(()=>{"use strict";var e={m:{},u:e=>"static/js/"+e+"."+{32:"bdd105eb",646:"8ffb4619",654:"c07a466f"}[e]+".chunk.js",o:(e,a)=>Object.prototype.hasOwnProperty.call(e,a),p:"/rl/"};e.b=self.location+"/../../../";const a=function(e){let n=arguments.length>2?arguments[2]:void 0;if("function"===typeof e){const r=Array(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1).fill(null).map(e).map(((e,r)=>a(e,null,n?e=>n(e,r):null))),t=function(e){for(var a=arguments.length,n=new Array(a>1?a-1:0),t=1;t<a;t++)n[t-1]=arguments[t];return Promise.all(r.map((a=>a.call(e,...n))))};return{call:t}}const r="".concat((Date.now()*Math.random()).toString(36));let t;const l=new Promise((e=>{t=e})),o={};return e.addEventListener("message",(e=>{let{data:a}=e;if("calleeReady"===a.func)return void t();const{callId:r,error:l,data:c}=a;r&&o[r]?l?o[r].reject(l):o[r].resolve(c):n&&n(a)})),{call:async function(a){await l;const n="".concat((Date.now()*Math.random()).toString(36));for(var t=arguments.length,c=new Array(t>1?t-1:0),s=1;s<t;s++)c[s-1]=arguments[s];return e.postMessage({func:a,params:c,callerId:r,callId:n}),new Promise(((e,a)=>{o[n]={resolve:function(){delete o[n],e(...arguments)},reject:function(){delete o[n],a(...arguments)}}}))}}},n=async n=>{const r=new Uint8Array(new SharedArrayBuffer(1)),t=new Uint8Array(new SharedArrayBuffer(1)),l=(e,a)=>({score:{series:a,values:new Float32Array(new SharedArrayBuffer(4*e)).fill(NaN)},actorLoss:{series:a,values:new Float32Array(new SharedArrayBuffer(4*e)).fill(NaN)},entropyLoss:{series:a,values:new Float32Array(new SharedArrayBuffer(4*e)).fill(NaN)},criticLoss:{series:a,values:new Float32Array(new SharedArrayBuffer(4*e)).fill(NaN)},loss:{series:a,values:new Float32Array(new SharedArrayBuffer(4*e)).fill(NaN)}}),o=new Uint32Array(new SharedArrayBuffer(4)),c=(a,n)=>{if("pg"===a)return new Worker(new URL(e.p+e.u(646),e.b),{type:void 0,name:n});if("ac"===a)return new Worker(new URL(e.p+e.u(654),e.b),{type:void 0,name:n});if("ppo"===a)return new Worker(new URL(e.p+e.u(32),e.b),{type:void 0,name:n});throw new Error("Unknown agent")},s=[await(async e=>{let{minEpisodesCriterion:a=100,...n}=e;return{minEpisodesCriterion:a,...n,plot:l(n.numOfIterations,"".concat(n.algorithm,"(").concat(n.numOfActors,") ").concat(n.layers.join("x")," ").concat(n.numOfSteps,"~ \u03b1=").concat(n.learningRate," \u03b3=").concat(n.discountRate," ").concat(n.gaeLambda>0?" \u03bb=".concat(n.gaeLambda):"").concat(n.clipEpsilon>0?" \u03b5=".concat(n.clipEpsilon):"").replace(/\./g,","))}})({algorithm:"ppo",layers:[128],numOfIterations:2e3,numOfActors:4,numOfSteps:512,numOfMinibatch:4,goalScore:512,learningRate:5e-5,discountRate:.99,updateEpochs:3,gaeLambda:.9,clipEpsilon:.2,valueClipEpsilon:.2,maxGradNorm:.5,entropyCoef:.01,valueCoef:.5,actorSleep:100})];return n("ready",{stopRequested:r,training:t,plots:s.map((e=>e.plot)),plotLength:o}),{start:async()=>{t[0]=!0;const e=await Promise.all(s.map((async(e,n)=>{const r=a(c(e.algorithm,"plan_".concat(n)));return await r.call("new",e.numOfActors),await r.call("setPlan",e),r})));await Promise.all(e.map(((e,a)=>e.call("trainEpisodes",0===a?o:null)))),t[0]=!1;const r=a(c("ppo","tester")),l=await r.call("new",0);n("envSharedData",l),await r.call("setPlan",s[0]),await r.call("test")}}};(async e=>{const a="".concat((Date.now()*Math.random()).toString(36)),n=await e((function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),t=1;t<n;t++)r[t-1]=arguments[t];return self.postMessage({calleeId:a,callee:self.name,func:e,params:r})}));self.onmessage=async e=>{let{data:r}=e;if(r.callId)try{self.postMessage({callId:r.callId,calleeId:a,callee:self.name,func:r.func,data:await n[r.func](...r.params)})}catch(t){console.error(t),self.postMessage({callId:r.callId,calleeId:a,callee:self.name,func:r.func,error:t})}}})((e=>{const a=n(e);return e("calleeReady",self.name),a}))})();