/*! For license information please see 275.a0249792.chunk.js.LICENSE.txt */
(self.webpackChunktfjs_rl=self.webpackChunktfjs_rl||[]).push([[275],{31098:(t,e,n)=>{"use strict";n.d(e,{J:()=>o});var r=n(37837),i=n(80448);const a=r.kernel_impls.whereImpl;class o extends r.KernelBackend{nextDataId(){return o.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new r.DataStorage(this,(0,r.engine)())}write(t,e,n){this.firstUse&&(this.firstUse=!1,(0,r.env)().get("IS_NODE")&&r.backend_util.warn("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));const i={id:this.nextDataId()};return this.data.set(i,{values:t,dtype:n,refCount:1}),i}makeTensorInfo(t,e,n){let i;if("string"===e&&null!=n&&n.length>0&&r.util.isString(n[0])){const a=n.map((t=>r.util.encodeString(t)));i=this.write(a,t,e)}else i=this.write(n,t,e);return{dataId:i,shape:t,dtype:e}}refCount(t){if(this.data.has(t)){return this.data.get(t).refCount}return 0}incRef(t){this.data.get(t).refCount++}decRef(t){if(this.data.has(t)){this.data.get(t).refCount--}}move(t,e,n,r,i){this.data.set(t,{values:e,dtype:r,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:e,complexTensorInfos:n}=this.data.get(t);if("complex64"===e){const t=this.readSync(n.real.dataId),e=this.readSync(n.imag.dataId);return r.backend_util.mergeRealAndImagArrays(t,e)}return r.util.convertBackendValuesAndArrayBuffer(this.data.get(t).values,e)}bufferSync(t){const e=this.readSync(t.dataId);if("string"===t.dtype)try{const n=e.map((t=>r.util.decodeString(t)));return(0,r.buffer)(t.shape,t.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return(0,r.buffer)(t.shape,t.dtype,e)}makeOutput(t,e,n){return(0,r.engine)().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,t),this)}disposeData(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.data.has(t)){if(this.data.get(t).refCount--,!e&&this.data.get(t).refCount>0)return!1;const{complexTensorInfos:n}=this.data.get(t);null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}async time(t){const e=r.util.now();t();return{kernelMs:r.util.now()-e}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){(0,i.C)([t],"where");const e=this.readSync(t.dataId);return a(t.shape,e)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}o.nextDataId=0},31174:(t,e,n)=>{"use strict";n.d(e,{Um:()=>a.r});var r=n(37837),i=n(31098),a=n(58147);(0,r.registerBackend)("cpu",(()=>new i.J),1)},80448:(t,e,n)=>{"use strict";n.d(e,{C:()=>i});var r=n(37837);function i(t,e){Array.isArray(t)||(t=[t]),t.forEach((t=>{null!=t&&r.util.assert("complex64"!==t.dtype,(()=>"".concat(e," does not support complex64 tensors in the CPU backend.")))}))}},57739:(t,e,n)=>{"use strict";n.d(e,{Um:()=>r.Um});var r=n(31174);n(74351)},14906:(t,e,n)=>{"use strict";n.d(e,{dH:()=>a,lO:()=>o});var r=n(37837),i=n(80448);function a(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const o={kernelName:r.Abs,backendName:"cpu",kernelFunc:t=>{const{x:e}=t.inputs,n=t.backend;(0,i.C)(e,"abs");let o=new Float32Array(r.util.sizeFromShape(e.shape));return o=a(n.data.get(e.dataId).values),n.makeOutput(o,e.shape,e.dtype)}}},29758:(t,e,n)=>{"use strict";n.d(e,{t:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.Acos,(t=>Math.acos(t))),a={kernelName:r.Acos,backendName:"cpu",kernelFunc:i}},99588:(t,e,n)=>{"use strict";n.d(e,{D:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.Acosh,(t=>Math.acosh(t))),a={kernelName:r.Acosh,backendName:"cpu",kernelFunc:i}},75197:(t,e,n)=>{"use strict";n.d(e,{UK:()=>u,WQ:()=>c,mx:()=>o});var r=n(37837),i=n(7369),a=n(21150);const o=(0,i.Z)(((t,e)=>t+e)),s=(0,a.B)(((t,e,n,r)=>({real:t+n,imag:e+r}))),c=(0,a.j)(r.Add,o,s),u={kernelName:r.Add,backendName:"cpu",kernelFunc:c}},34643:(t,e,n)=>{"use strict";n.d(e,{y:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.AddN,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,a=e;(0,i.C)(e,"addN");const o=a.map((t=>n.data.get(t.dataId).values)),s=(0,r.buffer)(a[0].shape,a[0].dtype),c=s.values;for(let r=0;r<a.length;r++){const t=o[r];for(let e=0;e<c.length;e++)c[e]+=t[e]}return n.makeTensorInfo(s.shape,s.dtype,s.values)}}},28013:(t,e,n)=>{"use strict";n.d(e,{k:()=>s});var r=n(37837),i=n(80448),a=n(34744),o=n(10933);const s={kernelName:r.All,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:c}=e,{axis:u,keepDims:l}=s;(0,i.C)(c,"all");const h=r.util.parseAxisParam(u,c.shape);let d=h;const f=r.backend_util.getAxesPermutation(d,c.shape.length);let p=c;null!=f&&(p=(0,o.m)({inputs:{x:c},backend:n,attrs:{perm:f}}),d=r.backend_util.getInnerMostAxes(d.length,c.shape.length)),r.backend_util.assertAxesAreInnerMostDims("all",d,p.shape.length);const[g,m]=r.backend_util.computeOutAndReduceShapes(p.shape,d),v=r.util.sizeFromShape(m),y=r.util.makeZerosTypedArray(r.util.sizeFromShape(g),p.dtype),b=n.data.get(p.dataId).values;for(let r=0;r<y.length;++r){const t=r*v;let e=b[t];for(let n=0;n<v;++n){const r=b[t+n];e=e&&r}y[r]=e}null!=f&&n.disposeIntermediateTensorInfo(p);const x=n.makeTensorInfo(g,p.dtype,y);if(l){const t=r.backend_util.expandShapeToKeepDim(g,h),e=(0,a.t)({inputs:{x:x},backend:n,attrs:{shape:t}});return n.disposeIntermediateTensorInfo(x),e}return x}}},88020:(t,e,n)=>{"use strict";n.d(e,{l:()=>s});var r=n(37837),i=n(80448),a=n(34744),o=n(10933);const s={kernelName:r.Any,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:c}=e,{axis:u,keepDims:l}=s;(0,i.C)(c,"any");const h=r.util.parseAxisParam(u,c.shape);let d=h;const f=r.backend_util.getAxesPermutation(d,c.shape.length);let p=c;null!=f&&(p=(0,o.m)({inputs:{x:c},backend:n,attrs:{perm:f}}),d=r.backend_util.getInnerMostAxes(d.length,c.shape.length)),r.backend_util.assertAxesAreInnerMostDims("any",d,p.shape.length);const[g,m]=r.backend_util.computeOutAndReduceShapes(p.shape,d),v=r.util.sizeFromShape(m),y=r.util.makeZerosTypedArray(r.util.sizeFromShape(g),p.dtype),b=n.data.get(p.dataId).values;for(let r=0;r<y.length;++r){const t=r*v;let e=b[t];for(let n=0;n<v;++n){const r=b[t+n];e=e||r}y[r]=e}null!=f&&n.disposeIntermediateTensorInfo(p);const x=n.makeTensorInfo(g,p.dtype,y);if(l){const t=r.backend_util.expandShapeToKeepDim(g,h),e=(0,a.t)({inputs:{x:x},backend:n,attrs:{shape:t}});return n.disposeIntermediateTensorInfo(x),e}return x}}},58482:(t,e,n)=>{"use strict";n.d(e,{n:()=>o});var r=n(37837),i=n(80448),a=n(10933);const o={kernelName:r.ArgMax,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:o}=t,{x:s}=e,{axis:c}=o;(0,i.C)(s,"argMax");let u=r.util.parseAxisParam(c,s.shape);const l=r.backend_util.getAxesPermutation(u,s.shape.length);let h=s;const d=[];null!=l&&(h=(0,a.m)({inputs:{x:s},backend:n,attrs:{perm:l}}),d.push(h),u=r.backend_util.getInnerMostAxes(u.length,h.shape.length)),u=[u[0]],r.backend_util.assertAxesAreInnerMostDims("argMax",u,h.shape.length);const[f,p]=r.backend_util.computeOutAndReduceShapes(h.shape,u),g=r.util.sizeFromShape(f),m=r.util.makeZerosTypedArray(g,"int32"),v=r.util.sizeFromShape(p),y=n.data.get(h.dataId).values;for(let r=0;r<m.length;++r){const t=r*v;let e=y[t],n=0;for(let r=0;r<v;++r){const i=y[t+r];i>e&&(e=i,n=r)}m[r]=n}return d.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.makeTensorInfo(f,"int32",m)}}},73980:(t,e,n)=>{"use strict";n.d(e,{l:()=>o});var r=n(37837),i=n(80448),a=n(10933);const o={kernelName:r.ArgMin,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:o}=t,{x:s}=e,{axis:c}=o;(0,i.C)(s,"argMin");let u=r.util.parseAxisParam(c,s.shape);const l=r.backend_util.getAxesPermutation(u,s.shape.length);let h=s;const d=[];null!=l&&(h=(0,a.m)({inputs:{x:s},backend:n,attrs:{perm:l}}),d.push(h),u=r.backend_util.getInnerMostAxes(u.length,h.shape.length)),u=[u[0]],r.backend_util.assertAxesAreInnerMostDims("argMin",u,h.shape.length);const[f,p]=r.backend_util.computeOutAndReduceShapes(h.shape,u),g=r.util.sizeFromShape(f),m=r.util.makeZerosTypedArray(g,"int32"),v=r.util.sizeFromShape(p),y=n.data.get(h.dataId).values;for(let r=0;r<m.length;++r){const t=r*v;let e=y[t],n=0;for(let r=0;r<v;++r){const i=y[t+r];i<e&&(e=i,n=r)}m[r]=n}return d.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.makeTensorInfo(f,"int32",m)}}},58343:(t,e,n)=>{"use strict";n.d(e,{S:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.Asin,(t=>Math.asin(t))),a={kernelName:r.Asin,backendName:"cpu",kernelFunc:i}},82439:(t,e,n)=>{"use strict";n.d(e,{M:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.Asinh,(t=>Math.asinh(t))),a={kernelName:r.Asinh,backendName:"cpu",kernelFunc:i}},77510:(t,e,n)=>{"use strict";n.d(e,{L:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.Atan,(t=>Math.atan(t))),a={kernelName:r.Atan,backendName:"cpu",kernelFunc:i}},76590:(t,e,n)=>{"use strict";n.d(e,{rL:()=>c});var r=n(37837),i=n(7369),a=n(21150);const o=(0,i.Z)(((t,e)=>Math.atan2(t,e))),s=(0,a.j)(r.Atan2,o),c={kernelName:r.Atan2,backendName:"cpu",kernelFunc:s}},15532:(t,e,n)=>{"use strict";n.d(e,{l:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.Atanh,(t=>Math.atanh(t))),a={kernelName:r.Atanh,backendName:"cpu",kernelFunc:i}},23412:(t,e,n)=>{"use strict";n.d(e,{R:()=>s});var r=n(37837),i=n(80448),a=n(51269),o=n(94010);const s={kernelName:r.AvgPool,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:c}=e;(0,i.C)(c,"avgPool");const{filterSize:u,strides:l,pad:h,dimRoundingMode:d}=s;r.util.assert(r.backend_util.eitherStridesOrDilationsAreOne(l,1),(()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(l," and dilations '").concat(1,"'")));const f=r.backend_util.computePool2DInfo(c.shape,u,l,1,h,d);let p;if(1===f.filterWidth&&1===f.filterHeight&&r.util.arraysEqual(f.inShape,f.outShape))p=(0,o.D)({inputs:{x:c},backend:n});else{const t=n.data.get(c.dataId).values,e=r.util.computeStrides(c.shape),i=(0,a.dz)(t,c.shape,c.dtype,e,f,"avg");p=n.makeTensorInfo(f.outShape,c.dtype,i.values)}return p}}},66591:(t,e,n)=>{"use strict";n.d(e,{O:()=>o});var r=n(37837),i=n(80448),a=n(51269);const o={kernelName:r.AvgPool3D,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:o}=t,{x:s}=e,{filterSize:c,strides:u,pad:l,dimRoundingMode:h,dataFormat:d}=o;(0,i.C)(s,"avgPool3d");const f=r.backend_util.computePool3DInfo(s.shape,c,u,1,l,h,d),p=n.data.get(s.dataId).values,g=(0,a.W_)(p,s.shape,s.dtype,r.util.computeStrides(s.shape),f,"avg");return n.makeTensorInfo(g.shape,"float32",g.values)}}},52087:(t,e,n)=>{"use strict";n.d(e,{m:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.AvgPool3DGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{dy:o,input:s}=e,{filterSize:c,strides:u,pad:l,dimRoundingMode:h}=a;(0,i.C)([o,s],"avgPool3DGrad");const d=r.backend_util.computePool3DInfo(s.shape,c,u,1,l,h),f=d.strideDepth,p=d.strideHeight,g=d.strideWidth,m=d.filterDepth,v=d.filterHeight,y=d.filterWidth,b=d.dilationDepth,x=d.dilationHeight,w=d.dilationWidth,k=d.effectiveFilterDepth,_=d.effectiveFilterHeight,A=d.effectiveFilterWidth,C=k-1-d.padInfo.front,S=A-1-d.padInfo.left,E=_-1-d.padInfo.top,T=(0,r.buffer)(s.shape,"float32"),N=1/(m*v*y),F=n.bufferSync(o);for(let r=0;r<d.batchSize;++r)for(let t=0;t<d.inChannels;++t)for(let e=0;e<d.inDepth;++e)for(let n=0;n<d.inHeight;++n)for(let i=0;i<d.inWidth;++i){const a=e-C,o=n-E,s=i-S;let c=0;for(let e=0;e<k;e+=b){const n=(a+e)/f;if(!(n<0||n>=d.outDepth||Math.floor(n)!==n))for(let e=0;e<_;e+=x){const i=(o+e)/p;if(!(i<0||i>=d.outHeight||Math.floor(i)!==i))for(let e=0;e<A;e+=w){const a=(s+e)/g;if(a<0||a>=d.outWidth||Math.floor(a)!==a)continue;c+=F.get(r,n,i,a,t)}}}T.set(c*N,r,e,n,i,t)}return n.makeTensorInfo(T.shape,T.dtype,T.values)}}},49304:(t,e,n)=>{"use strict";n.d(e,{$:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.AvgPoolGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{dy:o,input:s}=e,c=s;(0,i.C)([o,s],"avgPoolGrad");const{filterSize:u,strides:l,pad:h}=a,d=r.backend_util.computePool2DInfo(c.shape,u,l,1,h),f=d.strideHeight,p=d.strideWidth,g=d.filterHeight,m=d.filterWidth,v=d.dilationHeight,y=d.dilationWidth,b=d.effectiveFilterHeight,x=d.effectiveFilterWidth,w=x-1-d.padInfo.left,k=b-1-d.padInfo.top,_=(0,r.buffer)(c.shape,"float32"),A=1/(g*m),C=n.data.get(o.dataId).values,S=(0,r.buffer)(o.shape,"float32",C);for(let r=0;r<d.batchSize;++r)for(let t=0;t<d.inChannels;++t)for(let e=0;e<d.inHeight;++e)for(let n=0;n<d.inWidth;++n){const i=e-k,a=n-w;let o=0;for(let e=0;e<b;e+=v){const n=(i+e)/f;if(!(n<0||n>=d.outHeight||Math.floor(n)!==n))for(let e=0;e<x;e+=y){const i=(a+e)/p;if(i<0||i>=d.outWidth||Math.floor(i)!==i)continue;o+=S.get(r,n,i,t)}}_.set(o*A,r,e,n,t)}return n.makeTensorInfo(_.shape,_.dtype,_.values)}}},38718:(t,e,n)=>{"use strict";n.d(e,{N:()=>o,X:()=>s});var r=n(37837),i=n(80448),a=n(34744);function o(t){const{inputs:e,backend:n,attrs:o}=t,{a:s,b:c}=e,{transposeA:u,transposeB:l}=o;(0,i.C)([s,c],"matMul");const h=s.shape.length,d=c.shape.length,f=u?s.shape[h-2]:s.shape[h-1],p=l?c.shape[d-1]:c.shape[d-2],g=u?s.shape[h-1]:s.shape[h-2],m=l?c.shape[d-2]:c.shape[d-1],v=s.shape.slice(0,-2),y=c.shape.slice(0,-2),b=r.util.sizeFromShape(v),x=r.util.sizeFromShape(y),w=r.broadcast_util.assertAndGetBroadcastShape(s.shape.slice(0,-2),c.shape.slice(0,-2)).concat([g,m]);r.util.assert(f===p,(()=>"Error in matMul: inner shapes (".concat(f,") and (")+"".concat(p,") of Tensors with shapes ").concat(s.shape," and ")+"".concat(c.shape," and transposeA=").concat(u)+" and transposeB=".concat(l," must match.")));const k=u?[b,f,g]:[b,g,f],_=l?[x,m,p]:[x,p,m],A=(0,a.t)({inputs:{x:s},backend:n,attrs:{shape:k}}),C=(0,a.t)({inputs:{x:c},backend:n,attrs:{shape:_}}),S=u?A.shape[1]:A.shape[2],E=u?A.shape[2]:A.shape[1],T=l?C.shape[1]:C.shape[2],N=Math.max(b,x),F=n.data.get(A.dataId).values,D=n.data.get(C.dataId).values,I=r.util.computeStrides(A.shape),M=r.util.computeStrides(C.shape),[O,R,z]=u?[I[0],1,I[1]]:[I[0],I[1],1],[B,L,P]=l?[1,M[1],M[0]]:[M[1],1,M[0]],j=E*T,U=(0,r.buffer)([N,E,T],A.dtype),W=U.values,V=n.blockSize;for(let r=0;r<N;r++){const t=r%b,e=r%x;for(let n=0;n<E;n+=V){const i=Math.min(n+V,E);for(let a=0;a<T;a+=V){const o=Math.min(a+V,T);for(let s=0;s<S;s+=V){const c=Math.min(s+V,S);for(let u=n;u<i;u++)for(let n=a;n<o;n++){let i=0;for(let r=s;r<c;r++){i+=F[t*O+u*R+r*z]*D[r*B+n*L+e*P]}W[r*j+(u*T+n)]+=i}}}}}return n.disposeIntermediateTensorInfo(A),n.disposeIntermediateTensorInfo(C),n.makeTensorInfo(w,U.dtype,U.values)}const s={kernelName:r.BatchMatMul,backendName:"cpu",kernelFunc:o}},57096:(t,e,n)=>{"use strict";n.d(e,{V:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.FusedBatchNorm,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{x:o,scale:s,offset:c,mean:u,variance:l}=e;r.util.assert(u.shape.length===l.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),r.util.assert(null==c||u.shape.length===c.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),r.util.assert(null==s||u.shape.length===s.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks.")),(0,i.C)([o,u,l,s,c],"batchNorm");let{varianceEpsilon:h}=a;null==h&&(h=.001);const d=n.data.get(o.dataId).values,f=n.data.get(u.dataId).values,p=n.data.get(l.dataId).values,g=s?n.data.get(s.dataId).values:new Float32Array([1]),m=c?n.data.get(c.dataId).values:new Float32Array([0]),v=new Float32Array(d.length),y=m.length,b=g.length,x=p.length,w=f.length;let k=0,_=0,A=0,C=0;for(let r=0;r<d.length;++r)v[r]=m[k++]+(d[r]-f[_++])*g[A++]/Math.sqrt(p[C++]+h),k>=y&&(k=0),_>=w&&(_=0),A>=b&&(A=0),C>=x&&(C=0);return n.makeTensorInfo(o.shape,o.dtype,v)}}},19923:(t,e,n)=>{"use strict";n.d(e,{e:()=>c});var r=n(37837),i=n(80448),a=n(34744),o=n(80844),s=n(10933);const c={kernelName:r.BatchToSpaceND,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:c}=t,{x:u}=e,{blockShape:l,crops:h}=c;(0,i.C)([u],"batchToSpaceND");const d=l.reduce(((t,e)=>t*e)),f=r.backend_util.getReshaped(u.shape,l,d),p=r.backend_util.getPermuted(f.length,l.length),g=r.backend_util.getReshapedPermuted(u.shape,l,d),m=r.backend_util.getSliceBeginCoords(h,l.length),v=r.backend_util.getSliceSize(g,h,l.length),y=(0,a.t)({inputs:{x:u},backend:n,attrs:{shape:f}}),b=(0,s.m)({inputs:{x:y},backend:n,attrs:{perm:p}}),x=(0,a.t)({inputs:{x:b},backend:n,attrs:{shape:g}}),w=(0,o.di)({inputs:{x:x},backend:n,attrs:{begin:m,size:v}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(x),w}}},58648:(t,e,n)=>{"use strict";n.d(e,{l:()=>a});var r=n(37837),i=n(96837);const a={kernelName:r.Bincount,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:o}=e,{size:s}=r,c=n.data.get(a.dataId).values,u=n.data.get(o.dataId).values,l=(0,i.X)(c,u,o.dtype,o.shape,s);return n.makeTensorInfo([s],o.dtype,l)}}},96837:(t,e,n)=>{"use strict";n.d(e,{N:()=>a,X:()=>i});var r=n(37837);function i(t,e,n,i,a){const o=r.util.sizeFromShape(i),s=r.util.makeZerosTypedArray(a,n);for(let r=0;r<t.length;r++){const n=t[r];if(n<0)throw new Error("Input x must be non-negative!");n>=a||(s[n]+=o>0?e[r]:1)}return s}function a(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=t.shape[0],o=t.shape[1],s=(0,r.buffer)([a,n],e.dtype);for(let r=0;r<a;r++)for(let a=0;a<o;a++){const o=t.get(r,a);if(o<0)throw new Error("Input x must be non-negative!");o>=n||(i?s.set(1,r,o):e.size>0?s.set(s.get(r,o)+e.get(r,a),r,o):s.set(s.get(r,o)+1,r,o))}return s}},87488:(t,e,n)=>{"use strict";n.d(e,{LY:()=>c,f6:()=>o});var r=n(37837),i=n(7369),a=n(21150);const o=(0,i.Z)(((t,e)=>t&e)),s=(0,a.j)(r.BitwiseAnd,o),c={kernelName:r.BitwiseAnd,backendName:"cpu",kernelFunc:s}},19540:(t,e,n)=>{"use strict";n.d(e,{N:()=>i});var r=n(37837);const i={kernelName:r.BroadcastArgs,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{s0:i,s1:a}=e,o=n.data.get(i.dataId).values,s=n.data.get(a.dataId).values,c=r.backend_util.assertAndGetBroadcastShape(Array.from(o),Array.from(s));return n.makeTensorInfo([c.length],"int32",Int32Array.from(c))}}},37007:(t,e,n)=>{"use strict";n.d(e,{Ml:()=>h,ct:()=>u,wg:()=>l});var r=n(37837),i=n(7369),a=n(94883),o=n(60694),s=n(94010),c=n(50280);function u(t,e,n,a){if("int32"===a){return[e,"int32",Int32Array.from(t)]}if("bool"===a){const a=r.util.toTypedArray([0],n),[o,s]=(0,i.Z)(((t,e)=>t!==e?1:0))(e,[],t,a,"bool");return[s,"bool",o]}throw new Error("Error in Cast: failed to cast ".concat(n," to ").concat(a))}function l(t){const{inputs:e,backend:n,attrs:i}=t,{x:h}=e,{dtype:d}=i;if("complex64"===d){if("complex64"===h.dtype)return(0,s.D)({inputs:{x:h},backend:n});const t=(0,a.U)(n,h.shape,h.dtype),e=l({inputs:{x:h},backend:n,attrs:{dtype:"float32"}}),r=(0,o.f)({inputs:{real:e,imag:t},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),r}if("complex64"===h.dtype){const t=(0,c.x)({inputs:{input:h},backend:n}),e=l({inputs:{x:t},backend:n,attrs:{dtype:d}});return n.disposeIntermediateTensorInfo(t),e}if(!r.util.hasEncodingLoss(h.dtype,d)){const t=(0,s.D)({inputs:{x:h},backend:n});return{dataId:t.dataId,shape:t.shape,dtype:d}}const f=n.data.get(h.dataId).values,[p,g,m]=u(f,h.shape,h.dtype,d);return n.makeTensorInfo(p,g,m)}const h={kernelName:r.Cast,backendName:"cpu",kernelFunc:l}},56729:(t,e,n)=>{"use strict";n.d(e,{YG:()=>o,uf:()=>c});var r=n(37837),i=n(77199),a=n(74092);const o=(0,i.o)((t=>Math.ceil(t))),s=(0,a.F)(r.Ceil,o),c={kernelName:r.Ceil,backendName:"cpu",kernelFunc:s}},9658:(t,e,n)=>{"use strict";n.d(e,{F:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.ClipByValue,((t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t})),a={kernelName:r.ClipByValue,backendName:"cpu",kernelFunc:i}},60694:(t,e,n)=>{"use strict";function r(t){const{inputs:e,backend:n}=t,{real:r,imag:i}=e,a=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,s=n.makeTensorInfo(r.shape,"complex64");return n.data.get(s.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",a),imag:n.makeTensorInfo(i.shape,"float32",o)},s}n.d(e,{f:()=>r,v:()=>i});const i={kernelName:n(37837).Complex,backendName:"cpu",kernelFunc:r}},99176:(t,e,n)=>{"use strict";n.d(e,{t:()=>i});var r=n(37837);const i={kernelName:r.ComplexAbs,backendName:"cpu",kernelFunc:t=>{const{x:e}=t.inputs,n=t.backend,i=new Float32Array(r.util.sizeFromShape(e.shape)),a=n.data.get(e.dataId),o=a.complexTensorInfos.real,s=a.complexTensorInfos.imag,c=n.data.get(o.dataId).values,u=n.data.get(s.dataId).values;for(let r=0;r<c.length;r++){const t=c[r],e=u[r];i[r]=Math.hypot(t,e)}return n.makeOutput(i,e.shape,"float32")}}},21244:(t,e,n)=>{"use strict";n.d(e,{V:()=>h,x:()=>l});var r=n(37837),i=n(60694),a=n(9929),o=n(94010),s=n(14970),c=n(50280),u=n(34744);function l(t){const{inputs:e,backend:n,attrs:h}=t,{axis:d}=h,f=r.util.parseAxisParam(d,e[0].shape)[0],p=e.map((t=>t.shape));r.backend_util.assertParamsConsistent(p,f);let g=r.backend_util.computeOutShape(e.map((t=>t.shape)),f);if(0===r.util.sizeFromShape(g))return n.makeTensorInfo(g,e[0].dtype,[]);const m=e.filter((t=>r.util.sizeFromShape(t.shape)>0));if(1===m.length)return(0,o.D)({inputs:{x:m[0]},backend:n});if("complex64"===m[0].dtype){const t=m.map((t=>(0,c.x)({inputs:{input:t},backend:n}))),e=m.map((t=>(0,s.n)({inputs:{input:t},backend:n}))),r=l({inputs:t,backend:n,attrs:{axis:f}}),a=l({inputs:e,backend:n,attrs:{axis:f}}),o=(0,i.f)({inputs:{real:r,imag:a},backend:n});return t.forEach((t=>n.disposeIntermediateTensorInfo(t))),e.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a),o}const v=m.map((t=>{const e=[-1,r.util.sizeFromShape(t.shape.slice(f))];return(0,u.t)({inputs:{x:t},backend:n,attrs:{shape:e}})})),y=v.map((t=>({vals:n.data.get(t.dataId).values,shape:t.shape})));g=r.backend_util.computeOutShape(v.map((t=>t.shape)),1);const b=1===v[0].shape[0],x=(0,a.h)(y,g,e[0].dtype,b),w=r.backend_util.computeOutShape(m.map((t=>t.shape)),f),k=n.makeTensorInfo(w,e[0].dtype,x);return v.forEach((t=>n.disposeIntermediateTensorInfo(t))),k}const h={kernelName:r.Concat,backendName:"cpu",kernelFunc:l}},9929:(t,e,n)=>{"use strict";n.d(e,{h:()=>i});var r=n(37837);function i(t,e,n,i){const a=r.util.getArrayFromDType(n,r.util.sizeFromShape(e));if(i&&"string"!==n){let e=0;t.forEach((t=>{const n=r.util.sizeFromShape(t.shape);a.set(t.vals,e),e+=n}))}else{let i=0;t.forEach((t=>{const o="string"===n?r.backend_util.fromUint8ToStringArray(t.vals):t.vals;let s=0;for(let n=0;n<t.shape[0];++n){const r=n*e[1]+i;for(let e=0;e<t.shape[1];++e)a[r+e]=o[s++]}i+=t.shape[1]}))}return a}},14284:(t,e,n)=>{"use strict";n.d(e,{J:()=>a,x:()=>o});var r=n(37837),i=n(80448);function a(t){const{inputs:e,backend:n,attrs:a}=t,{x:o,filter:s}=e,{strides:c,pad:u,dataFormat:l,dilations:h,dimRoundingMode:d}=a;(0,i.C)([o,s],"conv2d");const f=r.backend_util.convertConv2DDataFormat(l),p=r.backend_util.computeConv2DInfo(o.shape,s.shape,c,h,u,d,!1,f),g=p.filterHeight,m=p.filterWidth,v=p.dilationHeight,y=p.dilationWidth,b=p.padInfo.left,x=p.padInfo.top,w="channelsLast"===p.dataFormat,k=new r.TensorBuffer(p.outShape,o.dtype),_=r.util.computeStrides(o.shape),A=r.util.computeStrides(s.shape),C=_[0],S=w?_[1]:_[2],E=w?_[2]:1,T=w?1:_[1],N=k.strides[0],F=w?k.strides[1]:k.strides[2],D=w?k.strides[2]:1,I=w?1:k.strides[1],M=n.data.get(o.dataId).values,O=n.data.get(s.dataId).values,R=k.values;for(let r=0;r<p.batchSize;++r){const t=r*C,e=r*N;for(let n=0;n<p.outHeight;++n){const r=e+n*F,i=n*p.strideHeight-x;for(let e=0;e<g;++e){const n=i+e*v;if(n<0||n>=p.inHeight)continue;const a=e*A[0],o=t+n*S;for(let t=0;t<p.outWidth;++t){const e=r+t*D,n=t*p.strideWidth-b;for(let t=0;t<m;++t){const r=n+t*y;if(r<0||r>=p.inWidth)continue;const i=o+r*E;let s=a+t*A[1];for(let t=0;t<p.inChannels;++t){const n=M[i+t*T];for(let t=0;t<p.outChannels;++t)R[e+t*I]+=n*O[s+t];s+=p.outChannels}}}}}}return n.makeTensorInfo(k.shape,k.dtype,R)}const o={kernelName:r.Conv2D,backendName:"cpu",kernelFunc:a}},64120:(t,e,n)=>{"use strict";n.d(e,{r:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.Conv2DBackpropFilter,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{x:o,dy:s}=e,{strides:c,pad:u,dataFormat:l,dimRoundingMode:h,filterShape:d}=a;(0,i.C)([o,s],"conv2dBackpropFilter");const f=r.backend_util.convertConv2DDataFormat(l),p=r.backend_util.computeConv2DInfo(o.shape,d,c,1,u,h,!1,f),{strideHeight:g,strideWidth:m,filterHeight:v,filterWidth:y}=p,b="channelsLast"===p.dataFormat,x=new r.TensorBuffer(p.filterShape,"float32"),w=p.padInfo.left,k=p.padInfo.top,_=n.data.get(o.dataId).values,A=n.data.get(s.dataId).values,C=new r.TensorBuffer(o.shape,o.dtype,_),S=new r.TensorBuffer(s.shape,s.dtype,A);for(let r=0;r<v;++r){const t=Math.max(0,Math.ceil((k-r)/g)),e=Math.min(p.outHeight,(p.inHeight+k-r)/g);for(let n=0;n<y;++n){const i=Math.max(0,Math.ceil((w-n)/m)),a=Math.min(p.outWidth,(p.inWidth+w-n)/m);for(let o=0;o<p.inChannels;++o)for(let s=0;s<p.outChannels;++s){let c=0;for(let u=0;u<p.batchSize;++u)for(let l=t;l<e;++l){const t=r+l*g-k;for(let e=i;e<a;++e){const r=n+e*m-w;c+=b?C.get(u,t,r,o)*S.get(u,l,e,s):C.get(u,o,t,r)*S.get(u,s,l,e)}}x.set(c,r,n,o,s)}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}}},53060:(t,e,n)=>{"use strict";n.d(e,{f:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.Conv2DBackpropInput,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{dy:o,filter:s}=e,{inputShape:c,strides:u,pad:l,dataFormat:h,dimRoundingMode:d}=a;(0,i.C)([o,s],"conv2dBackpropInput");const f=r.util.computeStrides(s.shape),p=r.util.computeStrides(o.shape);let g=r.backend_util.convertConv2DDataFormat(h);const m=r.backend_util.computeConv2DInfo(c,s.shape,u,1,l,d,!1,g),v=new r.TensorBuffer(m.inShape,"float32"),y=v.values,b=n.data.get(o.dataId).values,x=n.data.get(s.dataId).values,[w,k,_]=f,{batchSize:A,filterHeight:C,filterWidth:S,inChannels:E,inHeight:T,inWidth:N,outChannels:F,outHeight:D,outWidth:I,strideHeight:M,strideWidth:O}=m;g=m.dataFormat;const R=C-1-m.padInfo.top,z=S-1-m.padInfo.left,B="channelsLast"===g,L=v.strides[0],P=B?v.strides[1]:v.strides[2],j=B?v.strides[2]:1,U=B?1:v.strides[1],W=p[0],V=B?p[1]:p[2],q=B?p[2]:1,G=B?1:p[1];for(let r=0;r<A;++r)for(let t=0;t<E;++t)for(let e=0;e<T;++e){const n=e-R,i=Math.max(0,Math.ceil(n/M)),a=Math.min(D,(C+n)/M);for(let o=0;o<N;++o){const s=o-z,c=Math.max(0,Math.ceil(s/O)),u=Math.min(I,(S+s)/O);let l=0;for(let e=i;e<a;++e){const i=e*M-n;for(let n=c;n<u;++n){const a=W*r+V*e+q*n,o=w*(C-1-i)+k*(S-1-(n*O-s))+_*t;for(let t=0;t<F;++t){l+=b[a+G*t]*x[o+t]}}}y[L*r+P*e+j*o+U*t]=l}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}}},75145:(t,e,n)=>{"use strict";n.d(e,{i:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.Conv3D,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{x:o,filter:s}=e,{strides:c,pad:u,dilations:l}=a;(0,i.C)([o,s],"conv3d");const h=r.backend_util.computeConv3DInfo(o.shape,s.shape,c,l,u),{filterDepth:d,filterHeight:f,filterWidth:p,dilationDepth:g,dilationHeight:m,dilationWidth:v,padInfo:y}=h,b=y.front,x=y.left,w=y.top,k=new r.TensorBuffer(h.outShape,o.dtype),_=n.data.get(o.dataId).values,A=n.data.get(s.dataId).values,C=k.values,S=r.util.computeStrides(o.shape),E=r.util.computeStrides(s.shape);for(let r=0;r<h.batchSize;++r){const t=r*S[0],e=r*k.strides[0];for(let n=0;n<h.outDepth;++n){const r=e+n*k.strides[1],i=n*h.strideDepth-b;for(let e=0;e<d;++e){const n=i+e*g;if(n<0||n>=h.inDepth)continue;const a=e*E[0],o=t+n*S[1];for(let t=0;t<h.outHeight;++t){const e=r+t*k.strides[2],n=t*h.strideHeight-w;for(let t=0;t<f;++t){const r=n+t*m;if(r<0||r>=h.inHeight)continue;const i=a+t*E[1],s=o+r*S[2];for(let t=0;t<h.outWidth;++t){const n=e+t*h.outChannels,r=t*h.strideWidth-x;for(let t=0;t<p;++t){const e=r+t*v;if(e<0||e>=h.inWidth)continue;const a=i+t*E[2],o=s+e*h.inChannels;let c=a;for(let t=0;t<h.inChannels;++t){const e=_[o+t];for(let t=0;t<h.outChannels;++t)C[n+t]+=e*A[c+t];c+=h.outChannels}}}}}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}}},4141:(t,e,n)=>{"use strict";n.d(e,{i:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.Conv3DBackpropFilterV2,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{x:o,dy:s}=e,{strides:c,pad:u,filterShape:l}=a;(0,i.C)([o,s],"conv3dBackpropFilterV2");const h=r.util.computeStrides(o.shape),d=r.util.computeStrides(s.shape),f=r.backend_util.computeConv3DInfo(o.shape,l,c,1,u),p=f.strideDepth,g=f.strideHeight,m=f.strideWidth,v=f.filterDepth,y=f.filterHeight,b=f.filterWidth,x=new r.TensorBuffer(f.filterShape,"float32"),w=x.values,[k,_,A,C]=x.strides,S=n.data.get(s.dataId).values,[E,T,N,F]=d,D=n.data.get(o.dataId).values,[I,M,O,R]=h,z=f.padInfo.front,B=f.padInfo.left,L=f.padInfo.top;for(let r=0;r<v;++r){const t=Math.max(0,Math.ceil((z-r)/p)),e=Math.min(f.outDepth,(f.inDepth+z-r)/p),n=r*k;for(let i=0;i<y;++i){const a=Math.max(0,Math.ceil((L-i)/g)),o=Math.min(f.outHeight,(f.inHeight+L-i)/g),s=i*_+n;for(let n=0;n<b;++n){const c=Math.max(0,Math.ceil((B-n)/m)),u=Math.min(f.outWidth,(f.inWidth+B-n)/m),l=n*A+s;for(let s=0;s<f.inChannels;++s){const h=s*C+l;for(let l=0;l<f.outChannels;++l){let d=0;for(let h=0;h<f.batchSize;++h){const f=h*I,v=h*E;for(let h=t;h<e;++h){const t=(r+h*p-z)*M+f,e=h*T+v;for(let r=a;r<o;++r){const a=(i+r*g-L)*O+t,o=r*N+e;for(let t=c;t<u;++t){const e=t*F+o;d+=D[(n+t*m-B)*R+a+s]*S[e+l]}}}}w[h+l]=d}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}}},57379:(t,e,n)=>{"use strict";n.d(e,{e:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.Conv3DBackpropInputV2,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{dy:o,filter:s}=e,{pad:c,strides:u,inputShape:l}=a;(0,i.C)([o],"conv3dBackpropInputV2");const h=r.util.computeStrides(o.shape),d=r.util.computeStrides(s.shape),f=r.backend_util.computeConv3DInfo(l,s.shape,u,1,c),p=new r.TensorBuffer(f.inShape,"float32"),g=p.values,[m,v,y,b]=p.strides,x=n.data.get(o.dataId).values,[w,k,_,A]=h,C=n.data.get(s.dataId).values,[S,E,T,N]=d,{batchSize:F,filterDepth:D,filterHeight:I,filterWidth:M,inChannels:O,inDepth:R,inHeight:z,inWidth:B,outChannels:L,outDepth:P,outHeight:j,outWidth:U,strideDepth:W,strideHeight:V,strideWidth:q}=f,G=D-1-f.padInfo.front,H=I-1-f.padInfo.top,Y=M-1-f.padInfo.left;for(let r=0;r<F;++r)for(let t=0;t<O;++t)for(let e=0;e<R;++e){const n=e-G,i=Math.max(0,Math.ceil(n/W)),a=Math.min(P,(D+n)/W);for(let o=0;o<z;++o){const s=o-H,c=Math.max(0,Math.ceil(s/V)),u=Math.min(j,(I+s)/V);for(let l=0;l<B;++l){const h=l-Y,d=Math.max(0,Math.ceil(h/q)),f=Math.min(U,(M+h)/q);let p=0;for(let e=i;e<a;++e){const i=e*W-n;for(let n=c;n<u;++n){const a=n*V-s;for(let o=d;o<f;++o){const s=w*r+k*e+_*n+A*o,c=S*(D-1-i)+E*(I-1-a)+T*(M-1-(o*q-h))+N*t;for(let t=0;t<L;++t){p+=x[s+t]*C[c+t]}}}}g[m*r+v*e+y*o+b*l+t]=p}}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}}},13753:(t,e,n)=>{"use strict";n.d(e,{o:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.Cos,(t=>Math.cos(t))),a={kernelName:r.Cos,backendName:"cpu",kernelFunc:i}},84125:(t,e,n)=>{"use strict";n.d(e,{k:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.Cosh,(t=>Math.cosh(t))),a={kernelName:r.Cosh,backendName:"cpu",kernelFunc:i}},2293:(t,e,n)=>{"use strict";n.d(e,{O:()=>i});var r=n(37837);const i={kernelName:r.CropAndResize,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{image:a,boxes:o,boxInd:s}=e,{cropSize:c,method:u,extrapolationValue:l}=i,[h,d,f,p]=a.shape,g=o.shape[0],[m,v]=c,y=(0,r.buffer)([g,m,v,p],"float32"),b=n.data.get(o.dataId).values,x=n.data.get(s.dataId).values,w=n.data.get(a.dataId).values,k=r.util.computeStrides(a.shape),_=r.util.computeStrides(y.shape);for(let r=0;r<g;r++){const t=4*r,e=b[t],n=b[t+1],i=b[t+2],a=b[t+3],o=x[r];if(o>=h)continue;const s=m>1?(i-e)*(d-1)/(m-1):0,c=v>1?(a-n)*(f-1)/(v-1):0;for(let h=0;h<m;h++){const t=m>1?e*(d-1)+h*s:.5*(e+i)*(d-1);if(t<0||t>d-1)for(let e=0;e<v;e++)for(let t=0;t<p;t++){const n=t+e*_[2]+h*_[1]+r*_[0];y.values[n]=l}else if("bilinear"===u){const e=Math.floor(t),i=Math.ceil(t),s=t-e;for(let t=0;t<v;t++){const u=v>1?n*(f-1)+t*c:.5*(n+a)*(f-1);if(u<0||u>f-1){for(let e=0;e<p;e++){const n=e+t*_[2]+h*_[1]+r*_[0];y.values[n]=l}continue}const d=Math.floor(u),g=Math.ceil(u),m=u-d;for(let n=0;n<p;n++){let a=n+d*k[2]+e*k[1]+o*k[0];const c=w[a];a=n+g*k[2]+e*k[1]+o*k[0];const u=w[a];a=n+d*k[2]+i*k[1]+o*k[0];const l=w[a];a=n+g*k[2]+i*k[1]+o*k[0];const f=c+(u-c)*m,p=l+(w[a]-l)*m;a=n+t*_[2]+h*_[1]+r*_[0],y.values[a]=f+(p-f)*s}}}else for(let e=0;e<v;++e){const i=v>1?n*(f-1)+e*c:.5*(n+a)*(f-1);if(i<0||i>f-1){for(let t=0;t<p;t++){const n=t+e*_[2]+h*_[1]+r*_[0];y.values[n]=l}continue}const s=Math.round(i),u=Math.round(t);for(let t=0;t<p;t++){const n=t+s*k[2]+u*k[1]+o*k[0],i=t+e*_[2]+h*_[1]+r*_[0];y.values[i]=w[n]}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}}},87308:(t,e,n)=>{"use strict";n.d(e,{T:()=>o});var r=n(37837),i=n(80448),a=n(10933);const o={kernelName:r.Cumprod,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:o}=t,{x:s}=e,{axis:c,exclusive:u,reverse:l}=o;(0,i.C)(s,"cumprod");const h=r.backend_util.getAxesPermutation([c],s.shape.length);let d=s;null!=h&&(d=(0,a.m)({inputs:{x:s},backend:n,attrs:{perm:h}}));const f=r.backend_util.getInnerMostAxes(1,s.shape.length)[0];if(f!==d.shape.length-1)throw new Error("backend.cumprod in CPU expects an inner-most "+"axis=".concat(d.shape.length-1," but got axis=").concat(f));const p=(0,r.upcastType)(d.dtype,"int32"),g=r.util.makeOnesTypedArray(r.util.sizeFromShape(d.shape),p),m=n.data.get(d.dataId).values,v=d.shape[d.shape.length-1],y=l?(t,e)=>t+v-e-1:(t,e)=>t+e;for(let r=0;r<m.length;r+=v)for(let t=0;t<v;t++){const e=y(r,t);if(0===t)g[e]=u?1:m[e];else{const n=y(r,t-1);g[e]=u?m[n]*g[n]:m[e]*g[n]}}const b=n.makeTensorInfo(d.shape,p,g);if(null!=h){const t=r.backend_util.getUndoAxesPermutation(h),e=(0,a.m)({inputs:{x:b},backend:n,attrs:{perm:t}});return n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(d),e}return b}}},48190:(t,e,n)=>{"use strict";n.d(e,{$:()=>o});var r=n(37837),i=n(80448),a=n(10933);const o={kernelName:r.Cumsum,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:o}=t,{x:s}=e,{axis:c,exclusive:u,reverse:l}=o;(0,i.C)(s,"cumsum");const h=r.backend_util.getAxesPermutation([c],s.shape.length);let d=s;null!=h&&(d=(0,a.m)({inputs:{x:s},backend:n,attrs:{perm:h}}));const f=r.backend_util.getInnerMostAxes(1,s.shape.length)[0];if(f!==d.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most "+"axis=".concat(d.shape.length-1," but got axis=").concat(f));const p=(0,r.upcastType)(d.dtype,"int32"),g=r.util.makeZerosTypedArray(r.util.sizeFromShape(d.shape),p),m=n.data.get(d.dataId).values,v=d.shape[d.shape.length-1],y=l?(t,e)=>t+v-e-1:(t,e)=>t+e;for(let r=0;r<m.length;r+=v)for(let t=0;t<v;t++){const e=y(r,t);if(0===t)g[e]=u?0:m[e];else{const n=y(r,t-1);g[e]=u?m[n]+g[n]:m[e]+g[n]}}const b=n.makeTensorInfo(d.shape,p,g);if(null!=h){const t=r.backend_util.getUndoAxesPermutation(h),e=(0,a.m)({inputs:{x:b},backend:n,attrs:{perm:t}});return n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(d),e}return b}}},45749:(t,e,n)=>{"use strict";n.d(e,{Y:()=>a});var r=n(37837),i=n(96837);const a={kernelName:r.DenseBincount,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:o}=e,{size:s,binaryOutput:c}=r;if(1===a.shape.length){const t=n.data.get(a.dataId).values,e=n.data.get(o.dataId).values,r=(0,i.X)(t,e,o.dtype,o.shape,s);return n.makeTensorInfo([s],o.dtype,r)}if(2===a.shape.length){const t=n.bufferSync(a),e=n.bufferSync(o),r=(0,i.N)(t,e,s,c);return n.makeTensorInfo(r.shape,o.dtype,r.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}}},58866:(t,e,n)=>{"use strict";n.d(e,{R:()=>i});var r=n(37837);const i={kernelName:r.DepthToSpace,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t,{x:a}=e,{blockSize:o,dataFormat:s}=i;r.util.assert("NHWC"===s,(()=>"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(s)));const c=a.shape[0],u=a.shape[1],l=a.shape[2],h=a.shape[3],d=u*o,f=l*o,p=h/(o*o),g=n.data.get(a.dataId).values,m=new Float32Array(c*d*f*p);let v=0;for(let r=0;r<c;++r)for(let t=0;t<d;++t){const e=Math.floor(t/o),n=t%o;for(let t=0;t<f;++t){const i=Math.floor(t/o),a=(n*o+t%o)*p;for(let t=0;t<p;++t){const n=t+a+h*(i+l*(e+u*r));m[v++]=g[n]}}}return n.makeTensorInfo([c,d,f,p],a.dtype,m)}}},37352:(t,e,n)=>{"use strict";n.d(e,{n:()=>a,v:()=>o});var r=n(37837),i=n(80448);function a(t){const{inputs:e,backend:n,attrs:a}=t,{x:o,filter:s}=e,{strides:c,pad:u,dilations:l,dimRoundingMode:h}=a;(0,i.C)([o,s],"depthwiseConv2DNative");const d=r.util.computeStrides(o.shape),f=r.util.computeStrides(s.shape);let p=l;null==p&&(p=[1,1]),r.util.assert(r.backend_util.eitherStridesOrDilationsAreOne(c,p),(()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(c," and dilations '").concat(p,"'")));const g=r.backend_util.computeConv2DInfo(o.shape,s.shape,c,p,u,h,!0),{filterHeight:m,filterWidth:v,dilationHeight:y,dilationWidth:b,padInfo:x}=g,w=x.left,k=x.top,_=g.outChannels/g.inChannels,A=new r.TensorBuffer(g.outShape,o.dtype),C=n.data.get(o.dataId).values,S=n.data.get(s.dataId).values,E=A.values;for(let r=0;r<g.batchSize;++r){const t=r*d[0],e=r*A.strides[0];for(let n=0;n<g.outHeight;++n){const r=e+n*A.strides[1],i=n*g.strideHeight-k;for(let e=0;e<m;++e){const n=i+e*y;if(n<0||n>=g.inHeight)continue;const a=e*f[0],o=t+n*d[1];for(let t=0;t<g.outWidth;++t){const e=r+t*A.strides[2],n=t*g.strideWidth-w;for(let t=0;t<v;++t){const r=n+t*b;if(r<0||r>=g.inWidth)continue;const i=a+t*f[1],s=o+r*g.inChannels;let c=e,u=i;for(let t=0;t<g.inChannels;++t){const e=C[s+t];for(let t=0;t<_;++t)E[c+t]+=e*S[u+t];c+=_,u+=_}}}}}}return n.makeTensorInfo(A.shape,A.dtype,A.values)}const o={kernelName:r.DepthwiseConv2dNative,backendName:"cpu",kernelFunc:a}},51484:(t,e,n)=>{"use strict";n.d(e,{n:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.DepthwiseConv2dNativeBackpropFilter,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{x:o,dy:s}=e,{strides:c,dilations:u,pad:l,dimRoundingMode:h,filterShape:d}=a;(0,i.C)([o,s],"depthwiseConv2dNativeBackpropFilter");const f=r.backend_util.computeConv2DInfo(o.shape,d,c,u,l,h,!0),{strideHeight:p,strideWidth:g,filterHeight:m,filterWidth:v}=f,y=new r.TensorBuffer(f.filterShape,"float32"),b=f.padInfo.left,x=f.padInfo.top,w=f.outChannels/f.inChannels,k=n.data.get(o.dataId).values,_=new r.TensorBuffer(o.shape,o.dtype,k),A=n.data.get(s.dataId).values,C=new r.TensorBuffer(s.shape,s.dtype,A);for(let r=0;r<m;++r){const t=Math.max(0,Math.ceil((x-r)/p)),e=Math.min(f.outHeight,(f.inHeight+x-r)/p);for(let n=0;n<v;++n){const i=Math.max(0,Math.ceil((b-n)/g)),a=Math.min(f.outWidth,(f.inWidth+b-n)/g);for(let o=0;o<f.outChannels;++o){const s=Math.trunc(o/w),c=o%w;let u=0;for(let l=0;l<f.batchSize;++l)for(let c=t;c<e;++c){const t=r+c*p-x;for(let e=i;e<a;++e){const r=n+e*g-b;u+=_.get(l,t,r,s)*C.get(l,c,e,o)}}y.set(u,r,n,s,c)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}}},18360:(t,e,n)=>{"use strict";n.d(e,{V:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.DepthwiseConv2dNativeBackpropInput,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{dy:o,filter:s}=e,{strides:c,dilations:u,pad:l,dimRoundingMode:h,inputShape:d}=a;(0,i.C)([o,s],"depthwiseConv2DNativeBackpropInput");const f=r.util.computeStrides(o.shape),p=r.util.computeStrides(s.shape),g=r.backend_util.computeConv2DInfo(d,s.shape,c,u,l,h,!0),m=new r.TensorBuffer(g.inShape,"float32"),v=m.values,[y,b,x]=m.strides,w=n.data.get(o.dataId).values,[k,_,A]=f,C=n.data.get(s.dataId).values,[S,E,T]=p,{batchSize:N,filterHeight:F,filterWidth:D,inChannels:I,inHeight:M,inWidth:O,outChannels:R,outHeight:z,outWidth:B,strideHeight:L,strideWidth:P}=g,j=F-1-g.padInfo.top,U=D-1-g.padInfo.left,W=R/I;for(let r=0;r<N;++r)for(let t=0;t<I;++t)for(let e=0;e<M;++e){const n=e-j,i=Math.max(0,Math.ceil(n/L)),a=Math.min(z,(F+n)/L);for(let o=0;o<O;++o){const s=o-U,c=Math.max(0,Math.ceil(s/P)),u=Math.min(B,(D+s)/P);let l=0;for(let e=i;e<a;++e){const i=e*L-n;for(let n=c;n<u;++n){const a=k*r+_*e+A*n,o=S*(F-1-i)+E*(D-1-(n*P-s))+T*t;for(let e=0;e<W;++e){l+=w[a+(t*W+e)]*C[o+e]}}}v[y*r+b*e+x*o+t]=l}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}}},9795:(t,e,n)=>{"use strict";n.d(e,{O:()=>i});var r=n(37837);const i={kernelName:r.Diag,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:i}=e,a=r.util.sizeFromShape(i.shape),o=n.data.get(i.dataId).values,s=(0,r.buffer)([a,a],i.dtype),c=s.values;for(let r=0;r<o.length;r++)c[r*a+r]=o[r];const u=[...i.shape,...i.shape];return n.makeTensorInfo(u,s.dtype,s.values)}}},72580:(t,e,n)=>{"use strict";n.d(e,{F:()=>i});var r=n(37837);const i={kernelName:r.Dilation2D,backendName:"cpu",kernelFunc:t=>{let{inputs:e,backend:n,attrs:i}=t;const{x:a,filter:o}=e,{strides:s,pad:c,dilations:u}=i,l=n,h=l.data.get(a.dataId).values,d=a.shape.length,f=l.data.get(o.dataId).values,p=o.shape.length,{batchSize:g,inHeight:m,inWidth:v,inChannels:y,outHeight:b,outWidth:x,padInfo:w,strideHeight:k,strideWidth:_,filterHeight:A,filterWidth:C,dilationHeight:S,dilationWidth:E,outShape:T}=r.backend_util.computeDilation2DInfo(a.shape,o.shape,s,c,"NHWC",u),N=r.util.sizeFromShape(T),F=T.length,D=r.util.getArrayFromDType(a.dtype,N);for(let I=0;I<g;++I)for(let t=0;t<b;++t){const e=t*k-w.top;for(let n=0;n<x;++n){const i=n*_-w.left;for(let s=0;s<y;++s){let c=Number.MIN_SAFE_INTEGER;for(let t=0;t<A;++t){const n=e+t*S;if(n>=0&&n<m)for(let e=0;e<C;++e){const u=i+e*E;if(u>=0&&u<v){const i=r.util.locToIndex([I,n,u,s],d,r.util.computeStrides(a.shape)),l=r.util.locToIndex([t,e,s],p,r.util.computeStrides(o.shape)),g=h[i]+f[l];g>c&&(c=g)}}}D[r.util.locToIndex([I,t,n,s],F,r.util.computeStrides(T))]=c}}}return{dataId:l.write(r.util.toTypedArray(D,a.dtype),T,a.dtype),shape:T,dtype:a.dtype}}}},91920:(t,e,n)=>{"use strict";n.d(e,{N:()=>i});var r=n(37837);const i={kernelName:r.Dilation2DBackpropFilter,backendName:"cpu",kernelFunc:t=>{let{inputs:e,backend:n,attrs:i}=t;const{x:a,filter:o,dy:s}=e,{strides:c,pad:u,dilations:l}=i,h=n,d=r.util.toNestedArray(a.shape,h.data.get(a.dataId).values),f=r.util.toNestedArray(o.shape,h.data.get(o.dataId).values),{batchSize:p,inHeight:g,inWidth:m,inChannels:v,outHeight:y,outWidth:b,padInfo:x,strideHeight:w,strideWidth:k,filterHeight:_,filterWidth:A,dilationHeight:C,dilationWidth:S,outShape:E}=r.backend_util.computeDilation2DInfo(a.shape,o.shape,c,u,"NHWC",l);r.util.assert(s.rank===E.length,(()=>"Error in ".concat(r.Dilation2DBackpropFilter,", dy ")+"must have the same rank as output ".concat(E.length,", but got ")+"".concat(s.rank)));const T=r.util.toNestedArray(E,h.data.get(s.dataId).values),N=r.util.makeZerosNestedTypedArray(o.shape,o.dtype);for(let r=0;r<p;++r)for(let t=0;t<y;++t){const e=t*w-x.top;for(let n=0;n<b;++n){const i=n*k-x.left;for(let a=0;a<v;++a){let o=Number.MIN_SAFE_INTEGER,s=0,c=0;for(let t=0;t<_;++t){const n=e+t*C;if(n>=0&&n<g)for(let e=0;e<A;++e){const u=i+e*S;if(u>=0&&u<m){const i=d[r][n][u][a]+f[t][e][a];i>o&&(o=i,s=t,c=e)}}}N[s][c][a]+=T[r][t][n][a]}}}return{dataId:h.write(r.util.toTypedArray(N,a.dtype),o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}}},84204:(t,e,n)=>{"use strict";n.d(e,{b:()=>i});var r=n(37837);const i={kernelName:r.Dilation2DBackpropInput,backendName:"cpu",kernelFunc:t=>{let{inputs:e,backend:n,attrs:i}=t;const{x:a,filter:o,dy:s}=e,{strides:c,pad:u,dilations:l}=i,h=n,d=r.util.toNestedArray(a.shape,h.data.get(a.dataId).values),f=r.util.toNestedArray(o.shape,h.data.get(o.dataId).values),{batchSize:p,inHeight:g,inWidth:m,inChannels:v,outHeight:y,outWidth:b,padInfo:x,strideHeight:w,strideWidth:k,filterHeight:_,filterWidth:A,dilationHeight:C,dilationWidth:S,outShape:E}=r.backend_util.computeDilation2DInfo(a.shape,o.shape,c,u,"NHWC",l);r.util.assert(s.rank===E.length,(()=>"Error in ".concat(r.Dilation2DBackpropInput,", dy ")+"must have the same rank as output ".concat(E.length,", but got ")+"".concat(s.rank)));const T=r.util.toNestedArray(E,h.data.get(s.dataId).values),N=r.util.makeZerosNestedTypedArray(a.shape,a.dtype);for(let r=0;r<p;++r)for(let t=0;t<y;++t){const e=t*w-x.top;for(let n=0;n<b;++n){const i=n*k-x.left;for(let a=0;a<v;++a){let o=Number.MIN_SAFE_INTEGER,s=e<0?0:e,c=i<0?0:i;for(let t=0;t<_;++t){const n=e+t*C;if(n>=0&&n<g)for(let e=0;e<A;++e){const u=i+e*S;if(u>=0&&u<m){const i=d[r][n][u][a]+f[t][e][a];i>o&&(o=i,s=n,c=u)}}}N[r][s][c][a]+=T[r][t][n][a]}}}return{dataId:h.write(r.util.toTypedArray(N,a.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}}},80470:(t,e,n)=>{"use strict";n.d(e,{b:()=>r});const r={kernelName:n(37837).Draw,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{image:i}=e,{canvas:a,options:o}=r,{contextOptions:s,imageOptions:c}=o||{},u=(null===c||void 0===c?void 0:c.alpha)||1,l=(null===s||void 0===s?void 0:s.contextType)||"2d";if("2d"!==l)throw new Error("Context type ".concat(s.contextType," is not supported by the CPU backend."));const h=a.getContext(l,(null===s||void 0===s?void 0:s.contextAttributes)||{});if(null==h)throw new Error("Could not get the context with ".concat(l," type."));const[d,f]=i.shape.slice(0,2),p=2===i.shape.length?1:i.shape[2],g=n.data.get(i.dataId).values,m="float32"===i.dtype?255:1,v=new Uint8ClampedArray(f*d*4);for(let b=0;b<d*f;++b){const t=[0,0,0,255*u];for(let n=0;n<p;n++){const e=g[b*p+n];if("float32"===i.dtype){if(e<0||e>1)throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(e,"."))}else if("int32"===i.dtype&&(e<0||e>255))throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(e,"."));1===p?(t[0]=e*m,t[1]=e*m,t[2]=e*m):t[n]=e*m}const e=4*b;v[e+0]=Math.round(t[0]),v[e+1]=Math.round(t[1]),v[e+2]=Math.round(t[2]),v[e+3]=Math.round(t[3])}a.width=f,a.height=d;const y=new ImageData(v,f,d);return h.putImageData(y,0,0),i}}},86811:(t,e,n)=>{"use strict";n.d(e,{_:()=>c});var r=n(37837),i=n(82636),a=n(34744),o=n(62381),s=n(10933);const c={kernelName:r.Einsum,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:c}=t,{equation:u}=c,l=e,{allDims:h,summedDims:d,idDims:f}=r.backend_util.decodeEinsumEquation(u,l.length);r.backend_util.checkEinsumDimSizes(h.length,f,l);const{path:p,steps:g}=r.backend_util.getEinsumComputePath(d,f),m=g.length;let v=null,y=h.length;const b=[];for(let x=0;x<m;++x){for(const t of g[x]){const{permutationIndices:e,expandDims:o}=r.backend_util.getEinsumPermutation(y,f[t]);let c;r.backend_util.isIdentityPermutation(e)?c=l[t]:(c=(0,s.m)({inputs:{x:l[t]},backend:n,attrs:{perm:e}}),b.push(c));const u=c.shape.slice();for(let t=0;t<o.length;++t)u.splice(o[t],0,1);r.util.arraysEqual(c.shape,u)||(c=(0,a.t)({inputs:{x:c},backend:n,attrs:{shape:u}}),b.push(c)),null===v?v=c:(v=(0,i.lw)({inputs:{a:c,b:v},backend:n}),b.push(v))}x<m-1&&(p[x]>=0&&(v=(0,o.c)({inputs:{x:v},backend:n,attrs:{axis:p[x]-(h.length-y),keepDims:!1}}),b.push(v)),y--)}for(const r of b)r!==v&&n.disposeIntermediateTensorInfo(r);return v}}},31050:(t,e,n)=>{"use strict";n.d(e,{J:()=>a,P:()=>i});var r=n(37837);const i=(0,n(74092).v)(r.Elu,(t=>t>=0?t:Math.exp(t)-1)),a={kernelName:r.Elu,backendName:"cpu",kernelFunc:i}},84022:(t,e,n)=>{"use strict";n.d(e,{x:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.EluGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{dy:a,y:o}=e;(0,i.C)([a,o],"eluGrad");const s=new Float32Array(r.util.sizeFromShape(o.shape)),c=n.data.get(o.dataId).values,u=n.data.get(a.dataId).values;for(let r=0;r<c.length;++r){const t=c[r];s[r]=t>=0?u[r]:u[r]*(t+1)}return n.makeTensorInfo(o.shape,"float32",s)}}},58350:(t,e,n)=>{"use strict";n.d(e,{LC:()=>s,RY:()=>c,z3:()=>o});var r=n(37837),i=n(7369),a=n(21150);const o=(0,i.Z)(((t,e)=>t===e?1:0)),s=(0,a.j)(r.Equal,o,null,"bool"),c={kernelName:r.Equal,backendName:"cpu",kernelFunc:s}},76417:(t,e,n)=>{"use strict";n.d(e,{_:()=>d});var r=n(37837),i=n(74092);const a=r.backend_util.ERF_P,o=r.backend_util.ERF_A1,s=r.backend_util.ERF_A2,c=r.backend_util.ERF_A3,u=r.backend_util.ERF_A4,l=r.backend_util.ERF_A5,h=(0,i.v)(r.Erf,(t=>{const e=Math.sign(t),n=Math.abs(t),r=1/(1+a*n);return e*(1-((((l*r+u)*r+c)*r+s)*r+o)*r*Math.exp(-n*n))})),d={kernelName:r.Erf,backendName:"cpu",kernelFunc:h}},35577:(t,e,n)=>{"use strict";n.d(e,{AC:()=>c,oN:()=>s,sG:()=>o});var r=n(37837),i=n(77199),a=n(74092);const o=(0,i.o)((t=>Math.exp(t))),s=(0,a.F)(r.Exp,o,"float32"),c={kernelName:r.Exp,backendName:"cpu",kernelFunc:s}},8139:(t,e,n)=>{"use strict";n.d(e,{U:()=>a,a:()=>o});var r=n(37837),i=n(34744);function a(t){const{inputs:e,backend:n,attrs:a}=t,{input:o}=e,{dim:s}=a,c=o.shape.length,u=o.shape.slice();let l=s;return s<0&&(r.util.assert(-(c+1)<=s,(()=>"Axis must be in the interval [".concat(-(c+1),", ").concat(c,"]"))),l=c+s+1),u.splice(l,0,1),(0,i.t)({inputs:{x:o},backend:n,attrs:{shape:u}})}const o={kernelName:r.ExpandDims,backendName:"cpu",kernelFunc:a}},24239:(t,e,n)=>{"use strict";n.d(e,{Yp:()=>c,uM:()=>o});var r=n(37837),i=n(77199),a=n(74092);const o=(0,i.o)((t=>Math.expm1(t))),s=(0,a.F)(r.Expm1,o),c={kernelName:r.Expm1,backendName:"cpu",kernelFunc:s}},91946:(t,e,n)=>{"use strict";n.d(e,{N:()=>o});var r=n(37837),i=n(95287),a=n(34744);const o={kernelName:r.FFT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:o}=e,s=r.util.sizeFromShape(o.shape),c=o.shape[o.shape.length-1],u=s/c,l=(0,a.t)({inputs:{x:o},backend:n,attrs:{shape:[u,c]}}),h=(0,i.f)(l,!1,n),d=(0,a.t)({inputs:{x:h},backend:n,attrs:{shape:o.shape}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(h),d}}},94689:(t,e,n)=>{"use strict";n.d(e,{G:()=>i,u:()=>a});var r=n(37837);function i(t){const{backend:e,attrs:n}=t,{shape:i,value:a,dtype:o}=n,s=o||r.util.inferDtype(a),c=r.util.getArrayFromDType(s,r.util.sizeFromShape(i));return function(t,e,n){t.fill(e)}(c,a),e.makeTensorInfo(i,s,c)}const a={kernelName:r.Fill,backendName:"cpu",kernelFunc:i}},23662:(t,e,n)=>{"use strict";n.d(e,{D:()=>i});var r=n(37837);const i={kernelName:r.FlipLeftRight,backendName:"cpu",kernelFunc:t=>{let{inputs:e,attrs:n,backend:i}=t;const{image:a}=e,o=i,s=r.util.getTypedArrayFromDType(a.dtype,r.util.sizeFromShape(a.shape)),[c,u,l,h]=a.shape,d=o.data.get(a.dataId).values;for(let r=0;r<c;r++){const t=r*l*u*h;for(let e=0;e<u;e++){const n=e*(l*h);for(let e=0;e<l;e++){const r=e*h;for(let i=0;i<h;i++){const a=Math.round(l-e-1),o=t+n+r+i;let c=d[o];if(a>=0&&a<l){c=d[t+n+a*h+i]}s[o]=c}}}}return{dataId:o.write(s,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}}},57688:(t,e,n)=>{"use strict";n.d(e,{Hc:()=>c,vS:()=>o});var r=n(37837),i=n(77199),a=n(74092);const o=(0,i.o)((t=>Math.floor(t))),s=(0,a.F)(r.Floor,o),c={kernelName:r.Floor,backendName:"cpu",kernelFunc:s}},81065:(t,e,n)=>{"use strict";n.d(e,{Uc:()=>c});var r=n(37837),i=n(7369),a=n(21150);const o=(0,i.Z)(((t,e)=>Math.floor(t/e))),s=(0,a.j)(r.FloorDiv,o,null,"int32"),c={kernelName:r.FloorDiv,backendName:"cpu",kernelFunc:s}},37457:(t,e,n)=>{"use strict";n.d(e,{q:()=>c});var r=n(37837),i=n(79136),a=n(75197),o=n(14284),s=n(34744);const c={kernelName:r.FusedConv2D,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:c,filter:u,bias:l,preluActivationWeights:h}=e,{strides:d,pad:f,dataFormat:p,dilations:g,dimRoundingMode:m,activation:v,leakyreluAlpha:y}=r;let b=(0,o.J)({inputs:{x:c,filter:u},backend:n,attrs:{strides:d,pad:f,dataFormat:p,dilations:g,dimRoundingMode:m}});if(l){const t=b;if("NCHW"===p&&1===l.shape.length&&1!==l.shape[0]){const t=(0,s.t)({inputs:{x:l},backend:n,attrs:{shape:[l.shape[0],1,1]}});b=(0,a.WQ)({inputs:{a:b,b:t},backend:n}),n.disposeIntermediateTensorInfo(t)}else b=(0,a.WQ)({inputs:{a:b,b:l},backend:n});n.disposeIntermediateTensorInfo(t)}if(v){const t=b;if("NCHW"===p&&"prelu"===v&&1===h.shape.length&&1!==h.shape[0]){const t=(0,s.t)({inputs:{x:h},backend:n,attrs:{shape:[h.shape[0],1,1]}});b=(0,i.f)(n,b,v,t,y),n.disposeIntermediateTensorInfo(t)}else b=(0,i.f)(n,b,v,h,y);n.disposeIntermediateTensorInfo(t)}return b}}},66320:(t,e,n)=>{"use strict";n.d(e,{l:()=>s});var r=n(37837),i=n(79136),a=n(75197),o=n(37352);const s={kernelName:r.FusedDepthwiseConv2D,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:c,bias:u,preluActivationWeights:l}=e,{strides:h,pad:d,dataFormat:f,dilations:p,dimRoundingMode:g,activation:m,leakyreluAlpha:v}=r;let y=(0,o.n)({inputs:{x:s,filter:c},backend:n,attrs:{strides:h,pad:d,dataFormat:f,dilations:p,dimRoundingMode:g}});if(u){const t=y;y=(0,a.WQ)({inputs:{a:y,b:u},backend:n}),n.disposeIntermediateTensorInfo(t)}if(m){const t=y;y=(0,i.f)(n,y,m,l,v),n.disposeIntermediateTensorInfo(t)}return y}}},35801:(t,e,n)=>{"use strict";n.d(e,{K:()=>a});var r=n(37837),i=n(89270);const a={kernelName:r.GatherNd,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{params:a,indices:o}=e,s=r.util.sizeFromShape(a.shape),c=o.shape,u=c[c.length-1],[l,h,d,f]=r.backend_util.prepareAndValidate(a,o);if(0===h)return n.makeTensorInfo(l,a.dtype,[]);const p=n.data.get(o.dataId).values,g=n.bufferSync(a),m=(0,i.q)(p,g,a.dtype,h,u,d,f,a.shape,s);return n.makeTensorInfo(l,a.dtype,m.values)}}},89270:(t,e,n)=>{"use strict";n.d(e,{q:()=>i});var r=n(37837);function i(t,e,n,i,a,o,s,c,u){const l=(0,r.buffer)([i,o],n);for(let r=0;r<i;r++){const n=[];let i=0;for(let e=0;e<a;e++){const o=t[r*a+e];i+=o*s[e],n.push(o)}if(i<0||i>=u/o)throw new Error("Invalid indices: ".concat(n," does not index into ").concat(c));for(let t=0;t<o;t++)l.values[r*o+t]=e.get(...e.indexToLoc(i*o+t))}return l}},63499:(t,e,n)=>{"use strict";n.d(e,{a:()=>s});var r=n(37837),i=n(80448),a=n(87912),o=n(34744);const s={kernelName:r.GatherV2,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:c,indices:u}=e,{axis:l,batchDims:h}=s;(0,i.C)([c,u],"gatherV2");const d=r.util.parseAxisParam(l,c.shape)[0],f=n.data.get(u.dataId).values,p=c.shape[d];for(let i=0;i<f.length;++i){const t=f[i];r.util.assert(t<=p-1&&t>=0,(()=>"GatherV2: the index value ".concat(t," is not in [0, ").concat(p-1,"]")))}let g=h;null==h&&(g=0);const m=r.util.sizeFromShape(u.shape),v=r.backend_util.segment_util.collectGatherOpShapeInfo(c,u,d,g),y=(0,o.t)({inputs:{x:c},backend:n,attrs:{shape:[v.batchSize,v.outerSize,v.dimSize,v.sliceSize]}}),b=(0,o.t)({inputs:{x:u},backend:n,attrs:{shape:[v.batchSize,m/v.batchSize]}}),x=[v.batchSize,v.outerSize,m/v.batchSize,v.sliceSize],w=n.bufferSync(b),k=n.bufferSync(y),_=(0,a.G)(k,w,x);return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),n.makeTensorInfo(v.outputShape,_.dtype,_.values)}}},87912:(t,e,n)=>{"use strict";n.d(e,{G:()=>i});var r=n(37837);function i(t,e,n){const i=(0,r.buffer)(n,t.dtype);for(let r=0;r<i.size;++r){const n=i.indexToLoc(r).slice(),a=n[0],o=n[2],s=e.locToIndex([a,o]);n[2]=e.values[s];const c=t.locToIndex(n);0<=c&&c<t.values.length&&(i.values[r]=t.values[c])}return i}},41392:(t,e,n)=>{"use strict";n.d(e,{rq:()=>o,xp:()=>c});var r=n(37837),i=n(7369),a=n(21150);const o=(0,i.Z)(((t,e)=>t>e?1:0)),s=(0,a.j)(r.Greater,o,null,"bool"),c={kernelName:r.Greater,backendName:"cpu",kernelFunc:s}},92122:(t,e,n)=>{"use strict";n.d(e,{VM:()=>c,lg:()=>o});var r=n(37837),i=n(7369),a=n(21150);const o=(0,i.Z)(((t,e)=>t>=e?1:0)),s=(0,a.j)(r.GreaterEqual,o,null,"bool"),c={kernelName:r.GreaterEqual,backendName:"cpu",kernelFunc:s}},5545:(t,e,n)=>{"use strict";n.d(e,{c:()=>o});var r=n(37837),i=n(95287),a=n(34744);const o={kernelName:r.IFFT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:o}=e,s=r.util.sizeFromShape(o.shape),c=o.shape[o.shape.length-1],u=s/c,l=(0,a.t)({inputs:{x:o},backend:n,attrs:{shape:[u,c]}}),h=(0,i.f)(l,!0,n),d=(0,a.t)({inputs:{x:h},backend:n,attrs:{shape:o.shape}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(h),d}}},94010:(t,e,n)=>{"use strict";function r(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}n.d(e,{D:()=>r,F:()=>i});const i={kernelName:n(37837).Identity,backendName:"cpu",kernelFunc:r}},14970:(t,e,n)=>{"use strict";function r(t){const{inputs:e,backend:n}=t,{input:r}=e,i=n.data.get(r.dataId).complexTensorInfos.imag,a=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,a)}n.d(e,{l:()=>i,n:()=>r});const i={kernelName:n(37837).Imag,backendName:"cpu",kernelFunc:r}},65507:(t,e,n)=>{"use strict";n.d(e,{K:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.IsFinite,(t=>Number.isFinite(t)?1:0),"bool"),a={kernelName:r.IsFinite,backendName:"cpu",kernelFunc:i}},5861:(t,e,n)=>{"use strict";n.d(e,{I:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.IsInf,(t=>Math.abs(t)===1/0?1:0),"bool"),a={kernelName:r.IsInf,backendName:"cpu",kernelFunc:i}},85115:(t,e,n)=>{"use strict";n.d(e,{I:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.IsNan,(t=>Number.isNaN(t)?1:0),"bool"),a={kernelName:r.IsNan,backendName:"cpu",kernelFunc:i}},76110:(t,e,n)=>{"use strict";n.d(e,{x:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.LRN,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{x:o}=e,{depthRadius:s,bias:c,alpha:u,beta:l}=a;(0,i.C)(o,"LRN");const h=o.shape[3],d=h-1,f=n.data.get(o.dataId).values,p=r.util.sizeFromShape(o.shape),g=new Float32Array(p);function m(t){const e=t%h;let n=t-e+Math.max(0,e-s);const r=t-e+Math.min(e+s,d);let i=0;for(;n<=r;n++){const t=f[n];i+=t*t}return i}for(let r=0;r<p;r++){const t=m(r),e=f[r]*Math.pow(c+u*t,-l);g[r]=e}return n.makeTensorInfo(o.shape,o.dtype,g)}}},31306:(t,e,n)=>{"use strict";n.d(e,{j:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.LRNGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{x:o,y:s,dy:c}=e,{depthRadius:u,bias:l,alpha:h,beta:d}=a;(0,i.C)(c,"LRNGrad");const f=r.util.sizeFromShape(c.shape),p=c.shape[3],g=n.data.get(c.dataId).values,m=n.data.get(o.dataId).values,v=n.data.get(s.dataId).values,y=new Float32Array(f),b=f;for(let r=0;r<b;r++){const t=r%p,e=r-t+Math.max(0,t-u),n=r-t+Math.min(p,t+u+1);let i=0;for(let r=e;r<n;r++)i+=Math.pow(m[r],2);i=h*i+l;for(let a=e;a<n;a++){let t=-2*h*d*m[a]*v[r]/i;r===a&&(t+=Math.pow(i,-d)),t*=g[r],y[a]+=t}}return n.makeTensorInfo(c.shape,o.dtype,y)}}},92594:(t,e,n)=>{"use strict";n.d(e,{H:()=>a,z:()=>o});var r=n(37837),i=n(80448);function a(t){const{inputs:e,backend:n,attrs:a}=t,{x:o}=e,{alpha:s}=a;(0,i.C)([o],"leakyRelu");const c=r.util.sizeFromShape(o.shape),u=n.data.get(o.dataId).values,l=r.util.getTypedArrayFromDType("float32",c);for(let r=0;r<u.length;r++)l[r]=u[r]<0?s*u[r]:u[r];return n.makeTensorInfo(o.shape,"float32",l)}const o={kernelName:r.LeakyRelu,backendName:"cpu",kernelFunc:a}},50925:(t,e,n)=>{"use strict";n.d(e,{WR:()=>o,YW:()=>c});var r=n(37837),i=n(7369),a=n(21150);const o=(0,i.Z)(((t,e)=>t<e?1:0)),s=(0,a.j)(r.Less,o,null,"bool"),c={kernelName:r.Less,backendName:"cpu",kernelFunc:s}},75337:(t,e,n)=>{"use strict";n.d(e,{Q:()=>c,cu:()=>o});var r=n(37837),i=n(7369),a=n(21150);const o=(0,i.Z)(((t,e)=>t<=e?1:0)),s=(0,a.j)(r.LessEqual,o,null,"bool"),c={kernelName:r.LessEqual,backendName:"cpu",kernelFunc:s}},31499:(t,e,n)=>{"use strict";n.d(e,{o:()=>a});var r=n(37837),i=n(18472);const a={kernelName:r.LinSpace,backendName:"cpu",kernelFunc:function(t){const{backend:e,attrs:n}=t,{start:r,stop:a,num:o}=n,s=(0,i.G)(r,a,o);return e.makeTensorInfo([s.length],"float32",s)}}},18472:(t,e,n)=>{"use strict";n.d(e,{G:()=>i});var r=n(37837);function i(t,e,n){const i=(e-t)/(n-1),a=r.util.makeZerosTypedArray(n,"float32");a[0]=t;for(let r=1;r<a.length;r++)a[r]=a[r-1]+i;return a}},13380:(t,e,n)=>{"use strict";n.d(e,{Fx:()=>c,px:()=>o});var r=n(37837),i=n(77199),a=n(74092);const o=(0,i.o)((t=>Math.log(t))),s=(0,a.F)(r.Log,o),c={kernelName:r.Log,backendName:"cpu",kernelFunc:s}},94881:(t,e,n)=>{"use strict";n.d(e,{W:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.Log1p,(t=>Math.log1p(t))),a={kernelName:r.Log1p,backendName:"cpu",kernelFunc:i}},23164:(t,e,n)=>{"use strict";n.d(e,{Vr:()=>c});var r=n(37837),i=n(7369),a=n(21150);const o=(0,i.Z)(((t,e)=>t&&e)),s=(0,a.j)(r.LogicalAnd,o,null,"bool"),c={kernelName:r.LogicalAnd,backendName:"cpu",kernelFunc:s}},90096:(t,e,n)=>{"use strict";n.d(e,{f:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.LogicalNot,(t=>t?0:1),"bool"),a={kernelName:r.LogicalNot,backendName:"cpu",kernelFunc:i}},2736:(t,e,n)=>{"use strict";n.d(e,{r:()=>c});var r=n(37837),i=n(7369),a=n(21150);const o=(0,i.Z)(((t,e)=>t||e)),s=(0,a.j)(r.LogicalOr,o,null,"bool"),c={kernelName:r.LogicalOr,backendName:"cpu",kernelFunc:s}},32012:(t,e,n)=>{"use strict";n.d(e,{T:()=>s,l:()=>c});var r=n(37837),i=n(80448),a=n(36729),o=n(95250);function s(t){const{inputs:e,backend:n,attrs:s}=t,{x:c}=e,{reductionIndices:u,keepDims:l}=s,h=n;let d=c.shape;const f=d.length,p=r.util.parseAxisParam(u,d);let g=p;const m=r.backend_util.getAxesPermutation(g,f);let v=h.data.get(c.dataId).values;if(null!=m){const t=new Array(f);for(let e=0;e<t.length;e++)t[e]=d[m[e]];v=(0,o._)(v,d,c.dtype,m,t),g=r.backend_util.getInnerMostAxes(g.length,f),d=t}(0,i.C)(c,"max"),r.backend_util.assertAxesAreInnerMostDims("max",g,f);const[y,b]=r.backend_util.computeOutAndReduceShapes(d,g),x=r.util.sizeFromShape(b),w=(0,a.j)(v,x,y,c.dtype),k=h.write(w,y,c.dtype);let _=y;if(l){_=r.backend_util.expandShapeToKeepDim(y,p)}return{dataId:k,shape:_,dtype:c.dtype}}const c={kernelName:r.Max,backendName:"cpu",kernelFunc:s}},99854:(t,e,n)=>{"use strict";n.d(e,{$:()=>s});var r=n(37837),i=n(80448),a=n(51269),o=n(94010);const s={kernelName:r.MaxPool,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:c}=e;(0,i.C)(c,"maxPool");const{filterSize:u,strides:l,pad:h,dimRoundingMode:d}=s;r.util.assert(r.backend_util.eitherStridesOrDilationsAreOne(l,1),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(l," and dilations '").concat(1,"'")));const f=r.backend_util.computePool2DInfo(c.shape,u,l,1,h,d);let p;if(1===f.filterWidth&&1===f.filterHeight&&r.util.arraysEqual(f.inShape,f.outShape))p=(0,o.D)({inputs:{x:c},backend:n});else{const t=n.data.get(c.dataId).values,e=r.util.computeStrides(c.shape),i=(0,a.dz)(t,c.shape,c.dtype,e,f,"max");p=n.makeTensorInfo(f.outShape,c.dtype,i.values)}return p}}},40917:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var r=n(37837),i=n(80448),a=n(51269);const o={kernelName:r.MaxPool3D,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:o}=t,{x:s}=e,{filterSize:c,strides:u,pad:l,dimRoundingMode:h,dataFormat:d}=o;(0,i.C)(s,"maxPool3d");const f=r.backend_util.computePool3DInfo(s.shape,c,u,1,l,h,d),p=n.data.get(s.dataId).values,g=(0,a.W_)(p,s.shape,s.dtype,r.util.computeStrides(s.shape),f,"max");return n.makeTensorInfo(g.shape,"float32",g.values)}}},96069:(t,e,n)=>{"use strict";n.d(e,{S:()=>o});var r=n(37837),i=n(80448),a=n(51269);const o={kernelName:r.MaxPool3DGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:o}=t,{dy:s,input:c}=e,{filterSize:u,strides:l,pad:h,dimRoundingMode:d}=o;(0,i.C)([s,c],"maxPool3DGrad");const f=r.backend_util.computePool3DInfo(c.shape,u,l,1,h,d),p=n.bufferSync(c),g=(0,a.qW)(p,f),m=f.strideDepth,v=f.strideHeight,y=f.strideWidth,b=f.dilationDepth,x=f.dilationHeight,w=f.dilationWidth,k=f.effectiveFilterDepth,_=f.effectiveFilterHeight,A=f.effectiveFilterWidth,C=k-1-f.padInfo.front,S=A-1-f.padInfo.left,E=_-1-f.padInfo.top,T=(0,r.buffer)(c.shape,"float32"),N=n.bufferSync(s);for(let r=0;r<f.batchSize;++r)for(let t=0;t<f.inChannels;++t)for(let e=0;e<f.inDepth;++e)for(let n=0;n<f.inHeight;++n)for(let i=0;i<f.inWidth;++i){const a=e-C,o=n-E,s=i-S;let c=0;for(let e=0;e<k;e+=b){const n=(a+e)/m;if(!(n<0||n>=f.outDepth||Math.floor(n)!==n))for(let i=0;i<_;i+=x){const a=(o+i)/v;if(!(a<0||a>=f.outHeight||Math.floor(a)!==a))for(let o=0;o<A;o+=w){const u=(s+o)/y;if(u<0||u>=f.outWidth||Math.floor(u)!==u)continue;const l=k*_*A-1-g.get(r,n,a,u,t)===e*_*A+i*A+o?1:0;if(0===l)continue;c+=N.get(r,n,a,u,t)*l}}}T.set(c,r,e,n,i,t)}return n.makeTensorInfo(T.shape,T.dtype,T.values)}}},99242:(t,e,n)=>{"use strict";n.d(e,{P:()=>o});var r=n(37837),i=n(80448),a=n(51269);const o={kernelName:r.MaxPoolGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:o}=t,{dy:s,input:c,output:u}=e,l=c;(0,i.C)([c,u],"maxPoolGrad");const{filterSize:h,strides:d,pad:f,dimRoundingMode:p}=o,g=r.backend_util.computePool2DInfo(l.shape,h,d,1,f,p),m=n.data.get(l.dataId).values,v=(0,r.buffer)(g.outShape,l.dtype,(0,a.nN)(m,l.shape,l.dtype,g).values),y=g.strideHeight,b=g.strideWidth,x=g.dilationHeight,w=g.dilationWidth,k=g.effectiveFilterHeight,_=g.effectiveFilterWidth,A=_-1-g.padInfo.left,C=k-1-g.padInfo.top,S=(0,r.buffer)(l.shape,"float32"),E=n.data.get(s.dataId).values,T=(0,r.buffer)(s.shape,"float32",E);for(let r=0;r<g.batchSize;++r)for(let t=0;t<g.inChannels;++t)for(let e=0;e<g.inHeight;++e)for(let n=0;n<g.inWidth;++n){const i=e-C,a=n-A;let o=0;for(let e=0;e<k;e+=x){const n=(i+e)/y;if(!(n<0||n>=g.outHeight||Math.floor(n)!==n))for(let i=0;i<_;i+=w){const s=(a+i)/b;if(s<0||s>=g.outWidth||Math.floor(s)!==s)continue;const c=k*_-1-v.get(r,n,s,t)===e*_+i?1:0;if(0===c)continue;o+=T.get(r,n,s,t)*c}}S.set(o,r,e,n,t)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}}},32944:(t,e,n)=>{"use strict";n.d(e,{l:()=>o});var r=n(37837),i=n(80448),a=n(15085);const o={kernelName:r.MaxPoolWithArgmax,backendName:"cpu",kernelFunc:t=>{let{inputs:e,attrs:n,backend:o}=t;const{x:s}=e,{filterSize:c,strides:u,pad:l,includeBatchInIndex:h}=n,d=o;(0,i.C)(s,"MaxPoolWithArgmax");const f=d.data.get(s.dataId).values,p=r.backend_util.computePool2DInfo(s.shape,c,u,[1,1],l),[g,m]=(0,a.b)(f,s.shape,s.dtype,h,p),v=d.write(g,p.outShape,s.dtype),y=d.write(m,p.outShape,s.dtype);return[{dataId:v,shape:p.outShape,dtype:s.dtype},{dataId:y,shape:p.outShape,dtype:"int32"}]}}},15085:(t,e,n)=>{"use strict";n.d(e,{b:()=>a});var r=n(37837),i=n(51269);function a(t,e,n,a,o){const s=r.util.computeStrides(e),c=(0,i.dz)(t,e,n,s,o,"max"),u=(0,i.nN)(t,e,n,o,!0,a);return[c.values,u.values]}},36729:(t,e,n)=>{"use strict";n.d(e,{j:()=>i});var r=n(37837);function i(t,e,n,i){const a=r.util.getTypedArrayFromDType(i,r.util.sizeFromShape(n));for(let r=0;r<a.length;++r){const n=r*e;let i=t[n];for(let r=0;r<e;++r){const e=t[n+r];(Number.isNaN(e)||e>i)&&(i=e)}a[r]=i}return a}},35572:(t,e,n)=>{"use strict";n.d(e,{He:()=>o,l9:()=>c});var r=n(37837),i=n(7369),a=n(21150);const o=(0,i.Z)(((t,e)=>Math.max(t,e))),s=(0,a.j)(r.Maximum,o),c={kernelName:r.Maximum,backendName:"cpu",kernelFunc:s}},54181:(t,e,n)=>{"use strict";n.d(e,{M:()=>s});var r=n(37837),i=n(37007),a=n(56057),o=n(62381);const s={kernelName:r.Mean,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:c}=e,{axis:u,keepDims:l}=s,h=r.util.parseAxisParam(u,c.shape),d=r.backend_util.computeOutAndReduceShapes(c.shape,h)[1],f=r.util.sizeFromShape(d),p=[],g=n.makeTensorInfo([],"float32",new Float32Array([f]));p.push(g);const m=(0,i.wg)({inputs:{x:c},backend:n,attrs:{dtype:"float32"}});p.push(m);const v=(0,a.y4)({inputs:{a:m,b:g},backend:n});p.push(v);const y=(0,o.c)({inputs:{x:v},backend:n,attrs:{axis:u,keepDims:l}});return p.forEach((t=>n.disposeIntermediateTensorInfo(t))),y}}},42786:(t,e,n)=>{"use strict";n.d(e,{j:()=>s});var r=n(37837),i=n(80448),a=n(34744),o=n(10933);const s={kernelName:r.Min,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:c}=e,{axis:u,keepDims:l}=s;(0,i.C)(c,"min");const h=r.util.parseAxisParam(u,c.shape);let d=h;const f=r.backend_util.getAxesPermutation(d,c.shape.length);let p=c;null!=f&&(p=(0,o.m)({inputs:{x:c},backend:n,attrs:{perm:f}}),d=r.backend_util.getInnerMostAxes(d.length,c.shape.length)),r.backend_util.assertAxesAreInnerMostDims("min",d,p.shape.length);const[g,m]=r.backend_util.computeOutAndReduceShapes(p.shape,d),v=r.util.sizeFromShape(m),y=r.util.makeZerosTypedArray(r.util.sizeFromShape(g),p.dtype),b=n.data.get(p.dataId).values;for(let r=0;r<y.length;++r){const t=r*v;let e=b[t];for(let n=0;n<v;++n){const r=b[t+n];(Number.isNaN(r)||r<e)&&(e=r)}y[r]=e}null!=f&&n.disposeIntermediateTensorInfo(p);const x=n.makeTensorInfo(g,p.dtype,y);if(l){const t=r.backend_util.expandShapeToKeepDim(g,h),e=(0,a.t)({inputs:{x:x},backend:n,attrs:{shape:t}});return n.disposeIntermediateTensorInfo(x),e}return x}}},24178:(t,e,n)=>{"use strict";n.d(e,{Nu:()=>c,hE:()=>o});var r=n(37837),i=n(7369),a=n(21150);const o=(0,i.Z)(((t,e)=>Math.min(t,e))),s=(0,a.j)(r.Minimum,o),c={kernelName:r.Minimum,backendName:"cpu",kernelFunc:s}},92770:(t,e,n)=>{"use strict";n.d(e,{V:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.MirrorPad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{x:o}=e,{paddings:s,mode:c}=a;(0,i.C)(o,"mirrorPad");const u=s.map(((t,e)=>t[0]+o.shape[e]+t[1])),l=s.map((t=>t[0])),h=s.map(((t,e)=>t[0]+o.shape[e])),d="reflect"===c?0:1,f=n.data.get(o.dataId).values,p=o.shape.length,g=r.util.computeStrides(o.shape),m=r.util.sizeFromShape(u),v=u.length,y=r.util.computeStrides(u),b=r.util.getTypedArrayFromDType(o.dtype,m);for(let i=0;i<m;i++){let t=r.util.indexToLoc(i,v,y);for(let n=0;n<v;n++)t[n]<l[n]?t[n]=2*l[n]-t[n]-d:t[n]>=h[n]&&(t[n]=2*(h[n]-1)-t[n]+d);t=t.map(((t,e)=>t-l[e]));const e=r.util.locToIndex(t,p,g);b[i]=f[e]}return{dataId:n.write(b,u,o.dtype),shape:u,dtype:o.dtype}}}},27846:(t,e,n)=>{"use strict";n.d(e,{XR:()=>c});var r=n(37837),i=n(7369),a=n(21150);const o=(0,i.Z)(((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e})),s=(0,a.j)(r.Mod,o),c={kernelName:r.Mod,backendName:"cpu",kernelFunc:s}},30079:(t,e,n)=>{"use strict";n.d(e,{a:()=>s});var r=n(37837),i=n(11053),a=n(80448),o=n(23008);const s={kernelName:r.Multinomial,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{logits:c}=e,{numSamples:u,seed:l,normalized:h}=s;(0,a.C)(c,"multinomial");const d=h?c:(0,o.V)({inputs:{logits:c},backend:n,attrs:{dim:-1}}),f=d.shape[0],p=d.shape[1],g=n.data.get(d.dataId).values,m=[f,u],v=r.util.makeZerosTypedArray(r.util.sizeFromShape(m),"int32");for(let r=0;r<f;++r){const t=r*p,e=new Float32Array(p-1);e[0]=g[t];for(let r=1;r<e.length;++r)e[r]=e[r-1]+g[t+r];const n=i.alea(l.toString()),a=r*u;for(let r=0;r<u;++r){const t=n();v[a+r]=e.length;for(let n=0;n<e.length;n++)if(t<e[n]){v[a+r]=n;break}}}return h||n.disposeIntermediateTensorInfo(d),n.makeTensorInfo(m,"int32",v)}}},82636:(t,e,n)=>{"use strict";n.d(e,{BF:()=>o,lw:()=>c,tJ:()=>u});var r=n(37837),i=n(7369),a=n(21150);const o=(0,i.Z)(((t,e)=>t*e)),s=(0,a.B)(((t,e,n,r)=>({real:t*n-e*r,imag:t*r+e*n}))),c=(0,a.j)(r.Multiply,o,s),u={kernelName:r.Multiply,backendName:"cpu",kernelFunc:c}},26692:(t,e,n)=>{"use strict";n.d(e,{Dk:()=>o,hd:()=>s});var r=n(37837),i=n(80448),a=n(82636);function o(t,e,n){const i=r.util.createScalarValue(-1,n);return(0,a.BF)([],e,i,t,n)}const s={kernelName:r.Neg,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e;(0,i.C)(r,"neg");const a=n.data.get(r.dataId).values,[s,c]=o(a,r.shape,r.dtype);return n.makeTensorInfo(c,r.dtype,s)}}},99767:(t,e,n)=>{"use strict";n.d(e,{m:()=>o});var r=n(37837),i=n(80448);const a=r.kernel_impls.nonMaxSuppressionV3Impl;const o={kernelName:r.NonMaxSuppressionV3,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:o,scores:s}=e,{maxOutputSize:c,iouThreshold:u,scoreThreshold:l}=r;(0,i.C)(o,"NonMaxSuppression");const h=n.data.get(o.dataId).values,d=n.data.get(s.dataId).values,{selectedIndices:f}=a(h,d,c,u,l);return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}}},24886:(t,e,n)=>{"use strict";n.d(e,{F:()=>o});var r=n(37837),i=n(80448);const a=r.kernel_impls.nonMaxSuppressionV4Impl;const o={kernelName:r.NonMaxSuppressionV4,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:o,scores:s}=e,{maxOutputSize:c,iouThreshold:u,scoreThreshold:l,padToMaxOutputSize:h}=r;(0,i.C)(o,"NonMaxSuppressionPadded");const d=n.data.get(o.dataId).values,f=n.data.get(s.dataId).values,{selectedIndices:p,validOutputs:g}=a(d,f,c,u,l,h);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([g]))]}}},53077:(t,e,n)=>{"use strict";n.d(e,{u:()=>o});var r=n(37837),i=n(80448);const a=r.kernel_impls.nonMaxSuppressionV5Impl;const o={kernelName:r.NonMaxSuppressionV5,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:o,scores:s}=e,{maxOutputSize:c,iouThreshold:u,scoreThreshold:l,softNmsSigma:h}=r;(0,i.C)(o,"NonMaxSuppressionWithScore");const d=n.data.get(o.dataId).values,f=n.data.get(s.dataId).values,p=c,g=u,m=l,v=h,{selectedIndices:y,selectedScores:b}=a(d,f,p,g,m,v);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([b.length],"float32",new Float32Array(b))]}}},64383:(t,e,n)=>{"use strict";n.d(e,{AL:()=>c,cl:()=>o});var r=n(37837),i=n(7369),a=n(21150);const o=(0,i.Z)(((t,e)=>t!==e?1:0)),s=(0,a.j)(r.NotEqual,o,null,"bool"),c={kernelName:r.NotEqual,backendName:"cpu",kernelFunc:s}},9187:(t,e,n)=>{"use strict";n.d(e,{_:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.OneHot,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{indices:o}=e,{dtype:s,depth:c,onValue:u,offValue:l}=a;(0,i.C)(o,"oneHot");const h=r.util.sizeFromShape(o.shape),d=new Float32Array(h*c);d.fill(l);const f=n.data.get(o.dataId).values;for(let r=0;r<h;++r)f[r]>=0&&f[r]<c&&(d[r*c+f[r]]=u);return n.makeTensorInfo([...o.shape,c],s,d)}}},23690:(t,e,n)=>{"use strict";n.d(e,{h:()=>u});var r=n(37837),i=n(60694),a=n(94689),o=n(14970),s=n(50280),c=n(71326);const u={kernelName:r.OnesLike,backendName:"cpu",kernelFunc:function t(e){const{inputs:n,backend:r}=e,{x:u}=n;if("string"===u.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===u.dtype){const e=(0,s.x)({inputs:{input:u},backend:r}),n=t({inputs:{x:e},backend:r}),a=(0,o.n)({inputs:{input:u},backend:r}),l=(0,c.P)({inputs:{x:a},backend:r}),h=(0,i.f)({inputs:{real:n,imag:l},backend:r});return r.disposeIntermediateTensorInfo(e),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),h}return(0,a.G)({backend:r,attrs:{shape:u.shape,value:1,dtype:u.dtype}})}}},18197:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o,q:()=>s});var r=n(37837),i=n(21244),a=n(8139);function o(t){const{inputs:e,backend:n,attrs:o}=t,{axis:s}=o;if(1===e.length)return(0,a.U)({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const c=e[0].shape,u=e[0].dtype;e.forEach((t=>{r.util.assertShapesMatch(c,t.shape,"All tensors passed to stack must have matching shapes"),r.util.assert(u===t.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const l=[],h=e.map((t=>{const e=(0,a.U)({inputs:{input:t},backend:n,attrs:{dim:s}});return l.push(e),e})),d=(0,i.x)({inputs:h,backend:n,attrs:{axis:s}});return l.forEach((t=>n.disposeIntermediateTensorInfo(t))),d}const s={kernelName:r.Pack,backendName:"cpu",kernelFunc:o}},6319:(t,e,n)=>{"use strict";n.d(e,{e:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.PadV2,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{x:o}=e,{paddings:s,constantValue:c}=a;(0,i.C)(o,"pad");const u=s.map(((t,e)=>t[0]+o.shape[e]+t[1])),l=s.map((t=>t[0])),h=n.data.get(o.dataId).values,d=r.util.sizeFromShape(o.shape),f=o.shape.length,p=r.util.computeStrides(o.shape),g=r.util.sizeFromShape(u),m=u.length,v=r.util.computeStrides(u),y=r.util.getTypedArrayFromDType(o.dtype,g);0!==c&&y.fill(c);for(let i=0;i<d;i++){const t=r.util.indexToLoc(i,f,p).map(((t,e)=>t+l[e]));y[r.util.locToIndex(t,m,v)]=h[i]}return{dataId:n.write(y,u,o.dtype),shape:u,dtype:o.dtype}}}},90312:(t,e,n)=>{"use strict";n.d(e,{j6:()=>c});var r=n(37837),i=n(7369),a=n(21150);const o=(0,i.Z)(((t,e)=>Math.pow(t,e))),s=(0,a.j)(r.Pow,o),c={kernelName:r.Pow,backendName:"cpu",kernelFunc:s}},12728:(t,e,n)=>{"use strict";n.d(e,{H:()=>s,N:()=>o});var r=n(37837),i=n(80448);const a=(0,n(7369).Z)(((t,e)=>t<0?e*t:t));function o(t){const{inputs:e,backend:n}=t,{x:r,alpha:o}=e;(0,i.C)([r,o],"prelu");const s=n.data.get(r.dataId).values,c=n.data.get(o.dataId).values,[u,l]=a(r.shape,o.shape,s,c,"float32");return n.makeTensorInfo(l,"float32",u)}const s={kernelName:r.Prelu,backendName:"cpu",kernelFunc:o}},67097:(t,e,n)=>{"use strict";n.d(e,{S3:()=>s,_B:()=>o});var r=n(37837),i=n(80448),a=n(10933);function o(t,e,n,i){const[a,o]=r.backend_util.computeOutAndReduceShapes(t,i),s=(0,r.upcastType)(e,"int32"),c=r.util.makeZerosTypedArray(r.util.sizeFromShape(a),s),u=r.util.sizeFromShape(o);for(let r=0;r<c.length;++r){const t=r*u;let e=1;for(let r=0;r<u;++r)e*=n[t+r];c[r]=e}return{outVals:c,outShape:a,outDtype:s}}const s={kernelName:r.Prod,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:c}=e,{axis:u,keepDims:l}=s;(0,i.C)(c,"prod");const h=c.shape.length,d=r.util.parseAxisParam(u,c.shape),f=r.backend_util.getAxesPermutation(d,h);let p=d,g=c;const m=[];null!=f&&(g=(0,a.m)({inputs:{x:c},backend:n,attrs:{perm:f}}),m.push(g),p=r.backend_util.getInnerMostAxes(p.length,h));const v=n.data.get(g.dataId).values,{outVals:y,outShape:b,outDtype:x}=o(g.shape,g.dtype,v,p);let w=b;return l&&(w=r.backend_util.expandShapeToKeepDim(b,d)),m.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.makeTensorInfo(w,x,y)}}},13137:(t,e,n)=>{"use strict";n.d(e,{i:()=>a});var r=n(37837),i=n(8990);const a={kernelName:r.RaggedGather,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:a,paramsDenseValues:o,indices:s}=e,{outputRaggedRank:c}=r,u=a.map((t=>n.data.get(t.dataId).values)),l=a.map((t=>t.shape)),h=n.data.get(o.dataId).values,d=n.data.get(s.dataId).values,[f,p,g]=(0,i.u)(u,l,h,o.shape,o.dtype,d,s.shape,c),m=f.map((t=>n.makeTensorInfo([t.length],"int32",t))),v=n.makeTensorInfo(g,o.dtype,p);return m.concat([v])}}},8990:(t,e,n)=>{"use strict";n.d(e,{u:()=>s});var r=n(37837);function i(t,e,n,r){const i=[];let a=0;const o=e.length-1+n.length,s=new Array(o).fill(null).map((()=>[0]));!function(t,e){for(let n=0;n<t.length;++n){const r=t[n],i=n===t.length-1?e:t[n+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>i)throw new Error("Ragged splits must not point past values");for(let t=1;t<r.length;++t)if(r[t-1]>r[t])throw new Error("Ragged splits must be sorted in ascending order")}}(n,r);let c=1;for(let u=0;u<e.length-1;++u){c*=e[u];const t=e[u+1];for(let e=1;e<c+1;++e)s[u].push(e*t)}for(let u=0;u<t.length;++u){let r=t[u],o=t[u]+1;for(let t=0;t<n.length;++t){const i=n[t],a=t+e.length-1;if(a>=0){const t=s[a],e=t[t.length-1]-i[r];for(let n=r;n<o;++n)s[a].push(i[n+1]+e)}r=i[r],o=i[o]}o!==r&&(i.push([r,o]),a+=o-r)}return{outSplits:s,valueSlices:i,numValues:a}}function a(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function o(t,e,n,i,o){const s=e.slice();s[0]=o;const c=r.util.getArrayFromDType(n,r.util.sizeFromShape(s)),u=t.length;return function(t,e,n,r,i,o){const s=a(e,2)[1],c=a(o,2)[1];let u=0;for(const a of n)for(let e=a[0];e<a[1];++e){for(let n=0;n<r;++n)i[u*c+n]=t[e*s+n];++u}}(t,e,i,0===u?0:u/e[0],c,s),[c,s]}function s(t,e,n,a,s,c,u,l){if(0===t.length)throw new Error("paramsNestedSplits must be non empty");if(0===e[0].length)throw new Error("Split tensors must not be scalars");if(function(t,e,n){t.forEach(((t,i)=>{if(t<0||t>=n){const a=r.util.indexToLoc(i,e.length,r.util.computeStrides(e)).join(",");throw new Error("indices[".concat(a,"] = ").concat(t," is not in [0, ").concat(n,")"))}}))}(c,u,e[0][0]-1),0===a.length)throw new Error("params.rank must be nonzero");const h=a[0],{outSplits:d,valueSlices:f,numValues:p}=i(c,u,t,h),g=function(t){const e=[];for(let n=0;n<t.length;++n){const i=t[n].length,a=r.util.getArrayFromDType("int32",i);e.push(a),t[n].forEach(((t,e)=>a[e]=t))}return e}(d),m=o(n,a,s,f,p);return[g,m[0],m[1]]}},97545:(t,e,n)=>{"use strict";n.d(e,{Y:()=>a});var r=n(37837),i=n(57126);const a={kernelName:r.RaggedRange,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{starts:r,limits:a,deltas:o}=e,s=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,u=n.data.get(o.dataId).values,[l,h]=(0,i._)(s,r.shape,r.dtype,c,a.shape,u,o.shape);return[n.makeTensorInfo([l.length],"int32",l),n.makeTensorInfo([h.length],r.dtype,h)]}}},57126:(t,e,n)=>{"use strict";n.d(e,{_:()=>a});var r=n(37837);const i=2147483647;function a(t,e,n,a,o,s,c){if(e.length>1)throw new Error("starts must be a scalar or vector");if(o.length>1)throw new Error("limits must be a scalar or vector");if(c.length>1)throw new Error("deltas must be a scalar or vector");const u=0===e.length,l=0===o.length,h=0===c.length,d=[];u||d.push(e[0]),l||d.push(o[0]),h||d.push(c[0]);for(let r=1;r<d.length;++r)if(d[r]!==d[r-1])throw new Error("starts, limits, and deltas must have the same shape");const f=0===d.length?1:d[0],p=r.util.getArrayFromDType("int32",f+1);p[0]=0;for(let r=0;r<f;++r){const e=u?t[0]:t[r],n=l?a[0]:a[r],o=h?s[0]:s[r];if(0===o)throw new Error("Requires delta != 0");let c;if(o>0&&n<e||o<0&&n>e)c=0;else if(c=Math.ceil(Math.abs((n-e)/o)),c>i)throw new Error("Requires ((limit - start) / delta) <= ".concat(i));p[r+1]=p[r]+c}const g=p[f],m=r.util.getArrayFromDType(n,g);let v=0;for(let r=0;r<f;++r){const e=p[r+1]-p[r];let n=u?t[0]:t[r];const i=h?s[0]:s[r];for(let t=0;t<e;++t)m[v++]=n,n+=i}return[p,m]}},24375:(t,e,n)=>{"use strict";n.d(e,{g:()=>a});var r=n(37837),i=n(22868);const a={kernelName:r.RaggedTensorToTensor,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{shape:a,values:o,defaultValue:s,rowPartitionTensors:c}=e,{rowPartitionTypes:u}=r,l=n.data.get(a.dataId).values,h=n.data.get(o.dataId).values,d=n.data.get(s.dataId).values,f=c.map((t=>n.data.get(t.dataId).values)),p=c.map((t=>t.shape)),[g,m]=(0,i.K)(l,a.shape,h,o.shape,o.dtype,d,s.shape,f,p,u);return n.makeTensorInfo(g,o.dtype,m)}}},22868:(t,e,n)=>{"use strict";n.d(e,{K:()=>c});var r=n(37837),i=r.backend_util.RowPartitionType;class a{constructor(t,e,n,i,a,o,s,c,u,l){this.shape=t,this.shapeShape=e,this.values=n,this.valuesShape=i,this.valuesDType=a,this.defaultValue=o,this.defaultValueShape=s,this.rowPartitionValues=c,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=r.backend_util.getRowPartitionTypesHelper(l),this.raggedRank=r.backend_util.getRaggedRank(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===i.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===i.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){const e=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case i.VALUE_ROWIDS:return a.getMaxWidthValueRowID(e);case i.ROW_SPLITS:return a.getMaxWidthRowSplit(e);default:throw new Error("Cannot handle partition type ".concat(i[this.getRowPartitionTypeByDimension(t-1)]))}}static getMaxWidthRowSplit(t){const e=t.length;if(0===e||1===e)return 0;let n=0;for(let r=0;r<e-1;++r){const e=t[r+1]-t[r];e>n&&(n=e)}return n}static getMaxWidthValueRowID(t){const e=t.length;if(0===e)return 0;let n=0,r=t[0],i=0;for(let a=1;a<e;++a){const e=t[a];e!==r&&(r=e,i=Math.max(a-n,i),n=a)}return Math.max(e-n,i)}tensorShapeFromTensor(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===e.length){if(-1===t[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return s(t,n)}calculateOutputSize(t){const e=this.valuesShape,n=this.defaultValueShape;r.backend_util.validateDefaultValueShape(n,e);const i=this.tensorShapeFromTensor(this.shape,this.shapeShape),a=r.backend_util.combineRaggedTensorToTensorShapes(this.raggedRank,i,e);a[0]<0&&(a[0]=t);for(let r=1;r<=this.raggedRank;++r)a[r]<0&&(a[r]=this.getMaxWidth(r));return a}calculateFirstParentOutputIndex(t,e,n){const i=Math.min(t,n),a=[];let o=0;for(let r=0;r<i;++r,o+=e)a.push(o);for(let r=i;r<t;++r)a.push(-1);return r.util.assert(a.length===t,(()=>"Final length of result must be equal to firstDimension.")),a}calculateOutputIndexRowSplit(t,e,n,r){const i=t.length,a=[];for(let o=0;o<i-1;++o){const i=t[o+1]-t[o];let s=Math.min(r,i),c=e[o];-1===c&&(s=0);for(let t=0;t<s;++t)a.push(c),c+=n;for(let t=0;t<i-s;++t)a.push(-1)}if(i>0&&a.length!==t[i-1])throw new Error("Invalid row split size.");return a}calculateOutputIndexValueRowID(t,e,n,r){const i=t.length,a=[];if(0===i)return[];let o=0,s=t[0];if(s>=e.length)throw new Error("Got currentValueRowId=".concat(s,", which is not less than ").concat(e.length));let c=e[s];a.push(c);for(let u=1;u<i;++u){const i=t[u];if(i===s)c>=0&&(++o,o<r?c+=n:c=-1);else{if(o=0,s=i,i>=e.length)throw new Error("Got nextValueRowId=".concat(i," which is not less than ").concat(e.length));c=e[i]}a.push(c)}if(a.length!==t.length)throw new Error("Invalid row ids.");return a}calculateOutputIndex(t,e,n,r){const a=this.getRowPartitionTensor(t),o=this.getRowPartitionTypeByDimension(t);switch(o){case i.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,e,n,r);case i.ROW_SPLITS:if(a.length-1>e.length)throw new Error("Row partition size is greater than output size: ".concat(a.length-1," > ").concat(e.length));return this.calculateOutputIndexRowSplit(a,e,n,r);default:throw new Error("Unsupported partition type: ".concat(i[o]))}}getFirstDimensionSize(){const t=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");const e=this.rowPartitionTypes[0];switch(e){case i.FIRST_DIM_SIZE:return t[0];case i.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case i.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type ".concat(i[e]))}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),e=this.calculateOutputSize(t),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(let r=n.length-2;r>=0;--r)n[r]=n[r+1]*e[r+1];const i=s(e,!1),a=r.util.getArrayFromDType(this.valuesDType,r.util.sizeFromShape(i));if(n[0]*e[0]>0){let r=this.calculateFirstParentOutputIndex(t,n[0],e[0]);for(let t=1;t<=this.raggedRank;++t){r=this.calculateOutputIndex(t-1,r,n[t],e[t])}this.setOutput(this.raggedRank,r,a,i)}return[i,a]}setOutput(t,e,n,i){if(0===n.length)return;const a=this.values,s=n;let c=i.slice();c=c.slice(t+1);const u=r.util.sizeFromShape(c),l=e.length;let h=this.defaultValue;if(h.length!==u&&1!==h.length){const t=this.defaultValueShape;(0,r.tidy)((()=>{const e=(0,r.reshape)(h,t),n=(0,r.broadcastTo)(e,c);h=n.dataSync()}))}let d=0,f=0,p=0;for(let r=0;r<=l;++r){let t=r<l?e[r]:-1;if(t!==p){if(f<p){const t=a.subarray(d*u);o(s.subarray(f*u),t,(p-f)*u)}if(r>=l){const e=n.length;t=Math.floor(e/u)}if(t>p)if(1===this.defaultValue.length)s.subarray(p*u,t*u).fill(this.defaultValue[0]),p=t;else for(;t>p;){o(s.slice(p*u),h,u),++p}t<0?(d=r+1,f=p):(d=r,f=p,p=f+1)}else++p}}}function o(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function s(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error("Dimension ".concat(r," must be >= 0"));if(r<-1)throw new Error("Dimension ".concat(r," must be >= -1"));r=-1}n.push(r)}return n}function c(t,e,n,r,i,o,s,c,u,l){return new a(t,e,n,r,i,o,s,c,u,l).compute()}},45139:(t,e,n)=>{"use strict";n.d(e,{i:()=>a});var r=n(37837),i=n(31040);const a={kernelName:r.Range,backendName:"cpu",kernelFunc:function(t){const{backend:e,attrs:n}=t,{start:r,stop:a,dtype:o,step:s}=n,c=(0,i.q)(r,a,s,o);return e.makeTensorInfo([c.length],o,c)}}},31040:(t,e,n)=>{"use strict";n.d(e,{q:()=>i});var r=n(37837);function i(t,e,n,i){if(t===e||t<e&&n<0||e<t&&n>1)return r.util.makeZerosTypedArray(0,i);const a=Math.abs(Math.ceil((e-t)/n)),o=r.util.makeZerosTypedArray(a,i);e<t&&1===n&&(n=-1),o[0]=t;for(let r=1;r<o.length;r++)o[r]=o[r-1]+n;return o}},50280:(t,e,n)=>{"use strict";function r(t){const{inputs:e,backend:n}=t,{input:r}=e,i=n.data.get(r.dataId).complexTensorInfos.real,a=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,a)}n.d(e,{r:()=>i,x:()=>r});const i={kernelName:n(37837).Real,backendName:"cpu",kernelFunc:r}},56057:(t,e,n)=>{"use strict";n.d(e,{GN:()=>c,y4:()=>s});var r=n(37837),i=n(7369),a=n(21150);const o=(0,i.Z)(((t,e)=>t/e)),s=(0,a.j)(r.RealDiv,o),c={kernelName:r.RealDiv,backendName:"cpu",kernelFunc:s}},91848:(t,e,n)=>{"use strict";n.d(e,{l:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.Reciprocal,(t=>1/t)),a={kernelName:r.Reciprocal,backendName:"cpu",kernelFunc:i}},42666:(t,e,n)=>{"use strict";n.d(e,{V:()=>i,z:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.Relu,(t=>Math.max(0,t))),a={kernelName:r.Relu,backendName:"cpu",kernelFunc:i}},24758:(t,e,n)=>{"use strict";n.d(e,{X:()=>a,j:()=>i});var r=n(37837);const i=(0,n(74092).v)(r.Relu6,(t=>Math.min(Math.max(0,t),6))),a={kernelName:r.Relu6,backendName:"cpu",kernelFunc:i}},34744:(t,e,n)=>{"use strict";n.d(e,{V:()=>a,t:()=>i});var r=n(37837);function i(t){const{inputs:e,backend:n,attrs:i}=t,{x:a}=e,{shape:o}=i,s=r.util.sizeFromShape(a.shape),c=r.util.inferFromImplicitShape(o,s),u=r.util.sizeFromShape(c);r.util.assert(s===u,(()=>"The new shape (".concat(c,") has ").concat(u," elements and the old ")+"shape (".concat(a.shape,") has ").concat(s," elements. The new shape and old ")+"shape must have the same number of elements.")),n.incRef(a.dataId);const l=n.data.get(a.dataId);if(null!=l.complexTensorInfos){const t=l.complexTensorInfos.real,e=l.complexTensorInfos.imag;t.shape=c,e.shape=c}return{dataId:a.dataId,shape:c,dtype:a.dtype}}const a={kernelName:r.Reshape,backendName:"cpu",kernelFunc:i}},72728:(t,e,n)=>{"use strict";n.d(e,{T:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.ResizeBilinear,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{images:o}=e,{alignCorners:s,halfPixelCenters:c,size:u}=a;(0,i.C)(o,"resizeBilinear");const l=r.util.computeStrides(o.shape),[h,d]=u,[f,p,g,m]=o.shape,v=n.data.get(o.dataId).values,y=new Float32Array(r.util.sizeFromShape([f,h,d,m])),b=[s&&h>1?p-1:p,s&&d>1?g-1:g],x=[s&&h>1?h-1:h,s&&d>1?d-1:d];let w=0;const k=b[0]/x[0],_=b[1]/x[1];for(let r=0;r<f;r++)for(let t=0;t<h;t++){let e;e=c?k*(t+.5)-.5:k*t;const n=Math.max(0,Math.floor(e)),i=e-n,a=Math.min(p-1,Math.ceil(e)),o=r*l[0]+n*l[1],s=r*l[0]+a*l[1];for(let t=0;t<d;t++){let e;e=c?_*(t+.5)-.5:_*t;const n=Math.max(0,Math.floor(e)),r=e-n,a=Math.min(g-1,Math.ceil(e)),u=o+n*l[2],h=s+n*l[2],d=o+a*l[2],f=s+a*l[2];for(let t=0;t<m;t++){const e=v[u+t],n=v[h+t],a=e+(v[d+t]-e)*r,o=a+(n+(v[f+t]-n)*r-a)*i;y[w++]=o}}}return n.makeTensorInfo([f,h,d,m],"float32",y)}}},71660:(t,e,n)=>{"use strict";n.d(e,{j:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.ResizeBilinearGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{images:o,dy:s}=e,{alignCorners:c}=a;(0,i.C)([s,o],"resizeBilinearGrad");const u=r.util.computeStrides(o.shape),[l,h,d,f]=o.shape,[,p,g]=s.shape,m=new Float32Array(l*h*d*f),v=[c&&p>1?h-1:h,c&&g>1?d-1:d],y=[c&&p>1?p-1:p,c&&g>1?g-1:g],b=v[0]/y[0],x=v[1]/y[1],w=n.data.get(s.dataId).values;let k=0;for(let r=0;r<l;r++){const t=r*u[0];for(let e=0;e<p;e++){const n=e*b,r=Math.floor(n),i=Math.min(Math.ceil(n),h-1),a=t+r*u[1],o=t+i*u[1],s=n-r,c=1-s;for(let t=0;t<g;t++){const e=t*x,n=Math.floor(e),r=Math.min(Math.ceil(e),d-1),i=e-n,l=1-i,h=a+n*u[2],p=a+r*u[2],g=o+n*u[2],v=o+r*u[2],y=c*l,b=c*i,_=s*l,A=s*i;for(let t=0;t<f;t++){const e=w[k++];m[h+t]+=e*y,m[p+t]+=e*b,m[g+t]+=e*_,m[v+t]+=e*A}}}}return n.makeTensorInfo([l,d,h,f],"float32",m)}}},82078:(t,e,n)=>{"use strict";n.d(e,{j:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.ResizeNearestNeighbor,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{images:o}=e,{alignCorners:s,halfPixelCenters:c,size:u}=a;(0,i.C)(o,"resizeNearestNeighbor");const l=r.util.computeStrides(o.shape),[h,d]=u,[f,p,g,m]=o.shape,v=n.data.get(o.dataId).values,y=new Float32Array(f*h*d*m),b=[s&&h>1?p-1:p,s&&d>1?g-1:g],x=[s&&h>1?h-1:h,s&&d>1?d-1:d],w=b[0]/x[0],k=b[1]/x[1];let _=0;for(let r=0;r<f;r++){const t=r*l[0];for(let e=0;e<h;e++){const n=c?w*(e+.5):w*e;let r=Math.min(p-1,s?Math.round(n):Math.floor(n));c&&(r=Math.max(0,r));const i=t+r*l[1];for(let t=0;t<d;t++){const e=c?k*(t+.5):k*t;let n=Math.min(g-1,s?Math.round(e):Math.floor(e));c&&(n=Math.max(0,n));const r=i+n*l[2];for(let t=0;t<m;t++){const e=v[r+t];y[_++]=e}}}}return n.makeTensorInfo([f,h,d,m],o.dtype,y)}}},6682:(t,e,n)=>{"use strict";n.d(e,{n:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.ResizeNearestNeighborGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{images:o,dy:s}=e,{alignCorners:c}=a;(0,i.C)([s,o],"resizeNearestNeighborGrad");const u=r.util.computeStrides(o.shape),l=r.util.computeStrides(s.shape),[h,d,f,p]=o.shape,[,g,m]=s.shape,v=new Float32Array(h*d*f*p),y=n.data.get(s.dataId).values,b=[c&&g>1?d-1:d,c&&m>1?f-1:f],x=[c&&g>1?g-1:g,c&&m>1?m-1:m],w=b[0]/x[0],k=b[1]/x[1],_=1/w,A=1/k,C=2*Math.ceil(_)+2,S=2*Math.ceil(A)+2;for(let r=0;r<h;r++){const t=r*u[0];for(let e=0;e<d;e++){const n=t+e*u[1],r=Math.floor(e*_),i=Math.floor(r-C/2);for(let a=0;a<f;a++){const r=n+a*u[2],o=Math.floor(a*A),s=Math.floor(o-S/2);for(let n=0;n<p;n++){let o=0;for(let r=0;r<C;r++){const u=r+i;if(u<0||u>=g)continue;const h=t+u*l[1],p=u*w;if(e===Math.min(d-1,c?Math.round(p):Math.floor(p)))for(let t=0;t<S;t++){const e=t+s;if(e<0||e>=m)continue;const r=h+e*l[2],i=e*k;a===Math.min(f-1,c?Math.round(i):Math.floor(i))&&(o+=y[r+n])}}v[r+n]=o}}}}return n.makeTensorInfo(o.shape,o.dtype,v)}}},11600:(t,e,n)=>{"use strict";n.d(e,{r:()=>o});var r=n(37837),i=n(80448),a=n(94010);const o={kernelName:r.Reverse,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:o}=t,{x:s}=e,{dims:c}=o;(0,i.C)(s,"reverse");const u=s.shape.length,l=r.util.parseAxisParam(c,s.shape);if(0===u)return(0,a.D)({inputs:{x:s},backend:n});const h=new r.TensorBuffer(s.shape,s.dtype),d=n.bufferSync(s);for(let r=0;r<h.size;r++){const t=h.indexToLoc(r),e=t.slice();l.forEach((t=>e[t]=s.shape[t]-1-e[t])),h.set(d.get(...e),...t)}return n.makeTensorInfo(h.shape,h.dtype,h.values)}}},39804:(t,e,n)=>{"use strict";n.d(e,{f:()=>i});var r=n(37837);const i={kernelName:r.RotateWithOffset,backendName:"cpu",kernelFunc:t=>{let{inputs:e,attrs:n,backend:i}=t;const{image:a}=e,{radians:o,fillValue:s,center:c}=n,u=i,l=r.util.getTypedArrayFromDType(a.dtype,r.util.sizeFromShape(a.shape)),[h,d,f,p]=a.shape,[g,m]=r.backend_util.getImageCenter(c,d,f),v=Math.sin(o),y=Math.cos(o),b=u.data.get(a.dataId).values;for(let r=0;r<h;r++){const t=r*f*d*p;for(let e=0;e<d;e++){const n=e*(f*p);for(let r=0;r<f;r++){const i=r*p;for(let a=0;a<p;a++){const o=[h,e,r,a],c=o[2],u=o[1];let x=(c-g)*y-(u-m)*v,w=(c-g)*v+(u-m)*y;x=Math.round(x+g),w=Math.round(w+m);let k=s;if("number"!==typeof s&&(k=3===a?255:s[a]),x>=0&&x<f&&w>=0&&w<d){k=b[t+w*(f*p)+x*p+a]}l[t+n+i+a]=k}}}}return{dataId:u.write(l,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}}},47182:(t,e,n)=>{"use strict";n.d(e,{$:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.Round,(t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1})),a={kernelName:r.Round,backendName:"cpu",kernelFunc:i}},47410:(t,e,n)=>{"use strict";n.d(e,{Lt:()=>c,Zy:()=>o});var r=n(37837),i=n(77199),a=n(74092);const o=(0,i.o)((t=>1/Math.sqrt(t))),s=(0,a.F)(r.Rsqrt,o),c={kernelName:r.Rsqrt,backendName:"cpu",kernelFunc:s}},35690:(t,e,n)=>{"use strict";n.d(e,{H:()=>a});var r=n(37837),i=n(55949);const a={kernelName:r.ScatterNd,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{indices:o,updates:s}=e,{shape:c}=a,{sliceRank:u,numUpdates:l,sliceSize:h,strides:d,outputSize:f}=r.backend_util.calculateShapes(s,o,c),p=n.bufferSync(o),g=n.bufferSync(s),m=(0,i.b)(p,g,c,f,h,l,u,d,0,!0);return n.makeTensorInfo(c,m.dtype,m.values)}}},55949:(t,e,n)=>{"use strict";n.d(e,{b:()=>i});var r=n(37837);function i(t,e,n,i,a,o,s,c,u,l){const h=[i/a,a],d=t.values,f=e.values;if(0===i)return(0,r.buffer)(n,e.dtype);const p=u instanceof r.TensorBuffer?u:(0,r.buffer)(h,e.dtype);"string"===typeof u||"number"===typeof u?p.values.fill(u):"boolean"===typeof u&&p.values.fill(+u);for(let r=0;r<o;r++){const t=[];let o=0;for(let e=0;e<s;e++){const n=d[r*s+e];t.push(n),o+=n*c[e]}if(o<0||o>=i/a)throw new Error("Invalid indices: ".concat(t," does not index into ").concat(n));for(let n=0;n<a;n++)l?p.values[o*a+n]+=f[r*a+n]:p.values[o*a+n]=0===e.rank?f[0]:f[r*a+n]}return p}},30097:(t,e,n)=>{"use strict";n.d(e,{M:()=>a});var r=n(37837),i=n(96734);const a={kernelName:r.SearchSorted,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:a,values:o}=e,{side:s}=r,c=n.data.get(a.dataId).values,u=n.data.get(o.dataId).values,l=(0,i.C)(c,u,a.shape[0],a.shape[1],o.shape[1],s);return n.makeTensorInfo(o.shape,"int32",l)}}},96734:(t,e,n)=>{"use strict";n.d(e,{C:()=>o});var r=n(37837);function i(t,e){let n=0,r=t.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),t[i]<e?n=i+1:r=i;return r}function a(t,e){let n=0,r=t.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),t[i]<=e?n=i+1:r=i;return r}function o(t,e,n,o,s,c){const u=r.util.getArrayFromDType("int32",n*s);for(let r=0;r<n;++r){const n=t.slice(r*o,(r+1)*o),l=r*s;for(let t=0;t<s;++t)u[l+t]="left"===c?i(n,e[t+l]):a(n,e[t+l])}return u}},68116:(t,e,n)=>{"use strict";n.d(e,{z:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.Select,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{condition:a,t:o,e:s}=e;(0,i.C)([a,o,s],"select");const c=a.shape.length,u=n.data.get(a.dataId).values,l=n.data.get(o.dataId).values,h=n.data.get(s.dataId).values,d=(0,r.upcastType)(o.dtype,s.dtype),f=r.util.makeZerosTypedArray(r.util.sizeFromShape(o.shape),d);let p=0;const g=0===c||c>1||1===o.shape.length?1:r.util.sizeFromShape(o.shape.slice(1));for(let r=0;r<u.length;r++)for(let t=0;t<g;t++)1===u[r]?f[p++]=l[r]:f[p++]=h[r];return n.makeTensorInfo(o.shape,d,f)}}},4407:(t,e,n)=>{"use strict";n.d(e,{k:()=>c});var r=n(37837),i=n(74092);const a=r.backend_util.SELU_SCALEALPHA,o=r.backend_util.SELU_SCALE,s=(0,i.v)(r.Selu,(t=>t>=0?o*t:a*(Math.exp(t)-1))),c={kernelName:r.Selu,backendName:"cpu",kernelFunc:s}},83094:(t,e,n)=>{"use strict";n.d(e,{X3:()=>c,ry:()=>s,zv:()=>o});var r=n(37837),i=n(77199),a=n(74092);const o=(0,i.o)((t=>1/(1+Math.exp(-t)))),s=(0,a.v)(r.Sigmoid,(t=>1/(1+Math.exp(-t)))),c={kernelName:r.Sigmoid,backendName:"cpu",kernelFunc:s}},89285:(t,e,n)=>{"use strict";n.d(e,{C:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.Sign,(t=>t<0?-1:t>0?1:0)),a={kernelName:r.Sign,backendName:"cpu",kernelFunc:i}},13432:(t,e,n)=>{"use strict";n.d(e,{b:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.Sin,(t=>Math.sin(t))),a={kernelName:r.Sin,backendName:"cpu",kernelFunc:i}},85586:(t,e,n)=>{"use strict";n.d(e,{$:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.Sinh,(t=>Math.sinh(t))),a={kernelName:r.Sinh,backendName:"cpu",kernelFunc:i}},80844:(t,e,n)=>{"use strict";n.d(e,{HS:()=>a,di:()=>o,lv:()=>s});var r=n(37837),i=n(80448);function a(t,e,n,i,a){const o=r.slice_util.isSliceContinous(i,e,n),s=r.util.sizeFromShape(n),c=r.util.computeStrides(i);if(o){const n=r.slice_util.computeFlatOffset(e,c);return"string"===a?t.slice(n,n+s):t.subarray(n,n+s)}const u="string"===a?r.backend_util.fromUint8ToStringArray(t):t,l=(0,r.buffer)(i,a,u),h=(0,r.buffer)(n,a);for(let r=0;r<h.size;++r){const t=h.indexToLoc(r),n=t.map(((t,n)=>t+e[n]));h.set(l.get(...n),...t)}return"string"===a?r.backend_util.fromStringArrayToUint8(h.values):h.values}function o(t){const{inputs:e,backend:n,attrs:o}=t,{x:s}=e,{begin:c,size:u}=o;(0,i.C)(s,"slice");const[l,h]=r.slice_util.parseSliceParams(s,c,u);r.slice_util.assertParamsValid(s,l,h);const d=a(n.data.get(s.dataId).values,l,h,s.shape,s.dtype);return n.makeTensorInfo(h,s.dtype,d)}const s={kernelName:r.Slice,backendName:"cpu",kernelFunc:o}},23008:(t,e,n)=>{"use strict";n.d(e,{$:()=>h,V:()=>l});var r=n(37837),i=n(35577),a=n(32012),o=n(56057),s=n(34744),c=n(28400),u=n(62381);function l(t){const{inputs:e,backend:n,attrs:l}=t,{logits:h}=e,{dim:d}=l,f=h.shape.length;let p=d;if(-1===p&&(p=f-1),p!==f-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(f," and dim was ").concat(p));const g=r.util.parseAxisParam([p],h.shape),m=(0,a.T)({inputs:{x:h},backend:n,attrs:{reductionIndices:g,keepDims:!1}}),v=r.backend_util.expandShapeToKeepDim(m.shape,g),y=(0,s.t)({inputs:{x:m},backend:n,attrs:{shape:v}}),b=(0,c.jb)({inputs:{a:h,b:y},backend:n}),x=(0,i.oN)({inputs:{x:b},backend:n}),w=(0,u.c)({inputs:{x:x},backend:n,attrs:{axis:g,keepDims:!1}}),k=(0,s.t)({inputs:{x:w},backend:n,attrs:{shape:v}}),_=(0,o.y4)({inputs:{a:x,b:k},backend:n});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(k),_}const h={kernelName:r.Softmax,backendName:"cpu",kernelFunc:l}},60164:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(37837),i=n(74092);const a=Math.log(1.1920928955078125e-7)+2,o=(0,i.v)(r.Softplus,(t=>{const e=t>-a,n=t<a,r=Math.exp(t);let i;return i=n?r:e?t:Math.log(1+r),i})),s={kernelName:r.Softplus,backendName:"cpu",kernelFunc:o}},74359:(t,e,n)=>{"use strict";n.d(e,{W:()=>c});var r=n(37837),i=n(80448),a=n(6319),o=n(34744),s=n(10933);const c={kernelName:r.SpaceToBatchND,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:c}=t,{x:u}=e,{blockShape:l,paddings:h}=c;(0,i.C)([u],"spaceToBatchND");const d=r.util.sizeFromShape(l),f=[[0,0]];f.push(...h);for(let r=1+l.length;r<u.shape.length;++r)f.push([0,0]);const p=a.e.kernelFunc({inputs:{x:u},backend:n,attrs:{paddings:f,constantValue:0}}),g=r.backend_util.getReshaped(p.shape,l,d,!1),m=r.backend_util.getPermuted(g.length,l.length,!1),v=r.backend_util.getReshapedPermuted(p.shape,l,d,!1),y={x:p},b={shape:g},x=(0,o.t)({inputs:y,backend:n,attrs:b}),w={x:x},k={perm:m},_=(0,s.m)({inputs:w,backend:n,attrs:k}),A={x:_},C={shape:v},S=(0,o.t)({inputs:A,backend:n,attrs:C});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(_),S}}},27901:(t,e,n)=>{"use strict";n.d(e,{K:()=>a});var r=n(37837),i=n(62282);const a={kernelName:r.SparseFillEmptyRows,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{indices:r,values:a,denseShape:o,defaultValue:s}=e;if(1!==o.shape.length)throw new Error("Dense shape must be a vector, saw:\n        ".concat(o.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n        ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n        ".concat(a.shape));if(0!==s.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(s.shape));const c=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,l=n.data.get(o.dataId).values,h=n.data.get(s.dataId).values[0],[d,f,p,g,m]=(0,i.y)(c,r.shape,r.dtype,u,a.dtype,l,h);return[n.makeTensorInfo(f,r.dtype,d),n.makeTensorInfo([f[0]],a.dtype,p),n.makeTensorInfo([g.length],"bool",new Uint8Array(g.map((t=>Number(t))))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}}},62282:(t,e,n)=>{"use strict";n.d(e,{y:()=>i});var r=n(37837);function i(t,e,n,i,a,o,s){const c=e[0],u=o[0],l=new Array(u),h=new Array(c),d=e[1];if(0===u){if(0!==c)throw new Error(r.backend_util.getSparseFillEmptyRowsIndicesDenseShapeMismatch(c));return[r.util.getArrayFromDType(n,0),[0,d],r.util.getArrayFromDType(a,0),l,h]}let f=!0,p=0;const g=new Array(u).fill(0);for(let v=0;v<c;++v){const e=t[v*d];if(e<0)throw new Error(r.backend_util.getSparseFillEmptyRowsNegativeIndexErrorMessage(v,e));if(e>=u)throw new Error(r.backend_util.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(v,e,u));++g[e],f=f&&e>=p,p=e}let m=!0;for(let r=0;r<u;++r){const t=0===g[r];l[r]=t,m=m&&!t,g[r]=Math.max(g[r],1),r>0&&(g[r]+=g[r-1])}if(m&&f){const e=t,n=i;for(let t=0;t<c;++t)h[t]=t;return[e,[c,d],n,l,h]}{const e=g[u-1],o=r.util.getArrayFromDType(n,e*d),f=r.util.getArrayFromDType(a,e),p=new Array(u).fill(0);for(let n=0;n<c;++n){const e=t[n*d],r=p[e],a=(0===e?0:g[e-1])+r;p[e]++;for(let i=0;i<d;++i)o[a*d+i]=t[n*d+i];f[a]=i[n],h[n]=a}for(let t=0;t<u;++t){if(0===p[t]){const e=0===t?0:g[t-1];o[e*d+0]=t;for(let t=1;t<d;++t)o[e*d+t]=0;f[e]=s}}return[o,[e,d],f,l,h]}}},29748:(t,e,n)=>{"use strict";n.d(e,{F:()=>a});var r=n(37837),i=n(77681);const a={kernelName:r.SparseReshape,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:a,newShape:o}=e;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape\n        ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape\n        ".concat(a.shape));if(1!==o.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(o.shape));const s=Array.from(n.data.get(a.dataId).values),c=n.data.get(r.dataId).values,u=Array.from(n.data.get(o.dataId).values),[l,h,d]=(0,i.l)(c,r.shape,r.dtype,s,u);return[n.makeTensorInfo(h,r.dtype,l),n.makeTensorInfo([d.length],o.dtype,new Int32Array(d))]}}},77681:(t,e,n)=>{"use strict";n.d(e,{l:()=>i});var r=n(37837);function i(t,e,n,i,a){const o=r.util.sizeFromShape(i),s=e[0],c=a.length,u=[];let l=1,h=-1;for(let m=0;m<c;++m){const t=a[m];if(-1===t){if(-1!==h)throw new Error(r.backend_util.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(h,m));h=m,u.push(1)}else{if(t<0)throw new Error(r.backend_util.getSparseReshapeNegativeOutputDimErrorMessage(m,t));l*=t,u.push(t)}}if(-1!==h){if(l<=0)throw new Error(r.backend_util.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());const t=Math.trunc(o/l);if(l*t!==o)throw new Error(r.backend_util.getSparseReshapeInputOutputMultipleErrorMessage(i,u));u[h]=t}if(r.util.sizeFromShape(u)!==o)throw new Error(r.backend_util.getSparseReshapeInputOutputMismatchErrorMessage(i,u));const d=i.length,f=[];if(d>0){f[d-1]=1;for(let t=d-2;t>=0;--t)f[t]=f[t+1]*i[t+1]}const p=[];if(c>0){p[c-1]=1;for(let t=c-2;t>=0;--t)p[t]=p[t+1]*u[t+1]}const g=r.util.getArrayFromDType(n,s*c);for(let r=0;r<s;++r){let e=0;for(let n=0;n<d;++n)e+=t[r*d+n]*f[n];for(let t=0;t<c;++t)g[r*c+t]=Math.trunc(e/p[t]),e%=p[t]}return[g,[s,c],u]}},10950:(t,e,n)=>{"use strict";n.d(e,{v:()=>a});var r=n(37837),i=n(13363);const a={kernelName:r.SparseSegmentMean,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n          ".concat(a.shape));if(1!==o.shape.length)throw new Error("Segment ids should be a vector but received shape\n          ".concat(o.shape));if(a.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const s=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,u=n.data.get(o.dataId).values,[l,h]=(0,i.z)(s,r.shape,r.dtype,c,u,!0);return n.makeTensorInfo(h,r.dtype,l)}}},13363:(t,e,n)=>{"use strict";n.d(e,{z:()=>i});var r=n(37837);function i(t,e,n,i,a){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;const c=i.length,u=[e[0],t.length/e[0]],l=u[1],h=c>0?a[c-1]+1:0;if(h<0)throw new Error(r.backend_util.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());const d=e.slice();d[0]=h;const f=d.reduce(((t,e)=>t*e),1),p=r.util.getArrayFromDType(n,f);if(0===c)return h>0&&p.fill(s),[p,d];if(h<=0)throw new Error(r.backend_util.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let g=0,m=1,v=0,y=a[g];for(;;){let e=0;if(m<c){if(e=a[m],y===e){++m;continue}if(y>=e)throw new Error(r.backend_util.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(y<0||y>=h)throw new Error(r.backend_util.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(y,h));y>v&&p.fill(s,v*l,y*l);for(let n=g;n<m;++n){const e=i[n];if(e<0||e>=u[0])throw new Error(r.backend_util.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(n,i[n],u[0]));for(let n=0;n<l;n++)p[y*l+n]+=t[e*l+n]}if(o)for(let t=0;t<l;t++)p[y*l+t]/=m-g;if(g=m,++m,v=y+1,y=e,m>c)break}return v<h&&p.fill(s,v*l,h*l),[p,d]}},9660:(t,e,n)=>{"use strict";n.d(e,{j:()=>a});var r=n(37837),i=n(13363);const a={kernelName:r.SparseSegmentSum,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n         ".concat(a.shape));if(1!==o.shape.length)throw new Error("Segment ids should be a vector but received shape\n         ".concat(o.shape));if(a.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const s=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,u=n.data.get(o.dataId).values,[l,h]=(0,i.z)(s,r.shape,r.dtype,c,u);return n.makeTensorInfo(h,r.dtype,l)}}},99750:(t,e,n)=>{"use strict";n.d(e,{x:()=>a});var r=n(37837),i=n(55949);const a={kernelName:r.SparseToDense,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{sparseIndices:o,sparseValues:s,defaultValue:c}=e,{outputShape:u}=a,{sliceRank:l,numUpdates:h,sliceSize:d,strides:f,outputSize:p}=r.backend_util.calculateShapes(s,o,u),g=!1,m=n.bufferSync(o);let v;switch(s.dtype){case"bool":{const t=n.bufferSync(s),e=Boolean(n.data.get(c.dataId).values[0]);v=(0,i.b)(m,t,u,p,d,h,l,f,e,g);break}case"float32":{const t=n.bufferSync(s),e=n.data.get(c.dataId).values[0];v=(0,i.b)(m,t,u,p,d,h,l,f,e,g);break}case"int32":{const t=n.bufferSync(s),e=n.data.get(c.dataId).values[0];v=(0,i.b)(m,t,u,p,d,h,l,f,e,g);break}case"string":{const t=n.bufferSync(s),e=r.util.decodeString(n.data.get(c.dataId).values[0]);v=(0,i.b)(m,t,u,p,d,h,l,f,e,g);break}default:throw new Error("Unsupported type ".concat(s.dtype))}return n.makeTensorInfo(u,v.dtype,v.values)}}},27370:(t,e,n)=>{"use strict";n.d(e,{t:()=>a});var r=n(37837),i=n(80844);const a={kernelName:r.SplitV,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{x:o}=e,{numOrSizeSplits:s,axis:c}=a,u=r.util.parseAxisParam(c,o.shape)[0],l=r.backend_util.prepareSplitSize(o,s,u),h=new Array(o.shape.length).fill(0),d=o.shape.slice();return l.map((t=>{const e=[...d];e[u]=t;const r=(0,i.di)({inputs:{x:o},backend:n,attrs:{begin:h,size:e}});return h[u]+=t,r}))}}},41010:(t,e,n)=>{"use strict";n.d(e,{Fu:()=>c,x6:()=>o});var r=n(37837),i=n(77199),a=n(74092);const o=(0,i.o)((t=>Math.sqrt(t))),s=(0,a.v)(r.Sqrt,(t=>Math.sqrt(t))),c={kernelName:r.Sqrt,backendName:"cpu",kernelFunc:s}},93055:(t,e,n)=>{"use strict";n.d(e,{e:()=>a});var r=n(37837),i=n(80448);const a={kernelName:r.Square,backendName:"cpu",kernelFunc:t=>{let{inputs:e,backend:n}=t;const{x:r}=e,a=n;(0,i.C)(r,"square");const o=a.data.get(r.dataId).values,s=new Float32Array(o.length);for(let i=0;i<o.length;++i){const t=o[i];s[i]=t*t}return{dataId:a.write(s,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}}},11404:(t,e,n)=>{"use strict";n.d(e,{b2:()=>c});var r=n(37837),i=n(7369),a=n(21150);const o=(0,i.Z)(((t,e)=>{const n=t-e;return n*n})),s=(0,a.j)(r.SquaredDifference,o),c={kernelName:r.SquaredDifference,backendName:"cpu",kernelFunc:s}},57943:(t,e,n)=>{"use strict";n.d(e,{C:()=>c,_:()=>o});var r=n(37837),i=n(77199),a=n(74092);const o=(0,i.o)(((t,e)=>{const{pattern:n,replaceGlobal:r,rewrite:i}=e;return t.replace(new RegExp(n,r?"g":""),i)})),s=(0,a.F)(r.StaticRegexReplace,o),c={kernelName:r.StaticRegexReplace,backendName:"cpu",kernelFunc:s}},98726:(t,e,n)=>{"use strict";n.d(e,{t:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.Step,((t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha})),a={kernelName:r.Step,backendName:"cpu",kernelFunc:i}},10407:(t,e,n)=>{"use strict";n.d(e,{c:()=>c});var r=n(37837),i=n(80448),a=n(34744),o=n(80844),s=n(16100);const c={kernelName:r.StridedSlice,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:c}=t,{x:u}=e,{begin:l,end:h,strides:d,beginMask:f,endMask:p,ellipsisMask:g,newAxisMask:m,shrinkAxisMask:v}=c;(0,i.C)(u,"stridedSlice");const{finalShapeSparse:y,finalShape:b,isIdentity:x,sliceDim0:w,isSimpleSlice:k,begin:_,end:A,strides:C}=r.slice_util.sliceInfo(u.shape,l,h,d,f,p,g,m,v);let S;if(x)S=(0,a.t)({inputs:{x:u},backend:n,attrs:{shape:b}});else if(w||k){r.util.assert(u.shape.length>=1,(()=>"Input must have rank at least 1, got: ".concat(u.shape.length)));const t=r.slice_util.computeOutShape(_,A,C),e=(0,o.di)({inputs:{x:u},backend:n,attrs:{begin:_,size:t}});S=(0,a.t)({inputs:{x:e},backend:n,attrs:{shape:b}}),n.disposeIntermediateTensorInfo(e)}else{const t=n.bufferSync(u),e=(0,s.e)(y,t,C,_);S=n.makeTensorInfo(b,e.dtype,e.values)}return S}}},16100:(t,e,n)=>{"use strict";n.d(e,{e:()=>i});var r=n(37837);function i(t,e,n,i){const a=(0,r.buffer)(t,e.dtype);for(let r=0;r<a.size;r++){const t=a.indexToLoc(r),o=new Array(t.length);for(let e=0;e<o.length;e++)o[e]=t[e]*n[e]+i[e];a.set(e.get(...o),...t)}return a}},54307:(t,e,n)=>{"use strict";n.d(e,{Q:()=>a});var r=n(37837),i=n(6192);const a={kernelName:r.StringNGrams,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{separator:a,nGramWidths:o,leftPad:s,rightPad:c,padWidth:u,preserveShortSequences:l}=r,{data:h,dataSplits:d}=e,f=n.data.get(h.dataId).values,p=n.data.get(d.dataId).values,[g,m]=(0,i.G)(f,p,a,o,s,c,u,l);return[n.makeTensorInfo([g.length],"string",g),n.makeTensorInfo(d.shape,"int32",m)]}}},6192:(t,e,n)=>{"use strict";n.d(e,{G:()=>a});var r=n(37837);class i{constructor(t,e,n,i,a,o){this.separator=r.util.encodeString(t),this.nGramWidths=e,this.leftPad=r.util.encodeString(n),this.rightPad=r.util.encodeString(i),this.padWidth=a,this.preserveShort=o}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,e){const n=this.getPadWidth(e);return Math.max(0,t+2*n-e+1)}createNGrams(t,e,n,r,i,a){for(let o=0;o<i;++o){const s=this.getPadWidth(a),c=Math.max(0,s-o),u=Math.max(0,s-(i-(o+1))),l=a-(c+u),h=e+(c>0?0:o-s);let d=0;d+=c*this.leftPad.length;for(let e=0;e<l;++e)d+=t[h+e].length;d+=u*this.rightPad.length;d+=(c+u+l-1)*this.separator.length,n[r+o]=new Uint8Array(d);const f=n[r+o];let p=0;const g=t=>t.forEach((t=>f[p++]=t));for(let t=0;t<c;++t)g(this.leftPad),g(this.separator);for(let e=0;e<l-1;++e)g(t[h+e]),g(this.separator);if(l>0){g(t[h+l-1]);for(let t=0;t<u;++t)g(this.separator),g(this.rightPad)}else{for(let t=0;t<u-1;++t)g(this.rightPad),g(this.separator);g(this.rightPad)}}}compute(t,e){const n=t.length,i=e.length;if(i>0){let t=e[0];if(0!==t)throw new Error("First split value must be 0, got ".concat(t));for(let r=1;r<i;++r){let i=e[r]>=t;if(i=i&&e[r]<=n,!i)throw new Error("Invalid split value ".concat(e[r],", must be in [").concat(t,", ").concat(n,"]"));t=e[r]}if(t!==n)throw new Error("Last split value must be data size. Expected ".concat(n,", got ").concat(t))}const a=i-1,o=r.util.getArrayFromDType("int32",i);if(0===n||0===i){const t=new Array(n);for(let e=0;e<=a;++e)o[e]=0;return[t,o]}o[0]=0;for(let r=1;r<=a;++r){const t=e[r]-e[r-1];let n=0;this.nGramWidths.forEach((e=>{n+=this.getNumNGrams(t,e)})),this.preserveShort&&t>0&&0===n&&(n=1),o[r]=o[r-1]+n}const s=new Array(o[a]);for(let r=0;r<a;++r){const n=e[r];let i=o[r];if(this.nGramWidths.forEach((a=>{const o=e[r+1]-e[r],c=this.getNumNGrams(o,a);this.createNGrams(t,n,s,i,c,a),i+=c})),this.preserveShort&&i===o[r]){const a=e[r+1]-e[r];if(0===a)continue;const o=a+2*this.padWidth,c=1;this.createNGrams(t,n,s,i,c,o)}}return[s,o]}}function a(t,e,n,r,a,o,s,c){return new i(n,r,a,o,s,c).compute(t,e)}},50981:(t,e,n)=>{"use strict";n.d(e,{o:()=>a});var r=n(37837),i=n(13410);const a={kernelName:r.StringSplit,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:a}=r,{input:o,delimiter:s}=e;if("string"!==o.dtype)throw new Error("Input must be of datatype string");if(1!==o.shape.length)throw new Error("Input must be a vector, got shape: ".concat(o.shape));if(0!==s.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(s.shape));const c=n.data.get(o.dataId).values,u=n.data.get(s.dataId).values[0],[l,h,d]=(0,i.S)(c,u,a),f=h.length;return[n.makeTensorInfo([f,2],"int32",l),n.makeTensorInfo([f],"string",h),n.makeTensorInfo([2],"int32",new Int32Array(d))]}}},13410:(t,e,n)=>{"use strict";n.d(e,{S:()=>a});var r=n(37837);function i(t,e,n,r){if(!t.length)return;if(0===e.length){for(let e=0;e<t.length;++e)r.push(t.subarray(e,e+1));return}if(1===e.length){const i=e[0];let a=t.indexOf(i);for(;-1!==a;){const e=t.subarray(0,a);n&&0===e.length||r.push(e),a=(t=t.subarray(a+1)).indexOf(i)}return void(n&&0===t.length||r.push(t))}let i=0;for(let a=0;a<t.length+1;a++)if(a===t.length||-1!==e.indexOf(t[a])){const e=t.subarray(i,a);n&&0===e.length||r.push(e),i=a+1}}function a(t,e,n){const a=t.length,o=[];let s=0,c=0;const u=new Array(a);for(let r=0;r<a;++r){const a=o.length;i(t[r],e,n,o);const l=o.length-a;u[r]=l,s+=l,c=Math.max(c,l)}const l=r.util.getArrayFromDType("int32",2*s),h=new Array(s),d=[a,c];let f=0;for(let r=0;r<a;++r)for(let t=0;t<u[r];++t)l[2*f]=r,l[2*f+1]=t,h[f]=o[f],++f;return[l,h,d]}},2444:(t,e,n)=>{"use strict";n.d(e,{J:()=>a});var r=n(37837),i=n(96633);const a={kernelName:r.StringToHashBucketFast,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:a}=r,{input:o}=e;if("string"!==o.dtype)throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const s=n.data.get(o.dataId).values,c=(0,i.f)(s,a);return n.makeTensorInfo(o.shape,"int32",c)}}},96633:(t,e,n)=>{"use strict";n.d(e,{f:()=>i});var r=n(37837);function i(t,e){const n=r.util.getArrayFromDType("int32",t.length);for(let i=0;i<t.length;++i)n[i]=r.util.fingerPrint64(t[i]).modulo(e).getLowBitsUnsigned();return n}},28400:(t,e,n)=>{"use strict";n.d(e,{Zl:()=>u,dl:()=>o,jb:()=>c});var r=n(37837),i=n(7369),a=n(21150);const o=(0,i.Z)(((t,e)=>t-e)),s=(0,a.B)(((t,e,n,r)=>({real:t-n,imag:e-r}))),c=(0,a.j)(r.Sub,o,s),u={kernelName:r.Sub,backendName:"cpu",kernelFunc:c}},62381:(t,e,n)=>{"use strict";n.d(e,{c:()=>l,q:()=>h});var r=n(37837),i=n(80448),a=n(94883),o=n(37007),s=n(94010),c=n(34744),u=n(10933);function l(t){const{inputs:e,backend:n,attrs:l}=t,{x:h}=e,{axis:d,keepDims:f}=l;let p;(0,i.C)(h,"sum"),p="bool"===h.dtype?(0,o.wg)({inputs:{x:h},backend:n,attrs:{dtype:"int32"}}):(0,s.D)({inputs:{x:h},backend:n});const g=p.shape.length,m=r.util.parseAxisParam(d,p.shape),v=r.backend_util.getAxesPermutation(m,g);let y=m,b=p;null!=v&&(b=(0,u.m)({inputs:{x:p},backend:n,attrs:{perm:v}}),y=r.backend_util.getInnerMostAxes(y.length,g)),r.backend_util.assertAxesAreInnerMostDims("sum",y,b.shape.length);const[x,w]=r.backend_util.computeOutAndReduceShapes(b.shape,y),k=r.backend_util.upcastType(b.dtype,"int32");let _=(0,a.U)(n,x,k);const A=r.util.sizeFromShape(w),C=n.data.get(_.dataId).values,S=n.data.get(b.dataId).values;for(let r=0;r<C.length;++r){const t=r*A;let e=0;for(let n=0;n<A;++n)e+=S[t+n];C[r]=e}if(f){const t=r.backend_util.expandShapeToKeepDim(_.shape,m),e=_;_=(0,c.t)({inputs:{x:_},backend:n,attrs:{shape:t}}),n.disposeIntermediateTensorInfo(e)}return n.disposeIntermediateTensorInfo(p),null!=v&&n.disposeIntermediateTensorInfo(b),_}const h={kernelName:r.Sum,backendName:"cpu",kernelFunc:l}},54861:(t,e,n)=>{"use strict";n.d(e,{W:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.Tan,(t=>Math.tan(t))),a={kernelName:r.Tan,backendName:"cpu",kernelFunc:i}},84009:(t,e,n)=>{"use strict";n.d(e,{i:()=>a});var r=n(37837);const i=(0,n(74092).v)(r.Tanh,(t=>Math.tanh(t))),a={kernelName:r.Tanh,backendName:"cpu",kernelFunc:i}},34222:(t,e,n)=>{"use strict";n.d(e,{B:()=>a});var r=n(37837),i=n(55949);const a={kernelName:r.TensorScatterUpdate,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{tensor:a,indices:o,updates:s}=e,{sliceRank:c,numUpdates:u,sliceSize:l,strides:h,outputSize:d}=r.backend_util.calculateShapes(s,o,a.shape),f=n.bufferSync(o),p=n.bufferSync(s),g=n.bufferSync(a),m=(0,i.b)(f,p,a.shape,d,l,u,c,h,g,!1);return n.makeTensorInfo(a.shape,m.dtype,m.values)}}},4832:(t,e,n)=>{"use strict";n.d(e,{n:()=>o});var r=n(37837),i=n(80448),a=n(59613);const o={kernelName:r.Tile,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{reps:s}=r;(0,i.C)(o,"tile");const c=(0,a.D)(n.bufferSync(o),s);return n.makeTensorInfo(c.shape,c.dtype,c.values)}}},59613:(t,e,n)=>{"use strict";n.d(e,{D:()=>i});var r=n(37837);function i(t,e){const n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];const i=(0,r.buffer)(n,t.dtype);for(let r=0;r<i.values.length;++r){const e=i.indexToLoc(r),n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=e[r]%t.shape[r];const a=t.locToIndex(n);i.values[r]=t.values[a]}return i}},62116:(t,e,n)=>{"use strict";n.d(e,{p:()=>o});var r=n(37837),i=n(80448),a=n(52225);const o={kernelName:r.TopK,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{k:s,sorted:c}=r;(0,i.C)(o,"topk");const u=n.data.get(o.dataId).values,[l,h]=(0,a.x)(u,o.shape,o.dtype,s,c);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(h.shape,h.dtype,h.values)]}}},52225:(t,e,n)=>{"use strict";n.d(e,{x:()=>o});var r=n(37837);const i=(t,e)=>{const n=e.value-t.value;return 0===n?t.index-e.index:n};function a(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length-1;for(;o>n;){if(o-n>600){const r=o-n+1,i=e-n+1,s=Math.log(r),c=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*c*(r-c)/r)*Math.sign(i-r/2);a(t,e,Math.max(n,Math.floor(e-i*c/r+u)),Math.min(o,Math.floor(e+(r-i)*c/r+u)))}const s=t[e];let c=n,u=o;for(r.util.swap(t,n,e),i(t[o],s)>0&&r.util.swap(t,n,o);c<u;){for(r.util.swap(t,c,u),c++,u--;i(t[c],s)<0;)c+=1;for(;i(t[u],s)>0;)u-=1}0===i(t[n],s)?r.util.swap(t,n,u):(u+=1,r.util.swap(t,u,o)),u<=e&&(n=u+1),e<=u&&(o=u-1)}}function o(t,e,n,o,s){const c=e[e.length-1],[u,l]=[t.length/c,c],h=r.util.getTypedArrayFromDType(n,u*o),d=r.util.getTypedArrayFromDType("int32",u*o);for(let r=0;r<u;r++){const e=r*l,n=t.subarray(e,e+l);let c=new Array(n.length);n.forEach(((t,e)=>c[e]={value:t,index:e})),o<c.length&&(a(c,o),c=c.slice(0,o)),s&&c.sort(i);const u=r*o,f=h.subarray(u,u+o),p=d.subarray(u,u+o);for(let t=0;t<o;t++)f[t]=c[t].value,p[t]=c[t].index}const f=e.slice();return f[f.length-1]=o,[(0,r.buffer)(f,n,h),(0,r.buffer)(f,"int32",d)]}},24098:(t,e,n)=>{"use strict";n.d(e,{N:()=>i});var r=n(37837);const i={kernelName:r.Transform,backendName:"cpu",kernelFunc:function(t){const{inputs:e,attrs:n,backend:i}=t,{image:o,transforms:u}=e,{interpolation:l,fillMode:h,fillValue:d,outputShape:f}=n,[p,g,m,v]=o.shape,[y,b]=null!=f?f:[g,m],x=[p,y,b,v],w=r.util.computeStrides(o.shape),k=w[0],_=w[1],A=w[2],C=r.util.computeStrides(x),S=C[0],E=C[1],T=C[2],N=r.util.getTypedArrayFromDType(o.dtype,r.util.sizeFromShape(x));N.fill(d);const F=i.data.get(o.dataId).values,D=i.data.get(u.dataId).values;for(let r=0;r<p;++r){const t=1===u.shape[0]?D:D.subarray(8*r,8*r+8);for(let e=0;e<y;++e)for(let n=0;n<b;++n)for(let i=0;i<v;++i){let o;const u=t[6]*n+t[7]*e+1;if(0===u)continue;const f=(t[0]*n+t[1]*e+t[2])/u,p=(t[3]*n+t[4]*e+t[5])/u,v=a(f,m,h),y=a(p,g,h);switch(l){case"nearest":o=s(F,g,m,k,_,A,r,y,v,i,d);break;case"bilinear":o=c(F,g,m,k,_,A,r,y,v,i,d);break;default:throw new Error("Error in Transform: Expect 'nearest' or "+"'bilinear', but got ".concat(l))}N[r*S+e*E+n*T+i]=o}return i.makeTensorInfo(x,o.dtype,N)}return{dataId:i.write(N,x,o.dtype),shape:o.shape,dtype:o.dtype}}};function a(t,e,n){switch(n){case"reflect":return function(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const t=2*e;n<t&&(n=t*Math.trunc(-n/t)+n),n=n<-e?n+t:-n-1}else if(n>e-1)if(e<=1)n=0;else{const t=2*e;n-=t*Math.trunc(n/t),n>=e&&(n=t-n-1)}return r.util.clamp(0,n,e-1)}(t,e);case"wrap":return function(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const t=e-1;n+=e*(Math.trunc(-n/t)+1)}else if(n>e-1)if(e<=1)n=0;else{const t=e-1;n-=e*Math.trunc(n/t)}return r.util.clamp(0,n,e-1)}(t,e);case"nearest":return function(t,e){return r.util.clamp(0,t,e-1)}(t,e);default:return function(t,e){return t}(t)}}function o(t,e,n,r,i,a,o,s,c,u,l){return 0<=s&&s<e&&0<=c&&c<n?t[o*r+s*i+c*a+u]:l}function s(t,e,n,r,i,a,s,c,u,l,h){return o(t,e,n,r,i,a,s,Math.round(c),Math.round(u),l,h)}function c(t,e,n,r,i,a,s,c,u,l,h){const d=Math.floor(c),f=Math.floor(u),p=d+1,g=f+1;return(p-c)*((g-u)*o(t,e,n,r,i,a,s,d,f,l,h)+(u-f)*o(t,e,n,r,i,a,s,d,g,l,h))+(c-d)*((g-u)*o(t,e,n,r,i,a,s,p,f,l,h)+(u-f)*o(t,e,n,r,i,a,s,p,g,l,h))}},10933:(t,e,n)=>{"use strict";n.d(e,{W:()=>s,m:()=>o});var r=n(37837),i=n(80448),a=n(95250);function o(t){const{inputs:e,attrs:n,backend:r}=t,{x:o}=e,{perm:s}=n;(0,i.C)(o,"transpose");const c=o.shape.length,u=new Array(c);for(let i=0;i<u.length;i++)u[i]=o.shape[s[i]];const l=r.data.get(o.dataId).values,h=(0,a._)(l,o.shape,o.dtype,s,u);return{dataId:r.write(h,u,o.dtype),shape:u,dtype:o.dtype}}const s={kernelName:r.Transpose,backendName:"cpu",kernelFunc:o}},95250:(t,e,n)=>{"use strict";n.d(e,{_:()=>i});var r=n(37837);function i(t,e,n,i,a){const o=e.length,s=r.util.sizeFromShape(e),c=r.util.computeStrides(e),u=r.util.computeStrides(a),l=r.util.getTypedArrayFromDType(n,r.util.sizeFromShape(a));for(let h=0;h<s;++h){const e=r.util.indexToLoc(h,o,c),n=new Array(e.length);for(let t=0;t<n.length;t++)n[t]=e[i[t]];l[r.util.locToIndex(n,o,u)]=t[h]}return l}},6171:(t,e,n)=>{"use strict";n.d(e,{a:()=>o});var r=n(37837),i=n(80448),a=n(71160);const o={kernelName:r.Unique,backendName:"cpu",kernelFunc:function(t){const{inputs:e,attrs:n,backend:r}=t,{axis:o}=n,{x:s}=e;(0,i.C)(s,"unique");const c=r.data.get(s.dataId).values,{outputValues:u,outputShape:l,indices:h}=(0,a.w)(c,o,s.shape,s.dtype);return[r.makeTensorInfo(l,s.dtype,u),r.makeTensorInfo([h.length],"int32",h)]}}},71160:(t,e,n)=>{"use strict";n.d(e,{w:()=>i});var r=n(37837);function i(t,e,n,i){const a=r.util.parseAxisParam(e,n)[0],o=[1,n[0],1];for(let r=0;r<a;r++)o[0]*=n[r];o[1]=n[a];for(let r=a+1;r<n.length;r++)o[2]*=n[r];const s=new Map,c=new Int32Array(n[a]),u=new r.TensorBuffer(o,i,t),l=[],h=1===o[0]&&1===o[2];for(let r=0;r<n[a];r++){let e;if(h)e=t[r].toString();else{const t=[];for(let e=0;e<o[0];e++)for(let n=0;n<o[2];n++)t.push(u.get(e,r,n));e=t.join(",")}const n=s.get(e);if(null!=n)c[r]=n;else{const t=s.size;s.set(e,t),c[r]=t,l.push(r)}}const d=o.slice();d[1]=s.size;const f=new r.TensorBuffer(d,i);l.forEach(((t,e)=>{for(let n=0;n<o[0];n++)for(let r=0;r<o[2];r++)f.set(u.get(n,t,r),n,e,r)}));const p=n.slice();return p[a]=d[1],{outputValues:f.values,outputShape:p,indices:c}}},98866:(t,e,n)=>{"use strict";n.d(e,{B:()=>o});var r=n(37837),i=n(34744),a=n(80844);const o={kernelName:r.Unpack,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{value:o}=e;let{axis:s}=r;s<0&&(s+=o.shape.length);const c=o.shape.length,u=o.shape[s],l=new Array(c-1);let h=0;for(let i=0;i<c;i++)i!==s&&(l[h++]=o.shape[i]);const d=new Array(c).fill(0),f=o.shape.slice();f[s]=1;const p=new Array(u);for(let g=0;g<p.length;g++){d[s]=g;const t=(0,a.di)({inputs:{x:o},backend:n,attrs:{begin:d,size:f}});p[g]=(0,i.t)({inputs:{x:t},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(t)}return p}}},99490:(t,e,n)=>{"use strict";n.d(e,{b:()=>h});var r=n(37837),i=n(80448),a=n(37007),o=n(58350),s=n(8139),c=n(82636),u=n(18197),l=n(62381);const h={kernelName:r.UnsortedSegmentSum,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:h}=t,{x:d,segmentIds:f}=e,{numSegments:p}=h;(0,i.C)(d,"unsortedSegmentSum");const g=[],m=[],v=d.shape.length-f.shape.length;let y=f;for(let r=0;r<v;++r){const t=(0,s.U)({inputs:{input:y},backend:n,attrs:{dim:r+1}});y=t,m.push(t)}for(let i=0;i<p;++i){const t=r.util.createScalarValue(i,"int32"),e=n.makeTensorInfo([],"int32",t),s=(0,o.LC)({inputs:{a:e,b:y},backend:n}),u=(0,a.wg)({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),h=(0,c.lw)({inputs:{a:u,b:d},backend:n}),f=(0,l.c)({inputs:{x:h},backend:n,attrs:{axis:0,keepDims:!1}});g.push(f),m.push(e),m.push(s),m.push(u),m.push(h),m.push(f)}const b=(0,u.Z)({inputs:g,backend:n,attrs:{axis:0}});return m.forEach((t=>n.disposeIntermediateTensorInfo(t))),b}}},71326:(t,e,n)=>{"use strict";n.d(e,{P:()=>c,Z:()=>u});var r=n(37837),i=n(60694),a=n(94689),o=n(14970),s=n(50280);function c(t){const{inputs:e,backend:n}=t,{x:r}=e;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){const t=(0,s.x)({inputs:{input:r},backend:n}),e=c({inputs:{x:t},backend:n}),a=(0,o.n)({inputs:{input:r},backend:n}),u=c({inputs:{x:a},backend:n}),l=(0,i.f)({inputs:{real:e,imag:u},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(u),l}return(0,a.G)({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const u={kernelName:r.ZerosLike,backendName:"cpu",kernelFunc:c}},1348:(t,e,n)=>{"use strict";n.d(e,{l:()=>s});var r=n(37837),i=n(79136),a=n(75197),o=n(38718);const s={kernelName:r._FusedMatMul,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:c,bias:u,preluActivationWeights:l}=e,{transposeA:h,transposeB:d,activation:f,leakyreluAlpha:p}=r;let g,m,v;const y=[];g=(0,o.N)({inputs:{a:s,b:c},attrs:{transposeA:h,transposeB:d},backend:n}),u&&(m=(0,a.WQ)({inputs:{a:g,b:u},backend:n}),y.push(g),g=m),f&&(v=(0,i.f)(n,g,f,l,p),y.push(g),g=v);for(const i of y)n.disposeIntermediateTensorInfo(i);return g}}},74351:(t,e,n)=>{"use strict";var r=n(37837),i=n(1348),a=n(14906),o=n(29758),s=n(99588),c=n(75197),u=n(34643),l=n(28013),h=n(88020),d=n(58482),f=n(73980),p=n(58343),g=n(82439),m=n(77510),v=n(76590),y=n(15532),b=n(23412),x=n(66591),w=n(52087),k=n(49304),_=n(38718),A=n(57096),C=n(19923),S=n(58648),E=n(87488),T=n(19540),N=n(37007),F=n(56729),D=n(9658),I=n(60694),M=n(99176),O=n(21244),R=n(14284),z=n(64120),B=n(53060),L=n(75145),P=n(4141),j=n(57379),U=n(13753),W=n(84125),V=n(2293),q=n(87308),G=n(48190),H=n(45749),Y=n(58866),X=n(37352),K=n(51484),Q=n(18360),Z=n(9795),$=n(72580),J=n(91920),tt=n(84204),et=n(80470),nt=n(86811),rt=n(31050),it=n(84022),at=n(58350),ot=n(76417),st=n(35577),ct=n(8139),ut=n(24239),lt=n(91946),ht=n(94689),dt=n(23662),ft=n(57688),pt=n(81065),gt=n(37457),mt=n(66320),vt=n(35801),yt=n(63499),bt=n(41392),xt=n(92122),wt=n(94010),kt=n(5545),_t=n(14970),At=n(65507),Ct=n(5861),St=n(85115),Et=n(92594),Tt=n(50925),Nt=n(75337),Ft=n(31499),Dt=n(13380),It=n(94881),Mt=n(23164),Ot=n(90096),Rt=n(2736),zt=n(76110),Bt=n(31306),Lt=n(32012),Pt=n(35572),jt=n(99854),Ut=n(40917),Wt=n(96069),Vt=n(99242),qt=n(32944),Gt=n(54181),Ht=n(42786),Yt=n(24178),Xt=n(92770),Kt=n(27846),Qt=n(30079),Zt=n(82636),$t=n(26692),Jt=n(99767),te=n(24886),ee=n(53077),ne=n(64383),re=n(9187),ie=n(23690),ae=n(18197),oe=n(6319),se=n(90312),ce=n(12728),ue=n(67097),le=n(13137),he=n(97545),de=n(24375),fe=n(45139),pe=n(50280),ge=n(56057),me=n(91848),ve=n(42666),ye=n(24758),be=n(34744),xe=n(72728),we=n(71660),ke=n(82078),_e=n(6682),Ae=n(11600),Ce=n(39804),Se=n(47182),Ee=n(47410),Te=n(35690),Ne=n(30097),Fe=n(68116),De=n(4407),Ie=n(83094),Me=n(89285),Oe=n(13432),Re=n(85586),ze=n(80844),Be=n(23008),Le=n(60164),Pe=n(74359),je=n(27901),Ue=n(29748),We=n(10950),Ve=n(9660),qe=n(99750),Ge=n(27370),He=n(41010),Ye=n(93055),Xe=n(11404),Ke=n(57943),Qe=n(98726),Ze=n(10407),$e=n(54307),Je=n(50981),tn=n(2444),en=n(28400),nn=n(62381),rn=n(54861),an=n(84009),on=n(34222),sn=n(4832),cn=n(62116),un=n(24098),ln=n(10933),hn=n(6171),dn=n(98866),fn=n(99490),pn=n(71326);const gn=[i.l,a.lO,o.t,s.D,c.UK,u.y,l.k,h.l,d.n,f.l,p.S,g.M,m.L,v.rL,y.l,b.R,x.O,w.m,k.$,_.X,A.V,C.e,S.l,E.LY,T.N,N.Ml,F.uf,D.F,I.v,M.t,O.V,R.x,z.r,B.f,L.i,P.i,j.e,U.o,W.k,V.O,q.T,G.$,H.Y,Y.R,X.v,K.n,Q.V,Z.O,$.F,J.N,tt.b,et.b,nt._,rt.J,it.x,at.RY,ot._,st.AC,ct.a,ut.Yp,lt.N,ht.u,dt.D,ft.Hc,pt.Uc,gt.q,mt.l,vt.K,yt.a,bt.xp,xt.VM,wt.F,kt.c,_t.l,At.K,Ct.I,St.I,Et.z,Tt.YW,Nt.Q,Ft.o,Dt.Fx,It.W,Mt.Vr,Ot.f,Rt.r,zt.x,Bt.j,Lt.l,Pt.l9,jt.$,Ut.A,Wt.S,Vt.P,qt.l,Gt.M,Ht.j,Yt.Nu,Xt.V,Kt.XR,Qt.a,Zt.tJ,$t.hd,Jt.m,te.F,ee.u,ne.AL,re._,ie.h,ae.q,oe.e,se.j6,ce.H,ue.S3,le.i,he.Y,de.g,fe.i,pe.r,ge.GN,me.l,ve.z,ye.X,be.V,xe.T,we.j,ke.j,_e.n,Ae.r,Ce.f,Se.$,Ee.Lt,Te.H,Ne.M,Fe.z,De.k,Ie.X3,Me.C,Oe.b,Re.$,ze.lv,Be.$,Le.Z,Pe.W,je.K,Ue.F,We.v,Ve.j,qe.x,Ge.t,He.Fu,Ye.e,Xe.b2,Ke.C,Qe.t,Ze.c,$e.Q,Je.o,tn.J,en.Zl,nn.q,rn.W,an.i,on.B,sn.n,cn.p,un.N,ln.W,hn.a,dn.B,fn.b,pn.Z];for(const mn of gn)(0,r.registerKernel)(mn)},36214:(t,e,n)=>{"use strict";n.d(e,{addImpl:()=>i.mx,bincountImpl:()=>a.X,bincountReduceImpl:()=>a.N,bitwiseAndImpl:()=>o.f6,castImpl:()=>s.ct,ceilImpl:()=>c.YG,concatImpl:()=>u.h,equalImpl:()=>l.z3,expImpl:()=>h.sG,expm1Impl:()=>d.uM,floorImpl:()=>f.vS,gatherNdImpl:()=>p.q,gatherV2Impl:()=>g.G,greaterEqualImpl:()=>v.lg,greaterImpl:()=>m.rq,lessEqualImpl:()=>b.cu,lessImpl:()=>y.WR,linSpaceImpl:()=>x.G,logImpl:()=>w.px,maxImpl:()=>k.j,maximumImpl:()=>_.He,minimumImpl:()=>A.hE,multiplyImpl:()=>C.BF,negImpl:()=>S.Dk,notEqualImpl:()=>E.cl,prodImpl:()=>T._B,raggedGatherImpl:()=>N.u,raggedRangeImpl:()=>F._,raggedTensorToTensorImpl:()=>D.K,rangeImpl:()=>I.q,rsqrtImpl:()=>M.Zy,scatterImpl:()=>O.b,sigmoidImpl:()=>R.zv,simpleAbsImpl:()=>r.dH,sliceImpl:()=>z.HS,sparseFillEmptyRowsImpl:()=>B.y,sparseReshapeImpl:()=>L.l,sparseSegmentReductionImpl:()=>P.z,sqrtImpl:()=>j.x6,staticRegexReplaceImpl:()=>U._,stridedSliceImpl:()=>W.e,stringNGramsImpl:()=>V.G,stringSplitImpl:()=>q.S,stringToHashBucketFastImpl:()=>G.f,subImpl:()=>H.dl,tileImpl:()=>Y.D,topKImpl:()=>X.x,transposeImpl:()=>K._,uniqueImpl:()=>Q.w});var r=n(14906),i=n(75197),a=n(96837),o=n(87488),s=n(37007),c=n(56729),u=n(9929),l=n(58350),h=n(35577),d=n(24239),f=n(57688),p=n(89270),g=n(87912),m=n(41392),v=n(92122),y=n(50925),b=n(75337),x=n(18472),w=n(13380),k=n(36729),_=n(35572),A=n(24178),C=n(82636),S=n(26692),E=n(64383),T=n(67097),N=n(8990),F=n(57126),D=n(22868),I=n(31040),M=n(47410),O=n(55949),R=n(83094),z=n(80844),B=n(62282),L=n(77681),P=n(13363),j=n(41010),U=n(57943),W=n(16100),V=n(6192),q=n(13410),G=n(96633),H=n(28400),Y=n(59613),X=n(52225),K=n(95250),Q=n(71160)},7369:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(37837);function i(t){return(e,n,i,a,o)=>{const s=r.backend_util.assertAndGetBroadcastShape(e,n),c=s.length,u=r.util.computeStrides(s),l=r.util.sizeFromShape(s),h=r.util.getTypedArrayFromDType(o,l),d=e.length,f=n.length,p=r.util.computeStrides(e),g=r.util.computeStrides(n),m=r.backend_util.getBroadcastDims(e,s),v=r.backend_util.getBroadcastDims(n,s);if(m.length+v.length===0)for(let r=0;r<h.length;++r)h[r]=t(i[r%i.length],a[r%a.length]);else for(let y=0;y<h.length;++y){const e=r.util.indexToLoc(y,c,u),n=e.slice(-d);m.forEach((t=>n[t]=0));const o=r.util.locToIndex(n,d,p),s=e.slice(-f);v.forEach((t=>s[t]=0));const l=r.util.locToIndex(s,f,g);h[y]=t(i[o],a[l])}return[h,s]}}},21150:(t,e,n)=>{"use strict";n.d(e,{B:()=>c,j:()=>s});var r=n(37837),i=n(80448),a=n(37007),o=n(60694);function s(t,e,n,s){return null==n?n=>{let{inputs:a,backend:o}=n;const{a:c,b:u}=a,l=o;(0,i.C)([c,u],t);const h=l.data.get(c.dataId).values,d=l.data.get(u.dataId).values,f="string"===c.dtype?r.backend_util.fromUint8ToStringArray(h):h,p="string"===c.dtype?r.backend_util.fromUint8ToStringArray(d):d,g=s||c.dtype,[m,v]=e(c.shape,u.shape,f,p,g);return l.makeTensorInfo(v,g,m)}:t=>{let{inputs:r,backend:i}=t;const{a:c,b:u}=r,l=i;if("complex64"===c.dtype||"complex64"===u.dtype){const t=(0,a.wg)({inputs:{x:c},backend:l,attrs:{dtype:"complex64"}}),e=l.data.get(t.dataId),r=e.complexTensorInfos.real,i=e.complexTensorInfos.imag,s=l.data.get(r.dataId).values,h=l.data.get(i.dataId).values,d=(0,a.wg)({inputs:{x:u},backend:l,attrs:{dtype:"complex64"}}),f=l.data.get(d.dataId),p=f.complexTensorInfos.real,g=f.complexTensorInfos.imag,m=l.data.get(p.dataId).values,v=l.data.get(g.dataId).values,[y,b,x]=n(c.shape,u.shape,s,h,m,v),w=l.makeTensorInfo(x,"float32",y),k=l.makeTensorInfo(x,"float32",b),_=(0,o.f)({inputs:{real:w,imag:k},backend:l});return l.disposeIntermediateTensorInfo(t),l.disposeIntermediateTensorInfo(d),l.disposeIntermediateTensorInfo(w),l.disposeIntermediateTensorInfo(k),_}{const t=l.data.get(c.dataId).values,n=l.data.get(u.dataId).values,r=s||c.dtype,[i,a]=e(c.shape,u.shape,t,n,r);return l.makeTensorInfo(a,r,i)}}}function c(t){return(e,n,i,a,o,s)=>{const c=r.backend_util.assertAndGetBroadcastShape(e,n),u=r.util.sizeFromShape(c),l=c.length,h=r.util.computeStrides(c),d=r.util.getTypedArrayFromDType("float32",u),f=r.util.getTypedArrayFromDType("float32",u),p=r.backend_util.getBroadcastDims(e,c),g=r.backend_util.getBroadcastDims(n,c),m=r.backend_util.mergeRealAndImagArrays(i,a),v=r.backend_util.mergeRealAndImagArrays(o,s),y=e.length,b=r.util.computeStrides(e),x=n.length,w=r.util.computeStrides(n);if(p.length+g.length===0)for(let r=0;r<d.length;r++){const e=r%m.length,n=r%v.length,i=t(m[2*e],m[2*e+1],v[2*n],v[2*n+1]);d[r]=i.real,f[r]=i.imag}else for(let k=0;k<d.length;k++){const e=r.util.indexToLoc(k,l,h),n=e.slice(-y);p.forEach((t=>n[t]=0));const i=r.util.locToIndex(n,y,b),a=e.slice(-x);g.forEach((t=>a[t]=0));const o=r.util.locToIndex(a,x,w),s=t(m[2*i],m[2*i+1],v[2*o],v[2*o+1]);d[k]=s.real,f[k]=s.imag}return[d,f,c]}}},95287:(t,e,n)=>{"use strict";n.d(e,{f:()=>p});var r=n(37837),i=n(75197),a=n(60694),o=n(21244),s=n(94010),c=n(14970),u=n(82636),l=n(50280),h=n(56057),d=n(80844),f=n(28400);function p(t,e,n){const i=t.shape,o=i[0],s=i[1],c=n.data.get(t.dataId),u=c.complexTensorInfos.real,l=c.complexTensorInfos.imag,h=[o,s],f=r.util.sizeFromShape(h),p=r.util.getTypedArrayFromDType("float32",f),m=r.util.getTypedArrayFromDType("float32",f);for(let x=0;x<o;x++){const t=(0,d.di)({inputs:{x:u},backend:n,attrs:{begin:[x,0],size:[1,s]}}),i=(0,d.di)({inputs:{x:l},backend:n,attrs:{begin:[x,0],size:[1,s]}}),o=(0,a.f)({inputs:{real:t,imag:i},backend:n}),{real:c,imag:h}=g(o,e,n),f=r.backend_util.mergeRealAndImagArrays(c,h);for(let e=0;e<s;e++){const t=r.backend_util.getComplexWithIndex(f,e);p[x*s+e]=t.real,m[x*s+e]=t.imag}n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o)}const v=n.makeTensorInfo(h,"float32",p),y=n.makeTensorInfo(h,"float32",m),b=(0,a.f)({inputs:{real:v,imag:y},backend:n});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(y),b}function g(t,e,n){const i=r.util.sizeFromShape(t.shape),a=n.data.get(t.dataId),o=n.data.get(a.complexTensorInfos.real.dataId).values,c=n.data.get(a.complexTensorInfos.imag.dataId).values;if(0===((u=i)&u-1)){const a=m(o,c,i,e,n),u=[t.shape[0],t.shape[1]];if(e){const t=n.makeTensorInfo(u,"float32",a.real),e=n.makeTensorInfo(u,"float32",a.imag),o=n.makeTensorInfo([],"float32",r.util.createScalarValue(i,"float32")),c=(0,s.D)({inputs:{x:o},backend:n}),l=h.GN.kernelFunc({inputs:{a:t,b:o},backend:n}),d=h.GN.kernelFunc({inputs:{a:e,b:c},backend:n}),f=n.data.get(l.dataId).values,p=n.data.get(d.dataId).values;return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(d),{real:f,imag:p}}return a}{const t=function(t,e,n){const i=new Float32Array(2*e);for(let a=0;a<e;a++){let o=0,s=0;for(let i=0;i<e;i++){const c=r.backend_util.exponent(a*i,e,n),u=r.backend_util.getComplexWithIndex(t,i);o+=u.real*c.real-u.imag*c.imag,s+=u.real*c.imag+u.imag*c.real}n&&(o/=e,s/=e),r.backend_util.assignToTypedArray(i,o,s,a)}return i}(r.backend_util.mergeRealAndImagArrays(o,c),i,e);return r.backend_util.splitRealAndImagArrays(t)}var u}function m(t,e,n,s,h){if(1===n)return{real:t,imag:e};const d=r.backend_util.mergeRealAndImagArrays(t,e),p=n/2,g=r.backend_util.complexWithEvenIndex(d),v=g.real,y=g.imag,b=[v.length],x=h.makeTensorInfo(b,"float32",v),w=h.makeTensorInfo(b,"float32",y),k=(0,a.f)({inputs:{real:x,imag:w},backend:h}),_=r.backend_util.complexWithOddIndex(d),A=_.real,C=_.imag,S=[A.length],E=h.makeTensorInfo(S,"float32",A),T=h.makeTensorInfo(S,"float32",C),N=(0,a.f)({inputs:{real:E,imag:T},backend:h}),F=m(v,y,p,s,h),D=F.real,I=F.imag,M=[D.length],O=h.makeTensorInfo(M,"float32",D),R=h.makeTensorInfo(M,"float32",I),z=(0,a.f)({inputs:{real:O,imag:R},backend:h}),B=m(A,C,p,s,h),L=B.real,P=B.imag,j=[L.length],U=h.makeTensorInfo(j,"float32",L),W=h.makeTensorInfo(j,"float32",P),V=(0,a.f)({inputs:{real:U,imag:W},backend:h}),q=r.backend_util.exponents(n,s),G=[q.real.length],H=h.makeTensorInfo(G,"float32",q.real),Y=h.makeTensorInfo(G,"float32",q.imag),X=(0,a.f)({inputs:{real:H,imag:Y},backend:h}),K=(0,u.lw)({inputs:{a:X,b:V},backend:h}),Q=(0,i.WQ)({inputs:{a:z,b:K},backend:h}),Z=(0,f.jb)({inputs:{a:z,b:K},backend:h}),$=(0,l.x)({inputs:{input:Q},backend:h}),J=(0,l.x)({inputs:{input:Z},backend:h}),tt=(0,c.n)({inputs:{input:Q},backend:h}),et=(0,c.n)({inputs:{input:Z},backend:h}),nt=(0,o.x)({inputs:[$,J],backend:h,attrs:{axis:0}}),rt=(0,o.x)({inputs:[tt,et],backend:h,attrs:{axis:0}}),it=h.data.get(nt.dataId).values,at=h.data.get(rt.dataId).values;return h.disposeIntermediateTensorInfo(x),h.disposeIntermediateTensorInfo(w),h.disposeIntermediateTensorInfo(k),h.disposeIntermediateTensorInfo(E),h.disposeIntermediateTensorInfo(T),h.disposeIntermediateTensorInfo(N),h.disposeIntermediateTensorInfo(O),h.disposeIntermediateTensorInfo(R),h.disposeIntermediateTensorInfo(z),h.disposeIntermediateTensorInfo(U),h.disposeIntermediateTensorInfo(W),h.disposeIntermediateTensorInfo(V),h.disposeIntermediateTensorInfo(H),h.disposeIntermediateTensorInfo(Y),h.disposeIntermediateTensorInfo(X),h.disposeIntermediateTensorInfo(K),h.disposeIntermediateTensorInfo(Q),h.disposeIntermediateTensorInfo(Z),h.disposeIntermediateTensorInfo($),h.disposeIntermediateTensorInfo(tt),h.disposeIntermediateTensorInfo(J),h.disposeIntermediateTensorInfo(et),h.disposeIntermediateTensorInfo(nt),h.disposeIntermediateTensorInfo(rt),{real:it,imag:at}}},79136:(t,e,n)=>{"use strict";n.d(e,{f:()=>l});var r=n(31050),i=n(94010),a=n(92594),o=n(12728),s=n(42666),c=n(24758),u=n(83094);function l(t,e,n,l,h){if("linear"===n)return(0,i.D)({inputs:{x:e},backend:t});if("relu"===n)return(0,s.V)({inputs:{x:e},backend:t});if("elu"===n)return(0,r.P)({inputs:{x:e},backend:t});if("relu6"===n)return(0,c.j)({inputs:{x:e},backend:t});if("prelu"===n)return(0,o.N)({inputs:{x:e,alpha:l},backend:t});if("leakyrelu"===n)return(0,a.H)({inputs:{x:e},backend:t,attrs:{alpha:h}});if("sigmoid"===n)return(0,u.ry)({inputs:{x:e},backend:t});throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}},51269:(t,e,n)=>{"use strict";n.d(e,{W_:()=>o,dz:()=>i,nN:()=>a,qW:()=>s});var r=n(37837);function i(t,e,n,i,a,o){const s=a.strideHeight,c=a.strideWidth,u=a.dilationHeight,l=a.dilationWidth,h=a.effectiveFilterHeight,d=a.effectiveFilterWidth,f=a.padInfo.top,p=a.padInfo.left,g="max"===o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=(0,r.buffer)(a.outShape,n),v=m.values,y=a.outShape[1]*a.outShape[2]*a.outShape[3],b=a.outShape[2]*a.outShape[3],x=a.outShape[3];for(let r=0;r<a.batchSize;++r){const e=r*y,n=r*i[0];for(let r=0;r<a.inChannels;++r)for(let m=0;m<a.outHeight;++m){const y=m*s-f,w=Math.max(0,y),k=Math.min(a.inHeight,h+y),_=e+m*b;for(let e=0;e<a.outWidth;++e){const s=e*c-p,h=Math.max(0,s),f=Math.min(a.inWidth,d+s);let m=g,y=0,b=0;for(let e=w;e<k;e+=u){const a=n+e*i[1];for(let e=h;e<f;e+=l){const n=t[a+e*i[2]+r];"max"===o&&n>m?m=n:"avg"===o&&(y+=n,b++)}if(isNaN(m))break}v[_+e*x+r]="avg"===o?y/b:m}}}return m}function a(t,e,n,i){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const s=(0,r.buffer)(i.outShape,"int32"),c=i.strideHeight,u=i.strideWidth,l=i.dilationHeight,h=i.dilationWidth,d=i.effectiveFilterHeight,f=i.effectiveFilterWidth,p=i.padInfo.top,g=i.padInfo.left,m=(0,r.buffer)(e,n,t);for(let r=0;r<i.batchSize;++r)for(let t=0;t<i.inChannels;++t)for(let e=0;e<i.outHeight;++e){const n=e*c-p;let v=n;for(;v<0;)v+=l;const y=Math.min(i.inHeight,d+n);for(let c=0;c<i.outWidth;++c){const d=c*u-g;let p=d;for(;p<0;)p+=h;const b=Math.min(i.inWidth,f+d);let x=Number.NEGATIVE_INFINITY,w=-1;for(let e=v;e<y;e+=l){const s=e-n;for(let n=p;n<b;n+=h){const c=n-d,u=m.get(r,e,n,t);u>x&&(x=u,w=a?o?((r*i.inHeight+e)*i.inWidth+n)*i.inChannels+t:(e*i.inWidth+n)*i.inChannels+t:s*f+c)}}s.set(w,r,e,c,t)}}return s}function o(t,e,n,i,a,o){const s=a.strideDepth,c=a.strideHeight,u=a.strideWidth,l=a.dilationDepth,h=a.dilationHeight,d=a.dilationWidth,f=a.effectiveFilterDepth,p=a.effectiveFilterHeight,g=a.effectiveFilterWidth,m=a.padInfo.front,v=a.padInfo.top,y=a.padInfo.left,b="max"===o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=(0,r.buffer)(a.outShape,n),w=x.values,k=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],_=a.outShape[2]*a.outShape[3]*a.outShape[4],A=a.outShape[3]*a.outShape[4],C=a.outShape[4];for(let r=0;r<a.batchSize;++r){const e=r*k,n=r*i[0];for(let r=0;r<a.inChannels;++r)for(let x=0;x<a.outDepth;++x){const k=x*s-m;let S=k;for(;S<0;)S+=l;const E=Math.min(a.inDepth,f+k),T=e+x*_;for(let e=0;e<a.outHeight;++e){const s=e*c-v;let f=s;for(;f<0;)f+=h;const m=Math.min(a.inHeight,p+s),x=T+e*A;for(let e=0;e<a.outWidth;++e){const s=e*u-y;let c=s;for(;c<0;)c+=d;const p=Math.min(a.inWidth,g+s),v=x+e*C;let k=b,_=0,A=0;for(let e=S;e<E;e+=l){const a=n+e*i[1];for(let e=f;e<m;e+=h){const n=a+e*i[2];for(let e=c;e<p;e+=d){const a=t[n+e*i[3]+r];if("max"===o&&a>k?k=a:"avg"===o&&(_+=a,A++),isNaN(k))break}if(isNaN(k))break}if(isNaN(k))break}w[v+r]="avg"===o?_/Math.max(A,1):k}}}}return x}function s(t,e){const n=(0,r.buffer)(e.outShape,"int32"),i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,l=e.effectiveFilterDepth,h=e.effectiveFilterHeight,d=e.effectiveFilterWidth,f=e.padInfo.front,p=e.padInfo.top,g=e.padInfo.left;for(let r=0;r<e.batchSize;++r)for(let m=0;m<e.inChannels;++m)for(let v=0;v<e.outDepth;++v){const y=v*i-f;let b=y;for(;b<0;)b+=s;const x=Math.min(e.inDepth,l+y);for(let i=0;i<e.outHeight;++i){const l=i*a-p;let f=l;for(;f<0;)f+=c;const w=Math.min(e.inHeight,h+l);for(let a=0;a<e.outWidth;++a){const p=a*o-g;let k=p;for(;k<0;)k+=u;const _=Math.min(e.inWidth,d+p);let A=Number.NEGATIVE_INFINITY,C=-1;for(let e=b;e<x;e+=s){const n=e-y;for(let i=f;i<w;i+=c){const a=i-l;for(let o=k;o<_;o+=u){const s=o-p,c=t.get(r,e,i,o,m);c>=A&&(A=c,C=n*h*d+a*h+s)}}}n.set(C,r,v,i,a,m)}}}return n}},77199:(t,e,n)=>{"use strict";n.d(e,{o:()=>i});var r=n(37837);function i(t){return(e,n,i)=>{const a=r.util.getArrayFromDType(n,e.length);for(let r=0;r<e.length;++r)a[r]=t(e[r],i);return a}}},74092:(t,e,n)=>{"use strict";n.d(e,{F:()=>s,v:()=>o});var r=n(37837),i=n(80448),a=n(77199);function o(t,e,n){return s(t,(0,a.o)(e),n)}function s(t,e,n){return a=>{let{inputs:o,attrs:s,backend:c}=a;const{x:u}=o;(0,i.C)(u,t);const l=c,h=l.data.get(u.dataId).values;let d;if("string"===u.dtype){if(!Array.isArray(h))throw new Error("String tensor's value was not an instance of Array");d=r.backend_util.fromUint8ToStringArray(h)}else d=h;const f=n||u.dtype,p=e(d,f,s);return l.makeTensorInfo(u.shape,f,p)}}},94883:(t,e,n)=>{"use strict";n.d(e,{U:()=>a});var r=n(37837),i=n(60694);function a(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n){const n=a(t,e,"float32"),r=a(t,e,"float32");return(0,i.f)({inputs:{real:n,imag:r},backend:t})}const o=r.util.makeZerosTypedArray(r.util.sizeFromShape(e),n);return t.makeTensorInfo(e,n,o)}},58147:(t,e,n)=>{"use strict";n.d(e,{r:()=>r});const r="4.17.0"},12250:(t,e,n)=>{"use strict";n.d(e,{K:()=>r});class r{constructor(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map(((t,e)=>"T".concat(e)));const n=[];this.variableNames.forEach((t=>{n.push("float v".concat(t," = get").concat(t,"AtOutCoords();"))}));const r=this.variableNames.map((t=>"v".concat(t))).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        float result = ").concat(r,";\n        setOutput(result);\n      }\n    ")}}},55523:(t,e,n)=>{"use strict";n.d(e,{c:()=>r});class r{constructor(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map(((t,e)=>"T".concat(e)));const n=[];this.variableNames.forEach((t=>{n.push("vec4 v".concat(t," = get").concat(t,"AtOutCoords();"))}));const r=this.variableNames.map((t=>"v".concat(t))).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        vec4 result = ").concat(r,";\n        setOutput(result);\n      }\n    ")}}},80209:(t,e,n)=>{"use strict";n.d(e,{l:()=>r});class r{constructor(t,e,n){this.variableNames=["A"];const{windowSize:r,batchSize:i,outSize:a}=t;n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,a];const o="max"===e?">":"<",s=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(r,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(r,"; i++) {\n          int inIdx = ").concat(s,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(o," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")}}},49406:(t,e,n)=>{"use strict";n.d(e,{l:()=>o});var r=n(37837),i=n(62796),a=n(41109);class o{constructor(t,e,n,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,r.util.assert(t.length>2,(()=>"Packed arg".concat(n.charAt(0).toUpperCase()+n.slice(1)," supports only inputs with rank above 2.")));const s=t[t.length-1],c=Math.ceil(s/e);this.outputShape=t.slice(0,-1),c>1&&this.outputShape.push(c),o||this.variableNames.push("bestIndicesA");const u=this.outputShape,l=u.length,h=(0,a.bf)(l),d=(0,i.Jp)("coords",l);let f,p;if(1===c){p=l+1;const t=(0,a.bf)(p);f="\n        ".concat(t," sourceLocR = ").concat(t,"(").concat(d.join(),", 0);\n        ++").concat(d[l-1],";\n        ").concat(t," sourceLocG = ").concat(t,"(").concat(d.join(),", 0);\n        ++").concat(d[l-2],";\n        ").concat(t," sourceLocA = ").concat(t,"(").concat(d.join(),", 0);\n        --").concat(d[l-1],";\n        ").concat(t," sourceLocB = ").concat(t,"(").concat(d.join(),", 0);\n        --").concat(d[l-2],";")}else p=l,f="\n        ".concat(h," sourceLocR = coords;\n        ++").concat(d[l-1],";\n        ").concat(h," sourceLocG = coords;\n        ++").concat(d[l-2],";\n        ").concat(h," sourceLocA = coords;\n        --").concat(d[l-1],";\n        ").concat(h," sourceLocB = coords;\n        --").concat(d[l-2],";");const g=["x","y","z","w","u","v"].slice(0,p),m="."+g[p-1],v=g.map((t=>"int "+t)),y=(0,i.Jp)("sourceLocR",p-1).concat("inIdx.r"),b=(0,i.Jp)("sourceLocG",p-1).concat("inIdx.g"),x=(0,i.Jp)("sourceLocB",p-1).concat("inIdx.b"),w=(0,i.Jp)("sourceLocA",p-1).concat("inIdx.a"),k="max"===n?"greaterThan":"lessThan",_=o?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(b.join(),"),\n                             getBestIndicesAChannel(").concat(x.join(),"),\n                             getBestIndicesAChannel(").concat(w.join(),")));"),A="vec4(\n            getAChannel(".concat(y.join(),"),\n            hasNextCol ? getAChannel(").concat(b.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(x.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(w.join(),") : 0.)"),C=o?"":"\n      float getBestIndicesAChannel(".concat(v.join(),") {\n        return getChannel(getBestIndicesA(").concat(g.join(),"),\n                                          vec2(").concat(g.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(v.join(),") {\n        return getChannel(getA(").concat(g.join(),"),\n                               vec2(").concat(g.slice(-2).join(),"));\n      }\n      ").concat(C,"\n      void main() {\n        ").concat(h," coords = getOutputCoords();\n        bool hasNextCol = ").concat(d[l-1]," < ").concat(u[l-1]-1,";\n        bool hasNextRow = ").concat(d[l-2]," < ").concat(u[l-2]-1,";\n        ").concat(f,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(m,", sourceLocG").concat(m,",\n          sourceLocB").concat(m,", sourceLocA").concat(m,") * ").concat(e,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(A,";\n\n        for (int i = 0; i < ").concat(e,"; i++) {\n          inIdx = srcIdx;\n          ").concat(_,"\n          vec4 candidate = ").concat(A,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(k,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}}},37853:(t,e,n)=>{"use strict";n.d(e,{q:()=>i,x:()=>r});class r{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,a=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterHeight,c=t.effectiveFilterWidth,u=s-1-t.padInfo.top,l=c-1-t.padInfo.left,h=1/(e*n);this.userCode="\n      const ivec2 pads = ivec2(".concat(u,", ").concat(l,");\n      const float avgMultiplier = float(").concat(h,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(s,";\n            wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(c,";\n            wC+= ").concat(o,") {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class i{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,i=t.strideDepth,a=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,c=t.dilationHeight,u=t.dilationWidth,l=t.effectiveFilterDepth,h=t.effectiveFilterHeight,d=t.effectiveFilterWidth,f=l-1-t.padInfo.front,p=h-1-t.padInfo.top,g=d-1-t.padInfo.left,m=1/(e*n*r);this.userCode="\n      const ivec3 pads = ivec3(".concat(f,", ").concat(p,", ").concat(g,");\n      const float avgMultiplier = float(").concat(m,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(l,";\n            wD += ").concat(s,") {\n          float dyD = float(dyDCorner + wD) / ").concat(i,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(h,";\n              wR += ").concat(c,") {\n            float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(u,") {\n              float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}},64904:(t,e,n)=>{"use strict";n.d(e,{Q6:()=>C});n(75255);var r=n(37837),i=n(44455),a=n(69497),o=n(84630),s=n(64810),c=n(94515),u=n(89893),l=n(9522),h=n(98293),d=n(29150),f=n(37999),p=n(51740),g=n(95002),m=n(4870),v=n(77565),y=n(23199),b=n(53884),x=n(4375),w=n(11414);const k=r.kernel_impls.whereImpl,_={};const A=(0,r.env)().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");class C extends r.KernelBackend{nextDataId(){return C.nextDataId++}constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!(0,r.env)().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let e;if(null!=t){if(t instanceof h.n)e=t;else{const n=(0,i.bU)((0,r.env)().getNumber("WEBGL_VERSION"),t);e=new h.n(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const t=(0,i.bU)((0,r.env)().getNumber("WEBGL_VERSION"));e=new h.n(t),this.binaryCache=((n=(0,r.env)().getNumber("WEBGL_VERSION"))in _||(_[n]={}),_[n]),this.gpgpuCreatedLocally=!0}var n;this.gpgpu=e,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new v.p(this.gpgpu),this.numMBBeforeWarning=null==(0,r.env)().global.screen?1024:(0,r.env)().global.screen.height*(0,r.env)().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new r.DataStorage(this,(0,r.engine)())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(t,e,n,r,i,a){const o=this.makeTensorInfo(e,n),s=this.texData.get(o.dataId);s.isPacked=!1,s.texture={texture:t,texShape:[r,i]},s.texShape=[r,i];const c=w.FP(e),l=new u.C(c,!1,a),h=this.runWebGLProgram(l,[o],n,[[r,i]]);return h.shape=e,s.texture=null,this.disposeIntermediateTensorInfo(o),h.dataId}write(t,e,n){if(((0,r.env)().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||(0,r.env)().getBool("DEBUG"))&&this.checkNumericalProblems(t),"complex64"===n&&null!=t)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const i={id:this.nextDataId()};return this.texData.set(i,{shape:e,dtype:n,values:t,usage:m.tT.UPLOAD,refCount:1}),i}refCount(t){if(this.texData.has(t)){return this.texData.get(t).refCount}return 0}incRef(t){this.texData.get(t).refCount++}decRef(t){if(this.texData.has(t)){this.texData.get(t).refCount--}}move(t,e,n,i,a){if((0,r.env)().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===i)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:n,dtype:i,values:e,usage:m.tT.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}readSync(t){const e=this.texData.get(t),{values:n,dtype:i,complexTensorInfos:a,slice:o,shape:s,isPacked:c}=e;if(null!=o){let e;e=c?new b.rf(s,y.UC):new y.hE(s,y.UC);const n=this.runWebGLProgram(e,[{dataId:t,shape:s,dtype:i}],i),r=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),r}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===i)return n;const u=null!=this.activeTimers;let l,h;if(u&&(l=r.util.now()),"complex64"===i){const t=this.readSync(a.real.dataId),e=this.readSync(a.imag.dataId);h=r.backend_util.mergeRealAndImagArrays(t,e)}else h=this.getValuesFromTexture(t);return u&&(this.downloadWaitMs+=r.util.now()-l),this.convertAndCacheOnCPU(t,h)}async read(t){if(this.pendingRead.has(t)){const e=this.pendingRead.get(t);return new Promise((t=>e.push(t)))}const e=this.texData.get(t),{values:n,shape:i,slice:a,dtype:o,complexTensorInfos:s,isPacked:c}=e;if(null!=a){let e;e=c?new b.rf(i,y.UC):new y.hE(i,y.UC);const n=this.runWebGLProgram(e,[{dataId:t,shape:i,dtype:o}],o),r=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),r}if(null!=n)return this.convertAndCacheOnCPU(t);if((0,r.env)().getBool("DEBUG")&&!(0,r.env)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===(0,r.env)().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u,l,h=null;if("complex64"!==o&&(0,r.env)().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(t);const e=this.texData.get(u.dataId);h=this.gpgpu.createBufferFromTexture(e.texture.texture,...m.GM(i))}if(this.pendingRead.set(t,[]),"complex64"!==o&&await this.gpgpu.createAndWaitForFence(),"complex64"===o){const t=await Promise.all([this.read(s.real.dataId),this.read(s.imag.dataId)]),e=t[0],n=t[1];l=r.backend_util.mergeRealAndImagArrays(e,n)}else if(null==h)l=this.getValuesFromTexture(t);else{const t=r.util.sizeFromShape(i);l=this.gpgpu.downloadFloat32MatrixFromBuffer(h,t)}if(null!=u&&this.disposeIntermediateTensorInfo(u),null!=h){const t=this.gpgpu.gl;w.ul(t,(()=>t.deleteBuffer(h)))}const d=this.convertAndCacheOnCPU(t,l),f=this.pendingRead.get(t);return this.pendingRead.delete(t),f.forEach((t=>t(d))),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&(0,r.engine)().removeDataId(t,this),this.pendingDeletes--),d}readToGPU(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.texData.get(t),{values:i,shape:a,slice:o,dtype:s,isPacked:c,texture:u}=n;if("complex64"===s)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=o){let n;n=c?new b.rf(a,y.UC):new y.hE(a,y.UC);const r=this.runWebGLProgram(n,[{dataId:t,shape:a,dtype:s}],s),i=this.readToGPU(r,e);return this.disposeIntermediateTensorInfo(r),i}if(null==u)throw null!=i?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const l=this.decode(t,e.customTexShape),h=(0,r.engine)().makeTensorFromTensorInfo(l),d=this.texData.get(l.dataId);return Object.assign({tensorRef:h},d.texture)}bufferSync(t){const e=this.readSync(t.dataId);if("string"===t.dtype)try{const n=e.map((t=>r.util.decodeString(t)));return(0,r.buffer)(t.shape,t.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return(0,r.buffer)(t.shape,t.dtype,e)}checkNumericalProblems(t){if(null!=t)for(let e=0;e<t.length;e++){const n=t[e];if(!w.dm(n)){if((0,r.env)().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}getValuesFromTexture(t){const{shape:e,dtype:n,isPacked:i}=this.texData.get(t),a=r.util.sizeFromShape(e);if((0,r.env)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const n=this.decode(t),r=this.texData.get(n.dataId),i=this.gpgpu.downloadMatrixFromPackedTexture(r.texture.texture,...m.GM(e)).subarray(0,a);return this.disposeIntermediateTensorInfo(n),i}const o=(0,r.env)().getBool("WEBGL_PACK")&&!0===i,u=o?w.FP(e):e,l=o?new c.N(u):new s.$(u),h=this.runWebGLProgram(l,[{shape:u,dtype:n,dataId:t}],"float32"),d=this.texData.get(h.dataId),f=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(d.texture.texture,d.texShape[0],d.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(h),f}timerAvailable(){return(0,r.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(t){const e=this.activeTimers,n=[];let i=!1;null==this.programTimersStack?(this.programTimersStack=n,i=!0):this.activeTimers.push(n),this.activeTimers=n,t();const a=r.util.flatten(this.activeTimers.map((t=>t.query))).filter((t=>null!=t)),o=r.util.flatten(this.activeTimers.map((t=>t.name))).filter((t=>null!=t));this.activeTimers=e,i&&(this.programTimersStack=null);const s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if((0,r.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const t=await Promise.all(a);s.kernelMs=r.util.sum(t),s.getExtraProfileInfo=()=>t.map(((t,e)=>({name:o[e],ms:t}))).map((t=>"".concat(t.name,": ").concat(t.ms))).join(", ")}else s.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,s})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return(0,r.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:r.util.now(),endMs:null}}endTimer(t){return(0,r.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=r.util.now(),t)}async getQueryTime(t){if((0,r.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);const e=t;return e.endMs-e.startMs}disposeData(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(t))return!1;if(!this.texData.has(t))return!0;if(e?this.texData.get(t).refCount=0:this.texData.get(t).refCount--,!e&&this.texData.get(t).refCount>0)return!1;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),this.pendingDeletes++,!1;this.releaseGPUData(t);const{complexTensorInfos:n}=this.texData.get(t);return null!=n&&(this.disposeData(n.real.dataId,e),this.disposeData(n.imag.dataId,e)),this.texData.delete(t),!0}releaseGPUData(t){const{texture:e,dtype:n,texShape:r,usage:i,isPacked:a,slice:o}=this.texData.get(t),s=o&&o.origDataId||t,c=this.dataRefCount.get(s);c>1?this.dataRefCount.set(s,c-1):(this.dataRefCount.delete(s),null!=e&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(e,r,i,a)));const u=this.texData.get(t);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture.texture}getDataInfo(t){return this.texData.get(t)}shouldExecuteOnCPU(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:A;return(0,r.env)().getBool("WEBGL_CPU_FORWARD")&&t.every((t=>null==this.texData.get(t.dataId).texture&&r.util.sizeFromShape(t.shape)<e))}getGPGPUContext(){return this.gpgpu}where(t){r.backend_util.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const e=t.dataSync();return k(t.shape,e)}packedUnaryOp(t,e,n){const i=new b.rf(t.shape,e),a=this.compileAndRun(i,[t],n);return(0,r.engine)().makeTensorFromTensorInfo(a)}abs(t){if(this.shouldExecuteOnCPU([t])&&"complex64"!==t.dtype){const e=(0,f.f8)(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,e)}if((0,r.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,y.pd,t.dtype);const e=new y.hE(t.shape,y.pd),n=this.compileAndRun(e,[t]);return(0,r.engine)().makeTensorFromTensorInfo(n)}makeTensorInfo(t,e,n){let i;if("string"===e&&null!=n&&n.length>0&&r.util.isString(n[0])){const a=n.map((t=>r.util.encodeString(t)));i=this.write(a,t,e)}else i=this.write(n,t,e);return this.texData.get(i).usage=null,{dataId:i,shape:t,dtype:e}}makeOutput(t,e,n){return(0,r.engine)().makeTensorFromTensorInfo(this.makeTensorInfo(t,e,n),this)}unpackTensor(t){const e=new x.z(t.shape);return this.runWebGLProgram(e,[t],t.dtype)}packTensor(t){const e=new p.m(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)}packedReshape(t,e){const n=[w.N0(t.shape),...w.Ph(t.shape)],r={dtype:t.dtype,shape:n,dataId:t.dataId},i=[w.N0(e),...w.Ph(e)],a=new g.R(i,n),o=[n],s=this.runWebGLProgram(a,[r],t.dtype,o,!0);return{dataId:s.dataId,shape:e,dtype:s.dtype}}decode(t,e){const n=this.texData.get(t),{isPacked:i,shape:s,dtype:c}=n;if(null!=e){const t=r.util.sizeFromShape(s),n=e[0]*e[1]*4;r.util.assert(t<=n,(()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data."))}const u=w.FP(s);let l;l=i?new o.S(u):new a.K(u);const h=[null!=e?e:m.GM(u)];return{dtype:c,shape:s,dataId:this.runWebGLProgram(l,[{shape:u,dtype:c,dataId:t}],c,h,!0,e).dataId}}runWebGLProgram(t,e,n,i){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0;const s=this.makeTensorInfo(t.outputShape,n),c=this.texData.get(s.dataId);if(t.packedOutput&&(c.isPacked=!0),t.outPackingScheme===m.BB.DENSE){const e=null!=o?o:m.GM(t.outputShape);c.texShape=e.map((t=>2*t))}if(null!=t.outTexUsage&&(c.usage=t.outTexUsage),0===r.util.sizeFromShape(s.shape))return c.values=r.util.getTypedArrayFromDType(s.dtype,0),s;const u=[],l=e.map((e=>{if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(e.dataId);if(null==n.texture){if(!t.packedInputs&&r.util.sizeFromShape(e.shape)<=(0,r.env)().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.packedInputs&&(n.isPacked=!0,n.shape=e.shape)}if(this.uploadToGPU(e.dataId),!!n.isPacked!==!!t.packedInputs)e=n.isPacked?this.unpackTensor(e):this.packTensor(e),u.push(e),n=this.texData.get(e.dataId);else if(n.isPacked&&!w.P0(n.shape,e.shape)){const t=e,r=e.shape;e.shape=n.shape,e=this.packedReshape(e,r),u.push(e),n=this.texData.get(e.dataId),t.shape=r}return{shape:e.shape,texData:n,isUniform:!1}}));this.uploadToGPU(s.dataId);const h={shape:s.shape,texData:c,isUniform:!1},f=d.Tb(t,l,h),p=this.getAndSaveBinary(f,(()=>d.Kz(this.gpgpu,t,l,h))),g=null!=this.activeTimers;let v;g&&(v=this.startTimer()),(0,r.env)().get("ENGINE_COMPILE_ONLY")||d.mB(this.gpgpu,p,l,h,i),u.forEach((t=>this.disposeIntermediateTensorInfo(t))),g&&(v=this.endTimer(v),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(v)}));const y=(0,r.env)().getNumber("WEBGL_FLUSH_THRESHOLD");if(y>0){const t=r.util.now();t-this.lastGlFlushTime>y&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=t)}if(!(0,r.env)().getBool("WEBGL_LAZILY_UNPACK")&&c.isPacked&&!1===a){const t=this.unpackTensor(s);return this.disposeIntermediateTensorInfo(s),t}return s}compileAndRun(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||e[0].dtype;return this.runWebGLProgram(t,e,n,r,i)}getAndSaveBinary(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){if(!this.disposed){if(!(0,r.env)().getBool("IS_TEST")){Object.keys(this.binaryCache).forEach((t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}))}this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=(0,r.tidy)((()=>{if(!(0,r.env)().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=(0,r.env)().getBool("DEBUG");(0,r.env)().set("DEBUG",!1);const e=this.abs((0,r.scalar)(1e-8)).dataSync()[0];if((0,r.env)().set("DEBUG",t),e>0)return 32}return 16}))),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(t){const e=this.texData.get(t),{shape:n,dtype:i,values:a,texture:o,usage:s,isPacked:c}=e;if(null!=o)return;const h=null!=this.activeTimers;let d;h&&(d=r.util.now());let f=e.texShape;if(null==f&&(f=w.fA(n,c),e.texShape=f),null!=a){const t=w.FP(n);let o,s=f[1],p=f[0];const g=a instanceof Uint8Array||a instanceof Uint8ClampedArray;!c&&g||([s,p]=m.NO(f[0],f[1])),o=c?new l.A(t,g):new u.C(t,g);const v=g?[p,s]:f,y=this.makeTensorInfo(v,i),b=this.texData.get(y.dataId);b.usage=g?m.tT.PIXELS:m.tT.UPLOAD,b.texShape=v,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),s,p,a);const x=[[p,s]],k=!0,_=this.runWebGLProgram(o,[y],i,x,k),A=this.texData.get(_.dataId);e.texShape=A.texShape,e.isPacked=A.isPacked,e.usage=A.usage,(0,r.env)().get("ENGINE_COMPILE_ONLY")?this.disposeData(_.dataId):(e.texture=A.texture,e.values=null,this.texData.delete(_.dataId)),this.disposeIntermediateTensorInfo(y),h&&(this.uploadWaitMs+=r.util.now()-d)}else{const t=this.acquireTexture(f,s,i,c);e.texture=t}}convertAndCacheOnCPU(t,e){const n=this.texData.get(t),{dtype:r}=n;return null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){const n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length);for(let e=0;e<n.length;++e)n[e]=Math.round(t[e]);return n}throw new Error("Unknown dtype ".concat(e))}(e,r)),n.values}acquireTexture(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const t=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(t," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(t,e,r)}computeBytes(t,e){return t[0]*t[1]*r.util.bytesPerElement(e)}checkCompileCompletion(){for(const[,t]of Object.entries(this.binaryCache))this.checkCompletion_(t)}async checkCompileCompletionAsync(){const t=[];if(this.gpgpu.parallelCompilationExtension){for(const[,e]of Object.entries(this.binaryCache))t.push(this.checkCompletionAsync_(e));return Promise.all(t)}for(const[,e]of Object.entries(this.binaryCache)){const n=new Promise((t=>{try{this.checkCompletion_(e),t(!0)}catch(n){throw n}}));t.push(n)}return Promise.all(t)}async checkCompletionAsync_(t){return this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(t):(await(0,r.nextFrame)(),this.checkCompletionAsync_(t))}checkCompletion_(t){if(!1===this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(t.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(t.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw w.cr(t.source,this.gpgpu.gl.getShaderInfoLog(t.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0}getUniformLocations(){for(const t of Object.values(this.binaryCache)){this.gpgpu.buildVao(t.webGLProgram);const{variablesLocations:e,customUniformLocations:n,infLoc:r,nanLoc:i,outShapeLocation:a,outShapeStridesLocation:o,outTexShapeLocation:s}=(0,d.Tw)(this.gpgpu,t.program,t.webGLProgram);t.variablesLocations=e,t.customUniformLocations=n,t.infLoc=r,t.nanLoc=i,t.outShapeLocation=a,t.outShapeStridesLocation=o,t.outTexShapeLocation=s}}createTensorFromGPUData(t,e,n){t.channels=t.channels||"RGBA";const{texture:i,height:a,width:o,channels:s}=t,c=(0,r.engine)().backend;if(!c.gpgpu.gl.isTexture(i))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=c.writeTexture(i,e,n,a,o,s);return(0,r.engine)().makeTensorFromDataId(u,e,n,c)}}C.nextDataId=0},74141:(t,e,n)=>{"use strict";n.d(e,{$p:()=>a.r});var r=n(37837),i=n(64904),a=n(54114),o=n(35931);r.device_util.isBrowser()&&(0,r.registerBackend)("webgl",(()=>new i.Q6),2);o.bP},34461:(t,e,n)=>{"use strict";n.d(e,{f:()=>i});var r=n(37837);class i{constructor(t,e,n,i,a,o){this.outputShape=[],this.variableNames=["x","mean","variance"],r.backend_util.assertAndGetBroadcastShape(t,e),r.backend_util.assertAndGetBroadcastShape(t,n);let s="0.0";null!=i&&(r.backend_util.assertAndGetBroadcastShape(t,i),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let c="1.0";null!=a&&(r.backend_util.assertAndGetBroadcastShape(t,a),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(s,";\n        float scale = ").concat(c,";\n        float inv = scale * inversesqrt(variance + float(").concat(o,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")}}},43482:(t,e,n)=>{"use strict";n.d(e,{x:()=>i});var r=n(37837);class i{constructor(t,e,n,i,a,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],r.backend_util.assertAndGetBroadcastShape(t,e),r.backend_util.assertAndGetBroadcastShape(t,n);let s="vec4(0.0)";null!=i&&(r.backend_util.assertAndGetBroadcastShape(t,i),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let c="vec4(1.0)";null!=a&&(r.backend_util.assertAndGetBroadcastShape(t,a),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = ".concat(s,";\n        vec4 scale = ").concat(c,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(o,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")}}},38376:(t,e,n)=>{"use strict";n.d(e,{C:()=>i,f:()=>a});var r=n(37837);const i={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class a{constructor(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=r.backend_util.assertAndGetBroadcastShape(e,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")}}},74139:(t,e,n)=>{"use strict";n.d(e,{dR:()=>a,x:()=>o});var r=n(37837),i=n(29150);const a="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n";class o{constructor(t,e,n){this.variableNames=["A","B"],this.outputShape=r.backend_util.assertAndGetBroadcastShape(e,n),this.enableShapeUniforms=(0,i.ik)(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")}}},61880:(t,e,n)=>{"use strict";n.d(e,{VI:()=>c,qq:()=>s});var r=n(37837),i=n(29150),a=n(62796),o=n(41109);const s="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n";class c{constructor(t,e,n){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r.backend_util.assertAndGetBroadcastShape(e,n);const c=this.outputShape.length;this.enableShapeUniforms=(0,i.ik)(c);let u="";if(s)if(0===c||1===r.util.sizeFromShape(this.outputShape))u="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{const t=(0,o.bf)(c);if(u="\n          ".concat(t," coords = getOutputCoords();\n        "),1===c)this.enableShapeUniforms?u+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":u+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{const t=(0,a.Jp)("coords",c);this.enableShapeUniforms?u+="\n            bool nextRowOutOfBounds =\n              (".concat(t[c-2]," + 1) >= outShape[").concat(c," - 2];\n            bool nextColOutOfBounds =\n              (").concat(t[c-1]," + 1) >= outShape[").concat(c," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):u+="\n            bool nextRowOutOfBounds =\n              (".concat(t[c-2]," + 1) >= ").concat(this.outputShape[c-2],";\n            bool nextColOutOfBounds =\n              (").concat(t[c-1]," + 1) >= ").concat(this.outputShape[c-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(u,"\n\n        setOutput(result);\n      }\n    ")}}},44455:(t,e,n)=>{"use strict";n.d(e,{bU:()=>s,lj:()=>o});var r=n(37837);const i={},a={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function o(t,e){i[t]=e}function s(t,e){if(!(t in i)||null!=e){const n=function(t,e){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=null==e?function(t){if((0,r.env)().getBool("IS_SAFARI")||"undefined"===typeof OffscreenCanvas||2!==t){if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}return new OffscreenCanvas(300,150)}(t):e;n.addEventListener("webglcontextlost",(e=>{e.preventDefault(),delete i[t]}),!1),(0,r.env)().getBool("SOFTWARE_WEBGL_ENABLED")&&(a.failIfMajorPerformanceCaveat=!1);if(1===t)return n.getContext("webgl",a)||n.getContext("experimental-webgl",a);return n.getContext("webgl2",a)}(t,e);if(null===n)return console.log("Could not get context for WebGL version",t),null;i[t]=n}const n=i[t];return null==n||n.isContextLost()?(delete i[t],s(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),i[t])}},21303:(t,e,n)=>{"use strict";n.d(e,{T:()=>r});class r{constructor(t){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}},14372:(t,e,n)=>{"use strict";n.d(e,{$:()=>r});class r{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}},25660:(t,e,n)=>{"use strict";n.d(e,{t:()=>r});class r{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}},97865:(t,e,n)=>{"use strict";n.d(e,{P:()=>i});var r=n(37837);class i{constructor(t){this.outputShape=[],this.outputShape=r.backend_util.computeOutShape(t,1),this.variableNames=t.map(((t,e)=>"T".concat(e)));const e=new Array(t.length-1);e[0]=t[0][1];for(let r=1;r<e.length;r++)e[r]=e[r-1]+t[r][1];const n=["if (yC < ".concat(e[0],") setOutput(getT0(yR, yC));")];for(let r=1;r<e.length;r++){const t=e[r-1];n.push("else if (yC < ".concat(e[r],") ")+"setOutput(getT".concat(r,"(yR, yC-").concat(t,"));"))}const i=e.length,a=e[e.length-1];n.push("else setOutput(getT".concat(i,"(yR, yC-").concat(a,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(n.join("\n        "),"\n      }\n    ")}}},38406:(t,e,n)=>{"use strict";n.d(e,{V:()=>o});var r=n(37837),i=n(62796),a=n(41109);class o{constructor(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=r.backend_util.computeOutShape(t,e);const n=this.outputShape,o=n.length,c=(0,a.bf)(o),u=(0,i.Jp)("coords",o),l=["x","y","z","w","u","v"].slice(0,o);this.variableNames=t.map(((t,e)=>"T".concat(e)));const h=new Array(t.length-1);h[0]=t[0][e];for(let r=1;r<h.length;r++)h[r]=h[r-1]+t[r][e];const d=l[e],f=l.slice(-2),p=l.join();let g="if (".concat(d," < ").concat(h[0],") {\n        return getChannel(\n            getT0(").concat(p,"), vec2(").concat(f.join(),"));\n        }");for(let r=1;r<h.length;r++){const t=h[r-1];g+="\n        if (".concat(d," < ").concat(h[r],"  && ").concat(d," >= ").concat(h[r-1],") {\n          return getChannel(\n            getT").concat(r,"(").concat(s(l,d,t),"),\n            vec2(").concat(s(f,d,t),"));\n        }")}const m=h.length,v=h[h.length-1];g+="\n        return getChannel(\n          getT".concat(m,"(").concat(s(l,d,v),"),\n          vec2(").concat(s(f,d,v),"));"),this.userCode="\n      float getValue(".concat(l.map((t=>"int "+t)),") {\n        ").concat(g,"\n      }\n\n      void main() {\n        ").concat(c," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(u,"), 0., 0., 0.);\n\n        ").concat(u[o-1]," = ").concat(u[o-1]," + 1;\n        if (").concat(u[o-1]," < ").concat(n[o-1],") {\n          result.g = getValue(").concat(u,");\n        }\n\n        ").concat(u[o-2]," = ").concat(u[o-2]," + 1;\n        if (").concat(u[o-2]," < ").concat(n[o-2],") {\n          result.a = getValue(").concat(u,");\n        }\n\n        ").concat(u[o-1]," = ").concat(u[o-1]," - 1;\n        if (").concat(u[o-2]," < ").concat(n[o-2]," &&\n            ").concat(u[o-1]," < ").concat(n[o-1],") {\n          result.b = getValue(").concat(u,");\n        }\n        setOutput(result);\n      }\n    ")}}function s(t,e,n){const r=t.indexOf(e);return t.map(((t,e)=>e===r?"".concat(t," - ").concat(n):t)).join()}},86698:(t,e,n)=>{"use strict";n.d(e,{N7:()=>a,S5:()=>r,eS:()=>i,tR:()=>o});class r{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,i=t.padInfo.left,a="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(e," - ").concat(r,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              ").concat(a?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);","\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class i{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,a="channelsLast"===t.dataFormat,o=e-1-t.padInfo.top,s=n-1-t.padInfo.left,c=a?1:2,u=a?2:3,l=a?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(l,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(c,"], coords[").concat(u,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(e,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(e," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n\n              if (").concat(a,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class a{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,i=t.padInfo.front,a=t.padInfo.top,o=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(t.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(e," - ").concat(i,";\n\n            if (xF < 0 || xF >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(r," - ").concat(o,";\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class o{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,i=t.strideDepth,a=t.strideHeight,o=t.strideWidth,s=e-1-t.padInfo.front,c=n-1-t.padInfo.top,u=r-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(s,", ").concat(c,", ").concat(u,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(e,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(i,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(t.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(e," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(n,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(n," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(r,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(r," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}},93752:(t,e,n)=>{"use strict";n.d(e,{R:()=>i,f:()=>r});class r{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,i=t.padInfo.left,a=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(a," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(e," - ").concat(r,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class i{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,a=e-1-t.padInfo.top,o=n-1-t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(a,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(e,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(e," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(s,"; dm++) {\n              int d2 = d1 * ").concat(s," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}},79763:(t,e,n)=>{"use strict";n.d(e,{g:()=>i});var r=n(29150);class i{constructor(t){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=t.inShape,this.enableShapeUniforms=(0,r.ik)(this.outputShape.length);const e=t.filterHeight,n=t.filterWidth,i=e-1-t.padInfo.top,a=n-1-t.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2(".concat(i,", ").concat(a,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ").concat(e,"; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ").concat(e," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ").concat(t.outWidth,".0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ").concat(t.outWidth,".0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    ")}}},6031:(t,e,n)=>{"use strict";n.d(e,{B:()=>r,w:()=>i});class r{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.outputShape=t.outShape;const a=t.padInfo.top,o=t.padInfo.left,s=t.strideHeight,c=t.strideWidth,u=t.dilationHeight,l=t.dilationWidth,h=t.filterHeight,d=t.filterWidth,f=4*Math.floor(t.inChannels/4),p=t.inChannels%4,g="channelsLast"===t.dataFormat,m=g?1:2,v=g?2:3,y=g?3:1;let b="",x="";n&&(b=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),x="result = activation(result);");const w=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(b,"\n\n      const ivec2 strides = ivec2(").concat(s,", ").concat(c,");\n      const ivec2 pads = ivec2(").concat(a,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(y,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(m,"], coords[").concat(v,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(h,"; wR++) {\n          int xR = xRCorner + wR * ").concat(u,";\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(d,"; wC++) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            if (xC < 0 || xC >= ").concat(t.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(f,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(g,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===p,") {\n\n              if (").concat(g,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(f,") *\n                    getW(wR, wC, ").concat(f,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(f,", xR, xC) *\n                    getW(wR, wC, ").concat(f,", d2);\n              }\n\n            } else if (").concat(2===p,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(f,", d2),\n                getW(wR, wC, ").concat(f," + 1, d2)\n              );\n\n              if (").concat(g,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(f,"),\n                  getX(batch, xR, xC, ").concat(f," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(f,", xR, xC),\n                  getX(batch, ").concat(f," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===p,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(f,", d2),\n                getW(wR, wC, ").concat(f," + 1, d2),\n                getW(wR, wC, ").concat(f," + 2, d2)\n              );\n\n              if (").concat(g,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(f,"),\n                  getX(batch, xR, xC, ").concat(f," + 1),\n                  getX(batch, xR, xC, ").concat(f," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(f,", xR, xC),\n                  getX(batch, ").concat(f," + 1, xR, xC),\n                  getX(batch, ").concat(f," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(w,"\n        ").concat(x,"\n        setOutput(result);\n      }\n    ")}}class i{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,i=t.strideDepth,a=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,c=t.dilationHeight,u=t.dilationWidth,l=t.filterDepth,h=t.filterHeight,d=t.filterWidth,f=4*Math.floor(t.inChannels/4),p=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(i,", ").concat(a,", ").concat(o,");\n      const ivec3 pads = ivec3(").concat(e,", ").concat(n,", ").concat(r,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(l,"; wF++) {\n          int xF = xFCorner + wF * ").concat(s,";\n\n          if (xF < 0 || xF >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(h,"; wR++) {\n            int xR = xRCorner + wR * ").concat(c,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,"; wC++) {\n              int xC = xCCorner + wC * ").concat(u,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(f,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===p,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(f,") *\n                  getW(wF, wR, wC, ").concat(f,", d2);\n              } else if (").concat(2===p,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(f,"),\n                  getX(batch, xF, xR, xC, ").concat(f," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(f,", d2),\n                  getW(wF, wR, wC, ").concat(f," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===p,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(f,"),\n                  getX(batch, xF, xR, xC, ").concat(f," + 1),\n                  getX(batch, xF, xR, xC, ").concat(f," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(f,", d2),\n                  getW(wF, wR, wC, ").concat(f," + 1, d2),\n                  getW(wF, wR, wC, ").concat(f," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}},41301:(t,e,n)=>{"use strict";n.d(e,{E:()=>i});var r=n(29150);class i{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=(0,r.ik)(this.outputShape.length);const o=t.filterHeight,s=t.filterWidth,c=t.outChannels/t.inChannels;let u="",l="";n&&(u=i?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):a?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),l="result = activation(result);");const h=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(u,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(c,";\n        int q = d2 - d1 * ").concat(c,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(o,"; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(s,"; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(h,"\n        ").concat(l,"\n        setOutput(result);\n      }\n    ")}}},29196:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(37837),i=n(29150);class a{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=(0,i.ik)(this.outputShape.length);const s=t.padInfo.left,c=t.strideWidth,u=t.dilationWidth,l=t.filterHeight,h=t.filterWidth,d=h;let f="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let r=0;r<h;r++)f+="\n           vec4 xTexelC".concat(2*r,";\n           int xTexelC").concat(2*r,"Ready;\n           vec4 xTexelC").concat(2*r+1,";\n           int xTexelC").concat(2*r+1,"Ready;\n           vec4 xC").concat(r,";");f+="\n     for (int r = 0; r < ".concat(l,"; r++) {\n      for (int d1 = 0; d1 < ").concat(t.inChannels,"; d1 += 2) {\n       ");for(let r=0;r<h;r++)f+="\n           xTexelC".concat(2*r," = vec4(0.0);\n           xTexelC").concat(2*r,"Ready = 0;\n           xTexelC").concat(2*r+1," = vec4(0.0);\n           xTexelC").concat(2*r+1,"Ready = 0;\n           xC").concat(r," = vec4(0.0);");f+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let i=0;i<(d+1)/2;i++){const e=2*i;if(f+="\n           xC = xCCorner + ".concat(e*u,";\n           "),1===c){if(e<h&&(s%2===1?(f+="\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                   xTexelC").concat(e," = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(e,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(e,"Ready = 1;\n                 }\n               "),f+=1===u&&e>0?"\n                 xC".concat(e," = vec4(xTexelC").concat(e-2,".zw, xTexelC").concat(e,".xy);\n                 "):"\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC".concat(e," = vec4(previous.zw, xTexelC").concat(e,".xy);\n                   } else {\n                     xC").concat(e," = vec4(0.0, 0.0, xTexelC").concat(e,".xy);\n                   }\n                   ")):f+="\n                 if (xC >= 0 && xC < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                   xTexelC").concat(e," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(e,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(e,"Ready = 1;\n                 }\n\n                 xC").concat(e," = xTexelC").concat(e,";\n                 "),e+1<h)){const t=s%2===0?r.util.nearestLargerEven(u):u;u%2===0&&s%2===1||u%2!==0&&s%2!==1?(f+="\n                   xCOffset = xC + imod(pads[1], 2) + ".concat(t,";\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                     xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC").concat(e+1,".zw = vec2(0.0);\n                     }\n                     xTexelC").concat(e+1,"Ready = 1;\n                   }\n                   "),f+=u>1?"\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC".concat(e+1," = vec4(previous.zw, xTexelC").concat(e+1,".xy);\n                     } else {\n                      xC").concat(e+1," = vec4(0.0, 0.0, xTexelC").concat(e+1,".xy);\n                     }\n                     "):"\n                     xC".concat(e+1," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".xy);\n                     ")):f+=1===t?"\n                     xC".concat(e+1," = xTexelC").concat(e,";\n                     "):"\n                     xCOffset = xC + ".concat(t,";\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                       xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC").concat(e+1,".zw = vec2(0.0);\n                       }\n                       xTexelC").concat(e+1,"Ready = 1;\n                     }\n\n                     xC").concat(e+1," = xTexelC").concat(e+1,";\n                     ")}}else e<h&&(s%2===1?(f+="\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                   xTexelC").concat(e," = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(e,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(e,"Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                   xTexelC").concat(e+1," = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC").concat(e+1,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(e+1,"Ready = 1;\n                 }\n\n                 xC").concat(e," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".zw);\n               "),e+1<h&&(f+="\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC".concat(e+1," = vec4(xTexelC").concat(e+1,".xy, final.xy);\n                 "))):(f+="\n                 if(xC >= 0 && xC < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                   xTexelC").concat(e," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(e,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(e,"Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                   xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(e+1,".zw = vec2(0.);\n                   }\n                   xTexelC").concat(e+1,"Ready = 1;\n                 }\n\n                 xC").concat(e," = vec4(\n                   xTexelC").concat(e,".xy, xTexelC").concat(e+1,".xy);\n               "),e+1<h&&(f+="\n                   xC".concat(e+1," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".zw);\n                 "))));e<h&&(f+="\n             wTexel = getW(r, ".concat(e,", d1, d2);\n             dotProd += xC").concat(e,".xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ").concat(t.inChannels,") {\n               dotProd += xC").concat(e,".yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           "),e+1<h&&(f+="\n               wTexel = getW(r, ".concat(e+1,", d1, d2);\n               dotProd += xC").concat(e+1,".xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ").concat(t.inChannels,") {\n                 dotProd += xC").concat(e+1,".yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             ")))}f+="\n     }\n   ",f+="\n     }\n   ",f+="\n     }\n   ";let p="",g="";n&&(p=a?"vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ".concat(n,"\n         }"):o?"vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ".concat(n,"\n         }"):"vec4 activation(vec4 x) {\n           ".concat(n,"\n         }"),g="result = activation(result);");const m=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n       ".concat(p,"\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ").concat(f,"\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ").concat(m,"\n         ").concat(g,"\n         setOutput(result);\n       }\n     ")}}},34606:(t,e,n)=>{"use strict";n.d(e,{K:()=>a});var r=n(37837),i=n(29150);class a{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=(0,i.ik)(this.outputShape.length);const s=t.outChannels/t.inChannels,c=t.padInfo.left,u=t.strideWidth,l=t.dilationWidth,h=t.filterHeight,d=t.filterWidth,f=d;let p="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let r=0;r<d;r++)p+="\n          vec4 xTexelC".concat(2*r,";\n          int xTexelC").concat(2*r,"Ready;\n          vec4 xTexelC").concat(2*r+1,";\n          int xTexelC").concat(2*r+1,"Ready;\n          vec4 xC").concat(r,";");p+="\n    for (int r = 0; r < ".concat(h,"; r++) {\n      ");for(let r=0;r<d;r++)p+="\n          xTexelC".concat(2*r," = vec4(0.0);\n          xTexelC").concat(2*r,"Ready = 0;\n          xTexelC").concat(2*r+1," = vec4(0.0);\n          xTexelC").concat(2*r+1,"Ready = 0;\n          xC").concat(r," = vec4(0.0);");p+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let i=0;i<(f+1)/2;i++){const t=2*i;if(p+="\n          xC = xCCorner + ".concat(t*l,";\n          "),1===u){if(t<d&&(c%2===1?(p+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                  xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(t,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t,"Ready = 1;\n                }\n              "),p+=1===l&&t>0?"\n                xC".concat(t," = vec4(xTexelC").concat(t-2,".zw, xTexelC").concat(t,".xy);\n                "):"\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC".concat(t," = vec4(previous.zw, xTexelC").concat(t,".xy);\n                  } else {\n                    xC").concat(t," = vec4(0.0, 0.0, xTexelC").concat(t,".xy);\n                  }\n                  ")):p+="\n                if (xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                  xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(t,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t,"Ready = 1;\n                }\n\n                xC").concat(t," = xTexelC").concat(t,";\n                "),t+1<d)){const e=c%2===0?r.util.nearestLargerEven(l):l;l%2===0&&c%2===1||l%2!==0&&c%2!==1?(p+="\n                  xCOffset = xC + imod(pads[1], 2) + ".concat(e,";\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                    xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC").concat(t+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(t+1,"Ready = 1;\n                  }\n                  "),p+=l>1?"\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC".concat(t+1," = vec4(previous.zw, xTexelC").concat(t+1,".xy);\n                    } else {\n                     xC").concat(t+1," = vec4(0.0, 0.0, xTexelC").concat(t+1,".xy);\n                    }\n                    "):"\n                    xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".xy);\n                    ")):p+=1===e?"\n                    xC".concat(t+1," = xTexelC").concat(t,";\n                    "):"\n                    xCOffset = xC + ".concat(e,";\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                      xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC").concat(t+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(t+1,"Ready = 1;\n                    }\n\n                    xC").concat(t+1," = xTexelC").concat(t+1,";\n                    ")}}else t<d&&(c%2===1?(p+="\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                  xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(t,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                  xTexelC").concat(t+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC").concat(t+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t+1,"Ready = 1;\n                }\n\n                xC").concat(t," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n              "),t+1<d&&(p+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC".concat(t+1," = vec4(xTexelC").concat(t+1,".xy, final.xy);\n                "))):(p+="\n                if(xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                  xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(t,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t,"Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                  xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(t+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(t+1,"Ready = 1;\n                }\n\n                xC").concat(t," = vec4(\n                  xTexelC").concat(t,".xy, xTexelC").concat(t+1,".xy);\n              "),t+1<d&&(p+="\n                  xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n                "))));t<d&&(p+="\n            wTexel = getW(r, ".concat(t,", d1, q);\n            dotProd += xC").concat(t," * vec4(wTexel.xz, wTexel.xz);\n          "),t+1<d&&(p+="\n              wTexel = getW(r, ".concat(t+1,", d1, q);\n              dotProd += xC").concat(t+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}p+="\n    }\n  ",p+="\n      }\n    ";let g="",m="";n&&(g=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):o?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(n,"\n        }"),m="result = activation(result);");const v=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(g,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(s,";\n        int q = d2 - d1 * ").concat(s,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(p,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(v,"\n        ").concat(m,"\n        setOutput(result);\n      }\n    ")}}},17654:(t,e,n)=>{"use strict";n.d(e,{c:()=>r});class r{constructor(t,e,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[a,o,s,c]=t,[u]=e,[l,h]=n;this.outputShape=[u,l,h,c];const d="bilinear"===r?1:0,[f,p]=["".concat(o-1,".0"),"".concat(s-1,".0")],[g,m,v]=l>1?["".concat((o-1)/(l-1)),"(y2-y1) * height_ratio","y1*".concat(f," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(f)],[y,b,x]=h>1?["".concat((s-1)/(h-1)),"(x2-x1) * width_ratio","x1*".concat(p," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(p)];this.userCode="\n      const float height_ratio = float(".concat(g,");\n      const float width_ratio = float(").concat(y,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(a,") {\n          return;\n        }\n\n        float height_scale = ").concat(m,";\n        float width_scale = ").concat(b,";\n\n        float in_y = ").concat(v,";\n        if( in_y < 0.0 || in_y > ").concat(f," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n        float in_x = ").concat(x,";\n        if( in_x < 0.0 || in_x > ").concat(p," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(d," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")}}},94660:(t,e,n)=>{"use strict";n.d(e,{G:()=>a,z:()=>r});var r,i=n(41109);!function(t){t.Prod="*",t.Sum="+"}(r||(r={}));class a{constructor(t,e,n,a){this.op=t,this.outputShape=e,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const c=this.outputShape.length,u=this.op===r.Prod?"1.0":"0.0",l=n?u:"getX(".concat(o(c,"coords",this.op),")"),h=this.outputShape[this.outputShape.length-1];let d="",f="";n?(d=a?"end != ".concat(h-1):"end != 0",f=a?"end + 1":"end - 1"):(d=a?"end + pow2 < ".concat(h):"end >= pow2",f=a?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat((0,i.bf)(c)," coords = getOutputCoords();\n        int end = ").concat(s(c,"coords",this.op),";\n        float val = ").concat(l,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(d,") {\n          int idx = ").concat(f,";\n          ").concat(s(c,"coords",this.op)," = idx;\n          val ").concat(this.op,"= getX(").concat(o(c,"coords",this.op),");\n        }\n        setOutput(val);\n      }\n    ")}}function o(t,e,n){if(1===t)return"".concat(e);if(2===t)return"".concat(e,".x, ").concat(e,".y");if(3===t)return"".concat(e,".x, ").concat(e,".y, ").concat(e,".z");if(4===t)return"".concat(e,".x, ").concat(e,".y, ").concat(e,".z, ").concat(e,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(t," is not yet supported"))}function s(t,e,n){if(1===t)return"".concat(e);if(2===t)return"".concat(e,".y");if(3===t)return"".concat(e,".z");if(4===t)return"".concat(e,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(t," is not yet supported"))}},69497:(t,e,n)=>{"use strict";n.d(e,{K:()=>s});var r=n(82071),i=n(29150),a=n(31904),o=n(4870);class s{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=o.BB.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const e=(0,r.B)();this.outputShape=t,this.enableShapeUniforms=(0,i.ik)(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?a.WA(["r","c","d"],t):a.UG(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(e.output," = result;\n      }\n    ")}}},84630:(t,e,n)=>{"use strict";n.d(e,{S:()=>s});var r=n(82071),i=n(29150),a=n(31904),o=n(4870);class s{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=o.BB.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const e=(0,r.B)();this.outputShape=t,this.enableShapeUniforms=(0,i.ik)(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?a.WA(["r","c","d"],t):a.UG(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(e.output," = result;\n      }\n    ")}}},32439:(t,e,n)=>{"use strict";n.d(e,{x:()=>r});class r{constructor(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(e,";\n      int offset_h = imod(h, ").concat(e,");\n      int in_w = w / ").concat(e,";\n      int offset_w = imod(w, ").concat(e,");\n      int offset_d = (offset_h * ").concat(e," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}},23242:(t,e,n)=>{"use strict";n.d(e,{e:()=>r});class r{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}},17895:(t,e,n)=>{"use strict";n.d(e,{x:()=>r});class r{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:e,inWidth:n,padInfo:r,strideHeight:i,strideWidth:a,filterHeight:o,filterWidth:s,dilationHeight:c,dilationWidth:u}=t,{top:l,left:h}=r;this.userCode="\n      const ivec2 strides = ivec2(".concat(i,", ").concat(a,");\n      const ivec2 pads = ivec2(").concat(l,", ").concat(h,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(o,"; h++) {\n          int hIn = hBeg + h * ").concat(c,";\n\n          if (hIn >= 0 && hIn < ").concat(e,") {\n            for (int w = 0; w < ").concat(s,"; w++) {\n              int wIn = wBeg + w * ").concat(u,";\n\n              if (wIn >= 0 && wIn < ").concat(n,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}}},64810:(t,e,n)=>{"use strict";n.d(e,{$:()=>o});var r=n(82071),i=n(31904),a=n(4870);class o{constructor(t){this.variableNames=["A"],this.outTexUsage=a.tT.DOWNLOAD;const e=(0,r.B)();this.outputShape=t,this.userCode="\n      ".concat(i.G2,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(e.output," = encode_float(x);\n      }\n    ")}}},94515:(t,e,n)=>{"use strict";n.d(e,{N:()=>o});var r=n(82071),i=n(31904),a=n(4870);class o{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=a.tT.DOWNLOAD;const e=(0,r.B)();this.outputShape=t,this.userCode="\n      ".concat(i.G2,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(e.output," = encode_float(x);\n      }\n    ")}}},89893:(t,e,n)=>{"use strict";n.d(e,{C:()=>s});var r=n(82071),i=n(29150),a=n(31904);const o={R:0,G:1,B:2,A:3};class s{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"RGBA";this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=(0,r.B)();this.outputShape=t,this.enableShapeUniforms=(0,i.ik)(this.outputShape.length);let c="result";e&&(c="floor(result * 255. + 0.5)");let u="";for(let r=0;r<n.length;r++){const t=n[r];u+="\n          if(offset == ".concat(r,") {\n            result = values[").concat(o[t],"];\n          }")}this.userCode="\n      ".concat(this.enableShapeUniforms?a.Od():a.fM(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ").concat(n.length,");\n\n        flatIndex = idiv(flatIndex, ").concat(n.length,", 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ").concat(s.texture2D,"(A, uv);\n          ").concat(u,"\n        }\n        ").concat(s.output," = vec4(").concat(c,", 0., 0., 0.);\n      }\n    ")}}},9522:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var r=n(82071),i=n(29150),a=n(31904);class o{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=(0,r.B)();this.outputShape=t,this.enableShapeUniforms=(0,i.ik)(this.outputShape.length);let o="",s="result";e&&(s="floor(result * 255. + 0.5)");for(let r=0;r<=1;r++)for(let e=0;e<=1;e++){const i=2*r+e;o+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(e," < ").concat(this.enableShapeUniforms?"outShape[2]":"".concat(t[2]),") {\n          localCoords[2] += ").concat(e,";\n          if (localCoords[1] + ").concat(r," < ").concat(this.enableShapeUniforms?"outShape[1]":"".concat(t[1]),") {\n            localCoords[1] += ").concat(r,";\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ").concat(n.texture2D,"(A, uv);\n\n            if (offset == 0) {\n              result[").concat(i,"] = values[0];\n            } else if (offset == 1) {\n              result[").concat(i,"] = values[1];\n            } else if (offset == 2) {\n              result[").concat(i,"] = values[2];\n            } else {\n              result[").concat(i,"] = values[3];\n            }\n          }\n        }\n        ")}this.userCode="\n        ".concat(this.enableShapeUniforms?a.Od():a.fM(t),"\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ").concat(o,"\n\n          ").concat(n.output," = ").concat(s,";\n        }\n    ")}}},65711:(t,e,n)=>{"use strict";n.d(e,{R:()=>r});class r{constructor(t,e,n){this.variableNames=["real","imag"];const r=e[1];this.outputShape=e;const i=n?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),a=n?"".concat(r,".0"):"1.0";let o;if("real"===t)o="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error('FFT component must be either "real" or "imag", got '.concat(t,"."));o="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(i,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(o,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(r,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(r,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(a,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}}},24304:(t,e,n)=>{"use strict";n.d(e,{w:()=>r});class r{constructor(t,e){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}}},75255:(t,e,n)=>{"use strict";var r=n(37837),i=n(11414);const a=(0,r.env)();a.registerFlag("HAS_WEBGL",(()=>a.getNumber("WEBGL_VERSION")>0)),a.registerFlag("WEBGL_VERSION",(()=>(0,i.Zj)(2)?2:(0,i.Zj)(1)?1:0)),a.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(()=>!1)),a.registerFlag("WEBGL_BUFFER_SUPPORTED",(()=>2===a.get("WEBGL_VERSION"))),a.registerFlag("WEBGL_CPU_FORWARD",(()=>!0)),a.registerFlag("WEBGL_FORCE_F16_TEXTURES",(()=>!1)),a.registerFlag("WEBGL_PACK",(()=>a.getBool("HAS_WEBGL"))),a.registerFlag("WEBGL_PACK_NORMALIZATION",(()=>a.getBool("WEBGL_PACK"))),a.registerFlag("WEBGL_PACK_CLIP",(()=>a.getBool("WEBGL_PACK"))),a.registerFlag("WEBGL_PACK_DEPTHWISECONV",(()=>a.getBool("WEBGL_PACK"))),a.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(()=>a.getBool("WEBGL_PACK"))),a.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(()=>a.getBool("WEBGL_PACK"))),a.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(()=>a.getBool("WEBGL_PACK"))),a.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(()=>a.getBool("WEBGL_PACK"))),a.registerFlag("WEBGL_PACK_REDUCE",(()=>a.getBool("WEBGL_PACK"))),a.registerFlag("WEBGL_LAZILY_UNPACK",(()=>a.getBool("WEBGL_PACK"))),a.registerFlag("WEBGL_CONV_IM2COL",(()=>a.getBool("WEBGL_PACK"))),a.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",(()=>a.getBool("WEBGL_PACK"))),a.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(()=>(0,i.Se)(a.getNumber("WEBGL_VERSION")))),a.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(()=>(0,i.jL)(a.getNumber("WEBGL_VERSION")))),a.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(()=>{const t=a.getNumber("WEBGL_VERSION");return 0===t?0:(0,i.VJ)(t)})),a.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(()=>a.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!r.device_util.isMobile())),a.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(()=>(0,i.I2)(a.getNumber("WEBGL_VERSION")))),a.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(()=>!a.getBool("WEBGL_FORCE_F16_TEXTURES")&&a.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))),a.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(()=>(0,i.N6)(a.getNumber("WEBGL_VERSION")))),a.registerFlag("WEBGL_FENCE_API_ENABLED",(()=>(0,i.Ut)(a.getNumber("WEBGL_VERSION")))),a.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(()=>a.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0)),a.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(()=>-1),(t=>{if("number"!==typeof t)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but "+"got ".concat(t,"."));if(t<0&&-1!==t)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(t,"."))})),a.registerFlag("WEBGL_FLUSH_THRESHOLD",(()=>r.device_util.isMobile()?1:-1),(t=>{if("number"!==typeof t)throw new Error("WEBGL_FLUSH_THRESHOLD must be a number but got "+"".concat(t,"."));if(t<0&&-1!==t)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(t,"."))})),a.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",(()=>128)),a.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",(()=>!1)),a.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",(()=>1e5)),a.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",(()=>128)),a.registerFlag("WEBGL_EXP_CONV",(()=>!1)),a.registerFlag("SOFTWARE_WEBGL_ENABLED",(()=>a.getBool("IS_TEST"))),a.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",(()=>1/0)),a.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",(()=>!1)),a.registerFlag("WEBGL2_ISNAN_CUSTOM",(()=>!1)),a.registerFlag("ENGINE_COMPILE_ONLY",(()=>!1))},51927:(t,e,n)=>{"use strict";n.d(e,{T:()=>r});class r{constructor(t){this.variableNames=["Image"],this.outputShape=[];const e=t[2];this.outputShape=t,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(e," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(e,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}},25554:(t,e,n)=>{"use strict";n.d(e,{u:()=>i});var r=n(41109);class i{constructor(t,e){this.variableNames=["A","indices"],this.outputShape=e,this.rank=e.length;const n=(0,r.bf)(this.rank),i=function(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let i=0;i<t.length;i++)2===i?r.push("index"):r.push("".concat(n[i]));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(n," resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ").concat(t[2],") ? 1.0 : 0.0;\n        setOutput(inBounds * getA(").concat(i,"));\n      }\n    ")}}},97893:(t,e,n)=>{"use strict";n.d(e,{g:()=>i});var r=n(41109);class i{constructor(t,e,n,i){this.sliceDim=t,this.strides=e,this.paramsShape=i,this.variableNames=["x","indices"],this.outputShape=n;const a=(0,r.bf)(n.length);let o="\n    int index;";for(let r=0;r<this.sliceDim;r++)o+="\n          index = round(getIndices(coords[0], ".concat(r,"));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ").concat(this.paramsShape[r],";\n          flattenIndex += index * ").concat(this.strides[r],";");this.userCode="\n         void main() {\n          ".concat(a," coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ").concat(o,"\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      ")}}},82071:(t,e,n)=>{"use strict";n.d(e,{B:()=>i});var r=n(37837);function i(){let t,e,n,i,a,o,s,c,u,l;return 2===(0,r.env)().getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",i="in",a="texture",o="outputColor",s="out vec4 outputColor;",c=(0,r.env)().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",u="",l="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",i="varying",a="texture2D",o="gl_FragColor",s="",c="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",l="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:i,texture2D:a,output:o,defineOutput:s,defineSpecialNaN:c,defineSpecialInf:u,defineRound:l}}},98293:(t,e,n)=>{"use strict";n.d(e,{n:()=>c});var r=n(37837),i=n(44455),a=n(40948),o=n(4870),s=n(11414);class c{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const e=(0,r.env)().getNumber("WEBGL_VERSION");if(null!=t?(this.gl=t,(0,i.lj)(e,t)):this.gl=(0,i.bU)(e),t=this.gl,2===(0,r.env)().getNumber("WEBGL_VERSION")){const e=t;this.createVertexArray=()=>s.ul(e,(()=>e.createVertexArray())),this.bindVertexArray=t=>s.ul(e,(()=>e.bindVertexArray(t))),this.deleteVertexArray=t=>s.ul(e,(()=>e.deleteVertexArray(t))),this.getVertexArray=()=>s.ul(e,(()=>e.getParameter(e.VERTEX_ARRAY_BINDING)))}else if(null!=t){const e=t.getExtension("OES_vertex_array_object");if(null==e)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>s.ul(t,(()=>e.createVertexArrayOES())),this.bindVertexArray=n=>s.ul(t,(()=>e.bindVertexArrayOES(n))),this.deleteVertexArray=n=>s.ul(t,(()=>e.deleteVertexArrayOES(n))),this.getVertexArray=()=>s.ul(t,(()=>t.getParameter(e.VERTEX_ARRAY_BINDING_OES)))}let n="WEBGL_color_buffer_float";const c="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===(0,r.env)().getNumber("WEBGL_VERSION")){const t="OES_texture_float",e="OES_texture_half_float";if(this.textureFloatExtension=s.HM(this.gl,t),s.Ql(this.gl,e))this.textureHalfFloatExtension=s.HM(this.gl,e);else if((0,r.env)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),s.Ql(this.gl,c))this.colorBufferHalfFloatExtension=s.HM(this.gl,c);else if((0,r.env)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",s.Ql(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!s.Ql(this.gl,c))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(c)}this.vertexBuffer=a.b1(this.gl),this.indexBuffer=a.Ng(this.gl),this.framebuffer=s.oN(this.gl),this.textureConfig=o.EZ(this.gl,this.textureHalfFloatExtension)}get debug(){return(0,r.env)().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;s.ul(t,(()=>t.finish())),s.ul(t,(()=>t.bindFramebuffer(t.FRAMEBUFFER,null))),s.ul(t,(()=>t.deleteFramebuffer(this.framebuffer))),s.ul(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,null))),s.ul(t,(()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null))),s.ul(t,(()=>t.deleteBuffer(this.indexBuffer))),this.disposed=!0}createFloat32MatrixTexture(t,e){return this.throwIfDisposed(),a.cD(this.gl,t,e,this.textureConfig)}createFloat16MatrixTexture(t,e){return this.throwIfDisposed(),a.WH(this.gl,t,e,this.textureConfig)}createUnsignedBytesMatrixTexture(t,e){return this.throwIfDisposed(),a.Hw(this.gl,t,e,this.textureConfig)}uploadPixelDataToTexture(t,e){this.throwIfDisposed(),a.qg(this.gl,t,e)}uploadDenseMatrixToTexture(t,e,n,r){this.throwIfDisposed(),a.y7(this.gl,t,e,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(t,e){return this.throwIfDisposed(),a.Me(this.gl,t,e,this.textureConfig)}createPackedMatrixTexture(t,e){return this.throwIfDisposed(),a.bG(this.gl,t,e,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(s.sA(this.gl,this.framebuffer),this.outputTexture=null),s.ul(this.gl,(()=>this.gl.deleteTexture(t)))}downloadByteEncodedFloatMatrixFromOutputTexture(t,e,n){return this.downloadMatrixDriver(t,(()=>a.ir(this.gl,e,n,this.textureConfig)))}downloadPackedMatrixFromBuffer(t,e,n,r,i,o){return a.SD(this.gl,t,e,n,r,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,e){return a.$k(this.gl,t,e)}createBufferFromTexture(t,e,n){this.bindTextureToFrameBuffer(t);const r=a.zP(this.gl,e,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let e,n;if((0,r.env)().getBool("WEBGL_FENCE_API_ENABLED")){const r=t,i=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=()=>{const t=r.clientWaitSync(i,0,0);return t===r.ALREADY_SIGNALED||t===r.CONDITION_SATISFIED},e=i}else(0,r.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(e,(0,r.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:e,isFencePassed:n}}downloadMatrixFromPackedTexture(t,e,n){return this.downloadMatrixDriver(t,(()=>a.uS(this.gl,e,n)))}createProgram(t){this.throwIfDisposed();const e=this.gl;null==this.vertexShader&&(this.vertexShader=a.yr(e));const n=s.rC(e);s.ul(e,(()=>e.attachShader(n,this.vertexShader))),s.ul(e,(()=>e.attachShader(n,t))),s.R7(e,n);const r=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&s.bz(e,r),r}buildVao(t){this.setProgram(t),this.bindVertexArray(t.vao);const e=this.gl;s.ul(e,(()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer))),a.Z(e,t,this.vertexBuffer)}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&(s.ul(this.gl,(()=>this.gl.deleteProgram(t))),this.deleteVertexArray(t.vao))}setProgram(t){this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&s.bz(this.gl,this.program),s.ul(this.gl,(()=>this.gl.useProgram(t)))}getUniformLocation(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?s.Rh(this.gl,t,e):s.Yn(this.gl,t,e)}getAttributeLocation(t,e){return this.throwIfDisposed(),s.ul(this.gl,(()=>this.gl.getAttribLocation(t,e)))}getUniformLocationNoThrow(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)}setInputMatrixTexture(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),s.y_(this.gl,t,e,n)}setOutputMatrixTexture(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)}setOutputPackedMatrixTexture(t,e,n){this.throwIfDisposed();const[r,i]=o.NO(e,n);this.setOutputMatrixTextureDriver(t,r,i)}setOutputMatrixWriteRegion(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)}setOutputPackedMatrixWriteRegion(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&s.bz(this.gl,this.program),s.s6(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;if(this.debug){const t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}s.ul(t,(()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),s.ul(this.gl,(()=>this.gl.finish()))}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=s.HM(this.gl,2===(0,r.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===(0,r.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}const t=this.getQueryTimerExtensionWebGL1(),e=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,e),e}endQuery(){if(2===(0,r.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2();return void t.endQuery(e.TIME_ELAPSED_EXT)}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await r.util.repeatedTry((()=>this.disposed||this.isQueryAvailable(t,(0,r.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")))),this.getQueryTime(t,(0,r.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,e){if(0===e)return null;if(2===e){const e=this.gl;return e.getQueryParameter(t,e.QUERY_RESULT)/1e6}{const e=this.getQueryTimerExtensionWebGL1();return e.getQueryObjectEXT(t,e.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,e){if(0===e)return!0;if(2===e){const e=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=e.getQueryParameter(t,e.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}{const e=this.getQueryTimerExtensionWebGL1(),n=e.getQueryObjectEXT(t,e.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(e.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(t){return new Promise((e=>{this.addItemToPoll((()=>t.isFencePassed()),(()=>e()))}))}pollItems(){const t=function(t){let e=0;for(;e<t.length;++e){if(!t[e]())break}return e-1}(this.itemsToPoll.map((t=>t.isDoneFn)));for(let e=0;e<=t;++e){const{resolveFn:t}=this.itemsToPoll[e];t()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,e){if(this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in(0,r.env)().platform&&(n=(0,r.env)().platform.setTimeoutCustom.bind((0,r.env)().platform)),r.util.repeatedTry((()=>(this.pollItems(),0===this.itemsToPoll.length)),(()=>0),null,n)}bindTextureToFrameBuffer(t){this.throwIfDisposed(),s.SO(this.gl,t,this.framebuffer),this.debug&&s.s6(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(s.SO(this.gl,this.outputTexture,this.framebuffer),this.debug&&s.s6(this.gl)):s.sA(this.gl,this.framebuffer)}downloadMatrixDriver(t,e){this.bindTextureToFrameBuffer(t);const n=e();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(t,e,n){this.throwIfDisposed();const r=this.gl;s.SO(r,t,this.framebuffer),this.debug&&s.s6(r),this.outputTexture=t,s.ul(r,(()=>r.viewport(0,0,e,n))),s.ul(r,(()=>r.scissor(0,0,e,n)))}setOutputMatrixWriteRegionDriver(t,e,n,r){this.throwIfDisposed(),s.ul(this.gl,(()=>this.gl.scissor(t,e,n,r)))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}},29150:(t,e,n)=>{"use strict";n.d(e,{Kz:()=>o,Tb:()=>l,Tw:()=>s,ik:()=>h,mB:()=>u});var r=n(37837),i=n(41109),a=n(11414);function o(t,e,n,o){const c=n.map(((t,n)=>{const r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}})),u=c.map((t=>t.shapeInfo)),l={logicalShape:o.shape,texShape:o.texData.texShape,isUniform:!1,isPacked:o.texData.isPacked,flatOffset:null},h=i.yr(c,l,e),d=(0,a.yG)(t.gl,h),f=t.createProgram(d);return(0,r.env)().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:d,source:h,webGLProgram:f,inShapeInfos:u,outShapeInfo:l,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(f),Object.assign({program:e,fragmentShader:d,source:h,webGLProgram:f,inShapeInfos:u,outShapeInfo:l},s(t,e,f)))}function s(t,e,n){const i=[],a=[];let o,s,c,u=null,l=null;l=t.getUniformLocation(n,"NAN",!1),1===(0,r.env)().getNumber("WEBGL_VERSION")&&(u=t.getUniformLocation(n,"INFINITY",!1));const h=!1;for(const r of e.variableNames){const a={name:r,uniform:t.getUniformLocation(n,r,h),offset:t.getUniformLocation(n,"offset".concat(r),h)};e.enableShapeUniforms&&(a.shape=t.getUniformLocation(n,"".concat(r,"Shape"),h),a.texShape=t.getUniformLocation(n,"".concat(r,"TexShape"),h)),i.push(a)}if(e.enableShapeUniforms&&(o=t.getUniformLocation(n,"outShape",h),c=t.getUniformLocation(n,"outShapeStrides",h),s=t.getUniformLocation(n,"outTexShape",h)),e.customUniforms)for(const r of e.customUniforms)a.push(t.getUniformLocation(n,r.name,h));return{variablesLocations:i,customUniformLocations:a,infLoc:u,nanLoc:l,outShapeLocation:o,outShapeStridesLocation:c,outTexShapeLocation:s}}function c(t,e){if(t.length!==e.length)throw Error("Binary was compiled with ".concat(t.length," inputs, but ")+"was executed with ".concat(e.length," inputs"));t.forEach(((t,n)=>{const i=t.logicalShape,a=e[n],o=a.shape;if(!r.util.arraysEqual(i,o))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(i," and ").concat(o," must match"));if(t.isUniform&&a.isUniform)return;const s=t.texShape,c=a.isUniform?null:a.texData.texShape;if(!r.util.arraysEqual(s,c))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(s," and ").concat(c," must match"))}))}function u(t,e,n,a,o){e.program.enableShapeUniforms||(c(e.inShapeInfos,n),c([e.outShapeInfo],[a]));const s=a.texData.texture,u=a.texData.texShape;a.texData.isPacked?t.setOutputPackedMatrixTexture(s.texture,u[0],u[1]):t.setOutputMatrixTexture(s.texture,u[0],u[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),1===(0,r.env)().getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN);for(let c=0;c<n.length;++c){const a=n[c],{uniform:o,offset:s,shape:u,texShape:l}=e.variablesLocations[c];if(u){const{uniformShape:n}=i.YE(e.program.packedInputs,a.shape,a.texData.texShape);switch(n.length){case 1:t.gl.uniform1iv(u,new Int32Array(n));break;case 2:t.gl.uniform2iv(u,new Int32Array(n));break;case 3:t.gl.uniform3iv(u,new Int32Array(n));break;case 4:t.gl.uniform4iv(u,new Int32Array(n))}}if(l&&t.gl.uniform2i(l,a.texData.texShape[0],a.texData.texShape[1]),null!=o)if(a.isUniform)if(r.util.sizeFromShape(a.shape)<2)t.gl.uniform1f(o,a.uniformValues[0]);else{let e=a.uniformValues;e instanceof Float32Array||(e=new Float32Array(e)),t.gl.uniform1fv(o,e)}else null!=a.texData.slice&&null!=s&&t.gl.uniform1i(s,a.texData.slice.flatOffset),t.setInputMatrixTexture(a.texData.texture.texture,o,c)}const l=e.outShapeLocation;if(l)switch(a.shape.length){case 1:t.gl.uniform1iv(l,new Int32Array(a.shape));break;case 2:t.gl.uniform2iv(l,new Int32Array(a.shape));break;case 3:t.gl.uniform3iv(l,new Int32Array(a.shape));break;case 4:t.gl.uniform4iv(l,new Int32Array(a.shape))}if(e.outShapeStridesLocation){const n=r.util.computeStrides(a.shape);switch(a.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(n));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(n));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(n))}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,a.texData.texShape[0],a.texData.texShape[1]),e.program.customUniforms&&o)for(let r=0;r<e.program.customUniforms.length;++r){const n=e.program.customUniforms[r],i=e.customUniformLocations[r],a=o[r];if("float"===n.type)t.gl.uniform1fv(i,a);else if("vec2"===n.type)t.gl.uniform2fv(i,a);else if("vec3"===n.type)t.gl.uniform3fv(i,a);else if("vec4"===n.type)t.gl.uniform4fv(i,a);else if("int"===n.type)t.gl.uniform1iv(i,a);else if("ivec2"===n.type)t.gl.uniform2iv(i,a);else if("ivec3"===n.type)t.gl.uniform3iv(i,a);else{if("ivec4"!==n.type)throw Error("uniform type ".concat(n.type," is not supported yet."));t.gl.uniform4iv(i,a)}}t.executeProgram()}function l(t,e,n){let a="";e.concat(n).forEach((e=>{const o=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!e.isUniform){const s=e.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:l}=i.YE(t.packedInputs,e.shape,s);let h="",d="",f="";if(1===u.length&&t.packedInputs){const t=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];h="".concat(t[0]>1,"_").concat(t[1]>1)}else if(2!==u.length||t.packedInputs){if(u.length>2&&!t.packedInputs){const t=r.util.computeStrides(u);f="".concat(t[0]===s[1],"_").concat(t[t.length-1]===s[1])}}else d="".concat(u[0]>1,"_").concat(u[1]>1);const p=e.shape.length,g=2===u.length&&r.util.arraysEqual(e.shape,s),m=1===r.util.sizeFromShape(e.shape),v=r.backend_util.getBroadcastDims(e.shape,n.shape),y=!t.packedInputs&&p===n.shape.length&&r.util.arraysEqual(s,n.texData.texShape),b=t.packedInputs||u.length>2?"":"".concat(s[0]>1,"_").concat(s[1]>1);a+="".concat(p,"_").concat(y,"_").concat(c?l:"","_").concat(u.length,"_").concat(m,"_").concat(v,"_").concat(g,"_").concat(h,"_").concat(d,"_").concat(f,"_").concat(b,"_").concat(o)}else{const t=e.isUniform?"uniform":e.texData.texShape;a+="".concat(e.shape,"_").concat(t,"_").concat(o)}}));const o=t.userCode;let s=t.constructor.name;return s+="_"+a+"_"+o+"".concat((0,r.env)().getNumber("WEBGL_VERSION")),s}function h(t){return(0,r.env)().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}},40948:(t,e,n)=>{"use strict";n.d(e,{$k:()=>C,Hw:()=>m,Ij:()=>v,J$:()=>f,Me:()=>x,Ng:()=>u,SD:()=>E,WH:()=>p,Z:()=>w,b1:()=>c,bG:()=>y,cD:()=>d,fj:()=>h,ir:()=>S,qg:()=>_,uS:()=>T,wM:()=>g,y7:()=>k,yr:()=>s,z8:()=>b,zP:()=>A});var r=n(37837),i=n(82071),a=n(4870),o=n(11414);function s(t){const e=(0,i.B)(),n="".concat(e.version,"\n    precision highp float;\n    ").concat(e.attribute," vec3 clipSpacePos;\n    ").concat(e.attribute," vec2 uv;\n    ").concat(e.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }");return o.yr(t,n)}function c(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return o.HW(t,e)}function u(t){const e=new Uint16Array([0,1,2,2,1,3]);return o.$e(t,e)}function l(t,e,n,i,a,s){o.ph(e,n);const c=o.sZ(t),u=t.TEXTURE_2D;return o.ul(t,(()=>t.bindTexture(u,c))),o.ul(t,(()=>t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE))),o.ul(t,(()=>t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE))),o.ul(t,(()=>t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST))),o.ul(t,(()=>t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST))),1===(0,r.env)().getNumber("WEBGL_VERSION")?o.ul(t,(()=>t.texImage2D(u,0,i,e,n,0,a,s,null))):o.ul(t,(()=>t.texStorage2D(u,1,i,e,n))),o.ul(t,(()=>t.bindTexture(t.TEXTURE_2D,null))),{texture:c,texShape:[n,e]}}function h(t){return t.internalFormatFloat}function d(t,e,n,r){const[i,o]=a.Qn(e,n);return l(t,i,o,h(r),r.textureFormatFloat,t.FLOAT)}function f(t){return t.internalFormatHalfFloat}function p(t,e,n,r){const[i,o]=a.Qn(e,n);return l(t,i,o,f(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function g(t){return t.downloadTextureFormat}function m(t,e,n,r){const[i,o]=a.Qn(e,n);return l(t,i,o,g(r),t.RGBA,t.UNSIGNED_BYTE)}function v(t){return t.internalFormatPackedFloat}function y(t,e,n,r){const[i,o]=a.NO(e,n);return l(t,i,o,v(r),t.RGBA,t.FLOAT)}function b(t){return t.internalFormatPackedHalfFloat}function x(t,e,n,r){const[i,o]=a.NO(e,n);return l(t,i,o,b(r),t.RGBA,r.textureTypeHalfFloat)}function w(t,e,n){o.ul(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,n)));return o.rw(t,e,"clipSpacePos",n,3,20,0)&&o.rw(t,e,"uv",n,2,20,12)}function k(t,e,n,i,a,s){let c,u,l;o.ul(t,(()=>t.bindTexture(t.TEXTURE_2D,e))),a instanceof Uint8Array?(c=new Uint8Array(n*i*4),u=t.UNSIGNED_BYTE,l=t.RGBA):(c=new Float32Array(n*i*4),u=t.FLOAT,l=s.internalFormatPackedFloat),c.set(a),2===(0,r.env)().getNumber("WEBGL_VERSION")?o.ul(t,(()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,i,t.RGBA,u,c))):o.ul(t,(()=>t.texImage2D(t.TEXTURE_2D,0,l,n,i,0,t.RGBA,u,c))),o.ul(t,(()=>t.bindTexture(t.TEXTURE_2D,null)))}function _(t,e,n){o.ul(t,(()=>t.bindTexture(t.TEXTURE_2D,e))),n.data instanceof Uint8Array?2===(0,r.env)().getNumber("WEBGL_VERSION")?o.ul(t,(()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data))):o.ul(t,(()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data))):2===(0,r.env)().getNumber("WEBGL_VERSION")?o.ul(t,(()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n))):o.ul(t,(()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n))),o.ul(t,(()=>t.bindTexture(t.TEXTURE_2D,null)))}function A(t,e,n,r){const i=t.createBuffer();o.ul(t,(()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,i)));const a=16*e*n;return o.ul(t,(()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ))),o.ul(t,(()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0))),o.ul(t,(()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null))),i}function C(t,e,n){const r=t,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function S(t,e,n,r){const[i,s]=a.Qn(e,n),c=new Uint8Array(a.EX(e*n,4));return o.ul(t,(()=>t.readPixels(0,0,i,s,r.downloadTextureFormat,t.UNSIGNED_BYTE,c))),new Float32Array(c.buffer)}function E(t,e,n,r,i,o,s,c){const u=t,l=new Float32Array(a.PM(o,s));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function T(t,e,n){const r=new Float32Array(e*n*4);return o.ul(t,(()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r))),r}},41988:(t,e,n)=>{"use strict";n.d(e,{D:()=>a});var r=n(82071),i=n(29150);class a{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=(0,i.ik)(this.outputShape.length);const{dataFormat:n}=e,a=(0,r.B)(),o="channelsLast"===n,s=o?1:2,c=o?2:3,u=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < ".concat(t[2]," && pos < ").concat(t[1],") {");let l="";for(let r=0;r<=1;r++)for(let t=0;t<=1;t++)l+="\n          blockIndex = rc.z + ".concat(t,";\n          pos = rc.y + ").concat(r,";\n\n          ").concat(u,"\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[").concat(s,"] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[").concat(c,"] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (").concat(o,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*r+t,"] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*r+t,"] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(l,"\n\n        ").concat(a.output," = result;\n      }\n    ")}}},13686:(t,e,n)=>{"use strict";n.d(e,{$p:()=>r.$p});var r=n(74141);n(76692)},97994:(t,e,n)=>{"use strict";n.d(e,{f:()=>u});var r=n(37837),i=n(80209),a=n(49406),o=n(52813);function s(t,e,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=e.shape[0],c=e.shape[1];null!=a&&(o=a.shape[0],c=a.shape[1]);const u=r.backend_util.computeOptimalWindowSize(c),l={windowSize:u,inSize:c,batchSize:o,outSize:Math.ceil(c/u)},h=new i.l(l,n,null==a),d=[e];null!=a&&d.push(a);const f=t.runWebGLProgram(h,d,"int32");if(1===f.shape[1])return f;const p=s(t,e,n,f);return t.disposeIntermediateTensorInfo(f),p}function c(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const o=null!=i?i.shape:e.shape,s=o[o.length-1],u=r.backend_util.computeOptimalWindowSize(s),l=new a.l(o,u,n,null==i),h=null==i?[e]:[e,i],d=t.runWebGLProgram(l,h,"int32");if(d.shape.length===e.shape.length){const r=c(t,e,n,d);return t.disposeIntermediateTensorInfo(d),r}return d}function u(t,e,n,i){const a=[n];if(r.backend_util.assertAxesAreInnerMostDims("arg"+i.charAt(0).toUpperCase()+i.slice(1),a,e.shape.length),!(0,r.env)().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const n=[],c=t.texData.get(e.dataId);let u=e;null!==c&&c.isPacked&&(u=t.unpackTensor(e),n.push(u));const[l,h]=r.backend_util.computeOutAndReduceShapes(u.shape,a),d=r.util.sizeFromShape(h),f=(0,o.t)({inputs:{x:u},backend:t,attrs:{shape:[-1,d]}});n.push(f);const p=s(t,f,i);n.push(p);const g=(0,o.t)({inputs:{x:p},backend:t,attrs:{shape:l}});return n.forEach((e=>t.disposeIntermediateTensorInfo(e))),g}return c(t,e,i)}},91965:(t,e,n)=>{"use strict";n.d(e,{W:()=>a});var r=n(23199);const i="return float(int(x));";function a(t,e){const n=new r.hE(t.shape,i),a=e.runWebGLProgram(n,[t],"int32");return{dataId:a.dataId,shape:a.shape,dtype:a.dtype}}},55289:(t,e,n)=>{"use strict";n.d(e,{Zt:()=>h,bE:()=>p,j0:()=>f,vi:()=>d});var r=n(37837),i=n(74139),a=n(61880),o=n(5795),s=n(36267),c=n(35329),u=n(23199),l=n(53884);const h="if (isnan(x)) return x;";function d(t){let{opSnippet:e,packedOpSnippet:n,cpuKernelImpl:i,dtype:a}=t;return t=>{let{inputs:o,backend:s}=t;const{x:c}=o,h=s,d=a||c.dtype;if(h.shouldExecuteOnCPU([c])&&null!=i){const t=h.texData.get(c.dataId),e=i(t.values,d);return h.makeTensorInfo(c.shape,d,e)}let f;return f=(0,r.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new l.rf(c.shape,n):new u.hE(c.shape,e),h.runWebGLProgram(f,[c],d)}}function f(t){let{opSnippet:e,packedOpSnippet:n,checkOutOfBounds:s=!1,supportsComplex:c=!1,cpuKernelImpl:u,dtype:l}=t;return t=>{let{inputs:h,backend:d}=t;const{a:f,b:p}=h,g=d;if(c&&"complex64"===f.dtype){const t=g.texData.get(f.dataId),n=g.texData.get(p.dataId),[a,s]=[[t.complexTensorInfos.real,n.complexTensorInfos.real],[t.complexTensorInfos.imag,n.complexTensorInfos.imag]].map((t=>{const[n,a]=t,o={dataId:n.dataId,dtype:n.dtype,shape:f.shape},s={dataId:a.dataId,dtype:a.dtype,shape:p.shape},c=new i.x(e,f.shape,p.shape);return g.runWebGLProgram(c,[o,s],(0,r.upcastType)(n.dtype,a.dtype))})),c=(0,o.f)({inputs:{real:a,imag:s},backend:g});return g.disposeIntermediateTensorInfo(a),g.disposeIntermediateTensorInfo(s),c}const m=l||(0,r.upcastType)(f.dtype,p.dtype);if(("string"===f.dtype||"string"===p.dtype||g.shouldExecuteOnCPU([f,p]))&&null!=u){const t=g.texData.get(f.dataId).values,e=g.texData.get(p.dataId).values,n="string"===f.dtype?r.backend_util.fromUint8ToStringArray(t):t,i="string"===f.dtype?r.backend_util.fromUint8ToStringArray(e):e,[a,o]=u(f.shape,p.shape,n,i,m),s=g.makeTensorInfo(o,m);return g.texData.get(s.dataId).values=a,s}let v;return v=(0,r.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new a.VI(n,f.shape,p.shape,s):new i.x(e,f.shape,p.shape),g.runWebGLProgram(v,[f,p],m)}}function p(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===t)return e?l._Q:u._Q;if("relu"===t)return e?l.X8:u.X8;if("elu"===t)return e?l.X0:u.X0;if("relu6"===t)return e?l.Nb:u.Nb;if("prelu"===t)return e?c.CN:c.DH;if("leakyrelu"===t)return e?s.aw:s.B1;if("sigmoid"===t)return e?l.Hq:u.Hq;throw new Error("Activation ".concat(t," has not been implemented for the WebGL backend."))}},71912:(t,e,n)=>{"use strict";n.d(e,{T:()=>o});var r=n(37837),i=n(43324),a=n(38903);function o(t,e,n,o){const s=function(t){const e=[];for(;0===e.length||1!==e[e.length-1].outSize;){const n=e.length?e[e.length-1].outSize:t[1],i=r.backend_util.computeOptimalWindowSize(n);e.push({inSize:n,windowSize:i,outSize:Math.ceil(n/i)})}return e}(t.shape);let c=t;for(let r=0;r<s.length;r++){const{inSize:u,windowSize:l,outSize:h}=s[r];let d,f;d="mean"===n?0===r?new i.C({windowSize:l,inSize:u,batchSize:t.shape[0],outSize:h},u):new i.C({windowSize:l,inSize:u,batchSize:t.shape[0],outSize:h}):new a.t({windowSize:l,inSize:u,batchSize:t.shape[0],outSize:h},n),f=c,c=o.runWebGLProgram(d,[c],e),f.dataId!==t.dataId&&o.disposeIntermediateTensorInfo(f)}return c}},47306:(t,e,n)=>{"use strict";n.d(e,{p:()=>a});var r=n(95002),i=n(11414);function a(t,e,n){const a=[(0,i.N0)(t.shape),...(0,i.Ph)(t.shape)],o={dtype:t.dtype,shape:a,dataId:t.dataId},s=[(0,i.N0)(e),...(0,i.Ph)(e)],c=new r.R(s,a),u=[a],l=n.runWebGLProgram(c,[o],t.dtype,u,!0);return{dataId:l.dataId,shape:e,dtype:l.dtype}}},37999:(t,e,n)=>{"use strict";n.d(e,{$O:()=>K,AC:()=>w,BC:()=>z,BW:()=>y,CJ:()=>p,Dy:()=>A,E$:()=>d,G3:()=>I,G4:()=>F,Gs:()=>i,J3:()=>L,Kf:()=>c,LF:()=>W,M_:()=>$,Md:()=>u,Og:()=>N,Oy:()=>D,PA:()=>s,PP:()=>h,Q5:()=>Z,QM:()=>m,S6:()=>H,SF:()=>f,Tm:()=>v,UC:()=>G,UF:()=>g,Xe:()=>S,ad:()=>T,cy:()=>q,dv:()=>l,f8:()=>B,fC:()=>R,fW:()=>Y,h:()=>C,h0:()=>o,jm:()=>a,lL:()=>X,mo:()=>x,rI:()=>k,rQ:()=>E,rw:()=>_,sB:()=>P,tc:()=>O,uw:()=>b,vo:()=>j,we:()=>M,xt:()=>Q,yZ:()=>V,zN:()=>U});var r=n(36214);const{addImpl:i,bincountImpl:a,bincountReduceImpl:o,bitwiseAndImpl:s,castImpl:c,ceilImpl:u,concatImpl:l,equalImpl:h,expImpl:d,expm1Impl:f,floorImpl:p,gatherNdImpl:g,gatherV2Impl:m,greaterImpl:v,greaterEqualImpl:y,lessImpl:b,lessEqualImpl:x,linSpaceImpl:w,logImpl:k,maxImpl:_,maximumImpl:A,minimumImpl:C,multiplyImpl:S,negImpl:E,notEqualImpl:T,prodImpl:N,raggedGatherImpl:F,raggedRangeImpl:D,raggedTensorToTensorImpl:I,rangeImpl:M,rsqrtImpl:O,scatterImpl:R,sigmoidImpl:z,simpleAbsImpl:B,sliceImpl:L,sparseFillEmptyRowsImpl:P,sparseReshapeImpl:j,sparseSegmentReductionImpl:U,sqrtImpl:W,staticRegexReplaceImpl:V,stridedSliceImpl:q,stringNGramsImpl:G,stringSplitImpl:H,stringToHashBucketFastImpl:Y,subImpl:X,tileImpl:K,topKImpl:Q,transposeImpl:Z,uniqueImpl:$}=r},39935:(t,e,n)=>{"use strict";n.d(e,{l:()=>c});var r=n(37837),i=n(37999),a=n(23199),o=n(53884);const s="return abs(x);";const c={kernelName:r.Abs,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:c}=e;if(n.shouldExecuteOnCPU([c])&&"complex64"!==c.dtype){const t=n.texData.get(c.dataId),e=(0,i.f8)(t.values);return n.makeTensorInfo(c.shape,c.dtype,e)}let u;return u=(0,r.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new o.rf(c.shape,s):new a.hE(c.shape,s),n.runWebGLProgram(u,[c],c.dtype)}}},82845:(t,e,n)=>{"use strict";n.d(e,{t:()=>s});var r=n(37837),i=n(55289);const a=n(23199).dR+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n",o=(0,i.vi)({opSnippet:a}),s={kernelName:r.Acos,backendName:"webgl",kernelFunc:o}},90137:(t,e,n)=>{"use strict";n.d(e,{D:()=>s});var r=n(37837),i=n(55289);const a=n(23199).dR+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));",o=(0,i.vi)({opSnippet:a}),s={kernelName:r.Acosh,backendName:"webgl",kernelFunc:o}},59160:(t,e,n)=>{"use strict";n.d(e,{U:()=>c});var r=n(37837),i=n(55289),a=n(37999);const o="return a + b;",s=(0,i.j0)({opSnippet:o,packedOpSnippet:o,supportsComplex:!0,cpuKernelImpl:a.Gs}),c={kernelName:r.Add,backendName:"webgl",kernelFunc:s}},95252:(t,e,n)=>{"use strict";n.d(e,{y:()=>s});var r=n(37837),i=n(12250),a=n(55523),o=n(57381);const s={kernelName:r.AddN,backendName:"webgl",kernelFunc:function t(e){const{inputs:n,backend:s}=e,c=n;if(1===c.length)return(0,o.D)({inputs:{x:c[0]},backend:s});if(c.length>(0,r.env)().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const e=Math.floor(c.length/2),n=t({inputs:c.slice(0,e),backend:s}),r=t({inputs:c.slice(e),backend:s});return t({inputs:[n,r],backend:s})}const u=c.map((t=>t.dtype)).reduce(((t,e)=>(0,r.upcastType)(t,e))),l=c.map((t=>t.shape)),h=(0,r.env)().getBool("WEBGL_PACK")?new a.c(c[0].shape,l):new i.K(c[0].shape,l);return s.runWebGLProgram(h,c,u)}}},19064:(t,e,n)=>{"use strict";n.d(e,{k:()=>s});var r=n(37837),i=n(71912),a=n(52813),o=n(78652);const s={kernelName:r.All,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:c}=e,{axis:u,keepDims:l}=s,h=c.shape.length,d=r.util.parseAxisParam(u,c.shape);let f=d;const p=r.backend_util.getAxesPermutation(f,h);let g=c;null!=p&&(g=(0,o.m)({inputs:{x:c},backend:n,attrs:{perm:p}}),f=r.backend_util.getInnerMostAxes(f.length,h)),r.backend_util.assertAxesAreInnerMostDims("all",f,h);const[m,v]=r.backend_util.computeOutAndReduceShapes(g.shape,f),y=r.util.sizeFromShape(v),b=(0,a.t)({inputs:{x:g},backend:n,attrs:{shape:[-1,y]}}),x=(0,i.T)(b,b.dtype,"all",n);let w;if(l){const t=r.backend_util.expandShapeToKeepDim(m,d);w=(0,a.t)({inputs:{x:x},backend:n,attrs:{shape:t}})}else w=(0,a.t)({inputs:{x:x},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(x),null!=p&&n.disposeIntermediateTensorInfo(g),w}}},74325:(t,e,n)=>{"use strict";n.d(e,{l:()=>s});var r=n(37837),i=n(71912),a=n(52813),o=n(78652);const s={kernelName:r.Any,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:c}=e,{axis:u,keepDims:l}=s,h=c.shape.length,d=r.util.parseAxisParam(u,c.shape);let f=d;const p=r.backend_util.getAxesPermutation(f,h);let g=c;null!=p&&(g=(0,o.m)({inputs:{x:c},backend:n,attrs:{perm:p}}),f=r.backend_util.getInnerMostAxes(f.length,h)),r.backend_util.assertAxesAreInnerMostDims("any",f,h);const[m,v]=r.backend_util.computeOutAndReduceShapes(g.shape,f),y=r.util.sizeFromShape(v),b=(0,a.t)({inputs:{x:g},backend:n,attrs:{shape:[-1,y]}}),x=(0,i.T)(b,b.dtype,"any",n);let w;if(l){const t=r.backend_util.expandShapeToKeepDim(m,d);w=(0,a.t)({inputs:{x:x},backend:n,attrs:{shape:t}})}else w=(0,a.t)({inputs:{x:x},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(x),null!=p&&n.disposeIntermediateTensorInfo(g),w}}},53125:(t,e,n)=>{"use strict";n.d(e,{n:()=>o});var r=n(37837),i=n(97994),a=n(78652);const o={kernelName:r.ArgMax,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:o}=t,{x:s}=e,{axis:c}=o;let u=r.util.parseAxisParam(c,s.shape);const l=r.backend_util.getAxesPermutation(u,s.shape.length);let h=s;const d=[];null!=l&&(h=(0,a.m)({inputs:{x:s},backend:n,attrs:{perm:l}}),d.push(h),u=r.backend_util.getInnerMostAxes(u.length,h.shape.length)),r.backend_util.assertAxesAreInnerMostDims("argMax",[u[0]],h.shape.length);const f=(0,i.f)(n,h,u[0],"max");return d.forEach((t=>n.disposeIntermediateTensorInfo(t))),f}}},32463:(t,e,n)=>{"use strict";n.d(e,{l:()=>o});var r=n(37837),i=n(97994),a=n(78652);const o={kernelName:r.ArgMin,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:o}=t,{x:s}=e,{axis:c}=o;let u=r.util.parseAxisParam(c,s.shape);const l=r.backend_util.getAxesPermutation(u,s.shape.length);let h=s;const d=[];null!=l&&(h=(0,a.m)({inputs:{x:s},backend:n,attrs:{perm:l}}),d.push(h),u=r.backend_util.getInnerMostAxes(u.length,h.shape.length)),r.backend_util.assertAxesAreInnerMostDims("argMin",[u[0]],h.shape.length);const f=(0,i.f)(n,h,u[0],"min");return d.forEach((t=>n.disposeIntermediateTensorInfo(t))),f}}},85900:(t,e,n)=>{"use strict";n.d(e,{S:()=>s});var r=n(37837),i=n(55289);const a=n(23199).dR+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n",o=(0,i.vi)({opSnippet:a}),s={kernelName:r.Asin,backendName:"webgl",kernelFunc:o}},94750:(t,e,n)=>{"use strict";n.d(e,{M:()=>s});var r=n(37837),i=n(55289);const a=n(23199).dR+"return log(x + sqrt(x * x + 1.0));",o=(0,i.vi)({opSnippet:a}),s={kernelName:r.Asinh,backendName:"webgl",kernelFunc:o}},43449:(t,e,n)=>{"use strict";n.d(e,{L:()=>s});var r=n(37837),i=n(55289);const a=n(23199).dR+"\n  return atan(x);\n",o=(0,i.vi)({opSnippet:a}),s={kernelName:r.Atan,backendName:"webgl",kernelFunc:o}},30499:(t,e,n)=>{"use strict";n.d(e,{r:()=>l});var r=n(37837),i=n(74139),a=n(61880),o=n(55289);const s=i.dR+"\n  return atan(a, b);\n",c="\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+a.qq+"\n  return result;\n",u=(0,o.j0)({opSnippet:s,packedOpSnippet:c}),l={kernelName:r.Atan2,backendName:"webgl",kernelFunc:u}},35389:(t,e,n)=>{"use strict";n.d(e,{l:()=>s});var r=n(37837),i=n(55289);const a=n(23199).dR+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;",o=(0,i.vi)({opSnippet:a}),s={kernelName:r.Atanh,backendName:"webgl",kernelFunc:o}},18553:(t,e,n)=>{"use strict";n.d(e,{R:()=>s});var r=n(37837),i=n(46051),a=n(11414),o=n(57381);const s={kernelName:r.AvgPool,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:c}=e;(0,a.CE)(c,"avgPool");const{filterSize:u,strides:l,pad:h,dimRoundingMode:d}=s;r.util.assert(r.backend_util.eitherStridesOrDilationsAreOne(l,1),(()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(l," and dilations '").concat(1,"'")));const f=r.backend_util.computePool2DInfo(c.shape,u,l,1,h,d);if(1===f.filterWidth&&1===f.filterHeight&&r.util.arraysEqual(f.inShape,f.outShape))return(0,o.D)({inputs:{x:c},backend:n});const p=new i.h(f,"avg",!1);return n.runWebGLProgram(p,[c],"float32")}}},18074:(t,e,n)=>{"use strict";n.d(e,{O:()=>a});var r=n(37837),i=n(46051);const a={kernelName:r.AvgPool3D,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{x:o}=e,{filterSize:s,strides:c,pad:u,dimRoundingMode:l,dataFormat:h}=a,d=r.backend_util.computePool3DInfo(o.shape,s,c,[1,1,1],u,l,h),f=new i.U(d,"avg",!1);return n.runWebGLProgram(f,[o],"float32")}}},75366:(t,e,n)=>{"use strict";n.d(e,{m:()=>a});var r=n(37837),i=n(37853);const a={kernelName:r.AvgPool3DGrad,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{dy:o,input:s}=e,c=s,{filterSize:u,strides:l,pad:h,dimRoundingMode:d}=a,f=r.backend_util.computePool3DInfo(c.shape,u,l,[1,1,1],h,d),p=new i.q(f);return n.runWebGLProgram(p,[o],c.dtype)}}},43785:(t,e,n)=>{"use strict";n.d(e,{$:()=>o});var r=n(37837),i=n(37853),a=n(11414);const o={kernelName:r.AvgPoolGrad,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:o}=t,{dy:s,input:c}=e,u=c;(0,a.CE)([s,c],"avgPoolGrad");const{filterSize:l,strides:h,pad:d}=o,f=r.backend_util.computePool2DInfo(u.shape,l,h,1,d),p=new i.x(f);return n.runWebGLProgram(p,[s],u.dtype)}}},76811:(t,e,n)=>{"use strict";n.d(e,{X:()=>a});var r=n(37837),i=n(49032);const a={kernelName:r.BatchMatMul,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{a:a,b:o}=e,{transposeA:s,transposeB:c}=r;return(0,i.L)({a:a,b:o,transposeA:s,transposeB:c,backend:n})}}},49032:(t,e,n)=>{"use strict";n.d(e,{L:()=>h,U:()=>l});var r=n(37837),i=n(55289),a=n(74506),o=n(39999),s=n(52813),c=n(40176),u=n(78652);const l=1e3;function h(t){let{a:e,b:n,transposeA:h,transposeB:d,backend:f,bias:p=null,preluActivationWeights:g=null,leakyreluAlpha:m=0,activation:v=null}=t;const y=e.shape.length,b=n.shape.length,x=h?e.shape[y-2]:e.shape[y-1],w=d?n.shape[b-1]:n.shape[b-2],k=h?e.shape[y-1]:e.shape[y-2],_=d?n.shape[b-2]:n.shape[b-1],A=e.shape.slice(0,-2),C=n.shape.slice(0,-2),S=r.util.sizeFromShape(A),E=r.util.sizeFromShape(C),T=r.broadcast_util.assertAndGetBroadcastShape(e.shape.slice(0,-2),n.shape.slice(0,-2)).concat([k,_]);r.util.assert(x===w,(()=>"Error in matMul: inner shapes (".concat(x,") and (")+"".concat(w,") of Tensors with shapes ").concat(e.shape," and ")+"".concat(n.shape," and transposeA=").concat(h)+" and transposeB=".concat(d," must match.")));const N=h?[S,x,k]:[S,k,x],F=d?[E,_,w]:[E,w,_],D=(0,s.t)({inputs:{x:e},backend:f,attrs:{shape:N}}),I=(0,s.t)({inputs:{x:n},backend:f,attrs:{shape:F}}),M=[D,I],O=Math.max(S,E),R=h?D.shape[1]:D.shape[2],z=null!=p,B=null!=g,L="leakyrelu"===v,P=null!=v?(0,i.bE)(v,!0):null;let j;if((1===k||1===_)&&R>l&&!1===(z||B||L||null!=P)){let t=D,e=I;h&&(t=(0,u.m)({inputs:{x:D},backend:f,attrs:{perm:[0,2,1]}}),M.push(t)),d&&(e=(0,u.m)({inputs:{x:I},backend:f,attrs:{perm:[0,2,1]}}),M.push(e));const n=1===_;let r=t;1!==_&&(r=(0,s.t)({inputs:{x:t},backend:f,attrs:{shape:[O,R,1]}}),M.push(r));const i=1===_?2:1;let a=e;n&&(a=(0,s.t)({inputs:{x:e},backend:f,attrs:{shape:[O,1,R]}}),M.push(a));const l=(0,o.l)({inputs:{a:r,b:a},backend:f});j=(0,c.c)({inputs:{x:l},backend:f,attrs:{axis:i,keepDims:!0}}),M.push(l)}else{const t=(0,r.upcastType)(e.dtype,n.dtype),i=new a.P(N,F,[O,k,_],h,d,z,P,B,L),o=[D,I];if(null!=p&&o.push(p),B&&o.push(g),L){const t=f.makeTensorInfo([],"float32",r.util.createScalarValue(m,"float32"));o.push(t),M.push(t)}j=f.runWebGLProgram(i,o,t)}const U=(0,s.t)({inputs:{x:j},backend:f,attrs:{shape:T}});M.push(j);for(const r of M)f.disposeIntermediateTensorInfo(r);return U}},14209:(t,e,n)=>{"use strict";n.d(e,{V:()=>o});var r=n(37837),i=n(34461),a=n(43482);const o={kernelName:r.FusedBatchNorm,backendName:"webgl",kernelFunc:t=>{let{inputs:e,backend:n,attrs:o}=t;const{x:s,mean:c,variance:u,offset:l,scale:h}=e;r.util.assert(c.shape.length===u.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),r.util.assert(null==l||c.shape.length===l.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),r.util.assert(null==h||c.shape.length===h.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));let{varianceEpsilon:d}=o;null==d&&(d=.001);const f=[s,c,u];let p=null;null!=l&&(p=l.shape,f.push(l));let g=null;null!=h&&(g=h.shape,f.push(h));const m=(0,r.env)().getBool("WEBGL_PACK_NORMALIZATION")?new a.x(s.shape,c.shape,u.shape,p,g,d):new i.f(s.shape,c.shape,u.shape,p,g,d);return n.runWebGLProgram(m,f,f[0].dtype)}}},5896:(t,e,n)=>{"use strict";n.d(e,{e:()=>s});var r=n(37837),i=n(52813),a=n(57861),o=n(78652);const s={kernelName:r.BatchToSpaceND,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:s}=t,{x:c}=e,{blockShape:u,crops:l}=s;r.util.assert(c.shape.length<=4,(()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"));const h=u.reduce(((t,e)=>t*e)),d=r.backend_util.getReshaped(c.shape,u,h),f=r.backend_util.getPermuted(d.length,u.length),p=r.backend_util.getReshapedPermuted(c.shape,u,h),g=r.backend_util.getSliceBeginCoords(l,u.length),m=r.backend_util.getSliceSize(p,l,u.length),v=[],y=(0,i.t)({inputs:{x:c},backend:n,attrs:{shape:d}}),b=(0,o.m)({inputs:{x:y},backend:n,attrs:{perm:f}}),x=(0,i.t)({inputs:{x:b},backend:n,attrs:{shape:p}}),w=(0,a.d)({inputs:{x:x},backend:n,attrs:{begin:g,size:m}});return v.push(y),v.push(b),v.push(x),v.forEach((t=>n.disposeIntermediateTensorInfo(t))),w}}},60895:(t,e,n)=>{"use strict";n.d(e,{l:()=>a});var r=n(37837),i=n(37999);const a={kernelName:r.Bincount,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:o}=e,{size:s}=r,c=n.readSync(a.dataId),u=n.readSync(o.dataId),l=(0,i.jm)(c,u,o.dtype,o.shape,s);return n.makeTensorInfo([s],o.dtype,l)}}},55379:(t,e,n)=>{"use strict";n.d(e,{LY:()=>s});var r=n(37837),i=n(74139),a=n(61880),o=n(37999);const s={kernelName:r.BitwiseAnd,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{a:s,b:c}=e,u=(0,r.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS"),l=(0,r.env)().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([s,c])||1===l){const t=n.texData.get(s.dataId).values,e=n.texData.get(c.dataId).values,[r,i]=(0,o.PA)(s.shape,c.shape,t,e,s.dtype),a=n.makeTensorInfo(i,s.dtype);return n.texData.get(a.dataId).values=r,a}let h;return h=u?new a.VI("\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",s.shape,c.shape,!1):new i.x("\n  return float(int(a.r) & int(b.r));\n",s.shape,c.shape),n.runWebGLProgram(h,[s,c],s.dtype)}}},70329:(t,e,n)=>{"use strict";n.d(e,{N:()=>i});var r=n(37837);const i={kernelName:r.BroadcastArgs,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{s0:i,s1:a}=e,o=n.readSync(i.dataId),s=n.readSync(a.dataId),c=r.backend_util.assertAndGetBroadcastShape(Array.from(o),Array.from(s));return n.makeTensorInfo([c.length],"int32",Int32Array.from(c))}}},44268:(t,e,n)=>{"use strict";n.d(e,{M:()=>l});var r=n(37837),i=n(37999),a=n(5795),o=n(57381),s=n(93592),c=n(93067),u=n(91965);const l={kernelName:r.Cast,backendName:"webgl",kernelFunc:function t(e){const{inputs:n,backend:l,attrs:h}=e,{x:d}=n,{dtype:f}=h;if("complex64"===f){if("complex64"===d.dtype)return(0,o.D)({inputs:{x:d},backend:l});const e=r.zeros(d.shape),n=t({inputs:{x:d},backend:l,attrs:{dtype:"float32"}}),i=(0,a.f)({inputs:{real:n,imag:e},backend:l});return e.dispose(),l.disposeIntermediateTensorInfo(n),i}if("complex64"===d.dtype){const e=(0,c.x)({inputs:{input:d},backend:l}),n=t({inputs:{x:e},backend:l,attrs:{dtype:f}});return l.disposeIntermediateTensorInfo(e),n}if(!r.util.hasEncodingLoss(d.dtype,f)){const t=(0,o.D)({inputs:{x:d},backend:l});return{dataId:t.dataId,shape:t.shape,dtype:f}}if(l.shouldExecuteOnCPU([d])){const t=l.texData.get(d.dataId).values,[e,n,r]=(0,i.Kf)(t,d.shape,d.dtype,f);return l.makeTensorInfo(e,n,r)}if("int32"===f)return(0,u.W)(d,l);if("bool"===f){const t=l.makeTensorInfo([],"bool",r.util.getTypedArrayFromDType("bool",1)),e={a:d,b:t},n=(0,s.E)({inputs:e,backend:l});return l.disposeIntermediateTensorInfo(t),n}throw new Error("Error in Cast: failed to cast ".concat(d.dtype," to ").concat(f))}}},56002:(t,e,n)=>{"use strict";n.d(e,{u:()=>c});var r=n(37837),i=n(55289),a=n(37999);const o="return ceil(x);",s=(0,i.vi)({opSnippet:o,packedOpSnippet:o,cpuKernelImpl:a.Md}),c={kernelName:r.Ceil,backendName:"webgl",kernelFunc:s}},92963:(t,e,n)=>{"use strict";n.d(e,{F:()=>o});var r=n(37837),i=n(21303),a=n(14372);const o={kernelName:r.ClipByValue,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:o}=t,{x:s}=e,{clipValueMin:c,clipValueMax:u}=o;let l;l=(0,r.env)().getBool("WEBGL_PACK_CLIP")?new a.$(s.shape):new i.T(s.shape);const h=[[c],[u]];return n.runWebGLProgram(l,[s],s.dtype,h)}}},5795:(t,e,n)=>{"use strict";n.d(e,{f:()=>a,v:()=>o});var r=n(37837),i=n(57381);function a(t){const{inputs:e,backend:n}=t,{real:r,imag:a}=e,o=n.makeTensorInfo(r.shape,"complex64"),s=n.texData.get(o.dataId),c=(0,i.D)({inputs:{x:r},backend:n}),u=(0,i.D)({inputs:{x:a},backend:n});return s.complexTensorInfos={real:c,imag:u},o}const o={kernelName:r.Complex,backendName:"webgl",kernelFunc:a}},43843:(t,e,n)=>{"use strict";n.d(e,{t:()=>o});var r=n(37837),i=n(25660);function a(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}const o={kernelName:r.ComplexAbs,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e,o=n.texData.get(r.dataId),s=new i.t(r.shape),c=[a(r,o.complexTensorInfos.real),a(r,o.complexTensorInfos.imag)];return n.runWebGLProgram(s,c,c[0].dtype)}}},1415:(t,e,n)=>{"use strict";n.d(e,{V:()=>s,x:()=>o});var r=n(37837),i=n(3236),a=n(57381);function o(t){const{inputs:e,backend:n,attrs:o}=t,{axis:s}=o,c=r.util.parseAxisParam(s,e[0].shape)[0],u=e.map((t=>t.shape));r.backend_util.assertParamsConsistent(u,c);const l=r.backend_util.computeOutShape(e.map((t=>t.shape)),c);if(0===r.util.sizeFromShape(l))return n.makeTensorInfo(l,e[0].dtype,[]);const h=e.filter((t=>r.util.sizeFromShape(t.shape)>0));return 1===h.length?(0,a.D)({inputs:{x:h[0]},backend:n}):(0,i.h)(h,c,n)}const s={kernelName:r.Concat,backendName:"webgl",kernelFunc:o}},3236:(t,e,n)=>{"use strict";n.d(e,{h:()=>f});var r=n(37837),i=n(97865),a=n(38406),o=n(37999),s=n(23199),c=n(53884),u=n(5795),l=n(81877),h=n(93067),d=n(52813);function f(t,e,n){const p=t[0].dtype;if("complex64"===p){const r=t.map((t=>(0,h.x)({inputs:{input:t},backend:n}))),i=t.map((t=>(0,l.n)({inputs:{input:t},backend:n}))),a=f(r,e,n),o=f(i,e,n),s=(0,u.f)({inputs:{real:a,imag:o},backend:n});return r.forEach((t=>n.disposeIntermediateTensorInfo(t))),i.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),s}let g=n.shouldExecuteOnCPU(t);if("string"===p&&(g=!0),g){const i=t.map((t=>{const i=[-1,r.util.sizeFromShape(t.shape.slice(e))];return(0,d.t)({inputs:{x:t},backend:n,attrs:{shape:i}})})),a=i.map((t=>({vals:n.readSync(t.dataId),shape:t.shape}))),s=r.backend_util.computeOutShape(i.map((t=>t.shape)),1),c=1===i[0].shape[0],u=(0,o.dv)(a,s,p,c),l=r.backend_util.computeOutShape(t.map((t=>t.shape)),e),h=n.makeTensorInfo(l,p,u);return i.forEach((t=>n.disposeIntermediateTensorInfo(t))),h}const m=t.filter((t=>r.util.sizeFromShape(t.shape)>0)),v=(0,r.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&m[0].shape.length>1;if(1===m.length){const e=v?new s.hE(t[0].shape,s.UC):new c.rf(t[0].shape,s.UC);return n.runWebGLProgram(e,t,p)}const y=(0,r.env)().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(m.length>y){const t=[];for(let i=0;i<m.length;i+=y){const r=m.slice(i,i+y);t.push(f(r,e,n))}const r=f(t,e,n);for(const e of t)n.disposeIntermediateTensorInfo(e);return r}if(v){const t=new a.V(m.map((t=>t.shape)),e);return n.runWebGLProgram(t,m,p)}const{tensors2D:b,outShape:x}=function(t,e,n){const i=r.backend_util.computeOutShape(t.map((t=>t.shape)),e),a=t.map((t=>(0,d.t)({inputs:{x:t},attrs:{shape:[-1,r.util.sizeFromShape(t.shape.slice(e))]},backend:n})));return{tensors2D:a,outShape:i}}(m,e,n),w=new i.P(b.map((t=>t.shape))),k=n.runWebGLProgram(w,b,p);b.forEach((t=>n.disposeIntermediateTensorInfo(t)));const _=(0,d.t)({inputs:{x:k},attrs:{shape:x},backend:n});return n.disposeIntermediateTensorInfo(k),_}},31375:(t,e,n)=>{"use strict";n.d(e,{x:()=>c});var r=n(37837),i=n(6031),a=n(29196),o=n(67868),s=n(52813);const c={kernelName:r.Conv2D,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:c}=t,{x:u,filter:l}=e,{strides:h,pad:d,dataFormat:f,dilations:p,dimRoundingMode:g}=c,m=r.backend_util.convertConv2DDataFormat(f),v=r.backend_util.computeConv2DInfo(u.shape,l.shape,h,p,d,g,!1,m);let y;if(1!==v.filterHeight||1!==v.filterWidth||1!==v.dilationHeight||1!==v.dilationWidth||1!==v.strideHeight||1!==v.strideWidth||"SAME"!==v.padInfo.type&&"VALID"!==v.padInfo.type)if(v.strideWidth<=2&&"channelsLast"===m&&(0,r.env)().getBool("WEBGL_EXP_CONV")){const t=new a.Z(v),e=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]];y=n.runWebGLProgram(t,[u,l],"float32",e)}else if((0,r.env)().getBool("WEBGL_CONV_IM2COL"))y=(0,o.J)({x:u,filter:l,convInfo:v,backend:n});else{const t=new i.B(v);y=n.runWebGLProgram(t,[u,l],"float32")}else y=(0,o.K)({x:u,filter:l,convInfo:v,backend:n});const b=(0,s.t)({inputs:{x:y},backend:n,attrs:{shape:v.outShape}});return n.disposeIntermediateTensorInfo(y),b}}},55591:(t,e,n)=>{"use strict";n.d(e,{r:()=>a});var r=n(37837),i=n(86698);const a={kernelName:r.Conv2DBackpropFilter,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{x:o,dy:s}=e,{strides:c,pad:u,dataFormat:l,dimRoundingMode:h,filterShape:d}=a,f=r.backend_util.convertConv2DDataFormat(l),p=r.backend_util.computeConv2DInfo(o.shape,d,c,1,u,h,!1,f),g=new i.S5(p);return n.runWebGLProgram(g,[o,s],"float32")}}},10917:(t,e,n)=>{"use strict";n.d(e,{f:()=>o});var r=n(37837),i=n(86698),a=n(79763);const o={kernelName:r.Conv2DBackpropInput,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:o}=t,{dy:s,filter:c}=e,{inputShape:u,strides:l,pad:h,dataFormat:d,dimRoundingMode:f}=o,p=r.backend_util.convertConv2DDataFormat(d),g=r.backend_util.computeConv2DInfo(u,c.shape,l,1,h,f,!1,p);if((0,r.env)().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&"channelsLast"===p){const t=[[g.strideHeight,g.strideWidth]],e=new a.g(g);return n.runWebGLProgram(e,[s,c],"float32",t)}{const t=new i.eS(g);return n.runWebGLProgram(t,[s,c],"float32")}}}},67868:(t,e,n)=>{"use strict";n.d(e,{J:()=>f,K:()=>d});var r=n(37837),i=n(41988),a=n(55289),o=n(74506),s=n(11414),c=n(49032),u=n(57381),l=n(52813);function h(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&1===n&&t[0]>1?[t[0],1]:null}function d(t){let{x:e,filter:n,convInfo:i,backend:a,bias:o=null,preluActivationWeights:d=null,leakyreluAlpha:f=0,activation:p=null}=t;const g=e.shape,m=a.texData.get(e.dataId),v=i.inChannels,y=g[0]*g[1]*g[2],b=i.outChannels,x="channelsLast"===i.dataFormat;let w;const k=[];if(null!=d){const t=h(d.shape,x);null!=t&&(d=(0,l.t)({inputs:{x:d},backend:a,attrs:{shape:t}}),k.push(d))}if(null!=o){const t=h(o.shape,x);null!=t&&(o=(0,l.t)({inputs:{x:o},backend:a,attrs:{shape:t}}),k.push(o))}if(!((1===y||1===b)&&v>c.U)&&m.isPacked&&x&&null!=m.texture&&g[2]%2!==0&&r.util.arraysEqual(m.shape.slice(-3),g.slice(-3))){const t=g[0]*g[1]*(g[2]+1),h={dataId:e.dataId,shape:[1,t,i.inChannels],dtype:e.dtype},v=m.shape;m.shape=m.shape.slice(),m.shape[m.shape.length-2]++,r.util.assert(s.P0(m.shape,h.shape),(()=>"packed reshape ".concat(m.shape," to ").concat(h.shape," isn't free")));const y=(0,l.t)({inputs:{x:n},backend:a,attrs:{shape:[1,i.inChannels,i.outChannels]}});k.push(y);const b=(0,c.L)({a:h,b:y,backend:a,transposeA:false,transposeB:false,bias:o,activation:p,preluActivationWeights:d,leakyreluAlpha:f}),x=a.texData.get(b.dataId);r.util.assert(x.isPacked,(()=>"batchMatMul result is expected to be packed")),m.shape=v,x.shape=i.outShape,w=(0,u.D)({inputs:{x:b},backend:a}),w.shape=i.outShape,k.push(b)}else{const t=i.outHeight*i.outWidth,r=(0,l.t)({inputs:{x:e},backend:a,attrs:{shape:x?[i.batchSize,t,i.inChannels]:[i.batchSize,i.inChannels,t]}}),s=(0,l.t)({inputs:{x:n},backend:a,attrs:{shape:[1,i.inChannels,i.outChannels]}}),u=(0,c.L)({a:x?r:s,b:x?s:r,transposeA:!x,transposeB:false,backend:a,bias:o,activation:p,preluActivationWeights:d,leakyreluAlpha:f});w=(0,l.t)({inputs:{x:u},backend:a,attrs:{shape:i.outShape}}),k.push(r),k.push(s),k.push(u)}for(const r of k)a.disposeIntermediateTensorInfo(r);return w}function f(t){let{x:e,filter:n,convInfo:s,backend:c,bias:u=null,preluActivationWeights:d=null,leakyreluAlpha:f=0,activation:p=null}=t;const{filterWidth:g,filterHeight:m,inChannels:v,outWidth:y,outHeight:b,dataFormat:x}=s,w="channelsLast"===x,k=g*m*v,_=b*y,A=[s.batchSize,k,_],C=[];if(null!=d){const t=h(d.shape,w);null!=t&&(d=(0,l.t)({inputs:{x:d},backend:c,attrs:{shape:t}}),C.push(d))}if(null!=u){const t=h(u.shape,w);null!=t&&(u=(0,l.t)({inputs:{x:u},backend:c,attrs:{shape:t}}),C.push(u))}const S=(0,l.t)({inputs:{x:n},backend:c,attrs:{shape:[1,k,r.util.sizeFromShape(n.shape)/k]}});C.push(S);const E=new i.D(A,s),T=[e.shape,[s.padInfo.top,s.padInfo.left],[s.strideHeight,s.strideWidth],[s.dilationHeight,s.dilationWidth],[s.inChannels],[s.filterWidth*s.inChannels],[s.outWidth]],N=c.runWebGLProgram(E,[e],"float32",T),F=(0,l.t)({inputs:{x:N},backend:c,attrs:{shape:A}});C.push(N),C.push(F);const D=null!=u,I=null!=d,M="leakyrelu"===p,O=p?(0,a.bE)(p,!0):null,R=new o.P(w?F.shape:S.shape,w?S.shape:F.shape,w?[s.batchSize,_,s.outChannels]:[s.batchSize,s.outChannels,_],!0,!1,D,O,I,M),z=w?[F,S]:[S,F];if(u&&z.push(u),I&&z.push(d),M){const t=c.makeTensorInfo([],"float32",r.util.createScalarValue(f,"float32"));z.push(t),C.push(t)}const B=c.runWebGLProgram(R,z,"float32"),L=(0,l.t)({inputs:{x:B},backend:c,attrs:{shape:s.outShape}});C.push(B);for(const r of C)c.disposeIntermediateTensorInfo(r);return L}},56722:(t,e,n)=>{"use strict";n.d(e,{i:()=>a});var r=n(37837),i=n(6031);const a={kernelName:r.Conv3D,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{x:o,filter:s}=e,{strides:c,pad:u,dilations:l}=a,h=r.backend_util.computeConv3DInfo(o.shape,s.shape,c,l,u),d=new i.w(h);return n.runWebGLProgram(d,[o,s],"float32")}}},64630:(t,e,n)=>{"use strict";n.d(e,{i:()=>a});var r=n(37837),i=n(86698);const a={kernelName:r.Conv3DBackpropFilterV2,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{x:o,dy:s}=e,{strides:c,pad:u,filterShape:l}=a,h=r.backend_util.computeConv3DInfo(o.shape,l,c,1,u),d=new i.N7(h);return n.runWebGLProgram(d,[o,s],"float32")}}},16042:(t,e,n)=>{"use strict";n.d(e,{Y:()=>a});var r=n(37837),i=n(86698);const a={kernelName:r.Conv3DBackpropInputV2,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{dy:o,filter:s}=e,{pad:c,strides:u,inputShape:l}=a,h=r.backend_util.computeConv3DInfo(l,s.shape,u,1,c),d=new i.tR(h);return n.runWebGLProgram(d,[o,s],"float32")}}},95952:(t,e,n)=>{"use strict";n.d(e,{o:()=>u});var r=n(37837),i=n(61880),a=n(55289);const o=a.Zt+"\n  return cos(x);\n",s="\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(i.qq,"\n  return result;\n"),c=(0,a.vi)({opSnippet:o,packedOpSnippet:s}),u={kernelName:r.Cos,backendName:"webgl",kernelFunc:c}},24490:(t,e,n)=>{"use strict";n.d(e,{k:()=>a});var r=n(37837);const i=(0,n(55289).vi)({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),a={kernelName:r.Cosh,backendName:"webgl",kernelFunc:i}},47364:(t,e,n)=>{"use strict";n.d(e,{O:()=>a});var r=n(37837),i=n(17654);const a={kernelName:r.CropAndResize,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{image:a,boxes:o,boxInd:s}=e,{cropSize:c,method:u,extrapolationValue:l}=r,h=new i.c(a.shape,o.shape,c,u,l);return n.runWebGLProgram(h,[a,o,s],"float32")}}},72029:(t,e,n)=>{"use strict";n.d(e,{G:()=>s});var r=n(37837),i=n(94660),a=n(57381),o=n(78652);function s(t,e,n,s,c,u){const l=e.shape.length,h=r.backend_util.getAxesPermutation([s],l);let d=e;null!=h&&(d=(0,o.m)({inputs:{x:e},backend:n,attrs:{perm:h}}));const f=r.backend_util.getInnerMostAxes(1,l)[0];if(f!==l-1)throw new Error("WebGL cumprod shader expects an inner-most axis=".concat(e.shape.length-1," ")+"but got axis=".concat(s));const p=d.shape[f];let g=(0,a.D)({inputs:{x:d},backend:n});for(let r=0;r<=Math.ceil(Math.log2(p))-1;r++){const e=new i.G(t,d.shape,!1,u),a=[[r]],o=g;g=n.runWebGLProgram(e,[g],g.dtype,a),n.disposeIntermediateTensorInfo(o)}if(c){const e=new i.G(t,d.shape,c,u),r=g;g=n.runWebGLProgram(e,[g],g.dtype),n.disposeIntermediateTensorInfo(r)}if(null!=h){const t=r.backend_util.getUndoAxesPermutation(h),e=(0,o.m)({inputs:{x:g},backend:n,attrs:{perm:t}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(d),e}return g}},18805:(t,e,n)=>{"use strict";n.d(e,{T:()=>o});var r=n(37837),i=n(94660),a=n(72029);const o={kernelName:r.Cumprod,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:s,exclusive:c,reverse:u}=r;return(0,a.G)(i.z.Prod,o,n,s,c,u)}}},80625:(t,e,n)=>{"use strict";n.d(e,{$:()=>o});var r=n(37837),i=n(94660),a=n(72029);const o={kernelName:r.Cumsum,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{axis:s,exclusive:c,reverse:u}=r;return(0,a.G)(i.z.Sum,o,n,s,c,u)}}},98932:(t,e,n)=>{"use strict";n.d(e,{Y:()=>a});var r=n(37837),i=n(37999);const a={kernelName:r.DenseBincount,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:o}=e,{size:s,binaryOutput:c}=r;if(1===a.shape.length){const t=n.readSync(a.dataId),e=n.readSync(o.dataId),r=(0,i.jm)(t,e,o.dtype,o.shape,s);return n.makeTensorInfo([s],o.dtype,r)}if(2===a.shape.length){const t=n.bufferSync(a),e=n.bufferSync(o),r=(0,i.h0)(t,e,s,c);return n.makeTensorInfo(r.shape,o.dtype,r.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}}},60501:(t,e,n)=>{"use strict";n.d(e,{R:()=>a});var r=n(37837),i=n(32439);const a={kernelName:r.DepthToSpace,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockSize:o,dataFormat:s}=r,c=a.shape[0],u=("NHWC"===s?a.shape[1]:a.shape[2])*o,l=("NHWC"===s?a.shape[2]:a.shape[3])*o,h=("NHWC"===s?a.shape[3]:a.shape[1])/(o*o),d="NHWC"===s?[c,u,l,h]:[c,h,u,l],f=new i.x(d,o,s);return n.runWebGLProgram(f,[a],a.dtype)}}},17201:(t,e,n)=>{"use strict";n.d(e,{v:()=>o});var r=n(37837),i=n(41301),a=n(34606);const o={kernelName:r.DepthwiseConv2dNative,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:o}=t,{x:s,filter:c}=e,{strides:u,pad:l,dilations:h,dimRoundingMode:d}=o;let f=h;null==f&&(f=[1,1]),r.util.assert(r.backend_util.eitherStridesOrDilationsAreOne(u,f),(()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(u," and dilations '").concat(f,"'")));const p=r.backend_util.computeConv2DInfo(s.shape,c.shape,u,f,l,d,!0);let g;g=(0,r.env)().getBool("WEBGL_PACK_DEPTHWISECONV")&&p.strideWidth<=2&&p.outChannels/p.inChannels===1?new a.K(p):new i.E(p);const m=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];return n.runWebGLProgram(g,[s,c],"float32",m)}}},61205:(t,e,n)=>{"use strict";n.d(e,{n:()=>a});var r=n(37837),i=n(93752);const a={kernelName:r.DepthwiseConv2dNativeBackpropFilter,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{x:o,dy:s}=e,{strides:c,dilations:u,pad:l,dimRoundingMode:h,filterShape:d}=a,f=r.backend_util.computeConv2DInfo(o.shape,d,c,u,l,h,!0),p=new i.f(f);return n.runWebGLProgram(p,[o,s],"float32")}}},36011:(t,e,n)=>{"use strict";n.d(e,{V:()=>a});var r=n(37837),i=n(93752);const a={kernelName:r.DepthwiseConv2dNativeBackpropInput,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{dy:o,filter:s}=e,{strides:c,dilations:u,pad:l,dimRoundingMode:h,inputShape:d}=a,f=r.backend_util.computeConv2DInfo(d,s.shape,c,u,l,h,!0),p=new i.R(f);return n.runWebGLProgram(p,[o,s],"float32")}}},52332:(t,e,n)=>{"use strict";n.d(e,{O:()=>o});var r=n(37837),i=n(23242),a=n(52813);const o={kernelName:r.Diag,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:o}=e,s=[...o.shape,...o.shape],c=r.util.sizeFromShape(o.shape),u=(0,a.t)({inputs:{x:o},backend:n,attrs:{shape:[c]}}),l=new i.e(c),h=n.runWebGLProgram(l,[u],u.dtype),d=(0,a.t)({inputs:{x:h},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),d}}},43483:(t,e,n)=>{"use strict";n.d(e,{F:()=>o});var r=n(37837),i=n(17895),a=n(52813);const o={kernelName:r.Dilation2D,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:o}=t,{x:s,filter:c}=e,{strides:u,pad:l,dilations:h}=o,d=r.backend_util.computeDilation2DInfo(s.shape,c.shape,u,l,"NHWC",h);let f;const p=new i.x(d);f=n.runWebGLProgram(p,[s,c],"float32");const g=(0,a.t)({inputs:{x:f},backend:n,attrs:{shape:d.outShape}});return n.disposeIntermediateTensorInfo(f),g}}},83436:(t,e,n)=>{"use strict";n.d(e,{_:()=>c});var r=n(37837),i=n(39999),a=n(52813),o=n(40176),s=n(78652);const c={kernelName:r.Einsum,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:c}=t,{equation:u}=c,l=e,{allDims:h,summedDims:d,idDims:f}=r.backend_util.decodeEinsumEquation(u,l.length);r.backend_util.checkEinsumDimSizes(h.length,f,l);const{path:p,steps:g}=r.backend_util.getEinsumComputePath(d,f),m=g.length;let v=null,y=h.length;const b=[];for(let x=0;x<m;++x){for(const t of g[x]){const{permutationIndices:e,expandDims:o}=r.backend_util.getEinsumPermutation(y,f[t]);let c;r.backend_util.isIdentityPermutation(e)?c=l[t]:(c=(0,s.m)({inputs:{x:l[t]},backend:n,attrs:{perm:e}}),b.push(c));const u=c.shape.slice();for(let t=0;t<o.length;++t)u.splice(o[t],0,1);r.util.arraysEqual(c.shape,u)||(c=(0,a.t)({inputs:{x:c},backend:n,attrs:{shape:u}}),b.push(c)),null===v?v=c:(v=(0,i.l)({inputs:{a:c,b:v},backend:n}),b.push(v))}x<m-1&&(p[x]>=0&&(v=(0,o.c)({inputs:{x:v},backend:n,attrs:{axis:p[x]-(h.length-y),keepDims:!1}}),b.push(v)),y--)}for(const r of b)r!==v&&n.disposeIntermediateTensorInfo(r);return v}}},44115:(t,e,n)=>{"use strict";n.d(e,{J:()=>a});var r=n(37837);const i=(0,n(55289).vi)({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),a={kernelName:r.Elu,backendName:"webgl",kernelFunc:i}},16123:(t,e,n)=>{"use strict";n.d(e,{x:()=>o});var r=n(37837),i=n(74139),a=n(61880);const o={kernelName:r.EluGrad,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n}=t,{dy:o,y:s}=e,c=(0,r.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new a.VI("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",o.shape,s.shape):new i.x("return (b >= 0.0) ? a : a * (b + 1.0);",o.shape,s.shape);return n.runWebGLProgram(c,[o,s],o.dtype)}}},69215:(t,e,n)=>{"use strict";n.d(e,{R:()=>s});var r=n(37837),i=n(55289),a=n(37999);const o=(0,i.j0)({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:a.PP}),s={kernelName:r.Equal,backendName:"webgl",kernelFunc:o}},15995:(t,e,n)=>{"use strict";n.d(e,{_:()=>s});var r=n(37837),i=n(55289);const a='\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(r.backend_util.ERF_P,";\n  float a1 = ").concat(r.backend_util.ERF_A1,";\n  float a2 = ").concat(r.backend_util.ERF_A2,";\n  float a3 = ").concat(r.backend_util.ERF_A3,";\n  float a4 = ").concat(r.backend_util.ERF_A4,";\n  float a5 = ").concat(r.backend_util.ERF_A5,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n"),o=(0,i.vi)({opSnippet:a}),s={kernelName:r.Erf,backendName:"webgl",kernelFunc:o}},53348:(t,e,n)=>{"use strict";n.d(e,{AC:()=>c,oN:()=>s});var r=n(37837),i=n(55289),a=n(37999);const o=i.Zt+"\n  return exp(x);\n",s=(0,i.vi)({opSnippet:o,packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:a.E$,dtype:"float32"}),c={kernelName:r.Exp,backendName:"webgl",kernelFunc:s}},13764:(t,e,n)=>{"use strict";n.d(e,{U:()=>a,a:()=>o});var r=n(37837),i=n(52813);function a(t){const{inputs:e,attrs:n,backend:a}=t,{dim:o}=n,{input:s}=e,c=s.shape.length,u=s.shape.slice();let l=o;return o<0&&(r.util.assert(-(c+1)<=o,(()=>"Axis must be in the interval [".concat(-(c+1),", ").concat(c,"]"))),l=c+o+1),u.splice(l,0,1),(0,i.t)({inputs:{x:s},backend:a,attrs:{shape:u}})}const o={kernelName:r.ExpandDims,backendName:"webgl",kernelFunc:a}},67494:(t,e,n)=>{"use strict";n.d(e,{Y:()=>c});var r=n(37837),i=n(55289),a=n(37999);const o="return exp(x) - 1.0;",s=(0,i.vi)({opSnippet:o,packedOpSnippet:o,cpuKernelImpl:a.SF}),c={kernelName:r.Expm1,backendName:"webgl",kernelFunc:s}},33023:(t,e,n)=>{"use strict";n.d(e,{N:()=>a});var r=n(37837),i=n(78828);const a={kernelName:r.FFT,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:r}=e;return(0,i.J)(r,!1,n)}}},78828:(t,e,n)=>{"use strict";n.d(e,{J:()=>s});var r=n(37837),i=n(65711),a=n(5795),o=n(52813);function s(t,e,n){const s=n.texData.get(t.dataId),c=r.util.sizeFromShape(t.shape),u=t.shape[t.shape.length-1],l=c/u,h=(0,o.t)({inputs:{x:t},backend:n,attrs:{shape:[l,u]}}),d=h.shape,f=new i.R("real",d,e),p=new i.R("imag",d,e),g=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:d},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:d}],m=n.runWebGLProgram(f,g,"float32"),v=n.runWebGLProgram(p,g,"float32"),y=(0,a.f)({inputs:{real:m,imag:v},backend:n});n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v);const b=(0,o.t)({inputs:{x:y},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(y),b}},97402:(t,e,n)=>{"use strict";n.d(e,{G:()=>a,u:()=>o});var r=n(37837),i=n(24304);function a(t){const{backend:e,attrs:n}=t,{shape:a,value:o}=n;let{dtype:s}=n;if(s=s||r.util.inferDtype(o),"string"===s){const t=r.util.getArrayFromDType(s,r.util.sizeFromShape(a));return t.fill(o),e.makeTensorInfo(a,s,t)}{const t=new i.w(a,o),n=[[o]];return e.runWebGLProgram(t,[],s,n)}}const o={kernelName:r.Fill,backendName:"webgl",kernelFunc:a}},27007:(t,e,n)=>{"use strict";n.d(e,{D:()=>a});var r=n(37837),i=n(51927);const a={kernelName:r.FlipLeftRight,backendName:"webgl",kernelFunc:t=>{let{inputs:e,backend:n}=t;const{image:r}=e,a=n,o=new i.T(r.shape);return a.runWebGLProgram(o,[r],r.dtype)}}},8065:(t,e,n)=>{"use strict";n.d(e,{H:()=>c});var r=n(37837),i=n(55289),a=n(37999);const o="return floor(x);",s=(0,i.vi)({opSnippet:o,packedOpSnippet:o,cpuKernelImpl:a.CJ}),c={kernelName:r.Floor,backendName:"webgl",kernelFunc:s}},40082:(t,e,n)=>{"use strict";n.d(e,{U:()=>a});var r=n(37837);const i=(0,n(55289).j0)({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),a={kernelName:r.FloorDiv,backendName:"webgl",kernelFunc:i}},53498:(t,e,n)=>{"use strict";n.d(e,{y:()=>s});var r=n(37837),i=n(4870),a=n(96426),o=n(77139);const s={kernelName:r.FromPixels,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t;let{pixels:l}=e;const{numChannels:h}=s,d="undefined"!==typeof HTMLVideoElement&&l instanceof HTMLVideoElement,f="undefined"!==typeof HTMLImageElement&&l instanceof HTMLImageElement,[p,g]=d?[l.videoWidth,l.videoHeight]:[l.width,l.height],m=[g,p],v=[g,p,h];if(f||d){const t=(0,r.env)().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=c&&t===u||(u=t,c=document.createElement("canvas").getContext("2d",{willReadFrequently:u})),c.canvas.width=p,c.canvas.height=g,c.drawImage(l,0,0,p,g),l=c.canvas}const y=n.makeTensorInfo(m,"int32");n.texData.get(y.dataId).usage=i.tT.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(y.dataId),l);const b=(0,r.env)().getBool("WEBGL_PACK")?new o.g(v):new a.Y(v),x=n.runWebGLProgram(b,[y],"int32");return n.disposeData(y.dataId),x}};let c,u=(0,r.env)().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU")},96426:(t,e,n)=>{"use strict";n.d(e,{Y:()=>i});var r=n(82071);class i{constructor(t){this.variableNames=["A"];const e=(0,r.B)(),[n,i]=t;this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(i,".0, ").concat(n,".0);\n\n        vec4 values = ").concat(e.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")}}},77139:(t,e,n)=>{"use strict";n.d(e,{g:()=>i});var r=n(82071);class i{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const e=(0,r.B)(),[n,i]=t;this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(i,".0, ").concat(n,".0);\n            vec4 values = ").concat(e.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(e.output," = result;\n      }\n    ")}}},47952:(t,e,n)=>{"use strict";n.d(e,{q:()=>u});var r=n(37837),i=n(6031),a=n(29196),o=n(55289),s=n(67868),c=n(52813);const u={kernelName:r.FusedConv2D,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:u}=t,{x:l,filter:h,bias:d,preluActivationWeights:f}=e,{strides:p,pad:g,dataFormat:m,dilations:v,dimRoundingMode:y,activation:b,leakyreluAlpha:x}=u,w=r.backend_util.convertConv2DDataFormat(m),k=r.backend_util.computeConv2DInfo(l.shape,h.shape,p,v,g,y,!1,w);let _;const A=[],C=null!=d,S=null!=f,E="leakyrelu"===b,T=()=>{const t=[l,h],e=(t,e)=>{if("NCHW"===e&&1===t.shape.length&&1!==t.shape[0]){const e=(0,c.t)({inputs:{x:t},backend:n,attrs:{shape:[t.shape[0],1,1]}});return A.push(e),e}return t};if(C&&t.push(e(d,m)),S&&t.push(e(f,m)),E){const e=n.makeTensorInfo([],"float32",r.util.createScalarValue(x,"float32"));t.push(e),A.push(e)}return t};if(1!==k.filterHeight||1!==k.filterWidth||1!==k.dilationHeight||1!==k.dilationWidth||1!==k.strideHeight||1!==k.strideWidth||"SAME"!==k.padInfo.type&&"VALID"!==k.padInfo.type)if(k.strideWidth<=2&&"channelsLast"===w&&(0,r.env)().getBool("WEBGL_EXP_CONV")){const t=b?(0,o.bE)(b,!0):null,e=new a.Z(k,C,t,S,E),r=[[k.padInfo.top,k.padInfo.left],[k.strideHeight,k.strideWidth],[k.dilationHeight,k.dilationWidth],[k.inHeight,k.inWidth]],i=T();_=n.runWebGLProgram(e,i,"float32",r)}else if((0,r.env)().getBool("WEBGL_CONV_IM2COL"))_=(0,s.J)({x:l,filter:h,convInfo:k,backend:n,bias:d,activation:b,preluActivationWeights:f,leakyreluAlpha:x});else{const t=b?(0,o.bE)(b,!1):null,e=new i.B(k,C,t,S,E),r=T();_=n.runWebGLProgram(e,r,"float32")}else _=(0,s.K)({x:l,filter:h,convInfo:k,backend:n,bias:d,activation:b,preluActivationWeights:f,leakyreluAlpha:x});const N=(0,c.t)({inputs:{x:_},backend:n,attrs:{shape:k.outShape}});return A.push(_),A.forEach((t=>n.disposeIntermediateTensorInfo(t))),N}}},58312:(t,e,n)=>{"use strict";n.d(e,{l:()=>s});var r=n(37837),i=n(41301),a=n(34606),o=n(55289);const s={kernelName:r.FusedDepthwiseConv2D,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:c,filter:u,bias:l,preluActivationWeights:h}=e,{strides:d,pad:f,dilations:p,dimRoundingMode:g,activation:m,leakyreluAlpha:v}=s,y=[];let b=p;null==b&&(b=[1,1]),r.util.assert(r.backend_util.eitherStridesOrDilationsAreOne(d,b),(()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(d," and dilations '").concat(b,"'")));const x=r.backend_util.computeConv2DInfo(c.shape,u.shape,d,b,f,g,!0),w=(0,r.env)().getBool("WEBGL_PACK_DEPTHWISECONV")&&x.strideWidth<=2&&x.outChannels/x.inChannels===1,k=m?(0,o.bE)(m,w):null,_=[c,u],A=null!=l,C=null!=h,S="leakyrelu"===m;if(A&&_.push(l),C&&_.push(h),S){const t=n.makeTensorInfo([],"float32",r.util.createScalarValue(v,"float32"));_.push(t),y.push(t)}let E;E=w?new a.K(x,A,k,C,S):new i.E(x,A,k,C,S);const T=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],N=n.runWebGLProgram(E,_,"float32",T);return y.forEach((t=>n.disposeIntermediateTensorInfo(t))),N}}},79230:(t,e,n)=>{"use strict";n.d(e,{K:()=>s});var r=n(37837),i=n(97893),a=n(37999),o=n(52813);const s={kernelName:r.GatherNd,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{params:s,indices:c}=e,u=c.shape,l=u[u.length-1],h=r.util.sizeFromShape(s.shape),[d,f,p,g]=r.backend_util.prepareAndValidate(s,c),m=(0,o.t)({inputs:{x:c},backend:n,attrs:{shape:[f,l]}}),v=(0,o.t)({inputs:{x:s},backend:n,attrs:{shape:[r.util.sizeFromShape(s.shape)/p,p]}});if(n.shouldExecuteOnCPU([s,c])||"string"===s.dtype){const t=n.readSync(c.dataId),e=n.bufferSync(s),r=(0,a.UF)(t,e,s.dtype,f,l,p,g,s.shape,h);return n.makeTensorInfo(d,s.dtype,r.values)}const y=new i.g(l,g,[f,p],s.shape),b=n.runWebGLProgram(y,[v,m],v.dtype),x=(0,o.t)({inputs:{x:b},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(b),x}}},56224:(t,e,n)=>{"use strict";n.d(e,{C:()=>s,a:()=>c});var r=n(37837),i=n(25554),a=n(37999),o=n(52813);function s(t){const{inputs:e,backend:n,attrs:s}=t,{x:c,indices:u}=e,{axis:l,batchDims:h}=s,d=r.util.parseAxisParam(l,c.shape)[0];if((0,r.env)().get("DEBUG")){const t=n.readSync(u.dataId),e=c.shape[d];for(let n=0;n<t.length;++n){const i=t[n];r.util.assert(i<=e-1&&i>=0,(()=>"GatherV2: the index value ".concat(i," is not in [0, ").concat(e-1,"]")))}}const f=r.backend_util.segment_util.collectGatherOpShapeInfo(c,u,d,h),p=r.util.sizeFromShape(u.shape),g=[],m=(0,o.t)({inputs:{x:c},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),v=(0,o.t)({inputs:{x:u},backend:n,attrs:{shape:[f.batchSize,p/f.batchSize]}});g.push(m),g.push(v);const y=[f.batchSize,f.outerSize,p/f.batchSize,f.sliceSize];if(n.shouldExecuteOnCPU([c,u])||"string"===c.dtype){const t=n.bufferSync(v),e=n.bufferSync(m),r=(0,a.QM)(e,t,y);return g.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.makeTensorInfo(f.outputShape,r.dtype,r.values)}const b=new i.u(m.shape,y),x=n.runWebGLProgram(b,[m,v],m.dtype);g.push(x);const w=(0,o.t)({inputs:{x:x},backend:n,attrs:{shape:f.outputShape}});return g.forEach((t=>n.disposeIntermediateTensorInfo(t))),w}const c={kernelName:r.GatherV2,backendName:"webgl",kernelFunc:s}},80769:(t,e,n)=>{"use strict";n.d(e,{x:()=>s});var r=n(37837),i=n(55289),a=n(37999);const o=(0,i.j0)({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:a.Tm,dtype:"bool"}),s={kernelName:r.Greater,backendName:"webgl",kernelFunc:o}},24445:(t,e,n)=>{"use strict";n.d(e,{V:()=>s});var r=n(37837),i=n(55289),a=n(37999);const o=(0,i.j0)({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:a.BW}),s={kernelName:r.GreaterEqual,backendName:"webgl",kernelFunc:o}},29222:(t,e,n)=>{"use strict";n.d(e,{c:()=>a});var r=n(37837),i=n(78828);const a={kernelName:r.IFFT,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:r}=e;return(0,i.J)(r,!0,n)}}},57381:(t,e,n)=>{"use strict";function r(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}n.d(e,{D:()=>r,F:()=>i});const i={kernelName:n(37837).Identity,backendName:"webgl",kernelFunc:r}},81877:(t,e,n)=>{"use strict";n.d(e,{l:()=>o,n:()=>a});var r=n(37837),i=n(57381);function a(t){const{inputs:e,backend:n}=t,{input:r}=e,a=n.texData.get(r.dataId);return(0,i.D)({inputs:{x:a.complexTensorInfos.imag},backend:n})}const o={kernelName:r.Imag,backendName:"webgl",kernelFunc:a}},93572:(t,e,n)=>{"use strict";n.d(e,{K:()=>a});var r=n(37837);const i=(0,n(55289).vi)({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),a={kernelName:r.IsFinite,backendName:"webgl",kernelFunc:i}},57336:(t,e,n)=>{"use strict";n.d(e,{I:()=>a});var r=n(37837);const i=(0,n(55289).vi)({opSnippet:"return float(isinf(x));",dtype:"bool"}),a={kernelName:r.IsInf,backendName:"webgl",kernelFunc:i}},20070:(t,e,n)=>{"use strict";n.d(e,{I:()=>a});var r=n(37837);const i=(0,n(55289).vi)({opSnippet:"return float(isnan(x));",dtype:"bool"}),a={kernelName:r.IsNan,backendName:"webgl",kernelFunc:i}},9371:(t,e,n)=>{"use strict";n.d(e,{x:()=>o});var r=n(37837),i=n(81867),a=n(67912);const o={kernelName:r.LRN,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:o}=t,{x:s}=e,{depthRadius:c,bias:u,alpha:l,beta:h}=o,d=(0,r.env)().getBool("WEBGL_PACK_NORMALIZATION")?new a.f(s.shape,c,u,l,h):new i.F(s.shape,c,u,l,h);return n.runWebGLProgram(d,[s],s.dtype)}}},66467:(t,e,n)=>{"use strict";n.d(e,{j:()=>a});var r=n(37837),i=n(27824);const a={kernelName:r.LRNGrad,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a,y:o,dy:s}=e,{depthRadius:c,bias:u,alpha:l,beta:h}=r,d=new i.j(a.shape,c,u,l,h);return n.runWebGLProgram(d,[a,o,s],a.dtype)}}},36267:(t,e,n)=>{"use strict";n.d(e,{B1:()=>o,aw:()=>s,zp:()=>c});var r=n(37837),i=n(74139),a=n(61880);const o="return (a < 0.) ? b * a : a;",s="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const c={kernelName:r.LeakyRelu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:c}=t,{x:u}=e,{alpha:l}=c,h=n.makeTensorInfo([],"float32",r.util.createScalarValue(l,"float32")),d=(0,r.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new a.VI(s,u.shape,h.shape):new i.x(o,u.shape,h.shape),f=n.runWebGLProgram(d,[u,h],"float32");return n.disposeIntermediateTensorInfo(h),f}}},82106:(t,e,n)=>{"use strict";n.d(e,{Y:()=>s});var r=n(37837),i=n(55289),a=n(37999);const o=(0,i.j0)({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:a.uw,dtype:"bool"}),s={kernelName:r.Less,backendName:"webgl",kernelFunc:o}},61504:(t,e,n)=>{"use strict";n.d(e,{Q:()=>s});var r=n(37837),i=n(55289),a=n(37999);const o=(0,i.j0)({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:a.mo,dtype:"bool"}),s={kernelName:r.LessEqual,backendName:"webgl",kernelFunc:o}},33092:(t,e,n)=>{"use strict";n.d(e,{o:()=>a});var r=n(37837),i=n(37999);const a={kernelName:r.LinSpace,backendName:"webgl",kernelFunc:function(t){const{backend:e,attrs:n}=t,{start:r,stop:a,num:o}=n,s=(0,i.AC)(r,a,o);return e.makeTensorInfo([s.length],"float32",s)}}},87261:(t,e,n)=>{"use strict";n.d(e,{F:()=>c});var r=n(37837),i=n(55289),a=n(37999);const o=i.Zt+"\n  return x < 0.0 ? 0./0. : log(x);\n",s=(0,i.vi)({opSnippet:o,packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:a.rI}),c={kernelName:r.Log,backendName:"webgl",kernelFunc:s}},89480:(t,e,n)=>{"use strict";n.d(e,{W:()=>s});var r=n(37837),i=n(55289);const a=i.Zt+"\n  return log(1.0 + x);\n",o=(0,i.vi)({opSnippet:a}),s={kernelName:r.Log1p,backendName:"webgl",kernelFunc:o}},94779:(t,e,n)=>{"use strict";n.d(e,{V:()=>a});var r=n(37837);const i=(0,n(55289).j0)({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),a={kernelName:r.LogicalAnd,backendName:"webgl",kernelFunc:i}},81779:(t,e,n)=>{"use strict";n.d(e,{f:()=>a});var r=n(37837);const i=(0,n(55289).vi)({opSnippet:"return float(!(x >= 1.0));"}),a={kernelName:r.LogicalNot,backendName:"webgl",kernelFunc:i}},3621:(t,e,n)=>{"use strict";n.d(e,{r:()=>a});var r=n(37837);const i=(0,n(55289).j0)({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),a={kernelName:r.LogicalOr,backendName:"webgl",kernelFunc:i}},10481:(t,e,n)=>{"use strict";n.d(e,{T:()=>s,l:()=>c});var r=n(37837),i=n(37999),a=n(22910),o=n(41737);function s(t){const{inputs:e,backend:n,attrs:s}=t,{x:c}=e,{reductionIndices:u,keepDims:l}=s,h=c.shape.length,d=r.util.parseAxisParam(u,c.shape);let f=d;const p=r.backend_util.getAxesPermutation(f,h),g=null!=p,m=n.shouldExecuteOnCPU([c]);let v=c;if(g){if(m){const t=n.texData.get(v.dataId).values,e=new Array(h);for(let n=0;n<e.length;n++)e[n]=c.shape[p[n]];const r=(0,i.Q5)(t,c.shape,c.dtype,p,e);v=n.makeTensorInfo(e,c.dtype);n.texData.get(v.dataId).values=r}else v=(0,o._)(c,p,n);f=r.backend_util.getInnerMostAxes(f.length,h)}r.backend_util.assertAxesAreInnerMostDims("max",f,h);const[y,b]=r.backend_util.computeOutAndReduceShapes(v.shape,f);let x,w=y;if(l&&(w=r.backend_util.expandShapeToKeepDim(y,d)),m){const t=n.texData.get(v.dataId).values,e=(0,i.rw)(t,r.util.sizeFromShape(b),w,c.dtype);x=n.makeTensorInfo(w,c.dtype);n.texData.get(x.dataId).values=e}else x=(0,a.j)(v,b,w,n);return g&&n.disposeIntermediateTensorInfo(v),x}const c={kernelName:r.Max,backendName:"webgl",kernelFunc:s}},58603:(t,e,n)=>{"use strict";n.d(e,{$:()=>s});var r=n(37837),i=n(46051),a=n(11414),o=n(57381);const s={kernelName:r.MaxPool,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:c}=e;(0,a.CE)(c,"maxPool");const{filterSize:u,strides:l,pad:h,dimRoundingMode:d}=s;r.util.assert(r.backend_util.eitherStridesOrDilationsAreOne(l,1),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(l," and dilations '").concat(1,"'")));const f=r.backend_util.computePool2DInfo(c.shape,u,l,1,h,d);if(1===f.filterWidth&&1===f.filterHeight&&r.util.arraysEqual(f.inShape,f.outShape))return(0,o.D)({inputs:{x:c},backend:n});const p=new i.h(f,"max",!1);return n.runWebGLProgram(p,[c],c.dtype)}}},37456:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var r=n(37837),i=n(46051);const a={kernelName:r.MaxPool3D,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{x:o}=e,{filterSize:s,strides:c,pad:u,dataFormat:l,dimRoundingMode:h}=a,d=r.backend_util.computePool3DInfo(o.shape,s,c,[1,1,1],u,h,l),f=new i.U(d,"max",!1);return n.runWebGLProgram(f,[o],o.dtype)}}},71300:(t,e,n)=>{"use strict";n.d(e,{S:()=>o});var r=n(37837),i=n(91091),a=n(46051);const o={kernelName:r.MaxPool3DGrad,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:o}=t,{dy:s,input:c}=e,u=c,{filterSize:l,strides:h,pad:d,dimRoundingMode:f}=o,p=r.backend_util.computePool3DInfo(u.shape,l,h,[1,1,1],d,f),g=new a.U(p,"max",!0),m=n.runWebGLProgram(g,[u],u.dtype),v=new i.Y(p),y=n.runWebGLProgram(v,[s,m],u.dtype);return n.disposeIntermediateTensorInfo(m),y}}},69139:(t,e,n)=>{"use strict";n.d(e,{P:()=>s});var r=n(37837),i=n(91091),a=n(46051),o=n(11414);const s={kernelName:r.MaxPoolGrad,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{dy:c,input:u,output:l}=e,h=u;(0,o.CE)([u,l],"maxPoolGrad");const{filterSize:d,strides:f,pad:p,dimRoundingMode:g}=s,m=r.backend_util.computePool2DInfo(h.shape,d,f,1,p,g),v=new a.h(m,"max",!0),y=n.runWebGLProgram(v,[h],h.dtype),b=new i.d(m),x=n.runWebGLProgram(b,[c,y],h.dtype);return n.disposeIntermediateTensorInfo(y),x}}},4273:(t,e,n)=>{"use strict";n.d(e,{l:()=>a});var r=n(37837),i=n(95390);const a={kernelName:r.MaxPoolWithArgmax,backendName:"webgl",kernelFunc:t=>{let{inputs:e,attrs:n,backend:a}=t;const{x:o}=e,{filterSize:s,strides:c,pad:u,includeBatchInIndex:l}=n,h=a;r.util.assert(4===o.shape.length,(()=>"Error in maxPool: input must be rank 4 but got rank ".concat(o.shape.length,".")));const d=[1,1];r.util.assert(r.backend_util.eitherStridesOrDilationsAreOne(c,d),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(c," and dilations '").concat(d,"'")));const f=r.backend_util.computePool2DInfo(o.shape,s,c,d,u),[p,g]=(0,i.b)(o,l,f,h);return[p,g]}}},95390:(t,e,n)=>{"use strict";n.d(e,{b:()=>i});var r=n(46051);function i(t,e,n,i){let a=new r.h(n,"max",!1);const o=i.runWebGLProgram(a,[t],"float32");a=new r.h(n,"max",!0,!0,e);return[o,i.runWebGLProgram(a,[t],"float32")]}},22910:(t,e,n)=>{"use strict";n.d(e,{j:()=>o});var r=n(37837),i=n(71912),a=n(52813);function o(t,e,n,o){const s=r.util.sizeFromShape(e),c=r.util.sizeFromShape(t.shape)/s,u=(0,a.t)({inputs:{x:t},attrs:{shape:[c,s]},backend:o}),l=(0,i.T)(u,t.dtype,"max",o),h=(0,a.t)({inputs:{x:l},attrs:{shape:n},backend:o});return o.disposeIntermediateTensorInfo(u),o.disposeIntermediateTensorInfo(l),h}},35785:(t,e,n)=>{"use strict";n.d(e,{l:()=>h});var r=n(37837),i=n(74139),a=n(61880),o=n(55289),s=n(37999);const c=i.dR+"\n  return max(a, b);\n",u="\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+a.qq+"\n  return result;\n",l=(0,o.j0)({opSnippet:c,packedOpSnippet:u,cpuKernelImpl:s.Dy}),h={kernelName:r.Maximum,backendName:"webgl",kernelFunc:l}},31850:(t,e,n)=>{"use strict";n.d(e,{M:()=>s});var r=n(37837),i=n(29079),a=n(37999),o=n(41737);const s={kernelName:r.Mean,backendName:"webgl",kernelFunc:t=>{let{inputs:e,attrs:n,backend:s}=t;const{x:c}=e,{keepDims:u,axis:l}=n,h=s,d=c.shape.length,f=r.util.parseAxisParam(l,c.shape);let p=f;const g=r.backend_util.getAxesPermutation(p,d),m=null!=g,v=h.shouldExecuteOnCPU([c]),y=[];let b=c;if(m){if(v){const t=h.texData.get(b.dataId).values,e=new Array(d);for(let r=0;r<e.length;r++)e[r]=c.shape[g[r]];const n=(0,a.Q5)(t,c.shape,c.dtype,g,e);b=h.makeTensorInfo(e,c.dtype);h.texData.get(b.dataId).values=n}else b=(0,o._)(c,g,h);y.push(b),p=r.backend_util.getInnerMostAxes(p.length,d)}r.backend_util.assertAxesAreInnerMostDims("sum",p,d);const[x,w]=r.backend_util.computeOutAndReduceShapes(b.shape,p);let k=x;u&&(k=r.backend_util.expandShapeToKeepDim(x,f));const _=(0,i.u)(b,w,k,h);for(const r of y)h.disposeIntermediateTensorInfo(r);return _}}},29079:(t,e,n)=>{"use strict";n.d(e,{u:()=>o});var r=n(37837),i=n(71912),a=n(52813);function o(t,e,n,o){const s=r.util.sizeFromShape(e),c=r.util.sizeFromShape(t.shape)/s,u=(0,a.t)({inputs:{x:t},attrs:{shape:[c,s]},backend:o}),l=(0,i.T)(u,"float32","mean",o),h=(0,a.t)({inputs:{x:l},attrs:{shape:n},backend:o});return o.disposeIntermediateTensorInfo(u),o.disposeIntermediateTensorInfo(l),h}},62819:(t,e,n)=>{"use strict";n.d(e,{j:()=>s});var r=n(37837),i=n(71912),a=n(52813),o=n(78652);const s={kernelName:r.Min,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:c}=e,{axis:u,keepDims:l}=s,h=c.shape.length,d=r.util.parseAxisParam(u,c.shape);let f=d;const p=r.backend_util.getAxesPermutation(f,h);let g=c;null!=p&&(g=(0,o.m)({inputs:{x:c},backend:n,attrs:{perm:p}}),f=r.backend_util.getInnerMostAxes(f.length,c.shape.length)),r.backend_util.assertAxesAreInnerMostDims("min",f,h);const[m,v]=r.backend_util.computeOutAndReduceShapes(g.shape,f),y=r.util.sizeFromShape(v),b=(0,a.t)({inputs:{x:g},backend:n,attrs:{shape:[-1,y]}}),x=(0,i.T)(b,b.dtype,"min",n);let w;if(l){const t=r.backend_util.expandShapeToKeepDim(m,d);w=(0,a.t)({inputs:{x:x},backend:n,attrs:{shape:t}})}else w=(0,a.t)({inputs:{x:x},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(x),null!=p&&n.disposeIntermediateTensorInfo(g),w}}},31147:(t,e,n)=>{"use strict";n.d(e,{N:()=>h});var r=n(37837),i=n(74139),a=n(61880),o=n(55289),s=n(37999);const c=i.dR+"\n  return min(a, b);\n",u="\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+a.qq+"\n  return result;\n",l=(0,o.j0)({opSnippet:c,packedOpSnippet:u,cpuKernelImpl:s.h}),h={kernelName:r.Minimum,backendName:"webgl",kernelFunc:l}},39523:(t,e,n)=>{"use strict";n.d(e,{V:()=>o});var r=n(37837),i=n(97952),a=n(80577);const o={kernelName:r.MirrorPad,backendName:"webgl",kernelFunc:t=>{let{inputs:e,backend:n,attrs:o}=t;const{x:s}=e,{paddings:c,mode:u}=o,l=(0,r.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new a.V(s.shape,c,u):new i.X(s.shape,c,u);return n.runWebGLProgram(l,[s],s.dtype)}}},34435:(t,e,n)=>{"use strict";n.d(e,{X:()=>c});var r=n(37837),i=n(61880),a=n(55289);const o="\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+i.qq+"\n  return result;\n",s=(0,a.j0)({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:o}),c={kernelName:r.Mod,backendName:"webgl",kernelFunc:s}},36962:(t,e,n)=>{"use strict";n.d(e,{a:()=>o});var r=n(37837),i=n(16990),a=n(20497);const o={kernelName:r.Multinomial,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{logits:o}=e,{numSamples:s,seed:c,normalized:u}=r,l=u?o:(0,a.V)({inputs:{logits:o},backend:n,attrs:{dim:o.shape.length-1}}),h=l.shape[0],d=l.shape[1],f=new i.O(h,d,s),p=[[c]],g=n.runWebGLProgram(f,[l],"int32",p);return u||n.disposeIntermediateTensorInfo(l),g}}},39999:(t,e,n)=>{"use strict";n.d(e,{l:()=>l,t:()=>h});var r=n(37837),i=n(38376),a=n(74139),o=n(61880),s=n(37999),c=n(5795);const u="return a * b;";function l(t){const{inputs:e,backend:n}=t,{a:l,b:h}=e,d=r.backend_util.upcastType(l.dtype,h.dtype);if("complex64"===l.dtype){const t=n.texData.get(l.dataId),e=n.texData.get(h.dataId),r=new i.f(i.C.REAL,l.shape,h.shape),a=new i.f(i.C.IMAG,l.shape,h.shape),o=[{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:l.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:l.shape},{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:h.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:h.shape}],s=n.runWebGLProgram(r,o,"float32"),u=n.runWebGLProgram(a,o,"float32"),d=(0,c.f)({inputs:{real:s,imag:u},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(u),d}if(n.shouldExecuteOnCPU([l,h])){const t=n.texData.get(l.dataId),e=n.texData.get(h.dataId),[r,i]=(0,s.Xe)(l.shape,h.shape,t.values,e.values,d),a=n.makeTensorInfo(i,d);return n.texData.get(a.dataId).values=r,a}let f;return f=(0,r.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new o.VI(u,l.shape,h.shape):new a.x(u,l.shape,h.shape),n.runWebGLProgram(f,[l,h],d)}const h={kernelName:r.Multiply,backendName:"webgl",kernelFunc:l}},70737:(t,e,n)=>{"use strict";n.d(e,{h:()=>c});var r=n(37837),i=n(37999),a=n(23199),o=n(53884);const s=a.dR+"\n  return -x;\n";const c={kernelName:r.Neg,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:c}=e;if(n.shouldExecuteOnCPU([c])){const t=n.texData.get(c.dataId),[e,r]=(0,i.rQ)(t.values,c.shape,c.dtype);return n.makeTensorInfo(r,c.dtype,e)}let u;return u=(0,r.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new o.rf(c.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new a.hE(c.shape,s),n.runWebGLProgram(u,[c],c.dtype)}}},91590:(t,e,n)=>{"use strict";n.d(e,{m:()=>a});var r=n(37837);const i=r.kernel_impls.nonMaxSuppressionV3Impl;const a={kernelName:r.NonMaxSuppressionV3,backendName:"webgl",kernelFunc:function(t){r.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:a}=t,{boxes:o,scores:s}=e,{maxOutputSize:c,iouThreshold:u,scoreThreshold:l}=a,h=n.readSync(o.dataId),d=n.readSync(s.dataId),{selectedIndices:f}=i(h,d,c,u,l);return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}}},11271:(t,e,n)=>{"use strict";n.d(e,{F:()=>a});var r=n(37837);const i=r.kernel_impls.nonMaxSuppressionV4Impl;const a={kernelName:r.NonMaxSuppressionV4,backendName:"webgl",kernelFunc:function(t){r.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:a}=t,{boxes:o,scores:s}=e,{maxOutputSize:c,iouThreshold:u,scoreThreshold:l,padToMaxOutputSize:h}=a,d=n.readSync(o.dataId),f=n.readSync(s.dataId),{selectedIndices:p,validOutputs:g}=i(d,f,c,u,l,h);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([g]))]}}},87120:(t,e,n)=>{"use strict";n.d(e,{u:()=>a});var r=n(37837);const i=r.kernel_impls.nonMaxSuppressionV5Impl;const a={kernelName:r.NonMaxSuppressionV5,backendName:"webgl",kernelFunc:function(t){r.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:a}=t,{boxes:o,scores:s}=e,{maxOutputSize:c,iouThreshold:u,scoreThreshold:l,softNmsSigma:h}=a,d=n.readSync(o.dataId),f=n.readSync(s.dataId),p=c,g=u,m=l,v=h,{selectedIndices:y,selectedScores:b}=i(d,f,p,g,m,v);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([b.length],"float32",new Float32Array(b))]}}},93592:(t,e,n)=>{"use strict";n.d(e,{A:()=>s,E:()=>o});var r=n(37837),i=n(55289),a=n(37999);const o=(0,i.j0)({opSnippet:"return float(a != b);",cpuKernelImpl:a.ad,dtype:"bool"}),s={kernelName:r.NotEqual,backendName:"webgl",kernelFunc:o}},11532:(t,e,n)=>{"use strict";n.d(e,{_:()=>o});var r=n(37837),i=n(83994),a=n(52813);const o={kernelName:r.OneHot,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:o}=t,{indices:s}=e,{dtype:c,depth:u,onValue:l,offValue:h}=o,d=r.util.sizeFromShape(s.shape),f=new i.M(d,u,l,h),p=(0,a.t)({inputs:{x:s},backend:n,attrs:{shape:[d]}}),g=n.runWebGLProgram(f,[p],c);n.disposeIntermediateTensorInfo(p);const m=[...s.shape,u],v=(0,a.t)({inputs:{x:g},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(g),v}}},78785:(t,e,n)=>{"use strict";n.d(e,{h:()=>u});var r=n(37837),i=n(5795),a=n(97402),o=n(81877),s=n(93067),c=n(66895);const u={kernelName:r.OnesLike,backendName:"webgl",kernelFunc:function t(e){const{inputs:n,backend:r}=e,{x:u}=n;if("string"===u.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===u.dtype){const e=(0,s.x)({inputs:{input:u},backend:r}),n=t({inputs:{x:e},backend:r}),a=(0,o.n)({inputs:{input:u},backend:r}),l=(0,c.P)({inputs:{x:a},backend:r}),h=(0,i.f)({inputs:{real:n,imag:l},backend:r});return r.disposeIntermediateTensorInfo(e),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),h}return(0,a.G)({attrs:{shape:u.shape,dtype:u.dtype,value:1},backend:r})}}},73666:(t,e,n)=>{"use strict";n.d(e,{q:()=>o});var r=n(37837),i=n(1415),a=n(13764);const o={kernelName:r.Pack,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:o}=t,{axis:s}=o;if(1===e.length)return(0,a.U)({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const c=e[0].shape,u=e[0].dtype;e.forEach((t=>{r.util.assertShapesMatch(c,t.shape,"All tensors passed to stack must have matching shapes"),r.util.assert(u===t.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const l=[],h=e.map((t=>{const e=(0,a.U)({inputs:{input:t},backend:n,attrs:{dim:s}});return l.push(e),e})),d=(0,i.x)({inputs:h,backend:n,attrs:{axis:s}});return l.forEach((t=>n.disposeIntermediateTensorInfo(t))),d}}},25850:(t,e,n)=>{"use strict";n.d(e,{e:()=>c,w:()=>s});var r=n(37837),i=n(36342),a=n(75455),o=n(97402);const s=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:c}=e,{paddings:u,constantValue:l}=s;if(0===r.util.sizeFromShape(c.shape)){const t=u.map(((t,e)=>t[0]+c.shape[e]+t[1]));return(0,o.G)({backend:n,attrs:{shape:t,value:l,dtype:c.dtype}})}const h=(0,r.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new a._(c.shape,u,l):new i.e(c.shape,u,l),d=[[l]];return n.runWebGLProgram(h,[c],c.dtype,d)},c={kernelName:r.PadV2,backendName:"webgl",kernelFunc:s}},12825:(t,e,n)=>{"use strict";n.d(e,{j:()=>c});var r=n(37837),i=n(61880),a=n(55289);const o="\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+i.qq+"\n  return result;\n",s=(0,a.j0)({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:o}),c={kernelName:r.Pow,backendName:"webgl",kernelFunc:s}},35329:(t,e,n)=>{"use strict";n.d(e,{CN:()=>s,DH:()=>o,HK:()=>c});var r=n(37837),i=n(74139),a=n(61880);const o="return (a < 0.) ? b * a : a;",s="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const c={kernelName:r.Prelu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:c,alpha:u}=e,l=(0,r.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new a.VI(s,c.shape,u.shape):new i.x(o,c.shape,u.shape);return n.runWebGLProgram(l,[c,u],"float32")}}},67638:(t,e,n)=>{"use strict";n.d(e,{S:()=>c});var r=n(37837),i=n(71912),a=n(37999),o=n(52813),s=n(78652);const c={kernelName:r.Prod,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:c}=t,{x:u}=e,{axis:l,keepDims:h}=c,d=u.shape.length,f=[],p=r.util.parseAxisParam(l,u.shape);let g=p;const m=r.backend_util.getAxesPermutation(g,d);let v,y=u;if(null!=m&&(y=(0,s.m)({inputs:{x:u},backend:n,attrs:{perm:m}}),g=r.backend_util.getInnerMostAxes(g.length,d),f.push(y)),r.backend_util.assertAxesAreInnerMostDims("prod",g,d),n.shouldExecuteOnCPU([y])){const t=n.texData.get(y.dataId).values,{outVals:e,outShape:r,outDtype:i}=(0,a.Og)(y.shape,y.dtype,t,g);v=n.makeTensorInfo(r,i,e)}else{const[t,e]=r.backend_util.computeOutAndReduceShapes(y.shape,g),a=r.util.sizeFromShape(e),s=(0,o.t)({inputs:{x:y},backend:n,attrs:{shape:[-1,a]}}),c=(0,r.sumOutType)(u.dtype),l=(0,i.T)(s,c,"prod",n);v=(0,o.t)({inputs:{x:l},backend:n,attrs:{shape:t}}),f.push(s),f.push(l)}if(h){f.push(v);const t=r.backend_util.expandShapeToKeepDim(v.shape,p);v=(0,o.t)({inputs:{x:v},backend:n,attrs:{shape:t}})}return f.forEach((t=>n.disposeIntermediateTensorInfo(t))),v}}},17786:(t,e,n)=>{"use strict";n.d(e,{i:()=>a});var r=n(37837),i=n(37999);const a={kernelName:r.RaggedGather,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:a,paramsDenseValues:o,indices:s}=e,{outputRaggedRank:c}=r,u=a.map((t=>n.readSync(t.dataId))),l=a.map((t=>t.shape)),h=n.readSync(o.dataId),d=n.readSync(s.dataId),[f,p,g]=(0,i.G4)(u,l,h,o.shape,o.dtype,d,s.shape,c),m=f.map((t=>n.makeTensorInfo([t.length],"int32",t))),v=n.makeTensorInfo(g,o.dtype,p);return m.concat([v])}}},5412:(t,e,n)=>{"use strict";n.d(e,{Y:()=>a});var r=n(37837),i=n(37999);const a={kernelName:r.RaggedRange,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{starts:r,limits:a,deltas:o}=e,s=n.readSync(r.dataId),c=n.readSync(a.dataId),u=n.readSync(o.dataId),[l,h]=(0,i.Oy)(s,r.shape,r.dtype,c,a.shape,u,o.shape);return[n.makeTensorInfo([l.length],"int32",l),n.makeTensorInfo([h.length],r.dtype,h)]}}},2052:(t,e,n)=>{"use strict";n.d(e,{g:()=>a});var r=n(37837),i=n(37999);const a={kernelName:r.RaggedTensorToTensor,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{shape:a,values:o,defaultValue:s,rowPartitionTensors:c}=e,{rowPartitionTypes:u}=r,l=n.readSync(a.dataId),h=n.readSync(o.dataId),d=n.readSync(s.dataId),f=c.map((t=>n.readSync(t.dataId))),p=c.map((t=>t.shape)),[g,m]=(0,i.G3)(l,a.shape,h,o.shape,o.dtype,d,s.shape,f,p,u);return n.makeTensorInfo(g,o.dtype,m)}}},14526:(t,e,n)=>{"use strict";n.d(e,{i:()=>o,y:()=>a});var r=n(37837),i=n(37999);const a=t=>{const{backend:e,attrs:n}=t,{start:r,stop:a,step:o,dtype:s}=n,c=(0,i.we)(r,a,o,s);return e.makeTensorInfo([c.length],s,c)},o={kernelName:r.Range,backendName:"webgl",kernelFunc:a}},93067:(t,e,n)=>{"use strict";n.d(e,{r:()=>o,x:()=>a});var r=n(37837),i=n(57381);function a(t){const{inputs:e,backend:n}=t,{input:r}=e,a=n.texData.get(r.dataId);return(0,i.D)({inputs:{x:a.complexTensorInfos.real},backend:n})}const o={kernelName:r.Real,backendName:"webgl",kernelFunc:a}},92284:(t,e,n)=>{"use strict";n.d(e,{G:()=>a,M:()=>i});var r=n(37837);const i=(0,n(55289).j0)({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),a={kernelName:r.RealDiv,backendName:"webgl",kernelFunc:i}},56331:(t,e,n)=>{"use strict";n.d(e,{l:()=>a});var r=n(37837);const i=(0,n(55289).vi)({opSnippet:"return 1.0 / x;"}),a={kernelName:r.Reciprocal,backendName:"webgl",kernelFunc:i}},5209:(t,e,n)=>{"use strict";n.d(e,{z:()=>s});var r=n(37837),i=n(55289);const a=n(23199).dR+"\n  return (x < 0.0) ? 0.0 : x;\n",o=(0,i.vi)({opSnippet:a,packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),s={kernelName:r.Relu,backendName:"webgl",kernelFunc:o}},95431:(t,e,n)=>{"use strict";n.d(e,{X:()=>s});var r=n(37837),i=n(55289);const a=n(23199).dR+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",o=(0,i.vi)({opSnippet:a,packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),s={kernelName:r.Relu6,backendName:"webgl",kernelFunc:o}},52813:(t,e,n)=>{"use strict";n.d(e,{V:()=>s,t:()=>o});var r=n(37837),i=n(47306),a=n(11414);function o(t){const{inputs:e,backend:n,attrs:o}=t,{x:s}=e,{shape:c}=o,u=n,l=r.util.sizeFromShape(s.shape),h=r.util.inferFromImplicitShape(c,l),d=r.util.sizeFromShape(h);r.util.assert(l===d,(()=>"The new shape (".concat(h,") has ").concat(d," elements and the old ")+"shape (".concat(s.shape,") has ").concat(l," elements. The new shape and old ")+"shape must have the same number of elements."));const f=u.texData.get(s.dataId);return!f.isPacked||(0,a.P0)(s.shape,h)||null!==f.texture&&(0,a.P0)(f.shape,h)?(u.incRef(s.dataId),{dataId:s.dataId,shape:h,dtype:s.dtype}):(0,i.p)(s,h,u)}const s={kernelName:r.Reshape,backendName:"webgl",kernelFunc:o}},60975:(t,e,n)=>{"use strict";n.d(e,{T:()=>o});var r=n(37837),i=n(3230),a=n(8279);const o={kernelName:r.ResizeBilinear,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:o}=t,{images:s}=e,{alignCorners:c,halfPixelCenters:u,size:l}=o,[h,d]=l,f=(0,r.env)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new a.x(s.shape,h,d,c,u):new i.z(s.shape,h,d,c,u);return n.runWebGLProgram(f,[s],"float32")}}},77319:(t,e,n)=>{"use strict";n.d(e,{j:()=>a});var r=n(37837),i=n(78389);const a={kernelName:r.ResizeBilinearGrad,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:a,dy:o}=e,{alignCorners:s}=r,c=new i.h(o.shape,a.shape,s);return n.runWebGLProgram(c,[o],o.dtype)}}},94575:(t,e,n)=>{"use strict";n.d(e,{j:()=>o});var r=n(37837),i=n(43415),a=n(53956);const o={kernelName:r.ResizeNearestNeighbor,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:o}=t,{images:s}=e,{alignCorners:c,halfPixelCenters:u,size:l}=o,[h,d]=l,f=(0,r.env)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new a.z(s.shape,h,d,c,u):new i.$(s.shape,h,d,c,u);return n.runWebGLProgram(f,[s],s.dtype)}}},50887:(t,e,n)=>{"use strict";n.d(e,{n:()=>a});var r=n(37837),i=n(49426);const a={kernelName:r.ResizeNearestNeighborGrad,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:a,dy:o}=e,{alignCorners:s}=r,c=new i.x(o.shape,a.shape,s);return n.runWebGLProgram(c,[o],o.dtype)}}},96625:(t,e,n)=>{"use strict";n.d(e,{r:()=>s});var r=n(37837),i=n(73909),a=n(99426),o=n(57381);const s={kernelName:r.Reverse,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{x:c}=e,{dims:u}=s,l=c.shape.length,h=r.util.parseAxisParam(u,c.shape);if(0===l)return(0,o.D)({inputs:{x:c},backend:n});const d=(0,r.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new a.X(c.shape,h):new i.N(c.shape,h);return n.runWebGLProgram(d,[c],c.dtype)}}},34963:(t,e,n)=>{"use strict";n.d(e,{f:()=>a});var r=n(37837),i=n(65698);const a={kernelName:r.RotateWithOffset,backendName:"webgl",kernelFunc:t=>{let{inputs:e,attrs:n,backend:a}=t;const{image:o}=e,{radians:s,fillValue:c,center:u}=n,l=a,h=new i.e(o.shape,c),[d,f]=r.backend_util.getImageCenter(u,o.shape[1],o.shape[2]),p=[[d,f,Math.sin(s),Math.cos(s)]];return l.runWebGLProgram(h,[o],o.dtype,p)}}},10135:(t,e,n)=>{"use strict";n.d(e,{$:()=>a});var r=n(37837);const i=(0,n(55289).vi)({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),a={kernelName:r.Round,backendName:"webgl",kernelFunc:i}},8531:(t,e,n)=>{"use strict";n.d(e,{L:()=>s});var r=n(37837),i=n(55289),a=n(37999);const o=(0,i.vi)({opSnippet:"return inversesqrt(x);",cpuKernelImpl:a.tc}),s={kernelName:r.Rsqrt,backendName:"webgl",kernelFunc:o}},80027:(t,e,n)=>{"use strict";n.d(e,{H:()=>s});var r=n(37837),i=n(46677),a=n(22050),o=n(52813);const s={kernelName:r.ScatterNd,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{indices:c,updates:u}=e,{shape:l}=s,{sliceRank:h,numUpdates:d,sliceSize:f,strides:p,outputSize:g}=r.backend_util.calculateShapes(u,c,l),m=[g/f,f];if(0===g)return n.makeTensorInfo(l,c.dtype);const v=(0,o.t)({inputs:{x:c},backend:n,attrs:{shape:[d,h]}}),y=(0,o.t)({inputs:{x:u},backend:n,attrs:{shape:[d,f]}}),b=n.makeTensorInfo([],"float32",new Float32Array([0]));let x;x=(0,r.env)().getBool("WEBGL_PACK")?new a.h(d,h,v.shape.length,y.shape.length,p,m):new i.$(d,h,v.shape.length,y.shape.length,p,m);const w=n.runWebGLProgram(x,[y,v,b],y.dtype),k=(0,o.t)({inputs:{x:w},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(b),k}}},12050:(t,e,n)=>{"use strict";n.d(e,{M:()=>a});var r=n(37837),i=n(62123);const a={kernelName:r.SearchSorted,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:a,values:o}=e,{side:s}=r,c=new i.i(a.shape[0],a.shape[1],o.shape[1],s),u=[[a.shape[1]]];return n.runWebGLProgram(c,[a,o],"int32",u)}}},34687:(t,e,n)=>{"use strict";n.d(e,{z:()=>a});var r=n(37837),i=n(58977);const a={kernelName:r.Select,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{condition:a,t:o,e:s}=e,c=new i.T(a.shape.length,o.shape,o.shape.length);return n.runWebGLProgram(c,[a,o,s],(0,r.upcastType)(o.dtype,s.dtype))}}},21188:(t,e,n)=>{"use strict";n.d(e,{k:()=>s});var r=n(37837),i=n(55289);const a="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(r.backend_util.SELU_SCALEALPHA,";\n  float scale = ").concat(r.backend_util.SELU_SCALE,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n"),o=(0,i.vi)({opSnippet:a}),s={kernelName:r.Selu,backendName:"webgl",kernelFunc:o}},70431:(t,e,n)=>{"use strict";n.d(e,{X:()=>c});var r=n(37837),i=n(55289),a=n(37999);const o=i.Zt+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",s=(0,i.vi)({opSnippet:o,packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:a.BC}),c={kernelName:r.Sigmoid,backendName:"webgl",kernelFunc:s}},18946:(t,e,n)=>{"use strict";n.d(e,{C:()=>a});var r=n(37837);const i=(0,n(55289).vi)({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),a={kernelName:r.Sign,backendName:"webgl",kernelFunc:i}},34229:(t,e,n)=>{"use strict";n.d(e,{b:()=>u});var r=n(37837),i=n(61880),a=n(55289);const o=a.Zt+"\n  return sin(x);\n",s="\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(i.qq,"\n  return result;\n"),c=(0,a.vi)({opSnippet:o,packedOpSnippet:s}),u={kernelName:r.Sin,backendName:"webgl",kernelFunc:c}},90353:(t,e,n)=>{"use strict";n.d(e,{$:()=>a});var r=n(37837);const i=(0,n(55289).vi)({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),a={kernelName:r.Sinh,backendName:"webgl",kernelFunc:i}},57861:(t,e,n)=>{"use strict";n.d(e,{d:()=>s,l:()=>c});var r=n(37837),i=n(37999),a=n(21321),o=n(22438);function s(t){const{inputs:e,backend:n,attrs:s}=t,{x:c}=e,{begin:u,size:l}=s,[h,d]=r.slice_util.parseSliceParams(c,u,l);if(r.slice_util.assertParamsValid(c,h,d),0===r.util.sizeFromShape(d))return n.makeTensorInfo(d,c.dtype,[]);if(n.shouldExecuteOnCPU([c])||"string"===c.dtype){const t=n.texData.get(c.dataId),e=(0,i.J3)(t.values,h,d,c.shape,c.dtype);return n.makeTensorInfo(d,c.dtype,e)}const{isPacked:f}=n.texData.get(c.dataId),p=r.slice_util.isSliceContinous(c.shape,h,d);if(f||!p){const t=(0,r.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new o.V(d):new a.J(d),e=[h];return n.runWebGLProgram(t,[c],c.dtype,e)}return n.uploadToGPU(c.dataId),function(t,e,n,i){const a=i.texData.get(t.dataId),o=i.makeTensorInfo(n,t.dtype),s=i.texData.get(o.dataId);Object.assign(s,a),s.refCount=1,s.shape=n,s.dtype=t.dtype;let c=r.slice_util.computeFlatOffset(e,r.util.computeStrides(t.shape));a.slice&&(c+=a.slice.flatOffset),s.slice={flatOffset:c,origDataId:a.slice&&a.slice.origDataId||t.dataId};const u=i.dataRefCount.get(s.slice.origDataId)||1;return i.dataRefCount.set(s.slice.origDataId,u+1),o}(c,h,d,n)}const c={kernelName:r.Slice,backendName:"webgl",kernelFunc:s}},20497:(t,e,n)=>{"use strict";n.d(e,{$:()=>h,V:()=>l});var r=n(37837),i=n(53348),a=n(10481),o=n(92284),s=n(52813),c=n(333),u=n(40176);function l(t){const{inputs:e,backend:n,attrs:l}=t,{logits:h}=e,{dim:d}=l,f=r.util.parseAxisParam([d],h.shape),p=(0,a.T)({inputs:{x:h},backend:n,attrs:{reductionIndices:f,keepDims:!1}}),g=r.backend_util.expandShapeToKeepDim(p.shape,f),m=(0,s.t)({inputs:{x:p},backend:n,attrs:{shape:g}}),v=(0,c.j)({inputs:{a:h,b:m},backend:n}),y=(0,i.oN)({inputs:{x:v},backend:n}),b=(0,u.c)({inputs:{x:y},backend:n,attrs:{axis:f,keepDims:!1}}),x=(0,s.t)({inputs:{x:b},backend:n,attrs:{shape:g}}),w=(0,o.M)({inputs:{a:y,b:x},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(x),w}const h={kernelName:r.Softmax,backendName:"webgl",kernelFunc:l}},40295:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(37837);const i=(0,n(55289).vi)({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),a={kernelName:r.Softplus,backendName:"webgl",kernelFunc:i}},16956:(t,e,n)=>{"use strict";n.d(e,{W:()=>s});var r=n(37837),i=n(25850),a=n(52813),o=n(78652);const s={kernelName:r.SpaceToBatchND,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:s}=t,{x:c}=e,{blockShape:u,paddings:l}=s;r.util.assert(c.shape.length<=4,(()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"));const h=u.reduce(((t,e)=>t*e)),d=[[0,0]];d.push(...l);for(let r=1+u.length;r<c.shape.length;++r)d.push([0,0]);const f=[],p=(0,i.w)({inputs:{x:c},backend:n,attrs:{paddings:d,constantValue:0}}),g=r.backend_util.getReshaped(p.shape,u,h,!1),m=r.backend_util.getPermuted(g.length,u.length,!1),v=r.backend_util.getReshapedPermuted(p.shape,u,h,!1),y=(0,a.t)({inputs:{x:p},backend:n,attrs:{shape:g}}),b=(0,o.m)({inputs:{x:y},backend:n,attrs:{perm:m}}),x=(0,a.t)({inputs:{x:b},backend:n,attrs:{shape:v}});return f.push(p),f.push(y),f.push(b),f.forEach((t=>n.disposeIntermediateTensorInfo(t))),x}}},74996:(t,e,n)=>{"use strict";n.d(e,{K:()=>a});var r=n(37837),i=n(37999);const a={kernelName:r.SparseFillEmptyRows,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{indices:r,values:a,denseShape:o,defaultValue:s}=e;if(1!==o.shape.length)throw new Error("Dense shape must be a vector, saw:\n         ".concat(o.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n         ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n         ".concat(a.shape));if(0!==s.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(s.shape));const c=n.readSync(r.dataId),u=n.readSync(a.dataId),l=n.readSync(o.dataId),h=n.readSync(s.dataId)[0],[d,f,p,g,m]=(0,i.sB)(c,r.shape,r.dtype,u,a.dtype,l,h);return[n.makeTensorInfo(f,r.dtype,d),n.makeTensorInfo([f[0]],a.dtype,p),n.makeTensorInfo([g.length],"bool",new Uint8Array(g.map((t=>Number(t))))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}}},3717:(t,e,n)=>{"use strict";n.d(e,{F:()=>a});var r=n(37837),i=n(37999);const a={kernelName:r.SparseReshape,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:a,newShape:o}=e;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape ".concat(a.shape));if(1!==o.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(o.shape));const s=Array.from(n.readSync(a.dataId)),c=n.readSync(r.dataId),u=Array.from(n.readSync(o.dataId)),[l,h,d]=(0,i.vo)(c,r.shape,r.dtype,s,u);return[n.makeTensorInfo(h,r.dtype,l),n.makeTensorInfo([d.length],o.dtype,new Int32Array(d))]}}},20919:(t,e,n)=>{"use strict";n.d(e,{v:()=>a});var r=n(37837),i=n(37999);const a={kernelName:r.SparseSegmentMean,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n              ".concat(a.shape));if(1!==o.shape.length)throw new Error("Segment ids should be a vector but received shape\n              ".concat(o.shape));const s=n.readSync(r.dataId),c=n.readSync(a.dataId),u=n.readSync(o.dataId),[l,h]=(0,i.zN)(s,r.shape,r.dtype,c,u,!0);return n.makeTensorInfo(h,r.dtype,l)}}},74003:(t,e,n)=>{"use strict";n.d(e,{j:()=>a});var r=n(37837),i=n(37999);const a={kernelName:r.SparseSegmentSum,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n             ".concat(a.shape));if(1!==o.shape.length)throw new Error("Segment ids should be a vector but received shape\n             ".concat(o.shape));const s=n.readSync(r.dataId),c=n.readSync(a.dataId),u=n.readSync(o.dataId),[l,h]=(0,i.zN)(s,r.shape,r.dtype,c,u);return n.makeTensorInfo(h,r.dtype,l)}}},52523:(t,e,n)=>{"use strict";n.d(e,{x:()=>s});var r=n(37837),i=n(37999),a=n(46677),o=n(52813);const s={kernelName:r.SparseToDense,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:c,sparseValues:u,defaultValue:l}=e,{outputShape:h}=s,{sliceRank:d,numUpdates:f,sliceSize:p,strides:g,outputSize:m}=r.backend_util.calculateShapes(u,c,h);if("string"===u.dtype){const t=n.bufferSync(c),e=n.bufferSync(u),a=r.util.decodeString(n.readSync(l.dataId)[0]),o=(0,i.fC)(t,e,h,m,p,f,d,g,a,false);return n.makeTensorInfo(h,o.dtype,o.values)}const v=new a.$(f,d,c.shape.length,u.shape.length,g,[m,1],false),y=n.runWebGLProgram(v,[u,c,l],u.dtype),b=(0,o.t)({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(y),b}}},25285:(t,e,n)=>{"use strict";n.d(e,{t:()=>a});var r=n(37837),i=n(57861);const a={kernelName:r.SplitV,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{x:o}=e,{numOrSizeSplits:s,axis:c}=a,u=r.util.parseAxisParam(c,o.shape)[0],l=r.backend_util.prepareSplitSize(o,s,u),h=o.shape.length,d=new Array(h).fill(0),f=o.shape.slice();return l.map((t=>{const e=[...f];e[u]=t;const r=(0,i.d)({inputs:{x:o},backend:n,attrs:{begin:d,size:e}});return d[u]+=t,r}))}}},59273:(t,e,n)=>{"use strict";n.d(e,{F:()=>c});var r=n(37837),i=n(55289),a=n(37999);const o="return sqrt(x);",s=(0,i.vi)({opSnippet:o,packedOpSnippet:o,cpuKernelImpl:a.LF}),c={kernelName:r.Sqrt,backendName:"webgl",kernelFunc:s}},96852:(t,e,n)=>{"use strict";n.d(e,{e:()=>a});var r=n(37837);const i=(0,n(55289).vi)({opSnippet:"return x * x;"}),a={kernelName:r.Square,backendName:"webgl",kernelFunc:i}},6414:(t,e,n)=>{"use strict";n.d(e,{b:()=>o});var r=n(37837);const i="return (a - b) * (a - b);",a=(0,n(55289).j0)({opSnippet:i,packedOpSnippet:i}),o={kernelName:r.SquaredDifference,backendName:"webgl",kernelFunc:a}},38580:(t,e,n)=>{"use strict";n.d(e,{C:()=>a});var r=n(37837),i=n(37999);const a={kernelName:r.StaticRegexReplace,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:a}=t,{x:o}=e;if("string"!==o.dtype)throw new Error("Input must be of datatype string");const s=n.readSync(o.dataId),c=r.backend_util.fromUint8ToStringArray(s),u=(0,i.yZ)(c,"string",a);return n.makeTensorInfo(o.shape,"string",u)}}},97213:(t,e,n)=>{"use strict";n.d(e,{t:()=>a});var r=n(37837),i=n(23199);const a={kernelName:r.Step,backendName:"webgl",kernelFunc:function(t){let{inputs:e,attrs:n,backend:r}=t;const{x:a}=e,o=i.dR+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),s=new i.hE(a.shape,o);return r.runWebGLProgram(s,[a],a.dtype)}}},51320:(t,e,n)=>{"use strict";n.d(e,{c:()=>c});var r=n(37837),i=n(37999),a=n(10193),o=n(52813),s=n(57861);const c={kernelName:r.StridedSlice,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:c}=t,{x:u}=e,{begin:l,end:h,strides:d,beginMask:f,endMask:p,ellipsisMask:g,newAxisMask:m,shrinkAxisMask:v}=c,{finalShapeSparse:y,finalShape:b,isIdentity:x,sliceDim0:w,isSimpleSlice:k,begin:_,end:A,strides:C}=r.slice_util.sliceInfo(u.shape,l,h,d,f,p,g,m,v);let S;if(x)S=(0,o.t)({inputs:{x:u},backend:n,attrs:{shape:b}});else if(w||k){r.util.assert(u.shape.length>=1,(()=>"Input must have rank at least 1, got: ".concat(u.shape.length)));const t=r.slice_util.computeOutShape(_,A,C),e=(0,s.d)({inputs:{x:u},backend:n,attrs:{begin:_,size:t}});S=(0,o.t)({inputs:{x:e},backend:n,attrs:{shape:b}}),n.disposeIntermediateTensorInfo(e)}else{if(n.shouldExecuteOnCPU([u])){const t=n.readSync(u.dataId),e=(0,r.buffer)(u.shape,u.dtype,t),a=(0,i.cy)(y,e,C,_);S=n.makeTensorInfo(b,u.dtype,a.values)}else{const t=new a.U(_,C,y);S=n.runWebGLProgram(t,[u],u.dtype)}}const E=(0,o.t)({inputs:{x:S},backend:n,attrs:{shape:b}});return n.disposeIntermediateTensorInfo(S),E}}},6540:(t,e,n)=>{"use strict";n.d(e,{Q:()=>a});var r=n(37837),i=n(37999);const a={kernelName:r.StringNGrams,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{separator:a,nGramWidths:o,leftPad:s,rightPad:c,padWidth:u,preserveShortSequences:l}=r,{data:h,dataSplits:d}=e,f=n.readSync(h.dataId),p=n.readSync(d.dataId),[g,m]=(0,i.UC)(f,p,a,o,s,c,u,l);return[n.makeTensorInfo([g.length],"string",g),n.makeTensorInfo(d.shape,"int32",m)]}}},6708:(t,e,n)=>{"use strict";n.d(e,{o:()=>a});var r=n(37837),i=n(37999);const a={kernelName:r.StringSplit,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:a}=r,{input:o,delimiter:s}=e;if("string"!==o.dtype)throw new Error("Input must be of datatype string");if(1!==o.shape.length)throw new Error("Input must be a vector, got shape: ".concat(o.shape));if(0!==s.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(s.shape));const c=n.readSync(o.dataId),u=n.readSync(s.dataId)[0],[l,h,d]=(0,i.S6)(c,u,a),f=h.length;return[n.makeTensorInfo([f,2],"int32",l),n.makeTensorInfo([f],"string",h),n.makeTensorInfo([2],"int32",new Int32Array(d))]}}},33723:(t,e,n)=>{"use strict";n.d(e,{J:()=>a});var r=n(37837),i=n(37999);const a={kernelName:r.StringToHashBucketFast,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:a}=r,{input:o}=e;if("string"!==o.dtype)throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const s=n.readSync(o.dataId),c=(0,i.fW)(s,a);return n.makeTensorInfo(o.shape,"int32",c)}}},333:(t,e,n)=>{"use strict";n.d(e,{Z:()=>c,j:()=>s});var r=n(37837),i=n(55289),a=n(37999);const o="return a - b;",s=(0,i.j0)({opSnippet:o,packedOpSnippet:o,supportsComplex:!0,cpuKernelImpl:a.lL}),c={kernelName:r.Sub,backendName:"webgl",kernelFunc:s}},40176:(t,e,n)=>{"use strict";n.d(e,{c:()=>a,q:()=>o});var r=n(37837),i=n(14157);function a(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:o,keepDims:s}=r;return(0,i.m)(a,o,s,n)}const o={kernelName:r.Sum,backendName:"webgl",kernelFunc:a}},14157:(t,e,n)=>{"use strict";n.d(e,{m:()=>s});var r=n(37837),i=n(71912),a=n(52813),o=n(41737);function s(t,e,n,s){const c=e,u=t.shape.length,l=r.util.parseAxisParam(c,t.shape);let h=l;const d=r.backend_util.getAxesPermutation(h,u),f=null!=d;let p=t;f&&(p=(0,o._)(t,d,s),h=r.backend_util.getInnerMostAxes(h.length,u)),r.backend_util.assertAxesAreInnerMostDims("sum",h,u);const[g,m]=r.backend_util.computeOutAndReduceShapes(p.shape,h);let v=g;n&&(v=r.backend_util.expandShapeToKeepDim(g,l));const y=r.util.sizeFromShape(m),b=r.util.sizeFromShape(t.shape)/y,x=(0,a.t)({inputs:{x:p},attrs:{shape:[b,y]},backend:s}),w=(0,r.sumOutType)(t.dtype),k=(0,i.T)(x,w,"sum",s),_=(0,a.t)({inputs:{x:k},attrs:{shape:v},backend:s});return s.disposeIntermediateTensorInfo(x),s.disposeIntermediateTensorInfo(k),f&&s.disposeIntermediateTensorInfo(p),_}},16944:(t,e,n)=>{"use strict";n.d(e,{W:()=>a});var r=n(37837);const i=(0,n(55289).vi)({opSnippet:"return tan(x);"}),a={kernelName:r.Tan,backendName:"webgl",kernelFunc:i}},69162:(t,e,n)=>{"use strict";n.d(e,{i:()=>a});var r=n(37837);const i=(0,n(55289).vi)({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),a={kernelName:r.Tanh,backendName:"webgl",kernelFunc:i}},82899:(t,e,n)=>{"use strict";n.d(e,{B:()=>o});var r=n(37837),i=n(46677),a=n(52813);const o={kernelName:r.TensorScatterUpdate,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:o}=t,{tensor:s,indices:c,updates:u}=e,{}=o,{sliceRank:l,numUpdates:h,sliceSize:d,strides:f,outputSize:p}=r.backend_util.calculateShapes(u,c,s.shape),g=[p/d,d];if(0===p)return n.makeTensorInfo(s.shape,c.dtype);const m=(0,a.t)({inputs:{x:c},backend:n,attrs:{shape:[h,l]}}),v=(0,a.t)({inputs:{x:u},backend:n,attrs:{shape:[h,d]}}),y=(0,a.t)({inputs:{x:s},backend:n,attrs:{shape:g}}),b=new i.$(h,l,m.shape.length,v.shape.length,f,g,!1,!0),x=n.runWebGLProgram(b,[v,m,y],y.dtype),w=(0,a.t)({inputs:{x:x},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),w}}},35579:(t,e,n)=>{"use strict";n.d(e,{V:()=>o,n:()=>s});var r=n(37837),i=n(37999),a=n(56309);function o(t){const{inputs:e,backend:n,attrs:o}=t,{x:s}=e,{reps:c}=o;if("string"===s.dtype||s.shape.length>5){const t=n.readSync(s.dataId),e="string"===s.dtype?t.map((t=>r.util.decodeString(t))):t,a=(0,r.buffer)(s.shape,s.dtype,e),o=(0,i.$O)(a,c);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const u=new a.$(s.shape,c);return n.runWebGLProgram(u,[s],s.dtype)}const s={kernelName:r.Tile,backendName:"webgl",kernelFunc:o}},94951:(t,e,n)=>{"use strict";n.d(e,{p:()=>d});var r=n(37837),i=n(37999),a=n(96062),o=n(97402),s=n(56224),c=n(52813),u=n(57861);function l(t,e){null!==e&&t.disposeIntermediateTensorInfo(e)}function h(t){let e=1;for(;e<t;)e*=2;return e}const d={kernelName:r.TopK,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:d}=t,{x:f}=e,{k:p,sorted:g}=d,m=(0,r.env)().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),v=(0,r.env)().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),y=f.shape,b=y[y.length-1];if(n.shouldExecuteOnCPU([f])||b<m||p>v){const t=n.readSync(f.dataId),[e,r]=(0,i.xt)(t,y,f.dtype,p,g);return[n.makeTensorInfo(e.shape,e.dtype,e.values),n.makeTensorInfo(r.shape,r.dtype,r.values)]}if(0===p)return y[y.length-1]=0,[n.makeTensorInfo(y,f.dtype,[]),n.makeTensorInfo(y,"int32",[])];if(1===b)return[f,(0,o.G)({attrs:{shape:y,dtype:"int32",value:0},backend:n})];const x=n.texData.get(f.dataId),w=null!==x&&x.isPacked,k=w?n.unpackTensor(f):f,_=r.util.sizeFromShape(y)/b,A=(0,c.t)({inputs:{x:k},attrs:{shape:[_,b]},backend:n});w&&l(n,k);const C=h(p),S=h(b);let E=null;const T=()=>null===E?[A,A]:[A,E],N=(t,e,r)=>{const i=T(),o=new a.K(r),s=[[b],[null===E?1:0],[Number.NEGATIVE_INFINITY],[t],[e]],c=E;E=n.runWebGLProgram(o,i,"int32",s),l(n,c)};for(let r=1;r<C;r*=2){const t=2*r;for(let e=r;e>=1;e/=2)N(t,e,[_,S])}for(let r=S;r>C;r/=2){const t=T(),e=new a.T([_,r/2]),i=[[b],[null===E?1:0],[C]],o=E;E=n.runWebGLProgram(e,t,"int32",i),l(n,o);const s=C/2,c=2*s;for(let n=s;n>=1;n/=2)N(c,n,E.shape)}let F=E;E=(0,u.d)({inputs:{x:E},backend:n,attrs:{begin:0,size:[_,p]}}),l(n,F);let D=(0,s.C)({inputs:{x:A,indices:E},backend:n,attrs:{axis:1,batchDims:1}});l(n,A);const I=y.slice(0,-1);I.push(p),F=E,E=(0,c.t)({inputs:{x:E},attrs:{shape:I},backend:n}),l(n,F);const M=D;return D=(0,c.t)({inputs:{x:D},attrs:{shape:I},backend:n}),l(n,M),[D,E]}}},36763:(t,e,n)=>{"use strict";n.d(e,{N:()=>a});var r=n(37837),i=n(94087);const a={kernelName:r.Transform,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{image:a,transforms:o}=e,{interpolation:s,fillMode:c,fillValue:u,outputShape:l}=r,[h,d,f,p]=a.shape,[g,m]=null!=l?l:[d,f],v=[h,g,m,p],y=new i.R(d,f,s,c,u,v);return n.runWebGLProgram(y,[a,o],"float32")}}},78652:(t,e,n)=>{"use strict";n.d(e,{W:()=>s,m:()=>o});var r=n(37837),i=n(41737),a=n(37999);function o(t){const{inputs:e,backend:n,attrs:r}=t,{x:o}=e,{perm:s}=r,c=n,u=o.shape.length,l=new Array(u);for(let i=0;i<l.length;i++)l[i]=o.shape[s[i]];let h;if(c.shouldExecuteOnCPU([o])){const t=c.texData.get(o.dataId).values,e=(0,a.Q5)(t,o.shape,o.dtype,s,l);h=c.makeTensorInfo(l,o.dtype);c.texData.get(h.dataId).values=e}else h=(0,i._)(o,s,c);return h}const s={kernelName:r.Transpose,backendName:"webgl",kernelFunc:o}},41737:(t,e,n)=>{"use strict";n.d(e,{_:()=>o});var r=n(37837),i=n(55580),a=n(65693);function o(t,e,n){const o=(0,r.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new a.Y(t.shape,e):new i.u(t.shape,e);return n.runWebGLProgram(o,[t],t.dtype)}},96380:(t,e,n)=>{"use strict";n.d(e,{a:()=>o});var r=n(37837),i=n(37999),a=n(11414);const o={kernelName:r.Unique,backendName:"webgl",kernelFunc:function(t){const{inputs:e,attrs:n,backend:r}=t,{axis:o}=n,{x:s}=e;(0,a.CE)(s,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const c=r.readSync(s.dataId),{outputValues:u,outputShape:l,indices:h}=(0,i.M_)(c,o,s.shape,s.dtype);return[r.makeTensorInfo(l,s.dtype,u),r.makeTensorInfo([h.length],"int32",h)]}}},25281:(t,e,n)=>{"use strict";n.d(e,{B:()=>o});var r=n(37837),i=n(52813),a=n(57861);const o={kernelName:r.Unpack,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{value:o}=e;let{axis:s}=r;s<0&&(s+=o.shape.length);const c=o,u=c.shape.length,l=o.shape[s],h=new Array(u-1);let d=0;for(let i=0;i<u;i++)i!==s&&(h[d++]=c.shape[i]);const f=[],p=new Array(u).fill(0),g=c.shape.slice();g[s]=1;const m=new Array(l);for(let v=0;v<m.length;v++){p[s]=v;const t=(0,a.d)({inputs:{x:c},backend:n,attrs:{begin:p,size:g}}),e=(0,i.t)({inputs:{x:t},backend:n,attrs:{shape:h}});m[v]=e,f.push(t)}return f.forEach((t=>n.disposeIntermediateTensorInfo(t))),m}}},1201:(t,e,n)=>{"use strict";n.d(e,{b:()=>u});var r=n(37837),i=n(48478),a=n(14526),o=n(52813),s=n(35579),c=n(78652);const u={kernelName:r.UnsortedSegmentSum,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:u}=t,{x:l,segmentIds:h}=e,{numSegments:d}=u,f=l.shape.length,p=[];let g=0;const m=r.backend_util.getAxesPermutation([g],f);let v=l;null!=m&&(v=(0,c.m)({inputs:{x:l},backend:n,attrs:{perm:m}}),p.push(v),g=r.backend_util.getInnerMostAxes(1,f)[0]);const y=r.backend_util.segment_util.computeOutShape(v.shape,g,d),b=r.util.sizeFromShape([v.shape[g]]),x=(0,o.t)({inputs:{x:v},backend:n,attrs:{shape:[-1,b]}});p.push(x);const w=(0,r.sumOutType)(l.dtype),k=(t,e,o,c,u)=>{const l=t.shape[0],h=t.shape[1],d=r.backend_util.segment_util.segOpComputeOptimalWindowSize(h,u),f={windowSize:d,inSize:h,batchSize:l,numSegments:u},g=new i.v(f,e),m=n.compileAndRun(g,[t,o],c);if(p.push(m),m.shape[1]===u)return m;const v=(0,a.y)({backend:n,attrs:{start:0,stop:u,step:1,dtype:"float32"}}),y=(0,s.V)({inputs:{x:v},backend:n,attrs:{reps:[h/d]}});p.push(v),p.push(y);return k(m,e,y,c,u)},_=k(x,"unsortedSegmentSum",h,w,d),A=(0,o.t)({inputs:{x:_},backend:n,attrs:{shape:y}});let C=A;if(null!=m){p.push(A);const t=r.backend_util.getUndoAxesPermutation(m);C=(0,c.m)({inputs:{x:C},backend:n,attrs:{perm:t}})}return p.forEach((t=>n.disposeIntermediateTensorInfo(t))),C}}},66895:(t,e,n)=>{"use strict";n.d(e,{P:()=>c,Z:()=>u});var r=n(37837),i=n(5795),a=n(97402),o=n(81877),s=n(93067);function c(t){const{inputs:e,backend:n}=t,{x:r}=e;if("complex64"===r.dtype){const t=(0,s.x)({inputs:{input:r},backend:n}),e=c({inputs:{x:t},backend:n}),a=(0,o.n)({inputs:{input:r},backend:n}),u=c({inputs:{x:a},backend:n}),l=(0,i.f)({inputs:{real:e,imag:u},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(u),l}return(0,a.G)({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}const u={kernelName:r.ZerosLike,backendName:"webgl",kernelFunc:c}},43695:(t,e,n)=>{"use strict";n.d(e,{l:()=>a});var r=n(37837),i=n(49032);const a={kernelName:r._FusedMatMul,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{a:a,b:o,bias:s,preluActivationWeights:c}=e,{transposeA:u,transposeB:l,activation:h,leakyreluAlpha:d}=r;return(0,i.L)({a:a,b:o,transposeA:u,transposeB:l,backend:n,bias:s,preluActivationWeights:c,leakyreluAlpha:d,activation:h})}}},81867:(t,e,n)=>{"use strict";n.d(e,{F:()=>r});class r{constructor(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[];const a=e,o=t[3]-1;let s;this.outputShape=t;const c="float(".concat(n,") + float(").concat(r,") * sum");s=.5===i?"inversesqrt(".concat(c,")"):1===i?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(a,"; j <= ").concat(a,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(o,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(s,";\n        setOutput(val);\n      }\n    ")}}},27824:(t,e,n)=>{"use strict";n.d(e,{j:()=>r});class r{constructor(t,e,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(e,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(e," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(r,") * norm + float(").concat(n,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(r,")\n                * float(").concat(i,")\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(i,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")}}},67912:(t,e,n)=>{"use strict";n.d(e,{f:()=>r});class r{constructor(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const a=e,o=t[3]-1;let s;this.outputShape=t;const c="float(".concat(n,") + float(").concat(r,") * sum");s=.5===i?"inversesqrt(".concat(c,")"):1===i?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(a,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(a,"; j <= ").concat(a,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(o,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(s,";\n        setOutput(result);\n      }\n    ")}}},91091:(t,e,n)=>{"use strict";n.d(e,{Y:()=>i,d:()=>r});class r{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideHeight,n=t.strideWidth,r=t.dilationHeight,i=t.effectiveFilterHeight,a=t.effectiveFilterWidth,o=i-1-t.padInfo.top,s=a-1-t.padInfo.left,c=i*a-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(i,";\n          wR += ").concat(r,") {\n          float dyR = float(dyRCorner + wR) / ").concat(e,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(a,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(n,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(c," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(a," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class i{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,i=t.dilationDepth,a=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterDepth,c=t.effectiveFilterHeight,u=t.effectiveFilterWidth,l=s-1-t.padInfo.front,h=c-1-t.padInfo.top,d=u-1-t.padInfo.left,f=s*c*u-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(l,", ").concat(h,", ").concat(d,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(s,";\n           wD += ").concat(i,") {\n          float dyD = float(dyDCorner + wD) / ").concat(e,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(c,";\n              wR += ").concat(a,") {\n            float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(u,";\n                wC += ").concat(o,") {\n              float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(f," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(c," * ").concat(u," +\n                  wR * ").concat(u," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}},43324:(t,e,n)=>{"use strict";n.d(e,{C:()=>i});var r=n(37837);class i{constructor(t,e){this.variableNames=["x"];const{windowSize:n,batchSize:i,inSize:a,outSize:o}=t;this.outputShape=[i,o];const s=4*Math.floor(n/4),c=n%4;let u="sumValue += dot(values, ones);";if(null!=e){const t=1/e;u="sumValue += dot(values * ".concat(r.util.isInt(t)?t.toPrecision(2):t,", ones);")}let l="";a%n>0&&(l="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(l,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(u,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===c,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(u,"\n        } else if (").concat(2===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(u,"\n        } else if (").concat(3===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(u,"\n        }\n        setOutput(sumValue);\n      }\n    ")}}},97952:(t,e,n)=>{"use strict";n.d(e,{X:()=>i});var r=n(41109);class i{constructor(t,e,n){this.variableNames=["x"],this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const i=t.length,a=(0,r.bf)(i),o=e.map((t=>t[0])).join(","),s=e.map(((e,n)=>e[0]+t[n])).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i),u="reflect"===n?0:1;this.userCode=1!==i?"\n      ".concat(a," start = ").concat(a,"(").concat(o,");\n      ").concat(a," end = ").concat(a,"(").concat(s,");\n\n      void main() {\n        ").concat(a," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(i,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(u,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(u,";\n          }\n        }\n        ").concat(a," coords = outC - start;\n        setOutput(getX(").concat(c,"));\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(u,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(u,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")}}},80577:(t,e,n)=>{"use strict";n.d(e,{V:()=>a});var r=n(62796),i=n(41109);class a{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const a=t.length,o=(0,i.bf)(a),s=e.map((t=>t[0])).join(","),c=e.map(((e,n)=>e[0]+t[n])).join(","),u=(0,r.Jp)("rc",a),l=(0,r.Jp)("source",a),h="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),d=1===a?"source":"vec2(".concat(l.slice(-2).join(),")"),f="reflect"===n?0:1;let p="";if(1===a){const t="\n        ".concat(o," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(f,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(f,";\n        }\n        source -= start;\n      ");p="\n        ".concat(o," rc = outputLoc;\n        ").concat(t,"\n        result[0] = getChannel(getX(").concat(l.join(),"), ").concat(d,");\n        ").concat(u[a-1]," += 1;\n        if(").concat(h,") {\n          ").concat(t,"\n          result[1] = getChannel(getX(").concat(l.join(),"), ").concat(d,");\n        }\n      ")}else{const t="\n        ".concat(o," source = rc;\n        ").concat(o," lt = ").concat(o,"(lessThan(source, start));\n        ").concat(o," gte = ").concat(o,"(greaterThanEqual(source, end));\n        ").concat(o," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(f,") +\n                gte * ((end - 1) * 2 - source + ").concat(f,");\n        source -= start;\n      ");p="\n        ".concat(o," rc = outputLoc;\n        ").concat(t,"\n        result[0] = getChannel(getX(").concat(l.join(),"), ").concat(d,");\n        ").concat(u[a-1]," += 1;\n        if(").concat(h,") {\n          ").concat(t,"\n          result[1] = getChannel(getX(").concat(l.join(),"), ").concat(d,");\n        }\n        rc = outputLoc;\n        ").concat(u[a-2]," += 1;\n        if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {\n          ").concat(t,"\n          result[2] = getChannel(getX(").concat(l.join(),"), ").concat(d,");\n          ").concat(u[a-1]," += 1;\n          if(").concat(h,") {\n            ").concat(t,"\n            result[3] = getChannel(getX(").concat(l.join(),"), ").concat(d,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(o," start = ").concat(o,"(").concat(s,");\n      const ").concat(o," end = ").concat(o,"(").concat(c,");\n\n      void main() {\n        ").concat(o," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")}}},74506:(t,e,n)=>{"use strict";n.d(e,{P:()=>i});var r=n(29150);class i{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=arguments.length>8&&void 0!==arguments[8]&&arguments[8];this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=(0,r.ik)(this.outputShape.length);const l=i?t[1]:t[2],h=Math.ceil(l/2),d=i?"i * 2, rc.y":"rc.y, i * 2",f=a?"rc.z, i * 2":"i * 2, rc.z",p=i?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],g=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let m="",v="";s&&(m=c?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(s,"\n        }"):u?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(s,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(s,"\n        }"),v="result = activation(result);");const y=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),c&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let b="rc.x",x="rc.x";t[0]<e[0]?b="imod(rc.x, ".concat(t[0],")"):e[0]<t[0]&&(x="imod(rc.x, ".concat(e[0],")")),this.userCode="\n      ".concat(m,"\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ").concat(h,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ").concat(b,";\n        int batchB = ").concat(x,";\n        for (int i = 0; i < ").concat(h,"; i++) {\n          vec4 a = getMatrixA(batchA, ").concat(d,");\n          vec4 b = getMatrixB(batchB, ").concat(f,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(p[0]," * ").concat(g[0],");\n          result += (").concat(p[1]," * ").concat(g[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(y,"\n\n        ").concat(v,"\n\n        setOutput(result);\n      }\n    ")}}},16990:(t,e,n)=>{"use strict";n.d(e,{O:()=>r});class r{constructor(t,e,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(e-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(e-1,"));\n      }\n    ")}}},83994:(t,e,n)=>{"use strict";n.d(e,{M:()=>r});class r{constructor(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(r,"), float(").concat(n,"),\n                      float(index == coords.y)));\n      }\n    ")}}},51740:(t,e,n)=>{"use strict";n.d(e,{m:()=>o});var r=n(29150),i=n(62796),a=n(41109);class o{constructor(t){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=(0,r.ik)(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const t=(0,i.Jp)("rc",this.rank),e=(0,a.bf)(this.rank),n=this.getOutOfBoundsCondition(t),r=this.getSetup(t),o=this.getOutput(t);this.userCode="\n        void main() {\n          ".concat(e," rc = getOutputCoords();\n\n          if(").concat(n,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(r,"\n\n            setOutput(vec4(").concat(o,"));\n          }\n        }\n      ")}}getSourceCoordsArr(t){const e=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let i="".concat(0===n?"r":"rp1",", ").concat(0===r?"c":"cp1");for(let e=2;e<this.rank;e++)i="".concat(t[t.length-1-e],",")+i;e.push(i)}return e}getOutOfBoundsCondition(t){if(1===this.rank)return"rc > ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]);let e="";for(let n=this.rank-2;n<this.rank;n++)e+="".concat(t[n]," >= ").concat(this.enableShapeUniforms?"outShape[".concat(n,"]"):this.outputShape[n]),n<this.rank-1&&(e+="||");return e}getSetup(t){if(1===this.rank)return"";const e=t.slice(-2),n=this.enableShapeUniforms?"outShape[".concat(this.rank," - 1]"):this.outputShape[this.rank-1],r=this.enableShapeUniforms?"outShape[".concat(this.rank," - 2]"):this.outputShape[this.rank-2];return"\n      int r = ".concat(e[0],";\n      int c = ").concat(e[1],";\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ").concat(n,";\n      bool rEdge = rp1 >= ").concat(r,";\n    ")}getOutput(t){const e=this.getSourceCoordsArr(t);if(1===this.rank){const t=this.enableShapeUniforms?"outShape":this.outputShape[0];return"getA(rc), (rc + 1 >= ".concat(t," ? 0. : getA(rc + 1)), 0, 0")}return"getA(".concat(e[0],"),\n            cEdge ? 0. : getA(").concat(e[1],"),\n            rEdge ? 0. : getA(").concat(e[2],"),\n            rEdge || cEdge ? 0. : getA(").concat(e[3],")")}}},62796:(t,e,n)=>{"use strict";function r(t,e){return["x","y","z","w","u","v"].slice(0,e).map((e=>"".concat(t,".").concat(e)))}function i(t,e){return 1===e?[t]:r(t,e)}function a(t,e){if(1===t)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}n.d(e,{Fd:()=>r,Jp:()=>i,kp:()=>a})},36342:(t,e,n)=>{"use strict";n.d(e,{e:()=>i});var r=n(41109);class i{constructor(t,e,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const i=t.length,a=(0,r.bf)(i),o=e.map((t=>t[0])).join(","),s=e.map(((e,n)=>e[0]+t[n])).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i);this.userCode=1!==i?"\n      ".concat(a," start = ").concat(a,"(").concat(o,");\n      ").concat(a," end = ").concat(a,"(").concat(s,");\n\n      void main() {\n        ").concat(a," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(a," coords = outC - start;\n          setOutput(getX(").concat(c,"));\n        }\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")}}},75455:(t,e,n)=>{"use strict";n.d(e,{_:()=>a});var r=n(62796),i=n(41109);class a{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const a=t.length,o=(0,i.bf)(a),s=e.map((t=>t[0])).join(","),c=e.map(((e,n)=>e[0]+t[n])).join(","),u=(0,r.Jp)("rc",a),l=(0,r.Jp)("source",a),h="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),d=1===a?"source":"vec2(".concat(l.slice(-2).join(),")"),f=["".concat(o," rc = outputLoc;"),"".concat(u[a-1]," += 1;\n       if(").concat(h,") {\n      "),1===a?"":"}\n       rc = outputLoc;\n       ".concat(u[a-2]," += 1;\n       if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {"),1===a?"":"  ".concat(u[a-1]," += 1;\n         if(").concat(h,") {")],p=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let g="";for(let r=0,i=1===a?2:4;r<i;r++)g+="\n        ".concat(f[r],"\n        if (").concat(p,") {\n          result[").concat(r,"] = float(value);\n        } else {\n          ").concat(o," source = rc - start;\n          result[").concat(r,"] = getChannel(getX(").concat(l.join(),"), ").concat(d,");\n        }\n      ");g+=1===a?"} ":"}}",this.userCode="\n      const ".concat(o," start = ").concat(o,"(").concat(s,");\n      const ").concat(o," end = ").concat(o,"(").concat(c,");\n\n      void main() {\n        ").concat(o," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(g,"\n        setOutput(result);\n      }\n    ")}}},46051:(t,e,n)=>{"use strict";n.d(e,{U:()=>i,h:()=>r});class r{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const a=t.filterWidth,o=t.strideHeight,s=t.strideWidth,c=t.dilationHeight,u=t.dilationWidth,l=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=t.padInfo.top,f=t.padInfo.left;this.outputShape=t.outShape;const p="avg"===e,g="((batch  * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),m="(xR * ".concat(t.inWidth," + xC) * ").concat(t.inChannels," + d");let v="0.0";if(p||(v="-1.0 / 1e-20"),n){const e=">=";return void(this.userCode="\n        const ivec2 strides = ivec2(".concat(o,", ").concat(s,");\n        const ivec2 pads = ivec2(").concat(d,", ").concat(f,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(l,";\n              wR += ").concat(c,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(h,";\n                wC += ").concat(u,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(e," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(r?i?g:m:"wR * ".concat(h," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let y="".concat(e,"(").concat(e,"(").concat(e,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(y="avgValue / max(count, 1.0)");const b=4*Math.floor(a/4),x=a%4,w="\n      if (".concat(p,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(o,", ").concat(s,");\n      const ivec2 pads = ivec2(").concat(d,", ").concat(f,");\n      const float initializationValue = ").concat(v,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(v,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(l,";\n            wR += ").concat(c,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(b,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(u,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(u,", d),\n              getValue(batch, xR, xC + 2 * ").concat(u,", d),\n              getValue(batch, xR, xC + 3 * ").concat(u,", d)\n            );\n\n            ").concat(w,"\n          }\n\n          int xC = xCCorner + ").concat(b,";\n          if (").concat(1===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(2===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(u,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(3===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(u,", d),\n              getValue(batch, xR, xC + 2 * ").concat(u,", d),\n              initializationValue\n            );\n\n            ").concat(w,"\n          }\n        }\n        setOutput(").concat(y,");\n      }\n    ")}}class i{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const a=t.filterWidth,o=t.strideDepth,s=t.strideHeight,c=t.strideWidth,u=t.dilationDepth,l=t.dilationHeight,h=t.dilationWidth,d=t.effectiveFilterDepth,f=t.effectiveFilterHeight,p=t.effectiveFilterWidth,g=t.padInfo.front,m=t.padInfo.top,v=t.padInfo.left;this.outputShape=t.outShape;const y="avg"===e;let b="0.0";if(y||(b="-1.0 / 1e-20"),n){const e=">=";return void(this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(o,", ").concat(s,", ").concat(c,");\n        const ivec3 pads = ivec3(").concat(g,", ").concat(m,", ").concat(v,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(d,";\n              wD += ").concat(u,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(f,";\n                wR += ").concat(l,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(p,";\n                  wC += ").concat(h,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(e," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(r?i?"(((batch * ".concat(t.inDepth," + xD) * ").concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"((xD * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"wD * ".concat(f," * ").concat(p," +\n                      wR * ").concat(p," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let x="".concat(e,"(").concat(e,"(").concat(e,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(x="avgValue / max(count, 1.0)");const w=4*Math.floor(a/4),k=a%4,_="\n      if (".concat(y,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(o,", ").concat(s,", ").concat(c,");\n      const ivec3 pads = ivec3(").concat(g,", ").concat(m,", ").concat(v,");\n      const float initializationValue = ").concat(b,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(b,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(d,";\n            wD += ").concat(u,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(f,";\n            wR += ").concat(l,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(w,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(h,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(h,", ch)\n              );\n\n              ").concat(_,"\n            }\n\n            int xC = xCCorner + ").concat(w,";\n            if (").concat(1===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(_,"\n            } else if (").concat(2===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(_,"\n            } else if (").concat(3===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(h,", ch),\n                initializationValue\n              );\n\n              ").concat(_,"\n            }\n          }\n        }\n        setOutput(").concat(x,");\n      }\n    ")}}},38903:(t,e,n)=>{"use strict";n.d(e,{t:()=>r});class r{constructor(t,e){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:i,outSize:a}=t;this.outputShape=[r,a];let o="0.0",s="";"prod"===e?o="1.0":"min"===e?(o="1.0 / 1e-20",s="min"):"max"===e&&(o="-1.0 / 1e-20",s="max");let c="".concat(e,"(").concat(e,"(").concat(e,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===e?c="sumValue":"prod"===e?c="prodValue":"all"===e?c="allValue":"any"===e&&(c="anyValue");const u=4*Math.floor(n/4),l=n%4;let h="\n      if (".concat("sum"===e,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===e,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(s,"(values, minMaxValue);\n        if (").concat("min"===e," || ").concat("max"===e,") {\n          minMaxValue = ").concat(s,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),d="vec4";"all"===e?(o="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===e&&(o="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");let f="";i%n>0&&(f="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(o,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(f,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        vec4 minMaxValue = vec4(").concat(o,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(u,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(h,"\n        }\n\n        int inIdx = inOffset + ").concat(u,";\n        if (").concat(1===l,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(h,"\n        } else if (").concat(2===l,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(h,"\n        } else if (").concat(3===l,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(h,"\n        }\n        setOutput(").concat(c,");\n      }\n    ")}}},76692:(t,e,n)=>{"use strict";var r=n(37837),i=n(43695),a=n(39935),o=n(82845),s=n(90137),c=n(59160),u=n(95252),l=n(19064),h=n(74325),d=n(53125),f=n(32463),p=n(85900),g=n(94750),m=n(43449),v=n(30499),y=n(35389),b=n(18553),x=n(18074),w=n(75366),k=n(43785),_=n(76811),A=n(14209),C=n(5896),S=n(60895),E=n(55379),T=n(70329),N=n(44268),F=n(56002),D=n(92963),I=n(5795),M=n(43843),O=n(1415),R=n(31375),z=n(55591),B=n(10917),L=n(56722),P=n(64630),j=n(16042),U=n(95952),W=n(24490),V=n(47364),q=n(18805),G=n(80625),H=n(98932),Y=n(60501),X=n(17201),K=n(61205),Q=n(36011),Z=n(52332),$=n(43483),J=n(83436),tt=n(44115),et=n(16123),nt=n(69215),rt=n(15995),it=n(53348),at=n(13764),ot=n(67494),st=n(33023),ct=n(97402),ut=n(27007),lt=n(8065),ht=n(40082),dt=n(53498),ft=n(47952),pt=n(58312),gt=n(79230),mt=n(56224),vt=n(80769),yt=n(24445),bt=n(57381),xt=n(29222),wt=n(81877),kt=n(93572),_t=n(57336),At=n(20070),Ct=n(36267),St=n(82106),Et=n(61504),Tt=n(33092),Nt=n(87261),Ft=n(89480),Dt=n(94779),It=n(81779),Mt=n(3621),Ot=n(9371),Rt=n(66467),zt=n(10481),Bt=n(35785),Lt=n(58603),Pt=n(37456),jt=n(71300),Ut=n(69139),Wt=n(4273),Vt=n(31850),qt=n(62819),Gt=n(31147),Ht=n(39523),Yt=n(34435),Xt=n(36962),Kt=n(39999),Qt=n(70737),Zt=n(91590),$t=n(11271),Jt=n(87120),te=n(93592),ee=n(11532),ne=n(78785),re=n(73666),ie=n(25850),ae=n(12825),oe=n(35329),se=n(67638),ce=n(17786),ue=n(5412),le=n(2052),he=n(14526),de=n(93067),fe=n(92284),pe=n(56331),ge=n(5209),me=n(95431),ve=n(52813),ye=n(60975),be=n(77319),xe=n(94575),we=n(50887),ke=n(96625),_e=n(34963),Ae=n(10135),Ce=n(8531),Se=n(80027),Ee=n(12050),Te=n(34687),Ne=n(21188),Fe=n(70431),De=n(18946),Ie=n(34229),Me=n(90353),Oe=n(57861),Re=n(20497),ze=n(40295),Be=n(16956),Le=n(74996),Pe=n(3717),je=n(20919),Ue=n(74003),We=n(52523),Ve=n(25285),qe=n(59273),Ge=n(96852),He=n(6414),Ye=n(38580),Xe=n(97213),Ke=n(51320),Qe=n(6540),Ze=n(6708),$e=n(33723),Je=n(333),tn=n(40176),en=n(16944),nn=n(69162),rn=n(82899),an=n(35579),on=n(94951),sn=n(36763),cn=n(78652),un=n(96380),ln=n(25281),hn=n(1201),dn=n(66895);const fn=[i.l,a.l,o.t,s.D,c.U,u.y,l.k,h.l,d.n,f.l,p.S,g.M,m.L,v.r,y.l,b.R,x.O,w.m,k.$,_.X,A.V,C.e,S.l,E.LY,T.N,N.M,F.u,D.F,I.v,M.t,O.V,R.x,z.r,B.f,L.i,P.i,j.Y,U.o,W.k,V.O,q.T,G.$,H.Y,Y.R,X.v,K.n,Q.V,Z.O,$.F,J._,tt.J,et.x,nt.R,rt._,it.AC,at.a,ot.Y,st.N,ct.u,ut.D,lt.H,ht.U,dt.y,ft.q,pt.l,gt.K,mt.a,vt.x,yt.V,bt.F,xt.c,wt.l,kt.K,_t.I,At.I,Ct.zp,St.Y,Et.Q,Tt.o,Nt.F,Ft.W,Dt.V,It.f,Mt.r,Ot.x,Rt.j,zt.l,Bt.l,Lt.$,Pt.A,jt.S,Ut.P,Wt.l,Vt.M,qt.j,Gt.N,Ht.V,Yt.X,Xt.a,Kt.t,Qt.h,Zt.m,$t.F,Jt.u,te.A,ee._,ne.h,re.q,ie.e,ae.j,oe.HK,se.S,ce.i,ue.Y,le.g,he.i,de.r,fe.G,pe.l,ge.z,me.X,ve.V,ye.T,be.j,xe.j,we.n,ke.r,_e.f,Ae.$,Ce.L,Se.H,Ee.M,Te.z,Ne.k,Fe.X,De.C,Ie.b,Me.$,Oe.l,Re.$,ze.Z,Be.W,Le.K,Pe.F,je.v,Ue.j,We.x,Ve.t,qe.F,Ge.e,He.b,Ye.C,Xe.t,Ke.c,Qe.Q,Ze.o,$e.J,Je.Z,tn.q,en.W,nn.i,rn.B,an.n,on.p,sn.N,cn.W,un.a,ln.B,hn.b,dn.Z];for(const pn of fn)(0,r.registerKernel)(pn)},95002:(t,e,n)=>{"use strict";n.d(e,{R:()=>a});var r=n(29150),i=n(31904);class a{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=(0,r.ik)(this.outputShape.length);let n="";for(let r=0;r<4;r++){let t="thisRC = rc;";r%2===1&&(t+="thisRC.z += 1;"),r>1&&(t+="thisRC.y += 1;"),n+="\n        ".concat(t,"\n        ").concat(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(r,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(r>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(t,e){const n=e?i.TN(["r","c","d"],"inputShape"):i.UG(["r","c","d"],t);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,this.enableShapeUniforms),"\n      ").concat(this.enableShapeUniforms?i.Od():i.fM(t),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(this.enableShapeUniforms?"outShape[1]":t[1],";\n        int cols = ").concat(this.enableShapeUniforms?"outShape[2]":t[2],";\n\n        ").concat(n,"\n\n        setOutput(result);\n      }\n    ")}}},78389:(t,e,n)=>{"use strict";n.d(e,{h:()=>r});class r{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,r,i]=e,[,a,o]=t,s=[n&&a>1?r-1:r,n&&o>1?i-1:i],c=[n&&a>1?a-1:a,n&&o>1?o-1:o],u=s[0]/c[0],l=s[1]/c[1],h=1/u,d=1/l,f=2*Math.ceil(h)+2,p=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(u,");\n        const float widthScale = float(").concat(l,");\n\n        const float invHeightScale = float(").concat(h,");\n        const float invWidthScale = float(").concat(d,");\n\n        const int winHeight = int(").concat(f,");\n        const int winWidth = int(").concat(p,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(a,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(o,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(r-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(i-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}},3230:(t,e,n)=>{"use strict";n.d(e,{z:()=>r});class r{constructor(t,e,n,r,i){this.variableNames=["A"],this.outputShape=[];const[a,o,s,c]=t;this.outputShape=[a,e,n,c];const u=[r&&e>1?o-1:o,r&&n>1?s-1:s],l=[r&&e>1?e-1:e,r&&n>1?n-1:n];let h;h=i?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(u[0]/l[0],",\n          ").concat(u[1]/l[1],");\n      const vec2 inputShapeRC = vec2(").concat(o,".0, ").concat(s,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")}}},8279:(t,e,n)=>{"use strict";n.d(e,{x:()=>r});class r{constructor(t,e,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,o,s,c]=t;this.outputShape=[a,e,n,c];const u=[r&&e>1?o-1:o,r&&n>1?s-1:s],l=[r&&e>1?e-1:e,r&&n>1?n-1:n];let h;h=i?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(u[0]/l[0],",\n          ").concat(u[1]/l[1],",\n          ").concat(u[1]/l[1],");\n      const vec3 inputShapeRC = vec3(").concat(o,".0, ").concat(s,".0,\n                                     ").concat(s,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(c-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}}},49426:(t,e,n)=>{"use strict";n.d(e,{x:()=>r});class r{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,r,i]=e,[,a,o]=t,s=[n&&a>1?r-1:r,n&&o>1?i-1:i],c=[n&&a>1?a-1:a,n&&o>1?o-1:o],u=s[0]/c[0],l=s[1]/c[1],h=1/u,d=1/l,f=2*Math.ceil(h)+2,p=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(u,");\n        const float widthScale = float(").concat(l,");\n\n        const float invHeightScale = float(").concat(h,");\n        const float invWidthScale = float(").concat(d,");\n\n        const int winHeight = int(").concat(f,");\n        const int winWidth = int(").concat(p,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(a,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(o,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(s[0],") *\n                (float(dyR) / float(").concat(c[0],"));\n\n            float sourceFracCol =\n                float(").concat(s[1],") *\n                  (float(dyC) / float(").concat(c[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(r,") - 1),\n                ").concat(n," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(i,") - 1),\n                ").concat(n," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}},43415:(t,e,n)=>{"use strict";n.d(e,{$:()=>r});class r{constructor(t,e,n,r,i){this.variableNames=["A"],this.outputShape=[];const[a,o,s,c]=t;this.outputShape=[a,e,n,c];const u=[r&&e>1?o-1:o,r&&n>1?s-1:s],l=[r&&e>1?e-1:e,r&&n>1?n-1:n],h=r?"0.5":"0.0";let d;d=i?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(u[0]/l[0],",\n          ").concat(u[1]/l[1],");\n      const vec2 inputShapeRC = vec2(").concat(o,".0, ").concat(s,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(h,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")}}},53956:(t,e,n)=>{"use strict";n.d(e,{z:()=>r});class r{constructor(t,e,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,o,s,c]=t;this.outputShape=[a,e,n,c];const u=[r&&e>1?o-1:o,r&&n>1?s-1:s],l=[r&&e>1?e-1:e,r&&n>1?n-1:n],h=r?"0.5":"0.0";let d;d=i?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(u[0]/l[0],",\n          ").concat(u[1]/l[1],",\n          ").concat(u[1]/l[1],");\n      const vec3 inputShapeRC = vec3(").concat(o,".0, ").concat(s,".0,\n                                     ").concat(s,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(h,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(c-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")}}},73909:(t,e,n)=>{"use strict";n.d(e,{N:()=>i});var r=n(41109);class i{constructor(t,e){this.variableNames=["x"];const n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));if(this.outputShape=t,1===n)return void(this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(t[0]," - coord - 1));\n        }\n      "));const i=t.map(((n,r)=>(n=>-1!==e.indexOf(n)&&1!==t[n]?"".concat(t[n]," - coords[").concat(n,"] - 1"):"coords[".concat(n,"]"))(r))).join(","),a=(0,r.bf)(n);this.userCode="\n      void main() {\n        ".concat(a," coords = getOutputCoords();\n        setOutput(getX(").concat(i,"));\n      }\n    ")}}},99426:(t,e,n)=>{"use strict";n.d(e,{X:()=>a});var r=n(62796),i=n(41109);class a{constructor(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));this.outputShape=t;const a=(0,r.Jp)("rc",n),o="".concat(a[n-1]," + 1 < ").concat(this.outputShape[n-1]),s="".concat(a[n-2]," + 1 < ").concat(this.outputShape[n-2]),c=(0,i.bf)(n);function u(n){const r=t.map(((r,i)=>function(n,r){return-1!==e.indexOf(n)&&1!==t[n]?"".concat(t[n]," - ").concat(r[n]," - 1"):"".concat(r[n])}(i,n))),i=r.join(","),a=r.slice(-2).join(",");return"getChannel(getX(".concat(i,"), vec2(").concat(a,"))")}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(t[0]," - rc - 1),\n            ").concat(t[0]," - rc - 1);\n          if(").concat(o,"){\n              result.g = getChannel(getX(").concat(t[0]," - (rc  + 1) - 1),\n                ").concat(t[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(c," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(t){return u(t)}(a.slice()),";\n          if(").concat(o,"){\n            result.g = ").concat(function(t){return t[n-1]="("+t[n-1]+" + 1)",u(t)}(a.slice()),";\n          }\n          if(").concat(s,") {\n            result.b = ").concat(function(t){return t[n-2]="("+t[n-2]+" + 1)",u(t)}(a.slice()),";\n            if(").concat(o,") {\n              result.a = ").concat(function(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",u(t)}(a.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")}}},65698:(t,e,n)=>{"use strict";n.d(e,{e:()=>r});class r{constructor(t,e){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const n=t[1],r=t[2];this.outputShape=t;let i="";i="number"===typeof e?"float outputValue = ".concat(e.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(e.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(i,"\n          if(coordX >= 0 && coordX < ").concat(r," && coordY >= 0 && coordY < ").concat(n,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}},46677:(t,e,n)=>{"use strict";n.d(e,{$:()=>i});var r=n(41109);class i{constructor(t,e,n,i,a,o){let s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const c=(0,r.bf)(a.length),u=(0,r.bf)(o.length);let l="";1===n?l="i":2===n&&(l="i, j");const h="getIndices(".concat(l,")");let d="";1===i?d="i":2===i&&(d="i, coords[1]");const f="getUpdates(".concat(d,")");let p="";s&&(p="coords[0], coords[1]");const g="getDefaultValue(".concat(p,")"),m=e>1?"strides[j]":"strides";this.userCode="\n        ".concat(c," strides = ").concat(c,"(").concat(a,");\n\n        void main() {\n          ").concat(u," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(t,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(e,"; j++) {\n              int index = round(").concat(h,");\n              flattenedIndex += index * ").concat(m,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(f,";\n              found = true;\n            }\n          }\n          setOutput(mix(").concat(g,", sum, float(found)));\n        }\n      ")}}},22050:(t,e,n)=>{"use strict";n.d(e,{h:()=>i});var r=n(41109);class i{constructor(t,e,n,i,a,o){let s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const c=(0,r.bf)(a.length),u=(0,r.bf)(o.length);let l="";1===n?l="i":2===n&&(l="i, j");const h="getIndices(".concat(l,")");let d="";1===i?d="i":2===i&&(d="i, coords[1]");const f="getUpdates(".concat(d,")");let p="";s&&(p="coords[0], coords[1]");const g="getDefaultValue(".concat(p,")"),m=e>1?"strides[j]":"strides",v=e>1?"strides[j + 1]":"strides";this.userCode="\n        ".concat(c," strides = ").concat(c,"(").concat(a,");\n\n        void main() {\n          ").concat(u," coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ").concat(t,"; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ").concat(e,"; j+=2) {\n              ivec4 index = round(").concat(h,");\n              flattenedIndex += index.xz * ").concat(m,";\n              if (j + 1 < ").concat(e,") {\n                flattenedIndex += index.yw * ").concat(v,";\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ").concat(f,";\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(").concat(g,", sum, found));\n        }\n      ")}}},62123:(t,e,n)=>{"use strict";n.d(e,{i:()=>i});var r=n(37837);class i{constructor(t,e,n,i){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,n];const a="for (int i = 0; i < ".concat(Math.ceil(Math.log2(e+1)),"; ++i) { if (left >= right) break;"),o=2===(0,r.env)().getNumber("WEBGL_VERSION")?"while (left < right) {":a,s="left"===i?"<":"<=";this.userCode="\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ".concat(o,"\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ").concat(s," value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     ")}}},48478:(t,e,n)=>{"use strict";n.d(e,{v:()=>r});class r{constructor(t,e){this.variableNames=["x","segmentIds"];const n=t.windowSize,r=t.batchSize,i=t.inSize,a=t.numSegments,o=a*Math.ceil(i/n);this.outputShape=[r,o];const s=4*Math.floor(n/4),c=n%4,u="\n        sumValue += dot(values, segFilter);\n    ";let l="";i%n>0&&(l="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      "));let h="";i%n>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(l,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(h,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(a,")) * float(").concat(n,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(a,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(u,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(u,"\n        } else if (").concat(2===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(u,"\n        } else if (").concat(3===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(u,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")}}},58977:(t,e,n)=>{"use strict";n.d(e,{T:()=>i});var r=n(41109);class i{constructor(t,e,n){let i,a;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank ".concat(n," is not yet supported"));if(1===n)a="resRC",i="resRC";else{const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[],o=[];for(let i=0;i<e.length;i++)o.push("".concat(n[i])),i<t&&r.push("".concat(n[i]));i=r.join(),a=o.join()}const o=(0,r.bf)(n);this.userCode="\n      void main() {\n        ".concat(o," resRC = getOutputCoords();\n        float cVal = getC(").concat(i,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(a,"));\n        } else {\n          setOutput(getB(").concat(a,"));\n        }\n      }\n    ")}}},41109:(t,e,n)=>{"use strict";n.d(e,{YE:()=>v,bf:()=>m,yr:()=>s});var r=n(37837),i=n(82071),a=n(31904);const{getBroadcastDims:o}=r.backend_util;function s(t,e,n){const s=[];if(t.forEach((t=>{const e=r.util.sizeFromShape(t.shapeInfo.logicalShape);if(t.shapeInfo.isUniform?s.push("uniform float ".concat(t.name).concat(e>1?"[".concat(e,"]"):"",";")):(s.push("uniform sampler2D ".concat(t.name,";")),s.push("uniform int offset".concat(t.name,";"))),n.enableShapeUniforms){const{uniformShape:e}=v(n.packedInputs,t.shapeInfo.logicalShape,t.shapeInfo.texShape);switch(e.length){case 1:s.push("uniform int ".concat(t.name,"Shape;"));break;case 2:s.push("uniform ivec2 ".concat(t.name,"Shape;"));break;case 3:s.push("uniform ivec3 ".concat(t.name,"Shape;"));break;case 4:s.push("uniform ivec4 ".concat(t.name,"Shape;"))}s.push("uniform ivec2 ".concat(t.name,"TexShape;"))}})),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;")}s.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach((t=>{s.push("uniform ".concat(t.type," ").concat(t.name).concat(t.arrayIndex?"[".concat(t.arrayIndex,"]"):"",";"))}));const p=s.join("\n"),g=t.map((t=>function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0,a="";a+=n?u(t,i):c(t,i);const s=t.shapeInfo.logicalShape,l=e.logicalShape;s.length<=l.length&&(a+=n?function(t,e){const n=t.name,i=n.charAt(0).toUpperCase()+n.slice(1),a="get"+i+"AtOutCoords",s=t.shapeInfo.logicalShape.length,c=e.logicalShape.length,u=o(t.shapeInfo.logicalShape,e.logicalShape),l=m(c),h=c-s;let d;const f=["x","y","z","w","u","v"];d=0===s?"":c<2&&u.length>=1?"coords = 0;":u.map((t=>"coords.".concat(f[t+h]," = 0;"))).join("\n");let p="";p=c<2&&s>0?"coords":t.shapeInfo.logicalShape.map(((t,e)=>"coords.".concat(f[e+h]))).join(", ");let g="return outputValue;";const v=1===r.util.sizeFromShape(t.shapeInfo.logicalShape),y=r.util.sizeFromShape(e.logicalShape),b=1===y;if(1!==s||v||b){if(v&&!b)g=1===c?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){const t=s-2,e=s-1;u.indexOf(t)>-1&&u.indexOf(e)>-1?g="return vec4(outputValue.x);":u.indexOf(t)>-1?g="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(e)>-1&&(g="return vec4(outputValue.xx, outputValue.zz);")}}else g="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(a,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(d,"\n      vec4 outputValue = get").concat(i,"(").concat(p,");\n      ").concat(g,"\n    }\n  ")}(t,e):function(t,e){const n=t.name,i=n.charAt(0).toUpperCase()+n.slice(1),a="get"+i+"AtOutCoords",s=e.texShape,c=t.shapeInfo.texShape,u=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&u===l&&null==t.shapeInfo.flatOffset&&r.util.arraysEqual(c,s))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");const h=m(l),d=o(t.shapeInfo.logicalShape,e.logicalShape),f=l-u;let p;const g=["x","y","z","w","u","v"];p=0===u?"":l<2&&d.length>=1?"coords = 0;":d.map((t=>"coords.".concat(g[t+f]," = 0;"))).join("\n");let v="";v=l<2&&u>0?"coords":t.shapeInfo.logicalShape.map(((t,e)=>"coords.".concat(g[e+f]))).join(", ");return"\n    float ".concat(a,"() {\n      ").concat(h," coords = getOutputCoords();\n      ").concat(p,"\n      return get").concat(i,"(").concat(v,");\n    }\n  ")}(t,e));return a}(t,e,n.packedInputs,n.enableShapeUniforms))).join("\n"),y=e.texShape,b=(0,i.B)(),x=function(t){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(t.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(b);let w,k,_=function(t){const e="".concat(t.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(t.varyingFs," vec2 resultUV;\n    ").concat(t.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(t.defineSpecialNaN,"\n    ").concat(t.defineSpecialInf,"\n    ").concat(t.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(l,"\n    ").concat(h,"\n    ").concat(d,"\n  ");return e}(b);e.isPacked?(w=function(t,e,n){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(1===r[0])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(r[1],".0);\n      }\n    ");if(1===r[1])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(r[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      return 2 * (resTexRC.x * ").concat(r[1]," + resTexRC.y);\n    }\n  ")}(0,e,n);case 2:return function(t,e,n){const i=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(r.util.arraysEqual(t,e))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(i[0],", ").concat(i[1],"));\n      }\n    ");const a=Math.ceil(t[1]/2);if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(i[0],", ").concat(i[1],"));\n\n      int index = resTexRC.x * ").concat(i[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(t,e,n);case 3:return function(t,e,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(t[2]/2),a=i*Math.ceil(t[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(i,");\n      int c = imod(index, ").concat(i,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(t,e,n);default:return function(t,e,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(t[t.length-1]/2),a=i*Math.ceil(t[t.length-2]/2);let o=a,s="",c="b, r, c";for(let u=2;u<t.length-1;u++)o*=t[t.length-u-1],s="\n      int b".concat(u," = index / ").concat(o,";\n      index -= b").concat(u," * ").concat(o,";\n    ")+s,c="b".concat(u,", ")+c;return"\n    ivec".concat(t.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      ").concat(s,"\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(i,");\n      int c = imod(index, ").concat(i,") * 2;\n\n      return ivec").concat(t.length,"(").concat(c,");\n    }\n  ")}(t,e,n)}}(e.logicalShape,y,n.enableShapeUniforms),k=function(t){return"\n    void setOutput(vec4 val) {\n      ".concat(t.output," = val;\n    }\n  ")}(b)):(w=function(t,e,n){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e,n){if(1===e[0])return n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(e[1],".0);\n      }\n    ");if(1===e[1])return n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(e[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      return resTexRC.x * ").concat(e[1]," + resTexRC.y;\n    }\n  ")}(0,e,n);case 2:return function(t,e,n){if(r.util.arraysEqual(t,e))return n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(e[0],", ").concat(e[1],"));\n      }\n    ");if(1===t[1])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(e[0],", ").concat(e[1],"));\n        int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===t[0])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(e[0],", ").concat(e[1],"));\n        int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      int r = index / ").concat(t[1],";\n      int c = index - r * ").concat(t[1],";\n      return ivec2(r, c);\n    }\n  ")}(t,e,n);case 3:return function(t,e,n){if(n){const e=a.WA(["r","c","d"],t);return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(e,"\n    return ivec3(r, c, d);\n  }\n")}const r=a.UG(["r","c","d"],t);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      ").concat(r,"\n      return ivec3(r, c, d);\n    }\n  ")}(t,e,n);case 4:return function(t,e,n){if(n){const e=a.WA(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(e,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}const r=a.UG(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      ").concat(r,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(t,e,n);case 5:return function(t,e){const n=a.UG(["r","c","d","d2","d3"],t);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(e[0],",\n                             ").concat(e[1],"));\n\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(t,e);case 6:return function(t,e){const n=a.UG(["r","c","d","d2","d3","d4"],t);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(t,e);default:throw new Error("".concat(t.length,"-D output sampling is not yet supported"))}}(e.logicalShape,y,n.enableShapeUniforms),k=function(t){return"\n    void setOutput(float val) {\n      ".concat(t.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(b)),n.packedInputs&&(_+=f);return[_,x,k,p,w,g,n.userCode].join("\n")}function c(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return function(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return"float ".concat(r,"() {return ").concat(n,";}");const[i,a]=t.shapeInfo.texShape;if(1===i&&1===a)return"\n      float ".concat(r,"() {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");const o=p(n);if(e)return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], ").concat(o,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");const[s,c]=t.shapeInfo.texShape;return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(s,", ").concat(c,", ").concat(o,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t,e);case 1:return function(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return"\n      float ".concat(r,"(int index) {\n        ").concat(g(t),"\n      }\n    ");const i=t.shapeInfo.texShape,a=i[0],o=i[1];if(1===o&&1===a)return"\n      float ".concat(r,"(int index) {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");const s=p(n);if(1===o)return e?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / ").concat(a,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(1===a)return e?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / ").concat(o,".0, 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(e)return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(a,", ").concat(o,", index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t,e);case 2:return function(t,e){const n=t.shapeInfo.logicalShape,i=t.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=t.shapeInfo.texShape;if(null!=o&&r.util.arraysEqual(n,o)){if(e)return"\n      float ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(i,"TexShape[1], ").concat(i,"TexShape[0]);\n        return sampleTexture(").concat(i,", uv);\n      }\n    ");const t=o[0],n=o[1];return"\n    float ".concat(a,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(n,".0, ").concat(t,".0);\n      return sampleTexture(").concat(i,", uv);\n    }\n  ")}const{newShape:s,keptDims:u}=r.util.squeezeShape(n),l=s;if(l.length<n.length){const n=y(t,l),r=["row","col"];return"\n      ".concat(c(n,e),"\n      float ").concat(a,"(int row, int col) {\n        return ").concat(a,"(").concat(b(r,u),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(g(t),"\n      }\n    ");const h=o[0],d=o[1],f=p(i);if(1===d)return e?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(f,"), vec3(").concat(i,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(i,"TexShape[0]));\n        return sampleTexture(").concat(i,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(f,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(h,".0);\n      return sampleTexture(").concat(i,", uv);\n    }\n  ");if(1===h)return e?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(f,"), vec3(").concat(i,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(i,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(i,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(f,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(d,".0, 0.5);\n      return sampleTexture(").concat(i,", uv);\n    }\n  ");if(e)return"\n      float ".concat(a,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(i,"Shape[1] + col + ").concat(f,";\n        vec2 uv = uvFromFlat(").concat(i,"TexShape[0], ").concat(i,"TexShape[1], index);\n        return sampleTexture(").concat(i,", uv);\n      }\n    ");return"\n  float ".concat(a,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(f,";\n    vec2 uv = uvFromFlat(").concat(h,", ").concat(d,", index);\n    return sampleTexture(").concat(i,", uv);\n  }\n")}(t,e);case 3:return function(t,e){const n=t.shapeInfo.logicalShape,i=t.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=n[1]*n[2],s=n[2],{newShape:u,keptDims:l}=r.util.squeezeShape(n),h=u;if(h.length<n.length){const n=y(t,h),r=["row","col","depth"];return"\n        ".concat(c(n,e),"\n        float ").concat(a,"(int row, int col, int depth) {\n          return ").concat(a,"(").concat(b(r,l),");\n        }\n      ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(o,", ").concat(s,", 1)));\n        ").concat(g(t),"\n      }\n    ");const d=t.shapeInfo.texShape,f=d[0],m=d[1],v=t.shapeInfo.flatOffset;if(m===o&&null==v)return e?"\n      float ".concat(a,"(int row, int col, int depth) {\n        int stride1 = ").concat(i,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(i,"TexShape[1], ").concat(i,"TexShape[0]);\n        return sampleTexture(").concat(i,", uv);\n      }\n    "):"\n        float ".concat(a,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(s,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(m,".0, ").concat(f,".0);\n          return sampleTexture(").concat(i,", uv);\n        }\n      ");if(m===s&&null==v)return e?"\n      float ".concat(a,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(i,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(i,"TexShape[1], ").concat(i,"TexShape[0]);\n        return sampleTexture(").concat(i,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(m,".0, ").concat(f,".0);\n      return sampleTexture(").concat(i,", uv);\n    }\n  ");const x=p(i);if(e)return"\n    float ".concat(a,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(i,"Shape[1] * ").concat(i,"Shape[2];\n      int stride1 = ").concat(i,"Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ").concat(x,";\n      vec2 uv = uvFromFlat(").concat(i,"TexShape[0], ").concat(i,"TexShape[1], index);\n      return sampleTexture(").concat(i,", uv);\n    }\n    ");return"\n      float ".concat(a,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(o," + col * ").concat(s," + depth + ").concat(x,";\n        vec2 uv = uvFromFlat(").concat(f,", ").concat(m,", index);\n        return sampleTexture(").concat(i,", uv);\n      }\n  ")}(t,e);case 4:return function(t,e){const n=t.shapeInfo.logicalShape,i=t.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=n[3],s=n[2]*o,u=n[1]*s,{newShape:l,keptDims:h}=r.util.squeezeShape(n);if(l.length<n.length){const n=y(t,l),r=["row","col","depth","depth2"];return"\n      ".concat(c(n,e),"\n      float ").concat(a,"(int row, int col, int depth, int depth2) {\n        return ").concat(a,"(").concat(b(r,h),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(u,", ").concat(s,", ").concat(o,", 1)));\n        ").concat(g(t),"\n      }\n    ");const d=t.shapeInfo.flatOffset,f=t.shapeInfo.texShape,m=f[0],v=f[1],x="int stride2 = ".concat(i,"Shape[3];"),w="int stride1 = ".concat(i,"Shape[2] * stride2;"),k="int stride0 = ".concat(i,"Shape[1] * stride1;");if(v===u&&null==d)return e?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        ").concat(x,"\n        ").concat(w,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(i,"TexShape[1], ").concat(i,"TexShape[0]);\n        return sampleTexture(").concat(i,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(s,", ").concat(o,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(v,".0, ").concat(m,".0);\n        return sampleTexture(").concat(i,", uv);\n      }\n    ");if(v===o&&null==d)return e?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(i,"Shape[1] * ").concat(i,"Shape[2], ").concat(i,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(i,"TexShape[1], ").concat(i,"TexShape[0]);\n        return sampleTexture(").concat(i,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(v,".0, ").concat(m,".0);\n        return sampleTexture(").concat(i,", uv);\n      }\n    ");const _=p(i);if(e)return"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(x,"\n      ").concat(w,"\n      ").concat(k,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(i,"TexShape[0], ").concat(i,"TexShape[1], index + ").concat(_,");\n      return sampleTexture(").concat(i,", uv);\n    }\n  ");return"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(s," +\n          depth * ").concat(o," + depth2;\n      vec2 uv = uvFromFlat(").concat(m,", ").concat(v,", index + ").concat(_,");\n      return sampleTexture(").concat(i,", uv);\n    }\n  ")}(t,e);case 5:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e[4],o=e[3]*a,s=e[2]*o,u=e[1]*s,{newShape:l,keptDims:h}=r.util.squeezeShape(e);if(l.length<e.length){const e=y(t,l),n=["row","col","depth","depth2","depth3"];return"\n      ".concat(c(e),"\n      float ").concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(i,"(").concat(b(n,h),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(u,", ").concat(s,", ").concat(o,", ").concat(a,")) +\n          depth3;\n        ").concat(g(t),"\n      }\n    ");const d=t.shapeInfo.flatOffset,f=t.shapeInfo.texShape,m=f[0],v=f[1];if(v===u&&null==d)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(s,", ").concat(o,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(v,".0, ").concat(m,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(v===a&&null==d)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(e[1]*e[2]*e[3],",\n               ").concat(e[2]*e[3],", ").concat(e[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(v,".0, ").concat(m,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const x=p(n);return"\n    float ".concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(s," + depth * ").concat(o," +\n          depth2 * ").concat(a," + depth3 + ").concat(x,";\n      vec2 uv = uvFromFlat(").concat(m,", ").concat(v,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t);case 6:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:a,keptDims:o}=r.util.squeezeShape(e);if(a.length<e.length){const e=y(t,a),n=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(c(e),"\n      float ").concat(i,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(i,"(").concat(b(n,o),");\n      }\n    ")}const s=e[5],u=e[4]*s,l=e[3]*u,h=e[2]*l,d=e[1]*h;if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(d,", ").concat(h,", ").concat(l,", ").concat(u,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(s,", 1)));\n        ").concat(g(t),"\n      }\n    ");const f=t.shapeInfo.flatOffset,m=t.shapeInfo.texShape,v=m[0],x=m[1];if(x===d&&null==f)return"\n      float ".concat(i,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(h,", ").concat(l,", ").concat(u,", ").concat(s,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(x,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(x===s&&null==f)return"\n      float ".concat(i,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(e[1]*e[2]*e[3]*e[4],",\n               ").concat(e[2]*e[3]*e[4],",\n               ").concat(e[3]*e[4],",\n               ").concat(e[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(x,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const w=p(n);return"\n    float ".concat(i,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(d," + col * ").concat(h," + depth * ").concat(l," +\n          depth2 * ").concat(u," + depth3 * ").concat(s," + depth4 + ").concat(w,";\n      vec2 uv = uvFromFlat(").concat(v,", ").concat(x,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t);default:throw new Error("".concat(n.length,"-D input sampling")+" is not yet supported")}}function u(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=(0,i.B)();return"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(e,", halfCR);\n    }\n  ")}(t);case 1:return function(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t.shapeInfo.texShape,o=(0,i.B)();if(e)return"\n    vec4 ".concat(r,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(o.texture2D,"(").concat(n,", uv);\n    }\n  ");const s=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return"\n    vec4 ".concat(r,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(s[0],", ").concat(s[1],", index);\n      return ").concat(o.texture2D,"(").concat(n,", uv);\n    }\n  ")}(t,e);case 2:return function(t,e){const n=t.shapeInfo.logicalShape,a=t.name,o="get"+a.charAt(0).toUpperCase()+a.slice(1),s=t.shapeInfo.texShape,c=s[0],u=s[1],l=(0,i.B)();if(null!=s&&r.util.arraysEqual(n,s))return e?"\n      vec4 ".concat(o,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(a,"TexShape[1], ").concat(a,"TexShape[0]);\n\n        return ").concat(l.texture2D,"(").concat(a,", uv);\n      }\n    "):"\n      vec4 ".concat(o,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(u,".0, ").concat(c,".0);\n\n        return ").concat(l.texture2D,"(").concat(a,", uv);\n      }\n    ");if(e)return"\n    vec4 ".concat(o,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(a,"TexShape[0]) / 2.0), ceil(float(").concat(a,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(a,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(l.texture2D,"(").concat(a,", uv);\n    }\n  ");const h=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],d=Math.ceil(n[1]/2);return"\n    vec4 ".concat(o,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(d,", ").concat(h[0],", ").concat(h[1],", row, col);\n      return ").concat(l.texture2D,"(").concat(a,", uv);\n    }\n  ")}(t,e);case 3:return function(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,s=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(1===n[0]){const r=[1,2],i=y(t,n.slice(1)),o=["b","row","col"];return"\n        ".concat(u(i,e),"\n        vec4 ").concat(a,"(int b, int row, int col) {\n          return ").concat(a,"(").concat(b(o,r),");\n        }\n      ")}const c=(0,i.B)();if(e)return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(c.texture2D,"(").concat(r,", uv);\n    }\n  ");const l=s[0],h=s[1],d=Math.ceil(n[2]/2),f=d*Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(l,", ").concat(h,", ").concat(f,", ").concat(d,", b, row, col);\n      return ").concat(c.texture2D,"(").concat(r,", uv);\n    }\n  ")}(t,e);default:return function(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=(0,i.B)();if(e)return"\n    vec4 ".concat(r,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(n,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ");const o=t.shapeInfo.logicalShape,s=o.length,c=t.shapeInfo.texShape,u=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)],l=u[0],h=u[1],d=Math.ceil(o[s-1]/2);let f=d*Math.ceil(o[s-2]/2),p="int b, int row, int col",g="b * ".concat(f," + (row / 2) * ").concat(d," + (col / 2)");for(let i=2;i<s-1;i++)p="int b".concat(i,", ")+p,f*=o[s-i-1],g="b".concat(i," * ").concat(f," + ")+g;return"\n    vec4 ".concat(r,"(").concat(p,") {\n      int index = ").concat(g,";\n      int texR = index / ").concat(h,";\n      int texC = index - texR * ").concat(h,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(h,", ").concat(l,");\n      return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ")}(t,e)}}const l="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",h="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",d="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",f="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function p(t){return"offset".concat(t)}function g(t){const e=t.name,n=r.util.sizeFromShape(t.shapeInfo.logicalShape);return n<2?"return ".concat(e,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(e,"[i];\n      }\n    }\n  ")}function m(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error("GPU for rank ".concat(t," is not yet supported"))}function v(t,e,n){const{newShape:i,keptDims:a}=r.util.squeezeShape(e),o=e.length,s=t&&3===o&&1===e[0],c=s?e.slice(1):i,u=!t&&o>1&&!r.util.arraysEqual(e,n)&&i.length<o||s;return{useSqueezeShape:u,uniformShape:u?c:e,keptDims:a}}function y(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function b(t,e){return e.map((e=>t[e])).join(", ")}},31904:(t,e,n)=>{"use strict";n.d(e,{G2:()=>u,Od:()=>c,TN:()=>o,UG:()=>i,WA:()=>a,fM:()=>s});var r=n(37837);function i(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const i=r.util.computeStrides(e);return i.map(((e,r)=>{const a="int ".concat(t[r]," = ").concat(n," / ").concat(e),o=r===i.length-1?"int ".concat(t[r+1]," = ").concat(n," - ").concat(t[r]," * ").concat(e):"index -= ".concat(t[r]," * ").concat(e);return"".concat(a,"; ").concat(o,";")})).join("")}function a(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const i=r.util.computeStrides(e);return i.map(((e,r)=>{const a="int ".concat(t[r]," = ").concat(n," / outShapeStrides[").concat(r,"]"),o=r===i.length-1?"int ".concat(t[r+1]," = ").concat(n," - ").concat(t[r]," * outShapeStrides[").concat(r,"]"):"index -= ".concat(t[r]," * outShapeStrides[").concat(r,"]");return"".concat(a,"; ").concat(o,";")})).join("")}function o(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=function(t,e){const n=t.length,r=t.map((t=>"".concat(e,"[").concat(t,"]"))),i=new Array(n-1);i[n-2]=r[n-1];for(let a=n-3;a>=0;--a)i[a]="(".concat(i[a+1]," * ").concat(r[a+1],")");return i}(t.map(((t,e)=>e)),e);return r.map(((e,i)=>{const a="int ".concat(t[i]," = ").concat(n," / ").concat(r[i]),o=i===r.length-1?"int ".concat(t[i+1]," = ").concat(n," - ").concat(t[i]," * ").concat(r[i]):"index -= ".concat(t[i]," * ").concat(r[i]);return"".concat(a,"; ").concat(o,";")})).join("")}function s(t){const e=r.util.computeStrides(t).map((t=>t.toString()));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(e[0]," + coords.y * ").concat(e[1]," + coords.z;\n  }\n")}function c(){return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n"}const u="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n"},21321:(t,e,n)=>{"use strict";n.d(e,{J:()=>i});var r=n(41109);class i{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const e=(0,r.bf)(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=function(t){if(1===t)return"sourceLoc";if(t<=6)return a.slice(0,t).map((t=>"sourceLoc."+t)).join(",");throw Error("Slicing for rank ".concat(t," is not yet supported"))}(this.rank);let i;const o=t.map(((t,e)=>"sourceLoc.".concat(a[e]," = start[").concat(e,"] + coords.").concat(a[e],";")));i="\n        ".concat(e," sourceLoc;\n        ").concat(e," coords = getOutputCoords();\n        ").concat(o.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(i,"\n        setOutput(getSource(").concat(n,"));\n      }\n    ")}}const a=["x","y","z","w","u","v"]},22438:(t,e,n)=>{"use strict";n.d(e,{V:()=>a});var r=n(62796),i=n(41109);class a{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const e=(0,i.bf)(this.rank),n=(0,r.Jp)("coords",this.rank),a=(0,r.Jp)("sourceLoc",this.rank),o=1===this.rank?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),s="getChannel(getSource(".concat(a.join(),"), ").concat(o,")"),c="\n      result.x = ".concat(s,";\n      if (++").concat(n[this.rank-1]," < ").concat(t[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(s,";\n        --").concat(a[this.rank-1],";\n      }\n    "),u=1===this.rank?"":"\n      --".concat(n[this.rank-1],";\n      if (++").concat(n[this.rank-2]," < ").concat(t[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(s,";\n        if (++").concat(n[this.rank-1]," < ").concat(t[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(s,";\n        }\n      }\n    "),l=this.rank<=4?"sourceLoc = coords +\n            ".concat(e,"(").concat(t.map(((t,e)=>"start[".concat(e,"]"))).join(),");"):t.map(((t,e)=>"".concat(a[e]," = ").concat(n[e]," + start[").concat(e,"];"))).join("\n");this.userCode="\n      void main() {\n        ".concat(e," coords = getOutputCoords();\n        ").concat(e," sourceLoc;\n        ").concat(l,"\n        vec4 result = vec4(0.);\n        ").concat(c,"\n        ").concat(u,"\n        setOutput(result);\n      }\n    ")}}},10193:(t,e,n)=>{"use strict";n.d(e,{U:()=>i});var r=n(41109);class i{constructor(t,e,n){this.variableNames=["x"],this.outputShape=n;const i=n.length,a=(0,r.bf)(n.length),o=(0,r.bf)(n.length);let s="";if(1===i)s="coords * strides + begin";else{let t=0;s=n.map(((e,r)=>(t++,1===n.length?"coords * strides[".concat(r,"] + begin[").concat(r,"]"):"coords[".concat(t-1,"] * strides[").concat(r,"] + begin[").concat(r,"]")))).join(",")}this.userCode="\n      ".concat(a," begin = ").concat(a,"(").concat(t,");\n      ").concat(a," strides = ").concat(a,"(").concat(e,");\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        setOutput(getX(").concat(s,"));\n      }\n    ")}}},4870:(t,e,n)=>{"use strict";n.d(e,{BB:()=>r,EX:()=>c,EZ:()=>d,GM:()=>u,NO:()=>l,PM:()=>h,Qn:()=>s,j:()=>a,tT:()=>i});var r,i,a,o=n(37837);function s(t,e){return[e,t]}function c(t,e){return t*e}function u(t){const e=o.util.sizeFromShape(t),n=Math.ceil(e/4);return o.util.sizeToSquarishShape(n)}function l(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function h(t,e){const[n,r]=l(t,e);return n*r*4}function d(t,e){const n=t;let r,i,a,s,c,u,l,h,d,f;return 2===(0,o.env)().getNumber("WEBGL_VERSION")?(r=n.R32F,i=n.R16F,a=n.RGBA16F,s=n.RGBA32F,c=n.RED,l=4,h=1,d=n.HALF_FLOAT,f=n.FLOAT,u=n.RGBA8):(r=t.RGBA,i=t.RGBA,a=t.RGBA,s=n.RGBA,c=t.RGBA,l=4,h=4,d=null!=e?e.HALF_FLOAT_OES:null,f=t.FLOAT,u=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:s,textureFormatFloat:c,downloadTextureFormat:u,downloadUnpackNumChannels:l,defaultNumChannels:h,textureTypeHalfFloat:d,textureTypeFloat:f}}!function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"}(r||(r={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(i||(i={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(a||(a={}))},77565:(t,e,n)=>{"use strict";n.d(e,{p:()=>o});var r=n(37837),i=n(40948),a=n(4870);class o{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(t,e,n){const r=c(e,n),i=u(t,r,n);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=s(t,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const t=this.freeTextures[i].pop();return this.usedTextures[i].push(t),t}let l;return r===a.j.PACKED_2X2_FLOAT32?l=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):r===a.j.PACKED_2X2_FLOAT16?l=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):r===a.j.UNPACKED_FLOAT32?l=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):r===a.j.UNPACKED_FLOAT16?l=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):r===a.j.PACKED_4X1_UNSIGNED_BYTE&&(l=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[i].push(l),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),l}releaseTexture(t,e,n,i){if(null==this.freeTextures)return;const a=c(n,i),o=u(e,a,i);o in this.freeTextures||(this.freeTextures[o]=[]);const l=s(e,a,this.gpgpu.gl,this.gpgpu.textureConfig,i),h=(0,r.env)().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==h&&this._numBytesAllocated>h?(this.gpgpu.deleteMatrixTexture(t.texture),this._numBytesAllocated-=l):(this.freeTextures[o].push(t),this.numFreeTextures++,this._numBytesFree+=l),this.numUsedTextures--;const d=this.usedTextures[o],f=d&&d.indexOf(t);if(null==f||f<0)throw new Error("Cannot release a texture that was never provided by this texture manager");d[f]=d[d.length-1],d.pop(),this.log()}log(){if(!this.logEnabled)return;const t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(t,")"));const e=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*e),"%)"))}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const t in this.freeTextures)this.freeTextures[t].forEach((t=>{this.gpgpu.deleteMatrixTexture(t.texture)}));for(const t in this.usedTextures)this.usedTextures[t].forEach((t=>{this.gpgpu.deleteMatrixTexture(t.texture)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function s(t,e,n,r,o){const s=function(t,e){switch(t){case a.j.PACKED_2X2_FLOAT32:return(0,i.Ij)(e);case a.j.PACKED_2X2_FLOAT16:return(0,i.z8)(e);case a.j.UNPACKED_FLOAT32:return(0,i.fj)(e);case a.j.UNPACKED_FLOAT16:return(0,i.J$)(e);case a.j.PACKED_4X1_UNSIGNED_BYTE:return(0,i.wM)(e);default:throw new Error("Unknown physical texture type ".concat(t))}}(e,r);let c;if(o){const[e,n]=(0,a.NO)(t[0],t[1]);c=e*n}else{const[e,n]=(0,a.Qn)(t[0],t[1]);c=e*n}const u=function(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error("Unknown internal format ".concat(e))}(n,s);return c*u}function c(t,e){if(t===a.tT.UPLOAD)return a.j.PACKED_2X2_FLOAT32;if(t===a.tT.RENDER||null==t)return function(t){return(0,r.env)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?a.j.PACKED_2X2_FLOAT32:a.j.UNPACKED_FLOAT32:t?a.j.PACKED_2X2_FLOAT16:a.j.UNPACKED_FLOAT16}(e);if(t===a.tT.DOWNLOAD||t===a.tT.PIXELS)return a.j.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(t))}function u(t,e,n){return"".concat(t[0],"_").concat(t[1],"_").concat(e,"_").concat(n)}},56309:(t,e,n)=>{"use strict";n.d(e,{$:()=>i});var r=n(41109);class i{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let r=0;r<n.length;r++)n[r]=t[r]*e[r];this.outputShape=n,this.rank=n.length;const i=(0,r.bf)(this.rank),a=function(t){const e=t.length;if(e>5)throw Error("Tile for rank ".concat(e," is not yet supported"));if(1===e)return"imod(resRC, ".concat(t[0],")");const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let i=0;i<t.length;i++)r.push("imod(".concat(n[i],", ").concat(t[i],")"));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        setOutput(getA(").concat(a,"));\n      }\n    ")}}},96062:(t,e,n)=>{"use strict";n.d(e,{K:()=>r,T:()=>i});class r{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}}class i{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}}},94087:(t,e,n)=>{"use strict";n.d(e,{R:()=>r});class r{constructor(t,e,n,r,i,a){this.variableNames=["Image","Transforms"],this.outputShape=a;const o="nearest"===n?1:2;let s;switch(r){case"constant":default:s=1;break;case"reflect":s=2;break;case"wrap":s=3;break;case"nearest":s=4}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(s," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(t," && 0 <= coordX && coordX < ").concat(e,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(i,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(i,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(e,"));\n                float mapY = mapCoord(inY, float(").concat(t,"));\n\n                if (").concat(o," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")}}},55580:(t,e,n)=>{"use strict";n.d(e,{u:()=>i});var r=n(41109);class i{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let r=0;r<n.length;r++)n[r]=t[e[r]];this.outputShape=n,this.rank=n.length;const i=(0,r.bf)(this.rank),a=function(t){const e=t.length;if(e>6)throw Error("Transpose for rank ".concat(e," is not yet supported"));const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let i=0;i<t.length;i++)r[t[i]]=n[i];return r.join()}(e);this.userCode="\n    void main() {\n      ".concat(i," resRC = getOutputCoords();\n      setOutput(getA(").concat(a,"));\n    }\n    ")}}},65693:(t,e,n)=>{"use strict";n.d(e,{Y:()=>a});var r=n(62796),i=n(41109);class a{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(t.length);for(let r=0;r<n.length;r++)n[r]=t[e[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));const a=(0,i.bf)(this.rank),o=(0,r.Fd)("rc",this.rank),s=new Array(this.rank);for(let r=0;r<e.length;r++)s[e[r]]=o[r];const c="vec2(".concat(s.slice(-2).join(),")"),u="++".concat(o[this.rank-1]," < ").concat(n[this.rank-1]),l="getChannel(getA(".concat(s.join(),"), ").concat(c,")");this.userCode="\n    void main() {\n      ".concat(a," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(l,";\n      if(").concat(u,") {\n        result[1] = ").concat(l,";\n      }\n      --").concat(o[this.rank-1],";\n      if(++").concat(o[this.rank-2]," < ").concat(n[this.rank-2],") {\n        result[2] = ").concat(l,";\n        if(").concat(u,") {\n          result[3] = ").concat(l,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}}},23199:(t,e,n)=>{"use strict";n.d(e,{Hq:()=>d,Nb:()=>l,UC:()=>h,X0:()=>c,X8:()=>u,_Q:()=>o,dR:()=>a,hE:()=>i,pd:()=>s});var r=n(29150);class i{constructor(t,e){this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=(0,r.ik)(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}const a="if (isnan(x)) return x;",o="return x;",s="return abs(x);";const c="return (x >= 0.0) ? x : (exp(x) - 1.0);",u=a+"\n  return (x < 0.0) ? 0.0 : x;\n",l=a+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",h="return x;",d="return 1.0 / (1.0 + exp(-1.0 * x));"},53884:(t,e,n)=>{"use strict";n.d(e,{Hq:()=>c,Nb:()=>s,X0:()=>a,X8:()=>o,_Q:()=>i,rf:()=>u});var r=n(29150);const i="return x;",a="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",o="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",s="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",c="return 1.0 / (1.0 + exp(-1.0 * x));";class u{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=(0,r.ik)(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(e,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}},4375:(t,e,n)=>{"use strict";n.d(e,{z:()=>o});var r=n(29150),i=n(62796),a=n(41109);class o{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=(0,r.ik)(this.outputShape.length);const e=t.length,n=(0,i.Jp)("rc",e),o=(0,a.bf)(e),s=(0,i.kp)(e,n),c=n.slice(-2),u=e<=1?"rc":"vec2(".concat(c.join(","),")");this.userCode="\n      void main() {\n        ".concat(o," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(s,");\n\n        setOutput(getChannel(packedInput, ").concat(u,"));\n      }\n    ")}}},54114:(t,e,n)=>{"use strict";n.d(e,{r:()=>r});const r="4.17.0"},35931:(t,e,n)=>{"use strict";n.d(e,{bP:()=>i});var r=n(37837);function i(){(0,r.env)().set("WEBGL_FORCE_F16_TEXTURES",!0)}},11414:(t,e,n)=>{"use strict";n.d(e,{$e:()=>b,CE:()=>K,FP:()=>O,HM:()=>l,HW:()=>y,I2:()=>G,N0:()=>I,N6:()=>H,P0:()=>B,Ph:()=>M,Ql:()=>V,R7:()=>m,Rh:()=>A,SO:()=>E,Se:()=>j,Ut:()=>X,VJ:()=>W,Yn:()=>C,Zj:()=>q,bz:()=>v,cr:()=>p,dm:()=>u,fA:()=>R,jL:()=>U,oN:()=>k,ph:()=>w,rC:()=>g,rw:()=>_,s6:()=>N,sA:()=>T,sZ:()=>x,ul:()=>o,yG:()=>d,y_:()=>S,yr:()=>h});var r=n(37837),i=n(44455),a=n(4870);function o(t,e){const n=e();return(0,r.env)().getBool("DEBUG")&&function(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+function(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(e)}}(t,e))}(t),n}const s=5.96e-8,c=65504;function u(t){return!!((0,r.env)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||s<Math.abs(t)&&Math.abs(t)<c)}function l(t,e){return F(t,(()=>t.getExtension(e)),'Extension "'+e+'" not supported on this browser.')}function h(t,e){const n=F(t,(()=>t.createShader(t.VERTEX_SHADER)),"Unable to create vertex WebGLShader.");if(o(t,(()=>t.shaderSource(n,e))),o(t,(()=>t.compileShader(n))),!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function d(t,e){const n=F(t,(()=>t.createShader(t.FRAGMENT_SHADER)),"Unable to create fragment WebGLShader.");if(o(t,(()=>t.shaderSource(n,e))),o(t,(()=>t.compileShader(n))),(0,r.env)().get("ENGINE_COMPILE_ONLY"))return n;if(!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw p(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const f=/ERROR: [0-9]+:([0-9]+):/g;function p(t,e){const n=f.exec(e);if(null==n)return console.log("Couldn't parse line number in error: ".concat(e)),void console.log(t);const i=+n[1],a=t.split("\n"),o=a.length.toString().length+2,s=a.map(((t,e)=>r.util.rightPad((e+1).toString(),o)+t));let c=0;for(let r=0;r<s.length;r++)c=Math.max(s[r].length,c);const u=s.slice(0,i-1),l=s.slice(i-1,i),h=s.slice(i);console.log(u.join("\n")),console.log(e.split("\n")[0]),console.log("%c ".concat(r.util.rightPad(l[0],c)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}function g(t){return F(t,(()=>t.createProgram()),"Unable to create WebGLProgram.")}function m(t,e){if(o(t,(()=>t.linkProgram(e))),!(0,r.env)().get("ENGINE_COMPILE_ONLY")&&!1===t.getProgramParameter(e,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function v(t,e){if(o(t,(()=>t.validateProgram(e))),!1===t.getProgramParameter(e,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function y(t,e){const n=F(t,(()=>t.createBuffer()),"Unable to create WebGLBuffer");return o(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,n))),o(t,(()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW))),n}function b(t,e){const n=F(t,(()=>t.createBuffer()),"Unable to create WebGLBuffer");return o(t,(()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n))),o(t,(()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW))),n}function x(t){return F(t,(()=>t.createTexture()),"Unable to create WebGLTexture.")}function w(t,e){const n=(0,r.env)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const n="[".concat(t,"x").concat(e,"]");throw new Error("Requested texture size "+n+" is invalid.")}if(t>n||e>n){const r="[".concat(t,"x").concat(e,"]"),i="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+i+".")}}function k(t){return F(t,(()=>t.createFramebuffer()),"Unable to create WebGLFramebuffer.")}function _(t,e,n,r,i,a,s){const c=t.getAttribLocation(e,n);return-1!==c&&(o(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,r))),o(t,(()=>t.vertexAttribPointer(c,i,t.FLOAT,!1,a,s))),o(t,(()=>t.enableVertexAttribArray(c))),!0)}function A(t,e,n){return F(t,(()=>t.getUniformLocation(e,n)),'uniform "'+n+'" not present in program.')}function C(t,e,n){return t.getUniformLocation(e,n)}function S(t,e,n,r){o(t,(()=>function(t,e,n){D(t,n),o(t,(()=>t.activeTexture(t.TEXTURE0+n))),o(t,(()=>t.bindTexture(t.TEXTURE_2D,e)))}(t,e,r))),o(t,(()=>t.uniform1i(n,r)))}function E(t,e,n){o(t,(()=>t.bindFramebuffer(t.FRAMEBUFFER,n))),o(t,(()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)))}function T(t,e){o(t,(()=>t.bindFramebuffer(t.FRAMEBUFFER,e))),o(t,(()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)))}function N(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(e)}}(t,e))}function F(t,e,n){const r=o(t,(()=>e()));if(null==r)throw new Error(n);return r}function D(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const t="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(t,"."))}}function I(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return r.util.sizeFromShape(t.slice(0,t.length-e))}function M(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function O(t){let e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[I(t),...M(t)]),e}function R(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(0,r.env)().getNumber("WEBGL_MAX_TEXTURE_SIZE"),i=(0,r.env)().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(i===1/0&&(0,r.env)().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(i=n/2),e&&(n*=2,i*=2,1===(t=t.map(((e,n)=>n>=t.length-2?r.util.nearestLargerEven(t[n]):t[n]))).length&&(t=[2,t[0]])),2!==t.length){const e=r.util.squeezeShape(t);t=e.newShape}let a=r.util.sizeFromShape(t),o=null;t.length<=1&&a<=n?o=[1,a]:2===t.length&&t[0]<=n&&t[1]<=n?o=t:3===t.length&&t[0]*t[1]<=n&&t[2]<=n?o=[t[0]*t[1],t[2]]:3===t.length&&t[0]<=n&&t[1]*t[2]<=n?o=[t[0],t[1]*t[2]]:4===t.length&&t[0]*t[1]*t[2]<=n&&t[3]<=n?o=[t[0]*t[1]*t[2],t[3]]:4===t.length&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(o=[t[0],t[1]*t[2]*t[3]]);const s=null!=o&&Math.max(...o)>i&&Math.min(...o)<=(e?2:1)&&Math.min(...o)>0;if(null==o||s)if(e){const e=I(t);let n=2,i=2;t.length&&([n,i]=M(t)),a=e*(n/2)*(i/2),o=r.util.sizeToSquarishShape(a).map((t=>2*t))}else o=r.util.sizeToSquarishShape(a);return o}function z(t){return t%2===0}function B(t,e){if(t=t.slice(-2),e=e.slice(-2),r.util.arraysEqual(t,e))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){const n=t[t.length-1],r=e[e.length-1];if(n===r)return!0;if(z(n)&&z(r)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&z(t[0])&&z(e[0])}let L,P;function j(t){if(null==L){const e=(0,i.bU)(t);L=e.getParameter(e.MAX_TEXTURE_SIZE)}return L}function U(t){if(null==P){const e=(0,i.bU)(t);P=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,P)}function W(t){if(0===t)return 0;let e;const n=(0,i.bU)(t);return e=V(n,"EXT_disjoint_timer_query_webgl2")&&2===t?2:V(n,"EXT_disjoint_timer_query")?1:0,e}function V(t,e){return null!=t.getExtension(e)}function q(t){try{if(null!=(0,i.bU)(t))return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function G(t){if(0===t)return!1;const e=(0,i.bU)(t);if(1===t){if(!V(e,"OES_texture_float"))return!1}else if(!V(e,"EXT_color_buffer_float"))return!1;return Y(e)}function H(t){if(0===t)return!1;const e=(0,i.bU)(t);if(1!==t){if(V(e,"EXT_color_buffer_float"))return Y(e);const t="EXT_color_buffer_half_float";if(V(e,t)){const n=e.getExtension(t);return function(t,e){const n=(0,a.EZ)(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const i=1,o=1;t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,i,o,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const s=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,s),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const c=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(s),c}(e,n)}return!1}if(!V(e,"OES_texture_float"))return!1;if(!V(e,"WEBGL_color_buffer_float"))return!1;return Y(e)}function Y(t){const e=(0,a.EZ)(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),i}function X(t){if(2!==t)return!1;return null!=(0,i.bU)(t).fenceSync}function K(t,e){Array.isArray(t)||(t=[t]),t.forEach((t=>{null!=t&&r.util.assert("complex64"!==t.dtype,(()=>"".concat(e," does not support complex64 tensors ")+"in the WebGL backend."))}))}},10283:(t,e,n)=>{"use strict";var r,i;!function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"}(r||(r={})),function(t){let e;!function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"}(e=t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))}(i||(i={}))},52724:(t,e,n)=>{"use strict";n(37837),n(20277),n(7978),n(31252)},73624:(t,e,n)=>{"use strict";n(37837),n(69634),n(52724),n(92834)},91275:(t,e,n)=>{"use strict";n(37837)},31252:(t,e,n)=>{"use strict";n(20277);Error;new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"])},59127:(t,e,n)=>{"use strict";n(37837),n(94827)},7032:(t,e,n)=>{"use strict";n(37837),n(94827)},94827:(t,e,n)=>{"use strict";n(37837)},52113:(t,e,n)=>{"use strict";(0,n(37837).env)().registerFlag("KEEP_INTERMEDIATE_TENSORS",(()=>!1),(t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")}))},90342:(t,e,n)=>{"use strict";n.d(e,{uW:()=>r.r});n(52113),n(73624),n(47640);var r=n(17234)},99276:(t,e,n)=>{"use strict";n(20277),n(69634)},47640:(t,e,n)=>{"use strict"},82284:(t,e,n)=>{"use strict";n(20277)},35699:(t,e,n)=>{"use strict";n(20277)},79893:(t,e,n)=>{"use strict";n(37837),n(59127),n(7032),n(20277)},79072:(t,e,n)=>{"use strict";n(20277)},86955:(t,e,n)=>{"use strict";n(20277)},55205:(t,e,n)=>{"use strict";n(20277)},19242:(t,e,n)=>{"use strict";n(20277)},27058:(t,e,n)=>{"use strict";n(20277)},98133:(t,e,n)=>{"use strict";n(91275),n(20277)},33697:(t,e,n)=>{"use strict";n(20277)},37435:(t,e,n)=>{"use strict";n(20277)},74204:(t,e,n)=>{"use strict";n(20277)},28849:(t,e,n)=>{"use strict";n(20277)},32910:(t,e,n)=>{"use strict";n(20277)},93209:(t,e,n)=>{"use strict";n(20277)},98125:(t,e,n)=>{"use strict";n(37837),n(20277)},35760:(t,e,n)=>{"use strict";n(20277)},79604:(t,e,n)=>{"use strict";n(20277)},83263:(t,e,n)=>{"use strict";n(20277)},83127:(t,e,n)=>{"use strict";n(20277)},20277:(t,e,n)=>{"use strict";n(37837)},36284:(t,e,n)=>{"use strict"},41637:(t,e,n)=>{"use strict"},76659:(t,e,n)=>{"use strict"},48840:(t,e,n)=>{"use strict"},24541:(t,e,n)=>{"use strict"},34383:(t,e,n)=>{"use strict"},98690:(t,e,n)=>{"use strict"},54130:(t,e,n)=>{"use strict"},20479:(t,e,n)=>{"use strict"},96575:(t,e,n)=>{"use strict"},8157:(t,e,n)=>{"use strict"},92672:(t,e,n)=>{"use strict"},84307:(t,e,n)=>{"use strict"},11427:(t,e,n)=>{"use strict"},93715:(t,e,n)=>{"use strict"},47932:(t,e,n)=>{"use strict"},16912:(t,e,n)=>{"use strict"},27665:(t,e,n)=>{"use strict"},79889:(t,e,n)=>{"use strict"},7978:(t,e,n)=>{"use strict";n(37837),n(99276),n(47640),n(82284),n(35699),n(79893),n(79072),n(86955),n(55205),n(19242),n(27058),n(98133),n(33697),n(37435),n(74204),n(28849),n(32910),n(93209),n(98125),n(35760),n(79604),n(83263),n(83127)},69634:(t,e,n)=>{"use strict";n(37837),n(10283),n(47640),n(20277),n(36284),n(41637),n(76659),n(48840),n(24541),n(34383),n(98690),n(54130),n(20479),n(96575),n(8157),n(92672),n(84307),n(11427),n(93715),n(47932),n(16912),n(27665),n(79889)},17234:(t,e,n)=>{"use strict";n.d(e,{r:()=>r});const r="4.17.0"},68099:(t,e,n)=>{"use strict";n.d(e,{GJ:()=>r,uI:()=>i});class r{constructor(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,e){this.dataIdsCount++,this.data.set(t,e)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class i{refCount(t){return a("refCount")}incRef(t){return a("incRef")}timerAvailable(){return!0}time(t){return a("time")}read(t){return a("read")}readSync(t){return a("readSync")}readToGPU(t,e){return a("readToGPU")}numDataIds(){return a("numDataIds")}disposeData(t,e){return a("disposeData")}write(t,e,n){return a("write")}move(t,e,n,r,i){return a("move")}createTensorFromGPUData(t,e,n){return a("createTensorFromGPUData")}memory(){return a("memory")}floatPrecision(){return a("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return a("dispose")}}function a(t){throw new Error("'".concat(t,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}},74164:(t,e,n)=>{"use strict";n.d(e,{ljI:()=>K.ljI,Vvy:()=>K.Vvy,PH8:()=>K.PH8,K$F:()=>It.K,ah4:()=>Mt.a,FYc:()=>Ot.F,oC7:()=>Rt.o,OMN:()=>K.OMN,EkD:()=>K.EkD,u8Z:()=>K.u8Z,FSt:()=>K.FSt,Jp_:()=>K.Jp_,p_m:()=>K.p_m,QKF:()=>K.QKF,epO:()=>K.epO,TyE:()=>K.TyE,lxb:()=>K.lxb,zP9:()=>K.zP9,ho8:()=>K.ho8,cS:()=>K.cS,wwC:()=>K.wwC,VCH:()=>K.VCH,jAQ:()=>K.jAQ,Ik2:()=>K.Ik2,N4F:()=>K.N4F,HNs:()=>K.HNs,vj7:()=>K.vj7,LB5:()=>K.LB5,KXH:()=>K.KXH,QDP:()=>K.QDP,vaV:()=>K.vaV,pr3:()=>K.pr3,$zE:()=>K.$zE,$dB:()=>K.$dB,p2J:()=>K.p2J,rFm:()=>K.rFm,jfg:()=>K.jfg,A1h:()=>K.A1h,iGz:()=>K.iGz,gC7:()=>K.gC7,Mn0:()=>K.Mn0,MnK:()=>K.MnK,MRQ:()=>K.MRQ,jj_:()=>K.jj_,nY8:()=>K.nY8,GJx:()=>hs.GJ,wNW:()=>K.wNW,TMz:()=>K.TMz,tGH:()=>K.tGH,X$8:()=>K.X$8,nVu:()=>K.nVu,ORI:()=>K.ORI,jxD:()=>K.jxD,pk0:()=>K.pk0,bP9:()=>K.bP9,XmO:()=>K.XmO,Kmu:()=>f.Km,Qgm:()=>K.Qgm,Pah:()=>K.Pah,rsH:()=>K.rsH,OH$:()=>f.OH,BRl:()=>K.BRl,_s9:()=>K._s9,ox3:()=>K.ox3,ybN:()=>K.ybN,ybj:()=>K.ybj,rGP:()=>K.rGP,SQl:()=>K.SQl,BxF:()=>K.BxF,ZgB:()=>K.ZgB,ElG:()=>K.ElG,awo:()=>K.awo,i5R:()=>K.i5R,aAr:()=>K.aAr,T7M:()=>K.T7M,O4G:()=>K.O4G,mxL:()=>K.mxL,XhZ:()=>K.XhZ,lLS:()=>K.lLS,OAQ:()=>K.OAQ,lzr:()=>K.lzr,dv8:()=>K.dv8,gIW:()=>K.gIW,E3$:()=>K.E3$,iPs:()=>K.iPs,uI_:()=>hs.uI,jM4:()=>K.jM4,ToN:()=>K.ToN,X0$:()=>K.X0$,mIA:()=>K.mIA,CwD:()=>K.CwD,mnI:()=>K.mnI,tG8:()=>K.tG8,Cg$:()=>K.Cg$,zfU:()=>K.zfU,RUm:()=>K.RUm,nZd:()=>K.nZd,LXA:()=>K.LXA,RW8:()=>K.RW8,yPW:()=>K.yPW,WRv:()=>K.WRv,VAI:()=>K.VAI,t3d:()=>K.t3d,ySp:()=>K.ySp,cHb:()=>K.cHb,RXX:()=>K.RXX,TL8:()=>K.TL8,LDN:()=>K.LDN,g5A:()=>K.g5A,lNG:()=>K.lNG,LG0:()=>K.LG0,x7F:()=>K.x7F,BLA:()=>K.BLA,Qu_:()=>zt.Q,WT3:()=>K.WT3,xu7:()=>K.xu7,l0G:()=>K.l0G,SDM:()=>K.SDM,Zl4:()=>K.Zl4,e0f:()=>K.e0f,ylV:()=>K.ylV,BTT:()=>q.B,urI:()=>K.urI,LWX:()=>K.LWX,ELo:()=>Bt.E,L5p:()=>jt,mM$:()=>K.mM$,ODT:()=>K.ODT,bCz:()=>K.bCz,pyJ:()=>K.pyJ,Ncv:()=>K.Ncv,kdj:()=>K.kdj,PS5:()=>Lt.P,oJ2:()=>K.oJ2,CQC:()=>K.CQC,mH5:()=>K.mH5,Q6t:()=>K.Q6t,rgM:()=>Ut.rg,LRy:()=>K.LRy,sDr:()=>K.sDr,huO:()=>K.huO,iDl:()=>Fa,fUj:()=>K.fUj,P_L:()=>K.P_L,R23:()=>K.R23,hgw:()=>K.hgw,FCQ:()=>K.FCQ,jOE:()=>K.jOE,XQy:()=>K.XQy,D7i:()=>K.D7i,BK4:()=>K.BK4,hVg:()=>K.hVg,TOR:()=>K.TOR,SYI:()=>Pt.S,pJc:()=>K.pJc,uWl:()=>K.uWl,l6P:()=>K.l6P,u$b:()=>K.u$b,vI1:()=>K.vI1,YVe:()=>K.YVe,hql:()=>K.hql,J3C:()=>K.J3C,JiE:()=>K.JiE,rFG:()=>K.rFG,Fin:()=>K.Fin,A8B:()=>K.A8B,C8s:()=>K.C8s,BoJ:()=>K.BoJ,L6G:()=>K.L6G,DvZ:()=>K.DvZ,jgd:()=>K.jgd,Blb:()=>K.Blb,dFH:()=>K.dFH,M6A:()=>K.M6A,Ddj:()=>K.Ddj,GZp:()=>K.GZp,pnw:()=>K.pnw,UcO:()=>K.UcO,YAb:()=>K.YAb,iW0:()=>K.iW0,$jE:()=>K.$jE,PbM:()=>K.PbM,WuN:()=>K.WuN,oFs:()=>K.oFs,iuW:()=>K.iuW,qYS:()=>Z.qY,ylz:()=>Z.yl,X4r:()=>K.X4r,FAs:()=>K.FAs,TBb:()=>K.TBb,dLy:()=>K.dLy,wx0:()=>K.wx0,EwU:()=>K.EwU,dXR:()=>K.dXR,pPe:()=>K.pPe,RMm:()=>K.RMm,rTt:()=>Z.rT,xJ3:()=>K.xJ3,Dr:()=>K.Dr,tnl:()=>Wt.t,HQu:()=>Vt.H,FqL:()=>qt.F,WQq:()=>Gt.W,QiD:()=>Ht,Q7R:()=>Yt.Q,bzn:()=>Xt.b,FLi:()=>Kt.F,XRg:()=>Qt.X,qRo:()=>Zt.q,yHs:()=>$t.y,rYl:()=>Jt.r,FPz:()=>te.F,rfv:()=>ee.r,$jT:()=>ne.$,sub:()=>ae,Hs:()=>Ea.Hs,C0T:()=>h,lZX:()=>he,$v7:()=>fe.$,BFc:()=>pe,kSi:()=>ge,T5N:()=>me,GTe:()=>de.G,HbZ:()=>ve,vjT:()=>ye,ftb:()=>Ti,ROE:()=>be,hOW:()=>xe.h,ZEY:()=>Y,TaL:()=>a,ra8:()=>we.r,wgE:()=>U.w,mkO:()=>ke.m,zQh:()=>_e.z,o8B:()=>Ae.o,faB:()=>Ce.f,xWs:()=>oe.x,I1m:()=>Se,RPU:()=>Ee,O5O:()=>Te,P1l:()=>Ne,kA9:()=>Fe.k,Xtf:()=>De.X,wX9:()=>Ie.w,IPL:()=>Me,jIJ:()=>Re,Cfv:()=>Q.Cf,gnS:()=>ze.g,yIG:()=>Be.y,_jP:()=>zi,Lp0:()=>Le.L,rCv:()=>Pe.r,_Xg:()=>Li._X,aOp:()=>je,fLc:()=>Ea.fL,Rj8:()=>Ue.R,Gl3:()=>We.G,eMq:()=>ls,smy:()=>Ve,X7t:()=>qe.X,ISJ:()=>Ea.IS,ASo:()=>Ea.AS,rm6:()=>Ea.rm,y4m:()=>Ge.y,ek5:()=>He.e,Omf:()=>Ye.O,EZY:()=>Oi,_3C:()=>Xe,Pqc:()=>Ke.P,gYU:()=>Ea.gY,SmG:()=>Ea.Sm,FJY:()=>Ri,Hi9:()=>Ea.Hi,QP2:()=>Qe,_K2:()=>f._K,LCg:()=>Ze.L,Y12:()=>$e.Y,p4S:()=>Je.p,oNF:()=>tn.o,UG6:()=>en.U,IYd:()=>nn.I,y5U:()=>an,hVP:()=>Qr.h,GSj:()=>on.G,goy:()=>Ea.go,W4C:()=>Ea.W4,RIf:()=>sn.R,wh_:()=>cn.w,cZk:()=>u,kgh:()=>un.k,SY9:()=>Mi,FJy:()=>o,jz4:()=>Ea.jz,vQR:()=>Q.vQ,_5H:()=>Q._5,OpK:()=>Q.Op,Dvk:()=>Li.Dv,ok9:()=>Li.ok,rhj:()=>ln.r,DQN:()=>hn.D,KGM:()=>Zr.K,ngS:()=>dn.n,Slp:()=>Qa,U4u:()=>Bi,io:()=>r,ggX:()=>$r.g,MIs:()=>fn.M,EN4:()=>pn.E,yrW:()=>gn.y,aCs:()=>Ea.aC,kpo:()=>d,H8d:()=>mn.H,M7h:()=>vn.M,InN:()=>yn.I,mPL:()=>Za,mT8:()=>bn,Kgs:()=>xn.K,Rm2:()=>wn.R,Kko:()=>kn.K,nqI:()=>_n.n,HPB:()=>An.H,VZ:()=>Cn.V,n76:()=>Sn.n,NSZ:()=>En.N,ztW:()=>Tn.z,rxB:()=>Nn.r,YYh:()=>$a,yzS:()=>In,NoW:()=>W.N,DyF:()=>i,T9B:()=>Mn.T,jgi:()=>On.j,NYV:()=>Rn,RO:()=>zn,PhQ:()=>Bn.P,i2o:()=>Ln.i,m1Z:()=>Ea.m1,OYQ:()=>jn,jkA:()=>Un.j,BpO:()=>Wn.B,FFZ:()=>Vn.F,ziu:()=>qn.z,Clk:()=>Xn,CRk:()=>Fi,lKK:()=>se.l,YDF:()=>Kn,OjQ:()=>Qn,HZy:()=>Zn.H,dA1:()=>ro,xbf:()=>Ni.x,Ec:()=>$n.E,Mw0:()=>V.M,SaS:()=>Pn.S,P61:()=>Jn.P,op:()=>q.op,X4o:()=>tr,eVF:()=>er.e,BZs:()=>nr,grY:()=>rr,XHu:()=>ir,WLX:()=>ar,dzn:()=>or.d,n7C:()=>sr.n,NsG:()=>cr.N,yyV:()=>ur.y,_eU:()=>lr._,MEE:()=>Ea.ME,whe:()=>hr,iyU:()=>dr,Q0_:()=>fr,_9M:()=>pr,pR9:()=>br,FE$:()=>xr,m0H:()=>wr,YeY:()=>kr,HYA:()=>_r,y17:()=>Ar,Gc4:()=>Ea.Gc,xav:()=>Cr.x,VOZ:()=>Sr.V,gJX:()=>Ea.gJ,krJ:()=>Q.kr,tAK:()=>Q.tA,VVh:()=>Er.V,j__:()=>Tr.j,rEj:()=>Ea.rE,tQQ:()=>ie.t,BEg:()=>Nr.B,QD2:()=>Fr,LMr:()=>Dr,I2l:()=>Ir,JYU:()=>Mr,z8$:()=>Jr.z,LIG:()=>Or.L,Z$r:()=>Rr.Z,d_2:()=>zr.d,NFr:()=>Di,g23:()=>s,sZg:()=>Dn,WfX:()=>Br.W,wdz:()=>Lr.w,JFn:()=>pt,jh6:()=>Ea.jh,OkC:()=>Ea.Ok,F12:()=>Pr,ry7:()=>ce.r,_SZ:()=>jr._,vPA:()=>Ka,F8e:()=>Ur.F,L0l:()=>Wr.L,dik:()=>ue.d,Q$M:()=>Vr,zAd:()=>qr,wck:()=>Gr,R0O:()=>Hr,Kro:()=>ft,Vs9:()=>Yr.V,lw0:()=>Xr.l,eDJ:()=>Kr.e,lMo:()=>Ja,Zhr:()=>Ii,lOn:()=>Xa,lDo:()=>ti.l,RZD:()=>ei.R,EwI:()=>Hn.E,Pbu:()=>ni.P,r2V:()=>ri.r,t$z:()=>ii.t,PMw:()=>ai.P,Ym9:()=>oi.Y,YjP:()=>to,jbE:()=>Yn.j,czq:()=>si.c,chL:()=>Ut.ch,Mlm:()=>ci.M,ymU:()=>le.y,OEK:()=>ui.O,tGX:()=>li,KtR:()=>hi,$_$:()=>J,g9W:()=>di,Lpo:()=>fi,yxw:()=>pi,NNh:()=>gi,d_S:()=>gt,Obs:()=>c,DZQ:()=>Ea.DZ,Vsq:()=>rn.V,kBw:()=>Ea.kB,rfw:()=>mi.r,BaG:()=>eo,mgz:()=>G.m,efE:()=>vi,AmM:()=>yi.A,rYx:()=>Q.rY,iPt:()=>Q.iP,zAU:()=>bi.z,K$i:()=>xi.K,TuY:()=>Ut.Tu,rni:()=>wi,ZSL:()=>mt,jYt:()=>Li.jY,muS:()=>Li.mu,bvq:()=>ki,y7e:()=>Li.y7,bgA:()=>Dt,_M9:()=>_i._,YJN:()=>Ci,Ul9:()=>Si.U,POl:()=>Ei.P});var r={};n.r(r),n.d(r,{CompositeArrayBuffer:()=>m.D,browserFiles:()=>x,browserHTTPRequest:()=>D,concatenateArrayBuffers:()=>p.AQ,copyModel:()=>P.xk,decodeWeights:()=>p.CY,decodeWeightsStream:()=>p.s5,encodeWeights:()=>p.aG,fromMemory:()=>R,fromMemorySync:()=>z,getLoadHandlers:()=>g.C9,getModelArtifactsForJSON:()=>p.Ej,getModelArtifactsForJSONSync:()=>p.Rl,getModelArtifactsInfoForJSON:()=>p.oR,getSaveHandlers:()=>g.x3,getWeightSpecs:()=>p.Xf,http:()=>F,isHTTPScheme:()=>T,listModels:()=>P.D,loadWeights:()=>C,moveModel:()=>P.Vo,registerLoadRouter:()=>g.R4,registerSaveRouter:()=>g.Yd,removeModel:()=>P.az,weightsLoaderFactory:()=>S,withSaveHandler:()=>B,withSaveHandlerSync:()=>L});var i={};n.r(i),n.d(i,{confusionMatrix:()=>H});var a={};n.r(a),n.d(a,{draw:()=>st,fromPixels:()=>ct,fromPixelsAsync:()=>it,toPixels:()=>ot});var o={};n.r(o),n.d(o,{prepareAndValidate:()=>ut});var s={};n.r(s),n.d(s,{calculateShapes:()=>dt,validateInput:()=>ht,validateUpdateShape:()=>lt});var c={};n.r(c),n.d(c,{TEST_EPSILON_FLOAT16:()=>yt,createVideoElement:()=>Nt,encodeStrings:()=>Tt,expectArrayBuffersEqual:()=>Et,expectArraysClose:()=>bt,expectArraysEqual:()=>_t,expectNumbersClose:()=>At,expectPromiseToFail:()=>kt,expectValuesInRange:()=>St,play:()=>Ft,testEpsilon:()=>xt});var u={};n.r(u),n.d(u,{conv2d:()=>Gi,depthwiseConv2d:()=>Xi,matMul:()=>Ki});var l={};n.r(l),n.d(l,{collectGatherOpShapeInfo:()=>ss,computeOutShape:()=>os,segOpComputeOptimalWindowSize:()=>as});var h={};n.r(h),n.d(h,{ERF_A1:()=>ko,ERF_A2:()=>_o,ERF_A3:()=>Ao,ERF_A4:()=>Co,ERF_A5:()=>So,ERF_P:()=>wo,PARALLELIZE_THRESHOLD:()=>ho,RowPartitionType:()=>oo,SELU_SCALE:()=>xo.X,SELU_SCALEALPHA:()=>xo.j,applyActivation:()=>Vi,assertAndGetBroadcastShape:()=>Y.assertAndGetBroadcastShape,assertAxesAreInnerMostDims:()=>Gn.WC,assertParamsConsistent:()=>io,assignToTypedArray:()=>Mo,axesAreInnerMostDims:()=>Gn.WH,calculateShapes:()=>dt,checkEinsumDimSizes:()=>Wo,checkPadOnDimRoundingMode:()=>re.s_,combineLocations:()=>Gn.aF,combineRaggedTensorToTensorShapes:()=>so,complexWithEvenIndex:()=>Fo,complexWithOddIndex:()=>Do,computeConv2DInfo:()=>re.uf,computeConv3DInfo:()=>re.p$,computeDefaultPad:()=>re.G8,computeDilation2DInfo:()=>re.YQ,computeOptimalWindowSize:()=>fo,computeOutAndReduceShapes:()=>Gn.lb,computeOutShape:()=>ao,computePool2DInfo:()=>re.E6,computePool3DInfo:()=>re.l5,convertConv2DDataFormat:()=>re.$Q,decodeEinsumEquation:()=>jo,eitherStridesOrDilationsAreOne:()=>re.G0,expandShapeToKeepDim:()=>Gn.SM,exponent:()=>Ro,exponents:()=>Oo,fromStringArrayToUint8:()=>us,fromUint8ToStringArray:()=>cs,getAxesPermutation:()=>Gn.Em,getBroadcastDims:()=>Y.getBroadcastDims,getComplexWithIndex:()=>Io,getEinsumComputePath:()=>Vo,getEinsumPermutation:()=>Uo,getFusedBiasGradient:()=>Wi,getFusedDyActivation:()=>Ui,getImageCenter:()=>po,getInnerMostAxes:()=>Gn.fK,getPermuted:()=>mo,getRaggedRank:()=>uo,getReductionAxes:()=>Y.getReductionAxes,getReshaped:()=>go,getReshapedPermuted:()=>vo,getRowPartitionTypesHelper:()=>co,getSliceBeginCoords:()=>yo,getSliceSize:()=>bo,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>Yo,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>Xo,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>Ko,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>$o,getSparseReshapeInputOutputMismatchErrorMessage:()=>ts,getSparseReshapeInputOutputMultipleErrorMessage:()=>Jo,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>Qo,getSparseReshapeNegativeOutputDimErrorMessage:()=>Zo,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>is,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>es,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>ns,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>rs,getUndoAxesPermutation:()=>Gn.gx,isIdentityPermutation:()=>qo,log:()=>Eo.R,mergeRealAndImagArrays:()=>To,prepareAndValidate:()=>ut,prepareSplitSize:()=>Ho,segment_util:()=>l,shouldFuse:()=>qi,slice_util:()=>ft,splitRealAndImagArrays:()=>No,stridesOrDilationsArePositive:()=>re.qk,tupleValuesAreOne:()=>re.Dh,upcastType:()=>Ut.Tu,validateDefaultValueShape:()=>lo,validateInput:()=>ht,validateUpdateShape:()=>lt,warn:()=>Eo.i});var d={};n.r(d),n.d(d,{nonMaxSuppressionV3Impl:()=>ua,nonMaxSuppressionV4Impl:()=>la,nonMaxSuppressionV5Impl:()=>ha,whereImpl:()=>Ai});n(59624),n(53259),n(41130);var f=n(89e3),p=n(92834),g=n(93131),m=n(76544);function v(t){return new Promise((t=>setTimeout(t))).then(t)}class y{constructor(t){if(!(0,f._K)().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(y.URL_SCHEME)&&(t=t.slice(y.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelJsonFileName=t+".json",this.weightDataFileName=t+".weights.bin"}async save(t){if("undefined"===typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const e=m.D.join(t.weightData),n=window.URL.createObjectURL(new Blob([e],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const e=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],r=(0,p.zV)(t,e),i=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),a=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=i,await v((()=>a.dispatchEvent(new MouseEvent("click")))),null!=t.weightData){const t=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;t.download=this.weightDataFileName,t.href=n,await v((()=>t.dispatchEvent(new MouseEvent("click"))))}return{modelArtifactsInfo:(0,p.oR)(t)}}}}y.URL_SCHEME="downloads://";class b{constructor(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(t));this.jsonFile=t[0],this.weightsFiles=t.slice(1)}async load(){return new Promise(((t,e)=>{const n=new FileReader;n.onload=n=>{const r=JSON.parse(n.target.result),i=r.modelTopology;if(null==i)return void e(new Error("modelTopology field is missing from file ".concat(this.jsonFile.name)));if(null==r.weightsManifest)return void e(new Error("weightManifest field is missing from file ".concat(this.jsonFile.name)));if(0===this.weightsFiles.length)return void t({modelTopology:i});const a=(0,p.Ej)(r,(t=>this.loadWeights(t)));t(a)},n.onerror=t=>e("Failed to read model topology and weights manifest JSON "+"from file '".concat(this.jsonFile.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only."),n.readAsText(this.jsonFile)}))}loadWeights(t){const e=[],n=[];for(const a of t)e.push(...a.weights),n.push(...a.paths);const r=this.checkManifestAndWeightFiles(t),i=n.map((t=>this.loadWeightsFile(t,r[t])));return Promise.all(i).then((t=>[e,t]))}loadWeightsFile(t,e){return new Promise(((n,r)=>{const i=new FileReader;i.onload=t=>{const e=t.target.result;n(e)},i.onerror=e=>r("Failed to weights data from file of path '".concat(t,"'.")),i.readAsArrayBuffer(e)}))}checkManifestAndWeightFiles(t){const e=[],n=this.weightsFiles.map((t=>(0,p.P8)(t.name))),r={};for(const i of t)i.paths.forEach((t=>{const i=(0,p.P8)(t);if(-1!==e.indexOf(i))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(i,"'"));if(e.push(i),-1===n.indexOf(i))throw new Error("Weight file with basename '".concat(i,"' is not provided."));r[t]=this.weightsFiles[n.indexOf(i)]}));if(e.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(e.length,") and the number of weight files provided ")+"(".concat(this.weightsFiles.length,")."));return r}}function x(t){return new b(t)}g.bM.registerSaveRouter((t=>(0,f._K)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(y.URL_SCHEME)?function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new y(t)}(t.slice(y.URL_SCHEME.length)):null));var w=n(23869);function k(t,e,n,r){!function(t){(0,w.vA)(null!=t&&Array.isArray(t)&&t.length>0,(()=>"promises must be a none empty array"))}(t),function(t,e){(0,w.vA)(t>=0&&t<=1,(()=>"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(t))),(0,w.vA)(e>=0&&e<=1,(()=>"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(e))),(0,w.vA)(e>=t,(()=>"startFraction must be no more than endFraction, but "+"got startFraction ".concat(t," and endFraction ")+"".concat(e)))}(n=null==n?0:n,r=null==r?1:r);let i=0;return Promise.all(t.map((a=>(a.then((a=>{const o=n+ ++i/t.length*(r-n);return e(o),a})),a))))}var _=n(64511);async function A(t,e){null==e&&(e={});const n=null==e.fetchFunc?(0,f._K)().platform.fetch:e.fetchFunc,r=t.map((t=>n(t,e.requestInit,{isBinary:!0}))),i=(null==e.onProgress?await Promise.all(r):await k(r,e.onProgress,0,.5)).map((t=>t.arrayBuffer()));return null==e.onProgress?await Promise.all(i):await k(i,e.onProgress,.5,1)}async function C(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return S((t=>A(t,{requestInit:r})))(t,e,n)}function S(t){return async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;const i=e.map((()=>!1)),a={},o=null!=r?r.map((()=>!1)):[],s=[];if(e.forEach(((t,e)=>{let n=0;t.weights.forEach((t=>{const c="quantization"in t?t.quantization.dtype:t.dtype,u=_.i[c]*w.Ze(t.shape),l=()=>{i[e]=!0,null==a[e]&&(a[e]=[]),a[e].push({manifestEntry:t,groupOffset:n,sizeBytes:u})};null!=r?r.forEach(((e,n)=>{e===t.name&&(l(),o[n]=!0)})):l(),s.push(t.name),n+=u}))})),!o.every((t=>t))){const t=r.filter(((t,e)=>!o[e]));throw new Error("Could not find weights in manifest with names: "+"".concat(t.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(s.join(", "),"."))}const c=i.reduce(((t,e,n)=>(e&&t.push(n),t)),[]),u=[];c.forEach((t=>{e[t].paths.forEach((t=>{const e=n+(n.endsWith("/")?"":"/")+t;u.push(e)}))}));const l=await t(u),h={};let d=0;return c.forEach((t=>{const n=e[t].paths.length,r=new m.D(l.slice(d,d+n));a[t].forEach((t=>{const e=r.slice(t.groupOffset,t.groupOffset+t.sizeBytes),n=(0,p.CY)(e,[t.manifestEntry]);for(const r in n)h[r]=n[r]})),d+=n})),h}}class E{constructor(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.weightUrlConverter=e.weightUrlConverter,null!=e.fetchFunc?((0,w.vA)("function"===typeof e.fetchFunc,(()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)")),this.fetch=e.fetchFunc):this.fetch=(0,f._K)().platform.fetch,(0,w.vA)(null!=t&&t.length>0,(()=>"URL path for http must not be null, undefined or empty.")),Array.isArray(t)&&(0,w.vA)(2===t.length,(()=>"URL paths for http must have a length of 2, "+"(actual length is ".concat(t.length,")."))),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{},this.loadOptions=e}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);e.body=new FormData;const n=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],r=(0,p.zV)(t,n);if(e.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=t.weightData){const n=m.D.join(t.weightData);e.body.append("model.weights.bin",new Blob([n],{type:"application/octet-stream"}),"model.weights.bin")}const i=await this.fetch(this.path,e);if(i.ok)return{modelArtifactsInfo:(0,p.oR)(t),responses:[i]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(i.status,"."))}async loadModelJSON(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(t.status,". Please verify this URL points to ")+"the model JSON of the model to load.");let e;try{e=await t.json()}catch(i){let t="Failed to parse model JSON of response from ".concat(this.path,".");throw this.path.endsWith(".pb")?t+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":t+=" Please make sure the server is serving valid JSON for this request.",new Error(t)}const n=e.modelTopology,r=e.weightsManifest;if(null==n&&null==r)throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");return e}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const t=await this.loadModelJSON();return(0,p.Ej)(t,(t=>this.loadWeights(t)))}async loadStream(){const t=await this.loadModelJSON(),e=await this.getWeightUrls(t.weightsManifest),n=(0,p.Xf)(t.weightsManifest);return Object.assign(Object.assign({},t),{weightSpecs:n,getWeightStream:()=>function(t,e){var n;const r=null==e.fetchFunc?(0,f._K)().platform.fetch:e.fetchFunc;let i,a=0;return null===(n=e.onProgress)||void 0===n||n.call(e,0),new ReadableStream({pull:async n=>{for(var o;a<t.length;){if(!i){const n=(await r(t[a],e.requestInit,{isBinary:!0})).body;i=n.getReader()}const{done:s,value:c}=await i.read();if(!s)return void n.enqueue(c);a++,i=void 0,null===(o=e.onProgress)||void 0===o||o.call(e,a/t.length)}n.close()}})}(e,this.loadOptions)})}async getWeightUrls(t){const e=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=function(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),i=n>e?t.substring(n):"";return[r+"/",i]}(e),i=this.weightPathPrefix||n,a=[],o=[];for(const s of t)for(const t of s.paths)null!=this.weightUrlConverter?o.push(this.weightUrlConverter(t)):a.push(i+t+r);return this.weightUrlConverter&&a.push(...await Promise.all(o)),a}async loadWeights(t){const e=await this.getWeightUrls(t);return[(0,p.Xf)(t),await A(e,this.loadOptions)]}}function T(t){return null!=t.match(E.URL_SCHEME_REGEX)}E.URL_SCHEME_REGEX=/^https?:\/\//;const N=(t,e)=>{if("undefined"===typeof fetch&&(null==e||null==e.fetchFunc))return null;{let n=!0;if(n=Array.isArray(t)?t.every((t=>T(t))):T(t),n)return F(t,e)}return null};function F(t,e){return new E(t,e)}function D(t,e){return F(t,e)}g.bM.registerSaveRouter(N),g.bM.registerLoadRouter(N);class I{constructor(t){this.modelArtifacts=t}load(){return this.modelArtifacts}}class M{constructor(t){this.saveHandler=t}save(t){return this.saveHandler(t)}}class O{constructor(t){t.load&&(this.load=()=>Promise.resolve(t.load())),t.save&&(this.save=e=>Promise.resolve(t.save(e)))}}function R(t,e,n,r){return new O(z(...arguments))}function z(t,e,n,r){if(1===arguments.length){return null!=t.modelTopology||null!=t.weightSpecs?new I(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new I({modelTopology:t}))}return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new I({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r})}function B(t){return new M(t)}function L(t){return new M(t)}var P=n(69897),j=n(52863),U=n(69779),W=n(65849),V=n(48926),q=n(26039),G=n(15977);const H=(0,q.op)({confusionMatrix_:function(t,e,n){const r=(0,j.YT)(t,"labels","confusionMatrix"),i=(0,j.YT)(e,"predictions","confusionMatrix");w.vA(null==n||n>0&&Number.isInteger(n),(()=>"If provided, numClasses must be a positive integer, "+"but got ".concat(n))),w.vA(1===r.rank,(()=>"Expected the rank of labels to be 1, but got ".concat(r.rank))),w.vA(1===i.rank,(()=>"Expected the rank of predictions to be 1, "+"but got ".concat(i.rank))),w.vA(r.shape[0]===i.shape[0],(()=>"Mismatch in the number of examples: "+"".concat(r.shape[0]," vs. ").concat(i.shape[0],". ")+"Labels and predictions should have the same number of elements.")),w.vA(n>0&&Number.isInteger(n),(()=>"numClasses is required to be a positive integer, but got "+"".concat(n)));const a=(0,V.M)((0,U.w)(r,"int32"),n),o=(0,V.M)((0,U.w)(i,"int32"),n),s=(0,G.m)(a),c=(0,W.N)(s,o);return(0,U.w)(c,"int32")}});var Y=n(84824),X=n(37484),K=n(87311),Q=n(46780),Z=n(90739),$=n(47921);function J(t,e,n){if((0,w.HO)(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");const r=(0,j.MZ)(t,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return(0,$.Q)(t,e,r,n)}let tt,et=!1;function nt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,i=!1,a=!1,o=!1,s=!1;if(t.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&t instanceof ImageData)r=!0;else if("undefined"!==typeof HTMLVideoElement&&t instanceof HTMLVideoElement)i=!0;else if("undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement)a=!0;else if(null!=t.getContext)o=!0;else{if(!("undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(t.constructor.name));s=!0}if(null!=(0,Q._5)(K.awo,X.T2.backendName)){const n={pixels:t},r={numChannels:e};return X.T2.runKernel(K.awo,n,r)}const[c,u]=i?[t.videoWidth,t.videoHeight]:[t.width,t.height];let l,h;if(o)l=t.getContext("2d").getImageData(0,0,c,u).data;else if(r||n)l=t.data;else if(a||i||s){if(null==tt)if("undefined"===typeof document){if("undefined"===typeof OffscreenCanvas||"undefined"===typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");tt=new OffscreenCanvas(1,1).getContext("2d")}else tt=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});tt.canvas.width=c,tt.canvas.height=u,tt.drawImage(t,0,0,c,u),l=tt.getImageData(0,0,c,u).data}if(4===e)h=new Int32Array(l);else{const t=c*u;h=new Int32Array(t*e);for(let n=0;n<t;n++)for(let t=0;t<e;++t)h[n*e+t]=l[4*n+t]}return J(h,[u,c,e],"int32")}function rt(t){return"undefined"!==typeof window&&"undefined"!==typeof ImageBitmap&&window.hasOwnProperty("createImageBitmap")&&!(t instanceof ImageBitmap)&&function(t){return null!=t&&0!==t.width&&0!==t.height}(t)&&!function(t){return null!=t&&t.data instanceof Uint8Array}(t)}async function it(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=null;if((0,f._K)().getBool("WRAP_TO_IMAGEBITMAP")&&rt(t)){let e;try{e=await createImageBitmap(t,{premultiplyAlpha:"none"})}catch(r){e=null}n=null!=e&&e.width===t.width&&e.height===t.height?e:t}else n=t;return nt(n,e)}function at(t){if(2!==t.rank&&3!==t.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(t.rank,"."));const e=2===t.rank?1:t.shape[2];if(e>4||2===e)throw new Error("toPixels only supports depth of size "+"1, 3 or 4 but got ".concat(e));if("float32"!==t.dtype&&"int32"!==t.dtype)throw new Error("Unsupported type for toPixels: ".concat(t.dtype,".")+" Please use float32 or int32 tensors.")}async function ot(t,e){let n=(0,j.YT)(t,"img","toPixels");if(!(t instanceof Z.qY)){const t=n;n=(0,U.w)(t,"int32"),t.dispose()}at(n);const[r,i]=n.shape.slice(0,2),a=2===n.rank?1:n.shape[2],o=await n.data(),s="float32"===n.dtype?255:1,c=new Uint8ClampedArray(i*r*4);for(let u=0;u<r*i;++u){const t=[0,0,0,255];for(let r=0;r<a;r++){const e=o[u*a+r];if("float32"===n.dtype){if(e<0||e>1)throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(e,"."))}else if("int32"===n.dtype&&(e<0||e>255))throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(e,"."));1===a?(t[0]=e*s,t[1]=e*s,t[2]=e*s):t[r]=e*s}const e=4*u;c[e+0]=Math.round(t[0]),c[e+1]=Math.round(t[1]),c[e+2]=Math.round(t[2]),c[e+3]=Math.round(t[3])}if(null!=e){if(!et){null!=(0,Q._5)(K.XmO,X.T2.backendName)&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),et=!0)}e.width=i,e.height=r;const t=e.getContext("2d"),n=new ImageData(c,i,r);t.putImageData(n,0,0)}return n!==t&&n.dispose(),c}function st(t,e,n){let r=(0,j.YT)(t,"img","draw");if(!(t instanceof Z.qY)){const t=r;r=(0,U.w)(t,"int32"),t.dispose()}at(r),function(t){const e=(null===t||void 0===t?void 0:t.alpha)||1;if(e>1||e<0)throw new Error("Alpha value ".concat(e," is suppoed to be in range [0 - 1]."))}(null===n||void 0===n?void 0:n.imageOptions);const i={image:r},a={canvas:e,options:n};X.T2.runKernel(K.XmO,i,a)}const ct=(0,q.op)({fromPixels_:nt});function ut(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(r,"."));if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(e.shape[r-1]," vs. ").concat(n));if(0===(0,w.Ze)(t.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(t.shape,"."));const i=e.shape,a=i[i.length-1];let o=1;for(let h=0;h<i.length-1;++h)o*=i[h];const s=t.shape,c=i.slice();c.pop();let u=1;for(let h=a;h<n;++h)u*=s[h],c.push(s[h]);const l=[...(0,w.Ur)(t.shape).map((t=>t/u)),1].slice(0,a);return[c,o,u,l]}function lt(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,a="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(e.shape,", shape: ").concat(t)+", sliceDim: ".concat(r,", and batchDim: ").concat(i,".");if(n.rank<i)throw new Error(a+" update.rank < ".concat(i,". "));if(t.length<r+(n.rank-i))throw new Error(a+" Output shape length < ".concat(r+(n.rank-i)));if(n.rank!==i+t.length-r)throw new Error(a+" update.rank != ".concat(i+t.length-r));for(let o=0;o<i;++o)if(n.shape[o]!==e.shape[o])throw new Error(a+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(e.shape[o],")."));for(let o=0;o<n.rank-i;++o)if(n.shape[o+i]!==t[o+r])throw new Error(a+" updates.shape[".concat(o+i,"] (").concat(n.shape[o+i],") != shape[").concat(o+i,"] (").concat(t[o+i],")"))}function ht(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(e.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: ".concat(e.shape));if(0===t.size)throw new Error("Updates specified for empty output. updates shape: ".concat(t.shape))}lt(n,e,t)}function dt(t,e,n){const r=e.shape.length,i=r>1?e.shape[r-1]:1,a=n.length;let o=1;for(let c=i;c<a;++c)o*=n[c];const s=i<1?1:i;return{sliceRank:i,numUpdates:(0,w.Ze)(e.shape)/s,sliceSize:o,strides:[...(0,w.Ur)(n.slice(0,i)),1],outputSize:(0,w.Ze)(n)}}var ft=n(48791),pt=n(50581),gt=n(48683),mt=n(73837);const vt=.001,yt=.1;function bt(t,e,n){return null==n&&(n=xt()),wt(t,e,((t,e)=>Ct(t,e,n)))}function xt(){return 32===X.T2.backend.floatPrecision()?vt:yt}function wt(t,e,n){let r=!0;if(((0,mt.isTypedArray)(t)||(0,mt.isTypedArray)(e))&&(r=!1),(0,mt.isTypedArray)(t)&&(0,mt.isTypedArray)(e)&&(r=!0),r){const n=t.constructor.name,r=e.constructor.name;if(n!==r)throw new Error("Arrays are of different type. Actual: ".concat(n,". ")+"Expected: ".concat(r))}if(Array.isArray(t)&&Array.isArray(e)){const n=(0,j.MZ)(t),r=(0,j.MZ)(e);if(!(0,w.r1)(n,r))throw new Error("Arrays have different shapes. "+"Actual: [".concat(n,"]. Expected: [").concat(r,"]"))}const i=(0,mt.isTypedArray)(t)?t:(0,mt.flatten)(t),a=(0,mt.isTypedArray)(e)?e:(0,mt.flatten)(e);if(i.length!==a.length)throw new Error("Arrays have different lengths actual: ".concat(i.length," vs ")+"expected: ".concat(a.length,".\n")+"Actual:   ".concat(i,".\n")+"Expected: ".concat(a,"."));for(let o=0;o<a.length;++o){const t=i[o],e=a[o];if(!n(t,e))throw new Error("Arrays differ: actual[".concat(o,"] = ").concat(t,", expected[").concat(o,"] = ").concat(e,".\n")+"Actual:   ".concat(i,".\n")+"Expected: ".concat(a,"."))}"undefined"!==typeof expect&&expect().nothing()}function kt(t,e){t().then((()=>e.fail()),(()=>e())),"undefined"!==typeof expect&&expect().nothing()}function _t(t,e){const n="string"===typeof e||"number"===typeof e||"boolean"===typeof e?[e]:e;return(0,w.Kg)(t)||(0,w.Kg)(t[0])||(0,w.Kg)(e)||(0,w.Kg)(e[0])?wt(t,n,((t,e)=>t==e)):wt(t,e,((t,e)=>Ct(t,e,0)))}function At(t,e,n){if(null==n&&(n=xt()),!Ct(t,e,n))throw new Error("Numbers differ: actual === ".concat(t,", expected === ").concat(e));"undefined"!==typeof expect&&expect().nothing()}function Ct(t,e,n){return!isFinite(t)&&!isFinite(e)||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}function St(t,e,n){for(let r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error("Value out of range:".concat(t[r]," low: ").concat(e,", high: ").concat(n))}function Et(t,e){const n=new Float32Array(t),r=new Float32Array(e);if(n.length!==r.length)throw new Error("Expected ArrayBuffer to be of length "+"".concat(r.length,", but it was ").concat(n.length));for(let i=0;i<r.length;i++)if(n[i]!==r[i])throw new Error("Expected ArrayBuffer value at ".concat(i," to be ")+"".concat(r[i]," but got ").concat(n[i]," instead"))}function Tt(t){for(let e=0;e<t.length;e++){const n=t[e];Array.isArray(n)?Tt(n):t[e]=(0,mt.encodeString)(n)}return t}function Nt(t){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(t),new Promise((t=>{e.addEventListener("loadeddata",(n=>t(e))),e.load()}))}async function Ft(t){await t.play(),"requestVideoFrameCallback"in t&&await new Promise((e=>{t.requestVideoFrameCallback(e)}))}const Dt="4.17.0";var It=n(52342),Mt=n(51662),Ot=n(19527),Rt=n(74190),zt=n(59490),Bt=n(59777),Lt=n(95241),Pt=n(67060);class jt{static sgd(t){return new Pt.S(t)}static momentum(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new zt.Q(t,e,n)}static rmsprop(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return new Lt.P(t,e,n,r,i)}static adam(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Ot.F(t,e,n,r)}static adadelta(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new It.K(t,e,n)}static adamax(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return new Rt.o(t,e,n,r,i)}static adagrad(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return new Mt.a(t,e)}}var Ut=n(15188),Wt=n(59470),Vt=n(75090),qt=n(34528),Gt=n(67281);const Ht=(0,q.op)({addN_:function(t){w.vA(Array.isArray(t),(()=>"The argument passed to tf.addN() must be a list of tensors")),w.vA(t.length>=1,(()=>"Must pass at least one tensor to tf.addN(), but got "+"".concat(t.length)));const e=t.map(((t,e)=>(0,j.YT)(t,"tensors".concat(e),"addN"))),n=e[0];e.forEach((t=>{if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((t=>{if(!w.r1(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));const r=e;return X.T2.runKernel(K.EkD,r)}});var Yt=n(86465),Xt=n(25552),Kt=n(31003),Qt=n(72345),Zt=n(50155),$t=n(94467),Jt=n(16802),te=n(67986),ee=n(68080),ne=n(70963),re=n(157),ie=n(89068);const ae=(0,q.op)({avgPool3d_:function(t,e,n,r,i){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC";const o=(0,j.YT)(t,"x","avgPool3d","float32");let s=o,c=!1;4===o.rank&&(c=!0,s=(0,ie.t)(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),w.vA(5===s.rank,(()=>"Error in avgPool3d: x must be rank 5 but got rank ".concat(s.rank,"."))),w.vA("NDHWC"===a,(()=>"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(a))),w.vA("number"===typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,(()=>"Error in avgPool3d: Stride must be > 0, but got '".concat(n,"'"))),(0,re.s_)("avgPool3d",r,i);const u={x:s},l={filterSize:e,strides:n,pad:r,dimRoundingMode:i,dataFormat:a};let h=X.T2.runKernel(K.cS,u,l);return h=(0,U.w)(h,s.dtype),c?(0,ie.t)(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});var oe=n(89360),se=n(86272),ce=n(1242),ue=n(8016),le=n(47173);const he=(0,q.op)({basicLSTMCell_:function(t,e,n,r,i,a){const o=(0,j.YT)(t,"forgetBias","basicLSTMCell"),s=(0,j.YT)(e,"lstmKernel","basicLSTMCell"),c=(0,j.YT)(n,"lstmBias","basicLSTMCell"),u=(0,j.YT)(r,"data","basicLSTMCell"),l=(0,j.YT)(i,"c","basicLSTMCell"),h=(0,j.YT)(a,"h","basicLSTMCell"),d=(0,oe.x)([u,h],1),f=(0,W.N)(d,s),p=(0,Gt.W)(f,c),g=p.shape[0],m=p.shape[1]/4,v=[g,m],y=(0,ue.d)(p,[0,0],v),b=(0,ue.d)(p,[0,m],v),x=(0,ue.d)(p,[0,2*m],v),w=(0,ue.d)(p,[0,3*m],v),k=(0,Gt.W)((0,se.l)((0,ce.r)(y),(0,le.y)(b)),(0,se.l)(l,(0,ce.r)((0,Gt.W)(o,x))));return[k,(0,se.l)((0,le.y)(k),(0,ce.r)(w))]}});var de=n(81406),fe=n(26670);const pe=(0,q.op)({batchNorm2d_:function(t,e,n,r,i,a){const o=(0,j.YT)(t,"x","batchNorm"),s=(0,j.YT)(e,"mean","batchNorm"),c=(0,j.YT)(n,"variance","batchNorm");let u,l;return null!=i&&(u=(0,j.YT)(i,"scale","batchNorm")),null!=r&&(l=(0,j.YT)(r,"offset","batchNorm")),w.vA(2===o.rank,(()=>"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(o.rank,"."))),w.vA(2===s.rank||1===s.rank,(()=>"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(s.rank,"."))),w.vA(2===c.rank||1===c.rank,(()=>"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(c.rank,"."))),null!=u&&w.vA(2===u.rank||1===u.rank,(()=>"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(u.rank,"."))),null!=l&&w.vA(2===l.rank||1===l.rank,(()=>"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,"."))),(0,fe.$)(o,s,c,l,u,a)}});const ge=(0,q.op)({batchNorm3d_:function(t,e,n,r,i,a){const o=(0,j.YT)(t,"x","batchNorm"),s=(0,j.YT)(e,"mean","batchNorm"),c=(0,j.YT)(n,"variance","batchNorm");let u,l;return null!=i&&(u=(0,j.YT)(i,"scale","batchNorm")),null!=r&&(l=(0,j.YT)(r,"offset","batchNorm")),w.vA(3===o.rank,(()=>"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(o.rank,"."))),w.vA(3===s.rank||1===s.rank,(()=>"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(s.rank,"."))),w.vA(3===c.rank||1===c.rank,(()=>"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(c.rank,"."))),null!=u&&w.vA(3===u.rank||1===u.rank,(()=>"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(u.rank,"."))),null!=l&&w.vA(3===l.rank||1===l.rank,(()=>"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,"."))),(0,fe.$)(o,s,c,l,u,a)}});const me=(0,q.op)({batchNorm4d_:function(t,e,n,r,i,a){const o=(0,j.YT)(t,"x","batchNorm"),s=(0,j.YT)(e,"mean","batchNorm"),c=(0,j.YT)(n,"variance","batchNorm");let u,l;return null!=i&&(u=(0,j.YT)(i,"scale","batchNorm")),null!=r&&(l=(0,j.YT)(r,"offset","batchNorm")),w.vA(4===o.rank,(()=>"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(o.rank,"."))),w.vA(4===s.rank||1===s.rank,(()=>"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(s.rank,"."))),w.vA(4===c.rank||1===c.rank,(()=>"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(c.rank,"."))),null!=u&&w.vA(4===u.rank||1===u.rank,(()=>"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(u.rank,"."))),null!=l&&w.vA(4===l.rank||1===l.rank,(()=>"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,"."))),(0,fe.$)(o,s,c,l,u,a)}});const ve=(0,q.op)({bincount_:function(t,e,n){const r=(0,j.YT)(t,"x","bincount"),i=(0,j.YT)(e,"weights","bincount");w.vA("int32"===r.dtype,(()=>"Error in bincount: input "+"dtype must be int32, but got ".concat(r.dtype))),w.vA(n>=0,(()=>"size must be non-negative, but got ".concat(n,"."))),w.vA(i.size===r.size||0===i.size,(()=>"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(r.shape,", weights shape: ")+"".concat(i.shape,".")));const a={x:r,weights:i},o={size:n};return X.T2.runKernel(K.N4F,a,o)}});const ye=(0,q.op)({bitwiseAnd_:function(t,e){const n=(0,j.YT)(t,"x","bitwiseAnd"),r=(0,j.YT)(e,"y","bitwiseAnd");if(!(0,w.r1)(n.shape,r.shape))throw new Error("BitwiseAnd: Tensors must have the same shape. x: ".concat(n.shape,", y: ").concat(r.shape));if("int32"!==n.dtype||"int32"!==r.dtype)throw new Error("BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ".concat(n.dtype," and type of y: ").concat(r.dtype));const i={a:n,b:r};return X.T2.runKernel(K.HNs,i)}});const be=(0,q.op)({broadcastArgs_:function(t,e){const n=(0,j.YT)(t,"s0","broadcastArgs","int32"),r=(0,j.YT)(e,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error("broadcastArgs(): first input must be a vector (rank=1). "+"Has rank ".concat(n.rank));if(1!==r.rank)throw new Error("broadcastArgs(): second input must be a vector (rank=1). "+"Has rank ".concat(r.rank));const i={s0:n,s1:r};return X.T2.runKernel(K.vj7,i)}});var xe=n(99965),we=n(80186),ke=n(33989),_e=n(68042),Ae=n(62503),Ce=n(76234);const Se=(0,q.op)({concat1d_:function(t){return(0,oe.x)(t,0)}});const Ee=(0,q.op)({concat2d_:function(t,e){return(0,oe.x)(t,e)}});const Te=(0,q.op)({concat3d_:function(t,e){return(0,oe.x)(t,e)}});const Ne=(0,q.op)({concat4d_:function(t,e){return(0,oe.x)(t,e)}});var Fe=n(65783),De=n(31880),Ie=n(80824);const Me=(0,q.op)({conv3d_:function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1];const o=(0,j.YT)(t,"x","conv3d"),s=(0,j.YT)(e,"filter","conv3d");let c=o,u=!1;4===o.rank&&(u=!0,c=(0,ie.t)(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),w.vA(5===c.rank,(()=>"Error in conv3d: input must be rank 5, but got rank ".concat(c.rank,"."))),w.vA(5===s.rank,(()=>"Error in conv3d: filter must be rank 5, but got rank "+"".concat(s.rank,"."))),w.vA(c.shape[4]===s.shape[3],(()=>"Error in conv3d: depth of input (".concat(c.shape[4],") must match ")+"input depth for filter ".concat(s.shape[3],"."))),w.vA((0,re.G0)(n,a),(()=>"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(a,"'"))),w.vA("NDHWC"===i,(()=>"Error in conv3d: got dataFormat of ".concat(i," but only NDHWC is currently supported."))),w.vA((0,re.qk)(a),(()=>"Error in conv3D: Dilated rates should be larger than 0.")),w.vA((0,re.qk)(n),(()=>"Error in conv3D: Strides should be larger than 0."));const l={x:c,filter:s},h={strides:n,pad:r,dataFormat:i,dilations:a},d=X.T2.runKernel(K.A1h,l,h);return u?(0,ie.t)(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});var Oe=n(20289);const Re=(0,q.op)({conv3dTranspose_:function(t,e,n,r,i){const a=(0,j.YT)(t,"x","conv3dTranspose"),o=(0,j.YT)(e,"filter","conv3dTranspose");return(0,Oe.c)(n,a,o,r,i)}});var ze=n(48133),Be=n(84033),Le=n(79808),Pe=n(91482);const je=(0,q.op)({denseBincount_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=(0,j.YT)(t,"x","denseBincount"),a=(0,j.YT)(e,"weights","denseBincount");w.vA("int32"===i.dtype,(()=>"Error in denseBincount: input "+"dtype must be int32, but got ".concat(i.dtype))),w.vA(i.rank<=2,(()=>"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(i.rank,"."))),w.vA(n>=0,(()=>"size must be non-negative, but got ".concat(n,"."))),w.vA(a.size===i.size||0===a.size,(()=>"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(i.shape,", weights shape: ")+"".concat(a.shape,".")));const o={x:i,weights:a},s={size:n,binaryOutput:r};return X.T2.runKernel(K.wNW,o,s)}});var Ue=n(89854),We=n(92302);const Ve=(0,q.op)({diag_:function(t){const e={x:(0,j.YT)(t,"x","diag")};return X.T2.runKernel(K.ORI,e)}});var qe=n(14640),Ge=n(64113),He=n(83645),Ye=n(33185);const Xe=(0,q.op)({einsum_:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];const i=n.map(((t,e)=>(0,j.YT)(t,"tensors".concat(e),"einsum"))),a={equation:t};return X.T2.runKernel(K.Qgm,i,a)}});var Ke=n(62534);const Qe=(0,q.op)({ensureShape_:function(t,e){const n=(0,j.YT)(t,"x","ensureShape","string_or_numeric");if(!(0,w.e_)(n.shape,e))throw new Error("EnsureShape: Shape of tensor ".concat(n.shape," is not compatible with expected shape ").concat(e));return t}});var Ze=n(92138),$e=n(47829),Je=n(13779),tn=n(48389),en=n(70816),nn=n(54195),rn=n(35716);const an=(0,q.op)({eye_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";null==e&&(e=t);const i=(0,we.r)([t,e],r),a=t<=e?t:e;for(let s=0;s<a;++s)i.set(1,s,s);const o=(0,ie.t)(i.toTensor(),[t,e]);if(null==n)return o;if(1===n.length)return(0,rn.V)((0,en.U)(o,0),[n[0],1,1]);if(2===n.length)return(0,rn.V)((0,en.U)((0,en.U)(o,0),0),[n[0],n[1],1,1]);if(3===n.length)return(0,rn.V)((0,en.U)((0,en.U)((0,en.U)(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}});var on=n(99333),sn=n(96812),cn=n(64149),un=n(50511),ln=n(60228),hn=n(39103),dn=n(66758),fn=n(38660),pn=n(37304),gn=n(42310),mn=n(51965),vn=n(72969),yn=n(64210);function bn(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:t,stop:e,num:n};return X.T2.runKernel(K.mnI,{},r)}var xn=n(85593),wn=n(18688),kn=n(90781),_n=n(34675),An=n(8229),Cn=n(45492),Sn=n(21183),En=n(87375),Tn=n(65497),Nn=n(6699);const Fn=2147483648;const Dn=(0,q.op)({searchSorted_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left";const r=(0,j.YT)(t,"sortedSequence","searchSorted"),i=(0,j.YT)(e,"values","searchSorted"),a=r.shape[r.shape.length-1],o=i.shape[i.shape.length-1],s=(0,ie.t)(r,[-1,a]),c=(0,ie.t)(i,[-1,o]);if(s.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(s.shape[0]!==c.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if((0,w.Ze)(c.shape)>=Fn)throw new Error("values tensor size must less than ".concat(Fn));if(s.shape[1]>=Fn)throw new Error("trailing dim_size must less than ".concat(Fn," for int32 output type, was ").concat(s.shape[1]));const u={sortedSequence:s,values:c},l={side:n};return X.T2.runKernel(K.uWl,u,l)}});function In(t,e){return Dn(t,e,"left")}var Mn=n(73e3),On=n(8853);const Rn=(0,q.op)({maxPool3d_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC";const o=(0,j.YT)(t,"x","maxPool3d");let s=o,c=!1;4===o.rank&&(c=!0,s=(0,ie.t)(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),w.vA(5===s.rank,(()=>"Error in maxPool3d: x must be rank 5 but got rank ".concat(s.rank,"."))),w.vA("NDHWC"===a,(()=>"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(a))),(0,re.s_)("maxPool3d",r,i);const u={x:s},l={filterSize:e,strides:n,pad:r,dimRoundingMode:i,dataFormat:a},h=X.T2.runKernel(K.ySp,u,l);return c?(0,ie.t)(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});const zn=(0,q.op)({maxPoolWithArgmax_:function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const a={x:(0,j.YT)(t,"x","maxPoolWithArgmax")},o={filterSize:e,strides:n,pad:r,includeBatchInIndex:i},s=X.T2.runKernel(K.TL8,a,o);return{result:s[0],indexes:s[1]}}});var Bn=n(98104),Ln=n(49577),Pn=n(88865);function jn(t,e){let{indexing:n="xy"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("xy"!==n&&"ij"!==n)throw new TypeError("".concat(n," is not a valid third argument to meshgrid"));if(void 0===t)return[];let r=(0,j.YT)(t,"x","meshgrid",t instanceof Z.qY?t.dtype:"float32");if(void 0===e)return[r];let i=(0,j.YT)(e,"y","meshgrid",e instanceof Z.qY?e.dtype:"float32");const a=(0,w.Ze)(r.shape),o=(0,w.Ze)(i.shape);return"xy"===n?(r=(0,ie.t)(r,[1,-1]),i=(0,ie.t)(i,[-1,1]),[(0,W.N)((0,Pn.S)([o,1],r.dtype),r),(0,W.N)(i,(0,Pn.S)([1,a],i.dtype))]):(r=(0,ie.t)(r,[-1,1]),i=(0,ie.t)(i,[1,-1]),[(0,W.N)(r,(0,Pn.S)([1,o],r.dtype)),(0,W.N)((0,Pn.S)([a,1],i.dtype),i)])}var Un=n(60278),Wn=n(91086),Vn=n(32509),qn=n(5634),Gn=n(58724),Hn=n(95195),Yn=n(77820);const Xn=(0,q.op)({moments_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t=(0,j.YT)(t,"x","moments");const r=(0,w.Y6)(e,t.shape),i=(0,Ln.i)(t,r,n);let a=i.shape;n||(a=(0,Gn.SM)(i.shape,r));const o=(0,Hn.E)((0,Yn.j)((0,U.w)(t,"float32"),(0,ie.t)(i,a)));return{mean:i,variance:(0,Ln.i)(o,r,n)}}});const Kn=(0,q.op)({multiRNNCell_:function(t,e,n,r){const i=(0,j.YT)(e,"data","multiRNNCell"),a=(0,j.j1)(n,"c","multiRNNCell"),o=(0,j.j1)(r,"h","multiRNNCell");let s=i;const c=[];for(let h=0;h<t.length;h++){const e=t[h](s,a[h],o[h]);c.push(e[0]),c.push(e[1]),s=e[1]}const u=[],l=[];for(let h=0;h<c.length;h+=2)u.push(c[h]),l.push(c[h+1]);return[u,l]}});const Qn=(0,q.op)({multinomial_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=(0,j.YT)(t,"logits","multinomial"),a=i.size,o=i.rank;if(a<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(a,"."));if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(o));n=n||Math.random();const s={logits:1===o?(0,ie.t)(i,[1,-1]):i},c={numSamples:e,seed:n,normalized:r},u=X.T2.runKernel(K.WT3,s,c);return 1===o?(0,ie.t)(u,[u.size]):u}});var Zn=n(5008),$n=n(73848),Jn=n(98903);const tr=(0,q.op)({outerProduct_:function(t,e){const n=(0,j.YT)(t,"v1","outerProduct"),r=(0,j.YT)(e,"v2","outerProduct");w.vA(1===n.rank&&1===r.rank,(()=>"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")));const i=(0,ie.t)(n,[-1,1]),a=(0,ie.t)(r,[1,-1]);return(0,W.N)(i,a)}});var er=n(67507);const nr=(0,q.op)({pad1d_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,w.vA)(2===e.length,(()=>"Invalid number of paddings. Must be length of 2.")),(0,er.e)(t,[e],n)}});const rr=(0,q.op)({pad2d_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,w.vA)(2===e.length&&2===e[0].length&&2===e[1].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),(0,er.e)(t,e,n)}});const ir=(0,q.op)({pad3d_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,w.vA)(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),(0,er.e)(t,e,n)}});const ar=(0,q.op)({pad4d_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,w.vA)(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),(0,er.e)(t,e,n)}});var or=n(18570),sr=n(78188),cr=n(83860),ur=n(30629),lr=n(38517);const hr=(0,q.op)({raggedGather_:function(t,e,n,r){const i={paramsNestedSplits:t.map(((t,e)=>(0,j.YT)(t,"tensors".concat(e),"raggedGather","int32"))),paramsDenseValues:(0,j.YT)(e,"paramsDenseValues","raggedGather"),indices:(0,j.YT)(n,"indices","raggedGather","int32")},a={outputRaggedRank:r},o=X.T2.runKernel(K.oJ2,i,a);return{outputNestedSplits:o.slice(0,o.length-1),outputDenseValues:o[o.length-1]}}});const dr=(0,q.op)({raggedRange_:function(t,e,n){const r=(0,j.YT)(t,"starts","raggedRange"),i={starts:r,limits:(0,j.YT)(e,"limits","raggedRange",r.dtype),deltas:(0,j.YT)(n,"deltas","raggedRange",r.dtype)},a=X.T2.runKernel(K.CQC,i);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}});const fr=(0,q.op)({raggedTensorToTensor_:function(t,e,n,r,i){const a=(0,j.YT)(t,"shape","raggedTensorToTensor","int32"),o=(0,j.YT)(e,"values","raggedTensorToTensor"),s={shape:a,values:o,defaultValue:(0,j.YT)(n,"defaultValue","raggedTensorToTensor",o.dtype),rowPartitionTensors:r.map(((t,e)=>(0,j.YT)(t,"tensors".concat(e),"raggedTensorToTensor","int32")))},c={rowPartitionTypes:i};return X.T2.runKernel(K.mH5,s,c)}});const pr=(0,q.op)({rand_:function(t,e,n){(0,w.SA)(t);const r=(0,w.Ze)(t);let i=null;if(null==n||"float32"===n)i=new Float32Array(r);else if("int32"===n)i=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));i=new Uint8Array(r)}for(let a=0;a<r;a++)i[a]=e();return X.T2.makeTensor(i,t,n)}});var gr=n(11053);class mr{constructor(t,e,n,r,i){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const a=i||Math.random();this.random=gr.alea(a.toString())}nextValue(){if(!isNaN(this.nextVal)){const t=this.nextVal;return this.nextVal=NaN,t}let t,e,n=!1;for(;!n;){let r,i,a;do{r=2*this.random()-1,i=2*this.random()-1,a=r*r+i*i}while(a>=1||0===a);const o=Math.sqrt(-2*Math.log(a)/a);t=this.mean+this.stdDev*r*o,e=this.mean+this.stdDev*i*o,this.truncated&&!this.isValidTruncated(t)||(n=!0)}return this.truncated&&!this.isValidTruncated(e)||(this.nextVal=this.convertValue(e)),this.convertValue(t)}convertValue(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class vr{constructor(t,e,n,r){this.alpha=t,this.beta=1/e,this.dtype=n;const i=r||Math.random();this.randu=gr.alea(i.toString()),this.randn=new mr(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,e,n,r,i,a;for(;;){do{r=this.randn.nextValue(),a=1+this.c*r}while(a<=0);if(a*=a*a,t=r*r,e=1-.331*t*t,n=.5*t+this.d*(1-a+Math.log(a)),i=this.randu(),i<e||Math.log(i)<n)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)}convertValue(t){return"float32"===this.dtype?t:Math.round(t)}}class yr{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"===typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(t," - ").concat(e," <= 1 and dtype is not float"));this.random=gr.alea(r)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const br=(0,q.op)({randomGamma_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",i=arguments.length>4?arguments[4]:void 0;if((0,w.SA)(t),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type ".concat(r));const a=new vr(e,n,r,i),o=(0,we.r)(t,r);for(let s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}});const xr=(0,q.op)({randomNormal_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if((0,w.SA)(t),null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));const a=new mr(e,n,r,!1,i),o=(0,we.r)(t,r);for(let s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}});const wr=(0,q.op)({randomStandardNormal_:function(t,e,n){if(null!=e&&"bool"===e)throw new Error("Unsupported data type ".concat(e));return xr(t,0,1,e,n)}});const kr=(0,q.op)({randomUniform_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",i=arguments.length>4?arguments[4]:void 0;(0,w.SA)(t);const a=(0,we.r)(t,r),o=new yr(e,n,null,i);for(let s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}});const _r=(0,q.op)({randomUniformInt_:function(t,e,n,r){return kr(t,e,n,"int32",r)}});function Ar(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");const i={start:t,stop:e,step:n,dtype:r};return X.T2.runKernel(K.Q6t,{},i)}var Cr=n(86372),Sr=n(95868),Er=n(38414),Tr=n(6650),Nr=n(23540);const Fr=(0,q.op)({reverse1d_:function(t){const e=(0,j.YT)(t,"x","reverse");return w.vA(1===e.rank,(()=>"Error in reverse1D: x must be rank 1 but got rank ".concat(e.rank,"."))),(0,Nr.B)(e,0)}});const Dr=(0,q.op)({reverse2d_:function(t,e){const n=(0,j.YT)(t,"x","reverse");return w.vA(2===n.rank,(()=>"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,"."))),(0,Nr.B)(n,e)}});const Ir=(0,q.op)({reverse3d_:function(t,e){const n=(0,j.YT)(t,"x","reverse");return w.vA(3===n.rank,(()=>"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,"."))),(0,Nr.B)(n,e)}});const Mr=(0,q.op)({reverse4d_:function(t,e){const n=(0,j.YT)(t,"x","reverse");return w.vA(4===n.rank,(()=>"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,"."))),(0,Nr.B)(n,e)}});var Or=n(16242),Rr=n(30414),zr=n(90844),Br=n(52203),Lr=n(848);const Pr=async function(t,e){const n=(0,j.YT)(t,"x","setdiff1d"),r=(0,j.YT)(e,"y","setdiff1d");w.vA(n.dtype===r.dtype,(()=>"x and y should have the same dtype, but got x (".concat(n.dtype,") and y (").concat(r.dtype,")."))),w.vA(1===n.rank,(()=>"x should be 1D tensor, but got x (".concat(n.shape,")."))),w.vA(1===r.rank,(()=>"y should be 1D tensor, but got y (".concat(r.shape,").")));const i=await n.data(),a=await r.data(),o=new Set(a);let s=0;for(let l=0;l<i.length;l++)o.has(i[l])||s++;const c=new Z.yl([s],n.dtype),u=new Z.yl([s],"int32");for(let l=0,h=0;l<i.length;l++)o.has(i[l])||(c.values[h]=i[l],u.values[h]=l,h++);return[c.toTensor(),u.toTensor()]};var jr=n(5601),Ur=n(85956),Wr=n(15990);const Vr=(0,q.op)({slice1d_:function(t,e,n){const r=(0,j.YT)(t,"x","slice1d");return w.vA(1===r.rank,(()=>"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor"))),(0,ue.d)(r,[e],[n])}});const qr=(0,q.op)({slice2d_:function(t,e,n){const r=(0,j.YT)(t,"x","slice2d");return w.vA(2===r.rank,(()=>"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor"))),(0,ue.d)(r,e,n)}});const Gr=(0,q.op)({slice3d_:function(t,e,n){const r=(0,j.YT)(t,"x","slice3d");return w.vA(3===r.rank,(()=>"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor"))),(0,ue.d)(r,e,n)}});const Hr=(0,q.op)({slice4d_:function(t,e,n){const r=(0,j.YT)(t,"x","slice4d");return w.vA(4===r.rank,(()=>"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor"))),(0,ue.d)(r,e,n)}});var Yr=n(80724),Xr=n(22824),Kr=n(90602),Qr=n(42587),Zr=n(93674),$r=n(30890),Jr=n(35721),ti=n(77554),ei=n(45766),ni=n(77189),ri=n(2330),ii=n(22190),ai=n(52946),oi=n(57136),si=n(17937),ci=n(66465),ui=n(98869);function li(t,e){(0,w.HO)(t);const n=(0,j.MZ)(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return(0,$.Q)(t,null,n,e)}function hi(t,e,n){if((0,w.HO)(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");const r=(0,j.MZ)(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return(0,$.Q)(t,e,r,n)}function di(t,e,n){if((0,w.HO)(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");const r=(0,j.MZ)(t,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return(0,$.Q)(t,e,r,n)}function fi(t,e,n){if((0,w.HO)(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");const r=(0,j.MZ)(t,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return(0,$.Q)(t,e,r,n)}function pi(t,e,n){if((0,w.HO)(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");const r=(0,j.MZ)(t,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,(0,$.Q)(t,e,r,n)}const gi=(0,q.op)({tensorScatterUpdate_:function(t,e,n){const r=(0,j.YT)(t,"tensor","tensorScatterupdate"),i=(0,j.YT)(e,"indices","tensorScatterupdate","int32"),a=(0,j.YT)(n,"updates","tensorScatterupdate");if(ht(a,i,r.shape),r.dtype!==a.dtype)throw new Error("tensor and updates must have the same dtype, instead they are ".concat(r.dtype," and ").concat(a.dtype,"."));const o={tensor:r,indices:i,updates:a};return X.T2.runKernel(K.X4r,o,{})}});var mi=n(87984);const vi=(0,q.op)({truncatedNormal_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if((0,w.SA)(t),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");const a=new mr(e,n,r,!0,i),o=(0,we.r)(t,r);for(let s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}});var yi=n(68583),bi=n(66788),xi=n(84491);function wi(t,e){return Dn(t,e,"right")}function ki(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return X.T2.makeVariable(t,e,n,r)}var _i=n(52117);function Ai(t,e){const n=[];for(let a=0;a<e.length;a++)e[a]&&n.push(a);const r=(0,we.r)(t,"int32"),i=(0,we.r)([n.length,t.length],"int32");for(let a=0;a<n.length;a++){const e=r.indexToLoc(n[a]),o=a*t.length;i.values.set(e,o)}return i.toTensor()}const Ci=async function(t){const e=(0,j.YT)(t,"condition","whereAsync","bool"),n=await e.data(),r=Ai(e.shape,n);return t!==e&&e.dispose(),r};var Si=n(38197),Ei=n(90043);const Ti=async function(t,e,n){const r=(0,j.YT)(t,"tensor","boolMask"),i=(0,j.YT)(e,"mask","boolMask","bool"),a=null==n?0:n,o=i.rank,s=r.shape;w.vA(o>0,(()=>"mask cannot be scalar")),w.O3(s.slice(a,a+o),i.shape,"mask's shape must match the first K dimensions of tensor's shape,");let c=1;for(let g=a;g<a+o;g++)c*=s[g];const u=s.slice(0,a).concat([c],s.slice(a+o)),l=(0,ie.t)(r,u),h=(0,ie.t)(i,[-1]),d=await Ci(h),f=(0,ri.r)(d,[1]),p=(0,un.k)(l,f,a);return t!==r&&r.dispose(),e!==i&&i.dispose(),f.dispose(),l.dispose(),h.dispose(),d.dispose(),p};var Ni=n(48306);const Fi=(0,q.op)({movingAverage_:function(t,e,n,r){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const a=(0,j.YT)(t,"v","movingAverage"),o=(0,j.YT)(e,"x","movingAverage"),s=(0,j.YT)(n,"decay","movingAverage");(0,gt.assertTypesMatch)(a,o),w.vA(w.r1(a.shape,o.shape),(()=>"Shape mismatch in v and x"));const c=(0,zr.d)(1),u=(0,Yn.j)(c,s);let l=(0,se.l)((0,Yn.j)(o,a),u);if(i){w.vA(null!=r,(()=>"When using zeroDebias: true, step is required."));const t=(0,j.YT)(r,"step","movingAverage");l=(0,Ge.y)(l,(0,Yn.j)(c,(0,sr.n)(s,t)))}return(0,Gt.W)(a,l)}});const Di=(0,q.op)({scatterND_:function(t,e,n){(0,w.SA)(n);const r=(0,j.YT)(t,"indices","scatterND","int32"),i=(0,j.YT)(e,"updates","scatterND");ht(i,r,n);const a={indices:r,updates:i},o={shape:n};return X.T2.runKernel(K.pJc,a,o)}});const Ii=(0,q.op)({sparseToDense_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,w.SA)(n);const i=(0,j.YT)(t,"sparseIndices","sparseToDense","int32"),a=(0,j.YT)(e,"sparseValues","sparseToDense","string_or_numeric"),o=(0,j.YT)(r,"defaultValue","sparseToDense",a.dtype);!function(t,e,n,r){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(t.shape,"."));const i=t.rank>0?t.shape[0]:1,a=t.rank>1?t.shape[1]:1;if(n.length!==a)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(a,"."));const o=e.size;if(0!==e.rank&&(1!==e.rank||o!==i))throw new Error("sparseValues has incorrect shape "+"".concat(e.shape,", should be [] or [").concat(i,"]"));if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,a,n,o);const s={sparseIndices:i,sparseValues:a,defaultValue:o},c={outputShape:n};return X.T2.runKernel(K.jgd,s,c)}});const Mi=(0,q.op)({gatherND_:function(t,e){const n=(0,j.YT)(e,"indices","gatherND","int32"),r={params:(0,j.YT)(t,"x","gatherND","string_or_numeric"),indices:n};return X.T2.runKernel(K.O4G,r)}});const Oi=(0,q.op)({dropout_:function(t,e,n,r){const i=(0,j.YT)(t,"x","dropout");if(w.vA("float32"===i.dtype,(()=>"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(i.dtype," tensor instead."))),w.vA(e>=0&&e<1,(()=>"rate must be a float in the range [0, 1), but got ".concat(e,"."))),0===e)return t instanceof Z.qY?i.clone():i;const a=function(t,e){if(null==e)return t.shape.slice();if(w.r1(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)null==e[r]&&null!=t.shape[r]?n.push(t.shape[r]):n.push(e[r]);return n}return e}(i,n),o=1-e,s=(0,Ge.y)((0,sn.R)((0,Gt.W)(kr(a,0,1,"float32",r),o)),o);return(0,se.l)(i,s)}});function Ri(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function zi(t,e,n){const r=1-t%2,i=new Float32Array(t);for(let a=0;a<t;++a){const o=2*Math.PI*a/(t+r-1);i[a]=e-n*Math.cos(o)}return li(i,"float32")}const Bi=async function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const r=(0,j.YT)(t,"predictions","inTopK"),i=(0,j.YT)(e,"targets","inTopK");(0,w.vA)(r.rank>1,(()=>"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(r.rank))),(0,w.vA)(r.rank-1===i.rank,(()=>"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(r.rank," and targets rank ").concat(i.rank))),(0,w.O3)(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const a=r.shape[r.shape.length-1];(0,w.vA)(n>0&&n<=a,(()=>"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(a,"), but got ").concat(n)));const o=await r.data(),s=await i.data(),[c,u]=[o.length/a,a],l=(0,w.ce)("bool",c);for(let h=0;h<c;h++){const t=h*u,e=o.subarray(t,t+u),r=[];for(let n=0;n<e.length;n++)r.push({value:e[n],index:n});r.sort(((t,e)=>e.value-t.value)),l[h]=0;for(let i=0;i<n;i++)if(r[i].index===s[h]){l[h]=1;break}}return t!==r&&r.dispose(),e!==i&&i.dispose(),(0,ui.O)(l,i.shape,"bool")};var Li=n(57832),Pi=n(23458),ji=n(51294);function Ui(t,e,n){if(null==n||"linear"===n)return t;if("relu"===n)return(0,se.l)(t,(0,ai.P)(e));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function Wi(t,e){let n=e;const r=Y.getReductionAxes(t.shape,e.shape);return r.length>0&&(n=(0,si.c)(n,r)),(0,ie.t)(n,t.shape)}function Vi(t,e,n,r){if("linear"===e)return t;if("relu"===e)return(0,Er.V)(t);if("elu"===e)return(0,Ke.P)(t);if("relu6"===e)return(0,Tr.j)(t);if("prelu"===e)return(0,cr.N)(t,n);if("leakyrelu"===e)return(0,mn.H)(t,r);if("sigmoid"===e)return(0,ce.r)(t);throw new Error("Unknown fused activation ".concat(e,"."))}const qi=(t,e)=>!(t>0)||"linear"===e;const Gi=(0,q.op)({fusedConv2d_:function(t){let{x:e,filter:n,strides:r,pad:i,dataFormat:a="NHWC",dilations:o=[1,1],dimRoundingMode:s,bias:c,activation:u="linear",preluActivationWeights:l,leakyreluAlpha:h}=t;if(u=u||"linear",!1===qi(X.T2.state.gradientDepth,u)){w.vA("NHWC"===a,(()=>"Error in fused conv2d: got dataFormat of ".concat(a," but ")+"only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear."));let t=(0,De.X)(e,n,r,i,a,o,s);return null!=c&&(t=(0,Gt.W)(t,c)),Vi(t,u,l,h)}const d=(0,j.YT)(e,"x","conv2d","float32"),f=(0,j.YT)(n,"filter","conv2d","float32");let p=d,g=!1;3===d.rank&&(g=!0,p=(0,ie.t)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),w.vA(4===p.rank,(()=>"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(p.rank,"."))),w.vA(4===f.rank,(()=>"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(f.rank,"."))),re.s_("fused conv2d",i,s);const m="NHWC"===a?p.shape[3]:p.shape[1];w.vA(f.shape[2]===m,(()=>"Error in conv2d: depth of input (".concat(m,") must match ")+"input depth for filter ".concat(f.shape[2],"."))),w.vA(re.G0(r,o),(()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(o,"'")));const v=re.uf(p.shape,f.shape,r,o,i,s);let y,b;if(null!=c&&(y=(0,j.YT)(c,"bias","fused conv2d"),[y]=(0,gt.makeTypesMatch)(y,d),"NHWC"===a?Y.assertAndGetBroadcastShape(v.outShape,y.shape):(w.vA(y.shape.length<=1,(()=>"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of "+"rank-".concat(y.shape.length,"."))),w.vA(0===y.shape.length||y.shape[0]===v.outChannels||1===y.shape[0],(()=>"Error in fused conv2d: bias shape (".concat(y.shape,") is not ")+"compatible with the number of output channels "+"(".concat(v.outChannels,")"))))),null!=l){const t=l.shape;if(w.vA(t.length<=1||3===t.length,(()=>"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of "+"rank-".concat(t.length,"."))),1===t.length)w.vA(1===t[0]||t[0]===v.outChannels,(()=>"Error in fused conv2d: PReLU activation weights "+"(".concat(t,") is not compatible with the number of output ")+"channels (".concat(v.outChannels,").")));else if(3===t.length)try{Y.assertAndGetBroadcastShape(t,v.outShape)}catch(A){const e="Error in fused conv2d: PReLU activation weights (".concat(t,") ")+"is not compatible with the output shape of the conv2d "+"(".concat(v.outShape,").");throw Error(e)}b=(0,j.YT)(l,"prelu weights","fused conv2d")}const x=(t,e)=>{w.vA("NHWC"===a,(()=>"Error in gradient of fused conv2D: got dataFormat of ".concat(a," but only NHWC is currently supported.")));const[n,s,c,l]=e,h=Ui(t,c,u);w.vA(re.Dh(o),(()=>"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(o,"'")));const d=[(0,ji.v)(s.shape,h,n,r,i),(0,Pi.H)(s,h,n.shape,r,i)];if(null!=l){const t=Wi(l,h);d.push(t)}return d},k={x:p,filter:f,bias:y,preluActivationWeights:b},_={strides:r,pad:i,dataFormat:a,dilations:o,dimRoundingMode:s,activation:u,leakyreluAlpha:h};if(null==c){const t=(0,Li._X)(((t,e,n)=>{let r=X.T2.runKernel(K.aAr,k,_);return n([e,t,r]),g&&(r=(0,ie.t)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:x}}));return t(p,f)}{const t=(0,Li._X)(((t,e,n,r)=>{let i=X.T2.runKernel(K.aAr,k,_);return r([e,t,i,n]),g&&(i=(0,ie.t)(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:x}}));return t(p,f,y)}}});var Hi=n(85408),Yi=n(59068);const Xi=(0,q.op)({fusedDepthwiseConv2d_:function(t){let{x:e,filter:n,strides:r,pad:i,dataFormat:a="NHWC",dilations:o=[1,1],dimRoundingMode:s,bias:c,activation:u="linear",preluActivationWeights:l,leakyreluAlpha:h}=t;if(!1===qi(X.T2.state.gradientDepth,u)){let t=(0,We.G)(e,n,r,i,a,o,s);return null!=c&&(t=(0,Gt.W)(t,c)),Vi(t,u,l,h)}const d=(0,j.YT)(e,"x","depthwiseConv2d","float32"),f=(0,j.YT)(n,"filter","depthwiseConv2d","float32");let p=d,g=!1;3===d.rank&&(g=!0,p=(0,ie.t)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),w.vA(4===p.rank,(()=>"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(p.rank,"."))),w.vA(4===f.rank,(()=>"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(f.rank,"."))),w.vA(p.shape[3]===f.shape[2],(()=>"Error in fused depthwiseConv2d: number of input channels "+"(".concat(p.shape[3],") must match the inChannels dimension in ")+"filter ".concat(f.shape[2],"."))),null==o&&(o=[1,1]),w.vA(re.G0(r,o),(()=>"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(r," and dilations '").concat(o,"'"))),re.s_("fused depthwiseConv2d",i,s);const m=re.uf(p.shape,f.shape,r,o,i,s,!0);let v,y;null!=c&&(v=(0,j.YT)(c,"bias","fused conv2d"),[v]=(0,gt.makeTypesMatch)(v,d),Y.assertAndGetBroadcastShape(m.outShape,v.shape)),null!=l&&(y=(0,j.YT)(l,"prelu weights","fused depthwiseConv2d"));const b=(t,e)=>{w.vA(re.Dh(o),(()=>"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(o,"'")));const[n,a,c,l]=e,h=Ui(t,c,u),d=(0,Yi.l)(a.shape,h,n,r,i,o,s),f=(0,Hi.x)(a,h,n.shape,r,i,o,s);if(null!=l){return[d,f,Wi(v,h)]}return[d,f]},x={x:p,filter:f,bias:v,preluActivationWeights:y},k={strides:r,pad:i,dataFormat:a,dilations:o,dimRoundingMode:s,activation:u,leakyreluAlpha:h};if(null==c){const t=(0,Li._X)(((t,e,n)=>{let r=X.T2.runKernel(K.T7M,x,k);return n([e,t,r]),g&&(r=(0,ie.t)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:b}}));return t(p,f)}{const t=(0,Li._X)(((t,e,n,r)=>{let i=X.T2.runKernel(K.T7M,x,k);return r([e,t,i,n]),g&&(i=(0,ie.t)(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:b}}));return t(p,f,v)}}});const Ki=(0,q.op)({fusedMatMul_:function(t){let{a:e,b:n,transposeA:r=!1,transposeB:i=!1,bias:a,activation:o="linear",preluActivationWeights:s,leakyreluAlpha:c=.2}=t;if(!1===qi(X.T2.state.gradientDepth,o)){let t=(0,W.N)(e,n,r,i);return null!=a&&(t=(0,Gt.W)(t,a)),Vi(t,o,s,c)}let u=(0,j.YT)(e,"a","fused matMul"),l=(0,j.YT)(n,"b","fused matMul");[u,l]=(0,gt.makeTypesMatch)(u,l);const h=r?u.shape[u.rank-2]:u.shape[u.rank-1],d=i?l.shape[l.rank-1]:l.shape[l.rank-2],f=r?u.shape[u.rank-1]:u.shape[u.rank-2],p=i?l.shape[l.rank-2]:l.shape[l.rank-1],g=u.shape.slice(0,-2),m=l.shape.slice(0,-2),v=w.Ze(g),y=w.Ze(m);w.vA(h===d,(()=>"Error in fused matMul: inner shapes (".concat(h,") and (")+"".concat(d,") of Tensors with shapes ").concat(u.shape," and ")+"".concat(l.shape," and transposeA=").concat(r)+" and transposeB=".concat(i," must match.")));const b=Y.assertAndGetBroadcastShape(u.shape.slice(0,-2),l.shape.slice(0,-2)).concat([f,p]),x=r?(0,ie.t)(u,[v,h,f]):(0,ie.t)(u,[v,f,h]),k=i?(0,ie.t)(l,[y,p,d]):(0,ie.t)(l,[y,d,p]);let _,A;null!=a&&(_=(0,j.YT)(a,"bias","fused matMul"),[_]=(0,gt.makeTypesMatch)(_,u),Y.assertAndGetBroadcastShape(b,_.shape)),null!=s&&(A=(0,j.YT)(s,"prelu weights","fused matMul"));const C=(t,e)=>{const[n,s,c,u]=e,l=Ui((0,ie.t)(t,c.shape),c,o);let h,d;if(r||i?!r&&i?(h=(0,W.N)(l,s,!1,!1),d=(0,W.N)(l,n,!0,!1)):r&&!i?(h=(0,W.N)(s,l,!1,!0),d=(0,W.N)(n,l,!1,!1)):(h=(0,W.N)(s,l,!0,!0),d=(0,W.N)(l,n,!0,!0)):(h=(0,W.N)(l,s,!1,!0),d=(0,W.N)(n,l,!0,!1)),null!=a){return[h,d,Wi(u,l)]}return[h,d]},S={a:x,b:k,bias:_,preluActivationWeights:A},E={transposeA:r,transposeB:i,activation:o,leakyreluAlpha:c};if(null==a){const t=(0,Li._X)(((t,e,n)=>{const r=X.T2.runKernel(K.Dr,S,E);return n([t,e,r]),{value:(0,ie.t)(r,b),gradFunc:C}}));return t(x,k)}{const t=(0,Li._X)(((t,e,n,r)=>{const i=X.T2.runKernel(K.Dr,S,E);return r([t,e,i,n]),{value:(0,ie.t)(i,b),gradFunc:C}}));return t(x,k,_)}}});const Qi=(0,q.op)({hammingWindow_:function(t){return zi(t,.54,.46)}});const Zi=(0,q.op)({hannWindow_:function(t){return zi(t,.5,.5)}});const $i=(0,q.op)({frame_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=0;const o=[];for(;a+e<=t.size;)o.push((0,ue.d)(t,a,e)),a+=n;if(r)for(;a<t.size;){const r=a+e-t.size,s=(0,oe.x)([(0,ue.d)(t,a,e-r),(0,on.G)([r],i)]);o.push(s),a+=n}return 0===o.length?hi([],[0,e]):(0,ie.t)((0,oe.x)(o),[o.length,e])}});const Ji=(0,q.op)({stft_:function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Zi;null==r&&(r=Ri(e));const a=$i(t,e,n),o=(0,se.l)(a,i(e));return(0,Jr.z)(o,r)}});const ta=(0,q.op)({cropAndResize_:function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=(0,j.YT)(t,"image","cropAndResize"),s=(0,j.YT)(e,"boxes","cropAndResize","float32"),c=(0,j.YT)(n,"boxInd","cropAndResize","int32"),u=s.shape[0];w.vA(4===o.rank,(()=>"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(o.rank,"."))),w.vA(2===s.rank&&4===s.shape[1],(()=>"Error in cropAndResize: boxes must be have size [".concat(u,",4] ")+"but had shape ".concat(s.shape,"."))),w.vA(1===c.rank&&c.shape[0]===u,(()=>"Error in cropAndResize: boxInd must be have size [".concat(u,"] ")+"but had shape ".concat(s.shape,"."))),w.vA(2===r.length,(()=>"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,"."))),w.vA(r[0]>=1&&r[1]>=1,(()=>"cropSize must be atleast [1,1], but was ".concat(r))),w.vA("bilinear"===i||"nearest"===i,(()=>"method must be bilinear or nearest, but was ".concat(i)));const l={image:o,boxes:s,boxInd:c},h={method:i,extrapolationValue:a,cropSize:r};return X.T2.runKernel(K.MRQ,l,h)}});const ea=(0,q.op)({flipLeftRight_:function(t){const e=(0,j.YT)(t,"image","flipLeftRight","float32");w.vA(4===e.rank,(()=>"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(e.rank,".")));const n={image:e};return X.T2.runKernel(K.BxF,n,{})}});const na=(0,q.op)({grayscaleToRGB_:function(t){const e=(0,j.YT)(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];w.vA(e.rank>=2,(()=>"Error in grayscaleToRGB: images must be at least rank 2, "+"but got rank ".concat(e.rank,"."))),w.vA(1===r,(()=>"Error in grayscaleToRGB: last dimension of a grayscale image "+"should be size 1, but got size ".concat(r,".")));const i=new Array(e.rank);return i.fill(1,0,n),i[n]=3,(0,rn.V)(e,i)}});const ra=(0,q.op)({rgbToGrayscale_:function(t){const e=(0,j.YT)(t,"image","RGBToGrayscale"),n=e.rank-1,r=e.shape[n];w.vA(e.rank>=2,(()=>"Error in RGBToGrayscale: images must be at least rank 2, "+"but got rank ".concat(e.rank,"."))),w.vA(3===r,(()=>"Error in RGBToGrayscale: last dimension of an RGB image "+"should be size 3, but got size ".concat(r,".")));const i=e.dtype,a=(0,U.w)(e,"float32"),o=li([.2989,.587,.114]);let s;switch(e.rank){case 2:s=Xe("ij,j->i",a,o);break;case 3:s=Xe("ijk,k->ij",a,o);break;case 4:s=Xe("ijkl,l->ijk",a,o);break;case 5:s=Xe("ijklm,m->ijkl",a,o);break;case 6:s=Xe("ijklmn,n->ijklm",a,o);break;default:throw new Error("Not a valid tensor rank.")}return s=(0,en.U)(s,-1),(0,U.w)(s,i)}});const ia=(0,q.op)({rotateWithOffset_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const i=(0,j.YT)(t,"image","rotateWithOffset","float32");w.vA(4===i.rank,(()=>"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(i.rank,".")));const a={image:i},o={radians:e,fillValue:n,center:r};return X.T2.runKernel(K.BK4,a,o)}});function aa(t,e,n,r,i,a){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY),null==a&&(a=0);const o=t.shape[0];return n=Math.min(n,o),w.vA(0<=r&&r<=1,(()=>"iouThreshold must be in [0, 1], but was '".concat(r,"'"))),w.vA(2===t.rank,(()=>"boxes must be a 2D tensor, but was of rank '".concat(t.rank,"'"))),w.vA(4===t.shape[1],(()=>"boxes must have 4 columns, but 2nd dimension was ".concat(t.shape[1]))),w.vA(1===e.rank,(()=>"scores must be a 1D tensor")),w.vA(e.shape[0]===o,(()=>"scores has incompatible shape with boxes. Expected ".concat(o,", ")+"but was ".concat(e.shape[0]))),w.vA(0<=a&&a<=1,(()=>"softNmsSigma must be in [0, 1], but was '".concat(a,"'"))),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a}}const oa=(0,q.op)({nonMaxSuppression_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const a=(0,j.YT)(t,"boxes","nonMaxSuppression","float32"),o=(0,j.YT)(e,"scores","nonMaxSuppression","float32"),s=aa(a,o,n,r,i);n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold;const c={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return X.T2.runKernel(K.SDM,{boxes:a,scores:o},c)}});function sa(t,e,n){const r=function(t,e,n){return function(t,e,n){let r=0,i=t.length,a=0,o=!1;for(;r<i;){a=r+(i-r>>>1);const s=n(e,t[a]);s>0?r=a+1:(i=a,o=!s)}return o?r:-r-1}(t,e,n||ca)}(t,e,n),i=r<0?-(r+1):r;t.splice(i,0,e)}function ca(t,e){return t>e?1:t<e?-1:0}function ua(t,e,n,r,i){return da(t,e,n,r,i,0)}function la(t,e,n,r,i,a){return da(t,e,n,r,i,0,!1,a,!0)}function ha(t,e,n,r,i,a){return da(t,e,n,r,i,a,!0)}function da(t,e,n,r,i,a){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];const u=[];for(let m=0;m<e.length;m++)e[m]>i&&u.push({score:e[m],boxIndex:m,suppressBeginIndex:0});u.sort(ga);const l=a>0?-.5/a:0,h=[],d=[];for(;h.length<n&&u.length>0;){const e=u.pop(),{score:n,boxIndex:a,suppressBeginIndex:o}=e;if(n<i)break;let s=!1;for(let c=h.length-1;c>=o;--c){const n=fa(t,a,h[c]);if(n>=r){s=!0;break}if(e.score=e.score*pa(r,l,n),e.score<=i)break}e.suppressBeginIndex=h.length,s||(e.score===n?(h.push(a),d.push(e.score)):e.score>i&&sa(u,e,ga))}const f=h.length,p=n-f;s&&p>0&&(h.push(...new Array(p).fill(0)),d.push(...new Array(p).fill(0)));const g={selectedIndices:h};return o&&(g.selectedScores=d),c&&(g.validOutputs=f),g}function fa(t,e,n){const r=t.subarray(4*e,4*e+4),i=t.subarray(4*n,4*n+4),a=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),c=Math.max(r[1],r[3]),u=Math.min(i[0],i[2]),l=Math.min(i[1],i[3]),h=Math.max(i[0],i[2]),d=Math.max(i[1],i[3]),f=(s-a)*(c-o),p=(h-u)*(d-l);if(f<=0||p<=0)return 0;const g=Math.max(a,u),m=Math.max(o,l),v=Math.min(s,h),y=Math.min(c,d),b=Math.max(v-g,0)*Math.max(y-m,0);return b/(f+p-b)}function pa(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function ga(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}const ma=async function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const a=(0,j.YT)(t,"boxes","nonMaxSuppressionAsync"),o=(0,j.YT)(e,"scores","nonMaxSuppressionAsync"),s=aa(a,o,n,r,i);n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold;const c=await Promise.all([a.data(),o.data()]),u=c[0],l=c[1],{selectedIndices:h}=ua(u,l,n,r,i);return a!==t&&a.dispose(),o!==e&&o.dispose(),li(h,"int32")};const va=(0,q.op)({nonMaxSuppressionWithScore_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=(0,j.YT)(t,"boxes","nonMaxSuppression"),s=(0,j.YT)(e,"scores","nonMaxSuppression"),c=aa(o,s,n,r,i,a);n=c.maxOutputSize,r=c.iouThreshold,i=c.scoreThreshold,a=c.softNmsSigma;const u={boxes:o,scores:s},l={maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a},h=X.T2.runKernel(K.e0f,u,l);return{selectedIndices:h[0],selectedScores:h[1]}}});const ya=async function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=(0,j.YT)(t,"boxes","nonMaxSuppressionAsync"),s=(0,j.YT)(e,"scores","nonMaxSuppressionAsync"),c=aa(o,s,n,r,i,a);n=c.maxOutputSize,r=c.iouThreshold,i=c.scoreThreshold,a=c.softNmsSigma;const u=await Promise.all([o.data(),s.data()]),l=u[0],h=u[1],{selectedIndices:d,selectedScores:f}=ha(l,h,n,r,i,a);return o!==t&&o.dispose(),s!==e&&s.dispose(),{selectedIndices:li(d,"int32"),selectedScores:li(f)}};const ba=(0,q.op)({nonMaxSuppressionPadded_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=(0,j.YT)(t,"boxes","nonMaxSuppression"),s=(0,j.YT)(e,"scores","nonMaxSuppression"),c=aa(o,s,n,r,i,null),u={boxes:o,scores:s},l={maxOutputSize:c.maxOutputSize,iouThreshold:c.iouThreshold,scoreThreshold:c.scoreThreshold,padToMaxOutputSize:a},h=X.T2.runKernel(K.Zl4,u,l);return{selectedIndices:h[0],validOutputs:h[1]}}});const xa=async function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=(0,j.YT)(t,"boxes","nonMaxSuppressionAsync"),s=(0,j.YT)(e,"scores","nonMaxSuppressionAsync"),c=aa(o,s,n,r,i,null),u=c.maxOutputSize,l=c.iouThreshold,h=c.scoreThreshold,[d,f]=await Promise.all([o.data(),s.data()]),{selectedIndices:p,validOutputs:g}=la(d,f,u,l,h,a);return o!==t&&o.dispose(),s!==e&&s.dispose(),{selectedIndices:li(p,"int32"),validOutputs:(0,zr.d)(g,"int32")}};var wa=n(20537),ka=n(80828);const _a=(0,q.op)({threshold_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const i=(0,j.YT)(t,"image","threshold"),a=i.shape[0]*i.shape[1];let o,s,c,u,l=(0,se.l)(li([r]),255);if(w.vA(3===i.rank,(()=>"Error in threshold: image must be rank 3,"+"but got rank ".concat(i.rank,"."))),w.vA(3===i.shape[2]||1===i.shape[2],(()=>"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(i.shape[2],"."))),w.vA("int32"===i.dtype||"float32"===i.dtype,(()=>"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(i.dtype,"."))),w.vA("otsu"===e||"binary"===e,(()=>"Method must be binary or otsu, but was ".concat(e))),3===i.shape[2]){[o,s,c]=(0,ti.l)(i,[1,1,1],-1);const t=(0,se.l)(o,.2989),e=(0,se.l)(s,.587),n=(0,se.l)(c,.114);u=(0,Gt.W)((0,Gt.W)(t,e),n)}else u=t;if("otsu"===e){l=function(t,e){let n,r,i,a,o,s,c=li([-1]),u=li([0]),l=li([0]);for(let h=0;h<t.size-1;h++){n=(0,ue.d)(t,0,h+1),r=(0,ue.d)(t,h+1),o=(0,Ge.y)((0,si.c)(n),e),s=(0,Ge.y)((0,si.c)(r),e);const d=(0,si.c)((0,se.l)(n,Ar(0,n.size)));i=(0,Ge.y)(d,(0,si.c)(n));const f=(0,on.G)(r.shape,n.size),p=(0,Gt.W)(Ar(0,r.size),f),g=(0,se.l)(r,p);a=(0,Ge.y)((0,si.c)(g),(0,si.c)(r));const m=(0,Yn.j)(i,a),v=(0,Yn.j)(i,a),y=(0,se.l)(o,s);l=(0,se.l)((0,se.l)(y,m),v);const b=(0,ln.r)(l,u);u=(0,_i._)(b,l,u),c=(0,_i._)(b,li([h]),c)}return c}(ve((0,U.w)((0,Or.L)(u),"int32"),(0,ui.O)([]),256),a)}const h=n?(0,yn.I)(u,l):(0,ln.r)(u,l);return(0,U.w)((0,se.l)(h,255),"int32")}});const Aa=(0,q.op)({transform_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5?arguments[5]:void 0;const o=(0,j.YT)(t,"image","transform","float32"),s=(0,j.YT)(e,"transforms","transform","float32");w.vA(4===o.rank,(()=>"Error in transform: image must be rank 4,"+"but got rank ".concat(o.rank,"."))),w.vA(2===s.rank&&(s.shape[0]===o.shape[0]||1===s.shape[0])&&8===s.shape[1],(()=>"Error in transform: Input transform should be batch x 8 or 1 x 8")),w.vA(null==a||2===a.length,(()=>"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(a,".")));const c={image:o,transforms:s},u={interpolation:n,fillMode:r,fillValue:i,outputShape:a};return X.T2.runKernel(K.dLy,c,u)}});const Ca=(0,q.op)({bandPart_:function(t,e,n){const r=(0,j.YT)(t,"a","bandPart");(0,w.vA)(r.rank>=2,(()=>"bandPart(): Rank must be at least 2, got ".concat(r.rank,".")));const i=r.shape,[a,o]=r.shape.slice(-2);let s,c;"number"===typeof e?((0,w.vA)(e%1===0,(()=>"bandPart(): numLower must be an integer, got ".concat(e,"."))),(0,w.vA)(e<=a,(()=>"bandPart(): numLower (".concat(e,")")+" must not be greater than the number of rows (".concat(a,")."))),s=(0,j.YT)(e<0?a:e,"numLower","bandPart")):((0,w.vA)("int32"===e.dtype,(()=>"bandPart(): numLower's dtype must be an int32.")),s=(0,_i._)((0,vn.M)(e,0),a,(0,Wn.B)(e,a))),"number"===typeof n?((0,w.vA)(n%1===0,(()=>"bandPart(): numUpper must be an integer, got ".concat(n,"."))),(0,w.vA)(n<=o,(()=>"bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(o,")."))),c=(0,j.YT)(n<0?o:n,"numUpper","bandPart")):((0,w.vA)("int32"===n.dtype,(()=>"bandPart(): numUpper's dtype must be an int32.")),c=(0,_i._)((0,vn.M)(n,0),o,(0,Wn.B)(n,o)));const u=(0,ie.t)(Ar(0,a,1,"int32"),[-1,1]),l=Ar(0,o,1,"int32"),h=(0,Yn.j)(u,l),d=(0,Sn.n)((0,yn.I)(h,s),(0,hn.D)(h,(0,Zn.H)(c))),f=(0,Si.U)([a,o],r.dtype);return(0,ie.t)((0,ii.t)((0,xi.K)((0,ie.t)(r,[-1,a,o])).map((t=>(0,_i._)(d,t,f)))),i)}});const Sa=(0,q.op)({gramSchmidt_:function(t){let e;if(Array.isArray(t)){e=!1,(0,w.vA)(null!=t&&t.length>0,(()=>"Gram-Schmidt process: input must not be null, undefined, or empty"));const n=t[0].shape[0];for(let e=1;e<t.length;++e)(0,w.vA)(t[e].shape[0]===n,(()=>"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(t[e].shape[0]," vs. ").concat(n,")")))}else e=!0,t=(0,ti.l)(t,t.shape[0],0).map((t=>(0,ri.r)(t,[0])));(0,w.vA)(t.length<=t[0].shape[0],(()=>"Gram-Schmidt: Number of vectors (".concat(t.length,") exceeds ")+"number of dimensions (".concat(t[0].shape[0],").")));const n=[],r=t;for(let i=0;i<t.length;++i)n.push(X.T2.tidy((()=>{let t=r[i];if(i>0)for(let e=0;e<i;++e){const r=(0,se.l)((0,si.c)((0,se.l)(n[e],t)),n[e]);t=(0,Yn.j)(t,r)}return(0,Ge.y)(t,(0,Ni.x)(t,"euclidean"))})));return e?(0,ii.t)(n,0):n}});var Ea=n(23129);function Ta(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return X.T2.tidy((()=>{(0,w.vA)(2===t.shape.length,(()=>"qr2d() requires a 2D Tensor, but got a ".concat(t.shape.length,"D Tensor.")));const n=t.shape[0],r=t.shape[1];let i=an(n),a=(0,Ae.o)(t);const o=hi([[1]],[1,1]);let s=(0,Ae.o)(o);const c=n>=r?r:n;for(let t=0;t<c;++t){const e=a,c=s,u=i;[s,a,i]=X.T2.tidy((()=>{const e=(0,ue.d)(a,[t,t],[n-t,1]),c=(0,Ni.x)(e),u=(0,ue.d)(a,[t,t],[1,1]),l=(0,_i._)((0,ln.r)(u,0),hi([[-1]]),hi([[1]])),h=(0,Yn.j)(u,(0,se.l)(l,c)),d=(0,Ge.y)(e,h);s=1===d.shape[0]?(0,Ae.o)(o):(0,oe.x)([o,(0,ue.d)(d,[1,0],[d.shape[0]-1,d.shape[1]])],0);const f=(0,Zn.H)((0,Ge.y)((0,W.N)(l,h),c)),p=(0,ue.d)(a,[t,0],[n-t,r]),g=(0,se.l)(f,s),m=(0,G.m)(s);if(0===t)a=(0,Yn.j)(p,(0,W.N)(g,(0,W.N)(m,p)));else{const e=(0,Yn.j)(p,(0,W.N)(g,(0,W.N)(m,p)));a=(0,oe.x)([(0,ue.d)(a,[0,0],[t,r]),e],0)}const v=(0,G.m)(g),y=(0,ue.d)(i,[0,t],[n,i.shape[1]-t]);if(0===t)i=(0,Yn.j)(y,(0,W.N)((0,W.N)(y,s),v));else{const e=(0,Yn.j)(y,(0,W.N)((0,W.N)(y,s),v));i=(0,oe.x)([(0,ue.d)(i,[0,0],[n,t]),e],1)}return[s,a,i]})),(0,Ea.AS)([e,c,u])}return!e&&n>r&&(i=(0,ue.d)(i,[0,0],[n,r]),a=(0,ue.d)(a,[0,0],[r,r])),[i,a]}))}const Na=(0,q.op)({qr_:function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((0,w.vA)(t.rank>=2,(()=>"qr() requires input tensor to have a rank >= 2, but got rank ".concat(t.rank))),2===t.rank)return Ta(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce(((t,e)=>t*e)),r=(0,xi.K)((0,ie.t)(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),i=[],a=[];r.forEach((t=>{const[n,r]=Ta(t,e);i.push(n),a.push(r)}));return[(0,ie.t)((0,ii.t)(i,0),t.shape),(0,ie.t)((0,ii.t)(a,0),t.shape)]}}});var Fa;!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(Fa||(Fa={}));const Da=(0,q.op)({computeWeightedLoss_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Fa.SUM_BY_NONZERO_WEIGHTS;const r=(0,j.YT)(t,"losses","computeWeightedLoss");let i=null;null!=e&&(i=(0,j.YT)(e,"weights","computeWeightedLoss"));const a=null==i?r:(0,se.l)(r,i);if(n===Fa.NONE)return a;if(n===Fa.SUM)return(0,si.c)(a);if(n===Fa.MEAN){if(null==i)return(0,Ln.i)(a);{const t=r.size/i.size,e=(0,Ge.y)((0,si.c)(a),(0,si.c)(i));return t>1?(0,Ge.y)(e,(0,zr.d)(t)):e}}if(n===Fa.SUM_BY_NONZERO_WEIGHTS){if(null==i)return(0,Ge.y)((0,si.c)(a),(0,zr.d)(r.size));{const t=(0,se.l)(i,(0,Pn.S)(r.shape)),e=(0,U.w)((0,si.c)((0,$n.E)(t,(0,zr.d)(0))),"float32");return(0,Ge.y)((0,si.c)(a),e)}}throw Error("Unknown reduction: ".concat(n))}});const Ia=(0,q.op)({absoluteDifference_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Fa.SUM_BY_NONZERO_WEIGHTS;const i=(0,j.YT)(t,"labels","absoluteDifference"),a=(0,j.YT)(e,"predictions","absoluteDifference");let o=null;null!=n&&(o=(0,j.YT)(n,"weights","absoluteDifference")),(0,w.O3)(i.shape,a.shape,"Error in absoluteDifference: ");const s=(0,Wt.t)((0,Yn.j)(i,a));return Da(s,o,r)}});const Ma=(0,q.op)({cosineDistance_:function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Fa.SUM_BY_NONZERO_WEIGHTS;const a=(0,j.YT)(t,"labels","cosineDistance"),o=(0,j.YT)(e,"predictions","cosineDistance");let s=null;null!=r&&(s=(0,j.YT)(r,"weights","cosineDistance")),(0,w.O3)(a.shape,o.shape,"Error in cosineDistance: ");const c=(0,zr.d)(1),u=(0,Yn.j)(c,(0,si.c)((0,se.l)(a,o),n,!0));return Da(u,s,i)}});const Oa=(0,q.op)({hingeLoss_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Fa.SUM_BY_NONZERO_WEIGHTS,i=(0,j.YT)(t,"labels","hingeLoss");const a=(0,j.YT)(e,"predictions","hingeLoss");let o=null;null!=n&&(o=(0,j.YT)(n,"weights","hingeLoss")),(0,w.O3)(i.shape,a.shape,"Error in hingeLoss: ");const s=(0,zr.d)(1);i=(0,Yn.j)((0,se.l)((0,zr.d)(2),i),s);const c=(0,Er.V)((0,Yn.j)(s,(0,se.l)(i,a)));return Da(c,o,r)}});const Ra=(0,q.op)({huberLoss_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Fa.SUM_BY_NONZERO_WEIGHTS;const a=(0,j.YT)(t,"labels","huberLoss"),o=(0,j.YT)(e,"predictions","huberLoss");let s=null;null!=n&&(s=(0,j.YT)(n,"weights","huberLoss")),(0,w.O3)(a.shape,o.shape,"Error in huberLoss: ");const c=(0,zr.d)(r),u=(0,Wt.t)((0,Yn.j)(o,a)),l=(0,Wn.B)(u,c),h=(0,Yn.j)(u,l),d=(0,Gt.W)((0,se.l)((0,zr.d)(.5),(0,Hn.E)(l)),(0,se.l)(c,h));return Da(d,s,i)}});const za=(0,q.op)({logLoss_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Fa.SUM_BY_NONZERO_WEIGHTS;const a=(0,j.YT)(t,"labels","logLoss"),o=(0,j.YT)(e,"predictions","logLoss");let s=null;null!=n&&(s=(0,j.YT)(n,"weights","logLoss")),(0,w.O3)(a.shape,o.shape,"Error in logLoss: ");const c=(0,zr.d)(1),u=(0,zr.d)(r),l=(0,Zn.H)((0,se.l)(a,(0,wn.R)((0,Gt.W)(o,u)))),h=(0,se.l)((0,Yn.j)(c,a),(0,wn.R)((0,Gt.W)((0,Yn.j)(c,o),u))),d=(0,Yn.j)(l,h);return Da(d,s,i)}});const Ba=(0,q.op)({meanSquaredError_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Fa.SUM_BY_NONZERO_WEIGHTS;const i=(0,j.YT)(t,"labels","meanSquaredError"),a=(0,j.YT)(e,"predictions","meanSquaredError");let o=null;null!=n&&(o=(0,j.YT)(n,"weights","meanSquaredError")),(0,w.O3)(i.shape,a.shape,"Error in meanSquaredError: ");const s=(0,ni.P)(i,a);return Da(s,o,r)}});const La=(0,q.op)({sigmoidCrossEntropy_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Fa.SUM_BY_NONZERO_WEIGHTS,a=(0,j.YT)(t,"multiClassLabels","sigmoidCrossEntropy");const o=(0,j.YT)(e,"logits","sigmoidCrossEntropy");let s=null;if(null!=n&&(s=(0,j.YT)(n,"weights","sigmoidCrossEntropy")),(0,w.O3)(a.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){const t=(0,zr.d)(r),e=(0,zr.d)(1),n=(0,zr.d)(.5);a=(0,Gt.W)((0,se.l)(a,(0,Yn.j)(e,t)),(0,se.l)(n,t))}const c=function(t,e){const n=(0,j.YT)(t,"labels","sigmoidCrossEntropyWithLogits"),r=(0,j.YT)(e,"logits","sigmoidCrossEntropyWithLogits");(0,w.O3)(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const i=(0,Er.V)(r),a=(0,se.l)(r,n),o=(0,kn.K)((0,tn.o)((0,Zn.H)((0,Wt.t)(r))));return(0,Gt.W)((0,Yn.j)(i,a),o)}(a,o);return Da(c,s,i)}});const Pa=(0,q.op)({softmaxCrossEntropy_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Fa.SUM_BY_NONZERO_WEIGHTS,a=(0,j.YT)(t,"onehotLabels","softmaxCrossEntropy");const o=(0,j.YT)(e,"logits","softmaxCrossEntropy");let s=null;if(null!=n&&(s=(0,j.YT)(n,"weights","softmaxCrossEntropy")),(0,w.O3)(a.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){const t=(0,zr.d)(r),e=(0,zr.d)(1),n=(0,zr.d)(a.shape[1]);a=(0,Gt.W)((0,se.l)(a,(0,Yn.j)(e,t)),(0,Ge.y)(t,n))}const c=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(e.rank," ")+"and dim was ".concat(n));const r=(0,Li._X)(((t,e,r)=>{const i=(0,Cn.V)(e,[n],!0),a=(0,Yn.j)((0,U.w)(e,"float32"),i);r([t,a]);const o=(0,Zn.H)((0,se.l)(a,t));return{value:(0,si.c)(o,[n]),gradFunc:(t,e)=>{const[r,i]=e,a=(0,Gn.SM)(t.shape,[n]);return[(0,se.l)((0,ie.t)(t,a),(0,Yn.j)((0,U.w)(r,"float32"),(0,tn.o)(i))),(0,se.l)((0,ie.t)(t,a),(0,Yn.j)((0,tn.o)(i),(0,U.w)(r,"float32")))]}}}));return r(t,e)}(a,o);return Da(c,s,i)}});const ja=(0,q.op)({sparseFillEmptyRows_:function(t,e,n,r){const i=(0,j.YT)(t,"indices","sparseFillEmptyRows","int32"),a=(0,j.YT)(e,"values","sparseFillEmptyRows"),o=(0,j.YT)(n,"denseShape","sparseFillEmptyRows","int32"),s=(0,j.YT)(r,"defaultValue","sparseFillEmptyRows",a.dtype);if(2!==i.rank)throw new Error("Indices should be Tensor2D but received shape\n        ".concat(i.shape));if(1!==a.rank)throw new Error("Values should be Tensor1D but received shape ".concat(a.shape));if(1!==o.rank)throw new Error("Dense shape should be Tensor1D but received shape ".concat(o.shape));if(0!==s.rank)throw new Error("Default value should be a scalar but received shape ".concat(s.shape));const c={indices:i,values:a,denseShape:o,defaultValue:s},u=X.T2.runKernel(K.C8s,c);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}});const Ua=(0,q.op)({sparseReshape_:function(t,e,n){const r=(0,j.YT)(t,"inputIndices","sparseReshape","int32"),i=(0,j.YT)(e,"inputShape","sparseReshape","int32"),a=(0,j.YT)(n,"newShape","sparseReshape","int32");if(2!==r.rank)throw new Error("Input indices should be Tensor2D but received shape\n        ".concat(r.shape));if(1!==i.rank)throw new Error("Input shape should be Tensor1D but received shape ".concat(i.shape));if(1!==a.rank)throw new Error("New shape should be Tensor1D but received shape ".concat(a.shape));const o={inputIndices:r,inputShape:i,newShape:a},s=X.T2.runKernel(K.BoJ,o);return{outputIndices:s[0],outputShape:s[1]}}});const Wa=(0,q.op)({sparseSegmentMean_:function(t,e,n){const r=(0,j.YT)(t,"data","sparseSegmentMean"),i=(0,j.YT)(e,"indices","sparseSegmentMean","int32"),a=(0,j.YT)(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.rank)throw new Error("Indices should be Tensor1D but received shape\n          ".concat(i.shape));if(1!==a.rank)throw new Error("Segment ids should be Tensor1D but received shape\n          ".concat(a.shape));const o={data:r,indices:i,segmentIds:a};return X.T2.runKernel(K.L6G,o)}});const Va=(0,q.op)({sparseSegmentSum_:function(t,e,n){const r=(0,j.YT)(t,"data","sparseSegmentSum"),i=(0,j.YT)(e,"indices","sparseSegmentSum","int32"),a=(0,j.YT)(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.rank)throw new Error("Indices should be Tensor1D but received shape\n         ".concat(i.shape));if(1!==a.rank)throw new Error("Segment ids should be Tensor1D but received shape\n         ".concat(a.shape));const o={data:r,indices:i,segmentIds:a};return X.T2.runKernel(K.DvZ,o)}});const qa=(0,q.op)({stringNGrams_:function(t,e,n,r,i,a,o,s){const c=(0,j.YT)(t,"data","stringNGrams","string");if("string"!==c.dtype)throw new Error("Data must be of datatype string");if(1!==c.shape.length)throw new Error("Data must be a vector, saw: ".concat(c.shape));const u=(0,j.YT)(e,"dataSplits","stringNGrams");if("int32"!==u.dtype)throw new Error("Data splits must be of datatype int32");const l={separator:n,nGramWidths:r,leftPad:i,rightPad:a,padWidth:o,preserveShortSequences:s},h={data:c,dataSplits:u},d=X.T2.runKernel(K.YAb,h,l);return{nGrams:d[0],nGramsSplits:d[1]}}});const Ga=(0,q.op)({stringSplit_:function(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=(0,j.YT)(t,"input","stringSplit","string"),i=(0,j.YT)(e,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error("Input should be Tensor1D but received shape ".concat(r.shape));if(0!==i.rank)throw new Error("Delimiter should be a scalar but received shape ".concat(i.shape));const a={skipEmpty:n},o={input:r,delimiter:i},s=X.T2.runKernel(K.iW0,o,a);return{indices:s[0],values:s[1],shape:s[2]}}});const Ha=(0,q.op)({stringToHashBucketFast_:function(t,e){const n=(0,j.YT)(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const i={input:n};return X.T2.runKernel(K.$jE,i,r)}});const Ya=(0,q.op)({staticRegexReplace_:function(t,e,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=(0,j.YT)(t,"input","staticRegexReplace","string"),a={pattern:e,rewrite:n,replaceGlobal:r};return X.T2.runKernel(K.GZp,{x:i},a)}}),Xa={fft:Qr.h,ifft:Zr.K,rfft:Jr.z,irfft:$r.g},Ka={hammingWindow:Qi,hannWindow:Zi,frame:$i,stft:Ji},Qa={flipLeftRight:ea,grayscaleToRGB:na,resizeNearestNeighbor:ka.b,resizeBilinear:wa.v,rgbToGrayscale:ra,rotateWithOffset:ia,cropAndResize:ta,nonMaxSuppression:oa,nonMaxSuppressionAsync:ma,nonMaxSuppressionWithScore:va,nonMaxSuppressionWithScoreAsync:ya,nonMaxSuppressionPadded:ba,nonMaxSuppressionPaddedAsync:xa,threshold:_a,transform:Aa},Za={bandPart:Ca,gramSchmidt:Sa,qr:Na},$a={absoluteDifference:Ia,computeWeightedLoss:Da,cosineDistance:Ma,hingeLoss:Oa,huberLoss:Ra,logLoss:za,meanSquaredError:Ba,sigmoidCrossEntropy:La,softmaxCrossEntropy:Pa},Ja={sparseFillEmptyRows:ja,sparseReshape:Ua,sparseSegmentMean:Wa,sparseSegmentSum:Va},to={stringNGrams:qa,stringSplit:Ga,stringToHashBucketFast:Ha,staticRegexReplace:Ya},eo=jt,no="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:t=>t();function ro(){return new Promise((t=>no((()=>t()))))}function io(t,e){const n=t[0].length;t.forEach(((t,e)=>{w.vA(t.length===n,(()=>"Error in concat".concat(n,"D: rank of tensors[").concat(e,"] must be the same ")+"as the rank of the rest (".concat(n,")")))})),w.vA(e>=0&&e<n,(()=>"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")));const r=t[0];t.forEach(((t,i)=>{for(let a=0;a<n;a++)w.vA(a===e||t[a]===r[a],(()=>"Error in concat".concat(n,"D: Shape of tensors[").concat(i,"] (").concat(t,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(i,".")))}))}function ao(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}var oo;function so(t,e,n){let r=new Array;if(null==n&&null==e)return r;if(null==e)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(null==n)return r;if(t+n.length!==r.length)throw new Error("rt input.shape and shape=".concat(e," are incompatible: rt input.rank = ").concat(t+n.length,", but shape.rank = ").concat(r.length));for(let i=1;i<n.length;++i){const a=n[i],o=r[r.length-n.length+i],s=r[o];if(a>=0)if(s>=0){if(s!==a)throw new Error("rt input.shape and shape=".concat(e," are incompatible: rt input.shape[").concat(i+t,"] = ").concat(a," but shape[").concat(i+t,"] = ").concat(s))}else r[o]=a}return r}function co(t){const e={FIRST_DIM_SIZE:oo.FIRST_DIM_SIZE,VALUE_ROWIDS:oo.VALUE_ROWIDS,ROW_LENGTHS:oo.ROW_LENGTHS,ROW_SPLITS:oo.ROW_SPLITS,ROW_LIMITS:oo.ROW_LIMITS,ROW_STARTS:oo.ROW_STARTS},n=[];for(const r of t){if(!(r in e))break;n.push(e[r])}return n}function uo(t){return 0===t.length?0:t[0]===oo.FIRST_DIM_SIZE?t.length-1:t.length}function lo(t,e){if(null==t||null==e)return;const n=t.length,r=e.length;if(n>=r)throw new Error("defaultValue.shape=".concat(t," and ragged tensor flatValues.shape=").concat(e,", are incompatible: defaultValue.rank = ").concat(n," must be less than ragged tensor input flatValues.rank = ").concat(r,")"));for(let i=0;i<Math.min(n,r-1);++i){const n=t[i],r=e[i+1];if(n>=0&&r>=0&&1!==n&&n!==r)throw new Error("defaultValue.shape=".concat(t,", and ragged tensor input flatValues.shape=").concat(e," are incompatible: defaultValue.shape[").concat(i-t.length,"] = ").concat(n," but ragged tensor input.flatValues.shape[").concat(i-t.length,"] = ").concat(r))}}!function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"}(oo||(oo={}));const ho=30;function fo(t){return t<=ho?t:(0,w.lK)(t,Math.floor(Math.sqrt(t)))}function po(t,e,n){return[n*("number"===typeof t?t:t[0]),e*("number"===typeof t?t:t[1])]}function go(t,e,n){let r=[];if(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])r=r.concat(e.slice(0)),r.push(t[0]/n),r=r.concat(t.slice(1));else{r=r.concat(t[0]);const n=e.length;for(let i=0;i<n;++i)r=r.concat([t[i+1]/e[i],e[i]]);r=r.concat(t.slice(n+1))}return r}function mo(t,e){const n=[];if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]){n.push(e);for(let r=e+1;r<t;++r)r<=2*e?(n.push(r),n.push(r-(e+1))):n.push(r)}else{const r=[],i=[];for(let n=1;n<t;++n)n>=2*e+1||n%2===1?i.push(n):r.push(n);n.push(...r),n.push(0),n.push(...i)}return n}function vo(t,e,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=[];r?i.push(t[0]/n):i.push(t[0]*n);for(let a=1;a<t.length;++a)a<=e.length?r?i.push(e[a-1]*t[a]):i.push(t[a]/e[a-1]):i.push(t[a]);return i}function yo(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function bo(t,e,n){const r=t.slice(0,1);for(let i=0;i<n;++i)r.push(t[i+1]-e[i][0]-e[i][1]);return r}var xo=n(84102);const wo=.3275911,ko=.254829592,_o=-.284496736,Ao=1.421413741,Co=-1.453152027,So=1.061405429;var Eo=n(94851);function To(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(t.length,", imag: ").concat(e.length,"."));const n=new Float32Array(2*t.length);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function No(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function Fo(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let i=0;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}function Do(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let i=2;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}function Io(t,e){return{real:t[2*e],imag:t[2*e+1]}}function Mo(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function Oo(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let i=0;i<Math.ceil(t/2);i++){const a=(e?2:-2)*Math.PI*(i/t);n[i]=Math.cos(a),r[i]=Math.sin(a)}return{real:n,imag:r}}function Ro(t,e,n){const r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}const zo="->",Bo=/->/g,Lo=",",Po="...";function jo(t,e){const n=((t=t.replace(/\s/g,"")).length-t.replace(Bo,"").length)/zo.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat(zo,'").'));const[r,i]=t.split(zo);(0,w.vA)(-1===r.indexOf(Po),(()=>'The ellipsis notation ("'.concat(Po,'") is not supported yet.')));const a=r.split(Lo),o=a.length;if(e!==o)throw new Error("Expected ".concat(o," input tensors, received ").concat(e));if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const s=[];for(let h=0;h<i.length;++h){const t=i[h];if(!a.some((e=>-1!==e.indexOf(t))))throw new Error("Output subscripts contain the label ".concat(t," ")+"not present in the input subscripts.");-1===s.indexOf(t)&&s.push(t)}for(let h=0;h<r.length;++h){const t=r[h];-1===s.indexOf(t)&&t!==Lo&&s.push(t)}const c=new Array(a.length);for(let h=0;h<o;++h){if(new Set(a[h].split("")).size!==a[h].length)throw new Error("Found duplicate axes in input component ".concat(a[h],". ")+"Support for duplicate axes in input is not implemented yet.");c[h]=[];for(let t=0;t<a[h].length;++t)c[h].push(s.indexOf(a[h][t]))}const u=s.length,l=[];for(let h=i.length;h<u;++h)l.push(h);return{allDims:s,summedDims:l,idDims:c}}function Uo(t,e){let n=new Array(t);n.fill(-1);for(let i=0;i<e.length;++i)n[e[i]]=i;const r=[];for(let i=0;i<t;++i)-1===n[i]&&r.push(i);return n=n.filter((t=>-1!==t)),{permutationIndices:n,expandDims:r}}function Wo(t,e,n){const r=new Array(t);for(let i=0;i<n.length;++i){const t=n[i].shape;for(let n=0;n<e[i].length;++n)void 0===r[e[i][n]]?r[e[i][n]]=t[n]:(0,w.vA)(r[e[i][n]]===t[n],(()=>"Expected dimension ".concat(r[e[i][n]]," at axis ").concat(n," ")+"of input shaped ".concat(JSON.stringify(t),", ")+"but got dimension ".concat(t[n])))}}function Vo(t,e){const n=t,r=[];let i=0;0===t.length&&n.push(-1),i=t.length+1;for(let o=0;o<i;++o)r.push([]);const a=[];for(let o=0;o<n.length;++o){const t=Go(e,n[o]);for(const e of t)-1===a.indexOf(e)&&(r[o].push(e),a.push(e))}return{path:n,steps:r}}function qo(t){return t.every(((t,e)=>t===e))}function Go(t,e){const n=[];for(let r=0;r<t.length;++r)0!==t[r].length&&-1===t[r].indexOf(e)&&-1!==e||n.push(r);return n}function Ho(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof e)(0,w.vA)(t.shape[n]%e===0,(()=>"Number of splits must evenly divide the axis.")),r=new Array(e).fill(t.shape[n]/e);else{const i=e.reduce(((t,e)=>(-1===e&&(t+=1),t)),0);(0,w.vA)(i<=1,(()=>"There should be only one negative value in split array."));const a=e.indexOf(-1);if(-1!==a){const r=e.reduce(((t,e)=>e>0?t+e:t));e[a]=t.shape[n]-r}(0,w.vA)(t.shape[n]===e.reduce(((t,e)=>t+e)),(()=>"The sum of sizes must match the size of the axis dimension.")),r=e}return r}function Yo(t){return"Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(t)}function Xo(t,e){return"indices(".concat(t,", 0) is invalid: ").concat(e," < 0")}function Ko(t,e,n){return"indices(".concat(t,", 0) is invalid: ").concat(e," >= ").concat(n)}function Qo(t,e){return"only one output dimension may be -1, not both ".concat(t," and ").concat(e)}function Zo(t,e){return"size ".concat(t," must be non-negative, not ").concat(e)}function $o(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function Jo(t,e){const n=(0,w.Ze)(t),r=(0,w.Ze)(e);return"Input to reshape is a SparseTensor with ".concat(n,"\n  dense values, but the requested shape requires a multiple of ").concat(r,". inputShape=").concat(t," outputShape= ").concat(e)}function ts(t,e){const n=(0,w.Ze)(t),r=(0,w.Ze)(e);return"Input to reshape is a tensor with ".concat(n," dense values, but the requested shape has ").concat(r,". inputShape=").concat(t," outputShape=").concat(e)}function es(){return"segment ids must be >= 0"}function ns(){return"segment ids are not increasing"}function rs(t,e){return"Segment id ".concat(t," out of range [0, ").concat(e,"), possibly because segmentIds input is not sorted.")}function is(t,e,n){return"Bad: indices[".concat(t,"] == ").concat(e," out of range [0, ").concat(n,")")}function as(t,e){let n,r=!1;for(t<=ho?(n=t,r=!0):n=(0,w.lK)(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=(0,w.lK)(t,n+1);return n}function os(t,e,n){const r=[],i=t.length;for(let a=0;a<i;a++)a!==e?r.push(t[a]):r.push(n);return r}function ss(t,e,n,r){const i=e.shape.length,a=t.shape.length;if(0!==r&&(r<-i||r>i))throw new Error("Expect batchDims in the range of [-".concat(i,", ").concat(i,"], but got ").concat(r));if(r<0&&(r+=i),r>a)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(a,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(let h=0;h<r;++h)if(t.shape[h]!==e.shape[h])throw new Error("x.shape[".concat(h,"]: ").concat(t.shape[h]," should be equal to indices.shape[").concat(h,"]: ").concat(e.shape[h],"."));const o=t.shape[n],s=[];let c=1,u=1,l=1;for(let h=0;h<r;++h)s.push(t.shape[h]),c*=t.shape[h];for(let h=r;h<n;h++)s.push(t.shape[h]),u*=t.shape[h];for(let h=r;h<i;h++)s.push(e.shape[h]);for(let h=n+1;h<a;h++)s.push(t.shape[h]),l*=t.shape[h];return{batchSize:c,sliceSize:l,outerSize:u,dimSize:o,outputShape:s}}function cs(t){try{return t.map((t=>(0,mt.decodeString)(t)))}catch(e){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(e))}}function us(t){return t.map((t=>(0,mt.encodeString)(t)))}var ls=n(80106),hs=n(68099)},5965:(t,e,n)=>{"use strict";var r=n(37484),i=(n(41130),n(89e3)),a=n(59624),o=n(53259),s=n(69897),c=n(84634);class u{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,e){return fetch(t,e)}now(){return performance.now()}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got ".concat(e));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,e){return new TextDecoder(e).decode(t)}setTimeoutCustom(t,e){"undefined"!==typeof window&&(0,i._K)().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(t),setTimeout((()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")}),e),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",(t=>{if(t.source===window&&t.data.name===this.messageName){t.stopPropagation();(0,this.functionRefs[t.data.index])(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}}),!0))):setTimeout(t,e)}isTypedArray(t){return(0,c.Y)(t)}}if((0,i._K)().get("IS_BROWSER")){(0,i._K)().setPlatform("browser",new u);try{s.dy.registerManager(o.ZT.URL_SCHEME,new o.Cd)}catch(b){}try{s.dy.registerManager(a.mn.URL_SCHEME,new a.lQ)}catch(b){}}const l=()=>n(85817);let h;class d{constructor(){this.util=n(18590),this.textEncoder=new this.util.TextEncoder}fetch(t,e){return null!=(0,i._K)().global.fetch?(0,i._K)().global.fetch(t,e):(null==h&&(h=l()),h(t,e))}now(){const t=process.hrtime();return 1e3*t[0]+t[1]/1e6}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(e));return this.textEncoder.encode(t)}decode(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)}isTypedArray(t){return this.util.types.isFloat32Array(t)||this.util.types.isInt32Array(t)||this.util.types.isUint8Array(t)||this.util.types.isUint8ClampedArray(t)}}(0,i._K)().get("IS_NODE")&&!(0,i._K)().get("IS_BROWSER")&&(0,i._K)().setPlatform("node",new d);var f=n(80186),p=n(69779),g=n(62503),m=n(30629),v=n(90739);(0,r.Ye)();const y={buffer:f.r,cast:p.w,clone:g.o,print:m.y};(0,v.Q5)(y)},80106:(t,e,n)=>{"use strict";let r;function i(t){r=t}function a(t){if(void 0!==r)return r;if(t||"undefined"!==typeof navigator&&null!=navigator){if(t||(t=navigator),"ReactNative"===t.product)return!0;const e=t.userAgent||t.vendor||("undefined"!==typeof window?window.opera:"");if(!e){const e=t;return e.userAgentData&&e.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function o(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}n.r(e),n.d(e,{isBrowser:()=>o,isMobile:()=>a,mockIsMobile:()=>i})},37484:(t,e,n)=>{"use strict";n.d(e,{T2:()=>x,Ye:()=>b});var r=n(68099),i=n(89e3),a=n(86177),o=n(87311),s=n(46780),c=n(94851),u=n(73837),l=n(23869);class h{constructor(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new f)}profileKernel(t,e,n){let r;const a=()=>{r=n()};let o;const s=u.now();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(a);else{a();for(const t of r)t.dataSync();o=Promise.resolve({kernelMs:u.now()-s})}if((0,i._K)().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let i=0;i<r.length;i++){const e=r[i];e.data().then((n=>{d(n,e.dtype,t)}))}return{kernelName:t,outputs:r,inputs:e,timeMs:o.then((t=>t.kernelMs)),extraInfo:o.then((t=>null!=t.getExtraProfileInfo?t.getExtraProfileInfo():""))}}logKernelProfile(t){const{kernelName:e,outputs:n,timeMs:r,inputs:i,extraInfo:a}=t;n.forEach((t=>{Promise.all([t.data(),r,a]).then((n=>{this.logger.logKernelProfile(e,t,n[0],n[1],i,n[2])}))}))}}function d(t,e,n){if("float32"!==e)return!1;for(let r=0;r<t.length;r++){const e=t[r];if(isNaN(e)||!isFinite(e))return console.warn("Found ".concat(e," in the result of '").concat(n,"'")),!0}return!1}class f{logKernelProfile(t,e,n,r,i,a){const o="number"===typeof r?l.av("".concat(r,"ms"),9):r.error,s=l.av(t,25),c=e.rank,u=e.size,h=l.av(e.shape.toString(),14);let d="";for(const l in i){const t=i[l];if(null!=t){const n=t.shape||e.shape,r=n.length;d+="".concat(l,": ").concat(r,"D ").concat(r>0?n:""," ")}}console.log("%c".concat(s,"\t%c").concat(o,"\t%c").concat(c,"D ").concat(h,"\t%c").concat(u,"\t%c").concat(d,"\t%c").concat(a),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}var p=n(90739),g=n(48683);function m(t){return null!=t.kernelName}class v{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((t=>t.name))))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class y{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new v}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then((()=>{}));if(null!=this.backendInstance)return;const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e];if(await this.initializeBackend(n).success)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){const{name:t,asyncInit:e}=this.initializeBackendsAndReturnBest();if(e)throw new Error("The highest priority backend '".concat(t,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;{const{asyncInit:e}=this.initializeBackend(t);if(e)return null}}return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t in this.registryFactory?(c.i("".concat(t," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)}async setBackend(t){if(null==this.registryFactory[t])throw new Error("Backend name '".concat(t,"' not found in registry"));if(this.backendName=t,null==this.registry[t]){this.backendInstance=null;const{success:e,asyncInit:n}=this.initializeBackend(t);if(!(n?await e:e))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new h(this.backendInstance),!0}setupRegisteredKernels(){(0,s.Op)(this.backendName).forEach((t=>{null!=t.setupFunc&&t.setupFunc(this.backendInstance)}))}disposeRegisteredKernels(t){(0,s.Op)(t).forEach((e=>{null!=e.disposeFunc&&e.disposeFunc(this.registry[t])}))}initializeBackend(t){const e=this.registryFactory[t];if(null==e)throw new Error("Cannot initialize backend ".concat(t,", no registration found."));try{const n=e.factory();if(!n||n instanceof r.uI||"function"!==typeof n.then)return this.registry[t]=n,{success:!0,asyncInit:!1};{const e=++this.pendingBackendInitId,r=n.then((n=>!(e<this.pendingBackendInitId)&&(this.registry[t]=n,this.pendingBackendInit=null,!0))).catch((n=>(e<this.pendingBackendInitId||(this.pendingBackendInit=null,c.i("Initialization of backend ".concat(t," failed")),c.i(n.stack||n.message)),!1)));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}}catch(n){return c.i("Initialization of backend ".concat(t," failed")),c.i(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error("".concat(t," backend not found in registry"));this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(((t,e)=>this.registryFactory[e].priority-this.registryFactory[t].priority))}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e],{success:r,asyncInit:i}=this.initializeBackend(n);if(i||r)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,e){const n=this.state.tensorInfo.get(e),r=n.backend,i=this.readSync(e),a=r.refCount(e);r.disposeData(e,!0),n.backend=t,t.move(e,i,n.shape,n.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,e){let n,r=null;if(null==e){if("function"!==typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!==typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=t}return this.scopedRun((()=>this.startScope(r)),(()=>this.endScope(n)),(()=>(n=e(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n)))}scopedRun(t,e,n){t();try{const t=n();return e(),t}catch(r){throw e(),r}}nextTensorId(){return y.nextTensorId++}nextVariableId(){return y.nextVariableId++}clone(t){const e=x.runKernel(o.lzr,{x:t}),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],(t=>({x:()=>{const e={x:t},n={dtype:"float32"};return x.runKernel(o.KXH,e,n)}})),[],{}),e}runKernel(t,e,n){null==this.backendName&&this.backend;if(!(null!=(0,s._5)(t,this.backendName)))throw new Error("Kernel '".concat(t,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:t,inputs:e,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,e,n){const r=this.backend.numDataIds();let i=0;n.forEach((t=>{i+="complex64"===t.dtype?3:1}));const a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-e-i-a;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(o," data ids) after running '").concat(t,"'"))}runKernelFunc(t){let e,n=[];const r=this.isTapeOn(),i=this.state.numBytes,a=this.state.numTensors;let o,c;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;const u=m(t)?t.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(m(t)){const{kernelName:e,inputs:i,attrs:a}=t;null==this.backendName&&this.backend;const u=(0,s._5)(e,this.backendName);l.vA(null!=u,(()=>"Cannot find registered kernel '".concat(e,"' for backend '").concat(this.backendName,"'"))),o=()=>{const t=this.backend.numDataIds();c=u.kernelFunc({inputs:i,attrs:a,backend:this.backend});const o=Array.isArray(c)?c:[c];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(e,t,o);const s=o.map((t=>null!=t.rank?t:this.makeTensorFromTensorInfo(t)));if(r){const t=this.getTensorsForGradient(e,i,s);n=this.saveTensorsForBackwardMode(t)}return s}}else{const{forwardFunc:e}=t,i=t=>{r&&(n=t.map((t=>this.keep(this.clone(t)))))};o=()=>{const t=this.backend.numDataIds();c=this.tidy((()=>e(this.backend,i)));const n=Array.isArray(c)?c:[c];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,t,n),n}}const{inputs:h,attrs:d}=t,f=m(t)?null:t.backwardsFunc;let p;return this.scopedRun((()=>this.state.kernelDepth++),(()=>this.state.kernelDepth--),(()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(p=this.profiler.profileKernel(u,h,(()=>o())),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(p),e=p.outputs):e=o()})),r&&this.addTapeNode(u,h,e,f,n,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(h).map((t=>null!=h[t]?h[t].shape:null)),outputShapes:e.map((t=>t.shape)),kernelTimeMs:p.timeMs,extraInfo:p.extraInfo}),Array.isArray(c)?e:e[0]}saveTensorsForBackwardMode(t){const e=t.map((t=>this.keep(this.clone(t))));return e}getTensorsForGradient(t,e,n){const r=(0,s.vQ)(t);if(null!=r){const t=r.inputsToSave||[],i=r.outputsToSave||[];let a;r.saveAllInputs?(l.vA(Array.isArray(e),(()=>"saveAllInputs is true, expected inputs to be an array.")),a=Object.keys(e).map((t=>e[t]))):a=t.map((t=>e[t]));const o=n.filter(((t,e)=>i[e]));return a.concat(o)}return[]}makeTensor(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let i=t;"string"===n&&l.Kg(t[0])&&(i=t.map((t=>u.encodeString(t))));const a=r.write(i,e,n),o=new p.qY(e,n,a,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){const t=this.state.tensorInfo.get(a),e=(0,l.SL)(i);this.state.numBytes+=e-t.bytes,t.bytes=e}return o}makeTensorFromDataId(t,e,n,r){const i={dataId:t,shape:e,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(t,e){const{dataId:n,shape:r,dtype:i}=t,a=new p.qY(r,i,n,this.nextTensorId());return this.trackTensor(a,e),a}makeVariable(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.cast(r));const i=new p.rT(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw new Error("Variable with name ".concat(i.name," was already registered"));return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(t,e){this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(n=t.size*l.jv(t.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:n})),t instanceof p.rT||this.track(t)}incRef(t,e){this.trackTensor(t,e),this.backend.incRef(t.dataId)}removeDataId(t,e){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===e&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;const e=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,"string"===t.dtype&&(this.state.numStringTensors--,this.state.numBytes-=e.bytes),"complex64"!==t.dtype&&"string"!==t.dtype){const e=t.size*l.jv(t.dtype);this.state.numBytes-=e}e.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,e.backend)}disposeVariables(){for(const t in this.state.registeredVariables){const e=this.state.registeredVariables[t];this.disposeVariable(e)}}disposeVariable(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const e=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map((t=>t.totalBytesSnapshot))),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(t,e,n,r,i,a){const o={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:i},c=(0,s.vQ)(t);null!=c&&(r=c.gradFunc),null!=r&&(o.gradient=t=>(t=t.map(((t,e)=>{if(null==t){const t=n[e],r=l.Ty(t.size,t.dtype);return this.makeTensor(r,t.shape,t.dtype)}return t})),r(t.length>1?t:t[0],i,a))),this.state.activeTape.push(o)}keep(t){return t.kept=!0,t}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e}endScope(t){const e=(0,g.getTensorsInContainer)(t),n=new Set(e.map((t=>t.id)));for(let i=0;i<this.state.activeScope.track.length;i++){const t=this.state.activeScope.track[i];t.kept||n.has(t.id)||t.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],e.forEach((t=>{t.kept||t.scopeId!==r.id||this.track(t)}))}gradients(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(l.vA(e.length>0,(()=>"gradients() received an empty list of xs.")),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));const i=this.scopedRun((()=>this.startTape()),(()=>this.endTape()),(()=>this.tidy("forward",t)));l.vA(i instanceof p.qY,(()=>"The result y returned by f() must be a tensor."));const a=function(t,e,n){const r={},i={};for(let c=0;c<e.length;c++)r[e[c].id]=!0;for(let c=0;c<t.length;c++){const n=t[c],a=n.inputs;for(const t in a){const o=a[t];let s=!1;for(let t=0;t<e.length;t++)if(r[o.id]){n.outputs.forEach((t=>r[t.id]=!0)),s=!0,i[n.id]=!0;break}if(s)break}}const a={};a[n.id]=!0;const o={};for(let c=t.length-1;c>=0;c--){const e=t[c],n=e.inputs;for(let t=0;t<e.outputs.length;t++)if(a[e.outputs[t].id]){for(const t in n)a[n[t].id]=!0,o[e.id]=!0;break}}const s=[];for(let c=0;c<t.length;c++){const e=t[c];if(i[e.id]&&o[e.id]){const t={};for(const i in e.inputs){const n=e.inputs[i];r[n.id]&&(t[i]=n)}const n=Object.assign({},e);n.inputs=t,n.outputs=e.outputs,s.push(n)}}return s}(this.state.activeTape,e,i);if(!r&&0===a.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(()=>{const t={};t[i.id]=null==n?function(t){const e=(0,l.FZ)((0,l.Ze)(t),"float32");return x.makeTensor(e,t,"float32")}(i.shape):n,function(t,e,n,r){for(let i=e.length-1;i>=0;i--){const a=e[i],o=[];if(a.outputs.forEach((e=>{const n=t[e.id];null!=n?o.push(n):o.push(null)})),null==a.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(a.kernelName,"."));const s=a.gradient(o);for(const e in a.inputs){if(!(e in s))throw new Error("Cannot backprop through input ".concat(e,". ")+"Available gradients found: ".concat(Object.keys(s),"."));const i=n((()=>s[e]()));if("float32"!==i.dtype)throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"".concat(e," must have 'float32' dtype, but has '").concat(i.dtype,"'"));const o=a.inputs[e];if(!l.r1(i.shape,o.shape))throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"'".concat(e,"' has shape '").concat(i.shape,"', which does not match ")+"the shape of the input '".concat(o.shape,"'"));if(null==t[o.id])t[o.id]=i;else{const e=t[o.id];t[o.id]=r(e,i),e.dispose()}}}}(t,a,(t=>this.tidy(t)),w);const r=e.map((e=>t[e.id]));return 0===this.state.gradientDepth&&(this.state.activeTape.forEach((t=>{for(const e of t.saved)e.dispose()})),this.state.activeTape=null),{value:i,grads:r}}))}customGrad(t){var e=this;return l.vA(l.Tn(t),(()=>"The f passed in customGrad(f) must be a function.")),function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];let a;l.vA(r.every((t=>t instanceof p.qY)),(()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors"));const o={};r.forEach(((t,e)=>{o[e]=t}));return e.runKernelFunc({forwardFunc:(e,n)=>(a=t(...r,n),l.vA(a.value instanceof p.qY,(()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor")),l.vA(l.Tn(a.gradFunc),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function.")),a.value),backwardsFunc:(t,e)=>{const n=a.gradFunc(t,e),i=Array.isArray(n)?n:[n];l.vA(i.length===r.length,(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...).")),l.vA(i.every((t=>t instanceof p.qY)),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."));const o={};return i.forEach(((t,e)=>{o[e]=()=>t})),o},inputs:o})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}readToGPU(t,e){return this.state.tensorInfo.get(t).backend.readToGPU(t,e)}async time(t){const e=(0,u.now)(),n=await this.backend.time(t);return n.wallMs=(0,u.now)()-e,n}track(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new v;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function b(){const t=(0,a.L)();if(null==t._tfengine){const e=new i.OH(t);t._tfengine=new y(e)}return(0,i.tj)(t._tfengine.ENV),(0,p.qP)((()=>t._tfengine)),t._tfengine}y.nextTensorId=0,y.nextVariableId=0;const x=b();function w(t,e){const n={a:t,b:e};return x.runKernel(o.OMN,n)}},89e3:(t,e,n)=>{"use strict";n.d(e,{Km:()=>c,OH:()=>a,_K:()=>s,tj:()=>u});var r=n(23869);const i="tfjsflags";class a{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=o,this.populateURLFlags()}setPlatform(t,e){null!=this.platform&&(s().getBool("IS_TEST")||s().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(t,"."))),this.platformName=t,this.platform=e}registerFlag(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){const e=this.urlFlags[t];s().getBool("IS_TEST")||s().getBool("PROD")||console.warn("Setting feature override from URL ".concat(t,": ").concat(e,".")),this.set(t,e)}}async getAsync(t){return t in this.flags||(this.flags[t]=await this.evaluateFlag(t)),this.flags[t]}get(t){if(t in this.flags)return this.flags[t];const e=this.evaluateFlag(t);if((0,r.yL)(e))throw new Error("Flag ".concat(t," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[t]=e,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getString(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag ".concat(t," as it has not been registered."));this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '".concat(t,"': no evaluation function found."));return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if("undefined"===typeof this.global||"undefined"===typeof this.global.location||"undefined"===typeof this.global.location.search)return;const t=this.getQueryParams(this.global.location.search);if(i in t){t[i].split(",").forEach((t=>{const[e,n]=t.split(":");this.urlFlags[e]=function(t,e){const n=e.toLowerCase();return"true"===n||"false"===n?"true"===n:"".concat(+n)===n?+n:e}(0,n)}))}}}function o(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(e,r[0],r[1]),r.join("=")})),e}function s(){return c}let c=null;function u(t){c=t}},41130:(t,e,n)=>{"use strict";n(37484);var r=n(80106);const i=(0,n(89e3)._K)();i.registerFlag("DEBUG",(()=>!1),(t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),i.registerFlag("IS_BROWSER",(()=>r.isBrowser())),i.registerFlag("IS_NODE",(()=>"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node)),i.registerFlag("IS_CHROME",(()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor))),i.registerFlag("IS_SAFARI",(()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor))),i.registerFlag("PROD",(()=>!1)),i.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(()=>i.getBool("DEBUG"))),i.registerFlag("DEPRECATION_WARNINGS_ENABLED",(()=>!0)),i.registerFlag("IS_TEST",(()=>!1)),i.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(()=>i.getBool("DEBUG"))),i.registerFlag("WRAP_TO_IMAGEBITMAP",(()=>!1)),i.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",(()=>!1)),i.registerFlag("USE_SETTIMEOUTCUSTOM",(()=>!1))},86177:(t,e,n)=>{"use strict";let r;function i(){if(null==r){let t;if("undefined"!==typeof window)t=window;else if("undefined"!==typeof n.g)t=n.g;else if("undefined"!==typeof process)t=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");t=self}r=t}return r}function a(t,e){const n=function(){const t=i();return null==t._tfGlobals&&(t._tfGlobals=new Map),t._tfGlobals}();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}n.d(e,{L:()=>i,m:()=>a})},23129:(t,e,n)=>{"use strict";n.d(e,{AS:()=>m,DZ:()=>g,Gc:()=>x,Hi:()=>d,Hs:()=>S,IS:()=>u,ME:()=>p,Ok:()=>E,Sm:()=>s,W4:()=>A,aC:()=>v,fL:()=>l,gJ:()=>C,gY:()=>c,go:()=>_,jh:()=>b,jz:()=>w,kB:()=>y,m1:()=>f,rE:()=>k,rm:()=>h});var r=n(37484),i=n(89e3),a=n(90739),o=n(48683);function s(){(0,i._K)().set("PROD",!0)}function c(){(0,i._K)().set("DEBUG",!0)}function u(){(0,i._K)().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function l(t){(0,i._K)().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function h(){r.T2.disposeVariables()}function d(){return r.T2}function f(){return r.T2.memory()}function p(t){return r.T2.profile(t)}function g(t,e){return r.T2.tidy(t,e)}function m(t){(0,o.getTensorsInContainer)(t).forEach((t=>t.dispose()))}function v(t){return r.T2.keep(t)}function y(t){return r.T2.time(t)}function b(t){return r.T2.setBackend(t)}function x(){return r.T2.ready()}function w(){return r.T2.backendName}function k(t){r.T2.removeBackend(t)}function _(t){return r.T2.findBackend(t)}function A(t){return r.T2.findBackendFactory(t)}function C(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return r.T2.registerBackend(t,e,n)}function S(){return r.T2.backend}function E(t,e){(0,i._K)().setPlatform(t,e)}(0,a.B4)(l)},57832:(t,e,n)=>{"use strict";n.d(e,{Dv:()=>s,_X:()=>d,jY:()=>u,mu:()=>l,ok:()=>c,y7:()=>h});var r=n(37484),i=n(90739),a=n(52863),o=n(23869);function s(t){return o.vA(o.Tn(t),(()=>"The f passed in grad(f) must be a function")),(e,n)=>{const i=(0,a.YT)(e,"x","tf.grad","string_or_numeric"),s=null!=n?(0,a.YT)(n,"dy","tf.grad"):null;return r.T2.tidy((()=>{const{value:e,grads:n}=r.T2.gradients((()=>t(i)),[i],s);return null!=s&&o.O3(e.shape,s.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),f(n),n[0]}))}}function c(t){return o.vA(o.Tn(t),(()=>"The f passed in grads(f) must be a function")),(e,n)=>{o.vA(Array.isArray(e),(()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"));const i=(0,a.j1)(e,"args","tf.grads","string_or_numeric"),s=null!=n?(0,a.YT)(n,"dy","tf.grads"):null;return r.T2.tidy((()=>{const{value:e,grads:n}=r.T2.gradients((()=>t(...i)),i,s);return null!=s&&o.O3(e.shape,s.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),f(n),n}))}}function u(t){return o.vA(o.Tn(t),(()=>"The f passed in valueAndGrad(f) must be a function")),(e,n)=>{o.vA(e instanceof i.qY,(()=>"The x passed in valueAndGrad(f)(x) must be a tensor")),o.vA(null==n||n instanceof i.qY,(()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"));const{grads:a,value:s}=r.T2.gradients((()=>t(e)),[e],n);return f(a),{grad:a[0],value:s}}}function l(t){return o.vA(o.Tn(t),(()=>"The f passed in valueAndGrads(f) must be a function")),(e,n)=>{o.vA(Array.isArray(e)&&e.every((t=>t instanceof i.qY)),(()=>"The args passed in valueAndGrads(f)(args) must be array of tensors")),o.vA(null==n||n instanceof i.qY,(()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"));const a=r.T2.gradients((()=>t(...e)),e,n);return null!=n&&o.O3(a.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),f(a.grads),a}}function h(t,e){o.vA(o.Tn(t),(()=>"The f passed in variableGrads(f) must be a function")),o.vA(null==e||Array.isArray(e)&&e.every((t=>t instanceof i.rT)),(()=>"The varList passed in variableGrads(f, varList) must be an array of variables"));const n=null!=e;if(!n){e=[];for(const t in r.T2.registeredVariables)e.push(r.T2.registeredVariables[t])}const a=n?e.filter((t=>!t.trainable)):null,s=e.length;e=e.filter((t=>t.trainable)),o.vA(e.length>0,(()=>"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(s," variables is ")+"trainable."));const{value:c,grads:u}=r.T2.gradients(t,e,null,!0);o.vA(u.some((t=>null!=t)),(()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize().")),o.vA(0===c.rank,(()=>"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(c.rank," tensor")));const l={};return e.forEach(((t,e)=>{null!=u[e]&&(l[t.name]=u[e])})),null!=a&&a.forEach((t=>l[t.name]=null)),{value:c,grads:l}}function d(t){return r.T2.customGrad(t)}function f(t){if(t.filter((t=>null==t)).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}},90054:(t,e,n)=>{"use strict";n.d(e,{B:()=>s});var r=n(87311),i=n(69779),a=n(86272),o=n(52946);const s={kernelName:r.ljI,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,a.l)(t,(0,o.P)((0,i.w)(n,"float32"),-1))}}}},70476:(t,e,n)=>{"use strict";n.d(e,{l:()=>h});var r=n(87311),i=n(69779),a=n(64113),o=n(5008),s=n(90844),c=n(45766),u=n(95195),l=n(77820);const h={kernelName:r.Vvy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=(0,u.E)((0,i.w)(n,"float32")),r=(0,c.R)((0,l.j)((0,s.d)(1),e));return(0,o.H)((0,a.y)(t,r))}}}}},62720:(t,e,n)=>{"use strict";n.d(e,{h:()=>u});var r=n(87311),i=n(69779),a=n(64113),o=n(45766),s=n(95195),c=n(77820);const u={kernelName:r.PH8,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=(0,o.R)((0,c.j)((0,s.E)((0,i.w)(n,"float32")),1));return(0,a.y)(t,e)}}}}},14219:(t,e,n)=>{"use strict";n.d(e,{y:()=>r});const r={kernelName:n(87311).EkD,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach(((e,r)=>{n[r]=()=>t.clone()})),n}}},39823:(t,e,n)=>{"use strict";n.d(e,{Y:()=>s});var r=n(87311),i=n(84824),a=n(89068),o=n(17937);const s={kernelName:r.OMN,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=i.assertAndGetBroadcastShape(n.shape,r.shape);return{a:()=>{let e=t;const r=i.getReductionAxes(n.shape,s);return r.length>0&&(e=(0,o.c)(e,r)),(0,a.t)(e,n.shape)},b:()=>{let e=t;const n=i.getReductionAxes(r.shape,s);return n.length>0&&(e=(0,o.c)(e,n)),(0,a.t)(e,r.shape)}}}}},71500:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(87311),i=n(90043);const a={kernelName:r.Jp_,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,i.P)(n)}}}},92998:(t,e,n)=>{"use strict";n.d(e,{l:()=>a});var r=n(87311),i=n(90043);const a={kernelName:r.p_m,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,i.P)(n)}}}},98003:(t,e,n)=>{"use strict";n.d(e,{_:()=>l});var r=n(87311),i=n(69779),a=n(64113),o=n(90844),s=n(45766),c=n(95195),u=n(77820);const l={kernelName:r.QKF,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,a.y)(t,(0,s.R)((0,u.j)((0,o.d)(1),(0,c.E)((0,i.w)(n,"float32")))))}}}},10101:(t,e,n)=>{"use strict";n.d(e,{O:()=>l});var r=n(87311),i=n(67281),a=n(69779),o=n(64113),s=n(90844),c=n(45766),u=n(95195);const l={kernelName:r.epO,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=(0,c.R)((0,i.W)((0,s.d)(1),(0,u.E)((0,a.w)(n,"float32"))));return(0,o.y)(t,e)}}}}},83018:(t,e,n)=>{"use strict";n.d(e,{B:()=>d});var r=n(87311),i=n(67281),a=n(84824),o=n(64113),s=n(86272),c=n(5008),u=n(89068),l=n(95195),h=n(17937);const d={kernelName:r.lxb,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,d=(0,a.assertAndGetBroadcastShape)(n.shape,r.shape);return{a:()=>{const e=(0,i.W)((0,l.E)(n),(0,l.E)(r));let c=(0,s.l)(t,(0,o.y)(r,e));const f=(0,a.getReductionAxes)(n.shape,d);return f.length>0&&(c=(0,h.c)(c,f)),(0,u.t)(c,n.shape)},b:()=>{const e=(0,i.W)((0,l.E)(n),(0,l.E)(r));let f=(0,c.H)((0,s.l)(t,(0,o.y)(n,e)));const p=(0,a.getReductionAxes)(r.shape,d);return p.length>0&&(f=(0,h.c)(f,p)),(0,u.t)(f,r.shape)}}}}},71536:(t,e,n)=>{"use strict";n.d(e,{z:()=>c});var r=n(87311),i=n(67281),a=n(69779),o=n(64113),s=n(95195);const c={kernelName:r.TyE,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,o.y)(t,(0,i.W)((0,s.E)((0,a.w)(n,"float32")),1))}}}},93372:(t,e,n)=>{"use strict";n.d(e,{n:()=>u});var r=n(87311),i=n(69779),a=n(64113),o=n(95195),s=n(77820),c=n(90844);const u={kernelName:r.zP9,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,a.y)(t,(0,s.j)((0,c.d)(1),(0,o.E)((0,i.w)(n,"float32"))))}}}},84969:(t,e,n)=>{"use strict";n.d(e,{m:()=>a});var r=n(87311),i=n(88500);const a={kernelName:r.cS,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:a,strides:o,pad:s,dimRoundingMode:c}=n;return{x:()=>(0,i.k)(t,r,a,o,s,c)}}}},1568:(t,e,n)=>{"use strict";n.d(e,{$:()=>a});var r=n(87311),i=n(15518);const a={kernelName:r.ho8,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:a,strides:o,pad:s}=n;return{x:()=>(0,i.$)(t,r,a,o,s)}}}},76722:(t,e,n)=>{"use strict";n.d(e,{v:()=>a});var r=n(87311),i=n(65849);const a={kernelName:r.jAQ,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[r,a]=e,{transposeA:o,transposeB:s}=n;return o||s?!o&&s?{a:()=>(0,i.N)(t,a,!1,!1),b:()=>(0,i.N)(t,r,!0,!1)}:o&&!s?{a:()=>(0,i.N)(a,t,!1,!0),b:()=>(0,i.N)(r,t,!1,!1)}:{a:()=>(0,i.N)(a,t,!0,!0),b:()=>(0,i.N)(t,r,!0,!0)}:{a:()=>(0,i.N)(t,a,!1,!0),b:()=>(0,i.N)(r,t,!0,!1)}}}},99223:(t,e,n)=>{"use strict";n.d(e,{I:()=>a});var r=n(87311),i=n(90602);const a={kernelName:r.Ik2,gradFunc:(t,e,n)=>{const{blockShape:r,crops:a}=n;return{x:()=>(0,i.e)(t,r,a)}}}},68432:(t,e,n)=>{"use strict";n.d(e,{X:()=>a});var r=n(87311),i=n(17937);const a={kernelName:r.LB5,gradFunc:(t,e,n)=>{const r=n,a=r.inputShape,o=r.shape,s=Array.from(o);for(let i=a.length-1;i>=0;i--)if(a[i]===o[i])s[i]=1;else if(1!==a[i])throw new Error("broadcastTo(): [".concat(a,"] cannot be broadcast to [").concat(o,"]."));const c=[];for(let i=0;i<s.length;i++)s[i]>1&&c.push(i);return{x:()=>(0,i.c)(t,c,!0)}}}},4067:(t,e,n)=>{"use strict";n.d(e,{Q:()=>r});const r={kernelName:n(87311).KXH,gradFunc:t=>({x:()=>t.clone()})}},95833:(t,e,n)=>{"use strict";n.d(e,{C:()=>a});var r=n(87311),i=n(90043);const a={kernelName:r.QDP,gradFunc:t=>({x:()=>(0,i.P)(t)})}},26290:(t,e,n)=>{"use strict";n.d(e,{Z:()=>u});var r=n(87311),i=n(39103),a=n(64210),o=n(21183),s=n(52117),c=n(90043);const u={kernelName:r.vaV,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{clipValueMin:u,clipValueMax:l}=n;return{x:()=>(0,s._)((0,o.n)((0,i.D)(r,u),(0,a.I)(r,l)),t,(0,c.P)(t))}}}},88818:(t,e,n)=>{"use strict";n.d(e,{N:()=>a});var r=n(87311),i=n(90054);const a={kernelName:r.$zE,inputsToSave:["x"],gradFunc:i.B.gradFunc}},21662:(t,e,n)=>{"use strict";n.d(e,{N:()=>o});var r=n(87311),i=n(77554),a=n(23869);const o={kernelName:r.$dB,saveAllInputs:!0,gradFunc:(t,e,n)=>{const r=e.map((t=>t.shape)),{axis:o}=n,s=(0,a.Y6)(o,e[0].shape)[0],c=r.map((t=>t[s]));return(0,i.l)(t,c,s).map((t=>()=>t))}}},80196:(t,e,n)=>{"use strict";n.d(e,{R:()=>o});var r=n(87311),i=n(31880),a=n(23458);const o={kernelName:r.jfg,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[r,o]=e,{strides:s,pad:c,dataFormat:u,dimRoundingMode:l}=n;return{dy:()=>(0,i.X)(t,o,s,c,u,1,l),filter:()=>(0,a.H)(t,r,o.shape,s,c,u,l)}}}},80238:(t,e,n)=>{"use strict";n.d(e,{J:()=>c});var r=n(87311),i=n(23458),a=n(51294),o=n(157),s=n(23869);const c={kernelName:r.p2J,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,c]=e,{dilations:u,strides:l,pad:h,dataFormat:d}=n;return s.vA(o.Dh(u),(()=>"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(u,"'"))),{x:()=>(0,a.v)(r.shape,t,c,l,h,d),filter:()=>(0,i.H)(r,t,c.shape,l,h,d)}}}},90249:(t,e,n)=>{"use strict";n.d(e,{Y:()=>c});var r=n(87311),i=n(29475),a=n(20289),o=n(157),s=n(23869);const c={kernelName:r.A1h,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:c,pad:u}=n;s.vA((0,o.Dh)(r),(()=>"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(r,"'")));const[l,h]=e;return{x:()=>(0,a.c)(l.shape,t,h,c,u),filter:()=>(0,i._)(l,t,h.shape,c,u)}}}},5103:(t,e,n)=>{"use strict";n.d(e,{g:()=>c});var r=n(87311),i=n(69779),a=n(86272),o=n(5008),s=n(85956);const c={kernelName:r.Mn0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,a.l)((0,o.H)((0,s.F)((0,i.w)(n,"float32"))),t)}}}},99065:(t,e,n)=>{"use strict";n.d(e,{M:()=>s});var r=n(87311),i=n(69779),a=n(86272),o=n(15990);const s={kernelName:r.MnK,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,a.l)((0,o.L)((0,i.w)(n,"float32")),t)}}}},27432:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(87311),i=n(58724),a=n(91482),o=n(15977);const s={kernelName:r.nY8,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s,exclusive:c,reverse:u}=n;return{x:()=>{const e=(0,i.Em)([s],r.rank);let n=(0,a.r)(t,s,c,!u);return null!=e&&(n=(0,o.m)(n,e)),n}}}}},11464:(t,e,n)=>{"use strict";n.d(e,{z:()=>c});var r=n(87311),i=n(157),a=n(85408),o=n(59068),s=n(23869);const c={kernelName:r.tGH,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:c,pad:u,dimRoundingMode:l}=n,h=null==r?[1,1]:r;s.vA(i.Dh(h),(()=>"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(h,"'")));const[d,f]=e;return s.vA(4===d.rank,(()=>"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(d.rank,"."))),s.vA(4===f.rank,(()=>"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(f.rank,"."))),s.vA(d.shape[3]===f.shape[2],(()=>"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(d.shape[3],") must match the inChannels dimension ")+"in filter ".concat(f.shape[2],"."))),s.vA(i.G0(c,h),(()=>"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(c," and dilations ")+"'".concat(h,"'."))),i.s_("depthwiseConv2d",u,l),{x:()=>(0,o.l)(d.shape,t,f,c,u,h,l),filter:()=>(0,a.x)(d,t,f.shape,c,u,h,l)}}}},15674:(t,e,n)=>{"use strict";n.d(e,{v:()=>a});var r=n(37484),i=n(87311);const a={kernelName:i.jxD,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[a,o]=e,s={x:a,filter:o,dy:t},c={x:a,filter:o,dy:t};return{x:()=>r.T2.runKernel(i.bP9,s,n),filter:()=>r.T2.runKernel(i.pk0,c,n)}}}},36514:(t,e,n)=>{"use strict";n.d(e,{x:()=>a});var r=n(37484),i=n(87311);const a={kernelName:i.Pah,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,a={dy:t,y:n};return{x:()=>r.T2.runKernel(i.rsH,a)}}}},88559:(t,e,n)=>{"use strict";n.d(e,{S:()=>c});var r=n(87311),i=n(48389),a=n(86272),o=n(5008),s=n(95195);const c={kernelName:r._s9,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=(0,a.l)((0,i.o)((0,o.H)((0,s.E)(n))),2/Math.sqrt(Math.PI));return{x:()=>(0,a.l)(t,r)}}}},97987:(t,e,n)=>{"use strict";n.d(e,{k:()=>a});var r=n(87311),i=n(86272);const a={kernelName:r.ox3,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,i.l)(t,n)}}}},65579:(t,e,n)=>{"use strict";n.d(e,{y:()=>a});var r=n(87311),i=n(89068);const a={kernelName:r.ybN,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>(0,i.t)(t,n.shape)}}}},59861:(t,e,n)=>{"use strict";n.d(e,{a:()=>o});var r=n(87311),i=n(48389),a=n(86272);const o={kernelName:r.ybj,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,a.l)(t,(0,i.o)(n))}}}},82825:(t,e,n)=>{"use strict";n.d(e,{S:()=>d});var r=n(87311),i=n(84824),a=n(69779),o=n(64113),s=n(86272),c=n(5008),u=n(89068),l=n(95195),h=n(17937);const d={kernelName:r.ElG,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,d=(0,i.assertAndGetBroadcastShape)(n.shape,r.shape);return{a:()=>{const e=(0,o.y)(t,(0,a.w)(r,"float32")),s=(0,i.getReductionAxes)(n.shape,d);return s.length>0?(0,u.t)((0,h.c)(e,s),n.shape):e},b:()=>{let e=(0,s.l)(t,(0,a.w)(n,"float32"));const f=(0,i.getReductionAxes)(r.shape,d);f.length>0&&(e=(0,u.t)((0,h.c)(e,f),r.shape));const p=(0,l.E)(r);return(0,c.H)((0,o.y)(e,(0,a.w)(p,"float32")))}}}}},67008:(t,e,n)=>{"use strict";n.d(e,{n:()=>a});var r=n(87311),i=n(90043);const a={kernelName:r.ZgB,gradFunc:t=>({x:()=>(0,i.P)(t)})}},60035:(t,e,n)=>{"use strict";n.d(e,{E:()=>f});var r=n(87311),i=n(67281),a=n(84824),o=n(86272),s=n(89068),c=n(30414),u=n(90844),l=n(77820),h=n(17937),d=n(35716);const f={kernelName:r.i5R,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:r}=n,[f,p,g,m]=e,v=null==m?(0,u.d)(1):m,y=(0,a.getReductionAxes)(p.shape,f.shape),b=[];if(1===p.rank){for(let t=0;t<f.shape.length-1;++t)b.push(f.shape[t]);b.push(1)}const x=(0,l.j)(f,p),w=(0,o.l)(t,v),k=(0,c.Z)((0,i.W)(g,(0,u.d)(r))),_=(0,o.l)((0,o.l)((0,o.l)(k,k),k),(0,u.d)(-.5));return{x:()=>1===p.rank?(0,s.t)((0,o.l)((0,o.l)(t,(0,d.V)((0,s.t)(k,[1,1,1,p.shape[0]]),b)),v),f.shape):(0,s.t)((0,o.l)((0,o.l)(t,k),v),f.shape),mean:()=>{let t=(0,o.l)((0,o.l)(k,(0,u.d)(-1)),w);return 1===p.rank&&(t=(0,h.c)(t,y)),(0,s.t)(t,p.shape)},variance:()=>{let t=(0,o.l)((0,o.l)(_,x),w);return 1===p.rank&&(t=(0,h.c)(t,y)),(0,s.t)(t,p.shape)},scale:()=>{const e=(0,o.l)(x,k);let n=(0,o.l)(t,e);return 1===p.rank&&(n=(0,h.c)(n,y)),(0,s.t)(n,p.shape)},offset:()=>{let e=t;return 1===p.rank&&(e=(0,h.c)(e,y)),(0,s.t)(e,p.shape)}}}}},71551:(t,e,n)=>{"use strict";n.d(e,{E:()=>l});var r=n(87311),i=n(58724),a=n(89068),o=n(22190),s=n(15977),c=n(66788),u=n(23869);const l={kernelName:r.mxL,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[r,l]=e,{axis:f,batchDims:p}=n,g=(0,u.Y6)(f,r.shape)[0],m=(t,e,n)=>()=>{const r=t.shape,o=e.size,u=r.slice(0,g),l=u.length,p=r.slice(f,r.length).slice(1),m=p.length,v=h(0,l),y=h(l+1,l+1+m),b=d([u,[o],p]),x=(0,a.t)(n,b),w=(0,a.t)(e,[o]),k=d([[l],v,y]),_=(0,s.m)(x,k);let A=(0,c.z)(_,w,t.shape[g]);const C=(0,i.gx)(k);return A=(0,s.m)(A,C),A};if(1===p){const e=r.shape[0],n=r.split(e,0);return{x:()=>{const e=(0,o.t)(n.map(((e,n)=>m(e,l.slice(n,1),t.slice(n,1))())));return e.reshape(r.shape)},indices:()=>l}}return{x:m(r,l,t),indices:()=>l}}};function h(t,e){const n=[];for(let r=t;r<e;++r)n.push(r);return n}function d(t){const e=[];for(let n=0;n<t.length;++n)for(let r=0;r<t[n].length;++r)e.push(t[n][r]);return e}},82588:(t,e,n)=>{"use strict";n.d(e,{D:()=>a});var r=n(87311),i=n(90043);const a={kernelName:r.lLS,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>(0,i.P)(n),b:()=>(0,i.P)(r)}}}},65428:(t,e,n)=>{"use strict";n.d(e,{L:()=>a});var r=n(87311),i=n(69779);const a={kernelName:r.lzr,gradFunc:t=>({x:()=>(0,i.w)(t,"float32")})}},96403:(t,e,n)=>{"use strict";n.d(e,{c:()=>a});var r=n(87311),i=n(90043);const a={kernelName:r.gIW,gradFunc:t=>({x:()=>(0,i.P)(t)})}},41503:(t,e,n)=>{"use strict";n.d(e,{c:()=>a});var r=n(87311),i=n(90043);const a={kernelName:r.E3$,gradFunc:t=>({x:()=>(0,i.P)(t)})}},1381:(t,e,n)=>{"use strict";n.d(e,{C:()=>a});var r=n(87311),i=n(90043);const a={kernelName:r.iPs,gradFunc:t=>({x:()=>(0,i.P)(t)})}},48274:(t,e,n)=>{"use strict";n.d(e,{J:()=>a});var r=n(87311),i=n(14206);const a={kernelName:r.jM4,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,a]=e,{depthRadius:o,bias:s,alpha:c,beta:u}=n;return{x:()=>(0,i.u)(r,a,t,o,s,c,u)}}}},75962:(t,e,n)=>{"use strict";n.d(e,{f:()=>s});var r=n(87311),i=n(60228),a=n(86272),o=n(52117);const s={kernelName:r.X0$,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{alpha:s}=n,c=(0,i.r)(r,0);return{x:()=>(0,o._)(c,t,(0,a.l)(t,s))}}}},58119:(t,e,n)=>{"use strict";n.d(e,{G:()=>o});var r=n(87311),i=n(67281),a=n(64113);const o={kernelName:r.Cg$,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,a.y)(t,(0,i.W)(n,1))}}}},97822:(t,e,n)=>{"use strict";n.d(e,{z:()=>c});var r=n(87311),i=n(48389),a=n(86272),o=n(77820),s=n(17937);const c={kernelName:r.zfU,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{axis:c}=n;return{logits:()=>{const e=(0,i.o)(r);return(0,o.j)(t,(0,a.l)((0,s.c)(t,c,!0),e))}}}}},79828:(t,e,n)=>{"use strict";n.d(e,{V:()=>o});var r=n(87311),i=n(69779),a=n(64113);const o={kernelName:r.tG8,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,a.y)(t,(0,i.w)(n,"float32"))}}}},37391:(t,e,n)=>{"use strict";n.d(e,{S:()=>a});var r=n(87311),i=n(19530);const a={kernelName:r.ySp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,a]=e,{filterSize:o,strides:s,pad:c,dimRoundingMode:u}=n;return{x:()=>(0,i.s)(t,r,a,o,s,c,u)}}}},36818:(t,e,n)=>{"use strict";n.d(e,{P:()=>a});var r=n(87311),i=n(3768);const a={kernelName:r.t3d,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,a]=e,{filterSize:o,strides:s,pad:c}=n;return{x:()=>(0,i.d)(t,r,a,o,s,c)}}}},45144:(t,e,n)=>{"use strict";n.d(e,{n:()=>o});var r=n(87311),i=n(23869),a=n(38360);const o={kernelName:r.VAI,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{reductionIndices:o}=r,s=e[0],c=e[1],u=i.Y6(o,s.shape),l=(0,a.v)(t,c,s,u);return{x:()=>l.x()}}}},1560:(t,e,n)=>{"use strict";n.d(e,{p:()=>c});var r=n(87311),i=n(69779),a=n(39103),o=n(72969),s=n(86272);const c={kernelName:r.LDN,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>(0,s.l)(t,(0,i.w)((0,a.D)(n,r),"float32")),b:()=>(0,s.l)(t,(0,i.w)((0,o.M)(n,r),"float32"))}}}},66313:(t,e,n)=>{"use strict";n.d(e,{k:()=>l});var r=n(87311),i=n(58724),a=n(64113),o=n(86272),s=n(88865),c=n(89068),u=n(23869);const l={kernelName:r.g5A,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:l}=n,h=u.Y6(l,r.shape),d=(0,i.lb)(r.shape,h)[1],f=u.Ze(d);return{x:()=>{const e=r.shape.slice();h.forEach((t=>{e[t]=1}));const n=(0,c.t)(t,e);return(0,a.y)((0,o.l)(n,(0,s.S)(r.shape,"float32")),f)}}}}},33450:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var r=n(87311),i=n(23869),a=n(38360);const o={kernelName:r.lNG,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{axis:o}=r,[s,c]=e,u=i.Y6(o,s.shape),l=(0,a.v)(t,c,s,u);return{x:()=>l.x()}}}},41530:(t,e,n)=>{"use strict";n.d(e,{$:()=>c});var r=n(87311),i=n(69779),a=n(60228),o=n(64210),s=n(86272);const c={kernelName:r.LG0,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>(0,s.l)(t,(0,i.w)((0,o.I)(n,r),"float32")),b:()=>(0,s.l)(t,(0,i.w)((0,a.r)(n,r),"float32"))}}}},70306:(t,e,n)=>{"use strict";n.d(e,{P:()=>a});var r=n(87311),i=n(8016);const a={kernelName:r.x7F,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:a}=n,o=a.map((t=>t[0]));return{x:()=>(0,i.d)(t,o,r.shape)}}}},73330:(t,e,n)=>{"use strict";n.d(e,{$:()=>h});var r=n(87311),i=n(84824),a=n(64113),o=n(96812),s=n(86272),c=n(5008),u=n(89068),l=n(17937);const h={kernelName:r.BLA,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,h=(0,i.assertAndGetBroadcastShape)(n.shape,r.shape);return{a:()=>{const e=(0,i.getReductionAxes)(n.shape,h);return e.length>0?(0,u.t)((0,l.c)(t,e),n.shape):t},b:()=>{const e=(0,s.l)(t,(0,c.H)((0,o.R)((0,a.y)(n,r)))),d=(0,i.getReductionAxes)(r.shape,h);return d.length>0?(0,u.t)((0,l.c)(e,d),r.shape):e}}}}},96454:(t,e,n)=>{"use strict";n.d(e,{r:()=>u});var r=n(87311),i=n(84824),a=n(69779),o=n(86272),s=n(89068),c=n(17937);const u={kernelName:r.xu7,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,u=(0,i.assertAndGetBroadcastShape)(n.shape,r.shape);return{a:()=>{const e=(0,o.l)(t,(0,a.w)(r,"float32")),l=(0,i.getReductionAxes)(n.shape,u);return l.length>0?(0,s.t)((0,c.c)(e,l),n.shape):e},b:()=>{const e=(0,o.l)(t,(0,a.w)(n,"float32")),l=(0,i.getReductionAxes)(r.shape,u);return l.length>0?(0,s.t)((0,c.c)(e,l),r.shape):e}}}}},74488:(t,e,n)=>{"use strict";n.d(e,{h:()=>a});var r=n(87311),i=n(5008);const a={kernelName:r.l0G,gradFunc:t=>({x:()=>(0,i.H)(t)})}},4915:(t,e,n)=>{"use strict";n.d(e,{U:()=>a});var r=n(87311),i=n(38197);const a={kernelName:r.urI,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>(0,i.U)(n.shape,"float32")}}}},99312:(t,e,n)=>{"use strict";n.d(e,{P:()=>a});var r=n(87311),i=n(90043);const a={kernelName:r.LWX,gradFunc:t=>({x:()=>(0,i.P)(t)})}},64633:(t,e,n)=>{"use strict";n.d(e,{I:()=>a});var r=n(87311),i=n(84491);const a={kernelName:r.mM$,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:r}=n;return(0,i.K)(t,r).map((t=>()=>t))}}},64265:(t,e,n)=>{"use strict";n.d(e,{M:()=>a});var r=n(87311),i=n(8016);const a={kernelName:r.ODT,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:a}=n,o=a.map((t=>t[0]));return{x:()=>(0,i.d)(t,o,r.shape)}}}},74744:(t,e,n)=>{"use strict";n.d(e,{d:()=>m});var r=n(87311),i=n(84824),a=n(69779),o=n(60228),s=n(18688),c=n(86272),u=n(78188),l=n(89068),h=n(90844),d=n(77820),f=n(17937),p=n(52117),g=n(90043);const m={kernelName:r.pyJ,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,r,m]=e,v=n,y=r,b=i.assertAndGetBroadcastShape(v.shape,y.shape);return{a:()=>{const e=(0,a.w)(y,"float32");let n=(0,c.l)(t,(0,c.l)(e,(0,u.n)(v,(0,d.j)(e,(0,h.d)(1)))));const r=i.getReductionAxes(v.shape,b);return r.length>0&&(n=(0,f.c)(n,r)),(0,l.t)(n,v.shape)},b:()=>{const e=(0,o.r)(v,0),n=(0,p._)(e,(0,s.R)(v),(0,g.P)(v));let r=(0,c.l)(t,(0,c.l)(m,n));const a=i.getReductionAxes(y.shape,b);return a.length>0&&(r=(0,f.c)(r,a)),(0,l.t)(r,y.shape)}}}}},408:(t,e,n)=>{"use strict";n.d(e,{t:()=>h});var r=n(87311),i=n(84824),a=n(60228),o=n(86272),s=n(89068),c=n(17937),u=n(52117),l=n(90043);const h={kernelName:r.Ncv,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,r]=e,h=(0,a.r)(n,0);return{x:()=>(0,u._)(h,t,(0,o.l)(t,r)),alpha:()=>{let e=(0,u._)(h,(0,l.P)(t),(0,o.l)(t,n));const a=(0,i.getReductionAxes)(r.shape,t.shape);return a.length>0&&(e=(0,c.c)(e,a)),(0,s.t)(e,r.shape)}}}}},96189:(t,e,n)=>{"use strict";n.d(e,{a:()=>l});var r=n(58724),i=n(87311),a=n(79808),o=n(86272),s=n(89068),c=n(15977);function u(t,e,n){const i=t.shape.length,u=i-n.length,l=r.Em(n,i);let h=t;null!=l&&(h=(0,c.m)(t,l));const d=h.shape.slice(),f=d.splice(i-n.length,n.length).reduce(((t,e)=>t*e),1);d.push(f);let p=function(t,e,n){const r=t.shape.slice();r[n]=1;const i=(0,s.t)(e,r),c=(0,a.L)(t,n,!0,!1),u=(0,a.L)(t,n,!0,!0),l=(0,o.l)(c,u);return(0,o.l)(i,l)}(h.reshape(d),e,u);if(p=p.reshape(h.shape),null!=l){const t=r.gx(l);p=(0,c.m)(p,t)}return p}const l={kernelName:i.kdj,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:i}=n;let a=[];return a=void 0===i||null===i?r.shape.map(((t,e)=>e)):"number"===typeof i?[i]:i,{x:()=>u(r,t,a)}}}},94131:(t,e,n)=>{"use strict";n.d(e,{g:()=>d});var r=n(87311),i=n(84824),a=n(69779),o=n(64113),s=n(86272),c=n(5008),u=n(89068),l=n(95195),h=n(17937);const d={kernelName:r.sDr,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,d=i.assertAndGetBroadcastShape(n.shape,r.shape);return{a:()=>{const e=(0,o.y)(t,(0,a.w)(r,"float32")),s=i.getReductionAxes(n.shape,d);return s.length>0?(0,u.t)((0,h.c)(e,s),n.shape):e},b:()=>{let e=(0,s.l)(t,(0,a.w)(n,"float32"));const f=i.getReductionAxes(r.shape,d);f.length>0&&(e=(0,u.t)((0,h.c)(e,f),r.shape));const p=(0,l.E)(r);return(0,c.H)((0,o.y)(e,(0,a.w)(p,"float32")))}}}}},56770:(t,e,n)=>{"use strict";n.d(e,{j:()=>s});var r=n(87311),i=n(64113),a=n(5008),o=n(95195);const s={kernelName:r.huO,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,i.y)(t,(0,a.H)((0,o.E)(n)))}}}},32718:(t,e,n)=>{"use strict";n.d(e,{p:()=>c});var r=n(87311),i=n(69779),a=n(64210),o=n(86272),s=n(52946);const c={kernelName:r.P_L,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=(0,o.l)((0,a.I)(n,6),(0,s.P)(n));return{x:()=>(0,o.l)(t,(0,i.w)(r,"float32"))}}}},90248:(t,e,n)=>{"use strict";n.d(e,{T:()=>s});var r=n(87311),i=n(69779),a=n(86272),o=n(52946);const s={kernelName:r.fUj,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,a.l)(t,(0,i.w)((0,o.P)(n),"float32"))}}}},95276:(t,e,n)=>{"use strict";n.d(e,{x:()=>a});var r=n(87311),i=n(89068);const a={kernelName:r.R23,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,i.t)(t,n.shape)}}}},6806:(t,e,n)=>{"use strict";n.d(e,{j:()=>a});var r=n(37484),i=n(87311);const a={kernelName:i.hgw,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[a]=e,o={dy:t,images:a};return{images:()=>r.T2.runKernel(i.FCQ,o,n)}}}},26118:(t,e,n)=>{"use strict";n.d(e,{n:()=>a});var r=n(37484),i=n(87311);const a={kernelName:i.jOE,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[a]=e,o={dy:t,images:a};return{images:()=>r.T2.runKernel(i.XQy,o,n)}}}},78816:(t,e,n)=>{"use strict";n.d(e,{D:()=>o});var r=n(87311),i=n(23540),a=n(23869);const o={kernelName:r.D7i,gradFunc:(t,e,n)=>{const{dims:r}=n,o=(0,a.Y6)(r,t.shape);return{x:()=>(0,i.B)(t,o)}}}},51630:(t,e,n)=>{"use strict";n.d(e,{v:()=>a});var r=n(87311),i=n(90043);const a={kernelName:r.hVg,gradFunc:t=>({x:()=>(0,i.P)(t)})}},56354:(t,e,n)=>{"use strict";n.d(e,{$:()=>c});var r=n(87311),i=n(64113),a=n(86272),o=n(5008),s=n(78188);const c={kernelName:r.TOR,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,o.H)((0,i.y)(t,(0,a.l)((0,s.n)(n,1.5),2)))}}}},19070:(t,e,n)=>{"use strict";n.d(e,{D:()=>c});var r=n(87311),i=n(69779),a=n(87375),o=n(86272),s=n(90043);const c={kernelName:r.l6P,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>(0,i.w)((0,s.P)(n),"float32"),t:()=>(0,o.l)(t,(0,i.w)(n,t.dtype)),e:()=>(0,o.l)(t,(0,i.w)((0,a.N)(n),t.dtype))}}}},22731:(t,e,n)=>{"use strict";n.d(e,{O:()=>h});var r=n(87311),i=n(69779),a=n(48389),o=n(60228),s=n(86272),c=n(90844),u=n(84102),l=n(52117);const h={kernelName:r.u$b,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=(0,o.r)(n,(0,c.d)(0)),r=(0,c.d)(u.j),h=(0,c.d)(u.X),d=(0,s.l)(t,h),f=(0,s.l)((0,s.l)(t,r),(0,a.o)((0,i.w)(n,"float32")));return(0,l._)(e,d,f)}}}}},72070:(t,e,n)=>{"use strict";n.d(e,{H:()=>s});var r=n(87311),i=n(86272),a=n(90844),o=n(77820);const s={kernelName:r.vI1,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,i.l)(t,(0,i.l)(n,(0,o.j)((0,a.d)(1),n)))}}}},68537:(t,e,n)=>{"use strict";n.d(e,{q:()=>a});var r=n(87311),i=n(90043);const a={kernelName:r.YVe,gradFunc:t=>({x:()=>(0,i.P)(t)})}},37660:(t,e,n)=>{"use strict";n.d(e,{V:()=>s});var r=n(87311),i=n(69779),a=n(48133),o=n(86272);const s={kernelName:r.hql,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,o.l)((0,a.g)((0,i.w)(n,"float32")),t)}}}},30672:(t,e,n)=>{"use strict";n.d(e,{l:()=>s});var r=n(87311),i=n(69779),a=n(84033),o=n(86272);const s={kernelName:r.J3C,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,o.l)((0,a.y)((0,i.w)(n,"float32")),t)}}}},45428:(t,e,n)=>{"use strict";n.d(e,{d:()=>o});var r=n(87311),i=n(67507),a=n(48791);const o={kernelName:r.JiE,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{begin:o,size:s}=n,c=r.shape,[u,l]=(0,a.parseSliceParams)(r,o,s),h=[];for(let i=0;i<t.rank;i++)h.push([u[i],c[i]-u[i]-l[i]]);return{x:()=>(0,i.e)(t,h)}}}},68064:(t,e,n)=>{"use strict";n.d(e,{X:()=>s});var r=n(87311),i=n(86272),a=n(77820),o=n(17937);const s={kernelName:r.rFG,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{dim:s}=n,c=(0,i.l)(t,r);return{logits:()=>(0,a.j)(c,(0,i.l)((0,o.c)(c,[s],true),r))}}}},34142:(t,e,n)=>{"use strict";n.d(e,{F:()=>o});var r=n(87311),i=n(86272),a=n(1242);const o={kernelName:r.Fin,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,i.l)(t,(0,a.r)(n))}}}},31787:(t,e,n)=>{"use strict";n.d(e,{Y:()=>a});var r=n(87311),i=n(81406);const a={kernelName:r.A8B,gradFunc:(t,e,n)=>{const{blockShape:r,paddings:a}=n;return{x:()=>(0,i.G)(t,r,a)}}}},13428:(t,e,n)=>{"use strict";n.d(e,{n:()=>a});var r=n(87311),i=n(89360);const a={kernelName:r.Blb,gradFunc:(t,e,n)=>{const{axis:r}=n;return{x:()=>(0,i.x)(t,r)}}}},46456:(t,e,n)=>{"use strict";n.d(e,{V:()=>c});var r=n(87311),i=n(69779),a=n(64113),o=n(86272),s=n(45766);const c={kernelName:r.dFH,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,a.y)(t,(0,o.l)((0,s.R)((0,i.w)(n,"float32")),2))}}}},18003:(t,e,n)=>{"use strict";n.d(e,{M:()=>o});var r=n(87311),i=n(69779),a=n(86272);const o={kernelName:r.M6A,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,a.l)(t,(0,a.l)((0,i.w)(n,"float32"),2))}}}},39600:(t,e,n)=>{"use strict";n.d(e,{b:()=>s});var r=n(87311),i=n(86272),a=n(90844),o=n(77820);const s={kernelName:r.Ddj,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=(0,a.d)(2);return{a:()=>(0,i.l)(t,(0,i.l)(s,(0,o.j)(n,r))),b:()=>(0,i.l)(t,(0,i.l)(s,(0,o.j)(r,n)))}}}},21972:(t,e,n)=>{"use strict";n.d(e,{f:()=>a});var r=n(87311),i=n(90043);const a={kernelName:r.pnw,gradFunc:t=>({x:()=>(0,i.P)(t)})}},15156:(t,e,n)=>{"use strict";n.d(e,{p:()=>c});var r=n(87311),i=n(84824),a=n(5008),o=n(89068),s=n(17937);const c={kernelName:r.PbM,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,c=i.assertAndGetBroadcastShape(n.shape,r.shape);return{a:()=>{let e=t;const r=i.getReductionAxes(n.shape,c);return r.length>0&&(e=(0,s.c)(e,r)),(0,o.t)(e,n.shape)},b:()=>{let e=t;const n=i.getReductionAxes(r.shape,c);return n.length>0&&(e=(0,s.c)(e,n)),(0,o.t)((0,a.H)(e),r.shape)}}}}},14087:(t,e,n)=>{"use strict";n.d(e,{m:()=>c});var r=n(87311),i=n(86272),a=n(88865),o=n(89068),s=n(23869);const c={kernelName:r.WuN,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,c=r.shape.slice(),{axis:u}=n;(0,s.Y6)(u,r.shape).forEach((t=>{c[t]=1}));const l=(0,o.t)(t,c),h=(0,i.l)(l,(0,a.S)(r.shape,"float32"));return{x:()=>h}}}},26295:(t,e,n)=>{"use strict";n.d(e,{k:()=>s});var r=n(87311),i=n(48133),a=n(64113),o=n(95195);const s={kernelName:r.oFs,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,a.y)(t,(0,o.E)((0,i.g)(n)))}}}},4833:(t,e,n)=>{"use strict";n.d(e,{w:()=>c});var r=n(87311),i=n(86272),a=n(90844),o=n(95195),s=n(77820);const c={kernelName:r.iuW,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,i.l)((0,s.j)((0,a.d)(1),(0,o.E)(n)),t)}}}},65474:(t,e,n)=>{"use strict";n.d(e,{X:()=>s});var r=n(87311),i=n(67281),a=n(8016),o=n(90043);const s={kernelName:r.FAs,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{reps:s}=n;return{x:()=>{let e=(0,o.P)(r);if(1===r.rank)for(let n=0;n<s[0];++n)e=(0,i.W)(e,(0,a.d)(t,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(let n=0;n<s[0];++n)for(let o=0;o<s[1];++o)e=(0,i.W)(e,(0,a.d)(t,[n*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(let n=0;n<s[0];++n)for(let o=0;o<s[1];++o)for(let c=0;c<s[2];++c)e=(0,i.W)(e,(0,a.d)(t,[n*r.shape[0],o*r.shape[1],c*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(r.rank," tensors yet."));for(let n=0;n<s[0];++n)for(let o=0;o<s[1];++o)for(let c=0;c<s[2];++c)for(let u=0;u<s[3];++u)e=(0,i.W)(e,(0,a.d)(t,[n*r.shape[0],o*r.shape[1],c*r.shape[2],u*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return e}}}}},25347:(t,e,n)=>{"use strict";n.d(e,{m:()=>o});var r=n(87311),i=n(58724),a=n(15977);const o={kernelName:r.wx0,gradFunc:(t,e,n)=>{const r=n,{perm:o}=r,s=i.gx(o);return{x:()=>(0,a.m)(t,s)}}}},57048:(t,e,n)=>{"use strict";n.d(e,{t:()=>a});var r=n(87311),i=n(22190);const a={kernelName:r.dXR,gradFunc:(t,e,n)=>{const r=n,{axis:a}=r;return{value:()=>(0,i.t)(t,a)}}}},44232:(t,e,n)=>{"use strict";n.d(e,{h:()=>f});var r=n(87311),i=n(70816),a=n(50511),o=n(39103),s=n(21183),c=n(98104),u=n(88865),l=n(90844),h=n(52117),d=n(90043);const f={kernelName:r.pPe,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>function(t,e){const n=(0,c.P)(e,(0,d.P)(e)),r=(0,a.k)(t,n);let f=(0,o.D)(e,(0,l.d)(0,"int32"));const p=r.rank-f.rank;for(let a=0;a<p;++a)f=(0,i.U)(f,a+1);f=(0,s.n)(f,(0,u.S)(r.shape,"bool"));const g=(0,d.P)(r);return(0,h._)(f,r,g)}(t,n)}}}},66086:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(87311),i=n(90043);const a={kernelName:r.xJ3,gradFunc:t=>({x:()=>(0,i.P)(t)})}},38360:(t,e,n)=>{"use strict";n.d(e,{v:()=>c});var r=n(58724),i=n(69779),a=n(92138),o=n(86272),s=n(89068);function c(t,e,n,c){return e.rank<n.rank&&(e=(0,s.t)(e,r.SM(e.shape,c))),t.rank<n.rank&&(t=(0,s.t)(t,r.SM(t.shape,c))),{x:()=>(0,o.l)(t,(0,i.w)((0,a.L)(n,e),t.dtype))}}},76544:(t,e,n)=>{"use strict";n.d(e,{D:()=>i});var r=n(73837);class i{static join(t){return new i(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,null==t)return;if(t instanceof Array||(t=[t]),0===(t=t.map((t=>r.isTypedArray(t)?t.buffer:t))).length)return;this.bufferUniformSize=t[0].byteLength;let e=0;for(let n=0;n<t.length;n++){const r=t[n];n!==t.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=e+r.byteLength;this.shards.push({buffer:r,start:e,end:i}),e=i}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength;if(0===this.shards.length)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,e=isNaN(Number(e))?0:e,t=Math.max(0,t),e=Math.min(this.byteLength,e),e<=t)return new ArrayBuffer(0);const n=this.findShardForByte(t);if(-1===n)throw new Error("Could not find start shard for byte ".concat(t));const r=new ArrayBuffer(e-t),i=new Uint8Array(r);let a=0;for(let o=n;o<this.shards.length;o++){const n=this.shards[o],r=t+a-n.start,s=a,c=Math.min(e,n.end)-n.start,u=new Uint8Array(n.buffer,r,c-r);if(i.set(u,s),a+=u.length,e<n.end)break}return r}findShardForByte(t){if(0===this.shards.length||t<0||t>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function e(e){return t<e.start?-1:t>=e.end?1:0}if(0===e(this.shards[this.previousShardIndex]))return this.previousShardIndex;const n=function(t,e){let n=0,r=t.length;for(;n<=r;){const i=Math.floor((r-n)/2)+n,a=e(t[i]);if(0===a)return i;a<0?r=i:n=i+1}return-1}(this.shards,e);return-1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)}}},59624:(t,e,n)=>{"use strict";n.d(e,{lQ:()=>p,mn:()=>d});n(41130);var r=n(89e3),i=n(92834),a=n(93131),o=n(76544);const s="tensorflowjs",c="models_store",u="model_info_store";function l(){if(!(0,r._K)().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t="undefined"===typeof window?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function h(t){const e=t.result;e.createObjectStore(c,{keyPath:"modelPath"}),e.createObjectStore(u,{keyPath:"modelPath"})}class d{constructor(t){if(this.indexedDB=l(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,e){return new Promise(((t,n)=>{const r=this.indexedDB.open(s,1);r.onupgradeneeded=()=>h(r),r.onsuccess=()=>{const a=r.result;if(null==e){const e=a.transaction(c,"readonly"),r=e.objectStore(c).get(this.modelPath);r.onsuccess=()=>{if(null==r.result)return a.close(),n(new Error("Cannot find model with path '".concat(this.modelPath,"' ")+"in IndexedDB."));t(r.result.modelArtifacts)},r.onerror=t=>(a.close(),n(r.error)),e.oncomplete=()=>a.close()}else{e.weightData=o.D.join(e.weightData);const r=(0,i.oR)(e),l=a.transaction(u,"readwrite");let h,d,f=l.objectStore(u);try{h=f.put({modelPath:this.modelPath,modelArtifactsInfo:r})}catch(s){return n(s)}h.onsuccess=()=>{d=a.transaction(c,"readwrite");const i=d.objectStore(c);let o;try{o=i.put({modelPath:this.modelPath,modelArtifacts:e,modelArtifactsInfo:r})}catch(s){return n(s)}o.onsuccess=()=>t({modelArtifactsInfo:r}),o.onerror=t=>{f=l.objectStore(u);const e=f.delete(this.modelPath);e.onsuccess=()=>(a.close(),n(o.error)),e.onerror=t=>(a.close(),n(o.error))}},h.onerror=t=>(a.close(),n(h.error)),l.oncomplete=()=>{null==d?a.close():d.oncomplete=()=>a.close()}}},r.onerror=t=>n(r.error)}))}}d.URL_SCHEME="indexeddb://";const f=t=>{return(0,r._K)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(d.URL_SCHEME)?(e=t.slice(d.URL_SCHEME.length),new d(e)):null;var e};a.bM.registerSaveRouter(f),a.bM.registerLoadRouter(f);class p{constructor(){this.indexedDB=l()}async listModels(){return new Promise(((t,e)=>{const n=this.indexedDB.open(s,1);n.onupgradeneeded=()=>h(n),n.onsuccess=()=>{const r=n.result,i=r.transaction(u,"readonly"),a=i.objectStore(u).getAll();a.onsuccess=()=>{const e={};for(const t of a.result)e[t.modelPath]=t.modelArtifactsInfo;t(e)},a.onerror=t=>(r.close(),e(a.error)),i.oncomplete=()=>r.close()},n.onerror=t=>e(n.error)}))}async removeModel(t){var e;return t=(e=t).startsWith(d.URL_SCHEME)?e.slice(d.URL_SCHEME.length):e,new Promise(((e,n)=>{const r=this.indexedDB.open(s,1);r.onupgradeneeded=()=>h(r),r.onsuccess=()=>{const i=r.result,a=i.transaction(u,"readwrite"),o=a.objectStore(u),s=o.get(t);let l;s.onsuccess=()=>{if(null==s.result)return i.close(),n(new Error("Cannot find model with path '".concat(t,"' ")+"in IndexedDB."));{const r=o.delete(t),a=()=>{l=i.transaction(c,"readwrite");const r=l.objectStore(c).delete(t);r.onsuccess=()=>e(s.result.modelArtifactsInfo),r.onerror=t=>n(s.error)};r.onsuccess=a,r.onerror=t=>(a(),i.close(),n(s.error))}},s.onerror=t=>(i.close(),n(s.error)),a.oncomplete=()=>{null==l?i.close():l.oncomplete=()=>i.close()}},r.onerror=t=>n(r.error)}))}}},92834:(t,e,n)=>{"use strict";n.d(e,{AQ:()=>_,CY:()=>d,Ej:()=>E,P8:()=>A,Rl:()=>S,Xf:()=>N,aG:()=>h,jf:()=>k,l3:()=>w,oR:()=>T,s5:()=>v,zV:()=>C});var r=n(76234),i=n(98869),a=n(23869),o=n(64511),s=n(76544),c=n(23129),u=n(89e3);const l=4;async function h(t,e){const n=[],r=[],i=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);for(let a=0;a<i.length;++a){const o=i[a],s=Array.isArray(t)?t[a].tensor:t[o];if("float32"!==s.dtype&&"int32"!==s.dtype&&"bool"!==s.dtype&&"string"!==s.dtype&&"complex64"!==s.dtype)throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(s.dtype));const c={name:o,shape:s.shape,dtype:s.dtype};if("string"===s.dtype){const t=new Promise((async t=>{const e=await s.bytes(),n=e.reduce(((t,e)=>t+e.length),0)+l*e.length,r=new Uint8Array(n);let i=0;for(let a=0;a<e.length;a++){const t=e[a],n=new Uint8Array(new Uint32Array([t.length]).buffer);r.set(n,i),i+=l,r.set(t,i),i+=t.length}t(r)}));r.push(t)}else r.push(s.data());null!=e&&(c.group=e),n.push(c)}return{data:y(await Promise.all(r)),specs:n}}function d(t,e){const n=new s.D(t),r={};let i=0;for(const a of e){const t=f(a,((t,e)=>n.slice(i+t,i+e)));r[a.name]=g(a,n.slice(i,i+t)),i+=t}return r}function f(t,e){const n=(0,a.Ze)(t.shape);let r;if("quantization"in t){const e=t.quantization;r=o.i[e.dtype]}else{if("string"===t.dtype){let t=0;for(let r=0;r<n;r++)t+=l+new Uint32Array(e(t,t+l))[0];return t}r=o.i[t.dtype]}return n*r}async function p(t,e){const n=(0,a.Ze)(t.shape);let r;if("quantization"in t){const e=t.quantization;r=o.i[e.dtype]}else{if("string"===t.dtype){let t=0;for(let r=0;r<n;r++)t+=l+new Uint32Array(await e(t,t+l))[0];return t}r=o.i[t.dtype]}return n*r}function g(t,e){const n=t.name,s=t.dtype,c=t.shape,u=(0,a.Ze)(c);let h,d=0;if("quantization"in t){const r=t.quantization;if("uint8"===r.dtype||"uint16"===r.dtype){if(!("min"in r)||!("scale"in r))throw new Error("Weight ".concat(t.name," with quantization ").concat(r.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==r.dtype)throw new Error("Weight ".concat(t.name," has unknown ")+"quantization dtype ".concat(r.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==s)throw new Error("Weight ".concat(t.name," is quantized with ").concat(r.dtype," ")+"which only supports weights of type float32 not ".concat(s,"."))}const i=o.i[r.dtype],a="uint8"===r.dtype?new Uint8Array(e):new Uint16Array(e);if("float32"===s)if("uint8"===r.dtype||"uint16"===r.dtype){h=new Float32Array(a.length);for(let t=0;t<a.length;t++){const e=a[t];h[t]=e*r.scale+r.min}}else{if("float16"!==r.dtype)throw new Error("Unsupported quantization type ".concat(r.dtype," ")+"for weight type float32.");{const t=function(){const t=function(){const t=t=>{let e=t<<13,n=0;for(;0===(8388608&e);)n-=8388608,e<<=1;return e&=-8388609,n+=947912704,e|n},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}(),e=function(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}(),n=function(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}();return r=>{const i=new ArrayBuffer(4*r.length),a=new Uint32Array(i);for(let o=0;o<r.length;o++){const i=r[o],s=t[n[i>>10]+(1023&i)]+e[i>>10];a[o]=s}return new Float32Array(i)}}();h=t(a)}}else{if("int32"!==s)throw new Error("Unsupported dtype in weight '".concat(n,"': ").concat(s));if("uint8"!==r.dtype&&"uint16"!==r.dtype)throw new Error("Unsupported quantization type ".concat(r.dtype," ")+"for weight type int32.");h=new Int32Array(a.length);for(let t=0;t<a.length;t++){const e=a[t];h[t]=Math.round(e*r.scale+r.min)}}d+=u*i}else if("string"===s){const n=(0,a.Ze)(t.shape);h=[];for(let t=0;t<n;t++){const t=new Uint32Array(e.slice(d,d+l))[0];d+=l;const n=new Uint8Array(e.slice(d,d+t));h.push(n),d+=t}}else{const t=o.i[s];if("float32"===s)h=new Float32Array(e);else if("int32"===s)h=new Int32Array(e);else{if("bool"!==s){if("complex64"===s){h=new Float32Array(e);const t=new Float32Array(h.length/2),n=new Float32Array(h.length/2);for(let e=0;e<t.length;e++)t[e]=h[2*e],n[e]=h[2*e+1];const a=(0,i.O)(t,c,"float32"),o=(0,i.O)(n,c,"float32"),s=(0,r.f)(a,o);return a.dispose(),o.dispose(),s}throw new Error("Unsupported dtype in weight '".concat(n,"': ").concat(s))}h=new Uint8Array(e)}d+=u*t}return(0,i.O)(h,c,s)}async function m(t,e,n){let r=new Uint8Array(e);for(;r.byteLength<n;){const{done:e,value:i}=await t.read();if(e&&null==i){const t=n-r.byteLength;throw new Error("Reader is done but ".concat(t," bytes are still expected"))}const a=new Uint8Array(r.length+i.byteLength);a.set(r,0),a.set(new Uint8Array(i),r.length),r=a}return r.buffer}async function v(t,e){const n={},r=t.getReader();let i=new ArrayBuffer(0);for(const o of e){const t=await p(o,(async(t,e)=>(i=await m(r,i,e),i.slice(t,e))));i=await m(r,i,t);const e=i.slice(0,t);i=i.slice(t);const s=g(o,e);if(n[o.name]=s,"webgpu"===(0,c.jz)()){const t=(0,c.Hs)();"uploadToGPU"in t&&(0,a.Ze)(s.shape)>=(0,u._K)().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&t.uploadToGPU(s.dataId)}}return n}function y(t){if(null===t)throw new Error("Invalid input value: ".concat(JSON.stringify(t)));let e=0;const n=[];t.forEach((t=>{if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(t.constructor.name))}));const r=new Uint8Array(e);let i=0;return n.forEach((t=>{r.set(new Uint8Array(t.buffer),i),i+=t.byteLength})),r.buffer}const b="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function x(t){return b?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function w(t){if(b)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,i=e.length;r<i;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function k(t){if(b){const e=Buffer.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function _(t){return s.D.join(t)}function A(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);const e=t.split("/");return e[e.length-1]}function C(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return null!=t.signature&&(n.signature=t.signature),null!=t.userDefinedMetadata&&(n.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(n.modelInitializer=t.modelInitializer),null!=t.initializerSignature&&(n.initializerSignature=t.initializerSignature),null!=t.trainingConfig&&(n.trainingConfig=t.trainingConfig),n}function S(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(null!=t.trainingConfig&&(r.trainingConfig=t.trainingConfig),null!=t.weightsManifest){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return null!=t.signature&&(r.signature=t.signature),null!=t.userDefinedMetadata&&(r.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(r.modelInitializer=t.modelInitializer),null!=t.initializerSignature&&(r.initializerSignature=t.initializerSignature),r}async function E(t,e){let n,r;return null!=t.weightsManifest&&([n,r]=await e(t.weightsManifest)),S(t,n,r)}function T(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:x(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:x(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:new s.D(t.weightData).byteLength}}function N(t){const e=[];for(const n of t)e.push(...n.weights);return e}},53259:(t,e,n)=>{"use strict";n.d(e,{Cd:()=>x,ZT:()=>y});n(41130);var r=n(89e3),i=n(23869),a=n(92834),o=n(76544),s=n(93131);const c="/",u="tensorflowjs_models",l="info",h="model_topology",d="weight_specs",f="weight_data",p="model_metadata";function g(t){return{info:[u,t,l].join(c),topology:[u,t,h].join(c),weightSpecs:[u,t,d].join(c),weightData:[u,t,f].join(c),modelMetadata:[u,t,p].join(c)}}function m(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function v(t){const e=t.split(c);if(e.length<3)throw new Error("Invalid key format: ".concat(t));return e.slice(1,e.length-1).join(c)}class y{constructor(t){if(!(0,r._K)().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=g(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),i=(0,a.oR)(t),s=o.D.join(t.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,(0,a.l3)(s));const e={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:null!=t.signature?t.signature:void 0,userDefinedMetadata:null!=t.userDefinedMetadata?t.userDefinedMetadata:void 0,modelInitializer:null!=t.modelInitializer?t.modelInitializer:void 0,initializerSignature:null!=t.initializerSignature?t.initializerSignature:void 0,trainingConfig:null!=t.trainingConfig?t.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(e)),{modelArtifactsInfo:i}}catch(e){throw m(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(i.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(i.weightSpecsBytes,", ")+"weightDataBytes=".concat(i.weightDataBytes,"."))}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(null==t)throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const e={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");e.modelTopology=n;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");e.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(null!=i){const t=JSON.parse(i);e.format=t.format,e.generatedBy=t.generatedBy,e.convertedBy=t.convertedBy,null!=t.signature&&(e.signature=t.signature),null!=t.userDefinedMetadata&&(e.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(e.modelInitializer=t.modelInitializer),null!=t.initializerSignature&&(e.initializerSignature=t.initializerSignature),null!=t.trainingConfig&&(e.trainingConfig=t.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(null==o)throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));return e.weightData=(0,a.jf)(o),e}}y.URL_SCHEME="localstorage://";const b=t=>{return(0,r._K)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(y.URL_SCHEME)?(e=t.slice(y.URL_SCHEME.length),new y(e)):null;var e};s.bM.registerSaveRouter(b),s.bM.registerLoadRouter(b);class x{constructor(){(0,i.vA)((0,r._K)().getBool("IS_BROWSER"),(()=>"Current environment is not a web browser")),(0,i.vA)("undefined"===typeof window||"undefined"!==typeof window.localStorage,(()=>"Current browser does not appear to support localStorage")),this.LS=window.localStorage}async listModels(){const t={},e=u+c,n=c+l;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);if(i.startsWith(e)&&i.endsWith(n)){t[v(i)]=JSON.parse(this.LS.getItem(i))}}return t}async removeModel(t){var e;const n=g(t=(e=t).startsWith(y.URL_SCHEME)?e.slice(y.URL_SCHEME.length):e);if(null==this.LS.getItem(n.info))throw new Error("Cannot find model at path '".concat(t,"'"));const r=JSON.parse(this.LS.getItem(n.info));return m(n),r}}},69897:(t,e,n)=>{"use strict";n.d(e,{D:()=>u,Vo:()=>d,az:()=>l,dy:()=>o,xk:()=>h});var r=n(23869),i=n(93131);const a="://";class o{constructor(){this.managers={}}static getInstance(){return null==o.instance&&(o.instance=new o),o.instance}static registerManager(t,e){(0,r.vA)(null!=t,(()=>"scheme must not be undefined or null.")),t.endsWith(a)&&(t=t.slice(0,t.indexOf(a))),(0,r.vA)(t.length>0,(()=>"scheme must not be an empty string."));const n=o.getInstance();(0,r.vA)(null==n.managers[t],(()=>"A model store manager is already registered for scheme '".concat(t,"'."))),n.managers[t]=e}static getManager(t){const e=o.getInstance().managers[t];if(null==e)throw new Error("Cannot find model manager for scheme '".concat(t,"'"));return e}static getSchemes(){return Object.keys(o.getInstance().managers)}}function s(t){if(-1===t.indexOf(a))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(o.getSchemes().join(",")));return{scheme:t.split(a)[0],path:t.split(a)[1]}}async function c(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(0,r.vA)(t!==e,(()=>"Old path and new path are the same: '".concat(t,"'")));const a=i.bM.getLoadHandlers(t);(0,r.vA)(a.length>0,(()=>"Copying failed because no load handler is found for source URL ".concat(t,"."))),(0,r.vA)(a.length<2,(()=>"Copying failed because more than one (".concat(a.length,") ")+"load handlers for source URL ".concat(t,".")));const c=a[0],u=i.bM.getSaveHandlers(e);(0,r.vA)(u.length>0,(()=>"Copying failed because no save handler is found for destination "+"URL ".concat(e,"."))),(0,r.vA)(u.length<2,(()=>"Copying failed because more than one (".concat(a.length,") ")+"save handlers for destination URL ".concat(e,".")));const l=u[0],h=s(t).scheme,d=s(t).path,f=h===s(t).scheme,p=await c.load();n&&f&&await o.getManager(h).removeModel(d);const g=await l.save(p);return n&&!f&&await o.getManager(h).removeModel(d),g.modelArtifactsInfo}async function u(){const t=o.getSchemes(),e={};for(const n of t){const t=await o.getManager(n).listModels();for(const r in t){e[n+a+r]=t[r]}}return e}async function l(t){const e=s(t);return o.getManager(e.scheme).removeModel(e.path)}async function h(t,e){return c(t,e,!1)}async function d(t,e){return c(t,e,!0)}},93131:(t,e,n)=>{"use strict";n.d(e,{C9:()=>s,R4:()=>a,Yd:()=>i,bM:()=>r,x3:()=>o});class r{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==r.instance&&(r.instance=new r),r.instance}static registerSaveRouter(t){r.getInstance().saveRouters.push(t)}static registerLoadRouter(t){r.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return r.getHandlers(t,"save")}static getLoadHandlers(t,e){return r.getHandlers(t,"load",e)}static getHandlers(t,e,n){const i=[];return("load"===e?r.getInstance().loadRouters:r.getInstance().saveRouters).forEach((e=>{const r=e(t,n);null!==r&&i.push(r)})),i}}const i=t=>r.registerSaveRouter(t),a=t=>r.registerLoadRouter(t),o=t=>r.getSaveHandlers(t),s=(t,e)=>r.getLoadHandlers(t,e)},64511:(t,e,n)=>{"use strict";n.d(e,{i:()=>r});const r={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8}},87311:(t,e,n)=>{"use strict";n.d(e,{$dB:()=>I,$jE:()=>nn,$zE:()=>D,A1h:()=>z,A8B:()=>We,BK4:()=>yn,BLA:()=>Zt,BRl:()=>at,Blb:()=>Ve,BoJ:()=>He,BxF:()=>ht,C8s:()=>Ge,CQC:()=>pe,Cg$:()=>Ft,CwD:()=>Et,D7i:()=>Se,Ddj:()=>Qe,Dr:()=>bn,DvZ:()=>Xe,E3$:()=>_t,EkD:()=>s,ElG:()=>ft,EwU:()=>hn,FAs:()=>sn,FCQ:()=>Ae,FSt:()=>u,Fin:()=>Pe,GZp:()=>$e,HNs:()=>A,Ik2:()=>k,J3C:()=>ze,JiE:()=>Oe,Jp_:()=>l,KXH:()=>E,L6G:()=>Ye,LB5:()=>C,LDN:()=>Ut,LG0:()=>Kt,LRy:()=>ve,LWX:()=>ae,LXA:()=>Mt,M6A:()=>Ze,MRQ:()=>V,Mn0:()=>P,MnK:()=>j,N4F:()=>_,Ncv:()=>he,O4G:()=>mt,OAQ:()=>xt,ODT:()=>ce,OMN:()=>o,ORI:()=>K,PH8:()=>a,P_L:()=>Ce,Pah:()=>nt,PbM:()=>rn,Q6t:()=>me,QDP:()=>T,QKF:()=>d,Qgm:()=>et,R23:()=>xe,RMm:()=>pn,RUm:()=>Dt,RW8:()=>Ot,RXX:()=>Vt,SDM:()=>ne,SQl:()=>lt,T7M:()=>wn,TBb:()=>cn,TL8:()=>Ht,TMz:()=>G,TOR:()=>Te,ToN:()=>Lt,TyE:()=>p,UcO:()=>Je,VAI:()=>jt,VCH:()=>y,Vvy:()=>i,WRv:()=>Pt,WT3:()=>$t,WuN:()=>Ue,X$8:()=>Y,X0$:()=>Ct,X4r:()=>Fe,XQy:()=>ke,XhZ:()=>vt,XmO:()=>J,YAb:()=>tn,YVe:()=>Be,ZgB:()=>dt,Zl4:()=>re,_s9:()=>it,aAr:()=>xn,awo:()=>vn,bCz:()=>ue,bP9:()=>Z,cHb:()=>Gt,cS:()=>b,dFH:()=>je,dLy:()=>un,dXR:()=>dn,dv8:()=>wt,e0f:()=>ie,epO:()=>f,fUj:()=>be,g5A:()=>Yt,gC7:()=>L,gIW:()=>kt,hVg:()=>Ee,hgw:()=>_e,ho8:()=>v,hql:()=>Re,huO:()=>ye,i5R:()=>pt,iGz:()=>B,iPs:()=>At,iW0:()=>en,iuW:()=>on,jAQ:()=>w,jM4:()=>Bt,jOE:()=>we,jfg:()=>R,jgd:()=>Ke,jj_:()=>U,jxD:()=>Q,kdj:()=>de,l0G:()=>te,l6P:()=>Ie,lLS:()=>yt,lNG:()=>Xt,ljI:()=>r,lxb:()=>m,lzr:()=>bt,mH5:()=>ge,mIA:()=>St,mM$:()=>se,mnI:()=>Tt,mxL:()=>gt,nVu:()=>X,nY8:()=>W,nZd:()=>It,oFs:()=>an,oJ2:()=>fe,ox3:()=>ot,p2J:()=>M,pJc:()=>Ne,pPe:()=>fn,p_m:()=>h,pk0:()=>$,pnw:()=>mn,pr3:()=>F,pyJ:()=>le,rFG:()=>qe,rFm:()=>O,rGP:()=>ut,rsH:()=>rt,sDr:()=>tt,t3d:()=>Wt,tG8:()=>Nt,tGH:()=>H,u$b:()=>Me,u8Z:()=>c,uWl:()=>De,urI:()=>oe,vI1:()=>Le,vaV:()=>N,vj7:()=>S,wNW:()=>q,wwC:()=>x,wx0:()=>ln,x7F:()=>Qt,xJ3:()=>gn,xu7:()=>Jt,yPW:()=>zt,ySp:()=>qt,ybN:()=>st,ybj:()=>ct,ylV:()=>ee,zP9:()=>g,zfU:()=>Rt});const r="Abs",i="Acos",a="Acosh",o="Add",s="AddN",c="All",u="Any",l="ArgMax",h="ArgMin",d="Asin",f="Asinh",p="Atan",g="Atanh",m="Atan2",v="AvgPool",y="AvgPoolGrad",b="AvgPool3D",x="AvgPool3DGrad",w="BatchMatMul",k="BatchToSpaceND",_="Bincount",A="BitwiseAnd",C="BroadcastTo",S="BroadcastArgs",E="Cast",T="Ceil",N="ClipByValue",F="Complex",D="ComplexAbs",I="Concat",M="Conv2D",O="Conv2DBackpropFilter",R="Conv2DBackpropInput",z="Conv3D",B="Conv3DBackpropFilterV2",L="Conv3DBackpropInputV2",P="Cos",j="Cosh",U="Cumprod",W="Cumsum",V="CropAndResize",q="DenseBincount",G="DepthToSpace",H="DepthwiseConv2dNative",Y="DepthwiseConv2dNativeBackpropFilter",X="DepthwiseConv2dNativeBackpropInput",K="Diag",Q="Dilation2D",Z="Dilation2DBackpropInput",$="Dilation2DBackpropFilter",J="Draw",tt="RealDiv",et="Einsum",nt="Elu",rt="EluGrad",it="Erf",at="Equal",ot="Exp",st="ExpandDims",ct="Expm1",ut="FFT",lt="Fill",ht="FlipLeftRight",dt="Floor",ft="FloorDiv",pt="FusedBatchNorm",gt="GatherV2",mt="GatherNd",vt="Greater",yt="GreaterEqual",bt="Identity",xt="IFFT",wt="Imag",kt="IsFinite",_t="IsInf",At="IsNan",Ct="LeakyRelu",St="Less",Et="LessEqual",Tt="LinSpace",Nt="Log",Ft="Log1p",Dt="LogicalAnd",It="LogicalNot",Mt="LogicalOr",Ot="LogicalXor",Rt="LogSoftmax",zt="LowerBound",Bt="LRN",Lt="LRNGrad",Pt="MatrixBandPart",jt="Max",Ut="Maximum",Wt="MaxPool",Vt="MaxPoolGrad",qt="MaxPool3D",Gt="MaxPool3DGrad",Ht="MaxPoolWithArgmax",Yt="Mean",Xt="Min",Kt="Minimum",Qt="MirrorPad",Zt="Mod",$t="Multinomial",Jt="Multiply",te="Neg",ee="NotEqual",ne="NonMaxSuppressionV3",re="NonMaxSuppressionV4",ie="NonMaxSuppressionV5",ae="OnesLike",oe="OneHot",se="Pack",ce="PadV2",ue="Pool",le="Pow",he="Prelu",de="Prod",fe="RaggedGather",pe="RaggedRange",ge="RaggedTensorToTensor",me="Range",ve="Real",ye="Reciprocal",be="Relu",xe="Reshape",we="ResizeNearestNeighbor",ke="ResizeNearestNeighborGrad",_e="ResizeBilinear",Ae="ResizeBilinearGrad",Ce="Relu6",Se="Reverse",Ee="Round",Te="Rsqrt",Ne="ScatterNd",Fe="TensorScatterUpdate",De="SearchSorted",Ie="Select",Me="Selu",Oe="Slice",Re="Sin",ze="Sinh",Be="Sign",Le="Sigmoid",Pe="Softplus",je="Sqrt",Ue="Sum",We="SpaceToBatchND",Ve="SplitV",qe="Softmax",Ge="SparseFillEmptyRows",He="SparseReshape",Ye="SparseSegmentMean",Xe="SparseSegmentSum",Ke="SparseToDense",Qe="SquaredDifference",Ze="Square",$e="StaticRegexReplace",Je="StridedSlice",tn="StringNGrams",en="StringSplit",nn="StringToHashBucketFast",rn="Sub",an="Tan",on="Tanh",sn="Tile",cn="TopK",un="Transform",ln="Transpose",hn="Unique",dn="Unpack",fn="UnsortedSegmentSum",pn="UpperBound",gn="ZerosLike",mn="Step",vn="FromPixels",yn="RotateWithOffset",bn="_FusedMatMul",xn="FusedConv2D",wn="FusedDepthwiseConv2D"},46780:(t,e,n)=>{"use strict";n.d(e,{Cf:()=>g,Op:()=>l,_5:()=>c,iP:()=>f,kr:()=>d,rY:()=>p,tA:()=>h,vQ:()=>u});var r=n(89e3),i=n(86177),a=n(94851);const o=(0,i.m)("kernelRegistry",(()=>new Map)),s=(0,i.m)("gradRegistry",(()=>new Map));function c(t,e){const n=m(t,e);return o.get(n)}function u(t){return s.get(t)}function l(t){const e=o.entries(),n=[];for(;;){const{done:r,value:i}=e.next();if(r)break;const[a,o]=i,[s]=a.split("_");s===t&&n.push(o)}return n}function h(t){const{kernelName:e,backendName:n}=t,r=m(e,n);o.has(r)&&a.i("The kernel '".concat(e,"' for backend ")+"'".concat(n,"' is already registered")),o.set(r,t)}function d(t){const{kernelName:e}=t;s.has(e)&&(0,r._K)().getBool("DEBUG")&&a.i("Overriding the gradient for '".concat(e,"'")),s.set(e,t)}function f(t,e){const n=m(t,e);if(!o.has(n))throw new Error("The kernel '".concat(t,"' for backend ")+"'".concat(e,"' is not registered"));o.delete(n)}function p(t){if(!s.has(t))throw new Error("The gradient '".concat(t,"' for backend is not registered"));s.delete(t)}function g(t,e){l(t).forEach((t=>{h(Object.assign({},t,{backendName:e}))}))}function m(t,e){return"".concat(e,"_").concat(t)}},94851:(t,e,n)=>{"use strict";n.d(e,{R:()=>a,i:()=>i});var r=n(89e3);function i(){(0,r._K)().getBool("IS_TEST")||(0,r._K)().getBool("PROD")||console.warn(...arguments)}function a(){(0,r._K)().getBool("IS_TEST")||(0,r._K)().getBool("PROD")||console.log(...arguments)}},59470:(t,e,n)=>{"use strict";n.d(e,{t:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({abs_:function(t){const e=(0,a.YT)(t,"x","abs");if("complex64"===e.dtype){const t={x:e};return r.T2.runKernel(i.$zE,t)}{const t={x:e};return r.T2.runKernel(i.ljI,t)}}})},75090:(t,e,n)=>{"use strict";n.d(e,{H:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({acos_:function(t){const e={x:(0,a.YT)(t,"x","acos")};return r.T2.runKernel(i.Vvy,e)}})},34528:(t,e,n)=>{"use strict";n.d(e,{F:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({acosh_:function(t){const e={x:(0,a.YT)(t,"x","acosh")};return r.T2.runKernel(i.PH8,e)}})},67281:(t,e,n)=>{"use strict";n.d(e,{W:()=>s});var r=n(37484),i=n(87311),a=n(48683),o=n(52863);const s=(0,n(26039).op)({add_:function(t,e){let n=(0,o.YT)(t,"a","add"),s=(0,o.YT)(e,"b","add");[n,s]=(0,a.makeTypesMatch)(n,s);const c={a:n,b:s};return r.T2.runKernel(i.OMN,c)}})},86465:(t,e,n)=>{"use strict";n.d(e,{Q:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({all_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o={x:(0,a.YT)(t,"x","all","bool")},s={axis:e,keepDims:n};return r.T2.runKernel(i.u8Z,o,s)}})},25552:(t,e,n)=>{"use strict";n.d(e,{b:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({any_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o={x:(0,a.YT)(t,"x","any","bool")},s={axis:e,keepDims:n};return r.T2.runKernel(i.FSt,o,s)}})},31003:(t,e,n)=>{"use strict";n.d(e,{F:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({argMax_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:(0,a.YT)(t,"x","argMax")},o={axis:e};return r.T2.runKernel(i.Jp_,n,o)}})},72345:(t,e,n)=>{"use strict";n.d(e,{X:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({argMin_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:(0,a.YT)(t,"x","argMin")},o={axis:e};return r.T2.runKernel(i.p_m,n,o)}})},50155:(t,e,n)=>{"use strict";n.d(e,{q:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({asin_:function(t){const e={x:(0,a.YT)(t,"x","asin")};return r.T2.runKernel(i.QKF,e)}})},94467:(t,e,n)=>{"use strict";n.d(e,{y:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({asinh_:function(t){const e={x:(0,a.YT)(t,"x","asinh")};return r.T2.runKernel(i.epO,e)}})},16802:(t,e,n)=>{"use strict";n.d(e,{r:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({atan_:function(t){const e={x:(0,a.YT)(t,"x","atan")};return r.T2.runKernel(i.TyE,e)}})},67986:(t,e,n)=>{"use strict";n.d(e,{F:()=>s});var r=n(37484),i=n(87311),a=n(48683),o=n(52863);const s=(0,n(26039).op)({atan2_:function(t,e){let n=(0,o.YT)(t,"a","atan2"),s=(0,o.YT)(e,"b","atan2");[n,s]=(0,a.makeTypesMatch)(n,s);const c={a:n,b:s};return r.T2.runKernel(i.lxb,c)}})},68080:(t,e,n)=>{"use strict";n.d(e,{r:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({atanh_:function(t){const e={x:(0,a.YT)(t,"x","atanh")};return r.T2.runKernel(i.zP9,e)}})},70963:(t,e,n)=>{"use strict";n.d(e,{$:()=>h});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(69779),c=n(157),u=n(26039),l=n(89068);const h=(0,u.op)({avgPool_:function(t,e,n,u,h){const d=(0,a.YT)(t,"x","avgPool","float32");o.vA(c.G0(n,1),(()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")));let f=d,p=!1;3===d.rank&&(p=!0,f=(0,l.t)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),o.vA(4===f.rank,(()=>"Error in avgPool: x must be rank 4 but got rank ".concat(f.rank,"."))),c.s_("avgPool",u,h);const g={x:f},m={filterSize:e,strides:n,pad:u,dimRoundingMode:h};let v=r.T2.runKernel(i.ho8,g,m);return v=(0,s.w)(v,d.dtype),p?(0,l.t)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},88500:(t,e,n)=>{"use strict";n.d(e,{k:()=>l});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(157),c=n(26039),u=n(89068);const l=(0,c.op)({avgPool3dGrad_:function(t,e,n,c,l,h){const d=(0,a.YT)(t,"dy","avgPool3dGrad"),f=(0,a.YT)(e,"input","avgPool3dGrad");let p=d,g=f,m=!1;4===f.rank&&(m=!0,p=(0,u.t)(d,[1,d.shape[0],d.shape[1],d.shape[2],d.shape[3]]),g=(0,u.t)(f,[1,f.shape[0],f.shape[1],f.shape[2],f.shape[3]])),o.vA(5===p.rank,(()=>"Error in avgPool3dGrad: dy must be rank 5 but got rank "+"".concat(p.rank,"."))),o.vA(5===g.rank,(()=>"Error in avgPool3dGrad: input must be rank 5 but got rank "+"".concat(g.rank,"."))),(0,s.s_)("avgPool3dGrad",l,h);const v={dy:p,input:g},y={filterSize:n,strides:c,pad:l,dimRoundingMode:h},b=r.T2.runKernel(i.wwC,v,y);return m?(0,u.t)(b,[b.shape[1],b.shape[2],b.shape[3],b.shape[4]]):b}})},15518:(t,e,n)=>{"use strict";n.d(e,{$:()=>u});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(26039),c=n(89068);const u=(0,s.op)({avgPoolGrad_:function(t,e,n,s,u){const l=(0,a.YT)(t,"dy","avgPoolGrad"),h=(0,a.YT)(e,"input","avgPoolGrad");o.vA(h.rank===l.rank,(()=>"Rank of input (".concat(h.rank,") does not match rank of dy (").concat(l.rank,")")));let d=h,f=l,p=!1;3===h.rank&&(p=!0,d=(0,c.t)(h,[1,h.shape[0],h.shape[1],h.shape[2]]),f=(0,c.t)(l,[1,l.shape[0],l.shape[1],l.shape[2]])),o.vA(4===f.rank,(()=>"Error in avgPoolGrad: dy must be rank 4 but got rank "+"".concat(f.rank,"."))),o.vA(4===d.rank,(()=>"Error in avgPoolGrad: input must be rank 4 but got rank "+"".concat(d.rank,".")));const g={dy:f,input:d},m={filterSize:n,strides:s,pad:u},v=r.T2.runKernel(i.VCH,g,m);return p?(0,c.t)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},58724:(t,e,n)=>{"use strict";n.d(e,{Em:()=>u,SM:()=>s,WC:()=>c,WH:()=>i,aF:()=>a,fK:()=>h,gx:()=>l,lb:()=>o});var r=n(23869);function i(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function a(t,e,n){const r=t.length+e.length,i=[];let a=0,o=0;for(let s=0;s<r;s++)-1===n.indexOf(s)?i.push(t[a++]):i.push(e[o++]);return i}function o(t,e){const n=[],r=t.length;for(let i=0;i<r;i++)-1===e.indexOf(i)&&n.push(t[i]);return[n,e.map((e=>t[e]))]}function s(t,e){return a(t,e.map((t=>1)),e)}function c(t,e,n){r.vA(i(e,n),(()=>"".concat(t," supports only inner-most axes for now. ")+"Got axes ".concat(e," and rank-").concat(n," input.")))}function u(t,e){if(i(t,e))return null;const n=[];for(let r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach((t=>n.push(t))),n}function l(t){return t.map(((t,e)=>[e,t])).sort(((t,e)=>t[1]-e[1])).map((t=>t[0]))}function h(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}},81406:(t,e,n)=>{"use strict";n.d(e,{G:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({batchToSpaceND_:function(t,e,n){const s=(0,a.YT)(t,"x","batchToSpaceND"),c=e.reduce(((t,e)=>t*e));o.vA(s.rank>=1+e.length,(()=>"input rank is ".concat(s.rank," but should be > than blockShape.length ").concat(e.length))),o.vA(n.length===e.length,(()=>"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(e.length))),o.vA(s.shape[0]%c===0,(()=>"input tensor batch is ".concat(s.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(e.join(" * ")," === ").concat(c)));const u={x:s},l={blockShape:e,crops:n};return r.T2.runKernel(i.Ik2,u,l)}})},26670:(t,e,n)=>{"use strict";n.d(e,{$:()=>c});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(89068);const c=(0,n(26039).op)({batchNorm_:function(t,e,n,c,u,l){null==l&&(l=.001);const h=(0,a.YT)(t,"x","batchNorm"),d=(0,a.YT)(e,"mean","batchNorm"),f=(0,a.YT)(n,"variance","batchNorm");let p,g;null!=u&&(p=(0,a.YT)(u,"scale","batchNorm")),null!=c&&(g=(0,a.YT)(c,"offset","batchNorm")),o.vA(d.rank===f.rank,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),o.vA(null==g||d.rank===g.rank,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),o.vA(null==p||d.rank===p.rank,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));const m={x:function(t){let e;return e=0===t.rank||1===t.rank?(0,s.t)(t,[1,1,1,t.size]):2===t.rank?(0,s.t)(t,[1,1,t.shape[0],t.shape[1]]):3===t.rank?(0,s.t)(t,[1,t.shape[0],t.shape[1],t.shape[2]]):t,e}(h),scale:p,offset:g,mean:d,variance:f},v={varianceEpsilon:l},y=r.T2.runKernel(i.i5R,m,v);return(0,s.t)(y,h.shape)}})},99965:(t,e,n)=>{"use strict";n.d(e,{h:()=>l});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(62503),c=n(26039),u=n(89068);const l=(0,c.op)({broadcastTo_:function(t,e){let n=(0,a.YT)(t,"broadcastTo","x");const c=n.shape;if((0,o.SA)(e),e.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(e.length," < input.rank=").concat(n.rank,"."));if(e.length>n.rank){const t=n.shape.slice();for(;t.length<e.length;)t.unshift(1);n=(0,u.t)(n,t)}const l=n.shape,h=Array.from(e);for(let r=e.length-1;r>=0;r--)if(l[r]===e[r])h[r]=1;else if(1!==n.shape[r])throw new Error("broadcastTo(): [".concat(c,"] cannot be broadcast to [").concat(e,"]."));if(0===h.map(((t,e)=>t>1?e:-1)).filter((t=>t>=0)).length)return(0,s.o)(n);const d={x:n},f={reps:h};return r.T2.runKernel(i.FAs,d,f)}})},84824:(t,e,n)=>{"use strict";function r(t,e){const n=t.length,r=[];for(let i=0;i<n;i++){const a=n-1-i,o=t[a]||1;(e[e.length-1-i]||1)>1&&1===o&&r.unshift(a)}return r}function i(t,e){const n=[];for(let r=0;r<e.length;r++){const i=t[t.length-r-1],a=e.length-r-1,o=e[a];(null==i||1===i&&o>1)&&n.unshift(a)}return n}function a(t,e){const n=Math.max(t.length,e.length),r=new Array(n);for(let i=0;i<n;i++){let a=t[t.length-i-1];null==a&&(a=1);let o=e[e.length-i-1];if(null==o&&(o=1),1===a)r[n-i-1]=o;else if(1===o)r[n-i-1]=a;else{if(a!==o){const n="Operands could not be broadcast together with shapes "+"".concat(t," and ").concat(e,".");throw Error(n)}r[n-i-1]=a}}return r}n.r(e),n.d(e,{assertAndGetBroadcastShape:()=>a,getBroadcastDims:()=>r,getReductionAxes:()=>i})},80186:(t,e,n)=>{"use strict";n.d(e,{r:()=>a});var r=n(90739),i=n(23869);function a(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return e=e||"float32",i.SA(t),new r.yl(t,e,n)}},69779:(t,e,n)=>{"use strict";n.d(e,{w:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({cast_:function(t,e){const n=(0,a.YT)(t,"x","cast");if(!o.xn(e))throw new Error("Failed to cast to unknown dtype ".concat(e));if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");const s={x:n},c={dtype:e};return r.T2.runKernel(i.KXH,s,c)}})},33989:(t,e,n)=>{"use strict";n.d(e,{m:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({ceil_:function(t){const e={x:(0,a.YT)(t,"x","ceil","float32")};return r.T2.runKernel(i.QDP,e)}})},68042:(t,e,n)=>{"use strict";n.d(e,{z:()=>c});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(99333);const c=(0,n(26039).op)({clipByValue_:function(t,e,n){const c=(0,a.YT)(t,"x","clipByValue");if(o.vA(e<=n,(()=>"Error in clip: min (".concat(e,") must be ")+"less than or equal to max (".concat(n,")."))),e===n)return(0,s.G)(c.shape,e,c.dtype);const u={x:c},l={clipValueMin:e,clipValueMax:n};return r.T2.runKernel(i.vaV,u,l)}})},62503:(t,e,n)=>{"use strict";n.d(e,{o:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({clone_:function(t){const e={x:(0,a.YT)(t,"x","clone","string_or_numeric")};return r.T2.runKernel(i.lzr,e)}})},76234:(t,e,n)=>{"use strict";n.d(e,{f:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({complex_:function(t,e){const n=(0,a.YT)(t,"real","complex"),s=(0,a.YT)(e,"imag","complex");o.O3(n.shape,s.shape,"real and imag shapes, ".concat(n.shape," and ").concat(s.shape,", ")+"must match in call to tf.complex().");const c={real:n,imag:s};return r.T2.runKernel(i.pr3,c)}})},89360:(t,e,n)=>{"use strict";n.d(e,{x:()=>c});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(62503);const c=(0,n(26039).op)({concat_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,o.vA)(t.length>=1,(()=>"Pass at least one tensor to concat"));const n=(0,a.j1)(t,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((t=>{if("complex64"!==t.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(t.dtype,". "))})),1===n.length)return(0,s.o)(n[0]);const c=n,u={axis:e};return r.T2.runKernel(i.$dB,c,u)}})},65783:(t,e,n)=>{"use strict";n.d(e,{k:()=>u});var r=n(52863),i=n(23869),a=n(31880),o=n(157),s=n(26039),c=n(89068);const u=(0,s.op)({conv1d_:function(t,e,n,s){let u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,h=arguments.length>6?arguments[6]:void 0;const d=(0,r.YT)(t,"x","conv1d"),f=(0,r.YT)(e,"filter","conv1d");let p=d,g=!1;2===d.rank&&(g=!0,p=(0,c.t)(d,[1,d.shape[0],d.shape[1]])),i.vA(3===p.rank,(()=>"Error in conv1d: input must be rank 3, but got rank ".concat(p.rank,"."))),i.vA(3===f.rank,(()=>"Error in conv1d: filter must be rank 3, but got rank "+"".concat(f.rank,"."))),o.s_("conv1d",s,h),i.vA(p.shape[2]===f.shape[1],(()=>"Error in conv1d: depth of input (".concat(p.shape[2],") must match ")+"input depth for filter ".concat(f.shape[1],"."))),i.vA(o.G0(n,l),(()=>"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(l,"'"))),i.vA(o.qk(l),(()=>"Error in conv1D: Dilated rates should be larger than 0.")),i.vA(o.qk(n),(()=>"Error in conv1D: Stride should be larger than 0.")),i.vA("NWC"===u,(()=>"Error in conv1d: got dataFormat of ".concat(u," but only NWC is currently supported.")));const m=(0,c.t)(f,[1,f.shape[0],f.shape[1],f.shape[2]]),v=(0,c.t)(p,[p.shape[0],1,p.shape[1],p.shape[2]]),y=[1,n],b=[1,l],x=(0,a.X)(v,m,y,s,"NHWC",b,h);return g?(0,c.t)(x,[x.shape[2],x.shape[3]]):(0,c.t)(x,[x.shape[0],x.shape[2],x.shape[3]])}})},31880:(t,e,n)=>{"use strict";n.d(e,{X:()=>l});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(157),c=n(26039),u=n(89068);const l=(0,c.op)({conv2d_:function(t,e,n,c){let l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],d=arguments.length>6?arguments[6]:void 0;const f=(0,a.YT)(t,"x","conv2d","float32"),p=(0,a.YT)(e,"filter","conv2d","float32");let g=f,m=!1;3===f.rank&&(m=!0,g=(0,u.t)(f,[1,f.shape[0],f.shape[1],f.shape[2]])),o.vA(4===g.rank,(()=>"Error in conv2d: input must be rank 4, but got rank ".concat(g.rank,"."))),o.vA(4===p.rank,(()=>"Error in conv2d: filter must be rank 4, but got rank "+"".concat(p.rank,"."))),s.s_("conv2d",c,d);const v="NHWC"===l?g.shape[3]:g.shape[1];o.vA(v===p.shape[2],(()=>"Error in conv2d: depth of input (".concat(v,") must match ")+"input depth for filter ".concat(p.shape[2],"."))),o.vA(s.G0(n,h),(()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(h,"'"))),o.vA(s.qk(h),(()=>"Error in conv2D: Dilated rates should be larger than 0.")),o.vA(s.qk(n),(()=>"Error in conv2D: Strides should be larger than 0."));const y={x:g,filter:p},b={strides:n,pad:c,dataFormat:l,dilations:h,dimRoundingMode:d},x=r.T2.runKernel(i.p2J,y,b);return m?(0,u.t)(x,[x.shape[1],x.shape[2],x.shape[3]]):x}})},23458:(t,e,n)=>{"use strict";n.d(e,{H:()=>u});var r=n(37484),i=n(87311),a=n(23869),o=n(157),s=n(26039),c=n(89068);const u=(0,s.op)({conv2DBackpropFilter_:function(t,e,n,s,u){let l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",h=arguments.length>6?arguments[6]:void 0,d=t;3===t.rank&&(d=(0,c.t)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let f=e;3===f.rank&&(f=(0,c.t)(e,[1,e.shape[0],e.shape[1],e.shape[2]])),a.vA(4===d.rank,(()=>"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(d.shape,"."))),a.vA(4===f.rank,(()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(f.shape,"."))),a.vA(4===n.length,(()=>"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")));const p="NHWC"===l?d.shape[3]:d.shape[1],g="NHWC"===l?f.shape[3]:f.shape[1];a.vA(p===n[2],(()=>"Error in conv2dDerFilter: depth of input ".concat(p,") must ")+"match input depth in filter (".concat(n[2],"."))),a.vA(g===n[3],(()=>"Error in conv2dDerFilter: depth of dy (".concat(g,") must ")+"match output depth for filter (".concat(n[3],")."))),o.s_("conv2dDerFilter",u,h);const m={x:d,dy:f},v={strides:s,pad:u,dataFormat:l,dimRoundingMode:h,filterShape:n};return r.T2.runKernel(i.rFm,m,v)}})},51294:(t,e,n)=>{"use strict";n.d(e,{v:()=>u});var r=n(37484),i=n(87311),a=n(23869),o=n(157),s=n(26039),c=n(89068);const u=(0,s.op)({conv2DBackpropInput_:function(t,e,n,s,u){let l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",h=arguments.length>6?arguments[6]:void 0;a.vA(t.length===e.rank,(()=>"Length of inShape "+"(".concat(t.length,") and rank of dy (").concat(e.rank,") must match")));let d=t,f=e,p=!1;3===e.rank&&(p=!0,f=(0,c.t)(e,[1,e.shape[0],e.shape[1],e.shape[2]]),d=[1,t[0],t[1],t[2]]),a.vA(4===d.length,(()=>"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(d.length,"."))),a.vA(4===f.rank,(()=>"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(f.rank))),a.vA(4===n.rank,(()=>"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)));const g="NHWC"===l?d[3]:d[1],m="NHWC"===l?f.shape[3]:f.shape[1];a.vA(g===n.shape[2],(()=>"Error in conv2dDerInput: depth of input (".concat(g,") must ")+"match input depth for filter ".concat(n.shape[2],"."))),a.vA(m===n.shape[3],(()=>"Error in conv2dDerInput: depth of output (".concat(m,") must ")+"match output depth for filter ".concat(n.shape[3],"."))),o.s_("conv2dDerInput",u,h);const v={dy:f,filter:n},y={strides:s,pad:u,dataFormat:l,dimRoundingMode:h,inputShape:d},b=r.T2.runKernel(i.jfg,v,y);return p?(0,c.t)(b,[b.shape[1],b.shape[2],b.shape[3]]):b}})},80824:(t,e,n)=>{"use strict";n.d(e,{w:()=>a});var r=n(52863),i=n(51294);const a=(0,n(26039).op)({conv2dTranspose_:function(t,e,n,a,o,s){const c=(0,r.YT)(t,"x","conv2dTranspose"),u=(0,r.YT)(e,"filter","conv2dTranspose");return(0,i.v)(n,c,u,a,o,"NHWC",s)}})},29475:(t,e,n)=>{"use strict";n.d(e,{_:()=>c});var r=n(37484),i=n(87311),a=n(23869),o=n(26039),s=n(89068);const c=(0,o.op)({conv3DBackpropFilter_:function(t,e,n,o,c){let u=t;4===t.rank&&(u=(0,s.t)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let l=e;4===l.rank&&(l=(0,s.t)(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),a.vA(5===u.rank,(()=>"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(u.shape,"."))),a.vA(5===l.rank,(()=>"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(l.shape,"."))),a.vA(5===n.length,(()=>"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,"."))),a.vA(u.shape[4]===n[3],(()=>"Error in conv3dDerFilter: depth of input ".concat(u.shape[4],") must ")+"match input depth in filter (".concat(n[3],"."))),a.vA(l.shape[4]===n[4],(()=>"Error in conv3dDerFilter: depth of dy (".concat(l.shape[4],") must ")+"match output depth for filter (".concat(n[4],").")));const h={x:u,dy:l},d={strides:o,pad:c,filterShape:n};return r.T2.runKernel(i.iGz,h,d)}})},20289:(t,e,n)=>{"use strict";n.d(e,{c:()=>c});var r=n(37484),i=n(87311),a=n(23869),o=n(26039),s=n(89068);const c=(0,o.op)({conv3DBackpropInput_:function(t,e,n,o,c){a.vA(t.length===e.rank,(()=>"Length of inShape "+"(".concat(t.length,") and rank of dy (").concat(e.rank,") must match")));let u=t,l=e,h=!1;4===e.rank&&(h=!0,l=(0,s.t)(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),u=[1,t[0],t[1],t[2],t[3]]);const d=u[4],f=l.shape[4];a.vA(5===u.length,(()=>"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(u.length,"."))),a.vA(5===l.rank,(()=>"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(l.rank))),a.vA(5===n.rank,(()=>"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank))),a.vA(d===n.shape[3],(()=>"Error in conv3dDerInput: depth of input (".concat(d,") must ")+"match input depth for filter ".concat(n.shape[3],"."))),a.vA(f===n.shape[4],(()=>"Error in conv3dDerInput: depth of output (".concat(f,") must ")+"match output depth for filter ".concat(n.shape[4],".")));const p={dy:l,filter:n},g={pad:c,strides:o,inputShape:u},m=r.T2.runKernel(i.gC7,p,g);return h?(0,s.t)(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}})},157:(t,e,n)=>{"use strict";n.d(e,{$Q:()=>v,Dh:()=>p,E6:()=>a,G0:()=>g,G8:()=>u,YQ:()=>i,l5:()=>o,p$:()=>c,qk:()=>m,s_:()=>y,uf:()=>s});var r=n(23869);function i(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",a=arguments.length>5?arguments[5]:void 0;return s(t,[...e,t[3]],n,a,r,null,null,v(i))}function a(t,e,n,r,i,a){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast";const[c,u]=l(e);let h;if("channelsLast"===o)h=[c,u,t[3],t[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));h=[c,u,t[1],t[1]]}return s(t,h,n,r,i,a,!1,o)}function o(t,e,n,r,i,a){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC";const[s,u,l]=h(e);let d,f;if("NDHWC"===o)f="channelsLast",d=[s,u,l,t[4],t[4]];else{if("NCDHW"!==o)throw new Error("Unknown dataFormat ".concat(o));f="channelsFirst",d=[s,u,l,t[1],t[1]]}return c(t,d,n,r,i,!1,f,a)}function s(t,e,n,r,i,a){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",[c,h,p,g]=[-1,-1,-1,-1];if("channelsLast"===s)[c,h,p,g]=t;else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));[c,g,h,p]=t}const[m,v,,y]=e,[b,x]=l(n),[w,k]=l(r),_=d(m,w),A=d(v,k),{padInfo:C,outHeight:S,outWidth:E}=function(t,e,n,r,i,a,o,s,c){let l,h,d;if("number"===typeof t){l={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};const i=function(t,e,n,r,i){null==r&&(r=u(t,e,n));const a=t[0],o=t[1],s=f((a-e+2*r)/n+1,i),c=f((o-e+2*r)/n+1,i);return[s,c]}([e,n],a,r,t,s);h=i[0],d=i[1]}else if("same"===t){h=Math.ceil(e/r),d=Math.ceil(n/i);const t=Math.max(0,(h-1)*r+a-e),s=Math.max(0,(d-1)*i+o-n),c=Math.floor(t/2),u=t-c,f=Math.floor(s/2);l={top:c,bottom:u,left:f,right:s-f,type:"SAME"}}else if("valid"===t)l={top:0,bottom:0,left:0,right:0,type:"VALID"},h=Math.ceil((e-a+1)/r),d=Math.ceil((n-o+1)/i);else{if("object"!==typeof t)throw Error("Unknown padding parameter: ".concat(t));{const u="channelsLast"===c?t[1][0]:t[2][0],p="channelsLast"===c?t[1][1]:t[2][1],g="channelsLast"===c?t[2][0]:t[3][0],m="channelsLast"===c?t[2][1]:t[3][1];l={top:u,bottom:p,left:g,right:m,type:0===u&&0===p&&0===g&&0===m?"VALID":"EXPLICIT"},h=f((e-a+u+p)/r+1,s),d=f((n-o+g+m)/i+1,s)}}return{padInfo:l,outHeight:h,outWidth:d}}(i,h,p,b,x,_,A,a,s),T=o?y*g:y;let N;return"channelsFirst"===s?N=[c,T,S,E]:"channelsLast"===s&&(N=[c,S,E,T]),{batchSize:c,dataFormat:s,inHeight:h,inWidth:p,inChannels:g,outHeight:S,outWidth:E,outChannels:T,padInfo:C,strideHeight:b,strideWidth:x,filterHeight:m,filterWidth:v,effectiveFilterHeight:_,effectiveFilterWidth:A,dilationHeight:w,dilationWidth:k,inShape:t,outShape:N,filterShape:e}}function c(t,e,n,r,i){let a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",s=arguments.length>7?arguments[7]:void 0,[c,l,p,g,m]=[-1,-1,-1,-1,-1];if("channelsLast"===o)[c,l,p,g,m]=t;else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));[c,m,l,p,g]=t}const[v,y,b,,x]=e,[w,k,_]=h(n),[A,C,S]=h(r),E=d(v,A),T=d(y,C),N=d(b,S),{padInfo:F,outDepth:D,outHeight:I,outWidth:M}=function(t,e,n,r,i,a,o,s,c,l,h){let d,p,g,m;"valid"===t&&(t=0);if("number"===typeof t){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};const v=function(t,e,n,r,i,a){null==i&&(i=u(t,e[0],r[0]));const o=[0,0,0,n];for(let s=0;s<3;s++)t[s]+2*i>=e[s]&&(o[s]=f((t[s]-e[s]+2*i)/r[s]+1,a));return o}([e,n,r,1],[s,c,l],1,[i,a,o],t,h);p=v[0],g=v[1],m=v[2]}else{if("same"!==t)throw Error("Unknown padding parameter: ".concat(t));{p=Math.ceil(e/i),g=Math.ceil(n/a),m=Math.ceil(r/o);const t=(p-1)*i+s-e,u=(g-1)*a+c-n,h=(m-1)*o+l-r,f=Math.floor(t/2),v=t-f,y=Math.floor(u/2),b=u-y,x=Math.floor(h/2);d={top:y,bottom:b,left:x,right:h-x,front:f,back:v,type:"SAME"}}}return{padInfo:d,outDepth:p,outHeight:g,outWidth:m}}(i,l,p,g,w,k,_,E,T,N,s),O=a?x*m:x;let R;return"channelsFirst"===o?R=[c,O,D,I,M]:"channelsLast"===o&&(R=[c,D,I,M,O]),{batchSize:c,dataFormat:o,inDepth:l,inHeight:p,inWidth:g,inChannels:m,outDepth:D,outHeight:I,outWidth:M,outChannels:O,padInfo:F,strideDepth:w,strideHeight:k,strideWidth:_,filterDepth:v,filterHeight:y,filterWidth:b,effectiveFilterDepth:E,effectiveFilterHeight:T,effectiveFilterWidth:N,dilationDepth:A,dilationHeight:C,dilationWidth:S,inShape:t,outShape:R,filterShape:e}}function u(t,e,n){const r=d(e,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1);return Math.floor((t[0]*(n-1)-n+r)/2)}function l(t){return"number"===typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function h(t){return"number"===typeof t?[t,t,t]:t}function d(t,e){return e<=1?t:t+(t-1)*(e-1)}function f(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode ".concat(e))}}function p(t){const[e,n,r]=l(t);return 1===e&&1===n&&1===r}function g(t,e){return p(t)||p(e)}function m(t){return l(t).every((t=>t>0))}function v(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(t))}function y(t,e,n){if(null!=n){if("string"===typeof e)throw Error("Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,"."));if("number"===typeof e)r.vA(r.E6(e),(()=>"Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,".")));else{if("object"!==typeof e)throw Error("Error in ".concat(t,": Unknown padding parameter: ").concat(e));e.forEach((e=>{e.forEach((e=>{r.vA(r.E6(e),(()=>"Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,".")))}))}))}}}},48133:(t,e,n)=>{"use strict";n.d(e,{g:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({cos_:function(t){const e={x:(0,a.YT)(t,"x","cos","float32")};return r.T2.runKernel(i.Mn0,e)}})},84033:(t,e,n)=>{"use strict";n.d(e,{y:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({cosh_:function(t){const e={x:(0,a.YT)(t,"x","cosh","float32")};return r.T2.runKernel(i.MnK,e)}})},79808:(t,e,n)=>{"use strict";n.d(e,{L:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({cumprod_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s={x:(0,a.YT)(t,"x","cumprod")},c={axis:e,exclusive:n,reverse:o};return r.T2.runKernel(i.jj_,s,c)}})},91482:(t,e,n)=>{"use strict";n.d(e,{r:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({cumsum_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s={x:(0,a.YT)(t,"x","cumsum")},c={axis:e,exclusive:n,reverse:o};return r.T2.runKernel(i.nY8,s,c)}})},89854:(t,e,n)=>{"use strict";n.d(e,{R:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({depthToSpace_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC";const s=(0,a.YT)(t,"x","depthToSpace","float32"),c="NHWC"===n?s.shape[1]:s.shape[2],u="NHWC"===n?s.shape[2]:s.shape[3],l="NHWC"===n?s.shape[3]:s.shape[1];o.vA(e>1,(()=>"blockSize should be > 1 for depthToSpace, but was: ".concat(e))),o.vA(c*e>=0,(()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(c," and ").concat(e,"  for depthToSpace with input shape\n    ").concat(s.shape))),o.vA(u*e>=0,(()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(u," and ").concat(e," for depthToSpace with input shape\n        ").concat(s.shape))),o.vA(l%(e*e)===0,(()=>"Dimension size must be evenly divisible by ".concat(e*e," but is ").concat(l," for depthToSpace with input shape ").concat(s.shape)));const h={x:s},d={blockSize:e,dataFormat:n};return r.T2.runKernel(i.TMz,h,d)}})},92302:(t,e,n)=>{"use strict";n.d(e,{G:()=>l});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(157),c=n(26039),u=n(89068);const l=(0,c.op)({depthwiseConv2d_:function(t,e,n,c){let l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],d=arguments.length>6?arguments[6]:void 0;const f=(0,a.YT)(t,"x","depthwiseConv2d","float32"),p=(0,a.YT)(e,"filter","depthwiseConv2d","float32");let g=f,m=!1;3===f.rank&&(m=!0,g=(0,u.t)(f,[1,f.shape[0],f.shape[1],f.shape[2]])),o.vA(4===g.rank,(()=>"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(g.rank,"."))),o.vA(4===p.rank,(()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(p.rank,".")));const v="NHWC"===l?g.shape[3]:g.shape[1];o.vA(v===p.shape[2],(()=>"Error in depthwiseConv2d: number of input channels "+"(".concat(v,") must match the inChannels dimension in ")+"filter ".concat(p.shape[2],"."))),s.s_("depthwiseConv2d",c,d);const y={x:g,filter:p},b={strides:n,pad:c,dataFormat:l,dilations:h,dimRoundingMode:d},x=r.T2.runKernel(i.tGH,y,b);return m?(0,u.t)(x,[x.shape[1],x.shape[2],x.shape[3]]):x}})},85408:(t,e,n)=>{"use strict";n.d(e,{x:()=>s});var r=n(37484),i=n(87311),a=n(26039),o=n(89068);const s=(0,a.op)({depthwiseConv2dNativeBackpropFilter_:function(t,e,n,a,s){let c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],u=arguments.length>6?arguments[6]:void 0,l=t;3===t.rank&&(l=(0,o.t)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let h=e;3===h.rank&&(h=(0,o.t)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const d={x:l,dy:h},f={strides:a,pad:s,dimRoundingMode:u,dilations:c,filterShape:n};return r.T2.runKernel(i.X$8,d,f)}})},59068:(t,e,n)=>{"use strict";n.d(e,{l:()=>s});var r=n(37484),i=n(87311),a=n(26039),o=n(89068);const s=(0,a.op)({depthwiseConv2dNativeBackpropInput_:function(t,e,n,a,s){let c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],u=arguments.length>6?arguments[6]:void 0,l=e,h=!1;3===e.rank&&(h=!0,l=(0,o.t)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const d={dy:l,filter:n},f={strides:a,pad:s,dimRoundingMode:u,dilations:c,inputShape:t},p=r.T2.runKernel(i.nVu,d,f);return h?(0,o.t)(p,[p.shape[1],p.shape[2],p.shape[3]]):p}})},14640:(t,e,n)=>{"use strict";n.d(e,{X:()=>u});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(26039),c=n(89068);const u=(0,s.op)({dilation2d_:function(t,e,n,s){let u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC";const h=(0,a.YT)(t,"x","dilation2d"),d=(0,a.YT)(e,"filter","dilation2d");o.vA(3===h.rank||4===h.rank,(()=>"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(h.rank,"."))),o.vA(3===d.rank,(()=>"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(d.rank,"."))),o.vA("NHWC"===l,(()=>"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(l)));let f=h,p=!1;3===h.rank&&(f=(0,c.t)(h,[1,h.shape[0],h.shape[1],h.shape[2]]),p=!0),o.vA(f.shape[3]===d.shape[2],(()=>"Error in dilation2d:  input and filter must have the same depth: ".concat(f.shape[3]," vs ").concat(d.shape[2])));const g={x:f,filter:d},m={strides:n,pad:s,dilations:u},v=r.T2.runKernel(i.jxD,g,m);return p?(0,c.t)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},64113:(t,e,n)=>{"use strict";n.d(e,{y:()=>c});var r=n(37484),i=n(87311),a=n(48683),o=n(52863),s=n(64149);const c=(0,n(26039).op)({div_:function(t,e){let n=(0,o.YT)(t,"a","div"),c=(0,o.YT)(e,"b","div");if([n,c]=(0,a.makeTypesMatch)(n,c),"int32"===n.dtype&&"int32"===c.dtype)return(0,s.w)(n,c);const u={a:n,b:c};return r.T2.runKernel(i.sDr,u,{})}})},83645:(t,e,n)=>{"use strict";n.d(e,{e:()=>l});var r=n(48683),i=n(52863),a=n(64113),o=n(92138),s=n(26039),c=n(52117),u=n(90043);const l=(0,s.op)({divNoNan_:function(t,e){let n=(0,i.YT)(t,"a","div"),s=(0,i.YT)(e,"b","div");[n,s]=(0,r.makeTypesMatch)(n,s);const l=(0,a.y)(n,s),h=(0,u.P)(l),d=(0,o.L)(s,h);return(0,c._)(d,h,l)}})},33185:(t,e,n)=>{"use strict";n.d(e,{O:()=>c});var r=n(52863),i=n(23869),a=n(65849),o=n(26039),s=n(89068);const c=(0,o.op)({dot_:function(t,e){const n=(0,r.YT)(t,"t1","dot"),o=(0,r.YT)(e,"t2","dot");i.vA((1===n.rank||2===n.rank)&&(1===o.rank||2===o.rank),(()=>"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(o.rank,".")));const c=1===n.rank?n.size:n.shape[1],u=1===o.rank?o.size:o.shape[0];if(i.vA(c===u,(()=>"Error in dot: inner dimensions of inputs must match, but got "+"".concat(c," and ").concat(u,"."))),1===n.rank&&1===o.rank){const t=(0,s.t)(n,[1,-1]),e=(0,s.t)(o,[-1,1]),r=(0,a.N)(t,e);return(0,s.t)(r,[])}if(1===n.rank&&2===o.rank){const t=(0,s.t)(n,[1,-1]),e=(0,s.t)(o,[o.shape[0],o.shape[1]]),r=(0,a.N)(t,e);return(0,s.t)(r,[r.size])}if(2===n.rank&&1===o.rank){const t=(0,s.t)(o,[-1,1]),e=(0,a.N)(n,t);return(0,s.t)(e,[e.size])}{const t=(0,s.t)(o,[o.shape[0],o.shape[1]]);return(0,a.N)(n,t)}}})},62534:(t,e,n)=>{"use strict";n.d(e,{P:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({elu_:function(t){const e={x:(0,a.YT)(t,"x","elu","float32")};return r.T2.runKernel(i.Pah,e)}})},92138:(t,e,n)=>{"use strict";n.d(e,{L:()=>c});var r=n(37484),i=n(87311),a=n(48683),o=n(52863),s=n(84824);const c=(0,n(26039).op)({equal_:function(t,e){let n=(0,o.YT)(t,"a","equal","string_or_numeric"),c=(0,o.YT)(e,"b","equal","string_or_numeric");[n,c]=(0,a.makeTypesMatch)(n,c),(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);const u={a:n,b:c};return r.T2.runKernel(i.BRl,u)}})},47829:(t,e,n)=>{"use strict";n.d(e,{Y:()=>c});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(69779);const c=(0,n(26039).op)({erf_:function(t){let e=(0,a.YT)(t,"x","erf");o.vA("int32"===e.dtype||"float32"===e.dtype,(()=>"Input dtype must be `int32` or `float32`.")),"int32"===e.dtype&&(e=(0,s.w)(e,"float32"));const n={x:e};return r.T2.runKernel(i._s9,n)}})},13779:(t,e,n)=>{"use strict";n.d(e,{p:()=>i});var r=n(48306);const i=(0,n(26039).op)({euclideanNorm_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,r.x)(t,"euclidean",e,n)}})},48389:(t,e,n)=>{"use strict";n.d(e,{o:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({exp_:function(t){const e={x:(0,a.YT)(t,"x","exp")};return r.T2.runKernel(i.ox3,e)}})},70816:(t,e,n)=>{"use strict";n.d(e,{U:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({expandDims_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(0,a.YT)(t,"x","expandDims","string_or_numeric");o.vA(e<=n.rank,(()=>"Axis must be <= rank of the tensor"));const s={input:n},c={dim:e};return r.T2.runKernel(i.ybN,s,c)}})},54195:(t,e,n)=>{"use strict";n.d(e,{I:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({expm1_:function(t){const e={x:(0,a.YT)(t,"x","expm1")};return r.T2.runKernel(i.ybj,e)}})},99333:(t,e,n)=>{"use strict";n.d(e,{G:()=>o});var r=n(37484),i=n(87311),a=n(23869);function o(t,e,n){(0,a.SA)(t);const o={shape:t,value:e,dtype:n=n||(0,a.X$)(e)};return r.T2.runKernel(i.SQl,{},o)}},96812:(t,e,n)=>{"use strict";n.d(e,{R:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({floor_:function(t){const e={x:(0,a.YT)(t,"x","floor","float32")};return r.T2.runKernel(i.ZgB,e)}})},64149:(t,e,n)=>{"use strict";n.d(e,{w:()=>s});var r=n(37484),i=n(87311),a=n(48683),o=n(52863);const s=(0,n(26039).op)({floorDiv_:function(t,e){let n=(0,o.YT)(t,"a","floorDiv"),s=(0,o.YT)(e,"b","floorDiv");[n,s]=(0,a.makeTypesMatch)(n,s);const c={a:n,b:s};return r.T2.runKernel(i.ElG,c)}})},50511:(t,e,n)=>{"use strict";n.d(e,{k:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({gather_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const s={x:(0,a.YT)(t,"x","gather"),indices:(0,a.YT)(e,"indices","gather","int32")},c={axis:n,batchDims:o};return r.T2.runKernel(i.mxL,s,c)}})},60228:(t,e,n)=>{"use strict";n.d(e,{r:()=>c});var r=n(37484),i=n(87311),a=n(48683),o=n(52863),s=n(84824);const c=(0,n(26039).op)({greater_:function(t,e){let n=(0,o.YT)(t,"a","greater","string_or_numeric"),c=(0,o.YT)(e,"b","greater","string_or_numeric");[n,c]=(0,a.makeTypesMatch)(n,c),(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);const u={a:n,b:c};return r.T2.runKernel(i.XhZ,u)}})},39103:(t,e,n)=>{"use strict";n.d(e,{D:()=>c});var r=n(37484),i=n(87311),a=n(48683),o=n(52863),s=n(84824);const c=(0,n(26039).op)({greaterEqual_:function(t,e){let n=(0,o.YT)(t,"a","greaterEqual","string_or_numeric"),c=(0,o.YT)(e,"b","greaterEqual","string_or_numeric");[n,c]=(0,a.makeTypesMatch)(n,c),(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);const u={a:n,b:c};return r.T2.runKernel(i.lLS,u)}})},66758:(t,e,n)=>{"use strict";n.d(e,{n:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({imag_:function(t){const e={input:(0,a.YT)(t,"input","imag")};return r.T2.runKernel(i.dv8,e)}})},20537:(t,e,n)=>{"use strict";n.d(e,{v:()=>u});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(26039),c=n(89068);const u=(0,s.op)({resizeBilinear_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const u=(0,a.YT)(t,"images","resizeBilinear");o.vA(3===u.rank||4===u.rank,(()=>"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(u.rank,"."))),o.vA(2===e.length,(()=>"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(e,"."))),o.vA(!1===s||!1===n,(()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."));let l=u,h=!1;3===u.rank&&(h=!0,l=(0,c.t)(u,[1,u.shape[0],u.shape[1],u.shape[2]]));const[]=e,d={images:l},f={alignCorners:n,halfPixelCenters:s,size:e},p=r.T2.runKernel(i.hgw,d,f);return h?(0,c.t)(p,[p.shape[1],p.shape[2],p.shape[3]]):p}})},80828:(t,e,n)=>{"use strict";n.d(e,{b:()=>u});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(26039),c=n(89068);const u=(0,s.op)({resizeNearestNeighbor_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const u=(0,a.YT)(t,"images","resizeNearestNeighbor");o.vA(3===u.rank||4===u.rank,(()=>"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(u.rank,"."))),o.vA(2===e.length,(()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(e,"."))),o.vA("float32"===u.dtype||"int32"===u.dtype,(()=>"`images` must have `int32` or `float32` as dtype")),o.vA(!1===s||!1===n,(()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."));let l=u,h=!1;3===u.rank&&(h=!0,l=(0,c.t)(u,[1,u.shape[0],u.shape[1],u.shape[2]]));const[]=e,d={images:l},f={alignCorners:n,halfPixelCenters:s,size:e},p=r.T2.runKernel(i.jOE,d,f);return h?(0,c.t)(p,[p.shape[1],p.shape[2],p.shape[3]]):p}})},38660:(t,e,n)=>{"use strict";n.d(e,{M:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({isFinite_:function(t){const e={x:(0,a.YT)(t,"x","isFinite")};return r.T2.runKernel(i.gIW,e)}})},37304:(t,e,n)=>{"use strict";n.d(e,{E:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({isInf_:function(t){const e={x:(0,a.YT)(t,"x","isInf")};return r.T2.runKernel(i.E3$,e)}})},42310:(t,e,n)=>{"use strict";n.d(e,{y:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({isNaN_:function(t){const e={x:(0,a.YT)(t,"x","isNaN")};return r.T2.runKernel(i.iPs,e)}})},51965:(t,e,n)=>{"use strict";n.d(e,{H:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({leakyRelu_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2;const n={x:(0,a.YT)(t,"x","leakyRelu")},o={alpha:e};return r.T2.runKernel(i.X0$,n,o)}})},72969:(t,e,n)=>{"use strict";n.d(e,{M:()=>c});var r=n(37484),i=n(87311),a=n(48683),o=n(52863),s=n(84824);const c=(0,n(26039).op)({less_:function(t,e){let n=(0,o.YT)(t,"a","less","string_or_numeric"),c=(0,o.YT)(e,"b","less","string_or_numeric");[n,c]=(0,a.makeTypesMatch)(n,c),(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);const u={a:n,b:c};return r.T2.runKernel(i.mIA,u)}})},64210:(t,e,n)=>{"use strict";n.d(e,{I:()=>c});var r=n(37484),i=n(87311),a=n(48683),o=n(52863),s=n(84824);const c=(0,n(26039).op)({lessEqual_:function(t,e){let n=(0,o.YT)(t,"a","lessEqual","string_or_numeric"),c=(0,o.YT)(e,"b","lessEqual","string_or_numeric");[n,c]=(0,a.makeTypesMatch)(n,c),(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);const u={a:n,b:c};return r.T2.runKernel(i.CwD,u)}})},85593:(t,e,n)=>{"use strict";n.d(e,{K:()=>u});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(26039),c=n(89068);const u=(0,s.op)({localResponseNormalization_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;const l=(0,a.YT)(t,"x","localResponseNormalization");o.vA(4===l.rank||3===l.rank,(()=>"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(l.rank,"."))),o.vA(o.E6(e),(()=>"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(e,".")));let h=l,d=!1;3===l.rank&&(d=!0,h=(0,c.t)(l,[1,l.shape[0],l.shape[1],l.shape[2]]));const f={x:h},p={depthRadius:e,bias:n,alpha:s,beta:u},g=r.T2.runKernel(i.jM4,f,p);return d?(0,c.t)(g,[g.shape[1],g.shape[2],g.shape[3]]):g}})},14206:(t,e,n)=>{"use strict";n.d(e,{u:()=>a});var r=n(37484),i=n(87311);const a=(0,n(26039).op)({localResponseNormalizationBackprop_:function(t,e,n){const a={x:t,y:e,dy:n},o={depthRadius:arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,bias:arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,alpha:arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,beta:arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5};return r.T2.runKernel(i.ToN,a,o)}})},18688:(t,e,n)=>{"use strict";n.d(e,{R:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({log_:function(t){const e={x:(0,a.YT)(t,"x","log","float32")};return r.T2.runKernel(i.tG8,e)}})},90781:(t,e,n)=>{"use strict";n.d(e,{K:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({log1p_:function(t){const e={x:(0,a.YT)(t,"x","log1p")};return r.T2.runKernel(i.Cg$,e)}})},34675:(t,e,n)=>{"use strict";n.d(e,{n:()=>l});var r=n(57832),i=n(52863),a=n(86272),o=n(5008),s=n(26039),c=n(1242),u=n(22824);const l=(0,s.op)({logSigmoid_:function(t){const e=(0,i.YT)(t,"x","logSigmoid");return(0,r._X)((t=>({value:(0,o.H)((0,u.l)((0,o.H)(t))),gradFunc:e=>(0,a.l)(e,(0,c.r)((0,o.H)(t)))})))(e)}})},8229:(t,e,n)=>{"use strict";n.d(e,{H:()=>f});var r=n(57832),i=n(52863),a=n(69779),o=n(48389),s=n(18688),c=n(73e3),u=n(86272),l=n(26039),h=n(77820),d=n(17937);const f=(0,l.op)({logSoftmax_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=(0,i.YT)(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(e));return(0,r._X)(((t,n)=>{const r=(0,c.T)(t,e,!0),i=(0,h.j)(t,r),l=(0,h.j)((0,a.w)(i,"float32"),(0,s.R)((0,d.c)((0,o.o)(i),e,!0)));n([l]);return{value:l,gradFunc:(t,n)=>{const[r]=n,i=(0,o.o)(r);return(0,h.j)(t,(0,u.l)((0,d.c)(t,e,!0),i))}}}))(n)}})},45492:(t,e,n)=>{"use strict";n.d(e,{V:()=>p});var r=n(52863),i=n(23869),a=n(67281),o=n(58724),s=n(48389),c=n(18688),u=n(73e3),l=n(26039),h=n(89068),d=n(77820),f=n(17937);const p=(0,l.op)({logSumExp_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const l=(0,r.YT)(t,"x","logSumExp"),p=(0,i.Y6)(e,l.shape),g=(0,u.T)(l,p,!0),m=(0,d.j)(l,g),v=(0,s.o)(m),y=(0,f.c)(v,p),b=(0,c.R)(y),x=(0,a.W)((0,h.t)(g,b.shape),b);if(n){const t=(0,o.SM)(x.shape,p);return(0,h.t)(x,t)}return x}})},21183:(t,e,n)=>{"use strict";n.d(e,{n:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(84824);const s=(0,n(26039).op)({logicalAnd_:function(t,e){const n=(0,a.YT)(t,"a","logicalAnd","bool"),s=(0,a.YT)(e,"b","logicalAnd","bool");(0,o.assertAndGetBroadcastShape)(n.shape,s.shape);const c={a:n,b:s};return r.T2.runKernel(i.RUm,c)}})},87375:(t,e,n)=>{"use strict";n.d(e,{N:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({logicalNot_:function(t){const e={x:(0,a.YT)(t,"x","logicalNot","bool")};return r.T2.runKernel(i.nZd,e)}})},65497:(t,e,n)=>{"use strict";n.d(e,{z:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(84824);const s=(0,n(26039).op)({logicalOr_:function(t,e){const n=(0,a.YT)(t,"a","logicalOr","bool"),s=(0,a.YT)(e,"b","logicalOr","bool");(0,o.assertAndGetBroadcastShape)(n.shape,s.shape);const c={a:n,b:s};return r.T2.runKernel(i.LXA,c)}})},6699:(t,e,n)=>{"use strict";n.d(e,{r:()=>c});var r=n(52863),i=n(84824),a=n(21183),o=n(87375),s=n(65497);const c=(0,n(26039).op)({logicalXor_:function(t,e){const n=(0,r.YT)(t,"a","logicalXor","bool"),c=(0,r.YT)(e,"b","logicalXor","bool");return(0,i.assertAndGetBroadcastShape)(n.shape,c.shape),(0,a.n)((0,s.z)(t,e),(0,o.N)((0,a.n)(t,e)))}})},65849:(t,e,n)=>{"use strict";n.d(e,{N:()=>s});var r=n(37484),i=n(87311),a=n(48683),o=n(52863);const s=(0,n(26039).op)({matMul_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=(0,o.YT)(t,"a","matMul"),u=(0,o.YT)(e,"b","matMul");[c,u]=(0,a.makeTypesMatch)(c,u);const l={a:c,b:u},h={transposeA:n,transposeB:s};return r.T2.runKernel(i.jAQ,l,h)}})},73e3:(t,e,n)=>{"use strict";n.d(e,{T:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({max_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o={x:(0,a.YT)(t,"x","max")},s={reductionIndices:e,keepDims:n};return r.T2.runKernel(i.VAI,o,s)}})},8853:(t,e,n)=>{"use strict";n.d(e,{j:()=>l});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(157),c=n(26039),u=n(89068);const l=(0,c.op)({maxPool_:function(t,e,n,c,l){const h=(0,a.YT)(t,"x","maxPool");let d=h,f=!1;3===h.rank&&(f=!0,d=(0,u.t)(h,[1,h.shape[0],h.shape[1],h.shape[2]])),o.vA(4===d.rank,(()=>"Error in maxPool: input must be rank 4 but got rank ".concat(d.rank,"."))),o.vA(s.G0(n,1),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'"))),s.s_("maxPool",c,l);const p={x:d},g={filterSize:e,strides:n,pad:c,dimRoundingMode:l},m=r.T2.runKernel(i.t3d,p,g);return f?(0,u.t)(m,[m.shape[1],m.shape[2],m.shape[3]]):m}})},19530:(t,e,n)=>{"use strict";n.d(e,{s:()=>l});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(157),c=n(26039),u=n(89068);const l=(0,c.op)({maxPool3dGrad_:function(t,e,n,c,l,h,d){const f=(0,a.YT)(t,"dy","maxPool3dGrad"),p=(0,a.YT)(e,"input","maxPool3dGrad"),g=(0,a.YT)(n,"output","maxPool3dGrad");let m=f,v=p,y=g,b=!1;4===p.rank&&(b=!0,m=(0,u.t)(f,[1,f.shape[0],f.shape[1],f.shape[2],f.shape[3]]),v=(0,u.t)(p,[1,p.shape[0],p.shape[1],p.shape[2],p.shape[3]]),y=(0,u.t)(g,[1,g.shape[0],g.shape[1],g.shape[2],g.shape[3]])),o.vA(5===m.rank,(()=>"Error in maxPool3dGrad: dy must be rank 5 but got rank "+"".concat(m.rank,"."))),o.vA(5===v.rank,(()=>"Error in maxPool3dGrad: input must be rank 5 but got rank "+"".concat(v.rank,"."))),o.vA(5===y.rank,(()=>"Error in maxPool3dGrad: output must be rank 5 but got rank "+"".concat(y.rank,"."))),(0,s.s_)("maxPool3dGrad",h,d);const x={dy:m,input:v,output:y},w={filterSize:c,strides:l,pad:h,dimRoundingMode:d},k=r.T2.runKernel(i.cHb,x,w);return b?(0,u.t)(k,[k.shape[1],k.shape[2],k.shape[3],k.shape[4]]):k}})},3768:(t,e,n)=>{"use strict";n.d(e,{d:()=>c});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(157);const c=(0,n(26039).op)({maxPoolGrad_:function(t,e,n,c,u,l,h){const d=(0,a.YT)(t,"dy","maxPoolGrad"),f=(0,a.YT)(e,"input","maxPoolGrad"),p=(0,a.YT)(n,"output","maxPoolGrad");o.vA(f.rank===d.rank,(()=>"Rank of input (".concat(f.rank,") does not match rank of dy ")+"(".concat(d.rank,")"))),o.vA(4===d.rank,(()=>"Error in maxPoolGrad: dy must be rank 4 but got rank "+"".concat(d.rank,"."))),o.vA(4===f.rank,(()=>"Error in maxPoolGrad: input must be rank 4 but got rank "+"".concat(f.rank,"."))),s.s_("maxPoolGrad",l,h);const g={dy:d,input:f,output:p},m={filterSize:c,strides:u,pad:l,dimRoundingMode:h};return r.T2.runKernel(i.RXX,g,m)}})},98104:(t,e,n)=>{"use strict";n.d(e,{P:()=>u});var r=n(37484),i=n(87311),a=n(48683),o=n(52863),s=n(84824),c=n(69779);const u=(0,n(26039).op)({maximum_:function(t,e){let n=(0,o.YT)(t,"a","maximum"),u=(0,o.YT)(e,"b","maximum");[n,u]=(0,a.makeTypesMatch)(n,u),"bool"===n.dtype&&(n=(0,c.w)(n,"int32"),u=(0,c.w)(u,"int32")),(0,s.assertAndGetBroadcastShape)(n.shape,u.shape);const l={a:n,b:u};return r.T2.runKernel(i.LDN,l)}})},49577:(t,e,n)=>{"use strict";n.d(e,{i:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({mean_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o={x:(0,a.YT)(t,"x","mean")},s={axis:e,keepDims:n};return r.T2.runKernel(i.g5A,o,s)}})},60278:(t,e,n)=>{"use strict";n.d(e,{j:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({min_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o={x:(0,a.YT)(t,"x","min")},s={axis:e,keepDims:n};return r.T2.runKernel(i.lNG,o,s)}})},91086:(t,e,n)=>{"use strict";n.d(e,{B:()=>u});var r=n(37484),i=n(87311),a=n(48683),o=n(52863),s=n(84824),c=n(69779);const u=(0,n(26039).op)({minimum_:function(t,e){let n=(0,o.YT)(t,"a","minimum"),u=(0,o.YT)(e,"b","minimum");[n,u]=(0,a.makeTypesMatch)(n,u),"bool"===n.dtype&&(n=(0,c.w)(n,"int32"),u=(0,c.w)(u,"int32")),(0,s.assertAndGetBroadcastShape)(n.shape,u.shape);const l={a:n,b:u};return r.T2.runKernel(i.LG0,l)}})},32509:(t,e,n)=>{"use strict";n.d(e,{F:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({mirrorPad_:function(t,e,n){o.vA("reflect"===n||"symmetric"===n,(()=>"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,".")));const s=(0,a.YT)(t,"x","mirrorPad");if(0===s.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");o.vA(e.length===s.rank,(()=>"Padding doesn't match input. Must be ".concat(s.rank,". ")+"Got ".concat(e.length,".")));const c="reflect"===n?1:0;for(let r=0;r<s.rank;r++)o.vA(2===e[r].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),o.vA(e[r][0]>=0&&e[r][0]<=s.shape[r]-c&&e[r][1]>=0&&e[r][1]<=s.shape[r]-c,(()=>"Padding in dimension ".concat(r," cannot be greater than or equal ")+"to ".concat(s.shape[r]-c," or less than 0 for input of ")+"shape ".concat(s.shape)));const u={paddings:e,mode:n},l={x:s};return r.T2.runKernel(i.x7F,l,u)}})},5634:(t,e,n)=>{"use strict";n.d(e,{z:()=>s});var r=n(37484),i=n(87311),a=n(48683),o=n(52863);const s=(0,n(26039).op)({mod_:function(t,e){let n=(0,o.YT)(t,"a","mod"),s=(0,o.YT)(e,"b","mod");[n,s]=(0,a.makeTypesMatch)(n,s);const c={a:n,b:s};return r.T2.runKernel(i.BLA,c)}})},86272:(t,e,n)=>{"use strict";n.d(e,{l:()=>s});var r=n(37484),i=n(87311),a=n(48683),o=n(52863);const s=(0,n(26039).op)({mul_:function(t,e){let n=(0,o.YT)(t,"a","mul"),s=(0,o.YT)(e,"b","mul");[n,s]=(0,a.makeTypesMatch)(n,s);const c={a:n,b:s};return r.T2.runKernel(i.xu7,c)}})},5008:(t,e,n)=>{"use strict";n.d(e,{H:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({neg_:function(t){const e={x:(0,a.YT)(t,"x","neg")};return r.T2.runKernel(i.l0G,e)}})},48306:(t,e,n)=>{"use strict";n.d(e,{x:()=>v});var r=n(52863),i=n(23869),a=n(59470),o=n(58724),s=n(73e3),c=n(60278),u=n(26039),l=n(78188),h=n(89068),d=n(90844),f=n(45766),p=n(95195),g=n(17937);function m(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===t.rank)return(0,a.t)(t);if(1!==t.rank&&null===n)return m((0,h.t)(t,[-1]),e,n);if(1===t.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===e)return(0,g.c)((0,a.t)(t),n);if(e===1/0)return(0,s.T)((0,a.t)(t),n);if(e===-1/0)return(0,c.j)((0,a.t)(t),n);if("euclidean"===e||2===e)return(0,f.R)((0,g.c)((0,l.n)((0,a.t)(t),(0,d.d)(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(e))}if(Array.isArray(n)&&2===n.length){if(1===e)return(0,s.T)((0,g.c)((0,a.t)(t),n[0]),n[1]-1);if(e===1/0)return(0,s.T)((0,g.c)((0,a.t)(t),n[1]),n[0]);if(e===-1/0)return(0,c.j)((0,g.c)((0,a.t)(t),n[1]),n[0]);if("fro"===e||"euclidean"===e)return(0,f.R)((0,g.c)((0,p.E)(t),n));throw new Error("Error in norm: invalid ord value: ".concat(e))}throw new Error("Error in norm: invalid axis: ".concat(n))}const v=(0,u.op)({norm_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=m(t=(0,r.YT)(t,"x","norm"),e,n);let c=s.shape;if(a){const e=(0,i.Y6)(n,t.shape);c=o.SM(s.shape,e)}return(0,h.t)(s,c)}})},73848:(t,e,n)=>{"use strict";n.d(e,{E:()=>c});var r=n(37484),i=n(87311),a=n(48683),o=n(52863),s=n(84824);const c=(0,n(26039).op)({notEqual_:function(t,e){let n=(0,o.YT)(t,"a","notEqual","string_or_numeric"),c=(0,o.YT)(e,"b","notEqual","string_or_numeric");[n,c]=(0,a.makeTypesMatch)(n,c),(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);const u={a:n,b:c};return r.T2.runKernel(i.ylV,u)}})},48926:(t,e,n)=>{"use strict";n.d(e,{M:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({oneHot_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"int32";if(e<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(e));const c={indices:(0,a.YT)(t,"indices","oneHot","int32")},u={dtype:s,depth:e,onValue:n,offValue:o};return r.T2.runKernel(i.urI,c,u)}})},88865:(t,e,n)=>{"use strict";n.d(e,{S:()=>s});var r=n(37484),i=n(23869),a=n(76234),o=n(38197);function s(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if((0,i.SA)(t),"complex64"===e){const e=s(t,"float32"),n=(0,o.U)(t,"float32");return(0,a.f)(e,n)}const n=(0,i.FZ)((0,i.Ze)(t),e);return r.T2.makeTensor(n,t,e)}},98903:(t,e,n)=>{"use strict";n.d(e,{P:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({onesLike_:function(t){const e={x:(0,a.YT)(t,"x","onesLike")};return r.T2.runKernel(i.LWX,e)}})},26039:(t,e,n)=>{"use strict";n.d(e,{B:()=>a,op:()=>o});var r=n(37484),i=n(23869);const a="__op";function o(t){const e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(e.length," keys."));let n=e[0];const o=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=a;const s=function(){r.T2.startScope(n);try{const t=o(...arguments);return(0,i.yL)(t)&&console.error("Cannot return a Promise inside of tidy."),r.T2.endScope(t),t}catch(t){throw r.T2.endScope(null),t}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}},67507:(t,e,n)=>{"use strict";n.d(e,{e:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({pad_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=(0,a.YT)(t,"x","pad");if(0===o.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:n},c={x:o};return r.T2.runKernel(i.ODT,c,s)}})},18570:(t,e,n)=>{"use strict";n.d(e,{d:()=>d});var r=n(52863),i=n(23869),a=n(70963),o=n(81406),s=n(157),c=n(8853),u=n(26039),l=n(89068),h=n(90602);const d=(0,u.op)({pool_:function(t,e,n,u,d,f,p){null==d&&(d=[1,1]),null==f&&(f=1),0===u&&(u="valid");const g=(0,r.YT)(t,"x","maxPool");let m=g,v=!1;3===g.rank&&(v=!0,m=(0,l.t)(g,[1,g.shape[0],g.shape[1],g.shape[2]])),i.vA(s.G0(f,d),(()=>"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(f," and dilations '").concat(d,"'")));const y=s.E6(m.shape,e,f,d,u),b=[y.dilationHeight,y.dilationWidth];let x;x="same"===u?function(t,e){const n=t.map(((t,n)=>t+(t-1)*(e[n]-1))),r=n.map((t=>t-1)),i=r.map((t=>Math.floor(t/2))),a=r.map(((t,e)=>t-i[e]));return r.map(((t,e)=>[i[e],a[e]]))}([y.filterHeight,y.filterWidth],b):[[0,0],[0,0]];const w=1===b[0]&&1===b[1],[k,_]=function(t,e,n){const r=n.map((t=>t[0])),i=n.map((t=>t[1])),a=t.concat(r,i),o=e.map(((t,e)=>(t-a[e]%t)%t)),s=i.map(((t,e)=>t+o[e])),c=e.map(((t,e)=>[r[e],s[e]])),u=e.map(((t,e)=>[0,o[e]]));return[c,u]}([y.inHeight,y.inWidth],b,x),A=w?u:"valid",C=w?m:(0,h.e)(m,b,k),S=("avg"===n?()=>(0,a.$)(C,e,f,A,p):()=>(0,c.j)(C,e,f,A,p))(),E=w?S:(0,o.G)(S,b,_);return v?(0,l.t)(E,[E.shape[1],E.shape[2],E.shape[3]]):E}})},78188:(t,e,n)=>{"use strict";n.d(e,{n:()=>s});var r=n(37484),i=n(87311),a=n(48683),o=n(52863);const s=(0,n(26039).op)({pow_:function(t,e){let n=(0,o.YT)(t,"base","pow"),s=(0,o.YT)(e,"exp","pow");[n,s]=(0,a.makeTypesMatch)(n,s);const c={a:n,b:s};return r.T2.runKernel(i.pyJ,c)}})},83860:(t,e,n)=>{"use strict";n.d(e,{N:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({prelu_:function(t,e){const n={x:(0,a.YT)(t,"x","prelu"),alpha:(0,a.YT)(e,"alpha","prelu")};return r.T2.runKernel(i.Ncv,n)}})},30629:(t,e,n)=>{"use strict";function r(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(t.toString(e))}n.d(e,{y:()=>r})},38517:(t,e,n)=>{"use strict";n.d(e,{_:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(69779);const s=(0,n(26039).op)({prod_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=(0,a.YT)(t,"x","prod");"bool"===s.dtype&&(s=(0,o.w)(s,"int32"));const c={x:s},u={axis:e,keepDims:n};return r.T2.runKernel(i.kdj,c,u)}})},86372:(t,e,n)=>{"use strict";n.d(e,{x:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({real_:function(t){const e={input:(0,a.YT)(t,"input","real")};return r.T2.runKernel(i.LRy,e)}})},95868:(t,e,n)=>{"use strict";n.d(e,{V:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({reciprocal_:function(t){const e={x:(0,a.YT)(t,"x","reciprocal")};return r.T2.runKernel(i.huO,e)}})},38414:(t,e,n)=>{"use strict";n.d(e,{V:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({relu_:function(t){const e={x:(0,a.YT)(t,"x","relu")};return r.T2.runKernel(i.fUj,e)}})},6650:(t,e,n)=>{"use strict";n.d(e,{j:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({relu6_:function(t){const e={x:(0,a.YT)(t,"x","relu6")};return r.T2.runKernel(i.P_L,e)}})},89068:(t,e,n)=>{"use strict";n.d(e,{t:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({reshape_:function(t,e){const n={x:(0,a.YT)(t,"x","reshape","string_or_numeric")},o={shape:e};return r.T2.runKernel(i.R23,n,o)}})},23540:(t,e,n)=>{"use strict";n.d(e,{B:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({reverse_:function(t,e){const n={x:(0,a.YT)(t,"x","reverse")},o={dims:e};return r.T2.runKernel(i.D7i,n,o)}})},16242:(t,e,n)=>{"use strict";n.d(e,{L:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({round_:function(t){const e={x:(0,a.YT)(t,"x","round")};return r.T2.runKernel(i.hVg,e)}})},30414:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({rsqrt_:function(t){const e={x:(0,a.YT)(t,"x","rsqrt","float32")};return r.T2.runKernel(i.TOR,e)}})},90844:(t,e,n)=>{"use strict";n.d(e,{d:()=>a});var r=n(73837),i=n(47921);function a(t,e){if(((0,r.isTypedArray)(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&(0,r.isTypedArray)(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return(0,i.Q)(t,[],[],e)}},52203:(t,e,n)=>{"use strict";n.d(e,{W:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({selu_:function(t){const e={x:(0,a.YT)(t,"x","selu")};return r.T2.runKernel(i.u$b,e)}})},84102:(t,e,n)=>{"use strict";n.d(e,{X:()=>i,j:()=>r});const r=1.7580993408473768,i=1.0507009873554805},848:(t,e,n)=>{"use strict";n.d(e,{w:()=>u});var r=n(52863),i=n(23869),a=n(31880),o=n(92302),s=n(26039),c=n(89068);const u=(0,s.op)({separableConv2d_:function(t,e,n,s,u){let l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC";const d=(0,r.YT)(t,"x","separableConv2d"),f=(0,r.YT)(e,"depthwiseFilter","separableConv2d"),p=(0,r.YT)(n,"pointwiseFilter","separableConv2d");let g=d,m=!1;if(3===d.rank&&(m=!0,g=(0,c.t)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),"NCHW"===h)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");i.vA(4===g.rank,(()=>"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(g.rank,"."))),i.vA(4===f.rank,(()=>"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(f.rank,"."))),i.vA(4===p.rank,(()=>"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(f.rank,"."))),i.vA(1===p.shape[0],(()=>"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(p.shape[0],"."))),i.vA(1===p.shape[1],(()=>"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(p.shape[1],".")));const v=f.shape[2],y=f.shape[3];i.vA(p.shape[2]===v*y,(()=>"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(v*y,", ")+"but got ".concat(p.shape[2],".")));const b=(0,o.G)(g,f,s,u,h,l),x=(0,a.X)(b,p,1,"valid",h);return m?(0,c.t)(x,[x.shape[1],x.shape[2],x.shape[3]]):x}})},1242:(t,e,n)=>{"use strict";n.d(e,{r:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({sigmoid_:function(t){const e={x:(0,a.YT)(t,"x","sigmoid","float32")};return r.T2.runKernel(i.vI1,e)}})},5601:(t,e,n)=>{"use strict";n.d(e,{_:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({sign_:function(t){const e={x:(0,a.YT)(t,"x","sign")};return r.T2.runKernel(i.YVe,e)}})},85956:(t,e,n)=>{"use strict";n.d(e,{F:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({sin_:function(t){const e={x:(0,a.YT)(t,"x","sin","float32")};return r.T2.runKernel(i.hql,e)}})},15990:(t,e,n)=>{"use strict";n.d(e,{L:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({sinh_:function(t){const e={x:(0,a.YT)(t,"x","sinh")};return r.T2.runKernel(i.J3C,e)}})},8016:(t,e,n)=>{"use strict";n.d(e,{d:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({slice_:function(t,e,n){const o=(0,a.YT)(t,"x","slice","string_or_numeric");if(0===o.rank)throw new Error("Slicing scalar is not possible");const s={x:o},c={begin:e,size:n};return r.T2.runKernel(i.JiE,s,c)}})},48791:(t,e,n)=>{"use strict";n.r(e),n.d(e,{assertParamsValid:()=>o,computeFlatOffset:()=>b,computeOutShape:()=>c,getNormalizedAxes:()=>d,isSliceContinous:()=>y,maskToAxes:()=>s,parseSliceParams:()=>x,sliceInfo:()=>w,startForAxis:()=>m,startIndicesWithElidedDims:()=>f,stopForAxis:()=>v,stopIndicesWithElidedDims:()=>p,stridesForAxis:()=>g,stridesWithElidedDims:()=>u});var r=n(23869);const i=-2,a=-1;function o(t,e,n){const i=t.shape.length;r.vA(i===e.length,(()=>"Error in slice".concat(i,"D: Length of begin ").concat(e," must ")+"match the rank of the array (".concat(i,")."))),r.vA(i===n.length,(()=>"Error in slice".concat(i,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(i,").")));for(let a=0;a<i;++a)r.vA(e[a]+n[a]<=t.shape[a],(()=>"Error in slice".concat(i,"D: begin[").concat(a,"] + size[").concat(a,"] ")+"(".concat(e[a]+n[a],") would overflow input.shape[").concat(a,"] (").concat(t.shape[a],")")))}function s(t){const e=[];let n=0;for(;t>0;)1&t&&e.push(n),t/=2,n++;return e}function c(t,e,n){const r=[];for(let i=0;i<t.length;i++)r[i]=Math.ceil((e[i]-t[i])/n[i]);return r}function u(t,e,n,r){const i=[...t];for(let a=i.length;a<r.length;a++)i.push(1);for(let a=0;a<n;a++)0===a?i[e]=1:(i.splice(e,0,1),i.pop());return i}function l(t,e,n){return n<=t?n:n-(e-1)}function h(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function d(t,e,n,r,i,a,o,s,c){const l=t.length;let h=new Array(l),d=new Array(l),y=new Array(l);if(e.length&&n>0){const c=e[0],l=n+1;h=f(o,c,l,r,t),d=p(s,c,l,i,t),y=u(a,c,l,t)}else for(let u=0;u<l;u++)h[u]=m(o,r,a,t,u,c),d[u]=v(s,i,a,t,u,c),y[u]=g(a,u,c);return{begin:h,end:d,strides:y}}function f(t,e,n,r,i){const a=[...i],o=h(n,e);for(let s=0;s<a.length;s++)if(o.indexOf(s)>-1)a[s]=0;else{const i=l(e,n,s);let o=r[i];t&1<<i&&(o=0),a[s]=o}return a}function p(t,e,n,i,a){const o=[...a],s=h(n,e);for(let r=0;r<o.length;r++)if(s.indexOf(r)>-1)o[r]=Number.MAX_SAFE_INTEGER;else{const a=l(e,n,r);let s=i[a];t&1<<a&&(s=Number.MAX_SAFE_INTEGER),o[r]=s}for(let c=0;c<o.length;c++){const t=a[c];o[c]<0&&(o[c]+=t),o[c]=r.qE(0,o[c],a[c])}return o}function g(t,e,n){let r=t[e];return(n&1<<e||null==r)&&(r=1),r}function m(t,e,n,i,a,o){let s=e[a];const c=n[a]||1;(t&1<<a||o&1<<a||null==s)&&(s=c>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const u=i[a];return s<0&&(s+=u),s=r.qE(0,s,u-1),s}function v(t,e,n,i,a,o){let s=e[a];const c=n[a]||1;(t&1<<a||o&1<<a||null==s)&&(s=c>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const u=i[a];return s<0&&(s+=u),s=c>0?r.qE(0,s,u):r.qE(-1,s,u-1),s}function y(t,e,n){let r=n.length;for(let i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(let i=r+1;i<n.length;i++)if(e[i]>0||n[i]!==t[i])return!1;return!0}function b(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function x(t,e,n){let i;const a=t.shape.length;let o;return i="number"===typeof e?[e,...new Array(a-1).fill(0)]:e.length<a?e.concat(new Array(a-e.length).fill(0)):e.slice(),i.forEach((t=>{r.vA(-1!==t,(()=>"slice() does not support negative begin indexing."))})),o=null==n?new Array(a).fill(-1):"number"===typeof n?[n,...new Array(a-1).fill(-1)]:n.length<a?n.concat(new Array(a-n.length).fill(-1)):n,o=o.map(((e,n)=>e>=0?e:(r.vA(-1===e,(()=>"Negative size values should be exactly -1 but got "+"".concat(e," for the slice() size at index ").concat(n,"."))),t.shape[n]-i[n]))),[i,o]}function w(t,e,n,r,o,s,c,u,l){let h;if(null==r?(h=new Array(e.length),h.fill(1)):h=r,null!=c&&0!==(c&c-1))throw new Error("Multiple ellipses in slice is not allowed.");let d=!1;const f={dims:h.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:h.slice(),beginMask:o,endMask:s,ellipsisMask:c,newAxisMask:u,shrinkAxisMask:l};for(let i=0;i<f.dims;i++)d&&0!==(1<<i&u)&&f.numAddAxisAfterEllipsis++,1<<i&c&&(d=!0);d||(f.ellipsisMask|=1<<f.dims,f.dims++);const p={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=null!=t.begin,e.endValid=null!=t.end,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const i=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<i;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(i),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error("Index out of range using input dim ".concat(n,"; input ")+"has only ".concat(e.dims," dims, ").concat(e.begin.length,"."));null!=t.begin&&(e.begin[n]=t.begin[r]),null!=t.end&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(a),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}(f,p);let g=!0,m=!0,v=!0;const y=[],b=[];for(let i=0;i<t.length;++i){if(0===p.strides[i])throw Error("strides[".concat(i,"] must be non-zero"));const e=!!(p.shrinkAxisMask&1<<i),n=t[i];if(-1===n){y.push(e?1:-1);continue}const r=[p.beginMask&1<<i,p.endMask&1<<i],a=[p.strides[i]>0?0:-1,p.strides[i]>0?n:n-1];if(e&&p.strides[i]<=0)throw Error("only stride 1 allowed on non-range indexing.");v=v&&1===p.strides[i];const o=!!(p.beginMask&1<<i&&p.endMask&1<<i);if(p.beginValid&&p.endValid){if(e){const t=p.begin[i]<0?n+p.begin[i]:p.begin[i];if(p.begin[i]=t,p.end[i]=p.begin[i]+1,t<0||t>=n)throw Error("slice index ".concat(p.begin[i]," of dimension ").concat(i," out of bounds."))}else p.begin[i]=k(p.begin[i],0,p.strides[i],n,r,a),p.end[i]=k(p.end[i],1,p.strides[i],n,r,a);const t=1===p.strides[i]&&0===p.begin[i]&&p.end[i]===n;g=g&&t,m=m&&(0===i&&1===p.strides[i]||t)}else g=g&&1===p.strides[i]&&o,m=m&&(0===i&&1===p.strides[i]||o);let s,c=!1;if(p.beginValid&&p.endValid?(s=p.end[i]-p.begin[i],c=!0):e?(s=1,c=!0):o&&n>=0&&(s=p.strides[i]<0?-n:n,c=!0),c){let t;t=0===s||s<0!==p.strides[i]<0?0:Math.trunc(s/p.strides[i])+(s%p.strides[i]!==0?1:0),y.push(t)}else y.push(-1)}for(let a=0;a<p.finalShapeGatherIndices.length;++a){const t=p.finalShapeGatherIndices[a];t>=0?b.push(y[t]):t===i&&b.push(1)}return{finalShapeSparse:b.filter(((t,e)=>p.finalShapeGatherIndices[e]!==i)),finalShape:b,isIdentity:g,sliceDim0:m,isSimpleSlice:v,begin:p.begin,end:p.end,strides:p.strides}}function k(t,e,n,r,i,a){if(i[e])return n>0?a[e]:a[e+1&1];{const e=t<0?r+t:t;return e<a[0]?a[0]:e>a[1]?a[1]:e}}},80724:(t,e,n)=>{"use strict";n.d(e,{V:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({softmax_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=(0,a.YT)(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(e));const o={logits:n},s={dim:e};return r.T2.runKernel(i.rFG,o,s)}})},22824:(t,e,n)=>{"use strict";n.d(e,{l:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({softplus_:function(t){const e={x:(0,a.YT)(t,"x","softplus")};return r.T2.runKernel(i.Fin,e)}})},90602:(t,e,n)=>{"use strict";n.d(e,{e:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({spaceToBatchND_:function(t,e,n){const s=(0,a.YT)(t,"x","spaceToBatchND");o.vA(s.rank>=1+e.length,(()=>"input rank ".concat(s.rank," should be > than [blockShape] ").concat(e.length))),o.vA(n.length===e.length,(()=>"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(e.length))),o.vA(s.shape.reduce(((t,r,i)=>i>0&&i<=e.length?t&&(r+n[i-1][0]+n[i-1][1])%e[i-1]===0:t),!0),(()=>"input spatial dimensions ".concat(s.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(e.toString())));const c={x:s},u={blockShape:e,paddings:n};return r.T2.runKernel(i.A8B,c,u)}})},42587:(t,e,n)=>{"use strict";n.d(e,{h:()=>o});var r=n(37484),i=n(87311),a=n(23869);const o=(0,n(26039).op)({fft_:function(t){(0,a.vA)("complex64"===t.dtype,(()=>"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(t.dtype,".")));const e={input:t};return r.T2.runKernel(i.rGP,e)}})},93674:(t,e,n)=>{"use strict";n.d(e,{K:()=>o});var r=n(37484),i=n(87311),a=n(23869);const o=(0,n(26039).op)({ifft_:function(t){(0,a.vA)("complex64"===t.dtype,(()=>"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(t.dtype,".")));const e={input:t};return r.T2.runKernel(i.OAQ,e)}})},30890:(t,e,n)=>{"use strict";n.d(e,{g:()=>p});var r=n(76234),i=n(89360),a=n(66758),o=n(86272),s=n(26039),c=n(86372),u=n(89068),l=n(23540),h=n(90844),d=n(8016),f=n(93674);const p=(0,s.op)({irfft_:function(t){const e=t.shape[t.shape.length-1],n=t.size/e;let s;if(e<=2){const r=(0,u.t)(t,[n,e]);s=(0,f.K)(r)}else{const p=[n,2*(e-1)],g=(0,u.t)((0,c.x)(t),[n,e]),m=(0,u.t)((0,a.n)(t),[n,e]),v=(0,l.B)((0,d.d)(g,[0,1],[n,e-2]),1),y=(0,o.l)((0,l.B)((0,d.d)(m,[0,1],[n,e-2]),1),(0,h.d)(-1)),b=(0,i.x)([g,v],1),x=(0,i.x)([m,y],1),w=(0,u.t)((0,r.f)(b,x),[p[0],p[1]]);s=(0,f.K)(w)}if(s=(0,c.x)(s),3===t.rank&&0!==t.shape[0]){const e=s,n=t.shape[0];s=(0,u.t)(s,[n,s.shape[0]/n,s.shape[1]]),e.dispose()}return s}})},35721:(t,e,n)=>{"use strict";n.d(e,{z:()=>g});var r=n(23869),i=n(76234),a=n(89360),o=n(66758),s=n(26039),c=n(86372),u=n(89068),l=n(8016),h=n(77554),d=n(38197),f=n(90043),p=n(42587);const g=(0,s.op)({rfft_:function(t,e){(0,r.vA)("float32"===t.dtype,(()=>"The dtype for rfft() must be real value but got ".concat(t.dtype)));let n=t.shape[t.shape.length-1];const s=t.size/n;let g;if(null!=e&&e<n){const r=t.shape.map((t=>0)),i=t.shape.map((t=>t));i[t.shape.length-1]=e,g=(0,l.d)(t,r,i),n=e}else if(null!=e&&e>n){const r=t.shape.map((t=>t));r[t.shape.length-1]=e-n,g=(0,a.x)([t,(0,d.U)(r)],t.shape.length-1),n=e}else g=t;const m=(0,f.P)(g),v=(0,u.t)((0,i.f)(g,m),[s,n]),y=(0,p.h)(v),b=Math.floor(n/2)+1,x=(0,c.x)(y),w=(0,o.n)(y),k=(0,h.l)(x,[b,n-b],x.shape.length-1),_=(0,h.l)(w,[b,n-b],w.shape.length-1),A=g.shape.slice();return A[g.shape.length-1]=b,(0,u.t)((0,i.f)(k[0],_[0]),A)}})},77554:(t,e,n)=>{"use strict";n.d(e,{l:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({split_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o={x:(0,a.YT)(t,"x","split")},s={numOrSizeSplits:e,axis:n};return r.T2.runKernel(i.Blb,o,s)}})},45766:(t,e,n)=>{"use strict";n.d(e,{R:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({sqrt_:function(t){const e={x:(0,a.YT)(t,"x","sqrt","float32")};return r.T2.runKernel(i.dFH,e)}})},95195:(t,e,n)=>{"use strict";n.d(e,{E:()=>a});var r=n(37484),i=n(52863);const a=(0,n(26039).op)({square_:function(t){const e=(0,i.YT)(t,"x","square");return r.T2.runKernel("Square",{x:e},{})}})},77189:(t,e,n)=>{"use strict";n.d(e,{P:()=>c});var r=n(37484),i=n(87311),a=n(48683),o=n(52863),s=n(84824);const c=(0,n(26039).op)({squaredDifference_:function(t,e){let n=(0,o.YT)(t,"a","squaredDifference"),c=(0,o.YT)(e,"b","squaredDifference");[n,c]=(0,a.makeTypesMatch)(n,c),(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);const u={a:n,b:c};return r.T2.runKernel(i.Ddj,u,{})}})},2330:(t,e,n)=>{"use strict";n.d(e,{r:()=>s});var r=n(52863),i=n(23869),a=n(26039),o=n(89068);const s=(0,a.op)({squeeze_:function(t,e){const n=(0,r.YT)(t,"x","squeeze","string_or_numeric");return(0,o.t)(n,(0,i.gx)(n.shape,e).newShape)}})},22190:(t,e,n)=>{"use strict";n.d(e,{t:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({stack_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(0,a.j1)(t,"tensors","stack","string_or_numeric");o.vA(n.length>=1,(()=>"Pass at least one tensor to tf.stack")),n.length>0&&o.vA(e<=n[0].rank,(()=>"Axis must be <= rank of the tensor"));const s=n,c={axis:e};return r.T2.runKernel(i.mM$,s,c)}})},52946:(t,e,n)=>{"use strict";n.d(e,{P:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({step_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:(0,a.YT)(t,"x","step")},o={alpha:e};return r.T2.runKernel(i.pnw,n,o)}})},57136:(t,e,n)=>{"use strict";n.d(e,{Y:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({stridedSlice_:function(t,e,n,o){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;const d={x:(0,a.YT)(t,"x","stridedSlice","string_or_numeric")},f={begin:e,end:n,strides:o,beginMask:s,endMask:c,ellipsisMask:u,newAxisMask:l,shrinkAxisMask:h};return r.T2.runKernel(i.UcO,d,f)}})},77820:(t,e,n)=>{"use strict";n.d(e,{j:()=>s});var r=n(37484),i=n(87311),a=n(48683),o=n(52863);const s=(0,n(26039).op)({sub_:function(t,e){let n=(0,o.YT)(t,"a","sub"),s=(0,o.YT)(e,"b","sub");[n,s]=(0,a.makeTypesMatch)(n,s);const c={a:n,b:s};return r.T2.runKernel(i.PbM,c)}})},17937:(t,e,n)=>{"use strict";n.d(e,{c:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(69779);const s=(0,n(26039).op)({sum_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=(0,a.YT)(t,"x","sum");"bool"===s.dtype&&(s=(0,o.w)(s,"int32"));const c={x:s},u={axis:e,keepDims:n};return r.T2.runKernel(i.WuN,c,u)}})},66465:(t,e,n)=>{"use strict";n.d(e,{M:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({tan_:function(t){const e={x:(0,a.YT)(t,"x","tan","float32")};return r.T2.runKernel(i.oFs,e)}})},47173:(t,e,n)=>{"use strict";n.d(e,{y:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({tanh_:function(t){const e={x:(0,a.YT)(t,"x","tanh","float32")};return r.T2.runKernel(i.iuW,e)}})},98869:(t,e,n)=>{"use strict";n.d(e,{O:()=>a});var r=n(52863),i=n(47921);function a(t,e,n){const a=(0,r.MZ)(t,n);return(0,i.Q)(t,e,a,n)}},47921:(t,e,n)=>{"use strict";n.d(e,{Q:()=>s});var r=n(37484),i=n(15188),a=n(23869),o=n(73837);function s(t,e,n,s){if(null==s)s=(0,a.X$)(t);else if("complex64"===s)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if((0,i.Nw)(t)||(0,i.Oj)(t)){if("float32"!==s&&"int32"!==s)throw new Error("Creating tensor from GPU data only supports "+"'float32'|'int32' dtype, while the dtype is ".concat(s,"."));return r.T2.backend.createTensorFromGPUData(t,e||n,s)}if(!(0,o.isTypedArray)(t)&&!Array.isArray(t)&&"number"!==typeof t&&"boolean"!==typeof t&&"string"!==typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){(0,a.SA)(e);const t=(0,a.Ze)(e),r=(0,a.Ze)(n);(0,a.vA)(t===r,(()=>"Based on the provided shape, [".concat(e,"], the tensor should have ")+"".concat(t," values but has ").concat(r)));for(let i=0;i<n.length;++i){const t=n[i],r=i!==n.length-1||t!==(0,a.Ze)(e.slice(i));(0,a.vA)(n[i]===e[i]||!r,(()=>"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(e,"). ")))}}return(0,o.isTypedArray)(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==s?(0,o.toTypedArray)(t,s):(0,o.flatten)(t,[],!0),r.T2.makeTensor(t,e,s)}},35716:(t,e,n)=>{"use strict";n.d(e,{V:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({tile_:function(t,e){const n=(0,a.YT)(t,"x","tile","string_or_numeric");o.vA(n.rank===e.length,(()=>"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(e,".")));const s={x:n},c={reps:e};return r.T2.runKernel(i.FAs,s,c)}})},87984:(t,e,n)=>{"use strict";n.d(e,{r:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({topk_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=(0,a.YT)(t,"x","topk");if(0===o.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const s=o.shape[o.shape.length-1];if(e<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(e));if(e>s)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(s,") ")+"but got ".concat(e));const c={x:o},u={k:e,sorted:n},[l,h]=r.T2.runKernel(i.TBb,c,u);return{values:l,indices:h}}})},15977:(t,e,n)=>{"use strict";n.d(e,{m:()=>f});var r=n(37484),i=n(23129),a=n(87311),o=n(52863),s=n(23869),c=n(76234),u=n(66758),l=n(5008),h=n(26039),d=n(86372);const f=(0,h.op)({transpose_:function(t,e,n){const h=(0,o.YT)(t,"x","transpose");if(null==e&&(e=h.shape.map(((t,e)=>e)).reverse()),s.vA(h.rank===e.length,(()=>"Error in transpose: rank of input ".concat(h.rank," ")+"must match length of perm ".concat(e,"."))),e.forEach((t=>{s.vA(t>=0&&t<h.rank,(()=>"All entries in 'perm' must be between 0 and ".concat(h.rank-1)+" but got ".concat(e)))})),h.rank<=1)return h.clone();const f={x:h},p={perm:e};return"complex64"===h.dtype?(0,i.DZ)((()=>{let t=(0,d.x)(h),e=(0,u.n)(h);return t=r.T2.runKernel(a.wx0,{x:t},p),e=r.T2.runKernel(a.wx0,{x:e},p),n&&(e=(0,l.H)(e)),(0,c.f)(t,e)})):r.T2.runKernel(a.wx0,f,p)}})},68583:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({unique_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(0,a.YT)(t,"x","unique","string_or_numeric");(0,o.vA)(n.rank>0,(()=>"The input tensor must be at least 1D"));const s={x:n},c={axis:e},[u,l]=r.T2.runKernel(i.EwU,s,c);return{values:u,indices:l}}})},66788:(t,e,n)=>{"use strict";n.d(e,{z:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({unsortedSegmentSum_:function(t,e,n){const s=(0,a.YT)(t,"x","unsortedSegmentSum"),c=(0,a.YT)(e,"segmentIds","unsortedSegmentSum","int32");(0,o.vA)((0,o.E6)(n),(()=>"numSegments must be of dtype int"));const u={x:s,segmentIds:c},l={numSegments:n};return r.T2.runKernel(i.pPe,u,l)}})},84491:(t,e,n)=>{"use strict";n.d(e,{K:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({unstack_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(0,a.YT)(t,"x","unstack","string_or_numeric");o.vA(e>=-n.shape.length&&e<n.shape.length,(()=>"Axis = ".concat(e," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")));const s={value:n},c={axis:e};return r.T2.runKernel(i.dXR,s,c)}})},52117:(t,e,n)=>{"use strict";n.d(e,{_:()=>c});var r=n(37484),i=n(87311),a=n(52863),o=n(99965),s=n(84824);const c=(0,n(26039).op)({where_:function(t,e,n){const c=(0,a.YT)(e,"a","where"),u=(0,a.YT)(n,"b","where"),l=(0,a.YT)(t,"condition","where","bool"),h=(0,s.assertAndGetBroadcastShape)((0,s.assertAndGetBroadcastShape)(l.shape,c.shape),u.shape),d={condition:(0,o.h)(l,h),t:(0,o.h)(c,h),e:(0,o.h)(u,h)};return r.T2.runKernel(i.l6P,d)}})},38197:(t,e,n)=>{"use strict";n.d(e,{U:()=>o});var r=n(37484),i=n(23869),a=n(76234);function o(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if((0,i.SA)(t),"complex64"===e){const e=o(t,"float32"),n=o(t,"float32");return(0,a.f)(e,n)}const n=(0,i.Ty)((0,i.Ze)(t),e);return r.T2.makeTensor(n,t,e)}},90043:(t,e,n)=>{"use strict";n.d(e,{P:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({zerosLike_:function(t){const e={x:(0,a.YT)(t,"x","zerosLike")};return r.T2.runKernel(i.xJ3,e)}})},52342:(t,e,n)=>{"use strict";n.d(e,{K:()=>d});var r=n(37484),i=n(23129),a=n(67281),o=n(64113),s=n(86272),c=n(45766),u=n(95195),l=n(90043),h=n(59777);class d extends h.E{static get className(){return"Adadelta"}constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(),this.learningRate=t,this.rho=e,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=r.T2.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const h=r.T2.registeredVariables[e];null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:"".concat(e,"/accum_grad"),variable:(0,i.DZ)((()=>(0,l.P)(h).variable(false)))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:"".concat(e,"/accum_var"),variable:(0,i.DZ)((()=>(0,l.P)(h).variable(false)))});const d=Array.isArray(t)?t[n].tensor:t[e];if(null==d)return;const f=this.accumulatedGrads[n].variable,p=this.accumulatedUpdates[n].variable;(0,i.DZ)((()=>{const t=(0,a.W)((0,s.l)(f,this.rho),(0,s.l)((0,u.E)(d),1-this.rho)),e=(0,s.l)((0,o.y)((0,c.R)((0,a.W)(p,this.epsilon)),(0,c.R)((0,a.W)(f,this.epsilon))),d),n=(0,a.W)((0,s.l)(p,this.rho),(0,s.l)((0,u.E)(e),1-this.rho));f.assign(t),p.assign(n);const r=(0,a.W)((0,s.l)(e,-this.learningRate),h);h.assign(r)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&((0,i.AS)(this.accumulatedGrads.map((t=>t.variable))),(0,i.AS)(this.accumulatedUpdates.map((t=>t.variable))))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){const e=(t=await this.extractIterations(t)).length/2;this.accumulatedGrads=t.slice(0,e).map((t=>({originalName:t.name,variable:t.tensor.variable(false)}))),this.accumulatedUpdates=t.slice(e,2*e).map((t=>({originalName:t.name,variable:t.tensor.variable(false)})))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.rho,e.epsilon)}}},51662:(t,e,n)=>{"use strict";n.d(e,{a:()=>d});var r=n(37484),i=n(23129),a=n(67281),o=n(64113),s=n(99333),c=n(86272),u=n(45766),l=n(95195),h=n(59777);class d extends h.E{static get className(){return"Adagrad"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;super(),this.learningRate=t,this.initialAccumulatorValue=e,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const h=r.T2.registeredVariables[e];if(null==this.accumulatedGrads[n]){const t=!1;this.accumulatedGrads[n]={originalName:"".concat(e,"/accumulator"),variable:(0,i.DZ)((()=>(0,s.G)(h.shape,this.initialAccumulatorValue).variable(t)))}}const d=Array.isArray(t)?t[n].tensor:t[e];if(null==d)return;const f=this.accumulatedGrads[n].variable;(0,i.DZ)((()=>{const t=(0,a.W)(f,(0,l.E)(d));f.assign(t);const e=(0,a.W)((0,c.l)((0,o.y)(d,(0,u.R)((0,a.W)(t,r.T2.backend.epsilon()))),-this.learningRate),h);h.assign(e)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&(0,i.AS)(this.accumulatedGrads.map((t=>t.variable)))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t);this.accumulatedGrads=t.map((t=>({originalName:t.name,variable:t.tensor.variable(false)})))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,e){return new t(e.learningRate,e.initialAccumulatorValue)}}},19527:(t,e,n)=>{"use strict";n.d(e,{F:()=>g});var r=n(37484),i=n(23129),a=n(67281),o=n(64113),s=n(86272),c=n(78188),u=n(90844),l=n(45766),h=n(95195),d=n(77820),f=n(90043),p=n(59777);class g extends p.E{static get className(){return"Adam"}constructor(t,e,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=a,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],(0,i.DZ)((()=>{this.accBeta1=(0,u.d)(e).variable(),this.accBeta2=(0,u.d)(n).variable()})),null==a&&(this.epsilon=r.T2.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);(0,i.DZ)((()=>{const n=(0,d.j)(1,this.accBeta1),c=(0,d.j)(1,this.accBeta2);e.forEach(((e,u)=>{const d=r.T2.registeredVariables[e];null==this.accumulatedFirstMoment[u]&&(this.accumulatedFirstMoment[u]={originalName:"".concat(e,"/m"),variable:(0,i.DZ)((()=>(0,f.P)(d).variable(false)))}),null==this.accumulatedSecondMoment[u]&&(this.accumulatedSecondMoment[u]={originalName:"".concat(e,"/v"),variable:(0,i.DZ)((()=>(0,f.P)(d).variable(false)))});const p=Array.isArray(t)?t[u].tensor:t[e];if(null==p)return;const g=this.accumulatedFirstMoment[u].variable,m=this.accumulatedSecondMoment[u].variable,v=(0,a.W)((0,s.l)(g,this.beta1),(0,s.l)(p,1-this.beta1)),y=(0,a.W)((0,s.l)(m,this.beta2),(0,s.l)((0,h.E)(p),1-this.beta2)),b=(0,o.y)(v,n),x=(0,o.y)(y,c);g.assign(v),m.assign(y);const w=(0,a.W)((0,s.l)((0,o.y)(b,(0,a.W)((0,l.R)(x),this.epsilon)),-this.learningRate),d);d.assign(w)})),this.accBeta1.assign((0,s.l)(this.accBeta1,this.beta1)),this.accBeta2.assign((0,s.l)(this.accBeta2,this.beta2))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&(0,i.AS)(this.accumulatedFirstMoment.map((t=>t.variable))),null!=this.accumulatedSecondMoment&&(0,i.AS)(this.accumulatedSecondMoment.map((t=>t.variable)))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t),(0,i.DZ)((()=>{this.accBeta1.assign((0,c.n)(this.beta1,this.iterations_+1)),this.accBeta2.assign((0,c.n)(this.beta2,this.iterations_+1))}));const e=t.length/2;this.accumulatedFirstMoment=t.slice(0,e).map((t=>({originalName:t.name,variable:t.tensor.variable(false)}))),this.accumulatedSecondMoment=t.slice(e,2*e).map((t=>({originalName:t.name,variable:t.tensor.variable(false)})))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)}}},74190:(t,e,n)=>{"use strict";n.d(e,{o:()=>p});var r=n(37484),i=n(23129),a=n(59470),o=n(67281),s=n(64113),c=n(98104),u=n(86272),l=n(90844),h=n(77820),d=n(90043),f=n(59777);class p extends f.E{static get className(){return"Adamax"}constructor(t,e,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=a,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],(0,i.DZ)((()=>{this.iteration=(0,l.d)(0).variable(),this.accBeta1=(0,l.d)(e).variable()})),null==a&&(this.epsilon=r.T2.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);(0,i.DZ)((()=>{const n=(0,h.j)(1,this.accBeta1),i=(0,s.y)(-this.learningRate,(0,o.W)((0,u.l)(this.iteration,this.decay),1));e.forEach(((e,l)=>{const h=r.T2.registeredVariables[e];null==this.accumulatedFirstMoment[l]&&(this.accumulatedFirstMoment[l]={originalName:"".concat(e,"/m"),variable:(0,d.P)(h).variable(false)}),null==this.accumulatedWeightedInfNorm[l]&&(this.accumulatedWeightedInfNorm[l]={originalName:"".concat(e,"/v"),variable:(0,d.P)(h).variable(false)});const f=Array.isArray(t)?t[l].tensor:t[e];if(null==f)return;const p=this.accumulatedFirstMoment[l].variable,g=this.accumulatedWeightedInfNorm[l].variable,m=(0,o.W)((0,u.l)(p,this.beta1),(0,u.l)(f,1-this.beta1)),v=(0,u.l)(g,this.beta2),y=(0,a.t)(f),b=(0,c.P)(v,y);p.assign(m),g.assign(b);const x=(0,o.W)((0,u.l)((0,s.y)(i,n),(0,s.y)(m,(0,o.W)(b,this.epsilon))),h);h.assign(x)})),this.iteration.assign((0,o.W)(this.iteration,1)),this.accBeta1.assign((0,u.l)(this.accBeta1,this.beta1))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&(0,i.AS)(this.accumulatedFirstMoment.map((t=>t.variable))),null!=this.accumulatedWeightedInfNorm&&(0,i.AS)(this.accumulatedWeightedInfNorm.map((t=>t.variable)))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)}}},59490:(t,e,n)=>{"use strict";n.d(e,{Q:()=>l});var r=n(37484),i=n(23129),a=n(67281),o=n(86272),s=n(90844),c=n(90043),u=n(67060);class l extends u.S{static get className(){return"Momentum"}constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(t),this.learningRate=t,this.momentum=e,this.useNesterov=n,this.accumulations=[],this.m=(0,s.d)(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const s=r.T2.registeredVariables[e];if(null==this.accumulations[n]){const t=!1;this.accumulations[n]={originalName:"".concat(e,"/momentum"),variable:(0,i.DZ)((()=>(0,c.P)(s).variable(t)))}}const u=this.accumulations[n].variable,l=Array.isArray(t)?t[n].tensor:t[e];null!=l&&(0,i.DZ)((()=>{let t;const e=(0,a.W)((0,o.l)(this.m,u),l);t=this.useNesterov?(0,a.W)((0,o.l)(this.c,(0,a.W)(l,(0,o.l)(e,this.m))),s):(0,a.W)((0,o.l)(this.c,e),s),u.assign(e),s.assign(t)}))})),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&(0,i.AS)(this.accumulations.map((t=>t.variable)))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t);this.accumulations=t.map((t=>({originalName:t.name,variable:t.tensor.variable(false)})))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)}}},59777:(t,e,n)=>{"use strict";n.d(e,{E:()=>s});var r=n(23129),i=n(57832),a=n(90844),o=n(50581);class s extends o.Serializable{minimize(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;const{value:i,grads:a}=this.computeGradients(t,n);if(null!=n){const t=n.map((t=>({name:t.name,tensor:a[t.name]})));this.applyGradients(t)}else this.applyGradients(a);return(0,r.AS)(a),e?i:(i.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,e){return(0,i.y7)(t,e)}dispose(){null!=this.iterations_&&(0,r.AS)(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:(0,a.d)(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()))}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(s,Symbol.hasInstance,{value:t=>null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients})},20940:(t,e,n)=>{"use strict";n.d(e,{i:()=>d});var r=n(52342),i=n(51662),a=n(19527),o=n(74190),s=n(59490),c=n(95241),u=n(67060),l=n(50581);const h=[r.K,i.a,a.F,o.o,s.Q,c.P,u.S];function d(){for(const t of h)(0,l.registerClass)(t)}},95241:(t,e,n)=>{"use strict";n.d(e,{P:()=>f});var r=n(37484),i=n(23129),a=n(67281),o=n(64113),s=n(86272),c=n(45766),u=n(95195),l=n(77820),h=n(90043),d=n(59777);class f extends d.E{static get className(){return"RMSProp"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(super(),this.learningRate=t,this.decay=e,this.momentum=n,this.epsilon=i,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,null==i&&(this.epsilon=r.T2.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const d=r.T2.registeredVariables[e],f=!1;null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:"".concat(e,"/rms"),variable:(0,i.DZ)((()=>(0,h.P)(d).variable(f)))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:"".concat(e,"/momentum"),variable:(0,i.DZ)((()=>(0,h.P)(d).variable(f)))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:"".concat(e,"/mg"),variable:(0,i.DZ)((()=>(0,h.P)(d).variable(f)))});const p=Array.isArray(t)?t[n].tensor:t[e];if(null==p)return;const g=this.accumulatedMeanSquares[n].variable,m=this.accumulatedMoments[n].variable;(0,i.DZ)((()=>{const t=(0,a.W)((0,s.l)(g,this.decay),(0,s.l)((0,u.E)(p),1-this.decay));if(this.centered){const e=this.accumulatedMeanGrads[n].variable,r=(0,a.W)((0,s.l)(e,this.decay),(0,s.l)(p,1-this.decay)),i=(0,o.y)((0,s.l)(p,this.learningRate),(0,c.R)((0,l.j)(t,(0,a.W)((0,u.E)(r),this.epsilon)))),h=(0,a.W)((0,s.l)(m,this.momentum),i);g.assign(t),e.assign(r),m.assign(h);const f=(0,l.j)(d,h);d.assign(f)}else{const t=(0,a.W)((0,s.l)(g,this.decay),(0,s.l)((0,u.E)(p),1-this.decay)),e=(0,a.W)((0,s.l)(m,this.momentum),(0,o.y)((0,s.l)(p,this.learningRate),(0,c.R)((0,a.W)(t,this.epsilon))));g.assign(t),m.assign(e);const n=(0,l.j)(d,e);d.assign(n)}}))})),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&(0,i.AS)(this.accumulatedMeanSquares.map((t=>t.variable))),null!=this.accumulatedMeanGrads&&this.centered&&(0,i.AS)(this.accumulatedMeanGrads.map((t=>t.variable))),null!=this.accumulatedMoments&&(0,i.AS)(this.accumulatedMoments.map((t=>t.variable)))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t);const e=this.centered?t.length/3:t.length/2,n=!1;this.accumulatedMeanSquares=t.slice(0,e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)}))),this.accumulatedMoments=t.slice(e,2*e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)}))),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)}))))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)}}},67060:(t,e,n)=>{"use strict";n.d(e,{S:()=>u});var r=n(37484),i=n(23129),a=n(67281),o=n(86272),s=n(90844),c=n(59777);class u extends c.E{static get className(){return"SGD"}constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const s=Array.isArray(t)?t[n].tensor:t[e];if(null==s)return;const c=r.T2.registeredVariables[e];(0,i.DZ)((()=>{const t=(0,a.W)((0,o.l)(this.c,s),c);c.assign(t)}))})),this.incrementIterations()}setLearningRate(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=(0,i.aC)((0,s.d)(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(0!==(t=await this.extractIterations(t)).length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,e){return new t(e.learningRate)}}},84634:(t,e,n)=>{"use strict";function r(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}n.d(e,{Y:()=>r})},58914:(t,e,n)=>{"use strict";n.r(e);var r=n(59470),i=n(90739);(0,i.tp)().prototype.abs=function(){return this.throwIfDisposed(),(0,r.t)(this)};var a=n(75090);(0,i.tp)().prototype.acos=function(){return this.throwIfDisposed(),(0,a.H)(this)};var o=n(34528);(0,i.tp)().prototype.acosh=function(){return this.throwIfDisposed(),(0,o.F)(this)};var s=n(67281);(0,i.tp)().prototype.add=function(t){return this.throwIfDisposed(),(0,s.W)(this,t)};var c=n(86465);(0,i.tp)().prototype.all=function(t,e){return this.throwIfDisposed(),(0,c.Q)(this,t,e)};var u=n(25552);(0,i.tp)().prototype.any=function(t,e){return this.throwIfDisposed(),(0,u.b)(this,t,e)};var l=n(31003);(0,i.tp)().prototype.argMax=function(t){return this.throwIfDisposed(),(0,l.F)(this,t)};var h=n(72345);(0,i.tp)().prototype.argMin=function(t){return this.throwIfDisposed(),(0,h.X)(this,t)};var d=n(89068),f=n(23869);(0,i.tp)().prototype.asScalar=function(){return this.throwIfDisposed(),(0,f.vA)(1===this.size,(()=>"The array must have only 1 element.")),(0,d.t)(this,[])};var p=n(69779);(0,i.tp)().prototype.asType=function(t){return this.throwIfDisposed(),(0,p.w)(this,t)},(0,i.tp)().prototype.as1D=function(){return this.throwIfDisposed(),(0,d.t)(this,[this.size])},(0,i.tp)().prototype.as2D=function(t,e){return this.throwIfDisposed(),(0,d.t)(this,[t,e])},(0,i.tp)().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),(0,d.t)(this,[t,e,n])},(0,i.tp)().prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),(0,d.t)(this,[t,e,n,r])},(0,i.tp)().prototype.as5D=function(t,e,n,r,i){return this.throwIfDisposed(),(0,d.t)(this,[t,e,n,r,i])};var g=n(50155);(0,i.tp)().prototype.asin=function(){return this.throwIfDisposed(),(0,g.q)(this)};var m=n(94467);(0,i.tp)().prototype.asinh=function(){return this.throwIfDisposed(),(0,m.y)(this)};var v=n(16802);(0,i.tp)().prototype.atan=function(){return this.throwIfDisposed(),(0,v.r)(this)};var y=n(67986);(0,i.tp)().prototype.atan2=function(t){return this.throwIfDisposed(),(0,y.F)(this,t)};var b=n(68080);(0,i.tp)().prototype.atanh=function(){return this.throwIfDisposed(),(0,b.r)(this)};var x=n(70963);(0,i.tp)().prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),(0,x.$)(this,t,e,n,r)};var w=n(81406);(0,i.tp)().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),(0,w.G)(this,t,e)};var k=n(26670);(0,i.tp)().prototype.batchNorm=function(t,e,n,r,i){return this.throwIfDisposed(),(0,k.$)(this,t,e,n,r,i)};var _=n(99965);(0,i.tp)().prototype.broadcastTo=function(t){return this.throwIfDisposed(),(0,_.h)(this,t)},(0,i.tp)().prototype.cast=function(t){return this.throwIfDisposed(),(0,p.w)(this,t)};var A=n(33989);(0,i.tp)().prototype.ceil=function(){return this.throwIfDisposed(),(0,A.m)(this)};var C=n(68042);(0,i.tp)().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),(0,C.z)(this,t,e)};var S=n(89360);(0,i.tp)().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof i.qY&&(t=[t]),(0,S.x)([this,...t],e)};var E=n(65783);(0,i.tp)().prototype.conv1d=function(t,e,n,r,i,a){return this.throwIfDisposed(),(0,E.k)(this,t,e,n,r,i,a)};var T=n(80824);(0,i.tp)().prototype.conv2dTranspose=function(t,e,n,r,i){return this.throwIfDisposed(),(0,T.w)(this,t,e,n,r,i)};var N=n(31880);(0,i.tp)().prototype.conv2d=function(t,e,n,r,i,a){return this.throwIfDisposed(),(0,N.X)(this,t,e,n,r,i,a)};var F=n(48133);(0,i.tp)().prototype.cos=function(){return this.throwIfDisposed(),(0,F.g)(this)};var D=n(84033);(0,i.tp)().prototype.cosh=function(){return this.throwIfDisposed(),(0,D.y)(this)};var I=n(79808);(0,i.tp)().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),(0,I.L)(this,t,e,n)};var M=n(91482);(0,i.tp)().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),(0,M.r)(this,t,e,n)};var O=n(89854);(0,i.tp)().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),(0,O.R)(this,t,e)};var R=n(92302);(0,i.tp)().prototype.depthwiseConv2d=function(t,e,n,r,i,a){return this.throwIfDisposed(),(0,R.G)(this,t,e,n,r,i,a)};var z=n(14640);(0,i.tp)().prototype.dilation2d=function(t,e,n,r,i){return this.throwIfDisposed(),(0,z.X)(this,t,e,n,r,i)};var B=n(83645);(0,i.tp)().prototype.divNoNan=function(t){return this.throwIfDisposed(),(0,B.e)(this,t)};var L=n(64113);(0,i.tp)().prototype.div=function(t){return this.throwIfDisposed(),(0,L.y)(this,t)};var P=n(33185);(0,i.tp)().prototype.dot=function(t){return this.throwIfDisposed(),(0,P.O)(this,t)};var j=n(62534);(0,i.tp)().prototype.elu=function(){return this.throwIfDisposed(),(0,j.P)(this)};var U=n(92138);(0,i.tp)().prototype.equal=function(t){return this.throwIfDisposed(),(0,U.L)(this,t)};var W=n(47829);(0,i.tp)().prototype.erf=function(){return this.throwIfDisposed(),(0,W.Y)(this)};var V=n(13779);(0,i.tp)().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),(0,V.p)(this,t,e)};var q=n(48389);(0,i.tp)().prototype.exp=function(){return this.throwIfDisposed(),(0,q.o)(this)};var G=n(70816);(0,i.tp)().prototype.expandDims=function(t){return this.throwIfDisposed(),(0,G.U)(this,t)};var H=n(54195);(0,i.tp)().prototype.expm1=function(){return this.throwIfDisposed(),(0,H.I)(this)};var Y=n(42587);(0,i.tp)().prototype.fft=function(){return this.throwIfDisposed(),(0,Y.h)(this)},(0,i.tp)().prototype.flatten=function(){return this.throwIfDisposed(),(0,d.t)(this,[this.size])};var X=n(96812);(0,i.tp)().prototype.floor=function(){return this.throwIfDisposed(),(0,X.R)(this)};var K=n(64149);(0,i.tp)().prototype.floorDiv=function(t){return this.throwIfDisposed(),(0,K.w)(this,t)};var Q=n(50511);(0,i.tp)().prototype.gather=function(t,e,n){return this.throwIfDisposed(),(0,Q.k)(this,t,e,n)};var Z=n(39103);(0,i.tp)().prototype.greaterEqual=function(t){return this.throwIfDisposed(),(0,Z.D)(this,t)};var $=n(60228);(0,i.tp)().prototype.greater=function(t){return this.throwIfDisposed(),(0,$.r)(this,t)};var J=n(93674);(0,i.tp)().prototype.ifft=function(){return this.throwIfDisposed(),(0,J.K)(this)};var tt=n(30890);(0,i.tp)().prototype.irfft=function(){return this.throwIfDisposed(),(0,tt.g)(this)};var et=n(38660);(0,i.tp)().prototype.isFinite=function(){return this.throwIfDisposed(),(0,et.M)(this)};var nt=n(37304);(0,i.tp)().prototype.isInf=function(){return this.throwIfDisposed(),(0,nt.E)(this)};var rt=n(42310);(0,i.tp)().prototype.isNaN=function(){return this.throwIfDisposed(),(0,rt.y)(this)};var it=n(51965);(0,i.tp)().prototype.leakyRelu=function(t){return this.throwIfDisposed(),(0,it.H)(this,t)};var at=n(64210);(0,i.tp)().prototype.lessEqual=function(t){return this.throwIfDisposed(),(0,at.I)(this,t)};var ot=n(72969);(0,i.tp)().prototype.less=function(t){return this.throwIfDisposed(),(0,ot.M)(this,t)};var st=n(85593);(0,i.tp)().prototype.localResponseNormalization=function(t,e,n,r){return this.throwIfDisposed(),(0,st.K)(this,t,e,n,r)};var ct=n(34675);(0,i.tp)().prototype.logSigmoid=function(){return this.throwIfDisposed(),(0,ct.n)(this)};var ut=n(8229);(0,i.tp)().prototype.logSoftmax=function(t){return this.throwIfDisposed(),(0,ut.H)(this,t)};var lt=n(45492);(0,i.tp)().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),(0,lt.V)(this,t,e)};var ht=n(18688);(0,i.tp)().prototype.log=function(){return this.throwIfDisposed(),(0,ht.R)(this)};var dt=n(90781);(0,i.tp)().prototype.log1p=function(){return this.throwIfDisposed(),(0,dt.K)(this)};var ft=n(21183);(0,i.tp)().prototype.logicalAnd=function(t){return this.throwIfDisposed(),(0,ft.n)(this,t)};var pt=n(87375);(0,i.tp)().prototype.logicalNot=function(){return this.throwIfDisposed(),(0,pt.N)(this)};var gt=n(65497);(0,i.tp)().prototype.logicalOr=function(t){return this.throwIfDisposed(),(0,gt.z)(this,t)};var mt=n(6699);(0,i.tp)().prototype.logicalXor=function(t){return this.throwIfDisposed(),(0,mt.r)(this,t)};var vt=n(65849);(0,i.tp)().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),(0,vt.N)(this,t,e,n)};var yt=n(8853);(0,i.tp)().prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),(0,yt.j)(this,t,e,n,r)};var bt=n(73e3);(0,i.tp)().prototype.max=function(t,e){return this.throwIfDisposed(),(0,bt.T)(this,t,e)};var xt=n(98104);(0,i.tp)().prototype.maximum=function(t){return this.throwIfDisposed(),(0,xt.P)(this,t)};var wt=n(49577);(0,i.tp)().prototype.mean=function(t,e){return this.throwIfDisposed(),(0,wt.i)(this,t,e)};var kt=n(60278);(0,i.tp)().prototype.min=function(t,e){return this.throwIfDisposed(),(0,kt.j)(this,t,e)};var _t=n(91086);(0,i.tp)().prototype.minimum=function(t){return this.throwIfDisposed(),(0,_t.B)(this,t)};var At=n(32509);(0,i.tp)().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),(0,At.F)(this,t,e)};var Ct=n(5634);(0,i.tp)().prototype.mod=function(t){return this.throwIfDisposed(),(0,Ct.z)(this,t)};var St=n(86272);(0,i.tp)().prototype.mul=function(t){return this.throwIfDisposed(),(0,St.l)(this,t)};var Et=n(5008);(0,i.tp)().prototype.neg=function(){return this.throwIfDisposed(),(0,Et.H)(this)};var Tt=n(48306);(0,i.tp)().prototype.norm=function(t,e,n){return this.throwIfDisposed(),(0,Tt.x)(this,t,e,n)};var Nt=n(73848);(0,i.tp)().prototype.notEqual=function(t){return this.throwIfDisposed(),(0,Nt.E)(this,t)};var Ft=n(48926);(0,i.tp)().prototype.oneHot=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),(0,Ft.M)(this,t,e,n)};var Dt=n(98903);(0,i.tp)().prototype.onesLike=function(){return this.throwIfDisposed(),(0,Dt.P)(this)};var It=n(67507);(0,i.tp)().prototype.pad=function(t,e){return this.throwIfDisposed(),(0,It.e)(this,t,e)};var Mt=n(18570);(0,i.tp)().prototype.pool=function(t,e,n,r,i,a){return this.throwIfDisposed(),(0,Mt.d)(this,t,e,n,r,i,a)};var Ot=n(78188);(0,i.tp)().prototype.pow=function(t){return this.throwIfDisposed(),(0,Ot.n)(this,t)};var Rt=n(83860);(0,i.tp)().prototype.prelu=function(t){return this.throwIfDisposed(),(0,Rt.N)(this,t)};var zt=n(38517);(0,i.tp)().prototype.prod=function(t,e){return this.throwIfDisposed(),(0,zt._)(this,t,e)};var Bt=n(95868);(0,i.tp)().prototype.reciprocal=function(){return this.throwIfDisposed(),(0,Bt.V)(this)};var Lt=n(38414);(0,i.tp)().prototype.relu=function(){return this.throwIfDisposed(),(0,Lt.V)(this)};var Pt=n(6650);(0,i.tp)().prototype.relu6=function(){return this.throwIfDisposed(),(0,Pt.j)(this)},(0,i.tp)().prototype.reshapeAs=function(t){return this.throwIfDisposed(),(0,d.t)(this,t.shape)},(0,i.tp)().prototype.reshape=function(t){return this.throwIfDisposed(),(0,d.t)(this,t)};var jt=n(20537);(0,i.tp)().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),(0,jt.v)(this,t,e,n)};var Ut=n(80828);(0,i.tp)().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),(0,Ut.b)(this,t,e,n)};var Wt=n(23540);(0,i.tp)().prototype.reverse=function(t){return this.throwIfDisposed(),(0,Wt.B)(this,t)};var Vt=n(35721);(0,i.tp)().prototype.rfft=function(){return this.throwIfDisposed(),(0,Vt.z)(this)};var qt=n(16242);(0,i.tp)().prototype.round=function(){return this.throwIfDisposed(),(0,qt.L)(this)};var Gt=n(30414);(0,i.tp)().prototype.rsqrt=function(){return this.throwIfDisposed(),(0,Gt.Z)(this)};var Ht=n(52203);(0,i.tp)().prototype.selu=function(){return this.throwIfDisposed(),(0,Ht.W)(this)};var Yt=n(848);(0,i.tp)().prototype.separableConv2d=function(t,e,n,r,i,a){return this.throwIfDisposed(),(0,Yt.w)(this,t,e,n,r,i,a)};var Xt=n(1242);(0,i.tp)().prototype.sigmoid=function(){return this.throwIfDisposed(),(0,Xt.r)(this)};var Kt=n(5601);(0,i.tp)().prototype.sign=function(){return this.throwIfDisposed(),(0,Kt._)(this)};var Qt=n(85956);(0,i.tp)().prototype.sin=function(){return this.throwIfDisposed(),(0,Qt.F)(this)};var Zt=n(15990);(0,i.tp)().prototype.sinh=function(){return this.throwIfDisposed(),(0,Zt.L)(this)};var $t=n(8016);(0,i.tp)().prototype.slice=function(t,e){return this.throwIfDisposed(),(0,$t.d)(this,t,e)};var Jt=n(80724);(0,i.tp)().prototype.softmax=function(t){return this.throwIfDisposed(),(0,Jt.V)(this,t)};var te=n(22824);(0,i.tp)().prototype.softplus=function(){return this.throwIfDisposed(),(0,te.l)(this)};var ee=n(90602);(0,i.tp)().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),(0,ee.e)(this,t,e)};var ne=n(77554);(0,i.tp)().prototype.split=function(t,e){return this.throwIfDisposed(),(0,ne.l)(this,t,e)};var re=n(45766);(0,i.tp)().prototype.sqrt=function(){return this.throwIfDisposed(),(0,re.R)(this)};var ie=n(95195);(0,i.tp)().prototype.square=function(){return this.throwIfDisposed(),(0,ie.E)(this)};var ae=n(77189);(0,i.tp)().prototype.squaredDifference=function(t){return this.throwIfDisposed(),(0,ae.P)(this,t)};var oe=n(2330);(0,i.tp)().prototype.squeeze=function(t){return this.throwIfDisposed(),(0,oe.r)(this,t)};var se=n(22190);(0,i.tp)().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof i.qY?[this,t]:[this,...t];return(0,se.t)(n,e)};var ce=n(52946);(0,i.tp)().prototype.step=function(t){return this.throwIfDisposed(),(0,ce.P)(this,t)};var ue=n(57136);(0,i.tp)().prototype.stridedSlice=function(t,e,n,r,i,a,o,s){return this.throwIfDisposed(),(0,ue.Y)(this,t,e,n,r,i,a,o,s)};var le=n(77820);(0,i.tp)().prototype.sub=function(t){return this.throwIfDisposed(),(0,le.j)(this,t)};var he=n(17937);(0,i.tp)().prototype.sum=function(t,e){return this.throwIfDisposed(),(0,he.c)(this,t,e)};var de=n(66465);(0,i.tp)().prototype.tan=function(){return this.throwIfDisposed(),(0,de.M)(this)};var fe=n(47173);(0,i.tp)().prototype.tanh=function(){return this.throwIfDisposed(),(0,fe.y)(this)};var pe=n(35716);(0,i.tp)().prototype.tile=function(t){return this.throwIfDisposed(),(0,pe.V)(this,t)},(0,i.tp)().prototype.toBool=function(){return this.throwIfDisposed(),(0,p.w)(this,"bool")},(0,i.tp)().prototype.toFloat=function(){return this.throwIfDisposed(),(0,p.w)(this,"float32")},(0,i.tp)().prototype.toInt=function(){return this.throwIfDisposed(),(0,p.w)(this,"int32")};var ge=n(87984);(0,i.tp)().prototype.topk=function(t,e){return this.throwIfDisposed(),(0,ge.r)(this,t,e)};var me=n(15977);(0,i.tp)().prototype.transpose=function(t){return this.throwIfDisposed(),(0,me.m)(this,t)};var ve=n(68583);(0,i.tp)().prototype.unique=function(t){return this.throwIfDisposed(),(0,ve.A)(this,t)};var ye=n(66788);(0,i.tp)().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),(0,ye.z)(this,t,e)};var be=n(84491);(0,i.tp)().prototype.unstack=function(t){return this.throwIfDisposed(),(0,be.K)(this,t)};var xe=n(52117);(0,i.tp)().prototype.where=function(t,e){return this.throwIfDisposed(),(0,xe._)(t,this,e)};var we=n(90043);(0,i.tp)().prototype.zerosLike=function(){return this.throwIfDisposed(),(0,we.P)(this)}},49446:(t,e,n)=>{"use strict";var r=n(90054),i=n(70476),a=n(62720),o=n(39823),s=n(14219),c=n(71500),u=n(92998),l=n(98003),h=n(10101),d=n(83018),f=n(71536),p=n(93372),g=n(84969),m=n(1568),v=n(76722),y=n(99223),b=n(68432),x=n(4067),w=n(95833),k=n(26290),_=n(88818),A=n(21662),C=n(80238),S=n(80196),E=n(90249),T=n(5103),N=n(99065),F=n(27432),D=n(11464),I=n(15674),M=n(36514),O=n(88559),R=n(97987),z=n(65579),B=n(59861),L=n(67008),P=n(82825),j=n(60035),U=n(71551),W=n(82588),V=n(65428),q=n(96403),G=n(41503),H=n(1381),Y=n(75962),X=n(58119),K=n(79828),Q=n(97822),Z=n(48274),$=n(45144),J=n(1560),tt=n(37391),et=n(36818),nt=n(66313),rt=n(33450),it=n(41530),at=n(70306),ot=n(73330),st=n(96454),ct=n(74488),ut=n(4915),lt=n(99312),ht=n(64633),dt=n(64265),ft=n(74744),pt=n(408),gt=n(96189),mt=n(94131),vt=n(56770),yt=n(32718),bt=n(90248),xt=n(95276),wt=n(6806),kt=n(26118),_t=n(78816),At=n(51630),Ct=n(56354),St=n(19070),Et=n(22731),Tt=n(72070),Nt=n(68537),Ft=n(37660),Dt=n(30672),It=n(45428),Mt=n(68064),Ot=n(34142),Rt=n(31787),zt=n(13428),Bt=n(46456),Lt=n(18003),Pt=n(39600),jt=n(21972),Ut=n(15156),Wt=n(14087),Vt=n(26295),qt=n(4833),Gt=n(65474),Ht=n(25347),Yt=n(57048),Xt=n(44232),Kt=n(66086),Qt=n(46780);const Zt=[r.B,i.l,a.h,o.Y,s.y,c.Z,u.l,l._,h.O,d.B,f.z,p.n,g.m,m.$,v.v,y.I,b.X,x.Q,w.C,k.Z,_.N,A.N,S.R,C.J,E.Y,T.g,N.M,F.Z,D.z,I.v,mt.g,M.x,O.S,R.k,z.y,B.a,P.S,L.n,j.E,U.E,W.D,V.L,q.c,G.c,H.C,Y.f,X.G,K.V,Q.z,Z.J,$.n,$.n,J.p,tt.S,et.P,nt.k,rt.Z,it.$,at.P,ot.$,st.r,ct.h,ut.U,lt.P,ht.I,dt.M,dt.M,ft.d,pt.t,gt.a,vt.j,yt.p,bt.T,xt.x,wt.j,kt.n,_t.D,At.v,Ct.$,St.D,Et.O,Tt.H,Nt.q,Ft.V,Dt.l,It.d,Mt.X,Ot.F,Rt.Y,Rt.Y,zt.n,zt.n,Bt.V,Pt.b,Lt.M,jt.f,Ut.p,Wt.m,Vt.k,qt.w,Gt.X,Ht.m,Yt.t,Xt.h,Kt.Z];for(const $t of Zt)(0,Qt.kr)($t)},50581:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Serializable:()=>o,SerializationMap:()=>s,getRegisteredName:()=>u,registerClass:()=>c});var r=n(23869);const i=new Map,a=new Map;class o{getClassName(){return this.constructor.className}static fromConfig(t,e){return new t(e)}}class s{constructor(){this.classNameMap={}}static getMap(){return null==s.instance&&(s.instance=new s),s.instance}static register(t){s.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function c(t,e,n){(0,r.vA)(null!=t.className,(()=>"Class being registered does not have the static className property defined.")),(0,r.vA)("string"===typeof t.className,(()=>"className is required to be a string, but got type "+typeof t.className)),(0,r.vA)(t.className.length>0,(()=>"Class being registered has an empty-string as its className, which is disallowed.")),"undefined"===typeof e&&(e="Custom"),"undefined"===typeof n&&(n=t.className);const o=e+">"+n;return s.register(t),i.set(o,t),a.set(t,o),t}function u(t){return a.has(t)?a.get(t):t.className}},90739:(t,e,n)=>{"use strict";n.d(e,{qY:()=>w,yl:()=>p,rT:()=>_,tp:()=>k,B4:()=>x,Q5:()=>b,qP:()=>y});var r=n(86177),i=n(23869);const a=20,o=3,s=7;function c(t,e,n,r){const a=(0,i.Ur)(e),o=function(t,e,n,r){const a=(0,i.Ze)(e),o=r[r.length-1],s=new Array(o).fill(0),c=e.length,l="complex64"===n?d(t):t;if(c>1)for(let i=0;i<a/o;i++){const t=i*o;for(let e=0;e<o;e++)s[e]=Math.max(s[e],u(l[t+e],0,n).length)}return s}(t,e,n,a),s=e.length,c=h(t,e,n,a,o),l=["Tensor"];return r&&(l.push("  dtype: ".concat(n)),l.push("  rank: ".concat(s)),l.push("  shape: [".concat(e,"]")),l.push("  values:")),l.push(c.map((t=>"    "+t)).join("\n")),l.join("\n")}function u(t,e,n){let r;return r=Array.isArray(t)?"".concat(parseFloat(t[0].toFixed(s))," + ")+"".concat(parseFloat(t[1].toFixed(s)),"j"):(0,i.Kg)(t)?"'".concat(t,"'"):"bool"===n?l(t):parseFloat(t.toFixed(s)).toString(),(0,i.av)(r,e)}function l(t){return 0===t?"false":"true"}function h(t,e,n,r,i){let s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];const c="complex64"===n?2:1,f=e[0],p=e.length;if(0===p){if("complex64"===n){return[u(d(t)[0],0,n)]}return"bool"===n?[l(t[0])]:[t[0].toString()]}if(1===p){if(f>a){const e=o*c;let r=Array.from(t.slice(0,e)),a=Array.from(t.slice((f-o)*c,f*c));return"complex64"===n&&(r=d(r),a=d(a)),["["+r.map(((t,e)=>u(t,i[e],n))).join(", ")+", ..., "+a.map(((t,e)=>u(t,i[f-o+e],n))).join(", ")+"]"]}return["["+("complex64"===n?d(t):Array.from(t)).map(((t,e)=>u(t,i[e],n))).join(", ")+"]"]}const g=e.slice(1),m=r.slice(1),v=r[0]*c,y=[];if(f>a){for(let e=0;e<o;e++){const r=e*v,a=r+v;y.push(...h(t.slice(r,a),g,n,m,i,!1))}y.push("...");for(let e=f-o;e<f;e++){const r=e*v,a=r+v;y.push(...h(t.slice(r,a),g,n,m,i,e===f-1))}}else for(let a=0;a<f;a++){const e=a*v,r=e+v;y.push(...h(t.slice(e,r),g,n,m,i,a===f-1))}const b=2===p?",":"";y[0]="["+(f>0?y[0]+b:"");for(let a=1;a<y.length-1;a++)y[a]=" "+y[a]+b;let x=",\n";for(let a=2;a<p;a++)x+="\n";return y[y.length-1]=" "+y[y.length-1]+"]"+(s?"":x),y}function d(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var f=n(73837);class p{constructor(t,e,n){if(this.dtype=e,this.shape=t.slice(),this.size=i.Ze(t),null!=n){const t=n.length;i.vA(t===this.size,(()=>"Length of values '".concat(t,"' does not match the size ")+"inferred by the shape '".concat(this.size,"'.")))}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||i.Ab(e,this.size),this.strides=(0,i.Ur)(t)}set(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),i.vA(n.length===this.rank,(()=>"The number of provided coordinates (".concat(n.length,") must ")+"match the rank (".concat(this.rank,")")));const a=this.locToIndex(n);this.values[a]=t}get(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];0===e.length&&(e=[0]);let r=0;for(const a of e){if(a<0||a>=this.shape[r]){const t="Requested out of range element at ".concat(e,". ")+"  Buffer shape=".concat(this.shape);throw new Error(t)}r++}let i=e[e.length-1];for(let a=0;a<e.length-1;++a)i+=this.strides[a]*e[a];return this.values[i]}locToIndex(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];let e=t[t.length-1];for(let n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e}indexToLoc(t){if(0===this.rank)return[];if(1===this.rank)return[t];const e=new Array(this.shape.length);for(let n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e}get rank(){return this.shape.length}toTensor(){return g().makeTensor(this.values,this.shape,this.dtype)}}let g=null,m=null,v=null;function y(t){g=t}function b(t){m=t}function x(t){v=t}class w{constructor(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=i.Ze(t),this.strides=(0,i.Ur)(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return m.buffer(this.shape,this.dtype,t)}bufferSync(){return m.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return(0,i.yw)(this.shape,t,"complex64"===this.dtype)}arraySync(){return(0,i.yw)(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();const t=g().read(this.dataId);if("string"===this.dtype){const n=await t;try{return n.map((t=>f.decodeString(t)))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataToGPU(t){return this.throwIfDisposed(),g().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=g().readSync(this.dataId);if("string"===this.dtype)try{return t.map((t=>f.decodeString(t)))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await g().read(this.dataId);return"string"===this.dtype?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),g().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return m.print(this,t)}clone(){return this.throwIfDisposed(),m.clone(this)}toString(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return c(this.dataSync(),this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),m.cast(this,t)}variable(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),g().makeVariable(this,t,e,n)}}function k(){return(0,r.m)("Tensor",(()=>w))}Object.defineProperty(w,Symbol.hasInstance,{value:t=>!!t&&null!=t.data&&null!=t.dataSync&&null!=t.throwIfDisposed}),k();class _ extends w{constructor(t,e,n,r){super(t.shape,t.dtype,t.dataId,r),this.trainable=e,this.name=n}assign(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(t.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!i.r1(t.shape,this.shape))throw new Error("shape of the new value (".concat(t.shape,") and ")+"previous value (".concat(this.shape,") must match"));g().disposeTensor(this),this.dataId=t.dataId,g().incRef(this,null)}dispose(){g().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(_,Symbol.hasInstance,{value:t=>t instanceof w&&null!=t.assign&&t.assign instanceof Function})},48683:(t,e,n)=>{"use strict";n.r(e),n.d(e,{assertTypesMatch:()=>s,getTensorsInContainer:()=>u,isTensorInList:()=>c,makeTypesMatch:()=>o});var r=n(90739),i=n(15188),a=n(23869);function o(t,e){if(t.dtype===e.dtype)return[t,e];const n=(0,i.Tu)(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function s(t,e){(0,a.vA)(t.dtype===e.dtype,(()=>"The dtypes of the first(".concat(t.dtype,") and")+" second(".concat(e.dtype,") input must match")))}function c(t,e){return e.some((e=>e.id===t.id))}function u(t){const e=[];return l(t,e,new Set),e}function l(t,e,n){if(null==t)return;if(t instanceof r.qY)return void e.push(t);if(i=t,!Array.isArray(i)&&"object"!==typeof i)return;var i;const a=t;for(const r in a){const t=a[r];n.has(t)||(n.add(t),l(t,e,n))}}},52863:(t,e,n)=>{"use strict";n.d(e,{MZ:()=>u,YT:()=>d,j1:()=>f});var r=n(37484),i=n(89e3),a=n(90739),o=n(15188),s=n(73837),c=n(23869);function u(t,e){let n=t;if((0,s.isTypedArray)(t))return"string"===e?[]:[t.length];if((0,o.Oj)(t)){const e=t.channels||"RGBA";return[t.height,t.width*e.length]}if((0,o.Nw)(t))return[t.buffer.size/(null==e?4:(0,c.jv)(e))];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||(0,s.isTypedArray)(n)&&"string"!==e;)r.push(n.length),n=n[0];return Array.isArray(t)&&(0,i._K)().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&l(t,r,[]),r}function l(t,e,n){if(n=n||[],!Array.isArray(t)&&!(0,s.isTypedArray)(t))return void(0,c.vA)(0===e.length,(()=>"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(e[0]," elements")));(0,c.vA)(e.length>0,(()=>"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(t.length," elements"))),(0,c.vA)(t.length===e[0],(()=>"Element arr[".concat(n.join("]["),"] should have ").concat(e[0]," ")+"elements, but has ".concat(t.length," elements")));const r=e.slice(1);for(let i=0;i<t.length;++i)l(t[i],r,n.concat(i))}function h(t,e,n,r){if("string_or_numeric"!==t){if(null==t)throw new Error("Expected dtype cannot be null.");if("numeric"!==t&&t!==e||"numeric"===t&&"string"===e)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(t," tensor, but got ").concat(e," tensor"))}}function d(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(t instanceof(0,a.tp)())return h(i,t.dtype,e,n),t;let o=(0,c.X$)(t);if("string"!==o&&["bool","int32","float32"].indexOf(i)>=0&&(o=i),h(i,o,e,n),null==t||!(0,s.isTypedArray)(t)&&!Array.isArray(t)&&"number"!==typeof t&&"boolean"!==typeof t&&"string"!==typeof t){const r=null==t?"null":t.constructor.name;throw new Error("Argument '".concat(e,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(r,"'"))}const l=u(t,o);(0,s.isTypedArray)(t)||Array.isArray(t)||(t=[t]);const d="string"!==o?(0,s.toTypedArray)(t,o):(0,s.flatten)(t,[],!0);return r.T2.makeTensor(d,l,o)}function f(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(t))throw new Error("Argument ".concat(e," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");return t.map(((t,i)=>d(t,"".concat(e,"[").concat(i,"]"),n,r)))}},15188:(t,e,n)=>{"use strict";var r,i,a,o,s;n.d(e,{Nw:()=>d,Oj:()=>h,Tu:()=>u,ch:()=>l,rg:()=>r}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(r||(r={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(i||(i={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(a||(a={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(o||(o={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(s||(s={}));const c={float32:o,int32:i,bool:a,complex64:s};function u(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast ".concat(t," with ").concat(e))}return c[t][e]}function l(t){return u(t,"int32")}function h(t){return null!=t&&"object"===typeof t&&"texture"in t&&t.texture instanceof WebGLTexture}function d(t){return"undefined"!==typeof GPUBuffer&&null!=t&&"object"===typeof t&&"buffer"in t&&t.buffer instanceof GPUBuffer}},73837:(t,e,n)=>{"use strict";n.r(e),n.d(e,{arraysEqual:()=>a.r1,arraysEqualWithNull:()=>a.e_,assert:()=>a.vA,assertNonNegativeIntegerDimensions:()=>a.SA,assertNonNull:()=>a.HO,assertShapesMatch:()=>a.O3,bytesFromStringArray:()=>a.SL,bytesPerElement:()=>a.jv,checkConversionForErrors:()=>a.nd,clamp:()=>a.qE,computeStrides:()=>a.Ur,convertBackendValuesAndArrayBuffer:()=>a.o2,createScalarValue:()=>x,createShuffledIndices:()=>a.P8,decodeString:()=>C,distSquared:()=>a.oO,encodeString:()=>A,fetch:()=>_,fingerPrint64:()=>b,flatten:()=>E,getArrayFromDType:()=>a.Ab,getTypedArrayFromDType:()=>a.ce,hasEncodingLoss:()=>a.BE,hexToLong:()=>c,indexToLoc:()=>a._k,inferDtype:()=>a.X$,inferFromImplicitShape:()=>a.XT,isBoolean:()=>a.Lm,isFunction:()=>a.Tn,isInt:()=>a.E6,isNumber:()=>a.Et,isPromise:()=>a.yL,isScalarShape:()=>a.Sf,isString:()=>a.Kg,isTypedArray:()=>S,isValidDtype:()=>a.xn,locToIndex:()=>a.sX,makeOnesTypedArray:()=>a.FZ,makeZerosNestedTypedArray:()=>a.c7,makeZerosTypedArray:()=>a.Ty,nearestDivisor:()=>a.lK,nearestLargerEven:()=>a.eV,now:()=>k,parseAxisParam:()=>a.Y6,randUniform:()=>a.so,repeatedTry:()=>a._q,rightPad:()=>a.av,shuffle:()=>a.k4,shuffleCombo:()=>a.a0,sizeFromShape:()=>a.Ze,sizeToSquarishShape:()=>a.gS,squeezeShape:()=>a.gx,sum:()=>a.cz,swap:()=>a.wg,tanh:()=>a.ym,toNestedArray:()=>a.yw,toTypedArray:()=>w});var r=n(89e3),i=n(84634),a=n(23869),o=n(61072);const s=n.n(o)()||o;function c(t){return s.fromString(t,!0,16)}const u=c("c3a5c85c97cb3127"),l=c("b492b66fbe98f273"),h=c("9ae16a3b2f90404f");function d(t){return t.xor(t.shru(47))}function f(t,e,n){const r=t.slice(e,e+n);return s.fromBytes(Array.from(r),!0,!0)}function p(t,e){return f(t,e,8)}function g(t,e){return f(t,e,4)}function m(t,e){return 0===e?t:t.shru(e).or(t.shl(64-e))}function v(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c("9ddfea08eb382d69"),r=t.xor(e).mul(n);r=r.xor(r.shru(47));let i=e.xor(r).mul(n);return i=i.xor(i.shru(47)),i=i.mul(n),i}function y(t,e,n,r){return function(t,e,n,r,i,a){i=i.add(t),a=m(a.add(i).add(r),21);const o=i;return i=(i=i.add(e)).add(n),a=a.add(m(i,44)),[i.add(r),a.add(o)]}(p(t,e),p(t,e+8),p(t,e+16),p(t,e+24),n,r)}function b(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;const n=s.fromNumber(81,!0);if(e<=32)return e<=16?function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;if(e>=8){const n=h.add(2*e),r=p(t,0).add(h),i=p(t,e-8);return v(m(i,37).mul(n).add(r),m(r,25).add(i).mul(n),n)}if(e>=4){const n=h.add(2*e);return v(g(t,0).shl(3).add(e),g(t,e-4),n)}if(e>0){const n=t[0]+(t[e>>1]<<8),r=e+(t[e-1]<<2);return d(h.mul(n).xor(u.mul(r))).mul(h)}return h}(t,e):function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;const n=h.add(2*e),r=p(t,0).mul(l),i=p(t,8),a=p(t,e-8).mul(n),o=p(t,e-16).mul(h);return v(m(r.add(i),43).add(m(a,30)).add(o),r.add(m(i.add(h),18)).add(a),n)}(t,e);if(e<=64)return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;const n=h.add(2*e),r=p(t,0).mul(h),i=p(t,8),a=p(t,e-8).mul(n),o=p(t,e-16).mul(h),s=m(r.add(i),43).add(m(a,30)).add(o),c=v(s,r.add(m(i.add(h),18)).add(a),n),u=p(t,16).mul(n),l=p(t,24),d=s.add(p(t,e-32)).mul(n),f=c.add(p(t,e-24)).mul(n);return v(m(u.add(l),43).add(m(d,30)).add(f),u.add(m(l.add(r),18)).add(d),n)}(t,e);let r=n,i=n.mul(l).add(113),a=d(i.mul(h).add(113)).mul(h),o=[s.UZERO,s.UZERO],c=[s.UZERO,s.UZERO];r=r.mul(h).add(p(t,0));let f=0;const b=64*(e-1>>6),x=b+(e-1&63)-63;do{r=m(r.add(i).add(o[0]).add(p(t,f+8)),37).mul(l),i=m(i.add(o[1]).add(p(t,f+48)),42).mul(l),r=r.xor(c[1]),i=i.add(o[0]).add(p(t,f+40)),a=m(a.add(c[0]),33).mul(l),o=y(t,f,o[1].mul(l),r.add(c[0])),c=y(t,f+32,a.add(c[1]),i.add(p(t,f+16))),[a,r]=[r,a],f+=64}while(f!==b);const w=l.add(a.and(255).shl(1));return f=x,c[0]=c[0].add(e-1&63),o[0]=o[0].add(c[0]),c[0]=c[0].add(o[0]),r=m(r.add(i).add(o[0]).add(p(t,f+8)),37).mul(w),i=m(i.add(o[1]).add(p(t,f+48)),42).mul(w),r=r.xor(c[1].mul(9)),i=i.add(o[0].mul(9).add(p(t,f+40))),a=m(a.add(c[0]),33).mul(w),o=y(t,f,o[1].mul(w),r.add(c[0])),c=y(t,f+32,a.add(c[1]),i.add(p(t,f+16))),[a,r]=[r,a],v(v(o[0],c[0],w).add(d(i).mul(u)).add(a),v(o[1],c[1],w).add(r),w)}function x(t,e){return"string"===e?A(t):w([t],e)}function w(t,e){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=E(t)),(0,r._K)().getBool("DEBUG")&&a.nd(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){const e=new Uint8Array(t.length);for(let n=0;n<e.length;++n)0!==Math.round(t[n])&&(e[n]=1);return e}throw new Error("Unknown data type ".concat(e))}function k(){return(0,r._K)().platform.now()}function _(t,e){return(0,r._K)().platform.fetch(t,e)}function A(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return e=e||"utf-8",(0,r._K)().platform.encode(t,e)}function C(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return e=e||"utf-8",(0,r._K)().platform.decode(t,e)}function S(t){return null!=(0,r._K)().platform.isTypedArray?(0,r._K)().platform.isTypedArray(t):(0,i.Y)(t)}function E(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e&&(e=[]),"boolean"===typeof t||"number"===typeof t||"string"===typeof t||a.yL(t)||null==t||S(t)&&n)e.push(t);else if(Array.isArray(t)||S(t))for(let r=0;r<t.length;++r)E(t[r],e,n);else{let r=-1;for(const e of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(e)&&(r=Math.max(r,Number(e)));for(let i=0;i<=r;i++)E(t[i],e,n)}return e}},23869:(t,e,n)=>{"use strict";function r(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,s(t,e,n)}function i(t,e){if(t.length!==e.length)throw new Error("Array sizes must match to be shuffled together "+"First array length was ".concat(t.length)+"Second array length was ".concat(e.length));let n=t.length,r=0;for(;n>0;)r=Math.random()*n|0,n--,s(t,n,r),s(e,n,r)}function a(t,e,n){return Math.max(t,Math.min(e,n))}function o(t){return t%2===0?t:t+1}function s(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function c(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function u(t,e){const n=Math.random();return e*n+(1-n)*t}function l(t,e){let n=0;for(let r=0;r<t.length;r++){const i=Number(t[r])-Number(e[r]);n+=i*i}return n}function h(t,e){if(!t)throw new Error("string"===typeof e?e:e())}function d(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";h(v(t,e),(()=>n+" Shapes ".concat(t," and ").concat(e," must match")))}function f(t){h(null!=t,(()=>"The input to the tensor constructor must be a non-null value."))}function p(t){if(0===t.length)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function g(t){return 0===t.length}function m(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(null!==t[n]&&null!==e[n]&&t[n]!==e[n])return!1;return!0}function v(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function y(t){return t%1===0}function b(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function x(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function w(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return r(e),e}function k(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function _(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t=>0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return new Promise(((i,a)=>{let o=0;const s=()=>{if(t())return void i();o++;const c=e(o);null!=n&&o>=n?a():null!=r?r(s,c):setTimeout(s,c)};s()}))}function A(t,e){let n=1,r=-1;for(let a=0;a<t.length;++a)if(t[a]>=0)n*=t[a];else if(-1===t[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(a));r=a}else if(t[a]<0)throw Error("Shapes can not be < 0. Found ".concat(t[a]," at dim ").concat(a));if(-1===r){if(e>0&&e!==n)throw Error("Size(".concat(e,") must match the product of shape ").concat(t));return t}if(0===n)throw Error("Cannot infer the missing size in [".concat(t,"] when ")+"there are 0 elements");if(e%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(e," / ").concat(n));const i=t.slice();return i[r]=e/n,i}function C(t,e){const n=e.length;return h((t=null==t?e.map(((t,e)=>e)):[].concat(t)).every((t=>t>=-n&&t<n)),(()=>"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(t))),h(t.every((t=>y(t))),(()=>"All values in axis param must be integers but "+"got axis ".concat(t))),t.map((t=>t<0?n+t:t))}function S(t,e){const n=[],r=[],i=null!=e&&Array.isArray(e)&&0===e.length,a=null==e||i?null:C(e,t).sort();let o=0;for(let s=0;s<t.length;++s){if(null!=a){if(a[o]===s&&1!==t[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(t[s],"' is not 1"));(null==a[o]||a[o]>s)&&1===t[s]&&(n.push(t[s]),r.push(s)),a[o]<=s&&o++}1!==t[s]&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function E(t,e){return T(t,e)}function T(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type ".concat(t));n=new Array(e)}return n}function N(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(e," being uploaded contains ").concat(r,"."))}}function F(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function D(t,e){return"complex64"!==e&&(("float32"!==e||"complex64"===t)&&(("int32"!==e||"float32"===t||"complex64"===t)&&("bool"!==e||"bool"!==t)))}function I(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype ".concat(t))}function M(t){if(null==t)return 0;let e=0;return t.forEach((t=>e+=t.length)),e}function O(t){return"string"===typeof t||t instanceof String}function R(t){return"boolean"===typeof t}function z(t){return"number"===typeof t}function B(t){return Array.isArray(t)?B(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":z(t)?"float32":O(t)?"string":R(t)?"bool":"float32"}function L(t){return!!(t&&t.constructor&&t.call&&t.apply)}function P(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function j(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function U(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=new Array;if(1===e.length){const a=e[0]*(r?2:1);for(let e=0;e<a;e++)i[e]=n[t+e]}else{const a=e[0],o=e.slice(1),s=o.reduce(((t,e)=>t*e))*(r?2:1);for(let e=0;e<a;e++)i[e]=U(t+e*s,o,n,r)}return i}function W(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===t.length)return e[0];const r=t.reduce(((t,e)=>t*e))*(n?2:1);if(0===r)return[];if(r!==e.length)throw new Error("[".concat(t,"] does not match the input size ").concat(e.length).concat(n?" for a complex tensor":"","."));return U(0,t,e,n)}function V(t,e){if(Array.isArray(t))return t;if("float32"===e)return t instanceof Float32Array?t:new Float32Array(t);if("int32"===e)return t instanceof Int32Array?t:new Int32Array(t);if("bool"===e||"string"===e)return Uint8Array.from(new Int32Array(t));throw new Error("Unknown dtype ".concat(e))}function q(t,e){const n=G(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function G(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type ".concat(e))}function H(t,e){const n=t.reduce(((t,e)=>t*e),1);if(null==e||"float32"===e)return W(t,new Float32Array(n));if("int32"===e)return W(t,new Int32Array(n));if("bool"===e)return W(t,new Uint8Array(n));throw new Error("Unknown data type ".concat(e))}function Y(t){t.forEach((e=>{h(Number.isInteger(e)&&e>=0,(()=>"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(t,"].")))}))}function X(t,e,n){if(0===e)return 0;if(1===e)return t[0];let r=t[t.length-1];for(let i=0;i<t.length-1;++i)r+=n[i]*t[i];return r}function K(t,e,n){if(0===e)return[];if(1===e)return[t];const r=new Array(e);for(let i=0;i<r.length-1;++i)r[i]=Math.floor(t/n[i]),t-=r[i]*n[i];return r[r.length-1]=t,r}function Q(t){return t&&t.then&&"function"===typeof t.then}n.d(e,{Ab:()=>T,BE:()=>D,E6:()=>y,Et:()=>z,FZ:()=>q,HO:()=>f,Kg:()=>O,Lm:()=>R,O3:()=>d,P8:()=>w,SA:()=>Y,SL:()=>M,Sf:()=>g,Tn:()=>L,Ty:()=>G,Ur:()=>j,X$:()=>B,XT:()=>A,Y6:()=>C,Ze:()=>p,_k:()=>K,_q:()=>_,a0:()=>i,av:()=>k,c7:()=>H,ce:()=>E,cz:()=>c,eV:()=>o,e_:()=>m,gS:()=>x,gx:()=>S,jv:()=>I,k4:()=>r,lK:()=>P,nd:()=>N,o2:()=>V,oO:()=>l,qE:()=>a,r1:()=>v,sX:()=>X,so:()=>u,vA:()=>h,wg:()=>s,xn:()=>F,yL:()=>Q,ym:()=>b,yw:()=>W})},84536:(t,e,n)=>{"use strict";n.d(e,{jG:()=>s});var r=n(37837),i=n(11053),a=n(28801),o=n(48906);class s{constructor(){this.size=null}batch(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this;let i;return r.util.assert(t>0,(()=>"batchSize needs to be positive, but it is\n      ".concat(t))),i=this.size===1/0||null==this.size?this.size:e?Math.ceil(this.size/t):Math.floor(this.size/t),c((async()=>(await n.iterator()).columnMajorBatch(t,e,u)),i)}concatenate(t){const e=this;let n;return n=this.size===1/0||t.size===1/0?1/0:null!=this.size&&null!=t.size?this.size+t.size:null,c((async()=>(await e.iterator()).concatenate(await t.iterator())),n)}filter(t){const e=this;let n;return n=this.size===1/0?1/0:null,c((async()=>(await e.iterator()).filter((e=>r.tidy((()=>t(e)))))),n)}async forEachAsync(t){return(await this.iterator()).forEachAsync(t)}map(t){const e=this;return c((async()=>(await e.iterator()).map((e=>r.tidy((()=>t(e)))))),this.size)}mapAsync(t){const e=this;return c((async()=>(await e.iterator()).mapAsync(t)),this.size)}prefetch(t){if(null==t)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const e=this;return c((async()=>(await e.iterator()).prefetch(t)),this.size)}repeat(t){const e=this;let n;return n=null!=this.size&&t>0?this.size*t:0===t?0:null!=this.size&&(void 0===t||t<0)?1/0:null,c((async()=>{const n=(0,a.ht)((async()=>({value:await e.iterator(),done:!1})));return(0,a.kP)(n.take(t))}),n)}skip(t){const e=this;let n;return n=null!=this.size&&t>=0&&this.size>=t?this.size-t:null!=this.size&&(this.size<t||void 0===t||t<0)?0:null,c((async()=>(await e.iterator()).skip(t)),n)}shuffle(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==t||t<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+"bufferSize to the dataset size (".concat(this.size," elements)"));const a=this,o=i.alea(e||r.util.now().toString());return c((async()=>{let e=o.int32();return n&&(e+=o.int32()),(await a.iterator()).shuffle(t,e.toString())}),this.size)}take(t){const e=this;let n;return n=null!=this.size&&this.size>t?t:null!=this.size&&this.size<=t?this.size:null,c((async()=>(await e.iterator()).take(t)),n)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}function c(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new class extends s{constructor(){super(...arguments),this.size=e}async iterator(){return t()}}}function u(t){if(null===t)return null;const e=t[0];if((0,o.mf)(e)){return{value:function(t){if(0===t.length)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof r.Tensor?r.stack(t):r.tensor(t)}(t),recurse:!1}}return{value:null,recurse:!0}}s.MAX_BUFFER_SIZE=1e4},90479:(t,e,n)=>{"use strict";n(37837);var r=n(84536);n(71021);Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");r.jG},71021:(t,e,n)=>{"use strict";n.d(e,{g:()=>i});var r=n(84536);class i extends r.jG{constructor(t){super(),this.input=t}async iterator(){return(await this.input.iterator()).decodeUTF8().split("\n").map((t=>(t.endsWith("\r")&&(t=t.slice(0,-1)),t)))}}},72247:(t,e,n)=>{"use strict";n.d(e,{q:()=>r});class r{}},9448:(t,e,n)=>{"use strict";n.d(e,{iS:()=>r.r});n(84536),n(90479),n(71021),n(54820),n(45860),n(51219);var r=n(47092)},44039:(t,e,n)=>{"use strict";n.d(e,{_:()=>o});var r=n(37837),i=n(28801),a=n(83200);class o extends i.DJ{decodeUTF8(){return new s(this)}}class s extends a.C{constructor(t){super(),this.upstream=t,this.impl=new c(t)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class c extends i.lh{constructor(t){if(super(),this.upstream=t,(0,r.env)().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{const{StringDecoder:t}=n(4530);this.decoder=new t("utf8")}}summary(){return"".concat(this.upstream.summary()," -> Utf8")}async pump(){const t=await this.upstream.next();let e,n;return!t.done&&(e=t.value,n=(0,r.env)().get("IS_BROWSER")?this.decoder.decode(e,{stream:!0}):this.decoder.write(Buffer.from(e.buffer)),this.outputQueue.push(n),!0)}}},2555:(t,e,n)=>{"use strict";n.d(e,{c:()=>a});var r=n(37837),i=n(44039);class a extends i._{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.file=t,this.options=e,r.util.assert(t instanceof Uint8Array||!!(0,r.env)().get("IS_BROWSER")&&(t instanceof File||t instanceof Blob),(()=>"FileChunkIterator only supports File, Blob and Uint8Array right now.")),this.offset=e.offset||0,this.chunkSize=e.chunkSize||1048576}summary(){return"FileChunks ".concat(this.file)}async next(){if(this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size))return{value:null,done:!0};const t=new Promise(((t,e)=>{const n=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)t(new Uint8Array(this.file.slice(this.offset,n)));else{const r=new FileReader;r.onload=n=>{let i=r.result;if(i instanceof ArrayBuffer&&(i=new Uint8Array(i)),!(i instanceof Uint8Array))return e(new TypeError("FileReader returned unknown type."));t(i)},r.onabort=t=>e(new Error("Aborted")),r.onerror=t=>e(new Error(t.type));const i=this.file.slice(this.offset,n);r.readAsArrayBuffer(i)}this.offset=n}));return{value:await t,done:!1}}}},28801:(t,e,n)=>{"use strict";n.d(e,{DJ:()=>d,ht:()=>l,kP:()=>h,lh:()=>_});var r,i=n(37837),a=n(11053),o=n(27437),s=n(48906),c=n(22434),u=n(95600);function l(t){return new p(t)}function h(t,e){return new C(t,e)}class d{async toArray(){const t=[];let e=await this.next();for(;!e.done;)t.push(e.value),e=await this.next();return t}async toArrayForTest(){const t=this.prefetch(100),e=[];let n=await t.next();for(;!n.done;)e.push(n.value),n=await t.next();return e}async resolveFully(){let t=await this.next();for(;!t.done;)t=await this.next()}async resolveWhile(t){let e=await this.next(),n=t(e.value);for(;!e.done&&n;)e=await this.next(),n=t(e.value)}handleErrors(t){return new w(this,t)}filter(t){return new b(this,t)}map(t){return new x(this,t)}mapAsync(t){return new k(this,t)}serialMapAsync(t){return new k(this,t).serial()}flatmap(t){return new A(this,t)}async forEachAsync(t){return this.map(t).resolveFully()}async serialForEach(t){return this.serialMapAsync(t).resolveWhile((t=>!0===t))}rowMajorBatch(t){return new y(this,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}columnMajorBatch(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.rN;return this.rowMajorBatch(t,e).map((t=>(0,s.sy)(t,n)))}concatenate(t,e){return new C(new f([this,t]),e)}take(t){return t<0||null==t?this:new v(this,t)}skip(t){return t<0||null==t?this:new m(this,t)}prefetch(t){return new S(this,t)}shuffle(t,e){return new E(this,t,e)}serial(){return new g(this)}}class f extends d{constructor(t){super(),this.items=t,this.trav=0}summary(){return"Array of ".concat(this.items.length," items")}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const t=this.items[this.trav];return this.trav++,{value:(0,o.G)(t),done:!1}}}class p extends d{constructor(t){super(),this.nextFn=t}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(t){throw t.message="Error thrown while iterating through a dataset: ".concat(t.message),t}}}class g extends d{constructor(t){super(),this.upstream=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Serial")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){return this.upstream.next()}}class m extends d{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Skip")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const t=await this.upstream.next();if(t.done)return t;i.dispose(t.value)}return this.upstream.next()}}class v extends d{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0}summary(){return"".concat(this.upstream.summary()," -> Take")}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class y extends d{constructor(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(),this.upstream=t,this.batchSize=e,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){const t=[];for(;t.length<this.batchSize;){const e=await this.upstream.next();if(e.done)return this.enableSmallLastBatch&&t.length>0?{value:t,done:!1}:{value:null,done:!0};t.push(e.value)}return{value:t,done:!1}}}class b extends d{constructor(t,e){super(),this.upstream=t,this.predicate=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Filter")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;;){const t=await this.upstream.next();if(t.done||this.predicate(t.value))return t;i.dispose(t.value)}}}class x extends d{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return"".concat(this.upstream.summary()," -> Map")}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const e=i.tensor_util.getTensorsInContainer(t.value),n=this.transform(t.value),r=i.tensor_util.getTensorsInContainer(n);for(const a of e)i.tensor_util.isTensorInList(a,r)||a.dispose();return{value:n,done:!1}}}class w extends d{constructor(t,e){super(),this.upstream=t,this.handler=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> handleErrors")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(t){if(!this.handler(t))return{value:null,done:!0}}}}class k extends d{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return"".concat(this.upstream.summary()," -> AsyncMap")}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const e=i.tensor_util.getTensorsInContainer(t.value),n=await this.transform(t.value),r=i.tensor_util.getTensorsInContainer(n);for(const a of e)i.tensor_util.isTensorInList(a,r)||a.dispose();return{value:n,done:!1}}}class _ extends d{constructor(){super(),this.outputQueue=new c.g,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;0===this.outputQueue.length();)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class A extends _{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return"".concat(this.upstream.summary()," -> Flatmap")}async pump(){const t=await this.upstream.next();if(t.done)return!1;const e=i.tensor_util.getTensorsInContainer(t.value),n=this.transform(t.value),r=i.tensor_util.getTensorsInContainer(n);this.outputQueue.pushAll(n);for(const a of e)i.tensor_util.isTensorInList(a,r)||a.dispose();return!0}}class C extends d{constructor(t,e){super(),this.baseErrorHandler=e,this.lastRead=null,this.iterator=null,this.moreIterators=t}summary(){return"".concat("TODO: fill in upstream of chained summaries"," -> Chained")}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(t){if(await t,null==this.iterator){const t=await this.moreIterators.next();if(t.done)return{value:null,done:!0};this.iterator=t.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const e=await this.iterator.next();return e.done?(this.iterator=null,this.readFromChain(t)):e}}!function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"}(r||(r={}));class S extends d{constructor(t,e){super(),this.upstream=t,this.bufferSize=e,this.buffer=new u.N(e)}summary(){return"".concat(this.upstream.summary()," -> Prefetch")}refill(){for(;!this.buffer.isFull();){const t=this.upstream.next();this.buffer.push(t)}}next(){return this.refill(),this.buffer.shift()}}class E extends S{constructor(t,e,n){super(t,e),this.upstream=t,this.windowSize=e,this.upstreamExhausted=!1,this.random=a.alea(n||i.util.now().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}randomInt(t){return Math.floor(this.random()*t)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const t=this.chooseIndex(),e=await this.buffer.shuffleExcise(t);if(!e.done)return this.refill(),e;this.upstreamExhausted=!0}return{value:null,done:!0}}}},139:(t,e,n)=>{"use strict";n(37837);var r=n(28801);r.DJ},83200:(t,e,n)=>{"use strict";n.d(e,{C:()=>i});var r=n(28801);class i extends r.DJ{split(t){return new a(this,t)}}class a extends i{constructor(t,e){super(),this.upstream=t,this.impl=new o(t,e)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class o extends r.lh{constructor(t,e){super(),this.upstream=t,this.separator=e,this.carryover=""}summary(){return"".concat(this.upstream.summary()," -> Split('").concat(this.separator,"')")}async pump(){const t=await this.upstream.next();if(t.done)return""!==this.carryover&&(this.outputQueue.push(this.carryover),this.carryover="",!0);const e=t.value.split(this.separator);e[0]=this.carryover+e[0];for(const n of e.slice(0,-1))this.outputQueue.push(n);return this.carryover=e[e.length-1],!0}}},54440:(t,e,n)=>{"use strict";n.d(e,{t:()=>a});var r=n(37837),i=n(2555);async function a(t){let e,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;"string"===typeof t?e=t:(e=t.url,n=o(t));const c=await(s||r.util.fetch)(e,n);if(c.ok){const t=new Uint8Array(await c.arrayBuffer());return new i.c(t,a)}throw new Error(c.statusText)}const o=t=>({method:t.method,headers:t.headers,body:t.body,mode:t.mode,credentials:t.credentials,cache:t.cache,redirect:t.redirect,referrer:t.referrer,integrity:t.integrity})},42464:(t,e,n)=>{"use strict";n(37837);var r=n(28801);r.DJ},54820:(t,e,n)=>{"use strict";n(84536),n(90479),n(28801),n(139),n(42464),n(51219)},45860:(t,e,n)=>{"use strict";n.d(e,{E:()=>s});var r=n(37837),i=n(72247),a=n(2555),o=n(30403);class s extends i.q{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.input=t,this.options=e}async iterator(){if((0,o.N)(this.input)&&(0,r.env)().get("IS_NODE")){const t=n(8108);this.input=t.readFileSync(this.input.slice(7))}return new a.c(this.input,this.options)}}},51219:(t,e,n)=>{"use strict";var r=n(72247);n(54440),n(30403),n(45860);r.q},27437:(t,e,n)=>{"use strict";n.d(e,{G:()=>a});var r=n(37837),i=n(48906);function a(t){return(0,i.Bl)(t,o)}function o(t){return t instanceof r.Tensor?{value:t.clone(),recurse:!1}:(0,i.xZ)(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}},48906:(t,e,n)=>{"use strict";n.d(e,{Bl:()=>i,mf:()=>h,rN:()=>c,sy:()=>o,te:()=>u,xZ:()=>l});var r=n(37837);function i(t,e){return a(t,e)}function a(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==t)return null;if("function"===typeof Blob&&t instanceof Blob)return t.slice();if(r.has(t))throw new Error("Circular references are not supported.");if(n.has(t))return n.get(t);const i=e(t);if(i.recurse&&null!==i.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(l(t)){const i=Array.isArray(t)?[]:{};r.add(t);for(const o in t){const s=a(t[o],e,n,r);i[o]=s}return r.delete(t),t.__proto__&&(i.__proto__=t.__proto__),i}throw new Error("Can't recurse into non-iterable type: ".concat(t))}return n.set(t,i.value),i.value}function o(t){return s(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:c)}function s(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;const r=t[0];if(n.has(r))throw new Error("Circular references are not supported.");const i=e(t);if(i.recurse&&null!==i.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(i.recurse){if(l(r)){const i=Array.isArray(r)?[]:{};n.add(r);for(const a in r){const r=s(t.map((t=>t[a])),e,n);i[a]=r}return n.delete(r),i}throw new Error("Can't recurse into non-iterable type: ".concat(r))}return i.value}function c(t){return null===t?null:l(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}async function u(t,e){const n=new Map;a(t,e,n);for(const i of Array.from(n.keys())){const t=n.get(i);if(r.util.isPromise(t)){const e=await t;n.set(i,e)}}return a(t,e,n)}function l(t){let e=!1;if(r.env().get("IS_BROWSER"))e=t instanceof TextDecoder;else{const{StringDecoder:r}=n(80551);e=t instanceof r}return null!=t&&!ArrayBuffer.isView(t)&&(Array.isArray(t)||"object"===typeof t&&!(t instanceof r.Tensor)&&!(t instanceof Promise)&&!e)}function h(t){return null==t||(null===(e=t)||"object"!==typeof e&&"function"!==typeof e)||Array.isArray(t)||"object"===typeof t&&t instanceof r.Tensor||r.util.isTypedArray(t);var e}},22434:(t,e,n)=>{"use strict";n.d(e,{g:()=>i});var r=n(95600);class i extends r.N{constructor(){super(i.INITIAL_CAPACITY)}isFull(){return!1}push(t){super.isFull()&&this.expand(),super.push(t)}unshift(t){super.isFull()&&this.expand(),super.unshift(t)}expand(){const t=2*this.capacity,e=new Array(t),n=this.length();for(let r=0;r<n;r++)e[r]=this.get(this.wrap(this.begin+r));this.data=e,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}i.INITIAL_CAPACITY=32},95600:(t,e,n)=>{"use strict";n.d(e,{N:()=>r});class r{constructor(t){if(this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}wrap(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity}get(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]}set(t,e){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e}length(){let t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)}pushAll(t){for(const e of t)this.push(e)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const t=this.get(this.end);return this.set(this.end,void 0),t}unshift(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t}shuffleExcise(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.wrap(this.begin+t),n=this.get(e);return this.set(e,this.pop()),n}}},30403:(t,e,n)=>{"use strict";function r(t){return"string"===typeof t&&"file://"===t.slice(0,7)}n.d(e,{N:()=>r})},47092:(t,e,n)=>{"use strict";n.d(e,{r:()=>r});const r="4.17.0"},97607:(t,e,n)=>{"use strict";n.d(e,{Bu:()=>w,b_:()=>_,rF:()=>v});var r=n(37837),i=n(36043),a=n(50531);class o extends r.serialization.Serializable{getConfig(){return{}}}class s extends o{apply(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return i.Pq(t,e)}}s.className="elu",r.serialization.registerClass(s);class c extends o{apply(t){return r.selu(t)}}c.className="selu",r.serialization.registerClass(c);class u extends o{apply(t){return r.relu(t)}}u.className="relu",r.serialization.registerClass(u);class l extends o{apply(t){return(0,r.tidy)((()=>r.minimum(6,r.relu(t))))}}l.className="relu6",r.serialization.registerClass(l);class h extends o{apply(t){return t}}h.className="linear",r.serialization.registerClass(h);class d extends o{apply(t){return r.sigmoid(t)}}d.className="sigmoid",r.serialization.registerClass(d);class f extends o{apply(t){return i.KK(t)}}f.className="hardSigmoid",r.serialization.registerClass(f);class p extends o{apply(t){return r.softplus(t)}}p.className="softplus",r.serialization.registerClass(p);class g extends o{apply(t){return i.aY(t)}}g.className="softsign",r.serialization.registerClass(g);class m extends o{apply(t){return r.tanh(t)}}m.className="tanh",r.serialization.registerClass(m);class v extends o{apply(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return r.softmax(t,e)}}v.className="softmax",r.serialization.registerClass(v);class y extends o{apply(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return r.logSoftmax(t,e)}}y.className="logSoftmax",r.serialization.registerClass(y);class b extends o{apply(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,r.tidy)((()=>r.mul(r.sigmoid(r.mul(t,e)),t)))}}b.className="swish",r.serialization.registerClass(b);class x extends o{apply(t){return(0,r.tidy)((()=>r.mul(t,r.tanh(r.softplus(t)))))}}function w(t){return t.getClassName()}function k(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.Xv)(t,r.serialization.SerializationMap.getMap().classNameMap,e,"activation")}function _(t){if(null==t){const t={className:"linear",config:{}};return k(t)}if("string"===typeof t){const e={};return e.className=t,e.config={},k(e)}return t instanceof o?t:k(t)}x.className="mish",r.serialization.registerClass(x)},71344:(t,e,n)=>{"use strict";n.d(e,{Ni:()=>a,VI:()=>o});var r=n(37837);let i;function a(){return null==i&&(i=(0,r.backend)().epsilon()),i}function o(){return"channelsLast"}},51244:(t,e,n)=>{"use strict";n.d(e,{X:()=>r});class r{constructor(t){this.seed=t}next(){if(void 0!==this.seed)return this.seed++}}r.className="RandomSeed"},76140:(t,e,n)=>{"use strict";n.d(e,{j:()=>i,v:()=>o});let r=0;function i(){return r++}const a={};function o(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t in a||(a[t]=0),a[t]+=1,t+a[t].toString()}},36043:(t,e,n)=>{"use strict";n.d(e,{Bq:()=>h,Dh:()=>f,EZ:()=>E,Ew:()=>k,FE:()=>b,KK:()=>T,Ls:()=>N,Om:()=>x,PS:()=>d,Pq:()=>C,UG:()=>u,Vs:()=>y,aY:()=>S,kg:()=>w,ly:()=>v,ni:()=>A,r0:()=>g,u1:()=>m,ux:()=>l,wg:()=>c});var r=n(37837),i=n(32381),a=n(5351),o=n(11690),s=n(71344);function c(t,e){return r.cast(t,e)}function u(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),r.reshape(t,n)}function l(t,e){return(0,r.tidy)((()=>{if(2!==t.shape.length)throw new a.Qp("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(t.shape.length," tensor."));return y(u(t,1),[1,e,1])}))}function h(t){const e=[o.no(t.shape)];return r.reshape(t,e)}function d(t){if(t.rank<=1)throw new a.Qp("batchFlatten requires a minimum rank of 2. Got rank: ".concat(t.rank,"."));const e=[t.shape[0],o.no(t.shape,1)];return r.reshape(t,e)}function f(t,e,n){return(0,r.tidy)((()=>{switch(t.rank){case 1:return r.slice1d(t,e,n);case 2:return r.slice2d(t,[e,0],[n,t.shape[1]]);case 3:return r.slice3d(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return r.slice4d(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return r.slice(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return r.slice(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new a.Qp("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(t.rank))}}))}function p(t,e,n){return(0,r.tidy)((()=>{switch(t.rank){case 1:return r.slice1d(t,e,n);case 2:return r.slice2d(t,[0,e],[t.shape[0],n]);case 3:return r.slice3d(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return r.slice4d(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new a.Qp("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(t.rank))}}))}function g(t,e,n,i){return(0,r.tidy)((()=>{switch(t.rank){case 1:return r.slice1d(t,e,n);case 2:switch(i){case 1:return f(t,e,n);case 2:return p(t,e,n);default:throw new a.Qp("The axis is not within the rank of the tensor "+"".concat(i))}case 3:switch(i){case 1:return f(t,e,n);case 2:return r.slice3d(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return p(t,e,n);default:throw new a.Qp("The axis is not within the rank of the tensor "+"".concat(i))}case 4:switch(i){case 1:return f(t,e,n);case 2:return r.slice4d(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return r.slice4d(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return p(t,e,n);default:throw new a.Qp("The axis is not within the rank of the tensor "+"".concat(i))}default:throw new a.Qp("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(t.rank))}}))}function m(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(e=t[0].rank,n=0!==e?e:0),n===t[0].rank&&(n=-1),r.concat(t,n)}function v(t,e){switch(t.rank){case 1:return r.concat1d([t,e]);case 2:return r.concat2d([t,e],0);case 3:return r.concat3d([t,e],0);case 4:return r.concat4d([t,e],0);default:throw new a.Qp("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(t.rank))}}function y(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new a.Qp("The length of input n (".concat(e.length,") does not match ")+"the number of dimensions in input x (".concat(t.rank,")"));return r.tile(t,e)}function b(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;return r.randomNormal(t,e,n,i,a)}function x(t,e,n,i){if(t.rank<2||e.rank<2)throw new a.EH("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(t.shape," and y shape = ").concat(e.shape));if(e.rank>=3){if(t.shape.slice(-1)[0]!==e.shape.slice(-2)[0])throw new a.EH("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(t.shape," and ")+" y shape = ".concat(e.shape))}if(2===t.rank&&2===e.rank){const a=!1,o=!1;return r.fused.matMul({a:t,b:e,transposeA:a,transposeB:o,bias:i?_(t.rank,i,(0,s.VI)()):null,activation:n})}{const a=t.shape.slice(),o=a.pop();t=r.reshape(t,[-1,o]);const c=e.shape.slice(),u=c.pop(),l=c.pop(),h=[...c,u],d=Array.from({length:e.rank},((t,n)=>0===n?e.rank-2:n<=e.rank-2?n-1:n));e=r.reshape(r.transpose(e,d),[l,-1]);const f=[...a,...h],p=!1,g=!1;return r.reshape(r.fused.matMul({a:t,b:e,transposeA:p,transposeB:g,bias:i?_(t.rank,i,(0,s.VI)()):null,activation:n}),f)}}function w(t,e,n){return(0,r.tidy)((()=>(e=Array.isArray(e)?(0,r.tensor1d)(e,"int32"):r.cast(e,"int32"),r.gather(t,e,n))))}function k(t){return r.mul(t,t)}function _(t,e,n){const i=e.shape;if(1!==e.rank&&e.rank!==t)throw new a.Qp("Unexpected bias dimensions: ".concat(e.rank)+"; expected it to be 1 or ".concat(t));if(5===t){if("channelsFirst"===n)return 1===i.length?r.reshape(e,[1,i[0],1,1,1]):r.reshape(e,[1,i[3],i[0],i[1],i[2]]);if("channelsLast"===n)return 1===i.length?r.reshape(e,[1,1,1,1,i[0]]):r.reshape(e,[1].concat(i))}else if(4===t){if("channelsFirst"===n)return 1===i.length?r.reshape(e,[1,i[0],1,1]):r.reshape(e,[1,i[2],i[0],i[1]]);if("channelsLast"===n)return 1===i.length?r.reshape(e,[1,1,1,i[0]]):r.reshape(e,[1].concat(i))}else if(3===t){if("channelsFirst"===n)return 1===i.length?r.reshape(e,[1,i[0],1]):r.reshape(e,[1,i[1],i[0]]);if("channelsLast"===n)return 1===i.length?r.reshape(e,[1,1,i[0]]):r.reshape(e,[1].concat(i))}else if(t<3)return e;throw new a.Qp("Unsupported input rank by biasAdd: ".concat(e.rank))}function A(t,e,n){return(0,r.tidy)((()=>(null==n&&(n=(0,s.VI)()),(0,i.uM)(n),r.add(t,_(t.rank,e,n)))))}function C(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==e)throw new a.EH("Support for alpha values other than 1 (".concat(e,") is not implemented ")+"yet.");return r.elu(t)}function S(t){return(0,r.tidy)((()=>r.div(t,r.add(r.abs(t),1))))}function E(t,e,n,i){return(0,r.tidy)((()=>r.dropout(t,e,n,i)))}function T(t){return(0,r.tidy)((()=>{const e=r.add(.5,r.mul(.2,t));return r.clipByValue(e,0,1)}))}function N(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?t():e()}},29934:(t,e,n)=>{"use strict";n.d(e,{Eq:()=>f,J5:()=>c,dY:()=>g});var r,i=n(37837),a=n(5351),o=n(38759),s=n(50531);!function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"}(r||(r={}));class c{constructor(){this.validationData=null}setParams(t){this.params=t}async onEpochBegin(t,e){}async onEpochEnd(t,e){}async onBatchBegin(t,e){}async onBatchEnd(t,e){}async onTrainBegin(t){}async onTrainEnd(t){}setModel(t){}}class u{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;null==t&&(t=[]),this.callbacks=t,this.queueLength=e}append(t){this.callbacks.push(t)}setParams(t){for(const e of this.callbacks)e.setParams(t)}setModel(t){for(const e of this.callbacks)e.setModel(t)}async onEpochBegin(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onEpochBegin(t,e)}async onEpochEnd(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onEpochEnd(t,e)}async onBatchBegin(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onBatchBegin(t,e)}async onBatchEnd(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onBatchEnd(t,e)}async onTrainBegin(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainBegin(t)}async onTrainEnd(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainEnd(t)}}class l extends c{constructor(){super()}async onEpochBegin(t){this.seen=0,this.totals={}}async onBatchEnd(t,e){null==e&&(e={});const n=null==e.size?0:e.size;this.seen+=n;for(const r in e){const t=e[r];if("number"===typeof t)this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+t*n;else{let e;r in this.totals?e=this.totals[r]:this.totals[r]=0;const a=(0,i.tidy)((()=>(0,i.add)(this.totals[r],(0,i.mul)(t,n))));this.totals[r]=a,null!=e&&e.dispose()}}}async onEpochEnd(t,e){if(null!=e)for(const n of this.params.metrics)null!=this.totals[n]&&("number"===typeof this.totals[n]?e[n]=this.totals[n]/this.seen:(0,i.tidy)((()=>{const t=(0,i.mul)((0,i.div)(1,this.seen),this.totals[n]);e[n]=t,this.totals[n].dispose(),(0,i.keep)(e[n])})))}}class h extends c{async onTrainBegin(t){this.epoch=[],this.history={}}async onEpochEnd(t,e){null==e&&(e={}),this.epoch.push(t);for(const n in e)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(e[n])}async syncData(){const t=[],e=[],n=[];for(const i in this.history){const r=this.history[i];for(let a=0;a<r.length;++a)if("number"!==typeof r[a]){const o=r[a];t.push(o.data()),e.push(i),n.push(a)}}const r=await Promise.all(t);for(let i=0;i<r.length;++i){this.history[e[i]][n[i]].dispose(),this.history[e[i]][n[i]]=r[i][0]}}}class d extends c{constructor(t,e){if(super(),this.currentEpoch=0,this.nowFunc=t.nowFunc,this.nextFrameFunc=t.nextFrameFunc||i.nextFrame,this.yieldEvery=e||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=t.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");i.util.isNumber(this.yieldEvery)&&(this.maybeWait=s.sg(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}async maybeWait(t,e,n){const r=[];null!=this.yield&&(await(0,o.I)(n),r.push(this.yield(t,e,n))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(t,e){this.currentEpoch=t,null!=this.epochBegin&&(await(0,o.I)(e),await this.epochBegin(t,e))}async onEpochEnd(t,e){const n=[];null!=this.epochEnd&&(await(0,o.I)(e),n.push(this.epochEnd(t,e))),"epoch"===this.yieldEvery&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(t,e){null!=this.batchBegin&&(await(0,o.I)(e),await this.batchBegin(t,e))}async onBatchEnd(t,e){const n=[];null!=this.batchEnd&&(await(0,o.I)(e),n.push(this.batchEnd(t,e))),"batch"===this.yieldEvery?n.push(this.nextFrameFunc()):i.util.isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,t,e)),await Promise.all(n)}async onTrainBegin(t){null!=this.trainBegin&&(await(0,o.I)(t),await this.trainBegin(t))}async onTrainEnd(t){null!=this.trainEnd&&(await(0,o.I)(t),await this.trainEnd(t))}}function f(t,e){if(null==t&&(t={}),t instanceof c)return[t];if(Array.isArray(t)&&t[0]instanceof c)return t;return s.st(t).map((t=>new d(t,e)))}class p{constructor(){}static registerCallbackConstructor(t,e){i.util.assert(t>=0&&Number.isInteger(t),(()=>"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(t))),p.checkForDuplicate(e),null==p.constructors[t]&&(p.constructors[t]=[]),p.constructors[t].push(e)}static checkForDuplicate(t){for(const e in p.constructors){p.constructors[+e].forEach((e=>{if(e===t)throw new a.Qp("Duplicate callback constructor.")}))}}static clear(){p.constructors={}}static createCallbacks(t){const e=[];for(const n in p.constructors){const r=+n;t>=r&&e.push(...p.constructors[r])}return e.map((t=>new t))}}function g(t,e,n,r,i,a,o,s,c){const d=new h,f=[new l,...p.createCallbacks(e)];null!=t&&f.push(...t),f.push(d);const g=new u(f);return g.setParams({epochs:n,initialEpoch:r,samples:i,steps:a,batchSize:o,verbose:e,doValidation:s,metrics:c}),{callbackList:g,history:d}}p.constructors={}},65126:(t,e,n)=>{"use strict";var r=n(29934);n(31483),n(5351),n(38759);r.J5},32381:(t,e,n)=>{"use strict";n.d(e,{BC:()=>f,IU:()=>d,Kx:()=>u,Uc:()=>p,tB:()=>c,uM:()=>o,uU:()=>s});var r=n(1002),i=n(50531);const a=new Map;function o(t){(0,i.E6)(r.To,"DataFormat",t)}function s(t){(0,i.E6)(r.ft,"InterpolationFormat",t)}function c(t){(0,i.E6)(r.EY,"PaddingMode",t)}function u(t){(0,i.E6)(r.bb,"PoolMode",t)}const l=[],h="/";function d(t,e){l.push(t);try{const t=e();return l.pop(),t}catch(n){throw l.pop(),n}}function f(t){if(!m(t))throw new Error("Not a valid tensor name: '"+t+"'");return(0===l.length?"":l.join(h)+h)+t}function p(t){if(!m(t))throw new Error("Not a valid tensor name: '"+t+"'");a.has(t)||a.set(t,0);const e=a.get(t);if(a.set(t,a.get(t)+1),e>0){const n="".concat(t,"_").concat(e);return a.set(n,1),n}return t}const g=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function m(t){return!!t.match(g)}},5874:(t,e,n)=>{"use strict";n.d(e,{YZ:()=>g,uH:()=>f});var r=n(37837),i=n(71344),a=n(50531);function o(t,e){return(0,r.tidy)((()=>r.sqrt(r.sum(r.mul(t,t),e,!0))))}class s extends r.serialization.Serializable{getConfig(){return{}}}class c extends s{constructor(t){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return(0,r.tidy)((()=>{const e=o(t,this.axis),n=r.clipByValue(e,0,this.maxValue);return r.mul(t,r.div(n,r.add((0,i.Ni)(),e)))}))}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}c.className="MaxNorm",r.serialization.registerClass(c);class u extends s{constructor(t){super(),this.defaultAxis=0,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return(0,r.tidy)((()=>r.div(t,r.add((0,i.Ni)(),o(t,this.axis)))))}getConfig(){return{axis:this.axis}}}u.className="UnitNorm",r.serialization.registerClass(u);class l extends s{apply(t){return r.relu(t)}}l.className="NonNeg",r.serialization.registerClass(l);class h extends s{constructor(t){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=t.minValue?t.minValue:this.defaultMinValue,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.rate=null!=t.rate?t.rate:this.defaultRate,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return(0,r.tidy)((()=>{const e=o(t,this.axis),n=r.add(r.mul(this.rate,r.clipByValue(e,this.minValue,this.maxValue)),r.mul(1-this.rate,e));return r.mul(t,r.div(n,r.add((0,i.Ni)(),e)))}))}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}h.className="MinMaxNorm",r.serialization.registerClass(h);const d={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function f(t){return(0,a.k4)(t)}function p(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.Xv)(t,r.serialization.SerializationMap.getMap().classNameMap,e,"constraint")}function g(t){if(null==t)return null;if("string"===typeof t){return p({className:t in d?d[t]:t,config:{}})}return t instanceof s?t:p(t)}},13010:(t,e,n)=>{"use strict";n.d(e,{W:()=>a});var r=n(51544),i=n(51244);class a extends r.Wd{constructor(t){super(t),this.randomGenerator=new i.X(t.seed)}getConfig(){const t={seed:this.randomGenerator.seed},e=super.getConfig();return Object.assign(t,e),t}}a.className="BaseRandomLayer"},9662:(t,e,n)=>{"use strict";n.d(e,{m:()=>g});var r=n(37837),i=n(76140),a=n(5351),o=n(5877),s=n(50531),c=n(69834),u=n(62755),l=n(1947),h=n(74022),d=n(81676),f=n(12335),p=n(51544);class g extends p.Wd{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,null==this.name){const t=this.getClassName().toLowerCase();this.name=(0,i.v)(t)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],s.Am(this.inputs).length!==this.inputs.length)throw new a.Qp("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(this.inputs.map((t=>t.name))));s.Am(this.outputs).length!==this.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(this.outputs.map((t=>t.name)))),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const i of this.outputs){const t=i.sourceLayer,e=i.nodeIndex,n=i.tensorIndex;this.outputLayers.push(t),this.outputLayersNodeIndices.push(e),this.outputLayersTensorIndices.push(n)}for(const i of this.inputs){const t=i.sourceLayer,e=i.nodeIndex,n=i.tensorIndex;s.vA(0===e,"input layer has >1 nodes"),s.vA(0===n,"input layer has >1 tensors"),this.inputLayers.push(t),this.inputLayersNodeIndices.push(e),this.inputLayersTensorIndices.push(n)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let i=0;i<this.inputLayers.length;i++){const e=this.inputLayers[i];if(!(e instanceof f.m))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(t.inputs,". ")+"Input ".concat(i," (0-based) originates ")+"from layer type ".concat(e.getClassName(),"."));this.inputNames.push(e.name),this.feedInputShapes.push(e.batchInputShape),this.feedInputNames.push(e.name)}for(const i of this.outputLayers)this.outputNames.push(i.name);this.internalInputShapes=this.inputs.map((t=>t.shape)),this.internalOutputShapes=this.outputs.map((t=>t.shape));const e={},n={},r={},o={},c={},u=[],l=(t,e,n,r,i,o)=>{null!=r&&null!=i&&null!=o||(r=t.sourceLayer,i=t.nodeIndex,o=t.tensorIndex);const s=r.inboundNodes[i];if(-1!==n.indexOf(s))throw new a.bu("The tensor ".concat(t.name,' at layer "').concat(r.name,'" ')+"is part of a cycle.");if(-1!==e.indexOf(s))return;this.containerNodes.add(g.nodeKey(r,i)),r.id in c||(c[r.id]=Object.keys(c).length),-1===n.indexOf(s)&&n.push(s);const h=s.inboundLayers.length;for(let a=0;a<h;a++){const t=s.inputTensors[a],r=s.inboundLayers[a],i=s.nodeIndices[a],o=s.tensorIndices[a];l(t,e,n,r,i,o)}for(e.push(s);n.indexOf(s)>=0;)n.splice(n.indexOf(s),1);u.push(s)},h=[],d=[];for(const i of this.outputs)l(i,h,d);const m=u.slice().reverse();for(const i of m){n[i.id]=i,i.id in e||(e[i.id]=0);let t=e[i.id];const a=null==r[i.outboundLayer.id]?0:r[i.outboundLayer.id];t=Math.max(t,a),r[i.outboundLayer.id]=t,o[i.outboundLayer.id]=i.outboundLayer,e[i.id]=t;for(let r=0;r<i.inboundLayers.length;r++){const a=i.inboundLayers[r],o=i.nodeIndices[r],s=a.inboundNodes[o],c=null==e[s.id]?0:e[s.id];e[s.id]=Math.max(t+1,c),n[s.id]=s}}const v={};for(const i in e){const t=e[i];t in v||(v[t]=[]),v[t].push(n[i])}const y={};for(const i in r){const t=r[i];t in y||(y[t]=[]),y[t].push(o[i])}let b=Object.keys(y).map((t=>parseInt(t,10))).sort(s.th);this.layers=[];for(const i of b){const t=y[i];t.sort(((t,e)=>{const n=c[t.id],r=c[e.id];return n<r?-1:n>r?1:0}));for(const e of t)e instanceof g&&this.internalContainerRefs.push(e),this.layers.push(e)}this.layersByDepth=y,b=Object.keys(v).map((t=>parseInt(t,10))).sort(s.th);const x=this.inputs.slice(),w=[];for(const i of b)for(const t of v[i]){const e=t.outboundLayer;if(null!=e){for(const n of t.inputTensors)if(-1===x.indexOf(n))throw new a.bu("Graph disconnected: cannot obtain value for tensor ".concat(n)+' at layer "'.concat(e.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(w));for(const e of t.outputTensors)x.push(e);w.push(e.name)}}this.nodesByDepth=v;const k=this.layers.map((t=>t.name));for(const i of k){const t=k.filter((t=>t===i)).length;if(1!==t)throw new a.bu('The name "'.concat(i,'" is used ').concat(t," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(k))}this.outboundNodes=[],this.inboundNodes=[],new p.bP({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map((t=>null)),outputMasks:this.outputs.map((t=>null)),inputShapes:this.inputs.map((t=>t.shape)),outputShapes:this.outputs.map((t=>t.shape))}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){for(const e of this.layers)t.numDisposedVariables+=e.dispose().numDisposedVariables;for(const e of this.internalContainerRefs)t.numDisposedVariables+=e.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach((e=>{e._trainableWeights.forEach((e=>e.trainable=t))})),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new a.Qp("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const e of this.layers)t=t.concat(e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.layers)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.layers)e.push(...t.trainableWeights);return e.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n={};let r=0;const i=(t=>{const e=Object.keys(t);if(0===e.length)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))})(t);i&&this.parseWeights(t);for(const s of this.layers)for(const[t,e]of s.weights.entries()){const o=i?"".concat(e.name.split("/").slice(0,-1).join("/")+"/").concat(t):e.originalName;if(null!=n[o])throw new a.Qp("Duplicate weight name: ".concat(o));n[o]=e,r++}const o=[];for(const s in t){let r=s;if(null==n[s]){const t=s.split("/");r=t.slice(0,-2).concat([t[t.length-1]]).join("/")}if(null!=n[r])o.push([n[r],t[s]]);else if(e)throw new a.Qp("Provided weight data has no target variable: ".concat(s));delete n[r]}if(e){const t=[];for(const e in n)t.push(e);if(t.length>0)throw new a.Qp("".concat(t.length," of ").concat(r," weights are not set: ")+"".concat(t))}(0,l.UM)(o)}parseWeights(t){for(const e in Object.keys(t)){const n=e.split("/"),r=["vars","layer_checkpoint_dependencies"],i=n.map((t=>t.startsWith("_")?t.slice(1):t)).filter((t=>!r.includes(t))).join("/");i!==e&&(t[i]=t[e],delete t[e])}}updatedConfig(){const t=this.getConfig(),e={};return e.className=this.getClassName(),e.config=t,e.kerasVersion="tfjs-layers ".concat(h.r),e.backend="TensorFlow.js",e}toJSON(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=(0,c.M)(this.updatedConfig());return e?JSON.stringify(n):n}call(t,e){return(0,r.tidy)((()=>{t=s.st(t);const n=new d.RW;for(let e=0;e<this.inputs.length;++e)n.add(this.inputs[e],t[e]);return(0,d.g7)(this.outputs,n,e)}))}computeMask(t,e){return(0,r.tidy)((()=>{let n;return t=s.st(t),n=null==e?s.fD(null,t.length):s.st(e),this.runInternalGraph(t,n)[1]}))}computeOutputShape(t){const e=u.FS(t);if(e.length!==this.inputLayers.length)throw new a.Qp("Invalid inputShape argument ".concat(t,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));const n={};for(let a=0;a<e.length;a++){const t=this.inputLayers[a],r=e[a];n[t.name+"_0_0"]=r}const r=Object.keys(this.nodesByDepth).map((t=>parseInt(t,10))).sort(s.th);if(r.length>1)for(const a of r){const t=this.nodesByDepth[a];for(const e of t){const t=e.outboundLayer;if(-1!==this.inputLayers.map((t=>t.id)).indexOf(t.id))continue;const r=[];for(let s=0;s<e.inboundLayers.length;s++){const t=e.inboundLayers[s],i=e.nodeIndices[s],a=e.tensorIndices[s],o=n["".concat(t.name,"_").concat(i,"_").concat(a)];r.push(o)}const i=t.computeOutputShape(s.wL(r)),a=u.FS(i),o=t.inboundNodes.indexOf(e);for(let e=0;e<a.length;e++){n["".concat(t.name,"_").concat(o,"_").concat(e)]=a[e]}}}const i=[],o=[];for(let a=0;a<this.outputLayers.length;a++){const t=this.outputLayers[a],e=this.outputLayersNodeIndices[a],n=this.outputLayersTensorIndices[a],r="".concat(t.name,"_").concat(e,"_").concat(n);o.push(r)}for(let a=0;a<o.length;a++){const t=o[a];s.vA(t in n),i.push(n[t])}return s.wL(i)}runInternalGraph(t,e){null==e&&(e=s.fD(null,t.length));const n={};for(let a=0;a<this.inputs.length;++a){const r=this.inputs[a],i=t[a],o=e[a];n[r.id]=[i,o]}const r=Object.keys(this.nodesByDepth).map((t=>parseInt(t,10))).sort(s.th);for(const u of r){const t=this.nodesByDepth[u];for(const e of t){const t=e.outboundLayer,r=e.inputTensors,i=e.outputTensors,o=new Array;for(const e of r)e.id in n&&o.push(n[e.id]);if(o.length===r.length){let r,c,u,l,h={};if(null!=e.callArgs&&(h=e.callArgs),1===o.length){const[e,n]=o[0];null==h.mask&&(h.mask=n),u=s.st(t.call(e,h)),l=s.st(t.computeMask(e,n)),r=[e],c=[n]}else r=o.map((t=>t[0])),c=o.map((t=>t[1])),null==h.mask&&(h.mask=c),u=s.st(t.call(r,h)),l=s.st(t.computeMask(r,c));if(t.activityRegularizer)throw new a.EH("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let t=0;t<i.length;++t){const e=i[t],r=u[t],a=l[t];n[e.id]=[r,a]}}}}const i=[],o=[],c=[];for(const a of this.outputs){s.vA(a.id in n,"Could not compute output ".concat(a.name," : ").concat(a.id));const[t,e]=n[a.id];c.push(t.shape),i.push(t),o.push(e)}return[i,o,c]}buildNodeConversionMap(t){const e={};let n;for(const r of this.layers){n=r instanceof g?1:0;for(let t=0;t<r.inboundNodes.length;t++){const i=g.nodeKey(r,t);this.containerNodes.has(i)&&(e[i]=n,n+=1)}}return e}getLayer(t,e){if(null!=e)return this.findLayer(e);if(null==t)throw new a.Qp("Provide either a layer name or layer index");if("number"===typeof t)return this.findLayer(t);for(const n of this.layers)if(n.name===t)return n;throw new a.Qp("No such layer: ".concat(t))}findLayer(t){if(this.layers.length<=t)throw new a.Qp("Was asked to retrieve layer at index ".concat(t,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[t]}calculateLosses(){return(0,r.tidy)((()=>{const t=[];for(const e of this.layers)for(let n=0;n<e.inboundNodes.length;++n){const r=g.nodeKey(e,n);this.containerNodes.has(r)&&t.push(...e.calculateLosses())}return t}))}getConfig(){const t={name:this.name},e=this.buildNodeConversionMap(this.layers),n=[];for(const o of this.layers){const t=o.getClassName(),r=o.getConfig(),i=[];for(let n=0;n<o.inboundNodes.length;n++){const t=o.inboundNodes[n],r=g.nodeKey(o,n);let s={};if(this.containerNodes.has(r)){if(t.callArgs)try{JSON.stringify(t.callArgs),s=t.callArgs}catch(a){console.warn("Layer ".concat(o.name," was passed ")+"non-serializable keyword arguments: "+"".concat(t.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),s={}}if(t.inboundLayers.length>0){const n=[];for(let r=0;r<t.inboundLayers.length;r++){const i=t.inboundLayers[r],a=t.nodeIndices[r],o=t.tensorIndices[r];let c=e[g.nodeKey(i,a)];null==c&&(c=0),n.push([i.name,c,o,s])}i.push(n)}}}const s={};s.name=o.name,s.className=t,s.config=r,s.inboundNodes=i,n.push(s)}t.layers=n;const r=[];for(let o=0;o<this.inputLayers.length;o++){const t=this.inputLayers[o],n=this.inputLayersNodeIndices[o],i=g.nodeKey(t,n);if(!this.containerNodes.has(i))continue;let a=e[i];null!==a&&void 0!==a||(a=0);const s=this.inputLayersTensorIndices[o];r.push([t.name,a,s])}t.inputLayers=r;const i=[];for(let o=0;o<this.outputLayers.length;o++){const t=this.outputLayers[o],n=this.outputLayersNodeIndices[o],r=g.nodeKey(t,n);if(!this.containerNodes.has(r))continue;let a=e[r];null!==a&&void 0!==a||(a=0);const s=this.outputLayersTensorIndices[o];i.push([t.name,a,s])}return t.outputLayers=i,t}static fromConfig(t,e){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r={},i={};function c(t,e){t.name in i?i[t.name].push(e):i[t.name]=[e]}function u(t,e){const n=[];let i;for(const a of e){const o=a[0],s=a[1],u=a[2];if(i=null==a[3]?{}:a[3],!(o in r))return void c(t,e);const l=r[o];if(l.inboundNodes.length<=s)return void c(t,e);const h=l.inboundNodes[s];n.push(h.outputTensors[u])}n.length>0&&t.apply(s.wL(n),i)}function l(t){const i=t.name,s=(0,o.i)(t,null!=e.customObjects?e.customObjects:{});s.setFastWeightInitDuringBuild(n),r[i]=s;t.inboundNodes.forEach((t=>{if(!(t instanceof Array))throw new a.Qp("Corrupted configuration, expected array for nodeData: ".concat(t));c(s,t)}))}const h=e.name,d=e.layers;for(const a of d)l(a);for(;!s.ZF(i);)for(const t of d){const e=r[t.name];if(e.name in i){const t=i[e.name];delete i[e.name];for(const n of t)u(e,n)}}const f=[],p=[],g=e.inputLayers;for(const a of g){const t=a[0],e=a[1],n=a[2];s.vA(t in r);const i=r[t].inboundNodes[e].outputTensors;f.push(i[n])}const m=e.outputLayers;for(const a of m){const t=a[0],e=a[1],n=a[2];s.vA(t in r);const i=r[t].inboundNodes[e].outputTensors;p.push(i[n])}return new t({inputs:f,outputs:p,name:h})}get stateful(){if(this._stateful)throw new a.Qp("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){(0,r.tidy)((()=>{this.layers.forEach((t=>{t.stateful&&t.resetStates()}))}))}}},81676:(t,e,n)=>{"use strict";n.d(e,{RW:()=>u,g7:()=>f,oR:()=>d});var r=n(37837),i=n(5351),a=n(83953),o=n(50531),s=n(12335),c=n(51544);class u{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof u)for(const e in t.id2Value)this.id2Value[e]=t.id2Value[e],e in t.id2Mask&&(this.id2Mask[e]=t.id2Mask[e]);else{if(null==t)return;for(const e of t)this.add(e.key,e.value)}}add(t,e,n){if(null!=this.id2Value[t.id])throw new i.Qp("Duplicate key: name=".concat(t.name,", id=").concat(t.id));return this.id2Value[t.id]=function(t,e){if(null==t.dtype||t.dtype===e.dtype)return e;try{return(0,r.cast)(e,t.dtype)}catch(n){throw new i.Qp("The dtype of the feed (".concat(e.dtype,") can not be cast to the dtype ")+"of the key '".concat(t.name,"' (").concat(t.dtype,")."))}}(t,e),this.name2Id[t.name]=t.id,null!=n&&(this.id2Mask[t.id]=n),this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return null!=this.id2Value[t.id]}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof c.Ar){if(null==this.id2Value[t.id])throw new i.Qp("Nonexistent key: ".concat(t.name));return this.id2Value[t.id]}{const e=this.name2Id[t];if(null==e)throw new i.Qp("Feed dict has no SymbolicTensor name: ".concat(t));return this.id2Value[e]}}getMask(t){if(t instanceof c.Ar){if(null==this.id2Value[t.id])throw new i.Qp("Nonexistent key: ".concat(t.name));return this.id2Mask[t.id]}{const e=this.name2Id[t];if(null==e)throw new i.Qp("Feed dict has no SymbolicTensor name: ".concat(t));return this.id2Mask[e]}}disposeMasks(){null!=this.id2Mask&&(0,r.dispose)(this.id2Mask)}}const l=new a.Q,h=new a.Q;function d(t){null!=l&&l.setMaxEntries(t),null!=h&&h.setMaxEntries(t)}function f(t,e,n,i){const a=null!=n&&n.training,c=Array.isArray(t),d=c?t:[t],f=d.map((t=>t.name)),v=[],y=e.names();for(const r of f)-1!==y.indexOf(r)?v.push(e.getValue(r)):v.push(null);null!=i&&(i.maxNumTensors=-1/0,i.minNumTensors=1/0);const b=f.join(",")+"|"+e.names().sort().join(",");let x,w=l.get(b);if(null==w){const t=function(t,e){r.util.assert(null!=t&&t.length>0,(()=>"Expected at least one fetch, got none"));let n=[],i={};if(1===t.length){const r=g(t[0],e);n=r.sorted,i=r.recipientMap}else{const r=new Set;for(const a of t){const{sorted:t,recipientMap:o}=g(a,e);for(const e of t)r.has(e.name)||(n.push(e),r.add(e.name));for(const e in o)null==i[e]&&(i[e]=new Set),o[e].forEach((t=>i[e].add(t)))}}return{sorted:n,recipientCounts:p(i)}}(d,e);w=t.sorted,x=t.recipientCounts,l.put(b,w),h.put(b,x)}x={},a||Object.assign(x,h.get(b));const k=new u(e);for(let u=0;u<w.length;++u){if(null!=i){const t=(0,r.memory)().numTensors;t>i.maxNumTensors&&(i.maxNumTensors=t),t<i.minNumTensors&&(i.minNumTensors=t)}const t=w[u],c=t.sourceLayer;if(c instanceof s.m)continue;const l=[],h=[],d=[];let p=!1;for(const n of t.inputs){const t=k.getValue(n),r=k.getMask(n);l.push(t),h.push(r),null!=r&&(p=!0),a||(x[n.name]--,0!==x[n.name]||e.hasKey(n)||-1!==f.indexOf(n.name)||t.isDisposed||!0===n.sourceLayer.stateful||d.push(t))}p&&((n=n||{}).mask=h[0]);const g=(0,o.st)(c.apply(l,n));let y=null;c.supportsMasking&&(y=c.computeMask(l,h));const b=m(t),_=Array.isArray(b)?b:[b];for(let e=0;e<_.length;++e){k.hasKey(_[e])||k.add(_[e],g[e],Array.isArray(y)?y[0]:y);const t=f.indexOf(_[e].name);-1!==t&&(v[t]=g[e])}a||(0,r.dispose)(d)}return k.disposeMasks(),c?v:v[0]}function p(t){const e={};for(const n in t)e[n]=t[n].size;return e}function g(t,e){const n=new Set,r=[],i={};for(const s of e.names())n.add(s);const a=[],o=[];for(a.push(t);a.length>0;){const t=a[a.length-1];if(n.has(t.name)){a.pop();continue}const e=o[o.length-1]===a.length-1;if(0===t.inputs.length||e)a.pop(),r.push(t),n.add(t.name),e&&o.pop();else{o.push(a.length-1);for(const e of t.inputs)null==i[e.name]&&(i[e.name]=new Set),i[e.name].add(t.name),n.has(e.name)||a.push(e)}}return{sorted:r,recipientMap:i}}function m(t){let e;if(1===t.sourceLayer.inboundNodes.length)e=t.sourceLayer.output;else{let n=null;for(let e=0;e<t.sourceLayer.inboundNodes.length;++e)for(const r of t.sourceLayer.inboundNodes[e].outputTensors)if(r.id===t.id){n=e;break}e=t.sourceLayer.getOutputAt(n)}return e}},12335:(t,e,n)=>{"use strict";n.d(e,{m:()=>s,p:()=>c});var r=n(37837),i=n(76140),a=n(5351),o=n(51544);class s extends o.Wd{constructor(t){if(super({dtype:t.dtype,name:null!=t.name?t.name:(0,i.v)("input").toString()}),null==t.batchSize&&(t.batchSize=null),null==t.sparse&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,null!=t.inputShape&&null!=t.batchInputShape)throw new a.Qp("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let e=t.batchInputShape;if(null==e){if(null==t.inputShape)throw new a.Qp("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");e=[t.batchSize].concat(t.inputShape)}else if(null!=t.batchSize)throw new a.Qp("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const n=t.dtype||"float32";this.batchInputShape=e,this.dtype=n,this.inputSpec=[{shape:e}];const r=new o.Ar(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new o.bP({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[e],outputShapes:[e]})}apply(t,e){throw new a.Qp("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}function c(t){if(null==t.batchShape&&null==t.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=t.batchShape&&null!=t.shape)throw new a.Qp("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;null!=t.shape&&null==e&&(e=[null].concat(t.shape));let n=t.dtype;null==n&&(n="float32");return new s({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}s.className="InputLayer",r.serialization.registerClass(s)},51544:(t,e,n)=>{"use strict";n.d(e,{Ar:()=>f,Wd:()=>v,X6:()=>y,bP:()=>g,eO:()=>d});var r=n(37837),i=n(76140),a=n(32381),o=n(5351),s=n(56817),c=n(50531),u=n(62755),l=n(63644),h=n(1947);class d{constructor(t){this.dtype=t.dtype,this.shape=t.shape,null!=t.shape?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class f{constructor(t,e,n,r,o,s,c){this.dtype=t,this.shape=e,this.sourceLayer=n,this.inputs=r,this.callArgs=o,this.outputTensorIndex=c,this.id=(0,i.j)(),null!=s&&(this.originalName=(0,a.BC)(s),this.name=(0,a.Uc)(this.originalName)),this.rank=e.length}}let p=0;class g{constructor(t,e){this.callArgs=e,this.id=p++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const n of t.inboundLayers)null!=n&&n.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const e of this.inboundLayers)null!=e?t.push(e.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let m=0;class v extends r.serialization.Serializable{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=m++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let e=t.name;if(!e){const t=this.getClassName();e=c.uc(t)+"_"+(0,i.v)(t)}if(this.name=e,this.trainable_=null==t.trainable||t.trainable,null!=t.inputShape||null!=t.batchInputShape){let e;if(null!=t.batchInputShape)e=t.batchInputShape;else if(null!=t.inputShape){let n=null;null!=t.batchSize&&(n=t.batchSize),e=[n].concat(t.inputShape)}this.batchInputShape=e;let n=t.dtype;null==n&&(n=t.inputDType),null==n&&(n="float32"),this.dtype=n}null!=t.weights?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,e){return t.name+"_ib-"+e.toString()}getNodeAtIndex(t,e){if(0===this.inboundNodes.length)throw new o.bu("The layer has never been called "+"and thus has no defined ".concat(e,"."));if(this.inboundNodes.length<=t)throw new o.Qp("Asked to get ".concat(e," at node ").concat(t,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[t]}getInputAt(t){return c.wL(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return c.wL(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new o.l7("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new o.l7("Layer ".concat(this.name)+" is not connected, no input to return.");return c.wL(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new o.l7("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new o.l7("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return c.wL(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map((t=>t()))}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach((e=>e.trainable=t)),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter((t=>t.trainable)):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter((t=>!t.trainable)).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){const e=c.st(t);if(null==this.inputSpec||0===this.inputSpec.length)return;const n=c.st(this.inputSpec);if(e.length!==n.length)throw new o.Qp("Layer ".concat(this.name," expects ").concat(n.length," inputs, ")+"but it received ".concat(e.length," input tensors. ")+"Input received: ".concat(t));for(let r=0;r<e.length;r++){const t=e[r],i=n[r];if(null==i)continue;const a=t.rank;if(null!=i.ndim&&a!==i.ndim)throw new o.Qp("Input ".concat(r," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(i.ndim,", found ndim=").concat(a));if(null!=i.maxNDim&&a>i.maxNDim)throw new o.Qp("Input ".concat(r," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(i.maxNDim,", found ndim=").concat(a));if(null!=i.minNDim&&a<i.minNDim)throw new o.Qp("Input ".concat(r," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(i.minNDim,", found ndim=").concat(a,"."));if(null!=i.dtype&&t.dtype!==i.dtype)throw new o.Qp("Input ".concat(r," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(i.dtype,", found dtype=").concat(t.dtype,"."));if(i.axes){const e=t.shape;for(const t in i.axes){const n=Number(t),a=i.axes[t],s=n>=0?e[n]:e[e.length+n];if(null!=a&&-1===[a,null].indexOf(s))throw new o.Qp("Input ".concat(r," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(n," of input shape to ")+"have value ".concat(a," but got shape ").concat(e,"."))}}if(null!=i.shape)for(let e=0;e<i.shape.length;++e){const n=i.shape[e],a=t.shape[e];if(null!=n&&null!=a&&n!==a)throw new o.Qp("Input ".concat(r," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(i.shape,", ")+"found shape=".concat(t.shape,"."))}}}call(t,e){return t}invokeCallHook(t,e){null!=this._callHook&&this._callHook(t,e)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,e){e=e||{},this.assertNotDisposed();const n=c.st(t),r=function(t){let e=!0;for(const n of c.st(t))if(!(n instanceof f)){e=!1;break}return e}(t),i=function(t){let e=!0;for(const n of c.st(t))if(n instanceof f){e=!1;break}return e}(t);if(r===i)throw new o.Qp("Arguments to apply() must be all SymbolicTensors or all Tensors");return(0,a.IU)(this.name,(()=>{if(!this.built){this.assertInputCompatibility(t);const e=[];for(const n of c.st(t))e.push(n.shape);this.build(c.wL(e)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&i&&(this._refCount=1)}if(this.assertInputCompatibility(t),i){let r=this.call(t,e);this.supportsMasking&&this.setMaskMetadata(t,r);const i=c.st(r),a=[];for(let t of i)-1!==n.indexOf(t)&&(t=t.clone()),a.push(t);if(r=c.wL(a),null!=this.activityRegularizer)throw new o.EH("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return r}{const n=function(t){t=c.st(t);const e=[];for(const n of t)e.push(n.shape);return c.wL(e)}(t),r=this.computeOutputShape(n);let i;const a="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(t)?n[0]:n),i=null!=r&&r.length>0&&Array.isArray(r[0])?r.map(((n,r)=>new f(a,n,this,c.st(t),e,this.name,r))):new f(a,r,this,c.st(t),e,this.name),this.addInboundNode(t,i,null,null,n,r,e),this._refCount++,null!=this.activityRegularizer)throw new o.EH("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}}))}warnOnIncompatibleInputShape(t){if(null!=this.batchInputShape)if(t.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(t),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{let e=!1;this.batchInputShape.forEach(((n,r)=>{null!=n&&null!=t[r]&&t[r]!==n&&(e=!0)})),e&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(t),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new o.l7("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");const t=[];for(const e of this.inboundNodes){const n=JSON.stringify(e.outputShapes);-1===t.indexOf(n)&&t.push(n)}if(1===t.length){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&1===t.length?t[0]:t}throw new o.l7("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "output shape" is ill-defined for the layer.')}countParams(){if(!this.built)throw new o.bu("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return l.Y(this.weights)}build(t){this.built=!0}getWeights(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,h.ex)(t?this.trainableWeights:this.weights)}setWeights(t){(0,r.tidy)((()=>{const e=this.weights;if(e.length!==t.length)throw new o.Qp('You called setWeights(weights) on layer "'.concat(this.name,'" ')+"with a weight list of length ".concat(t.length,", ")+"but the layer was expecting ".concat(e.length," weights. ")+"Provided weights: ".concat(t,"..."));if(0===e.length)return;const n=[],i=(0,h.ex)(e);for(let a=0;a<i.length;++a){const s=i[a],c=e[a],u=t[a];if(!r.util.arraysEqual(s.shape,u.shape))throw new o.Qp("Layer weight shape ".concat(s.shape," ")+"not compatible with provided weight shape ".concat(u.shape));n.push([c,u])}(0,h.UM)(n)}))}addWeight(t,e,n,r,i,a,c,u){if(-1!==this._addedWeightNames.indexOf(t))throw new o.Qp("Duplicate weight name ".concat(t," for layer ").concat(this.name));this._addedWeightNames.push(t),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=null!=u?u():(0,s.Fe)("zeros"));const l=r.apply(e,n),d=new h.eR(l,n,t,a,c);return l.dispose(),null!=i&&this.addLoss((()=>i.apply(d.read()))),null==a&&(a=!0),a?this._trainableWeights.push(d):this._nonTrainableWeights.push(d),d}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){null==t||Array.isArray(t)&&0===t.length||(t=c.st(t),void 0!==this._losses&&null!==this._losses&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,e){if(!this.supportsMasking){if(null!=e){if(!Array.isArray(e))throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");e.forEach((t=>{if(null!=t)throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.")}))}return null}return e}setMaskMetadata(t,e,n){if(!this.supportsMasking)return;const r=this.computeMask(t,n),i=c.st(e),a=c.st(r);if(i.length!==a.length)throw new Error("".concat(this.name," outputs ").concat(i.length," tensors ")+"but ".concat(i.length," masks for those tensors"));for(let o=0;o<i.length;o++)i[o].kerasMask=a[o]}addInboundNode(t,e,n,r,i,a){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;const s=c.st(t);e=c.st(e),n=c.st(n),r=c.st(r),i=u.FS(i),a=u.FS(a);const l=[],h=[],d=[];for(const c of s)l.push(c.sourceLayer),h.push(c.nodeIndex),d.push(c.tensorIndex);new g({outboundLayer:this,inboundLayers:l,nodeIndices:h,tensorIndices:d,inputTensors:s,outputTensors:e,inputMasks:n,outputMasks:r,inputShapes:i,outputShapes:a},o);for(let c=0;c<e.length;c++)e[c].sourceLayer=this,e[c].nodeIndex=this.inboundNodes.length-1,e[c].tensorIndex=c}getConfig(){const t={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(t.batchInputShape=this.batchInputShape),null!=this.dtype&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach((t=>t.dispose())),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}dispose(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();let t=0;return 0===--this._refCount&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function y(t,e,n){if((null==e||null!=n&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),0===e.inboundNodes.length)return[t];{const t=e.inboundNodes[n];if(0===t.inboundLayers.length)return t.inputTensors;{const e=[];for(let n=0;n<t.inboundLayers.length;n++){const r=y(t.inputTensors[n],t.inboundLayers[n],t.nodeIndices[n]);for(const t of r)-1===e.indexOf(t)&&e.push(t)}return e}}}},31483:(t,e,n)=>{"use strict";n.d(e,{Gw:()=>T});var r=n(37837),i=n(36043),a=n(29934),o=n(32381),s=n(5351),c=n(5877),u=n(38759),l=n(57463),h=n(98219),d=n(96776),f=n(41461),p=n(50531),g=n(9591),m=n(11690),v=n(69834),y=n(74022),b=n(9662),x=n(81676),w=n(95100),k=n(58426),_=n(9309);function A(t){return Array.isArray(t)}function C(t){return!function(t){return t instanceof r.Tensor}(t)&&!A(t)}function S(t,e,n){let r,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==e||0===e.length){if(null!=t){let e=!1;if(A(t)&&t.length>0)e=!0;else if(C(t)){for(const n in t)if(t.hasOwnProperty(n)){e=!0;break}}else e=!0;if(e)throw new s.Qp("Error when checking model ".concat(a," expected no data, ")+"but got ".concat(t))}return[]}if(null==t)return e.map((t=>null));if(C(t)){r=[];for(const n of e){if(null==t[n])throw new s.Qp('No data provided for "'.concat(n,'". Need data for each key in: ')+"".concat(e));r.push(t[n])}}else if(A(t)){if(t.length!==e.length)throw new s.Qp("Error when checking model ".concat(a,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(e.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(t));r=t}else{if(e.length>1)throw new s.Qp("The model ".concat(a," expects ").concat(e.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(t.shape));r=[t]}if(r=(0,k.n4)(r),null!=n)for(let o=0;o<e.length;++o){if(null==n[o])continue;const t=r[o];if(t.shape.length!==n[o].length)throw new s.Qp("Error when checking ".concat(a,": expected ").concat(e[o]," ")+"to have ".concat(n[o].length," dimension(s). but got array with ")+"shape ".concat(t.shape));for(let e=0;e<n[o].length;++e){if(0===e&&!i)continue;const r=t.shape[e],c=n[o][e];if(null!=c&&c>=0&&r!==c)throw new s.Qp("".concat(a," expected a batch of elements where each ")+"example has shape [".concat(n[o].slice(1,n[o].length),"] ")+"(i.e.,tensor shape [*,".concat(n[o].slice(1,n[o].length),"])")+" but the ".concat(a," received an input with ").concat(t.shape[0])+" examples, each with shape [".concat(t.shape.slice(1,t.shape.length),"]")+" (tensor shape [".concat(t.shape,"])"))}}return r}function E(t,e,n){let r,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(t)){if(t.length!==e.length)throw new s.Qp("Error when checking model ".concat(a,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(e.length," Tensor(s),")+" but instead got ".concat(t.length," Tensors(s)."));r=t}else{if(e.length>1)throw new s.Qp("The model expects ".concat(e.length," ").concat(a," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(t.shape),"."));r=[t]}if(null!=n)for(let o=0;o<e.length;++o){if(null==n[o])continue;const t=r[o];if(t.shape.length!==n[o].length)throw new s.Qp("Error when checking ".concat(a,": expected ").concat(e[o]," ")+"to have ".concat(n[o].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(t.shape)));for(let r=0;r<n[o].length;++r){if(0===r&&!i)continue;const c=t.shape[r],u=n[o][r];if(null!=u&&u!==c)throw new s.Qp("Error when checking ".concat(a,": expected ")+"".concat(e[o]," to have shape ").concat(JSON.stringify(n[o])," but ")+"got array with shape ".concat(JSON.stringify(t.shape),"."))}}}class T extends b.m{constructor(t){super(t),this.isTraining=!1}summary(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new s.Qp("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");(0,g.o)(this,t,e,n)}compile(t){if(null==t.loss&&(t.loss=[]),this.loss=t.loss,"string"===typeof t.optimizer)this.optimizer_=d.K(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof r.Optimizer))throw new s.Qp("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let e=[];if(Array.isArray(t.loss)||"string"===typeof t.loss||"function"===typeof t.loss)if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new s.Qp("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(t.loss,"."));const n=t.loss;e=n.map((t=>l.Jt(t)))}else{const n=l.Jt(t.loss);this.outputs.forEach((t=>{e.push(n)}))}else{t.loss=t.loss;for(const e in t.loss)if(-1===this.outputNames.indexOf(e))throw new s.Qp('Unknown entry in loss dictionary: "'.concat(e,'". ')+"Only expected the following keys: ".concat(this.outputNames));for(const n of this.outputNames)null==t.loss[n]&&console.warn('Output "'.concat(n,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(n," during training")),e.push(l.Jt(t.loss[n]))}this.lossFunctions=e,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let r=0;r<this.outputs.length;++r){const t=this.internalOutputShapes[r],e=this.outputNames[r];this.feedOutputNames.push(e),this.feedOutputShapes.push(t),this.feedLossFns.push(this.lossFunctions[r])}const n=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],(0,o.IU)("loss",(()=>{for(let t=0;t<this.outputs.length;++t){if(-1!==n.indexOf(t))continue;const e=this.lossFunctions[t];this.outputs.length>1&&(this.metricsTensors.push([e,t]),this.metricsNames.push(this.outputNames[t]+"_loss"))}}));const i=function(t,e){if(null==t||Array.isArray(t)&&0===t.length)return e.map((t=>[]));let n;if("string"===typeof t||"function"===typeof t)n=[t];else{if(!Array.isArray(t)&&"object"!==typeof t)throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(t));n=t}if(Array.isArray(n))return e.map((t=>n));{const t=[];for(const r of e){let e=n.hasOwnProperty(r)?n[r]:[];Array.isArray(e)||(e=[e]),t.push(e)}return t}}(t.metrics,this.outputNames),a=(t,e,n)=>{this.outputNames.length>1&&(e=this.outputNames[t]+"_"+e),this.metricsNames.push(e),this.metricsTensors.push([n,t])};(0,o.IU)("metric",(()=>{for(let t=0;t<this.outputs.length;++t){if(-1!==n.indexOf(t))continue;(e=>{let n,r,i;for(const s of e){if("string"===typeof s&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(s)){const e=this.internalOutputShapes[t];let a;1===e[e.length-1]||this.lossFunctions[t]===l.Jc?-1!==["accuracy","acc"].indexOf(s)?r=h.xM:-1!==["crossentropy","ce"].indexOf(s)&&(r=h.Jc):this.lossFunctions[t]===l.qp?-1!==["accuracy","acc"].indexOf(s)?r=h.qv:-1!==["crossentropy","ce"].indexOf(s)&&(r=h.qp):-1!==["accuracy","acc"].indexOf(s)?r=h.yP:-1!==["crossentropy","ce"].indexOf(s)&&(r=h.Ol),-1!==["accuracy","acc"].indexOf(s)?a="acc":-1!==["crossentropy","ce"].indexOf(s)&&(a="ce"),i=r,n=""+a}else{const t=h.Jt(s);i=t,n=""+h.GT(s)}let e;(0,o.IU)(n,(()=>{e=i})),a(t,n,e)}})(i[t])}})),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=null==n.batchSize?32:n.batchSize;(0,k.yy)(r);const i=this.standardizeUserDataXY(t,e,!0,r);try{const t=i[0].concat(i[1]);this.makeTestFunction();const e=this.testFunction,a=this.testLoop(e,t,r,n.verbose,n.steps);return(0,p.wL)(a)}finally{(0,k.Ec)(i[0],t),(0,k.Ec)(i[1],e)}}async evaluateDataset(t,e){return this.makeTestFunction(),(0,w.c)(this,t,e)}checkNumSamples(t,e,n){let r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(r=null,null!=e)throw new s.Qp("If ".concat(i," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(e))}else{if(null==t)throw new s.Qp("Either the input data should have a defined shape, or "+"".concat(i," shoud be specified."));r=Array.isArray(t)?t[0].shape[0]:t.shape[0]}return r}execute(t,e){if(Array.isArray(e)&&0===e.length)throw new s.Qp("`outputs` is an empty Array, which is not allowed.");const n=Array.isArray(e),i=n?e:[e],a=this.retrieveSymbolicTensors(i),o=new x.RW;if(t instanceof r.Tensor&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new s.Qp("The number of inputs provided (".concat(t.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(let e=0;e<this.inputs.length;++e)o.add(this.inputs[e],t[e])}else for(const r of this.inputs){const e=t[r.name];if(null==e)throw new s.Qp("No value is provided for the model's input ".concat(r.name));o.add(r,e)}const c=(0,x.g7)(a,o);return n?c:c[0]}retrieveSymbolicTensors(t){const e=(0,p.fD)(null,t.length);let n=t.length;for(const r of this.layers){const i=Array.isArray(r.output)?r.output:[r.output],a=i.map((t=>t.name));for(let r=0;r<t.length;++r){const o=a.indexOf(t[r]);if(-1!==o&&(e[r]=i[o],n--),0===n)break}if(0===n)break}if(n>0){const n=[];throw e.forEach(((e,r)=>{null==e&&n.push(t[r])})),new s.Qp("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(n)))}return e}predictLoop(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return r.tidy((()=>{const i=this.checkNumSamples(t);if(n)throw new s.EH("Verbose predictLoop() is not implemented yet.");const a=(0,k.XX)(i,e),o=this.outputs.map((t=>[]));for(let e=0;e<a.length;++e){r.tidy((()=>{const n=a[e][0],r=a[e][1],i=(0,k.Pe)(t,n,r),o=[];if(Array.isArray(i))for(let t=0;t<i.length;++t)o.push({key:this.inputs[t],value:i[t]});else o.push({key:this.inputs[0],value:i});const s=new x.RW(o);return(0,x.g7)(this.outputs,s)})).forEach(((t,e)=>o[e].push(t)))}return(0,p.wL)(o.map((t=>r.concat(t,0))))}))}predict(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=(0,k.n4)(t);E(n,this.inputNames,this.feedInputShapes,!1);try{const t=null==e.batchSize?32:e.batchSize;return(0,k.yy)(t),this.predictLoop(n,t)}finally{(0,k.Ec)(n,t)}}predictOnBatch(t){E(t,this.inputNames,this.feedInputShapes,!0);const e=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,e)}standardizeUserDataXY(t,e){let n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new s.bu("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let r=0;r<this.feedOutputShapes.length;++r){const t=this.feedOutputShapes[r];this.feedLossFns[r]===l.qp?i.push(t.slice(0,t.length-1).concat([1])):i.push(t)}if(function(t,e,n){const i=(0,p.Am)(t.map((t=>t.shape[0])));i.sort();const a=(0,p.Am)(e.map((t=>t.shape[0])));if(a.sort(),i.length>1)throw new s.Qp("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(t.map((t=>t.shape)))));if(a.length>1)throw new s.Qp("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map((t=>t.shape)))));if(i.length>0&&a.length>0&&!r.util.arraysEqual(i,a))throw new s.Qp("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(i[0]," input sample(s) and ").concat(a[0]," target ")+"sample(s).")}(t=S(t,this.feedInputNames,this.feedInputShapes,!1,"input"),e=S(e,this.feedOutputNames,i,!1,"target")),function(t,e,n){const r=[l.bt,l.Jc,l.Ol];for(let i=0;i<t.length;++i){const a=t[i],o=e[i],c=n[i];if(null!=o){if(o===l.Ol&&1===a.shape[a.shape.length-1])throw new s.Qp("You are passing a target array of shape ".concat(a.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(o)){const t=a.shape.slice(1),e=c.slice(1);for(let n=0;n<t.length;++n){const r=t[n],i=e[n];if(null!=i&&r!==i)throw new s.Qp("A target Tensor with shape ".concat(a.shape," was passed for an ")+"output of shape ".concat(c,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}}(e,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&t[0].shape[0]%n!==0)throw new s.Qp("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(n,". Found: ").concat(t[0].shape[0]," sample(s)."));return[t,e]}async standardizeUserData(t,e,n,r){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5?arguments[5]:void 0;const[o,s]=this.standardizeUserDataXY(t,e,i,a);if(null!=n)throw new Error("sample weight is not supported yet.");let c=null;if(null!=r){const t=(0,_.zO)(r,this.outputNames);c=[];for(let e=0;e<t.length;++e)c.push(await(0,_.tP)(s[e],null,t[e]))}return[o,s,c]}testLoop(t,e,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4?arguments[4]:void 0;return r.tidy((()=>{const c=this.checkNumSamples(e,n,o,"steps"),u=[];if(a>0)throw new s.EH("Verbose mode is not implemented yet.");if(null!=o)throw new s.EH("steps mode in testLoop() is not implemented yet");{const a=(0,k.XX)(c,n),o=(0,r.tensor1d)((0,m.y1)(0,c));for(let n=0;n<a.length;++n){const s=a[n][0],c=a[n][1],l=i.Dh(o,s,c-s),h=(0,k.DE)(e,l),d=t(h);if(0===n)for(let t=0;t<d.length;++t)u.push((0,r.scalar)(0));for(let t=0;t<d.length;++t){const e=d[t];u[t]=r.add(u[t],r.mul(c-s,e))}}for(let t=0;t<u.length;++t)u[t]=r.div(u[t],c)}return u}))}getDedupedMetricsNames(){const t=this.metricsNames,e=[];for(let n=0;n<t.length;++n){const r=t[n];let i=r;if((0,p.U9)(t,r)>1){const e=(0,p.U9)(t.slice(0,n),r);i+="_".concat(e)}e.push(i)}return e}makeTrainFunction(){return t=>{const e=[],n=t.slice(0,this.inputs.length),i=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),o=[],s=this.collectedTrainableWeights.map((t=>t.read()));return[this.optimizer_.minimize((()=>{const t=[];for(let e=0;e<this.inputs.length;++e)t.push({key:this.inputs[e],value:n[e]});const s=new x.RW(t),c=(0,x.g7)(this.outputs,s,{training:!0});let u;for(let n=0;n<this.lossFunctions.length;++n){let t=(0,this.lossFunctions[n])(i[n],c[n]);null!=a[n]&&(t=(0,_.M5)(t,a[n]));const o=r.mean(t);e.push(o),u=0===n?t:r.add(u,t)}for(let n=0;n<this.metricsTensors.length;++n){let t;if(this.outputs.length>1&&n<this.outputs.length)t=e[n];else{const e=this.metricsTensors[n][0],a=this.metricsTensors[n][1];t=r.mean(e(i[a],c[a]))}r.keep(t),o.push(t)}return u=r.mean(u),this.calculateLosses().forEach((t=>{u=r.add(u,t)})),u}),!0,s)].concat(o)}}makeTestFunction(){this.testFunction=t=>r.tidy((()=>{const e=[];let n;const i=t.slice(0,this.inputs.length),a=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let t=0;t<this.inputs.length;++t)o.push({key:this.inputs[t],value:i[t]});const s=new x.RW(o),c=(0,x.g7)(this.outputs,s);for(let t=0;t<this.lossFunctions.length;++t){const i=this.lossFunctions[t],o=r.mean(i(a[t],c[t]));n=0===t?o:r.add(n,o),e.push(n)}for(let t=0;t<this.metricsTensors.length;++t){const n=this.metricsTensors[t][0],i=this.metricsTensors[t][1],o=r.mean(n(a[i],c[i]));e.push(o)}return e}))}async fit(t,e){let n,i,o,c,u,l,h,d,f,p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;try{const r=null==p.batchSize?32:p.batchSize;(0,k.yy)(r);const g=!1,m=await this.standardizeUserData(t,e,p.sampleWeight,p.classWeight,g,r);n=m[0],i=m[1],f=m[2];let v,y=!1;if(null!=p.validationData&&p.validationData.length>0){if(y=!0,2!==p.validationData.length)throw 3===p.validationData.length?new s.EH("validationData including sample weights is not supported yet."):new s.Qp("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(p.validationData," is invalid."));u=p.validationData[0],l=p.validationData[1];const t=!0,e=await this.standardizeUserData(u,l,null,null,t,r);h=e[0],d=e[1],v=h.concat(d)}else if(null!=p.validationSplit&&p.validationSplit>0&&p.validationSplit<1){y=!0;const t=Math.floor(n[0].shape[0]*(1-p.validationSplit)),e=n[0].shape[0];h=(0,k.Pe)(n,t,e),o=n,n=(0,k.Pe)(n,0,t),d=(0,k.Pe)(i,t,e),c=i,i=(0,k.Pe)(i,0,t),v=h.concat(d)}else null!=p.validationSteps&&(y=!0);const b=n.concat(i).concat(f);this.checkTrainableWeightsConsistency();const x=this.makeTrainFunction(),w=this.getDedupedMetricsNames();let _,A;y?(this.makeTestFunction(),_=this.testFunction,A=w.slice().concat(w.map((t=>"val_"+t)))):(_=null,v=[],A=w.slice());const C=(0,a.Eq)(p.callbacks,p.yieldEvery);return await this.fitLoop(x,b,w,r,p.epochs,p.verbose,C,_,v,p.shuffle,A,p.initialEpoch,null,null)}finally{this.isTraining=!1,(0,k.Ec)(n,t),(0,k.Ec)(i,e),(0,k.Ec)(o,t),(0,k.Ec)(c,e),(0,k.Ec)(h,u),(0,k.Ec)(d,l),null!=f&&r.dispose(f)}}async fitLoop(t,e,n,o,c,l,h,d,f,p,g,v,y,b){null==o&&(o=32),null==c&&(c=1),null==p&&(p=!0),null==v&&(v=0);let x=!1;if(null!=d&&null!=f&&(x=!0),null!=b&&(x=!0,null==y))throw new s.Qp("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const w=this.checkNumSamples(e,o,y,"steps_per_epoch");let _;null!=w&&(_=(0,m.y1)(0,w)),null==l&&(l=1);const{callbackList:A,history:C}=(0,a.dY)(h,l,c,v,w,y,o,x,g);A.setModel(this),this.history=C,await A.onTrainBegin(),this.stopTraining_=!1;for(let a=v;a<c;++a){await A.onEpochBegin(a);const c={};if(null!=y)throw new s.EH("stepsPerEpoch mode is not implemented yet.");{if("batch"===p)throw new s.EH("batch shuffling is not implemneted yet");p&&r.util.shuffle(_);const a=(0,r.tensor1d)(_),l=(0,k.XX)(w,o);for(let s=0;s<l.length;++s){const h={};if(await A.onBatchBegin(s,h),r.tidy((()=>{const u=l[s][0],p=l[s][1],g=i.Dh(a,u,p-u);h.batch=s,h.size=p-u;const m=(0,k.DE)(e,g),v=t(m);for(let t=0;t<n.length;++t){const e=n[t],i=v[t];h[e]=i,r.keep(i)}if(s===l.length-1&&x){const t=this.testLoop(d,f,o);for(let e=0;e<n.length;++e){const i=n[e],a=t[e];r.keep(a),c["val_"+i]=a}}})),await A.onBatchEnd(s,h),(0,u.i)(h),this.stopTraining_)break}a.dispose()}if(await A.onEpochEnd(a,c),this.stopTraining_)break}return await A.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(t,e){return(0,w.O)(this,t,e)}async trainOnBatch(t,e){const n=await this.standardizeUserData(t,e),i=n[0],a=n[1],o=this.makeTrainFunction()(i.concat(a)),s=[];for(const r of o){const t=await r.data();s.push(t[0])}return r.dispose(o),(0,k.Ec)(n[0],t),(0,k.Ec)(n[1],e),(0,p.wL)(s)}getNamedWeights(t){const e=[],n=null!=t&&t.trainableOnly,r=n?this.trainableWeights:this.weights,i=this.getWeights(n);for(let a=0;a<r.length;++a)n&&!r[a].trainable||e.push({name:r[a].originalName,tensor:i[a]});return e}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(0===t.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){const e=r.memory().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=e-r.memory().numTensors}return t}getLossIdentifiers(){let t;if("string"===typeof this.loss)t=(0,p.uc)(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if("string"!==typeof t)throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map((t=>(0,p.uc)(t)))}else{const e=Object.keys(this.loss);t={};const n=this.loss;for(const r of e){if("string"!==typeof n[r])throw new Error("Serialization of non-string loss is not supported.");t[r]=(0,p.uc)(n[r])}}return t}getMetricIdentifiers(){if("string"===typeof this.metrics||"function"===typeof this.metrics)return[(0,p.uc)(h.GT(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((t=>(0,p.uc)(h.GT(t))));{const t={};for(const e in this.metrics)t[e]=(0,p.uc)(h.GT(this.metrics[e]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(null!=t.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=t.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=t.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");const e=(0,v.w)(t.optimizer_config),n=(0,c.i)(e);let r,i;if("string"===typeof t.loss)r=(0,p.Cb)(t.loss);else if(Array.isArray(t.loss))r=t.loss.map((t=>(0,p.Cb)(t)));else if(null!=t.loss){r={};for(const e in t.loss)r[e]=(0,p.Cb)(t.loss[e])}if(Array.isArray(t.metrics))i=t.metrics.map((t=>(0,p.Cb)(t)));else if(null!=t.metrics){i={};for(const e in t.metrics)i[e]=(0,p.Cb)(t.metrics[e])}this.compile({loss:r,metrics:i,optimizer:n})}async save(t,e){if("string"===typeof t){const e=r.io.getSaveHandlers(t);if(0===e.length)throw new s.Qp("Cannot find any save handlers for URL '".concat(t,"'"));if(e.length>1)throw new s.Qp("Found more than one (".concat(e.length,") save handlers for ")+"URL '".concat(t,"'"));t=e[0]}if(null==t.save)throw new s.Qp("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const n=await r.io.encodeWeights(this.getNamedWeights(e)),i={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v".concat(y.r),convertedBy:null};if(null!=e&&e.includeOptimizer&&null!=this.optimizer){i.trainingConfig=this.getTrainingConfig();const t="optimizer",{data:e,specs:a}=await r.io.encodeWeights(await this.optimizer.getWeights(),t);n.specs.push(...a),n.data=r.io.concatenateArrayBuffers([n.data,e])}if(null!=this.userDefinedMetadata){const t=!0;(0,f.Yl)(this.userDefinedMetadata,this.name,t),i.userDefinedMetadata=this.userDefinedMetadata}return i.weightData=n.data,i.weightSpecs=n.specs,t.save(i)}setUserDefinedMetadata(t){(0,f.Yl)(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}T.className="Model",r.serialization.registerClass(T);class N extends T{}N.className="Functional",r.serialization.registerClass(N)},95100:(t,e,n)=>{"use strict";n.d(e,{O:()=>d,c:()=>p});var r=n(37837),i=n(29934),a=n(5351),o=n(38759),s=n(50531),c=n(9309);const u=32;function l(t,e){let n,i;const a=e;n=a.xs,i=a.ys,r.util.assert(null!=n&&null!=i,(()=>"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(e)));const o=h("input",t.inputNames,n),s=h("output",t.outputNames,i),c=o[0].shape[0];r.util.assert(o.length===t.inputs.length,(()=>"LayersModel has ".concat(t.inputs.length," inputs, but the dataset ")+"provides ".concat(o.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(t.inputNames),")"))),r.util.assert(s.length===t.outputs.length,(()=>"LayersModel has ".concat(t.outputs.length," outputs, but the dataset ")+"provides ".concat(s.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(t.outputNames),")")));for(let u=0;u<o.length;u++)r.util.assert(o[u].shape[0]===c,(()=>"Batch size mismatch: input "+"".concat(t.inputNames[u]," has ").concat(o[u].shape[0],"; ")+"expected  ".concat(c," based on input ").concat(t.inputNames[0],".")));for(let u=0;u<s.length;u++)r.util.assert(s[u].shape[0]===c,(()=>"Batch size mismatch: output "+"".concat(t.outputNames[u]," has ").concat(s[u].shape[0],"; ")+"expected  ".concat(c," based on input ").concat(t.inputNames[0],".")));return{xs:o,ys:s}}function h(t,e,n){if(n instanceof r.Tensor)return[n];if(Array.isArray(n))return r.util.assert(n.length===e.length,(()=>"Received an array of ".concat(n.length," Tensors, but expected ").concat(e.length," to match the ").concat(t," keys ").concat(e,"."))),n;{const r=[];for(const i of e){if(null==n[i])throw new a.Qp("The feature data generated by the dataset lacks the required "+"".concat(t," key '").concat(i,"'."));r.push(n[i])}return r}}async function d(t,e,n){const h=null!=n.batchesPerEpoch;if(r.util.assert(null!=t.optimizer,(()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig).")),r.util.assert(null!=n,(()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call.")),r.util.assert(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),(()=>"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(n.epochs))),r.util.assert(!h||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),(()=>"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(n.batchesPerEpoch))),r.util.assert(null==n.validationSplit,(()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead.")),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const d=null!=n.validationData;let p,g;if(d)if(f(n.validationData))r.util.assert(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),(()=>"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(n.validationBatches)));else{const t=function(t){if(3===t.length)throw new a.EH("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}(n.validationData);p=t.xs,g=t.ys}const m=t.makeTrainFunction(),v=t.getDedupedMetricsNames();let y;y=d?v.slice().concat(v.map((t=>"val_"+t))):v.slice();const b=(0,i.Eq)(n.callbacks,n.yieldEvery),x=null==n.verbose?1:n.verbose,{callbackList:w,history:k}=(0,i.dY)(b,x,n.epochs,null,null,function(t,e){let n=null;null!=e.batchesPerEpoch?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size);return n}(e,n),null,d,y);w.setModel(t),t.history=k,await w.onTrainBegin(),t.stopTraining_=!1;let _=null==n.initialEpoch?0:n.initialEpoch,A=await e.iterator();for(;_<n.epochs;){const i={};await w.onEpochBegin(_);let a=0,y=0;for(h||(A=await e.iterator());!h||a<n.batchesPerEpoch;){const e=await A.next();if(h&&e.done){console.warn("You provided `batchesPerEpoch` as "+"".concat(n.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(a," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(n.batchesPerEpoch*n.epochs," batches). ")+"You may need to use the repeat() function when building your dataset.");break}if(null!=e.value){const{xs:i,ys:s}=l(t,e.value),u={};u.batch=y,u.size=i[0].shape[0],await w.onBatchBegin(y,u);const h=[];if(null!=n.classWeight){const e=(0,c.zO)(n.classWeight,t.outputNames);for(let t=0;t<e.length;++t)h.push(await(0,c.tP)(s[t],null,e[t]))}const d=i.concat(s).concat(h),f=m(d);r.dispose(d);for(let t=0;t<v.length;++t){const e=v[t],n=f[t];u[e]=n,r.keep(n)}await w.onBatchEnd(y,u),(0,o.i)(u),y++,a++}if(h?a>=n.batchesPerEpoch:e.done){if(d){let e;e=f(n.validationData)?(0,s.st)(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):(0,s.st)(t.evaluate(p,g,{batchSize:null==n.validationBatchSize?u:n.validationBatchSize,verbose:0}));for(let n=0;n<t.metricsNames.length;++n)i["val_".concat(t.metricsNames[n])]=e[n]}break}if(t.stopTraining_)break}if(await w.onEpochEnd(_,i),_++,t.stopTraining_)break}return await w.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function f(t){return"function"===typeof t.iterator}async function p(t,e,n){const i=null!=(n=n||{}).batches,o=t.testFunction;let c=[];if(n.verbose>0)throw new a.EH("Verbose mode is not implemented yet.");r.util.assert(!i||n.batches>0&&Number.isInteger(n.batches),(()=>"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(n.batches))));const u="function"===typeof e.next?e:await e.iterator();let h=0,d=0;for(;!i||d<n.batches;){const e=await u.next();if(c=r.tidy((()=>{if(e.value){const{xs:n,ys:i}=l(t,e.value),a=n.concat(i),s=r.tidy((()=>o(a)));if(r.dispose(a),0===d)for(let t=0;t<s.length;++t)c.push((0,r.scalar)(0));const u=a[0].shape[0];for(let t=0;t<s.length;++t){const e=s[t],n=c[t];c[t]=r.tidy((()=>r.add(c[t],r.mul(u,e)))),d>0&&r.dispose(n)}r.dispose(s),h+=u,++d}return c})),e.done){i&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(n.batches," batches). ")+"You may need to use the repeat() function when building your dataset.");break}}for(let a=0;a<c.length;++a){const t=c[a];c[a]=r.div(c[a],h),r.dispose(t)}return(0,s.wL)(c)}},58426:(t,e,n)=>{"use strict";n.d(e,{DE:()=>s,Ec:()=>l,Pe:()=>o,XX:()=>c,n4:()=>u,yy:()=>a});var r=n(37837),i=n(36043);function a(t){r.util.assert(t>0&&Number.isInteger(t),(()=>"batchSize is required to be a positive integer, but got ".concat(t)))}function o(t,e,n){return null==t?[null]:Array.isArray(t)?t.map((t=>(0,i.Dh)(t,e,n-e))):(0,i.Dh)(t,e,n-e)}function s(t,e){return r.tidy((()=>null==t?null:Array.isArray(t)?t.map((t=>s(t,e))):(0,i.kg)(t,"int32"===e.dtype?e:r.cast(e,"int32"))))}function c(t,e){const n=[];let r=0,i=null;for(;r<t;)i=r+e,i>=t&&(i=t),n.push([r,i]),r=i;return n}function u(t){const e=[];t instanceof r.Tensor&&(t=[t]);for(let n=0;n<t.length;++n){const r=t[n];if(1===r.rank)e.push((0,i.UG)(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function l(t,e){if(null==t)return;const n=[];if(e instanceof r.Tensor)n.push(e.id);else if(Array.isArray(e))e.forEach((t=>n.push(t.id)));else if(null!=e)for(const r in e){const t=e[r];n.push(t.id)}const i=[];if(t instanceof r.Tensor)-1===n.indexOf(t.id)&&i.push(t);else if(Array.isArray(t))t.forEach((t=>{-1===n.indexOf(t.id)&&i.push(t)}));else if(null!=t)for(const r in t){const e=t[r];-1===n.indexOf(e.id)&&i.push(e)}i.forEach((t=>{t.isDisposed||t.dispose()}))}},9309:(t,e,n)=>{"use strict";n.d(e,{M5:()=>s,tP:()=>o,zO:()=>a});var r=n(37837);function i(t,e,n){const r=e.length;if(null==t||Array.isArray(t)&&0===t.length)return e.map((t=>null));if(1===r)return Array.isArray(t)&&1===t.length?t:"object"===typeof t&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error("Provided ".concat(n," is an array of ").concat(t.length," ")+"element(s), but the model has ".concat(r," outputs. ")+"Make sure a set of weights is provided for each model output.");return t}if("object"===typeof t&&Object.keys(t).length>0&&"object"===typeof t[Object.keys(t)[0]]){const n=[];return e.forEach((e=>{e in t?n.push(t[e]):n.push(null)})),n}throw new Error("The model has multiple (".concat(r,") outputs, ")+"so ".concat(n," must be either an array with ")+"".concat(r," elements or an object with ").concat(e," keys. ")+"Provided ".concat(n," not understood: ").concat(JSON.stringify(t)))}function a(t,e){return i(t,e,"classWeight")}async function o(t,e,n,i){if(null!=e||null!=i)throw new Error("Support sampleWeight is not implemented yet");if(null!=n){const e=(0,r.tidy)((()=>{if(1===t.shape.length)return(0,r.clone)(t);if(2===t.shape.length){if(t.shape[1]>1){const e=1;return(0,r.argMax)(t,e)}if(1===t.shape[1])return(0,r.reshape)(t,[t.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(t.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor (".concat(t.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")})),i=Array.from(await e.data());(0,r.dispose)(e);const a=[];return i.forEach((t=>{if(null==n[t])throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(t," exists in the data but not in ")+"classWeight");a.push(n[t])})),(0,r.tensor1d)(a,"float32")}return null}function s(t,e){return(0,r.mul)(t,e)}},5351:(t,e,n)=>{"use strict";n.d(e,{EH:()=>o,Qp:()=>a,bu:()=>i,l7:()=>r,pf:()=>s});class r extends Error{constructor(t){super(t),Object.setPrototypeOf(this,r.prototype)}}class i extends Error{constructor(t){super(t),Object.setPrototypeOf(this,i.prototype)}}class a extends Error{constructor(t){super(t),Object.setPrototypeOf(this,a.prototype)}}class o extends Error{constructor(t){super(t),Object.setPrototypeOf(this,o.prototype)}}class s extends Error{constructor(t){super(t),Object.setPrototypeOf(this,s.prototype)}}Error},46377:(t,e,n)=>{"use strict";n.d(e,{O0:()=>a.O0,ge:()=>o,hF:()=>c,il:()=>s});n(29934);var r=n(12335),i=n(31483),a=n(31722);function o(t){return new i.Gw(t)}function s(t){return new a.Gx(t)}function c(t){return(0,r.p)(t)}},6194:(t,e,n)=>{"use strict";n(5874)},93905:(t,e,n)=>{"use strict";n(56817)},80190:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Layer:()=>i.Wd,RNN:()=>v.VS,RNNCell:()=>v.vR,activation:()=>j,add:()=>K,alphaDropout:()=>Pt,average:()=>Q,averagePooling1d:()=>at,averagePooling2d:()=>ct,averagePooling3d:()=>ht,avgPool1d:()=>ot,avgPool2d:()=>ut,avgPool3d:()=>dt,avgPooling1d:()=>st,avgPooling2d:()=>lt,avgPooling3d:()=>ft,batchNormalization:()=>nt,bidirectional:()=>Dt,categoryEncoding:()=>qt,centerCrop:()=>Wt,concatenate:()=>Z,conv1d:()=>D,conv2d:()=>I,conv2dTranspose:()=>M,conv3d:()=>O,conv3dTranspose:()=>R,convLstm2d:()=>Et,convLstm2dCell:()=>Tt,cropping2D:()=>B,dense:()=>U,depthwiseConv2d:()=>P,dot:()=>et,dropout:()=>W,elu:()=>C,embedding:()=>X,flatten:()=>q,gaussianDropout:()=>Lt,gaussianNoise:()=>Bt,globalAveragePooling1d:()=>pt,globalAveragePooling2d:()=>gt,globalMaxPool1d:()=>Mt,globalMaxPool2d:()=>Ot,globalMaxPooling1d:()=>mt,globalMaxPooling2d:()=>vt,gru:()=>wt,gruCell:()=>kt,input:()=>a.hF,inputLayer:()=>A,layerNormalization:()=>rt,leakyReLU:()=>E,lstm:()=>_t,lstmCell:()=>At,masking:()=>jt,maxPool1d:()=>Rt,maxPool2d:()=>zt,maxPooling1d:()=>yt,maxPooling2d:()=>bt,maxPooling3d:()=>xt,maximum:()=>$,minimum:()=>J,multiply:()=>tt,permute:()=>Y,prelu:()=>T,randomWidth:()=>Gt,reLU:()=>S,repeatVector:()=>G,rescaling:()=>Ut,reshape:()=>H,resizing:()=>Vt,rnn:()=>Nt,separableConv2d:()=>z,simpleRNN:()=>Ct,simpleRNNCell:()=>St,softmax:()=>N,spatialDropout1d:()=>V,stackedRNNCells:()=>Ft,thresholdedReLU:()=>F,timeDistributed:()=>It,upSampling2d:()=>L,zeroPadding2d:()=>it});var r=n(12335),i=n(51544),a=n(46377),o=n(42265),s=n(91566),c=n(73740),u=n(59771),l=n(10818),h=n(21287),d=n(70873),f=n(36543),p=n(10288),g=n(13884),m=n(50771),v=n(58715),y=n(67329),b=n(20316),x=n(97724),w=n(81916),k=n(28859),_=n(22862);function A(t){return new r.m(t)}function C(t){return new o.X0(t)}function S(t){return new o.b0(t)}function E(t){return new o.P(t)}function T(t){return new o.vD(t)}function N(t){return new o.rF(t)}function F(t){return new o.NH(t)}function D(t){return new s.so(t)}function I(t){return new s.p2(t)}function M(t){return new s.M5(t)}function O(t){return new s.A1(t)}function R(t){return new s.V5(t)}function z(t){return new s.k1(t)}function B(t){return new s.tw(t)}function L(t){return new s.Ds(t)}function P(t){return new c.g(t)}function j(t){return new l.xq(t)}function U(t){return new l.Yv(t)}function W(t){return new l.C2(t)}function V(t){return new l.XO(t)}function q(t){return new l.FA(t)}function G(t){return new l.JW(t)}function H(t){return new l.R2(t)}function Y(t){return new l.tg(t)}function X(t){return new h.s(t)}function K(t){return new d.OM(t)}function Q(t){return new d.Yb(t)}function Z(t){return new d.Sb(t)}function $(t){return new d.LD(t)}function J(t){return new d.LG(t)}function tt(t){return new d.xu(t)}function et(t){return new d.cL(t)}function nt(t){return new p.Ez(t)}function rt(t){return new p.RX(t)}function it(t){return new g.Ol(t)}function at(t){return new m.TG(t)}function ot(t){return at(t)}function st(t){return at(t)}function ct(t){return new m.kd(t)}function ut(t){return ct(t)}function lt(t){return ct(t)}function ht(t){return new m.$t(t)}function dt(t){return ht(t)}function ft(t){return ht(t)}function pt(t){return new m._M(t)}function gt(t){return new m.XC(t)}function mt(t){return new m.JJ(t)}function vt(t){return new m.OA(t)}function yt(t){return new m.Gk(t)}function bt(t){return new m.nO(t)}function xt(t){return new m.Mg(t)}function wt(t){return new v.T_(t)}function kt(t){return new v.pz(t)}function _t(t){return new v.FB(t)}function At(t){return new v.Tu(t)}function Ct(t){return new v.B7(t)}function St(t){return new v.RL(t)}function Et(t){return new u.j(t)}function Tt(t){return new u.H(t)}function Nt(t){return new v.VS(t)}function Ft(t){return new v.JU(t)}function Dt(t){return new y.ai(t)}function It(t){return new y.V2(t)}const Mt=mt,Ot=vt,Rt=yt,zt=bt;function Bt(t){return new f.UB(t)}function Lt(t){return new f.nV(t)}function Pt(t){return new f.Qu(t)}function jt(t){return new l.L(t)}function Ut(t){return new b.p(t)}function Wt(t){return new x.u(t)}function Vt(t){return new k.a(t)}function qt(t){return new w.c(t)}function Gt(t){return new _.q(t)}},69099:(t,e,n)=>{"use strict";n(57463),n(98219)},80458:(t,e,n)=>{"use strict";n(31722)},10341:(t,e,n)=>{"use strict";n(16613)},87554:(t,e,n)=>{"use strict";var r=n(37837),i=n(81676);(0,r.env)().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",(()=>100),i.oR)},882:(t,e,n)=>{"use strict";n.d(e,{Gw:()=>i.Gw,O0:()=>a.O0,ZF:()=>r,ge:()=>a.ge,il:()=>a.il,u$:()=>o.r});n(87554),n(37837),n(49446),n(6194),n(93905);var r=n(80190),i=(n(69099),n(80458),n(10341),n(29934),n(65126),n(51544),n(31483)),a=n(46377),o=(n(58715),n(31722),n(1947),n(74022))},56817:(t,e,n)=>{"use strict";n.d(e,{Fe:()=>N,H4:()=>l,sN:()=>d,zo:()=>T});var r=n(37837),i=n(36043),a=n(32381),o=n(5351),s=n(33448),c=n(50531),u=n(11690);class l extends r.serialization.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class h extends l{apply(t,e){return(0,r.zeros)(t,e)}}h.className="Zeros",r.serialization.registerClass(h);class d extends l{apply(t,e){return(0,r.ones)(t,e)}}d.className="Ones",r.serialization.registerClass(d);class f extends l{constructor(t){if(super(),"object"!==typeof t)throw new o.Qp("Expected argument of type ConstantConfig but got ".concat(t));if(void 0===t.value)throw new o.Qp("config must have value set but got ".concat(t));this.value=t.value}apply(t,e){return(0,r.tidy)((()=>(0,r.mul)((0,r.scalar)(this.value),(0,r.ones)(t,e))))}getConfig(){return{value:this.value}}}f.className="Constant",r.serialization.registerClass(f);class p extends l{constructor(t){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,e){return(0,r.randomUniform)(t,this.minval,this.maxval,e,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}p.className="RandomUniform",r.serialization.registerClass(p);class g extends l{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new o.EH("randomNormal does not support dType ".concat(e,"."));return i.FE(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}g.className="RandomNormal",r.serialization.registerClass(g);class m extends l{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new o.EH("truncatedNormal does not support dType ".concat(e,"."));return(0,r.truncatedNormal)(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}m.className="TruncatedNormal",r.serialization.registerClass(m);class v extends l{constructor(t){super(),this.gain=null!=t.gain?t.gain:1}apply(t,e){return(0,r.tidy)((()=>{if(2!==t.length||t[0]!==t[1])throw new o.Qp("Identity matrix initializer can only be used for 2D square matrices.");return(0,r.mul)(this.gain,(0,r.eye)(t[0]))}))}getConfig(){return{gain:this.gain}}}v.className="Identity",r.serialization.registerClass(v);class y extends l{constructor(t){if(super(),t.scale<0)throw new o.Qp("scale must be a positive float. Got: ".concat(t.scale));var e;this.scale=null==t.scale?1:t.scale,this.mode=null==t.mode?"fanIn":t.mode,e=this.mode,(0,c.E6)(s.A,"FanMode",e),this.distribution=null==t.distribution?"normal":t.distribution,function(t){(0,c.E6)(s.Nt,"Distribution",t)}(this.distribution),this.seed=t.seed}apply(t,e){const n=function(t){let e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if((0,a.uM)(r),2===t.length)e=t[0],n=t[1];else if(-1!==[3,4,5].indexOf(t.length)){if("channelsFirst"===r){const r=(0,u.no)(t,2);e=t[1]*r,n=t[0]*r}else if("channelsLast"===r){const r=(0,u.no)(t,0,t.length-2);e=t[t.length-2]*r,n=t[t.length-1]*r}}else{const r=(0,u.no)(t);e=Math.sqrt(r),n=Math.sqrt(r)}return[e,n]}(t),i=n[0],s=n[1];let c=this.scale;if("fanIn"===this.mode?c/=Math.max(1,i):"fanOut"===this.mode?c/=Math.max(1,s):c/=Math.max(1,(i+s)/2),"normal"===this.distribution){const n=Math.sqrt(c);if("float32"!==(e=e||"float32")&&"int32"!==e)throw new o.EH("".concat(this.getClassName()," does not support dType ").concat(e,"."));return(0,r.truncatedNormal)(t,0,n,e,this.seed)}{const n=Math.sqrt(3*c);return(0,r.randomUniform)(t,-n,n,e,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}y.className="VarianceScaling",r.serialization.registerClass(y);class b extends y{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return y.className}}b.className="GlorotUniform",r.serialization.registerClass(b);class x extends y{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return y.className}}x.className="GlorotNormal",r.serialization.registerClass(x);class w extends y{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return y.className}}w.className="HeNormal",r.serialization.registerClass(w);class k extends y{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return y.className}}k.className="HeUniform",r.serialization.registerClass(k);class _ extends y{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return y.className}}_.className="LeCunNormal",r.serialization.registerClass(_);class A extends y{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return y.className}}A.className="LeCunUniform",r.serialization.registerClass(A);class C extends l{constructor(t){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=null==t.gain?this.DEFAULT_GAIN:t.gain,this.seed=t.seed}apply(t,e){return(0,r.tidy)((()=>{if(t.length<2)throw new o.EH("Shape must be at least 2D.");if("int32"!==e&&"float32"!==e&&void 0!==e)throw new TypeError("Unsupported data type ".concat(e,"."));const n=r.util.sizeFromShape(t.slice(0,-1)),a=t[t.length-1],s=n*a;s>this.ELEMENTS_WARN_SLOW&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than ".concat(this.ELEMENTS_WARN_SLOW," (").concat(s,") elements: ")+"Slowness may result.");const c=[Math.max(a,n),Math.min(a,n)],u=i.FE(c,0,1,e,this.seed),l=r.linalg.qr(u,!1);let h=l[0];const d=l[1].flatten().stridedSlice([0],[Math.min(a,n)*Math.min(a,n)],[Math.min(a,n)+1]);return h=(0,r.mul)(h,d.sign()),n<a&&(h=h.transpose()),(0,r.mul)((0,r.scalar)(this.gain),h.reshape(t))}))}getConfig(){return{gain:this.gain,seed:this.seed}}}C.className="Orthogonal",r.serialization.registerClass(C);const S={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function E(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,c.Xv)(t,r.serialization.SerializationMap.getMap().classNameMap,e,"initializer")}function T(t){return(0,c.k4)(t)}function N(t){if("string"===typeof t){const e=t in S?S[t]:t;if("GlorotNormal"===e)return new x;if("GlorotUniform"===e)return new b;if("HeNormal"===e)return new w;if("HeUniform"===e)return new k;if("LeCunNormal"===e)return new _;if("LeCunUniform"===e)return new A;{const t={};return t.className=e,t.config={},E(t)}}return t instanceof l?t:E(t)}},1002:(t,e,n)=>{"use strict";n.d(e,{EY:()=>a,To:()=>r,bb:()=>o,ft:()=>i,r$:()=>s});const r=["channelsFirst","channelsLast"],i=["nearest","bilinear"],a=["valid","same","causal"],o=["max","avg"],s=["sum","mul","concat","ave"]},33448:(t,e,n)=>{"use strict";n.d(e,{A:()=>r,Nt:()=>i});const r=["fanIn","fanOut","fanAvg"],i=["normal","uniform","truncatedNormal"]},42265:(t,e,n)=>{"use strict";n.d(e,{NH:()=>g,P:()=>d,X0:()=>p,b0:()=>h,rF:()=>m,vD:()=>f});var r=n(37837),i=n(97607),a=n(5874),o=n(51544),s=n(5351),c=n(56817),u=n(16613),l=n(62755);class h extends o.Wd{constructor(t){super(null==t?{}:t),this.supportsMasking=!0,null!=t&&(this.maxValue=t.maxValue)}call(t,e){t=(0,l.un)(t);let n=(0,r.relu)(t);return null!=this.maxValue&&(n=(0,r.clipByValue)(n,0,this.maxValue)),n}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},e=super.getConfig();return Object.assign(t,e),t}}h.className="ReLU",r.serialization.registerClass(h);class d extends o.Wd{constructor(t){super(null==t?{}:t),this.DEFAULT_ALPHA=.3,null==t&&(t={}),this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const n=(0,l.un)(t);return(0,r.leakyRelu)(n,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}d.className="LeakyReLU",r.serialization.registerClass(d);class f extends o.Wd{constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==t&&(t={}),this.supportsMasking=!0,this.alphaInitializer=(0,c.Fe)(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=(0,u.Bm)(t.alphaRegularizer),this.alphaConstraint=(0,a.YZ)(t.alphaConstraint),null==t.sharedAxes)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else{if("number"!==typeof t.sharedAxes)throw new s.Qp("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(t.sharedAxes));this.sharedAxes=[t.sharedAxes]}}build(t){const e=(t=(0,l.U$)(t)).slice(1);if(null!=this.sharedAxes)for(const r of this.sharedAxes)e[r-1]=1;this.alpha=this.addWeight("alpha",e,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const n={};if(null!=this.sharedAxes)for(let r=1;r<t.length;++r)n[r]=t[r];this.inputSpec=[new o.eO({ndim:t.length,axes:n})],this.built=!0}call(t,e){return t=(0,l.un)(t),(0,r.prelu)(t,this.alpha.read())}getConfig(){const t={alphaInitializer:(0,c.zo)(this.alphaInitializer),alphaRegularizer:(0,u.R9)(this.alphaRegularizer),alphaConstraint:(0,a.uH)(this.alphaConstraint),sharedAxes:this.sharedAxes},e=super.getConfig();return Object.assign(t,e),t}}f.className="PReLU",r.serialization.registerClass(f);class p extends o.Wd{constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA=1,null==t&&(t={}),null!=t.alpha&&t.alpha!==this.DEFAULT_ALPHA)throw new s.EH("Non-default alpha value (".concat(t.alpha,") is not supported by the ")+"ELU layer yet.");this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const n=(0,l.un)(t);return(0,r.elu)(n)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}p.className="ELU",r.serialization.registerClass(p);class g extends o.Wd{constructor(t){super(null==t?{}:t),this.DEFAULT_THETA=1,null==t&&(t={}),this.theta=null==t.theta?this.DEFAULT_THETA:t.theta}call(t,e){const n=(0,l.un)(t);return(0,r.mul)(n,(0,r.cast)((0,r.greater)(n,this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},e=super.getConfig();return Object.assign(t,e),t}}g.className="ThresholdedReLU",r.serialization.registerClass(g);class m extends o.Wd{constructor(t){super(null==t?{}:t),this.DEFAULT_AXIS=1,null==t&&(t={}),this.softmax=(new i.rF).apply,this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis}call(t,e){return(0,r.tidy)((()=>{let n=(0,l.un)(t);const i=e.mask;if(null!=i){const t=(0,r.mul)((0,r.sub)((0,r.ones)(n.shape),(0,r.cast)(i,n.dtype)),(0,r.scalar)(-1e9));n=(0,r.add)(n,t)}return this.axis instanceof Array?this.axis.length>1?(0,r.exp)((0,r.sub)(n,(0,r.logSumExp)(n,this.axis,!0))):this.softmax(n,this.axis[0]):this.softmax(n,this.axis)}))}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}m.className="Softmax",r.serialization.registerClass(m)},91566:(t,e,n)=>{"use strict";n.d(e,{A1:()=>A,Ds:()=>D,M5:()=>C,RK:()=>m,V5:()=>S,al:()=>v,k1:()=>T,kO:()=>w,p2:()=>_,so:()=>N,tw:()=>F});var r=n(37837),i=n(97607),a=n(71344),o=n(36043),s=n(32381),c=n(5874),u=n(51544),l=n(5351),h=n(56817),d=n(16613),f=n(30130),p=n(50531),g=n(62755);function m(t,e){return(0,r.tidy)((()=>((0,s.uM)(e),"channelsFirst"===e?r.transpose(t,[0,2,3,1]):t)))}function v(t,e){return(0,r.tidy)((()=>((0,s.uM)(e),"channelsFirst"===e?r.transpose(t,[0,2,3,4,1]):t)))}function y(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",u=arguments.length>5?arguments[5]:void 0,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return(0,r.tidy)((()=>{if(null==u&&(u=(0,a.VI)()),(0,s.uM)(u),3!==t.shape.length)throw new l.Qp("The input of a conv1dWithBias operation should be 3, but is "+"".concat(t.shape.length," instead."));if(3!==e.shape.length)throw new l.Qp("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new l.Qp("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(e.shape.length," instead"));if("channelsFirst"===u&&(t=r.transpose(t,[0,2,1])),"causal"===c)throw new l.EH("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let d=r.conv1d(t,e,i,"same"===c?"same":"valid","NWC",h);return null!=n&&(d=o.ni(d,n)),d}))}function b(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",c=arguments.length>5?arguments[5]:void 0,u=arguments.length>6?arguments[6]:void 0,h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return(0,r.tidy)((()=>{if(null==c&&(c=(0,a.VI)()),(0,s.uM)(c),3!==t.rank&&4!==t.rank)throw new l.Qp("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(t.rank,"."));if(3!==e.rank&&4!==e.rank)throw new l.Qp("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(t.rank,"."));let d=m(t,c);if("causal"===o)throw new l.EH("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return d=r.fused.conv2d({x:d,filter:e,strides:i,pad:"same"===o?"same":"valid",dilations:u,dataFormat:"NHWC",bias:n,activation:h}),"channelsFirst"===c&&(d=r.transpose(d,[0,3,1,2])),d}))}function x(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",u=arguments.length>5?arguments[5]:void 0,h=arguments.length>6?arguments[6]:void 0;return(0,r.tidy)((()=>{if(null==u&&(u=(0,a.VI)()),(0,s.uM)(u),4!==t.rank&&5!==t.rank)throw new l.Qp("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(t.rank,"."));if(4!==e.rank&&5!==e.rank)throw new l.Qp("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(t.rank,"."));let d=v(t,u);if("causal"===c)throw new l.EH("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return d=r.conv3d(d,e,i,"same"===c?"same":"valid","NDHWC",h),null!=n&&(d=o.ni(d,n)),"channelsFirst"===u&&(d=r.transpose(d,[0,4,1,2,3])),d}))}class w extends u.Wd{constructor(t,e){if(super(e),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",w.verifyArgs(e),this.rank=t,p.oo(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new l.EH("Convolution layer for rank other than 1, 2, or 3 (".concat(this.rank,") is ")+"not implemented yet.");if(this.kernelSize=(0,f.J)(e.kernelSize,t,"kernelSize"),this.strides=(0,f.J)(null==e.strides?1:e.strides,t,"strides"),this.padding=null==e.padding?"valid":e.padding,(0,s.tB)(this.padding),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,(0,s.uM)(this.dataFormat),this.activation=(0,i.b_)(e.activation),this.useBias=null==e.useBias||e.useBias,this.biasInitializer=(0,h.Fe)(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=(0,c.YZ)(e.biasConstraint),this.biasRegularizer=(0,d.Bm)(e.biasRegularizer),this.activityRegularizer=(0,d.Bm)(e.activityRegularizer),this.dilationRate=(0,f.J)(null==e.dilationRate?1:e.dilationRate,t,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new l.Qp("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(this.dilationRate)));if(2===this.rank){if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new l.Qp("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(this.dilationRate)))}else if(3===this.rank)if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new l.Qp("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(this.dilationRate)))}static verifyArgs(t){if(p.vA("kernelSize"in t,"required key 'kernelSize' not in config"),"number"!==typeof t.kernelSize&&!p.HP(t.kernelSize,"number",1,3))throw new l.Qp("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(t.kernelSize),"."))}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:(0,i.Bu)(this.activation),useBias:this.useBias,biasInitializer:(0,h.zo)(this.biasInitializer),biasRegularizer:(0,d.R9)(this.biasRegularizer),activityRegularizer:(0,d.R9)(this.activityRegularizer),biasConstraint:(0,c.uH)(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}class k extends w{constructor(t,e){super(t,e),this.kernel=null,k.verifyArgs(e),this.filters=e.filters,p.oo(this.filters,"filters"),this.kernelInitializer=(0,h.Fe)(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=(0,c.YZ)(e.kernelConstraint),this.kernelRegularizer=(0,d.Bm)(e.kernelRegularizer)}build(t){t=(0,g.U$)(t);const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new l.Qp("The channel dimension of the input should be defined. "+"Found ".concat(t[e]));const n=t[e],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[e]:n}}],this.built=!0}call(t,e){return(0,r.tidy)((()=>{let e;t=(0,g.un)(t);const n=null==this.bias?null:this.bias.read(),r=p.Cd(this.activation.getClassName());if(null!=r&&2===this.rank)e=b(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(1===this.rank)e=y(t,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)e=b(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new l.EH("convolutions greater than 3D are not implemented yet.");e=x(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(e=this.activation.apply(e))}return e}))}computeOutputShape(t){t=(0,g.U$)(t);const e=[],n="channelsLast"===this.dataFormat?t.slice(1,t.length-1):t.slice(2);for(let i=0;i<n.length;++i){const t=(0,f.Ol)(n[i],this.kernelSize[i],this.padding,this.strides[i],"number"===typeof this.dilationRate?this.dilationRate:this.dilationRate[i]);e.push(t)}let r=[t[0]];return"channelsLast"===this.dataFormat?(r=r.concat(e),r.push(this.filters)):(r.push(this.filters),r=r.concat(e)),r}getConfig(){const t={filters:this.filters,kernelInitializer:(0,h.zo)(this.kernelInitializer),kernelRegularizer:(0,d.R9)(this.kernelRegularizer),kernelConstraint:(0,c.uH)(this.kernelConstraint)},e=super.getConfig();return Object.assign(t,e),t}static verifyArgs(t){if(!("filters"in t)||"number"!==typeof t.filters||t.filters<1)throw new l.Qp("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(t.filters)))}}class _ extends k{constructor(t){super(2,t),_.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if("number"!==typeof t.kernelSize&&!p.HP(t.kernelSize,"number",1,2))throw new l.Qp("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(t.kernelSize),"."))}}_.className="Conv2D",r.serialization.registerClass(_);class A extends k{constructor(t){super(3,t),A.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if("number"!==typeof t.kernelSize&&(!Array.isArray(t.kernelSize)||1!==t.kernelSize.length&&3!==t.kernelSize.length))throw new l.Qp("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(t.kernelSize),"."))}}A.className="Conv3D",r.serialization.registerClass(A);class C extends _{constructor(t){if(super(t),this.inputSpec=[new u.eO({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new l.Qp("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(this.padding))}build(t){if(4!==(t=(0,g.U$)(t)).length)throw new l.Qp("Input should have rank 4; Received input shape: "+JSON.stringify(t));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new l.Qp("The channel dimension of the inputs should be defined. Found `None`.");const n=t[e],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new u.eO({ndim:4,axes:{[e]:n}})],this.built=!0}call(t,e){return r.tidy((()=>{let e=(0,g.un)(t);if(4!==e.shape.length)throw new l.Qp("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(e.shape.length));const n=e.shape,i=n[0];let a,s;"channelsFirst"===this.dataFormat?(a=2,s=3):(a=1,s=2);const c=n[a],u=n[s],h=this.kernelSize[0],d=this.kernelSize[1],p=this.strides[0],m=this.strides[1],v=[i,(0,f.mW)(c,p,h,this.padding),(0,f.mW)(u,m,d,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(e=r.transpose(e,[0,2,3,1]));let y=r.conv2dTranspose(e,this.kernel.read(),v,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(y=r.transpose(y,[0,3,1,2])),null!=this.bias&&(y=o.ni(y,this.bias.read(),this.dataFormat)),null!=this.activation&&(y=this.activation.apply(y)),y}))}computeOutputShape(t){const e=(t=(0,g.U$)(t)).slice();let n,r,i;"channelsFirst"===this.dataFormat?(n=1,r=2,i=3):(n=3,r=1,i=2);const a=this.kernelSize[0],o=this.kernelSize[1],s=this.strides[0],c=this.strides[1];return e[n]=this.filters,e[r]=(0,f.mW)(e[r],s,a,this.padding),e[i]=(0,f.mW)(e[i],c,o,this.padding),e}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}C.className="Conv2DTranspose",r.serialization.registerClass(C);class S extends A{constructor(t){if(super(t),this.inputSpec=[new u.eO({ndim:5})],"same"!==this.padding&&"valid"!==this.padding)throw new l.Qp("Conv3DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(this.padding))}build(t){if(5!==(t=(0,g.U$)(t)).length)throw new l.Qp("Input should have rank 5; Received input shape: "+JSON.stringify(t));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new l.Qp("The channel dimension of the inputs should be defined. Found `None`.");const n=t[e],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new u.eO({ndim:5,axes:{[e]:n}})],this.built=!0}call(t,e){return r.tidy((()=>{let e=(0,g.un)(t);if(5!==e.shape.length)throw new l.Qp("Conv3DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(e.shape.length));const n=e.shape,i=n[0];let a,s,c;"channelsFirst"===this.dataFormat?(c=2,a=3,s=4):(c=1,a=2,s=3);const u=n[c],h=n[a],d=n[s],p=this.kernelSize[0],m=this.kernelSize[1],v=this.kernelSize[2],y=this.strides[0],b=this.strides[1],x=this.strides[2],w=[i,(0,f.mW)(u,y,p,this.padding),(0,f.mW)(h,b,m,this.padding),(0,f.mW)(d,x,v,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(e=r.transpose(e,[0,2,3,4,1]));let k=r.conv3dTranspose(e,this.kernel.read(),w,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(k=r.transpose(k,[0,4,1,2,3])),null!==this.bias&&(k=o.ni(k,this.bias.read(),this.dataFormat)),null!==this.activation&&(k=this.activation.apply(k)),k}))}computeOutputShape(t){const e=(t=(0,g.U$)(t)).slice();let n,r,i,a;"channelsFirst"===this.dataFormat?(n=1,r=2,i=3,a=4):(n=4,r=1,i=2,a=3);const o=this.kernelSize[0],s=this.kernelSize[1],c=this.kernelSize[2],u=this.strides[0],l=this.strides[1],h=this.strides[2];return e[n]=this.filters,e[r]=(0,f.mW)(e[r],u,o,this.padding),e[i]=(0,f.mW)(e[i],l,s,this.padding),e[a]=(0,f.mW)(e[a],h,c,this.padding),e}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}S.className="Conv3DTranspose",r.serialization.registerClass(S);class E extends k{constructor(t,e){if(super(t,e),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==e.filters)throw new l.Qp("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=e.kernelInitializer||null!=e.kernelRegularizer||null!=e.kernelConstraint)throw new l.Qp("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=e.padding&&"same"!==e.padding&&"valid"!==e.padding)throw new l.Qp("SeparableConv".concat(this.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(e.padding)));this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=(0,h.Fe)(e.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=(0,d.Bm)(e.depthwiseRegularizer),this.depthwiseConstraint=(0,c.YZ)(e.depthwiseConstraint),this.pointwiseInitializer=(0,h.Fe)(e.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=(0,d.Bm)(e.pointwiseRegularizer),this.pointwiseConstraint=(0,c.YZ)(e.pointwiseConstraint)}build(t){if((t=(0,g.U$)(t)).length<this.rank+2)throw new l.Qp("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(t)));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e]||t[e]<0)throw new l.Qp("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(t[e])));const n=t[e],r=this.kernelSize.concat([n,this.depthMultiplier]),i=[];for(let o=0;o<this.rank;++o)i.push(1);i.push(n*this.depthMultiplier,this.filters);const a=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,a,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,a,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,a,this.biasConstraint):this.bias=null,this.inputSpec=[new u.eO({ndim:this.rank+2,axes:{[e]:n}})],this.built=!0}call(t,e){return(0,r.tidy)((()=>{let e;if(t=(0,g.un)(t),1===this.rank)throw new l.EH("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(t=r.transpose(t,[0,2,3,1])),e=r.separableConv2d(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(e=o.ni(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),"channelsFirst"===this.dataFormat&&(e=r.transpose(e,[0,3,1,2])),e}))}getConfig(){const t=super.getConfig();return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=(0,h.zo)(this.depthwiseInitializer),t.pointwiseInitializer=(0,h.zo)(this.pointwiseInitializer),t.depthwiseRegularizer=(0,d.R9)(this.depthwiseRegularizer),t.pointwiseRegularizer=(0,d.R9)(this.pointwiseRegularizer),t.depthwiseConstraint=(0,c.uH)(this.depthwiseConstraint),t.pointwiseConstraint=(0,c.uH)(this.pointwiseConstraint),t}}E.className="SeparableConv";class T extends E{constructor(t){super(2,t)}}T.className="SeparableConv2D",r.serialization.registerClass(T);class N extends k{constructor(t){super(1,t),N.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if("number"!==typeof t.kernelSize&&!p.HP(t.kernelSize,"number",1,1))throw new l.Qp("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(t.kernelSize),"."))}}N.className="Conv1D",r.serialization.registerClass(N);class F extends u.Wd{constructor(t){super(t),"number"===typeof t.cropping?this.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:"number"===typeof t.cropping[0]?this.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:this.cropping=t.cropping,this.dataFormat=void 0===t.dataFormat?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return"channelsFirst"===this.dataFormat?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,e){return(0,r.tidy)((()=>{if(t=(0,g.un)(t),"channelsLast"===this.dataFormat){const e=o.r0(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return o.r0(e,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{const e=o.r0(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return o.r0(e,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}}))}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}F.className="Cropping2D",r.serialization.registerClass(F);class D extends u.Wd{constructor(t){super(t),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==t.size?this.DEFAULT_SIZE:t.size,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,(0,s.uM)(this.dataFormat),this.interpolation=null==t.interpolation?"nearest":t.interpolation,(0,s.uU)(this.interpolation)}computeOutputShape(t){if("channelsFirst"===this.dataFormat){const e=null==t[2]?null:this.size[0]*t[2],n=null==t[3]?null:this.size[1]*t[3];return[t[0],t[1],e,n]}{const e=null==t[1]?null:this.size[0]*t[1],n=null==t[2]?null:this.size[1]*t[2];return[t[0],e,n,t[3]]}}call(t,e){return r.tidy((()=>{let e=(0,g.un)(t);const n=e.shape;if("channelsFirst"===this.dataFormat){e=r.transpose(e,[0,2,3,1]);const t=this.size[0]*n[2],i=this.size[1]*n[3],a="nearest"===this.interpolation?r.image.resizeNearestNeighbor(e,[t,i]):r.image.resizeBilinear(e,[t,i]);return r.transpose(a,[0,3,1,2])}{const t=this.size[0]*n[1],i=this.size[1]*n[2];return"nearest"===this.interpolation?r.image.resizeNearestNeighbor(e,[t,i]):r.image.resizeBilinear(e,[t,i])}}))}getConfig(){const t={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},e=super.getConfig();return Object.assign(t,e),t}}D.className="UpSampling2D",r.serialization.registerClass(D)},73740:(t,e,n)=>{"use strict";n.d(e,{g:()=>p});var r=n(37837),i=n(71344),a=n(36043),o=n(32381),s=n(5874),c=n(5351),u=n(56817),l=n(16613),h=n(30130),d=n(62755),f=n(91566);class p extends f.kO{constructor(t){super(2,t),this.depthwiseKernel=null,this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=(0,u.Fe)(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=(0,s.YZ)(t.depthwiseConstraint),this.depthwiseRegularizer=(0,l.Bm)(t.depthwiseRegularizer)}build(t){if((t=(0,d.U$)(t)).length<4)throw new c.Qp("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(t),"."));const e="channelsFirst"===this.dataFormat?1:3;if(null==t[e]||t[e]<0)throw new c.Qp("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(t[e],")."));const n=t[e],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return(0,r.tidy)((()=>{let e=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",s=arguments.length>4?arguments[4]:void 0,u=arguments.length>5?arguments[5]:void 0;return(0,r.tidy)((()=>{null==s&&(s=(0,i.VI)()),(0,o.uM)(s);let l=(0,f.RK)(t,s);if(4!==t.rank)throw new c.Qp("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(t.rank,"-D"));if(4!==e.rank)throw new c.Qp("depthwiseKernel is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));return l=r.depthwiseConv2d(l,e,n,"same"===a?"same":"valid","NHWC",u),"channelsFirst"===s&&(l=r.transpose(l,[0,3,1,2])),l}))}(t=(0,d.un)(t),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(e=a.ni(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),e}))}computeOutputShape(t){t=(0,d.U$)(t);const e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,i=(0,h.Ol)(e,this.kernelSize[0],this.padding,this.strides[0]),a=(0,h.Ol)(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[t[0],r,i,a]:[t[0],i,a,r]}getConfig(){const t=super.getConfig();return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=(0,u.zo)(this.depthwiseInitializer),t.depthwiseRegularizer=(0,l.R9)(this.depthwiseRegularizer),t.depthwiseConstraint=(0,s.uH)(this.depthwiseRegularizer),t}}p.className="DepthwiseConv2D",r.serialization.registerClass(p)},59771:(t,e,n)=>{"use strict";n.d(e,{H:()=>g,j:()=>m});var r=n(37837),i=n(36043),a=n(32381),o=n(51544),s=n(5351),c=n(56817),u=n(30130),l=n(50531),h=n(62755),d=n(58715),f=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class p extends d.VS{constructor(t){if(t.unroll)throw new s.EH("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(t.cell))throw new s.EH("It is not possible at the moment to stack convolutional cells.");super(t),this.inputSpec=[new o.eO({ndim:5})]}call(t,e){return r.tidy((()=>{if(null!=this.cell.dropoutMask&&(r.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(r.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),e&&e.constants)throw new s.Qp("ConvRNN2D cell does not support constants");const n=null==e?null:e.mask,i=null==e?null:e.training,a=null==e?null:e.initialState;return super.call(t,{mask:n,training:i,initialState:a})}))}computeOutputShape(t){let e=this.computeSingleOutputShape(t);return this.returnSequences||(e=[e[0],...e.slice(2)]),this.returnState&&(e=[e,...Array(2).fill([t[0],...e.slice(-3)])]),e}getInitialState(t){return r.tidy((()=>{const{stateSize:e}=this.cell,n=t.shape,i=this.computeSingleOutputShape(n),a=[i[0],...i.slice(2)],o=r.zeros(a);return Array.isArray(e)?Array(e.length).fill(o):[o]}))}resetStates(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r.tidy((()=>{if(!this.stateful)throw new s.l7("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape,i=this.computeSingleOutputShape(n),a=[i[0],...i.slice(2)];if(null==n[0])throw new s.Qp("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((()=>r.zeros(a))):this.states_=[r.zeros(a)];else if(null==t)r.dispose(this.states_),null!=this.keptStates&&(r.dispose(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((()=>r.zeros(a))):this.states_[0]=r.zeros(a);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new s.Qp("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), ")+"but it received ".concat(t.length," state value(s). Input ")+"received: ".concat(t));e?this.keptStates.push(this.states_.slice()):r.dispose(this.states_);for(let e=0;e<this.states_.length;++e){const n=t[e],i=a;if(!r.util.arraysEqual(n.shape,i))throw new s.Qp("State ".concat(e," is incompatible with layer ").concat(this.name,": ")+"expected shape=".concat(i,", received shape=").concat(n.shape));this.states_[e]=n}}this.states_=this.states_.map((t=>r.keep(t.clone())))}))}computeSingleOutputShape(t){const{dataFormat:e,filters:n,kernelSize:r,padding:i,strides:a,dilationRate:o}=this.cell,s="channelsFirst"===e,c=t[s?3:2],l=t[s?4:3],h=(0,u.Ol)(c,r[0],i,a[0],o[0]),d=(0,u.Ol)(l,r[1],i,a[1],o[1]);return[...t.slice(0,2),...s?[n,h,d]:[h,d,n]]}}p.className="ConvRNN2D";class g extends d.Tu{constructor(t){const{filters:e,kernelSize:n,strides:r,padding:i,dataFormat:o,dilationRate:s}=t;super(Object.assign(Object.assign({},t),{units:e})),this.filters=e,(0,l.oo)(this.filters,"filters"),this.kernelSize=(0,u.J)(n,2,"kernelSize"),this.kernelSize.forEach((t=>(0,l.oo)(t,"kernelSize"))),this.strides=(0,u.J)(r||1,2,"strides"),this.strides.forEach((t=>(0,l.oo)(t,"strides"))),this.padding=i||"valid",(0,a.tB)(this.padding),this.dataFormat=o||"channelsLast",(0,a.uM)(this.dataFormat),this.dilationRate=(0,u.J)(s||1,2,"dilationRate"),this.dilationRate.forEach((t=>(0,l.oo)(t,"dilationRate")))}build(t){var e;t=(0,h.U$)(t);const n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n])throw new s.Qp("The channel dimension of the input should be defined. "+"Found ".concat(t[n]));const a=t[n],o=this.kernelSize.concat([a,4*this.filters]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const u=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",u,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let t;if(this.unitForgetBias){const n=this.biasInitializer,a=this.filters;t=new((e=class extends c.H4{apply(t,e){const o=n.apply([a]),s=r.ones([a]),c=n.apply([2*a]);return i.u1([o,s,c])}}).className="CustomInit",e)}else t=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,t,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(t,e){return r.tidy((()=>{if(3!==t.length)throw new s.Qp("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+"".concat(t.length,"."));const n=e.training||!1,i=t[0],a=t[1],o=t[2];0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=(0,d.FW)({ones:()=>r.onesLike(i),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const c=this.dropoutMask,u=(t,e,n)=>e&&e[n]?r.mul(e[n],t):t;let l=u(i,c,0),h=u(i,c,1),f=u(i,c,2),p=u(i,c,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=(0,d.FW)({ones:()=>r.onesLike(a),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const g=this.recurrentDropoutMask;let m=u(a,g,0),v=u(a,g,1),y=u(a,g,2),b=u(a,g,3);const[x,w,k,_]=r.split(this.kernel.read(),4,3),[A,C,S,E]=this.useBias?r.split(this.bias.read(),4):[null,null,null,null];l=this.inputConv(l,x,A,this.padding),h=this.inputConv(h,w,C,this.padding),f=this.inputConv(f,k,S,this.padding),p=this.inputConv(p,_,E,this.padding);const[T,N,F,D]=r.split(this.recurrentKernel.read(),4,3);m=this.recurrentConv(m,T),v=this.recurrentConv(v,N),y=this.recurrentConv(y,F),b=this.recurrentConv(b,D);const I=this.recurrentActivation.apply(r.add(l,m)),M=this.recurrentActivation.apply(r.add(h,v)),O=r.add(r.mul(M,o),r.mul(I,this.activation.apply(r.add(f,y)))),R=r.mul(this.recurrentActivation.apply(r.add(p,b)),this.activation.apply(O));return[R,R,O]}))}getConfig(){const t=super.getConfig(),{units:e}=t,n=f(t,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),r)}inputConv(t,e,n,a){const o=r.conv2d(t,e,this.strides,a||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?i.ni(o,n,this.dataFormat):o}recurrentConv(t,e){return r.conv2d(t,e,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}g.className="ConvLSTM2DCell",r.serialization.registerClass(g);class m extends p{constructor(t){const e=new g(t);super(Object.assign(Object.assign({},t),{cell:e}))}static fromConfig(t,e){return new t(e)}}m.className="ConvLSTM2D",r.serialization.registerClass(m)},10818:(t,e,n)=>{"use strict";n.d(e,{C2:()=>p,FA:()=>v,JW:()=>b,L:()=>k,R2:()=>x,XO:()=>g,Yv:()=>m,tg:()=>w,xq:()=>y});var r=n(37837),i=n(97607),a=n(36043),o=n(5874),s=n(51544),c=n(5351),u=n(56817),l=n(16613),h=n(50531),d=n(11690),f=n(62755);class p extends s.Wd{constructor(t){super(t),this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(null==this.noiseShape)return this.noiseShape;const e=t.shape,n=[];for(let r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?e[r]:this.noiseShape[r]);return n}call(t,e){return(0,r.tidy)((()=>{this.invokeCallHook(t,e);const n=(0,f.un)(t);if(0<this.rate&&this.rate<1){const t=null!=e.training&&e.training,r=this.getNoiseShape(n);return a.Ls((()=>a.EZ(n,this.rate,r,this.seed)),(()=>n),t)}return t}))}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},e=super.getConfig();return Object.assign(t,e),t}dispose(){return super.dispose()}}p.className="Dropout",r.serialization.registerClass(p);class g extends p{constructor(t){super(t),this.inputSpec=[{ndim:3}]}getNoiseShape(t){const e=t.shape;return[e[0],1,e[2]]}}g.className="SpatialDropout1D",r.serialization.registerClass(g);class m extends s.Wd{constructor(t){if(super(t),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==t.batchInputShape&&null==t.inputShape&&null!=t.inputDim){let e=null;null!=t.batchSize&&(e=t.batchSize),this.batchInputShape=[e,t.inputDim]}this.units=t.units,(0,h.oo)(this.units,"units"),this.activation=(0,i.b_)(t.activation),null!=t.useBias&&(this.useBias=t.useBias),this.kernelInitializer=(0,u.Fe)(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=(0,u.Fe)(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=(0,o.YZ)(t.kernelConstraint),this.biasConstraint=(0,o.YZ)(t.biasConstraint),this.kernelRegularizer=(0,l.Bm)(t.kernelRegularizer),this.biasRegularizer=(0,l.Bm)(t.biasRegularizer),this.activityRegularizer=(0,l.Bm)(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){const e=(t=(0,f.U$)(t))[t.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[e,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:e}}],this.built=!0}computeOutputShape(t){const e=(t=(0,f.U$)(t)).slice();return e[e.length-1]=this.units,e}call(t,e){return(0,r.tidy)((()=>{this.invokeCallHook(t,e);const n=(0,f.un)(t),r=(0,h.Cd)(this.activation.getClassName());let i;return null!=r?i=a.Om(n,this.kernel.read(),r,this.bias?this.bias.read():null):(i=a.Om(n,this.kernel.read()),null!=this.bias&&(i=a.ni(i,this.bias.read())),null!=this.activation&&(i=this.activation.apply(i))),i}))}getConfig(){const t={units:this.units,activation:(0,i.Bu)(this.activation),useBias:this.useBias,kernelInitializer:(0,u.zo)(this.kernelInitializer),biasInitializer:(0,u.zo)(this.biasInitializer),kernelRegularizer:(0,l.R9)(this.kernelRegularizer),biasRegularizer:(0,l.R9)(this.biasRegularizer),activityRegularizer:(0,l.R9)(this.activityRegularizer),kernelConstraint:(0,o.uH)(this.kernelConstraint),biasConstraint:(0,o.uH)(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}m.className="Dense",r.serialization.registerClass(m);class v extends s.Wd{constructor(t){super(t=t||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=(0,f.U$)(t);for(const e of t.slice(1))if(null==e)throw new c.Qp('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(t.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.');return[t[0],(0,d.no)(t,1)]}call(t,e){return(0,r.tidy)((()=>{this.invokeCallHook(t,e);let n=(0,f.un)(t);if("channelsFirst"===this.dataFormat&&n.rank>1){const t=[0];for(let e=2;e<n.rank;++e)t.push(e);t.push(1),n=(0,r.transpose)(n,t)}return a.PS(n)}))}getConfig(){const t={};null!=this.dataFormat&&(t.dataFormat=this.dataFormat);const e=super.getConfig();return Object.assign(t,e),t}}v.className="Flatten",r.serialization.registerClass(v);class y extends s.Wd{constructor(t){super(t),this.supportsMasking=!0,this.activation=(0,i.b_)(t.activation)}call(t,e){return(0,r.tidy)((()=>{this.invokeCallHook(t,e);const n=(0,f.un)(t);return this.activation.apply(n)}))}getConfig(){const t={activation:(0,i.Bu)(this.activation)},e=super.getConfig();return Object.assign(t,e),t}}y.className="Activation",r.serialization.registerClass(y);class b extends s.Wd{constructor(t){super(t),this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,e){return(0,r.tidy)((()=>(t=(0,f.un)(t),a.ux(t,this.n))))}getConfig(){const t={n:this.n},e=super.getConfig();return Object.assign(t,e),t}}b.className="RepeatVector",r.serialization.registerClass(b);class x extends s.Wd{constructor(t){super(t),this.targetShape=t.targetShape;for(let e=0;e<this.targetShape.length;++e)this.isUnknown(this.targetShape[e])&&(this.targetShape[e]=null)}isUnknown(t){return t<0||null==t}fixUnknownDimension(t,e){const n="Total size of new array must be unchanged.",r=e.slice();let i=1,a=null;for(let s=0;s<r.length;++s){const t=r[s];if(this.isUnknown(t)){if(null!==a)throw new c.Qp("Can only specifiy one unknown dimension.");a=s}else i*=t}const o=(0,d.no)(t);if(null!==a){if(0===i||o%i!==0)throw new c.Qp(n);r[a]=o/i}else if(o!==i)throw new c.Qp(n);return r}computeOutputShape(t){let e=!1;for(let n=0;n<t.length;++n)if(this.isUnknown(t[n])){e=!0;break}return e?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,e){return(0,r.tidy)((()=>{this.invokeCallHook(t,e);const n=(0,f.un)(t),i=n.shape,a=i.slice(0,1).concat(this.fixUnknownDimension(i.slice(1),this.targetShape));return(0,r.reshape)(n,a)}))}getConfig(){const t={targetShape:this.targetShape},e=super.getConfig();return Object.assign(t,e),t}}x.className="Reshape",r.serialization.registerClass(x);class w extends s.Wd{constructor(t){if(super(t),null==t.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(t.dims," instead."));const e=(0,d.y1)(1,t.dims.length+1);if(!r.util.arraysEqual(t.dims.slice().sort(),e))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new s.eO({ndim:this.dims.length+1})]}computeOutputShape(t){const e=(t=(0,f.U$)(t)).slice();return this.dims.forEach(((n,r)=>{e[r+1]=t[n]})),e}call(t,e){return(0,r.transpose)((0,f.un)(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},e=super.getConfig();return Object.assign(t,e),t}}w.className="Permute",r.serialization.registerClass(w);class k extends s.Wd{constructor(t){super(null==t?{}:t),this.supportsMasking=!0,this.maskValue=null!=t?null==t.maskValue?0:t.maskValue:0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={maskValue:this.maskValue};return Object.assign(e,t),e}computeMask(t,e){const n=(0,f.un)(t);return(0,r.any)((0,r.notEqual)(n,this.maskValue),-1)}call(t,e){return(0,r.tidy)((()=>{this.invokeCallHook(t,e);const n=(0,f.un)(t),i=(0,r.any)((0,r.notEqual)(n,this.maskValue),-1,!0);return(0,r.mul)(n,(0,r.cast)(i,n.dtype))}))}}k.className="Masking",r.serialization.registerClass(k)},21287:(t,e,n)=>{"use strict";n.d(e,{s:()=>d});var r=n(37837),i=n(36043),a=n(5874),o=n(51544),s=n(5351),c=n(56817),u=n(16613),l=n(50531),h=n(62755);class d extends o.Wd{constructor(t){if(super(t),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==t.batchInputShape&&null==t.inputShape){let e=null;null!=t.batchSize&&(e=t.batchSize),null==t.inputLength?this.batchInputShape=[e,null]:this.batchInputShape=[e].concat(l.st(t.inputLength))}this.inputDim=t.inputDim,l.oo(this.inputDim,"inputDim"),this.outputDim=t.outputDim,l.oo(this.outputDim,"outputDim"),this.embeddingsInitializer=(0,c.Fe)(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=(0,u.Bm)(t.embeddingsRegularizer),this.activityRegularizer=(0,u.Bm)(t.activityRegularizer),this.embeddingsConstraint=(0,a.YZ)(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,e){return(0,r.tidy)((()=>this.maskZero?(t=(0,h.un)(t),(0,r.notEqual)(t,(0,r.zerosLike)(t))):null))}computeOutputShape(t){if(t=(0,h.U$)(t),null==this.inputLength)return[...t,this.outputDim];const e=l.st(this.inputLength);if(e.length!==t.length-1)throw new s.Qp('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(t));{let n=0;for(let r=0;r<e.length;++r){const i=e[r],a=t[r+1];if(null!=i&&null!=a&&i!==a)throw new s.Qp('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(t));null==i&&(e[n]=a),n++}}return[t[0],...e,this.outputDim]}call(t,e){return(0,r.tidy)((()=>{this.invokeCallHook(t,e);let n=(0,h.un)(t);"int32"!==n.dtype&&(n=i.wg(n,"int32"));const a=i.kg(this.embeddings.read(),(0,r.reshape)(n,[n.size]));return(0,r.reshape)(a,(0,h.U$)(this.computeOutputShape(n.shape)))}))}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:(0,c.zo)(this.embeddingsInitializer),embeddingsRegularizer:(0,u.R9)(this.embeddingsRegularizer),activityRegularizer:(0,u.R9)(this.activityRegularizer),embeddingsConstraint:(0,a.uH)(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},e=super.getConfig();return Object.assign(t,e),t}}d.className="Embedding",r.serialization.registerClass(d)},70873:(t,e,n)=>{"use strict";n.d(e,{LD:()=>g,LG:()=>m,OM:()=>d,Sb:()=>v,Yb:()=>p,cL:()=>b,xu:()=>f});var r=n(37837),i=n(36043),a=n(51544),o=n(5351),s=n(57463),c=n(50531),u=n(11690),l=n(62755);class h extends a.Wd{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new o.EH}computeElementwiseOpOutputShape(t,e){if(null==t||null==e)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(0===e.length)return t;const n=t.slice(0,t.length-e.length);for(let r=0;r<e.length;++r){const i=t[t.length-e.length+r],a=e[r];if(null==i||null==a||i<0||a<0)n.push(null);else if(1===i)n.push(a);else if(1===a)n.push(i);else{if(i!==a)throw new o.Qp("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));n.push(i)}}return n}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[(0,l.U$)(t)]),t.length<2)throw new o.Qp("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(t.length," input(s)."));let e=[];for(const i of t)null!=i&&null!==i[0]&&e.push(i[0]);if(e=c.Am(e),e.length>1)throw new o.Qp("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(t),"."));let n=null==t[0]?null:t[0].slice(1);for(let i=1;i<t.length;++i){const e=null==t[i]?null:t[i].slice(1);n=this.computeElementwiseOpOutputShape(n,e)}const r=t.map((t=>t.length));-1===t.indexOf(null)&&1===c.Am(r).length?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,e){return(0,r.tidy)((()=>{if(this.reshapeRequired){const e=[],n=t.map((t=>t.rank));if(-1===n.indexOf(null)){const r=u.T9(n);for(let n of t){const t=n.rank;for(let e=0;e<r-t;++e)n=i.UG(n,1);e.push(n)}return this.mergeFunction(e)}{let n=!1;for(const o of t){const t=o.rank;if(null==t){const t=o.shape,i=t[0],a=t.slice(1).concat([i]);let s=r.reshape(o,[i].concat(u.no(t.slice(1))));s=r.transpose(s,[1,0]),s=r.reshape(s,a),e.push(s),n=!0}else if(t>1){const i=u.y1(1,t).concat([0]);e.push(r.transpose(o,i)),n=!0}else e.push(o)}let i=this.mergeFunction(e);const a=i.rank;if(n)if(null==a){const t=i.shape,e=t[t.length-1],n=[e].concat(t.slice(0,t.length-1));i=r.reshape(r.transpose(r.reshape(i,[-1,e]),[1,0]),n)}else if(a>1){const t=[a-1].concat(u.y1(0,a-1));i=r.transpose(i,t)}return i}}return this.mergeFunction(t)}))}computeOutputShape(t){let e;e=null==t[0]?null:t[0].slice(1);for(let r=1;r<t.length;++r){const n=null==t[r]?null:t[r].slice(1);e=this.computeElementwiseOpOutputShape(e,n)}let n=[];for(const r of t)null!=r&&null!==r[0]&&n.push(r[0]);return n=c.Am(n),e=1===n.length?n.concat(e):[null].concat(e),e}computeMask(t,e){return r.tidy((()=>{if(null==e)return null;if(!Array.isArray(e))throw new o.Qp("`mask` should be an Array");if(!Array.isArray(t))throw new o.Qp("`inputs` should be an Array");if(e.length!==t.length)throw new o.Qp("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(t.length," vs ").concat(e.length,")"));if(e.every((t=>null==t)))return null;let n=(e=e.map((t=>null==t?t:r.expandDims(t,0))))[0];for(let t=1;t<e.length-1;++t)n=r.logicalAnd(n,e[t]);return n}))}}class d extends h{constructor(t){super(t)}mergeFunction(t){return(0,r.tidy)((()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=r.add(e,t[n]);return e}))}}d.className="Add",r.serialization.registerClass(d);class f extends h{constructor(t){super(t)}mergeFunction(t){return(0,r.tidy)((()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=r.mul(e,t[n]);return e}))}}f.className="Multiply",r.serialization.registerClass(f);class p extends h{constructor(t){super(t)}mergeFunction(t){return(0,r.tidy)((()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=r.add(e,t[n]);return r.mul(1/t.length,e)}))}}p.className="Average",r.serialization.registerClass(p);class g extends h{constructor(t){super(t)}mergeFunction(t){return(0,r.tidy)((()=>{let e=t[0];for(let n=1;n<t.length;++n)e=r.maximum(e,t[n]);return e}))}}g.className="Maximum",r.serialization.registerClass(g);class m extends h{constructor(t){super(t)}mergeFunction(t){return(0,r.tidy)((()=>{let e=t[0];for(let n=1;n<t.length;++n)e=r.minimum(e,t[n]);return e}))}}m.className="Minimum",r.serialization.registerClass(m);class v extends h{constructor(t){super(t),this.DEFAULT_AXIS=-1,null==t&&(t={}),this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!Array.isArray(t)||!Array.isArray(t[0])||1===t.length)throw new o.Qp("A `Concatenate` layer should be called on a list of at least 2 inputs");let e=!0;for(const r of t)if(null!=r){e=!1;break}if(e)return;const n=[];for(let i=0;i<t.length;++i){const e=t[i].slice();e.splice(this.axis,1);let a=!1;for(const t of n)if(r.util.arraysEqual(t,e)){a=!0;break}a||n.push(e)}if(n.length>1)throw new o.Qp("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return(0,r.tidy)((()=>i.u1(t,this.axis)))}computeOutputShape(t){if(!Array.isArray(t)||!Array.isArray(t[0]))throw new o.Qp("A `Concatenate` layer should be called on a list of inputs.");const e=t,n=e[0].slice(),r=this.axis<0?n.length+this.axis:this.axis;for(const i of e.slice(1)){if(null==n[r]||null==i[r]){n[r]=null;break}n[r]+=i[r]}return n}computeMask(t,e){if(null==e)return null;if(!Array.isArray(e))throw new o.Qp("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new o.Qp("`inputs` should be an array for Concatenate");if(e.length!==t.length)throw new o.Qp("Mismatch in the length of mask (".concat(e.length,") ")+"and the legnth of inputs (".concat(t.length,")"));return r.tidy((()=>{let n=!0;if(e.forEach((t=>{null==t||(n=!1)})),n)return null;const i=[];for(let o=0;o<t.length;++o)null==e[o]?i.push(r.cast(r.onesLike(t[o]),"bool")):e[o].rank<t[o].rank?i.push(r.expandDims(e[o],-1)):i.push(e[o]);const a=r.concat(i,this.axis);return r.all(a,-1,!1)}))}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}function y(t,e){for(;t<0;)t+=e;return t}v.className="Concatenate",r.serialization.registerClass(v);class b extends h{constructor(t){super(t),this.axes=t.axes,this.normalize=null!=t.normalize&&t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){r.util.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),(()=>"A `Dot` layer should be called on a list of exactly 2 inputs."));const e=t[0],n=t[1];if(e.length>3||n.length>3)throw new o.EH("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(e,n);if(e[i[0]]!==n[i[1]])throw new o.Qp("Dimension incompatibility: "+"".concat(e[i[0]]," !== ").concat(n[i[1]]))}mergeFunction(t){if(2!==t.length)throw new o.Qp("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(t.length," input(s)."));let e,n=t[0],i=t[1];return e=Array.isArray(this.axes)?this.axes.map(((e,n)=>y(e,t[n].shape.length))):[y(this.axes,n.shape.length),y(this.axes,i.shape.length)],this.normalize&&(n=(0,s.Yq)(n,e[0]),i=(0,s.Yq)(i,e[1])),function(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new o.EH("batchDot is not implemented for tensors of 4D or higher rank yet");if(r.util.assert(t.shape.length>=2,(()=>"batchDot requires the rank of x to be >= 2, "+"but got ".concat(t.shape.length))),r.util.assert(t.shape.length>=2,(()=>"batchDot requires the rank of y to be >= 2, "+"but got ".concat(e.shape.length))),"number"===typeof n&&(n=[n,n]),"complex64"===t.dtype||"complex64"===e.dtype)throw new o.EH("batchDot is not implemented for complex64-type Tensors yet.");const i=t.shape.length,a=e.shape.length;null==n&&(n=[i-1,a-2]);const s=n;return r.tidy((()=>{let n,o;if(i>a){n=i-a;const t=[];for(let e=0;e<n;++e)t.push(1);e=r.reshape(e,e.shape.concat(t))}else if(a>i){n=a-i;const e=[];for(let t=0;t<n;++t)e.push(1);t=r.reshape(t,t.shape.concat(e))}else n=0;if(2===t.shape.length&&2===e.shape.length)o=s[0]===s[1]?r.sum(r.mul(t,e),s[0]):r.sum(r.mul(r.transpose(t,[1,0]),e),s[1]);else{const n=s[0]!==t.shape.length-1,i=s[1]===e.shape.length-1;o=r.matMul(t,e,n,i)}if(n>0){let t;t=i>a?i+a-3:i-1;const e=[];for(let r=t;r<t+n;++r)e.push(r);o=r.squeeze(o,e)}return 1===o.shape.length&&(o=r.expandDims(o,1)),o}))}(n,i,e)}interpretAxes(t,e){let n;return n=Array.isArray(this.axes)?this.axes:[y(this.axes,t.length),y(this.axes,e.length)],n}computeOutputShape(t){r.util.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),(()=>"A `Dot` layer should be called on a list of exactly 2 inputs."));const e=t[0].slice(),n=t[1].slice();if(e.length>3||n.length>3)throw new o.EH("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(e,n);e.splice(i[0],1),n.splice(i[1],1),n.splice(0,1);const a=e.concat(n);return 1===a.length&&a.push(1),a}computeMask(t,e){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},e=super.getConfig();return Object.assign(t,e),t}}b.className="Dot",r.serialization.registerClass(b)},36543:(t,e,n)=>{"use strict";n.d(e,{Qu:()=>u,UB:()=>s,nV:()=>c});var r=n(37837),i=n(36043),a=n(51544),o=n(62755);class s extends a.Wd{constructor(t){super(t),this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={stddev:this.stddev};return Object.assign(e,t),e}call(t,e){return(0,r.tidy)((()=>{this.invokeCallHook(t,e);const n=(0,o.un)(t);return i.Ls((()=>(0,r.add)(i.FE(n.shape,0,this.stddev),n)),(()=>n),e.training||!1)}))}}s.className="GaussianNoise",r.serialization.registerClass(s);class c extends a.Wd{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return(0,r.tidy)((()=>{this.invokeCallHook(t,e);const n=(0,o.un)(t);if(this.rate>0&&this.rate<1){const t=()=>{const t=Math.sqrt(this.rate/(1-this.rate));return(0,r.mul)(n,i.FE(n.shape,1,t))};return i.Ls(t,(()=>n),e.training||!1)}return n}))}}c.className="GaussianDropout",r.serialization.registerClass(c);class u extends a.Wd{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||(0,o.un)(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return(0,r.tidy)((()=>{if(this.rate<1&&this.rate>0){const n=this._getNoiseShape(t),a=()=>{const e=(0,o.un)(t),a=-1.7580993408473766;let s=(0,r.greaterEqual)((0,r.randomUniform)(n),this.rate);s=i.wg(s,"float32");const c=((1-this.rate)*(1+this.rate*a**2))**-.5,u=-c*a*this.rate,l=(0,r.add)((0,r.mul)(e,s),(0,r.mul)((0,r.add)(s,-1),a));return(0,r.add)((0,r.mul)(l,c),u)};return i.Ls(a,(()=>(0,o.un)(t)),e.training||!1)}return t}))}}u.className="AlphaDropout",r.serialization.registerClass(u)},10288:(t,e,n)=>{"use strict";n.d(e,{Ez:()=>p,RX:()=>g});var r=n(37837),i=n(5874),a=n(51544),o=n(5351),s=n(56817),c=n(16613),u=n(50531),l=n(11690),h=n(62755);function d(t,e,n,i,a){let s,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===t.rank)s=r.batchNorm2d(t,e,n,i,a,c);else if(3===t.rank)s=r.batchNorm3d(t,e,n,i,a,c);else{if(4!==t.rank)throw new o.EH("batchNormalization is not implemented for array of rank ".concat(t.rank," ")+"yet");s=r.batchNorm4d(t,e,n,i,a,c)}return s}function f(t,e,n,i){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return r.util.arraysEqual(i.slice().sort(),l.y1(0,t.rank-1))?function(t,e,n,i){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return(0,r.tidy)((()=>{const o=r.moments(t,i),s=o.mean,c=o.variance;return[d(t,s,c,n,e,a),s,c]}))}(t,e,n,i,a):function(t,e,n,i){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return(0,r.tidy)((()=>{const o=r.moments(t,i),s=o.mean,c=o.variance,u=[];for(const e of l.y1(0,t.rank))-1!==i.indexOf(e)?u.push(1):u.push(t.shape[e]);const h=(0,r.reshape)(s,u),f=(0,r.reshape)(c,u),p=null==e?null:(0,r.reshape)(e,u),g=null==n?null:(0,r.reshape)(n,u);return[d(t,h,f,g,p,a),s,c]}))}(t,e,n,i,a)}class p extends a.Wd{constructor(t){null==t&&(t={}),super(t),this.supportsMasking=!0,this.axis=null==t.axis?-1:t.axis,this.momentum=null==t.momentum?.99:t.momentum,this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=(0,s.Fe)(t.betaInitializer||"zeros"),this.gammaInitializer=(0,s.Fe)(t.gammaInitializer||"ones"),this.movingMeanInitializer=(0,s.Fe)(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=(0,s.Fe)(t.movingVarianceInitializer||"ones"),this.betaConstraint=(0,i.YZ)(t.betaConstraint),this.gammaConstraint=(0,i.YZ)(t.gammaConstraint),this.betaRegularizer=(0,c.Bm)(t.betaRegularizer),this.gammaRegularizer=(0,c.Bm)(t.gammaRegularizer)}build(t){t=(0,h.U$)(t);const e=this.axis>=0?this.axis:this.axis+t.length,n=t[e];if(null==n)throw new o.Qp("Axis ".concat(e," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(t),"."));this.inputSpec=[new a.eO({ndim:t.length,axes:{[e]:n}})];const r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,e){return(0,r.tidy)((()=>{const n=null!=e.training&&e.training,i=(0,h.un)(t),a=i.shape,o=a.length,s=l.y1(0,o),c=this.axis>=0?this.axis:this.axis+o;s.splice(c,1);const p=u.fD(1,o);p[c]=a[c];const g=s.slice();g.sort();const m=!r.util.arraysEqual(g,l.y1(0,o).slice(0,o-1));if(!n)return(()=>{if(m){const t=(0,r.reshape)(this.movingMean.read(),p),e=(0,r.reshape)(this.movingVariance.read(),p),n=this.center?(0,r.reshape)(this.beta.read(),p):null,a=this.scale?(0,r.reshape)(this.gamma.read(),p):null;return d(i,t,e,n,a,this.epsilon)}return d(i,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();const[v,y,b]=f(i,this.gamma.read(),this.beta.read(),s,this.epsilon),x=(t,e,n)=>{r.tidy((()=>{const i=1-n,a=t.read(),o=r.mul(r.sub(a,e),i);t.write(r.sub(a,o))}))};return(()=>{x(this.movingMean,y,this.momentum),x(this.movingVariance,b,this.momentum)})(),v}))}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:(0,s.zo)(this.betaInitializer),gammaInitializer:(0,s.zo)(this.gammaInitializer),movingMeanInitializer:(0,s.zo)(this.movingMeanInitializer),movingVarianceInitializer:(0,s.zo)(this.movingVarianceInitializer),betaRegularizer:(0,c.R9)(this.betaRegularizer),gammaRegularizer:(0,c.R9)(this.gammaRegularizer),betaConstraint:(0,i.uH)(this.betaConstraint),gammaConstraint:(0,i.uH)(this.gammaConstraint)},e=super.getConfig();return Object.assign(t,e),t}}p.className="BatchNormalization",r.serialization.registerClass(p);class g extends a.Wd{constructor(t){if(null==t&&(t={}),super(t),this.axis=null==t.axis?-1:t.axis,"number"===typeof this.axis){if(!Number.isInteger(this.axis))throw new Error("Expected axis to be an integer, but received ".concat(this.axis))}else{if(!Array.isArray(this.axis))throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(this.axis)));for(const t of this.axis)if(!Number.isInteger(t))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(this.axis)))}this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=(0,s.Fe)(t.betaInitializer||"zeros"),this.gammaInitializer=(0,s.Fe)(t.gammaInitializer||"ones"),this.betaRegularizer=(0,c.Bm)(t.betaRegularizer),this.gammaRegularizer=(0,c.Bm)(t.gammaRegularizer),this.supportsMasking=!0}build(t){const e=(t=(0,h.U$)(t)).length;"number"===typeof this.axis&&(this.axis=[this.axis]);for(let r=0;r<this.axis.length;++r)this.axis[r]<0&&(this.axis[r]+=e);for(const r of this.axis)if(r<0||r>=e)throw new Error("Invalid axis: ".concat(r));if(this.axis.length!==u.Am(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));const n=this.axis.map((e=>t[e]));this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,true):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,true):this.beta=null,this.built=!0}call(t,e){const n=(0,h.un)(t),i=n.shape,a=i.length;return(0,r.tidy)((()=>{let{mean:t,variance:e}=(0,r.moments)(n,this.axis,!0);const o=u.fD(1,a);for(const n of this.axis)o[n]=i[n];const s=t=>null!=t&&t.shape.length!==a?r.reshape(t,o):t;let c=this.scale?s(this.gamma.read()):null,l=this.center?s(this.beta.read()):null;const h=[],f=[];for(let n=0;n<a;++n)-1!==this.axis.indexOf(n)?(h.push(i[n]),f.push(1)):(h.push(1),f.push(i[n]));return t=r.tile(t,h),e=r.tile(e,h),null!=c&&(c=r.tile(c,f)),null!=l&&(l=r.tile(l,f)),d(n,t,e,l,c,this.epsilon)}))}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:(0,s.zo)(this.betaInitializer),gammaInitializer:(0,s.zo)(this.gammaInitializer),betaRegularizer:(0,c.R9)(this.betaRegularizer),gammaRegularizer:(0,c.R9)(this.gammaRegularizer)},e=super.getConfig();return Object.assign(t,e),t}}g.className="LayerNormalization",r.serialization.registerClass(g)},13884:(t,e,n)=>{"use strict";n.d(e,{Ol:()=>c});var r=n(37837),i=n(71344),a=n(51544),o=n(5351),s=n(62755);class c extends a.Wd{constructor(t){if(null==t&&(t={}),super(t),this.dataFormat=null==t.dataFormat?(0,i.VI)():t.dataFormat,null==t.padding)this.padding=[[1,1],[1,1]];else if("number"===typeof t.padding)this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,2!==t.padding.length)throw new o.Qp("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(t.padding.length," array."));let e,n;if("number"===typeof t.padding[0])e=[t.padding[0],t.padding[0]],n=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,2!==t.padding[0].length)throw new o.Qp("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(t.padding[0].length," array."));if(e=t.padding[0],2!==t.padding[1].length)throw new o.Qp("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(t.padding[1].length," array."));n=t.padding[1]}this.padding=[e,n]}this.inputSpec=[new a.eO({ndim:4})]}computeOutputShape(t){let e,n;return t=(0,s.U$)(t),"channelsFirst"===this.dataFormat?(e=null!=t[2]&&t[2]>=0?t[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[3]&&t[3]>=0?t[3]+this.padding[1][0]+this.padding[1][1]:null,[t[0],t[1],e,n]):(e=null!=t[1]&&t[1]>=0?t[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[2]&&t[2]>=0?t[2]+this.padding[1][0]+this.padding[1][1]:null,[t[0],e,n,t[3]])}call(t,e){return(0,r.tidy)((()=>{return e=(0,s.un)(t),n=this.padding,a=this.dataFormat,(0,r.tidy)((()=>{if(4!==e.rank)throw new o.Qp("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(e.rank,"-D tensor."));if(null==n&&(n=[[1,1],[1,1]]),2!==n.length||2!==n[0].length||2!==n[1].length)throw new o.Qp("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==a&&(a=(0,i.VI)()),"channelsLast"!==a&&"channelsFirst"!==a)throw new o.Qp("Unknown data format: ".concat(a,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");let t;return t="channelsFirst"===a?[[0,0],[0,0],n[0],n[1]]:[[0,0],n[0],n[1],[0,0]],r.pad(e,t)}));var e,n,a}))}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}c.className="ZeroPadding2D",r.serialization.registerClass(c)},50771:(t,e,n)=>{"use strict";n.d(e,{$t:()=>_,Gk:()=>m,JJ:()=>S,Mg:()=>k,OA:()=>N,TG:()=>v,XC:()=>T,_M:()=>C,kd:()=>x,nO:()=>b});var r=n(37837),i=n(71344),a=n(36043),o=n(32381),s=n(51544),c=n(5351),u=n(30130),l=n(50531),h=n(62755),d=n(91566);function f(t,e,n,a,s,c){return(0,r.tidy)((()=>{let u;(0,o.uM)(s),(0,o.Kx)(c),(0,o.tB)(a),null==n&&(n=[1,1]),null==a&&(a="valid"),null==s&&(s=(0,i.VI)()),null==c&&(c="max"),t=(0,d.RK)(t,s);const l="same"===a?"same":"valid";return u="max"===c?r.maxPool(t,e,n,l):r.avgPool(t,e,n,l),"channelsFirst"===s&&(u=r.transpose(u,[0,3,1,2])),u}))}function p(t,e,n,a,s,c){return(0,r.tidy)((()=>{let u;(0,o.uM)(s),(0,o.Kx)(c),(0,o.tB)(a),null==n&&(n=[1,1,1]),null==a&&(a="valid"),null==s&&(s=(0,i.VI)()),null==c&&(c="max"),t=(0,d.al)(t,s);const l="same"===a?"same":"valid";return u="max"===c?r.maxPool3d(t,e,n,l):r.avgPool3d(t,e,n,l),"channelsFirst"===s&&(u=r.transpose(u,[0,4,1,2,3])),u}))}class g extends s.Wd{constructor(t){if(null==t.poolSize&&(t.poolSize=2),super(t),"number"===typeof t.poolSize)this.poolSize=[t.poolSize];else{if(!Array.isArray(t.poolSize)||1!==t.poolSize.length||"number"!==typeof t.poolSize[0])throw new c.Qp("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(t.poolSize)));this.poolSize=t.poolSize}if((0,l.oo)(this.poolSize,"poolSize"),null==t.strides)this.strides=this.poolSize;else if("number"===typeof t.strides)this.strides=[t.strides];else{if(!Array.isArray(t.strides)||1!==t.strides.length||"number"!==typeof t.strides[0])throw new c.Qp("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(t.strides)));this.strides=t.strides}(0,l.oo)(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,(0,o.tB)(this.padding),this.inputSpec=[new s.eO({ndim:3})]}computeOutputShape(t){t=(0,h.U$)(t);const e=(0,u.Ol)(t[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]}call(t,e){return(0,r.tidy)((()=>{this.invokeCallHook(t,e),t=a.UG((0,h.un)(t),2);const n=this.poolingFunction((0,h.un)(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return r.squeeze(n,[2])}))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},e=super.getConfig();return Object.assign(t,e),t}}class m extends g{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return(0,o.uM)(i),(0,o.tB)(r),f(t,e,n,r,i,"max")}}m.className="MaxPooling1D",r.serialization.registerClass(m);class v extends g{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return(0,o.uM)(i),(0,o.tB)(r),f(t,e,n,r,i,"avg")}}v.className="AveragePooling1D",r.serialization.registerClass(v);class y extends s.Wd{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(2!==t.strides.length)throw new c.Qp("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(t.strides.length,"."));this.strides=t.strides}else this.strides=[t.strides,t.strides];(0,l.oo)(this.poolSize,"poolSize"),(0,l.oo)(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,(0,o.uM)(this.dataFormat),(0,o.tB)(this.padding),this.inputSpec=[new s.eO({ndim:4})]}computeOutputShape(t){t=(0,h.U$)(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2];return e=(0,u.Ol)(e,this.poolSize[0],this.padding,this.strides[0]),n=(0,u.Ol)(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n]:[t[0],e,n,t[3]]}call(t,e){return(0,r.tidy)((()=>(this.invokeCallHook(t,e),this.poolingFunction((0,h.un)(t),this.poolSize,this.strides,this.padding,this.dataFormat))))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class b extends y{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return(0,o.uM)(i),(0,o.tB)(r),f(t,e,n,r,i,"max")}}b.className="MaxPooling2D",r.serialization.registerClass(b);class x extends y{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return(0,o.uM)(i),(0,o.tB)(r),f(t,e,n,r,i,"avg")}}x.className="AveragePooling2D",r.serialization.registerClass(x);class w extends s.Wd{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(3!==t.strides.length)throw new c.Qp("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(t.strides.length,"."));this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];(0,l.oo)(this.poolSize,"poolSize"),(0,l.oo)(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,(0,o.uM)(this.dataFormat),(0,o.tB)(this.padding),this.inputSpec=[new s.eO({ndim:5})]}computeOutputShape(t){t=(0,h.U$)(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[4]:t[3];return e=(0,u.Ol)(e,this.poolSize[0],this.padding,this.strides[0]),n=(0,u.Ol)(n,this.poolSize[1],this.padding,this.strides[1]),r=(0,u.Ol)(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n,r]:[t[0],e,n,r,t[4]]}call(t,e){return(0,r.tidy)((()=>(this.invokeCallHook(t,e),this.poolingFunction((0,h.un)(t),this.poolSize,this.strides,this.padding,this.dataFormat))))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class k extends w{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return(0,o.uM)(i),(0,o.tB)(r),p(t,e,n,r,i,"max")}}k.className="MaxPooling3D",r.serialization.registerClass(k);class _ extends w{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return(0,o.uM)(i),(0,o.tB)(r),p(t,e,n,r,i,"avg")}}_.className="AveragePooling3D",r.serialization.registerClass(_);class A extends s.Wd{constructor(t){super(t),this.inputSpec=[new s.eO({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,e){throw new c.EH}}class C extends A{constructor(t){super(t||{})}call(t,e){return(0,r.tidy)((()=>{const e=(0,h.un)(t);return r.mean(e,1)}))}}C.className="GlobalAveragePooling1D",r.serialization.registerClass(C);class S extends A{constructor(t){super(t||{})}call(t,e){return(0,r.tidy)((()=>{const e=(0,h.un)(t);return r.max(e,1)}))}}S.className="GlobalMaxPooling1D",r.serialization.registerClass(S);class E extends s.Wd{constructor(t){super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,(0,o.uM)(this.dataFormat),this.inputSpec=[new s.eO({ndim:4})]}computeOutputShape(t){return"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]}call(t,e){throw new c.EH}getConfig(){const t={dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class T extends E{call(t,e){return(0,r.tidy)((()=>{const e=(0,h.un)(t);return"channelsLast"===this.dataFormat?r.mean(e,[1,2]):r.mean(e,[2,3])}))}}T.className="GlobalAveragePooling2D",r.serialization.registerClass(T);class N extends E{call(t,e){return(0,r.tidy)((()=>{const e=(0,h.un)(t);return"channelsLast"===this.dataFormat?r.max(e,[1,2]):r.max(e,[2,3])}))}}N.className="GlobalMaxPooling2D",r.serialization.registerClass(N)},81916:(t,e,n)=>{"use strict";n.d(e,{c:()=>u});var r=n(51544),i=n(37837),a=n(62755),o=n(5351),s=n(36043),c=n(24436);class u extends r.Wd{constructor(t){super(t),this.numTokens=t.numTokens,t.outputMode?this.outputMode=t.outputMode:this.outputMode="multiHot"}getConfig(){const t={numTokens:this.numTokens,outputMode:this.outputMode},e=super.getConfig();return Object.assign(t,e),t}computeOutputShape(t){return null==(t=(0,a.U$)(t))?[this.numTokens]:"oneHot"===this.outputMode&&1!==t[t.length-1]?(t.push(this.numTokens),t):(t[t.length-1]=this.numTokens,t)}call(t,e){return(0,i.tidy)((()=>{let n;if("int32"!==(t=(0,a.un)(t)).dtype&&(t=s.wg(t,"int32")),"undefined"!==typeof e.countWeights){if("count"!==this.outputMode)throw new o.Qp("countWeights is not used when outputMode !== count.\n              Received countWeights=".concat(e.countWeights));n=(0,a.un)(e.countWeights)}const r=(0,i.max)(t),u=(0,i.min)(t),l=(0,i.greater)(this.numTokens,r).bufferSync().get(0),h=(0,i.greaterEqual)(u,0).bufferSync().get(0);if(!l||!h)throw new o.Qp("Input values must be between 0 < values <="+" numTokens with numTokens=".concat(this.numTokens));return c.w(t,this.outputMode,this.numTokens,n)}))}}u.className="CategoryEncoding",i.serialization.registerClass(u)},97724:(t,e,n)=>{"use strict";n.d(e,{u:()=>u});var r=n(37837),i=n(62755),a=n(51544),o=n(36043);const{resizeBilinear:s,cropAndResize:c}=r.image;class u extends a.Wd{constructor(t){super(t),this.height=t.height,this.width=t.width}centerCrop(t,e,n,a,s,u,l,h){return(0,r.tidy)((()=>{let d,f=!1;const p=[e/u,n/l,(a+e)/u,(s+n)/l],g=[];3===t.rank?(f=!0,d=(0,r.stack)([t])):d=t;for(let t=0;t<d.shape[0];t++)g.push(p);const m=(0,r.tensor)(g,[g.length,4]),v=(0,r.range)(0,g.length,1,"int32"),y=c(d,m,v,[a,s],"nearest");return f?o.wg((0,i.un)((0,r.unstack)(y)),h):o.wg(y,h)}))}upsize(t,e,n,i){return(0,r.tidy)((()=>{const r=s(t,[e,n]);return o.wg(r,i)}))}call(t,e){return(0,r.tidy)((()=>{const e=(0,i.un)(t),n=e.dtype,r=e.shape,a=r[r.length-3],o=r[r.length-2];let s=0;a!==this.height&&(s=Math.floor((a-this.height)/2));let c=0;return o!==this.width&&(c=Math.floor((o-this.width)/2),0===c&&(c=1)),s>=0&&c>=0?this.centerCrop(e,s,c,this.height,this.width,a,o,n):this.upsize(t,this.height,this.width,n)}))}getConfig(){const t={height:this.height,width:this.width},e=super.getConfig();return Object.assign(t,e),t}computeOutputShape(t){const e=(t=(0,i.U$)(t)).length-3,n=t.length-2;return t[e]=this.height,t[n]=this.width,t}}u.className="CenterCrop",r.serialization.registerClass(u)},20316:(t,e,n)=>{"use strict";n.d(e,{p:()=>s});var r=n(51544),i=n(37837),a=n(62755),o=n(36043);class s extends r.Wd{constructor(t){super(t),this.scale=t.scale,t.offset?this.offset=t.offset:this.offset=0}getConfig(){const t={scale:this.scale,offset:this.offset},e=super.getConfig();return Object.assign(t,e),t}call(t,e){return(0,i.tidy)((()=>("float32"!==(t=(0,a.un)(t)).dtype&&(t=o.wg(t,"float32")),(0,i.add)((0,i.mul)(t,this.scale),this.offset))))}}s.className="Rescaling",i.serialization.registerClass(s)},28859:(t,e,n)=>{"use strict";n.d(e,{a:()=>c});var r=n(37837),i=n(51544),a=n(5351),o=n(62755);const s=new Set(["bilinear","nearest"]);class c extends i.Wd{constructor(t){if(super(t),this.height=t.height,this.width=t.width,t.interpolation){if(!s.has(t.interpolation))throw new a.Qp("Invalid interpolation parameter: ".concat(t.interpolation," is not implemented"));this.interpolation=t.interpolation}else this.interpolation="bilinear";this.cropToAspectRatio=Boolean(t.cropToAspectRatio)}computeOutputShape(t){const e=(t=(0,o.U$)(t))[2];return[this.height,this.width,e]}getConfig(){const t={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},e=super.getConfig();return Object.assign(t,e),t}call(t,e){return(0,r.tidy)((()=>{const e=[this.height,this.width];if("bilinear"===this.interpolation)return r.image.resizeBilinear(t,e,!this.cropToAspectRatio);if("nearest"===this.interpolation)return r.image.resizeNearestNeighbor(t,e,!this.cropToAspectRatio);throw new Error("Interpolation is ".concat(this.interpolation," but only ").concat([...s]," are supported"))}))}}c.className="Resizing",r.serialization.registerClass(c)},24436:(t,e,n)=>{"use strict";n.d(e,{w:()=>s});var r=n(37837),i=n(62755),a=n(5351),o=n(36043);function s(t,e,n,s){let c=(0,i.un)(t);if("int32"!==c.dtype&&(c=o.wg(c,"int32")),"int"===e)return c;const u=c.shape;if(0===c.rank&&(c=(0,r.expandDims)(c,-1)),"oneHot"===e&&1!==c.shape[c.shape.length-1]&&(c=(0,r.expandDims)(c,-1)),c.rank>2)throw new a.Qp("When outputMode is not int, maximum output rank is 2"+" Received outputMode ".concat(e," and input shape ").concat(u)+" which would result in output rank ".concat(c.rank,"."));const l=["multiHot","oneHot"].includes(e),h=c;let d;if(d="undefined"!==typeof s&&"count"===e?(0,r.denseBincount)(h,s,n,l):(0,r.denseBincount)(h,[],n,l),"tfIdf"!==e)return d;if(s)return(0,r.mul)(d,s);throw new a.Qp("When outputMode is 'tfIdf', weights must be provided.")}},22862:(t,e,n)=>{"use strict";n.d(e,{q:()=>c});var r=n(37837),i=n(62755),a=n(5351),o=n(13010);const s=new Set(["bilinear","nearest"]);class c extends o.W{constructor(t){super(t);const{factor:e,interpolation:n="bilinear"}=t;if(this.factor=e,Array.isArray(this.factor)&&2===this.factor.length)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else{if(Array.isArray(this.factor)||!(this.factor>0))throw new a.Qp("Invalid factor: ".concat(this.factor,". Must be positive number or tuple of 2 numbers"));this.widthLower=-this.factor,this.widthUpper=this.factor}if(this.widthLower<-1||this.widthUpper<-1)throw new a.Qp("factor must have values larger than -1. Got: ".concat(this.factor));if(this.widthUpper<this.widthLower)throw new a.Qp("factor cannot have upper bound less than lower bound.\n        Got upper bound: ".concat(this.widthUpper,".\n        Got lower bound: ").concat(this.widthLower,"\n      "));if(n){if(!s.has(n))throw new a.Qp("Invalid interpolation parameter: ".concat(n," is not implemented"));this.interpolation=n}}getConfig(){const t={factor:this.factor,interpolation:this.interpolation},e=super.getConfig();return Object.assign(t,e),t}computeOutputShape(t){const e=(t=(0,i.U$)(t))[2];return[this.imgHeight,-1,e]}call(t,e){return(0,r.tidy)((()=>{const e=(0,i.un)(t);this.imgHeight=e.shape[e.shape.length-3];const n=e.shape[e.shape.length-2];this.widthFactor=(0,r.randomUniform)([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let a=this.widthFactor.dataSync()[0]*n;a=Math.round(a);const o=[this.imgHeight,a];switch(this.interpolation){case"bilinear":return r.image.resizeBilinear(t,o);case"nearest":return r.image.resizeNearestNeighbor(t,o);default:throw new Error("Interpolation is ".concat(this.interpolation,"\n          but only ").concat([...s]," are supported"))}}))}}c.className="RandomWidth",r.serialization.registerClass(c)},58715:(t,e,n)=>{"use strict";n.d(e,{B7:()=>k,FB:()=>S,FW:()=>T,JU:()=>E,L7:()=>y,RL:()=>w,T_:()=>A,Tu:()=>C,VS:()=>b,pz:()=>_,tL:()=>v,vR:()=>x});var r=n(37837),i=n(97607),a=n(36043),o=n(32381),s=n(5874),c=n(51544),u=n(5351),l=n(56817),h=n(16613),d=n(50531),f=n(11690),p=n(62755),g=n(1947),m=n(5877);function v(t,e,n,r){if(Array.isArray(t)){if(null!=e||null!=n)throw new u.Qp("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function i(t){return null==t||Array.isArray(t)?t:[t]}return{inputs:t,initialState:e=i(e),constants:n=i(n)}}function y(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return r.tidy((()=>{const l=e.shape.length;if(l<3)throw new u.Qp("Input should be at least 3D, but is ".concat(l,"D."));const h=[1,0].concat(f.y1(2,l));if(e=r.transpose(e,h),null!=o)throw new u.EH("The rnn() functoin of the deeplearn.js backend does not support constants yet.");s&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=a&&(a=r.cast(r.cast(a,"bool"),"float32"),a.rank===l-1&&(a=r.expandDims(a,-1)),a=r.transpose(a,h)),i&&(e=r.reverse(e,0),null!=a&&(a=r.reverse(a,0)));const d=[];let p,g=n;const m=e.shape[0],v=r.unstack(e);let y,b;null!=a&&(y=r.unstack(a));for(let e=0;e<m;++e){const n=v[e],i=r.tidy((()=>t(n,g)));if(null==a)p=i[0],g=i[1];else{const t=r.tidy((()=>{const t=y[e],n=r.sub(r.onesLike(t),t);return{output:r.add(r.mul(i[0],t),r.mul(g[0],n)),newStates:g.map(((e,a)=>r.add(r.mul(i[1][a],t),r.mul(e,n))))}}));p=t.output,g=t.newStates}c&&d.push(p)}if(c){const t=1;b=r.stack(d,t)}return[p,b,g]}))}class b extends c.Wd{constructor(t){let e;if(super(t),null==t.cell)throw new u.Qp("cell property is missing for the constructor of RNN.");if(e=Array.isArray(t.cell)?new E({cells:t.cell}):t.cell,null==e.stateSize)throw new u.Qp("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=e,this.returnSequences=null!=t.returnSequences&&t.returnSequences,this.returnState=null!=t.returnState&&t.returnState,this.goBackwards=null!=t.goBackwards&&t.goBackwards,this._stateful=null!=t.stateful&&t.stateful,this.unroll=null!=t.unroll&&t.unroll,this.supportsMasking=!0,this.inputSpec=[new c.eO({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(null==this.states_){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return f.y1(0,t).map((t=>null))}return this.states_}setStates(t){this.states_=t}computeOutputShape(t){(0,p.TT)(t)&&(t=t[0]);let e=this.cell.stateSize;Array.isArray(e)||(e=[e]);const n=e[0];let r;if(r=this.returnSequences?[t[0],t[1],n]:[t[0],n],this.returnState){const n=[];for(const r of e)n.push([t[0],r]);return[r].concat(n)}return r}computeMask(t,e){return r.tidy((()=>{Array.isArray(e)&&(e=e[0]);const t=this.returnSequences?e:null;if(this.returnState){const e=this.states.map((t=>null));return[t].concat(e)}return t}))}get states(){if(null==this.states_){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,e=[];for(let n=0;n<t;++n)e.push(null);return e}return this.states_}set states(t){this.states_=t}build(t){if(null!=this.numConstants)throw new u.EH("Constants support is not implemented in RNN yet.");(0,p.TT)(t)&&(t=t[0]);const e=this.stateful?t[0]:null,n=t.slice(2);this.inputSpec[0]=new c.eO({shape:[e,null,...n]});const i=[t[0]].concat(t.slice(2));let a;if(this.cell.build(i),a=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!r.util.arraysEqual(this.stateSpec.map((t=>t.shape[t.shape.length-1])),a))throw new u.Qp("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=a.map((t=>new c.eO({shape:[null,t]})));this.stateful&&this.resetStates()}resetStates(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,r.tidy)((()=>{if(!this.stateful)throw new u.l7("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape[0];if(null==n)throw new u.Qp("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((t=>r.zeros([n,t]))):this.states_=[r.zeros([n,this.cell.stateSize])];else if(null==t)r.dispose(this.states_),null!=this.keptStates&&(r.dispose(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((t=>r.zeros([n,t]))):this.states_[0]=r.zeros([n,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new u.Qp("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), ")+"but it received ".concat(t.length," state value(s). Input ")+"received: ".concat(t));!0===e?this.keptStates.push(this.states_.slice()):r.dispose(this.states_);for(let e=0;e<this.states_.length;++e){const i=t[e],a=Array.isArray(this.cell.stateSize)?this.cell.stateSize[e]:this.cell.stateSize,o=[n,a];if(!r.util.arraysEqual(i.shape,o))throw new u.Qp("State ".concat(e," is incompatible with layer ").concat(this.name,": ")+"expected shape=".concat(o,", received shape=").concat(i.shape));this.states_[e]=i}}this.states_=this.states_.map((t=>r.keep(t.clone())))}))}apply(t,e){let n=null==e?null:e.initialState,r=null==e?null:e.constants;null==e&&(e={});const i=v(t,n,r,this.numConstants);t=i.inputs,n=i.initialState,r=i.constants;let a=[],o=[];if(null!=n){e.initialState=n,a=a.concat(n),this.stateSpec=[];for(const t of n)this.stateSpec.push(new c.eO({shape:t.shape}));o=o.concat(this.stateSpec)}null!=r&&(e.constants=r,a=a.concat(r),this.numConstants=r.length);if(a[0]instanceof c.Ar){const n=[t].concat(a),r=this.inputSpec.concat(o),i=this.inputSpec;this.inputSpec=r;const s=super.apply(n,e);return this.inputSpec=i,s}return super.apply(t,e)}call(t,e){return(0,r.tidy)((()=>{const n=null==e?null:e.mask,r=null==e?null:e.training;let i=null==e?null:e.initialState;t=(0,p.un)(t),null==i&&(i=this.stateful?this.states_:this.getInitialState(t));const a=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==a)throw new u.Qp("RNN Layer has ".concat(a," state(s) but was passed ")+"".concat(i.length," initial state(s)."));this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:r},s=y(((t,e)=>{const n=this.cell.call([t].concat(e),o);return[n[0],n.slice(1)]}),t,i,this.goBackwards,n,null,this.unroll,this.returnSequences),c=s[0],l=s[1],h=s[2];this.stateful&&this.resetStates(h,r);const d=this.returnSequences?l:c;return this.returnState?[d].concat(h):d}))}getInitialState(t){return(0,r.tidy)((()=>{let e=r.zeros(t.shape);return e=r.sum(e,[1,2]),e=a.UG(e),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map((t=>t>1?a.Vs(e,[1,t]):e)):this.cell.stateSize>1?[a.Vs(e,[1,this.cell.stateSize])]:[e]}))}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t=super.getConfig(),e={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(e.numConstants=this.numConstants);const n=this.cell.getConfig();return this.getClassName()===b.className&&(e.cell={className:this.cell.getClassName(),config:n}),Object.assign(Object.assign(Object.assign({},n),t),e)}static fromConfig(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=e.cell,i=(0,m.i)(r,n);return new t(Object.assign(e,{cell:i}))}}b.className="RNN",r.serialization.registerClass(b);class x extends c.Wd{}class w extends x{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,(0,d.oo)(this.units,"units"),this.activation=(0,i.b_)(null==t.activation?this.DEFAULT_ACTIVATION:t.activation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=(0,l.Fe)(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=(0,l.Fe)(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=(0,l.Fe)(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=(0,h.Bm)(t.kernelRegularizer),this.recurrentRegularizer=(0,h.Bm)(t.recurrentRegularizer),this.biasRegularizer=(0,h.Bm)(t.biasRegularizer),this.kernelConstraint=(0,s.YZ)(t.kernelConstraint),this.recurrentConstraint=(0,s.YZ)(t.recurrentConstraint),this.biasConstraint=(0,s.YZ)(t.biasConstraint),this.dropout=f.jk([1,f.T9([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=f.jk([1,f.T9([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=(0,p.U$)(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return(0,r.tidy)((()=>{if(2!==t.length)throw new u.Qp("SimpleRNNCell expects 2 input Tensors, got ".concat(t.length,"."));let n=t[1];t=t[0];const i=null!=e.training&&e.training;let o;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=T({ones:()=>r.onesLike(t),rate:this.dropout,training:i,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=T({ones:()=>r.onesLike(n),rate:this.recurrentDropout,training:i,dropoutFunc:this.dropoutFunc}));const s=this.dropoutMask,c=this.recurrentDropoutMask;o=null!=s?a.Om(r.mul(t,s),this.kernel.read()):a.Om(t,this.kernel.read()),null!=this.bias&&(o=a.ni(o,this.bias.read())),null!=c&&(n=r.mul(n,c));let l=r.add(o,a.Om(n,this.recurrentKernel.read()));return null!=this.activation&&(l=this.activation.apply(l)),[l,l]}))}getConfig(){const t=super.getConfig(),e={units:this.units,activation:(0,i.Bu)(this.activation),useBias:this.useBias,kernelInitializer:(0,l.zo)(this.kernelInitializer),recurrentInitializer:(0,l.zo)(this.recurrentInitializer),biasInitializer:(0,l.zo)(this.biasInitializer),kernelRegularizer:(0,h.R9)(this.kernelRegularizer),recurrentRegularizer:(0,h.R9)(this.recurrentRegularizer),biasRegularizer:(0,h.R9)(this.biasRegularizer),activityRegularizer:(0,h.R9)(this.activityRegularizer),kernelConstraint:(0,s.uH)(this.kernelConstraint),recurrentConstraint:(0,s.uH)(this.recurrentConstraint),biasConstraint:(0,s.uH)(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},t),e)}}w.className="SimpleRNNCell",r.serialization.registerClass(w);class k extends b{constructor(t){t.cell=new w(t),super(t)}call(t,e){return(0,r.tidy)((()=>{null!=this.cell.dropoutMask&&(r.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(r.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e.mask,i=null==e?null:e.training,a=null==e?null:e.initialState;return super.call(t,{mask:n,training:i,initialState:a})}))}static fromConfig(t,e){return new t(e)}}k.className="SimpleRNN",r.serialization.registerClass(k);class _ extends x{constructor(t){if(super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new u.Qp("GRUCell does not support reset_after parameter set to true.");this.units=t.units,(0,d.oo)(this.units,"units"),this.activation=(0,i.b_)(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=(0,i.b_)(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=(0,l.Fe)(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=(0,l.Fe)(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=(0,l.Fe)(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=(0,h.Bm)(t.kernelRegularizer),this.recurrentRegularizer=(0,h.Bm)(t.recurrentRegularizer),this.biasRegularizer=(0,h.Bm)(t.biasRegularizer),this.kernelConstraint=(0,s.YZ)(t.kernelConstraint),this.recurrentConstraint=(0,s.YZ)(t.recurrentConstraint),this.biasConstraint=(0,s.YZ)(t.biasConstraint),this.dropout=f.jk([1,f.T9([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=f.jk([1,f.T9([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){const e=(t=(0,p.U$)(t))[t.length-1];this.kernel=this.addWeight("kernel",[e,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return(0,r.tidy)((()=>{if(2!==t.length)throw new u.Qp("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(t.length,"."));const n=null!=e.training&&e.training;let i=t[1];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=T({ones:()=>r.onesLike(t),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=T({ones:()=>r.onesLike(i),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,s=this.recurrentDropoutMask;let c,l,h;0<this.dropout&&this.dropout<1&&(t=r.mul(t,o[0]));let d=a.Om(t,this.kernel.read());this.useBias&&(d=a.ni(d,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(i=r.mul(i,s[0]));const f=this.recurrentKernel.read(),[p,g]=r.split(f,[2*this.units,this.units],f.rank-1),m=a.Om(i,p),[v,y,b]=r.split(d,3,d.rank-1),[x,w]=r.split(m,2,m.rank-1);c=this.recurrentActivation.apply(r.add(v,x)),l=this.recurrentActivation.apply(r.add(y,w));const k=a.Om(r.mul(l,i),g);h=this.activation.apply(r.add(b,k));const _=r.add(r.mul(c,i),r.mul(r.add(1,r.neg(c)),h));return[_,_]}))}getConfig(){const t=super.getConfig(),e={units:this.units,activation:(0,i.Bu)(this.activation),recurrentActivation:(0,i.Bu)(this.recurrentActivation),useBias:this.useBias,kernelInitializer:(0,l.zo)(this.kernelInitializer),recurrentInitializer:(0,l.zo)(this.recurrentInitializer),biasInitializer:(0,l.zo)(this.biasInitializer),kernelRegularizer:(0,h.R9)(this.kernelRegularizer),recurrentRegularizer:(0,h.R9)(this.recurrentRegularizer),biasRegularizer:(0,h.R9)(this.biasRegularizer),activityRegularizer:(0,h.R9)(this.activityRegularizer),kernelConstraint:(0,s.uH)(this.kernelConstraint),recurrentConstraint:(0,s.uH)(this.recurrentConstraint),biasConstraint:(0,s.uH)(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},t),e)}}_.className="GRUCell",r.serialization.registerClass(_);class A extends b{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new _(t),super(t)}call(t,e){return(0,r.tidy)((()=>{null!=this.cell.dropoutMask&&(r.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(r.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e.mask,i=null==e?null:e.training,a=null==e?null:e.initialState;return super.call(t,{mask:n,training:i,initialState:a})}))}static fromConfig(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)}}A.className="GRU",r.serialization.registerClass(A);class C extends x{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,(0,d.oo)(this.units,"units"),this.activation=(0,i.b_)(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=(0,i.b_)(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=(0,l.Fe)(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=(0,l.Fe)(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=(0,l.Fe)(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=(0,h.Bm)(t.kernelRegularizer),this.recurrentRegularizer=(0,h.Bm)(t.recurrentRegularizer),this.biasRegularizer=(0,h.Bm)(t.biasRegularizer),this.kernelConstraint=(0,s.YZ)(t.kernelConstraint),this.recurrentConstraint=(0,s.YZ)(t.recurrentConstraint),this.biasConstraint=(0,s.YZ)(t.biasConstraint),this.dropout=f.jk([1,f.T9([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=f.jk([1,f.T9([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var e;const n=(t=(0,p.U$)(t))[t.length-1];let r;if(this.kernel=this.addWeight("kernel",[n,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){const t=this.biasInitializer,n=this.units;r=new((e=class extends l.H4{apply(e,r){const i=t.apply([n]),o=(new l.sN).apply([n]),s=t.apply([2*n]);return a.ly(a.ly(i,o),s)}}).className="CustomInit",e)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,e){return(0,r.tidy)((()=>{const n=null!=e.training&&e.training;if(3!==t.length)throw new u.Qp("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(t.length,"."));let i=t[1];const o=t[2];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=T({ones:()=>r.onesLike(t),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=T({ones:()=>r.onesLike(i),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const s=this.dropoutMask,c=this.recurrentDropoutMask;let l,h,d,f;0<this.dropout&&this.dropout<1&&(t=r.mul(t,s[0]));let p=a.Om(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(i=r.mul(i,c[0])),p=r.add(p,a.Om(i,this.recurrentKernel.read())),this.useBias&&(p=a.ni(p,this.bias.read()));const[g,m,v,y]=r.split(p,4,p.rank-1);l=this.recurrentActivation.apply(g),h=this.recurrentActivation.apply(m),d=r.add(r.mul(h,o),r.mul(l,this.activation.apply(v))),f=this.recurrentActivation.apply(y);const b=r.mul(f,this.activation.apply(d));return[b,b,d]}))}getConfig(){const t=super.getConfig(),e={units:this.units,activation:(0,i.Bu)(this.activation),recurrentActivation:(0,i.Bu)(this.recurrentActivation),useBias:this.useBias,kernelInitializer:(0,l.zo)(this.kernelInitializer),recurrentInitializer:(0,l.zo)(this.recurrentInitializer),biasInitializer:(0,l.zo)(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:(0,h.R9)(this.kernelRegularizer),recurrentRegularizer:(0,h.R9)(this.recurrentRegularizer),biasRegularizer:(0,h.R9)(this.biasRegularizer),activityRegularizer:(0,h.R9)(this.activityRegularizer),kernelConstraint:(0,s.uH)(this.kernelConstraint),recurrentConstraint:(0,s.uH)(this.recurrentConstraint),biasConstraint:(0,s.uH)(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},t),e)}}C.className="LSTMCell",r.serialization.registerClass(C);class S extends b{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new C(t),super(t)}call(t,e){return(0,r.tidy)((()=>{null!=this.cell.dropoutMask&&(r.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(r.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e.mask,i=null==e?null:e.training,a=null==e?null:e.initialState;return super.call(t,{mask:n,training:i,initialState:a})}))}static fromConfig(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)}}S.className="LSTM",r.serialization.registerClass(S);class E extends x{constructor(t){super(t),this.cells=t.cells}get stateSize(){const t=[];for(const e of this.cells.slice().reverse())Array.isArray(e.stateSize)?t.push(...e.stateSize):t.push(e.stateSize);return t}call(t,e){return(0,r.tidy)((()=>{let n=t.slice(1);const r=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?r.push(n.splice(0,t.stateSize.length)):r.push(n.splice(0,1));r.reverse();const i=[];let a;for(let o=0;o<this.cells.length;++o){const s=this.cells[o];n=r[o],a=0===o?[t[0]].concat(n):[a[0]].concat(n),a=s.call(a,e),i.push(a.slice(1))}n=[];for(const t of i.slice().reverse())n.push(...t);return[a[0]].concat(n)}))}build(t){let e;(0,p.TT)(t)&&(t=t[0]),this.cells.forEach(((n,r)=>{(0,o.IU)("RNNCell_".concat(r),(()=>{n.build(t),e=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,t=[t[0],e]}))})),this.built=!0}getConfig(){const t=super.getConfig(),e={cells:this.cells.map((t=>({className:t.getClassName(),config:t.getConfig()})))};return Object.assign(Object.assign({},t),e)}static fromConfig(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=[];for(const i of e.cells)r.push((0,m.i)(i,n));return new t({cells:r})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const e of this.cells)t.push(...e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.cells)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e.concat(t)}return t}getWeights(){const t=[];for(const e of this.cells)t.push(...e.weights);return(0,g.ex)(t)}setWeights(t){const e=[];for(const n of this.cells){const r=n.weights.length,i=t.splice(r);for(let t=0;t<n.weights.length;++t)e.push([n.weights[t],i[t]])}(0,g.UM)(e)}}function T(t){const{ones:e,rate:n,training:i=!1,count:o=1,dropoutFunc:s}=t,c=()=>null!=s?s(e(),n):a.EZ(e(),n),u=()=>a.Ls(c,e,i);if(!o||o<=1)return r.keep(u().clone());return Array(o).fill(void 0).map(u).map((t=>r.keep(t.clone())))}E.className="StackedRNNCells",r.serialization.registerClass(E)},5877:(t,e,n)=>{"use strict";n.d(e,{i:()=>a});var r=n(37837),i=n(50531);function a(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,i.Xv)(t,r.serialization.SerializationMap.getMap().classNameMap,e,"layer",n)}},67329:(t,e,n)=>{"use strict";n.d(e,{V2:()=>p,ai:()=>g});var r=n(37837),i=n(36043),a=n(32381),o=n(51544),s=n(5351),c=n(1002),u=n(50531),l=n(62755),h=n(58715),d=n(5877);class f extends o.Wd{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(t){null!=this.layer&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},e=super.getConfig();return Object.assign(t,e),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=e.layer,i=(0,d.i)(r,n);delete e.layer;const a={layer:i};return Object.assign(a,e),new t(a)}}class p extends f{constructor(t){super(t),this.supportsMasking=!0}build(t){if((t=(0,l.U$)(t)).length<3)throw new s.Qp("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(t)));this.inputSpec=[{shape:t}];const e=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(e),this.layer.built=!0),super.build(t)}computeOutputShape(t){const e=[(t=(0,l.U$)(t))[0]].concat(t.slice(2)),n=this.layer.computeOutputShape(e),r=t[1];return[n[0],r].concat(n.slice(1))}call(t,e){return(0,r.tidy)((()=>{t=(0,l.un)(t);return(0,h.L7)(((t,n)=>[(0,l.un)(this.layer.call(t,e)),[]]),t,[],!1,null,null,!1,!0)[1]}))}}p.className="TimeDistributed",r.serialization.registerClass(p);class g extends f{constructor(t){super(t);const e=t.layer.getConfig(),n={};n.className=t.layer.getClassName(),n.config=e,this.forwardLayer=(0,d.i)(n),e.goBackwards=!0!==e.goBackwards;const r={};var i;if(r.className=t.layer.getClassName(),r.config=e,this.backwardLayer=(0,d.i)(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===t.mergeMode?"concat":t.mergeMode,i=this.mergeMode,u.E6(c.r$,"BidirectionalMergeMode",i),t.weights)throw new s.EH("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,null!=this.forwardLayer&&(this.forwardLayer.trainable=t),null!=this.backwardLayer&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const e=t.length,n=Math.floor(e/2);this.forwardLayer.setWeights(t.slice(0,n)),this.backwardLayer.setWeights(t.slice(n))}computeOutputShape(t){let e,n,r,i=this.forwardLayer.computeOutputShape(t);return Array.isArray(i)&&Array.isArray(i[0])||(i=[i]),this.returnState?(r=i.slice(1),e=i[0]):e=i[0],"concat"===this.mergeMode?(e[e.length-1]*=2,n=[e]):n=null==this.mergeMode?[e,e.slice()]:[e],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[e].concat(r).concat(r.slice()):u.wL(n)}apply(t,e){let n=null==e?null:e.initialState,r=null==e?null:e.constants;null==e&&(e={});const i=(0,h.tL)(t,n,r,this.numConstants);if(t=i.inputs,n=i.initialState,r=i.constants,Array.isArray(t)&&(n=t.slice(1),t=t[0]),(null==n||0===n.length)&&null==r)return super.apply(t,e);const a=[],c=[];if(null!=n){const t=n.length;if(t%2>0)throw new s.Qp("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");e.initialState=n,a.push(...n);const r=n.map((t=>new o.eO({shape:t.shape})));this.forwardLayer.stateSpec=r.slice(0,t/2),this.backwardLayer.stateSpec=r.slice(t/2),c.push(...r)}if(null!=r)throw new s.EH("Support for constants in Bidirectional layers is not implemented yet.");const u=a[0]instanceof o.Ar;for(const l of a)if(l instanceof o.Ar!==u)throw new s.Qp("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(u){const n=[t].concat(a),r=this.inputSpec.concat(c),i=this.inputSpec;this.inputSpec=r;const o=super.apply(n,e);return this.inputSpec=i,o}return super.apply(t,e)}call(t,e){return(0,r.tidy)((()=>{const n=e.initialState;let a,o,s,c;if(null==n)a=this.forwardLayer.call(t,e),o=this.backwardLayer.call(t,e);else{const r=n.slice(0,n.length/2),i=n.slice(n.length/2);a=this.forwardLayer.call(t,Object.assign(e,{initialState:r})),o=this.backwardLayer.call(t,Object.assign(e,{initialState:i}))}return this.returnState&&(Array.isArray(a)&&(s=a.slice(1).concat(o.slice(1))),a=a[0],o=o[0]),this.returnSequences&&(o=r.reverse(o,1)),"concat"===this.mergeMode?c=i.u1([a,o]):"sum"===this.mergeMode?c=r.add(a,o):"ave"===this.mergeMode?c=r.mul(.5,r.add(a,o)):"mul"===this.mergeMode?c=r.mul(a,o):null==this.mergeMode&&(c=[a,o]),this.returnState?null==this.mergeMode?c.concat(s):[c].concat(s):c}))}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){(0,a.IU)(this.forwardLayer.name,(()=>{this.forwardLayer.build(t)})),(0,a.IU)(this.backwardLayer.name,(()=>{this.backwardLayer.build(t)})),this.built=!0}computeMask(t,e){let n;if(Array.isArray(e)&&(e=e[0]),n=this.returnSequences?null==this.mergeMode?[e,e]:e:null==this.mergeMode?[null,null]:null,this.returnState){const t=this.forwardLayer.states.map((t=>null));return Array.isArray(n)?n.concat(t).concat(t):[n].concat(t).concat(t)}return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(t),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},e=super.getConfig();return Object.assign(t,e),t}static fromConfig(t,e){const n=(0,d.i)(e.layer);if(delete e.layer,null!=e.numConstants)throw new s.EH("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=e;return r.layer=n,new t(r)}}g.className="Bidirectional",r.serialization.registerClass(g)},38759:(t,e,n)=>{"use strict";n.d(e,{I:()=>i,i:()=>a});var r=n(37837);async function i(t){if(null==t)return;const e=[],n=[],i=[];for(const r in t){const a=t[r];if("number"!==typeof a){const t=a;e.push(t.data()),n.push(r),i.push(t)}}if(e.length>0){const a=await Promise.all(e);for(let e=0;e<a.length;++e)t[n[e]]=a[e][0];(0,r.dispose)(i)}}function a(t){if(null!=t)for(const e in t){const n=t[e];"number"!==typeof n&&n.dispose()}}},57463:(t,e,n)=>{"use strict";n.d(e,{Jc:()=>p,Jt:()=>y,Ol:()=>d,Pg:()=>m,SO:()=>v,VW:()=>l,Xv:()=>u,Yq:()=>s,bt:()=>c,qp:()=>f});var r=n(37837),i=n(71344),a=n(36043),o=n(5351);function s(t,e){return(0,r.tidy)((()=>{"float32"!==t.dtype&&(t=r.cast(t,"float32"));const n=r.sum(a.Ew(t),e,!0),o=r.fill(n.shape,(0,i.Ni)()),s=r.sqrt(r.maximum(n,o));return r.div(t,s)}))}function c(t,e){return(0,r.tidy)((()=>r.mean(a.Ew(r.sub(e,t)),-1)))}function u(t,e){return(0,r.tidy)((()=>r.mean(r.abs(r.sub(e,t)),-1)))}function l(t,e){return(0,r.tidy)((()=>{const n=r.sub(t,e),a=r.clipByValue(r.abs(t),(0,i.Ni)(),Number.MAX_VALUE),o=r.abs(r.div(n,a));return r.mul(100,r.mean(o,-1))}))}function h(t,e){return(0,r.tidy)((()=>{const n=r.clipByValue(e,(0,i.Ni)(),Number.MAX_VALUE),o=r.log(r.add(1,n)),s=r.clipByValue(t,(0,i.Ni)(),Number.MAX_VALUE),c=r.log(r.add(1,s));return r.mean(a.Ew(r.sub(o,c)),-1)}))}function d(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,r.tidy)((()=>{if(n)e=r.softmax(e);else{const t=r.sum(e,e.shape.length-1,!0);e=r.div(e,t)}return e=r.clipByValue(e,(0,i.Ni)(),1-(0,i.Ni)()),r.neg(r.sum(r.mul(r.cast(t,"float32"),r.log(e)),e.shape.length-1))}))}function f(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,r.tidy)((()=>{const o=r.cast(r.floor(a.Bq(t)),"int32"),s=(e=r.clipByValue(e,(0,i.Ni)(),1-(0,i.Ni)())).shape;return d(r.reshape(r.oneHot(o,s[s.length-1]),s),e,n)}))}function p(t,e){return(0,r.tidy)((()=>{let n;return n=r.clipByValue(e,(0,i.Ni)(),1-(0,i.Ni)()),n=r.log(r.div(n,r.sub(1,n))),r.mean(function(t,e){if(!r.util.arraysEqual(t.shape,e.shape))throw new o.Qp("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(t.shape)," and ").concat(JSON.stringify(e.shape)));return(0,r.tidy)((()=>{const n=r.relu(e),i=r.neg(r.abs(e));return r.add(r.sub(n,r.mul(e,t)),r.log1p(r.exp(i)))}))}(t,n),-1)}))}function g(t,e){return(0,r.tidy)((()=>{const n=r.clipByValue(t,(0,i.Ni)(),1),a=r.clipByValue(e,(0,i.Ni)(),1);return r.sum(r.mul(t,r.log(r.div(n,a))),-1)}))}function m(t,e){return(0,r.tidy)((()=>{const n=s(t,-1),i=s(e,-1),a=r.mul(n,i);return r.neg(r.sum(a,-1))}))}const v={meanSquaredError:c,meanAbsoluteError:u,meanAbsolutePercentageError:l,meanSquaredLogarithmicError:h,squaredHinge:function(t,e){return(0,r.tidy)((()=>{const n=r.maximum(0,r.sub(1,r.mul(t,e)));return r.mean(a.Ew(n),-1)}))},hinge:function(t,e){return(0,r.tidy)((()=>{const n=r.maximum(0,r.sub(1,r.mul(t,e)));return r.mean(n,-1)}))},categoricalHinge:function(t,e){return(0,r.tidy)((()=>{const n=r.sum(r.mul(t,e),-1),i=r.max(r.mul(r.sub(1,t),e),-1);return r.maximum(0,r.add(1,r.sub(i,n)))}))},logcosh:function(t,e){return(0,r.tidy)((()=>{const n=Math.log(2),i=r.sub(e,t),a=r.sub(r.add(i,r.softplus(r.mul(-2,i))),n);return r.mean(a,-1)}))},categoricalCrossentropy:d,sparseCategoricalCrossentropy:f,binaryCrossentropy:p,kullbackLeiblerDivergence:g,poisson:function(t,e){return(0,r.tidy)((()=>{const n=r.log(r.add((0,i.Ni)(),e));return r.mean(r.sub(e,r.mul(t,n)),-1)}))},cosineProximity:m};function y(t){if("string"===typeof t){if(t in v)return v[t];let e="Unknown loss ".concat(t);throw t.toLowerCase().includes("softmaxcrossentropy")&&(e="Unknown loss ".concat(t,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new o.Qp(e)}return t}},98219:(t,e,n)=>{"use strict";n.d(e,{GT:()=>A,Jc:()=>h,Jt:()=>_,Ol:()=>b,qp:()=>w,qv:()=>d,xM:()=>c,yP:()=>u});var r=n(37837),i=n(36043),a=n(5351),o=n(57463),s=n(50531);function c(t,e){return(0,r.tidy)((()=>{const n=r.mul(.5,r.onesLike(e)),a=i.wg(r.greater(e,n),t.dtype);return r.mean(r.equal(t,a),-1)}))}function u(t,e){return(0,r.tidy)((()=>i.wg(r.equal(r.argMax(t,-1),r.argMax(e,-1)),"float32")))}function l(t,e){return(0,r.tidy)((()=>r.cast(r.sum(r.logicalAnd(r.equal(t,1),r.equal(e,1))),"float32")))}function h(t,e){return(0,o.Jc)(t,e)}function d(t,e){return t.rank===e.rank&&(t=r.squeeze(t,[t.rank-1])),(e=r.argMax(e,-1)).dtype!==t.dtype&&(e=r.cast(e,t.dtype)),r.cast(r.equal(t,e),"float32")}const f=o.bt,p=o.bt,g=o.Xv,m=o.Xv,v=o.VW,y=o.VW,b=o.Ol,x=o.Pg,w=o.qp,k={binaryAccuracy:c,categoricalAccuracy:u,precision:function(t,e){return(0,r.tidy)((()=>{const n=l(t,e),i=function(t,e){return(0,r.tidy)((()=>r.cast(r.sum(r.logicalAnd(r.equal(t,0),r.equal(e,1))),"float32")))}(t,e),a=r.add(n,i);return r.cast(r.where(r.greater(a,0),r.div(n,a),0),"float32")}))},categoricalCrossentropy:b,sparseCategoricalCrossentropy:w,mse:f,MSE:p,mae:g,MAE:m,mape:v,MAPE:y,cosine:x};function _(t){if("string"===typeof t&&t in k)return k[t];if("string"!==typeof t&&null!=t)return t;throw new a.Qp("Unknown metric ".concat(t))}function A(t){if(s.vA(null!==t,"Unknown LossOrMetricFn ".concat(t)),"string"===typeof t)return t;{let e;for(const n of Object.keys(o.SO))if(o.SO[n]===t){e=n;break}if(void 0!==e)return e;for(const n of Object.keys(k))if(k[n]===t){e=n;break}return void 0!==e?e:t.name}}},31722:(t,e,n)=>{"use strict";n.d(e,{Gx:()=>p,O0:()=>f});var r=n(37837),i=n(76140),a=n(12335),o=n(51544),s=n(31483),c=n(5351),u=n(5877),l=n(50531),h=n(69834),d=n(62755);async function f(t,e){if(null==e&&(e={}),"string"===typeof t){const n=r.io.getLoadHandlers(t,e);if(0===n.length)n.push(r.io.browserHTTPRequest(t,e));else if(n.length>1)throw new c.Qp("Found more than one (".concat(n.length,") load handlers for ")+"URL '".concat(t,"'"));t=n[0]}return async function(t,e,n){null==n&&(n={});if(null==t.load)throw new c.Qp("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const i=await t.load();let a=i.modelTopology;null!=a.model_config&&(a=a.model_config);const o=null==n.strict||n.strict,s=null!=i.weightData&&null!=i.weightSpecs&&o,l=(0,u.i)((0,h.w)(a),e,s),d=i.trainingConfig;null!=d&&l.loadTrainingConfig(d);null!=i.userDefinedMetadata&&l.setUserDefinedMetadata(i.userDefinedMetadata);if(null!=i.weightData){if(null==i.weightSpecs)throw new c.Qp("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:t,optimizerWeights:e}=function(t,e){const n=r.io.decodeWeights(t,e),i={},a=[];return e.forEach((t=>{"optimizer"===t.group?a.push({name:t.name,tensor:n[t.name]}):i[t.name]=n[t.name]})),{modelWeights:i,optimizerWeights:a}}(i.weightData,i.weightSpecs);l.loadWeights(t,o),null!=l.optimizer&&e.length>0&&await l.optimizer.setWeights(e),(0,r.dispose)(t),(0,r.dispose)(e.map((t=>t.tensor)))}return l}(t,void 0,e)}class p extends s.Gw{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=null!=t.name?t.name:(0,i.v)("sequential_"),null!=t.layers)for(const e of t.layers)this.add(e)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some((t=>t<0)))throw new c.Qp("Negative dimension size caused by adding layer "+"".concat(t.name," with input shape [")+"".concat(t.inboundNodes[0].inputTensors[0].shape,"]"))}add(t){const e=t instanceof p||t instanceof s.Gw;let n;if(e){if(n=t,1!==n.outputs.length)throw new c.Qp("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new c.Qp("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===t.inboundNodes.length){if(null==t.batchInputShape)throw new c.Qp("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const e=(0,a.p)({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(e)}if(e)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==t.inboundNodes.length)throw new c.Qp("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(t.name," ")+"which has ".concat(t.inboundNodes.length," pre-existing inbound ")+"connections.");if(1!==t.inboundNodes[0].outputTensors.length)throw new c.Qp("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=(0,o.X6)(this.outputs[0])}this.inboundNodes=[],new o.bP({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:l.fD(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((t=>t.shape)),outputShapes:this.outputs[0].shape})}else{const e=t.apply(this.outputs[0]);if(Array.isArray(e))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[e],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,e){return null==this.model&&this.build(),this.model.call(t,e)}build(t){if((0,d.U$)(t),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new s.Gw({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),super.summary(t,e,n)}setWeights(t){null==this.model&&this.build(),this.model.setWeights(t)}evaluate(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new c.bu("The model needs to be compiled before being used.");return this.model.evaluate(t,e,n)}async evaluateDataset(t,e){if(!this.built)throw new c.bu("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,e)}predict(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(t,e)}predictOnBatch(t){return null==this.model&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new c.bu("The model needs to be compiled before being used.");return this.model.fit(t,e,n)}async fitDataset(t,e){if(!this.built)throw new c.bu("The model needs to be compiled before being used.");return this.model.fitDataset(t,e)}async trainOnBatch(t,e){return this.model.trainOnBatch(t,e)}static fromConfig(t,e){let n,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={};if(e instanceof Array){if(null==e[0].className||"Merge"===e[0].className)throw new c.Qp("Legacy serialization format not supported yet.");n=e}else r.util.assert(null!=e.layers,(()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field.")),n=e.layers,delete e.layers,a=e;const o=new t(a);if(!(o instanceof p))throw new c.EH("Sequential.fromConfig called on non-Sequential input: ".concat(o));for(const r of n){const t=void 0,e=(0,u.i)(r,t,i);i&&e.setFastWeightInitDuringBuild(!0),o.add(e)}return o}set stopTraining(t){if(null==this.model)throw new c.Qp("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(null==this.model)throw new c.Qp("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const e of this.layers){const n={};n.className=e.getClassName(),n.config=e.getConfig(),t.push(n)}return{name:this.name,layers:t}}}p.className="Sequential",r.serialization.registerClass(p)},96776:(t,e,n)=>{"use strict";n.d(e,{K:()=>o});var r=n(37837),i=n(71344),a=n(5351);function o(t){const e={Adagrad:()=>r.train.adagrad(.01),Adadelta:()=>r.train.adadelta(1,.95,(0,i.Ni)()),Adam:()=>r.train.adam(.001,.9,.999,(0,i.Ni)()),Adamax:()=>r.train.adamax(.002,.9,.999,(0,i.Ni)(),0),RMSProp:()=>r.train.rmsprop(.001,.9,0,(0,i.Ni)()),SGD:()=>r.train.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new a.Qp("Unknown Optimizer ".concat(t))}},16613:(t,e,n)=>{"use strict";n.d(e,{Bm:()=>d,R9:()=>l});var r=n(37837),i=n(36043),a=n(50531);function o(t){if(null!=t&&"object"!==typeof t)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(t))}class s extends r.serialization.Serializable{}class c extends s{constructor(t){super(),o(t),this.l1=null==t||null==t.l1?.01:t.l1,this.l2=null==t||null==t.l2?.01:t.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(t){return(0,r.tidy)((()=>{let e=(0,r.zeros)([1]);return this.hasL1&&(e=(0,r.add)(e,(0,r.sum)(r.mul(this.l1,(0,r.abs)(t))))),this.hasL2&&(e=(0,r.add)(e,(0,r.sum)(r.mul(this.l2,i.Ew(t))))),r.reshape(e,[])}))}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,e){return new t({l1:e.l1,l2:e.l2})}}c.className="L1L2",r.serialization.registerClass(c);const u={l1l2:"L1L2"};function l(t){return(0,a.k4)(t)}function h(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.Xv)(t,r.serialization.SerializationMap.getMap().classNameMap,e,"regularizer")}function d(t){if(null==t)return null;if("string"===typeof t){return h({className:t in u?u[t]:t,config:{}})}return t instanceof s?t:h(t)}},41461:(t,e,n)=>{"use strict";n.d(e,{Yl:()=>i});const r=1048576;function i(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t||"object"!==typeof t||Object.getPrototypeOf(t)!==Object.prototype||!a(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const n=JSON.stringify(t);n.length>r&&console.warn('User-defined metadata of model "'.concat(e,'" is too large in ')+"size (length=".concat(n.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"".concat(r,"."))}}function a(t){if(null===t)return!0;if("object"===typeof t){if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e){if("string"!==typeof n)return!1;if(!a(t[n]))return!1}return!0}if(Array.isArray(t)){for(const e of t)if(!a(e))return!1;return!0}return!1}{const e=typeof t;return"string"===e||"number"===e||"boolean"===e}}},30130:(t,e,n)=>{"use strict";n.d(e,{J:()=>o,Ol:()=>s,mW:()=>c});var r=n(5351),i=n(50531),a=n(11690);function o(t,e,n){if("number"===typeof t)return(0,i.fD)(t,e);if(t.length!==e)throw new r.Qp("The ".concat(n," argument must be an integer or tuple of ").concat(e," integers.")+" Received: ".concat(t.length," elements."));for(let i=0;i<e;++i){const o=t[i];if(!(0,a.Fq)(o))throw new r.Qp("The ".concat(n," argument must be an integer or tuple of ").concat(e)+" integers. Received: ".concat(JSON.stringify(t)," including a")+" non-integer number ".concat(o))}return t}function s(t,e,n,r){if(null==t)return t;let i;return i="same"===n?t:t-(e+(e-1)*((arguments.length>4&&void 0!==arguments[4]?arguments[4]:1)-1))+1,Math.floor((i+r-1)/r)}function c(t,e,n,i){if(null==t)return null;if("valid"===i)t=t*e+(0,a.T9)([n-e,0]);else{if("same"!==i)throw new r.Qp("Unsupport padding mode: ".concat(i,"."));t*=e}return t}},83953:(t,e,n)=>{"use strict";n.d(e,{Q:()=>r});class r{constructor(t){this.maxEntries=t||100,this.cache=new Map}get(t){let e;return this.cache.has(t)&&(e=this.cache.get(t),this.cache.delete(t),this.cache.set(t,e)),e}put(t,e){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxEntries){const t=this.cache.keys().next().value;this.cache.delete(t)}this.cache.set(t,e)}getMaxEntries(){return this.maxEntries}setMaxEntries(t){if(t<0)throw new Error("The maxEntries of LRU caches must be at least 0, but got ".concat(t,"."));if(this.maxEntries>t)for(let e=0;e<this.maxEntries-t;e++){const t=this.cache.keys().next().value;this.cache.delete(t)}this.maxEntries=t}}},50531:(t,e,n)=>{"use strict";n.d(e,{Am:()=>v,Cb:()=>h,Cd:()=>A,E6:()=>b,HP:()=>x,U9:()=>s,Xv:()=>g,ZF:()=>y,fD:()=>a,k4:()=>f,oo:()=>w,sg:()=>_,st:()=>u,th:()=>m,uc:()=>l,vA:()=>o,wL:()=>c});var r=n(37837),i=n(5351);function a(t,e){if(Array.isArray(t)){let n=[];for(let r=0;r<e;r++)n=n.concat(t);return n}{const n=new Array(e);return n.fill(t),n}}function o(t,e){if(!t)throw new i.pf(e)}function s(t,e){let n=0;for(const r of t)r===e&&n++;return n}function c(t){return 1===t.length?t[0]:t}function u(t){return Array.isArray(t)?t:[t]}function l(t){const e=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==e[0]?e:"private"+e}function h(t){return t.length<=1||-1===t.indexOf("_")?t:t.replace(/[_]+(\w|$)/g,((t,e)=>e.toUpperCase()))}let d={};function f(t){if(null===t||void 0===t)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function p(t){if(null!=t&&"object"===typeof t)if(Array.isArray(t))t.forEach((t=>p(t)));else{const e=Object.keys(t);for(const n of e){const e=t[n];null!=e&&"object"===typeof e&&(Array.isArray(e)||"ndarray"!==e.type||"number"!==typeof e.value?p(e):t[n]=e.value)}}}function g(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"===typeof t){const a=t;let o;if(a in n)o=n[a];else if(a in d)o=d[a];else if(o=e[a],null==o)throw new i.Qp("Unknown ".concat(r,": ").concat(t,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return o}{const o=t;if(null==o.className||null==o.config)throw new i.Qp("".concat(r,": Improper config format: ")+"".concat(JSON.stringify(o),".\n")+"'className' and 'config' must set.");const s=o.className;let c,u;if(s in n?[c,u]=n[s]:s in d?[c,u]=d.className:s in e&&([c,u]=e[s]),null==c)throw new i.Qp("Unknown ".concat(r,": ").concat(s,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(null!=u){const t={};for(const n of Object.keys(d))t[n]=d[n];for(const i of Object.keys(n))t[i]=n[i];o.config.customObjects=t;const e=Object.assign({},d);for(const i of Object.keys(n))d[i]=n[i];p(o.config);const r=u(c,o.config,n,a);return d=Object.assign({},e),r}{const t=Object.assign({},d);for(const r of Object.keys(n))d[r]=n[r];const e=new c(o.config);return d=Object.assign({},t),e}}}function m(t,e){return-1*function(t,e){return t<e?-1:t>e?1:0}(t,e)}function v(t){if(null==t)return t;const e=[];for(const n of t)-1===e.indexOf(n)&&e.push(n);return e}function y(t){if(null==t)throw new i.Qp("Invalid value in obj: ".concat(JSON.stringify(t)));for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function b(t,e,n){if(null!=n&&t.indexOf(n)<0)throw new i.Qp("".concat(n," is not a valid ").concat(e,".  Valid values are ").concat(t," or null/undefined."))}function x(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return o(n>=0),o(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every((t=>typeof t===e))}function w(t,e){Array.isArray(t)?(r.util.assert(t.length>0,(()=>"".concat(e," is unexpectedly an empty array."))),t.forEach(((t,n)=>w(t,"element ".concat(n+1," of ").concat(e))))):r.util.assert(Number.isInteger(t)&&t>0,(()=>"Expected ".concat(e," to be a positive integer, but got ")+"".concat(k(t),".")))}function k(t){return null===t?"null":Array.isArray(t)?"["+t.map((t=>k(t))).join(",")+"]":"string"===typeof t?'"'.concat(t,'"'):"".concat(t)}function _(t,e,n){let i,a=null!=n?n():r.util.now();return function(){const o=null!=n?n():r.util.now();return o-a<e||(a=o,i=t(...arguments)),i}}function A(t){return"relu"===t?"relu":"linear"===t?"linear":"elu"===t?"elu":null}},9591:(t,e,n)=>{"use strict";n.d(e,{o:()=>i});var r=n(63644);function i(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log;const c=function(t){let e=!0;const n=[],r=[];for(const i in t.nodesByDepth)n.push(t.nodesByDepth[i]);for(const i of n){if(i.length>1||1===i.length&&i[0].inboundLayers.length>1){e=!1;break}r.push(...i)}if(e)for(const i of t.layers){let t=!1;for(const n of i.inboundNodes)if(-1!==r.indexOf(n)){if(t){e=!1;break}t=!0}if(!e)break}return e}(t),u=["Layer (type)","Input Shape","Output shape","Param #"];let l;if(c?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map((t=>Math.floor(e*t)))),!c){u.push("Receives inputs"),l=[];for(const e in t.nodesByDepth)l.push(...t.nodesByDepth[e])}i("_".repeat(e)),a(u,n,i),i("=".repeat(e));const h=t.layers;for(let r=0;r<h.length;++r)c?o(h[r],n,i):s(h[r],n,l,i),i((r===h.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const d=function(t){let e;e=null!=t.collectedTrainableWeights?(0,r.Y)(t.collectedTrainableWeights):(0,r.Y)(t.trainableWeights);return e}(t),f=(0,r.Y)(t.nonTrainableWeights);i("Total params: ".concat(d+f)),i("Trainable params: ".concat(d)),i("Non-trainable params: ".concat(f)),i("_".repeat(e))}function a(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,r="";for(let i=0;i<t.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r+=t[i],r=r.slice(0,e[i]),r+=" ".repeat(e[i]-r.length);n(r)}function o(t,e,n){let r,i;try{i=t.inboundNodes.map((t=>JSON.stringify(t.inputShapes))).join(",")}catch(c){i="multiple"}try{r=JSON.stringify(t.outputShape)}catch(c){r="multiple"}const o=t.name,s=t.getClassName();a(["".concat(o," (").concat(s,")"),i,r,t.countParams().toString()],e,n)}function s(t,e,n,r){let i,o;try{o=t.inboundNodes.map((t=>JSON.stringify(t.inputShapes))).join(",")}catch(h){o="multiple"}try{i=JSON.stringify(t.outputShape)}catch(h){i="multiple"}const s=[];for(const a of t.inboundNodes)if(!(null!=n&&n.length>0&&-1===n.indexOf(a)))for(let t=0;t<a.inboundLayers.length;++t){const e=a.inboundLayers[t].name,n=a.nodeIndices[t],r=a.tensorIndices[t];s.push("".concat(e,"[").concat(n,"][").concat(r,"]"))}const c=t.name,u=t.getClassName(),l=0===s.length?"":s[0];a(["".concat(c," (").concat(u,")"),o,i,t.countParams().toString(),l],e,r);for(let d=1;d<s.length;++d)a(["","","","",s[d]],e,r)}},11690:(t,e,n)=>{"use strict";n.d(e,{Fq:()=>i,T9:()=>s,jk:()=>o,no:()=>a,y1:()=>c});var r=n(5351);function i(t){return t===parseInt(t.toString(),10)}function a(t,e,n){null==e&&(e=0),null==n&&(n=t.length);let r=1;for(let i=e;i<n;++i)r*=t[i];return r}function o(t){if(0===t.length)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r<e&&(e=r)}return e}function s(t){if(0===t.length)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r>e&&(e=r)}return e}function c(t,e){if(e<t)throw new r.Qp("end (".concat(e,") < begin (").concat(t,") is forbidden."));const n=[];for(let r=t;r<e;++r)n.push(r);return n}},69834:(t,e,n)=>{"use strict";n.d(e,{M:()=>o,w:()=>a});var r=n(50531);function i(t,e,n){return("inboundNodes"===t||"outputLayers"===t||"inputLayers"===t)&&0===e&&"string"===typeof n}function a(t,e){if(null===t)return null;if("string"===typeof t)return r.Cb(t);if("number"===typeof t||"boolean"===typeof t)return t;if(t instanceof Array){const n=[],r=t.length;for(let o=0;o<r;++o){const r=t[o];i(e,o,r)?n.push(r):n.push(a(r,e))}return n}{const e={};for(const n of Object.keys(t)){const i=t[n];if("name"===n&&"string"===typeof i)e[n]=i;else{const t=r.Cb(n);e[t]=a(i,t)}}return e}}function o(t,e){if(null===t||void 0===t)return null;if("string"===typeof t)return r.uc(t);if("number"===typeof t||"boolean"===typeof t)return t;if(t instanceof Array){const n=[],r=t.length;for(let a=0;a<r;++a){const r=t[a];i(e,a,r)?n.push(r):n.push(o(r,e))}return n}{const e={};for(const n of Object.keys(t)){const i=t[n],a=r.uc(n);e[a]="name"!==n&&"className"!==n||"string"!==typeof i?o(i,n):i}return e}}},62755:(t,e,n)=>{"use strict";n.d(e,{FS:()=>a,TT:()=>i,U$:()=>s,un:()=>o});var r=n(5351);function i(t){return Array.isArray(t)&&Array.isArray(t[0])}function a(t){return 0===t.length?[]:Array.isArray(t[0])?t:[t]}function o(t){let e;if(Array.isArray(t)){if(1!==t.length)throw new r.Qp("Expected Tensor length to be 1; got ".concat(t.length));e=t[0]}else e=t;return e}function s(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(1===t.length)return t[0];throw new r.Qp("Expected exactly 1 Shape; got ".concat(t.length))}return t}},63644:(t,e,n)=>{"use strict";function r(t){let e=0;for(const n of t)0===n.shape.length?e+=1:e+=n.shape.reduce(((t,e)=>t*e));return e}n.d(e,{Y:()=>r})},1947:(t,e,n)=>{"use strict";n.d(e,{UM:()=>u,eR:()=>s,ex:()=>c});var r=n(37837),i=n(76140),a=n(32381);n(5351);const o="Variable";class s{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o,s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.dtype=null==e?"float32":e,this.shape=t.shape,this.id=(0,i.j)(),n=null==n?o:n,this.originalName=(0,a.BC)(n),this.name=(0,a.Uc)(this.originalName),this.trainable_=s,this.constraint=c,this.val=r.variable(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),function(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}(this.val,t),this.val.id!==t.id&&(this.val.assign(t),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function c(t){return t.map((t=>t.read()))}function u(t){t.forEach((t=>{t[0].write(t[1])}))}},74022:(t,e,n)=>{"use strict";n.d(e,{r:()=>r});const r="4.17.0"},99906:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(28927),i=n(17975);class a extends r.Component{componentDidMount(){const{name:t,tab:e}=this.props;this.props.registerSurface(t,e,this)}componentDidUpdate(){return!1}render(){const{name:t,visible:e,styles:n}=this.props,o=Object.assign({},a.defaultStyles,n),{width:s,height:c}=o;let{maxHeight:u,maxWidth:l}=o;u=c===a.defaultStyles.height?u:c,l=s===a.defaultStyles.width?l:s;const h=i.css({display:e?"block":"none",backgroundColor:"white",marginTop:"10px",marginBottom:"10px",boxShadow:"0 0 6px -3px #777",padding:"10px !important",height:c,width:s,maxHeight:u,maxWidth:l,overflow:"auto"}),d=i.css({backgroundColor:"white",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",marginBottom:"20px",fontWeight:"600",textAlign:"center"}),f=i.css({boxSizing:"border-box"});return r.h("div",{className:"".concat(h," tf-surface"),ref:t=>this.container=t,"data-visible":e},r.h("div",{className:"".concat(d," tf-label"),ref:t=>this.label=t},t),r.h("div",{className:"".concat(f," tf-draw-area"),ref:t=>this.drawArea=t}))}}a.defaultStyles={maxWidth:"550px",maxHeight:"580px",height:"auto",width:"auto"},e.SurfaceComponent=a},15217:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(28927),i=n(17975);class a extends r.Component{render(){const{tabNames:t,activeTab:e,handleClick:n}=this.props,a=t.length>0?t.map((t=>r.h(o,{key:t,id:t,handleClick:n,isActive:t===e},t))):null,s=i.css({overflowX:"scroll",overflowY:"hidden",whiteSpace:"nowrap",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"#eee",paddingBottom:"1rem",marginTop:"1rem"});return r.h("div",{className:"".concat(s," visor-tabs")},a)}}e.Tabs=a;class o extends r.Component{render(){const{children:t,isActive:e,handleClick:n,id:a}=this.props,o=i.css({borderBottomColor:e?"#357EDD":"#AAAAAA",borderBottomWidth:"1px",borderBottomStyle:"solid",cursor:"pointer",":hover":{color:"#357EDD"},display:"inline-block",marginRight:"1rem",padding:".5rem",fontSize:"1rem",fontWeight:"bold"});return r.h("a",{className:"".concat(o," tf-tab"),"data-isactive":e,onClick:()=>n(a)},t)}}},89570:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(28927),i=n(17975),a=n(99906),o=n(15217);class s extends r.Component{static render(t,e,n){return r.render(r.h(s,Object.assign({},n)),t,e)}constructor(t){super(t),this.surfaces=new Map;const e=null==t.startOpen||t.startOpen;this.state={isOpen:e,isFullscreen:!1,activeTab:null,tabs:new Set},this.keyHandler=this.keyHandler.bind(this)}close(){this.setState({isOpen:!1})}open(){this.setState({isOpen:!0})}toggle(){this.setState({isOpen:!this.state.isOpen})}toggleFullScreen(){this.setState({isFullscreen:!this.state.isFullscreen})}isOpen(){return this.state.isOpen}isFullscreen(){return this.state.isFullscreen}getSurface(t,e){const n=this.surfaceId(t,e);let r;if(!this.surfaces.has(n))throw Error("Surface not found with id: ".concat(n));return r=this.surfaces.get(n),{container:r.container,label:r.label,drawArea:r.drawArea}}bindKeys(){document.addEventListener("keydown",this.keyHandler,!1)}unbindKeys(){document.removeEventListener("keydown",this.keyHandler)}surfaceId(t,e){return t+e}setTabs(t){const e=t.map((t=>t.tab)),n=this.state.tabs;let r;for(const i of e)n.has(i)||(n.add(i),r=i);null!=r&&this.setState({tabs:n,activeTab:r})}getTabs(){return this.state.tabs}registerSurface(t,e,n){const r=this.surfaceId(t,e);this.surfaces.set(r,n)}keyHandler(t){192===t.keyCode&&(t.shiftKey?this.toggleFullScreen():this.toggle())}setActiveTab(t){this.setState({activeTab:t})}componentDidMount(){this.bindKeys()}componentWillMount(){this.setTabs(this.props.surfaceList)}componentWillReceiveProps(t){this.setTabs(t.surfaceList)}render(){const{isOpen:t,isFullscreen:e,activeTab:n}=this.state,{surfaceList:s}=this.props,u=Array.from(this.getTabs().values()),l=e?"90vw":"550px",h=i.css({width:l,height:"100%",backgroundColor:"#fafafa",boxSizing:"border-box",padding:"10px",position:"fixed",top:"0px",transition:"right 0.5s cubic-bezier(0.645, 0.045, 0.355, 1), width 0.5s cubic-bezier(0.645, 0.045, 0.355, 1)",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.12), 0 2px 5px rgba(0, 0, 0, 0.24)",overflow:"auto",fontFamily:"sans-serif",fontSize:"14px",zIndex:1e3}),d=i.css({right:"0"}),f=i.css({right:"calc(-".concat(l," - 10px)")}),p=t?d:f,g=i.css({});return r.h("div",{className:"".concat(h," ").concat(p," visor"),"data-isopen":t,"data-isfullscreen":e},r.h(c,{fullScreenHandler:this.toggleFullScreen.bind(this),closeHandler:this.close.bind(this),isFullScreen:e}),r.h(o.Tabs,{tabNames:u,activeTab:n,handleClick:this.setActiveTab.bind(this)}),r.h("div",{className:"".concat(g," visor-surfaces")},s.map((t=>r.h(a.SurfaceComponent,{key:t.name+t.tab,name:t.name,tab:t.tab,styles:t.styles,registerSurface:this.registerSurface.bind(this),visible:n===t.tab})))))}}function c(t){const{isFullScreen:e,fullScreenHandler:n,closeHandler:a}=t,o=i.css({display:"flex",backgroundColor:"white",border:"1px solid white",padding:"6px",paddingTop:"10px",marginBottom:"10px",borderRadius:"6px",marginTop:"-16px"}),s=i.css({fontSize:".875rem",borderRadius:".25rem",paddingLeft:"1rem",paddingRight:"1rem",paddingTop:".5rem",paddingBottom:".5rem",textDecoration:"none",transition:"color .15s ease-in",color:"#111"}),c=i.css({marginLeft:"auto"});return r.h("div",{className:"".concat(o," visor-controls")},r.h("button",{className:"".concat(s),onClick:n},e?"Minimize":"Maximize"),r.h("button",{className:"".concat(s," ").concat(c),onClick:a},"Hide"))}e.VisorComponent=s},86112:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(37837),n(58914);const r=n(18794),i=n(92977),a=n(46737),o=n(34115),s=n(72003),c=n(96683),u=n(56557),l=n(86920),h=n(8777),d=n(56957),f=n(35927),p=n(99151),g=n(15884);e.version_vis=g.version;const m={barchart:r.barchart,table:u.table,histogram:o.histogram,linechart:s.linechart,scatterplot:c.scatterplot,confusionMatrix:i.confusionMatrix,heatmap:a.heatmap};e.render=m;const v={accuracy:p.accuracy,perClassAccuracy:p.perClassAccuracy,confusionMatrix:p.confusionMatrix};e.metrics=v;const y={history:l.history,fitCallbacks:l.fitCallbacks,perClassAccuracy:d.perClassAccuracy,valuesDistribution:f.valuesDistribution,layer:h.layer,modelSummary:h.modelSummary};e.show=y;var b=n(67543);e.visor=b.visor,function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(55525))},18794:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(n(66836)),o=n(26513),s=n(11447);e.barchart=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r(this,void 0,void 0,(function*(){const r=s.getDrawArea(t),i=e,l=Object.assign({},c,n);if(u.has(r)){const t=u.get(r);if(s.shallowEquals(l,t.lastOptions)){yield s.nextFrame();const e=t.view,n=e.changeset().remove((()=>!0)).insert(i);return void(yield e.change("values",n).runAsync())}}const{xLabel:h,yLabel:d,xType:f,yType:p}=l;let g=null;null!=h&&(g={title:h});let m=null;null!=d&&(m={title:d});let v;v=null!=l.color?Array.isArray(l.color)?{field:"index",type:"nominal",scale:{range:l.color}}:{value:l.color}:{value:"#4C78A0"};const y={width:l.width||o.getDefaultWidth(r),height:l.height||o.getDefaultHeight(r),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:l.fontSize,titleFontSize:l.fontSize},text:{fontSize:l.fontSize},legend:{labelFontSize:l.fontSize,titleFontSize:l.fontSize}},data:{values:i,name:"values"},mark:{type:"bar",tooltip:!0},encoding:{x:{field:"index",type:f,axis:g},y:{field:"value",type:p,axis:m},color:v}};yield s.nextFrame();const b=yield a.default(r,y,{actions:!1,mode:"vega-lite",defaultStyle:!1});u.set(r,{view:b.view,lastOptions:l})}))};const c={xLabel:"",yLabel:"",xType:"ordinal",yType:"quantitative",fontSize:11},u=new Map},92977:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(n(66836)),o=n(26513),s=n(11447);e.confusionMatrix=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r(this,void 0,void 0,(function*(){const r=Object.assign({},c,n),i=s.getDrawArea(t),u=[],l=e.values,h=e.tickLabels||[],d=0===h.length;let f=!0;for(let t=0;t<l.length;t++){const e=d?"Class ".concat(t):h[t];d&&h.push(e);for(let n=0;n<l[t].length;n++){const i=d?"Class ".concat(n):h[n],a=l[t][n];t!==n||r.shadeDiagonal?(u.push({label:e,prediction:i,count:a,scaleCount:a}),0!==a&&(f=!1)):u.push({label:e,prediction:i,count:a,noFill:!0})}}if(!r.shadeDiagonal&&f)for(const t of u)!0===t.noFill&&(t.noFill=!1,t.scaleCount=t.count);const p={width:r.width||o.getDefaultWidth(i),height:r.height||o.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize}},data:{values:u},encoding:{x:{field:"prediction",type:"ordinal",title:r.xLabel||"prediction",scale:{domain:h}},y:{field:"label",type:"ordinal",title:r.yLabel||"label",scale:{domain:h}}},layer:[{transform:[{filter:"datum.noFill != true"}],mark:{type:"rect"},encoding:{color:{field:"scaleCount",type:"quantitative",scale:{range:r.colorMap}},tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}]};!1===r.shadeDiagonal&&p.layer.push({transform:[{filter:"datum.noFill == true"}],mark:{type:"rect",fill:"white"},encoding:{tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}),r.showTextOverlay&&p.layer.push({mark:{type:"text",baseline:"middle"},encoding:{text:{field:"count",type:"nominal"}}});const g="string"===typeof r.colorMap?{scheme:r.colorMap}:r.colorMap;p.layer[0].encoding.color.scale.range=g,yield a.default(i,p,{actions:!1,mode:"vega-lite",defaultStyle:!1})}))};const c={xLabel:null,yLabel:null,xType:"nominal",yType:"nominal",shadeDiagonal:!0,fontSize:12,showTextOverlay:!0,height:400,colorMap:["#f7fbff","#4292c6"]}},46737:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=i(n(37837)),s=a(n(66836)),c=n(26513),u=n(27332),l=n(11447);function h(t,e,n){const r=t instanceof o.Tensor?t.shape:[t.length,t[0].length];0===n?u.assert(r[0]===e.length,"Length of xTickLabels (".concat(e.length,") must match number of rows")+" (".concat(r[0],")")):1===n&&u.assert(r[1]===e.length,"Length of yTickLabels (".concat(e.length,") must match number of columns (").concat(r[1],")"))}e.heatmap=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r(this,void 0,void 0,(function*(){const i=Object.assign({},d,n),a=l.getDrawArea(t);let f=e.values;i.rowMajor&&(f=yield function(t){return r(this,void 0,void 0,(function*(){let e,n;t instanceof o.Tensor?(e=t.shape,n=t.transpose()):(e=[t.length,t[0].length],n=o.tidy((()=>o.tensor2d(t).transpose()))),u.assert(2===n.rank,"Input to renderHeatmap must be a 2d array or Tensor2d");const r=yield n.array();n.dispose();const i=[r.length,r[0].length];return u.assert(e[0]===i[1]&&e[1]===i[0],"Unexpected transposed shape. Original ".concat(e," : Transposed ").concat(i)),r}))}(e.values));const{xTickLabels:p,yTickLabels:g}=e;if(null!=p){h(f,p,0)}if(null!=g){h(f,g,1)}const m="@tfidx@",v=[];if(f instanceof o.Tensor){u.assert(2===f.rank,"Input to renderHeatmap must be a 2d array or Tensor2d");const t=yield f.data(),[e,n]=f.shape;for(let r=0;r<e;r++){const e=p?"".concat(p[r]).concat(m).concat(r):r;for(let i=0;i<n;i++){const a=g?"".concat(g[i]).concat(m).concat(i):i,o=t[r*n+i];v.push({x:e,y:a,value:o})}}}else{const t=f;for(let e=0;e<t.length;e++){const n=p?"".concat(p[e]).concat(m).concat(e):e;for(let r=0;r<t[e].length;r++){const i=g?"".concat(g[r]).concat(m).concat(r):r,a=t[e][r];v.push({x:n,y:i,value:a})}}}const y={actions:!1,mode:"vega-lite",defaultStyle:!1},b={width:i.width||c.getDefaultWidth(a),height:i.height||c.getDefaultHeight(a),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},text:{fontSize:i.fontSize},legend:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},scale:{bandPaddingInner:0,bandPaddingOuter:0}},data:{values:v},mark:{type:"rect",tooltip:!0},encoding:{x:{field:"x",type:i.xType,title:i.xLabel,sort:!1},y:{field:"y",type:i.yType,title:i.yLabel,sort:!1},fill:{field:"value",type:"quantitative"}}},x="".concat(m,"\\d+$"),w=new RegExp(x);let k;switch(p&&(b.encoding.x.axis={labelExpr:"replace(datum.value, regexp(/".concat(x,"/), '')")}),g&&(b.encoding.y.axis={labelExpr:"replace(datum.value, regexp(/".concat(x,"/), '')")}),(p||g)&&(y.tooltip={sanitize:t=>String(t).replace(w,"")}),i.colorMap){case"blues":k=["#f7fbff","#4292c6"];break;case"greyscale":k=["#000000","#ffffff"];break;default:k="viridis"}if("viridis"!==k){b.encoding.fill.scale={range:k}}if(i.domain){const t=b.encoding.fill;null!=t.scale?t.scale=Object.assign({},t.scale,{domain:i.domain}):t.scale={domain:i.domain}}yield s.default(a,b,y)}))};const d={xLabel:null,yLabel:null,xType:"ordinal",yType:"ordinal",colorMap:"viridis",fontSize:12,domain:null,rowMajor:!1}},34115:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=n(67637),o=i(n(66836)),s=n(26513),c=n(99151),u=n(56557),l={maxBins:12,fontSize:11};e.histogram=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r(this,void 0,void 0,(function*(){const r=function(t){if(null==t.length)throw new Error("input data must be an array");if(0===t.length)return[];if("object"===typeof t[0]){if(null==t[0].value)throw new Error("input data must have a value field");return t}{const e=Array(t.length);for(let n=0;n<t.length;n++)e[n]={value:t[n]};return e}}(e),i=Object.assign({},l,n),h=s.subSurface(t,"histogram");if(!1!==n.stats){const e=s.subSurface(t,"stats",{prepend:!0});let o;o=n.stats?n.stats:c.arrayStats(r.map((t=>t.value))),function(t,e,n){const r=a.format(",.4~f"),i=a.format(".4~p"),o=[],s=[];null!=t.numVals&&(o.push("Num Vals"),s.push(r(t.numVals)));null!=t.min&&(o.push("Min"),s.push(r(t.min)));null!=t.max&&(o.push("Max"),s.push(r(t.max)));if(null!=t.numZeros){o.push("# Zeros");let e="";t.numVals&&(e=t.numZeros>0?"(".concat(i(t.numZeros/t.numVals),")"):""),s.push("".concat(r(t.numZeros)," ").concat(e))}if(null!=t.numNans){o.push("# NaNs");let e="";t.numVals&&(e=t.numNans>0?"(".concat(i(t.numNans/t.numVals),")"):""),s.push("".concat(r(t.numNans)," ").concat(e))}if(null!=t.numInfs){o.push("# Infinity");let e="";t.numVals&&(e=t.numInfs>0?"(".concat(i(t.numInfs/t.numVals),")"):""),s.push("".concat(r(t.numInfs)," ").concat(e))}u.table(e,{headers:o,values:[s]},n)}(o,e,{fontSize:i.fontSize})}if(0===r.length)return;const d=[];for(let t=0;t<r.length;t++){const e=r[t].value;null!=e&&isFinite(e)&&d.push(r[t])}const f={width:i.width||s.getDefaultWidth(h),height:i.height||s.getDefaultHeight(h),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},data:{values:d},mark:{type:"bar",tooltip:!0},config:{axis:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},text:{fontSize:i.fontSize},legend:{labelFontSize:i.fontSize,titleFontSize:i.fontSize}},encoding:{x:{bin:{maxbins:i.maxBins},field:"value",type:"quantitative"},y:{aggregate:"count",type:"quantitative"},color:{value:i.color||"#001B44"}}};return o.default(h,f,{actions:!1,mode:"vega-lite",defaultStyle:!1})}))}},72003:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(n(66836)),o=n(26513),s=n(27332),c=n(11447);e.linechart=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r(this,void 0,void 0,(function*(){const r=Array.isArray(e.values[0])?e.values:[e.values],i=r[0].length,l=e.series?e.series:r.map(((t,e)=>"Series ".concat(e+1)));s.assert(l.length===r.length,"Must have an equal number of series labels as there are data series"),null!=n.seriesColors&&s.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const h=[];for(let t=0;t<i;t++){const e={x:t};l.forEach(((n,i)=>{const a=r[i][t].y;e[n]=a,e["".concat(n,"-name")]=n})),h.push(e)}const d=Object.assign({},u,n),f={x:{field:"x",type:d.xType,title:d.xLabel},tooltip:[{field:"x",type:"quantitative"},...l.map((t=>({field:t,type:"quantitative"})))]},p=l.map((t=>({data:void 0,mark:{type:"line",clip:!0},encoding:{y:{field:t,type:d.yType,title:d.yLabel,scale:d.zoomToFit?{zero:!1}:null!=d.yAxisDomain?{domain:d.yAxisDomain}:void 0},color:{field:"".concat(t,"-name"),type:"nominal",legend:{values:l,title:null},scale:{range:d.seriesColors}}}}))),g=c.getDrawArea(t),m={width:d.width||o.getDefaultWidth(g),height:d.height||o.getDefaultHeight(g),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:d.fontSize,titleFontSize:d.fontSize},text:{fontSize:d.fontSize},legend:{labelFontSize:d.fontSize,titleFontSize:d.fontSize}},data:{values:h},encoding:f,layer:[...p,{mark:"rule",selection:{hover:{type:"single",on:"mouseover",nearest:!0,clear:"mouseout"}},encoding:{color:{value:"grey",condition:{selection:{not:"hover"},value:"transparent"}}}}]};return yield a.default(g,m,{actions:!1,mode:"vega-lite",defaultStyle:!1}),Promise.resolve()}))};const u={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11}},11447:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n(55525),a=n(67543);e.getDrawArea=function(t){if(t instanceof HTMLElement)return t;if(i.isSurface(t))return t.drawArea;if(i.isSurfaceInfo(t)){return a.visor().surface({name:t.name,tab:t.tab,styles:t.styles}).drawArea}throw new Error("Not a drawable")},e.shallowEquals=function(t,e){const n=Object.getOwnPropertyNames(t),r=Object.getOwnPropertyNames(e);if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++){const r=n[i];if(t[r]!==e[r])return!1}return!0},e.nextFrame=function(){return r(this,void 0,void 0,(function*(){yield new Promise((t=>requestAnimationFrame(t)))}))}},96683:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(n(66836)),o=n(26513),s=n(27332),c=n(11447);e.scatterplot=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r(this,void 0,void 0,(function*(){let r=e.values;const i=null==e.series?[]:e.series;r=Array.isArray(r[0])?r:[r];const l=[];r.forEach(((t,e)=>{const n=null!=i[e]?i[e]:"Series ".concat(e+1),r=t.map((t=>Object.assign({},t,{series:n})));l.push(...r)})),null!=n.seriesColors&&s.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const h=c.getDrawArea(t),d=Object.assign({},u,n),f={width:d.width||o.getDefaultWidth(h),height:d.height||o.getDefaultHeight(h),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:d.fontSize,titleFontSize:d.fontSize},text:{fontSize:d.fontSize},legend:{labelFontSize:d.fontSize,titleFontSize:d.fontSize}},data:{values:l},mark:{type:"point",clip:!0,tooltip:{content:"data"}},encoding:{x:{field:"x",type:d.xType,title:d.xLabel,scale:d.zoomToFit?{zero:!1}:null!=d.xAxisDomain?{domain:d.xAxisDomain}:void 0},y:{field:"y",type:d.yType,title:d.yLabel,scale:d.zoomToFit?{zero:!1}:null!=d.yAxisDomain?{domain:d.yAxisDomain}:void 0},color:{field:"series",type:"nominal",scale:{range:d.seriesColors}},shape:{field:"series",type:"nominal"}}};return yield a.default(h,f,{actions:!1,mode:"vega-lite",defaultStyle:!1}),Promise.resolve()}))};const u={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11}},56557:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(67637),i=n(27954),a=n(17975),o=n(11447);e.table=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e&&null==e.headers)throw new Error('Data to render must have a "headers" property');if(e&&null==e.values)throw new Error('Data to render must have a "values" property');const c=o.getDrawArea(t),u=Object.assign({},s,n);let l=i.select(c).select("table.tf-table");const h=a.css({fontSize:u.fontSize||".875rem",width:"100%",maxWidth:"64rem",marginRight:"auto",marginLeft:"auto"});if(0===l.size()&&(l=i.select(c).append("table"),l.attr("class"," ".concat(h," tf-table")),l.append("thead").append("tr"),l.append("tbody")),1!==l.size())throw new Error("Error inserting table");const d=a.css({fontWeight:"600",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )",textAlign:"left",paddingBottom:"1rem",paddingRight:"1rem",backgroundColor:"#fff"}),f=l.select("thead").select("tr").selectAll("th").data(e.headers),p=f.enter().append("th").attr("class","".concat(d));f.merge(p).html((t=>t)),f.exit().remove();const g=r.format(",.4~f"),m=l.select("tbody").selectAll("tr").data(e.values),v=m.enter().append("tr"),y=a.css({padding:"0.25rem",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )"}),b=m.merge(v).selectAll("td").data((t=>t)),x=b.enter().append("td").attr("class","".concat(y));b.merge(x).html((t=>"number"===typeof t?g(t):t)),b.exit().remove(),m.exit().remove()};const s={fontSize:14}},86920:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n(72003),a=n(11447),o=n(26513);function s(t,e,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return r(this,void 0,void 0,(function*(){const r=a.getDrawArea(t),l={};for(const t of n)if(/val_/.test(t)){const r=t.replace("val_","");c(l,r);const i=u(e,t,n.indexOf(t));l[r].series.push(t),l[r].values.push(i)}else{const r=u(e,t,n.indexOf(t));c(l,t),l[t].series.push(t),l[t].values.push(r)}const h=Object.keys(l),d=Object.assign({},{xLabel:"Iteration",yLabel:"Value"},s),f=[];for(const t of h){const e=o.subSurface(r,t),n=l[t].series,a=l[t].values;n.every((t=>Boolean(t.match("acc"))))&&(d.zoomToFitAccuracy?d.zoomToFit=!0:(d.yAxisDomain=[0,1],delete d.zoomToFit));const s=i.linechart(e,{values:a,series:n},d);f.push(s)}yield Promise.all(f)}))}function c(t,e){null==t[e]&&(t[e]={series:[],values:[]})}function u(t,e,n){if(Array.isArray(t)){const r=Array.isArray(t[0])?t[n]:t,i=[];for(let t=0;t<r.length;t++){const n=r[t];i.push({x:t,y:n[e]})}return i}return t.history[e].map(((t,e)=>({x:e,y:t})))}function l(t,e,n){return null==t[e]&&(t[e]={}),null==t[e][n]&&(t[e][n]=[]),t[e][n]}e.history=s,e.fitCallbacks=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i={},c=n.callbacks||["onEpochEnd","onBatchEnd"],u=a.getDrawArea(t),h=Object.assign({},n);delete h.callbacks;const d={};return c.forEach((t=>{d[t]=function(t){return(n,c)=>r(this,void 0,void 0,(function*(){/batch/i.test(t)?h.xLabel="Batch":/epoch/i.test(t)&&(h.xLabel="Epoch");const n=[],r=[];for(const a of e)if(null!=c[a]){r.push(a);const e=l(i,t,a);e.push({[a]:c[a]}),n.push(e)}s(o.subSurface(u,t,{title:t}),n,r,h),yield a.nextFrame()}))}(t)})),d}},8777:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n(34115),a=n(11447),o=n(56557),s=n(26513),c=n(99151);function u(t){let e;if(Array.isArray(t.outputShape[0])){const n=t.outputShape.map((t=>l(t)));e="[".concat(n.join(", "),"]")}else e=l(t.outputShape);return{name:t.name,trainable:t.trainable,parameters:t.countParams(),outputShape:e}}function l(t){const e=t.slice();return 0===e.length?"Scalar":(null===e[0]&&(e[0]="batch"),"[".concat(e.join(","),"]"))}e.modelSummary=function(t,e){return r(this,void 0,void 0,(function*(){const n=a.getDrawArea(t),r=function(t){return{layers:t.layers.map(u)}}(e),i=r.layers.map((t=>[t.name,t.outputShape,t.parameters,t.trainable]));o.table(n,{headers:["Layer Name","Output Shape","# Of Params","Trainable"],values:i})}))},e.layer=function(t,e){return r(this,void 0,void 0,(function*(){const n=a.getDrawArea(t),u=yield function(t){return r(this,void 0,void 0,(function*(){const e=t.getWeights(),n=t.weights,r=e.map(c.tensorStats),i=yield Promise.all(r),a=e.map((t=>t.shape));return e.map(((t,e)=>({name:n[e].name,stats:i[e],shape:l(a[e]),weight:t})))}))}(e),h=s.subSurface(n,"layer-weights-info"),d=u.map((t=>[t.name,t.shape,t.stats.min,t.stats.max,t.weight.size,t.stats.numZeros,t.stats.numNans,t.stats.numInfs]));o.table(h,{headers:["Weight Name","Shape","Min","Max","# Params","# Zeros","# NaNs","# Infinity"],values:d});const f=s.subSurface(n,"select-layer"),p=s.subSurface(n,"param-distribution");!function(t,e,n){const r="\n    <select>\n      ".concat(t.map((t=>"<option value=".concat(t,">").concat(t,"</option>"))),"\n    </select>\n  "),i="<div>".concat("<button>Show Values Distribution for:</button>").concat(r,"</div>");e.innerHTML=i;const a=e.querySelector("button"),o=e.querySelector("select");a.addEventListener("click",(()=>{n(o.selectedOptions[0].label)}))}(u.map((t=>t.name)),f,(t=>r(this,void 0,void 0,(function*(){const e=u.filter((e=>e.name===t))[0],n=yield e.weight.data();i.histogram(p,n,{height:150,width:460,stats:!1})}))))}))}},56957:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n(11447),a=n(56557);e.perClassAccuracy=function(t,e,n){return r(this,void 0,void 0,(function*(){const r=i.getDrawArea(t),o=[];for(let t=0;t<e.length;t++){const r=n?n[t]:t.toString(),i=e[t];o.push([r,i.accuracy,i.count])}return a.table(r,{headers:["Class","Accuracy","# Samples"],values:o})}))}},35927:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n(34115),a=n(11447),o=n(99151);e.valuesDistribution=function(t,e){return r(this,void 0,void 0,(function*(){const n=a.getDrawArea(t),r=yield o.tensorStats(e),s=yield e.data();i.histogram(n,s,{height:150,stats:r})}))}},55525:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isSurfaceInfo=function(t){return null!=t.name},e.isSurface=function(t){return t.drawArea instanceof HTMLElement}},26513:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(17975),i=n(11447),a={prepend:!1};e.subSurface=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=i.getDrawArea(t),s=r.css({"& canvas":{display:"block"},marginTop:".5rem",marginBottom:".5rem"}),c=r.css({backgroundColor:"white",display:"inline-block",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",padding:"0 10px 0 10px",marginBottom:"20px",fontWeight:"600",textAlign:"left"}),u=Object.assign({},a,n);let l=o.querySelector("div[data-name=".concat(e,"]"));if(!l){if(l=document.createElement("div"),l.setAttribute("class","".concat(s)),l.dataset.name=e,u.title){const t=document.createElement("div");t.setAttribute("class","subsurface-title ".concat(c)),t.innerText=u.title,l.appendChild(t)}u.prepend?o.insertBefore(l,o.firstChild):o.appendChild(l)}return l},e.getDefaultWidth=function(t){let e=0,n=t;for(;n&&0===n.clientWidth;)n=n.parentElement,e=50;return n.clientWidth-e},e.getDefaultHeight=function(t){return 0===t.clientHeight?200:t.clientHeight}},99151:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n(37837),a=n(27332);e.arrayStats=function(t){if(!Array.isArray(t))throw new Error("input must be an array");if(0===t.length)return{numVals:0,numNans:0,numZeros:0,max:void 0,min:void 0};const e=t.length;let n=-1/0,r=1/0,i=0,a=0,o=0;for(let c=0;c<e;c++){const e=t[c];e>n&&(n=e),e<r&&(r=e),0===e&&(i+=1),isNaN(e)?a+=1:isFinite(e)||(o+=1)}const s={numVals:e,numZeros:i,numNans:a,max:n,min:r,numInfs:o};return s.max===-1/0&&(s.max=NaN),s.min===1/0&&(s.min=NaN),s},e.tensorStats=function(t){return r(this,void 0,void 0,(function*(){const[e,n,r]=i.tidy((()=>{const e=i.scalar(0,t.dtype);return[t.min(),t.max(),t.equal(e).sum()]}));return Promise.all([t.data(),e.data(),n.data(),r.data()]).then((t=>{let[e,n,r,i]=t;const a=e.length;let o=0,s=0;for(let l=0;l<a;l++){const t=e[l];isNaN(t)?o+=1:isFinite(t)||(s+=1)}let c=n[0],u=r[0];o===a&&(c=NaN,u=NaN);return{numVals:a,numZeros:i[0],numNans:o,min:c,max:u,numInfs:s}}))}))},e.confusionMatrix=function(t,e,n,o){return r(this,void 0,void 0,(function*(){a.assert(1===t.rank,"labels must be a 1D tensor"),a.assert(1===e.rank,"predictions must be a 1D tensor"),a.assert(t.size===e.size,"labels and predictions must be the same length"),null!=o&&a.assert(o.size===e.size,"labels and predictions must be the same length");const r=t.cast("int32"),s=e.cast("int32");null==n&&(n=i.tidy((()=>i.maximum(r.max(),s.max()).cast("int32").dataSync()[0]+1)));let c=Promise.resolve(null);return null!=o&&(c=o.data()),Promise.all([r.data(),s.data(),c]).then((t=>{let[e,r,i]=t;const a=Array(n).fill(0);for(let o=0;o<n;o++)a[o]=Array(n).fill(0);for(let n=0;n<e.length;n++){const t=e[n],o=r[n];a[t][o]+=null!=i?i[n]:1}return a}))}))},e.accuracy=function(t,e){return r(this,void 0,void 0,(function*(){a.assertShapesMatch(t.shape,e.shape,"Error computing accuracy.");const n=t.equal(e),r=n.mean(),o=(yield r.data())[0];return i.dispose([n,r]),o}))},e.perClassAccuracy=function(t,e,n){return r(this,void 0,void 0,(function*(){return a.assert(1===t.rank,"labels must be a 1D tensor"),a.assert(1===e.rank,"predictions must be a 1D tensor"),a.assert(t.size===e.size,"labels and predictions must be the same length"),null==n&&(n=i.tidy((()=>i.maximum(t.max(),e.max()).dataSync()[0]+1))),Promise.all([t.data(),e.data()]).then((t=>{let[e,r]=t;const i=Array(n).fill(0),a=Array(n).fill(0);for(let n=0;n<e.length;n++){const t=e[n],o=r[n];i[t]+=1,t===o&&(a[t]+=1)}const o=[];for(let n=0;n<i.length;n++)o.push({count:i[n],accuracy:0===i[n]?0:a[n]/i[n]});return o}))}))}},27332:(t,e)=>{"use strict";function n(t,e){if(!t)throw new Error("string"===typeof e?e:e())}function r(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}Object.defineProperty(e,"__esModule",{value:!0}),e.assert=n,e.assertShapesMatch=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";n(r(t,e),i+" Shapes ".concat(t," and ").concat(e," must match"))},e.arraysEqual=r,e.DECIMAL_PLACES_TO_CHECK=4},15884:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.version="1.5.1"},67543:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(89570);let i;const a="tfjs-visor-container";e.visor=function(){if("undefined"===typeof document)throw new Error("No document defined. This library needs a browser/dom to work");if(document.getElementById(a)&&null!=i)return i;let t,e=document.getElementById(a);function n(e,n){let i=null;return t=r.VisorComponent.render(e,t,{ref:t=>i=t,surfaceList:Array.from(n.values())}),i}null==e&&(e=document.createElement("div"),e.id=a,document.body.appendChild(e));const s=new Map,c=n(e,s);return i=new o(c,e,s,n),i};class o{constructor(t,e,n,r){this.visorComponent=t,this.el=e,this.surfaceList=n,this.renderVisor=r}surface(t){const{name:e}=t,n=null==t.tab?"Visor":t.tab;if(null==e||!("string"===typeof e||e instanceof String))throw new Error("You must pass a config object with a 'name' property to create or retrieve a surface");const r=Object.assign({},t,{tab:n}),i="".concat(e,"-").concat(n);return this.surfaceList.has(i)||this.surfaceList.set(i,r),this.renderVisor(this.el,this.surfaceList),this.visorComponent.getSurface(e,n)}isFullscreen(){return this.visorComponent.isFullscreen()}isOpen(){return this.visorComponent.isOpen()}close(){return this.visorComponent.close()}open(){return this.visorComponent.open()}toggle(){return this.visorComponent.toggle()}toggleFullScreen(){return this.visorComponent.toggleFullScreen()}bindKeys(){return this.visorComponent.bindKeys()}unbindKeys(){return this.visorComponent.unbindKeys()}setActiveTab(t){if(!this.visorComponent.state.tabs.has(t))throw new Error("Tab '".concat(t,"' does not exist"));this.visorComponent.setState({activeTab:t})}}e.Visor=o},67637:(t,e,n)=>{"use strict";function r(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function i(t){return(t=r(Math.abs(t)))?t[1]:NaN}n.r(e),n.d(e,{format:()=>f,formatDefaultLocale:()=>v,formatLocale:()=>m,formatPrefix:()=>p,formatSpecifier:()=>s,precisionFixed:()=>y,precisionPrefix:()=>b,precisionRound:()=>x});var a,o=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function s(t){return new c(t)}function c(t){if(!(e=o.exec(t)))throw new Error("invalid format: "+t);var e;this.fill=e[1]||" ",this.align=e[2]||">",this.sign=e[3]||"-",this.symbol=e[4]||"",this.zero=!!e[5],this.width=e[6]&&+e[6],this.comma=!!e[7],this.precision=e[8]&&+e[8].slice(1),this.trim=!!e[9],this.type=e[10]||""}function u(t,e){var n=r(t,e);if(!n)return t+"";var i=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+i:i.length>a+1?i.slice(0,a+1)+"."+i.slice(a+1):i+new Array(a-i.length+2).join("0")}s.prototype=c.prototype,c.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const l={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return u(100*t,e)},r:u,s:function(t,e){var n=r(t,e);if(!n)return t+"";var i=n[0],o=n[1],s=o-(a=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,c=i.length;return s===c?i:s>c?i+new Array(s-c+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+r(t,Math.max(0,e+s-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function h(t){return t}var d,f,p,g=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function m(t){var e,n,r=t.grouping&&t.thousands?(e=t.grouping,n=t.thousands,function(t,r){for(var i=t.length,a=[],o=0,s=e[0],c=0;i>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),a.push(t.substring(i-=s,i+s)),!((c+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}):h,o=t.currency,c=t.decimal,u=t.numerals?function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(t.numerals):h,d=t.percent||"%";function f(t){var e=(t=s(t)).fill,n=t.align,i=t.sign,h=t.symbol,f=t.zero,p=t.width,m=t.comma,v=t.precision,y=t.trim,b=t.type;"n"===b?(m=!0,b="g"):l[b]||(null==v&&(v=12),y=!0,b="g"),(f||"0"===e&&"="===n)&&(f=!0,e="0",n="=");var x="$"===h?o[0]:"#"===h&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",w="$"===h?o[1]:/[%p]/.test(b)?d:"",k=l[b],_=/[defgprs%]/.test(b);function A(t){var o,s,l,h=x,d=w;if("c"===b)d=k(t)+d,t="";else{var A=(t=+t)<0;if(t=k(Math.abs(t),v),y&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(i>0){if(!+t[r])break t;i=0}}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),A&&0===+t&&(A=!1),h=(A?"("===i?i:"-":"-"===i||"("===i?"":i)+h,d=("s"===b?g[8+a/3]:"")+d+(A&&"("===i?")":""),_)for(o=-1,s=t.length;++o<s;)if(48>(l=t.charCodeAt(o))||l>57){d=(46===l?c+t.slice(o+1):t.slice(o))+d,t=t.slice(0,o);break}}m&&!f&&(t=r(t,1/0));var C=h.length+t.length+d.length,S=C<p?new Array(p-C+1).join(e):"";switch(m&&f&&(t=r(S+t,S.length?p-d.length:1/0),S=""),n){case"<":t=h+t+d+S;break;case"=":t=h+S+t+d;break;case"^":t=S.slice(0,C=S.length>>1)+h+t+d+S.slice(C);break;default:t=S+h+t+d}return u(t)}return v=null==v?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),A.toString=function(){return t+""},A}return{format:f,formatPrefix:function(t,e){var n=f(((t=s(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(i(e)/3))),a=Math.pow(10,-r),o=g[8+r/3];return function(t){return n(a*t)+o}}}}function v(t){return d=m(t),f=d.format,p=d.formatPrefix,d}function y(t){return Math.max(0,-i(Math.abs(t)))}function b(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(i(e)/3)))-i(Math.abs(t)))}function x(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,i(e)-i(t))+1}v({decimal:".",thousands:",",grouping:[3],currency:["$",""]})},33641:(t,e,n)=>{"use strict";n.d(e,{r:()=>r});const r="4.17.0"},32129:t=>{var e=function(){"use strict";function t(t,e){return null!=e&&t instanceof e}var e,n,r;try{e=Map}catch(s){e=function(){}}try{n=Set}catch(s){n=function(){}}try{r=Promise}catch(s){r=function(){}}function i(a,s,c,u,l){"object"===typeof s&&(c=s.depth,u=s.prototype,l=s.includeNonEnumerable,s=s.circular);var h=[],d=[],f="undefined"!=typeof Buffer;return"undefined"==typeof s&&(s=!0),"undefined"==typeof c&&(c=1/0),function a(c,p){if(null===c)return null;if(0===p)return c;var g,m;if("object"!=typeof c)return c;if(t(c,e))g=new e;else if(t(c,n))g=new n;else if(t(c,r))g=new r((function(t,e){c.then((function(e){t(a(e,p-1))}),(function(t){e(a(t,p-1))}))}));else if(i.__isArray(c))g=[];else if(i.__isRegExp(c))g=new RegExp(c.source,o(c)),c.lastIndex&&(g.lastIndex=c.lastIndex);else if(i.__isDate(c))g=new Date(c.getTime());else{if(f&&Buffer.isBuffer(c))return g=Buffer.allocUnsafe?Buffer.allocUnsafe(c.length):new Buffer(c.length),c.copy(g),g;t(c,Error)?g=Object.create(c):"undefined"==typeof u?(m=Object.getPrototypeOf(c),g=Object.create(m)):(g=Object.create(u),m=u)}if(s){var v=h.indexOf(c);if(-1!=v)return d[v];h.push(c),d.push(g)}for(var y in t(c,e)&&c.forEach((function(t,e){var n=a(e,p-1),r=a(t,p-1);g.set(n,r)})),t(c,n)&&c.forEach((function(t){var e=a(t,p-1);g.add(e)})),c){var b;m&&(b=Object.getOwnPropertyDescriptor(m,y)),b&&null==b.set||(g[y]=a(c[y],p-1))}if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(c);for(y=0;y<x.length;y++){var w=x[y];(!(_=Object.getOwnPropertyDescriptor(c,w))||_.enumerable||l)&&(g[w]=a(c[w],p-1),_.enumerable||Object.defineProperty(g,w,{enumerable:!1}))}}if(l){var k=Object.getOwnPropertyNames(c);for(y=0;y<k.length;y++){var _,A=k[y];(_=Object.getOwnPropertyDescriptor(c,A))&&_.enumerable||(g[A]=a(c[A],p-1),Object.defineProperty(g,A,{enumerable:!1}))}}return g}(a,c)}function a(t){return Object.prototype.toString.call(t)}function o(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return i.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},i.__objToStr=a,i.__isDate=function(t){return"object"===typeof t&&"[object Date]"===a(t)},i.__isArray=function(t){return"object"===typeof t&&"[object Array]"===a(t)},i.__isRegExp=function(t){return"object"===typeof t&&"[object RegExp]"===a(t)},i.__getRegExpFlags=o,i}();t.exports&&(t.exports=e)},61243:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return(0,a.default)(t)};var r,i=n(73231),a=(r=i)&&r.__esModule?r:{default:r};t.exports=e.default},53584:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return"string"===typeof t&&n.test(t)};var n=/-webkit-|-moz-|-ms-/;t.exports=e.default},27954:(t,e,n)=>{"use strict";n.r(e),n.d(e,{clientPoint:()=>_t,create:()=>yt,creator:()=>c,customEvent:()=>ut,event:()=>it,local:()=>xt,matcher:()=>m,mouse:()=>At,namespace:()=>a,namespaces:()=>i,select:()=>vt,selectAll:()=>Ct,selection:()=>mt,selector:()=>l,selectorAll:()=>d,style:()=>M,touch:()=>St,touches:()=>Et,window:()=>N});var r="http://www.w3.org/1999/xhtml";const i={svg:"http://www.w3.org/2000/svg",xhtml:r,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function a(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),i.hasOwnProperty(e)?{space:i[e],local:t}:t}function o(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===r&&e.documentElement.namespaceURI===r?e.createElement(t):e.createElementNS(n,t)}}function s(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function c(t){var e=a(t);return(e.local?s:o)(e)}function u(){}function l(t){return null==t?u:function(){return this.querySelector(t)}}function h(){return[]}function d(t){return null==t?h:function(){return this.querySelectorAll(t)}}var f=function(t){return function(){return this.matches(t)}};if("undefined"!==typeof document){var p=document.documentElement;if(!p.matches){var g=p.webkitMatchesSelector||p.msMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector;f=function(t){return function(){return g.call(this,t)}}}}const m=f;function v(t){return new Array(t.length)}function y(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}y.prototype={constructor:y,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var b="$";function x(t,e,n,r,i,a){for(var o,s=0,c=e.length,u=a.length;s<u;++s)(o=e[s])?(o.__data__=a[s],r[s]=o):n[s]=new y(t,a[s]);for(;s<c;++s)(o=e[s])&&(i[s]=o)}function w(t,e,n,r,i,a,o){var s,c,u,l={},h=e.length,d=a.length,f=new Array(h);for(s=0;s<h;++s)(c=e[s])&&(f[s]=u=b+o.call(c,c.__data__,s,e),u in l?i[s]=c:l[u]=c);for(s=0;s<d;++s)(c=l[u=b+o.call(t,a[s],s,a)])?(r[s]=c,c.__data__=a[s],l[u]=null):n[s]=new y(t,a[s]);for(s=0;s<h;++s)(c=e[s])&&l[f[s]]===c&&(i[s]=c)}function k(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function _(t){return function(){this.removeAttribute(t)}}function A(t){return function(){this.removeAttributeNS(t.space,t.local)}}function C(t,e){return function(){this.setAttribute(t,e)}}function S(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function E(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function T(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function N(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function F(t){return function(){this.style.removeProperty(t)}}function D(t,e,n){return function(){this.style.setProperty(t,e,n)}}function I(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function M(t,e){return t.style.getPropertyValue(e)||N(t).getComputedStyle(t,null).getPropertyValue(e)}function O(t){return function(){delete this[t]}}function R(t,e){return function(){this[t]=e}}function z(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function B(t){return t.trim().split(/^|\s+/)}function L(t){return t.classList||new P(t)}function P(t){this._node=t,this._names=B(t.getAttribute("class")||"")}function j(t,e){for(var n=L(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function U(t,e){for(var n=L(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function W(t){return function(){j(this,t)}}function V(t){return function(){U(this,t)}}function q(t,e){return function(){(e.apply(this,arguments)?j:U)(this,t)}}function G(){this.textContent=""}function H(t){return function(){this.textContent=t}}function Y(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function X(){this.innerHTML=""}function K(t){return function(){this.innerHTML=t}}function Q(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Z(){this.nextSibling&&this.parentNode.appendChild(this)}function $(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function J(){return null}function tt(){var t=this.parentNode;t&&t.removeChild(this)}function et(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function nt(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}P.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var rt={},it=null;"undefined"!==typeof document&&("onmouseenter"in document.documentElement||(rt={mouseenter:"mouseover",mouseleave:"mouseout"}));function at(t,e,n){return t=ot(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function ot(t,e,n){return function(r){var i=it;it=r;try{t.call(this,this.__data__,e,n)}finally{it=i}}}function st(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,a=e.length;r<a;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function ct(t,e,n){var r=rt.hasOwnProperty(t.type)?at:ot;return function(i,a,o){var s,c=this.__on,u=r(e,a,o);if(c)for(var l=0,h=c.length;l<h;++l)if((s=c[l]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=u,s.capture=n),void(s.value=e);this.addEventListener(t.type,u,n),s={type:t.type,name:t.name,value:e,listener:u,capture:n},c?c.push(s):this.__on=[s]}}function ut(t,e,n,r){var i=it;t.sourceEvent=it,it=t;try{return e.apply(n,r)}finally{it=i}}function lt(t,e,n){var r=N(t),i=r.CustomEvent;"function"===typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function ht(t,e){return function(){return lt(this,t,e)}}function dt(t,e){return function(){return lt(this,t,e.apply(this,arguments))}}var ft=[null];function pt(t,e){this._groups=t,this._parents=e}function gt(){return new pt([[document.documentElement]],ft)}pt.prototype=gt.prototype={constructor:pt,select:function(t){"function"!==typeof t&&(t=l(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o,s=e[i],c=s.length,u=r[i]=new Array(c),h=0;h<c;++h)(a=s[h])&&(o=t.call(a,a.__data__,h,s))&&("__data__"in a&&(o.__data__=a.__data__),u[h]=o);return new pt(r,this._parents)},selectAll:function(t){"function"!==typeof t&&(t=d(t));for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var o,s=e[a],c=s.length,u=0;u<c;++u)(o=s[u])&&(r.push(t.call(o,o.__data__,u,s)),i.push(o));return new pt(r,i)},filter:function(t){"function"!==typeof t&&(t=m(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,c=r[i]=[],u=0;u<s;++u)(a=o[u])&&t.call(a,a.__data__,u,o)&&c.push(a);return new pt(r,this._parents)},data:function(t,e){if(!t)return p=new Array(this.size()),l=-1,this.each((function(t){p[++l]=t})),p;var n,r=e?w:x,i=this._parents,a=this._groups;"function"!==typeof t&&(n=t,t=function(){return n});for(var o=a.length,s=new Array(o),c=new Array(o),u=new Array(o),l=0;l<o;++l){var h=i[l],d=a[l],f=d.length,p=t.call(h,h&&h.__data__,l,i),g=p.length,m=c[l]=new Array(g),v=s[l]=new Array(g);r(h,d,m,v,u[l]=new Array(f),p,e);for(var y,b,k=0,_=0;k<g;++k)if(y=m[k]){for(k>=_&&(_=k+1);!(b=v[_])&&++_<g;);y._next=b||null}}return(s=new pt(s,i))._enter=c,s._exit=u,s},enter:function(){return new pt(this._enter||this._groups.map(v),this._parents)},exit:function(){return new pt(this._exit||this._groups.map(v),this._parents)},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var c,u=e[s],l=n[s],h=u.length,d=o[s]=new Array(h),f=0;f<h;++f)(c=u[f]||l[f])&&(d[f]=c);for(;s<r;++s)o[s]=e[s];return new pt(o,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&o!==r.nextSibling&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=k);for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o,s=n[a],c=s.length,u=i[a]=new Array(c),l=0;l<c;++l)(o=s[l])&&(u[l]=o);u.sort(e)}return new pt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,a=e[n],o=0,s=a.length;o<s;++o)(i=a[o])&&t.call(i,i.__data__,o,a);return this},attr:function(t,e){var n=a(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?A:_:"function"===typeof e?n.local?T:E:n.local?S:C)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?F:"function"===typeof e?I:D)(t,e,null==n?"":n)):M(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?O:"function"===typeof e?z:R)(t,e)):this.node()[t]},classed:function(t,e){var n=B(t+"");if(arguments.length<2){for(var r=L(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"===typeof e?q:e?W:V)(n,e))},text:function(t){return arguments.length?this.each(null==t?G:("function"===typeof t?Y:H)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?X:("function"===typeof t?Q:K)(t)):this.node().innerHTML},raise:function(){return this.each(Z)},lower:function(){return this.each($)},append:function(t){var e="function"===typeof t?t:c(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"===typeof t?t:c(t),r=null==e?J:"function"===typeof e?e:l(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(tt)},clone:function(t){return this.select(t?nt:et)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,a=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}(t+""),o=a.length;if(!(arguments.length<2)){for(s=e?ct:st,null==n&&(n=!1),r=0;r<o;++r)this.each(s(a[r],e,n));return this}var s=this.node().__on;if(s)for(var c,u=0,l=s.length;u<l;++u)for(r=0,c=s[u];r<o;++r)if((i=a[r]).type===c.type&&i.name===c.name)return c.value},dispatch:function(t,e){return this.each(("function"===typeof e?dt:ht)(t,e))}};const mt=gt;function vt(t){return"string"===typeof t?new pt([[document.querySelector(t)]],[document.documentElement]):new pt([[t]],ft)}function yt(t){return vt(c(t).call(document.documentElement))}var bt=0;function xt(){return new wt}function wt(){this._="@"+(++bt).toString(36)}function kt(){for(var t,e=it;t=e.sourceEvent;)e=t;return e}function _t(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}function At(t){var e=kt();return e.changedTouches&&(e=e.changedTouches[0]),_t(t,e)}function Ct(t){return"string"===typeof t?new pt([document.querySelectorAll(t)],[document.documentElement]):new pt([null==t?[]:t],ft)}function St(t,e,n){arguments.length<3&&(n=e,e=kt().changedTouches);for(var r,i=0,a=e?e.length:0;i<a;++i)if((r=e[i]).identifier===n)return _t(t,r);return null}function Et(t,e){null==e&&(e=kt().touches);for(var n=0,r=e?e.length:0,i=new Array(r);n<r;++n)i[n]=_t(t,e[n]);return i}wt.prototype=xt.prototype={constructor:wt,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}}},45355:t=>{"use strict";t.exports=function t(e,n){if(e===n)return!0;if(e&&n&&"object"==typeof e&&"object"==typeof n){if(e.constructor!==n.constructor)return!1;var r,i,a;if(Array.isArray(e)){if((r=e.length)!=n.length)return!1;for(i=r;0!==i--;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if((r=(a=Object.keys(e)).length)!==Object.keys(n).length)return!1;for(i=r;0!==i--;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return!1;for(i=r;0!==i--;){var o=a[i];if(!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n}},14110:t=>{"use strict";t.exports=function(t,e){e||(e={}),"function"===typeof e&&(e={cmp:e});var n,r="boolean"===typeof e.cycles&&e.cycles,i=e.cmp&&(n=e.cmp,function(t){return function(e,r){var i={key:e,value:t[e]},a={key:r,value:t[r]};return n(i,a)}}),a=[];return function t(e){if(e&&e.toJSON&&"function"===typeof e.toJSON&&(e=e.toJSON()),void 0!==e){if("number"==typeof e)return isFinite(e)?""+e:"null";if("object"!==typeof e)return JSON.stringify(e);var n,o;if(Array.isArray(e)){for(o="[",n=0;n<e.length;n++)n&&(o+=","),o+=t(e[n])||"null";return o+"]"}if(null===e)return"null";if(-1!==a.indexOf(e)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=a.push(e)-1,c=Object.keys(e).sort(i&&i(e));for(o="",n=0;n<c.length;n++){var u=c[n],l=t(e[u]);l&&(o&&(o+=","),o+=JSON.stringify(u)+":"+l)}return a.splice(s,1),"{"+o+"}"}}(t)}},76866:t=>{"use strict";var e=/-(.)/g;t.exports=function(t){return t.replace(e,(function(t,e){return e.toUpperCase()}))}},29522:(t,e,n)=>{"use strict";var r=n(76866),i=/^-ms-/;t.exports=function(t){return r(t.replace(i,"ms-"))}},10601:t=>{"use strict";function e(t){return function(){return t}}var n=function(){};n.thatReturns=e,n.thatReturnsFalse=e(!1),n.thatReturnsTrue=e(!0),n.thatReturnsNull=e(null),n.thatReturnsThis=function(){return this},n.thatReturnsArgument=function(t){return t},t.exports=n},54836:t=>{"use strict";var e=/([A-Z])/g;t.exports=function(t){return t.replace(e,"-$1").toLowerCase()}},90184:(t,e,n)=>{"use strict";var r=n(54836),i=/^ms-/;t.exports=function(t){return r(t).replace(i,"-ms-")}},75899:t=>{"use strict";t.exports=function(t){var e={};return function(n){return e.hasOwnProperty(n)||(e[n]=t.call(this,n)),e[n]}}},77600:(t,e,n)=>{"use strict";var r=n(10601);t.exports=r},64822:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowStart:!0,gridRowEnd:!0,gridColumn:!0,gridColumnStart:!0,gridColumnEnd:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};var r=["Webkit","ms","Moz","O"];Object.keys(n).forEach((function(t){r.forEach((function(e){n[function(t,e){return t+e.charAt(0).toUpperCase()+e.substring(1)}(e,t)]=n[t]}))}));var i={isUnitlessNumber:n,shorthandPropertyExpansions:{background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}}};e.default=i},20514:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(n(64822));i(n(77600));function i(t){return t&&t.__esModule?t:{default:t}}var a=r.default.isUnitlessNumber;e.default=function(t,e,n){return null==e||"boolean"===typeof e||""===e?"":isNaN(e)||0===e||a.hasOwnProperty(t)&&a[t]?""+e:("string"===typeof e&&(e=e.trim()),e+"px")}},8484:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.processStyleName=void 0,e.createMarkupForStyles=function(t,e){var n="";for(var i in t){var a=0===i.indexOf("--");if(t.hasOwnProperty(i)&&"label"!==i){var o=t[i];0,null!=o&&(a?n+=i+":"+o+";":(n+=s(i)+":",n+=(0,r.default)(i,o,e)+";"))}}return n||null};o(n(29522));var r=o(n(20514)),i=o(n(90184)),a=o(n(75899));o(n(77600));function o(t){return t&&t.__esModule?t:{default:t}}var s=e.processStyleName=(0,a.default)(i.default)},66678:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function r(t){if(function(t){return null===t||void 0===t||!1===t||"object"===("undefined"===typeof t?"undefined":n(t))&&0===Object.keys(t).length}(t))return null;if("object"!==("undefined"===typeof t?"undefined":n(t)))return t;for(var e={},r=Object.keys(t),a=!1,o=0;o<r.length;o++){var s=t[r[o]],c=i(s);null!==c&&c===s||(a=!0),null!==c&&(e[r[o]]=c)}return 0===Object.keys(e).length?null:a?e:t}function i(t){return Array.isArray(t)?function(t){var e=!1,n=[];return t.forEach((function(t){var r=i(t);null!==r&&r===t||(e=!0),null!==r&&n.push(r)})),0==n.length?null:e?n:t}(t):r(t)}e.default=i},70259:(t,e)=>{"use strict";function n(t,e){return t.charCodeAt(e++)+(t.charCodeAt(e++)<<8)+(t.charCodeAt(e++)<<16)+(t.charCodeAt(e)<<24)}function r(t,e){return t.charCodeAt(e++)+(t.charCodeAt(e++)<<8)}function i(t,e){return(65535&(t|=0))*(e|=0)+(((t>>>16)*e&65535)<<16)|0}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var a=1540483477,o=e^t.length,s=t.length,c=0;for(;s>=4;){var u=n(t,c);u=i(u,a),u=i(u^=u>>>24,a),o=i(o,a),o^=u,c+=4,s-=4}switch(s){case 3:o^=r(t,c),o=i(o^=t.charCodeAt(c+2)<<16,a);break;case 2:o=i(o^=r(t,c),a);break;case 1:o=i(o^=t.charCodeAt(c),a)}return o=i(o^=o>>>13,a),(o^=o>>>15)>>>0}},17975:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.compose=e.merge=e.$=e.style=e.presets=e.keyframes=e.fontFace=e.insertGlobal=e.insertRule=e.plugins=e.styleSheet=void 0,e.speedy=function(t){return h.speedy(t)},e.simulations=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];m=!!t},e.simulate=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(!(e=(0,o.default)(e)))return{};if(!m)return v||(console.warn("can't simulate without once calling simulations(true)"),v=!0),f||p||y||(console.warn("don't use simulation outside dev"),y=!0),{};return e.reduce((function(t,e){return t["data-simulate-"+x(e)]="",t}),{})},e.cssLabels=function(t){b=!!t},e.isLikeRule=k,e.idFor=_,e.css=H,e.rehydrate=function(t){(0,r.default)(F,t.reduce((function(t,e){return t[e]=!0,t}),{}))},e.flush=function(){F=h.inserted={},D=h.registered={},M={},h.flush(),h.inject()},e.select=X,e.parent=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return H(l({},t+" &",n))},e.media=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return H(l({},"@media "+t,n))},e.pseudo=K,e.active=function(t){return K(":active",t)},e.any=function(t){return K(":any",t)},e.checked=function(t){return K(":checked",t)},e.disabled=function(t){return K(":disabled",t)},e.empty=function(t){return K(":empty",t)},e.enabled=function(t){return K(":enabled",t)},e._default=function(t){return K(":default",t)},e.first=function(t){return K(":first",t)},e.firstChild=function(t){return K(":first-child",t)},e.firstOfType=function(t){return K(":first-of-type",t)},e.fullscreen=function(t){return K(":fullscreen",t)},e.focus=function(t){return K(":focus",t)},e.hover=function(t){return K(":hover",t)},e.indeterminate=function(t){return K(":indeterminate",t)},e.inRange=function(t){return K(":in-range",t)},e.invalid=function(t){return K(":invalid",t)},e.lastChild=function(t){return K(":last-child",t)},e.lastOfType=function(t){return K(":last-of-type",t)},e.left=function(t){return K(":left",t)},e.link=function(t){return K(":link",t)},e.onlyChild=function(t){return K(":only-child",t)},e.onlyOfType=function(t){return K(":only-of-type",t)},e.optional=function(t){return K(":optional",t)},e.outOfRange=function(t){return K(":out-of-range",t)},e.readOnly=function(t){return K(":read-only",t)},e.readWrite=function(t){return K(":read-write",t)},e.required=function(t){return K(":required",t)},e.right=function(t){return K(":right",t)},e.root=function(t){return K(":root",t)},e.scope=function(t){return K(":scope",t)},e.target=function(t){return K(":target",t)},e.valid=function(t){return K(":valid",t)},e.visited=function(t){return K(":visited",t)},e.dir=function(t,e){return K(":dir("+t+")",e)},e.lang=function(t,e){return K(":lang("+t+")",e)},e.not=function(t,e){var n=t.split(",").map((function(t){return t.trim()})).map((function(t){return":not("+t+")"}));if(1===n.length)return K(":not("+t+")",e);return X(n.join(""),e)},e.nthChild=function(t,e){return K(":nth-child("+t+")",e)},e.nthLastChild=function(t,e){return K(":nth-last-child("+t+")",e)},e.nthLastOfType=function(t,e){return K(":nth-last-of-type("+t+")",e)},e.nthOfType=function(t,e){return K(":nth-of-type("+t+")",e)},e.after=function(t){return K("::after",t)},e.before=function(t){return K("::before",t)},e.firstLetter=function(t){return K("::first-letter",t)},e.firstLine=function(t){return K("::first-line",t)},e.selection=function(t){return K("::selection",t)},e.backdrop=function(t){return K("::backdrop",t)},e.placeholder=function(t){return H({"::placeholder":t})},e.cssFor=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return(e=(0,o.default)(e))?e.map((function(t){var e={label:[]};return P(e,{src:t}),N(w(e),T(e)).join("")})).join(""):""},e.attribsFor=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return(e=(0,o.default)(e))?e.map((function(t){_(t);var e=Object.keys(t)[0];return e+'="'+(t[e]||"")+'"'})).join(" "):""};var r=u(n(26470)),i=n(1484),a=n(8484),o=u(n(66678)),s=n(99139),c=u(n(70259));function u(t){return t&&t.__esModule?t:{default:t}}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var h=e.styleSheet=new i.StyleSheet;h.inject();var d=e.plugins=h.plugins=new s.PluginSet([s.prefixes,s.contentWrap,s.fallbacks]);d.media=new s.PluginSet,d.fontFace=new s.PluginSet,d.keyframes=new s.PluginSet([s.prefixes,s.fallbacks]);var f=!1,p=!1,g="undefined"!==typeof window,m=f,v=!1,y=!1;var b=f;function x(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t.toLowerCase().replace(/[^a-z0-9]/g,e)}function w(t){var e=JSON.stringify(t),n=(0,c.default)(e).toString(36);return t.label&&t.label.length>0&&f?x(t.label.join("."),"-")+"-"+n:n}function k(t){var e=Object.keys(t).filter((function(t){return"toString"!==t}));return 1===e.length&&!!/data\-css\-([a-zA-Z0-9\-_]+)/.exec(e[0])}function _(t){var e=Object.keys(t).filter((function(t){return"toString"!==t}));if(1!==e.length)throw new Error("not a rule");var n=/data\-css\-([a-zA-Z0-9\-_]+)/.exec(e[0]);if(!n)throw new Error("not a rule");return n[1]}var A=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function C(t){if(-1===t.indexOf(","))return[t];for(var e,n=[],r=[],i=0;e=A.exec(t);)switch(e[0]){case"(":i++;break;case")":i--;break;case",":if(i)break;n.push(e.index)}for(e=n.length;e--;)r.unshift(t.slice(n[e]+1)),t=t.slice(0,n[e]);return r.unshift(t),r}function S(t,e){if(!t)return e.replace(/\&/g,"");if(!e)return".css-"+t+",[data-css-"+t+"]";var n=C(e).map((function(e){return e.indexOf("&")>=0?[e.replace(/\&/gm,".css-"+t),e.replace(/\&/gm,"[data-css-"+t+"]")].join(","):".css-"+t+e+",[data-css-"+t+"]"+e})).join(",");return m&&/^\&\:/.exec(e)&&!/\s/.exec(e)&&(n+=",.css-"+t+"[data-simulate-"+x(e)+"],[data-css-"+t+"][data-simulate-"+x(e)+"]"),n}function E(t){var e=t.selector,n=t.style,r=d.transform({selector:e,style:n});return r.selector+"{"+(0,a.createMarkupForStyles)(r.style)+"}"}function T(t){var e=void 0,n=void 0,r=void 0,i=void 0;return Object.keys(t).forEach((function(a){a.indexOf("&")>=0?(n=n||{})[a]=t[a]:0===a.indexOf("@media")?(r=r||{})[a]=T(t[a]):0===a.indexOf("@supports")?(i=i||{})[a]=T(t[a]):"label"===a?t.label.length>0&&((e=e||{}).label=b?t.label.join("."):""):(e=e||{})[a]=t[a]})),{plain:e,selects:n,medias:r,supports:i}}function N(t,e){var n=[],r=e.plain,i=e.selects,a=e.medias,o=e.supports;return r&&n.push(E({style:r,selector:S(t)})),i&&Object.keys(i).forEach((function(e){return n.push(E({style:i[e],selector:S(t,e)}))})),a&&Object.keys(a).forEach((function(e){return n.push(e+"{"+N(t,a[e]).join("")+"}")})),o&&Object.keys(o).forEach((function(e){return n.push(e+"{"+N(t,o[e]).join("")+"}")})),n}var F=h.inserted={};var D=h.registered={};function I(t){D[t.id]||(D[t.id]=t)}var M={};function O(t){if(I(t),function(t){if(!F[t.id]){F[t.id]=!0;var e=T(t.style),n=N(t.id,e);F[t.id]=!!g||n,n.forEach((function(t){return h.insert(t)}))}}(t),M[t.id])return M[t.id];var e=l({},"data-css-"+t.id,b&&t.label||"");return Object.defineProperty(e,"toString",{enumerable:!1,value:function(){return"css-"+t.id}}),M[t.id]=e,e}function R(t,e){var n=C(t).map((function(t){return t.indexOf("&")>=0?t:"&"+t})),r=C(e).map((function(t){return t.indexOf("&")>=0?t:"&"+t}));return r.reduce((function(t,e){return t.concat(n.map((function(t){return e.replace(/\&/g,t)})))}),[]).join(",")}function z(t,e){return t?"@supports "+t.substring(9)+" and "+e.substring(9):e}function B(t){for(var e=[],n=0;n<t.length;n++)e=Array.isArray(t[n])?e.concat(B(t[n])):e.concat(t[n]);return e}var L={"::placeholder":["::-webkit-input-placeholder","::-moz-placeholder","::-ms-input-placeholder"],":fullscreen":[":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"]};function P(t,e){var n=e.selector,r=void 0===n?"":n,i=e.mq,a=void 0===i?"":i,s=e.supp,c=void 0===s?"":s,u=e.src,l=void 0===u?{}:u;Array.isArray(l)||(l=[l]),(l=B(l)).forEach((function(e){if(k(e)){var n=function(t){if(k(t)){var e=D[_(t)];if(null==e)throw new Error("[glamor] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79");return e}return t}(e);if("css"!==n.type)throw new Error("cannot merge this rule");e=n.style}(e=(0,o.default)(e))&&e.composes&&P(t,{selector:r,mq:a,supp:c,src:e.composes}),Object.keys(e||{}).forEach((function(n){if(function(t){for(var e=[":",".","[",">"," "],n=!1,r=t.charAt(0),i=0;i<e.length;i++)if(r===e[i]){n=!0;break}return n||t.indexOf("&")>=0}(n))L[n]&&L[n].forEach((function(i){return P(t,{selector:R(r,i),mq:a,supp:c,src:e[n]})})),P(t,{selector:R(r,n),mq:a,supp:c,src:e[n]});else if(function(t){return 0===t.indexOf("@media")}(n))P(t,{selector:r,mq:(o=a,s=n,o?"@media "+o.substring(6)+" and "+s.substring(6):s),supp:c,src:e[n]});else if(function(t){return 0===t.indexOf("@supports")}(n))P(t,{selector:r,mq:a,supp:z(c,n),src:e[n]});else if("composes"===n);else{var i=t;c&&(i[c]=i[c]||{},i=i[c]),a&&(i[a]=i[a]||{},i=i[a]),r&&(i[r]=i[r]||{},i=i[r]),"label"===n?b&&(t.label=t.label.concat(e.label)):i[n]=e[n]}var o,s}))}))}function j(t){var e={label:[]};return P(e,{src:t}),O({id:w(e),style:e,label:b?e.label.join("."):"",type:"css"})}var U={};Object.defineProperty(U,"toString",{enumerable:!1,value:function(){return"css-nil"}});var W="undefined"!==typeof WeakMap?[U,new WeakMap,new WeakMap,new WeakMap]:[U],V=!1;var q,G="undefined"!==typeof WeakMap?(q=j,function(t){if(W[t.length]){for(var e=W[t.length],n=0;n<t.length-1;)e.has(t[n])||e.set(t[n],new WeakMap),e=e.get(t[n]),n++;if(e.has(t[t.length-1])){var r=e.get(t[n]);if(D[r.toString().substring(4)])return r}}var i=q(t);if(W[t.length]){for(var a=0,o=W[t.length];a<t.length-1;)o=o.get(t[a]),a++;try{o.set(t[a],i)}catch(c){var s;f&&!V&&(V=!0,(s=console).warn.apply(s,["failed setting the WeakMap cache for args:"].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(t))),console.warn("this should NOT happen, please file a bug on the github repo."))}}return i}):j;function H(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(e[0]&&e[0].length&&e[0].raw)throw new Error("you forgot to include glamor/babel in your babel plugins.");return(e=(0,o.default)(e))?G(e):U}H.insert=function(t){var e={id:w(t),css:t,type:"raw"};I(e),F[e.id]||(h.insert(e.css),F[e.id]=!!g||[e.css])};e.insertRule=H.insert;H.global=function(t,e){if(e=(0,o.default)(e))return H.insert(E({selector:t,style:e}))};e.insertGlobal=H.global;H.keyframes=function(t,e){e||(e=t,t="animation");var n={id:w({name:t,kfs:e=(0,o.default)(e)||{}}),type:"keyframes",name:t,keyframes:e};return I(n),function(t){if(!F[t.id]){var e=Object.keys(t.keyframes).map((function(e){var n=d.keyframes.transform({id:t.id,name:e,style:t.keyframes[e]});return n.name+"{"+(0,a.createMarkupForStyles)(n.style)+"}"})).join(""),n=["-webkit-","-moz-","-o-",""].map((function(n){return"@"+n+"keyframes "+t.name+"_"+t.id+"{"+e+"}"}));n.forEach((function(t){return h.insert(t)})),F[t.id]=!!g||n}}(n),t+"_"+n.id},H.fontFace=function(t){var e={id:w(t=(0,o.default)(t)),type:"font-face",font:t};return I(e),function(t){if(!F[t.id]){var e="@font-face{"+(0,a.createMarkupForStyles)(t.font)+"}";h.insert(e),F[t.id]=!!g||[e]}}(e),t.fontFamily};e.fontFace=H.fontFace,e.keyframes=H.keyframes;e.presets={mobile:"(min-width: 400px)",Mobile:"@media (min-width: 400px)",phablet:"(min-width: 550px)",Phablet:"@media (min-width: 550px)",tablet:"(min-width: 750px)",Tablet:"@media (min-width: 750px)",desktop:"(min-width: 1000px)",Desktop:"@media (min-width: 1000px)",hd:"(min-width: 1200px)",Hd:"@media (min-width: 1200px)"};var Y=e.style=H;function X(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t?H(l({},t,n)):Y(n)}e.$=X;e.merge=H,e.compose=H;function K(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return H(l({},t,n))}},99139:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};e.PluginSet=c,e.fallbacks=function(t){if(Object.keys(t.style).map((function(e){return Array.isArray(t.style[e])})).indexOf(!0)>=0){var e=t.style,n=Object.keys(e).reduce((function(t,n){return t[n]=Array.isArray(e[n])?e[n].join("; "+(0,a.processStyleName)(n)+": "):e[n],t}),{});return(0,i.default)({},t,{style:n})}return t},e.contentWrap=function(t){if(t.style.content){var e=t.style.content;return u.indexOf(e)>=0||/^(attr|calc|counters?|url)\(/.test(e)?t:e.charAt(0)!==e.charAt(e.length-1)||'"'!==e.charAt(0)&&"'"!==e.charAt(0)?r({},t,{style:r({},t.style,{content:'"'+e+'"'})}):t}return t},e.prefixes=function(t){return(0,i.default)({},t,{style:(0,o.default)(r({},t.style))})};var i=s(n(26470)),a=n(8484),o=s(n(16084));function s(t){return t&&t.__esModule?t:{default:t}}function c(t){this.fns=t||[]}(0,i.default)(c.prototype,{add:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach((function(e){t.fns.indexOf(e)>=0||(t.fns=[e].concat(t.fns))}))},remove:function(t){this.fns=this.fns.filter((function(e){return e!==t}))},clear:function(){this.fns=[]},transform:function(t){return this.fns.reduce((function(t,e){return e(t)}),t)}});var u=["normal","none","counter","open-quote","close-quote","no-open-quote","no-close-quote","initial","inherit"]},16084:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){for(var e in t){var n=t[e],r=(0,a.default)(v,e,n,t,y);r&&(t[e]=r),(0,i.default)(y,e,t)}return t};var r=m(n(48155)),i=m(n(56083)),a=m(n(8713)),o=m(n(19618)),s=m(n(244)),c=m(n(80966)),u=m(n(40699)),l=m(n(83657)),h=m(n(54412)),d=m(n(86407)),f=m(n(97287)),p=m(n(93518)),g=m(n(92995));function m(t){return t&&t.__esModule?t:{default:t}}var v=[s.default,o.default,c.default,l.default,h.default,d.default,f.default,p.default,g.default,u.default],y=r.default.prefixMap},1484:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StyleSheet=f;var r,i=n(26470),a=(r=i)&&r.__esModule?r:{default:r};function o(t){return t[t.length-1]}function s(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}var c="undefined"!==typeof window,u=!1,l=!1,h=function(){if(c){var t=document.createElement("div");return t.innerHTML="\x3c!--[if lt IE 10]><i></i><![endif]--\x3e",1===t.getElementsByTagName("i").length}}();function d(){var t=document.createElement("style");return t.type="text/css",t.setAttribute("data-glamor",""),t.appendChild(document.createTextNode("")),(document.head||document.getElementsByTagName("head")[0]).appendChild(t),t}function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.speedy,n=void 0===e?!u&&!l:e,r=t.maxLength,i=void 0===r?c&&h?4e3:65e3:r;this.isSpeedy=n,this.sheet=void 0,this.tags=[],this.maxLength=i,this.ctr=0}(0,a.default)(f.prototype,{getSheet:function(){return s(o(this.tags))},inject:function(){var t=this;if(this.injected)throw new Error("already injected stylesheet!");c?this.tags[0]=d():this.sheet={cssRules:[],insertRule:function(e){t.sheet.cssRules.push({cssText:e})}},this.injected=!0},speedy:function(t){if(0!==this.ctr)throw new Error("cannot change speedy mode after inserting any rule to sheet. Either call speedy("+t+") earlier in your app, or call flush() before speedy("+t+")");this.isSpeedy=!!t},_insert:function(t){try{var e=this.getSheet();e.insertRule(t,-1!==t.indexOf("@import")?0:e.cssRules.length)}catch(n){u&&console.warn("whoops, illegal rule inserted",t)}},insert:function(t){if(c)if(this.isSpeedy&&this.getSheet().insertRule)this._insert(t);else if(-1!==t.indexOf("@import")){var e=o(this.tags);e.insertBefore(document.createTextNode(t),e.firstChild)}else o(this.tags).appendChild(document.createTextNode(t));else this.sheet.insertRule(t,-1!==t.indexOf("@import")?0:this.sheet.cssRules.length);return this.ctr++,c&&this.ctr%this.maxLength===0&&this.tags.push(d()),this.ctr-1},delete:function(t){return this.replace(t,"")},flush:function(){c?(this.tags.forEach((function(t){return t.parentNode.removeChild(t)})),this.tags=[],this.sheet=null,this.ctr=0):this.sheet.cssRules=[],this.injected=!1},rules:function(){if(!c)return this.sheet.cssRules;var t=[];return this.tags.forEach((function(e){return t.splice.apply(t,[t.length,0].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(Array.from(s(e).cssRules))))})),t}})},73231:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>s});var r=/[A-Z]/g,i=/^ms-/,a={};function o(t){return"-"+t.toLowerCase()}const s=function(t){if(a.hasOwnProperty(t))return a[t];var e=t.replace(r,o);return a[t]=i.test(e)?"-"+e:e}},244:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("string"===typeof e&&!(0,a.default)(e)&&e.indexOf("cross-fade(")>-1)return o.map((function(t){return e.replace(/cross-fade\(/g,t+"cross-fade(")}))};var r,i=n(53584),a=(r=i)&&r.__esModule?r:{default:r};var o=["-webkit-",""];t.exports=e.default},19618:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("cursor"===t&&r.hasOwnProperty(e))return n.map((function(t){return t+e}))};var n=["-webkit-","-moz-",""],r={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};t.exports=e.default},80966:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("string"===typeof e&&!(0,a.default)(e)&&e.indexOf("filter(")>-1)return o.map((function(t){return e.replace(/filter\(/g,t+"filter(")}))};var r,i=n(53584),a=(r=i)&&r.__esModule?r:{default:r};var o=["-webkit-",""];t.exports=e.default},40699:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("display"===t&&n.hasOwnProperty(e))return n[e]};var n={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};t.exports=e.default},83657:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,i){"flexDirection"===t&&"string"===typeof e&&(e.indexOf("column")>-1?i.WebkitBoxOrient="vertical":i.WebkitBoxOrient="horizontal",e.indexOf("reverse")>-1?i.WebkitBoxDirection="reverse":i.WebkitBoxDirection="normal");r.hasOwnProperty(t)&&(i[r[t]]=n[e]||e)};var n={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},r={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};t.exports=e.default},54412:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("string"===typeof e&&!(0,a.default)(e)&&s.test(e))return o.map((function(t){return t+e}))};var r,i=n(53584),a=(r=i)&&r.__esModule?r:{default:r};var o=["-webkit-","-moz-",""],s=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;t.exports=e.default},86407:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("string"===typeof e&&!(0,a.default)(e)&&e.indexOf("image-set(")>-1)return o.map((function(t){return e.replace(/image-set\(/g,t+"image-set(")}))};var r,i=n(53584),a=(r=i)&&r.__esModule?r:{default:r};var o=["-webkit-",""];t.exports=e.default},97287:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("position"===t&&"sticky"===e)return["-webkit-sticky","sticky"]},t.exports=e.default},93518:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if(r.hasOwnProperty(t)&&i.hasOwnProperty(e))return n.map((function(t){return t+e}))};var n=["-webkit-","-moz-",""],r={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},i={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};t.exports=e.default},92995:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n,o){if("string"===typeof e&&s.hasOwnProperty(t)){var u=function(t,e){if((0,i.default)(t))return t;for(var n=t.split(/,(?![^()]*(?:\([^()]*\))?\))/g),a=0,o=n.length;a<o;++a){var s=n[a],u=[s];for(var l in e){var h=(0,r.default)(l);if(s.indexOf(h)>-1&&"order"!==h)for(var d=e[l],f=0,p=d.length;f<p;++f)u.unshift(s.replace(h,c[d[f]]+h))}n[a]=u.join(",")}return n.join(",")}(e,o),l=u.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter((function(t){return!/-moz-|-ms-/.test(t)})).join(",");if(t.indexOf("Webkit")>-1)return l;var h=u.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter((function(t){return!/-webkit-|-ms-/.test(t)})).join(",");return t.indexOf("Moz")>-1?h:(n["Webkit"+(0,a.default)(t)]=l,n["Moz"+(0,a.default)(t)]=h,u)}};var r=o(n(61243)),i=o(n(53584)),a=o(n(52753));function o(t){return t&&t.__esModule?t:{default:t}}var s={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},c={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};t.exports=e.default},48155:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=["Webkit"],r=["Moz"],i=["ms"],a=["Webkit","Moz"],o=["Webkit","ms"],s=["Webkit","Moz","ms"];e.default={plugins:[],prefixMap:{appearance:a,userSelect:s,textEmphasisPosition:n,textEmphasis:n,textEmphasisStyle:n,textEmphasisColor:n,boxDecorationBreak:n,clipPath:n,maskImage:n,maskMode:n,maskRepeat:n,maskPosition:n,maskClip:n,maskOrigin:n,maskSize:n,maskComposite:n,mask:n,maskBorderSource:n,maskBorderMode:n,maskBorderSlice:n,maskBorderWidth:n,maskBorderOutset:n,maskBorderRepeat:n,maskBorder:n,maskType:n,textDecorationStyle:n,textDecorationSkip:n,textDecorationLine:n,textDecorationColor:n,filter:n,fontFeatureSettings:n,breakAfter:s,breakBefore:s,breakInside:s,columnCount:a,columnFill:a,columnGap:a,columnRule:a,columnRuleColor:a,columnRuleStyle:a,columnRuleWidth:a,columns:a,columnSpan:a,columnWidth:a,writingMode:o,flex:n,flexBasis:n,flexDirection:n,flexGrow:n,flexFlow:n,flexShrink:n,flexWrap:n,alignContent:n,alignItems:n,alignSelf:n,justifyContent:n,order:n,transform:n,transformOrigin:n,transformOriginX:n,transformOriginY:n,backfaceVisibility:n,perspective:n,perspectiveOrigin:n,transformStyle:n,transformOriginZ:n,animation:n,animationDelay:n,animationDirection:n,animationFillMode:n,animationDuration:n,animationIterationCount:n,animationName:n,animationPlayState:n,animationTimingFunction:n,backdropFilter:n,fontKerning:n,scrollSnapType:o,scrollSnapPointsX:o,scrollSnapPointsY:o,scrollSnapDestination:o,scrollSnapCoordinate:o,shapeImageThreshold:n,shapeImageMargin:n,shapeImageOutside:n,hyphens:s,flowInto:o,flowFrom:o,regionFragment:o,textAlignLast:r,tabSize:r,wrapFlow:i,wrapThrough:i,wrapMargin:i,gridTemplateColumns:i,gridTemplateRows:i,gridTemplateAreas:i,gridTemplate:i,gridAutoColumns:i,gridAutoRows:i,gridAutoFlow:i,grid:i,gridRowStart:i,gridColumnStart:i,gridRowEnd:i,gridRow:i,gridColumn:i,gridColumnEnd:i,gridColumnGap:i,gridRowGap:i,gridArea:i,gridGap:i,textSizeAdjust:o,borderImage:n,borderImageOutset:n,borderImageRepeat:n,borderImageSlice:n,borderImageSource:n,borderImageWidth:n,transitionDelay:n,transitionDuration:n,transitionProperty:n,transitionTimingFunction:n}},t.exports=e.default},52753:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},t.exports=e.default},56083:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){if(t.hasOwnProperty(e))for(var r=t[e],i=0,o=r.length;i<o;++i)n[r[i]+(0,a.default)(e)]=n[e]};var r,i=n(52753),a=(r=i)&&r.__esModule?r:{default:r};t.exports=e.default},8713:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n,r,i){for(var a=0,o=t.length;a<o;++a){var s=t[a](e,n,r,i);if(s)return s}},t.exports=e.default},61072:t=>{t.exports=n;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(C){}function n(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function r(t){return!0===(t&&t.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var i={},a={};function o(t,e){var n,r,o;return e?(o=0<=(t>>>=0)&&t<256)&&(r=a[t])?r:(n=c(t,(0|t)<0?-1:0,!0),o&&(a[t]=n),n):(o=-128<=(t|=0)&&t<128)&&(r=i[t])?r:(n=c(t,t<0?-1:0,!1),o&&(i[t]=n),n)}function s(t,e){if(isNaN(t))return e?v:m;if(e){if(t<0)return v;if(t>=f)return k}else{if(t<=-p)return _;if(t+1>=p)return w}return t<0?s(-t,e).neg():c(t%d|0,t/d|0,e)}function c(t,e,r){return new n(t,e,r)}n.fromInt=o,n.fromNumber=s,n.fromBits=c;var u=Math.pow;function l(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return m;if("number"===typeof e?(n=e,e=!1):e=!!e,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return l(t.substring(1),e,n).neg();for(var i=s(u(n,8)),a=m,o=0;o<t.length;o+=8){var c=Math.min(8,t.length-o),h=parseInt(t.substring(o,o+c),n);if(c<8){var d=s(u(n,c));a=a.mul(d).add(s(h))}else a=(a=a.mul(i)).add(s(h))}return a.unsigned=e,a}function h(t,e){return"number"===typeof t?s(t,e):"string"===typeof t?l(t,e):c(t.low,t.high,"boolean"===typeof e?e:t.unsigned)}n.fromString=l,n.fromValue=h;var d=4294967296,f=d*d,p=f/2,g=o(1<<24),m=o(0);n.ZERO=m;var v=o(0,!0);n.UZERO=v;var y=o(1);n.ONE=y;var b=o(1,!0);n.UONE=b;var x=o(-1);n.NEG_ONE=x;var w=c(-1,2147483647,!1);n.MAX_VALUE=w;var k=c(-1,-1,!0);n.MAX_UNSIGNED_VALUE=k;var _=c(0,-2147483648,!1);n.MIN_VALUE=_;var A=n.prototype;A.toInt=function(){return this.unsigned?this.low>>>0:this.low},A.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},A.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(_)){var e=s(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var i=s(u(t,6),this.unsigned),a=this,o="";;){var c=a.div(i),l=(a.sub(c.mul(i)).toInt()>>>0).toString(t);if((a=c).isZero())return l+o;for(;l.length<6;)l="0"+l;o=""+l+o}},A.getHighBits=function(){return this.high},A.getHighBitsUnsigned=function(){return this.high>>>0},A.getLowBits=function(){return this.low},A.getLowBitsUnsigned=function(){return this.low>>>0},A.getNumBitsAbs=function(){if(this.isNegative())return this.eq(_)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},A.isZero=function(){return 0===this.high&&0===this.low},A.eqz=A.isZero,A.isNegative=function(){return!this.unsigned&&this.high<0},A.isPositive=function(){return this.unsigned||this.high>=0},A.isOdd=function(){return 1===(1&this.low)},A.isEven=function(){return 0===(1&this.low)},A.equals=function(t){return r(t)||(t=h(t)),(this.unsigned===t.unsigned||this.high>>>31!==1||t.high>>>31!==1)&&(this.high===t.high&&this.low===t.low)},A.eq=A.equals,A.notEquals=function(t){return!this.eq(t)},A.neq=A.notEquals,A.ne=A.notEquals,A.lessThan=function(t){return this.comp(t)<0},A.lt=A.lessThan,A.lessThanOrEqual=function(t){return this.comp(t)<=0},A.lte=A.lessThanOrEqual,A.le=A.lessThanOrEqual,A.greaterThan=function(t){return this.comp(t)>0},A.gt=A.greaterThan,A.greaterThanOrEqual=function(t){return this.comp(t)>=0},A.gte=A.greaterThanOrEqual,A.ge=A.greaterThanOrEqual,A.compare=function(t){if(r(t)||(t=h(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},A.comp=A.compare,A.negate=function(){return!this.unsigned&&this.eq(_)?_:this.not().add(y)},A.neg=A.negate,A.add=function(t){r(t)||(t=h(t));var e=this.high>>>16,n=65535&this.high,i=this.low>>>16,a=65535&this.low,o=t.high>>>16,s=65535&t.high,u=t.low>>>16,l=0,d=0,f=0,p=0;return f+=(p+=a+(65535&t.low))>>>16,d+=(f+=i+u)>>>16,l+=(d+=n+s)>>>16,l+=e+o,c((f&=65535)<<16|(p&=65535),(l&=65535)<<16|(d&=65535),this.unsigned)},A.subtract=function(t){return r(t)||(t=h(t)),this.add(t.neg())},A.sub=A.subtract,A.multiply=function(t){if(this.isZero())return m;if(r(t)||(t=h(t)),e)return c(e.mul(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned);if(t.isZero())return m;if(this.eq(_))return t.isOdd()?_:m;if(t.eq(_))return this.isOdd()?_:m;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(g)&&t.lt(g))return s(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,i=65535&this.high,a=this.low>>>16,o=65535&this.low,u=t.high>>>16,l=65535&t.high,d=t.low>>>16,f=65535&t.low,p=0,v=0,y=0,b=0;return y+=(b+=o*f)>>>16,v+=(y+=a*f)>>>16,y&=65535,v+=(y+=o*d)>>>16,p+=(v+=i*f)>>>16,v&=65535,p+=(v+=a*d)>>>16,v&=65535,p+=(v+=o*l)>>>16,p+=n*f+i*d+a*l+o*u,c((y&=65535)<<16|(b&=65535),(p&=65535)<<16|(v&=65535),this.unsigned)},A.mul=A.multiply,A.divide=function(t){if(r(t)||(t=h(t)),t.isZero())throw Error("division by zero");var n,i,a;if(e)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?c((this.unsigned?e.div_u:e.div_s)(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?v:m;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return v;if(t.gt(this.shru(1)))return b;a=v}else{if(this.eq(_))return t.eq(y)||t.eq(x)?_:t.eq(_)?y:(n=this.shr(1).div(t).shl(1)).eq(m)?t.isNegative()?y:x:(i=this.sub(t.mul(n)),a=n.add(i.div(t)));if(t.eq(_))return this.unsigned?v:m;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();a=m}for(i=this;i.gte(t);){n=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),l=o<=48?1:u(2,o-48),d=s(n),f=d.mul(t);f.isNegative()||f.gt(i);)f=(d=s(n-=l,this.unsigned)).mul(t);d.isZero()&&(d=y),a=a.add(d),i=i.sub(f)}return a},A.div=A.divide,A.modulo=function(t){return r(t)||(t=h(t)),e?c((this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},A.mod=A.modulo,A.rem=A.modulo,A.not=function(){return c(~this.low,~this.high,this.unsigned)},A.and=function(t){return r(t)||(t=h(t)),c(this.low&t.low,this.high&t.high,this.unsigned)},A.or=function(t){return r(t)||(t=h(t)),c(this.low|t.low,this.high|t.high,this.unsigned)},A.xor=function(t){return r(t)||(t=h(t)),c(this.low^t.low,this.high^t.high,this.unsigned)},A.shiftLeft=function(t){return r(t)&&(t=t.toInt()),0===(t&=63)?this:t<32?c(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):c(0,this.low<<t-32,this.unsigned)},A.shl=A.shiftLeft,A.shiftRight=function(t){return r(t)&&(t=t.toInt()),0===(t&=63)?this:t<32?c(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):c(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},A.shr=A.shiftRight,A.shiftRightUnsigned=function(t){if(r(t)&&(t=t.toInt()),0===(t&=63))return this;var e=this.high;return t<32?c(this.low>>>t|e<<32-t,e>>>t,this.unsigned):c(32===t?e:e>>>t-32,0,this.unsigned)},A.shru=A.shiftRightUnsigned,A.shr_u=A.shiftRightUnsigned,A.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},A.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},A.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},A.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},A.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},n.fromBytes=function(t,e,r){return r?n.fromBytesLE(t,e):n.fromBytesBE(t,e)},n.fromBytesLE=function(t,e){return new n(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},n.fromBytesBE=function(t,e){return new n(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)}},88027:(t,e,n)=>{"use strict";const r=n(72453),i=Symbol("max"),a=Symbol("length"),o=Symbol("lengthCalculator"),s=Symbol("allowStale"),c=Symbol("maxAge"),u=Symbol("dispose"),l=Symbol("noDisposeOnSet"),h=Symbol("lruList"),d=Symbol("cache"),f=Symbol("updateAgeOnGet"),p=()=>1;const g=(t,e,n)=>{const r=t[d].get(e);if(r){const e=r.value;if(m(t,e)){if(y(t,r),!t[s])return}else n&&(t[f]&&(r.value.now=Date.now()),t[h].unshiftNode(r));return e.value}},m=(t,e)=>{if(!e||!e.maxAge&&!t[c])return!1;const n=Date.now()-e.now;return e.maxAge?n>e.maxAge:t[c]&&n>t[c]},v=t=>{if(t[a]>t[i])for(let e=t[h].tail;t[a]>t[i]&&null!==e;){const n=e.prev;y(t,e),e=n}},y=(t,e)=>{if(e){const n=e.value;t[u]&&t[u](n.key,n.value),t[a]-=n.length,t[d].delete(n.key),t[h].removeNode(e)}};class b{constructor(t,e,n,r,i){this.key=t,this.value=e,this.length=n,this.now=r,this.maxAge=i||0}}const x=(t,e,n,r)=>{let i=n.value;m(t,i)&&(y(t,n),t[s]||(i=void 0)),i&&e.call(r,i.value,i.key,t)};t.exports=class{constructor(t){if("number"===typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!==typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[i]=t.max||1/0;const e=t.length||p;if(this[o]="function"!==typeof e?p:e,this[s]=t.stale||!1,t.maxAge&&"number"!==typeof t.maxAge)throw new TypeError("maxAge must be a number");this[c]=t.maxAge||0,this[u]=t.dispose,this[l]=t.noDisposeOnSet||!1,this[f]=t.updateAgeOnGet||!1,this.reset()}set max(t){if("number"!==typeof t||t<0)throw new TypeError("max must be a non-negative number");this[i]=t||1/0,v(this)}get max(){return this[i]}set allowStale(t){this[s]=!!t}get allowStale(){return this[s]}set maxAge(t){if("number"!==typeof t)throw new TypeError("maxAge must be a non-negative number");this[c]=t,v(this)}get maxAge(){return this[c]}set lengthCalculator(t){"function"!==typeof t&&(t=p),t!==this[o]&&(this[o]=t,this[a]=0,this[h].forEach((t=>{t.length=this[o](t.value,t.key),this[a]+=t.length}))),v(this)}get lengthCalculator(){return this[o]}get length(){return this[a]}get itemCount(){return this[h].length}rforEach(t,e){e=e||this;for(let n=this[h].tail;null!==n;){const r=n.prev;x(this,t,n,e),n=r}}forEach(t,e){e=e||this;for(let n=this[h].head;null!==n;){const r=n.next;x(this,t,n,e),n=r}}keys(){return this[h].toArray().map((t=>t.key))}values(){return this[h].toArray().map((t=>t.value))}reset(){this[u]&&this[h]&&this[h].length&&this[h].forEach((t=>this[u](t.key,t.value))),this[d]=new Map,this[h]=new r,this[a]=0}dump(){return this[h].map((t=>!m(this,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)})).toArray().filter((t=>t))}dumpLru(){return this[h]}set(t,e,n){if((n=n||this[c])&&"number"!==typeof n)throw new TypeError("maxAge must be a number");const r=n?Date.now():0,s=this[o](e,t);if(this[d].has(t)){if(s>this[i])return y(this,this[d].get(t)),!1;const o=this[d].get(t).value;return this[u]&&(this[l]||this[u](t,o.value)),o.now=r,o.maxAge=n,o.value=e,this[a]+=s-o.length,o.length=s,this.get(t),v(this),!0}const f=new b(t,e,s,r,n);return f.length>this[i]?(this[u]&&this[u](t,e),!1):(this[a]+=f.length,this[h].unshift(f),this[d].set(t,this[h].head),v(this),!0)}has(t){if(!this[d].has(t))return!1;const e=this[d].get(t).value;return!m(this,e)}get(t){return g(this,t,!0)}peek(t){return g(this,t,!1)}pop(){const t=this[h].tail;return t?(y(this,t),t.value):null}del(t){y(this,this[d].get(t))}load(t){this.reset();const e=Date.now();for(let n=t.length-1;n>=0;n--){const r=t[n],i=r.e||0;if(0===i)this.set(r.k,r.v);else{const t=i-e;t>0&&this.set(r.k,r.v,t)}}}prune(){this[d].forEach(((t,e)=>g(this,e,!1)))}}},26470:t=>{"use strict";var e=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(i){return!1}}()?Object.assign:function(t,i){for(var a,o,s=function(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),c=1;c<arguments.length;c++){for(var u in a=Object(arguments[c]))n.call(a,u)&&(s[u]=a[u]);if(e){o=e(a);for(var l=0;l<o.length;l++)r.call(a,o[l])&&(s[o[l]]=a[o[l]])}}return s}},28927:(t,e,n)=>{"use strict";function r(){}n.r(e),n.d(e,{Component:()=>z,cloneElement:()=>l,createElement:()=>s,default:()=>L,h:()=>s,options:()=>i,render:()=>B,rerender:()=>p});var i={},a=[],o=[];function s(t,e){var n,s,c,u,l=o;for(u=arguments.length;u-- >2;)a.push(arguments[u]);for(e&&null!=e.children&&(a.length||a.push(e.children),delete e.children);a.length;)if((s=a.pop())&&void 0!==s.pop)for(u=s.length;u--;)a.push(s[u]);else"boolean"===typeof s&&(s=null),(c="function"!==typeof t)&&(null==s?s="":"number"===typeof s?s=String(s):"string"!==typeof s&&(c=!1)),c&&n?l[l.length-1]+=s:l===o?l=[s]:l.push(s),n=c;var h=new r;return h.nodeName=t,h.children=l,h.attributes=null==e?void 0:e,h.key=null==e?void 0:e.key,void 0!==i.vnode&&i.vnode(h),h}function c(t,e){for(var n in e)t[n]=e[n];return t}var u="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function l(t,e){return s(t.nodeName,c(c({},t.attributes),e),arguments.length>2?[].slice.call(arguments,2):t.children)}var h=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,d=[];function f(t){!t._dirty&&(t._dirty=!0)&&1==d.push(t)&&(i.debounceRendering||u)(p)}function p(){var t,e=d;for(d=[];t=e.pop();)t._dirty&&O(t)}function g(t,e,n){return"string"===typeof e||"number"===typeof e?void 0!==t.splitText:"string"===typeof e.nodeName?!t._componentConstructor&&m(t,e.nodeName):n||t._componentConstructor===e.nodeName}function m(t,e){return t.normalizedNodeName===e||t.nodeName.toLowerCase()===e.toLowerCase()}function v(t){var e=c({},t.attributes);e.children=t.children;var n=t.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===e[r]&&(e[r]=n[r]);return e}function y(t){var e=t.parentNode;e&&e.removeChild(t)}function b(t,e,n,r,i){if("className"===e&&(e="class"),"key"===e);else if("ref"===e)n&&n(null),r&&r(t);else if("class"!==e||i)if("style"===e){if(r&&"string"!==typeof r&&"string"!==typeof n||(t.style.cssText=r||""),r&&"object"===typeof r){if("string"!==typeof n)for(var a in n)a in r||(t.style[a]="");for(var a in r)t.style[a]="number"===typeof r[a]&&!1===h.test(a)?r[a]+"px":r[a]}}else if("dangerouslySetInnerHTML"===e)r&&(t.innerHTML=r.__html||"");else if("o"==e[0]&&"n"==e[1]){var o=e!==(e=e.replace(/Capture$/,""));e=e.toLowerCase().substring(2),r?n||t.addEventListener(e,x,o):t.removeEventListener(e,x,o),(t._listeners||(t._listeners={}))[e]=r}else if("list"!==e&&"type"!==e&&!i&&e in t)!function(t,e,n){try{t[e]=n}catch(r){}}(t,e,null==r?"":r),null!=r&&!1!==r||t.removeAttribute(e);else{var s=i&&e!==(e=e.replace(/^xlink:?/,""));null==r||!1===r?s?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.removeAttribute(e):"function"!==typeof r&&(s?t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),r):t.setAttribute(e,r))}else t.className=r||""}function x(t){return this._listeners[t.type](i.event&&i.event(t)||t)}var w=[],k=0,_=!1,A=!1;function C(){for(var t;t=w.pop();)i.afterMount&&i.afterMount(t),t.componentDidMount&&t.componentDidMount()}function S(t,e,n,r,i,a){k++||(_=null!=i&&void 0!==i.ownerSVGElement,A=null!=t&&!("__preactattr_"in t));var o=E(t,e,n,r,a);return i&&o.parentNode!==i&&i.appendChild(o),--k||(A=!1,a||C()),o}function E(t,e,n,r,i){var a=t,o=_;if(null!=e&&"boolean"!==typeof e||(e=""),"string"===typeof e||"number"===typeof e)return t&&void 0!==t.splitText&&t.parentNode&&(!t._component||i)?t.nodeValue!=e&&(t.nodeValue=e):(a=document.createTextNode(e),t&&(t.parentNode&&t.parentNode.replaceChild(a,t),T(t,!0))),a.__preactattr_=!0,a;var s=e.nodeName;if("function"===typeof s)return function(t,e,n,r){var i=t&&t._component,a=i,o=t,s=i&&t._componentConstructor===e.nodeName,c=s,u=v(e);for(;i&&!c&&(i=i._parentComponent);)c=i.constructor===e.nodeName;i&&c&&(!r||i._component)?(M(i,u,3,n,r),t=i.base):(a&&!s&&(R(a),t=o=null),i=D(e.nodeName,u,n),t&&!i.nextBase&&(i.nextBase=t,o=null),M(i,u,1,n,r),t=i.base,o&&t!==o&&(o._component=null,T(o,!1)));return t}(t,e,n,r);if(_="svg"===s||"foreignObject"!==s&&_,s=String(s),(!t||!m(t,s))&&(a=function(t,e){var n=e?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t);return n.normalizedNodeName=t,n}(s,_),t)){for(;t.firstChild;)a.appendChild(t.firstChild);t.parentNode&&t.parentNode.replaceChild(a,t),T(t,!0)}var c=a.firstChild,u=a.__preactattr_,l=e.children;if(null==u){u=a.__preactattr_={};for(var h=a.attributes,d=h.length;d--;)u[h[d].name]=h[d].value}return!A&&l&&1===l.length&&"string"===typeof l[0]&&null!=c&&void 0!==c.splitText&&null==c.nextSibling?c.nodeValue!=l[0]&&(c.nodeValue=l[0]):(l&&l.length||null!=c)&&function(t,e,n,r,i){var a,o,s,c,u,l=t.childNodes,h=[],d={},f=0,p=0,m=l.length,v=0,b=e?e.length:0;if(0!==m)for(var x=0;x<m;x++){var w=l[x],k=w.__preactattr_;null!=(_=b&&k?w._component?w._component.__key:k.key:null)?(f++,d[_]=w):(k||(void 0!==w.splitText?!i||w.nodeValue.trim():i))&&(h[v++]=w)}if(0!==b)for(x=0;x<b;x++){var _;if(u=null,null!=(_=(c=e[x]).key))f&&void 0!==d[_]&&(u=d[_],d[_]=void 0,f--);else if(!u&&p<v)for(a=p;a<v;a++)if(void 0!==h[a]&&g(o=h[a],c,i)){u=o,h[a]=void 0,a===v-1&&v--,a===p&&p++;break}u=E(u,c,n,r),s=l[x],u&&u!==t&&u!==s&&(null==s?t.appendChild(u):u===s.nextSibling?y(s):t.insertBefore(u,s))}if(f)for(var x in d)void 0!==d[x]&&T(d[x],!1);for(;p<=v;)void 0!==(u=h[v--])&&T(u,!1)}(a,l,n,r,A||null!=u.dangerouslySetInnerHTML),function(t,e,n){var r;for(r in n)e&&null!=e[r]||null==n[r]||b(t,r,n[r],n[r]=void 0,_);for(r in e)"children"===r||"innerHTML"===r||r in n&&e[r]===("value"===r||"checked"===r?t[r]:n[r])||b(t,r,n[r],n[r]=e[r],_)}(a,e.attributes,u),_=o,a}function T(t,e){var n=t._component;n?R(n):(null!=t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),!1!==e&&null!=t.__preactattr_||y(t),N(t))}function N(t){for(t=t.lastChild;t;){var e=t.previousSibling;T(t,!0),t=e}}var F={};function D(t,e,n){var r,i=F[t.name];if(t.prototype&&t.prototype.render?(r=new t(e,n),z.call(r,e,n)):((r=new z(e,n)).constructor=t,r.render=I),i)for(var a=i.length;a--;)if(i[a].constructor===t){r.nextBase=i[a].nextBase,i.splice(a,1);break}return r}function I(t,e,n){return this.constructor(t,n)}function M(t,e,n,r,a){t._disable||(t._disable=!0,(t.__ref=e.ref)&&delete e.ref,(t.__key=e.key)&&delete e.key,!t.base||a?t.componentWillMount&&t.componentWillMount():t.componentWillReceiveProps&&t.componentWillReceiveProps(e,r),r&&r!==t.context&&(t.prevContext||(t.prevContext=t.context),t.context=r),t.prevProps||(t.prevProps=t.props),t.props=e,t._disable=!1,0!==n&&(1!==n&&!1===i.syncComponentUpdates&&t.base?f(t):O(t,1,a)),t.__ref&&t.__ref(t))}function O(t,e,n,r){if(!t._disable){var a,o,s,u=t.props,l=t.state,h=t.context,d=t.prevProps||u,f=t.prevState||l,p=t.prevContext||h,g=t.base,m=t.nextBase,y=g||m,b=t._component,x=!1;if(g&&(t.props=d,t.state=f,t.context=p,2!==e&&t.shouldComponentUpdate&&!1===t.shouldComponentUpdate(u,l,h)?x=!0:t.componentWillUpdate&&t.componentWillUpdate(u,l,h),t.props=u,t.state=l,t.context=h),t.prevProps=t.prevState=t.prevContext=t.nextBase=null,t._dirty=!1,!x){a=t.render(u,l,h),t.getChildContext&&(h=c(c({},h),t.getChildContext()));var _,A,E=a&&a.nodeName;if("function"===typeof E){var N=v(a);(o=b)&&o.constructor===E&&N.key==o.__key?M(o,N,1,h,!1):(_=o,t._component=o=D(E,N,h),o.nextBase=o.nextBase||m,o._parentComponent=t,M(o,N,0,h,!1),O(o,1,n,!0)),A=o.base}else s=y,(_=b)&&(s=t._component=null),(y||1===e)&&(s&&(s._component=null),A=S(s,a,h,n||!g,y&&y.parentNode,!0));if(y&&A!==y&&o!==b){var F=y.parentNode;F&&A!==F&&(F.replaceChild(A,y),_||(y._component=null,T(y,!1)))}if(_&&R(_),t.base=A,A&&!r){for(var I=t,z=t;z=z._parentComponent;)(I=z).base=A;A._component=I,A._componentConstructor=I.constructor}}if(!g||n?w.unshift(t):x||(t.componentDidUpdate&&t.componentDidUpdate(d,f,p),i.afterUpdate&&i.afterUpdate(t)),null!=t._renderCallbacks)for(;t._renderCallbacks.length;)t._renderCallbacks.pop().call(t);k||r||C()}}function R(t){i.beforeUnmount&&i.beforeUnmount(t);var e=t.base;t._disable=!0,t.componentWillUnmount&&t.componentWillUnmount(),t.base=null;var n=t._component;n?R(n):e&&(e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),t.nextBase=e,y(e),function(t){var e=t.constructor.name;(F[e]||(F[e]=[])).push(t)}(t),N(e)),t.__ref&&t.__ref(null)}function z(t,e){this._dirty=!0,this.context=e,this.props=t,this.state=this.state||{}}function B(t,e,n){return S(n,t,{},!1,e,!1)}c(z.prototype,{setState:function(t,e){var n=this.state;this.prevState||(this.prevState=c({},n)),c(n,"function"===typeof t?t(n,this.props):t),e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),f(this)},forceUpdate:function(t){t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),O(this,2)},render:function(){}});const L={h:s,createElement:s,cloneElement:l,Component:z,render:B,rerender:p,options:i}},32654:(t,e,n)=>{"use strict";var r=n(9950),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function u(t,e,n){var r,a={},u=null,l=null;for(r in void 0!==n&&(u=""+n),void 0!==e.key&&(u=""+e.key),void 0!==e.ref&&(l=e.ref),e)o.call(e,r)&&!c.hasOwnProperty(r)&&(a[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps)void 0===a[r]&&(a[r]=e[r]);return{$$typeof:i,type:t,key:u,ref:l,props:a,_owner:s.current}}e.jsx=u,e.jsxs=u},32049:(t,e)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function v(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||p}function y(){}function b(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},v.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},y.prototype=v.prototype;var x=b.prototype=new y;x.constructor=b,g(x,v.prototype),x.isPureReactComponent=!0;var w=Array.isArray,k=Object.prototype.hasOwnProperty,_={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function C(t,e,r){var i,a={},o=null,s=null;if(null!=e)for(i in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(o=""+e.key),e)k.call(e,i)&&!A.hasOwnProperty(i)&&(a[i]=e[i]);var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){for(var u=Array(c),l=0;l<c;l++)u[l]=arguments[l+2];a.children=u}if(t&&t.defaultProps)for(i in c=t.defaultProps)void 0===a[i]&&(a[i]=c[i]);return{$$typeof:n,type:t,key:o,ref:s,props:a,_owner:_.current}}function S(t){return"object"===typeof t&&null!==t&&t.$$typeof===n}var E=/\/+/g;function T(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function N(t,e,i,a,o){var s=typeof t;"undefined"!==s&&"boolean"!==s||(t=null);var c=!1;if(null===t)c=!0;else switch(s){case"string":case"number":c=!0;break;case"object":switch(t.$$typeof){case n:case r:c=!0}}if(c)return o=o(c=t),t=""===a?"."+T(c,0):a,w(o)?(i="",null!=t&&(i=t.replace(E,"$&/")+"/"),N(o,e,i,"",(function(t){return t}))):null!=o&&(S(o)&&(o=function(t,e){return{$$typeof:n,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(o,i+(!o.key||c&&c.key===o.key?"":(""+o.key).replace(E,"$&/")+"/")+t)),e.push(o)),1;if(c=0,a=""===a?".":a+":",w(t))for(var u=0;u<t.length;u++){var l=a+T(s=t[u],u);c+=N(s,e,i,l,o)}else if(l=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=f&&t[f]||t["@@iterator"])?t:null}(t),"function"===typeof l)for(t=l.call(t),u=0;!(s=t.next()).done;)c+=N(s=s.value,e,i,l=a+T(s,u++),o);else if("object"===s)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return c}function F(t,e,n){if(null==t)return t;var r=[],i=0;return N(t,r,"","",(function(t){return e.call(n,t,i++)})),r}function D(t){if(-1===t._status){var e=t._result;(e=e()).then((function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)}),(function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)})),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var I={current:null},M={transition:null},O={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:M,ReactCurrentOwner:_};e.Children={map:F,forEach:function(t,e,n){F(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return F(t,(function(){e++})),e},toArray:function(t){return F(t,(function(t){return t}))||[]},only:function(t){if(!S(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=v,e.Fragment=i,e.Profiler=o,e.PureComponent=b,e.StrictMode=a,e.Suspense=l,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,e.cloneElement=function(t,e,r){if(null===t||void 0===t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=g({},t.props),a=t.key,o=t.ref,s=t._owner;if(null!=e){if(void 0!==e.ref&&(o=e.ref,s=_.current),void 0!==e.key&&(a=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)k.call(e,u)&&!A.hasOwnProperty(u)&&(i[u]=void 0===e[u]&&void 0!==c?c[u]:e[u])}var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){c=Array(u);for(var l=0;l<u;l++)c[l]=arguments[l+2];i.children=c}return{$$typeof:n,type:t.type,key:a,ref:o,props:i,_owner:s}},e.createContext=function(t){return(t={$$typeof:c,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:t},t.Consumer=t},e.createElement=C,e.createFactory=function(t){var e=C.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:u,render:t}},e.isValidElement=S,e.lazy=function(t){return{$$typeof:d,_payload:{_status:-1,_result:t},_init:D}},e.memo=function(t,e){return{$$typeof:h,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=M.transition;M.transition={};try{t()}finally{M.transition=e}},e.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},e.useCallback=function(t,e){return I.current.useCallback(t,e)},e.useContext=function(t){return I.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return I.current.useDeferredValue(t)},e.useEffect=function(t,e){return I.current.useEffect(t,e)},e.useId=function(){return I.current.useId()},e.useImperativeHandle=function(t,e,n){return I.current.useImperativeHandle(t,e,n)},e.useInsertionEffect=function(t,e){return I.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return I.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return I.current.useMemo(t,e)},e.useReducer=function(t,e,n){return I.current.useReducer(t,e,n)},e.useRef=function(t){return I.current.useRef(t)},e.useState=function(t){return I.current.useState(t)},e.useSyncExternalStore=function(t,e,n){return I.current.useSyncExternalStore(t,e,n)},e.useTransition=function(){return I.current.useTransition()},e.version="18.2.0"},9950:(t,e,n)=>{"use strict";t.exports=n(32049)},44414:(t,e,n)=>{"use strict";t.exports=n(32654)},11053:(t,e,n)=>{var r=n(52658),i=n(93271),a=n(50545),o=n(84281),s=n(94647),c=n(82855),u=n(2583);u.alea=r,u.xor128=i,u.xorwow=a,u.xorshift7=o,u.xor4096=s,u.tychei=c,t.exports=u},52658:function(t,e,n){var r;!function(t,i,a){function o(t){var e=this,n=function(){var t=4022871197,e=function(e){e=String(e);for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)};return e}();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function s(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function c(t,e){var n=new o(t),r=e&&e.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=c:n.amdD&&n.amdO?void 0===(r=function(){return c}.call(e,n,e,i))||(i.exports=r):this.alea=c}(0,t=n.nmd(t),n.amdD)},82855:function(t,e,n){var r;!function(t,i,a){function o(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function s(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function c(t,e){var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=c:n.amdD&&n.amdO?void 0===(r=function(){return c}.call(e,n,e,i))||(i.exports=r):this.tychei=c}(0,t=n.nmd(t),n.amdD)},93271:function(t,e,n){var r;!function(t,i,a){function o(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function c(t,e){var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=c:n.amdD&&n.amdO?void 0===(r=function(){return c}.call(e,n,e,i))||(i.exports=r):this.xor128=c}(0,t=n.nmd(t),n.amdD)},94647:function(t,e,n){var r;!function(t,i,a){function o(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,a=e.i;return e.w=r=r+1640531527|0,n=i[a+34&127],t=i[a=a+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[a]=n^t,e.i=a,n+(r^r>>>16)|0},function(t,e){var n,r,i,a,o,s=[],c=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,c=Math.max(c,e.length)),i=0,a=-32;a<c;++a)e&&(r^=e.charCodeAt((a+32)%e.length)),0===a&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(o=o+1640531527|0,i=0==(n=s[127&a]^=r+o)?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,a=512;a>0;--a)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;t.w=o,t.X=s,t.i=i}(e,t)}function s(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function c(t,e){null==t&&(t=+new Date);var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&(r.X&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=c:n.amdD&&n.amdO?void 0===(r=function(){return c}.call(e,n,e,i))||(i.exports=r):this.xor4096=c}(0,t=n.nmd(t),n.amdD)},84281:function(t,e,n){var r;!function(t,i,a){function o(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function s(t,e){return e.x=t.x.slice(),e.i=t.i,e}function c(t,e){null==t&&(t=+new Date);var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&(r.x&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=c:n.amdD&&n.amdO?void 0===(r=function(){return c}.call(e,n,e,i))||(i.exports=r):this.xorshift7=c}(0,t=n.nmd(t),n.amdD)},50545:function(t,e,n){var r;!function(t,i,a){function o(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function c(t,e){var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=c:n.amdD&&n.amdO?void 0===(r=function(){return c}.call(e,n,e,i))||(i.exports=r):this.xorwow=c}(0,t=n.nmd(t),n.amdD)},2583:function(t,e,n){var r;!function(i,a,o){var s,c=256,u=o.pow(c,6),l=o.pow(2,52),h=2*l,d=c-1;function f(t,e,n){var r=[],d=v(m((e=1==e?{entropy:!0}:e||{}).entropy?[t,y(a)]:null==t?function(){try{var t;return s&&(t=s.randomBytes)?t=t(c):(t=new Uint8Array(c),(i.crypto||i.msCrypto).getRandomValues(t)),y(t)}catch(r){var e=i.navigator,n=e&&e.plugins;return[+new Date,i,n,i.screen,y(a)]}}():t,3),r),f=new p(r),b=function(){for(var t=f.g(6),e=u,n=0;t<l;)t=(t+n)*c,e*=c,n=f.g(1);for(;t>=h;)t/=2,e/=2,n>>>=1;return(t+n)/e};return b.int32=function(){return 0|f.g(4)},b.quick=function(){return f.g(4)/4294967296},b.double=b,v(y(f.S),a),(e.pass||n||function(t,e,n,r){return r&&(r.S&&g(r,f),t.state=function(){return g(f,{})}),n?(o.random=t,e):t})(b,d,"global"in e?e.global:this==o,e.state)}function p(t){var e,n=t.length,r=this,i=0,a=r.i=r.j=0,o=r.S=[];for(n||(t=[n++]);i<c;)o[i]=i++;for(i=0;i<c;i++)o[i]=o[a=d&a+t[i%n]+(e=o[i])],o[a]=e;(r.g=function(t){for(var e,n=0,i=r.i,a=r.j,o=r.S;t--;)e=o[i=d&i+1],n=n*c+o[d&(o[i]=o[a=d&a+e])+(o[a]=e)];return r.i=i,r.j=a,n})(c)}function g(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function m(t,e){var n,r=[],i=typeof t;if(e&&"object"==i)for(n in t)try{r.push(m(t[n],e-1))}catch(a){}return r.length?r:"string"==i?t:t+"\0"}function v(t,e){for(var n,r=t+"",i=0;i<r.length;)e[d&i]=d&(n^=19*e[d&i])+r.charCodeAt(i++);return y(e)}function y(t){return String.fromCharCode.apply(0,t)}if(v(o.random(),a),t.exports){t.exports=f;try{s=n(41234)}catch(b){}}else void 0===(r=function(){return f}.call(e,n,e,t))||(t.exports=r)}("undefined"!==typeof self?self:this,[],Math)},66836:(t,e,n)=>{"use strict";n.r(e),n.d(e,{DEFAULT_ACTIONS:()=>vVt,default:()=>NVt,guessMode:()=>CVt,vega:()=>pVt,vegaLite:()=>gVt});var r={};n.r(r),n.d(r,{JsonPatchError:()=>O,_areEquals:()=>q,applyOperation:()=>P,applyPatch:()=>j,applyReducer:()=>U,deepClone:()=>R,getValueByPointer:()=>L,validate:()=>V,validator:()=>W});var i={};n.r(i),n.d(i,{compare:()=>$,generate:()=>Q,observe:()=>K,unobserve:()=>X});var a={};n.r(a),n.d(a,{aggregate:()=>Ju,bin:()=>tl,collect:()=>nl,compare:()=>rl,countpattern:()=>al,cross:()=>ol,density:()=>ll,dotbin:()=>gl,expression:()=>ml,extent:()=>yl,facet:()=>xl,field:()=>wl,filter:()=>_l,flatten:()=>Al,fold:()=>Cl,formula:()=>Sl,generate:()=>El,impute:()=>Fl,joinaggregate:()=>Dl,kde:()=>Il,key:()=>Ml,load:()=>Rl,lookup:()=>Bl,multiextent:()=>Ll,multivalues:()=>jl,params:()=>Wl,pivot:()=>Vl,prefacet:()=>ql,project:()=>Gl,proxy:()=>Hl,quantile:()=>Yl,relay:()=>Xl,sample:()=>Kl,sequence:()=>Ql,sieve:()=>Zl,subflow:()=>bl,timeunit:()=>$l,tupleindex:()=>th,values:()=>eh,window:()=>oh});var o={};n.r(o),n.d(o,{interpolate:()=>Gm,interpolateArray:()=>Bm,interpolateBasis:()=>Am,interpolateBasisClosed:()=>Cm,interpolateCubehelix:()=>Vv,interpolateCubehelixLong:()=>qv,interpolateDate:()=>Pm,interpolateDiscrete:()=>Ym,interpolateHcl:()=>Fv,interpolateHclLong:()=>Dv,interpolateHsl:()=>ov,interpolateHslLong:()=>sv,interpolateHue:()=>Xm,interpolateLab:()=>Tv,interpolateNumber:()=>jm,interpolateNumberArray:()=>Rm,interpolateObject:()=>Um,interpolateRgb:()=>Dm,interpolateRgbBasis:()=>Mm,interpolateRgbBasisClosed:()=>Om,interpolateRound:()=>Km,interpolateString:()=>qm,interpolateTransformCss:()=>ev,interpolateTransformSvg:()=>nv,interpolateZoom:()=>iv,piecewise:()=>Hm,quantize:()=>Gv});var s={};n.r(s),n.d(s,{bound:()=>SA,identifier:()=>NA,mark:()=>FA,overlap:()=>DA,render:()=>LA,viewlayout:()=>oC});var c={};n.r(c),n.d(c,{axisticks:()=>lS,datajoin:()=>hS,encode:()=>fS,legendentries:()=>pS,linkpath:()=>bS,pie:()=>AS,scale:()=>TS,sortitems:()=>IS,stack:()=>BS});var u={};n.r(u),n.d(u,{contour:()=>fI,geojson:()=>mI,geopath:()=>vI,geopoint:()=>yI,geoshape:()=>bI,graticule:()=>xI,heatmap:()=>wI,isocontour:()=>rI,kde2d:()=>lI,projection:()=>_I});var l={};n.r(l),n.d(l,{force:()=>kM});var h={};n.r(h),n.d(h,{nest:()=>kO,pack:()=>TO,partition:()=>FO,stratify:()=>DO,tree:()=>OO,treelinks:()=>RO,treemap:()=>LO});var d={};n.r(d),n.d(d,{label:()=>uR});var f={};n.r(f),n.d(f,{loess:()=>hR,regression:()=>fR});var p={};n.r(p),n.d(p,{voronoi:()=>zR});var g={};n.r(g),n.d(g,{wordcloud:()=>$R});var m={};n.r(m),n.d(m,{crossfilter:()=>uz,resolvefilter:()=>lz});var v={};n.r(v),n.d(v,{interpolate:()=>Xq,interpolateArray:()=>jq,interpolateBasis:()=>Eq,interpolateBasisClosed:()=>Tq,interpolateCubehelix:()=>HG,interpolateCubehelixLong:()=>YG,interpolateDate:()=>Wq,interpolateDiscrete:()=>Qq,interpolateHcl:()=>MG,interpolateHclLong:()=>OG,interpolateHsl:()=>uG,interpolateHslLong:()=>lG,interpolateHue:()=>Zq,interpolateLab:()=>DG,interpolateNumber:()=>Vq,interpolateNumberArray:()=>Lq,interpolateObject:()=>qq,interpolateRgb:()=>Oq,interpolateRgbBasis:()=>zq,interpolateRgbBasisClosed:()=>Bq,interpolateRound:()=>$q,interpolateString:()=>Yq,interpolateTransformCss:()=>iG,interpolateTransformSvg:()=>aG,interpolateZoom:()=>sG,piecewise:()=>Kq,quantize:()=>XG});var y={};n.r(y),n.d(y,{interpolate:()=>uS,interpolateArray:()=>eS,interpolateBasis:()=>WC,interpolateBasisClosed:()=>VC,interpolateCubehelix:()=>j2,interpolateCubehelixLong:()=>U2,interpolateDate:()=>rS,interpolateDiscrete:()=>G1,interpolateHcl:()=>E2,interpolateHclLong:()=>T2,interpolateHsl:()=>r2,interpolateHslLong:()=>i2,interpolateHue:()=>H1,interpolateLab:()=>C2,interpolateNumber:()=>iS,interpolateNumberArray:()=>JC,interpolateObject:()=>aS,interpolateRgb:()=>KC,interpolateRgbBasis:()=>ZC,interpolateRgbBasisClosed:()=>$C,interpolateRound:()=>cC,interpolateString:()=>cS,interpolateTransformCss:()=>$1,interpolateTransformSvg:()=>J1,interpolateZoom:()=>e2,piecewise:()=>W1,quantize:()=>W2});var b={};n.r(b),n.d(b,{interpolate:()=>Vut,interpolateArray:()=>Rut,interpolateBasis:()=>kut,interpolateBasisClosed:()=>_ut,interpolateCubehelix:()=>Ult,interpolateCubehelixLong:()=>Wlt,interpolateDate:()=>But,interpolateDiscrete:()=>Gut,interpolateHcl:()=>Tlt,interpolateHclLong:()=>Nlt,interpolateHsl:()=>ilt,interpolateHslLong:()=>alt,interpolateHue:()=>Hut,interpolateLab:()=>Slt,interpolateNumber:()=>Lut,interpolateNumberArray:()=>Mut,interpolateObject:()=>Put,interpolateRgb:()=>Nut,interpolateRgbBasis:()=>Dut,interpolateRgbBasisClosed:()=>Iut,interpolateRound:()=>Yut,interpolateString:()=>Wut,interpolateTransformCss:()=>Jut,interpolateTransformSvg:()=>tlt,interpolateZoom:()=>nlt,piecewise:()=>qut,quantize:()=>Vlt});var x={};n.r(x),n.d(x,{Bounds:()=>GY,CanvasHandler:()=>kQ,CanvasRenderer:()=>EQ,DATE:()=>wL,DAY:()=>kL,DAYOFYEAR:()=>_L,Dataflow:()=>Fc,Debug:()=>kt,Error:()=>bt,EventStream:()=>gc,Gradient:()=>$H,GroupItem:()=>YY,HOURS:()=>AL,Handler:()=>iQ,Info:()=>wt,Item:()=>HY,MILLISECONDS:()=>EL,MINUTES:()=>CL,MONTH:()=>bL,Marks:()=>WK,MultiPulse:()=>Cc,None:()=>yt,Operator:()=>dc,Parameters:()=>uc,Pulse:()=>wc,QUARTER:()=>yL,RenderType:()=>vZ,Renderer:()=>oQ,ResourceLoader:()=>XY,SECONDS:()=>SL,SVGHandler:()=>NQ,SVGRenderer:()=>tZ,SVGStringRenderer:()=>pZ,Scenegraph:()=>QK,TIME_UNITS:()=>TL,Transform:()=>Ic,View:()=>crt,WEEK:()=>xL,Warn:()=>xt,YEAR:()=>vL,accessor:()=>nt,accessorFields:()=>it,accessorName:()=>rt,array:()=>Kt,ascending:()=>te,bandwidthNRD:()=>pz,bin:()=>gz,bootstrapCI:()=>yz,boundClip:()=>CZ,boundContext:()=>gX,boundItem:()=>VK,boundMark:()=>GK,boundStroke:()=>ZY,changeset:()=>sc,clampRange:()=>Qt,codegenExpression:()=>tCt,compare:()=>Jt,constant:()=>ie,cumulativeLogNormal:()=>Mz,cumulativeNormal:()=>Ez,cumulativeUniform:()=>Pz,dayofyear:()=>RL,debounce:()=>ae,defaultLocale:()=>bot,definition:()=>Oc,densityLogNormal:()=>Iz,densityNormal:()=>Sz,densityUniform:()=>Lz,domChild:()=>tQ,domClear:()=>eQ,domCreate:()=>$K,domFind:()=>JK,dotbin:()=>bz,error:()=>ct,expressionFunction:()=>xyt,extend:()=>oe,extent:()=>se,extentIndex:()=>ce,falsy:()=>mt,fastmap:()=>de,field:()=>lt,flush:()=>fe,font:()=>OK,fontFamily:()=>MK,fontSize:()=>TK,format:()=>nU,formatLocale:()=>hot,formats:()=>rU,hasOwnProperty:()=>le,id:()=>ht,identity:()=>dt,inferType:()=>Kj,inferTypes:()=>Qj,ingest:()=>ec,inherits:()=>pe,inrange:()=>ge,interpolate:()=>F3,interpolateColors:()=>T3,interpolateRange:()=>E3,intersect:()=>xZ,intersectBoxLine:()=>SX,intersectPath:()=>kX,intersectPoint:()=>_X,intersectRule:()=>CX,isArray:()=>At,isBoolean:()=>me,isDate:()=>ve,isFunction:()=>Zt,isIterable:()=>ye,isNumber:()=>be,isObject:()=>Ct,isRegExp:()=>xe,isString:()=>we,isTuple:()=>$s,key:()=>ke,lerp:()=>_e,lineHeight:()=>NK,loader:()=>oU,locale:()=>yot,logger:()=>_t,lruCache:()=>Ce,markup:()=>YQ,merge:()=>Se,mergeConfig:()=>Et,multiLineOffset:()=>DK,one:()=>pt,pad:()=>Te,panLinear:()=>Lt,panLog:()=>Pt,panPow:()=>jt,panSymlog:()=>Ut,parse:()=>Jkt,parseExpression:()=>ZAt,parseSelector:()=>pCt,pathCurves:()=>tY,pathEqual:()=>TZ,pathParse:()=>rY,pathRectangle:()=>EY,pathRender:()=>pY,pathSymbols:()=>yY,pathTrail:()=>TY,peek:()=>Ft,point:()=>rQ,projection:()=>y8,quantileLogNormal:()=>Oz,quantileNormal:()=>Tz,quantileUniform:()=>jz,quantiles:()=>dz,quantizeInterpolator:()=>N3,quarter:()=>Yt,quartiles:()=>fz,random:()=>mz,randomInteger:()=>wz,randomKDE:()=>Fz,randomLCG:()=>xz,randomLogNormal:()=>Rz,randomMixture:()=>zz,randomNormal:()=>Nz,randomUniform:()=>Uz,read:()=>aU,regressionExp:()=>Xz,regressionLinear:()=>Hz,regressionLoess:()=>eB,regressionLog:()=>Yz,regressionPoly:()=>Zz,regressionPow:()=>Kz,regressionQuad:()=>Qz,renderModule:()=>bZ,repeat:()=>Ee,resetDefaultLocale:()=>xot,resetSVGClipId:()=>VY,resetSVGDefIds:()=>NZ,responseType:()=>iU,runtimeContext:()=>pnt,sampleCurve:()=>aB,sampleLogNormal:()=>Dz,sampleNormal:()=>Cz,sampleUniform:()=>Bz,scale:()=>S3,sceneEqual:()=>EZ,sceneFromJSON:()=>XK,scenePickVisit:()=>BX,sceneToJSON:()=>YK,sceneVisit:()=>zX,sceneZOrder:()=>RX,scheme:()=>O3,serializeXML:()=>XQ,setRandom:()=>vz,span:()=>Ne,splitAccessPath:()=>ut,stringValue:()=>Fe,textMetrics:()=>kK,timeBin:()=>CP,timeFloor:()=>ZL,timeFormatLocale:()=>mot,timeInterval:()=>rP,timeOffset:()=>oP,timeSequence:()=>uP,timeUnitSpecifier:()=>IL,timeUnits:()=>FL,toBoolean:()=>De,toDate:()=>Me,toNumber:()=>Dt,toSet:()=>Re,toString:()=>Oe,transform:()=>Rc,transforms:()=>Mc,truncate:()=>ze,truthy:()=>gt,tupleid:()=>Js,typeParsers:()=>Hj,utcFloor:()=>tP,utcInterval:()=>iP,utcOffset:()=>sP,utcSequence:()=>lP,utcdayofyear:()=>UL,utcquarter:()=>Xt,utcweek:()=>WL,version:()=>bCt,visitArray:()=>Be,week:()=>zL,writeConfig:()=>Tt,zero:()=>ft,zoomLinear:()=>Vt,zoomLog:()=>qt,zoomPow:()=>Gt,zoomSymlog:()=>Ht});var w={};n.r(w),n.d(w,{compile:()=>ZUt,extractTransforms:()=>JUt,normalize:()=>pOt,version:()=>tWt});var k={};n.r(k),n.d(k,{carbong10:()=>tVt,carbong100:()=>nVt,carbong90:()=>eVt,carbonwhite:()=>JWt,dark:()=>aWt,excel:()=>sWt,fivethirtyeight:()=>dWt,ggplot2:()=>pWt,googlecharts:()=>RWt,latimes:()=>xWt,powerbi:()=>XWt,quartz:()=>_Wt,urbaninstitute:()=>DWt,version:()=>rVt,vox:()=>CWt});var _=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),A=Object.prototype.hasOwnProperty;function C(t,e){return A.call(t,e)}function S(t){if(Array.isArray(t)){for(var e=new Array(t.length),n=0;n<e.length;n++)e[n]=""+n;return e}if(Object.keys)return Object.keys(t);var r=[];for(var i in t)C(t,i)&&r.push(i);return r}function E(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function T(t){for(var e,n=0,r=t.length;n<r;){if(!((e=t.charCodeAt(n))>=48&&e<=57))return!1;n++}return!0}function N(t){return-1===t.indexOf("/")&&-1===t.indexOf("~")?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function F(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function D(t){if(void 0===t)return!0;if(t)if(Array.isArray(t)){for(var e=0,n=t.length;e<n;e++)if(D(t[e]))return!0}else if("object"===typeof t)for(var r=S(t),i=r.length,a=0;a<i;a++)if(D(t[r[a]]))return!0;return!1}function I(t,e){var n=[t];for(var r in e){var i="object"===typeof e[r]?JSON.stringify(e[r],null,2):e[r];"undefined"!==typeof i&&n.push(r+": "+i)}return n.join("\n")}var M=function(t){function e(e,n,r,i,a){var o=this.constructor,s=t.call(this,I(e,{name:n,index:r,operation:i,tree:a}))||this;return s.name=n,s.index=r,s.operation=i,s.tree=a,Object.setPrototypeOf(s,o.prototype),s.message=I(e,{name:n,index:r,operation:i,tree:a}),s}return _(e,t),e}(Error),O=M,R=E,z={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var r=t[e];return delete t[e],{newDocument:n,removed:r}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:function(t,e,n){var r=L(n,this.path);r&&(r=E(r));var i=P(n,{op:"remove",path:this.from}).removed;return P(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(t,e,n){var r=L(n,this.from);return P(n,{op:"add",path:this.path,value:E(r)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:q(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}},B={add:function(t,e,n){return T(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){return{newDocument:n,removed:t.splice(e,1)[0]}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:z.move,copy:z.copy,test:z.test,_get:z._get};function L(t,e){if(""==e)return t;var n={op:"_get",path:e};return P(t,n),n.value}function P(t,e,n,r,i,a){if(void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===i&&(i=!0),void 0===a&&(a=0),n&&("function"==typeof n?n(e,0,t,e.path):W(e,0)),""===e.path){var o={newDocument:t};if("add"===e.op)return o.newDocument=e.value,o;if("replace"===e.op)return o.newDocument=e.value,o.removed=t,o;if("move"===e.op||"copy"===e.op)return o.newDocument=L(t,e.from),"move"===e.op&&(o.removed=t),o;if("test"===e.op){if(o.test=q(t,e.value),!1===o.test)throw new O("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return o.newDocument=t,o}if("remove"===e.op)return o.removed=t,o.newDocument=null,o;if("_get"===e.op)return e.value=t,o;if(n)throw new O("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,e,t);return o}r||(t=E(t));var s=(e.path||"").split("/"),c=t,u=1,l=s.length,h=void 0,d=void 0,f=void 0;for(f="function"==typeof n?n:W;;){if((d=s[u])&&-1!=d.indexOf("~")&&(d=F(d)),i&&("__proto__"==d||"prototype"==d&&u>0&&"constructor"==s[u-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===h&&(void 0===c[d]?h=s.slice(0,u).join("/"):u==l-1&&(h=e.path),void 0!==h&&f(e,0,t,h)),u++,Array.isArray(c)){if("-"===d)d=c.length;else{if(n&&!T(d))throw new O("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,e,t);T(d)&&(d=~~d)}if(u>=l){if(n&&"add"===e.op&&d>c.length)throw new O("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,e,t);if(!1===(o=B[e.op].call(e,c,d,t)).test)throw new O("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return o}}else if(u>=l){if(!1===(o=z[e.op].call(e,c,d,t)).test)throw new O("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return o}if(c=c[d],n&&u<l&&(!c||"object"!==typeof c))throw new O("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",a,e,t)}}function j(t,e,n,r,i){if(void 0===r&&(r=!0),void 0===i&&(i=!0),n&&!Array.isArray(e))throw new O("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(t=E(t));for(var a=new Array(e.length),o=0,s=e.length;o<s;o++)a[o]=P(t,e[o],n,!0,i,o),t=a[o].newDocument;return a.newDocument=t,a}function U(t,e,n){var r=P(t,e);if(!1===r.test)throw new O("Test operation failed","TEST_OPERATION_FAILED",n,e,t);return r.newDocument}function W(t,e,n,r){if("object"!==typeof t||null===t||Array.isArray(t))throw new O("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(!z[t.op])throw new O("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n);if("string"!==typeof t.path)throw new O("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(0!==t.path.indexOf("/")&&t.path.length>0)throw new O('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if(("move"===t.op||"copy"===t.op)&&"string"!==typeof t.from)throw new O("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&void 0===t.value)throw new O("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&D(t.value))throw new O("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n)if("add"==t.op){var i=t.path.split("/").length,a=r.split("/").length;if(i!==a+1&&i!==a)throw new O("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if("replace"===t.op||"remove"===t.op||"_get"===t.op){if(t.path!==r)throw new O("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if("move"===t.op||"copy"===t.op){var o=V([{op:"_get",path:t.from,value:void 0}],n);if(o&&"OPERATION_PATH_UNRESOLVABLE"===o.name)throw new O("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}function V(t,e,n){try{if(!Array.isArray(t))throw new O("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)j(E(e),E(t),n||!0);else{n=n||W;for(var r=0;r<t.length;r++)n(t[r],r,e,void 0)}}catch(i){if(i instanceof O)return i;throw i}}function q(t,e){if(t===e)return!0;if(t&&e&&"object"==typeof t&&"object"==typeof e){var n,r,i,a=Array.isArray(t),o=Array.isArray(e);if(a&&o){if((r=t.length)!=e.length)return!1;for(n=r;0!==n--;)if(!q(t[n],e[n]))return!1;return!0}if(a!=o)return!1;var s=Object.keys(t);if((r=s.length)!==Object.keys(e).length)return!1;for(n=r;0!==n--;)if(!e.hasOwnProperty(s[n]))return!1;for(n=r;0!==n--;)if(!q(t[i=s[n]],e[i]))return!1;return!0}return t!==t&&e!==e}var G=new WeakMap,H=function(t){this.observers=new Map,this.obj=t},Y=function(t,e){this.callback=t,this.observer=e};function X(t,e){e.unobserve()}function K(t,e){var n,r=function(t){return G.get(t)}(t);if(r){var i=function(t,e){return t.observers.get(e)}(r,e);n=i&&i.observer}else r=new H(t),G.set(t,r);if(n)return n;if(n={},r.value=E(t),e){n.callback=e,n.next=null;var a=function(){Q(n)},o=function(){clearTimeout(n.next),n.next=setTimeout(a)};"undefined"!==typeof window&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return n.patches=[],n.object=t,n.unobserve=function(){Q(n),clearTimeout(n.next),function(t,e){t.observers.delete(e.callback)}(r,n),"undefined"!==typeof window&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},r.observers.set(e,new Y(e,n)),n}function Q(t,e){void 0===e&&(e=!1);var n=G.get(t.object);Z(n.value,t.object,t.patches,"",e),t.patches.length&&j(n.value,t.patches);var r=t.patches;return r.length>0&&(t.patches=[],t.callback&&t.callback(r)),r}function Z(t,e,n,r,i){if(e!==t){"function"===typeof e.toJSON&&(e=e.toJSON());for(var a=S(e),o=S(t),s=!1,c=o.length-1;c>=0;c--){var u=t[h=o[c]];if(!C(e,h)||void 0===e[h]&&void 0!==u&&!1===Array.isArray(e))Array.isArray(t)===Array.isArray(e)?(i&&n.push({op:"test",path:r+"/"+N(h),value:E(u)}),n.push({op:"remove",path:r+"/"+N(h)}),s=!0):(i&&n.push({op:"test",path:r,value:t}),n.push({op:"replace",path:r,value:e}),!0);else{var l=e[h];"object"==typeof u&&null!=u&&"object"==typeof l&&null!=l&&Array.isArray(u)===Array.isArray(l)?Z(u,l,n,r+"/"+N(h),i):u!==l&&(!0,i&&n.push({op:"test",path:r+"/"+N(h),value:E(u)}),n.push({op:"replace",path:r+"/"+N(h),value:E(l)}))}}if(s||a.length!=o.length)for(c=0;c<a.length;c++){var h;C(t,h=a[c])||void 0===e[h]||n.push({op:"add",path:r+"/"+N(h),value:E(e[h])})}}}function $(t,e,n){void 0===n&&(n=!1);var r=[];return Z(t,e,r,"",n),r}Object.assign({},r,i,{JsonPatchError:M,deepClone:E,escapePathComponent:N,unescapePathComponent:F});var J=n(1403),tt=n.n(J),et=n(28394);function nt(t,e,n){return t.fields=e||[],t.fname=n,t}function rt(t){return null==t?null:t.fname}function it(t){return null==t?null:t.fields}function at(t){return 1===t.length?ot(t[0]):st(t)}const ot=t=>function(e){return e[t]},st=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function ct(t){throw Error(t)}function ut(t){const e=[],n=t.length;let r,i,a,o=null,s=0,c="";function u(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)c+=t.substring(r,i),c+=t.substring(++i,++i),r=i;else if(a===o)u(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&u(),s=r=i+1):"]"===a&&(s||ct("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&ct("Access path missing closing bracket: "+t),o&&ct("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function lt(t,e,n){const r=ut(t);return t=1===r.length?r[0]:t,nt((n&&n.get||at)(r),[t],e||t)}const ht=lt("id"),dt=nt((t=>t),[],"identity"),ft=nt((()=>0),[],"zero"),pt=nt((()=>1),[],"one"),gt=nt((()=>!0),[],"true"),mt=nt((()=>!1),[],"false");function vt(t,e,n){const r=[e].concat([].slice.call(n));console[t].apply(console,r)}const yt=0,bt=1,xt=2,wt=3,kt=4;function _t(t,e){let n=t||yt;return{level(t){return arguments.length?(n=+t,this):n},error(){return n>=bt&&vt(e||"error","ERROR",arguments),this},warn(){return n>=xt&&vt(e||"warn","WARN",arguments),this},info(){return n>=wt&&vt(e||"log","INFO",arguments),this},debug(){return n>=kt&&vt(e||"log","DEBUG",arguments),this}}}var At=Array.isArray;function Ct(t){return t===Object(t)}const St=t=>"__proto__"!==t;function Et(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(((t,e)=>{for(const n in e)if("signals"===n)t.signals=Nt(t.signals,e.signals);else{const r="legend"===n?{layout:1}:"style"===n||null;Tt(t,n,e[n],r)}return t}),{})}function Tt(t,e,n,r){if(!St(e))return;let i,a;if(Ct(n)&&!At(n))for(i in a=Ct(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?Tt(a,i,n[i]):St(i)&&(a[i]=n[i]);else t[e]=n}function Nt(t,e){if(null==t)return e;const n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}function Ft(t){return t[t.length-1]}function Dt(t){return null==t||""===t?null:+t}const It=t=>e=>t*Math.exp(e),Mt=t=>e=>Math.log(t*e),Ot=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),Rt=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,zt=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function Bt(t,e,n,r){const i=n(t[0]),a=n(Ft(t)),o=(a-i)*e;return[r(i-o),r(a-o)]}function Lt(t,e){return Bt(t,e,Dt,dt)}function Pt(t,e){var n=Math.sign(t[0]);return Bt(t,e,Mt(n),It(n))}function jt(t,e,n){return Bt(t,e,zt(n),zt(1/n))}function Ut(t,e,n){return Bt(t,e,Ot(n),Rt(n))}function Wt(t,e,n,r,i){const a=r(t[0]),o=r(Ft(t)),s=null!=e?r(e):(a+o)/2;return[i(s+(a-s)*n),i(s+(o-s)*n)]}function Vt(t,e,n){return Wt(t,e,n,Dt,dt)}function qt(t,e,n){const r=Math.sign(t[0]);return Wt(t,e,n,Mt(r),It(r))}function Gt(t,e,n,r){return Wt(t,e,n,zt(r),zt(1/r))}function Ht(t,e,n,r){return Wt(t,e,n,Ot(r),Rt(r))}function Yt(t){return 1+~~(new Date(t).getMonth()/3)}function Xt(t){return 1+~~(new Date(t).getUTCMonth()/3)}function Kt(t){return null!=t?At(t)?t:[t]:[]}function Qt(t,e,n){let r,i=t[0],a=t[1];return a<i&&(r=a,a=i,i=r),r=a-i,r>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]}function Zt(t){return"function"===typeof t}const $t="descending";function Jt(t,e,n){n=n||{},e=Kt(e)||[];const r=[],i=[],a={},o=n.comparator||ee;return Kt(t).forEach(((t,o)=>{null!=t&&(r.push(e[o]===$t?-1:1),i.push(t=Zt(t)?t:lt(t,null,n)),(it(t)||[]).forEach((t=>a[t]=1)))})),0===i.length?null:nt(o(i,r),Object.keys(a))}const te=(t,e)=>(t<e||null==t)&&null!=e?-1:(t>e||null==e)&&null!=t?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e===e?-1:e!==e&&t===t?1:0),ee=(t,e)=>1===t.length?ne(t[0],e[0]):re(t,e,t.length),ne=(t,e)=>function(n,r){return te(t(n),t(r))*e},re=(t,e,n)=>(e.push(0),function(r,i){let a,o=0,s=-1;for(;0===o&&++s<n;)a=t[s],o=te(a(r),a(i));return o*e[s]});function ie(t){return Zt(t)?t:()=>t}function ae(t,e){let n;return r=>{n&&clearTimeout(n),n=setTimeout((()=>(e(r),n=null)),t)}}function oe(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}function se(t,e){let n,r,i,a,o=0;if(t&&(n=t.length))if(null==e){for(r=t[o];o<n&&(null==r||r!==r);r=t[++o]);for(i=a=r;o<n;++o)r=t[o],null!=r&&(r<i&&(i=r),r>a&&(a=r))}else{for(r=e(t[o]);o<n&&(null==r||r!==r);r=e(t[++o]));for(i=a=r;o<n;++o)r=e(t[o]),null!=r&&(r<i&&(i=r),r>a&&(a=r))}return[i,a]}function ce(t,e){const n=t.length;let r,i,a,o,s,c=-1;if(null==e){for(;++c<n;)if(i=t[c],null!=i&&i>=i){r=a=i;break}if(c===n)return[-1,-1];for(o=s=c;++c<n;)i=t[c],null!=i&&(r>i&&(r=i,o=c),a<i&&(a=i,s=c))}else{for(;++c<n;)if(i=e(t[c],c,t),null!=i&&i>=i){r=a=i;break}if(c===n)return[-1,-1];for(o=s=c;++c<n;)i=e(t[c],c,t),null!=i&&(r>i&&(r=i,o=c),a<i&&(a=i,s=c))}return[o,s]}const ue=Object.prototype.hasOwnProperty;function le(t,e){return ue.call(t,e)}const he={};function de(t){let e,n={};function r(t){return le(n,t)&&n[t]!==he}const i={size:0,empty:0,object:n,has:r,get:t=>r(t)?n[t]:void 0,set(t,e){return r(t)||(++i.size,n[t]===he&&--i.empty),n[t]=e,this},delete(t){return r(t)&&(--i.size,++i.empty,n[t]=he),this},clear(){i.size=i.empty=0,i.object=n={}},test(t){return arguments.length?(e=t,i):e},clean(){const t={};let r=0;for(const i in n){const a=n[i];a===he||e&&e(a)||(t[i]=a,++r)}i.size=r,i.empty=0,i.object=n=t}};return t&&Object.keys(t).forEach((e=>{i.set(e,t[e])})),i}function fe(t,e,n,r,i,a){if(!n&&0!==n)return a;const o=+n;let s,c=t[0],u=Ft(t);u<c&&(s=c,c=u,u=s),s=Math.abs(e-c);const l=Math.abs(u-e);return s<l&&s<=o?r:l<=o?i:a}function pe(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),oe(r,n)}function ge(t,e,n,r){let i,a=e[0],o=e[e.length-1];return a>o&&(i=a,a=o,o=i),r=void 0===r||r,((n=void 0===n||n)?a<=t:a<t)&&(r?t<=o:t<o)}function me(t){return"boolean"===typeof t}function ve(t){return"[object Date]"===Object.prototype.toString.call(t)}function ye(t){return t&&Zt(t[Symbol.iterator])}function be(t){return"number"===typeof t}function xe(t){return"[object RegExp]"===Object.prototype.toString.call(t)}function we(t){return"string"===typeof t}function ke(t,e,n){t&&(t=e?Kt(t).map((t=>t.replace(/\\(.)/g,"$1"))):Kt(t));const r=t&&t.length,i=n&&n.get||at,a=t=>i(e?[t]:ut(t));let o;if(r)if(1===r){const e=a(t[0]);o=function(t){return""+e(t)}}else{const e=t.map(a);o=function(t){let n=""+e[0](t),i=0;for(;++i<r;)n+="|"+e[i](t);return n}}else o=function(){return""};return nt(o,t,"key")}function _e(t,e){const n=t[0],r=Ft(t),i=+e;return i?1===i?r:n+i*(r-n):n}const Ae=1e4;function Ce(t){let e,n,r;t=+t||Ae;const i=()=>{e={},n={},r=0},a=(i,a)=>(++r>t&&(n=e,e={},r=1),e[i]=a);return i(),{clear:i,has:t=>le(e,t)||le(n,t),get:t=>le(e,t)?e[t]:le(n,t)?a(t,n[t]):void 0,set:(t,n)=>le(e,t)?e[t]=n:a(t,n)}}function Se(t,e,n,r){const i=e.length,a=n.length;if(!a)return e;if(!i)return n;const o=r||new e.constructor(i+a);let s=0,c=0,u=0;for(;s<i&&c<a;++u)o[u]=t(e[s],n[c])>0?n[c++]:e[s++];for(;s<i;++s,++u)o[u]=e[s];for(;c<a;++c,++u)o[u]=n[c];return o}function Ee(t,e){let n="";for(;--e>=0;)n+=t;return n}function Te(t,e,n,r){const i=n||" ",a=t+"",o=e-a.length;return o<=0?a:"left"===r?Ee(i,o)+a:"center"===r?Ee(i,~~(o/2))+a+Ee(i,Math.ceil(o/2)):a+Ee(i,o)}function Ne(t){return t&&Ft(t)-t[0]||0}function Fe(t){return At(t)?"["+t.map(Fe)+"]":Ct(t)||we(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function De(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t}const Ie=t=>be(t)||ve(t)?t:Date.parse(t);function Me(t,e){return e=e||Ie,null==t||""===t?null:e(t)}function Oe(t){return null==t||""===t?null:t+""}function Re(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function ze(t,e,n,r){const i=null!=r?r:"\u2026",a=t+"",o=a.length,s=Math.max(0,e-i.length);return o<=e?a:"left"===n?i+a.slice(o-s):"center"===n?a.slice(0,Math.ceil(s/2))+i+a.slice(o-~~(s/2)):a.slice(0,s)+i}function Be(t,e,n){if(t)if(e){const r=t.length;for(let i=0;i<r;++i){const r=e(t[i]);r&&n(r,i,t)}}else t.forEach(n)}function Le(t,e,n){return t.fields=e||[],t.fname=n,t}function Pe(t){return null==t?null:t.fname}function je(t){return null==t?null:t.fields}function Ue(t){return 1===t.length?We(t[0]):Ve(t)}const We=t=>function(e){return e[t]},Ve=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function qe(t){throw Error(t)}function Ge(t){const e=[],n=t.length;let r,i,a,o=null,s=0,c="";function u(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)c+=t.substring(r,i++),r=i;else if(a===o)u(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&u(),s=r=i+1):"]"===a&&(s||qe("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&qe("Access path missing closing bracket: "+t),o&&qe("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function He(t,e,n){const r=Ge(t);return t=1===r.length?r[0]:t,Le((n&&n.get||Ue)(r),[t],e||t)}const Ye=He("id"),Xe=Le((t=>t),[],"identity"),Ke=Le((()=>0),[],"zero"),Qe=Le((()=>1),[],"one"),Ze=Le((()=>!0),[],"true"),$e=Le((()=>!1),[],"false");function Je(t,e,n){const r=[e].concat([].slice.call(n));console[t].apply(console,r)}const tn=0,en=1,nn=2,rn=3,an=4;var on=Array.isArray;function sn(t){return t===Object(t)}const cn=t=>"__proto__"!==t;function un(t,e,n,r){if(!cn(e))return;let i,a;if(sn(n)&&!on(n))for(i in a=sn(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?un(a,i,n[i]):cn(i)&&(a[i]=n[i]);else t[e]=n}function ln(t,e){if(null==t)return e;const n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}function hn(t){return t[t.length-1]}function dn(t){return null==t||""===t?null:+t}const fn=t=>e=>t*Math.exp(e),pn=t=>e=>Math.log(t*e),gn=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),mn=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,vn=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function yn(t,e,n,r){const i=n(t[0]),a=n(hn(t)),o=(a-i)*e;return[r(i-o),r(a-o)]}function bn(t,e,n,r,i){const a=r(t[0]),o=r(hn(t)),s=null!=e?r(e):(a+o)/2;return[i(s+(a-s)*n),i(s+(o-s)*n)]}function xn(t,e,n){return bn(t,e,n,dn,Xe)}function wn(t,e,n){const r=Math.sign(t[0]);return bn(t,e,n,pn(r),fn(r))}function kn(t,e,n,r){return bn(t,e,n,vn(r),vn(1/r))}function _n(t,e,n,r){return bn(t,e,n,gn(r),mn(r))}function An(t){return null!=t?on(t)?t:[t]:[]}function Cn(t){return"function"===typeof t}const Sn="descending";function En(t,e,n){n=n||{},e=An(e)||[];const r=[],i=[],a={},o=n.comparator||Nn;return An(t).forEach(((t,o)=>{null!=t&&(r.push(e[o]===Sn?-1:1),i.push(t=Cn(t)?t:He(t,null,n)),(je(t)||[]).forEach((t=>a[t]=1)))})),0===i.length?null:Le(o(i,r),Object.keys(a))}const Tn=(t,e)=>(t<e||null==t)&&null!=e?-1:(t>e||null==e)&&null!=t?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e===e?-1:e!==e&&t===t?1:0),Nn=(t,e)=>1===t.length?Fn(t[0],e[0]):Dn(t,e,t.length),Fn=(t,e)=>function(n,r){return Tn(t(n),t(r))*e},Dn=(t,e,n)=>(e.push(0),function(r,i){let a,o=0,s=-1;for(;0===o&&++s<n;)a=t[s],o=Tn(a(r),a(i));return o*e[s]});function In(t){return Cn(t)?t:()=>t}function Mn(t,e){let n;return r=>{n&&clearTimeout(n),n=setTimeout((()=>(e(r),n=null)),t)}}function On(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}function Rn(t,e){let n,r,i,a,o=0;if(t&&(n=t.length))if(null==e){for(r=t[o];o<n&&(null==r||r!==r);r=t[++o]);for(i=a=r;o<n;++o)r=t[o],null!=r&&(r<i&&(i=r),r>a&&(a=r))}else{for(r=e(t[o]);o<n&&(null==r||r!==r);r=e(t[++o]));for(i=a=r;o<n;++o)r=e(t[o]),null!=r&&(r<i&&(i=r),r>a&&(a=r))}return[i,a]}const zn=Object.prototype.hasOwnProperty;function Bn(t,e){return zn.call(t,e)}const Ln={};function Pn(t){let e,n={};function r(t){return Bn(n,t)&&n[t]!==Ln}const i={size:0,empty:0,object:n,has:r,get:t=>r(t)?n[t]:void 0,set(t,e){return r(t)||(++i.size,n[t]===Ln&&--i.empty),n[t]=e,this},delete(t){return r(t)&&(--i.size,++i.empty,n[t]=Ln),this},clear(){i.size=i.empty=0,i.object=n={}},test(t){return arguments.length?(e=t,i):e},clean(){const t={};let r=0;for(const i in n){const a=n[i];a===Ln||e&&e(a)||(t[i]=a,++r)}i.size=r,i.empty=0,i.object=n=t}};return t&&Object.keys(t).forEach((e=>{i.set(e,t[e])})),i}function jn(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),On(r,n)}function Un(t,e,n,r){let i,a=e[0],o=e[e.length-1];return a>o&&(i=a,a=o,o=i),r=void 0===r||r,((n=void 0===n||n)?a<=t:a<t)&&(r?t<=o:t<o)}function Wn(t){return"[object Date]"===Object.prototype.toString.call(t)}function Vn(t){return"number"===typeof t}function qn(t){return"string"===typeof t}function Gn(t,e,n){t&&(t=e?An(t).map((t=>t.replace(/\\(.)/g,"$1"))):An(t));const r=t&&t.length,i=n&&n.get||Ue,a=t=>i(e?[t]:Ge(t));let o;if(r)if(1===r){const e=a(t[0]);o=function(t){return""+e(t)}}else{const e=t.map(a);o=function(t){let n=""+e[0](t),i=0;for(;++i<r;)n+="|"+e[i](t);return n}}else o=function(){return""};return Le(o,t,"key")}function Hn(t,e){let n="";for(;--e>=0;)n+=t;return n}function Yn(t){return t&&hn(t)-t[0]||0}function Xn(t){return on(t)?"["+t.map(Xn)+"]":sn(t)||qn(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function Kn(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t}const Qn=t=>Vn(t)||Wn(t)?t:Date.parse(t);function Zn(t,e){return e=e||Qn,null==t||""===t?null:e(t)}function $n(t){return null==t||""===t?null:t+""}function Jn(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function tr(t,e,n){if(t)if(e){const r=t.length;for(let i=0;i<r;++i){const r=e(t[i]);r&&n(r,i,t)}}else t.forEach(n)}var er={},nr={},rr=34,ir=10,ar=13;function or(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function sr(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function cr(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function ur(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":function(t){return t<0?"-"+cr(-t,6):t>9999?"+"+cr(t,6):cr(t,4)}(t.getUTCFullYear())+"-"+cr(t.getUTCMonth()+1,2)+"-"+cr(t.getUTCDate(),2)+(i?"T"+cr(e,2)+":"+cr(n,2)+":"+cr(r,2)+"."+cr(i,3)+"Z":r?"T"+cr(e,2)+":"+cr(n,2)+":"+cr(r,2)+"Z":n||e?"T"+cr(e,2)+":"+cr(n,2)+"Z":"")}function lr(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],a=t.length,o=0,s=0,c=a<=0,u=!1;function l(){if(c)return nr;if(u)return u=!1,er;var e,r,i=o;if(t.charCodeAt(i)===rr){for(;o++<a&&t.charCodeAt(o)!==rr||t.charCodeAt(++o)===rr;);return(e=o)>=a?c=!0:(r=t.charCodeAt(o++))===ir?u=!0:r===ar&&(u=!0,t.charCodeAt(o)===ir&&++o),t.slice(i+1,e-1).replace(/""/g,'"')}for(;o<a;){if((r=t.charCodeAt(e=o++))===ir)u=!0;else if(r===ar)u=!0,t.charCodeAt(o)===ir&&++o;else if(r!==n)continue;return t.slice(i,e)}return c=!0,t.slice(i,a)}for(t.charCodeAt(a-1)===ir&&--a,t.charCodeAt(a-1)===ar&&--a;(r=l())!==nr;){for(var h=[];r!==er&&r!==nr;)h.push(r),r=l();e&&null==(h=e(h,s++))||i.push(h)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return o(e[t])})).join(t)}))}function a(e){return e.map(o).join(t)}function o(t){return null==t?"":t instanceof Date?ur(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,a=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=or(t);return function(r,i){return e(n(r),i,t)}}(t,e):or(t)}));return a.columns=i||[],a},parseRows:r,format:function(e,n){return null==n&&(n=sr(e)),[n.map(o).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=sr(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(a).join("\n")},formatRow:a,formatValue:o}}function hr(t){return t}function dr(t,e){return"string"===typeof e&&(e=t.objects[e]),"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map((function(e){return fr(t,e)}))}:fr(t,e)}function fr(t,e){var n=e.id,r=e.bbox,i=null==e.properties?{}:e.properties,a=pr(t,e);return null==n&&null==r?{type:"Feature",properties:i,geometry:a}:null==r?{type:"Feature",id:n,properties:i,geometry:a}:{type:"Feature",id:n,bbox:r,properties:i,geometry:a}}function pr(t,e){var n=function(t){if(null==t)return hr;var e,n,r=t.scale[0],i=t.scale[1],a=t.translate[0],o=t.translate[1];return function(t,s){s||(e=n=0);var c=2,u=t.length,l=new Array(u);for(l[0]=(e+=t[0])*r+a,l[1]=(n+=t[1])*i+o;c<u;)l[c]=t[c],++c;return l}}(t.transform),r=t.arcs;function i(t,e){e.length&&e.pop();for(var i=r[t<0?~t:t],a=0,o=i.length;a<o;++a)e.push(n(i[a],a));t<0&&function(t,e){for(var n,r=t.length,i=r-e;i<--r;)n=t[i],t[i++]=t[r],t[r]=n}(e,o)}function a(t){return n(t)}function o(t){for(var e=[],n=0,r=t.length;n<r;++n)i(t[n],e);return e.length<2&&e.push(e[0]),e}function s(t){for(var e=o(t);e.length<4;)e.push(e[0]);return e}function c(t){return t.map(s)}return function t(e){var n,r=e.type;switch(r){case"GeometryCollection":return{type:r,geometries:e.geometries.map(t)};case"Point":n=a(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(a);break;case"LineString":n=o(e.arcs);break;case"MultiLineString":n=e.arcs.map(o);break;case"Polygon":n=c(e.arcs);break;case"MultiPolygon":n=e.arcs.map(c);break;default:return null}return{type:r,coordinates:n}}(e)}function gr(t,e){var n={},r={},i={},a=[],o=-1;function s(t,e){for(var r in t){var i=t[r];delete e[i.start],delete i.start,delete i.end,i.forEach((function(t){n[t<0?~t:t]=1})),a.push(i)}}return e.forEach((function(n,r){var i,a=t.arcs[n<0?~n:n];a.length<3&&!a[1][0]&&!a[1][1]&&(i=e[++o],e[o]=n,e[r]=i)})),e.forEach((function(e){var n,a,o=function(e){var n,r=t.arcs[e<0?~e:e],i=r[0];t.transform?(n=[0,0],r.forEach((function(t){n[0]+=t[0],n[1]+=t[1]}))):n=r[r.length-1];return e<0?[n,i]:[i,n]}(e),s=o[0],c=o[1];if(n=i[s])if(delete i[n.end],n.push(e),n.end=c,a=r[c]){delete r[a.start];var u=a===n?n:n.concat(a);r[u.start=n.start]=i[u.end=a.end]=u}else r[n.start]=i[n.end]=n;else if(n=r[c])if(delete r[n.start],n.unshift(e),n.start=s,a=i[s]){delete i[a.end];var l=a===n?n:a.concat(n);r[l.start=a.start]=i[l.end=n.end]=l}else r[n.start]=i[n.end]=n;else r[(n=[e]).start=s]=i[n.end=c]=n})),s(i,r),s(r,i),e.forEach((function(t){n[t<0?~t:t]||a.push([t])})),a}function mr(t){return pr(t,vr.apply(this,arguments))}function vr(t,e,n){var r,i,a;if(arguments.length>1)r=function(t,e,n){var r,i=[],a=[];function o(t){var e=t<0?~t:t;(a[e]||(a[e]=[])).push({i:t,g:r})}function s(t){t.forEach(o)}function c(t){t.forEach(s)}function u(t){t.forEach(c)}function l(t){switch(r=t,t.type){case"GeometryCollection":t.geometries.forEach(l);break;case"LineString":s(t.arcs);break;case"MultiLineString":case"Polygon":c(t.arcs);break;case"MultiPolygon":u(t.arcs)}}return l(e),a.forEach(null==n?function(t){i.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&i.push(t[0].i)}),i}(0,e,n);else for(i=0,r=new Array(a=t.arcs.length);i<a;++i)r[i]=i;return{type:"MultiLineString",arcs:gr(t,r)}}const yr=Math.sqrt(50),br=Math.sqrt(10),xr=Math.sqrt(2);function wr(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=yr?10:a>=br?5:a>=xr?2:1;let s,c,u;return i<0?(u=Math.pow(10,-i)/o,s=Math.round(t*u),c=Math.round(e*u),s/u<t&&++s,c/u>e&&--c,u=-u):(u=Math.pow(10,i)*o,s=Math.round(t/u),c=Math.round(e/u),s*u<t&&++s,c*u>e&&--c),c<s&&.5<=n&&n<2?wr(t,e,2*n):[s,c,u]}function kr(t,e,n){return wr(t=+t,e=+e,n=+n)[2]}var _r,Ar=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Cr(t){if(!(e=Ar.exec(t)))throw new Error("invalid format: "+t);var e;return new Sr({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Sr(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Er(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Tr(t){return(t=Er(Math.abs(t)))?t[1]:NaN}function Nr(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Tr(e)/3)))-Tr(Math.abs(t)))}function Fr(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Tr(e)-Tr(t))+1}function Dr(t){return Math.max(0,-Tr(Math.abs(t)))}function Ir(t,e){var n=Er(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}Cr.prototype=Sr.prototype,Sr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Mr={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Ir(100*t,e),r:Ir,s:function(t,e){var n=Er(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(_r=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+Er(t,Math.max(0,e+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Or(t){return t}var Rr,zr,Br,Lr=Array.prototype.map,Pr=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function jr(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?Or:(e=Lr.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,a=[],o=0,s=e[0],c=0;i>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),a.push(t.substring(i-=s,i+s)),!((c+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?Or:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(Lr.call(t.numerals,String)),c=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"\u2212":t.minus+"",l=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=Cr(t)).fill,n=t.align,h=t.sign,d=t.symbol,f=t.zero,p=t.width,g=t.comma,m=t.precision,v=t.trim,y=t.type;"n"===y?(g=!0,y="g"):Mr[y]||(void 0===m&&(m=12),v=!0,y="g"),(f||"0"===e&&"="===n)&&(f=!0,e="0",n="=");var b="$"===d?i:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x="$"===d?a:/[%p]/.test(y)?c:"",w=Mr[y],k=/[defgprs%]/.test(y);function _(t){var i,a,c,d=b,_=x;if("c"===y)_=w(t)+_,t="";else{var A=(t=+t)<0||1/t<0;if(t=isNaN(t)?l:w(Math.abs(t),m),v&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),A&&0===+t&&"+"!==h&&(A=!1),d=(A?"("===h?h:u:"-"===h||"("===h?"":h)+d,_=("s"===y?Pr[8+_r/3]:"")+_+(A&&"("===h?")":""),k)for(i=-1,a=t.length;++i<a;)if(48>(c=t.charCodeAt(i))||c>57){_=(46===c?o+t.slice(i+1):t.slice(i))+_,t=t.slice(0,i);break}}g&&!f&&(t=r(t,1/0));var C=d.length+t.length+_.length,S=C<p?new Array(p-C+1).join(e):"";switch(g&&f&&(t=r(S+t,S.length?p-_.length:1/0),S=""),n){case"<":t=d+t+_+S;break;case"=":t=d+S+t+_;break;case"^":t=S.slice(0,C=S.length>>1)+d+t+_+S.slice(C);break;default:t=S+d+t+_}return s(t)}return m=void 0===m?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),_.toString=function(){return t+""},_}return{format:h,formatPrefix:function(t,e){var n=h(((t=Cr(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Tr(e)/3))),i=Math.pow(10,-r),a=Pr[8+r/3];return function(t){return n(i*t)+a}}}}!function(t){Rr=jr(t),zr=Rr.format,Br=Rr.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});const Ur=new Date,Wr=new Date;function Vr(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=e=>(t(e=new Date(+e)),e),i.ceil=n=>(t(n=new Date(n-1)),e(n,1),t(n),n),i.round=t=>{const e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=(t,n)=>(e(t=new Date(+t),null==n?1:Math.floor(n)),t),i.range=(n,r,a)=>{const o=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r)||!(a>0))return o;let s;do{o.push(s=new Date(+n)),e(n,a),t(n)}while(s<n&&n<r);return o},i.filter=n=>Vr((e=>{if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),((t,r)=>{if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););})),n&&(i.count=(e,r)=>(Ur.setTime(+e),Wr.setTime(+r),t(Ur),t(Wr),Math.floor(n(Ur,Wr))),i.every=t=>(t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?e=>r(e)%t===0:e=>i.count(0,e)%t===0):i:null)),i}const qr=1e3,Gr=6e4,Hr=36e5,Yr=864e5,Xr=6048e5,Kr=2592e6,Qr=31536e6,Zr=Vr((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Gr)/Yr),(t=>t.getDate()-1)),$r=(Zr.range,Vr((t=>{t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+e)}),((t,e)=>(e-t)/Yr),(t=>t.getUTCDate()-1))),Jr=($r.range,Vr((t=>{t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+e)}),((t,e)=>(e-t)/Yr),(t=>Math.floor(t/Yr))));Jr.range;function ti(t){return Vr((e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),((t,e)=>{t.setDate(t.getDate()+7*e)}),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Gr)/Xr))}const ei=ti(0),ni=ti(1),ri=ti(2),ii=ti(3),ai=ti(4),oi=ti(5),si=ti(6);ei.range,ni.range,ri.range,ii.range,ai.range,oi.range,si.range;function ci(t){return Vr((e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+7*e)}),((t,e)=>(e-t)/Xr))}const ui=ci(0),li=ci(1),hi=ci(2),di=ci(3),fi=ci(4),pi=ci(5),gi=ci(6),mi=(ui.range,li.range,hi.range,di.range,fi.range,pi.range,gi.range,Vr((t=>{t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,e)=>{t.setFullYear(t.getFullYear()+e)}),((t,e)=>e.getFullYear()-t.getFullYear()),(t=>t.getFullYear())));mi.every=t=>isFinite(t=Math.floor(t))&&t>0?Vr((e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,n)=>{e.setFullYear(e.getFullYear()+n*t)})):null;mi.range;const vi=Vr((t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)}),((t,e)=>e.getUTCFullYear()-t.getUTCFullYear()),(t=>t.getUTCFullYear()));vi.every=t=>isFinite(t=Math.floor(t))&&t>0?Vr((e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null;vi.range;const yi=Vr((t=>{t.setDate(1),t.setHours(0,0,0,0)}),((t,e)=>{t.setMonth(t.getMonth()+e)}),((t,e)=>e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())),(t=>t.getMonth())),bi=(yi.range,Vr((t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)}),((t,e)=>e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())),(t=>t.getUTCMonth()))),xi=(bi.range,Vr((t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*qr-t.getMinutes()*Gr)}),((t,e)=>{t.setTime(+t+e*Hr)}),((t,e)=>(e-t)/Hr),(t=>t.getHours()))),wi=(xi.range,Vr((t=>{t.setUTCMinutes(0,0,0)}),((t,e)=>{t.setTime(+t+e*Hr)}),((t,e)=>(e-t)/Hr),(t=>t.getUTCHours()))),ki=(wi.range,Vr((t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*qr)}),((t,e)=>{t.setTime(+t+e*Gr)}),((t,e)=>(e-t)/Gr),(t=>t.getMinutes()))),_i=(ki.range,Vr((t=>{t.setUTCSeconds(0,0)}),((t,e)=>{t.setTime(+t+e*Gr)}),((t,e)=>(e-t)/Gr),(t=>t.getUTCMinutes()))),Ai=(_i.range,Vr((t=>{t.setTime(t-t.getMilliseconds())}),((t,e)=>{t.setTime(+t+e*qr)}),((t,e)=>(e-t)/qr),(t=>t.getUTCSeconds()))),Ci=(Ai.range,Vr((()=>{}),((t,e)=>{t.setTime(+t+e)}),((t,e)=>e-t)));Ci.every=t=>(t=Math.floor(t),isFinite(t)&&t>0?t>1?Vr((e=>{e.setTime(Math.floor(e/t)*t)}),((e,n)=>{e.setTime(+e+n*t)}),((e,n)=>(n-e)/t)):Ci:null);Ci.range;function Si(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Ei(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Ti(){return 0}const Ni=Math.sqrt(50),Fi=Math.sqrt(10),Di=Math.sqrt(2);function Ii(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=Ni?10:a>=Fi?5:a>=Di?2:1;let s,c,u;return i<0?(u=Math.pow(10,-i)/o,s=Math.round(t*u),c=Math.round(e*u),s/u<t&&++s,c/u>e&&--c,u=-u):(u=Math.pow(10,i)*o,s=Math.round(t/u),c=Math.round(e/u),s*u<t&&++s,c*u>e&&--c),c<s&&.5<=n&&n<2?Ii(t,e,2*n):[s,c,u]}function Mi(t,e,n){return Ii(t=+t,e=+e,n=+n)[2]}function Oi(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?Mi(e,t,n):Mi(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}const Ri="year",zi="quarter",Bi="month",Li="week",Pi="date",ji="day",Ui="dayofyear",Wi="hours",Vi="minutes",qi="seconds",Gi="milliseconds",Hi=[Ri,zi,Bi,Li,Pi,ji,Ui,Wi,Vi,qi,Gi],Yi=Hi.reduce(((t,e,n)=>(t[e]=1+n,t)),{});function Xi(t){const e=An(t).slice(),n={};e.length||qe("Missing time unit."),e.forEach((t=>{Bn(Yi,t)?n[t]=1:qe("Invalid time unit: ".concat(t,"."))}));return(n[Li]||n[ji]?1:0)+(n[zi]||n[Bi]||n[Pi]?1:0)+(n[Ui]?1:0)>1&&qe("Incompatible time units: ".concat(t)),e.sort(((t,e)=>Yi[t]-Yi[e])),e}const Ki={[Ri]:"%Y ",[zi]:"Q%q ",[Bi]:"%b ",[Pi]:"%d ",[Li]:"W%U ",[ji]:"%a ",[Ui]:"%j ",[Wi]:"%H:00",[Vi]:"00:%M",[qi]:":%S",[Gi]:".%L",["".concat(Ri,"-").concat(Bi)]:"%Y-%m ",["".concat(Ri,"-").concat(Bi,"-").concat(Pi)]:"%Y-%m-%d ",["".concat(Wi,"-").concat(Vi)]:"%H:%M"};const Qi=new Date;function Zi(t){return Qi.setFullYear(t),Qi.setMonth(0),Qi.setDate(1),Qi.setHours(0,0,0,0),Qi}function $i(t){return Zr.count(Zi(t.getFullYear())-1,t)}function Ji(t){return ei.count(Zi(t.getFullYear())-1,t)}function ta(t){return Zi(t).getDay()}function ea(t,e,n,r,i,a,o){if(0<=t&&t<100){const s=new Date(-1,e,n,r,i,a,o);return s.setFullYear(t),s}return new Date(t,e,n,r,i,a,o)}function na(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return $r.count(e-1,t)}function ra(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return ui.count(e-1,t)}function ia(t){return Qi.setTime(Date.UTC(t,0,1)),Qi.getUTCDay()}function aa(t,e,n,r,i,a,o){if(0<=t&&t<100){const t=new Date(Date.UTC(-1,e,n,r,i,a,o));return t.setUTCFullYear(n.y),t}return new Date(Date.UTC(t,e,n,r,i,a,o))}function oa(t,e,n,r,i){const a=e||1,o=hn(t),s=(t,e,i)=>function(t,e,n,r){const i=n<=1?t:r?(e,i)=>r+n*Math.floor((t(e,i)-r)/n):(e,r)=>n*Math.floor(t(e,r)/n);return e?(t,n)=>e(i(t,n),n):i}(n[i=i||t],r[i],t===o&&a,e),c=new Date,u=Jn(t),l=u[Ri]?s(Ri):In(2012),h=u[Bi]?s(Bi):u[zi]?s(zi):Ke,d=u[Li]&&u[ji]?s(ji,1,Li+ji):u[Li]?s(Li,1):u[ji]?s(ji,1):u[Pi]?s(Pi,1):u[Ui]?s(Ui,1):Qe,f=u[Wi]?s(Wi):Ke,p=u[Vi]?s(Vi):Ke,g=u[qi]?s(qi):Ke,m=u[Gi]?s(Gi):Ke;return function(t){c.setTime(+t);const e=l(c);return i(e,h(c),d(c,e),f(c),p(c),g(c),m(c))}}function sa(t,e,n){return e+7*t-(n+6)%7}const ca={[Ri]:t=>t.getFullYear(),[zi]:t=>Math.floor(t.getMonth()/3),[Bi]:t=>t.getMonth(),[Pi]:t=>t.getDate(),[Wi]:t=>t.getHours(),[Vi]:t=>t.getMinutes(),[qi]:t=>t.getSeconds(),[Gi]:t=>t.getMilliseconds(),[Ui]:t=>$i(t),[Li]:t=>Ji(t),[Li+ji]:(t,e)=>sa(Ji(t),t.getDay(),ta(e)),[ji]:(t,e)=>sa(1,t.getDay(),ta(e))},ua={[zi]:t=>3*t,[Li]:(t,e)=>sa(t,0,ta(e))};function la(t,e){return oa(t,e||1,ca,ua,ea)}const ha={[Ri]:t=>t.getUTCFullYear(),[zi]:t=>Math.floor(t.getUTCMonth()/3),[Bi]:t=>t.getUTCMonth(),[Pi]:t=>t.getUTCDate(),[Wi]:t=>t.getUTCHours(),[Vi]:t=>t.getUTCMinutes(),[qi]:t=>t.getUTCSeconds(),[Gi]:t=>t.getUTCMilliseconds(),[Ui]:t=>na(t),[Li]:t=>ra(t),[ji]:(t,e)=>sa(1,t.getUTCDay(),ia(e)),[Li+ji]:(t,e)=>sa(ra(t),t.getUTCDay(),ia(e))},da={[zi]:t=>3*t,[Li]:(t,e)=>sa(t,0,ia(e))};function fa(t,e){return oa(t,e||1,ha,da,aa)}const pa={[Ri]:mi,[zi]:yi.every(3),[Bi]:yi,[Li]:ei,[Pi]:Zr,[ji]:Zr,[Ui]:Zr,[Wi]:xi,[Vi]:ki,[qi]:Ai,[Gi]:Ci},ga={[Ri]:vi,[zi]:bi.every(3),[Bi]:bi,[Li]:ui,[Pi]:$r,[ji]:$r,[Ui]:$r,[Wi]:wi,[Vi]:_i,[qi]:Ai,[Gi]:Ci};function ma(t){return pa[t]}function va(t){return ga[t]}function ya(t,e,n){return t?t.offset(e,n):void 0}function ba(t,e,n,r){return t?t.range(e,n,r):void 0}const xa=1e3,wa=6e4,ka=36e5,_a=864e5,Aa=2592e6,Ca=31536e6,Sa=[Ri,Bi,Pi,Wi,Vi,qi,Gi],Ea=Sa.slice(0,-1),Ta=Ea.slice(0,-1),Na=Ta.slice(0,-1),Fa=Na.slice(0,-1),Da=[Ri,Bi],Ia=[Ri],Ma=[[Ea,1,xa],[Ea,5,5e3],[Ea,15,15e3],[Ea,30,3e4],[Ta,1,wa],[Ta,5,3e5],[Ta,15,9e5],[Ta,30,18e5],[Na,1,ka],[Na,3,108e5],[Na,6,216e5],[Na,12,432e5],[Fa,1,_a],[[Ri,Li],1,6048e5],[Da,1,Aa],[Da,3,7776e6],[Ia,1,Ca]];function Oa(t){const e=t.extent,n=t.maxbins||40,r=Math.abs(Yn(e))/n;let i,a,o=function(t){let e,n,r;function i(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<0?i=e+1:a=e}while(i<a)}return i}return 2!==t.length?(e=Si,n=(e,n)=>Si(t(e),n),r=(e,n)=>t(e)-n):(e=t===Si||t===Ei?t:Ti,n=t,r=t),{left:i,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=i(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return a>n&&r(t[a-1],e)>-r(t[a],e)?a-1:a},right:function(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<=0?i=e+1:a=e}while(i<a)}return i}}}((t=>t[2])).right(Ma,r);return o===Ma.length?(i=Ia,a=Oi(e[0]/Ca,e[1]/Ca,n)):o?(o=Ma[r/Ma[o-1][2]<Ma[o][2]/r?o-1:o],i=o[0],a=o[1]):(i=Sa,a=Math.max(Oi(e[0],e[1],n),1)),{units:i,step:a}}function Ra(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function za(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Ba(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function La(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,a=t.days,o=t.shortDays,s=t.months,c=t.shortMonths,u=Qa(i),l=Za(i),h=Qa(a),d=Za(a),f=Qa(o),p=Za(o),g=Qa(s),m=Za(s),v=Qa(c),y=Za(c),b={a:function(t){return o[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:bo,e:bo,f:Ao,g:Ro,G:Bo,H:xo,I:wo,j:ko,L:_o,m:Co,M:So,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:os,s:ss,S:Eo,u:To,U:No,V:Do,w:Io,W:Mo,x:null,X:null,y:Oo,Y:zo,Z:Lo,"%":as},x={a:function(t){return o[t.getUTCDay()]},A:function(t){return a[t.getUTCDay()]},b:function(t){return c[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:Po,e:Po,f:qo,g:es,G:rs,H:jo,I:Uo,j:Wo,L:Vo,m:Go,M:Ho,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:os,s:ss,S:Yo,u:Xo,U:Ko,V:Zo,w:$o,W:Jo,x:null,X:null,y:ts,Y:ns,Z:is,"%":as},w={a:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(t,e,n){var r=v.exec(e.slice(n));return r?(t.m=y.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(t,e,n){var r=g.exec(e.slice(n));return r?(t.m=m.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(t,n,r){return A(t,e,n,r)},d:co,e:co,f:go,g:io,G:ro,H:lo,I:lo,j:uo,L:po,m:so,M:ho,p:function(t,e,n){var r=u.exec(e.slice(n));return r?(t.p=l.get(r[0].toLowerCase()),n+r[0].length):-1},q:oo,Q:vo,s:yo,S:fo,u:Ja,U:to,V:eo,w:$a,W:no,x:function(t,e,r){return A(t,n,e,r)},X:function(t,e,n){return A(t,r,e,n)},y:io,Y:ro,Z:ao,"%":mo};function k(t,e){return function(n){var r,i,a,o=[],s=-1,c=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===t.charCodeAt(s)&&(o.push(t.slice(c,s)),null!=(i=qa[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(a=e[r])&&(r=a(n,i)),o.push(r),c=s+1);return o.push(t.slice(c,s)),o.join("")}}function _(t,e){return function(n){var r,i,a=Ba(1900,void 0,1);if(A(a,t,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("s"in a)return new Date(1e3*a.s+("L"in a?a.L:0));if(e&&!("Z"in a)&&(a.Z=0),"p"in a&&(a.H=a.H%12+12*a.p),void 0===a.m&&(a.m="q"in a?a.q:0),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(i=(r=za(Ba(a.y,0,1))).getUTCDay(),r=i>4||0===i?li.ceil(r):li(r),r=$r.offset(r,7*(a.V-1)),a.y=r.getUTCFullYear(),a.m=r.getUTCMonth(),a.d=r.getUTCDate()+(a.w+6)%7):(i=(r=Ra(Ba(a.y,0,1))).getDay(),r=i>4||0===i?ni.ceil(r):ni(r),r=Zr.offset(r,7*(a.V-1)),a.y=r.getFullYear(),a.m=r.getMonth(),a.d=r.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),i="Z"in a?za(Ba(a.y,0,1)).getUTCDay():Ra(Ba(a.y,0,1)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(i+5)%7:a.w+7*a.U-(i+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,za(a)):Ra(a)}}function A(t,e,n,r){for(var i,a,o=0,s=e.length,c=n.length;o<s;){if(r>=c)return-1;if(37===(i=e.charCodeAt(o++))){if(i=e.charAt(o++),!(a=w[i in qa?e.charAt(o++):i])||(r=a(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=k(n,b),b.X=k(r,b),b.c=k(e,b),x.x=k(n,x),x.X=k(r,x),x.c=k(e,x),{format:function(t){var e=k(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=_(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=k(t+="",x);return e.toString=function(){return t},e},utcParse:function(t){var e=_(t+="",!0);return e.toString=function(){return t},e}}}var Pa,ja,Ua,Wa,Va,qa={"-":"",_:" ",0:"0"},Ga=/^\s*\d+/,Ha=/^%/,Ya=/[\\^$*+?|[\]().{}]/g;function Xa(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function Ka(t){return t.replace(Ya,"\\$&")}function Qa(t){return new RegExp("^(?:"+t.map(Ka).join("|")+")","i")}function Za(t){return new Map(t.map(((t,e)=>[t.toLowerCase(),e])))}function $a(t,e,n){var r=Ga.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Ja(t,e,n){var r=Ga.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function to(t,e,n){var r=Ga.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function eo(t,e,n){var r=Ga.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function no(t,e,n){var r=Ga.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function ro(t,e,n){var r=Ga.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function io(t,e,n){var r=Ga.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function ao(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function oo(t,e,n){var r=Ga.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function so(t,e,n){var r=Ga.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function co(t,e,n){var r=Ga.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function uo(t,e,n){var r=Ga.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function lo(t,e,n){var r=Ga.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function ho(t,e,n){var r=Ga.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function fo(t,e,n){var r=Ga.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function po(t,e,n){var r=Ga.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function go(t,e,n){var r=Ga.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function mo(t,e,n){var r=Ha.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function vo(t,e,n){var r=Ga.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function yo(t,e,n){var r=Ga.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function bo(t,e){return Xa(t.getDate(),e,2)}function xo(t,e){return Xa(t.getHours(),e,2)}function wo(t,e){return Xa(t.getHours()%12||12,e,2)}function ko(t,e){return Xa(1+Zr.count(mi(t),t),e,3)}function _o(t,e){return Xa(t.getMilliseconds(),e,3)}function Ao(t,e){return _o(t,e)+"000"}function Co(t,e){return Xa(t.getMonth()+1,e,2)}function So(t,e){return Xa(t.getMinutes(),e,2)}function Eo(t,e){return Xa(t.getSeconds(),e,2)}function To(t){var e=t.getDay();return 0===e?7:e}function No(t,e){return Xa(ei.count(mi(t)-1,t),e,2)}function Fo(t){var e=t.getDay();return e>=4||0===e?ai(t):ai.ceil(t)}function Do(t,e){return t=Fo(t),Xa(ai.count(mi(t),t)+(4===mi(t).getDay()),e,2)}function Io(t){return t.getDay()}function Mo(t,e){return Xa(ni.count(mi(t)-1,t),e,2)}function Oo(t,e){return Xa(t.getFullYear()%100,e,2)}function Ro(t,e){return Xa((t=Fo(t)).getFullYear()%100,e,2)}function zo(t,e){return Xa(t.getFullYear()%1e4,e,4)}function Bo(t,e){var n=t.getDay();return Xa((t=n>=4||0===n?ai(t):ai.ceil(t)).getFullYear()%1e4,e,4)}function Lo(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Xa(e/60|0,"0",2)+Xa(e%60,"0",2)}function Po(t,e){return Xa(t.getUTCDate(),e,2)}function jo(t,e){return Xa(t.getUTCHours(),e,2)}function Uo(t,e){return Xa(t.getUTCHours()%12||12,e,2)}function Wo(t,e){return Xa(1+$r.count(vi(t),t),e,3)}function Vo(t,e){return Xa(t.getUTCMilliseconds(),e,3)}function qo(t,e){return Vo(t,e)+"000"}function Go(t,e){return Xa(t.getUTCMonth()+1,e,2)}function Ho(t,e){return Xa(t.getUTCMinutes(),e,2)}function Yo(t,e){return Xa(t.getUTCSeconds(),e,2)}function Xo(t){var e=t.getUTCDay();return 0===e?7:e}function Ko(t,e){return Xa(ui.count(vi(t)-1,t),e,2)}function Qo(t){var e=t.getUTCDay();return e>=4||0===e?fi(t):fi.ceil(t)}function Zo(t,e){return t=Qo(t),Xa(fi.count(vi(t),t)+(4===vi(t).getUTCDay()),e,2)}function $o(t){return t.getUTCDay()}function Jo(t,e){return Xa(li.count(vi(t)-1,t),e,2)}function ts(t,e){return Xa(t.getUTCFullYear()%100,e,2)}function es(t,e){return Xa((t=Qo(t)).getUTCFullYear()%100,e,2)}function ns(t,e){return Xa(t.getUTCFullYear()%1e4,e,4)}function rs(t,e){var n=t.getUTCDay();return Xa((t=n>=4||0===n?fi(t):fi.ceil(t)).getUTCFullYear()%1e4,e,4)}function is(){return"+0000"}function as(){return"%"}function os(t){return+t}function ss(t){return Math.floor(+t/1e3)}function cs(t){const e={};return n=>e[n]||(e[n]=t(n))}function us(t){const e=cs(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(t){const n=Cr(t||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(t,e){return n=>{const r=t(n),i=r.indexOf(e);if(i<0)return r;let a=function(t,e){let n,r=t.lastIndexOf("e");if(r>0)return r;for(r=t.length;--r>e;)if(n=t.charCodeAt(r),n>=48&&n<=57)return r+1}(r,i);const o=a<r.length?r.slice(a):"";for(;--a>i;)if("0"!==r[a]){++a;break}return r.slice(0,a)+o}}(e(n),e(".1f")(1)[1])}return e(n)},formatSpan(t,r,i,a){a=Cr(null==a?",f":a);const o=function(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?kr(e,t,n):kr(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}(t,r,i),s=Math.max(Math.abs(t),Math.abs(r));let c;if(null==a.precision)switch(a.type){case"s":return isNaN(c=Nr(o,s))||(a.precision=c),n(a,s);case"":case"e":case"g":case"p":case"r":isNaN(c=Fr(o,s))||(a.precision=c-("e"===a.type));break;case"f":case"%":isNaN(c=Dr(o))||(a.precision=c-2*("%"===a.type))}return e(a)}}}let ls,hs;function ds(){return ls=us({format:zr,formatPrefix:Br})}function fs(t){return us(jr(t))}function ps(t){return arguments.length?ls=fs(t):ls}function gs(t,e,n){sn(n=n||{})||qe("Invalid time multi-format specifier: ".concat(n));const r=e(qi),i=e(Vi),a=e(Wi),o=e(Pi),s=e(Li),c=e(Bi),u=e(zi),l=e(Ri),h=t(n[Gi]||".%L"),d=t(n[qi]||":%S"),f=t(n[Vi]||"%I:%M"),p=t(n[Wi]||"%I %p"),g=t(n[Pi]||n[ji]||"%a %d"),m=t(n[Li]||"%b %d"),v=t(n[Bi]||"%B"),y=t(n[zi]||"%B"),b=t(n[Ri]||"%Y");return t=>(r(t)<t?h:i(t)<t?d:a(t)<t?f:o(t)<t?p:c(t)<t?s(t)<t?g:m:l(t)<t?u(t)<t?v:y:b)(t)}function ms(t){const e=cs(t.format),n=cs(t.utcFormat);return{timeFormat:t=>qn(t)?e(t):gs(e,ma,t),utcFormat:t=>qn(t)?n(t):gs(n,va,t),timeParse:cs(t.parse),utcParse:cs(t.utcParse)}}function vs(){return hs=ms({format:ja,parse:Ua,utcFormat:Wa,utcParse:Va})}function ys(t){return ms(La(t))}function bs(t){return arguments.length?hs=ys(t):hs}!function(t){Pa=La(t),ja=Pa.format,Ua=Pa.parse,Wa=Pa.utcFormat,Va=Pa.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),ds(),vs();const xs=(t,e)=>On({},t,e);function ws(t,e){const n=arguments.length;return n&&2!==n&&qe("defaultLocale expects either zero or two arguments."),n?xs(ps(t),bs(e)):xs(ps(),bs())}const ks=/^(data:|([A-Za-z]+:)?\/\/)/,_s=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,As=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Cs="file://";async function Ss(t,e){const n=await this.sanitize(t,e),r=n.href;return n.localFile?this.file(r):this.http(r,e)}async function Es(t,e){e=On({},this.options,e);const n=this.fileAccess,r={href:null};let i,a,o;const s=_s.test(t.replace(As,""));null!=t&&"string"===typeof t&&s||qe("Sanitize failure, invalid URI: "+Xn(t));const c=ks.test(t);return(o=e.baseURL)&&!c&&(t.startsWith("/")||o.endsWith("/")||(t="/"+t),t=o+t),a=(i=t.startsWith(Cs))||"file"===e.mode||"http"!==e.mode&&!c&&n,i?t=t.slice(Cs.length):t.startsWith("//")&&("file"===e.defaultProtocol?(t=t.slice(2),a=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(r,"localFile",{value:!!a}),r.href=t,e.target&&(r.target=e.target+""),e.rel&&(r.rel=e.rel+""),"image"===e.context&&e.crossOrigin&&(r.crossOrigin=e.crossOrigin+""),r}function Ts(t){return t?e=>new Promise(((n,r)=>{t.readFile(e,((t,e)=>{t?r(t):n(e)}))})):Ns}async function Ns(){qe("No file system access.")}function Fs(t){return t?async function(e,n){const r=On({},this.options.http,n),i=n&&n.response,a=await t(e,r);return a.ok?Cn(a[i])?a[i]():a.text():qe(a.status+""+a.statusText)}:Ds}async function Ds(){qe("No HTTP fetch method available.")}const Is=t=>null!=t&&t===t,Ms=t=>!Number.isNaN(+t)&&!(t instanceof Date),Os={boolean:Kn,integer:dn,number:dn,date:Zn,string:$n,unknown:Xe},Rs=[t=>"true"===t||"false"===t||!0===t||!1===t,t=>Ms(t)&&Number.isInteger(+t),Ms,t=>!Number.isNaN(Date.parse(t))],zs=["boolean","integer","number","date"];function Bs(t,e){return e.reduce(((e,n)=>(e[n]=function(t,e){if(!t||!t.length)return"unknown";const n=t.length,r=Rs.length,i=Rs.map(((t,e)=>e+1));for(let a,o,s=0,c=0;s<n;++s)for(o=e?t[s][e]:t[s],a=0;a<r;++a)if(i[a]&&Is(o)&&!Rs[a](o)&&(i[a]=0,++c,c===Rs.length))return"string";return zs[i.reduce(((t,e)=>0===t?e:t),0)-1]}(t,n),e)),{})}function Ls(t){const e=function(e,n){const r={delimiter:t};return Ps(e,n?On(n,r):r)};return e.responseType="text",e}function Ps(t,e){return e.header&&(t=e.header.map(Xn).join(e.delimiter)+"\n"+t),lr(e.delimiter).parse(t+"")}function js(t,e){const n=e&&e.property?He(e.property):Xe;return!sn(t)||(r=t,"function"===typeof Buffer&&Cn(Buffer.isBuffer)&&Buffer.isBuffer(r))?n(JSON.parse(t)):function(t,e){!on(t)&&function(t){return t&&Cn(t[Symbol.iterator])}(t)&&(t=[...t]);return e&&e.copy?JSON.parse(JSON.stringify(t)):t}(n(t),e);var r}Ps.responseType="text",js.responseType="json";const Us={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function Ws(t,e){let n,r,i,a;return t=js(t,e),e&&e.feature?(n=dr,i=e.feature):e&&e.mesh?(n=mr,i=e.mesh,a=Us[e.filter]):qe("Missing TopoJSON feature or mesh parameter."),r=(r=t.objects[i])?n(t,r,a):qe("Invalid TopoJSON object: "+i),r&&r.features||[r]}Ws.responseType="json";const Vs={dsv:Ps,csv:Ls(","),tsv:Ls("\t"),json:js,topojson:Ws};function qs(t,e){return arguments.length>1?(Vs[t]=e,this):Bn(Vs,t)?Vs[t]:null}function Gs(t){const e=qs(t);return e&&e.responseType||"text"}function Hs(t,e,n,r){const i=qs((e=e||{}).type||"json");return i||qe("Unknown data format type: "+e.type),t=i(t,e),e.parse&&function(t,e,n,r){if(!t.length)return;const i=bs();n=n||i.timeParse,r=r||i.utcParse;let a,o,s,c,u,l,h=t.columns||Object.keys(t[0]);"auto"===e&&(e=Bs(t,h));h=Object.keys(e);const d=h.map((t=>{const i=e[t];let a,o;if(i&&(i.startsWith("date:")||i.startsWith("utc:"))){a=i.split(/:(.+)?/,2),o=a[1],("'"===o[0]&&"'"===o[o.length-1]||'"'===o[0]&&'"'===o[o.length-1])&&(o=o.slice(1,-1));return("utc"===a[0]?r:n)(o)}if(!Os[i])throw Error("Illegal format pattern: "+t+":"+i);return Os[i]}));for(s=0,u=t.length,l=h.length;s<u;++s)for(a=t[s],c=0;c<l;++c)o=h[c],a[o]=d[c](a[o])}(t,e.parse,n,r),Bn(t,"columns")&&delete t.columns,t}const Ys=function(t,e){return n=>({options:n||{},sanitize:Es,load:Ss,fileAccess:!!e,file:Ts(e),http:Fs(t)})}("undefined"!==typeof fetch&&fetch,null);function Xs(t){const e=t||Xe,n=[],r={};return n.add=t=>{const i=e(t);return r[i]||(r[i]=1,n.push(t)),n},n.remove=t=>{const i=e(t);if(r[i]){r[i]=0;const e=n.indexOf(t);e>=0&&n.splice(e,1)}return n},n}async function Ks(t,e){try{await e(t)}catch(n){t.error(n)}}const Qs=Symbol("vega_id");let Zs=1;function $s(t){return!(!t||!Js(t))}function Js(t){return t[Qs]}function tc(t,e){return t[Qs]=e,t}function ec(t){const e=t===Object(t)?t:{data:t};return Js(e)?e:tc(e,Zs++)}function nc(t){return rc(t,ec({}))}function rc(t,e){for(const n in t)e[n]=t[n];return e}function ic(t,e){return tc(e,Js(t))}function ac(t,e){return t?e?(n,r)=>t(n,r)||Js(e(n))-Js(e(r)):(e,n)=>t(e,n)||Js(e)-Js(n):null}function oc(t){return t&&t.constructor===sc}function sc(){const t=[],e=[],n=[],r=[],i=[];let a=null,o=!1;return{constructor:sc,insert(e){const n=An(e),r=n.length;for(let i=0;i<r;++i)t.push(n[i]);return this},remove(t){const n=Cn(t)?r:e,i=An(t),a=i.length;for(let e=0;e<a;++e)n.push(i[e]);return this},modify(t,e,r){const a={field:e,value:In(r)};return Cn(t)?(a.filter=t,i.push(a)):(a.tuple=t,n.push(a)),this},encode(t,e){return Cn(t)?i.push({filter:t,field:e}):n.push({tuple:t,field:e}),this},clean(t){return a=t,this},reflow(){return o=!0,this},pulse(s,c){const u={},l={};let h,d,f,p,g,m;for(h=0,d=c.length;h<d;++h)u[Js(c[h])]=1;for(h=0,d=e.length;h<d;++h)g=e[h],u[Js(g)]=-1;for(h=0,d=r.length;h<d;++h)p=r[h],c.forEach((t=>{p(t)&&(u[Js(t)]=-1)}));for(h=0,d=t.length;h<d;++h)g=t[h],m=Js(g),u[m]?u[m]=1:s.add.push(ec(t[h]));for(h=0,d=c.length;h<d;++h)g=c[h],u[Js(g)]<0&&s.rem.push(g);function v(t,e,n){n?t[e]=n(t):s.encode=e,o||(l[Js(t)]=t)}for(h=0,d=n.length;h<d;++h)f=n[h],g=f.tuple,p=f.field,m=u[Js(g)],m>0&&(v(g,p,f.value),s.modifies(p));for(h=0,d=i.length;h<d;++h)f=i[h],p=f.filter,c.forEach((t=>{p(t)&&u[Js(t)]>0&&v(t,f.field,f.value)})),s.modifies(f.field);if(o)s.mod=e.length||r.length?c.filter((t=>u[Js(t)]>0)):c.slice();else for(m in l)s.mod.push(l[m]);return(a||null==a&&(e.length||r.length))&&s.clean(!0),s}}}const cc="_:mod:_";function uc(){Object.defineProperty(this,cc,{writable:!0,value:{}})}uc.prototype={set(t,e,n,r){const i=this,a=i[t],o=i[cc];return null!=e&&e>=0?(a[e]!==n||r)&&(a[e]=n,o[e+":"+t]=-1,o[t]=-1):(a!==n||r)&&(i[t]=n,o[t]=on(n)?1+n.length:-1),i},modified(t,e){const n=this[cc];if(!arguments.length){for(const t in n)if(n[t])return!0;return!1}if(on(t)){for(let e=0;e<t.length;++e)if(n[t[e]])return!0;return!1}return null!=e&&e>=0?e+1<n[t]||!!n[e+":"+t]:!!n[t]},clear(){return this[cc]={},this}};let lc=0;const hc=new uc;function dc(t,e,n,r){this.id=++lc,this.value=t,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,e&&(this._update=e),n&&this.parameters(n,r)}function fc(t){return function(e){const n=this.flags;return 0===arguments.length?!!(n&t):(this.flags=e?n|t:n&~t,this)}}dc.prototype={targets(){return this._targets||(this._targets=Xs(Ye))},set(t){return this.value!==t?(this.value=t,1):0},skip:fc(1),modified:fc(2),parameters(t,e,n){e=!1!==e;const r=this._argval=this._argval||new uc,i=this._argops=this._argops||[],a=[];let o,s,c,u;const l=(t,n,o)=>{o instanceof dc?(o!==this&&(e&&o.targets().add(this),a.push(o)),i.push({op:o,name:t,index:n})):r.set(t,n,o)};for(o in t)if(s=t[o],"pulse"===o)An(s).forEach((t=>{t instanceof dc?t!==this&&(t.targets().add(this),a.push(t)):qe("Pulse parameters must be operator instances.")})),this.source=s;else if(on(s))for(r.set(o,-1,Array(c=s.length)),u=0;u<c;++u)l(o,u,s[u]);else l(o,-1,s);return this.marshall().clear(),n&&(i.initonly=!0),a},marshall(t){const e=this._argval||hc,n=this._argops;let r,i,a,o;if(n){const s=n.length;for(i=0;i<s;++i)r=n[i],a=r.op,o=a.modified()&&a.stamp===t,e.set(r.name,r.index,a.value,o);if(n.initonly){for(i=0;i<s;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return e},detach(){const t=this._argops;let e,n,r,i;if(t)for(e=0,n=t.length;e<n;++e)r=t[e],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(t){const e=this._update;if(e){const n=this.marshall(t.stamp),r=e.call(this,n,t);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return t.StopPropagation}},run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?(this.skip(!1),e=0):e=this.evaluate(t),this.pulse=e||t}};let pc=0;function gc(t,e,n){this.id=++pc,this.value=null,n&&(this.receive=n),t&&(this._filter=t),e&&(this._apply=e)}function mc(t,e,n){return new gc(t,e,n)}gc.prototype={_filter:Ze,_apply:Xe,targets(){return this._targets||(this._targets=Xs(Ye))},consume(t){return arguments.length?(this._consume=!!t,this):!!this._consume},receive(t){if(this._filter(t)){const e=this.value=this._apply(t),n=this._targets,r=n?n.length:0;for(let t=0;t<r;++t)n[t].receive(e);this._consume&&(t.preventDefault(),t.stopPropagation())}},filter(t){const e=mc(t);return this.targets().add(e),e},apply(t){const e=mc(null,t);return this.targets().add(e),e},merge(){const t=mc();this.targets().add(t);for(let e=0,n=arguments.length;e<n;++e)arguments[e].targets().add(t);return t},throttle(t){let e=-1;return this.filter((()=>{const n=Date.now();return n-e>t?(e=n,1):0}))},debounce(t){const e=mc();return this.targets().add(mc(null,null,Mn(t,(t=>{const n=t.dataflow;e.receive(t),n&&n.run&&n.run()})))),e},between(t,e){let n=!1;return t.targets().add(mc(null,null,(()=>n=!0))),e.targets().add(mc(null,null,(()=>n=!1))),this.filter((()=>n))},detach(){this._filter=Ze,this._targets=null}};const vc={skip:!0};function yc(t,e,n,r,i,a){const o=On({},a,vc);let s,c;Cn(n)||(n=In(n)),void 0===r?s=e=>t.touch(n(e)):Cn(r)?(c=new dc(null,r,i,!1),s=e=>{c.evaluate(e);const r=n(e),i=c.value;oc(i)?t.pulse(r,i,a):t.update(r,i,o)}):s=e=>t.update(n(e),r,o),e.apply(s)}function bc(t,e,n,r,i,a){if(void 0===r)e.targets().add(n);else{const o=a||{},s=new dc(null,function(t,e){return e=Cn(e)?e:In(e),t?function(n,r){const i=e(n,r);return t.skip()||(t.skip(i!==this.value).value=i),i}:e}(n,r),i,!1);s.modified(o.force),s.rank=e.rank,e.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),t.connect(n,[s]))}}const xc={};function wc(t,e,n){this.dataflow=t,this.stamp=null==e?-1:e,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function kc(t,e){const n=[];return tr(t,e,(t=>n.push(t))),n}function _c(t,e){const n={};return t.visit(e,(t=>{n[Js(t)]=1})),t=>n[Js(t)]?null:t}function Ac(t,e){return t?(n,r)=>t(n,r)&&e(n,r):e}function Cc(t,e,n,r){const i=this;let a=0;this.dataflow=t,this.stamp=e,this.fields=null,this.encode=r||null,this.pulses=n;for(const o of n)if(o.stamp===e){if(o.fields){const t=i.fields||(i.fields={});for(const e in o.fields)t[e]=1}o.changed(i.ADD)&&(a|=i.ADD),o.changed(i.REM)&&(a|=i.REM),o.changed(i.MOD)&&(a|=i.MOD)}this.changes=a}function Sc(t){return t.error("Dataflow already running. Use runAsync() to chain invocations."),t}wc.prototype={StopPropagation:xc,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork(t){return new wc(this.dataflow).init(this,t)},clone(){const t=this.fork(7);return t.add=t.add.slice(),t.rem=t.rem.slice(),t.mod=t.mod.slice(),t.source&&(t.source=t.source.slice()),t.materialize(23)},addAll(){let t=this;return!t.source||t.add===t.rem||!t.rem.length&&t.source.length===t.add.length||(t=new wc(this.dataflow).init(this),t.add=t.source,t.rem=[]),t},init(t,e){const n=this;return n.stamp=t.stamp,n.encode=t.encode,!t.fields||64&e||(n.fields=t.fields),1&e?(n.addF=t.addF,n.add=t.add):(n.addF=null,n.add=[]),2&e?(n.remF=t.remF,n.rem=t.rem):(n.remF=null,n.rem=[]),4&e?(n.modF=t.modF,n.mod=t.mod):(n.modF=null,n.mod=[]),32&e?(n.srcF=null,n.source=null):(n.srcF=t.srcF,n.source=t.source,t.cleans&&(n.cleans=t.cleans)),n},runAfter(t){this.dataflow.runAfter(t)},changed(t){const e=t||7;return 1&e&&this.add.length||2&e&&this.rem.length||4&e&&this.mod.length},reflow(t){if(t)return this.fork(7).reflow();const e=this.add.length,n=this.source&&this.source.length;return n&&n!==e&&(this.mod=this.source,e&&this.filter(4,_c(this,1))),this},clean(t){return arguments.length?(this.cleans=!!t,this):this.cleans},modifies(t){const e=this.fields||(this.fields={});return on(t)?t.forEach((t=>e[t]=!0)):e[t]=!0,this},modified(t,e){const n=this.fields;return!(!e&&!this.mod.length||!n)&&(arguments.length?on(t)?t.some((t=>n[t])):n[t]:!!n)},filter(t,e){const n=this;return 1&t&&(n.addF=Ac(n.addF,e)),2&t&&(n.remF=Ac(n.remF,e)),4&t&&(n.modF=Ac(n.modF,e)),16&t&&(n.srcF=Ac(n.srcF,e)),n},materialize(t){const e=this;return 1&(t=t||7)&&e.addF&&(e.add=kc(e.add,e.addF),e.addF=null),2&t&&e.remF&&(e.rem=kc(e.rem,e.remF),e.remF=null),4&t&&e.modF&&(e.mod=kc(e.mod,e.modF),e.modF=null),16&t&&e.srcF&&(e.source=e.source.filter(e.srcF),e.srcF=null),e},visit(t,e){const n=this,r=e;if(16&t)return tr(n.source,n.srcF,r),n;1&t&&tr(n.add,n.addF,r),2&t&&tr(n.rem,n.remF,r),4&t&&tr(n.mod,n.modF,r);const i=n.source;if(8&t&&i){const t=n.add.length+n.mod.length;t===i.length||tr(i,t?_c(n,5):n.srcF,r)}return n}},jn(Cc,wc,{fork(t){const e=new wc(this.dataflow).init(this,t&this.NO_FIELDS);return void 0!==t&&(t&e.ADD&&this.visit(e.ADD,(t=>e.add.push(t))),t&e.REM&&this.visit(e.REM,(t=>e.rem.push(t))),t&e.MOD&&this.visit(e.MOD,(t=>e.mod.push(t)))),e},changed(t){return this.changes&t},modified(t){const e=this,n=e.fields;return n&&e.changes&e.MOD?on(t)?t.some((t=>n[t])):n[t]:0},filter(){qe("MultiPulse does not support filtering.")},materialize(){qe("MultiPulse does not support materialization.")},visit(t,e){const n=this,r=n.pulses,i=r.length;let a=0;if(t&n.SOURCE)for(;a<i;++a)r[a].visit(t,e);else for(;a<i;++a)r[a].stamp===n.stamp&&r[a].visit(t,e);return n}});const Ec={skip:!1,force:!1};function Tc(t){let e=[];return{clear:()=>e=[],size:()=>e.length,peek:()=>e[0],push:n=>(e.push(n),Nc(e,0,e.length-1,t)),pop:()=>{const n=e.pop();let r;return e.length?(r=e[0],e[0]=n,function(t,e,n){const r=e,i=t.length,a=t[e];let o,s=1+(e<<1);for(;s<i;)o=s+1,o<i&&n(t[s],t[o])>=0&&(s=o),t[e]=t[s],s=1+((e=s)<<1);t[e]=a,Nc(t,r,e,n)}(e,0,t)):r=n,r}}}function Nc(t,e,n,r){let i,a;const o=t[n];for(;n>e&&(a=n-1>>1,i=t[a],r(o,i)<0);)t[n]=i,n=a;return t[n]=o}function Fc(){this.logger(function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Je,r=t||tn;return{level(t){return arguments.length?(r=+t,this):r},error(){return r>=en&&n(e||"error","ERROR",arguments),this},warn(){return r>=nn&&n(e||"warn","WARN",arguments),this},info(){return r>=rn&&n(e||"log","INFO",arguments),this},debug(){return r>=an&&n(e||"log","DEBUG",arguments),this}}}()),this.logLevel(en),this._clock=0,this._rank=0,this._locale=ws();try{this._loader=Ys()}catch(t){}this._touched=Xs(Ye),this._input={},this._pulse=null,this._heap=Tc(((t,e)=>t.qrank-e.qrank)),this._postrun=[]}function Dc(t){return function(){return this._log[t].apply(this,arguments)}}function Ic(t,e){dc.call(this,t,null,e)}Fc.prototype={stamp(){return this._clock},loader(t){return arguments.length?(this._loader=t,this):this._loader},locale(t){return arguments.length?(this._locale=t,this):this._locale},logger(t){return arguments.length?(this._log=t,this):this._log},error:Dc("error"),warn:Dc("warn"),info:Dc("info"),debug:Dc("debug"),logLevel:Dc("level"),cleanThreshold:1e4,add:function(t,e,n,r){let i,a=1;return t instanceof dc?i=t:t&&t.prototype instanceof dc?i=new t:Cn(t)?i=new dc(null,t):(a=0,i=new dc(t,e)),this.rank(i),a&&(r=n,n=e),n&&this.connect(i,i.parameters(n,r)),this.touch(i),i},connect:function(t,e){const n=t.rank,r=e.length;for(let i=0;i<r;++i)if(n<e[i].rank)return void this.rerank(t)},rank:function(t){t.rank=++this._rank},rerank:function(t){const e=[t];let n,r,i;for(;e.length;)if(this.rank(n=e.pop()),r=n._targets)for(i=r.length;--i>=0;)e.push(n=r[i]),n===t&&qe("Cycle detected in dataflow graph.")},pulse:function(t,e,n){this.touch(t,n||Ec);const r=new wc(this,this._clock+(this._pulse?0:1)),i=t.pulse&&t.pulse.source||[];return r.target=t,this._input[t.id]=e.pulse(r,i),this},touch:function(t,e){const n=e||Ec;return this._pulse?this._enqueue(t):this._touched.add(t),n.skip&&t.skip(!0),this},update:function(t,e,n){const r=n||Ec;return(t.set(e)||r.force)&&this.touch(t,r),this},changeset:sc,ingest:function(t,e,n){return e=this.parse(e,n),this.pulse(t,this.changeset().insert(e))},parse:function(t,e){const n=this.locale();return Hs(t,e,n.timeParse,n.utcParse)},preload:async function(t,e,n){const r=this,i=r._pending||function(t){let e;const n=new Promise((t=>e=t));return n.requests=0,n.done=()=>{0===--n.requests&&(t._pending=null,e(t))},t._pending=n}(r);i.requests+=1;const a=await r.request(e,n);return r.pulse(t,r.changeset().remove(Ze).insert(a.data||[])),i.done(),a},request:async function(t,e){const n=this;let r,i=0;try{r=await n.loader().load(t,{context:"dataflow",response:Gs(e&&e.type)});try{r=n.parse(r,e)}catch(a){i=-2,n.warn("Data ingestion failed",t,a)}}catch(a){i=-1,n.warn("Loading failed",t,a)}return{data:r,status:i}},events:function(t,e,n,r){const i=this,a=mc(n,r),o=function(t){t.dataflow=i;try{a.receive(t)}catch(e){i.error(e)}finally{i.run()}};let s;s="string"===typeof t&&"undefined"!==typeof document?document.querySelectorAll(t):An(t);const c=s.length;for(let u=0;u<c;++u)s[u].addEventListener(e,o);return a},on:function(t,e,n,r,i){return(t instanceof dc?bc:yc)(this,t,e,n,r,i),this},evaluate:async function(t,e,n){const r=this,i=[];if(r._pulse)return Sc(r);if(r._pending&&await r._pending,e&&await Ks(r,e),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const a=++r._clock;r._pulse=new wc(r,a,t),r._touched.forEach((t=>r._enqueue(t,!0))),r._touched=Xs(Ye);let o,s,c,u=0;try{for(;r._heap.size()>0;)o=r._heap.pop(),o.rank===o.qrank?(s=o.run(r._getPulse(o,t)),s.then?s=await s:s.async&&(i.push(s.async),s=xc),s!==xc&&o._targets&&o._targets.forEach((t=>r._enqueue(t))),++u):r._enqueue(o,!0)}catch(l){r._heap.clear(),c=l}if(r._input={},r._pulse=null,r.debug("Pulse ".concat(a,": ").concat(u," operators")),c&&(r._postrun=[],r.error(c)),r._postrun.length){const t=r._postrun.sort(((t,e)=>e.priority-t.priority));r._postrun=[];for(let e=0;e<t.length;++e)await Ks(r,t[e].callback)}return n&&await Ks(r,n),i.length&&Promise.all(i).then((t=>r.runAsync(null,(()=>{t.forEach((t=>{try{t(r)}catch(l){r.error(l)}}))})))),r},run:function(t,e,n){return this._pulse?Sc(this):(this.evaluate(t,e,n),this)},runAsync:async function(t,e,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(t,e,n)).then(r,r),this._running},runAfter:function(t,e,n){if(this._pulse||e)this._postrun.push({priority:n||0,callback:t});else try{t(this)}catch(r){this.error(r)}},_enqueue:function(t,e){const n=t.stamp<this._clock;n&&(t.stamp=this._clock),(n||e)&&(t.qrank=t.rank,this._heap.push(t))},_getPulse:function(t,e){const n=t.source,r=this._clock;return n&&on(n)?new Cc(this,r,n.map((t=>t.pulse)),e):this._input[t.id]||function(t,e){if(e&&e.stamp===t.stamp)return e;t=t.fork(),e&&e!==xc&&(t.source=e.source);return t}(this._pulse,n&&n.pulse)}},jn(Ic,dc,{run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?this.skip(!1):e=this.evaluate(t),e=e||t,e.then?e=e.then((t=>this.pulse=t)):e!==t.StopPropagation&&(this.pulse=e),e},evaluate(t){const e=this.marshall(t.stamp),n=this.transform(e,t);return e.clear(),n},transform(){}});const Mc={};function Oc(t){const e=Rc(t);return e&&e.Definition||null}function Rc(t){return t=t&&t.toLowerCase(),Bn(Mc,t)?Mc[t]:null}function zc(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Bc(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function Lc(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function Pc(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zc;if(t===zc)return jc;if("function"!==typeof t)throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||0===r?r:(0===t(n,n))-(0===t(e,e))}}function jc(t,e){return(null==t||!(t>=t))-(null==e||!(e>=e))||(t<e?-1:t>e?1:0)}function Uc(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,i=arguments.length>4?arguments[4]:void 0;if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(i=void 0===i?jc:Pc(i);r>n;){if(r-n>600){const a=r-n+1,o=e-n+1,s=Math.log(a),c=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*c*(a-c)/a)*(o-a/2<0?-1:1);Uc(t,e,Math.max(n,Math.floor(e-o*c/a+u)),Math.min(r,Math.floor(e+(a-o)*c/a+u)),i)}const a=t[e];let o=n,s=r;for(Wc(t,n,e),i(t[r],a)>0&&Wc(t,n,r);o<s;){for(Wc(t,o,s),++o,--s;i(t[o],a)<0;)++o;for(;i(t[s],a)>0;)--s}0===i(t[n],a)?Wc(t,n,s):(++s,Wc(t,s,r)),s<=e&&(n=s+1),e<=s&&(r=s-1)}return t}function Wc(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function Vc(t){return null===t?NaN:+t}function qc(t,e,n){if(t=Float64Array.from(function*(t,e){if(void 0===e)for(let n of t)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(r=+r)>=r&&(yield r)}}(t,n)),(r=t.length)&&!isNaN(e=+e)){if(e<=0||r<2)return Lc(t);if(e>=1)return Bc(t);var r,i=(r-1)*e,a=Math.floor(i),o=Bc(Uc(t,a).subarray(0,a+1));return o+(Lc(t.subarray(a+1))-o)*(i-a)}}function Gc(t,e){return qc(t,.5,e)}function*Hc(t,e){if(null==e)for(let n of t)null!=n&&""!==n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)r=e(r,++n,t),null!=r&&""!==r&&(r=+r)>=r&&(yield r)}}function Yc(t,e,n){const r=Float64Array.from(Hc(t,n));return r.sort(zc),e.map((t=>function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Vc;if((r=t.length)&&!isNaN(e=+e)){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,a=Math.floor(i),o=+n(t[a],a,t);return o+(+n(t[a+1],a+1,t)-o)*(i-a)}}(r,t)))}function Xc(t,e){return Yc(t,[.25,.5,.75],e)}function Kc(t,e){const n=t.length,r=function(t,e){const n=function(t,e){let n,r=0,i=0,a=0;if(void 0===e)for(let o of t)null!=o&&(o=+o)>=o&&(n=o-i,i+=n/++r,a+=n*(o-i));else{let o=-1;for(let s of t)null!=(s=e(s,++o,t))&&(s=+s)>=s&&(n=s-i,i+=n/++r,a+=n*(s-i))}if(r>1)return a/(r-1)}(t,e);return n?Math.sqrt(n):n}(t,e),i=Xc(t,e),a=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,a)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}var Qc=Math.random;function Zc(t,e,n,r){r=r||(t=>t);const i=t.length,a=new Float64Array(i);let o,s=0,c=1,u=r(t[0]),l=u,h=u+e;for(;c<i;++c){if(o=r(t[c]),o>=h){for(l=(u+l)/2;s<c;++s)a[s]=l;h=o+e,u=o}l=o}for(l=(u+l)/2;s<c;++s)a[s]=l;return n?function(t,e){const n=t.length;let r,i,a=0,o=1;for(;t[a]===t[o];)++o;for(;o<n;){for(r=o+1;t[o]===t[r];)++r;if(t[o]-t[o-1]<e){for(i=o+(a+r-o-o>>1);i<o;)t[i++]=t[o];for(;i>o;)t[i--]=t[a]}a=o,o=r}return t}(a,e+e/4):a}const $c=Math.sqrt(2*Math.PI),Jc=Math.SQRT2;let tu=NaN;function eu(t,e){t=t||0,e=null==e?1:e;let n,r,i=0,a=0;if(tu===tu)i=tu,tu=NaN;else{do{i=2*Qc()-1,a=2*Qc()-1,n=i*i+a*a}while(0===n||n>1);r=Math.sqrt(-2*Math.log(n)/n),i*=r,tu=a*r}return t+i*e}function nu(t,e,n){const r=(t-(e||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*$c)}function ru(t,e,n){const r=(t-(e=e||0))/(n=null==n?1:n),i=Math.abs(r);let a;if(i>37)a=0;else{const t=Math.exp(-i*i/2);let e;i<7.07106781186547?(e=.0352624965998911*i+.700383064443688,e=e*i+6.37396220353165,e=e*i+33.912866078383,e=e*i+112.079291497871,e=e*i+221.213596169931,e=e*i+220.206867912376,a=t*e,e=.0883883476483184*i+1.75566716318264,e=e*i+16.064177579207,e=e*i+86.7807322029461,e=e*i+296.564248779674,e=e*i+637.333633378831,e=e*i+793.826512519948,e=e*i+440.413735824752,a/=e):(e=i+.65,e=i+4/e,e=i+3/e,e=i+2/e,e=i+1/e,a=t/e/2.506628274631)}return r>0?1-a:a}function iu(t,e,n){return t<0||t>1?NaN:(e||0)+(null==n?1:n)*Jc*function(t){let e,n=-Math.log((1-t)*(1+t));n<6.25?(n-=3.125,e=-364441206401782e-35,e=e*n-16850591381820166e-35,e=128584807152564e-32+e*n,e=11157877678025181e-33+e*n,e=e*n-1333171662854621e-31,e=20972767875968562e-33+e*n,e=6637638134358324e-30+e*n,e=e*n-4054566272975207e-29,e=e*n-8151934197605472e-29,e=26335093153082323e-28+e*n,e=e*n-12975133253453532e-27,e=e*n-5415412054294628e-26,e=1.0512122733215323e-9+e*n,e=e*n-4.112633980346984e-9,e=e*n-2.9070369957882005e-8,e=4.2347877827932404e-7+e*n,e=e*n-13654692000834679e-22,e=e*n-13882523362786469e-21,e=.00018673420803405714+e*n,e=e*n-.000740702534166267,e=e*n-.006033670871430149,e=.24015818242558962+e*n,e=1.6536545626831027+e*n):n<16?(n=Math.sqrt(n)-3.25,e=2.2137376921775787e-9,e=9.075656193888539e-8+e*n,e=e*n-2.7517406297064545e-7,e=1.8239629214389228e-8+e*n,e=15027403968909828e-22+e*n,e=e*n-4013867526981546e-21,e=29234449089955446e-22+e*n,e=12475304481671779e-21+e*n,e=e*n-47318229009055734e-21,e=6828485145957318e-20+e*n,e=24031110387097894e-21+e*n,e=e*n-.0003550375203628475,e=.0009532893797373805+e*n,e=e*n-.0016882755560235047,e=.002491442096107851+e*n,e=e*n-.003751208507569241,e=.005370914553590064+e*n,e=1.0052589676941592+e*n,e=3.0838856104922208+e*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,e=-27109920616438573e-27,e=e*n-2.555641816996525e-10,e=1.5076572693500548e-9+e*n,e=e*n-3.789465440126737e-9,e=7.61570120807834e-9+e*n,e=e*n-1.496002662714924e-8,e=2.914795345090108e-8+e*n,e=e*n-6.771199775845234e-8,e=2.2900482228026655e-7+e*n,e=e*n-9.9298272942317e-7,e=4526062597223154e-21+e*n,e=e*n-1968177810553167e-20,e=7599527703001776e-20+e*n,e=e*n-.00021503011930044477,e=e*n-.00013871931833623122,e=1.0103004648645344+e*n,e=4.849906401408584+e*n):e=1/0;return e*t}(2*t-1)}function au(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>eu(n,r),pdf:t=>nu(t,n,r),cdf:t=>ru(t,n,r),icdf:t=>iu(t,n,r)};return i.mean(t).stdev(e)}function ou(t,e){const n=au();let r=0;const i={data(n){return arguments.length?(t=n,r=n?n.length:0,i.bandwidth(e)):t},bandwidth(n){return arguments.length?(!(e=n)&&t&&(e=Kc(t)),i):e},sample:()=>t[~~(Qc()*r)]+e*n.sample(),pdf(i){let a=0,o=0;for(;o<r;++o)a+=n.pdf((i-t[o])/e);return a/e/r},cdf(i){let a=0,o=0;for(;o<r;++o)a+=n.cdf((i-t[o])/e);return a/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(t)}function su(t,e){return t=t||0,e=null==e?1:e,Math.exp(t+eu()*e)}function cu(t,e,n){if(t<=0)return 0;e=e||0,n=null==n?1:n;const r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*$c*t)}function uu(t,e,n){return ru(Math.log(t),e,n)}function lu(t,e,n){return Math.exp(iu(t,e,n))}function hu(t,e){return null==e&&(e=null==t?1:t,t=0),t+(e-t)*Qc()}function du(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=e&&t<=n?1/(n-e):0}function fu(t,e,n){return null==n&&(n=null==e?1:e,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function pu(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=0&&t<=1?e+t*(n-e):NaN}function gu(t,e,n,r){const i=r-t*t,a=Math.abs(i)<1e-24?0:(n-t*e)/i;return[e-a*t,a]}function mu(t,e,n,r){t=t.filter((t=>{let r=e(t),i=n(t);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i})),r&&t.sort(((t,n)=>e(t)-e(n)));const i=t.length,a=new Float64Array(i),o=new Float64Array(i);let s,c,u,l=0,h=0,d=0;for(u of t)a[l]=s=+e(u),o[l]=c=+n(u),++l,h+=(s-h)/l,d+=(c-d)/l;for(l=0;l<i;++l)a[l]-=h,o[l]-=d;return[a,o,h,d]}function vu(t,e,n,r){let i,a,o=-1;for(const s of t)i=e(s),a=n(s),null!=i&&(i=+i)>=i&&null!=a&&(a=+a)>=a&&r(i,a,++o)}function yu(t,e,n,r,i){let a=0,o=0;return vu(t,e,n,((t,e)=>{const n=e-i(t),s=e-r;a+=n*n,o+=s*s})),1-a/o}function bu(t,e,n){let r=0,i=0,a=0,o=0,s=0;vu(t,e,n,((t,e)=>{++s,r+=(t-r)/s,i+=(e-i)/s,a+=(t*e-a)/s,o+=(t*t-o)/s}));const c=gu(r,i,a,o),u=t=>c[0]+c[1]*t;return{coef:c,predict:u,rSquared:yu(t,e,n,i,u)}}function xu(t,e,n){const[r,i,a,o]=mu(t,e,n),s=r.length;let c,u,l,h,d=0,f=0,p=0,g=0,m=0;for(c=0;c<s;)u=r[c],l=i[c++],h=u*u,d+=(h-d)/c,f+=(h*u-f)/c,p+=(h*h-p)/c,g+=(u*l-g)/c,m+=(h*l-m)/c;const v=p-d*d,y=d*v-f*f,b=(m*d-g*f)/y,x=(g*v-m*f)/y,w=-b*d,k=t=>b*(t-=a)*t+x*t+w+o;return{coef:[w-x*a+b*a*a+o,x-2*b*a,b],predict:k,rSquared:yu(t,e,n,o,k)}}function wu(t,e,n,r){const i=Array(t);let a,o,s,c;for(a=0;a<t;++a)i[a]=0;for(a=t-1;a>=0;--a)for(s=e[a],c=1,i[a]+=s,o=1;o<=a;++o)c*=(a+1-o)/o,i[a-o]+=s*Math.pow(n,o)*c;return i[0]+=r,i}function ku(t){return(t=1-t*t*t)*t*t}function _u(t,e,n){const r=t[e];let i=n[0],a=n[1]+1;if(!(a>=t.length))for(;e>i&&t[a]-r<=r-t[i];)n[0]=++i,n[1]=a,++a}const Au=.5*Math.PI/180;function Cu(t,e,n,r){n=n||25,r=Math.max(n,r||200);const i=e=>[e,t(e)],a=e[0],o=e[1],s=o-a,c=s/r,u=[i(a)],l=[];if(n===r){for(let t=1;t<r;++t)u.push(i(a+t/n*s));return u.push(i(o)),u}l.push(i(o));for(let g=n;--g>0;)l.push(i(a+g/n*s));let h=u[0],d=l[l.length-1];const f=1/s,p=function(t,e){let n=t,r=t;const i=e.length;for(let a=0;a<i;++a){const t=e[a][1];t<n&&(n=t),t>r&&(r=t)}return 1/(r-n)}(h[1],l);for(;d;){const t=i((h[0]+d[0])/2);t[0]-h[0]>=c&&Su(h,t,d,f,p)>Au?l.push(t):(h=d,u.push(d),l.pop()),d=l[l.length-1]}return u}function Su(t,e,n,r,i){const a=Math.atan2(i*(n[1]-t[1]),r*(n[0]-t[0])),o=Math.atan2(i*(e[1]-t[1]),r*(e[0]-t[0]));return Math.abs(a-o)}function Eu(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function Tu(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function Nu(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Fu(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length-1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Nu;for(;r>n;){if(r-n>600){const a=r-n+1,o=e-n+1,s=Math.log(a),c=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*c*(a-c)/a)*(o-a/2<0?-1:1);Fu(t,e,Math.max(n,Math.floor(e-o*c/a+u)),Math.min(r,Math.floor(e+(a-o)*c/a+u)),i)}const a=t[e];let o=n,s=r;for(Du(t,n,e),i(t[r],a)>0&&Du(t,n,r);o<s;){for(Du(t,o,s),++o,--s;i(t[o],a)<0;)++o;for(;i(t[s],a)>0;)--s}0===i(t[n],a)?Du(t,n,s):(++s,Du(t,s,r)),s<=e&&(n=s+1),e<=s&&(r=s-1)}return t}function Du(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function Iu(t){return null===t?NaN:+t}function Mu(t,e,n){if(t=Float64Array.from(function*(t,e){if(void 0===e)for(let n of t)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(r=+r)>=r&&(yield r)}}(t,n)),r=t.length){if((e=+e)<=0||r<2)return Tu(t);if(e>=1)return Eu(t);var r,i=(r-1)*e,a=Math.floor(i),o=Eu(Fu(t,a).subarray(0,a+1));return o+(Tu(t.subarray(a+1))-o)*(i-a)}}function Ou(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Iu;if(r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,a=Math.floor(i),o=+n(t[a],a,t);return o+(+n(t[a+1],a+1,t)-o)*(i-a)}}function Ru(t,e){return Mu(t,.5,e)}function zu(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a}function Bu(t){let e=t,n=t;function r(t,e,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){const a=r+i>>>1;n(t[a],e)<0?r=a+1:i=a}return r}return 1===t.length&&(e=(e,n)=>t(e)-n,n=function(t){return(e,n)=>Nu(t(e),n)}(t)),{left:r,center:function(t,n,i,a){null==i&&(i=0),null==a&&(a=t.length);const o=r(t,n,i,a-1);return o>i&&e(t[o-1],n)>-e(t[o],n)?o-1:o},right:function(t,e,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){const a=r+i>>>1;n(t[a],e)>0?i=a:r=a+1}return r}}}function Lu(t){return t&&t.length?1===t.length?t[0]:(e=t,t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}):function(){return""};var e}function Pu(t,e,n){return n||t+(e?"_"+e:"")}const ju=()=>{},Uu={init:ju,add:ju,rem:ju,idx:0},Wu={values:{init:t=>t.cell.store=!0,value:t=>t.cell.data.values(),idx:-1},count:{value:t=>t.cell.num},__count__:{value:t=>t.missing+t.valid},missing:{value:t=>t.missing},valid:{value:t=>t.valid},sum:{init:t=>t.sum=0,value:t=>t.sum,add:(t,e)=>t.sum+=+e,rem:(t,e)=>t.sum-=e},product:{init:t=>t.product=1,value:t=>t.valid?t.product:void 0,add:(t,e)=>t.product*=e,rem:(t,e)=>t.product/=e},mean:{init:t=>t.mean=0,value:t=>t.valid?t.mean:void 0,add:(t,e)=>(t.mean_d=e-t.mean,t.mean+=t.mean_d/t.valid),rem:(t,e)=>(t.mean_d=e-t.mean,t.mean-=t.valid?t.mean_d/t.valid:t.mean)},average:{value:t=>t.valid?t.mean:void 0,req:["mean"],idx:1},variance:{init:t=>t.dev=0,value:t=>t.valid>1?t.dev/(t.valid-1):void 0,add:(t,e)=>t.dev+=t.mean_d*(e-t.mean),rem:(t,e)=>t.dev-=t.mean_d*(e-t.mean),req:["mean"],idx:1},variancep:{value:t=>t.valid>1?t.dev/t.valid:void 0,req:["variance"],idx:2},stdev:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:t=>t.valid>1?Math.sqrt(t.dev/t.valid):void 0,req:["variance"],idx:2},stderr:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid*(t.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:t=>t.cell.data.distinct(t.get),req:["values"],idx:3},ci0:{value:t=>t.cell.data.ci0(t.get),req:["values"],idx:3},ci1:{value:t=>t.cell.data.ci1(t.get),req:["values"],idx:3},median:{value:t=>t.cell.data.q2(t.get),req:["values"],idx:3},q1:{value:t=>t.cell.data.q1(t.get),req:["values"],idx:3},q3:{value:t=>t.cell.data.q3(t.get),req:["values"],idx:3},min:{init:t=>t.min=void 0,value:t=>t.min=Number.isNaN(t.min)?t.cell.data.min(t.get):t.min,add:(t,e)=>{(e<t.min||void 0===t.min)&&(t.min=e)},rem:(t,e)=>{e<=t.min&&(t.min=NaN)},req:["values"],idx:4},max:{init:t=>t.max=void 0,value:t=>t.max=Number.isNaN(t.max)?t.cell.data.max(t.get):t.max,add:(t,e)=>{(e>t.max||void 0===t.max)&&(t.max=e)},rem:(t,e)=>{e>=t.max&&(t.max=NaN)},req:["values"],idx:4},argmin:{init:t=>t.argmin=void 0,value:t=>t.argmin||t.cell.data.argmin(t.get),add:(t,e,n)=>{e<t.min&&(t.argmin=n)},rem:(t,e)=>{e<=t.min&&(t.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:t=>t.argmax=void 0,value:t=>t.argmax||t.cell.data.argmax(t.get),add:(t,e,n)=>{e>t.max&&(t.argmax=n)},rem:(t,e)=>{e>=t.max&&(t.argmax=void 0)},req:["max","values"],idx:3}},Vu=Object.keys(Wu);function qu(t,e){return Wu[t](e)}function Gu(t,e){return t.idx-e.idx}function Hu(){this.valid=0,this.missing=0,this._ops.forEach((t=>t.init(this)))}function Yu(t,e){null!=t&&""!==t?t===t&&(++this.valid,this._ops.forEach((n=>n.add(this,t,e)))):++this.missing}function Xu(t,e){null!=t&&""!==t?t===t&&(--this.valid,this._ops.forEach((n=>n.rem(this,t,e)))):--this.missing}function Ku(t){return this._out.forEach((e=>t[e.out]=e.value(this))),t}function Qu(t,e){const n=e||Xe,r=function(t){const e={};t.forEach((t=>e[t.name]=t));const n=t=>{t.req&&t.req.forEach((t=>{e[t]||n(e[t]=Wu[t]())}))};return t.forEach(n),Object.values(e).sort(Gu)}(t),i=t.slice().sort(Gu);function a(t){this._ops=r,this._out=i,this.cell=t,this.init()}return a.prototype.init=Hu,a.prototype.add=Yu,a.prototype.rem=Xu,a.prototype.set=Ku,a.prototype.get=n,a.fields=t.map((t=>t.out)),a}function Zu(t){this._key=t?He(t):Js,this.reset()}Vu.forEach((t=>{Wu[t]=function(t,e){return n=>On({name:t,out:n||t},Uu,e)}(t,Wu[t])}));const $u=Zu.prototype;function Ju(t){Ic.call(this,null,t),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}$u.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},$u.add=function(t){this._add.push(t)},$u.rem=function(t){this._rem.push(t)},$u.values=function(){if(this._get=null,0===this._rem.length)return this._add;const t=this._add,e=this._rem,n=this._key,r=t.length,i=e.length,a=Array(r-i),o={};let s,c,u;for(s=0;s<i;++s)o[n(e[s])]=1;for(s=0,c=0;s<r;++s)o[n(u=t[s])]?o[n(u)]=0:a[c++]=u;return this._rem=[],this._add=a},$u.distinct=function(t){const e=this.values(),n={};let r,i=e.length,a=0;for(;--i>=0;)r=t(e[i])+"",Bn(n,r)||(n[r]=1,++a);return a},$u.extent=function(t){if(this._get!==t||!this._ext){const e=this.values(),n=function(t,e){const n=t.length;let r,i,a,o,s,c=-1;if(null==e){for(;++c<n;)if(i=t[c],null!=i&&i>=i){r=a=i;break}if(c===n)return[-1,-1];for(o=s=c;++c<n;)i=t[c],null!=i&&(r>i&&(r=i,o=c),a<i&&(a=i,s=c))}else{for(;++c<n;)if(i=e(t[c],c,t),null!=i&&i>=i){r=a=i;break}if(c===n)return[-1,-1];for(o=s=c;++c<n;)i=e(t[c],c,t),null!=i&&(r>i&&(r=i,o=c),a<i&&(a=i,s=c))}return[o,s]}(e,t);this._ext=[e[n[0]],e[n[1]]],this._get=t}return this._ext},$u.argmin=function(t){return this.extent(t)[0]||{}},$u.argmax=function(t){return this.extent(t)[1]||{}},$u.min=function(t){const e=this.extent(t)[0];return null!=e?t(e):void 0},$u.max=function(t){const e=this.extent(t)[1];return null!=e?t(e):void 0},$u.quartile=function(t){return this._get===t&&this._q||(this._q=Xc(this.values(),t),this._get=t),this._q},$u.q1=function(t){return this.quartile(t)[0]},$u.q2=function(t){return this.quartile(t)[1]},$u.q3=function(t){return this.quartile(t)[2]},$u.ci=function(t){return this._get===t&&this._ci||(this._ci=function(t,e,n,r){if(!t.length)return[void 0,void 0];const i=Float64Array.from(Hc(t,r)),a=i.length,o=e;let s,c,u,l;for(u=0,l=Array(o);u<o;++u){for(s=0,c=0;c<a;++c)s+=i[~~(Qc()*a)];l[u]=s/a}return l.sort(zc),[qc(l,n/2),qc(l,1-n/2)]}(this.values(),1e3,.05,t),this._get=t),this._ci},$u.ci0=function(t){return this.ci(t)[0]},$u.ci1=function(t){return this.ci(t)[1]},Ju.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Vu},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},jn(Ju,Ic,{transform(t,e){const n=this,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.modified();return n.stamp=r.stamp,n.value&&(i||e.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(t):{},e.visit(e.SOURCE,(t=>n.add(t)))):(n.value=n.value||n.init(t),e.visit(e.REM,(t=>n.rem(t))),e.visit(e.ADD,(t=>n.add(t)))),r.modifies(n._outputs),n._drop=!1!==t.drop,t.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),e.clean()&&n._drop&&r.clean(!0).runAfter((()=>this.clean())),n.changes(r)},cross(){const t=this,e=t.value,n=t._dnames,r=n.map((()=>({}))),i=n.length;function a(t){let e,a,o,s;for(e in t)for(o=t[e].tuple,a=0;a<i;++a)r[a][s=o[n[a]]]=s}a(t._prev),a(e),function a(o,s,c){const u=n[c],l=r[c++];for(const n in l){const r=o?o+"|"+n:n;s[u]=l[n],c<i?a(r,s,c):e[r]||t.cell(r,s)}}("",{},0)},init(t){const e=this._inputs=[],n=this._outputs=[],r={};function i(t){const n=An(je(t)),i=n.length;let a,o=0;for(;o<i;++o)r[a=n[o]]||(r[a]=1,e.push(a))}this._dims=An(t.groupby),this._dnames=this._dims.map((t=>{const e=Pe(t);return i(t),n.push(e),e})),this.cellkey=t.key?t.key:Lu(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const a=t.fields||[null],o=t.ops||["count"],s=t.as||[],c=a.length,u={};let l,h,d,f,p,g;for(c!==o.length&&qe("Unmatched number of fields and aggregate ops."),g=0;g<c;++g)l=a[g],h=o[g],null==l&&"count"!==h&&qe("Null aggregate field specified."),f=Pe(l),p=Pu(h,f,s[g]),n.push(p),"count"!==h?(d=u[f],d||(i(l),d=u[f]=[],d.field=l,this._measures.push(d)),"count"!==h&&(this._countOnly=!1),d.push(qu(h,p))):this._counts.push(p);return this._measures=this._measures.map((t=>Qu(t,t.field))),{}},cellkey:Lu(),cell(t,e){let n=this.value[t];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[t]=this.newcell(t,e),this._adds[this._alen++]=n),n},newcell(t,e){const n={key:t,num:0,agg:null,tuple:this.newtuple(e,this._prev&&this._prev[t]),stamp:this.stamp,store:!1};if(!this._countOnly){const t=this._measures,e=t.length;n.agg=Array(e);for(let r=0;r<e;++r)n.agg[r]=new t[r](n)}return n.store&&(n.data=new Zu),n},newtuple(t,e){const n=this._dnames,r=this._dims,i=r.length,a={};for(let o=0;o<i;++o)a[n[o]]=r[o](t);return e?ic(e.tuple,a):ec(a)},clean(){const t=this.value;for(const e in t)0===t[e].num&&delete t[e]},add(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(t);const r=n.agg;for(let i=0,a=r.length;i<a;++i)r[i].add(r[i].get(t),t)},rem(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(t);const r=n.agg;for(let i=0,a=r.length;i<a;++i)r[i].rem(r[i].get(t),t)},celltuple(t){const e=t.tuple,n=this._counts;t.store&&t.data.values();for(let r=0,i=n.length;r<i;++r)e[n[r]]=t.num;if(!this._countOnly){const n=t.agg;for(let t=0,r=n.length;t<r;++t)n[t].set(e)}return e},changes(t){const e=this._adds,n=this._mods,r=this._prev,i=this._drop,a=t.add,o=t.rem,s=t.mod;let c,u,l,h;if(r)for(u in r)c=r[u],i&&!c.num||o.push(c.tuple);for(l=0,h=this._alen;l<h;++l)a.push(this.celltuple(e[l])),e[l]=null;for(l=0,h=this._mlen;l<h;++l)c=n[l],(0===c.num&&i?o:s).push(this.celltuple(c)),n[l]=null;return this._alen=this._mlen=0,this._prev=null,t}});function tl(t){Ic.call(this,null,t)}function el(t,e,n){const r=t;let i=e||[],a=n||[],o={},s=0;return{add:t=>a.push(t),remove:t=>o[r(t)]=++s,size:()=>i.length,data:(t,e)=>(s&&(i=i.filter((t=>!o[r(t)])),o={},s=0),e&&t&&i.sort(t),a.length&&(i=t?function(t,e,n,r){const i=e.length,a=n.length;if(!a)return e;if(!i)return n;const o=r||new e.constructor(i+a);let s=0,c=0,u=0;for(;s<i&&c<a;++u)o[u]=t(e[s],n[c])>0?n[c++]:e[s++];for(;s<i;++s,++u)o[u]=e[s];for(;c<a;++c,++u)o[u]=n[c];return o}(t,i,a.sort(t)):i.concat(a),a=[]),i)}}function nl(t){Ic.call(this,[],t)}function rl(t){dc.call(this,null,il,t)}function il(t){return this.value&&!t.modified()?this.value:En(t.fields,t.orders)}function al(t){Ic.call(this,null,t)}function ol(t){Ic.call(this,null,t)}tl.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},jn(tl,Ic,{transform(t,e){const n=!1!==t.interval,r=this._bins(t),i=r.start,a=r.step,o=t.as||["bin0","bin1"],s=o[0],c=o[1];let u;return u=t.modified()?(e=e.reflow(!0)).SOURCE:e.modified(je(t.field))?e.ADD_MOD:e.ADD,e.visit(u,n?t=>{const e=r(t);t[s]=e,t[c]=null==e?null:i+a*(1+(e-i)/a)}:t=>t[s]=r(t)),e.modifies(n?o:s)},_bins(t){if(this.value&&!t.modified())return this.value;const e=t.field,n=function(t){const e=t.maxbins||20,n=t.base||10,r=Math.log(n),i=t.divide||[5,2];let a,o,s,c,u,l,h=t.extent[0],d=t.extent[1];const f=t.span||d-h||Math.abs(h)||1;if(t.step)a=t.step;else if(t.steps){for(c=f/e,u=0,l=t.steps.length;u<l&&t.steps[u]<c;++u);a=t.steps[Math.max(0,u-1)]}else{for(o=Math.ceil(Math.log(e)/r),s=t.minstep||0,a=Math.max(s,Math.pow(n,Math.round(Math.log(f)/r)-o));Math.ceil(f/a)>e;)a*=n;for(u=0,l=i.length;u<l;++u)c=a/i[u],c>=s&&f/c<=e&&(a=c)}c=Math.log(a);const p=c>=0?0:1+~~(-c/r),g=Math.pow(n,-p-1);return(t.nice||void 0===t.nice)&&(c=Math.floor(h/a+g)*a,h=h<c?c-a:c,d=Math.ceil(d/a)*a),{start:h,stop:d===h?h+a:d,step:a}}(t),r=n.step;let i,a,o=n.start,s=o+Math.ceil((n.stop-o)/r)*r;null!=(i=t.anchor)&&(a=i-(o+r*Math.floor((i-o)/r)),o+=a,s+=a);const c=function(t){let n=dn(e(t));return null==n?null:n<o?-1/0:n>s?1/0:(n=Math.max(o,Math.min(n,s-r)),o+r*Math.floor(1e-14+(n-o)/r))};return c.start=o,c.stop=n.stop,c.step=r,this.value=Le(c,je(e),t.name||"bin_"+Pe(e))}}),nl.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},jn(nl,Ic,{transform(t,e){const n=e.fork(e.ALL),r=el(Js,this.value,n.materialize(n.ADD).add),i=t.sort,a=e.changed()||i&&(t.modified("sort")||e.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(a),this.value=n.source=r.data(ac(i),a),e.source&&e.source.root&&(this.value.root=e.source.root),n}}),jn(rl,dc),al.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},jn(al,Ic,{transform(t,e){const n=e=>n=>{for(var r,i=function(t,e,n){switch(e){case"upper":t=t.toUpperCase();break;case"lower":t=t.toLowerCase()}return t.match(n)}(s(n),t.case,a)||[],c=0,u=i.length;c<u;++c)o.test(r=i[c])||e(r)},r=this._parameterCheck(t,e),i=this._counts,a=this._match,o=this._stop,s=t.field,c=t.as||["text","count"],u=n((t=>i[t]=1+(i[t]||0))),l=n((t=>i[t]-=1));return r?e.visit(e.SOURCE,u):(e.visit(e.ADD,u),e.visit(e.REM,l)),this._finish(e,c)},_parameterCheck(t,e){let n=!1;return!t.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(t.stopwords||"")+"$","i"),n=!0),!t.modified("pattern")&&this._match||(this._match=new RegExp(t.pattern||"[\\w']+","g"),n=!0),(t.modified("field")||e.modified(t.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(t,e){const n=this._counts,r=this._tuples||(this._tuples={}),i=e[0],a=e[1],o=t.fork(t.NO_SOURCE|t.NO_FIELDS);let s,c,u;for(s in n)c=r[s],u=n[s]||0,!c&&u?(r[s]=c=ec({}),c[i]=s,c[a]=u,o.add.push(c)):0===u?(c&&o.rem.push(c),n[s]=null,r[s]=null):c[a]!==u&&(c[a]=u,o.mod.push(c));return o.modifies(e)}}),ol.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},jn(ol,Ic,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.as||["a","b"],i=r[0],a=r[1],o=!this.value||e.changed(e.ADD_REM)||t.modified("as")||t.modified("filter");let s=this.value;return o?(s&&(n.rem=s),s=e.materialize(e.SOURCE).source,n.add=this.value=function(t,e,n,r){for(var i,a,o=[],s={},c=t.length,u=0;u<c;++u)for(s[e]=a=t[u],i=0;i<c;++i)s[n]=t[i],r(s)&&(o.push(ec(s)),(s={})[e]=a);return o}(s,i,a,t.filter||Ze)):n.mod=s,n.source=this.value,n.modifies(r)}});const sl={kde:ou,mixture:function(t,e){let n,r=0;const i={weights(t){return arguments.length?(n=function(t){const e=[];let n,i=0;for(n=0;n<r;++n)i+=e[n]=null==t[n]?1:+t[n];for(n=0;n<r;++n)e[n]/=i;return e}(e=t||[]),i):e},distributions(n){return arguments.length?(n?(r=n.length,t=n):(r=0,t=[]),i.weights(e)):t},sample(){const e=Qc();let i=t[r-1],a=n[0],o=0;for(;o<r-1;a+=n[++o])if(e<a){i=t[o];break}return i.sample()},pdf(e){let i=0,a=0;for(;a<r;++a)i+=n[a]*t[a].pdf(e);return i},cdf(e){let i=0,a=0;for(;a<r;++a)i+=n[a]*t[a].cdf(e);return i},icdf(){throw Error("Mixture icdf not supported.")}};return i.distributions(t).weights(e)},normal:au,lognormal:function(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>su(n,r),pdf:t=>cu(t,n,r),cdf:t=>uu(t,n,r),icdf:t=>lu(t,n,r)};return i.mean(t).stdev(e)},uniform:function(t,e){let n,r;const i={min(t){return arguments.length?(n=t||0,i):n},max(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>hu(n,r),pdf:t=>du(t,n,r),cdf:t=>fu(t,n,r),icdf:t=>pu(t,n,r)};return null==e&&(e=null==t?1:t,t=0),i.min(t).max(e)}},cl="function";function ul(t,e){const n=t[cl];Bn(sl,n)||qe("Unknown distribution function: "+n);const r=sl[n]();for(const i in t)"field"===i?r.data((t.from||e()).map(t[i])):"distributions"===i?r[i](t[i].map((t=>ul(t,e)))):typeof r[i]===cl&&r[i](t[i]);return r}function ll(t){Ic.call(this,null,t)}const hl=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],dl={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:hl},{name:"weights",type:"number",array:!0}]};function fl(t,e){return t?t.map(((t,n)=>e[n]||Pe(t))):null}function pl(t,e,n){const r=[],i=t=>t(c);let a,o,s,c,u,l;if(null==e)r.push(t.map(n));else for(a={},o=0,s=t.length;o<s;++o)c=t[o],u=e.map(i),l=a[u],l||(a[u]=l=[],l.dims=u,r.push(l)),l.push(n(c));return r}ll.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:hl.concat(dl)},{name:"as",type:"string",array:!0,default:["value","density"]}]},jn(ll,Ic,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=ul(t.distribution,function(t){return()=>t.materialize(t.SOURCE).source}(e)),i=t.steps||t.minsteps||25,a=t.steps||t.maxsteps||200;let o=t.method||"pdf";"pdf"!==o&&"cdf"!==o&&qe("Invalid density method: "+o),t.extent||r.data||qe("Missing density extent parameter."),o=r[o];const s=t.as||["value","density"],c=Cu(o,t.extent||Rn(r.data()),i,a).map((t=>{const e={};return e[s[0]]=t[0],e[s[1]]=t[1],ec(e)}));this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}});function gl(t){Ic.call(this,null,t)}gl.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]};function ml(t){dc.call(this,null,vl,t),this.modified(!0)}function vl(t){const e=t.expr;return this.value&&!t.modified("expr")?this.value:Le((n=>e(n,t)),je(e),Pe(e))}function yl(t){Ic.call(this,[void 0,void 0],t)}function bl(t,e){dc.call(this,t),this.parent=e,this.count=0}function xl(t){Ic.call(this,{},t),this._keys=Pn();const e=this._targets=[];e.active=0,e.forEach=t=>{for(let n=0,r=e.active;n<r;++n)t(e[n],n,e)}}function wl(t){dc.call(this,null,kl,t)}function kl(t){return this.value&&!t.modified()?this.value:on(t.name)?An(t.name).map((t=>He(t))):He(t.name,t.as)}function _l(t){Ic.call(this,Pn(),t)}function Al(t){Ic.call(this,[],t)}function Cl(t){Ic.call(this,[],t)}function Sl(t){Ic.call(this,null,t)}function El(t){Ic.call(this,[],t)}jn(gl,Ic,{transform(t,e){if(this.value&&!t.modified()&&!e.changed())return e;const n=e.materialize(e.SOURCE).source,r=pl(e.source,t.groupby,Xe),i=t.smooth||!1,a=t.field,o=t.step||((t,e)=>Yn(Rn(t,e))/30)(n,a),s=ac(((t,e)=>a(t)-a(e))),c=t.as||"bin",u=r.length;let l,h=1/0,d=-1/0,f=0;for(;f<u;++f){const t=r[f].sort(s);l=-1;for(const e of Zc(t,o,i,a))e<h&&(h=e),e>d&&(d=e),t[++l][c]=e}return this.value={start:h,stop:d,step:o},e.reflow(!0).modifies(c)}}),jn(ml,dc),yl.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},jn(yl,Ic,{transform(t,e){const n=this.value,r=t.field,i=e.changed()||e.modified(r.fields)||t.modified("field");let a=n[0],o=n[1];if((i||null==a)&&(a=1/0,o=-1/0),e.visit(i?e.SOURCE:e.ADD,(t=>{const e=dn(r(t));null!=e&&(e<a&&(a=e),e>o&&(o=e))})),!Number.isFinite(a)||!Number.isFinite(o)){let t=Pe(r);t&&(t=' for field "'.concat(t,'"')),e.dataflow.warn("Infinite extent".concat(t,": [").concat(a,", ").concat(o,"]")),a=o=void 0}this.value=[a,o]}}),jn(bl,dc,{connect(t){return this.detachSubflow=t.detachSubflow,this.targets().add(t),t.source=this},add(t){this.count+=1,this.value.add.push(t)},rem(t){this.count-=1,this.value.rem.push(t)},mod(t){this.value.mod.push(t)},init(t){this.value.init(t,t.NO_SOURCE)},evaluate(){return this.value}}),jn(xl,Ic,{activate(t){this._targets[this._targets.active++]=t},subflow(t,e,n,r){const i=this.value;let a,o,s=Bn(i,t)&&i[t];return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(o=r||(o=this._group[t])&&o.tuple,a=n.dataflow,s=new bl(n.fork(n.NO_SOURCE),this),a.add(s).connect(e(a,t,o)),i[t]=s,this.activate(s)),s},clean(){const t=this.value;let e=0;for(const n in t)if(0===t[n].count){const r=t[n].detachSubflow;r&&r(),delete t[n],++e}if(e){const t=this._targets.filter((t=>t&&t.count>0));this.initTargets(t)}},initTargets(t){const e=this._targets,n=e.length,r=t?t.length:0;let i=0;for(;i<r;++i)e[i]=t[i];for(;i<n&&null!=e[i];++i)e[i]=null;e.active=r},transform(t,e){const n=e.dataflow,r=t.key,i=t.subflow,a=this._keys,o=t.modified("key"),s=t=>this.subflow(t,i,e);return this._group=t.group||{},this.initTargets(),e.visit(e.REM,(t=>{const e=Js(t),n=a.get(e);void 0!==n&&(a.delete(e),s(n).rem(t))})),e.visit(e.ADD,(t=>{const e=r(t);a.set(Js(t),e),s(e).add(t)})),o||e.modified(r.fields)?e.visit(e.MOD,(t=>{const e=Js(t),n=a.get(e),i=r(t);n===i?s(i).mod(t):(a.set(e,i),s(n).rem(t),s(i).add(t))})):e.changed(e.MOD)&&e.visit(e.MOD,(t=>{s(a.get(Js(t))).mod(t)})),o&&e.visit(e.REFLOW,(t=>{const e=Js(t),n=a.get(e),i=r(t);n!==i&&(a.set(e,i),s(n).rem(t),s(i).add(t))})),e.clean()?n.runAfter((()=>{this.clean(),a.clean()})):a.empty>n.cleanThreshold&&n.runAfter(a.clean),e}}),jn(wl,dc),_l.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},jn(_l,Ic,{transform(t,e){const n=e.dataflow,r=this.value,i=e.fork(),a=i.add,o=i.rem,s=i.mod,c=t.expr;let u=!0;function l(e){const n=Js(e),i=c(e,t),l=r.get(n);i&&l?(r.delete(n),a.push(e)):i||l?u&&i&&!l&&s.push(e):(r.set(n,1),o.push(e))}return e.visit(e.REM,(t=>{const e=Js(t);r.has(e)?r.delete(e):o.push(t)})),e.visit(e.ADD,(e=>{c(e,t)?a.push(e):r.set(Js(e),1)})),e.visit(e.MOD,l),t.modified()&&(u=!1,e.visit(e.REFLOW,l)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}}),Al.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},jn(Al,Ic,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=fl(r,t.as||[]),a=t.index||null,o=i.length;return n.rem=this.value,e.visit(e.SOURCE,(t=>{const e=r.map((e=>e(t))),s=e.reduce(((t,e)=>Math.max(t,e.length)),0);let c,u,l,h=0;for(;h<s;++h){for(u=nc(t),c=0;c<o;++c)u[i[c]]=null==(l=e[c][h])?null:l;a&&(u[a]=h),n.add.push(u)}})),this.value=n.source=n.add,a&&n.modifies(a),n.modifies(i)}}),Cl.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},jn(Cl,Ic,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=r.map(Pe),a=t.as||["key","value"],o=a[0],s=a[1],c=r.length;return n.rem=this.value,e.visit(e.SOURCE,(t=>{for(let e,a=0;a<c;++a)e=nc(t),e[o]=i[a],e[s]=r[a](t),n.add.push(e)})),this.value=n.source=n.add,n.modifies(a)}}),Sl.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},jn(Sl,Ic,{transform(t,e){const n=t.expr,r=t.as,i=t.modified(),a=t.initonly?e.ADD:i?e.SOURCE:e.modified(n.fields)||e.modified(r)?e.ADD_MOD:e.ADD;return i&&(e=e.materialize().reflow(!0)),t.initonly||e.modifies(r),e.visit(a,(e=>e[r]=n(e,t)))}}),jn(El,Ic,{transform(t,e){const n=e.fork(e.ALL),r=t.generator;let i,a,o,s=this.value,c=t.size-s.length;if(c>0){for(i=[];--c>=0;)i.push(o=ec(r(t))),s.push(o);n.add=n.add.length?n.materialize(n.ADD).add.concat(i):i}else a=s.slice(0,-c),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,s=s.slice(-c);return n.source=this.value=s,n}});const Tl={value:"value",median:Ru,mean:function(t,e){let n=0,r=0;if(void 0===e)for(let i of t)null!=i&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let a of t)null!=(a=e(a,++i,t))&&(a=+a)>=a&&(++n,r+=a)}if(n)return r/n},min:Tu,max:Eu},Nl=[];function Fl(t){Ic.call(this,[],t)}function Dl(t){Ju.call(this,t)}function Il(t){Ic.call(this,null,t)}function Ml(t){dc.call(this,null,Ol,t)}function Ol(t){return this.value&&!t.modified()?this.value:Gn(t.fields,t.flat)}function Rl(t){Ic.call(this,[],t),this._pending=null}function zl(t,e,n){n.forEach(ec);const r=e.fork(e.NO_FIELDS&e.NO_SOURCE);return r.rem=t.value,t.value=r.source=r.add=n,t._pending=null,r.rem.length&&r.clean(!0),r}function Bl(t){Ic.call(this,{},t)}function Ll(t){dc.call(this,null,Pl,t)}function Pl(t){if(this.value&&!t.modified())return this.value;const e=t.extents,n=e.length;let r,i,a=1/0,o=-1/0;for(r=0;r<n;++r)i=e[r],i[0]<a&&(a=i[0]),i[1]>o&&(o=i[1]);return[a,o]}function jl(t){dc.call(this,null,Ul,t)}function Ul(t){return this.value&&!t.modified()?this.value:t.values.reduce(((t,e)=>t.concat(e)),[])}function Wl(t){Ic.call(this,null,t)}function Vl(t){Ju.call(this,t)}function ql(t){xl.call(this,t)}function Gl(t){Ic.call(this,null,t)}function Hl(t){Ic.call(this,null,t)}function Yl(t){Ic.call(this,null,t)}Fl.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},jn(Fl,Ic,{transform(t,e){var n,r,i,a,o,s,c,u,l,h,d=e.fork(e.ALL),f=function(t){var e,n=t.method||Tl.value;if(null!=Tl[n])return n===Tl.value?(e=void 0!==t.value?t.value:0,()=>e):Tl[n];qe("Unrecognized imputation method: "+n)}(t),p=function(t){const e=t.field;return t=>t?e(t):NaN}(t),g=Pe(t.field),m=Pe(t.key),v=(t.groupby||[]).map(Pe),y=function(t,e,n,r){var i,a,o,s,c,u,l,h,d=t=>t(h),f=[],p=r?r.slice():[],g={},m={};for(p.forEach(((t,e)=>g[t]=e+1)),s=0,l=t.length;s<l;++s)u=n(h=t[s]),c=g[u]||(g[u]=p.push(u)),(o=m[a=(i=e?e.map(d):Nl)+""])||(o=m[a]=[],f.push(o),o.values=i),o[c-1]=h;return f.domain=p,f}(e.source,t.groupby,t.key,t.keyvals),b=[],x=this.value,w=y.domain.length;for(o=0,u=y.length;o<u;++o)for(i=(n=y[o]).values,r=NaN,c=0;c<w;++c)if(null==n[c]){for(a=y.domain[c],h={_impute:!0},s=0,l=i.length;s<l;++s)h[v[s]]=i[s];h[m]=a,h[g]=Number.isNaN(r)?r=f(n,p):r,b.push(ec(h))}return b.length&&(d.add=d.materialize(d.ADD).add.concat(b)),x.length&&(d.rem=d.materialize(d.REM).rem.concat(x)),this.value=b,d}}),Dl.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Vu},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},jn(Dl,Ju,{transform(t,e){const n=this,r=t.modified();let i;return n.value&&(r||e.modified(n._inputs,!0))?(i=n.value=r?n.init(t):{},e.visit(e.SOURCE,(t=>n.add(t)))):(i=n.value=n.value||this.init(t),e.visit(e.REM,(t=>n.rem(t))),e.visit(e.ADD,(t=>n.add(t)))),n.changes(),e.visit(e.SOURCE,(t=>{On(t,i[n.cellkey(t)].tuple)})),e.reflow(r).modifies(this._outputs)},changes(){const t=this._adds,e=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(t[n]),t[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(e[n]),e[n]=null;this._alen=this._mlen=0}}),Il.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},jn(Il,Ic,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=e.materialize(e.SOURCE).source,i=pl(r,t.groupby,t.field),a=(t.groupby||[]).map(Pe),o=t.bandwidth,s=t.cumulative?"cdf":"pdf",c=t.as||["value","density"],u=[];let l=t.extent,h=t.steps||t.minsteps||25,d=t.steps||t.maxsteps||200;"pdf"!==s&&"cdf"!==s&&qe("Invalid density method: "+s),"shared"===t.resolve&&(l||(l=Rn(r,t.field)),h=d=t.steps||d),i.forEach((e=>{const n=ou(e,o)[s],r=t.counts?e.length:1;Cu(n,l||Rn(e),h,d).forEach((t=>{const n={};for(let r=0;r<a.length;++r)n[a[r]]=e.dims[r];n[c[0]]=t[0],n[c[1]]=t[1]*r,u.push(ec(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}}),jn(Ml,dc),jn(Rl,Ic,{transform(t,e){const n=e.dataflow;if(this._pending)return zl(this,e,this._pending);if(function(t){return t.modified("async")&&!(t.modified("values")||t.modified("url")||t.modified("format"))}(t))return e.StopPropagation;if(t.values)return zl(this,e,n.parse(t.values,t.format));if(t.async){const e=n.request(t.url,t.format).then((t=>(this._pending=An(t.data),t=>t.touch(this))));return{async:e}}return n.request(t.url,t.format).then((t=>zl(this,e,An(t.data))))}}),Bl.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},jn(Bl,Ic,{transform(t,e){const n=t.fields,r=t.index,i=t.values,a=null==t.default?null:t.default,o=t.modified(),s=n.length;let c,u,l,h=o?e.SOURCE:e.ADD,d=e,f=t.as;return i?(u=i.length,s>1&&!f&&qe('Multi-field lookup requires explicit "as" parameter.'),f&&f.length!==s*u&&qe('The "as" parameter has too few output field names.'),f=f||i.map(Pe),c=function(t){for(var e,o,c=0,l=0;c<s;++c)if(null==(o=r.get(n[c](t))))for(e=0;e<u;++e,++l)t[f[l]]=a;else for(e=0;e<u;++e,++l)t[f[l]]=i[e](o)}):(f||qe("Missing output field names."),c=function(t){for(var e,i=0;i<s;++i)e=r.get(n[i](t)),t[f[i]]=null==e?a:e}),o?d=e.reflow(!0):(l=n.some((t=>e.modified(t.fields))),h|=l?e.MOD:0),e.visit(h,c),d.modifies(f)}}),jn(Ll,dc),jn(jl,dc),jn(Wl,Ic,{transform(t,e){return this.modified(t.modified()),this.value=t,e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),Vl.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:Vu,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},jn(Vl,Ju,{_transform:Ju.prototype.transform,transform(t,e){return this._transform(function(t,e){const n=t.field,r=t.value,i=("count"===t.op?"__count__":t.op)||"sum",a=je(n).concat(je(r)),o=function(t,e,n){const r={},i=[];return n.visit(n.SOURCE,(e=>{const n=t(e);r[n]||(r[n]=1,i.push(n))})),i.sort(Tn),e?i.slice(0,e):i}(n,t.limit||0,e);e.changed()&&t.set("__pivot__",null,null,!0);return{key:t.key,groupby:t.groupby,ops:o.map((()=>i)),fields:o.map((t=>function(t,e,n,r){return Le((r=>e(r)===t?n(r):NaN),r,t+"")}(t,n,r,a))),as:o.map((t=>t+"")),modified:t.modified.bind(t)}}(t,e),e)}}),jn(ql,xl,{transform(t,e){const n=t.subflow,r=t.field,i=t=>this.subflow(Js(t),n,e,t);return(t.modified("field")||r&&e.modified(je(r)))&&qe("PreFacet does not support field modification."),this.initTargets(),r?(e.visit(e.MOD,(t=>{const e=i(t);r(t).forEach((t=>e.mod(t)))})),e.visit(e.ADD,(t=>{const e=i(t);r(t).forEach((t=>e.add(ec(t))))})),e.visit(e.REM,(t=>{const e=i(t);r(t).forEach((t=>e.rem(t)))}))):(e.visit(e.MOD,(t=>i(t).mod(t))),e.visit(e.ADD,(t=>i(t).add(t))),e.visit(e.REM,(t=>i(t).rem(t)))),e.clean()&&e.runAfter((()=>this.clean())),e}}),Gl.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},jn(Gl,Ic,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=fl(t.fields,t.as||[]),a=r?(t,e)=>function(t,e,n,r){for(let i=0,a=n.length;i<a;++i)e[r[i]]=n[i](t);return e}(t,e,r,i):rc;let o;return this.value?o=this.value:(e=e.addAll(),o=this.value={}),e.visit(e.REM,(t=>{const e=Js(t);n.rem.push(o[e]),o[e]=null})),e.visit(e.ADD,(t=>{const e=a(t,ec({}));o[Js(t)]=e,n.add.push(e)})),e.visit(e.MOD,(t=>{n.mod.push(a(t,o[Js(t)]))})),n}}),jn(Hl,Ic,{transform(t,e){return this.value=t.value,t.modified("value")?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}}),Yl.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};function Xl(t){Ic.call(this,null,t)}function Kl(t){Ic.call(this,[],t),this.count=0}function Ql(t){Ic.call(this,null,t)}function Zl(t){Ic.call(this,null,t),this.modified(!0)}function $l(t){Ic.call(this,null,t)}jn(Yl,Ic,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=t.as||["prob","value"];if(this.value&&!t.modified()&&!e.changed())return n.source=this.value,n;const i=pl(e.materialize(e.SOURCE).source,t.groupby,t.field),a=(t.groupby||[]).map(Pe),o=[],s=t.step||.01,c=t.probs||zu(s/2,1-1e-14,s),u=c.length;return i.forEach((t=>{const e=Yc(t,c);for(let n=0;n<u;++n){const i={};for(let e=0;e<a.length;++e)i[a[e]]=t.dims[e];i[r[0]]=c[n],i[r[1]]=e[n],o.push(ec(i))}})),this.value&&(n.rem=this.value),this.value=n.add=n.source=o,n}}),jn(Xl,Ic,{transform(t,e){let n,r;return this.value?r=this.value:(n=e=e.addAll(),r=this.value={}),t.derive&&(n=e.fork(e.NO_SOURCE),e.visit(e.REM,(t=>{const e=Js(t);n.rem.push(r[e]),r[e]=null})),e.visit(e.ADD,(t=>{const e=nc(t);r[Js(t)]=e,n.add.push(e)})),e.visit(e.MOD,(t=>{const e=r[Js(t)];for(const r in t)e[r]=t[r],n.modifies(r);n.mod.push(e)}))),n}}),Kl.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},jn(Kl,Ic,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.modified("size"),i=t.size,a=this.value.reduce(((t,e)=>(t[Js(e)]=1,t)),{});let o=this.value,s=this.count,c=0;function u(t){let e,r;o.length<i?o.push(t):(r=~~((s+1)*Qc()),r<o.length&&r>=c&&(e=o[r],a[Js(e)]&&n.rem.push(e),o[r]=t)),++s}if(e.rem.length&&(e.visit(e.REM,(t=>{const e=Js(t);a[e]&&(a[e]=-1,n.rem.push(t)),--s})),o=o.filter((t=>-1!==a[Js(t)]))),(e.rem.length||r)&&o.length<i&&e.source&&(c=s=o.length,e.visit(e.SOURCE,(t=>{a[Js(t)]||u(t)})),c=-1),r&&o.length>i){const t=o.length-i;for(let e=0;e<t;++e)a[Js(o[e])]=-1,n.rem.push(o[e]);o=o.slice(t)}return e.mod.length&&e.visit(e.MOD,(t=>{a[Js(t)]&&n.mod.push(t)})),e.add.length&&e.visit(e.ADD,u),(e.add.length||c<0)&&(n.add=o.filter((t=>!a[Js(t)]))),this.count=s,this.value=n.source=o,n}}),Ql.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},jn(Ql,Ic,{transform(t,e){if(this.value&&!t.modified())return;const n=e.materialize().fork(e.MOD),r=t.as||"data";return n.rem=this.value?e.rem.concat(this.value):e.rem,this.value=zu(t.start,t.stop,t.step||1).map((t=>{const e={};return e[r]=t,ec(e)})),n.add=e.add.concat(this.value),n}}),jn(Zl,Ic,{transform(t,e){return this.value=e.source,e.changed()?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}});const Jl=["unit0","unit1"];function th(t){Ic.call(this,Pn(),t)}function eh(t){Ic.call(this,null,t)}$l.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:Hi,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:Jl}]},jn($l,Ic,{transform(t,e){const n=t.field,r=!1!==t.interval,i="utc"===t.timezone,a=this._floor(t,e),o=(i?va:ma)(a.unit).offset,s=t.as||Jl,c=s[0],u=s[1],l=a.step;let h=a.start||1/0,d=a.stop||-1/0,f=e.ADD;return(t.modified()||e.modified(je(n)))&&(f=(e=e.reflow(!0)).SOURCE,h=1/0,d=-1/0),e.visit(f,(t=>{const e=n(t);let i,s;null==e?(t[c]=null,r&&(t[u]=null)):(t[c]=i=s=a(e),r&&(t[u]=s=o(i,l)),i<h&&(h=i),s>d&&(d=s))})),a.start=h,a.stop=d,e.modifies(r?s:c)},_floor(t,e){const n="utc"===t.timezone,{units:r,step:i}=t.units?{units:t.units,step:t.step||1}:Oa({extent:t.extent||Rn(e.materialize(e.SOURCE).source,t.field),maxbins:t.maxbins}),a=Xi(r),o=this.value||{},s=(n?fa:la)(a,i);return s.unit=hn(a),s.units=a,s.step=i,s.start=o.start,s.stop=o.stop,this.value=s}}),jn(th,Ic,{transform(t,e){const n=e.dataflow,r=t.field,i=this.value,a=t=>i.set(r(t),t);let o=!0;return t.modified("field")||e.modified(r.fields)?(i.clear(),e.visit(e.SOURCE,a)):e.changed()?(e.visit(e.REM,(t=>i.delete(r(t)))),e.visit(e.ADD,a)):o=!1,this.modified(o),i.empty>n.cleanThreshold&&n.runAfter(i.clean),e.fork()}}),jn(eh,Ic,{transform(t,e){(!this.value||t.modified("field")||t.modified("sort")||e.changed()||t.sort&&e.modified(t.sort.fields))&&(this.value=(t.sort?e.source.slice().sort(ac(t.sort)):e.source).map(t.field))}});const nh={row_number:function(){return{next:t=>t.index+1}},rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?t=n+1:t}}},dense_rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?++t:t}}},percent_rank:function(){const t=nh.rank(),e=t.next;return{init:t.init,next:t=>(e(t)-1)/(t.data.length-1)}},cume_dist:function(){let t;return{init:()=>t=0,next:e=>{const n=e.data,r=e.compare;let i=e.index;if(t<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;t=i}return(1+t)/n.length}}},ntile:function(t,e){(e=+e)>0||qe("ntile num must be greater than zero.");const n=nh.cume_dist(),r=n.next;return{init:n.init,next:t=>Math.ceil(e*r(t))}},lag:function(t,e){return e=+e||1,{next:n=>{const r=n.index-e;return r>=0?t(n.data[r]):null}}},lead:function(t,e){return e=+e||1,{next:n=>{const r=n.index+e,i=n.data;return r<i.length?t(i[r]):null}}},first_value:function(t){return{next:e=>t(e.data[e.i0])}},last_value:function(t){return{next:e=>t(e.data[e.i1-1])}},nth_value:function(t,e){return(e=+e)>0||qe("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(e-1);return r<n.i1?t(n.data[r]):null}}},prev_value:function(t){let e;return{init:()=>e=null,next:n=>{const r=t(n.data[n.index]);return null!=r?e=r:e}}},next_value:function(t){let e,n;return{init:()=>(e=null,n=-1),next:r=>{const i=r.data;return r.index<=n?e:(n=function(t,e,n){for(let r=e.length;n<r;++n){if(null!=t(e[n]))return n}return-1}(t,i,r.index))<0?(n=i.length,e=null):e=t(i[n])}}}};const rh=Object.keys(nh);function ih(t){const e=An(t.ops),n=An(t.fields),r=An(t.params),i=An(t.as),a=this.outputs=[],o=this.windows=[],s={},c={},u=[],l=[];let h=!0;function d(t){An(je(t)).forEach((t=>s[t]=1))}d(t.sort),e.forEach(((t,e)=>{const s=n[e],f=Pe(s),p=Pu(t,f,i[e]);if(d(s),a.push(p),Bn(nh,t))o.push(function(t,e,n,r){const i=nh[t](e,n);return{init:i.init||Ke,update:function(t,e){e[r]=i.next(t)}}}(t,n[e],r[e],p));else{if(null==s&&"count"!==t&&qe("Null aggregate field specified."),"count"===t)return void u.push(p);h=!1;let e=c[f];e||(e=c[f]=[],e.field=s,l.push(e)),e.push(qu(t,p))}})),(u.length||l.length)&&(this.cell=function(t,e,n){t=t.map((t=>Qu(t,t.field)));const r={num:0,agg:null,store:!1,count:e};if(!n)for(var i=t.length,a=r.agg=Array(i),o=0;o<i;++o)a[o]=new t[o](r);if(r.store)var s=r.data=new Zu;return r.add=function(t){if(r.num+=1,!n){s&&s.add(t);for(let e=0;e<i;++e)a[e].add(a[e].get(t),t)}},r.rem=function(t){if(r.num-=1,!n){s&&s.rem(t);for(let e=0;e<i;++e)a[e].rem(a[e].get(t),t)}},r.set=function(t){let i,o;for(s&&s.values(),i=0,o=e.length;i<o;++i)t[e[i]]=r.num;if(!n)for(i=0,o=a.length;i<o;++i)a[i].set(t)},r.init=function(){r.num=0,s&&s.reset();for(let t=0;t<i;++t)a[t].init()},r}(l,u,h)),this.inputs=Object.keys(s)}const ah=ih.prototype;function oh(t){Ic.call(this,{},t),this._mlen=0,this._mods=[]}function sh(t,e,n,r){const i=r.sort,a=i&&!r.ignorePeers,o=r.frame||[null,0],s=t.data(n),c=s.length,u=a?Bu(i):null,l={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:i||In(-1)};e.init();for(let h=0;h<c;++h)ch(l,o,h,c),a&&uh(l,u),e.update(l,s[h])}function ch(t,e,n,r){t.p0=t.i0,t.p1=t.i1,t.i0=null==e[0]?0:Math.max(0,n-Math.abs(e[0])),t.i1=null==e[1]?r:Math.min(r,n+Math.abs(e[1])+1),t.index=n}function uh(t,e){const n=t.i0,r=t.i1-1,i=t.compare,a=t.data,o=a.length-1;n>0&&!i(a[n],a[n-1])&&(t.i0=e.left(a,a[n])),r<o&&!i(a[r],a[r+1])&&(t.i1=e.right(a,a[r]))}function lh(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function hh(t){this._context=t}function dh(t){return new hh(t)}function fh(){}function ph(t){this._context=t}function gh(t){return new ph(t)}function mh(t){this._context=t}function vh(t){return new mh(t)}function yh(t,e){this._basis=new hh(t),this._beta=e}ah.init=function(){this.windows.forEach((t=>t.init())),this.cell&&this.cell.init()},ah.update=function(t,e){const n=this.cell,r=this.windows,i=t.data,a=r&&r.length;let o;if(n){for(o=t.p0;o<t.i0;++o)n.rem(i[o]);for(o=t.p1;o<t.i1;++o)n.add(i[o]);n.set(e)}for(o=0;o<a;++o)r[o].update(t,e)},oh.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:rh.concat(Vu)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},jn(oh,Ic,{transform(t,e){this.stamp=e.stamp;const n=t.modified(),r=ac(t.sort),i=Lu(t.groupby),a=t=>this.group(i(t));let o=this.state;o&&!n||(o=this.state=new ih(t)),n||e.modified(o.inputs)?(this.value={},e.visit(e.SOURCE,(t=>a(t).add(t)))):(e.visit(e.REM,(t=>a(t).remove(t))),e.visit(e.ADD,(t=>a(t).add(t))));for(let s=0,c=this._mlen;s<c;++s)sh(this._mods[s],o,r,t);return this._mlen=0,this._mods=[],e.reflow(n).modifies(o.outputs)},group(t){let e=this.value[t];return e||(e=this.value[t]=el(Js),e.stamp=-1),e.stamp<this.stamp&&(e.stamp=this.stamp,this._mods[this._mlen++]=e),e}}),hh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:lh(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:lh(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},ph.prototype={areaStart:fh,areaEnd:fh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:lh(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},mh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:lh(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},yh.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],a=e[0],o=t[n]-i,s=e[n]-a,c=-1;++c<=n;)r=c/n,this._basis.point(this._beta*t[c]+(1-this._beta)*(i+r*o),this._beta*e[c]+(1-this._beta)*(a+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};const bh=function t(e){function n(t){return 1===e?new hh(t):new yh(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function xh(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function wh(t,e){this._context=t,this._k=(1-e)/6}wh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:xh(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:xh(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const kh=function t(e){function n(t){return new wh(t,e)}return n.tension=function(e){return t(+e)},n}(0);function _h(t,e){this._context=t,this._k=(1-e)/6}_h.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:xh(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Ah=function t(e){function n(t){return new _h(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Ch(t,e){this._context=t,this._k=(1-e)/6}Ch.prototype={areaStart:fh,areaEnd:fh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:xh(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Sh=function t(e){function n(t){return new Ch(t,e)}return n.tension=function(e){return t(+e)},n}(0),Eh=Math.abs,Th=Math.atan2,Nh=Math.cos,Fh=Math.max,Dh=Math.min,Ih=Math.sin,Mh=Math.sqrt,Oh=1e-12,Rh=Math.PI,zh=Rh/2,Bh=2*Rh;function Lh(t){return t>=1?zh:t<=-1?-zh:Math.asin(t)}function Ph(t,e,n){var r=t._x1,i=t._y1,a=t._x2,o=t._y2;if(t._l01_a>Oh){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>Oh){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,l=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*u+t._x1*t._l23_2a-e*t._l12_2a)/l,o=(o*u+t._y1*t._l23_2a-n*t._l12_2a)/l}t._context.bezierCurveTo(r,i,a,o,t._x2,t._y2)}function jh(t,e){this._context=t,this._alpha=e}jh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:Ph(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Uh=function t(e){function n(t){return e?new jh(t,e):new wh(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Wh(t,e){this._context=t,this._alpha=e}Wh.prototype={areaStart:fh,areaEnd:fh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Ph(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Vh=function t(e){function n(t){return e?new Wh(t,e):new Ch(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function qh(t,e){this._context=t,this._alpha=e}qh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ph(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Gh=function t(e){function n(t){return e?new qh(t,e):new _h(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Hh(t){this._context=t}function Yh(t){return new Hh(t)}function Xh(t){this._context=t}function Kh(t){return new Xh(t)}function Qh(t){return t<0?-1:1}function Zh(t,e,n){var r=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(r||i<0&&-0),o=(n-t._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(Qh(a)+Qh(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function $h(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Jh(t,e,n){var r=t._x0,i=t._y0,a=t._x1,o=t._y1,s=(a-r)/3;t._context.bezierCurveTo(r+s,i+s*e,a-s,o-s*n,a,o)}function td(t){this._context=t}function ed(t){this._context=new nd(t)}function nd(t){this._context=t}function rd(t){return new td(t)}function id(t){return new ed(t)}function ad(t){this._context=t}function od(t){var e,n,r=t.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(i[r-1]=o[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(o[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function sd(t){return new ad(t)}function cd(t,e){this._context=t,this._t=e}function ud(t){return new cd(t,.5)}function ld(t){return new cd(t,0)}function hd(t){return new cd(t,1)}function dd(t){return function(){return t}}function fd(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var pd,gd,md,vd,yd,bd,xd,wd,kd,_d,Ad,Cd,Sd,Ed;Hh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}},Xh.prototype={areaStart:fh,areaEnd:fh,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},td.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Jh(this,this._t0,$h(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Jh(this,$h(this,n=Zh(this,t,e)),n);break;default:Jh(this,this._t0,n=Zh(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(ed.prototype=Object.create(td.prototype)).point=function(t,e){td.prototype.point.call(this,e,t)},nd.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,a){this._context.bezierCurveTo(e,t,r,n,a,i)}},ad.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=od(t),i=od(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},cd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};const Td=Math.PI,Nd=2*Td,Fd=1e-6,Dd=Nd-Fd;function Id(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}class Md{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?Id:function(t){let e=Math.floor(t);if(!(e>=0))throw new Error("invalid digits: ".concat(t));if(e>15)return Id;const n=10**e;return function(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=Math.round(arguments[e]*n)/n+t[e]}}(t)}moveTo(t,e){this._append(pd||(pd=fd(["M",",",""])),this._x0=this._x1=+t,this._y0=this._y1=+e)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(gd||(gd=fd(["Z"]))))}lineTo(t,e){this._append(md||(md=fd(["L",",",""])),this._x1=+t,this._y1=+e)}quadraticCurveTo(t,e,n,r){this._append(vd||(vd=fd(["Q",",",",",",",""])),+t,+e,this._x1=+n,this._y1=+r)}bezierCurveTo(t,e,n,r,i,a){this._append(yd||(yd=fd(["C",",",",",",",",",",",""])),+t,+e,+n,+r,this._x1=+i,this._y1=+a)}arcTo(t,e,n,r,i){if(t=+t,e=+e,n=+n,r=+r,(i=+i)<0)throw new Error("negative radius: ".concat(i));let a=this._x1,o=this._y1,s=n-t,c=r-e,u=a-t,l=o-e,h=u*u+l*l;if(null===this._x1)this._append(bd||(bd=fd(["M",",",""])),this._x1=t,this._y1=e);else if(h>Fd)if(Math.abs(l*s-c*u)>Fd&&i){let d=n-a,f=r-o,p=s*s+c*c,g=d*d+f*f,m=Math.sqrt(p),v=Math.sqrt(h),y=i*Math.tan((Td-Math.acos((p+h-g)/(2*m*v)))/2),b=y/v,x=y/m;Math.abs(b-1)>Fd&&this._append(wd||(wd=fd(["L",",",""])),t+b*u,e+b*l),this._append(kd||(kd=fd(["A",",",",0,0,",",",",",""])),i,i,+(l*d>u*f),this._x1=t+x*s,this._y1=e+x*c)}else this._append(xd||(xd=fd(["L",",",""])),this._x1=t,this._y1=e);else;}arc(t,e,n,r,i,a){if(t=+t,e=+e,a=!!a,(n=+n)<0)throw new Error("negative radius: ".concat(n));let o=n*Math.cos(r),s=n*Math.sin(r),c=t+o,u=e+s,l=1^a,h=a?r-i:i-r;null===this._x1?this._append(_d||(_d=fd(["M",",",""])),c,u):(Math.abs(this._x1-c)>Fd||Math.abs(this._y1-u)>Fd)&&this._append(Ad||(Ad=fd(["L",",",""])),c,u),n&&(h<0&&(h=h%Nd+Nd),h>Dd?this._append(Cd||(Cd=fd(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),n,n,l,t-o,e-s,n,n,l,this._x1=c,this._y1=u):h>Fd&&this._append(Sd||(Sd=fd(["A",",",",0,",",",",",",",""])),n,n,+(h>=Td),l,this._x1=t+n*Math.cos(i),this._y1=e+n*Math.sin(i)))}rect(t,e,n,r){this._append(Ed||(Ed=fd(["M",",","h","v","h","Z"])),this._x0=this._x1=+t,this._y0=this._y1=+e,n=+n,+r,-n)}toString(){return this._}}function Od(){return new Md}function Rd(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(null==n)e=null;else{const t=Math.floor(n);if(!(t>=0))throw new RangeError("invalid digits: ".concat(n));e=t}return t},()=>new Md(e)}function zd(t){return t.innerRadius}function Bd(t){return t.outerRadius}function Ld(t){return t.startAngle}function Pd(t){return t.endAngle}function jd(t){return t&&t.padAngle}function Ud(t,e,n,r,i,a,o){var s=t-n,c=e-r,u=(o?a:-a)/Mh(s*s+c*c),l=u*c,h=-u*s,d=t+l,f=e+h,p=n+l,g=r+h,m=(d+p)/2,v=(f+g)/2,y=p-d,b=g-f,x=y*y+b*b,w=i-a,k=d*g-p*f,_=(b<0?-1:1)*Mh(Fh(0,w*w*x-k*k)),A=(k*b-y*_)/x,C=(-k*y-b*_)/x,S=(k*b+y*_)/x,E=(-k*y+b*_)/x,T=A-m,N=C-v,F=S-m,D=E-v;return T*T+N*N>F*F+D*D&&(A=S,C=E),{cx:A,cy:C,x01:-l,y01:-h,x11:A*(i/w-1),y11:C*(i/w-1)}}function Wd(){var t=zd,e=Bd,n=dd(0),r=null,i=Ld,a=Pd,o=jd,s=null,c=Rd(u);function u(){var u,l,h=+t.apply(this,arguments),d=+e.apply(this,arguments),f=i.apply(this,arguments)-zh,p=a.apply(this,arguments)-zh,g=Eh(p-f),m=p>f;if(s||(s=u=c()),d<h&&(l=d,d=h,h=l),d>Oh)if(g>Bh-Oh)s.moveTo(d*Nh(f),d*Ih(f)),s.arc(0,0,d,f,p,!m),h>Oh&&(s.moveTo(h*Nh(p),h*Ih(p)),s.arc(0,0,h,p,f,m));else{var v,y,b=f,x=p,w=f,k=p,_=g,A=g,C=o.apply(this,arguments)/2,S=C>Oh&&(r?+r.apply(this,arguments):Mh(h*h+d*d)),E=Dh(Eh(d-h)/2,+n.apply(this,arguments)),T=E,N=E;if(S>Oh){var F=Lh(S/h*Ih(C)),D=Lh(S/d*Ih(C));(_-=2*F)>Oh?(w+=F*=m?1:-1,k-=F):(_=0,w=k=(f+p)/2),(A-=2*D)>Oh?(b+=D*=m?1:-1,x-=D):(A=0,b=x=(f+p)/2)}var I=d*Nh(b),M=d*Ih(b),O=h*Nh(k),R=h*Ih(k);if(E>Oh){var z,B=d*Nh(x),L=d*Ih(x),P=h*Nh(w),j=h*Ih(w);if(g<Rh)if(z=function(t,e,n,r,i,a,o,s){var c=n-t,u=r-e,l=o-i,h=s-a,d=h*c-l*u;if(!(d*d<Oh))return[t+(d=(l*(e-a)-h*(t-i))/d)*c,e+d*u]}(I,M,P,j,B,L,O,R)){var U=I-z[0],W=M-z[1],V=B-z[0],q=L-z[1],G=1/Ih(function(t){return t>1?0:t<-1?Rh:Math.acos(t)}((U*V+W*q)/(Mh(U*U+W*W)*Mh(V*V+q*q)))/2),H=Mh(z[0]*z[0]+z[1]*z[1]);T=Dh(E,(h-H)/(G-1)),N=Dh(E,(d-H)/(G+1))}else T=N=0}A>Oh?N>Oh?(v=Ud(P,j,I,M,d,N,m),y=Ud(B,L,O,R,d,N,m),s.moveTo(v.cx+v.x01,v.cy+v.y01),N<E?s.arc(v.cx,v.cy,N,Th(v.y01,v.x01),Th(y.y01,y.x01),!m):(s.arc(v.cx,v.cy,N,Th(v.y01,v.x01),Th(v.y11,v.x11),!m),s.arc(0,0,d,Th(v.cy+v.y11,v.cx+v.x11),Th(y.cy+y.y11,y.cx+y.x11),!m),s.arc(y.cx,y.cy,N,Th(y.y11,y.x11),Th(y.y01,y.x01),!m))):(s.moveTo(I,M),s.arc(0,0,d,b,x,!m)):s.moveTo(I,M),h>Oh&&_>Oh?T>Oh?(v=Ud(O,R,B,L,h,-T,m),y=Ud(I,M,P,j,h,-T,m),s.lineTo(v.cx+v.x01,v.cy+v.y01),T<E?s.arc(v.cx,v.cy,T,Th(v.y01,v.x01),Th(y.y01,y.x01),!m):(s.arc(v.cx,v.cy,T,Th(v.y01,v.x01),Th(v.y11,v.x11),!m),s.arc(0,0,h,Th(v.cy+v.y11,v.cx+v.x11),Th(y.cy+y.y11,y.cx+y.x11),m),s.arc(y.cx,y.cy,T,Th(y.y11,y.x11),Th(y.y01,y.x01),!m))):s.arc(0,0,h,k,w,m):s.lineTo(O,R)}else s.moveTo(0,0);if(s.closePath(),u)return s=null,u+""||null}return u.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-Rh/2;return[Nh(r)*n,Ih(r)*n]},u.innerRadius=function(e){return arguments.length?(t="function"===typeof e?e:dd(+e),u):t},u.outerRadius=function(t){return arguments.length?(e="function"===typeof t?t:dd(+t),u):e},u.cornerRadius=function(t){return arguments.length?(n="function"===typeof t?t:dd(+t),u):n},u.padRadius=function(t){return arguments.length?(r=null==t?null:"function"===typeof t?t:dd(+t),u):r},u.startAngle=function(t){return arguments.length?(i="function"===typeof t?t:dd(+t),u):i},u.endAngle=function(t){return arguments.length?(a="function"===typeof t?t:dd(+t),u):a},u.padAngle=function(t){return arguments.length?(o="function"===typeof t?t:dd(+t),u):o},u.context=function(t){return arguments.length?(s=null==t?null:t,u):s},u}Od.prototype=Md.prototype;Array.prototype.slice;function Vd(t){return"object"===typeof t&&"length"in t?t:Array.from(t)}function qd(t){return t[0]}function Gd(t){return t[1]}function Hd(t,e){var n=dd(!0),r=null,i=Yh,a=null,o=Rd(s);function s(s){var c,u,l,h=(s=Vd(s)).length,d=!1;for(null==r&&(a=i(l=o())),c=0;c<=h;++c)!(c<h&&n(u=s[c],c,s))===d&&((d=!d)?a.lineStart():a.lineEnd()),d&&a.point(+t(u,c,s),+e(u,c,s));if(l)return a=null,l+""||null}return t="function"===typeof t?t:void 0===t?qd:dd(t),e="function"===typeof e?e:void 0===e?Gd:dd(e),s.x=function(e){return arguments.length?(t="function"===typeof e?e:dd(+e),s):t},s.y=function(t){return arguments.length?(e="function"===typeof t?t:dd(+t),s):e},s.defined=function(t){return arguments.length?(n="function"===typeof t?t:dd(!!t),s):n},s.curve=function(t){return arguments.length?(i=t,null!=r&&(a=i(r)),s):i},s.context=function(t){return arguments.length?(null==t?r=a=null:a=i(r=t),s):r},s}function Yd(t,e,n){var r=null,i=dd(!0),a=null,o=Yh,s=null,c=Rd(u);function u(u){var l,h,d,f,p,g=(u=Vd(u)).length,m=!1,v=new Array(g),y=new Array(g);for(null==a&&(s=o(p=c())),l=0;l<=g;++l){if(!(l<g&&i(f=u[l],l,u))===m)if(m=!m)h=l,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),d=l-1;d>=h;--d)s.point(v[d],y[d]);s.lineEnd(),s.areaEnd()}m&&(v[l]=+t(f,l,u),y[l]=+e(f,l,u),s.point(r?+r(f,l,u):v[l],n?+n(f,l,u):y[l]))}if(p)return s=null,p+""||null}function l(){return Hd().defined(i).curve(o).context(a)}return t="function"===typeof t?t:void 0===t?qd:dd(+t),e="function"===typeof e?e:dd(void 0===e?0:+e),n="function"===typeof n?n:void 0===n?Gd:dd(+n),u.x=function(e){return arguments.length?(t="function"===typeof e?e:dd(+e),r=null,u):t},u.x0=function(e){return arguments.length?(t="function"===typeof e?e:dd(+e),u):t},u.x1=function(t){return arguments.length?(r=null==t?null:"function"===typeof t?t:dd(+t),u):r},u.y=function(t){return arguments.length?(e="function"===typeof t?t:dd(+t),n=null,u):e},u.y0=function(t){return arguments.length?(e="function"===typeof t?t:dd(+t),u):e},u.y1=function(t){return arguments.length?(n=null==t?null:"function"===typeof t?t:dd(+t),u):n},u.lineX0=u.lineY0=function(){return l().x(t).y(e)},u.lineY1=function(){return l().x(t).y(n)},u.lineX1=function(){return l().x(r).y(e)},u.defined=function(t){return arguments.length?(i="function"===typeof t?t:dd(!!t),u):i},u.curve=function(t){return arguments.length?(o=t,null!=a&&(s=o(a)),u):o},u.context=function(t){return arguments.length?(null==t?a=s=null:s=o(a=t),u):a},u}Mh(3);const Xd={draw(t,e){const n=Mh(e/Rh);t.moveTo(n,0),t.arc(0,0,n,0,Bh)}},Kd=(Mh(1/3),Ih(Rh/10)/Ih(7*Rh/10));Ih(Bh/10),Nh(Bh/10),Mh(3),Mh(3),Mh(3),Mh(12);function Qd(t,e){let n=null,r=Rd(i);function i(){let i;if(n||(n=i=r()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),i)return n=null,i+""||null}return t="function"===typeof t?t:dd(t||Xd),e="function"===typeof e?e:dd(void 0===e?64:+e),i.type=function(e){return arguments.length?(t="function"===typeof e?e:dd(e),i):t},i.size=function(t){return arguments.length?(e="function"===typeof t?t:dd(+t),i):e},i.context=function(t){return arguments.length?(n=null==t?null:t,i):n},i}function Zd(t,e){if("undefined"!==typeof document&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=t,n.height=e,n}return null}const $d=()=>"undefined"!==typeof Image?Image:null;function Jd(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function tf(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function ef(t){let e,n,r;function i(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<0?i=e+1:a=e}while(i<a)}return i}return 2!==t.length?(e=Jd,n=(e,n)=>Jd(t(e),n),r=(e,n)=>t(e)-n):(e=t===Jd||t===tf?t:nf,n=t,r=t),{left:i,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=i(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return a>n&&r(t[a-1],e)>-r(t[a],e)?a-1:a},right:function(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<=0?i=e+1:a=e}while(i<a)}return i}}}function nf(){return 0}const rf=ef(Jd),af=rf.right,of=(rf.left,ef((function(t){return null===t?NaN:+t})).center,af),sf=Math.sqrt(50),cf=Math.sqrt(10),uf=Math.sqrt(2);function lf(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=sf?10:a>=cf?5:a>=uf?2:1;let s,c,u;return i<0?(u=Math.pow(10,-i)/o,s=Math.round(t*u),c=Math.round(e*u),s/u<t&&++s,c/u>e&&--c,u=-u):(u=Math.pow(10,i)*o,s=Math.round(t/u),c=Math.round(e/u),s*u<t&&++s,c*u>e&&--c),c<s&&.5<=n&&n<2?lf(t,e,2*n):[s,c,u]}function hf(t,e,n){if(!((n=+n)>0))return[];if((t=+t)===(e=+e))return[t];const r=e<t,[i,a,o]=r?lf(e,t,n):lf(t,e,n);if(!(a>=i))return[];const s=a-i+1,c=new Array(s);if(r)if(o<0)for(let u=0;u<s;++u)c[u]=(a-u)/-o;else for(let u=0;u<s;++u)c[u]=(a-u)*o;else if(o<0)for(let u=0;u<s;++u)c[u]=(i+u)/-o;else for(let u=0;u<s;++u)c[u]=(i+u)*o;return c}function df(t,e,n){return lf(t=+t,e=+e,n=+n)[2]}function ff(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function pf(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function gf(t){let e,n,r;function i(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<0?i=e+1:a=e}while(i<a)}return i}return 2!==t.length?(e=ff,n=(e,n)=>ff(t(e),n),r=(e,n)=>t(e)-n):(e=t===ff||t===pf?t:mf,n=t,r=t),{left:i,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=i(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return a>n&&r(t[a-1],e)>-r(t[a],e)?a-1:a},right:function(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<=0?i=e+1:a=e}while(i<a)}return i}}}function mf(){return 0}function vf(t){return null===t?NaN:+t}const yf=gf(ff),bf=yf.right,xf=(yf.left,gf(vf).center,bf);function wf(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function kf(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function _f(){}var Af=.7,Cf=1/Af,Sf="\\s*([+-]?\\d+)\\s*",Ef="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Tf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Nf=/^#([0-9a-f]{3,8})$/,Ff=new RegExp("^rgb\\(".concat(Sf,",").concat(Sf,",").concat(Sf,"\\)$")),Df=new RegExp("^rgb\\(".concat(Tf,",").concat(Tf,",").concat(Tf,"\\)$")),If=new RegExp("^rgba\\(".concat(Sf,",").concat(Sf,",").concat(Sf,",").concat(Ef,"\\)$")),Mf=new RegExp("^rgba\\(".concat(Tf,",").concat(Tf,",").concat(Tf,",").concat(Ef,"\\)$")),Of=new RegExp("^hsl\\(".concat(Ef,",").concat(Tf,",").concat(Tf,"\\)$")),Rf=new RegExp("^hsla\\(".concat(Ef,",").concat(Tf,",").concat(Tf,",").concat(Ef,"\\)$")),zf={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Bf(){return this.rgb().formatHex()}function Lf(){return this.rgb().formatRgb()}function Pf(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Nf.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?jf(e):3===n?new Vf(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Uf(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Uf(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Ff.exec(t))?new Vf(e[1],e[2],e[3],1):(e=Df.exec(t))?new Vf(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=If.exec(t))?Uf(e[1],e[2],e[3],e[4]):(e=Mf.exec(t))?Uf(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Of.exec(t))?Kf(e[1],e[2]/100,e[3]/100,1):(e=Rf.exec(t))?Kf(e[1],e[2]/100,e[3]/100,e[4]):zf.hasOwnProperty(t)?jf(zf[t]):"transparent"===t?new Vf(NaN,NaN,NaN,0):null}function jf(t){return new Vf(t>>16&255,t>>8&255,255&t,1)}function Uf(t,e,n,r){return r<=0&&(t=e=n=NaN),new Vf(t,e,n,r)}function Wf(t,e,n,r){return 1===arguments.length?((i=t)instanceof _f||(i=Pf(i)),i?new Vf((i=i.rgb()).r,i.g,i.b,i.opacity):new Vf):new Vf(t,e,n,null==r?1:r);var i}function Vf(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function qf(){return"#".concat(Xf(this.r)).concat(Xf(this.g)).concat(Xf(this.b))}function Gf(){const t=Hf(this.opacity);return"".concat(1===t?"rgb(":"rgba(").concat(Yf(this.r),", ").concat(Yf(this.g),", ").concat(Yf(this.b)).concat(1===t?")":", ".concat(t,")"))}function Hf(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Yf(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Xf(t){return((t=Yf(t))<16?"0":"")+t.toString(16)}function Kf(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Zf(t,e,n,r)}function Qf(t){if(t instanceof Zf)return new Zf(t.h,t.s,t.l,t.opacity);if(t instanceof _f||(t=Pf(t)),!t)return new Zf;if(t instanceof Zf)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new Zf(o,s,c,t.opacity)}function Zf(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function $f(t){return(t=(t||0)%360)<0?t+360:t}function Jf(t){return Math.max(0,Math.min(1,t||0))}function tp(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function ep(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}wf(_f,Pf,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Bf,formatHex:Bf,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Qf(this).formatHsl()},formatRgb:Lf,toString:Lf}),wf(Vf,Wf,kf(_f,{brighter(t){return t=null==t?Cf:Math.pow(Cf,t),new Vf(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?Af:Math.pow(Af,t),new Vf(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Vf(Yf(this.r),Yf(this.g),Yf(this.b),Hf(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:qf,formatHex:qf,formatHex8:function(){return"#".concat(Xf(this.r)).concat(Xf(this.g)).concat(Xf(this.b)).concat(Xf(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:Gf,toString:Gf})),wf(Zf,(function(t,e,n,r){return 1===arguments.length?Qf(t):new Zf(t,e,n,null==r?1:r)}),kf(_f,{brighter(t){return t=null==t?Cf:Math.pow(Cf,t),new Zf(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Af:Math.pow(Af,t),new Zf(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Vf(tp(t>=240?t-240:t+120,i,r),tp(t,i,r),tp(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Zf($f(this.h),Jf(this.s),Jf(this.l),Hf(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Hf(this.opacity);return"".concat(1===t?"hsl(":"hsla(").concat($f(this.h),", ").concat(100*Jf(this.s),"%, ").concat(100*Jf(this.l),"%").concat(1===t?")":", ".concat(t,")"))}}));const np=t=>()=>t;function rp(t,e){return function(n){return t+n*e}}function ip(t){return 1===(t=+t)?ap:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):np(isNaN(e)?n:e)}}function ap(t,e){var n=e-t;return n?rp(t,n):np(isNaN(t)?e:t)}const op=function t(e){var n=ip(e);function r(t,e){var r=n((t=Wf(t)).r,(e=Wf(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=ap(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function sp(t){return function(e){var n,r,i=e.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Wf(e[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=t(a),o=t(o),s=t(s),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=s(t),r+""}}}sp((function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,s=r<e-1?t[r+2]:2*a-i;return ep((n-r/e)*e,o,i,a,s)}})),sp((function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],s=t[(r+2)%e];return ep((n-r/e)*e,i,a,o,s)}}));function cp(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=mp(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}function up(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function lp(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function hp(t,e){var n,r={},i={};for(n in null!==t&&"object"===typeof t||(t={}),null!==e&&"object"===typeof e||(e={}),e)n in t?r[n]=mp(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var dp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,fp=new RegExp(dp.source,"g");function pp(t,e){var n,r,i,a=dp.lastIndex=fp.lastIndex=0,o=-1,s=[],c=[];for(t+="",e+="";(n=dp.exec(t))&&(r=fp.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,c.push({i:o,x:lp(n,r)})),a=fp.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?c[0]?function(t){return function(e){return t(e)+""}}(c[0].x):function(t){return function(){return t}}(e):(e=c.length,function(t){for(var n,r=0;r<e;++r)s[(n=c[r]).i]=n.x(t);return s.join("")})}function gp(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(a){for(n=0;n<r;++n)i[n]=t[n]*(1-a)+e[n]*a;return i}}function mp(t,e){var n,r=typeof e;return null==e||"boolean"===r?np(e):("number"===r?lp:"string"===r?(n=Pf(e))?(e=n,op):pp:e instanceof Pf?op:e instanceof Date?up:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}(e)?gp:Array.isArray(e)?cp:"function"!==typeof e.valueOf&&"function"!==typeof e.toString||isNaN(e)?hp:lp)(t,e)}function vp(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function yp(t){return+t}var bp=[0,1];function xp(t){return t}function wp(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function kp(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=wp(i,r),a=n(o,a)):(r=wp(r,i),a=n(a,o)),function(t){return a(r(t))}}function _p(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=wp(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(e){var n=xf(t,e,1,r)-1;return a[n](i[n](e))}}function Ap(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Cp(){var t,e,n,r,i,a,o=bp,s=bp,c=mp,u=xp;function l(){var t=Math.min(o.length,s.length);return u!==xp&&(u=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(o[0],o[t-1])),r=t>2?_p:kp,i=a=null,h}function h(e){return null==e||isNaN(e=+e)?n:(i||(i=r(o.map(t),s,c)))(t(u(e)))}return h.invert=function(n){return u(e((a||(a=r(s,o.map(t),lp)))(n)))},h.domain=function(t){return arguments.length?(o=Array.from(t,yp),l()):o.slice()},h.range=function(t){return arguments.length?(s=Array.from(t),l()):s.slice()},h.rangeRound=function(t){return s=Array.from(t),c=vp,l()},h.clamp=function(t){return arguments.length?(u=!!t||xp,l()):u!==xp},h.interpolate=function(t){return arguments.length?(c=t,l()):c},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,l()}}function Sp(){return Cp()(xp,xp)}function Ep(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function Tp(t,e){switch(arguments.length){case 0:break;case 1:"function"===typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"===typeof e?this.interpolator(e):this.range(e)}return this}function Np(t,e,n,r){var i,a=function(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?df(e,t,n):df(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}(t,e,n);switch((r=Cr(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=Nr(a,o))||(r.precision=i),Br(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=Fr(a,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=Dr(a))||(r.precision=i-2*("%"===r.type))}return zr(r)}function Fp(t){var e=t.domain;return t.ticks=function(t){var n=e();return hf(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return Np(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i,a=e(),o=0,s=a.length-1,c=a[o],u=a[s],l=10;for(u<c&&(i=c,c=u,u=i,i=o,o=s,s=i);l-- >0;){if((i=df(c,u,n))===r)return a[o]=c,a[s]=u,e(a);if(i>0)c=Math.floor(c/i)*i,u=Math.ceil(u/i)*i;else{if(!(i<0))break;c=Math.ceil(c*i)/i,u=Math.floor(u*i)/i}r=i}return t},t}function Dp(){var t=Sp();return t.copy=function(){return Ap(t,Dp())},Ep.apply(t,arguments),Fp(t)}function Ip(t){var e;function n(t){return null==t||isNaN(t=+t)?e:t}return n.invert=n,n.domain=n.range=function(e){return arguments.length?(t=Array.from(e,yp),n):t.slice()},n.unknown=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return Ip(t).unknown(e)},t=arguments.length?Array.from(t,yp):[0,1],Fp(n)}function Mp(t,e){var n,r=0,i=(t=t.slice()).length-1,a=t[r],o=t[i];return o<a&&(n=r,r=i,i=n,n=a,a=o,o=n),t[r]=e.floor(a),t[i]=e.ceil(o),t}function Op(t){return Math.log(t)}function Rp(t){return Math.exp(t)}function zp(t){return-Math.log(-t)}function Bp(t){return-Math.exp(-t)}function Lp(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Pp(t){return(e,n)=>-t(-e,n)}function jp(t){const e=t(Op,Rp),n=e.domain;let r,i,a=10;function o(){return r=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}(a),i=function(t){return 10===t?Lp:t===Math.E?Math.exp:e=>Math.pow(t,e)}(a),n()[0]<0?(r=Pp(r),i=Pp(i),t(zp,Bp)):t(Op,Rp),e}return e.base=function(t){return arguments.length?(a=+t,o()):a},e.domain=function(t){return arguments.length?(n(t),o()):n()},e.ticks=t=>{const e=n();let o=e[0],s=e[e.length-1];const c=s<o;c&&([o,s]=[s,o]);let u,l,h=r(o),d=r(s);const f=null==t?10:+t;let p=[];if(!(a%1)&&d-h<f){if(h=Math.floor(h),d=Math.ceil(d),o>0){for(;h<=d;++h)for(u=1;u<a;++u)if(l=h<0?u/i(-h):u*i(h),!(l<o)){if(l>s)break;p.push(l)}}else for(;h<=d;++h)for(u=a-1;u>=1;--u)if(l=h>0?u/i(-h):u*i(h),!(l<o)){if(l>s)break;p.push(l)}2*p.length<f&&(p=hf(o,s,f))}else p=hf(h,d,Math.min(d-h,f)).map(i);return c?p.reverse():p},e.tickFormat=(t,n)=>{if(null==t&&(t=10),null==n&&(n=10===a?"s":","),"function"!==typeof n&&(a%1||null!=(n=Cr(n)).precision||(n.trim=!0),n=zr(n)),t===1/0)return n;const o=Math.max(1,a*t/e.ticks().length);return t=>{let e=t/i(Math.round(r(t)));return e*a<a-.5&&(e*=a),e<=o?n(t):""}},e.nice=()=>n(Mp(n(),{floor:t=>i(Math.floor(r(t))),ceil:t=>i(Math.ceil(r(t)))})),e}function Up(){const t=jp(Cp()).domain([1,10]);return t.copy=()=>Ap(t,Up()).base(t.base()),Ep.apply(t,arguments),t}function Wp(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Vp(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function qp(t){return t<0?-t*t:t*t}function Gp(t){var e=t(xp,xp),n=1;return e.exponent=function(e){return arguments.length?1===(n=+e)?t(xp,xp):.5===n?t(Vp,qp):t(Wp(n),Wp(1/n)):n},Fp(e)}function Hp(){var t=Gp(Cp());return t.copy=function(){return Ap(t,Hp()).exponent(t.exponent())},Ep.apply(t,arguments),t}function Yp(){return Hp.apply(null,arguments).exponent(.5)}function Xp(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Kp(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function Qp(t){var e=1,n=t(Xp(e),Kp(e));return n.constant=function(n){return arguments.length?t(Xp(e=+n),Kp(e)):e},Fp(n)}function Zp(){var t=Qp(Cp());return t.copy=function(){return Ap(t,Zp()).constant(t.constant())},Ep.apply(t,arguments)}function $p(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Jp(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function tg(){return 0}const eg=Math.sqrt(50),ng=Math.sqrt(10),rg=Math.sqrt(2);function ig(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=eg?10:a>=ng?5:a>=rg?2:1;let s,c,u;return i<0?(u=Math.pow(10,-i)/o,s=Math.round(t*u),c=Math.round(e*u),s/u<t&&++s,c/u>e&&--c,u=-u):(u=Math.pow(10,i)*o,s=Math.round(t/u),c=Math.round(e/u),s*u<t&&++s,c*u>e&&--c),c<s&&.5<=n&&n<2?ig(t,e,2*n):[s,c,u]}function ag(t,e,n){return ig(t=+t,e=+e,n=+n)[2]}function og(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?ag(e,t,n):ag(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function sg(t,e,n,r,i,a){const o=[[Ai,1,qr],[Ai,5,5e3],[Ai,15,15e3],[Ai,30,3e4],[a,1,Gr],[a,5,3e5],[a,15,9e5],[a,30,18e5],[i,1,Hr],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,Yr],[r,2,1728e5],[n,1,Xr],[e,1,Kr],[e,3,7776e6],[t,1,Qr]];function s(e,n,r){const i=Math.abs(n-e)/r,a=function(t){let e,n,r;function i(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<0?i=e+1:a=e}while(i<a)}return i}return 2!==t.length?(e=$p,n=(e,n)=>$p(t(e),n),r=(e,n)=>t(e)-n):(e=t===$p||t===Jp?t:tg,n=t,r=t),{left:i,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=i(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return a>n&&r(t[a-1],e)>-r(t[a],e)?a-1:a},right:function(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<=0?i=e+1:a=e}while(i<a)}return i}}}((t=>{let[,,e]=t;return e})).right(o,i);if(a===o.length)return t.every(og(e/Qr,n/Qr,r));if(0===a)return Ci.every(Math.max(og(e,n,r),1));const[s,c]=o[i/o[a-1][2]<o[a][2]/i?a-1:a];return s.every(c)}return[function(t,e,n){const r=e<t;r&&([t,e]=[e,t]);const i=n&&"function"===typeof n.range?n:s(t,e,n),a=i?i.range(t,+e+1):[];return r?a.reverse():a},s]}const[cg,ug]=sg(vi,bi,ui,Jr,wi,_i),[lg,hg]=sg(mi,yi,ei,Zr,xi,ki);function dg(t){return new Date(t)}function fg(t){return t instanceof Date?+t:+new Date(+t)}function pg(t,e,n,r,i,a,o,s,c,u){var l=Sp(),h=l.invert,d=l.domain,f=u(".%L"),p=u(":%S"),g=u("%I:%M"),m=u("%I %p"),v=u("%a %d"),y=u("%b %d"),b=u("%B"),x=u("%Y");function w(t){return(c(t)<t?f:s(t)<t?p:o(t)<t?g:a(t)<t?m:r(t)<t?i(t)<t?v:y:n(t)<t?b:x)(t)}return l.invert=function(t){return new Date(h(t))},l.domain=function(t){return arguments.length?d(Array.from(t,fg)):d().map(dg)},l.ticks=function(e){var n=d();return t(n[0],n[n.length-1],null==e?10:e)},l.tickFormat=function(t,e){return null==e?w:u(e)},l.nice=function(t){var n=d();return t&&"function"===typeof t.range||(t=e(n[0],n[n.length-1],null==t?10:t)),t?d(Mp(n,t)):l},l.copy=function(){return Ap(l,pg(t,e,n,r,i,a,o,s,c,u))},l}function gg(){return Ep.apply(pg(lg,hg,mi,yi,ei,Zr,xi,ki,Ai,ja).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function mg(){return Ep.apply(pg(cg,ug,vi,bi,ui,$r,wi,_i,Ai,Wa).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function vg(){var t,e,n,r,i,a=0,o=1,s=xp,c=!1;function u(e){return null==e||isNaN(e=+e)?i:s(0===n?.5:(e=(r(e)-t)*n,c?Math.max(0,Math.min(1,e)):e))}function l(t){return function(e){var n,r;return arguments.length?([n,r]=e,s=t(n,r),u):[s(0),s(1)]}}return u.domain=function(i){return arguments.length?([a,o]=i,t=r(a=+a),e=r(o=+o),n=t===e?0:1/(e-t),u):[a,o]},u.clamp=function(t){return arguments.length?(c=!!t,u):c},u.interpolator=function(t){return arguments.length?(s=t,u):s},u.range=l(mp),u.rangeRound=l(vp),u.unknown=function(t){return arguments.length?(i=t,u):i},function(i){return r=i,t=i(a),e=i(o),n=t===e?0:1/(e-t),u}}function yg(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function bg(){var t=Fp(vg()(xp));return t.copy=function(){return yg(t,bg())},Tp.apply(t,arguments)}function xg(){var t=jp(vg()).domain([1,10]);return t.copy=function(){return yg(t,xg()).base(t.base())},Tp.apply(t,arguments)}function wg(){var t=Qp(vg());return t.copy=function(){return yg(t,wg()).constant(t.constant())},Tp.apply(t,arguments)}function kg(){var t=Gp(vg());return t.copy=function(){return yg(t,kg()).exponent(t.exponent())},Tp.apply(t,arguments)}function _g(){return kg.apply(null,arguments).exponent(.5)}function Ag(){var t,e,n,r,i,a,o,s=0,c=.5,u=1,l=1,h=xp,d=!1;function f(t){return isNaN(t=+t)?o:(t=.5+((t=+a(t))-e)*(l*t<l*e?r:i),h(d?Math.max(0,Math.min(1,t)):t))}function p(t){return function(e){var n,r,i;return arguments.length?([n,r,i]=e,h=function(t,e){void 0===e&&(e=t,t=mp);for(var n=0,r=e.length-1,i=e[0],a=new Array(r<0?0:r);n<r;)a[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return a[e](t-e)}}(t,[n,r,i]),f):[h(0),h(.5),h(1)]}}return f.domain=function(o){return arguments.length?([s,c,u]=o,t=a(s=+s),e=a(c=+c),n=a(u=+u),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),l=e<t?-1:1,f):[s,c,u]},f.clamp=function(t){return arguments.length?(d=!!t,f):d},f.interpolator=function(t){return arguments.length?(h=t,f):h},f.range=p(mp),f.rangeRound=p(vp),f.unknown=function(t){return arguments.length?(o=t,f):o},function(o){return a=o,t=o(s),e=o(c),n=o(u),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),l=e<t?-1:1,f}}function Cg(){var t=Fp(Ag()(xp));return t.copy=function(){return yg(t,Cg())},Tp.apply(t,arguments)}function Sg(){var t=jp(Ag()).domain([.1,1,10]);return t.copy=function(){return yg(t,Sg()).base(t.base())},Tp.apply(t,arguments)}function Eg(){var t=Qp(Ag());return t.copy=function(){return yg(t,Eg()).constant(t.constant())},Tp.apply(t,arguments)}function Tg(){var t=Gp(Ag());return t.copy=function(){return yg(t,Tg()).exponent(t.exponent())},Tp.apply(t,arguments)}function Ng(){return Tg.apply(null,arguments).exponent(.5)}function Fg(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:vf;if((r=t.length)&&!isNaN(e=+e)){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,a=Math.floor(i),o=+n(t[a],a,t);return o+(+n(t[a+1],a+1,t)-o)*(i-a)}}function Dg(){var t,e=[],n=[],r=[];function i(){var t=0,i=Math.max(1,n.length);for(r=new Array(i-1);++t<i;)r[t-1]=Fg(e,t/i);return a}function a(e){return null==e||isNaN(e=+e)?t:n[xf(r,e)]}return a.invertExtent=function(t){var i=n.indexOf(t);return i<0?[NaN,NaN]:[i>0?r[i-1]:e[0],i<r.length?r[i]:e[e.length-1]]},a.domain=function(t){if(!arguments.length)return e.slice();e=[];for(let n of t)null==n||isNaN(n=+n)||e.push(n);return e.sort(ff),i()},a.range=function(t){return arguments.length?(n=Array.from(t),i()):n.slice()},a.unknown=function(e){return arguments.length?(t=e,a):t},a.quantiles=function(){return r.slice()},a.copy=function(){return Dg().domain(e).range(n).unknown(t)},Ep.apply(a,arguments)}function Ig(){var t,e=0,n=1,r=1,i=[.5],a=[0,1];function o(e){return null!=e&&e<=e?a[xf(i,e,0,r)]:t}function s(){var t=-1;for(i=new Array(r);++t<r;)i[t]=((t+1)*n-(t-r)*e)/(r+1);return o}return o.domain=function(t){return arguments.length?([e,n]=t,e=+e,n=+n,s()):[e,n]},o.range=function(t){return arguments.length?(r=(a=Array.from(t)).length-1,s()):a.slice()},o.invertExtent=function(t){var o=a.indexOf(t);return o<0?[NaN,NaN]:o<1?[e,i[0]]:o>=r?[i[r-1],n]:[i[o-1],i[o]]},o.unknown=function(e){return arguments.length?(t=e,o):o},o.thresholds=function(){return i.slice()},o.copy=function(){return Ig().domain([e,n]).range(a).unknown(t)},Ep.apply(Fp(o),arguments)}function Mg(){var t,e=[.5],n=[0,1],r=1;function i(i){return null!=i&&i<=i?n[xf(e,i,0,r)]:t}return i.domain=function(t){return arguments.length?(e=Array.from(t),r=Math.min(e.length,n.length-1),i):e.slice()},i.range=function(t){return arguments.length?(n=Array.from(t),r=Math.min(e.length,n.length-1),i):n.slice()},i.invertExtent=function(t){var r=n.indexOf(t);return[e[r-1],e[r]]},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return Mg().domain(e).range(n).unknown(t)},Ep.apply(i,arguments)}class Og extends Map{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Lg;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[n,r]of t)this.set(n,r)}get(t){return super.get(Rg(this,t))}has(t){return super.has(Rg(this,t))}set(t,e){return super.set(zg(this,t),e)}delete(t){return super.delete(Bg(this,t))}}Set;function Rg(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)?n.get(i):e}function zg(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)?n.get(i):(n.set(i,e),e)}function Bg(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)&&(e=n.get(i),n.delete(i)),e}function Lg(t){return null!==t&&"object"===typeof t?t.valueOf():t}const Pg=Symbol("implicit");function jg(){var t=new Og,e=[],n=[],r=Pg;function i(i){let a=t.get(i);if(void 0===a){if(r!==Pg)return r;t.set(i,a=e.push(i)-1)}return n[a%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Og;for(const r of n)t.has(r)||t.set(r,e.push(r)-1);return i},i.range=function(t){return arguments.length?(n=Array.from(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return jg(e,n).unknown(r)},Ep.apply(i,arguments),i}function Ug(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Wg(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Vg(){}var qg=.7,Gg=1/qg,Hg="\\s*([+-]?\\d+)\\s*",Yg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Xg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Kg=/^#([0-9a-f]{3,8})$/,Qg=new RegExp("^rgb\\(".concat(Hg,",").concat(Hg,",").concat(Hg,"\\)$")),Zg=new RegExp("^rgb\\(".concat(Xg,",").concat(Xg,",").concat(Xg,"\\)$")),$g=new RegExp("^rgba\\(".concat(Hg,",").concat(Hg,",").concat(Hg,",").concat(Yg,"\\)$")),Jg=new RegExp("^rgba\\(".concat(Xg,",").concat(Xg,",").concat(Xg,",").concat(Yg,"\\)$")),tm=new RegExp("^hsl\\(".concat(Yg,",").concat(Xg,",").concat(Xg,"\\)$")),em=new RegExp("^hsla\\(".concat(Yg,",").concat(Xg,",").concat(Xg,",").concat(Yg,"\\)$")),nm={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function rm(){return this.rgb().formatHex()}function im(){return this.rgb().formatRgb()}function am(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Kg.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?om(e):3===n?new lm(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?sm(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?sm(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Qg.exec(t))?new lm(e[1],e[2],e[3],1):(e=Zg.exec(t))?new lm(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=$g.exec(t))?sm(e[1],e[2],e[3],e[4]):(e=Jg.exec(t))?sm(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=tm.exec(t))?mm(e[1],e[2]/100,e[3]/100,1):(e=em.exec(t))?mm(e[1],e[2]/100,e[3]/100,e[4]):nm.hasOwnProperty(t)?om(nm[t]):"transparent"===t?new lm(NaN,NaN,NaN,0):null}function om(t){return new lm(t>>16&255,t>>8&255,255&t,1)}function sm(t,e,n,r){return r<=0&&(t=e=n=NaN),new lm(t,e,n,r)}function cm(t){return t instanceof Vg||(t=am(t)),t?new lm((t=t.rgb()).r,t.g,t.b,t.opacity):new lm}function um(t,e,n,r){return 1===arguments.length?cm(t):new lm(t,e,n,null==r?1:r)}function lm(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function hm(){return"#".concat(gm(this.r)).concat(gm(this.g)).concat(gm(this.b))}function dm(){const t=fm(this.opacity);return"".concat(1===t?"rgb(":"rgba(").concat(pm(this.r),", ").concat(pm(this.g),", ").concat(pm(this.b)).concat(1===t?")":", ".concat(t,")"))}function fm(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function pm(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function gm(t){return((t=pm(t))<16?"0":"")+t.toString(16)}function mm(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new bm(t,e,n,r)}function vm(t){if(t instanceof bm)return new bm(t.h,t.s,t.l,t.opacity);if(t instanceof Vg||(t=am(t)),!t)return new bm;if(t instanceof bm)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new bm(o,s,c,t.opacity)}function ym(t,e,n,r){return 1===arguments.length?vm(t):new bm(t,e,n,null==r?1:r)}function bm(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function xm(t){return(t=(t||0)%360)<0?t+360:t}function wm(t){return Math.max(0,Math.min(1,t||0))}function km(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function _m(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}function Am(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,s=r<e-1?t[r+2]:2*a-i;return _m((n-r/e)*e,o,i,a,s)}}function Cm(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],s=t[(r+2)%e];return _m((n-r/e)*e,i,a,o,s)}}Ug(Vg,am,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:rm,formatHex:rm,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return vm(this).formatHsl()},formatRgb:im,toString:im}),Ug(lm,um,Wg(Vg,{brighter(t){return t=null==t?Gg:Math.pow(Gg,t),new lm(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?qg:Math.pow(qg,t),new lm(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new lm(pm(this.r),pm(this.g),pm(this.b),fm(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:hm,formatHex:hm,formatHex8:function(){return"#".concat(gm(this.r)).concat(gm(this.g)).concat(gm(this.b)).concat(gm(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:dm,toString:dm})),Ug(bm,ym,Wg(Vg,{brighter(t){return t=null==t?Gg:Math.pow(Gg,t),new bm(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?qg:Math.pow(qg,t),new bm(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new lm(km(t>=240?t-240:t+120,i,r),km(t,i,r),km(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new bm(xm(this.h),wm(this.s),wm(this.l),fm(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=fm(this.opacity);return"".concat(1===t?"hsl(":"hsla(").concat(xm(this.h),", ").concat(100*wm(this.s),"%, ").concat(100*wm(this.l),"%").concat(1===t?")":", ".concat(t,")"))}}));const Sm=t=>()=>t;function Em(t,e){return function(n){return t+n*e}}function Tm(t,e){var n=e-t;return n?Em(t,n>180||n<-180?n-360*Math.round(n/360):n):Sm(isNaN(t)?e:t)}function Nm(t){return 1===(t=+t)?Fm:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Sm(isNaN(e)?n:e)}}function Fm(t,e){var n=e-t;return n?Em(t,n):Sm(isNaN(t)?e:t)}const Dm=function t(e){var n=Nm(e);function r(t,e){var r=n((t=um(t)).r,(e=um(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=Fm(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function Im(t){return function(e){var n,r,i=e.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=um(e[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=t(a),o=t(o),s=t(s),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=s(t),r+""}}}var Mm=Im(Am),Om=Im(Cm);function Rm(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(a){for(n=0;n<r;++n)i[n]=t[n]*(1-a)+e[n]*a;return i}}function zm(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Bm(t,e){return(zm(e)?Rm:Lm)(t,e)}function Lm(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=Gm(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}function Pm(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function jm(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Um(t,e){var n,r={},i={};for(n in null!==t&&"object"===typeof t||(t={}),null!==e&&"object"===typeof e||(e={}),e)n in t?r[n]=Gm(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var Wm=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Vm=new RegExp(Wm.source,"g");function qm(t,e){var n,r,i,a=Wm.lastIndex=Vm.lastIndex=0,o=-1,s=[],c=[];for(t+="",e+="";(n=Wm.exec(t))&&(r=Vm.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,c.push({i:o,x:jm(n,r)})),a=Vm.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?c[0]?function(t){return function(e){return t(e)+""}}(c[0].x):function(t){return function(){return t}}(e):(e=c.length,function(t){for(var n,r=0;r<e;++r)s[(n=c[r]).i]=n.x(t);return s.join("")})}function Gm(t,e){var n,r=typeof e;return null==e||"boolean"===r?Sm(e):("number"===r?jm:"string"===r?(n=am(e))?(e=n,Dm):qm:e instanceof am?Dm:e instanceof Date?Pm:zm(e)?Rm:Array.isArray(e)?Lm:"function"!==typeof e.valueOf&&"function"!==typeof e.toString||isNaN(e)?Um:jm)(t,e)}function Hm(t,e){void 0===e&&(e=t,t=Gm);for(var n=0,r=e.length-1,i=e[0],a=new Array(r<0?0:r);n<r;)a[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return a[e](t-e)}}function Ym(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function Xm(t,e){var n=Tm(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}}function Km(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Qm,Zm=180/Math.PI,$m={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Jm(t,e,n,r,i,a){var o,s,c;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),t*r<e*n&&(t=-t,e=-e,c=-c,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*Zm,skewX:Math.atan(c)*Zm,scaleX:o,scaleY:s}}function tv(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var s=[],c=[];return a=t(a),o=t(o),function(t,r,i,a,o,s){if(t!==i||r!==a){var c=o.push("translate(",null,e,null,n);s.push({i:c-4,x:jm(t,i)},{i:c-2,x:jm(r,a)})}else(i||a)&&o.push("translate("+i+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,c),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:jm(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(a.rotate,o.rotate,s,c),function(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:jm(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(a.skewX,o.skewX,s,c),function(t,e,n,r,a,o){if(t!==n||e!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:jm(t,n)},{i:s-2,x:jm(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,c),a=o=null,function(t){for(var e,n=-1,r=c.length;++n<r;)s[(e=c[n]).i]=e.x(t);return s.join("")}}}var ev=tv((function(t){const e=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?$m:Jm(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),nv=tv((function(t){return null==t?$m:(Qm||(Qm=document.createElementNS("http://www.w3.org/2000/svg","g")),Qm.setAttribute("transform",t),(t=Qm.transform.baseVal.consolidate())?Jm((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):$m)}),", ",")",")");function rv(t){return((t=Math.exp(t))+1/t)/2}const iv=function t(e,n,r){function i(t,i){var a,o,s=t[0],c=t[1],u=t[2],l=i[0],h=i[1],d=i[2],f=l-s,p=h-c,g=f*f+p*p;if(g<1e-12)o=Math.log(d/u)/e,a=function(t){return[s+t*f,c+t*p,u*Math.exp(e*t*o)]};else{var m=Math.sqrt(g),v=(d*d-u*u+r*g)/(2*u*n*m),y=(d*d-u*u-r*g)/(2*d*n*m),b=Math.log(Math.sqrt(v*v+1)-v),x=Math.log(Math.sqrt(y*y+1)-y);o=(x-b)/e,a=function(t){var r=t*o,i=rv(b),a=u/(n*m)*(i*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(e*r+b)-function(t){return((t=Math.exp(t))-1/t)/2}(b));return[s+a*f,c+a*p,u*i/rv(e*r+b)]}}return a.duration=1e3*o*e/Math.SQRT2,a}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i}(Math.SQRT2,2,4);function av(t){return function(e,n){var r=t((e=ym(e)).h,(n=ym(n)).h),i=Fm(e.s,n.s),a=Fm(e.l,n.l),o=Fm(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=a(t),e.opacity=o(t),e+""}}}const ov=av(Tm);var sv=av(Fm);const cv=Math.PI/180,uv=180/Math.PI,lv=.96422,hv=1,dv=.82521,fv=4/29,pv=6/29,gv=3*pv*pv,mv=.008856451679035631;function vv(t){if(t instanceof bv)return new bv(t.l,t.a,t.b,t.opacity);if(t instanceof Sv)return Ev(t);t instanceof lm||(t=cm(t));var e,n,r=_v(t.r),i=_v(t.g),a=_v(t.b),o=xv((.2225045*r+.7168786*i+.0606169*a)/hv);return r===i&&i===a?e=n=o:(e=xv((.4360747*r+.3850649*i+.1430804*a)/lv),n=xv((.0139322*r+.0971045*i+.7141733*a)/dv)),new bv(116*o-16,500*(e-o),200*(o-n),t.opacity)}function yv(t,e,n,r){return 1===arguments.length?vv(t):new bv(t,e,n,null==r?1:r)}function bv(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function xv(t){return t>mv?Math.pow(t,1/3):t/gv+fv}function wv(t){return t>pv?t*t*t:gv*(t-fv)}function kv(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function _v(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Av(t){if(t instanceof Sv)return new Sv(t.h,t.c,t.l,t.opacity);if(t instanceof bv||(t=vv(t)),0===t.a&&0===t.b)return new Sv(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*uv;return new Sv(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Cv(t,e,n,r){return 1===arguments.length?Av(t):new Sv(t,e,n,null==r?1:r)}function Sv(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function Ev(t){if(isNaN(t.h))return new bv(t.l,0,0,t.opacity);var e=t.h*cv;return new bv(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function Tv(t,e){var n=Fm((t=yv(t)).l,(e=yv(e)).l),r=Fm(t.a,e.a),i=Fm(t.b,e.b),a=Fm(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=a(e),t+""}}function Nv(t){return function(e,n){var r=t((e=Cv(e)).h,(n=Cv(n)).h),i=Fm(e.c,n.c),a=Fm(e.l,n.l),o=Fm(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=a(t),e.opacity=o(t),e+""}}}Ug(bv,yv,Wg(Vg,{brighter(t){return new bv(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker(t){return new bv(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new lm(kv(3.1338561*(e=lv*wv(e))-1.6168667*(t=hv*wv(t))-.4906146*(n=dv*wv(n))),kv(-.9787684*e+1.9161415*t+.033454*n),kv(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Ug(Sv,Cv,Wg(Vg,{brighter(t){return new Sv(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker(t){return new Sv(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb(){return Ev(this).rgb()}}));const Fv=Nv(Tm);var Dv=Nv(Fm),Iv=-.14861,Mv=1.78277,Ov=-.29227,Rv=-.90649,zv=1.97294,Bv=zv*Rv,Lv=zv*Mv,Pv=Mv*Ov-Rv*Iv;function jv(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof Uv)return new Uv(t.h,t.s,t.l,t.opacity);t instanceof lm||(t=cm(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(Pv*r+Bv*e-Lv*n)/(Pv+Bv-Lv),a=r-i,o=(zv*(n-i)-Ov*a)/Rv,s=Math.sqrt(o*o+a*a)/(zv*i*(1-i)),c=s?Math.atan2(o,a)*uv-120:NaN;return new Uv(c<0?c+360:c,s,i,t.opacity)}(t):new Uv(t,e,n,null==r?1:r)}function Uv(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Wv(t){return function e(n){function r(e,r){var i=t((e=jv(e)).h,(r=jv(r)).h),a=Fm(e.s,r.s),o=Fm(e.l,r.l),s=Fm(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=a(t),e.l=o(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}Ug(Uv,jv,Wg(Vg,{brighter(t){return t=null==t?Gg:Math.pow(Gg,t),new Uv(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?qg:Math.pow(qg,t),new Uv(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*cv,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new lm(255*(e+n*(Iv*r+Mv*i)),255*(e+n*(Ov*r+Rv*i)),255*(e+n*(zv*r)),this.opacity)}}));const Vv=Wv(Tm);var qv=Wv(Fm);function Gv(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}function Hv(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0}const Yv="linear",Xv="log",Kv="pow",Qv="sqrt",Zv="symlog",$v="time",Jv="utc",ty="sequential",ey="diverging",ny="quantile",ry="quantize",iy="threshold",ay="ordinal",oy="point",sy="band",cy="bin-ordinal",uy="continuous",ly="discrete",hy="discretizing",dy="interpolating",fy="temporal";function py(){const t=jg().unknown(void 0),e=t.domain,n=t.range;let r,i,a=[0,1],o=!1,s=0,c=0,u=.5;function l(){const t=e().length,l=a[1]<a[0],h=a[1-l],d=Hv(t,s,c);let f=a[l-0];r=(h-f)/(d||1),o&&(r=Math.floor(r)),f+=(h-f-r*(t-s))*u,i=r*(1-s),o&&(f=Math.round(f),i=Math.round(i));const p=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a}(t).map((t=>f+r*t));return n(l?p.reverse():p)}return delete t.unknown,t.domain=function(t){return arguments.length?(e(t),l()):e()},t.range=function(t){return arguments.length?(a=[+t[0],+t[1]],l()):a.slice()},t.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,l()},t.bandwidth=function(){return i},t.step=function(){return r},t.round=function(t){return arguments.length?(o=!!t,l()):o},t.padding=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),s=c,l()):s},t.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),l()):s},t.paddingOuter=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),l()):c},t.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),l()):u},t.invertRange=function(t){if(null==t[0]||null==t[1])return;const r=a[1]<a[0],o=r?n().reverse():n(),s=o.length-1;let c,u,l,h=+t[0],d=+t[1];return h!==h||d!==d||(d<h&&(l=h,h=d,d=l),d<o[0]||h>a[1-r])?void 0:(c=Math.max(0,af(o,h)-1),u=h===d?c:af(o,d)-1,h-o[c]>i+1e-10&&++c,r&&(l=c,c=s-u,u=s-l),c>u?void 0:e().slice(c,u+1))},t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return py().domain(e()).range(a).round(o).paddingInner(s).paddingOuter(c).align(u)},l()}function gy(t){const e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return gy(e())},t}var my=Array.prototype.map;const vy=Array.prototype.slice;const yy=new Map,by=Symbol("vega_scale");function xy(t){return t[by]=!0,t}function wy(t,e,n){return arguments.length>1?(yy.set(t,function(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){let n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){const n=t.range();let r,i,a,o,s=e[0],c=e[1],u=-1;for(c<s&&(i=s,s=c,c=i),a=0,o=n.length;a<o;++a)n[a]>=s&&n[a]<=c&&(u<0&&(u=a),r=a);if(!(u<0))return s=t.invertExtent(n[u]),c=t.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===c[1]?c[0]:c[1]]}}(n):void 0),n.type=t,xy(n)};return r.metadata=Jn(An(n)),r}(t,e,n)),this):ky(t)?yy.get(t):void 0}function ky(t){return yy.has(t)}function _y(t,e){const n=yy.get(t);return n&&n.metadata[e]}function Ay(t){return _y(t,uy)}function Cy(t){return _y(t,ly)}function Sy(t){return _y(t,hy)}function Ey(t){return _y(t,Xv)}function Ty(t){return _y(t,dy)}function Ny(t){return _y(t,ny)}wy("identity",Ip),wy(Yv,Dp,uy),wy(Xv,Up,[uy,Xv]),wy(Kv,Hp,uy),wy(Qv,Yp,uy),wy(Zv,Zp,uy),wy($v,gg,[uy,fy]),wy(Jv,mg,[uy,fy]),wy(ty,bg,[uy,dy]),wy("".concat(ty,"-").concat(Yv),bg,[uy,dy]),wy("".concat(ty,"-").concat(Xv),xg,[uy,dy,Xv]),wy("".concat(ty,"-").concat(Kv),kg,[uy,dy]),wy("".concat(ty,"-").concat(Qv),_g,[uy,dy]),wy("".concat(ty,"-").concat(Zv),wg,[uy,dy]),wy("".concat(ey,"-").concat(Yv),Cg,[uy,dy]),wy("".concat(ey,"-").concat(Xv),Sg,[uy,dy,Xv]),wy("".concat(ey,"-").concat(Kv),Tg,[uy,dy]),wy("".concat(ey,"-").concat(Qv),Ng,[uy,dy]),wy("".concat(ey,"-").concat(Zv),Eg,[uy,dy]),wy(ny,Dg,[hy,ny]),wy(ry,Ig,hy),wy(iy,Mg,hy),wy(cy,(function t(){let e=[],n=[];function r(t){return null==t||t!==t?void 0:n[(of(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=function(t){return my.call(t,dn)}(t),r):e.slice()},r.range=function(t){return arguments.length?(n=vy.call(t),r):n.slice()},r.tickFormat=function(t,n){return Np(e[0],hn(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}),[ly,hy]),wy(ay,jg,ly),wy(sy,py,ly),wy(oy,(function(){return gy(py().paddingInner(1))}),ly);const Fy=["clamp","base","constant","exponent"];function Dy(t,e,n){return Hm(My(e||"rgb",n),t)}function Iy(t,e,n){const r=n-e;let i,a,o;return r&&Number.isFinite(r)?(i=(a=t.type).indexOf("-"),a=i<0?a:a.slice(i+1),o=wy(a)().domain([e,n]).range([0,1]),Fy.forEach((e=>t[e]?o[e](t[e]()):0)),o):In(.5)}function My(t,e){const n=o[function(t){return"interpolate"+t.toLowerCase().split("-").map((t=>t[0].toUpperCase()+t.slice(1))).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}function Oy(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function Ry(t,e){for(const n in t)By(n,e(t[n]))}const zy={};function By(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(zy[t]=e,this):zy[t]}Ry({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},Oy),Ry({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(t=>Dy(Oy(t))));const Ly="symbol",Py="discrete",jy=t=>on(t)?t.map((t=>String(t))):String(t),Uy=(t,e)=>t[1]-e[1],Wy=(t,e)=>e[1]-t[1];function Vy(t,e,n){let r;return Vn(e)&&(t.bins&&(e=Math.max(e,t.bins.length)),null!=n&&(e=Math.min(e,Math.floor(Yn(t.domain())/n||1)+1))),sn(e)&&(r=e.step,e=e.interval),qn(e)&&(e=t.type===$v?ma(e):t.type==Jv?va(e):qe("Only time and utc scales accept interval strings."),r&&(e=e.every(r))),e}function qy(t,e,n){let r=t.range(),i=r[0],a=hn(r),o=Uy;if(i>a&&(r=a,a=i,i=r,o=Wy),i=Math.floor(i),a=Math.ceil(a),e=e.map((e=>[e,t(e)])).filter((t=>i<=t[1]&&t[1]<=a)).sort(o).map((t=>t[0])),n>0&&e.length>1){const t=[e[0],hn(e)];for(;e.length>n&&e.length>=3;)e=e.filter(((t,e)=>!(e%2)));e.length<3&&(e=t)}return e}function Gy(t,e){return t.bins?qy(t,t.bins):t.ticks?t.ticks(e):t.domain()}function Hy(t,e,n,r,i,a){const o=e.type;let s=jy;if(o===$v||i===$v)s=t.timeFormat(r);else if(o===Jv||i===Jv)s=t.utcFormat(r);else if(Ey(o)){const i=t.formatFloat(r);if(a||e.bins)s=i;else{const t=Yy(e,n,!1);s=e=>t(e)?i(e):""}}else if(e.tickFormat){const i=e.domain();s=t.formatSpan(i[0],i[i.length-1],n,r)}else r&&(s=t.format(r));return s}function Yy(t,e,n){const r=Gy(t,e),i=t.base(),a=Math.log(i),o=Math.max(1,i*e/r.length),s=t=>{let e=t/Math.pow(i,Math.round(Math.log(t)/a));return e*i<i-.5&&(e*=i),e<=o};return n?r.filter(s):s}const Xy={[ny]:"quantiles",[ry]:"thresholds",[iy]:"domain"},Ky={[ny]:"quantiles",[ry]:"domain"};function Qy(t,e){return t.bins?function(t){const e=t.slice(0,-1);return e.max=hn(t),e}(t.bins):t.type===Xv?Yy(t,e,!0):Xy[t.type]?function(t){const e=[-1/0].concat(t);return e.max=1/0,e}(t[Xy[t.type]]()):Gy(t,e)}const Zy=t=>Xy[t.type]||t.bins;function $y(t,e,n,r,i,a,o){const s=Ky[e.type]&&a!==$v&&a!==Jv?function(t,e,n){const r=e[Ky[e.type]](),i=r.length;let a,o=i>1?r[1]-r[0]:r[0];for(a=1;a<i;++a)o=Math.min(o,r[a]-r[a-1]);return t.formatSpan(0,o,30,n)}(t,e,i):Hy(t,e,n,i,a,o);return r===Ly&&Zy(e)?Jy(s):r===Py?eb(s):nb(s)}const Jy=t=>(e,n,r)=>{const i=tb(r[n+1],tb(r.max,1/0)),a=rb(e,t),o=rb(i,t);return a&&o?a+" \u2013 "+o:o?"< "+o:"\u2265 "+a},tb=(t,e)=>null!=t?t:e,eb=t=>(e,n)=>n?t(e):null,nb=t=>e=>t(e),rb=(t,e)=>Number.isFinite(t)?e(t):null;function ib(t,e,n,r){const i=r||e.type;return qn(n)&&function(t){return _y(t,fy)}(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||i!==$v?n||i!==Jv?$y(t,e,5,null,n,r,!0):t.utcFormat("%A, %d %B %Y, %X UTC"):t.timeFormat("%A, %d %B %Y, %X")}function ab(t,e,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=ib(t,e,n.format,n.formatType);if(Sy(e.type)){const t=Qy(e).slice(1).map(i),n=t.length;return"".concat(n," boundar").concat(1===n?"y":"ies",": ").concat(t.join(", "))}if(Cy(e.type)){const t=e.domain(),n=t.length,a=n>r?t.slice(0,r-2).map(i).join(", ")+", ending with "+t.slice(-1).map(i):t.map(i).join(", ");return"".concat(n," value").concat(1===n?"":"s",": ").concat(a)}{const t=e.domain();return"values from ".concat(i(t[0])," to ").concat(i(hn(t)))}}let ob=0;const sb="p_";function cb(t){return t&&t.gradient}function ub(t,e,n){const r=t.gradient;let i=t.id,a="radial"===r?sb:"";return i||(i=t.id="gradient_"+ob++,"radial"===r?(t.x1=lb(t.x1,.5),t.y1=lb(t.y1,.5),t.r1=lb(t.r1,0),t.x2=lb(t.x2,.5),t.y2=lb(t.y2,.5),t.r2=lb(t.r2,.5),a=sb):(t.x1=lb(t.x1,0),t.y1=lb(t.y1,0),t.x2=lb(t.x2,1),t.y2=lb(t.y2,0))),e[i]=t,"url("+(n||"")+"#"+a+i+")"}function lb(t,e){return null!=t?t:e}const hb={basis:{curve:dh},"basis-closed":{curve:gh},"basis-open":{curve:vh},bundle:{curve:bh,tension:"beta",value:.85},cardinal:{curve:kh,tension:"tension",value:0},"cardinal-open":{curve:Ah,tension:"tension",value:0},"cardinal-closed":{curve:Sh,tension:"tension",value:0},"catmull-rom":{curve:Uh,tension:"alpha",value:.5},"catmull-rom-closed":{curve:Vh,tension:"alpha",value:.5},"catmull-rom-open":{curve:Gh,tension:"alpha",value:.5},linear:{curve:Yh},"linear-closed":{curve:Kh},monotone:{horizontal:id,vertical:rd},natural:{curve:sd},step:{curve:ud},"step-after":{curve:hd},"step-before":{curve:ld}};function db(t,e,n){var r=Bn(hb,t)&&hb[t],i=null;return r&&(i=r.curve||r[e||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const fb={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},pb=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,gb=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,mb=/^((\s+,?\s*)|(,\s*))/,vb=/^[01]/;function yb(t){const e=[];return(t.match(pb)||[]).forEach((t=>{let n=t[0];const r=n.toLowerCase(),i=fb[r],a=function(t,e,n){const r=[];for(let i=0;e&&i<n.length;)for(let a=0;a<e;++a){const e="a"!==t||3!==a&&4!==a?gb:vb,o=n.slice(i).match(e);if(null===o)throw Error("Invalid SVG path, incorrect parameter type");i+=o[0].length,r.push(+o[0]);const s=n.slice(i).match(mb);null!==s&&(i+=s[0].length)}return r}(r,i,t.slice(1).trim()),o=a.length;if(o<i||o&&o%i!==0)throw Error("Invalid SVG path, incorrect parameter count");if(e.push([n,...a.slice(0,i)]),o!==i){"m"===r&&(n="M"===n?"L":"l");for(let t=i;t<o;t+=i)e.push([n,...a.slice(t,t+i)])}})),e}const bb=Math.PI/180,xb=Math.PI/2,wb=2*Math.PI,kb=Math.sqrt(3)/2;var _b={},Ab={},Cb=[].join;function Sb(t){const e=Cb.call(t);if(Ab[e])return Ab[e];var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],u=t[7];const l=u*o,h=-c*s,d=c*o,f=u*s,p=Math.cos(i),g=Math.sin(i),m=Math.cos(a),v=Math.sin(a),y=.5*(a-i),b=Math.sin(.5*y),x=8/3*b*b/Math.sin(y),w=n+p-x*g,k=r+g+x*p,_=n+m,A=r+v,C=_+x*v,S=A-x*m;return Ab[e]=[l*w+h*k,d*w+f*k,l*C+h*S,d*C+f*S,l*_+h*A,d*_+f*A]}const Eb=["l",0,0,0,0,0,0,0];function Tb(t,e,n){const r=Eb[0]=t[0];if("a"===r||"A"===r)Eb[1]=e*t[1],Eb[2]=n*t[2],Eb[3]=t[3],Eb[4]=t[4],Eb[5]=t[5],Eb[6]=e*t[6],Eb[7]=n*t[7];else if("h"===r||"H"===r)Eb[1]=e*t[1];else if("v"===r||"V"===r)Eb[1]=n*t[1];else for(var i=1,a=t.length;i<a;++i)Eb[i]=(i%2==1?e:n)*t[i];return Eb}function Nb(t,e,n,r,i,a){var o,s,c,u,l,h=null,d=0,f=0,p=0,g=0,m=0,v=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==a&&(a=i),t.beginPath&&t.beginPath();for(var y=0,b=e.length;y<b;++y){switch(o=e[y],1===i&&1===a||(o=Tb(o,i,a)),o[0]){case"l":d+=o[1],f+=o[2],t.lineTo(d+n,f+r);break;case"L":d=o[1],f=o[2],t.lineTo(d+n,f+r);break;case"h":d+=o[1],t.lineTo(d+n,f+r);break;case"H":d=o[1],t.lineTo(d+n,f+r);break;case"v":f+=o[1],t.lineTo(d+n,f+r);break;case"V":f=o[1],t.lineTo(d+n,f+r);break;case"m":m=d+=o[1],v=f+=o[2],t.moveTo(d+n,f+r);break;case"M":m=d=o[1],v=f=o[2],t.moveTo(d+n,f+r);break;case"c":s=d+o[5],c=f+o[6],p=d+o[3],g=f+o[4],t.bezierCurveTo(d+o[1]+n,f+o[2]+r,p+n,g+r,s+n,c+r),d=s,f=c;break;case"C":d=o[5],f=o[6],p=o[3],g=o[4],t.bezierCurveTo(o[1]+n,o[2]+r,p+n,g+r,d+n,f+r);break;case"s":s=d+o[3],c=f+o[4],p=2*d-p,g=2*f-g,t.bezierCurveTo(p+n,g+r,d+o[1]+n,f+o[2]+r,s+n,c+r),p=d+o[1],g=f+o[2],d=s,f=c;break;case"S":s=o[3],c=o[4],p=2*d-p,g=2*f-g,t.bezierCurveTo(p+n,g+r,o[1]+n,o[2]+r,s+n,c+r),d=s,f=c,p=o[1],g=o[2];break;case"q":s=d+o[3],c=f+o[4],p=d+o[1],g=f+o[2],t.quadraticCurveTo(p+n,g+r,s+n,c+r),d=s,f=c;break;case"Q":s=o[3],c=o[4],t.quadraticCurveTo(o[1]+n,o[2]+r,s+n,c+r),d=s,f=c,p=o[1],g=o[2];break;case"t":s=d+o[1],c=f+o[2],null===h[0].match(/[QqTt]/)?(p=d,g=f):"t"===h[0]?(p=2*d-u,g=2*f-l):"q"===h[0]&&(p=2*d-p,g=2*f-g),u=p,l=g,t.quadraticCurveTo(p+n,g+r,s+n,c+r),f=c,p=(d=s)+o[1],g=f+o[2];break;case"T":s=o[1],c=o[2],p=2*d-p,g=2*f-g,t.quadraticCurveTo(p+n,g+r,s+n,c+r),d=s,f=c;break;case"a":Fb(t,d+n,f+r,[o[1],o[2],o[3],o[4],o[5],o[6]+d+n,o[7]+f+r]),d+=o[6],f+=o[7];break;case"A":Fb(t,d+n,f+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),d=o[6],f=o[7];break;case"z":case"Z":d=m,f=v,t.closePath()}h=o}}function Fb(t,e,n,r){const i=function(t,e,n,r,i,a,o,s,c){const u=Cb.call(arguments);if(_b[u])return _b[u];const l=o*bb,h=Math.sin(l),d=Math.cos(l),f=d*(s-t)*.5+h*(c-e)*.5,p=d*(c-e)*.5-h*(s-t)*.5;let g=f*f/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=d/n,v=h/n,y=-h/r,b=d/r,x=m*s+v*c,w=y*s+b*c,k=m*t+v*e,_=y*t+b*e;let A=1/((k-x)*(k-x)+(_-w)*(_-w))-.25;A<0&&(A=0);let C=Math.sqrt(A);a==i&&(C=-C);const S=.5*(x+k)-C*(_-w),E=.5*(w+_)+C*(k-x),T=Math.atan2(w-E,x-S);let N=Math.atan2(_-E,k-S)-T;N<0&&1===a?N+=wb:N>0&&0===a&&(N-=wb);const F=Math.ceil(Math.abs(N/(xb+.001))),D=[];for(let I=0;I<F;++I){const t=T+I*N/F,e=T+(I+1)*N/F;D[I]=[S,E,t,e,n,r,h,d]}return _b[u]=D}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n);for(let a=0;a<i.length;++a){const e=Sb(i[a]);t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5])}}const Db=.5773502691896257,Ib={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,wb)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,a=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-a),t.lineTo(i,-a),t.lineTo(0,-n),t.lineTo(-i,-a),t.lineTo(-r,-a),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=kb*n,i=r-n*Db,a=n/4;t.moveTo(0,-r-i),t.lineTo(-a,r-i),t.lineTo(a,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=kb*n,i=r-n*Db;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=kb*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=kb*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=kb*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=kb*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function Mb(t){return Bn(Ib,t)?Ib[t]:function(t){if(!Bn(Ob,t)){const e=yb(t);Ob[t]={draw:function(t,n){Nb(t,e,0,0,Math.sqrt(n)/2)}}}return Ob[t]}(t)}var Ob={};const Rb=.448084975506;function zb(t){return t.x}function Bb(t){return t.y}function Lb(t){return t.width}function Pb(t){return t.height}function jb(t){return"function"===typeof t?t:()=>+t}function Ub(t,e,n){return Math.max(e,Math.min(t,n))}function Wb(t,e){return null!=t?t:e}const Vb=t=>t.x||0,qb=t=>t.y||0,Gb=t=>!(!1===t.defined),Hb=Wd().startAngle((t=>t.startAngle||0)).endAngle((t=>t.endAngle||0)).padAngle((t=>t.padAngle||0)).innerRadius((t=>t.innerRadius||0)).outerRadius((t=>t.outerRadius||0)).cornerRadius((t=>t.cornerRadius||0)),Yb=Yd().x(Vb).y1(qb).y0((t=>(t.y||0)+(t.height||0))).defined(Gb),Xb=Yd().y(qb).x1(Vb).x0((t=>(t.x||0)+(t.width||0))).defined(Gb),Kb=Hd().x(Vb).y(qb).defined(Gb),Qb=function(){var t=zb,e=Bb,n=Lb,r=Pb,i=jb(0),a=i,o=i,s=i,c=null;function u(u,l,h){var d,f=null!=l?l:+t.call(this,u),p=null!=h?h:+e.call(this,u),g=+n.call(this,u),m=+r.call(this,u),v=Math.min(g,m)/2,y=Ub(+i.call(this,u),0,v),b=Ub(+a.call(this,u),0,v),x=Ub(+o.call(this,u),0,v),w=Ub(+s.call(this,u),0,v);if(c||(c=d=Od()),y<=0&&b<=0&&x<=0&&w<=0)c.rect(f,p,g,m);else{var k=f+g,_=p+m;c.moveTo(f+y,p),c.lineTo(k-b,p),c.bezierCurveTo(k-Rb*b,p,k,p+Rb*b,k,p+b),c.lineTo(k,_-w),c.bezierCurveTo(k,_-Rb*w,k-Rb*w,_,k-w,_),c.lineTo(f+x,_),c.bezierCurveTo(f+Rb*x,_,f,_-Rb*x,f,_-x),c.lineTo(f,p+y),c.bezierCurveTo(f,p+Rb*y,f+Rb*y,p,f+y,p),c.closePath()}if(d)return c=null,d+""||null}return u.x=function(e){return arguments.length?(t=jb(e),u):t},u.y=function(t){return arguments.length?(e=jb(t),u):e},u.width=function(t){return arguments.length?(n=jb(t),u):n},u.height=function(t){return arguments.length?(r=jb(t),u):r},u.cornerRadius=function(t,e,n,r){return arguments.length?(i=jb(t),a=null!=e?jb(e):i,s=null!=n?jb(n):i,o=null!=r?jb(r):a,u):i},u.context=function(t){return arguments.length?(c=null==t?null:t,u):c},u}().x(Vb).y(qb).width((t=>t.width||0)).height((t=>t.height||0)).cornerRadius((t=>Wb(t.cornerRadiusTopLeft,t.cornerRadius)||0),(t=>Wb(t.cornerRadiusTopRight,t.cornerRadius)||0),(t=>Wb(t.cornerRadiusBottomRight,t.cornerRadius)||0),(t=>Wb(t.cornerRadiusBottomLeft,t.cornerRadius)||0)),Zb=Qd().type((t=>Mb(t.shape||"circle"))).size((t=>Wb(t.size,64))),$b=function(){var t,e,n,r,i,a,o,s,c=null;function u(t,e,n){const r=n/2;if(i){var u=o-e,l=t-a;if(u||l){var h=Math.hypot(u,l),d=(u/=h)*s,f=(l/=h)*s,p=Math.atan2(l,u);c.moveTo(a-d,o-f),c.lineTo(t-u*r,e-l*r),c.arc(t,e,r,p-Math.PI,p),c.lineTo(a+d,o+f),c.arc(a,o,s,p,p+Math.PI)}else c.arc(t,e,r,0,wb);c.closePath()}else i=1;a=t,o=e,s=r}function l(a){var o,s,l,h=a.length,d=!1;for(null==c&&(c=l=Od()),o=0;o<=h;++o)!(o<h&&r(s=a[o],o,a))===d&&(d=!d)&&(i=0),d&&u(+t(s,o,a),+e(s,o,a),+n(s,o,a));if(l)return c=null,l+""||null}return l.x=function(e){return arguments.length?(t=e,l):t},l.y=function(t){return arguments.length?(e=t,l):e},l.size=function(t){return arguments.length?(n=t,l):n},l.defined=function(t){return arguments.length?(r=t,l):r},l.context=function(t){return arguments.length?(c=null==t?null:t,l):c},l}().x(Vb).y(qb).defined(Gb).size((t=>t.size||1));function Jb(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function tx(t,e,n,r){return Qb.context(t)(e,n,r)}var ex=1;function nx(t,e,n){var r=e.clip,i=t._defs,a=e.clip_id||(e.clip_id="clip"+ex++),o=i.clipping[a]||(i.clipping[a]={id:a});return Cn(r)?o.path=r(null):Jb(n)?o.path=tx(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+a+")"}function rx(t){this.clear(),t&&this.union(t)}function ix(t){this.mark=t,this.bounds=this.bounds||new rx}function ax(t){ix.call(this,t),this.items=this.items||[]}function ox(t){this._pending=0,this._loader=t||Ys()}function sx(t){t._pending+=1}function cx(t){t._pending-=1}function ux(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){const r=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(r+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}(e,r):0))}return t}rx.prototype={clone(){return new rx(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){const r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(t,e,n){var{x1:r,y1:i,x2:a,y2:o}=this,s=Math.cos(t),c=Math.sin(t),u=e-e*s+n*c,l=n-e*c-n*s;return[s*r-c*i+u,c*r+s*i+l,s*r-c*o+u,c*r+s*o+l,s*a-c*i+u,c*a+s*i+l,s*a-c*o+u,c*a+s*o+l]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},jn(ax,ix),ox.prototype={pending(){return this._pending},sanitizeURL(t){const e=this;return sx(e),e._loader.sanitize(t,{context:"href"}).then((t=>(cx(e),t))).catch((()=>(cx(e),null)))},loadImage(t){const e=this,n=$d();return sx(e),e._loader.sanitize(t,{context:"image"}).then((t=>{const r=t.href;if(!r||!n)throw{url:r};const i=new n,a=Bn(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=a&&(i.crossOrigin=a),i.onload=()=>cx(e),i.onerror=()=>cx(e),i.src=r,i})).catch((t=>(cx(e),{complete:!1,width:0,height:0,src:t&&t.url||""})))},ready(){const t=this;return new Promise((e=>{!function n(r){t.pending()?setTimeout((()=>{n(!0)}),10):e(r)}(!1)}))}};const lx=wb-1e-8;let hx,dx,fx,px,gx,mx,vx,yx;const bx=(t,e)=>hx.add(t,e),xx=(t,e)=>bx(dx=t,fx=e),wx=t=>bx(t,hx.y1),kx=t=>bx(hx.x1,t),_x=(t,e)=>gx*t+vx*e,Ax=(t,e)=>mx*t+yx*e,Cx=(t,e)=>bx(_x(t,e),Ax(t,e)),Sx=(t,e)=>xx(_x(t,e),Ax(t,e));function Ex(t,e){return hx=t,e?(px=e*bb,gx=yx=Math.cos(px),mx=Math.sin(px),vx=-mx):(gx=yx=1,px=mx=vx=0),Tx}const Tx={beginPath(){},closePath(){},moveTo:Sx,lineTo:Sx,rect(t,e,n,r){px?(Cx(t+n,e),Cx(t+n,e+r),Cx(t,e+r),Sx(t,e)):(bx(t+n,e+r),xx(t,e))},quadraticCurveTo(t,e,n,r){const i=_x(t,e),a=Ax(t,e),o=_x(n,r),s=Ax(n,r);Nx(dx,i,o,wx),Nx(fx,a,s,kx),xx(o,s)},bezierCurveTo(t,e,n,r,i,a){const o=_x(t,e),s=Ax(t,e),c=_x(n,r),u=Ax(n,r),l=_x(i,a),h=Ax(i,a);Fx(dx,o,c,l,wx),Fx(fx,s,u,h,kx),xx(l,h)},arc(t,e,n,r,i,a){if(r+=px,i+=px,dx=n*Math.cos(i)+t,fx=n*Math.sin(i)+e,Math.abs(i-r)>lx)bx(t-n,e-n),bx(t+n,e+n);else{const o=r=>bx(n*Math.cos(r)+t,n*Math.sin(r)+e);let s,c;if(o(r),o(i),i!==r)if((r%=wb)<0&&(r+=wb),(i%=wb)<0&&(i+=wb),i<r&&(a=!a,s=r,r=i,i=s),a)for(i-=wb,s=r-r%xb,c=0;c<4&&s>i;++c,s-=xb)o(s);else for(s=r-r%xb+xb,c=0;c<4&&s<i;++c,s+=xb)o(s)}}};function Nx(t,e,n,r){const i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function Fx(t,e,n,r,i){const a=r-t+3*e-3*n,o=t+n-2*e,s=t-e;let c,u=0,l=0;Math.abs(a)>1e-14?(c=o*o+s*a,c>=0&&(c=Math.sqrt(c),u=(-o+c)/a,l=(-o-c)/a)):u=.5*s/o,0<u&&u<1&&i(Dx(u,t,e,n,r)),0<l&&l<1&&i(Dx(l,t,e,n,r))}function Dx(t,e,n,r,i){const a=1-t,o=a*a,s=t*t;return o*a*e+3*o*t*n+3*a*s*r+s*t*i}var Ix=(Ix=Zd(1,1))?Ix.getContext("2d"):null;const Mx=new rx;function Ox(t){return function(e,n){if(!Ix)return!0;t(Ix,e),Mx.clear().union(e.bounds).intersect(n).round();const{x1:r,y1:i,x2:a,y2:o}=Mx;for(let t=i;t<=o;++t)for(let e=r;e<=a;++e)if(Ix.isPointInPath(e,t))return!0;return!1}}function Rx(t,e){return e.contains(t.x||0,t.y||0)}function zx(t,e){const n=t.x||0,r=t.y||0,i=t.width||0,a=t.height||0;return e.intersects(Mx.set(n,r,n+i,r+a))}function Bx(t,e,n,r,i){const{x1:a,y1:o,x2:s,y2:c}=t,u=r-e,l=i-n;let h,d,f,p,g=0,m=1;for(p=0;p<4;++p){if(0===p&&(h=-u,d=-(a-e)),1===p&&(h=u,d=s-e),2===p&&(h=-l,d=-(o-n)),3===p&&(h=l,d=c-n),Math.abs(h)<1e-10&&d<0)return!1;if(f=d/h,h<0){if(f>m)return!1;f>g&&(g=f)}else if(h>0){if(f<g)return!1;f<m&&(m=f)}}return!0}function Lx(t,e){t.globalCompositeOperation=e.blend||"source-over"}function Px(t,e){return null==t?e:t}function jx(t,e){const n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}function Ux(t,e,n){return cb(n)?function(t,e,n){const r=n.width(),i=n.height();let a;if("radial"===e.gradient)a=t.createRadialGradient(n.x1+Px(e.x1,.5)*r,n.y1+Px(e.y1,.5)*i,Math.max(r,i)*Px(e.r1,0),n.x1+Px(e.x2,.5)*r,n.y1+Px(e.y2,.5)*i,Math.max(r,i)*Px(e.r2,.5));else{const o=Px(e.x1,0),s=Px(e.y1,0),c=Px(e.x2,1),u=Px(e.y2,0);if(o!==c&&s!==u&&r!==i){const n=Zd(Math.ceil(r),Math.ceil(i)),a=n.getContext("2d");return a.scale(r,i),a.fillStyle=jx(a.createLinearGradient(o,s,c,u),e.stops),a.fillRect(0,0,r,i),t.createPattern(n,"no-repeat")}a=t.createLinearGradient(n.x1+o*r,n.y1+s*i,n.x1+c*r,n.y1+u*i)}return jx(a,e.stops)}(t,n,e.bounds):n}function Wx(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=Ux(t,e,e.fill),!0)}var Vx=[];function qx(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&((n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=Ux(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||Vx),t.lineDashOffset=e.strokeDashOffset||0),!0))}function Gx(t,e){return t.zindex-e.zindex||t.index-e.index}function Hx(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,a=[];for(n=0,r=i.length;n<r;++n)(e=i[n]).index=n,e.zindex&&a.push(e);return t.zdirty=!1,t.zitems=a.sort(Gx)}function Yx(t,e){var n,r,i=t.items;if(!i||!i.length)return;const a=Hx(t);if(a&&a.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=a}for(n=0,r=i.length;n<r;++n)e(i[n])}function Xx(t,e){var n,r,i=t.items;if(!i||!i.length)return null;const a=Hx(t);for(a&&a.length&&(i=a),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===a)for(r=(i=t.items).length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function Kx(t){return function(e,n,r){Yx(n,(n=>{r&&!r.intersects(n.bounds)||Zx(t,e,n,n)}))}}function Qx(t){return function(e,n,r){!n.items.length||r&&!r.intersects(n.bounds)||Zx(t,e,n.items[0],n.items)}}function Zx(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||(Lx(e,n),n.fill&&Wx(e,n,i)&&e.fill(),n.stroke&&qx(e,n,i)&&e.stroke()))}function $x(t){return t=t||Ze,function(e,n,r,i,a,o){return r*=e.pixelRatio,i*=e.pixelRatio,Xx(n,(n=>{const s=n.bounds;if((!s||s.contains(a,o))&&s)return t(e,n,r,i,a,o)?n:void 0}))}}function Jx(t,e){return function(n,r,i,a){var o,s,c=Array.isArray(r)?r[0]:r,u=null==e?c.fill:e,l=c.stroke&&n.isPointInStroke;return l&&(o=c.strokeWidth,s=c.strokeCap,n.lineWidth=null!=o?o:1,n.lineCap=null!=s?s:"butt"),!t(n,r)&&(u&&n.isPointInPath(i,a)||l&&n.isPointInStroke(i,a))}}function tw(t){return $x(Jx(t))}function ew(t,e){return"translate("+t+","+e+")"}function nw(t){return"rotate("+t+")"}function rw(t){return ew(t.x||0,t.y||0)}function iw(t,e,n){function r(t,n){var r=n.x||0,i=n.y||0,a=n.angle||0;t.translate(r,i),a&&t.rotate(a*=bb),t.beginPath(),e(t,n),a&&t.rotate(-a),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",function(t){return ew(t.x||0,t.y||0)+(t.angle?" "+nw(t.angle):"")}(n)),t("d",e(null,n))},bound:function(t,n){return e(Ex(t,n.angle),n),ux(t,n).translate(n.x||0,n.y||0)},draw:Kx(r),pick:tw(r),isect:n||Ox(r)}}var aw=iw("arc",(function(t,e){return Hb.context(t)(e)}));function ow(t,e,n){function r(t,n){t.beginPath(),e(t,n)}const i=Jx(r);return{type:t,tag:"path",nested:!0,attr:function(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))},bound:function(t,n){var r=n.items;return 0===r.length?t:(e(Ex(t),r),ux(t,r[0]))},draw:Qx(r),pick:function(t,e,n,r,a,o){var s=e.items,c=e.bounds;return!s||!s.length||c&&!c.contains(a,o)?null:(n*=t.pixelRatio,r*=t.pixelRatio,i(t,s,n,r)?s[0]:null)},isect:Rx,tip:n}}var sw=ow("area",(function(t,e){const n=e[0],r=n.interpolate||"linear";return("horizontal"===n.orient?Xb:Yb).curve(db(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i="horizontal"===t[0].orient?e[1]:e[0],a="horizontal"===t[0].orient?"y":"x",o=t.length,s=1/0;--o>=0;)!1!==t[o].defined&&(r=Math.abs(t[o][a]-i))<s&&(s=r,n=t[o]);return n}));function cw(t,e){t.beginPath(),Jb(e)?tx(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function uw(t){const e=Px(t.strokeWidth,1);return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function lw(t,e){const n=uw(e);t("d",tx(null,e,n,n))}function hw(t,e,n,r){const i=uw(e);t.beginPath(),tx(t,e,(n||0)+i,(r||0)+i)}const dw=Jx(hw),fw=Jx(hw,!1),pw=Jx(hw,!0);var gw={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",rw(e))},bound:function(t,e){if(!e.clip&&e.items){const n=e.items,r=n.length;for(let e=0;e<r;++e)t.union(n[e].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),ux(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n,r){Yx(e,(e=>{const i=e.x||0,a=e.y||0,o=e.strokeForeground,s=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&s&&(hw(t,e,i,a),Lx(t,e),e.fill&&Wx(t,e,s)&&t.fill(),e.stroke&&!o&&qx(t,e,s)&&t.stroke()),t.save(),t.translate(i,a),e.clip&&cw(t,e),n&&n.translate(-i,-a),Yx(e,(e=>{("group"===e.marktype||null==r||r.includes(e.marktype))&&this.draw(t,e,n,r)})),n&&n.translate(i,a),t.restore(),o&&e.stroke&&s&&(hw(t,e,i,a),Lx(t,e),qx(t,e,s)&&t.stroke())}))},pick:function(t,e,n,r,i,a){if(e.bounds&&!e.bounds.contains(i,a)||!e.items)return null;const o=n*t.pixelRatio,s=r*t.pixelRatio;return Xx(e,(c=>{let u,l,h;const d=c.bounds;if(d&&!d.contains(i,a))return;l=c.x||0,h=c.y||0;const f=l+(c.width||0),p=h+(c.height||0),g=c.clip;if(g&&(i<l||i>f||a<h||a>p))return;if(t.save(),t.translate(l,h),l=i-l,h=a-h,g&&Jb(c)&&!pw(t,c,o,s))return t.restore(),null;const m=c.strokeForeground,v=!1!==e.interactive;return v&&m&&c.stroke&&fw(t,c,o,s)?(t.restore(),c):(u=Xx(c,(t=>function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}(t,l,h)?this.pick(t,n,r,l,h):null)),!u&&v&&(c.fill||!m&&c.stroke)&&dw(t,c,o,s)&&(u=c),t.restore(),u||null)}))},isect:zx,content:function(t,e,n){t("clip-path",e.clip?nx(n,e,e):null)},background:function(t,e){t("class","background"),t("aria-hidden",!0),lw(t,e)},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?lw(t,e):t("d","")}},mw={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function vw(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then((e=>{t.image=e,t.image.url=t.url}))),n}function yw(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function bw(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function xw(t,e){return"center"===t?e/2:"right"===t?e:0}function ww(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var kw={type:"image",tag:"image",nested:!1,attr:function(t,e,n){const r=vw(e,n),i=yw(e,r),a=bw(e,r),o=(e.x||0)-xw(e.align,i),s=(e.y||0)-ww(e.baseline,a);t("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",mw["xmlns:xlink"],"xlink:href"),t("transform",ew(o,s)),t("width",i),t("height",a),t("preserveAspectRatio",!1===e.aspect?"none":"xMidYMid")},bound:function(t,e){const n=e.image,r=yw(e,n),i=bw(e,n),a=(e.x||0)-xw(e.align,r),o=(e.y||0)-ww(e.baseline,i);return t.set(a,o,a+r,o+i)},draw:function(t,e,n){Yx(e,(e=>{if(n&&!n.intersects(e.bounds))return;const r=vw(e,this);let i=yw(e,r),a=bw(e,r);if(0===i||0===a)return;let o,s,c,u,l=(e.x||0)-xw(e.align,i),h=(e.y||0)-ww(e.baseline,a);!1!==e.aspect&&(s=r.width/r.height,c=e.width/e.height,s===s&&c===c&&s!==c&&(c<s?(u=i/s,h+=(a-u)/2,a=u):(u=a*s,l+=(i-u)/2,i=u))),(r.complete||r.toDataURL)&&(Lx(t,e),t.globalAlpha=null!=(o=e.opacity)?o:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(r,l,h,i,a))}))},pick:$x(),isect:Ze,get:vw,xOffset:xw,yOffset:ww},_w=ow("line",(function(t,e){const n=e[0],r=n.interpolate||"linear";return Kb.curve(db(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i=Math.pow(t[0].strokeWidth||1,2),a=t.length;--a>=0;)if(!1!==t[a].defined&&(n=t[a].x-e[0])*n+(r=t[a].y-e[1])*r<i)return t[a];return null}));function Aw(t,e){var n=e.path;if(null==n)return!0;var r=e.x||0,i=e.y||0,a=e.scaleX||1,o=e.scaleY||1,s=(e.angle||0)*bb,c=e.pathCache;c&&c.path===n||((e.pathCache=c=yb(n)).path=n),s&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(s),Nb(t,c,0,0,a,o),t.rotate(-s),t.translate(-r,-i)):Nb(t,c,r,i,a,o)}var Cw={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,r=e.scaleY||1;1===n&&1===r||t("vector-effect","non-scaling-stroke"),t("transform",function(t){return ew(t.x||0,t.y||0)+(t.angle?" "+nw(t.angle):"")+(t.scaleX||t.scaleY?" "+function(t,e){return"scale("+t+","+e+")"}(t.scaleX||1,t.scaleY||1):"")}(e)),t("d",e.path)},bound:function(t,e){return Aw(Ex(t,e.angle),e)?t.set(0,0,0,0):ux(t,e,!0)},draw:Kx(Aw),pick:tw(Aw),isect:Ox(Aw)};function Sw(t,e){t.beginPath(),tx(t,e)}var Ew={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",tx(null,e))},bound:function(t,e){var n,r;return ux(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:Kx(Sw),pick:tw(Sw),isect:zx};function Tw(t,e,n){var r,i,a,o;return!(!e.stroke||!qx(t,e,n))&&(r=e.x||0,i=e.y||0,a=null!=e.x2?e.x2:r,o=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(a,o),!0)}var Nw={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",rw(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return ux(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)},draw:function(t,e,n){Yx(e,(e=>{if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&Tw(t,e,r)&&(Lx(t,e),t.stroke())}}))},pick:$x((function(t,e,n,r){return!!t.isPointInStroke&&(Tw(t,e,1)&&t.isPointInStroke(n,r))})),isect:function(t,e){const n=t.x||0,r=t.y||0;return Bx(e,n,r,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r)}},Fw=iw("shape",(function(t,e){return(e.mark.shape||e.shape).context(t)(e)})),Dw=iw("symbol",(function(t,e){return Zb.context(t)(e)}),Rx);const Iw=function(t){let e,n,r;t=+t||1e4;const i=()=>{e={},n={},r=0},a=(i,a)=>(++r>t&&(n=e,e={},r=1),e[i]=a);return i(),{clear:i,has:t=>Bn(e,t)||Bn(n,t),get:t=>Bn(e,t)?e[t]:Bn(n,t)?a(t,n[t]):void 0,set:(t,n)=>Bn(e,t)?e[t]=n:a(t,n)}}();var Mw={height:Pw,measureWidth:Bw,estimateWidth:Rw,width:Rw,canvas:Ow};function Ow(t){Mw.width=t&&Ix?Bw:Rw}function Rw(t,e){return zw(Vw(t,e),Pw(t))}function zw(t,e){return~~(.8*t.length*e)}function Bw(t,e){return Pw(t)<=0||!(e=Vw(t,e))?0:Lw(e,Gw(t))}function Lw(t,e){const n="(".concat(e,") ").concat(t);let r=Iw.get(n);return void 0===r&&(Ix.font=e,r=Ix.measureText(t).width,Iw.set(n,r)),r}function Pw(t){return null!=t.fontSize?+t.fontSize||0:11}function jw(t){return null!=t.lineHeight?t.lineHeight:Pw(t)+2}function Uw(t){return e=t.lineBreak&&t.text&&!on(t.text)?t.text.split(t.lineBreak):t.text,on(e)?e.length>1?e:e[0]:e;var e}function Ww(t){const e=Uw(t);return(on(e)?e.length-1:0)*jw(t)}function Vw(t,e){const n=null==e?"":(e+"").trim();return t.limit>0&&n.length?function(t,e){var n=+t.limit,r=function(t){if(Mw.width===Bw){const e=Gw(t);return t=>Lw(t,e)}if(Mw.width===Rw){const e=Pw(t);return t=>zw(t,e)}return e=>Mw.width(t,e)}(t);if(r(e)<n)return e;var i,a=t.ellipsis||"\u2026",o="rtl"===t.dir,s=0,c=e.length;if(n-=r(a),o){for(;s<c;)i=s+c>>>1,r(e.slice(i))>n?s=i+1:c=i;return a+e.slice(s)}for(;s<c;)i=1+(s+c>>>1),r(e.slice(0,i))<n?s=i:c=i-1;return e.slice(0,s)+a}(t,n):n}function qw(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Gw(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+Pw(t)+"px "+qw(t,e)}function Hw(t){var e=t.baseline,n=Pw(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*jw(t):"line-bottom"===e?.29*n-.5*jw(t):0)}Ow(!0);const Yw={left:"start",center:"middle",right:"end"},Xw=new rx;function Kw(t){var e,n=t.x||0,r=t.y||0,i=t.radius||0;return i&&(e=(t.theta||0)-xb,n+=i*Math.cos(e),r+=i*Math.sin(e)),Xw.x1=n,Xw.y1=r,Xw}function Qw(t,e,n){var r,i=Mw.height(e),a=e.align,o=Kw(e),s=o.x1,c=o.y1,u=e.dx||0,l=(e.dy||0)+Hw(e)-Math.round(.8*i),h=Uw(e);if(on(h)?(i+=jw(e)*(h.length-1),r=h.reduce(((t,n)=>Math.max(t,Mw.width(e,n))),0)):r=Mw.width(e,h),"center"===a?u-=r/2:"right"===a&&(u-=r),t.set(u+=s,l+=c,u+r,l+i),e.angle&&!n)t.rotate(e.angle*bb,s,c);else if(2===n)return t.rotatedPoints(e.angle*bb,s,c);return t}var Zw={type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,i=(e.dy||0)+Hw(e),a=Kw(e),o=a.x1,s=a.y1,c=e.angle||0;t("text-anchor",Yw[e.align]||"start"),c?(n=ew(o,s)+" "+nw(c),(r||i)&&(n+=" "+ew(r,i))):n=ew(o+r,s+i),t("transform",n)},bound:Qw,draw:function(t,e,n){Yx(e,(e=>{var r,i,a,o,s,c,u,l=null==e.opacity?1:e.opacity;if(!(n&&!n.intersects(e.bounds)||0===l||e.fontSize<=0||null==e.text||0===e.text.length)){if(t.font=Gw(e),t.textAlign=e.align||"left",i=(r=Kw(e)).x1,a=r.y1,e.angle&&(t.save(),t.translate(i,a),t.rotate(e.angle*bb),i=a=0),i+=e.dx||0,a+=(e.dy||0)+Hw(e),c=Uw(e),Lx(t,e),on(c))for(s=jw(e),o=0;o<c.length;++o)u=Vw(e,c[o]),e.fill&&Wx(t,e,l)&&t.fillText(u,i,a),e.stroke&&qx(t,e,l)&&t.strokeText(u,i,a),a+=s;else u=Vw(e,c),e.fill&&Wx(t,e,l)&&t.fillText(u,i,a),e.stroke&&qx(t,e,l)&&t.strokeText(u,i,a);e.angle&&t.restore()}}))},pick:$x((function(t,e,n,r,i,a){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var o=Kw(e),s=o.x1,c=o.y1,u=Qw(Xw,e,1),l=-e.angle*bb,h=Math.cos(l),d=Math.sin(l),f=h*i-d*a+(s-h*s+d*c),p=d*i+h*a+(c-d*s-h*c);return u.contains(f,p)})),isect:function(t,e){const n=Qw(Xw,t,2);return Bx(e,n[0],n[1],n[2],n[3])||Bx(e,n[0],n[1],n[4],n[5])||Bx(e,n[4],n[5],n[6],n[7])||Bx(e,n[2],n[3],n[6],n[7])}},$w=ow("trail",(function(t,e){return $b.context(t)(e)}),(function(t,e){for(var n,r,i=t.length;--i>=0;)if(!1!==t[i].defined&&(n=t[i].x-e[0])*n+(r=t[i].y-e[1])*r<(n=t[i].size||1)*n)return t[i];return null})),Jw={arc:aw,area:sw,group:gw,image:kw,line:_w,path:Cw,rect:Ew,rule:Nw,shape:Fw,symbol:Dw,text:Zw,trail:$w};function tk(t,e,n){var r=Jw[t.mark.marktype],i=e||r.bound;return r.nested&&(t=t.mark),i(t.bounds||(t.bounds=new rx),t,n)}var ek={mark:null};const nk=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function rk(t){return ik("string"===typeof t?JSON.parse(t):t)}function ik(t){var e,n,r,i=t.marktype,a=t.items;if(a)for(n=0,r=a.length;n<r;++n)e=i?"mark":"group",a[n][e]=t,a[n].zindex&&(a[n][e].zdirty=!0),"group"===(i||e)&&ik(a[n]);return i&&function(t,e,n){var r,i,a,o,s=Jw[t.marktype],c=s.bound,u=t.items,l=u&&u.length;if(s.nested)return l?a=u[0]:(ek.mark=t,a=ek),o=tk(a,c,n),e&&e.union(o)||o;if(e=e||t.bounds&&t.bounds.clear()||new rx,l)for(r=0,i=u.length;r<i;++r)e.union(tk(u[r],c,n));t.bounds=e}(t),t}function ak(t){arguments.length?this.root=rk(t):(this.root=ok({marktype:"group",name:"root",role:"frame"}),this.root.items=[new ax(this.root)])}function ok(t,e){const n={bounds:new rx,clip:!!t.clip,group:e,interactive:!1!==t.interactive,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0};return null!=t.aria&&(n.aria=t.aria),t.description&&(n.description=t.description),n}function sk(t,e,n){return!t&&"undefined"!==typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function ck(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function uk(t,e,n,r){var i,a=t.childNodes[e];return a&&a.tagName.toLowerCase()===n.toLowerCase()||(i=a||null,a=sk(t.ownerDocument,n,r),t.insertBefore(a,i)),a}function lk(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function hk(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function dk(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function fk(t,e){this._active=null,this._handlers={},this._loader=t||Ys(),this._tooltip=e||pk}function pk(t,e,n,r){t.element().setAttribute("title",r||"")}function gk(t){this._el=null,this._bgcolor=null,this._loader=new ox(t)}ak.prototype={toJSON(t){return function(t,e){return JSON.stringify(t,nk,e)}(this.root,t||0)},mark(t,e,n){const r=ok(t,e=e||this.root.items[0]);return e.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}},fk.prototype={initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},scene(t){return arguments.length?(this._scene=t,this):this._scene},on(){},off(){},_handlerIndex(t,e,n){for(let r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},handlers(t){const e=this._handlers,n=[];if(t)n.push(...e[this.eventName(t)]);else for(const r in e)n.push(...e[r]);return n},eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then((e=>{const n=new MouseEvent(t.type,t),r=sk(null,"a");for(const t in e)r.setAttribute(t,e[t]);r.dispatchEvent(n)})).catch((()=>{}))},handleTooltip(t,e,n){if(e&&null!=e.tooltip){e=function(t,e,n,r){var i,a,o=t&&t.mark;if(o&&(i=Jw[o.marktype]).tip){for((a=dk(e,n))[0]-=r[0],a[1]-=r[1];t=t.mark.group;)a[0]-=t.x||0,a[1]-=t.y||0;t=i.tip(o.items,a)}return t}(e,t,this.canvas(),this._origin);const r=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,r)}},getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,a=i.width(),o=i.height();let s=i.x1+r[0]+n.left,c=i.y1+r[1]+n.top;for(;t.mark&&(t=t.mark.group);)s+=t.x||0,c+=t.y||0;return{x:s,y:c,width:a,height:o,left:s,top:c,right:s+a,bottom:c+o}}},gk.prototype={initialize(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)},resize(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(t,e){const n=this;return n._call=function(){n._render(t,e)},n._call(),n._call=null,n},_render(){},renderAsync(t,e){const n=this.render(t,e);return this._ready?this._ready.then((()=>n)):Promise.resolve(n)},_load(t,e){var n=this,r=n._loader[t](e);if(!n._ready){const t=n._call;n._ready=n._loader.ready().then((e=>{e&&t(),n._ready=null}))}return r},sanitizeURL(t){return this._load("sanitizeURL",t)},loadImage(t){return this._load("loadImage",t)}};const mk="dragenter",vk="dragleave",yk="dragover",bk="pointerdown",xk="pointermove",wk="pointerout",kk="pointerover",_k="mousedown",Ak="mousemove",Ck="mouseout",Sk="mouseover",Ek="click",Tk="mousewheel",Nk="touchstart",Fk="touchmove",Dk="touchend",Ik=xk,Mk=wk,Ok=Ek;function Rk(t,e){fk.call(this,t,e),this._down=null,this._touch=null,this._first=!0,this._events={}}function zk(t,e){(t=>t===Nk||t===Fk||t===Dk?[Nk,Fk,Dk]:[t])(e).forEach((e=>function(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n)))}(t,e)))}function Bk(t,e,n){e.forEach((e=>t.fire(e,n)))}function Lk(t,e,n){return function(r){const i=this._active,a=this.pickEvent(r);a===i||(i&&i.exit||Bk(this,n,r),this._active=a,Bk(this,e,r)),Bk(this,t,r)}}function Pk(t){return function(e){Bk(this,t,e),this._active=null}}function jk(t,e,n,r,i,a){const o="undefined"!==typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,s=t.getContext("2d"),c=o?"undefined"!==typeof window&&window.devicePixelRatio||1:i;t.width=e*c,t.height=n*c;for(const u in a)s[u]=a[u];return o&&1!==c&&(t.style.width=e+"px",t.style.height=n+"px"),s.pixelRatio=c,s.setTransform(c,0,0,c,c*r[0],c*r[1]),t}function Uk(t){gk.call(this,t),this._options={},this._redraw=!1,this._dirty=new rx,this._tempb=new rx}jn(Rk,fk,{initialize(t,e,n){return this._canvas=t&&ck(t,"canvas"),[Ek,_k,bk,xk,wk,vk].forEach((t=>zk(this,t))),fk.prototype.initialize.call(this,t,e,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",mk,vk,yk,bk,"pointerup",xk,wk,kk,_k,"mouseup",Ak,Ck,Sk,Ek,"dblclick","wheel",Tk,Nk,Fk,Dk],DOMMouseScroll(t){this.fire(Tk,t)},pointermove:Lk([xk,Ak],[kk,Sk],[wk,Ck]),dragover:Lk([yk],[mk],[vk]),pointerout:Pk([wk,Ck]),dragleave:Pk([vk]),pointerdown(t){this._down=this._active,this.fire(bk,t)},mousedown(t){this._down=this._active,this.fire(_k,t)},click(t){this._down===this._active&&(this.fire(Ek,t),this._down=null)},touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(Nk,t,!0)},touchmove(t){this.fire(Fk,t,!0)},touchend(t){this.fire(Dk,t,!0),this._touch=null},fire(t,e,n){const r=n?this._touch:this._active,i=this._handlers[t];if(e.vegaType=t,t===Ok&&r&&r.href?this.handleHref(e,r,r.href):t!==Ik&&t!==Mk||this.handleTooltip(e,r,t!==Mk),i)for(let a=0,o=i.length;a<o;++a)i[a].handler.call(this._obj,e,r)},on(t,e){const n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(zk(this,t),(r[n]||(r[n]=[])).push({type:t,handler:e})),this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this},pickEvent(t){const e=dk(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pick(t,e,n,r,i){const a=this.context();return Jw[t.marktype].pick.call(this,a,t,e,n,r,i)}});const Wk=gk.prototype;function Vk(t,e){fk.call(this,t,e);const n=this;n._hrefHandler=qk(n,((t,e)=>{e&&e.href&&n.handleHref(t,e,e.href)})),n._tooltipHandler=qk(n,((t,e)=>{n.handleTooltip(t,e,t.type!==Mk)}))}jn(Uk,gk,{initialize(t,e,n,r,i,a){return this._options=a||{},this._canvas=this._options.externalContext?null:Zd(1,1,this._options.type),t&&this._canvas&&(lk(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),Wk.initialize.call(this,t,e,n,r,i)},resize(t,e,n,r){if(Wk.resize.call(this,t,e,n,r),this._canvas)jk(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const t=this._options.externalContext;t||qe("CanvasRenderer is missing a valid canvas or context"),t.scale(this._scale,this._scale),t.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)},_render(t,e){const n=this.context(),r=this._origin,i=this._width,a=this._height,o=this._dirty,s=((t,e,n)=>(new rx).set(0,0,e,n).translate(-t[0],-t[1]))(r,i,a);n.save();const c=this._redraw||o.empty()?(this._redraw=!1,s.expand(1)):function(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}(n,s.intersect(o),r);return this.clear(-r[0],-r[1],i,a),this.draw(n,t,c,e),n.restore(),o.clear(),this},draw(t,e,n,r){if("group"!==e.marktype&&null!=r&&!r.includes(e.marktype))return;const i=Jw[e.marktype];e.clip&&function(t,e){var n=e.clip;t.save(),Cn(n)?(t.beginPath(),n(t),t.clip()):cw(t,e.group)}(t,e),i.draw.call(this,t,e,n,r),e.clip&&t.restore()},clear(t,e,n,r){const i=this._options,a=this.context();"pdf"===i.type||i.externalContext||a.clearRect(t,e,n,r),null!=this._bgcolor&&(a.fillStyle=this._bgcolor,a.fillRect(t,e,n,r))}});const qk=(t,e)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,e.call(t._obj,n,r)};jn(Vk,fk,{initialize(t,e,n){let r=this._svg;return r&&(r.removeEventListener(Ok,this._hrefHandler),r.removeEventListener(Ik,this._tooltipHandler),r.removeEventListener(Mk,this._tooltipHandler)),this._svg=r=t&&ck(t,"svg"),r&&(r.addEventListener(Ok,this._hrefHandler),r.addEventListener(Ik,this._tooltipHandler),r.addEventListener(Mk,this._tooltipHandler)),fk.prototype.initialize.call(this,t,e,n)},canvas(){return this._svg},on(t,e){const n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){const i={type:t,handler:e,listener:qk(this,e)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const Gk="aria-hidden",Hk="aria-label",Yk="role",Xk="aria-roledescription",Kk="graphics-object",Qk="graphics-symbol",Zk=(t,e,n)=>({[Yk]:t,[Xk]:e,[Hk]:n||void 0}),$k=Jn(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),Jk={axis:{desc:"axis",caption:function(t){const e=t.datum,n=t.orient,r=e.title?i_(t):null,i=t.context,a=i.scales[e.scale].value,o=i.dataflow.locale(),s=a.type,c="left"===n||"right"===n?"Y":"X";return"".concat(c,"-axis")+(r?" titled '".concat(r,"'"):"")+" for a ".concat(Cy(s)?"discrete":s," scale")+" with ".concat(ab(o,a,t))}},legend:{desc:"legend",caption:function(t){const e=t.datum,n=e.title?i_(t):null,r="".concat(e.type||""," legend").trim(),i=e.scales,a=Object.keys(i),o=t.context,s=o.scales[i[a[0]]].value,c=o.dataflow.locale();return function(t){return t.length?t[0].toUpperCase()+t.slice(1):t}(r)+(n?" titled '".concat(n,"'"):"")+" for ".concat(function(t){return t=t.map((t=>t+("fill"===t||"stroke"===t?" color":""))),t.length<2?t[0]:t.slice(0,-1).join(", ")+" and "+hn(t)}(a))+" with ".concat(ab(c,s,t))}},"title-text":{desc:"title",caption:t=>"Title text '".concat(r_(t),"'")},"title-subtitle":{desc:"subtitle",caption:t=>"Subtitle text '".concat(r_(t),"'")}},t_={ariaRole:Yk,ariaRoleDescription:Xk,description:Hk};function e_(t,e){const n=!1===e.aria;if(t(Gk,n||void 0),n||null==e.description)for(const r in t_)t(t_[r],void 0);else{const n=e.mark.marktype;t(Hk,e.description),t(Yk,e.ariaRole||("group"===n?Kk:Qk)),t(Xk,e.ariaRoleDescription||"".concat(n," mark"))}}function n_(t){return!1===t.aria?{[Gk]:!0}:$k[t.role]?null:Jk[t.role]?function(t,e){try{const n=t.items[0],r=e.caption||(()=>"");return Zk(e.role||Qk,e.desc,n.description||r(n))}catch(n){return null}}(t,Jk[t.role]):function(t){const e=t.marktype,n="group"===e||"text"===e||t.items.some((t=>null!=t.description&&!1!==t.aria));return Zk(n?Kk:Qk,"".concat(e," mark container"),t.description)}(t)}function r_(t){return An(t.text).join(" ")}function i_(t){try{return An(hn(t.items).items[0].text).join(" ")}catch(e){return null}}const a_=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function o_(){let t="",e="",n="";const r=[],i=()=>e=n="",a=(t,n)=>(null!=n&&(e+=" ".concat(t,'="').concat(a_(n).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"),'"')),o),o={open(s){(a=>{e&&(t+="".concat(e,">").concat(n),i()),r.push(a)})(s),e="<"+s;for(var c=arguments.length,u=new Array(c>1?c-1:0),l=1;l<c;l++)u[l-1]=arguments[l];for(const t of u)for(const e in t)a(e,t[e]);return o},close(){const a=r.pop();return t+=e?e+(n?">".concat(n,"</").concat(a,">"):"/>"):"</".concat(a,">"),i(),o},attr:a,text:t=>(n+=a_(t),o),toString:()=>t};return o}const s_=t=>c_(o_(),t)+"";function c_(t,e){if(t.open(e.tagName),e.hasAttributes()){const n=e.attributes,r=n.length;for(let e=0;e<r;++e)t.attr(n[e].name,n[e].value)}if(e.hasChildNodes()){const n=e.childNodes;for(const e of n)3===e.nodeType?t.text(e.nodeValue):c_(t,e)}return t.close()}const u_={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},l_={blend:"mix-blend-mode"},h_={fill:"none","stroke-miterlimit":10},d_="http://www.w3.org/2000/xmlns/",f_=mw.xmlns;function p_(t){gk.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const g_=gk.prototype;function m_(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function v_(t,e,n){let r,i,a;if("radial"===e.gradient){let r=uk(t,n++,"pattern",f_);C_(r,{id:sb+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=uk(r,0,"rect",f_),C_(r,{width:1,height:1,fill:"url(".concat(E_(),"#").concat(e.id,")")}),C_(t=uk(t,n++,"radialGradient",f_),{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else C_(t=uk(t,n++,"linearGradient",f_),{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(r=0,i=e.stops.length;r<i;++r)a=uk(t,r,"stop",f_),a.setAttribute("offset",e.stops[r].offset),a.setAttribute("stop-color",e.stops[r].color);return lk(t,r),n}function y_(t,e,n){let r;return(t=uk(t,n,"clipPath",f_)).setAttribute("id",e.id),e.path?(r=uk(t,0,"path",f_),r.setAttribute("d",e.path)):(r=uk(t,0,"rect",f_),C_(r,{x:0,y:0,width:e.width,height:e.height})),lk(t,1),n+1}function b_(t,e,n,r,i){let a,o=t._svg;if(!o&&(a=e.ownerDocument,o=sk(a,r,f_),t._svg=o,t.mark&&(o.__data__=t,o.__values__={fill:"default"},"g"===r))){const e=sk(a,"path",f_);o.appendChild(e),e.__data__=t;const n=sk(a,"g",f_);o.appendChild(n),n.__data__=t;const r=sk(a,"path",f_);o.appendChild(r),r.__data__=t,r.__values__={fill:"default"}}return(o.ownerSVGElement!==i||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}(o,n))&&e.insertBefore(o,n?n.nextSibling:e.firstChild),o}jn(p_,gk,{initialize(t,e,n,r,i){return this._defs={},this._clearDefs(),t&&(this._svg=uk(t,0,"svg",f_),this._svg.setAttributeNS(d_,"xmlns",f_),this._svg.setAttributeNS(d_,"xmlns:xlink",mw["xmlns:xlink"]),this._svg.setAttribute("version",mw.version),this._svg.setAttribute("class","marks"),lk(t,1),this._root=uk(this._svg,0,"g",f_),C_(this._root,h_),lk(this._svg,1)),this.background(this._bgcolor),g_.initialize.call(this,t,e,n,r,i)},background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),g_.background.apply(this,arguments)},resize(t,e,n,r){return g_.resize.call(this,t,e,n,r),this._svg&&(C_(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas(){return this._svg},svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=uk(t,0,"rect",f_),C_(n,{width:this._width,height:this._height,fill:e}));const r=s_(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),r},_render(t,e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t,void 0,e),lk(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const e=++this._dirtyID;let n,r,i,a,o,s,c;for(o=0,s=t.length;o<s;++o)n=t[o],r=n.mark,r.marktype!==i&&(i=r.marktype,a=Jw[i]),r.zdirty&&r.dirty!==e&&(this._dirtyAll=!1,m_(n,e),r.items.forEach((t=>{t.dirty=e}))),r.zdirty||(n.exit?(a.nested&&r.items.length?(c=r.items[0],c._svg&&this._update(a,c._svg,c)):n._svg&&(c=n._svg.parentNode,c&&c.removeChild(n._svg)),n._svg=null):(n=a.nested?r.items[0]:n,n._update!==e&&(n._svg&&n._svg.ownerSVGElement?this._update(a,n._svg,n):(this._dirtyAll=!1,m_(n,e)),n._update=e)));return!this._dirtyAll},mark(t,e,n,r){if(!this.isDirty(e))return e._svg;const i=this._svg,a=e.marktype,o=Jw[a],s=!1===e.interactive?"none":null,c="g"===o.tag,u=b_(e,t,n,"g",i);if("group"!==a&&null!=r&&!r.includes(a))return lk(u,0),e._svg;u.setAttribute("class",hk(e));const l=n_(e);for(const p in l)S_(u,p,l[p]);c||S_(u,"pointer-events",s),S_(u,"clip-path",e.clip?nx(this,e,e.group):null);let h=null,d=0;const f=t=>{const e=this.isDirty(t),n=b_(t,u,h,o.tag,i);e&&(this._update(o,n,t),c&&function(t,e,n,r){e=e.lastChild.previousSibling;let i,a=0;Yx(n,(n=>{i=t.mark(e,n,i,r),++a})),lk(e,1+a)}(this,n,t,r)),h=n,++d};return o.nested?e.items.length&&f(e.items[0]):Yx(e,f),lk(u,d),u},_update(t,e,n){x_=e,w_=e.__values__,e_(__,n),t.attr(__,n,this);const r=k_[t.type];r&&r.call(this,t,e,n),x_&&this.style(x_,n)},style(t,e){if(null!=e){for(const n in u_){let r="font"===n?qw(e):e[n];if(r===w_[n])continue;const i=u_[n];null==r?t.removeAttribute(i):(cb(r)&&(r=ub(r,this._defs.gradient,E_())),t.setAttribute(i,r+"")),w_[n]=r}for(const n in l_)A_(t,l_[n],e[n])}},defs(){const t=this._svg,e=this._defs;let n=e.el,r=0;for(const i in e.gradient)n||(e.el=n=uk(t,1,"defs",f_)),r=v_(n,e.gradient[i],r);for(const i in e.clipping)n||(e.el=n=uk(t,1,"defs",f_)),r=y_(n,e.clipping[i],r);n&&(0===r?(t.removeChild(n),e.el=null):lk(n,r))},_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}});let x_=null,w_=null;const k_={group(t,e,n){const r=x_=e.childNodes[2];w_=r.__values__,t.foreground(__,n,this),w_=e.__values__,x_=e.childNodes[1],t.content(__,n,this);const i=x_=e.childNodes[0];t.background(__,n,this);const a=!1===n.mark.interactive?"none":null;if(a!==w_.events&&(S_(r,"pointer-events",a),S_(i,"pointer-events",a),w_.events=a),n.strokeForeground&&n.stroke){const t=n.fill;S_(r,"display",null),this.style(i,n),S_(i,"stroke",null),t&&(n.fill=null),w_=r.__values__,this.style(r,n),t&&(n.fill=t),x_=null}else S_(r,"display","none")},image(t,e,n){!1===n.smooth?(A_(e,"image-rendering","optimizeSpeed"),A_(e,"image-rendering","pixelated")):A_(e,"image-rendering",null)},text(t,e,n){const r=Uw(n);let i,a,o,s;on(r)?(a=r.map((t=>Vw(n,t))),i=a.join("\n"),i!==w_.text&&(lk(e,0),o=e.ownerDocument,s=jw(n),a.forEach(((t,r)=>{const i=sk(o,"tspan",f_);i.__data__=n,i.textContent=t,r&&(i.setAttribute("x",0),i.setAttribute("dy",s)),e.appendChild(i)})),w_.text=i)):(a=Vw(n,r),a!==w_.text&&(e.textContent=a,w_.text=a)),S_(e,"font-family",qw(n)),S_(e,"font-size",Pw(n)+"px"),S_(e,"font-style",n.fontStyle),S_(e,"font-variant",n.fontVariant),S_(e,"font-weight",n.fontWeight)}};function __(t,e,n){e!==w_[t]&&(n?function(t,e,n,r){null!=n?t.setAttributeNS(r,e,n):t.removeAttributeNS(r,e)}(x_,t,e,n):S_(x_,t,e),w_[t]=e)}function A_(t,e,n){n!==w_[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),w_[e]=n)}function C_(t,e){for(const n in e)S_(t,n,e[n])}function S_(t,e,n){null!=n?t.setAttribute(e,n):t.removeAttribute(e)}function E_(){let t;return"undefined"===typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function T_(t){gk.call(this,t),this._text=null,this._defs={gradient:{},clipping:{}}}jn(T_,gk,{svg(){return this._text},_render(t){const e=o_();e.open("svg",On({},mw,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",h_,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this},mark(t,e){const n=Jw[e.marktype],r=n.tag,i=[e_,n.attr];t.open("g",{class:hk(e),"clip-path":e.clip?nx(this,e,e.group):null},n_(e),{"pointer-events":"g"!==r&&!1===e.interactive?"none":null});const a=a=>{const o=this.href(a);if(o&&t.open("a",o),t.open(r,this.attr(e,a,i,"g"!==r?r:null)),"text"===r){const e=Uw(a);if(on(e)){const n={x:0,dy:jw(a)};for(let r=0;r<e.length;++r)t.open("tspan",r?n:null).text(Vw(a,e[r])).close()}else t.text(Vw(a,e))}else if("g"===r){const r=a.strokeForeground,i=a.fill,o=a.stroke;r&&o&&(a.stroke=null),t.open("path",this.attr(e,a,n.background,"bgrect")).close(),t.open("g",this.attr(e,a,n.content)),Yx(a,(e=>this.mark(t,e))),t.close(),r&&o?(i&&(a.fill=null),a.stroke=o,t.open("path",this.attr(e,a,n.foreground,"bgrect")).close(),i&&(a.fill=i)):t.open("path",this.attr(e,a,n.foreground,"bgfore")).close()}t.close(),o&&t.close()};return n.nested?e.items&&e.items.length&&a(e.items[0]):Yx(e,a),t.close()},href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then((t=>{t["xlink:href"]=t.href,t.href=null,(this._hrefs||(this._hrefs={}))[e]=t}))}return null},attr(t,e,n,r){const i={},a=(t,e,n,r)=>{i[r||t]=e};return Array.isArray(n)?n.forEach((t=>t(a,e,this))):n(a,e,this),r&&function(t,e,n,r,i){let a;if(null==e)return t;"bgrect"===r&&!1===n.interactive&&(t["pointer-events"]="none");if("bgfore"===r&&(!1===n.interactive&&(t["pointer-events"]="none"),t.display="none",null!==e.fill))return t;"image"===r&&!1===e.smooth&&(a=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]);"text"===r&&(t["font-family"]=qw(e),t["font-size"]=Pw(e)+"px",t["font-style"]=e.fontStyle,t["font-variant"]=e.fontVariant,t["font-weight"]=e.fontWeight);for(const o in u_){let n=e[o];const r=u_[o];("transparent"!==n||"fill"!==r&&"stroke"!==r)&&null!=n&&(cb(n)&&(n=ub(n,i.gradient,"")),t[r]=n)}for(const o in l_){const t=e[o];null!=t&&(a=a||[],a.push("".concat(l_[o],": ").concat(t,";")))}a&&(t.style=a.join(" "))}(i,e,t,r,this._defs),i},defs(t){const e=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(e).length+Object.keys(n).length){t.open("defs");for(const n in e){const r=e[n],i=r.stops;"radial"===r.gradient?(t.open("pattern",{id:sb+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),t.close(),t.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):t.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let e=0;e<i.length;++e)t.open("stop",{offset:i[e].offset,"stop-color":i[e].color}).close();t.close()}for(const e in n){const r=n[e];t.open("clipPath",{id:e}),r.path?t.open("path",{d:r.path}).close():t.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),t.close()}t.close()}}});const N_={svgMarkTypes:["text"],svgOnTop:!0,debug:!1};function F_(t){gk.call(this,t),this._svgRenderer=new p_(t),this._canvasRenderer=new Uk(t)}const D_=gk.prototype;function I_(t,e){Rk.call(this,t,e)}jn(F_,gk,{initialize(t,e,n,r,i){this._root_el=uk(t,0,"div");const a=uk(this._root_el,0,"div"),o=uk(this._root_el,1,"div");return this._root_el.style.position="relative",N_.debug||(a.style.height="100%",o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.height="100%",o.style.width="100%"),this._svgEl=N_.svgOnTop?o:a,this._canvasEl=N_.svgOnTop?a:o,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,e,n,r,i),this._svgRenderer.initialize(this._svgEl,e,n,r,i),D_.initialize.call(this,t,e,n,r,i)},dirty(t){return N_.svgMarkTypes.includes(t.mark.marktype)?this._svgRenderer.dirty(t):this._canvasRenderer.dirty(t),this},_render(t,e){const n=(null!==e&&void 0!==e?e:["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter((t=>!N_.svgMarkTypes.includes(t)));this._svgRenderer.render(t,N_.svgMarkTypes),this._canvasRenderer.render(t,n)},resize(t,e,n,r){return D_.resize.call(this,t,e,n,r),this._svgRenderer.resize(t,e,n,r),this._canvasRenderer.resize(t,e,n,r),this},background(t){return N_.svgOnTop?this._canvasRenderer.background(t):this._svgRenderer.background(t),this}}),jn(I_,Rk,{initialize(t,e,n){const r=uk(uk(t,0,"div"),N_.svgOnTop?0:1,"div");return Rk.prototype.initialize.call(this,r,e,n)}});const M_="canvas",O_="hybrid",R_="none",z_={Canvas:M_,PNG:"png",SVG:"svg",Hybrid:O_,None:R_},B_={};function L_(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(B_[t]=e,this):B_[t]}function P_(t,e,n,r){if(function(t,e,n){return t.bounds&&e.intersects(t.bounds)&&("group"===t.marktype||!1!==t.interactive&&(!n||n(t)))}(t,e,n)){const i=t.items,a=t.marktype,o=i.length;let s=0;if("group"===a)for(;s<o;++s)j_(i[s],e,n,r);else for(const t=Jw[a].isect;s<o;++s){const n=i[s];U_(n,e,t)&&r.push(n)}}return r}function j_(t,e,n,r){n&&n(t.mark)&&U_(t,e,Jw.group.isect)&&r.push(t);const i=t.items,a=i&&i.length;if(a){const o=t.x||0,s=t.y||0;e.translate(-o,-s);for(let t=0;t<a;++t)P_(i[t],e,n,r);e.translate(o,s)}return r}function U_(t,e,n){const r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}B_[M_]=B_.png={renderer:Uk,headless:Uk,handler:Rk},B_.svg={renderer:p_,headless:T_,handler:Vk},B_[O_]={renderer:F_,headless:F_,handler:I_},B_[R_]={};const W_=new rx;const V_="top",q_="left",G_="right",H_="bottom",Y_="top-left",X_="top-right",K_="bottom-left",Q_="bottom-right",Z_="start",$_="middle",J_="end",tA="x",eA="y",nA="group",rA="axis",iA="title",aA="frame",oA="scope",sA="legend",cA="row-header",uA="row-footer",lA="row-title",hA="column-header",dA="column-footer",fA="column-title",pA="padding",gA="symbol",mA="fit",vA="fit-x",yA="fit-y",bA="pad",xA="none",wA="all",kA="each",_A="flush",AA="column",CA="row";function SA(t){Ic.call(this,null,t)}function EA(t,e,n){return e(t.bounds.clear(),t,n)}jn(SA,Ic,{transform(t,e){const n=e.dataflow,r=t.mark,i=r.marktype,a=Jw[i],o=a.bound;let s,c=r.bounds;if(a.nested)r.items.length&&n.dirty(r.items[0]),c=EA(r,o),r.items.forEach((t=>{t.bounds.clear().union(c)}));else if(i===nA||t.modified())switch(e.visit(e.MOD,(t=>n.dirty(t))),c.clear(),r.items.forEach((t=>c.union(EA(t,o)))),r.role){case rA:case sA:case iA:e.reflow()}else s=e.changed(e.REM),e.visit(e.ADD,(t=>{c.union(EA(t,o))})),e.visit(e.MOD,(t=>{s=s||c.alignsWith(t.bounds),n.dirty(t),c.union(EA(t,o))})),s&&(c.clear(),r.items.forEach((t=>c.union(t.bounds))));return function(t){const e=t.clip;if(Cn(e))e(Ex(W_.clear()));else{if(!e)return;W_.set(0,0,t.group.width,t.group.height)}t.bounds.intersect(W_)}(r),e.modifies("bounds")}});const TA=":vega_identifier:";function NA(t){Ic.call(this,0,t)}function FA(t){Ic.call(this,null,t)}function DA(t){Ic.call(this,null,t)}NA.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},jn(NA,Ic,{transform(t,e){const n=(i=e.dataflow)._signals[TA]||(i._signals[TA]=i.add(0)),r=t.as;var i;let a=n.value;return e.visit(e.ADD,(t=>t[r]=t[r]||++a)),n.set(this.value=a),e}}),jn(FA,Ic,{transform(t,e){let n=this.value;n||(n=e.dataflow.scenegraph().mark(t.markdef,function(t){const e=t.groups,n=t.parent;return e&&1===e.size?e.get(Object.keys(e.object)[0]):e&&n?e.lookup(n):null}(t),t.index),n.group.context=t.context,t.context.group||(t.context.group=n.group),n.source=this.source,n.clip=t.clip,n.interactive=t.interactive,this.value=n);const r=n.marktype===nA?ax:ix;return e.visit(e.ADD,(t=>r.call(t,n))),(t.modified("clip")||t.modified("interactive"))&&(n.clip=t.clip,n.interactive=!!t.interactive,n.zdirty=!0,e.reflow()),n.items=e.source,e}});const IA={parity:t=>t.filter(((t,e)=>e%2?t.opacity=0:1)),greedy:(t,e)=>{let n;return t.filter(((t,r)=>r&&MA(n.bounds,t.bounds,e)?t.opacity=0:(n=t,1)))}},MA=(t,e,n)=>n>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2),OA=(t,e)=>{for(var n,r=1,i=t.length,a=t[0].bounds;r<i;a=n,++r)if(MA(a,n=t[r].bounds,e))return!0},RA=t=>{const e=t.bounds;return e.width()>1&&e.height()>1},zA=t=>(t.forEach((t=>t.opacity=1)),t),BA=(t,e)=>t.reflow(e.modified()).modifies("opacity");function LA(t){Ic.call(this,null,t)}jn(DA,Ic,{transform(t,e){const n=IA[t.method]||IA.parity,r=t.separation||0;let i,a,o=e.materialize(e.SOURCE).source;if(!o||!o.length)return;if(!t.method)return t.modified("method")&&(zA(o),e=BA(e,t)),e;if(o=o.filter(RA),!o.length)return;if(t.sort&&(o=o.slice().sort(t.sort)),i=zA(o),e=BA(e,t),i.length>=3&&OA(i,r)){do{i=n(i,r)}while(i.length>=3&&OA(i,r));i.length<3&&!hn(o).opacity&&(i.length>1&&(hn(i).opacity=0),hn(o).opacity=1)}t.boundScale&&t.boundTolerance>=0&&(a=((t,e,n)=>{var r=t.range(),i=new rx;return e===V_||e===H_?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),t=>i.encloses(t.bounds)})(t.boundScale,t.boundOrient,+t.boundTolerance),o.forEach((t=>{a(t)||(t.opacity=0)})));const s=i[0].mark.bounds.clear();return o.forEach((t=>{t.opacity&&s.union(t.bounds)})),e}}),jn(LA,Ic,{transform(t,e){const n=e.dataflow;if(e.visit(e.ALL,(t=>n.dirty(t))),e.fields&&e.fields.zindex){const t=e.source&&e.source[0];t&&(t.mark.zdirty=!0)}}});const PA=new rx;function jA(t,e,n){return t[e]===n?0:(t[e]=n,1)}function UA(t){var e=t.items[0].orient;return e===q_||e===G_}function WA(t,e,n,r){var i,a,o=e.items[0],s=o.datum,c=null!=o.translate?o.translate:.5,u=o.orient,l=function(t){let e=+t.grid;return[t.ticks?e++:-1,t.labels?e++:-1,e+ +t.domain]}(s),h=o.range,d=o.offset,f=o.position,p=o.minExtent,g=o.maxExtent,m=s.title&&o.items[l[2]].items[0],v=o.titlePadding,y=o.bounds,b=m&&Ww(m),x=0,w=0;switch(PA.clear().union(y),y.clear(),(i=l[0])>-1&&y.union(o.items[i].bounds),(i=l[1])>-1&&y.union(o.items[i].bounds),u){case V_:x=f||0,w=-d,a=Math.max(p,Math.min(g,-y.y1)),y.add(0,-a).add(h,0),m&&VA(t,m,a,v,b,0,-1,y);break;case q_:x=-d,w=f||0,a=Math.max(p,Math.min(g,-y.x1)),y.add(-a,0).add(0,h),m&&VA(t,m,a,v,b,1,-1,y);break;case G_:x=n+d,w=f||0,a=Math.max(p,Math.min(g,y.x2)),y.add(0,0).add(a,h),m&&VA(t,m,a,v,b,1,1,y);break;case H_:x=f||0,w=r+d,a=Math.max(p,Math.min(g,y.y2)),y.add(0,0).add(h,a),m&&VA(t,m,a,v,0,0,1,y);break;default:x=o.x,w=o.y}return ux(y.translate(x,w),o),jA(o,"x",x+c)|jA(o,"y",w+c)&&(o.bounds=PA,t.dirty(o),o.bounds=y,t.dirty(o)),o.mark.bounds.clear().union(y)}function VA(t,e,n,r,i,a,o,s){const c=e.bounds;if(e.auto){const s=o*(n+i+r);let u=0,l=0;t.dirty(e),a?u=(e.x||0)-(e.x=s):l=(e.y||0)-(e.y=s),e.mark.bounds.clear().union(c.translate(-u,-l)),t.dirty(e)}s.union(c)}const qA=(t,e)=>Math.floor(Math.min(t,e)),GA=(t,e)=>Math.ceil(Math.max(t,e));function HA(t){return(new rx).set(0,0,t.width||0,t.height||0)}function YA(t){const e=t.bounds.clone();return e.empty()?e.set(0,0,0,0):e.translate(-(t.x||0),-(t.y||0))}function XA(t,e,n){const r=sn(t)?t[e]:t;return null!=r?r:void 0!==n?n:0}function KA(t){return t<0?Math.ceil(-t):0}function QA(t,e,n){var r,i,a,o,s,c,u,l,h,d,f,p=!n.nodirty,g=n.bounds===_A?HA:YA,m=PA.set(0,0,0,0),v=XA(n.align,AA),y=XA(n.align,CA),b=XA(n.padding,AA),x=XA(n.padding,CA),w=n.columns||e.length,k=w<=0?1:Math.ceil(e.length/w),_=e.length,A=Array(_),C=Array(w),S=0,E=Array(_),T=Array(k),N=0,F=Array(_),D=Array(_),I=Array(_);for(i=0;i<w;++i)C[i]=0;for(i=0;i<k;++i)T[i]=0;for(i=0;i<_;++i)c=e[i],s=I[i]=g(c),c.x=c.x||0,F[i]=0,c.y=c.y||0,D[i]=0,a=i%w,o=~~(i/w),S=Math.max(S,u=Math.ceil(s.x2)),N=Math.max(N,l=Math.ceil(s.y2)),C[a]=Math.max(C[a],u),T[o]=Math.max(T[o],l),A[i]=b+KA(s.x1),E[i]=x+KA(s.y1),p&&t.dirty(e[i]);for(i=0;i<_;++i)i%w===0&&(A[i]=0),i<w&&(E[i]=0);if(v===kA)for(a=1;a<w;++a){for(f=0,i=a;i<_;i+=w)f<A[i]&&(f=A[i]);for(i=a;i<_;i+=w)A[i]=f+C[a-1]}else if(v===wA){for(f=0,i=0;i<_;++i)i%w&&f<A[i]&&(f=A[i]);for(i=0;i<_;++i)i%w&&(A[i]=f+S)}else for(v=!1,a=1;a<w;++a)for(i=a;i<_;i+=w)A[i]+=C[a-1];if(y===kA)for(o=1;o<k;++o){for(f=0,r=(i=o*w)+w;i<r;++i)f<E[i]&&(f=E[i]);for(i=o*w;i<r;++i)E[i]=f+T[o-1]}else if(y===wA){for(f=0,i=w;i<_;++i)f<E[i]&&(f=E[i]);for(i=w;i<_;++i)E[i]=f+N}else for(y=!1,o=1;o<k;++o)for(r=(i=o*w)+w;i<r;++i)E[i]+=T[o-1];for(h=0,i=0;i<_;++i)h=A[i]+(i%w?h:0),F[i]+=h-e[i].x;for(a=0;a<w;++a)for(d=0,i=a;i<_;i+=w)d+=E[i],D[i]+=d-e[i].y;if(v&&XA(n.center,AA)&&k>1)for(i=0;i<_;++i)(h=(s=v===wA?S:C[i%w])-I[i].x2-e[i].x-F[i])>0&&(F[i]+=h/2);if(y&&XA(n.center,CA)&&1!==w)for(i=0;i<_;++i)(d=(s=y===wA?N:T[~~(i/w)])-I[i].y2-e[i].y-D[i])>0&&(D[i]+=d/2);for(i=0;i<_;++i)m.union(I[i].translate(F[i],D[i]));switch(h=XA(n.anchor,tA),d=XA(n.anchor,eA),XA(n.anchor,AA)){case J_:h-=m.width();break;case $_:h-=m.width()/2}switch(XA(n.anchor,CA)){case J_:d-=m.height();break;case $_:d-=m.height()/2}for(h=Math.round(h),d=Math.round(d),m.clear(),i=0;i<_;++i)e[i].mark.bounds.clear();for(i=0;i<_;++i)(c=e[i]).x+=F[i]+=h,c.y+=D[i]+=d,m.union(c.mark.bounds.union(c.bounds.translate(F[i],D[i]))),p&&t.dirty(c);return m}function ZA(t,e,n){var r,i,a,o,s,c,u,l=function(t){var e,n,r=t.items,i=r.length,a=0;const o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;a<i;++a)if(n=(e=r[a]).items,e.marktype===nA)switch(e.role){case rA:case sA:case iA:break;case cA:o.rowheaders.push(...n);break;case uA:o.rowfooters.push(...n);break;case hA:o.colheaders.push(...n);break;case dA:o.colfooters.push(...n);break;case lA:o.rowtitle=n[0];break;case fA:o.coltitle=n[0];break;default:o.marks.push(...n)}return o}(e),h=l.marks,d=n.bounds===_A?$A:JA,f=n.offset,p=n.columns||h.length,g=p<=0?1:Math.ceil(h.length/p),m=g*p;const v=QA(t,h,n);v.empty()&&v.set(0,0,0,0),l.rowheaders&&(c=XA(n.headerBand,CA,null),r=tC(t,l.rowheaders,h,p,g,-XA(f,"rowHeader"),qA,0,d,"x1",0,p,1,c)),l.colheaders&&(c=XA(n.headerBand,AA,null),i=tC(t,l.colheaders,h,p,p,-XA(f,"columnHeader"),qA,1,d,"y1",0,1,p,c)),l.rowfooters&&(c=XA(n.footerBand,CA,null),a=tC(t,l.rowfooters,h,p,g,XA(f,"rowFooter"),GA,0,d,"x2",p-1,p,1,c)),l.colfooters&&(c=XA(n.footerBand,AA,null),o=tC(t,l.colfooters,h,p,p,XA(f,"columnFooter"),GA,1,d,"y2",m-p,1,p,c)),l.rowtitle&&(s=XA(n.titleAnchor,CA),u=XA(f,"rowTitle"),u=s===J_?a+u:r-u,c=XA(n.titleBand,CA,.5),eC(t,l.rowtitle,u,0,v,c)),l.coltitle&&(s=XA(n.titleAnchor,AA),u=XA(f,"columnTitle"),u=s===J_?o+u:i-u,c=XA(n.titleBand,AA,.5),eC(t,l.coltitle,u,1,v,c))}function $A(t,e){return"x1"===e?t.x||0:"y1"===e?t.y||0:"x2"===e?(t.x||0)+(t.width||0):"y2"===e?(t.y||0)+(t.height||0):void 0}function JA(t,e){return t.bounds[e]}function tC(t,e,n,r,i,a,o,s,c,u,l,h,d,f){var p,g,m,v,y,b,x,w,k,_=n.length,A=0,C=0;if(!_)return A;for(p=l;p<_;p+=h)n[p]&&(A=o(A,c(n[p],u)));if(!e.length)return A;for(e.length>i&&(t.warn("Grid headers exceed limit: "+i),e=e.slice(0,i)),A+=a,g=0,v=e.length;g<v;++g)t.dirty(e[g]),e[g].mark.bounds.clear();for(p=l,g=0,v=e.length;g<v;++g,p+=h){for(y=(b=e[g]).mark.bounds,m=p;m>=0&&null==(x=n[m]);m-=d);s?(w=null==f?x.x:Math.round(x.bounds.x1+f*x.bounds.width()),k=A):(w=A,k=null==f?x.y:Math.round(x.bounds.y1+f*x.bounds.height())),y.union(b.bounds.translate(w-(b.x||0),k-(b.y||0))),b.x=w,b.y=k,t.dirty(b),C=o(C,y[u])}return C}function eC(t,e,n,r,i,a){if(e){t.dirty(e);var o=n,s=n;r?o=Math.round(i.x1+a*i.width()):s=Math.round(i.y1+a*i.height()),e.bounds.translate(o-(e.x||0),s-(e.y||0)),e.mark.bounds.clear().union(e.bounds),e.x=o,e.y=s,t.dirty(e)}}function nC(t,e,n,r,i,a,o){const s=function(t,e){const n=t[e]||{};return(e,r)=>null!=n[e]?n[e]:null!=t[e]?t[e]:r}(n,e),c=function(t,e){let n=-1/0;return t.forEach((t=>{null!=t.offset&&(n=Math.max(n,t.offset))})),n>-1/0?n:e}(t,s("offset",0)),u=s("anchor",Z_),l=u===J_?1:u===$_?.5:0,h={align:kA,bounds:s("bounds",_A),columns:"vertical"===s("direction")?1:t.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(e){case q_:h.anchor={x:Math.floor(r.x1)-c,column:J_,y:l*(o||r.height()+2*r.y1),row:u};break;case G_:h.anchor={x:Math.ceil(r.x2)+c,y:l*(o||r.height()+2*r.y1),row:u};break;case V_:h.anchor={y:Math.floor(i.y1)-c,row:J_,x:l*(a||i.width()+2*i.x1),column:u};break;case H_:h.anchor={y:Math.ceil(i.y2)+c,x:l*(a||i.width()+2*i.x1),column:u};break;case Y_:h.anchor={x:c,y:c};break;case X_:h.anchor={x:a-c,y:c,column:J_};break;case K_:h.anchor={x:c,y:o-c,row:J_};break;case Q_:h.anchor={x:a-c,y:o-c,column:J_,row:J_}}return h}function rC(t,e){var n,r,i=e.items[0],a=i.datum,o=i.orient,s=i.bounds,c=i.x,u=i.y;return i._bounds?i._bounds.clear().union(s):i._bounds=s.clone(),s.clear(),function(t,e,n){var r=e.padding,i=r-n.x,a=r-n.y;if(e.datum.title){var o=e.items[1].items[0],s=o.anchor,c=e.titlePadding||0,u=r-o.x,l=r-o.y;switch(o.orient){case q_:i+=Math.ceil(o.bounds.width())+c;break;case G_:case H_:break;default:a+=o.bounds.height()+c}switch((i||a)&&aC(t,n,i,a),o.orient){case q_:l+=iC(e,n,o,s,1,1);break;case G_:u+=iC(e,n,o,J_,0,0)+c,l+=iC(e,n,o,s,1,1);break;case H_:u+=iC(e,n,o,s,0,0),l+=iC(e,n,o,J_,-1,0,1)+c;break;default:u+=iC(e,n,o,s,0,0)}(u||l)&&aC(t,o,u,l),(u=Math.round(o.bounds.x1-r))<0&&(aC(t,n,-u,0),aC(t,o,-u,0))}else(i||a)&&aC(t,n,i,a)}(t,i,i.items[0].items[0]),s=function(t,e){return t.items.forEach((t=>e.union(t.bounds))),e.x1=t.padding,e.y1=t.padding,e}(i,s),n=2*i.padding,r=2*i.padding,s.empty()||(n=Math.ceil(s.width()+n),r=Math.ceil(s.height()+r)),a.type===gA&&function(t){const e=t.reduce(((t,e)=>(t[e.column]=Math.max(e.bounds.x2-e.x,t[e.column]||0),t)),{});t.forEach((t=>{t.width=e[t.column],t.height=t.bounds.y2-t.y}))}(i.items[0].items[0].items[0].items),o!==xA&&(i.x=c=0,i.y=u=0),i.width=n,i.height=r,ux(s.set(c,u,c+n,u+r),i),i.mark.bounds.clear().union(s),i}function iC(t,e,n,r,i,a,o){const s="symbol"!==t.datum.type,c=n.datum.vgrad,u=(!s||!a&&c||o?e:e.items[0]).bounds[i?"y2":"x2"]-t.padding,l=c&&a?u:0,h=c&&a?0:u,d=i<=0?0:Ww(n);return Math.round(r===Z_?l:r===J_?h-d:.5*(u-d))}function aC(t,e,n,r){e.x+=n,e.y+=r,e.bounds.translate(n,r),e.mark.bounds.translate(n,r),t.dirty(e)}function oC(t){Ic.call(this,null,t)}function sC(t,e){let n=0;if(void 0===e)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}function cC(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function uC(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function lC(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function hC(){}jn(oC,Ic,{transform(t,e){const n=e.dataflow;return t.mark.items.forEach((e=>{t.layout&&ZA(n,e,t.layout),function(t,e,n){var r,i,a,o,s,c=e.items,u=Math.max(0,e.width||0),l=Math.max(0,e.height||0),h=(new rx).set(0,0,u,l),d=h.clone(),f=h.clone(),p=[];for(o=0,s=c.length;o<s;++o)switch((i=c[o]).role){case rA:(UA(i)?d:f).union(WA(t,i,u,l));break;case iA:r=i;break;case sA:p.push(rC(t,i));break;case aA:case oA:case cA:case uA:case lA:case hA:case dA:case fA:d.union(i.bounds),f.union(i.bounds);break;default:h.union(i.bounds)}if(p.length){const e={};p.forEach((t=>{(a=t.orient||G_)!==xA&&(e[a]||(e[a]=[])).push(t)}));for(const r in e){const i=e[r];QA(t,i,nC(i,r,n.legends,d,f,u,l))}p.forEach((e=>{const r=e.bounds;if(r.equals(e._bounds)||(e.bounds=e._bounds,t.dirty(e),e.bounds=r,t.dirty(e)),!n.autosize||n.autosize.type!==mA&&n.autosize.type!==vA&&n.autosize.type!==yA)h.union(r);else switch(e.orient){case q_:case G_:h.add(r.x1,0).add(r.x2,0);break;case V_:case H_:h.add(0,r.y1).add(0,r.y2)}}))}h.union(d).union(f),r&&h.union(function(t,e,n,r,i){var a,o=e.items[0],s=o.frame,c=o.orient,u=o.anchor,l=o.offset,h=o.padding,d=o.items[0].items[0],f=o.items[1]&&o.items[1].items[0],p=c===q_||c===G_?r:n,g=0,m=0,v=0,y=0,b=0;if(s!==nA?c===q_?(g=i.y2,p=i.y1):c===G_?(g=i.y1,p=i.y2):(g=i.x1,p=i.x2):c===q_&&(g=r,p=0),a=u===Z_?g:u===J_?p:(g+p)/2,f&&f.text){switch(c){case V_:case H_:b=d.bounds.height()+h;break;case q_:y=d.bounds.width()+h;break;case G_:y=-d.bounds.width()-h}PA.clear().union(f.bounds),PA.translate(y-(f.x||0),b-(f.y||0)),jA(f,"x",y)|jA(f,"y",b)&&(t.dirty(f),f.bounds.clear().union(PA),f.mark.bounds.clear().union(PA),t.dirty(f)),PA.clear().union(f.bounds)}else PA.clear();switch(PA.union(d.bounds),c){case V_:m=a,v=i.y1-PA.height()-l;break;case q_:m=i.x1-PA.width()-l,v=a;break;case G_:m=i.x2+PA.width()+l,v=a;break;case H_:m=a,v=i.y2+l;break;default:m=o.x,v=o.y}return jA(o,"x",m)|jA(o,"y",v)&&(PA.translate(m,v),t.dirty(o),o.bounds.clear().union(PA),e.bounds.clear().union(PA),t.dirty(o)),o.bounds}(t,r,u,l,h));e.clip&&h.set(0,0,e.width||0,e.height||0);!function(t,e,n,r){const i=r.autosize||{},a=i.type;if(t._autosize<1||!a)return;let o=t._width,s=t._height,c=Math.max(0,e.width||0),u=Math.max(0,Math.ceil(-n.x1)),l=Math.max(0,e.height||0),h=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-c)),f=Math.max(0,Math.ceil(n.y2-l));if(i.contains===pA){const e=t.padding();o-=e.left+e.right,s-=e.top+e.bottom}a===xA?(u=0,h=0,c=o,l=s):a===mA?(c=Math.max(0,o-u-d),l=Math.max(0,s-h-f)):a===vA?(c=Math.max(0,o-u-d),s=l+h+f):a===yA?(o=c+u+d,l=Math.max(0,s-h-f)):a===bA&&(o=c+u+d,s=l+h+f);t._resizeView(o,s,c,l,[u,h],i.resize)}(t,e,h,n)}(n,e,t)})),function(t){return t&&"legend-entry"!==t.mark.role}(t.mark.group)?e.reflow():e}});var dC=.7,fC=1.4285714285714286,pC="\\s*([+-]?\\d+)\\s*",gC="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",mC="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vC=/^#([0-9a-f]{3,8})$/,yC=new RegExp("^rgb\\("+[pC,pC,pC]+"\\)$"),bC=new RegExp("^rgb\\("+[mC,mC,mC]+"\\)$"),xC=new RegExp("^rgba\\("+[pC,pC,pC,gC]+"\\)$"),wC=new RegExp("^rgba\\("+[mC,mC,mC,gC]+"\\)$"),kC=new RegExp("^hsl\\("+[gC,mC,mC]+"\\)$"),_C=new RegExp("^hsla\\("+[gC,mC,mC,gC]+"\\)$"),AC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function CC(){return this.rgb().formatHex()}function SC(){return this.rgb().formatRgb()}function EC(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=vC.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?TC(e):3===n?new IC(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?NC(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?NC(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=yC.exec(t))?new IC(e[1],e[2],e[3],1):(e=bC.exec(t))?new IC(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=xC.exec(t))?NC(e[1],e[2],e[3],e[4]):(e=wC.exec(t))?NC(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=kC.exec(t))?zC(e[1],e[2]/100,e[3]/100,1):(e=_C.exec(t))?zC(e[1],e[2]/100,e[3]/100,e[4]):AC.hasOwnProperty(t)?TC(AC[t]):"transparent"===t?new IC(NaN,NaN,NaN,0):null}function TC(t){return new IC(t>>16&255,t>>8&255,255&t,1)}function NC(t,e,n,r){return r<=0&&(t=e=n=NaN),new IC(t,e,n,r)}function FC(t){return t instanceof hC||(t=EC(t)),t?new IC((t=t.rgb()).r,t.g,t.b,t.opacity):new IC}function DC(t,e,n,r){return 1===arguments.length?FC(t):new IC(t,e,n,null==r?1:r)}function IC(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function MC(){return"#"+RC(this.r)+RC(this.g)+RC(this.b)}function OC(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function RC(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function zC(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new PC(t,e,n,r)}function BC(t){if(t instanceof PC)return new PC(t.h,t.s,t.l,t.opacity);if(t instanceof hC||(t=EC(t)),!t)return new PC;if(t instanceof PC)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new PC(o,s,c,t.opacity)}function LC(t,e,n,r){return 1===arguments.length?BC(t):new PC(t,e,n,null==r?1:r)}function PC(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function jC(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function UC(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}function WC(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,s=r<e-1?t[r+2]:2*a-i;return UC((n-r/e)*e,o,i,a,s)}}function VC(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],s=t[(r+2)%e];return UC((n-r/e)*e,i,a,o,s)}}uC(hC,EC,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:CC,formatHex:CC,formatHsl:function(){return BC(this).formatHsl()},formatRgb:SC,toString:SC}),uC(IC,DC,lC(hC,{brighter:function(t){return t=null==t?fC:Math.pow(fC,t),new IC(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?dC:Math.pow(dC,t),new IC(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:MC,formatHex:MC,formatRgb:OC,toString:OC})),uC(PC,LC,lC(hC,{brighter:function(t){return t=null==t?fC:Math.pow(fC,t),new PC(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?dC:Math.pow(dC,t),new PC(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new IC(jC(t>=240?t-240:t+120,i,r),jC(t,i,r),jC(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));const qC=t=>()=>t;function GC(t,e){return function(n){return t+n*e}}function HC(t,e){var n=e-t;return n?GC(t,n>180||n<-180?n-360*Math.round(n/360):n):qC(isNaN(t)?e:t)}function YC(t){return 1===(t=+t)?XC:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):qC(isNaN(e)?n:e)}}function XC(t,e){var n=e-t;return n?GC(t,n):qC(isNaN(t)?e:t)}const KC=function t(e){var n=YC(e);function r(t,e){var r=n((t=DC(t)).r,(e=DC(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=XC(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function QC(t){return function(e){var n,r,i=e.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=DC(e[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=t(a),o=t(o),s=t(s),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=s(t),r+""}}}var ZC=QC(WC),$C=QC(VC);function JC(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(a){for(n=0;n<r;++n)i[n]=t[n]*(1-a)+e[n]*a;return i}}function tS(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function eS(t,e){return(tS(e)?JC:nS)(t,e)}function nS(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=uS(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}function rS(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function iS(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function aS(t,e){var n,r={},i={};for(n in null!==t&&"object"===typeof t||(t={}),null!==e&&"object"===typeof e||(e={}),e)n in t?r[n]=uS(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var oS=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,sS=new RegExp(oS.source,"g");function cS(t,e){var n,r,i,a=oS.lastIndex=sS.lastIndex=0,o=-1,s=[],c=[];for(t+="",e+="";(n=oS.exec(t))&&(r=sS.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,c.push({i:o,x:iS(n,r)})),a=sS.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?c[0]?function(t){return function(e){return t(e)+""}}(c[0].x):function(t){return function(){return t}}(e):(e=c.length,function(t){for(var n,r=0;r<e;++r)s[(n=c[r]).i]=n.x(t);return s.join("")})}function uS(t,e){var n,r=typeof e;return null==e||"boolean"===r?qC(e):("number"===r?iS:"string"===r?(n=EC(e))?(e=n,KC):cS:e instanceof EC?KC:e instanceof Date?rS:tS(e)?JC:Array.isArray(e)?nS:"function"!==typeof e.valueOf&&"function"!==typeof e.toString||isNaN(e)?aS:iS)(t,e)}function lS(t){Ic.call(this,null,t)}function hS(t){Ic.call(this,null,t)}function dS(){return ec({})}function fS(t){Ic.call(this,null,t)}function pS(t){Ic.call(this,[],t)}jn(lS,Ic,{transform(t,e){if(this.value&&!t.modified())return e.StopPropagation;var n=e.dataflow.locale(),r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=this.value,a=t.scale,o=Vy(a,null==t.count?t.values?t.values.length:10:t.count,t.minstep),s=t.format||Hy(n,a,o,t.formatSpecifier,t.formatType,!!t.values),c=t.values?qy(a,t.values,o):Gy(a,o);return i&&(r.rem=i),i=c.map(((t,e)=>ec({index:e/(c.length-1||1),value:t,label:s(t)}))),t.extra&&i.length&&i.push(ec({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}}),jn(hS,Ic,{transform(t,e){var n=e.dataflow,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.item||dS,a=t.key||Js,o=this.value;return on(r.encode)&&(r.encode=null),o&&(t.modified("key")||e.modified(a))&&qe("DataJoin does not support modified key function or fields."),o||(e=e.addAll(),this.value=o=function(t){const e=Pn().test((t=>t.exit));return e.lookup=n=>e.get(t(n)),e}(a)),e.visit(e.ADD,(t=>{const e=a(t);let n=o.get(e);n?n.exit?(o.empty--,r.add.push(n)):r.mod.push(n):(n=i(t),o.set(e,n),r.add.push(n)),n.datum=t,n.exit=!1})),e.visit(e.MOD,(t=>{const e=a(t),n=o.get(e);n&&(n.datum=t,r.mod.push(n))})),e.visit(e.REM,(t=>{const e=a(t),n=o.get(e);t!==n.datum||n.exit||(r.rem.push(n),n.exit=!0,++o.empty)})),e.changed(e.ADD_MOD)&&r.modifies("datum"),(e.clean()||t.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),r}}),jn(fS,Ic,{transform(t,e){var n=e.fork(e.ADD_REM),r=t.mod||!1,i=t.encoders,a=e.encode;if(on(a)){if(!n.changed()&&!a.every((t=>i[t])))return e.StopPropagation;a=a[0],n.encode=null}var o="enter"===a,s=i.update||$e,c=i.enter||$e,u=i.exit||$e,l=(a&&!o?i[a]:s)||$e;if(e.changed(e.ADD)&&(e.visit(e.ADD,(e=>{c(e,t),s(e,t)})),n.modifies(c.output),n.modifies(s.output),l!==$e&&l!==s&&(e.visit(e.ADD,(e=>{l(e,t)})),n.modifies(l.output))),e.changed(e.REM)&&u!==$e&&(e.visit(e.REM,(e=>{u(e,t)})),n.modifies(u.output)),o||l!==$e){const i=e.MOD|(t.modified()?e.REFLOW:0);o?(e.visit(i,(e=>{const i=c(e,t)||r;(l(e,t)||i)&&n.mod.push(e)})),n.mod.length&&n.modifies(c.output)):e.visit(i,(e=>{(l(e,t)||r)&&n.mod.push(e)})),n.mod.length&&n.modifies(l.output)}return n.changed()?n:e.StopPropagation}}),jn(pS,Ic,{transform(t,e){if(null!=this.value&&!t.modified())return e.StopPropagation;var n,r,i,a,o,s=e.dataflow.locale(),c=e.fork(e.NO_SOURCE|e.NO_FIELDS),u=this.value,l=t.type||Ly,h=t.scale,d=+t.limit,f=Vy(h,null==t.count?5:t.count,t.minstep),p=!!t.values||l===Ly,g=t.format||$y(s,h,f,l,t.formatSpecifier,t.formatType,p),m=t.values||Qy(h,f);return u&&(c.rem=u),l===Ly?(d&&m.length>d?(e.dataflow.warn("Symbol legend count exceeds limit, filtering items."),u=m.slice(0,d-1),o=!0):u=m,Cn(i=t.size)?(t.values||0!==h(u[0])||(u=u.slice(1)),a=u.reduce(((e,n)=>Math.max(e,i(n,t))),0)):i=In(a=i||8),u=u.map(((e,n)=>ec({index:n,label:g(e,n,u),value:e,offset:a,size:i(e,t)}))),o&&(o=m[u.length],u.push(ec({index:u.length,label:"\u2026".concat(m.length-u.length," entries"),value:o,offset:a,size:i(o,t)})))):"gradient"===l?(n=h.domain(),r=Iy(h,n[0],hn(n)),m.length<3&&!t.values&&n[0]!==hn(n)&&(m=[n[0],hn(n)]),u=m.map(((t,e)=>ec({index:e,label:g(t,e,m),value:t,perc:r(t)})))):(i=m.length-1,r=function(t){const e=t.domain(),n=e.length-1;let r=+e[0],i=+hn(e),a=i-r;if(t.type===iy){const t=n?a/n:.1;r-=t,i+=t,a=i-r}return t=>(t-r)/a}(h),u=m.map(((t,e)=>ec({index:e,label:g(t,e,m),value:t,perc:e?r(t):0,perc2:e===i?1:r(m[e+1])})))),c.source=u,c.add=u,this.value=u,c}});const gS=t=>t.source.x,mS=t=>t.source.y,vS=t=>t.target.x,yS=t=>t.target.y;function bS(t){Ic.call(this,{},t)}bS.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},jn(bS,Ic,{transform(t,e){var n=t.sourceX||gS,r=t.sourceY||mS,i=t.targetX||vS,a=t.targetY||yS,o=t.as||"path",s=t.orient||"vertical",c=t.shape||"line",u=_S.get(c+"-"+s)||_S.get(c);return u||qe("LinkPath unsupported type: "+t.shape+(t.orient?"-"+t.orient:"")),e.visit(e.SOURCE,(t=>{t[o]=u(n(t),r(t),i(t),a(t))})),e.reflow(t.modified()).modifies(o)}});const xS=(t,e,n,r)=>"M"+t+","+e+"L"+n+","+r,wS=(t,e,n,r)=>{var i=n-t,a=r-e,o=Math.sqrt(i*i+a*a)/2;return"M"+t+","+e+"A"+o+","+o+" "+180*Math.atan2(a,i)/Math.PI+" 0 1 "+n+","+r},kS=(t,e,n,r)=>{const i=n-t,a=r-e,o=.2*(i+a),s=.2*(a-i);return"M"+t+","+e+"C"+(t+o)+","+(e+s)+" "+(n+s)+","+(r-o)+" "+n+","+r},_S=Pn({line:xS,"line-radial":(t,e,n,r)=>xS(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),arc:wS,"arc-radial":(t,e,n,r)=>wS(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),curve:kS,"curve-radial":(t,e,n,r)=>kS(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),"orthogonal-horizontal":(t,e,n,r)=>"M"+t+","+e+"V"+r+"H"+n,"orthogonal-vertical":(t,e,n,r)=>"M"+t+","+e+"H"+n+"V"+r,"orthogonal-radial":(t,e,n,r)=>{const i=Math.cos(t),a=Math.sin(t),o=Math.cos(n),s=Math.sin(n);return"M"+e*i+","+e*a+"A"+e+","+e+" 0 0,"+((Math.abs(n-t)>Math.PI?n<=t:n>t)?1:0)+" "+e*o+","+e*s+"L"+r*o+","+r*s},"diagonal-horizontal":(t,e,n,r)=>{const i=(t+n)/2;return"M"+t+","+e+"C"+i+","+e+" "+i+","+r+" "+n+","+r},"diagonal-vertical":(t,e,n,r)=>{const i=(e+r)/2;return"M"+t+","+e+"C"+t+","+i+" "+n+","+i+" "+n+","+r},"diagonal-radial":(t,e,n,r)=>{const i=Math.cos(t),a=Math.sin(t),o=Math.cos(n),s=Math.sin(n),c=(e+r)/2;return"M"+e*i+","+e*a+"C"+c*i+","+c*a+" "+c*o+","+c*s+" "+r*o+","+r*s}});function AS(t){Ic.call(this,null,t)}AS.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},jn(AS,Ic,{transform(t,e){var n,r,i,a=t.as||["startAngle","endAngle"],o=a[0],s=a[1],c=t.field||Qe,u=t.startAngle||0,l=null!=t.endAngle?t.endAngle:2*Math.PI,h=e.source,d=h.map(c),f=d.length,p=u,g=(l-u)/sC(d),m=zu(f);for(t.sort&&m.sort(((t,e)=>d[t]-d[e])),n=0;n<f;++n)i=d[m[n]],(r=h[m[n]])[o]=p,r[s]=p+=i*g;return this.value=d,e.reflow(t.modified()).modifies(a)}});const CS=5;function SS(t){return Ay(t)&&t!==ty}const ES=Jn(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function TS(t){Ic.call(this,null,t),this.modified(!0)}function NS(t,e,n){Ey(t)&&(Math.abs(e.reduce(((t,e)=>t+(e<0?-1:e>0?1:0)),0))!==e.length&&n.warn("Log scale domain includes zero: "+Xn(e)));return e}function FS(t,e,n){return Cn(t)&&(e||n)?function(t,e){const n=e[0],r=hn(e)-n;return function(e){return t(n+e*r)}}(t,DS(e||[0,1],n)):t}function DS(t,e){return e?t.slice().reverse():t}function IS(t){Ic.call(this,null,t)}jn(TS,Ic,{transform(t,e){var n=e.dataflow,r=this.value,i=function(t){var e,n=t.type,r="";if(n===ty)return ty+"-"+Yv;(function(t){const e=t.type;return Ay(e)&&e!==$v&&e!==Jv&&(t.scheme||t.range&&t.range.length&&t.range.every(qn))})(t)&&(r=2===(e=t.rawDomain?t.rawDomain.length:t.domain?t.domain.length+ +(null!=t.domainMid):0)?ty+"-":3===e?ey+"-":"");return(r+n||Yv).toLowerCase()}(t);for(i in r&&i===r.type||(this.value=r=wy(i)()),t)if(!ES[i]){if("padding"===i&&SS(r.type))continue;Cn(r[i])?r[i](t[i]):n.warn("Unsupported scale property: "+i)}return function(t,e,n){var r=t.type,i=e.round||!1,a=e.range;if(null!=e.rangeStep)a=function(t,e,n){t!==sy&&t!==oy&&qe("Only band and point scales support rangeStep.");var r=(null!=e.paddingOuter?e.paddingOuter:e.padding)||0,i=t===oy?1:(null!=e.paddingInner?e.paddingInner:e.padding)||0;return[0,e.rangeStep*Hv(n,i,r)]}(r,e,n);else if(e.scheme&&(a=function(t,e,n){var r,i=e.schemeExtent;on(e.scheme)?r=Dy(e.scheme,e.interpolate,e.interpolateGamma):(r=By(e.scheme.toLowerCase()))||qe("Unrecognized scheme name: ".concat(e.scheme));return n=t===iy?n+1:t===cy?n-1:t===ny||t===ry?+e.schemeCount||CS:n,Ty(t)?FS(r,i,e.reverse):Cn(r)?function(t,e){const n=new Array(e),r=e+1;for(let i=0;i<e;)n[i]=t(++i/r);return n}(FS(r,i),n):t===ay?r:r.slice(0,n)}(r,e,n),Cn(a))){if(t.interpolator)return t.interpolator(a);qe("Scale type ".concat(r," does not support interpolating color schemes."))}if(a&&Ty(r))return t.interpolator(Dy(DS(a,e.reverse),e.interpolate,e.interpolateGamma));a&&e.interpolate&&t.interpolate?t.interpolate(My(e.interpolate,e.interpolateGamma)):Cn(t.round)?t.round(i):Cn(t.rangeRound)&&t.interpolate(i?cC:uS);a&&t.range(DS(a,e.reverse))}(r,t,function(t,e,n){let r=e.bins;if(r&&!on(r)){const e=t.domain(),n=e[0],i=hn(e),a=r.step;let o=null==r.start?n:r.start,s=null==r.stop?i:r.stop;a||qe("Scale bins parameter missing step property."),o<n&&(o=a*Math.ceil(n/a)),s>i&&(s=a*Math.floor(i/a)),r=zu(o,s+a/2,a)}r?t.bins=r:t.bins&&delete t.bins;t.type===cy&&(r?e.domain||e.domainRaw||(t.domain(r),n=r.length):t.bins=t.domain());return n}(r,t,function(t,e,n){const r=function(t,e,n){return e?(t.domain(NS(t.type,e,n)),e.length):-1}(t,e.domainRaw,n);if(r>-1)return r;var i,a,o=e.domain,s=t.type,c=e.zero||void 0===e.zero&&function(t){const e=t.type;return!t.bins&&(e===Yv||e===Kv||e===Qv)}(t);if(!o)return 0;SS(s)&&e.padding&&o[0]!==hn(o)&&(o=function(t,e,n,r,i,a){var o=Math.abs(hn(n)-n[0]),s=o/(o-2*r),c=t===Xv?wn(e,null,s):t===Qv?kn(e,null,s,.5):t===Kv?kn(e,null,s,i||1):t===Zv?_n(e,null,s,a||1):xn(e,null,s);return e=e.slice(),e[0]=c[0],e[e.length-1]=c[1],e}(s,o,e.range,e.padding,e.exponent,e.constant));if((c||null!=e.domainMin||null!=e.domainMax||null!=e.domainMid)&&(i=(o=o.slice()).length-1||1,c&&(o[0]>0&&(o[0]=0),o[i]<0&&(o[i]=0)),null!=e.domainMin&&(o[0]=e.domainMin),null!=e.domainMax&&(o[i]=e.domainMax),null!=e.domainMid)){const t=(a=e.domainMid)>o[i]?i+1:a<o[0]?0:i;t!==i&&n.warn("Scale domainMid exceeds domain min or max.",a),o.splice(t,0,a)}t.domain(NS(s,o,n)),s===ay&&t.unknown(e.domainImplicit?Pg:void 0);e.nice&&t.nice&&t.nice(!0!==e.nice&&Vy(t,e.nice)||null);return o.length}(r,t,n))),e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),jn(IS,Ic,{transform(t,e){const n=t.modified("sort")||e.changed(e.ADD)||e.modified(t.sort.fields)||e.modified("datum");return n&&e.source.sort(ac(t.sort)),this.modified(n),e}});const MS="zero",OS="center",RS="normalize",zS=["y0","y1"];function BS(t){Ic.call(this,null,t)}function LS(t,e,n,r,i){for(var a,o=(e-t.sum)/2,s=t.length,c=0;c<s;++c)(a=t[c])[r]=o,a[i]=o+=Math.abs(n(a))}function PS(t,e,n,r,i){for(var a,o=1/t.sum,s=0,c=t.length,u=0,l=0;u<c;++u)(a=t[u])[r]=s,a[i]=s=o*(l+=Math.abs(n(a)))}function jS(t,e,n,r,i){for(var a,o,s=0,c=0,u=t.length,l=0;l<u;++l)(a=+n(o=t[l]))<0?(o[r]=c,o[i]=c+=a):(o[r]=s,o[i]=s+=a)}BS.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:MS,values:[MS,OS,RS]},{name:"as",type:"string",array:!0,length:2,default:zS}]},jn(BS,Ic,{transform(t,e){var n,r,i,a,o=t.as||zS,s=o[0],c=o[1],u=ac(t.sort),l=t.field||Qe,h=t.offset===OS?LS:t.offset===RS?PS:jS;for(n=function(t,e,n,r){var i,a,o,s,c,u,l,h,d,f=[],p=t=>t(c);if(null==e)f.push(t.slice());else for(i={},a=0,o=t.length;a<o;++a)c=t[a],(l=i[u=e.map(p)])||(i[u]=l=[],f.push(l)),l.push(c);for(u=0,d=0,s=f.length;u<s;++u){for(a=0,h=0,o=(l=f[u]).length;a<o;++a)h+=Math.abs(r(l[a]));l.sum=h,h>d&&(d=h),n&&l.sort(n)}return f.max=d,f}(e.source,t.groupby,u,l),r=0,i=n.length,a=n.max;r<i;++r)h(n[r],a,l,s,c);return e.reflow(t.modified()).modifies(o)}});var US=Math.sqrt(50),WS=Math.sqrt(10),VS=Math.sqrt(2);function qS(t,e,n){var r,i,a,o,s=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(o=GS(t,e,n))||!isFinite(o))return[];if(o>0){let n=Math.round(t/o),r=Math.round(e/o);for(n*o<t&&++n,r*o>e&&--r,a=new Array(i=r-n+1);++s<i;)a[s]=(n+s)*o}else{o=-o;let n=Math.round(t*o),r=Math.round(e*o);for(n/o<t&&++n,r/o>e&&--r,a=new Array(i=r-n+1);++s<i;)a[s]=(n+s)/o}return r&&a.reverse(),a}function GS(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=US?10:a>=WS?5:a>=VS?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=US?10:a>=WS?5:a>=VS?2:1)}function HS(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=US?i*=10:a>=WS?i*=5:a>=VS&&(i*=2),e<t?-i:i}const YS=t=>t;function XS(t,e){t&&QS.hasOwnProperty(t.type)&&QS[t.type](t,e)}var KS={Feature:function(t,e){XS(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)XS(n[r].geometry,e)}},QS={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){ZS(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)ZS(n[r],e,0)},Polygon:function(t,e){$S(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)$S(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)XS(n[r],e)}};function ZS(t,e,n){var r,i=-1,a=t.length-n;for(e.lineStart();++i<a;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function $S(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)ZS(t[n],e,1);e.polygonEnd()}function JS(t,e){t&&KS.hasOwnProperty(t.type)?KS[t.type](t,e):XS(t,e)}class tE{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=e[r],a=t+i,o=Math.abs(t)<Math.abs(i)?t-(a-i):i-(a-t);o&&(e[n++]=o),t=a}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,r,i=this._n,a=0;if(i>0){for(a=t[--i];i>0&&(e=a,n=t[--i],a=e+n,r=n-(a-e),!r););i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(n=2*r,e=a+n,n==e-a&&(a=e))}return a}}var eE=1e-6,nE=1e-12,rE=Math.PI,iE=rE/2,aE=rE/4,oE=2*rE,sE=180/rE,cE=rE/180,uE=Math.abs,lE=Math.atan,hE=Math.atan2,dE=Math.cos,fE=(Math.ceil,Math.exp),pE=(Math.floor,Math.hypot,Math.log),gE=Math.pow,mE=Math.sin,vE=Math.sign||function(t){return t>0?1:t<0?-1:0},yE=Math.sqrt,bE=Math.tan;function xE(t){return t>1?0:t<-1?rE:Math.acos(t)}function wE(t){return t>1?iE:t<-1?-iE:Math.asin(t)}function kE(){}var _E,AE,CE,SE,EE=new tE,TE=new tE,NE={point:kE,lineStart:kE,lineEnd:kE,polygonStart:function(){NE.lineStart=FE,NE.lineEnd=ME},polygonEnd:function(){NE.lineStart=NE.lineEnd=NE.point=kE,EE.add(uE(TE)),TE=new tE},result:function(){var t=EE/2;return EE=new tE,t}};function FE(){NE.point=DE}function DE(t,e){NE.point=IE,_E=CE=t,AE=SE=e}function IE(t,e){TE.add(SE*t-CE*e),CE=t,SE=e}function ME(){IE(_E,AE)}const OE=NE;var RE=1/0,zE=RE,BE=-RE,LE=BE,PE={point:function(t,e){t<RE&&(RE=t);t>BE&&(BE=t);e<zE&&(zE=e);e>LE&&(LE=e)},lineStart:kE,lineEnd:kE,polygonStart:kE,polygonEnd:kE,result:function(){var t=[[RE,zE],[BE,LE]];return BE=LE=-(zE=RE=1/0),t}};const jE=PE;var UE,WE,VE,qE,GE=0,HE=0,YE=0,XE=0,KE=0,QE=0,ZE=0,$E=0,JE=0,tT={point:eT,lineStart:nT,lineEnd:aT,polygonStart:function(){tT.lineStart=oT,tT.lineEnd=sT},polygonEnd:function(){tT.point=eT,tT.lineStart=nT,tT.lineEnd=aT},result:function(){var t=JE?[ZE/JE,$E/JE]:QE?[XE/QE,KE/QE]:YE?[GE/YE,HE/YE]:[NaN,NaN];return GE=HE=YE=XE=KE=QE=ZE=$E=JE=0,t}};function eT(t,e){GE+=t,HE+=e,++YE}function nT(){tT.point=rT}function rT(t,e){tT.point=iT,eT(VE=t,qE=e)}function iT(t,e){var n=t-VE,r=e-qE,i=yE(n*n+r*r);XE+=i*(VE+t)/2,KE+=i*(qE+e)/2,QE+=i,eT(VE=t,qE=e)}function aT(){tT.point=eT}function oT(){tT.point=cT}function sT(){uT(UE,WE)}function cT(t,e){tT.point=uT,eT(UE=VE=t,WE=qE=e)}function uT(t,e){var n=t-VE,r=e-qE,i=yE(n*n+r*r);XE+=i*(VE+t)/2,KE+=i*(qE+e)/2,QE+=i,ZE+=(i=qE*t-VE*e)*(VE+t),$E+=i*(qE+e),JE+=3*i,eT(VE=t,qE=e)}const lT=tT;function hT(t){this._context=t}hT.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,oE)}},result:kE};var dT,fT,pT,gT,mT,vT=new tE,yT={point:kE,lineStart:function(){yT.point=bT},lineEnd:function(){dT&&xT(fT,pT),yT.point=kE},polygonStart:function(){dT=!0},polygonEnd:function(){dT=null},result:function(){var t=+vT;return vT=new tE,t}};function bT(t,e){yT.point=xT,fT=gT=t,pT=mT=e}function xT(t,e){gT-=t,mT-=e,vT.add(yE(gT*gT+mT*mT)),gT=t,mT=e}const wT=yT;var kT,_T,AT,CT;let ST,ET,TT,NT;class FT{constructor(t){this._append=null==t?DT:function(t){const e=Math.floor(t);if(!(e>=0))throw new RangeError("invalid digits: ".concat(t));if(e>15)return DT;if(e!==ST){const t=10**e;ST=e,ET=function(e){let n=1;this._+=e[0];for(const r=e.length;n<r;++n)this._+=Math.round(arguments[n]*t)/t+e[n]}}return ET}(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){0===this._line&&(this._+="Z"),this._point=NaN}point(t,e){switch(this._point){case 0:this._append(kT||(kT=fd(["M",",",""])),t,e),this._point=1;break;case 1:this._append(_T||(_T=fd(["L",",",""])),t,e);break;default:if(this._append(AT||(AT=fd(["M",",",""])),t,e),this._radius!==TT||this._append!==ET){const t=this._radius,e=this._;this._="",this._append(CT||(CT=fd(["m0,","a",","," 0 1,1 0,","a",","," 0 1,1 0,","z"])),t,t,t,-2*t,t,t,2*t),TT=t,ET=this._append,NT=this._,this._=e}this._+=NT}}result(){const t=this._;return this._="",t.length?t:null}}function DT(t){let e=1;this._+=t[0];for(const n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function IT(t,e){let n,r,i=3,a=4.5;function o(t){return t&&("function"===typeof a&&r.pointRadius(+a.apply(this,arguments)),JS(t,n(r))),r.result()}return o.area=function(t){return JS(t,n(OE)),OE.result()},o.measure=function(t){return JS(t,n(wT)),wT.result()},o.bounds=function(t){return JS(t,n(jE)),jE.result()},o.centroid=function(t){return JS(t,n(lT)),lT.result()},o.projection=function(e){return arguments.length?(n=null==e?(t=null,YS):(t=e).stream,o):t},o.context=function(t){return arguments.length?(r=null==t?(e=null,new FT(i)):new hT(e=t),"function"!==typeof a&&r.pointRadius(a),o):e},o.pointRadius=function(t){return arguments.length?(a="function"===typeof t?t:(r.pointRadius(+t),+t),o):a},o.digits=function(t){if(!arguments.length)return i;if(null==t)i=null;else{const e=Math.floor(t);if(!(e>=0))throw new RangeError("invalid digits: ".concat(t));i=e}return null===e&&(r=new FT(i)),o},o.projection(t).digits(i).context(e)}function MT(){var t,e=[];return{point:function(e,n,r){t.push([e,n,r])},lineStart:function(){e.push(t=[])},lineEnd:kE,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function OT(t,e){return uE(t[0]-e[0])<eE&&uE(t[1]-e[1])<eE}function RT(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function zT(t,e,n,r,i){var a,o,s=[],c=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],o=t[e];if(OT(r,o)){if(!r[2]&&!o[2]){for(i.lineStart(),a=0;a<e;++a)i.point((r=t[a])[0],r[1]);return void i.lineEnd()}o[0]+=2*eE}s.push(n=new RT(r,t,null,!0)),c.push(n.o=new RT(r,null,n,!1)),s.push(n=new RT(o,t,null,!1)),c.push(n.o=new RT(o,null,n,!0))}})),s.length){for(c.sort(e),BT(s),BT(c),a=0,o=c.length;a<o;++a)c[a].e=n=!n;for(var u,l,h=s[0];;){for(var d=h,f=!0;d.v;)if((d=d.n)===h)return;u=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(f)for(a=0,o=u.length;a<o;++a)i.point((l=u[a])[0],l[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(f)for(u=d.p.z,a=u.length-1;a>=0;--a)i.point((l=u[a])[0],l[1]);else r(d.x,d.p.x,-1,i);d=d.p}u=(d=d.o).z,f=!f}while(!d.v);i.lineEnd()}}}function BT(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}function LT(t){return[hE(t[1],t[0]),wE(t[2])]}function PT(t){var e=t[0],n=t[1],r=dE(n);return[r*dE(e),r*mE(e),mE(n)]}function jT(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function UT(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function WT(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function VT(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function qT(t){var e=yE(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function GT(t){return uE(t[0])<=rE?t[0]:vE(t[0])*((uE(t[0])+rE)%oE-rE)}function HT(t){return Array.from(function*(t){for(const e of t)yield*e}(t))}function YT(t,e,n,r){return function(i){var a,o,s,c=e(i),u=MT(),l=e(u),h=!1,d={point:f,lineStart:g,lineEnd:m,polygonStart:function(){d.point=v,d.lineStart=y,d.lineEnd=b,o=[],a=[]},polygonEnd:function(){d.point=f,d.lineStart=g,d.lineEnd=m,o=HT(o);var t=function(t,e){var n=GT(e),r=e[1],i=mE(r),a=[mE(n),-dE(n),0],o=0,s=0,c=new tE;1===i?r=iE+eE:-1===i&&(r=-iE-eE);for(var u=0,l=t.length;u<l;++u)if(d=(h=t[u]).length)for(var h,d,f=h[d-1],p=GT(f),g=f[1]/2+aE,m=mE(g),v=dE(g),y=0;y<d;++y,p=x,m=k,v=_,f=b){var b=h[y],x=GT(b),w=b[1]/2+aE,k=mE(w),_=dE(w),A=x-p,C=A>=0?1:-1,S=C*A,E=S>rE,T=m*k;if(c.add(hE(T*C*mE(S),v*_+T*dE(S))),o+=E?A+C*oE:A,E^p>=n^x>=n){var N=UT(PT(f),PT(b));qT(N);var F=UT(a,N);qT(F);var D=(E^A>=0?-1:1)*wE(F[2]);(r>D||r===D&&(N[0]||N[1]))&&(s+=E^A>=0?1:-1)}}return(o<-eE||o<eE&&c<-nE)^1&s}(a,r);o.length?(h||(i.polygonStart(),h=!0),zT(o,KT,t,n,i)):t&&(h||(i.polygonStart(),h=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),o=a=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function f(e,n){t(e,n)&&i.point(e,n)}function p(t,e){c.point(t,e)}function g(){d.point=p,c.lineStart()}function m(){d.point=f,c.lineEnd()}function v(t,e){s.push([t,e]),l.point(t,e)}function y(){l.lineStart(),s=[]}function b(){v(s[0][0],s[0][1]),l.lineEnd();var t,e,n,r,c=l.clean(),d=u.result(),f=d.length;if(s.pop(),a.push(s),s=null,f)if(1&c){if((e=(n=d[0]).length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else f>1&&2&c&&d.push(d.pop().concat(d.shift())),o.push(d.filter(XT))}return d}}function XT(t){return t.length>1}function KT(t,e){return((t=t.x)[0]<0?t[1]-iE-eE:iE-t[1])-((e=e.x)[0]<0?e[1]-iE-eE:iE-e[1])}const QT=YT((function(){return!0}),(function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(a,o){var s=a>0?rE:-rE,c=uE(a-n);uE(c-rE)<eE?(t.point(n,r=(r+o)/2>0?iE:-iE),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(a,r),e=0):i!==s&&c>=rE&&(uE(n-i)<eE&&(n-=i*eE),uE(a-s)<eE&&(a-=s*eE),r=function(t,e,n,r){var i,a,o=mE(t-n);return uE(o)>eE?lE((mE(e)*(a=dE(r))*mE(n)-mE(r)*(i=dE(e))*mE(t))/(i*a*o)):(e+r)/2}(n,r,a,o),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=a,r=o),i=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var i;if(null==t)i=n*iE,r.point(-rE,i),r.point(0,i),r.point(rE,i),r.point(rE,0),r.point(rE,-i),r.point(0,-i),r.point(-rE,-i),r.point(-rE,0),r.point(-rE,i);else if(uE(t[0]-e[0])>eE){var a=t[0]<e[0]?rE:-rE;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(e[0],e[1])}),[-rE,-iE]);function ZT(t,e,n,r,i,a){if(n){var o=dE(e),s=mE(e),c=r*n;null==i?(i=e+r*oE,a=e-c/2):(i=$T(o,i),a=$T(o,a),(r>0?i<a:i>a)&&(i+=r*oE));for(var u,l=i;r>0?l>a:l<a;l-=c)u=LT([o,-s*dE(l),-s*mE(l)]),t.point(u[0],u[1])}}function $T(t,e){(e=PT(e))[0]-=t,qT(e);var n=xE(-e[1]);return((-e[2]<0?-n:n)+oE-eE)%oE}var JT=1e9,tN=-JT;function eN(t,e,n,r){function i(i,a){return t<=i&&i<=n&&e<=a&&a<=r}function a(i,a,s,u){var l=0,h=0;if(null==i||(l=o(i,s))!==(h=o(a,s))||c(i,a)<0^s>0)do{u.point(0===l||3===l?t:n,l>1?r:e)}while((l=(l+s+4)%4)!==h);else u.point(a[0],a[1])}function o(r,i){return uE(r[0]-t)<eE?i>0?0:3:uE(r[0]-n)<eE?i>0?2:1:uE(r[1]-e)<eE?i>0?1:0:i>0?3:2}function s(t,e){return c(t.x,e.x)}function c(t,e){var n=o(t,1),r=o(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(o){var c,u,l,h,d,f,p,g,m,v,y,b=o,x=MT(),w={point:k,lineStart:function(){w.point=_,u&&u.push(l=[]);v=!0,m=!1,p=g=NaN},lineEnd:function(){c&&(_(h,d),f&&m&&x.rejoin(),c.push(x.result()));w.point=k,m&&b.lineEnd()},polygonStart:function(){b=x,c=[],u=[],y=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=u.length;n<i;++n)for(var a,o,s=u[n],c=1,l=s.length,h=s[0],d=h[0],f=h[1];c<l;++c)a=d,o=f,d=(h=s[c])[0],f=h[1],o<=r?f>r&&(d-a)*(r-o)>(f-o)*(t-a)&&++e:f<=r&&(d-a)*(r-o)<(f-o)*(t-a)&&--e;return e}(),n=y&&e,i=(c=HT(c)).length;(n||i)&&(o.polygonStart(),n&&(o.lineStart(),a(null,null,1,o),o.lineEnd()),i&&zT(c,s,e,a,o),o.polygonEnd());b=o,c=u=l=null}};function k(t,e){i(t,e)&&b.point(t,e)}function _(a,o){var s=i(a,o);if(u&&l.push([a,o]),v)h=a,d=o,f=s,v=!1,s&&(b.lineStart(),b.point(a,o));else if(s&&m)b.point(a,o);else{var c=[p=Math.max(tN,Math.min(JT,p)),g=Math.max(tN,Math.min(JT,g))],x=[a=Math.max(tN,Math.min(JT,a)),o=Math.max(tN,Math.min(JT,o))];!function(t,e,n,r,i,a){var o,s=t[0],c=t[1],u=0,l=1,h=e[0]-s,d=e[1]-c;if(o=n-s,h||!(o>0)){if(o/=h,h<0){if(o<u)return;o<l&&(l=o)}else if(h>0){if(o>l)return;o>u&&(u=o)}if(o=i-s,h||!(o<0)){if(o/=h,h<0){if(o>l)return;o>u&&(u=o)}else if(h>0){if(o<u)return;o<l&&(l=o)}if(o=r-c,d||!(o>0)){if(o/=d,d<0){if(o<u)return;o<l&&(l=o)}else if(d>0){if(o>l)return;o>u&&(u=o)}if(o=a-c,d||!(o<0)){if(o/=d,d<0){if(o>l)return;o>u&&(u=o)}else if(d>0){if(o<u)return;o<l&&(l=o)}return u>0&&(t[0]=s+u*h,t[1]=c+u*d),l<1&&(e[0]=s+l*h,e[1]=c+l*d),!0}}}}}(c,x,t,e,n,r)?s&&(b.lineStart(),b.point(a,o),y=!1):(m||(b.lineStart(),b.point(c[0],c[1])),b.point(x[0],x[1]),s||b.lineEnd(),y=!1)}p=a,g=o,m=s}return w}}function nN(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n}function rN(t,e){return uE(t)>rE&&(t-=Math.round(t/oE)*oE),[t,e]}function iN(t,e,n){return(t%=oE)?e||n?nN(oN(t),sN(e,n)):oN(t):e||n?sN(e,n):rN}function aN(t){return function(e,n){return uE(e+=t)>rE&&(e-=Math.round(e/oE)*oE),[e,n]}}function oN(t){var e=aN(t);return e.invert=aN(-t),e}function sN(t,e){var n=dE(t),r=mE(t),i=dE(e),a=mE(e);function o(t,e){var o=dE(e),s=dE(t)*o,c=mE(t)*o,u=mE(e),l=u*n+s*r;return[hE(c*i-l*a,s*n-u*r),wE(l*i+c*a)]}return o.invert=function(t,e){var o=dE(e),s=dE(t)*o,c=mE(t)*o,u=mE(e),l=u*i-c*a;return[hE(c*i+u*a,s*n+l*r),wE(l*n-s*r)]},o}function cN(t){return function(e){var n=new uN;for(var r in t)n[r]=t[r];return n.stream=e,n}}function uN(){}function lN(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),JS(n,t.stream(jE)),e(jE.result()),null!=r&&t.clipExtent(r),t}function hN(t,e,n){return lN(t,(function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],a=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),o=+e[0][0]+(r-a*(n[1][0]+n[0][0]))/2,s=+e[0][1]+(i-a*(n[1][1]+n[0][1]))/2;t.scale(150*a).translate([o,s])}),n)}function dN(t,e,n){return hN(t,[[0,0],e],n)}function fN(t,e,n){return lN(t,(function(n){var r=+e,i=r/(n[1][0]-n[0][0]),a=(r-i*(n[1][0]+n[0][0]))/2,o=-i*n[0][1];t.scale(150*i).translate([a,o])}),n)}function pN(t,e,n){return lN(t,(function(n){var r=+e,i=r/(n[1][1]-n[0][1]),a=-i*n[0][0],o=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([a,o])}),n)}rN.invert=rN,uN.prototype={constructor:uN,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var gN=16,mN=dE(30*cE);function vN(t,e){return+e?function(t,e){function n(r,i,a,o,s,c,u,l,h,d,f,p,g,m){var v=u-r,y=l-i,b=v*v+y*y;if(b>4*e&&g--){var x=o+d,w=s+f,k=c+p,_=yE(x*x+w*w+k*k),A=wE(k/=_),C=uE(uE(k)-1)<eE||uE(a-h)<eE?(a+h)/2:hE(w,x),S=t(C,A),E=S[0],T=S[1],N=E-r,F=T-i,D=y*N-v*F;(D*D/b>e||uE((v*N+y*F)/b-.5)>.3||o*d+s*f+c*p<mN)&&(n(r,i,a,o,s,c,E,T,C,x/=_,w/=_,k,g,m),m.point(E,T),n(E,T,C,x,w,k,u,l,h,d,f,p,g,m))}}return function(e){var r,i,a,o,s,c,u,l,h,d,f,p,g={point:m,lineStart:v,lineEnd:b,polygonStart:function(){e.polygonStart(),g.lineStart=x},polygonEnd:function(){e.polygonEnd(),g.lineStart=v}};function m(n,r){n=t(n,r),e.point(n[0],n[1])}function v(){l=NaN,g.point=y,e.lineStart()}function y(r,i){var a=PT([r,i]),o=t(r,i);n(l,h,u,d,f,p,l=o[0],h=o[1],u=r,d=a[0],f=a[1],p=a[2],gN,e),e.point(l,h)}function b(){g.point=m,e.lineEnd()}function x(){v(),g.point=w,g.lineEnd=k}function w(t,e){y(r=t,e),i=l,a=h,o=d,s=f,c=p,g.point=y}function k(){n(l,h,u,d,f,p,i,a,r,o,s,c,gN,e),g.lineEnd=b,b()}return g}}(t,e):function(t){return cN({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var yN=cN({point:function(t,e){this.stream.point(t*cE,e*cE)}});function bN(t,e,n,r,i,a){if(!a)return function(t,e,n,r,i){function a(a,o){return[e+t*(a*=r),n-t*(o*=i)]}return a.invert=function(a,o){return[(a-e)/t*r,(n-o)/t*i]},a}(t,e,n,r,i);var o=dE(a),s=mE(a),c=o*t,u=s*t,l=o/t,h=s/t,d=(s*n-o*e)/t,f=(s*e+o*n)/t;function p(t,a){return[c*(t*=r)-u*(a*=i)+e,n-u*t-c*a]}return p.invert=function(t,e){return[r*(l*t-h*e+d),i*(f-h*t-l*e)]},p}function xN(t){return wN((function(){return t}))()}function wN(t){var e,n,r,i,a,o,s,c,u,l,h=150,d=480,f=250,p=0,g=0,m=0,v=0,y=0,b=0,x=1,w=1,k=null,_=QT,A=null,C=YS,S=.5;function E(t){return c(t[0]*cE,t[1]*cE)}function T(t){return(t=c.invert(t[0],t[1]))&&[t[0]*sE,t[1]*sE]}function N(){var t=bN(h,0,0,x,w,b).apply(null,e(p,g)),r=bN(h,d-t[0],f-t[1],x,w,b);return n=iN(m,v,y),s=nN(e,r),c=nN(n,s),o=vN(s,S),F()}function F(){return u=l=null,E}return E.stream=function(t){return u&&l===t?u:u=yN(function(t){return cN({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}(n)(_(o(C(l=t)))))},E.preclip=function(t){return arguments.length?(_=t,k=void 0,F()):_},E.postclip=function(t){return arguments.length?(C=t,A=r=i=a=null,F()):C},E.clipAngle=function(t){return arguments.length?(_=+t?function(t){var e=dE(t),n=6*cE,r=e>0,i=uE(e)>eE;function a(t,n){return dE(t)*dE(n)>e}function o(t,n,r){var i=[1,0,0],a=UT(PT(t),PT(n)),o=jT(a,a),s=a[0],c=o-s*s;if(!c)return!r&&t;var u=e*o/c,l=-e*s/c,h=UT(i,a),d=VT(i,u);WT(d,VT(a,l));var f=h,p=jT(d,f),g=jT(f,f),m=p*p-g*(jT(d,d)-1);if(!(m<0)){var v=yE(m),y=VT(f,(-p-v)/g);if(WT(y,d),y=LT(y),!r)return y;var b,x=t[0],w=n[0],k=t[1],_=n[1];w<x&&(b=x,x=w,w=b);var A=w-x,C=uE(A-rE)<eE;if(!C&&_<k&&(b=k,k=_,_=b),C||A<eE?C?k+_>0^y[1]<(uE(y[0]-x)<eE?k:_):k<=y[1]&&y[1]<=_:A>rE^(x<=y[0]&&y[0]<=w)){var S=VT(f,(-p+v)/g);return WT(S,d),[y,LT(S)]}}}function s(e,n){var i=r?t:rE-t,a=0;return e<-i?a|=1:e>i&&(a|=2),n<-i?a|=4:n>i&&(a|=8),a}return YT(a,(function(t){var e,n,c,u,l;return{lineStart:function(){u=c=!1,l=1},point:function(h,d){var f,p=[h,d],g=a(h,d),m=r?g?0:s(h,d):g?s(h+(h<0?rE:-rE),d):0;if(!e&&(u=c=g)&&t.lineStart(),g!==c&&(!(f=o(e,p))||OT(e,f)||OT(p,f))&&(p[2]=1),g!==c)l=0,g?(t.lineStart(),f=o(p,e),t.point(f[0],f[1])):(f=o(e,p),t.point(f[0],f[1],2),t.lineEnd()),e=f;else if(i&&e&&r^g){var v;m&n||!(v=o(p,e,!0))||(l=0,r?(t.lineStart(),t.point(v[0][0],v[0][1]),t.point(v[1][0],v[1][1]),t.lineEnd()):(t.point(v[1][0],v[1][1]),t.lineEnd(),t.lineStart(),t.point(v[0][0],v[0][1],3)))}!g||e&&OT(e,p)||t.point(p[0],p[1]),e=p,c=g,n=m},lineEnd:function(){c&&t.lineEnd(),e=null},clean:function(){return l|(u&&c)<<1}}}),(function(e,r,i,a){ZT(a,t,n,i,e,r)}),r?[0,-t]:[-rE,t-rE])}(k=t*cE):(k=null,QT),F()):k*sE},E.clipExtent=function(t){return arguments.length?(C=null==t?(A=r=i=a=null,YS):eN(A=+t[0][0],r=+t[0][1],i=+t[1][0],a=+t[1][1]),F()):null==A?null:[[A,r],[i,a]]},E.scale=function(t){return arguments.length?(h=+t,N()):h},E.translate=function(t){return arguments.length?(d=+t[0],f=+t[1],N()):[d,f]},E.center=function(t){return arguments.length?(p=t[0]%360*cE,g=t[1]%360*cE,N()):[p*sE,g*sE]},E.rotate=function(t){return arguments.length?(m=t[0]%360*cE,v=t[1]%360*cE,y=t.length>2?t[2]%360*cE:0,N()):[m*sE,v*sE,y*sE]},E.angle=function(t){return arguments.length?(b=t%360*cE,N()):b*sE},E.reflectX=function(t){return arguments.length?(x=t?-1:1,N()):x<0},E.reflectY=function(t){return arguments.length?(w=t?-1:1,N()):w<0},E.precision=function(t){return arguments.length?(o=vN(s,S=t*t),F()):yE(S)},E.fitExtent=function(t,e){return hN(E,t,e)},E.fitSize=function(t,e){return dN(E,t,e)},E.fitWidth=function(t,e){return fN(E,t,e)},E.fitHeight=function(t,e){return pN(E,t,e)},function(){return e=t.apply(this,arguments),E.invert=e.invert&&T,N()}}function kN(t){var e=0,n=rE/3,r=wN(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*cE,n=t[1]*cE):[e*sE,n*sE]},i}function _N(t,e){var n=mE(t),r=(n+mE(e))/2;if(uE(r)<eE)return function(t){var e=dE(t);function n(t,n){return[t*e,mE(n)/e]}return n.invert=function(t,n){return[t/e,wE(n*e)]},n}(t);var i=1+n*(2*r-n),a=yE(i)/r;function o(t,e){var n=yE(i-2*r*mE(e))/r;return[n*mE(t*=r),a-n*dE(t)]}return o.invert=function(t,e){var n=a-e,o=hE(t,uE(n))*vE(n);return n*r<0&&(o-=rE*vE(t)*vE(n)),[o/r,wE((i-(t*t+n*n)*r*r)/(2*r))]},o}function AN(){return kN(_N).scale(155.424).center([0,33.6442])}function CN(){return AN().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function SN(t){return function(e,n){var r=dE(e),i=dE(n),a=t(r*i);return a===1/0?[2,0]:[a*i*mE(e),a*mE(n)]}}function EN(t){return function(e,n){var r=yE(e*e+n*n),i=t(r),a=mE(i),o=dE(i);return[hE(e*a,r*o),wE(r&&n*a/r)]}}var TN=SN((function(t){return yE(2/(1+t))}));TN.invert=EN((function(t){return 2*wE(t/2)}));var NN=SN((function(t){return(t=xE(t))&&t/mE(t)}));function FN(t,e){return[t,pE(bE((iE+e)/2))]}function DN(t){var e,n,r,i=xN(t),a=i.center,o=i.scale,s=i.translate,c=i.clipExtent,u=null;function l(){var a=rE*o(),s=i(function(t){function e(e){return(e=t(e[0]*cE,e[1]*cE))[0]*=sE,e[1]*=sE,e}return t=iN(t[0]*cE,t[1]*cE,t.length>2?t[2]*cE:0),e.invert=function(e){return(e=t.invert(e[0]*cE,e[1]*cE))[0]*=sE,e[1]*=sE,e},e}(i.rotate()).invert([0,0]));return c(null==u?[[s[0]-a,s[1]-a],[s[0]+a,s[1]+a]]:t===FN?[[Math.max(s[0]-a,u),e],[Math.min(s[0]+a,n),r]]:[[u,Math.max(s[1]-a,e)],[n,Math.min(s[1]+a,r)]])}return i.scale=function(t){return arguments.length?(o(t),l()):o()},i.translate=function(t){return arguments.length?(s(t),l()):s()},i.center=function(t){return arguments.length?(a(t),l()):a()},i.clipExtent=function(t){return arguments.length?(null==t?u=e=n=r=null:(u=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),l()):null==u?null:[[u,e],[n,r]]},l()}function IN(t){return bE((iE+t)/2)}function MN(t,e){var n=dE(t),r=t===e?mE(t):pE(n/dE(e))/pE(IN(e)/IN(t)),i=n*gE(IN(t),r)/r;if(!r)return FN;function a(t,e){i>0?e<-iE+eE&&(e=-iE+eE):e>iE-eE&&(e=iE-eE);var n=i/gE(IN(e),r);return[n*mE(r*t),i-n*dE(r*t)]}return a.invert=function(t,e){var n=i-e,a=vE(r)*yE(t*t+n*n),o=hE(t,uE(n))*vE(n);return n*r<0&&(o-=rE*vE(t)*vE(n)),[o/r,2*lE(gE(i/a,1/r))-iE]},a}function ON(t,e){return[t,e]}function RN(t,e){var n=dE(t),r=t===e?mE(t):(n-dE(e))/(e-t),i=n/r+t;if(uE(r)<eE)return ON;function a(t,e){var n=i-e,a=r*t;return[n*mE(a),i-n*dE(a)]}return a.invert=function(t,e){var n=i-e,a=hE(t,uE(n))*vE(n);return n*r<0&&(a-=rE*vE(t)*vE(n)),[a/r,i-vE(r)*yE(t*t+n*n)]},a}NN.invert=EN((function(t){return t})),FN.invert=function(t,e){return[t,2*lE(fE(e))-iE]},ON.invert=ON;var zN=1.340264,BN=-.081106,LN=893e-6,PN=.003796,jN=yE(3)/2;function UN(t,e){var n=wE(jN*mE(e)),r=n*n,i=r*r*r;return[t*dE(n)/(jN*(zN+3*BN*r+i*(7*LN+9*PN*r))),n*(zN+BN*r+i*(LN+PN*r))]}function WN(t,e){var n=dE(e),r=dE(t)*n;return[n*mE(t)/r,mE(e)/r]}function VN(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function qN(t,e){return[dE(e)*mE(t),mE(e)]}function GN(t,e){var n=dE(e),r=1+dE(t)*n;return[n*mE(t)/r,mE(e)/r]}function HN(t,e){return[pE(bE((iE+e)/2)),-t]}function YN(){}function XN(){var t,e=[];return{point:function(e,n,r){t.push([e,n,r])},lineStart:function(){e.push(t=[])},lineEnd:YN,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}UN.invert=function(t,e){for(var n,r=e,i=r*r,a=i*i*i,o=0;o<12&&(a=(i=(r-=n=(r*(zN+BN*i+a*(LN+PN*i))-e)/(zN+3*BN*i+a*(7*LN+9*PN*i)))*r)*i*i,!(uE(n)<nE));++o);return[jN*t*(zN+3*BN*i+a*(7*LN+9*PN*i))/dE(r),wE(mE(r)/jN)]},WN.invert=EN(lE),VN.invert=function(t,e){var n,r=e,i=25;do{var a=r*r,o=a*a;r-=n=(r*(1.007226+a*(.015085+o*(.028874*a-.044475-.005916*o)))-e)/(1.007226+a*(.045255+o*(.259866*a-.311325-.005916*11*o)))}while(uE(n)>eE&&--i>0);return[t/(.8707+(a=r*r)*(a*(a*a*a*(.003971-.001529*a)-.013791)-.131979)),r]},qN.invert=EN(wE),GN.invert=EN((function(t){return 2*lE(t)})),HN.invert=function(t,e){return[-e,2*lE(fE(t))-iE]};var KN=1e-6,QN=1e-12,ZN=Math.PI,$N=ZN/2,JN=ZN/4,tF=2*ZN,eF=180/ZN,nF=ZN/180,rF=Math.abs,iF=Math.atan,aF=Math.atan2,oF=Math.cos,sF=(Math.ceil,Math.exp,Math.floor,Math.hypot,Math.log,Math.pow,Math.sin),cF=Math.sign||function(t){return t>0?1:t<0?-1:0},uF=Math.sqrt;Math.tan;function lF(t){return t>1?$N:t<-1?-$N:Math.asin(t)}function hF(t,e){return rF(t[0]-e[0])<KN&&rF(t[1]-e[1])<KN}function dF(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function fF(t,e,n,r,i){var a,o,s=[],c=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],o=t[e];if(hF(r,o)){if(!r[2]&&!o[2]){for(i.lineStart(),a=0;a<e;++a)i.point((r=t[a])[0],r[1]);return void i.lineEnd()}o[0]+=2*KN}s.push(n=new dF(r,t,null,!0)),c.push(n.o=new dF(r,null,n,!1)),s.push(n=new dF(o,t,null,!1)),c.push(n.o=new dF(o,null,n,!0))}})),s.length){for(c.sort(e),pF(s),pF(c),a=0,o=c.length;a<o;++a)c[a].e=n=!n;for(var u,l,h=s[0];;){for(var d=h,f=!0;d.v;)if((d=d.n)===h)return;u=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(f)for(a=0,o=u.length;a<o;++a)i.point((l=u[a])[0],l[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(f)for(u=d.p.z,a=u.length-1;a>=0;--a)i.point((l=u[a])[0],l[1]);else r(d.x,d.p.x,-1,i);d=d.p}u=(d=d.o).z,f=!f}while(!d.v);i.lineEnd()}}}function pF(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}class gF{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=e[r],a=t+i,o=Math.abs(t)<Math.abs(i)?t-(a-i):i-(a-t);o&&(e[n++]=o),t=a}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,r,i=this._n,a=0;if(i>0){for(a=t[--i];i>0&&(e=a,n=t[--i],a=e+n,r=n-(a-e),!r););i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(n=2*r,e=a+n,n==e-a&&(a=e))}return a}}function mF(t){return[aF(t[1],t[0]),lF(t[2])]}function vF(t){var e=t[0],n=t[1],r=oF(n);return[r*oF(e),r*sF(e),sF(n)]}function yF(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function bF(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function xF(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function wF(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function kF(t){var e=uF(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function _F(t){return rF(t[0])<=ZN?t[0]:cF(t[0])*((rF(t[0])+ZN)%tF-ZN)}function AF(t){return Array.from(function*(t){for(const e of t)yield*e}(t))}function CF(t,e,n,r){return function(i){var a,o,s,c=e(i),u=XN(),l=e(u),h=!1,d={point:f,lineStart:g,lineEnd:m,polygonStart:function(){d.point=v,d.lineStart=y,d.lineEnd=b,o=[],a=[]},polygonEnd:function(){d.point=f,d.lineStart=g,d.lineEnd=m,o=AF(o);var t=function(t,e){var n=_F(e),r=e[1],i=sF(r),a=[sF(n),-oF(n),0],o=0,s=0,c=new gF;1===i?r=$N+KN:-1===i&&(r=-$N-KN);for(var u=0,l=t.length;u<l;++u)if(d=(h=t[u]).length)for(var h,d,f=h[d-1],p=_F(f),g=f[1]/2+JN,m=sF(g),v=oF(g),y=0;y<d;++y,p=x,m=k,v=_,f=b){var b=h[y],x=_F(b),w=b[1]/2+JN,k=sF(w),_=oF(w),A=x-p,C=A>=0?1:-1,S=C*A,E=S>ZN,T=m*k;if(c.add(aF(T*C*sF(S),v*_+T*oF(S))),o+=E?A+C*tF:A,E^p>=n^x>=n){var N=bF(vF(f),vF(b));kF(N);var F=bF(a,N);kF(F);var D=(E^A>=0?-1:1)*lF(F[2]);(r>D||r===D&&(N[0]||N[1]))&&(s+=E^A>=0?1:-1)}}return(o<-KN||o<KN&&c<-QN)^1&s}(a,r);o.length?(h||(i.polygonStart(),h=!0),fF(o,EF,t,n,i)):t&&(h||(i.polygonStart(),h=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),o=a=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function f(e,n){t(e,n)&&i.point(e,n)}function p(t,e){c.point(t,e)}function g(){d.point=p,c.lineStart()}function m(){d.point=f,c.lineEnd()}function v(t,e){s.push([t,e]),l.point(t,e)}function y(){l.lineStart(),s=[]}function b(){v(s[0][0],s[0][1]),l.lineEnd();var t,e,n,r,c=l.clean(),d=u.result(),f=d.length;if(s.pop(),a.push(s),s=null,f)if(1&c){if((e=(n=d[0]).length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else f>1&&2&c&&d.push(d.pop().concat(d.shift())),o.push(d.filter(SF))}return d}}function SF(t){return t.length>1}function EF(t,e){return((t=t.x)[0]<0?t[1]-$N-KN:$N-t[1])-((e=e.x)[0]<0?e[1]-$N-KN:$N-e[1])}const TF=CF((function(){return!0}),(function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(a,o){var s=a>0?ZN:-ZN,c=rF(a-n);rF(c-ZN)<KN?(t.point(n,r=(r+o)/2>0?$N:-$N),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(a,r),e=0):i!==s&&c>=ZN&&(rF(n-i)<KN&&(n-=i*KN),rF(a-s)<KN&&(a-=s*KN),r=function(t,e,n,r){var i,a,o=sF(t-n);return rF(o)>KN?iF((sF(e)*(a=oF(r))*sF(n)-sF(r)*(i=oF(e))*sF(t))/(i*a*o)):(e+r)/2}(n,r,a,o),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=a,r=o),i=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var i;if(null==t)i=n*$N,r.point(-ZN,i),r.point(0,i),r.point(ZN,i),r.point(ZN,0),r.point(ZN,-i),r.point(0,-i),r.point(-ZN,-i),r.point(-ZN,0),r.point(-ZN,i);else if(rF(t[0]-e[0])>KN){var a=t[0]<e[0]?ZN:-ZN;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(e[0],e[1])}),[-ZN,-$N]);function NF(t,e,n,r,i,a){if(n){var o=oF(e),s=sF(e),c=r*n;null==i?(i=e+r*tF,a=e-c/2):(i=FF(o,i),a=FF(o,a),(r>0?i<a:i>a)&&(i+=r*tF));for(var u,l=i;r>0?l>a:l<a;l-=c)u=mF([o,-s*oF(l),-s*sF(l)]),t.point(u[0],u[1])}}function FF(t,e){(e=vF(e))[0]-=t,kF(e);var n=function(t){return t>1?0:t<-1?ZN:Math.acos(t)}(-e[1]);return((-e[2]<0?-n:n)+tF-KN)%tF}var DF=1e9,IF=-DF;function MF(t,e,n,r){function i(i,a){return t<=i&&i<=n&&e<=a&&a<=r}function a(i,a,s,u){var l=0,h=0;if(null==i||(l=o(i,s))!==(h=o(a,s))||c(i,a)<0^s>0)do{u.point(0===l||3===l?t:n,l>1?r:e)}while((l=(l+s+4)%4)!==h);else u.point(a[0],a[1])}function o(r,i){return rF(r[0]-t)<KN?i>0?0:3:rF(r[0]-n)<KN?i>0?2:1:rF(r[1]-e)<KN?i>0?1:0:i>0?3:2}function s(t,e){return c(t.x,e.x)}function c(t,e){var n=o(t,1),r=o(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(o){var c,u,l,h,d,f,p,g,m,v,y,b=o,x=XN(),w={point:k,lineStart:function(){w.point=_,u&&u.push(l=[]);v=!0,m=!1,p=g=NaN},lineEnd:function(){c&&(_(h,d),f&&m&&x.rejoin(),c.push(x.result()));w.point=k,m&&b.lineEnd()},polygonStart:function(){b=x,c=[],u=[],y=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=u.length;n<i;++n)for(var a,o,s=u[n],c=1,l=s.length,h=s[0],d=h[0],f=h[1];c<l;++c)a=d,o=f,d=(h=s[c])[0],f=h[1],o<=r?f>r&&(d-a)*(r-o)>(f-o)*(t-a)&&++e:f<=r&&(d-a)*(r-o)<(f-o)*(t-a)&&--e;return e}(),n=y&&e,i=(c=AF(c)).length;(n||i)&&(o.polygonStart(),n&&(o.lineStart(),a(null,null,1,o),o.lineEnd()),i&&fF(c,s,e,a,o),o.polygonEnd());b=o,c=u=l=null}};function k(t,e){i(t,e)&&b.point(t,e)}function _(a,o){var s=i(a,o);if(u&&l.push([a,o]),v)h=a,d=o,f=s,v=!1,s&&(b.lineStart(),b.point(a,o));else if(s&&m)b.point(a,o);else{var c=[p=Math.max(IF,Math.min(DF,p)),g=Math.max(IF,Math.min(DF,g))],x=[a=Math.max(IF,Math.min(DF,a)),o=Math.max(IF,Math.min(DF,o))];!function(t,e,n,r,i,a){var o,s=t[0],c=t[1],u=0,l=1,h=e[0]-s,d=e[1]-c;if(o=n-s,h||!(o>0)){if(o/=h,h<0){if(o<u)return;o<l&&(l=o)}else if(h>0){if(o>l)return;o>u&&(u=o)}if(o=i-s,h||!(o<0)){if(o/=h,h<0){if(o>l)return;o>u&&(u=o)}else if(h>0){if(o<u)return;o<l&&(l=o)}if(o=r-c,d||!(o>0)){if(o/=d,d<0){if(o<u)return;o<l&&(l=o)}else if(d>0){if(o>l)return;o>u&&(u=o)}if(o=a-c,d||!(o<0)){if(o/=d,d<0){if(o>l)return;o>u&&(u=o)}else if(d>0){if(o<u)return;o<l&&(l=o)}return u>0&&(t[0]=s+u*h,t[1]=c+u*d),l<1&&(e[0]=s+l*h,e[1]=c+l*d),!0}}}}}(c,x,t,e,n,r)?s&&(b.lineStart(),b.point(a,o),y=!1):(m||(b.lineStart(),b.point(c[0],c[1])),b.point(x[0],x[1]),s||b.lineEnd(),y=!1)}p=a,g=o,m=s}return w}}function OF(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n}const RF=t=>t;function zF(t,e){return rF(t)>ZN&&(t-=Math.round(t/tF)*tF),[t,e]}function BF(t,e,n){return(t%=tF)?e||n?OF(PF(t),jF(e,n)):PF(t):e||n?jF(e,n):zF}function LF(t){return function(e,n){return rF(e+=t)>ZN&&(e-=Math.round(e/tF)*tF),[e,n]}}function PF(t){var e=LF(t);return e.invert=LF(-t),e}function jF(t,e){var n=oF(t),r=sF(t),i=oF(e),a=sF(e);function o(t,e){var o=oF(e),s=oF(t)*o,c=sF(t)*o,u=sF(e),l=u*n+s*r;return[aF(c*i-l*a,s*n-u*r),lF(l*i+c*a)]}return o.invert=function(t,e){var o=oF(e),s=oF(t)*o,c=sF(t)*o,u=sF(e),l=u*i-c*a;return[aF(c*i+u*a,s*n+l*r),lF(l*n-s*r)]},o}function UF(t){return function(e){var n=new WF;for(var r in t)n[r]=t[r];return n.stream=e,n}}function WF(){}function VF(t,e){t&&GF.hasOwnProperty(t.type)&&GF[t.type](t,e)}zF.invert=zF,WF.prototype={constructor:WF,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var qF={Feature:function(t,e){VF(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)VF(n[r].geometry,e)}},GF={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){HF(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)HF(n[r],e,0)},Polygon:function(t,e){YF(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)YF(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)VF(n[r],e)}};function HF(t,e,n){var r,i=-1,a=t.length-n;for(e.lineStart();++i<a;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function YF(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)HF(t[n],e,1);e.polygonEnd()}var XF=1/0,KF=XF,QF=-XF,ZF=QF,$F={point:function(t,e){t<XF&&(XF=t);t>QF&&(QF=t);e<KF&&(KF=e);e>ZF&&(ZF=e)},lineStart:YN,lineEnd:YN,polygonStart:YN,polygonEnd:YN,result:function(){var t=[[XF,KF],[QF,ZF]];return QF=ZF=-(KF=XF=1/0),t}};const JF=$F;function tD(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),function(t,e){t&&qF.hasOwnProperty(t.type)?qF[t.type](t,e):VF(t,e)}(n,t.stream(JF)),e(JF.result()),null!=r&&t.clipExtent(r),t}function eD(t,e,n){return tD(t,(function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],a=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),o=+e[0][0]+(r-a*(n[1][0]+n[0][0]))/2,s=+e[0][1]+(i-a*(n[1][1]+n[0][1]))/2;t.scale(150*a).translate([o,s])}),n)}var nD=16,rD=oF(30*nF);function iD(t,e){return+e?function(t,e){function n(r,i,a,o,s,c,u,l,h,d,f,p,g,m){var v=u-r,y=l-i,b=v*v+y*y;if(b>4*e&&g--){var x=o+d,w=s+f,k=c+p,_=uF(x*x+w*w+k*k),A=lF(k/=_),C=rF(rF(k)-1)<KN||rF(a-h)<KN?(a+h)/2:aF(w,x),S=t(C,A),E=S[0],T=S[1],N=E-r,F=T-i,D=y*N-v*F;(D*D/b>e||rF((v*N+y*F)/b-.5)>.3||o*d+s*f+c*p<rD)&&(n(r,i,a,o,s,c,E,T,C,x/=_,w/=_,k,g,m),m.point(E,T),n(E,T,C,x,w,k,u,l,h,d,f,p,g,m))}}return function(e){var r,i,a,o,s,c,u,l,h,d,f,p,g={point:m,lineStart:v,lineEnd:b,polygonStart:function(){e.polygonStart(),g.lineStart=x},polygonEnd:function(){e.polygonEnd(),g.lineStart=v}};function m(n,r){n=t(n,r),e.point(n[0],n[1])}function v(){l=NaN,g.point=y,e.lineStart()}function y(r,i){var a=vF([r,i]),o=t(r,i);n(l,h,u,d,f,p,l=o[0],h=o[1],u=r,d=a[0],f=a[1],p=a[2],nD,e),e.point(l,h)}function b(){g.point=m,e.lineEnd()}function x(){v(),g.point=w,g.lineEnd=k}function w(t,e){y(r=t,e),i=l,a=h,o=d,s=f,c=p,g.point=y}function k(){n(l,h,u,d,f,p,i,a,r,o,s,c,nD,e),g.lineEnd=b,b()}return g}}(t,e):function(t){return UF({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var aD=UF({point:function(t,e){this.stream.point(t*nF,e*nF)}});function oD(t,e,n,r,i,a){if(!a)return function(t,e,n,r,i){function a(a,o){return[e+t*(a*=r),n-t*(o*=i)]}return a.invert=function(a,o){return[(a-e)/t*r,(n-o)/t*i]},a}(t,e,n,r,i);var o=oF(a),s=sF(a),c=o*t,u=s*t,l=o/t,h=s/t,d=(s*n-o*e)/t,f=(s*e+o*n)/t;function p(t,a){return[c*(t*=r)-u*(a*=i)+e,n-u*t-c*a]}return p.invert=function(t,e){return[r*(l*t-h*e+d),i*(f-h*t-l*e)]},p}function sD(t){return function(t){var e,n,r,i,a,o,s,c,u,l,h=150,d=480,f=250,p=0,g=0,m=0,v=0,y=0,b=0,x=1,w=1,k=null,_=TF,A=null,C=RF,S=.5;function E(t){return c(t[0]*nF,t[1]*nF)}function T(t){return(t=c.invert(t[0],t[1]))&&[t[0]*eF,t[1]*eF]}function N(){var t=oD(h,0,0,x,w,b).apply(null,e(p,g)),r=oD(h,d-t[0],f-t[1],x,w,b);return n=BF(m,v,y),s=OF(e,r),c=OF(n,s),o=iD(s,S),F()}function F(){return u=l=null,E}return E.stream=function(t){return u&&l===t?u:u=aD(function(t){return UF({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}(n)(_(o(C(l=t)))))},E.preclip=function(t){return arguments.length?(_=t,k=void 0,F()):_},E.postclip=function(t){return arguments.length?(C=t,A=r=i=a=null,F()):C},E.clipAngle=function(t){return arguments.length?(_=+t?function(t){var e=oF(t),n=6*nF,r=e>0,i=rF(e)>KN;function a(t,n){return oF(t)*oF(n)>e}function o(t,n,r){var i=[1,0,0],a=bF(vF(t),vF(n)),o=yF(a,a),s=a[0],c=o-s*s;if(!c)return!r&&t;var u=e*o/c,l=-e*s/c,h=bF(i,a),d=wF(i,u);xF(d,wF(a,l));var f=h,p=yF(d,f),g=yF(f,f),m=p*p-g*(yF(d,d)-1);if(!(m<0)){var v=uF(m),y=wF(f,(-p-v)/g);if(xF(y,d),y=mF(y),!r)return y;var b,x=t[0],w=n[0],k=t[1],_=n[1];w<x&&(b=x,x=w,w=b);var A=w-x,C=rF(A-ZN)<KN;if(!C&&_<k&&(b=k,k=_,_=b),C||A<KN?C?k+_>0^y[1]<(rF(y[0]-x)<KN?k:_):k<=y[1]&&y[1]<=_:A>ZN^(x<=y[0]&&y[0]<=w)){var S=wF(f,(-p+v)/g);return xF(S,d),[y,mF(S)]}}}function s(e,n){var i=r?t:ZN-t,a=0;return e<-i?a|=1:e>i&&(a|=2),n<-i?a|=4:n>i&&(a|=8),a}return CF(a,(function(t){var e,n,c,u,l;return{lineStart:function(){u=c=!1,l=1},point:function(h,d){var f,p=[h,d],g=a(h,d),m=r?g?0:s(h,d):g?s(h+(h<0?ZN:-ZN),d):0;if(!e&&(u=c=g)&&t.lineStart(),g!==c&&(!(f=o(e,p))||hF(e,f)||hF(p,f))&&(p[2]=1),g!==c)l=0,g?(t.lineStart(),f=o(p,e),t.point(f[0],f[1])):(f=o(e,p),t.point(f[0],f[1],2),t.lineEnd()),e=f;else if(i&&e&&r^g){var v;m&n||!(v=o(p,e,!0))||(l=0,r?(t.lineStart(),t.point(v[0][0],v[0][1]),t.point(v[1][0],v[1][1]),t.lineEnd()):(t.point(v[1][0],v[1][1]),t.lineEnd(),t.lineStart(),t.point(v[0][0],v[0][1],3)))}!g||e&&hF(e,p)||t.point(p[0],p[1]),e=p,c=g,n=m},lineEnd:function(){c&&t.lineEnd(),e=null},clean:function(){return l|(u&&c)<<1}}}),(function(e,r,i,a){NF(a,t,n,i,e,r)}),r?[0,-t]:[-ZN,t-ZN])}(k=t*nF):(k=null,TF),F()):k*eF},E.clipExtent=function(t){return arguments.length?(C=null==t?(A=r=i=a=null,RF):MF(A=+t[0][0],r=+t[0][1],i=+t[1][0],a=+t[1][1]),F()):null==A?null:[[A,r],[i,a]]},E.scale=function(t){return arguments.length?(h=+t,N()):h},E.translate=function(t){return arguments.length?(d=+t[0],f=+t[1],N()):[d,f]},E.center=function(t){return arguments.length?(p=t[0]%360*nF,g=t[1]%360*nF,N()):[p*eF,g*eF]},E.rotate=function(t){return arguments.length?(m=t[0]%360*nF,v=t[1]%360*nF,y=t.length>2?t[2]%360*nF:0,N()):[m*eF,v*eF,y*eF]},E.angle=function(t){return arguments.length?(b=t%360*nF,N()):b*eF},E.reflectX=function(t){return arguments.length?(x=t?-1:1,N()):x<0},E.reflectY=function(t){return arguments.length?(w=t?-1:1,N()):w<0},E.precision=function(t){return arguments.length?(o=iD(s,S=t*t),F()):uF(S)},E.fitExtent=function(t,e){return eD(E,t,e)},E.fitSize=function(t,e){return function(t,e,n){return eD(t,[[0,0],e],n)}(E,t,e)},E.fitWidth=function(t,e){return function(t,e,n){return tD(t,(function(n){var r=+e,i=r/(n[1][0]-n[0][0]),a=(r-i*(n[1][0]+n[0][0]))/2,o=-i*n[0][1];t.scale(150*i).translate([a,o])}),n)}(E,t,e)},E.fitHeight=function(t,e){return function(t,e,n){return tD(t,(function(n){var r=+e,i=r/(n[1][1]-n[0][1]),a=-i*n[0][0],o=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([a,o])}),n)}(E,t,e)},function(){return e=t.apply(this,arguments),E.invert=e.invert&&T,N()}}((function(){return t}))()}var cD=Math.abs,uD=(Math.atan,Math.atan2,Math.ceil,Math.cos),lD=(Math.exp,Math.floor,Math.log,Math.max,Math.min,Math.pow,Math.round,Math.sign,Math.sin),hD=(Math.tan,1e-6),dD=Math.PI,fD=dD/2,pD=(Math.SQRT1_2,mD(2));mD(dD);function gD(t){return t>1?fD:t<-1?-fD:Math.asin(t)}function mD(t){return t>0?Math.sqrt(t):0}function vD(t,e){var n,r=t*lD(e),i=30;do{e-=n=(e+lD(e)-r)/(1+uD(e))}while(cD(n)>hD&&--i>0);return e/2}var yD=function(t,e,n){function r(r,i){return[t*r*uD(i=vD(n,i)),e*lD(i)]}return r.invert=function(r,i){return i=gD(i/e),[r/(t*uD(i)),gD((2*i+lD(2*i))/n)]},r}(pD/fD,pD,dD);const bD=IT(),xD=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function wD(t,e){if(!t||"string"!==typeof t)throw new Error("Projection type must be a name string.");return t=t.toLowerCase(),arguments.length>1?(_D[t]=function(t,e){return function n(){const r=e();return r.type=t,r.path=IT().projection(r),r.copy=r.copy||function(){const t=n();return xD.forEach((e=>{r[e]&&t[e](r[e]())})),t.path.pointRadius(r.path.pointRadius()),t},xy(r)}}(t,e),this):_D[t]||null}function kD(t){return t&&t.path||bD}const _D={albers:CN,albersusa:function(){var t,e,n,r,i,a,o=CN(),s=AN().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=AN().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(t,e){a=[t,e]}};function l(t){var e=t[0],o=t[1];return a=null,n.point(e,o),a||(r.point(e,o),a)||(i.point(e,o),a)}function h(){return t=e=null,l}return l.invert=function(t){var e=o.scale(),n=o.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?c:o).invert(t)},l.stream=function(n){return t&&e===n?t:t=function(t){var e=t.length;return{point:function(n,r){for(var i=-1;++i<e;)t[i].point(n,r)},sphere:function(){for(var n=-1;++n<e;)t[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)t[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)t[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)t[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)t[n].polygonEnd()}}}([o.stream(e=n),s.stream(n),c.stream(n)])},l.precision=function(t){return arguments.length?(o.precision(t),s.precision(t),c.precision(t),h()):o.precision()},l.scale=function(t){return arguments.length?(o.scale(t),s.scale(.35*t),c.scale(t),l.translate(o.translate())):o.scale()},l.translate=function(t){if(!arguments.length)return o.translate();var e=o.scale(),a=+t[0],l=+t[1];return n=o.translate(t).clipExtent([[a-.455*e,l-.238*e],[a+.455*e,l+.238*e]]).stream(u),r=s.translate([a-.307*e,l+.201*e]).clipExtent([[a-.425*e+eE,l+.12*e+eE],[a-.214*e-eE,l+.234*e-eE]]).stream(u),i=c.translate([a-.205*e,l+.212*e]).clipExtent([[a-.214*e+eE,l+.166*e+eE],[a-.115*e-eE,l+.234*e-eE]]).stream(u),h()},l.fitExtent=function(t,e){return hN(l,t,e)},l.fitSize=function(t,e){return dN(l,t,e)},l.fitWidth=function(t,e){return fN(l,t,e)},l.fitHeight=function(t,e){return pN(l,t,e)},l.scale(1070)},azimuthalequalarea:function(){return xN(TN).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return xN(NN).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return kN(MN).scale(109.5).parallels([30,30])},conicequalarea:AN,conicequidistant:function(){return kN(RN).scale(131.154).center([0,13.9389])},equalEarth:function(){return xN(UN).scale(177.158)},equirectangular:function(){return xN(ON).scale(152.63)},gnomonic:function(){return xN(WN).scale(144.049).clipAngle(60)},identity:function(){var t,e,n,r,i,a,o,s=1,c=0,u=0,l=1,h=1,d=0,f=null,p=1,g=1,m=cN({point:function(t,e){var n=b([t,e]);this.stream.point(n[0],n[1])}}),v=YS;function y(){return p=s*l,g=s*h,a=o=null,b}function b(n){var r=n[0]*p,i=n[1]*g;if(d){var a=i*t-r*e;r=r*t+i*e,i=a}return[r+c,i+u]}return b.invert=function(n){var r=n[0]-c,i=n[1]-u;if(d){var a=i*t+r*e;r=r*t-i*e,i=a}return[r/p,i/g]},b.stream=function(t){return a&&o===t?a:a=m(v(o=t))},b.postclip=function(t){return arguments.length?(v=t,f=n=r=i=null,y()):v},b.clipExtent=function(t){return arguments.length?(v=null==t?(f=n=r=i=null,YS):eN(f=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),y()):null==f?null:[[f,n],[r,i]]},b.scale=function(t){return arguments.length?(s=+t,y()):s},b.translate=function(t){return arguments.length?(c=+t[0],u=+t[1],y()):[c,u]},b.angle=function(n){return arguments.length?(e=mE(d=n%360*cE),t=dE(d),y()):d*sE},b.reflectX=function(t){return arguments.length?(l=t?-1:1,y()):l<0},b.reflectY=function(t){return arguments.length?(h=t?-1:1,y()):h<0},b.fitExtent=function(t,e){return hN(b,t,e)},b.fitSize=function(t,e){return dN(b,t,e)},b.fitWidth=function(t,e){return fN(b,t,e)},b.fitHeight=function(t,e){return pN(b,t,e)},b},mercator:function(){return DN(FN).scale(961/oE)},mollweide:function(){return sD(yD).scale(169.529)},naturalEarth1:function(){return xN(VN).scale(175.295)},orthographic:function(){return xN(qN).scale(249.5).clipAngle(90+eE)},stereographic:function(){return xN(GN).scale(250).clipAngle(142)},transversemercator:function(){var t=DN(HN),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)}};for(const Set in _D)wD(Set,_D[Set]);var AD=1e-6,CD=1e-12,SD=Math.PI,ED=SD/2,TD=SD/4,ND=2*SD,FD=180/SD,DD=SD/180,ID=Math.abs,MD=Math.atan,OD=Math.atan2,RD=Math.cos,zD=Math.ceil,BD=Math.exp,LD=(Math.floor,Math.hypot),PD=Math.log,jD=Math.pow,UD=Math.sin,WD=Math.sign||function(t){return t>0?1:t<0?-1:0},VD=Math.sqrt,qD=Math.tan;function GD(t){return t>1?0:t<-1?SD:Math.acos(t)}function HD(t){return t>1?ED:t<-1?-ED:Math.asin(t)}function YD(t,e,n){var r=zu(t,e-AD,n).concat(e);return function(t){return r.map((function(e){return[t,e]}))}}function XD(t,e,n){var r=zu(t,e-AD,n).concat(e);return function(t){return r.map((function(e){return[e,t]}))}}function KD(){var t,e,n,r,i,a,o,s,c,u,l,h,d=10,f=d,p=90,g=360,m=2.5;function v(){return{type:"MultiLineString",coordinates:y()}}function y(){return zu(zD(r/p)*p,n,p).map(l).concat(zu(zD(s/g)*g,o,g).map(h)).concat(zu(zD(e/d)*d,t,d).filter((function(t){return ID(t%p)>AD})).map(c)).concat(zu(zD(a/f)*f,i,f).filter((function(t){return ID(t%g)>AD})).map(u))}return v.lines=function(){return y().map((function(t){return{type:"LineString",coordinates:t}}))},v.outline=function(){return{type:"Polygon",coordinates:[l(r).concat(h(o).slice(1),l(n).reverse().slice(1),h(s).reverse().slice(1))]}},v.extent=function(t){return arguments.length?v.extentMajor(t).extentMinor(t):v.extentMinor()},v.extentMajor=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],s=+t[0][1],o=+t[1][1],r>n&&(t=r,r=n,n=t),s>o&&(t=s,s=o,o=t),v.precision(m)):[[r,s],[n,o]]},v.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],a=+n[0][1],i=+n[1][1],e>t&&(n=e,e=t,t=n),a>i&&(n=a,a=i,i=n),v.precision(m)):[[e,a],[t,i]]},v.step=function(t){return arguments.length?v.stepMajor(t).stepMinor(t):v.stepMinor()},v.stepMajor=function(t){return arguments.length?(p=+t[0],g=+t[1],v):[p,g]},v.stepMinor=function(t){return arguments.length?(d=+t[0],f=+t[1],v):[d,f]},v.precision=function(d){return arguments.length?(m=+d,c=YD(a,i,90),u=XD(e,t,m),l=YD(s,o,90),h=XD(r,n,m),v):m},v.extentMajor([[-180,-90+AD],[180,90-AD]]).extentMinor([[-180,-80-AD],[180,80+AD]])}function QD(){}const ZD=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function $D(){var t=1,e=1,n=o;function r(t,e){return e.map((e=>i(t,e)))}function i(r,i){var o=[],s=[];return function(n,r,i){var o,s,c,u,l,h,d=new Array,f=new Array;o=s=-1,u=n[0]>=r,ZD[u<<1].forEach(p);for(;++o<t-1;)c=u,u=n[o+1]>=r,ZD[c|u<<1].forEach(p);ZD[u<<0].forEach(p);for(;++s<e-1;){for(o=-1,u=n[s*t+t]>=r,l=n[s*t]>=r,ZD[u<<1|l<<2].forEach(p);++o<t-1;)c=u,u=n[s*t+t+o+1]>=r,h=l,l=n[s*t+o+1]>=r,ZD[c|u<<1|l<<2|h<<3].forEach(p);ZD[u|l<<3].forEach(p)}o=-1,l=n[s*t]>=r,ZD[l<<2].forEach(p);for(;++o<t-1;)h=l,l=n[s*t+o+1]>=r,ZD[l<<2|h<<3].forEach(p);function p(t){var e,n,r=[t[0][0]+o,t[0][1]+s],c=[t[1][0]+o,t[1][1]+s],u=a(r),l=a(c);(e=f[u])?(n=d[l])?(delete f[e.end],delete d[n.start],e===n?(e.ring.push(c),i(e.ring)):d[e.start]=f[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete f[e.end],e.ring.push(c),f[e.end=l]=e):(e=d[l])?(n=f[u])?(delete d[e.start],delete f[n.end],e===n?(e.ring.push(c),i(e.ring)):d[n.start]=f[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete d[e.start],e.ring.unshift(r),d[e.start=u]=e):d[u]=f[l]={start:u,end:l,ring:[r,c]}}ZD[l<<3].forEach(p)}(r,i,(t=>{n(t,r,i),function(t){var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];for(;++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}(t)>0?o.push([t]):s.push(t)})),s.forEach((t=>{for(var e,n=0,r=o.length;n<r;++n)if(-1!==JD((e=o[n])[0],t))return void e.push(t)})),{type:"MultiPolygon",value:i,coordinates:o}}function a(e){return 2*e[0]+e[1]*(t+1)*4}function o(n,r,i){n.forEach((n=>{var a,o=n[0],s=n[1],c=0|o,u=0|s,l=r[u*t+c];o>0&&o<t&&c===o&&(a=r[u*t+c-1],n[0]=o+(i-a)/(l-a)-.5),s>0&&s<e&&u===s&&(a=r[(u-1)*t+c],n[1]=s+(i-a)/(l-a)-.5)}))}return r.contour=i,r.size=function(n){if(!arguments.length)return[t,e];var i=Math.floor(n[0]),a=Math.floor(n[1]);return i>=0&&a>=0||qe("invalid size"),t=i,e=a,r},r.smooth=function(t){return arguments.length?(n=t?o:QD,r):n===o},r}function JD(t,e){for(var n,r=-1,i=e.length;++r<i;)if(n=tI(t,e[r]))return n;return 0}function tI(t,e){for(var n=e[0],r=e[1],i=-1,a=0,o=t.length,s=o-1;a<o;s=a++){var c=t[a],u=c[0],l=c[1],h=t[s],d=h[0],f=h[1];if(eI(c,h,e))return 0;l>r!==f>r&&n<(d-u)*(r-l)/(f-l)+u&&(i=-i)}return i}function eI(t,e,n){var r,i,a,o;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])===(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&(i=t[r=+(t[0]===e[0])],a=n[r],o=e[r],i<=a&&a<=o||o<=a&&a<=i)}function nI(t,e,n){return function(r){var i=Rn(r),a=n?Math.min(i[0],0):i[0],o=i[1],s=o-a,c=e?HS(a,o,t):s/(t+1);return zu(a+c,o,c)}}function rI(t){Ic.call(this,null,t)}function iI(t,e,n,r,i){const a=t.x1||0,o=t.y1||0,s=e*n<0;function c(t){t.forEach(u)}function u(t){s&&t.reverse(),t.forEach(l)}function l(t){t[0]=(t[0]-a)*e+r,t[1]=(t[1]-o)*n+i}return function(t){return t.coordinates.forEach(c),t}}function aI(t,e,n){const r=t>=0?t:Kc(e,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function oI(t){return Cn(t)?t:In(+t)}function sI(){var t=t=>t[0],e=t=>t[1],n=Qe,r=[-1,-1],i=960,a=500,o=2;function s(s,c){const u=aI(r[0],s,t)>>o,l=aI(r[1],s,e)>>o,h=u?u+2:0,d=l?l+2:0,f=2*h+(i>>o),p=2*d+(a>>o),g=new Float32Array(f*p),m=new Float32Array(f*p);let v=g;s.forEach((r=>{const i=h+(+t(r)>>o),a=d+(+e(r)>>o);i>=0&&i<f&&a>=0&&a<p&&(g[i+a*f]+=+n(r))})),u>0&&l>0?(cI(f,p,g,m,u),uI(f,p,m,g,l),cI(f,p,g,m,u),uI(f,p,m,g,l),cI(f,p,g,m,u),uI(f,p,m,g,l)):u>0?(cI(f,p,g,m,u),cI(f,p,m,g,u),cI(f,p,g,m,u),v=m):l>0&&(uI(f,p,g,m,l),uI(f,p,m,g,l),uI(f,p,g,m,l),v=m);const y=c?Math.pow(2,-2*o):1/sC(v);for(let t=0,e=f*p;t<e;++t)v[t]*=y;return{values:v,scale:1<<o,width:f,height:p,x1:h,y1:d,x2:h+(i>>o),y2:d+(a>>o)}}return s.x=function(e){return arguments.length?(t=oI(e),s):t},s.y=function(t){return arguments.length?(e=oI(t),s):e},s.weight=function(t){return arguments.length?(n=oI(t),s):n},s.size=function(t){if(!arguments.length)return[i,a];var e=+t[0],n=+t[1];return e>=0&&n>=0||qe("invalid size"),i=e,a=n,s},s.cellSize=function(t){return arguments.length?((t=+t)>=1||qe("invalid cell size"),o=Math.floor(Math.log(t)/Math.LN2),s):1<<o},s.bandwidth=function(t){return arguments.length?(1===(t=An(t)).length&&(t=[+t[0],+t[0]]),2!==t.length&&qe("invalid bandwidth"),r=t,s):r},s}function cI(t,e,n,r,i){const a=1+(i<<1);for(let o=0;o<e;++o)for(let e=0,s=0;e<t+i;++e)e<t&&(s+=n[e+o*t]),e>=i&&(e>=a&&(s-=n[e-a+o*t]),r[e-i+o*t]=s/Math.min(e+1,t-1+a-e,a))}function uI(t,e,n,r,i){const a=1+(i<<1);for(let o=0;o<t;++o)for(let s=0,c=0;s<e+i;++s)s<e&&(c+=n[o+s*t]),s>=i&&(s>=a&&(c-=n[o+(s-a)*t]),r[o+(s-i)*t]=c/Math.min(s+1,e-1+a-s,a))}function lI(t){Ic.call(this,null,t)}rI.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},jn(rI,Ic,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=e.materialize(e.SOURCE).source,i=t.field||Xe,a=$D().smooth(!1!==t.smooth),o=t.thresholds||function(t,e,n){const r=nI(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?r:r(t.map((t=>Eu(e(t).values))))}(r,i,t),s=null===t.as?null:t.as||"contour",c=[];return r.forEach((e=>{const n=i(e),r=a.size([n.width,n.height])(n.values,on(o)?o:o(n.values));!function(t,e,n,r){let i=r.scale||e.scale,a=r.translate||e.translate;Cn(i)&&(i=i(n,r));Cn(a)&&(a=a(n,r));if((1===i||null==i)&&!a)return;const o=(Vn(i)?i:i[0])||1,s=(Vn(i)?i:i[1])||1,c=a&&a[0]||0,u=a&&a[1]||0;t.forEach(iI(e,o,s,c,u))}(r,n,e,t),r.forEach((t=>{c.push(rc(e,ec(null!=s?{[s]:t}:t)))}))})),this.value&&(n.rem=this.value),this.value=n.source=n.add=c,n}}),lI.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const hI=["x","y","weight","size","cellSize","bandwidth"];function dI(t,e){return hI.forEach((n=>null!=e[n]?t[n](e[n]):0)),t}function fI(t){Ic.call(this,null,t)}jn(lI,Ic,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=function(t,e){var n,r,i,a,o,s,c=[],u=t=>t(a);if(null==e)c.push(t);else for(n={},r=0,i=t.length;r<i;++r)a=t[r],(s=n[o=e.map(u)])||(n[o]=s=[],s.dims=o,c.push(s)),s.push(a);return c}(e.materialize(e.SOURCE).source,t.groupby),a=(t.groupby||[]).map(Pe),o=dI(sI(),t),s=t.as||"grid";return n=i.map((e=>ec(function(t,e){for(let n=0;n<a.length;++n)t[a[n]]=e[n];return t}({[s]:o(e,t.counts)},e.dims)))),this.value&&(r.rem=this.value),this.value=r.source=r.add=n,r}}),fI.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},jn(fI,Ic,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r,i=e.fork(e.NO_SOURCE|e.NO_FIELDS),a=$D().smooth(!1!==t.smooth),o=t.values,s=t.thresholds||nI(t.count||10,t.nice,!!o),c=t.size;return o||(o=e.materialize(e.SOURCE).source,r=iI(n=dI(sI(),t)(o,!0),n.scale||1,n.scale||1,0,0),c=[n.width,n.height],o=n.values),s=on(s)?s:s(o),o=a.size(c)(o,s),r&&o.forEach(r),this.value&&(i.rem=this.value),this.value=i.source=i.add=(o||[]).map(ec),i}});const pI="Feature",gI="FeatureCollection";function mI(t){Ic.call(this,null,t)}function vI(t){Ic.call(this,null,t)}function yI(t){Ic.call(this,null,t)}function bI(t){Ic.call(this,null,t)}function xI(t){Ic.call(this,[],t),this.generator=KD()}function wI(t){Ic.call(this,null,t)}function kI(t){if(!Cn(t))return!1;const e=Jn(je(t));return e.$x||e.$y||e.$value||e.$max}function _I(t){Ic.call(this,null,t),this.modified(!0)}function AI(t,e,n){Cn(t[e])&&t[e](n)}function CI(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,a,o,s,c,u,l,h,d,f=t._root,p={data:r},g=t._x0,m=t._y0,v=t._x1,y=t._y1;if(!f)return t._root=p,t;for(;f.length;)if((u=e>=(a=(g+v)/2))?g=a:v=a,(l=n>=(o=(m+y)/2))?m=o:y=o,i=f,!(f=f[h=l<<1|u]))return i[h]=p,t;if(s=+t._x.call(null,f.data),c=+t._y.call(null,f.data),e===s&&n===c)return p.next=f,i?i[h]=p:t._root=p,t;do{i=i?i[h]=new Array(4):t._root=new Array(4),(u=e>=(a=(g+v)/2))?g=a:v=a,(l=n>=(o=(m+y)/2))?m=o:y=o}while((h=l<<1|u)===(d=(c>=o)<<1|s>=a));return i[d]=f,i[h]=p,t}function SI(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function EI(t){return t[0]}function TI(t){return t[1]}function NI(t,e,n){var r=new FI(null==e?EI:e,null==n?TI:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function FI(t,e,n,r,i,a){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function DI(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}mI.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},jn(mI,Ic,{transform(t,e){var n,r=this._features,i=this._points,a=t.fields,o=a&&a[0],s=a&&a[1],c=t.geojson||!a&&Xe,u=e.ADD;n=t.modified()||e.changed(e.REM)||e.modified(je(c))||o&&e.modified(je(o))||s&&e.modified(je(s)),this.value&&!n||(u=e.SOURCE,this._features=r=[],this._points=i=[]),c&&e.visit(u,(t=>r.push(c(t)))),o&&s&&(e.visit(u,(t=>{var e=o(t),n=s(t);null!=e&&null!=n&&(e=+e)===e&&(n=+n)===n&&i.push([e,n])})),r=r.concat({type:pI,geometry:{type:"MultiPoint",coordinates:i}})),this.value={type:gI,features:r}}}),vI.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},jn(vI,Ic,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.field||Xe,a=t.as||"path",o=n.SOURCE;!r||t.modified()?(this.value=r=kD(t.projection),n.materialize().reflow()):o=i===Xe||e.modified(i.fields)?n.ADD_MOD:n.ADD;const s=function(t,e){const n=t.pointRadius();t.context(null),null!=e&&t.pointRadius(e);return n}(r,t.pointRadius);return n.visit(o,(t=>t[a]=r(i(t)))),r.pointRadius(s),n.modifies(a)}}),yI.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},jn(yI,Ic,{transform(t,e){var n,r=t.projection,i=t.fields[0],a=t.fields[1],o=t.as||["x","y"],s=o[0],c=o[1];function u(t){const e=r([i(t),a(t)]);e?(t[s]=e[0],t[c]=e[1]):(t[s]=void 0,t[c]=void 0)}return t.modified()?e=e.materialize().reflow(!0).visit(e.SOURCE,u):(n=e.modified(i.fields)||e.modified(a.fields),e.visit(n?e.ADD_MOD:e.ADD,u)),e.modifies(o)}}),bI.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},jn(bI,Ic,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.as||"shape",a=n.ADD;return r&&!t.modified()||(this.value=r=function(t,e,n){const r=null==n?n=>t(e(n)):r=>{var i=t.pointRadius(),a=t.pointRadius(n)(e(r));return t.pointRadius(i),a};return r.context=e=>(t.context(e),r),r}(kD(t.projection),t.field||He("datum"),t.pointRadius),n.materialize().reflow(),a=n.SOURCE),n.visit(a,(t=>t[i]=r)),n.modifies(i)}}),xI.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},jn(xI,Ic,{transform(t,e){var n,r=this.value,i=this.generator;if(!r.length||t.modified())for(const a in t)Cn(i[a])&&i[a](t[a]);return n=i(),r.length?e.mod.push(ic(r[0],n)):e.add.push(ec(n)),r[0]=n,e}}),wI.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},jn(wI,Ic,{transform(t,e){if(!e.changed()&&!t.modified())return e.StopPropagation;var n=e.materialize(e.SOURCE).source,r="shared"===t.resolve,i=t.field||Xe,a=function(t,e){let n;Cn(t)?(n=n=>t(n,e),n.dep=kI(t)):t?n=In(t):(n=t=>t.$value/t.$max||0,n.dep=!0);return n}(t.opacity,t),o=function(t,e){let n;Cn(t)?(n=n=>DC(t(n,e)),n.dep=kI(t)):n=In(DC(t||"#888"));return n}(t.color,t),s=t.as||"image",c={$x:0,$y:0,$value:0,$max:r?Eu(n.map((t=>Eu(i(t).values)))):0};return n.forEach((t=>{const e=i(t),n=On({},t,c);r||(n.$max=Eu(e.values||[])),t[s]=function(t,e,n,r){const i=t.width,a=t.height,o=t.x1||0,s=t.y1||0,c=t.x2||i,u=t.y2||a,l=t.values,h=l?t=>l[t]:Ke,d=Zd(c-o,u-s),f=d.getContext("2d"),p=f.getImageData(0,0,c-o,u-s),g=p.data;for(let m=s,v=0;m<u;++m){e.$y=m-s;for(let t=o,a=m*i;t<c;++t,v+=4){e.$x=t-o,e.$value=h(t+a);const i=n(e);g[v+0]=i.r,g[v+1]=i.g,g[v+2]=i.b,g[v+3]=~~(255*r(e))}}return f.putImageData(p,0,0),d}(e,n,o.dep?o:In(o(n)),a.dep?a:In(a(n)))})),e.reflow(!0).modifies(s)}}),jn(_I,Ic,{transform(t,e){let n=this.value;return!n||t.modified("type")?(this.value=n=function(t){const e=wD((t||"mercator").toLowerCase());e||qe("Unrecognized projection type: "+t);return e()}(t.type),xD.forEach((e=>{null!=t[e]&&AI(n,e,t[e])}))):xD.forEach((e=>{t.modified(e)&&AI(n,e,t[e])})),null!=t.pointRadius&&n.path.pointRadius(t.pointRadius),t.fit&&function(t,e){const n=function(t){return t=An(t),1===t.length?t[0]:{type:gI,features:t.reduce(((t,e)=>t.concat(function(t){return t.type===gI?t.features:An(t).filter((t=>null!=t)).map((t=>t.type===pI?t:{type:pI,geometry:t}))}(e))),[])}}(e.fit);e.extent?t.fitExtent(e.extent,n):e.size&&t.fitSize(e.size,n)}(n,t),e.fork(e.NO_SOURCE|e.NO_FIELDS)}});var II=NI.prototype=FI.prototype;function MI(t){return function(){return t}}function OI(t){return 1e-6*(t()-.5)}function RI(t){return t.x+t.vx}function zI(t){return t.y+t.vy}II.copy=function(){var t,e,n=new FI(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=DI(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=DI(e));return n},II.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return CI(this.cover(e,n),e,n,t)},II.addAll=function(t){var e,n,r,i,a=t.length,o=new Array(a),s=new Array(a),c=1/0,u=1/0,l=-1/0,h=-1/0;for(n=0;n<a;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(o[n]=r,s[n]=i,r<c&&(c=r),r>l&&(l=r),i<u&&(u=i),i>h&&(h=i));if(c>l||u>h)return this;for(this.cover(c,u).cover(l,h),n=0;n<a;++n)CI(this,o[n],s[n],t[n]);return this},II.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,a=(r=Math.floor(e))+1;else{for(var o,s,c=i-n||1,u=this._root;n>t||t>=i||r>e||e>=a;)switch(s=(e<r)<<1|t<n,(o=new Array(4))[s]=u,u=o,c*=2,s){case 0:i=n+c,a=r+c;break;case 1:n=i-c,a=r+c;break;case 2:i=n+c,r=a-c;break;case 3:n=i-c,r=a-c}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this},II.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},II.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},II.find=function(t,e,n){var r,i,a,o,s,c,u,l=this._x0,h=this._y0,d=this._x1,f=this._y1,p=[],g=this._root;for(g&&p.push(new SI(g,l,h,d,f)),null==n?n=1/0:(l=t-n,h=e-n,d=t+n,f=e+n,n*=n);c=p.pop();)if(!(!(g=c.node)||(i=c.x0)>d||(a=c.y0)>f||(o=c.x1)<l||(s=c.y1)<h))if(g.length){var m=(i+o)/2,v=(a+s)/2;p.push(new SI(g[3],m,v,o,s),new SI(g[2],i,v,m,s),new SI(g[1],m,a,o,v),new SI(g[0],i,a,m,v)),(u=(e>=v)<<1|t>=m)&&(c=p[p.length-1],p[p.length-1]=p[p.length-1-u],p[p.length-1-u]=c)}else{var y=t-+this._x.call(null,g.data),b=e-+this._y.call(null,g.data),x=y*y+b*b;if(x<n){var w=Math.sqrt(n=x);l=t-w,h=e-w,d=t+w,f=e+w,r=g.data}}return r},II.remove=function(t){if(isNaN(a=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,r,i,a,o,s,c,u,l,h,d,f=this._root,p=this._x0,g=this._y0,m=this._x1,v=this._y1;if(!f)return this;if(f.length)for(;;){if((u=a>=(s=(p+m)/2))?p=s:m=s,(l=o>=(c=(g+v)/2))?g=c:v=c,e=f,!(f=f[h=l<<1|u]))return this;if(!f.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,d=h)}for(;f.data!==t;)if(r=f,!(f=f.next))return this;return(i=f.next)&&delete f.next,r?(i?r.next=i:delete r.next,this):e?(i?e[h]=i:delete e[h],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(n?n[d]=f:this._root=f),this):(this._root=i,this)},II.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},II.root=function(){return this._root},II.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},II.visit=function(t){var e,n,r,i,a,o,s=[],c=this._root;for(c&&s.push(new SI(c,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(c=e.node,r=e.x0,i=e.y0,a=e.x1,o=e.y1)&&c.length){var u=(r+a)/2,l=(i+o)/2;(n=c[3])&&s.push(new SI(n,u,l,a,o)),(n=c[2])&&s.push(new SI(n,r,l,u,o)),(n=c[1])&&s.push(new SI(n,u,i,a,l)),(n=c[0])&&s.push(new SI(n,r,i,u,l))}return this},II.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new SI(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var a,o=e.x0,s=e.y0,c=e.x1,u=e.y1,l=(o+c)/2,h=(s+u)/2;(a=i[0])&&n.push(new SI(a,o,s,l,h)),(a=i[1])&&n.push(new SI(a,l,s,c,h)),(a=i[2])&&n.push(new SI(a,o,h,l,u)),(a=i[3])&&n.push(new SI(a,l,h,c,u))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},II.x=function(t){return arguments.length?(this._x=t,this):this._x},II.y=function(t){return arguments.length?(this._y=t,this):this._y};var BI={value:()=>{}};function LI(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new PI(r)}function PI(t){this._=t}function jI(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function UI(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=BI,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}PI.prototype=LI.prototype={constructor:PI,on:function(t,e){var n,r=this._,i=function(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}(t+"",r),a=-1,o=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!==typeof e)throw new Error("invalid callback: "+e);for(;++a<o;)if(n=(t=i[a]).type)r[n]=UI(r[n],t.name,e);else if(null==e)for(n in r)r[n]=UI(r[n],t.name,null);return this}for(;++a<o;)if((n=(t=i[a]).type)&&(n=jI(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new PI(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(r=this._[t]).length;a<n;++a)r[a].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};const WI=LI;var VI,qI,GI=0,HI=0,YI=0,XI=1e3,KI=0,QI=0,ZI=0,$I="object"===typeof performance&&performance.now?performance:Date,JI="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function tM(){return QI||(JI(eM),QI=$I.now()+ZI)}function eM(){QI=0}function nM(){this._call=this._time=this._next=null}function rM(t,e,n){var r=new nM;return r.restart(t,e,n),r}function iM(){QI=(KI=$I.now())+ZI,GI=HI=0;try{!function(){tM(),++GI;for(var t,e=VI;e;)(t=QI-e._time)>=0&&e._call.call(null,t),e=e._next;--GI}()}finally{GI=0,function(){var t,e,n=VI,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:VI=e);qI=t,oM(r)}(),QI=0}}function aM(){var t=$I.now(),e=t-KI;e>XI&&(ZI-=e,KI=t)}function oM(t){GI||(HI&&(HI=clearTimeout(HI)),t-QI>24?(t<1/0&&(HI=setTimeout(iM,t-$I.now()-ZI)),YI&&(YI=clearInterval(YI))):(YI||(KI=$I.now(),YI=setInterval(aM,XI)),GI=1,JI(iM)))}nM.prototype=rM.prototype={constructor:nM,restart:function(t,e,n){if("function"!==typeof t)throw new TypeError("callback is not a function");n=(null==n?tM():+n)+(null==e?0:+e),this._next||qI===this||(qI?qI._next=this:VI=this,qI=this),this._call=t,this._time=n,oM()},stop:function(){this._call&&(this._call=null,this._time=1/0,oM())}};const sM=1664525,cM=1013904223,uM=4294967296;function lM(t){return t.x}function hM(t){return t.y}var dM=10,fM=Math.PI*(3-Math.sqrt(5));function pM(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,s=new Map,c=rM(h),u=WI("tick","end"),l=function(){let t=1;return()=>(t=(sM*t+cM)%uM)/uM}();function h(){d(),u.call("tick",e),n<r&&(c.stop(),u.call("end",e))}function d(r){var c,u,l=t.length;void 0===r&&(r=1);for(var h=0;h<r;++h)for(n+=(a-n)*i,s.forEach((function(t){t(n)})),c=0;c<l;++c)null==(u=t[c]).fx?u.x+=u.vx*=o:(u.x=u.fx,u.vx=0),null==u.fy?u.y+=u.vy*=o:(u.y=u.fy,u.vy=0);return e}function f(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=dM*Math.sqrt(.5+n),a=n*fM;e.x=i*Math.cos(a),e.y=i*Math.sin(a)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,l),e}return null==t&&(t=[]),f(),e={tick:d,restart:function(){return c.restart(h),e},stop:function(){return c.stop(),e},nodes:function(n){return arguments.length?(t=n,f(),s.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(a=+t,e):a},velocityDecay:function(t){return arguments.length?(o=1-t,e):1-o},randomSource:function(t){return arguments.length?(l=t,s.forEach(p),e):l},force:function(t,n){return arguments.length>1?(null==n?s.delete(t):s.set(t,p(n)),e):s.get(t)},find:function(e,n,r){var i,a,o,s,c,u=0,l=t.length;for(null==r?r=1/0:r*=r,u=0;u<l;++u)(o=(i=e-(s=t[u]).x)*i+(a=n-s.y)*a)<r&&(c=s,r=o);return c},on:function(t,n){return arguments.length>1?(u.on(t,n),e):u.on(t)}}}function gM(t){return t.index}function mM(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}const vM={center:function(t,e){var n,r=1;function i(){var i,a,o=n.length,s=0,c=0;for(i=0;i<o;++i)s+=(a=n[i]).x,c+=a.y;for(s=(s/o-t)*r,c=(c/o-e)*r,i=0;i<o;++i)(a=n[i]).x-=s,a.y-=c}return null==t&&(t=0),null==e&&(e=0),i.initialize=function(t){n=t},i.x=function(e){return arguments.length?(t=+e,i):t},i.y=function(t){return arguments.length?(e=+t,i):e},i.strength=function(t){return arguments.length?(r=+t,i):r},i},collide:function(t){var e,n,r,i=1,a=1;function o(){for(var t,o,c,u,l,h,d,f=e.length,p=0;p<a;++p)for(o=NI(e,RI,zI).visitAfter(s),t=0;t<f;++t)c=e[t],h=n[c.index],d=h*h,u=c.x+c.vx,l=c.y+c.vy,o.visit(g);function g(t,e,n,a,o){var s=t.data,f=t.r,p=h+f;if(!s)return e>u+p||a<u-p||n>l+p||o<l-p;if(s.index>c.index){var g=u-s.x-s.vx,m=l-s.y-s.vy,v=g*g+m*m;v<p*p&&(0===g&&(v+=(g=OI(r))*g),0===m&&(v+=(m=OI(r))*m),v=(p-(v=Math.sqrt(v)))/v*i,c.vx+=(g*=v)*(p=(f*=f)/(d+f)),c.vy+=(m*=v)*p,s.vx-=g*(p=1-p),s.vy-=m*p)}}}function s(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function c(){if(e){var r,i,a=e.length;for(n=new Array(a),r=0;r<a;++r)i=e[r],n[i.index]=+t(i,r,e)}}return"function"!==typeof t&&(t=MI(null==t?1:+t)),o.initialize=function(t,n){e=t,r=n,c()},o.iterations=function(t){return arguments.length?(a=+t,o):a},o.strength=function(t){return arguments.length?(i=+t,o):i},o.radius=function(e){return arguments.length?(t="function"===typeof e?e:MI(+e),c(),o):t},o},nbody:function(){var t,e,n,r,i,a=MI(-30),o=1,s=1/0,c=.81;function u(n){var i,a=t.length,o=NI(t,lM,hM).visitAfter(h);for(r=n,i=0;i<a;++i)e=t[i],o.visit(d)}function l(){if(t){var e,n,r=t.length;for(i=new Array(r),e=0;e<r;++e)n=t[e],i[n.index]=+a(n,e,t)}}function h(t){var e,n,r,a,o,s=0,c=0;if(t.length){for(r=a=o=0;o<4;++o)(e=t[o])&&(n=Math.abs(e.value))&&(s+=e.value,c+=n,r+=n*e.x,a+=n*e.y);t.x=r/c,t.y=a/c}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=i[e.data.index]}while(e=e.next)}t.value=s}function d(t,a,u,l){if(!t.value)return!0;var h=t.x-e.x,d=t.y-e.y,f=l-a,p=h*h+d*d;if(f*f/c<p)return p<s&&(0===h&&(p+=(h=OI(n))*h),0===d&&(p+=(d=OI(n))*d),p<o&&(p=Math.sqrt(o*p)),e.vx+=h*t.value*r/p,e.vy+=d*t.value*r/p),!0;if(!(t.length||p>=s)){(t.data!==e||t.next)&&(0===h&&(p+=(h=OI(n))*h),0===d&&(p+=(d=OI(n))*d),p<o&&(p=Math.sqrt(o*p)));do{t.data!==e&&(f=i[t.data.index]*r/p,e.vx+=h*f,e.vy+=d*f)}while(t=t.next)}}return u.initialize=function(e,r){t=e,n=r,l()},u.strength=function(t){return arguments.length?(a="function"===typeof t?t:MI(+t),l(),u):a},u.distanceMin=function(t){return arguments.length?(o=t*t,u):Math.sqrt(o)},u.distanceMax=function(t){return arguments.length?(s=t*t,u):Math.sqrt(s)},u.theta=function(t){return arguments.length?(c=t*t,u):Math.sqrt(c)},u},link:function(t){var e,n,r,i,a,o,s=gM,c=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},u=MI(30),l=1;function h(r){for(var i=0,s=t.length;i<l;++i)for(var c,u,h,d,f,p,g,m=0;m<s;++m)u=(c=t[m]).source,d=(h=c.target).x+h.vx-u.x-u.vx||OI(o),f=h.y+h.vy-u.y-u.vy||OI(o),d*=p=((p=Math.sqrt(d*d+f*f))-n[m])/p*r*e[m],f*=p,h.vx-=d*(g=a[m]),h.vy-=f*g,u.vx+=d*(g=1-g),u.vy+=f*g}function d(){if(r){var o,c,u=r.length,l=t.length,h=new Map(r.map(((t,e)=>[s(t,e,r),t])));for(o=0,i=new Array(u);o<l;++o)(c=t[o]).index=o,"object"!==typeof c.source&&(c.source=mM(h,c.source)),"object"!==typeof c.target&&(c.target=mM(h,c.target)),i[c.source.index]=(i[c.source.index]||0)+1,i[c.target.index]=(i[c.target.index]||0)+1;for(o=0,a=new Array(l);o<l;++o)c=t[o],a[o]=i[c.source.index]/(i[c.source.index]+i[c.target.index]);e=new Array(l),f(),n=new Array(l),p()}}function f(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+c(t[n],n,t)}function p(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+u(t[e],e,t)}return null==t&&(t=[]),h.initialize=function(t,e){r=t,o=e,d()},h.links=function(e){return arguments.length?(t=e,d(),h):t},h.id=function(t){return arguments.length?(s=t,h):s},h.iterations=function(t){return arguments.length?(l=+t,h):l},h.strength=function(t){return arguments.length?(c="function"===typeof t?t:MI(+t),f(),h):c},h.distance=function(t){return arguments.length?(u="function"===typeof t?t:MI(+t),p(),h):u},h},x:function(t){var e,n,r,i=MI(.1);function a(t){for(var i,a=0,o=e.length;a<o;++a)(i=e[a]).vx+=(r[a]-i.x)*n[a]*t}function o(){if(e){var a,o=e.length;for(n=new Array(o),r=new Array(o),a=0;a<o;++a)n[a]=isNaN(r[a]=+t(e[a],a,e))?0:+i(e[a],a,e)}}return"function"!==typeof t&&(t=MI(null==t?0:+t)),a.initialize=function(t){e=t,o()},a.strength=function(t){return arguments.length?(i="function"===typeof t?t:MI(+t),o(),a):i},a.x=function(e){return arguments.length?(t="function"===typeof e?e:MI(+e),o(),a):t},a},y:function(t){var e,n,r,i=MI(.1);function a(t){for(var i,a=0,o=e.length;a<o;++a)(i=e[a]).vy+=(r[a]-i.y)*n[a]*t}function o(){if(e){var a,o=e.length;for(n=new Array(o),r=new Array(o),a=0;a<o;++a)n[a]=isNaN(r[a]=+t(e[a],a,e))?0:+i(e[a],a,e)}}return"function"!==typeof t&&(t=MI(null==t?0:+t)),a.initialize=function(t){e=t,o()},a.strength=function(t){return arguments.length?(i="function"===typeof t?t:MI(+t),o(),a):i},a.y=function(e){return arguments.length?(t="function"===typeof e?e:MI(+e),o(),a):t},a}},yM="forces",bM=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],xM=["static","iterations"],wM=["x","y","vx","vy"];function kM(t){Ic.call(this,null,t)}function _M(t,e,n,r){var i,a,o,s,c=An(e.forces);for(i=0,a=bM.length;i<a;++i)(o=bM[i])!==yM&&e.modified(o)&&t[o](e[o]);for(i=0,a=c.length;i<a;++i)s=yM+i,(o=n||e.modified(yM,i)?CM(c[i]):r&&AM(c[i],r)?t.force(s):null)&&t.force(s,o);for(a=t.numForces||0;i<a;++i)t.force(yM+i,null);return t.numForces=c.length,t}function AM(t,e){var n,r;for(n in t)if(Cn(r=t[n])&&e.modified(je(r)))return 1;return 0}function CM(t){var e,n;for(n in Bn(vM,t.force)||qe("Unrecognized force: "+t.force),e=vM[t.force](),t)Cn(e[n])&&SM(e[n],t[n],t);return e}function SM(t,e,n){t(Cn(e)?t=>e(t,n):e)}function EM(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function TM(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=FM)):void 0===e&&(e=NM);for(var n,r,i,a,o,s=new MM(t),c=[s];n=c.pop();)if((i=e(n.data))&&(o=(i=Array.from(i)).length))for(n.children=i,a=o-1;a>=0;--a)c.push(r=i[a]=new MM(i[a])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(IM)}function NM(t){return t.children}function FM(t){return Array.isArray(t)?t[1]:null}function DM(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function IM(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function MM(t){this.data=t,this.depth=this.height=0,this.parent=null}function OM(t){for(var e,n,r=0,i=(t=function(t){for(var e,n,r=t.length;r;)n=Math.random()*r--|0,e=t[r],t[r]=t[n],t[n]=e;return t}(Array.from(t))).length,a=[];r<i;)e=t[r],n&&BM(n,e)?++r:(n=PM(a=RM(a,e)),r=0);return n}function RM(t,e){var n,r;if(LM(e,t))return[e];for(n=0;n<t.length;++n)if(zM(e,t[n])&&LM(jM(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(zM(jM(t[n],t[r]),e)&&zM(jM(t[n],e),t[r])&&zM(jM(t[r],e),t[n])&&LM(UM(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function zM(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function BM(t,e){var n=t.r-e.r+1e-9*Math.max(t.r,e.r,1),r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function LM(t,e){for(var n=0;n<e.length;++n)if(!BM(t,e[n]))return!1;return!0}function PM(t){switch(t.length){case 1:return function(t){return{x:t.x,y:t.y,r:t.r}}(t[0]);case 2:return jM(t[0],t[1]);case 3:return UM(t[0],t[1],t[2])}}function jM(t,e){var n=t.x,r=t.y,i=t.r,a=e.x,o=e.y,s=e.r,c=a-n,u=o-r,l=s-i,h=Math.sqrt(c*c+u*u);return{x:(n+a+c/h*l)/2,y:(r+o+u/h*l)/2,r:(h+i+s)/2}}function UM(t,e,n){var r=t.x,i=t.y,a=t.r,o=e.x,s=e.y,c=e.r,u=n.x,l=n.y,h=n.r,d=r-o,f=r-u,p=i-s,g=i-l,m=c-a,v=h-a,y=r*r+i*i-a*a,b=y-o*o-s*s+c*c,x=y-u*u-l*l+h*h,w=f*p-d*g,k=(p*x-g*b)/(2*w)-r,_=(g*m-p*v)/w,A=(f*b-d*x)/(2*w)-i,C=(d*v-f*m)/w,S=_*_+C*C-1,E=2*(a+k*_+A*C),T=k*k+A*A-a*a,N=-(S?(E+Math.sqrt(E*E-4*S*T))/(2*S):T/E);return{x:r+k+_*N,y:i+A+C*N,r:N}}function WM(t,e,n){var r,i,a,o,s=t.x-e.x,c=t.y-e.y,u=s*s+c*c;u?(i=e.r+n.r,i*=i,o=t.r+n.r,i>(o*=o)?(r=(u+o-i)/(2*u),a=Math.sqrt(Math.max(0,o/u-r*r)),n.x=t.x-r*s-a*c,n.y=t.y-r*c+a*s):(r=(u+i-o)/(2*u),a=Math.sqrt(Math.max(0,i/u-r*r)),n.x=e.x+r*s-a*c,n.y=e.y+r*c+a*s)):(n.x=e.x+n.r,n.y=e.y)}function VM(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function qM(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,a=(e.y*n.r+n.y*e.r)/r;return i*i+a*a}function GM(t){this._=t,this.next=null,this.previous=null}function HM(t){if(!(i=(t=function(t){return"object"===typeof t&&"length"in t?t:Array.from(t)}(t)).length))return 0;var e,n,r,i,a,o,s,c,u,l,h;if((e=t[0]).x=0,e.y=0,!(i>1))return e.r;if(n=t[1],e.x=-n.r,n.x=e.r,n.y=0,!(i>2))return e.r+n.r;WM(n,e,r=t[2]),e=new GM(e),n=new GM(n),r=new GM(r),e.next=r.previous=n,n.next=e.previous=r,r.next=n.previous=e;t:for(s=3;s<i;++s){WM(e._,n._,r=t[s]),r=new GM(r),c=n.next,u=e.previous,l=n._.r,h=e._.r;do{if(l<=h){if(VM(c._,r._)){n=c,e.next=n,n.previous=e,--s;continue t}l+=c._.r,c=c.next}else{if(VM(u._,r._)){(e=u).next=n,n.previous=e,--s;continue t}h+=u._.r,u=u.previous}}while(c!==u.next);for(r.previous=e,r.next=n,e.next=n.previous=n=r,a=qM(e);(r=r.next)!==n;)(o=qM(r))<a&&(e=r,a=o);n=e.next}for(e=[n._],r=n;(r=r.next)!==n;)e.push(r._);for(r=OM(e),s=0;s<i;++s)(e=t[s]).x-=r.x,e.y-=r.y;return r.r}function YM(t){if("function"!==typeof t)throw new Error;return t}function XM(){return 0}function KM(t){return function(){return t}}function QM(t){return Math.sqrt(t.value)}function ZM(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function $M(t,e){return function(n){if(r=n.children){var r,i,a,o=r.length,s=t(n)*e||0;if(s)for(i=0;i<o;++i)r[i].r+=s;if(a=HM(r),s)for(i=0;i<o;++i)r[i].r-=s;n.r=a+s}}}function JM(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function tO(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function eO(t,e,n,r,i){for(var a,o=t.children,s=-1,c=o.length,u=t.value&&(r-e)/t.value;++s<c;)(a=o[s]).y0=n,a.y1=i,a.x0=e,a.x1=e+=a.value*u}kM.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:wM}]},jn(kM,Ic,{transform(t,e){var n,r,i=this.value,a=e.changed(e.ADD_REM),o=t.modified(bM),s=t.iterations||300;if(i?(a&&(e.modifies("index"),i.nodes(e.source)),(o||e.changed(e.MOD))&&_M(i,t,0,e)):(this.value=i=function(t,e){const n=pM(t),r=n.stop,i=n.restart;let a=!1;return n.stopped=()=>a,n.restart=()=>(a=!1,i()),n.stop=()=>(a=!0,r()),_M(n,e,!0).on("end",(()=>a=!0))}(e.source,t),i.on("tick",(n=e.dataflow,r=this,()=>n.touch(r).run())),t.static||(a=!0,i.tick()),e.modifies("index")),o||a||t.modified(xM)||e.changed()&&t.restart)if(i.alpha(Math.max(i.alpha(),t.alpha||1)).alphaDecay(1-Math.pow(i.alphaMin(),1/s)),t.static)for(i.stop();--s>=0;)i.tick();else if(i.stopped()&&i.restart(),!a)return e.StopPropagation;return this.finish(t,e)},finish(t,e){const n=e.dataflow;for(let s,c=this._argops,u=0,l=c.length;u<l;++u)if(s=c[u],s.name===yM&&"link"===s.op._argval.force)for(var r,i=s.op._argops,a=0,o=i.length;a<o;++a)if("links"===i[a].name&&(r=i[a].op.source)){n.pulse(r,n.changeset().reflow());break}return e.reflow(t.modified()).modifies(wM)}}),MM.prototype=TM.prototype={constructor:MM,count:function(){return this.eachAfter(EM)},each:function(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this},eachAfter:function(t,e){for(var n,r,i,a=this,o=[a],s=[],c=-1;a=o.pop();)if(s.push(a),n=a.children)for(r=0,i=n.length;r<i;++r)o.push(n[r]);for(;a=s.pop();)t.call(e,a,++c,this);return this},eachBefore:function(t,e){for(var n,r,i=this,a=[i],o=-1;i=a.pop();)if(t.call(e,i,++o,this),n=i.children)for(r=n.length-1;r>=0;--r)a.push(n[r]);return this},find:function(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;t=n.pop(),e=r.pop();for(;t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return TM(this).eachBefore(DM)},[Symbol.iterator]:function*(){var t,e,n,r,i=this,a=[i];do{for(t=a.reverse(),a=[];i=t.pop();)if(yield i,e=i.children)for(n=0,r=e.length;n<r;++n)a.push(e[n])}while(a.length)}};var nO={depth:-1},rO={};function iO(t){return t.id}function aO(t){return t.parentId}function oO(){var t=iO,e=aO;function n(n){var r,i,a,o,s,c,u,l=Array.from(n),h=l.length,d=new Map;for(i=0;i<h;++i)r=l[i],s=l[i]=new MM(r),null!=(c=t(r,i,n))&&(c+="")&&(u=s.id=c,d.set(u,d.has(u)?rO:s)),null!=(c=e(r,i,n))&&(c+="")&&(s.parent=c);for(i=0;i<h;++i)if(c=(s=l[i]).parent){if(!(o=d.get(c)))throw new Error("missing: "+c);if(o===rO)throw new Error("ambiguous: "+c);o.children?o.children.push(s):o.children=[s],s.parent=o}else{if(a)throw new Error("multiple roots");a=s}if(!a)throw new Error("no root");if(a.parent=nO,a.eachBefore((function(t){t.depth=t.parent.depth+1,--h})).eachBefore(IM),a.parent=null,h>0)throw new Error("cycle");return a}return n.id=function(e){return arguments.length?(t=YM(e),n):t},n.parentId=function(t){return arguments.length?(e=YM(t),n):e},n}function sO(t,e){return t.parent===e.parent?1:2}function cO(t){var e=t.children;return e?e[0]:t.t}function uO(t){var e=t.children;return e?e[e.length-1]:t.t}function lO(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function hO(t,e,n){return t.a.parent===e.parent?t.a:n}function dO(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function fO(t,e){return t.parent===e.parent?1:2}function pO(t,e){return t+e.x}function gO(t,e){return Math.max(t,e.y)}function mO(t,e,n,r,i){for(var a,o=t.children,s=-1,c=o.length,u=t.value&&(i-n)/t.value;++s<c;)(a=o[s]).x0=e,a.x1=r,a.y0=n,a.y1=n+=a.value*u}dO.prototype=Object.create(MM.prototype);var vO=(1+Math.sqrt(5))/2;function yO(t,e,n,r,i,a){for(var o,s,c,u,l,h,d,f,p,g,m,v=[],y=e.children,b=0,x=0,w=y.length,k=e.value;b<w;){c=i-n,u=a-r;do{l=y[x++].value}while(!l&&x<w);for(h=d=l,m=l*l*(g=Math.max(u/c,c/u)/(k*t)),p=Math.max(d/m,m/h);x<w;++x){if(l+=s=y[x].value,s<h&&(h=s),s>d&&(d=s),m=l*l*g,(f=Math.max(d/m,m/h))>p){l-=s;break}p=f}v.push(o={value:l,dice:c<u,children:y.slice(b,x)}),o.dice?eO(o,n,r,i,k?r+=u*l/k:a):mO(o,n,r,k?n+=c*l/k:i,a),k-=l,b=x}return v}const bO=function t(e){function n(t,n,r,i,a){yO(e,t,n,r,i,a)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(vO),xO=function t(e){function n(t,n,r,i,a){if((o=t._squarify)&&o.ratio===e)for(var o,s,c,u,l,h=-1,d=o.length,f=t.value;++h<d;){for(c=(s=o[h]).children,u=s.value=0,l=c.length;u<l;++u)s.value+=c[u].value;s.dice?eO(s,n,r,i,f?r+=(a-r)*s.value/f:a):mO(s,n,r,f?n+=(i-n)*s.value/f:i,a),f-=s.value}else t._squarify=o=yO(e,t,n,r,i,a),o.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(vO);function wO(t,e,n){const r={};return t.each((t=>{const i=t.data;n(i)&&(r[e(i)]=t)})),t.lookup=r,t}function kO(t){Ic.call(this,null,t)}kO.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const _O=t=>t.values;function AO(){const t=[],e={entries:t=>r(n(t,0),0),key:n=>(t.push(n),e)};function n(e,r){if(r>=t.length)return e;const i=e.length,a=t[r++],o={},s={};let c,u,l,h=-1;for(;++h<i;)c=a(u=e[h])+"",(l=o[c])?l.push(u):o[c]=[u];for(c in o)s[c]=n(o[c],r);return s}function r(e,n){if(++n>t.length)return e;const i=[];for(const t in e)i.push({key:t,values:r(e[t],n)});return i}return e}function CO(t){Ic.call(this,null,t)}jn(kO,Ic,{transform(t,e){e.source||qe("Nest transform requires an upstream data source.");var n=t.generate,r=t.modified(),i=e.clone(),a=this.value;return(!a||r||e.changed())&&(a&&a.each((t=>{t.children&&$s(t.data)&&i.rem.push(t.data)})),this.value=a=TM({values:An(t.keys).reduce(((t,e)=>(t.key(e),t)),AO()).entries(i.source)},_O),n&&a.each((t=>{t.children&&(t=ec(t.data),i.add.push(t),i.source.push(t))})),wO(a,Js,Js)),i.source.root=a,i}});const SO=(t,e)=>t.parent===e.parent?1:2;jn(CO,Ic,{transform(t,e){e.source&&e.source.root||qe(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(t.method),r=this.fields,i=e.source.root,a=t.as||r;t.field?i.sum(t.field):i.count(),t.sort&&i.sort(ac(t.sort,(t=>t.data))),function(t,e,n){for(let r,i=0,a=e.length;i<a;++i)r=e[i],r in n&&t[r](n[r])}(n,this.params,t),n.separation&&n.separation(!1!==t.separation?SO:Qe);try{this.value=n(i)}catch(o){qe(o)}return i.each((t=>function(t,e,n){const r=t.data,i=e.length-1;for(let a=0;a<i;++a)r[n[a]]=t[e[a]];r[n[i]]=t.children?t.children.length:0}(t,r,a))),e.reflow(t.modified()).modifies(a).modifies("leaf")}});const EO=["x","y","r","depth","children"];function TO(t){CO.call(this,t)}TO.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:EO.length,default:EO}]},jn(TO,CO,{layout:function(){var t=null,e=1,n=1,r=XM;function i(i){return i.x=e/2,i.y=n/2,t?i.eachBefore(ZM(t)).eachAfter($M(r,.5)).eachBefore(JM(1)):i.eachBefore(ZM(QM)).eachAfter($M(XM,1)).eachAfter($M(r,i.r/Math.min(e,n))).eachBefore(JM(Math.min(e,n)/(2*i.r))),i}return i.radius=function(e){return arguments.length?(t=null==(n=e)?null:YM(n),i):t;var n},i.size=function(t){return arguments.length?(e=+t[0],n=+t[1],i):[e,n]},i.padding=function(t){return arguments.length?(r="function"===typeof t?t:KM(+t),i):r},i},params:["radius","size","padding"],fields:EO});const NO=["x0","y0","x1","y1","depth","children"];function FO(t){CO.call(this,t)}function DO(t){Ic.call(this,null,t)}FO.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:NO.length,default:NO}]},jn(FO,CO,{layout:function(){var t=1,e=1,n=0,r=!1;function i(i){var a=i.height+1;return i.x0=i.y0=n,i.x1=t,i.y1=e/a,i.eachBefore(function(t,e){return function(r){r.children&&eO(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var i=r.x0,a=r.y0,o=r.x1-n,s=r.y1-n;o<i&&(i=o=(i+o)/2),s<a&&(a=s=(a+s)/2),r.x0=i,r.y0=a,r.x1=o,r.y1=s}}(e,a)),r&&i.eachBefore(tO),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(n){return arguments.length?(t=+n[0],e=+n[1],i):[t,e]},i.padding=function(t){return arguments.length?(n=+t,i):n},i},params:["size","round","padding"],fields:NO}),DO.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},jn(DO,Ic,{transform(t,e){e.source||qe("Stratify transform requires an upstream data source.");let n=this.value;const r=t.modified(),i=e.fork(e.ALL).materialize(e.SOURCE),a=!n||r||e.changed(e.ADD_REM)||e.modified(t.key.fields)||e.modified(t.parentKey.fields);return i.source=i.source.slice(),a&&(n=i.source.length?wO(oO().id(t.key).parentId(t.parentKey)(i.source),t.key,Ze):wO(oO()([{}]),t.key,t.key)),i.source.root=this.value=n,i}});const IO={tidy:function(){var t=sO,e=1,n=1,r=null;function i(i){var c=function(t){for(var e,n,r,i,a,o=new dO(t,0),s=[o];e=s.pop();)if(r=e._.children)for(e.children=new Array(a=r.length),i=a-1;i>=0;--i)s.push(n=e.children[i]=new dO(r[i],i)),n.parent=e;return(o.parent=new dO(null,0)).children=[o],o}(i);if(c.eachAfter(a),c.parent.m=-c.z,c.eachBefore(o),r)i.eachBefore(s);else{var u=i,l=i,h=i;i.eachBefore((function(t){t.x<u.x&&(u=t),t.x>l.x&&(l=t),t.depth>h.depth&&(h=t)}));var d=u===l?1:t(u,l)/2,f=d-u.x,p=e/(l.x+d+f),g=n/(h.depth||1);i.eachBefore((function(t){t.x=(t.x+f)*p,t.y=t.depth*g}))}return i}function a(e){var n=e.children,r=e.parent.children,i=e.i?r[e.i-1]:null;if(n){!function(t){for(var e,n=0,r=0,i=t.children,a=i.length;--a>=0;)(e=i[a]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(e);var a=(n[0].z+n[n.length-1].z)/2;i?(e.z=i.z+t(e._,i._),e.m=e.z-a):e.z=a}else i&&(e.z=i.z+t(e._,i._));e.parent.A=function(e,n,r){if(n){for(var i,a=e,o=e,s=n,c=a.parent.children[0],u=a.m,l=o.m,h=s.m,d=c.m;s=uO(s),a=cO(a),s&&a;)c=cO(c),(o=uO(o)).a=e,(i=s.z+h-a.z-u+t(s._,a._))>0&&(lO(hO(s,e,r),e,i),u+=i,l+=i),h+=s.m,u+=a.m,d+=c.m,l+=o.m;s&&!uO(o)&&(o.t=s,o.m+=h-l),a&&!cO(c)&&(c.t=a,c.m+=u-d,r=e)}return r}(e,i,e.parent.A||r[0])}function o(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function s(t){t.x*=e,t.y=t.depth*n}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i},cluster:function(){var t=fO,e=1,n=1,r=!1;function i(i){var a,o=0;i.eachAfter((function(e){var n=e.children;n?(e.x=function(t){return t.reduce(pO,0)/t.length}(n),e.y=function(t){return 1+t.reduce(gO,0)}(n)):(e.x=a?o+=t(e,a):0,e.y=0,a=e)}));var s=function(t){for(var e;e=t.children;)t=e[0];return t}(i),c=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(i),u=s.x-t(s,c)/2,l=c.x+t(c,s)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*e,t.y=(i.y-t.y)*n}:function(t){t.x=(t.x-u)/(l-u)*e,t.y=(1-(i.y?t.y/i.y:1))*n})}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i}},MO=["x","y","depth","children"];function OO(t){CO.call(this,t)}function RO(t){Ic.call(this,[],t)}OO.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:MO.length,default:MO}]},jn(OO,CO,{layout(t){const e=t||"tidy";if(Bn(IO,e))return IO[e]();qe("Unrecognized Tree layout method: "+e)},params:["size","nodeSize"],fields:MO}),RO.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},jn(RO,Ic,{transform(t,e){const n=this.value,r=e.source&&e.source.root,i=e.fork(e.NO_SOURCE),a={};return r||qe("TreeLinks transform requires a tree data source."),e.changed(e.ADD_REM)?(i.rem=n,e.visit(e.SOURCE,(t=>a[Js(t)]=1)),r.each((t=>{const e=t.data,n=t.parent&&t.parent.data;n&&a[Js(e)]&&a[Js(n)]&&i.add.push(ec({source:n,target:e}))})),this.value=i.add):e.changed(e.MOD)&&(e.visit(e.MOD,(t=>a[Js(t)]=1)),n.forEach((t=>{(a[Js(t.source)]||a[Js(t.target)])&&i.mod.push(t)}))),i}});const zO={binary:function(t,e,n,r,i){var a,o,s=t.children,c=s.length,u=new Array(c+1);for(u[0]=o=a=0;a<c;++a)u[a+1]=o+=s[a].value;!function t(e,n,r,i,a,o,c){if(e>=n-1){var l=s[e];return l.x0=i,l.y0=a,l.x1=o,void(l.y1=c)}var h=u[e],d=r/2+h,f=e+1,p=n-1;for(;f<p;){var g=f+p>>>1;u[g]<d?f=g+1:p=g}d-u[f-1]<u[f]-d&&e+1<f&&--f;var m=u[f]-h,v=r-m;if(o-i>c-a){var y=r?(i*v+o*m)/r:o;t(e,f,m,i,a,y,c),t(f,n,v,y,a,o,c)}else{var b=r?(a*v+c*m)/r:c;t(e,f,m,i,a,o,b),t(f,n,v,i,b,o,c)}}(0,c,t.value,e,n,r,i)},dice:eO,slice:mO,slicedice:function(t,e,n,r,i){(1&t.depth?mO:eO)(t,e,n,r,i)},squarify:bO,resquarify:xO},BO=["x0","y0","x1","y1","depth","children"];function LO(t){CO.call(this,t)}LO.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:BO.length,default:BO}]},jn(LO,CO,{layout(){const t=function(){var t=bO,e=!1,n=1,r=1,i=[0],a=XM,o=XM,s=XM,c=XM,u=XM;function l(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(h),i=[0],e&&t.eachBefore(tO),t}function h(e){var n=i[e.depth],r=e.x0+n,l=e.y0+n,h=e.x1-n,d=e.y1-n;h<r&&(r=h=(r+h)/2),d<l&&(l=d=(l+d)/2),e.x0=r,e.y0=l,e.x1=h,e.y1=d,e.children&&(n=i[e.depth+1]=a(e)/2,r+=u(e)-n,l+=o(e)-n,(h-=s(e)-n)<r&&(r=h=(r+h)/2),(d-=c(e)-n)<l&&(l=d=(l+d)/2),t(e,r,l,h,d))}return l.round=function(t){return arguments.length?(e=!!t,l):e},l.size=function(t){return arguments.length?(n=+t[0],r=+t[1],l):[n,r]},l.tile=function(e){return arguments.length?(t=YM(e),l):t},l.padding=function(t){return arguments.length?l.paddingInner(t).paddingOuter(t):l.paddingInner()},l.paddingInner=function(t){return arguments.length?(a="function"===typeof t?t:KM(+t),l):a},l.paddingOuter=function(t){return arguments.length?l.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):l.paddingTop()},l.paddingTop=function(t){return arguments.length?(o="function"===typeof t?t:KM(+t),l):o},l.paddingRight=function(t){return arguments.length?(s="function"===typeof t?t:KM(+t),l):s},l.paddingBottom=function(t){return arguments.length?(c="function"===typeof t?t:KM(+t),l):c},l.paddingLeft=function(t){return arguments.length?(u="function"===typeof t?t:KM(+t),l):u},l}();return t.ratio=e=>{const n=t.tile();n.ratio&&t.tile(n.ratio(e))},t.method=e=>{Bn(zO,e)?t.tile(zO[e]):qe("Unrecognized Treemap layout method: "+e)},t},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:BO});const PO=4278190080,jO=268435456,UO=.0625;function WO(t,e,n,r){const i=t.width,a=t.height,o=n||r,s=Zd(i,a).getContext("2d");e.forEach((t=>VO(s,t,o)));const c=new Uint32Array(s.getImageData(0,0,i,a).data.buffer),u=t.bitmap(),l=o&&t.bitmap();let h,d,f,p,g;for(d=0;d<a;++d)for(h=0;h<i;++h)g=c[d*i+h]&PO,g&&(f=t(h),p=t(d),r||u.set(f,p),o&&g^jO&&l.set(f,p));return[u,l]}function VO(t,e,n){if(!e.length)return;const r=e[0].mark.marktype;"group"===r?e.forEach((e=>{e.items.forEach((e=>VO(t,e.items,n)))})):Jw[r].draw(t,{items:n?e.map(qO):e})}function qO(t){const e=rc(t,{});return e.stroke&&(e.strokeOpacity=1),e.fill&&(e.fillOpacity=UO,e.stroke="#000",e.strokeOpacity=1,e.strokeWidth=2),e}const GO=5,HO=31,YO=32,XO=new Uint32Array(YO+1),KO=new Uint32Array(YO+1);KO[0]=0,XO[0]=~KO[0];for(let Set=1;Set<=YO;++Set)KO[Set]=KO[Set-1]<<1|1,XO[Set]=~KO[Set];function QO(t,e,n){const r=Math.max(1,Math.sqrt(t*e/1e6)),i=~~((t+2*n+r)/r),a=~~((e+2*n+r)/r),o=t=>~~((t+n)/r);return o.invert=t=>t*r-n,o.bitmap=()=>function(t,e){const n=new Uint32Array(~~((t*e+YO)/YO));function r(t,e){n[t]|=e}function i(t,e){n[t]&=e}return{array:n,get:(e,r)=>{const i=r*t+e;return n[i>>>GO]&1<<(i&HO)},set:(e,n)=>{const i=n*t+e;r(i>>>GO,1<<(i&HO))},clear:(e,n)=>{const r=n*t+e;i(r>>>GO,~(1<<(r&HO)))},getRange:(e,r,i,a)=>{let o,s,c,u,l=a;for(;l>=r;--l)if(o=l*t+e,s=l*t+i,c=o>>>GO,u=s>>>GO,c===u){if(n[c]&XO[o&HO]&KO[1+(s&HO)])return!0}else{if(n[c]&XO[o&HO])return!0;if(n[u]&KO[1+(s&HO)])return!0;for(let t=c+1;t<u;++t)if(n[t])return!0}return!1},setRange:(e,n,i,a)=>{let o,s,c,u,l;for(;n<=a;++n)if(o=n*t+e,s=n*t+i,c=o>>>GO,u=s>>>GO,c===u)r(c,XO[o&HO]&KO[1+(s&HO)]);else for(r(c,XO[o&HO]),r(u,KO[1+(s&HO)]),l=c+1;l<u;++l)r(l,4294967295)},clearRange:(e,n,r,a)=>{let o,s,c,u,l;for(;n<=a;++n)if(o=n*t+e,s=n*t+r,c=o>>>GO,u=s>>>GO,c===u)i(c,KO[o&HO]|XO[1+(s&HO)]);else for(i(c,KO[o&HO]),i(u,XO[1+(s&HO)]),l=c+1;l<u;++l)i(l,0)},outOfBounds:(n,r,i,a)=>n<0||r<0||a>=e||i>=t}}(i,a),o.ratio=r,o.padding=n,o.width=t,o.height=e,o}function ZO(t,e,n,r,i,a){let o=n/2;return t-o<0||t+o>i||e-(o=r/2)<0||e+o>a}function $O(t,e,n,r,i,a,o,s){const c=i*a/(2*r),u=t(e-c),l=t(e+c),h=t(n-(a/=2)),d=t(n+a);return o.outOfBounds(u,h,l,d)||o.getRange(u,h,l,d)||s&&s.getRange(u,h,l,d)}const JO=[-1,-1,1,1],tR=[-1,1,-1,1];const eR=["right","center","left"],nR=["bottom","middle","top"];function rR(t,e,n,r,i,a,o,s,c,u,l,h){return!(i.outOfBounds(t,n,e,r)||(h&&a?a.getRange(t,n,e,r)||!function(t,e,n,r,i){return i[0]<=t&&n<=i[2]&&i[3]<=e&&r<=i[5]}(o,c,s,u,l):i.getRange(t,n,e,r)))}const iR={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},aR={naive:function(t,e,n,r){const i=t.width,a=t.height;return function(t){const e=t.datum.datum.items[r].items,n=e.length,o=t.datum.fontSize,s=Mw.width(t.datum,t.datum.text);let c,u,l,h,d,f,p,g=0;for(let r=0;r<n;++r)c=e[r].x,l=e[r].y,u=void 0===e[r].x2?c:e[r].x2,h=void 0===e[r].y2?l:e[r].y2,d=(c+u)/2,f=(l+h)/2,p=Math.abs(u-c+h-l),p>=g&&(g=p,t.x=d,t.y=f);return d=s/2,f=o/2,c=t.x-d,u=t.x+d,l=t.y-f,h=t.y+f,t.align="center",c<0&&u<=i?t.align="left":0<=c&&i<u&&(t.align="right"),t.baseline="middle",l<0&&h<=a?t.baseline="top":0<=l&&a<h&&(t.baseline="bottom"),!0}},"reduced-search":function(t,e,n,r){const i=t.width,a=t.height,o=e[0],s=e[1];function c(e,n,r,c,u){const l=t.invert(e),h=t.invert(n);let d,f=r,p=a;if(!ZO(l,h,c,u,i,a)&&!$O(t,l,h,u,c,f,o,s)&&!$O(t,l,h,u,c,u,o,null)){for(;p-f>=1;)d=(f+p)/2,$O(t,l,h,u,c,d,o,s)?p=d:f=d;if(f>r)return[l,h,f,!0]}}return function(e){const s=e.datum.datum.items[r].items,u=s.length,l=e.datum.fontSize,h=Mw.width(e.datum,e.datum.text);let d,f,p,g,m,v,y,b,x,w,k,_,A,C,S,E,T,N=n?l:0,F=!1,D=!1,I=0;for(let r=0;r<u;++r){for(d=s[r].x,p=s[r].y,f=void 0===s[r].x2?d:s[r].x2,g=void 0===s[r].y2?p:s[r].y2,d>f&&(T=d,d=f,f=T),p>g&&(T=p,p=g,g=T),x=t(d),k=t(f),w=~~((x+k)/2),_=t(p),C=t(g),A=~~((_+C)/2),y=w;y>=x;--y)for(b=A;b>=_;--b)E=c(y,b,N,h,l),E&&([e.x,e.y,N,F]=E);for(y=w;y<=k;++y)for(b=A;b<=C;++b)E=c(y,b,N,h,l),E&&([e.x,e.y,N,F]=E);F||n||(S=Math.abs(f-d+g-p),m=(d+f)/2,v=(p+g)/2,S>=I&&!ZO(m,v,h,l,i,a)&&!$O(t,m,v,l,h,l,o,null)&&(I=S,e.x=m,e.y=v,D=!0))}return!(!F&&!D)&&(m=h/2,v=l/2,o.setRange(t(e.x-m),t(e.y-v),t(e.x+m),t(e.y+v)),e.align="center",e.baseline="middle",!0)}},floodfill:function(t,e,n,r){const i=t.width,a=t.height,o=e[0],s=e[1],c=t.bitmap();return function(e){const u=e.datum.datum.items[r].items,l=u.length,h=e.datum.fontSize,d=Mw.width(e.datum,e.datum.text),f=[];let p,g,m,v,y,b,x,w,k,_,A,C,S=n?h:0,E=!1,T=!1,N=0;for(let r=0;r<l;++r){for(p=u[r].x,m=u[r].y,g=void 0===u[r].x2?p:u[r].x2,v=void 0===u[r].y2?m:u[r].y2,f.push([t((p+g)/2),t((m+v)/2)]);f.length;)if([x,w]=f.pop(),!(o.get(x,w)||s.get(x,w)||c.get(x,w))){c.set(x,w);for(let t=0;t<4;++t)y=x+JO[t],b=w+tR[t],c.outOfBounds(y,b,y,b)||f.push([y,b]);if(y=t.invert(x),b=t.invert(w),k=S,_=a,!ZO(y,b,d,h,i,a)&&!$O(t,y,b,h,d,k,o,s)&&!$O(t,y,b,h,d,h,o,null)){for(;_-k>=1;)A=(k+_)/2,$O(t,y,b,h,d,A,o,s)?_=A:k=A;k>S&&(e.x=y,e.y=b,S=k,E=!0)}}E||n||(C=Math.abs(g-p+v-m),y=(p+g)/2,b=(m+v)/2,C>=N&&!ZO(y,b,d,h,i,a)&&!$O(t,y,b,h,d,h,o,null)&&(N=C,e.x=y,e.y=b,T=!0))}return!(!E&&!T)&&(y=d/2,b=h/2,o.setRange(t(e.x-y),t(e.y-b),t(e.x+y),t(e.y+b)),e.align="center",e.baseline="middle",!0)}}};function oR(t,e,n,r,i,a,o,s,c,u,l){if(!t.length)return t;const h=Math.max(r.length,i.length),d=function(t,e){const n=new Float64Array(e),r=t.length;for(let i=0;i<r;++i)n[i]=t[i]||0;for(let i=r;i<e;++i)n[i]=n[r-1];return n}(r,h),f=function(t,e){const n=new Int8Array(e),r=t.length;for(let i=0;i<r;++i)n[i]|=iR[t[i]];for(let i=r;i<e;++i)n[i]=n[r-1];return n}(i,h),p=(x=t[0].datum)&&x.mark&&x.mark.marktype,g="group"===p&&t[0].datum.items[c].marktype,m="area"===g,v=function(t,e,n,r){const i=t=>[t.x,t.x,t.x,t.y,t.y,t.y];return t?"line"===t||"area"===t?t=>i(t.datum):"line"===e?t=>{const e=t.datum.items[r].items;return i(e.length?e["start"===n?0:e.length-1]:{x:NaN,y:NaN})}:t=>{const e=t.datum.bounds;return[e.x1,(e.x1+e.x2)/2,e.x2,e.y1,(e.y1+e.y2)/2,e.y2]}:i}(p,g,s,c),y=QO(e[0],e[1],u),b=m&&"naive"===l;var x;const w=t.map((t=>({datum:t,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:v(t)})));let k;if(!b){n&&w.sort(((t,e)=>n(t.datum,e.datum)));let e=!1;for(let t=0;t<f.length&&!e;++t)e=5===f[t]||d[t]<0;p&&(o||m)&&(a=[t.map((t=>t.datum))].concat(a)),k=a.length?WO(y,a,e,m):function(t,e){const n=t.bitmap();return(e||[]).forEach((e=>n.set(t(e.boundary[0]),t(e.boundary[3])))),[n,void 0]}(y,o&&w)}const _=m?aR[l](y,k,o,c):function(t,e,n,r){const i=t.width,a=t.height,o=e[0],s=e[1],c=r.length;return function(e){const u=e.boundary,l=e.datum.fontSize;if(u[2]<0||u[5]<0||u[0]>i||u[3]>a)return!1;let h,d,f,p,g,m,v,y,b,x,w,k,_,A,C,S=0;for(let i=0;i<c;++i){if(h=(3&n[i])-1,d=(n[i]>>>2&3)-1,f=0===h&&0===d||r[i]<0,p=h&&d?Math.SQRT1_2:1,g=r[i]<0?-1:1,m=u[1+h]+r[i]*h*p,w=u[4+d]+g*l*d/2+r[i]*d*p,y=w-l/2,b=w+l/2,k=t(m),A=t(y),C=t(b),!S){if(!rR(k,k,A,C,o,s,m,m,y,b,u,f))continue;S=Mw.width(e.datum,e.datum.text)}if(x=m+g*S*h/2,m=x-S/2,v=x+S/2,k=t(m),_=t(v),rR(k,_,A,C,o,s,m,v,y,b,u,f))return e.x=h?h*g<0?v:m:x,e.y=d?d*g<0?b:y:w,e.align=eR[h*g+1],e.baseline=nR[d*g+1],o.setRange(k,A,_,C),!0}return!1}}(y,k,f,d);return w.forEach((t=>t.opacity=+_(t))),w}const sR=["x","y","opacity","align","baseline"],cR=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function uR(t){Ic.call(this,null,t)}function lR(t,e){var n,r,i,a,o,s,c=[],u=function(t){return t(a)};if(null==e)c.push(t);else for(n={},r=0,i=t.length;r<i;++r)a=t[r],(s=n[o=e.map(u)])||(n[o]=s=[],s.dims=o,c.push(s)),s.push(a);return c}function hR(t){Ic.call(this,null,t)}uR.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:cR},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:sR.length,default:sR}]},jn(uR,Ic,{transform(t,e){const n=t.modified();if(!(n||e.changed(e.ADD_REM)||function(n){const r=t[n];return Cn(r)&&e.modified(r.fields)}("sort")))return;t.size&&2===t.size.length||qe("Size parameter should be specified as a [width, height] array.");const r=t.as||sR;return oR(e.materialize(e.SOURCE).source,t.size,t.sort,An(t.offset||1),An(t.anchor||cR),t.avoidMarks||[],!1!==t.avoidBaseMark,t.lineAnchor||"end",t.markIndex||0,t.padding||0,t.method||"naive").forEach((t=>{const e=t.datum;e[r[0]]=t.x,e[r[1]]=t.y,e[r[2]]=t.opacity,e[r[3]]=t.align,e[r[4]]=t.baseline})),e.reflow(n).modifies(r)}}),hR.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},jn(hR,Ic,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=lR(e.materialize(e.SOURCE).source,t.groupby),i=(t.groupby||[]).map(Pe),a=i.length,o=t.as||[Pe(t.x),Pe(t.y)],s=[];r.forEach((e=>{(function(t,e,n,r){const[i,a,o,s]=mu(t,e,n,!0),c=i.length,u=Math.max(2,~~(r*c)),l=new Float64Array(c),h=new Float64Array(c),d=new Float64Array(c).fill(1);for(let f=-1;++f<=2;){const t=[0,u-1];for(let n=0;n<c;++n){const e=i[n],r=t[0],o=t[1],s=e-i[r]>i[o]-e?r:o;let c=0,u=0,f=0,p=0,g=0;const m=1/Math.abs(i[s]-e||1);for(let t=r;t<=o;++t){const n=i[t],r=a[t],o=ku(Math.abs(e-n)*m)*d[t],s=n*o;c+=o,u+=s,f+=r*o,p+=r*s,g+=n*s}const[v,y]=gu(u/c,f/c,p/c,g/c);l[n]=v+y*e,h[n]=Math.abs(a[n]-l[n]),_u(i,n+1,t)}if(2===f)break;const e=Gc(h);if(Math.abs(e)<1e-12)break;for(let n,r,i=0;i<c;++i)n=h[i]/(6*e),d[i]=n>=1?1e-12:(r=1-n*n)*r}return function(t,e,n,r){const i=t.length,a=[];let o,s=0,c=0,u=[];for(;s<i;++s)o=t[s]+n,u[0]===o?u[1]+=(e[s]-u[1])/++c:(c=0,u[1]+=r,u=[o,e[s]],a.push(u));return u[1]+=r,a}(i,l,o,s)})(e,t.x,t.y,t.bandwidth||.3).forEach((t=>{const n={};for(let r=0;r<a;++r)n[i[r]]=e.dims[r];n[o[0]]=t[0],n[o[1]]=t[1],s.push(ec(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=s}return n}});const dR={linear:bu,log:function(t,e,n){let r=0,i=0,a=0,o=0,s=0;vu(t,e,n,((t,e)=>{++s,t=Math.log(t),r+=(t-r)/s,i+=(e-i)/s,a+=(t*e-a)/s,o+=(t*t-o)/s}));const c=gu(r,i,a,o),u=t=>c[0]+c[1]*Math.log(t);return{coef:c,predict:u,rSquared:yu(t,e,n,i,u)}},exp:function(t,e,n){const[r,i,a,o]=mu(t,e,n);let s,c,u,l=0,h=0,d=0,f=0,p=0;vu(t,e,n,((t,e)=>{s=r[p++],c=Math.log(e),u=s*e,l+=(e*c-l)/p,h+=(u-h)/p,d+=(u*c-d)/p,f+=(s*u-f)/p}));const[g,m]=gu(h/o,l/o,d/o,f/o),v=t=>Math.exp(g+m*(t-a));return{coef:[Math.exp(g-m*a),m],predict:v,rSquared:yu(t,e,n,o,v)}},pow:function(t,e,n){let r=0,i=0,a=0,o=0,s=0,c=0;vu(t,e,n,((t,e)=>{const n=Math.log(t),u=Math.log(e);++c,r+=(n-r)/c,i+=(u-i)/c,a+=(n*u-a)/c,o+=(n*n-o)/c,s+=(e-s)/c}));const u=gu(r,i,a,o),l=t=>u[0]*Math.pow(t,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:l,rSquared:yu(t,e,n,s,l)}},quad:xu,poly:function(t,e,n,r){if(0===r)return function(t,e,n){let r=0,i=0;for(const a of t){const t=n(a);null==e(a)||null==t||isNaN(t)||(r+=(t-r)/++i)}return{coef:[r],predict:()=>r,rSquared:0}}(t,e,n);if(1===r)return bu(t,e,n);if(2===r)return xu(t,e,n);const[i,a,o,s]=mu(t,e,n),c=i.length,u=[],l=[],h=r+1;let d,f,p,g,m;for(d=0;d<h;++d){for(p=0,g=0;p<c;++p)g+=Math.pow(i[p],d)*a[p];for(u.push(g),m=new Float64Array(h),f=0;f<h;++f){for(p=0,g=0;p<c;++p)g+=Math.pow(i[p],d+f);m[f]=g}l.push(m)}l.push(u);const v=function(t){const e=t.length-1,n=[];let r,i,a,o,s;for(r=0;r<e;++r){for(o=r,i=r+1;i<e;++i)Math.abs(t[r][i])>Math.abs(t[r][o])&&(o=i);for(a=r;a<e+1;++a)s=t[a][r],t[a][r]=t[a][o],t[a][o]=s;for(i=r+1;i<e;++i)for(a=e;a>=r;a--)t[a][i]-=t[a][r]*t[r][i]/t[r][r]}for(i=e-1;i>=0;--i){for(s=0,a=i+1;a<e;++a)s+=t[a][i]*n[a];n[i]=(t[e][i]-s)/t[i][i]}return n}(l),y=t=>{t-=o;let e=s+v[0]+v[1]*t+v[2]*t*t;for(d=3;d<h;++d)e+=v[d]*Math.pow(t,d);return e};return{coef:wu(h,v,-o,s),predict:y,rSquared:yu(t,e,n,s,y)}}};function fR(t){Ic.call(this,null,t)}fR.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(dR)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},jn(fR,Ic,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=lR(e.materialize(e.SOURCE).source,t.groupby),i=(t.groupby||[]).map(Pe),a=t.method||"linear",o=t.order||3,s=((t,e)=>"poly"===t?e:"quad"===t?2:1)(a,o),c=t.as||[Pe(t.x),Pe(t.y)],u=dR[a],l=[];let h=t.extent;Bn(dR,a)||qe("Invalid regression method: "+a),null!=h&&"log"===a&&h[0]<=0&&(e.dataflow.warn("Ignoring extent with values <= 0 for log regression."),h=null),r.forEach((n=>{if(n.length<=s)return void e.dataflow.warn("Skipping regression with more parameters than data points.");const r=u(n,t.x,t.y,o);if(t.params)return void l.push(ec({keys:n.dims,coef:r.coef,rSquared:r.rSquared}));const d=h||Rn(n,t.x),f=t=>{const e={};for(let r=0;r<i.length;++r)e[i[r]]=n.dims[r];e[c[0]]=t[0],e[c[1]]=t[1],l.push(ec(e))};"linear"===a?d.forEach((t=>f([t,r.predict(t)]))):Cu(r.predict,d,25,200).forEach(f)})),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});const pR=Math.pow(2,-52),gR=new Uint32Array(512);class mR{static from(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:AR,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:CR;const r=t.length,i=new Float64Array(2*r);for(let a=0;a<r;a++){const r=t[a];i[2*a]=e(r),i[2*a+1]=n(r)}return new mR(i)}constructor(t){const e=t.length>>1;if(e>0&&"number"!==typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:n,_hullTri:r,_hullHash:i}=this,a=t.length>>1;let o=1/0,s=1/0,c=-1/0,u=-1/0;for(let C=0;C<a;C++){const e=t[2*C],n=t[2*C+1];e<o&&(o=e),n<s&&(s=n),e>c&&(c=e),n>u&&(u=n),this._ids[C]=C}const l=(o+c)/2,h=(s+u)/2;let d,f,p,g=1/0;for(let C=0;C<a;C++){const e=vR(l,h,t[2*C],t[2*C+1]);e<g&&(d=C,g=e)}const m=t[2*d],v=t[2*d+1];g=1/0;for(let C=0;C<a;C++){if(C===d)continue;const e=vR(m,v,t[2*C],t[2*C+1]);e<g&&e>0&&(f=C,g=e)}let y=t[2*f],b=t[2*f+1],x=1/0;for(let C=0;C<a;C++){if(C===d||C===f)continue;const e=wR(m,v,y,b,t[2*C],t[2*C+1]);e<x&&(p=C,x=e)}let w=t[2*p],k=t[2*p+1];if(x===1/0){for(let r=0;r<a;r++)this._dists[r]=t[2*r]-t[0]||t[2*r+1]-t[1];kR(this._ids,this._dists,0,a-1);const e=new Uint32Array(a);let n=0;for(let t=0,r=-1/0;t<a;t++){const i=this._ids[t];this._dists[i]>r&&(e[n++]=i,r=this._dists[i])}return this.hull=e.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(bR(m,v,y,b,w,k)){const t=f,e=y,n=b;f=p,y=w,b=k,p=t,w=e,k=n}const _=function(t,e,n,r,i,a){const o=n-t,s=r-e,c=i-t,u=a-e,l=o*o+s*s,h=c*c+u*u,d=.5/(o*u-s*c),f=t+(u*l-s*h)*d,p=e+(o*h-c*l)*d;return{x:f,y:p}}(m,v,y,b,w,k);this._cx=_.x,this._cy=_.y;for(let C=0;C<a;C++)this._dists[C]=vR(t[2*C],t[2*C+1],_.x,_.y);kR(this._ids,this._dists,0,a-1),this._hullStart=d;let A=3;n[d]=e[p]=f,n[f]=e[d]=p,n[p]=e[f]=d,r[d]=0,r[f]=1,r[p]=2,i.fill(-1),i[this._hashKey(m,v)]=d,i[this._hashKey(y,b)]=f,i[this._hashKey(w,k)]=p,this.trianglesLen=0,this._addTriangle(d,f,p,-1,-1,-1);for(let C,S,E=0;E<this._ids.length;E++){const a=this._ids[E],o=t[2*a],s=t[2*a+1];if(E>0&&Math.abs(o-C)<=pR&&Math.abs(s-S)<=pR)continue;if(C=o,S=s,a===d||a===f||a===p)continue;let c=0;for(let t=0,e=this._hashKey(o,s);t<this._hashSize&&(c=i[(e+t)%this._hashSize],-1===c||c===n[c]);t++);c=e[c];let u,l=c;for(;u=n[l],!bR(o,s,t[2*l],t[2*l+1],t[2*u],t[2*u+1]);)if(l=u,l===c){l=-1;break}if(-1===l)continue;let h=this._addTriangle(l,a,n[l],-1,-1,r[l]);r[a]=this._legalize(h+2),r[l]=h,A++;let g=n[l];for(;u=n[g],bR(o,s,t[2*g],t[2*g+1],t[2*u],t[2*u+1]);)h=this._addTriangle(g,a,u,r[a],-1,r[g]),r[a]=this._legalize(h+2),n[g]=g,A--,g=u;if(l===c)for(;u=e[l],bR(o,s,t[2*u],t[2*u+1],t[2*l],t[2*l+1]);)h=this._addTriangle(u,a,l,-1,r[l],r[u]),this._legalize(h+2),r[u]=h,n[l]=l,A--,l=u;this._hullStart=e[a]=l,n[l]=e[g]=a,n[a]=g,i[this._hashKey(o,s)]=a,i[this._hashKey(t[2*l],t[2*l+1])]=l}this.hull=new Uint32Array(A);for(let C=0,S=this._hullStart;C<A;C++)this.hull[C]=S,S=n[S];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(function(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:n,coords:r}=this;let i=0,a=0;for(;;){const o=n[t],s=t-t%3;if(a=s+(t+2)%3,-1===o){if(0===i)break;t=gR[--i];continue}const c=o-o%3,u=s+(t+1)%3,l=c+(o+2)%3,h=e[a],d=e[t],f=e[u],p=e[l];if(xR(r[2*h],r[2*h+1],r[2*d],r[2*d+1],r[2*f],r[2*f+1],r[2*p],r[2*p+1])){e[t]=p,e[o]=h;const r=n[l];if(-1===r){let e=this._hullStart;do{if(this._hullTri[e]===l){this._hullTri[e]=t;break}e=this._hullPrev[e]}while(e!==this._hullStart)}this._link(t,r),this._link(o,n[a]),this._link(a,l);const s=c+(o+1)%3;i<gR.length&&(gR[i++]=s)}else{if(0===i)break;t=gR[--i]}}return a}_link(t,e){this._halfedges[t]=e,-1!==e&&(this._halfedges[e]=t)}_addTriangle(t,e,n,r,i,a){const o=this.trianglesLen;return this._triangles[o]=t,this._triangles[o+1]=e,this._triangles[o+2]=n,this._link(o,r),this._link(o+1,i),this._link(o+2,a),this.trianglesLen+=3,o}}function vR(t,e,n,r){const i=t-n,a=e-r;return i*i+a*a}function yR(t,e,n,r,i,a){const o=(r-e)*(i-t),s=(n-t)*(a-e);return Math.abs(o-s)>=33306690738754716e-32*Math.abs(o+s)?o-s:0}function bR(t,e,n,r,i,a){return(yR(i,a,t,e,n,r)||yR(t,e,n,r,i,a)||yR(n,r,i,a,t,e))<0}function xR(t,e,n,r,i,a,o,s){const c=t-o,u=e-s,l=n-o,h=r-s,d=i-o,f=a-s,p=l*l+h*h,g=d*d+f*f;return c*(h*g-p*f)-u*(l*g-p*d)+(c*c+u*u)*(l*f-h*d)<0}function wR(t,e,n,r,i,a){const o=n-t,s=r-e,c=i-t,u=a-e,l=o*o+s*s,h=c*c+u*u,d=.5/(o*u-s*c),f=(u*l-s*h)*d,p=(o*h-c*l)*d;return f*f+p*p}function kR(t,e,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const r=t[i],a=e[r];let o=i-1;for(;o>=n&&e[t[o]]>a;)t[o+1]=t[o--];t[o+1]=r}else{let i=n+1,a=r;_R(t,n+r>>1,i),e[t[n]]>e[t[r]]&&_R(t,n,r),e[t[i]]>e[t[r]]&&_R(t,i,r),e[t[n]]>e[t[i]]&&_R(t,n,i);const o=t[i],s=e[o];for(;;){do{i++}while(e[t[i]]<s);do{a--}while(e[t[a]]>s);if(a<i)break;_R(t,i,a)}t[n+1]=t[a],t[a]=o,r-i+1>=a-n?(kR(t,e,i,r),kR(t,e,n,a-1)):(kR(t,e,n,a-1),kR(t,e,i,r))}}function _R(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function AR(t){return t[0]}function CR(t){return t[1]}const SR=1e-6;class ER{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,e){this._+="M".concat(this._x0=this._x1=+t,",").concat(this._y0=this._y1=+e)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,e){this._+="L".concat(this._x1=+t,",").concat(this._y1=+e)}arc(t,e,n){const r=(t=+t)+(n=+n),i=e=+e;if(n<0)throw new Error("negative radius");null===this._x1?this._+="M".concat(r,",").concat(i):(Math.abs(this._x1-r)>SR||Math.abs(this._y1-i)>SR)&&(this._+="L"+r+","+i),n&&(this._+="A".concat(n,",").concat(n,",0,1,1,").concat(t-n,",").concat(e,"A").concat(n,",").concat(n,",0,1,1,").concat(this._x1=r,",").concat(this._y1=i))}rect(t,e,n,r){this._+="M".concat(this._x0=this._x1=+t,",").concat(this._y0=this._y1=+e,"h").concat(+n,"v").concat(+r,"h").concat(-n,"Z")}value(){return this._||null}}class TR{constructor(){this._=[]}moveTo(t,e){this._.push([t,e])}closePath(){this._.push(this._[0].slice())}lineTo(t,e){this._.push([t,e])}value(){return this._.length?this._:null}}class NR{constructor(t){let[e,n,r,i]=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,960,500];if(!((r=+r)>=(e=+e))||!((i=+i)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=r,this.xmin=e,this.ymax=i,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:e,triangles:n},vectors:r}=this,i=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let d,f,p=0,g=0,m=n.length;p<m;p+=3,g+=2){const e=2*n[p],r=2*n[p+1],a=2*n[p+2],o=t[e],s=t[e+1],c=t[r],u=t[r+1],l=t[a],h=t[a+1],m=c-o,v=u-s,y=l-o,b=h-s,x=m*m+v*v,w=y*y+b*b,k=2*(m*b-v*y);if(k)if(Math.abs(k)<1e-8)d=(o+l)/2,f=(s+h)/2;else{const t=1/k;d=o+(b*x-v*w)*t,f=s+(m*w-y*x)*t}else d=(o+l)/2-1e8*b,f=(s+h)/2+1e8*y;i[g]=d,i[g+1]=f}let a,o,s,c=e[e.length-1],u=4*c,l=t[2*c],h=t[2*c+1];r.fill(0);for(let d=0;d<e.length;++d)c=e[d],a=u,o=l,s=h,u=4*c,l=t[2*c],h=t[2*c+1],r[a+2]=r[u]=s-h,r[a+3]=r[u+1]=l-o}render(t){const e=null==t?t=new ER:void 0,{delaunay:{halfedges:n,inedges:r,hull:i},circumcenters:a,vectors:o}=this;if(i.length<=1)return null;for(let u=0,l=n.length;u<l;++u){const e=n[u];if(e<u)continue;const r=2*Math.floor(u/3),i=2*Math.floor(e/3),o=a[r],s=a[r+1],c=a[i],l=a[i+1];this._renderSegment(o,s,c,l,t)}let s,c=i[i.length-1];for(let u=0;u<i.length;++u){s=c,c=i[u];const e=2*Math.floor(r[c]/3),n=a[e],l=a[e+1],h=4*s,d=this._project(n,l,o[h+2],o[h+3]);d&&this._renderSegment(n,l,d[0],d[1],t)}return e&&e.value()}renderBounds(t){const e=null==t?t=new ER:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),e&&e.value()}renderCell(t,e){const n=null==e?e=new ER:void 0,r=this._clip(t);if(null===r||!r.length)return;e.moveTo(r[0],r[1]);let i=r.length;for(;r[0]===r[i-2]&&r[1]===r[i-1]&&i>1;)i-=2;for(let a=2;a<i;a+=2)r[a]===r[a-2]&&r[a+1]===r[a-1]||e.lineTo(r[a],r[a+1]);return e.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let e=0,n=t.length/2;e<n;++e){const t=this.cellPolygon(e);t&&(t.index=e,yield t)}}cellPolygon(t){const e=new TR;return this.renderCell(t,e),e.value()}_renderSegment(t,e,n,r,i){let a;const o=this._regioncode(t,e),s=this._regioncode(n,r);0===o&&0===s?(i.moveTo(t,e),i.lineTo(n,r)):(a=this._clipSegment(t,e,n,r,o,s))&&(i.moveTo(a[0],a[1]),i.lineTo(a[2],a[3]))}contains(t,e,n){return(e=+e)===e&&(n=+n)===n&&this.delaunay._step(t,e,n)===t}*neighbors(t){const e=this._clip(t);if(e)for(const n of this.delaunay.neighbors(t)){const t=this._clip(n);if(t)t:for(let r=0,i=e.length;r<i;r+=2)for(let a=0,o=t.length;a<o;a+=2)if(e[r]==t[a]&&e[r+1]==t[a+1]&&e[(r+2)%i]==t[(a+o-2)%o]&&e[(r+3)%i]==t[(a+o-1)%o]){yield n;break t}}}_cell(t){const{circumcenters:e,delaunay:{inedges:n,halfedges:r,triangles:i}}=this,a=n[t];if(-1===a)return null;const o=[];let s=a;do{const n=Math.floor(s/3);if(o.push(e[2*n],e[2*n+1]),s=s%3===2?s-2:s+1,i[s]!==t)break;s=r[s]}while(s!==a&&-1!==s);return o}_clip(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const e=this._cell(t);if(null===e)return null;const{vectors:n}=this,r=4*t;return n[r]||n[r+1]?this._clipInfinite(t,e,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(t,e)}_clipFinite(t,e){const n=e.length;let r,i,a,o,s,c=null,u=e[n-2],l=e[n-1],h=this._regioncode(u,l);for(let d=0;d<n;d+=2)if(r=u,i=l,u=e[d],l=e[d+1],a=h,h=this._regioncode(u,l),0===a&&0===h)o=s,s=0,c?c.push(u,l):c=[u,l];else{let e,n,d,f,p;if(0===a){if(null===(e=this._clipSegment(r,i,u,l,a,h)))continue;[n,d,f,p]=e}else{if(null===(e=this._clipSegment(u,l,r,i,h,a)))continue;[f,p,n,d]=e,o=s,s=this._edgecode(n,d),o&&s&&this._edge(t,o,s,c,c.length),c?c.push(n,d):c=[n,d]}o=s,s=this._edgecode(f,p),o&&s&&this._edge(t,o,s,c,c.length),c?c.push(f,p):c=[f,p]}if(c)o=s,s=this._edgecode(c[0],c[1]),o&&s&&this._edge(t,o,s,c,c.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return c}_clipSegment(t,e,n,r,i,a){for(;;){if(0===i&&0===a)return[t,e,n,r];if(i&a)return null;let o,s,c=i||a;8&c?(o=t+(n-t)*(this.ymax-e)/(r-e),s=this.ymax):4&c?(o=t+(n-t)*(this.ymin-e)/(r-e),s=this.ymin):2&c?(s=e+(r-e)*(this.xmax-t)/(n-t),o=this.xmax):(s=e+(r-e)*(this.xmin-t)/(n-t),o=this.xmin),i?(t=o,e=s,i=this._regioncode(t,e)):(n=o,r=s,a=this._regioncode(n,r))}}_clipInfinite(t,e,n,r,i,a){let o,s=Array.from(e);if((o=this._project(s[0],s[1],n,r))&&s.unshift(o[0],o[1]),(o=this._project(s[s.length-2],s[s.length-1],i,a))&&s.push(o[0],o[1]),s=this._clipFinite(t,s))for(let c,u=0,l=s.length,h=this._edgecode(s[l-2],s[l-1]);u<l;u+=2)c=h,h=this._edgecode(s[u],s[u+1]),c&&h&&(u=this._edge(t,c,h,s,u),l=s.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(t,e,n,r,i){for(;e!==n;){let n,a;switch(e){case 5:e=4;continue;case 4:e=6,n=this.xmax,a=this.ymin;break;case 6:e=2;continue;case 2:e=10,n=this.xmax,a=this.ymax;break;case 10:e=8;continue;case 8:e=9,n=this.xmin,a=this.ymax;break;case 9:e=1;continue;case 1:e=5,n=this.xmin,a=this.ymin}r[i]===n&&r[i+1]===a||!this.contains(t,n,a)||(r.splice(i,0,n,a),i+=2)}if(r.length>4)for(let a=0;a<r.length;a+=2){const t=(a+2)%r.length,e=(a+4)%r.length;(r[a]===r[t]&&r[t]===r[e]||r[a+1]===r[t+1]&&r[t+1]===r[e+1])&&(r.splice(t,2),a-=2)}return i}_project(t,e,n,r){let i,a,o,s=1/0;if(r<0){if(e<=this.ymin)return null;(i=(this.ymin-e)/r)<s&&(o=this.ymin,a=t+(s=i)*n)}else if(r>0){if(e>=this.ymax)return null;(i=(this.ymax-e)/r)<s&&(o=this.ymax,a=t+(s=i)*n)}if(n>0){if(t>=this.xmax)return null;(i=(this.xmax-t)/n)<s&&(a=this.xmax,o=e+(s=i)*r)}else if(n<0){if(t<=this.xmin)return null;(i=(this.xmin-t)/n)<s&&(a=this.xmin,o=e+(s=i)*r)}return[a,o]}_edgecode(t,e){return(t===this.xmin?1:t===this.xmax?2:0)|(e===this.ymin?4:e===this.ymax?8:0)}_regioncode(t,e){return(t<this.xmin?1:t>this.xmax?2:0)|(e<this.ymin?4:e>this.ymax?8:0)}}const FR=2*Math.PI,DR=Math.pow;function IR(t){return t[0]}function MR(t){return t[1]}function OR(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class RR{static from(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:IR,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:MR,r=arguments.length>3?arguments[3]:void 0;return new RR("length"in t?function(t,e,n,r){const i=t.length,a=new Float64Array(2*i);for(let o=0;o<i;++o){const i=t[o];a[2*o]=e.call(r,i,o,t),a[2*o+1]=n.call(r,i,o,t)}return a}(t,e,n,r):Float64Array.from(function*(t,e,n,r){let i=0;for(const a of t)yield e.call(r,a,i,t),yield n.call(r,a,i,t),++i}(t,e,n,r)))}constructor(t){this._delaunator=new mR(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,e=this.points;if(t.hull&&t.hull.length>2&&function(t){const{triangles:e,coords:n}=t;for(let r=0;r<e.length;r+=3){const t=2*e[r],i=2*e[r+1],a=2*e[r+2];if((n[a]-n[t])*(n[i+1]-n[t+1])-(n[i]-n[t])*(n[a+1]-n[t+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:e.length/2},((t,e)=>e)).sort(((t,n)=>e[2*t]-e[2*n]||e[2*t+1]-e[2*n+1]));const t=this.collinear[0],n=this.collinear[this.collinear.length-1],r=[e[2*t],e[2*t+1],e[2*n],e[2*n+1]],i=1e-8*Math.hypot(r[3]-r[1],r[2]-r[0]);for(let a=0,o=e.length/2;a<o;++a){const t=OR(e[2*a],e[2*a+1],i);e[2*a]=t[0],e[2*a+1]=t[1]}this._delaunator=new mR(e)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,i=this.triangles=this._delaunator.triangles,a=this.inedges.fill(-1),o=this._hullIndex.fill(-1);for(let s=0,c=n.length;s<c;++s){const t=i[s%3===2?s-2:s+1];-1!==n[s]&&-1!==a[t]||(a[t]=s)}for(let s=0,c=r.length;s<c;++s)o[r[s]]=s;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],this.triangles[1]=r[1],this.triangles[2]=r[1],a[r[0]]=1,2===r.length&&(a[r[1]]=0))}voronoi(t){return new NR(this,t)}*neighbors(t){const{inedges:e,hull:n,_hullIndex:r,halfedges:i,triangles:a,collinear:o}=this;if(o){const e=o.indexOf(t);return e>0&&(yield o[e-1]),void(e<o.length-1&&(yield o[e+1]))}const s=e[t];if(-1===s)return;let c=s,u=-1;do{if(yield u=a[c],c=c%3===2?c-2:c+1,a[c]!==t)return;if(c=i[c],-1===c){const e=n[(r[t]+1)%n.length];return void(e!==u&&(yield e))}}while(c!==s)}find(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((t=+t)!==t||(e=+e)!==e)return-1;const r=n;let i;for(;(i=this._step(n,t,e))>=0&&i!==n&&i!==r;)n=i;return i}_step(t,e,n){const{inedges:r,hull:i,_hullIndex:a,halfedges:o,triangles:s,points:c}=this;if(-1===r[t]||!c.length)return(t+1)%(c.length>>1);let u=t,l=DR(e-c[2*t],2)+DR(n-c[2*t+1],2);const h=r[t];let d=h;do{let r=s[d];const h=DR(e-c[2*r],2)+DR(n-c[2*r+1],2);if(h<l&&(l=h,u=r),d=d%3===2?d-2:d+1,s[d]!==t)break;if(d=o[d],-1===d){if(d=i[(a[t]+1)%i.length],d!==r&&DR(e-c[2*d],2)+DR(n-c[2*d+1],2)<l)return d;break}}while(d!==h);return u}render(t){const e=null==t?t=new ER:void 0,{points:n,halfedges:r,triangles:i}=this;for(let a=0,o=r.length;a<o;++a){const e=r[a];if(e<a)continue;const o=2*i[a],s=2*i[e];t.moveTo(n[o],n[o+1]),t.lineTo(n[s],n[s+1])}return this.renderHull(t),e&&e.value()}renderPoints(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;const n=null==t?t=new ER:void 0,{points:r}=this;for(let i=0,a=r.length;i<a;i+=2){const n=r[i],a=r[i+1];t.moveTo(n+e,a),t.arc(n,a,e,0,FR)}return n&&n.value()}renderHull(t){const e=null==t?t=new ER:void 0,{hull:n,points:r}=this,i=2*n[0],a=n.length;t.moveTo(r[i],r[i+1]);for(let o=1;o<a;++o){const e=2*n[o];t.lineTo(r[e],r[e+1])}return t.closePath(),e&&e.value()}hullPolygon(){const t=new TR;return this.renderHull(t),t.value()}renderTriangle(t,e){const n=null==e?e=new ER:void 0,{points:r,triangles:i}=this,a=2*i[t*=3],o=2*i[t+1],s=2*i[t+2];return e.moveTo(r[a],r[a+1]),e.lineTo(r[o],r[o+1]),e.lineTo(r[s],r[s+1]),e.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:t}=this;for(let e=0,n=t.length/3;e<n;++e)yield this.trianglePolygon(e)}trianglePolygon(t){const e=new TR;return this.renderTriangle(t,e),e.value()}}function zR(t){Ic.call(this,null,t)}zR.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const BR=[-1e5,-1e5,1e5,1e5];function LR(t){const e=t[0][0],n=t[0][1];let r=t.length-1;for(;t[r][0]===e&&t[r][1]===n;--r);return"M"+t.slice(0,r+1).join("L")+"Z"}jn(zR,Ic,{transform(t,e){const n=t.as||"path",r=e.source;if(!r||!r.length)return e;let i=t.size;i=i?[0,0,i[0],i[1]]:(i=t.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:BR;const a=this.value=RR.from(r,t.x,t.y).voronoi(i);for(let o=0,s=r.length;o<s;++o){const t=a.cellPolygon(o);r[o][n]=t?LR(t):null}return e.reflow(t.modified()).modifies(n)}});var PR=Math.PI/180,jR=64,UR=2048;function WR(){var t,e,n,r,i,a,o,s=[256,256],c=YR,u=[],l=Math.random,h={};function d(t,e,n){for(var r,i,a,o=e.x,u=e.y,h=Math.sqrt(s[0]*s[0]+s[1]*s[1]),d=c(s),f=l()<.5?1:-1,p=-f;(r=d(p+=f))&&(i=~~r[0],a=~~r[1],!(Math.min(Math.abs(i),Math.abs(a))>=h));)if(e.x=o+i,e.y=u+a,!(e.x+e.x0<0||e.y+e.y0<0||e.x+e.x1>s[0]||e.y+e.y1>s[1])&&(!n||!qR(e,t,s[0]))&&(!n||HR(e,n))){for(var g,m=e.sprite,v=e.width>>5,y=s[0]>>5,b=e.x-(v<<4),x=127&b,w=32-x,k=e.y1-e.y0,_=(e.y+e.y0)*y+(b>>5),A=0;A<k;A++){g=0;for(var C=0;C<=v;C++)t[_+C]|=g<<w|(C<v?(g=m[A*v+C])>>>x:0);_+=y}return e.sprite=null,!0}return!1}return h.layout=function(){for(var c=function(t){t.width=t.height=1;var e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2);t.width=(jR<<5)/e,t.height=UR/e;var n=t.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:e}}(Zd()),h=function(t){var e=[],n=-1;for(;++n<t;)e[n]=0;return e}((s[0]>>5)*s[1]),f=null,p=u.length,g=-1,m=[],v=u.map((s=>({text:t(s),font:e(s),style:r(s),weight:i(s),rotate:a(s),size:~~(n(s)+1e-14),padding:o(s),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:s}))).sort(((t,e)=>e.size-t.size));++g<p;){var y=v[g];y.x=s[0]*(l()+.5)>>1,y.y=s[1]*(l()+.5)>>1,VR(c,y,v,g),y.hasText&&d(h,y,f)&&(m.push(y),f?GR(f,y):f=[{x:y.x+y.x0,y:y.y+y.y0},{x:y.x+y.x1,y:y.y+y.y1}],y.x-=s[0]>>1,y.y-=s[1]>>1)}return m},h.words=function(t){return arguments.length?(u=t,h):u},h.size=function(t){return arguments.length?(s=[+t[0],+t[1]],h):s},h.font=function(t){return arguments.length?(e=XR(t),h):e},h.fontStyle=function(t){return arguments.length?(r=XR(t),h):r},h.fontWeight=function(t){return arguments.length?(i=XR(t),h):i},h.rotate=function(t){return arguments.length?(a=XR(t),h):a},h.text=function(e){return arguments.length?(t=XR(e),h):t},h.spiral=function(t){return arguments.length?(c=KR[t]||t,h):c},h.fontSize=function(t){return arguments.length?(n=XR(t),h):n},h.padding=function(t){return arguments.length?(o=XR(t),h):o},h.random=function(t){return arguments.length?(l=t,h):l},h}function VR(t,e,n,r){if(!e.sprite){var i=t.context,a=t.ratio;i.clearRect(0,0,(jR<<5)/a,UR/a);var o,s,c,u,l,h=0,d=0,f=0,p=n.length;for(--r;++r<p;){if(e=n[r],i.save(),i.font=e.style+" "+e.weight+" "+~~((e.size+1)/a)+"px "+e.font,o=i.measureText(e.text+"m").width*a,c=e.size<<1,e.rotate){var g=Math.sin(e.rotate*PR),m=Math.cos(e.rotate*PR),v=o*m,y=o*g,b=c*m,x=c*g;o=Math.max(Math.abs(v+x),Math.abs(v-x))+31>>5<<5,c=~~Math.max(Math.abs(y+b),Math.abs(y-b))}else o=o+31>>5<<5;if(c>f&&(f=c),h+o>=jR<<5&&(h=0,d+=f,f=0),d+c>=UR)break;i.translate((h+(o>>1))/a,(d+(c>>1))/a),e.rotate&&i.rotate(e.rotate*PR),i.fillText(e.text,0,0),e.padding&&(i.lineWidth=2*e.padding,i.strokeText(e.text,0,0)),i.restore(),e.width=o,e.height=c,e.xoff=h,e.yoff=d,e.x1=o>>1,e.y1=c>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,h+=o}for(var w=i.getImageData(0,0,(jR<<5)/a,UR/a).data,k=[];--r>=0;)if((e=n[r]).hasText){for(s=(o=e.width)>>5,c=e.y1-e.y0,u=0;u<c*s;u++)k[u]=0;if(null==(h=e.xoff))return;d=e.yoff;var _=0,A=-1;for(l=0;l<c;l++){for(u=0;u<o;u++){var C=s*l+(u>>5),S=w[(d+l)*(jR<<5)+(h+u)<<2]?1<<31-u%32:0;k[C]|=S,_|=S}_?A=l:(e.y0++,c--,l--,d++)}e.y1=e.y0+A,e.sprite=k.slice(0,(e.y1-e.y0)*s)}}}function qR(t,e,n){n>>=5;for(var r,i=t.sprite,a=t.width>>5,o=t.x-(a<<4),s=127&o,c=32-s,u=t.y1-t.y0,l=(t.y+t.y0)*n+(o>>5),h=0;h<u;h++){r=0;for(var d=0;d<=a;d++)if((r<<c|(d<a?(r=i[h*a+d])>>>s:0))&e[l+d])return!0;l+=n}return!1}function GR(t,e){var n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function HR(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}function YR(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function XR(t){return"function"===typeof t?t:function(){return t}}var KR={archimedean:YR,rectangular:function(t){var e=4*t[0]/t[1],n=0,r=0;return function(t){var i=t<0?-1:1;switch(Math.sqrt(1+4*i*t)-i&3){case 0:n+=e;break;case 1:r+=4;break;case 2:n-=e;break;default:r-=4}return[n,r]}}};const QR=["x","y","font","fontSize","fontStyle","fontWeight","angle"],ZR=["text","font","rotate","fontSize","fontStyle","fontWeight"];function $R(t){Ic.call(this,WR(),t)}$R.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:QR}]},jn($R,Ic,{transform(t,e){!t.size||t.size[0]&&t.size[1]||qe("Wordcloud size dimensions must be non-zero.");const n=t.modified();if(!(n||e.changed(e.ADD_REM)||ZR.some((function(n){const r=t[n];return Cn(r)&&e.modified(r.fields)}))))return;const r=e.materialize(e.SOURCE).source,i=this.value,a=t.as||QR;let o,s=t.fontSize||14;if(Cn(s)?o=t.fontSizeRange:s=In(s),o){const t=s,e=wy("sqrt")().domain(Rn(r,t)).range(o);s=n=>e(t(n))}r.forEach((t=>{t[a[0]]=NaN,t[a[1]]=NaN,t[a[3]]=0}));const c=i.words(r).text(t.text).size(t.size||[500,500]).padding(t.padding||1).spiral(t.spiral||"archimedean").rotate(t.rotate||0).font(t.font||"sans-serif").fontStyle(t.fontStyle||"normal").fontWeight(t.fontWeight||"normal").fontSize(s).random(Qc).layout(),u=i.size(),l=u[0]>>1,h=u[1]>>1,d=c.length;for(let f,p,g=0;g<d;++g)f=c[g],p=f.datum,p[a[0]]=f.x+l,p[a[1]]=f.y+h,p[a[2]]=f.font,p[a[3]]=f.size,p[a[4]]=f.style,p[a[5]]=f.weight,p[a[6]]=f.rotate;return e.reflow(n).modifies(a)}});const JR=Bu(Nu),tz=JR.right,ez=JR.left,nz=(Bu(Iu).center,tz);const rz=t=>new Uint8Array(t),iz=t=>new Uint16Array(t),az=t=>new Uint32Array(t);function oz(t,e,n){const r=(e<257?rz:e<65537?iz:az)(t);return n&&r.set(n),r}function sz(t,e,n){const r=1<<e;return{one:r,zero:~r,range:n.slice(),bisect:t.bisect,index:t.index,size:t.size,onAdd(t,e){const n=this,i=n.bisect(n.range,t.value),a=t.index,o=i[0],s=i[1],c=a.length;let u;for(u=0;u<o;++u)e[a[u]]|=r;for(u=s;u<c;++u)e[a[u]]|=r;return n}}}function cz(){let t=az(0),e=[],n=0;return{insert:function(r,i,a){if(!i.length)return[];const o=n,s=i.length,c=az(s);let u,l,h,d=Array(s);for(h=0;h<s;++h)d[h]=r(i[h]),c[h]=h;if(d=function(t,e){return t.sort.call(e,((e,n)=>{const r=t[e],i=t[n];return r<i?-1:r>i?1:0})),function(t,e){return Array.from(e,(e=>t[e]))}(t,e)}(d,c),o)u=e,l=t,e=Array(o+s),t=az(o+s),function(t,e,n,r,i,a,o,s,c){let u,l=0,h=0;for(u=0;l<r&&h<o;++u)e[l]<i[h]?(s[u]=e[l],c[u]=n[l++]):(s[u]=i[h],c[u]=a[h++]+t);for(;l<r;++l,++u)s[u]=e[l],c[u]=n[l];for(;h<o;++h,++u)s[u]=i[h],c[u]=a[h]+t}(a,u,l,o,d,c,s,e,t);else{if(a>0)for(h=0;h<s;++h)c[h]+=a;e=d,t=c}return n=o+s,{index:c,value:d}},remove:function(r,i){const a=n;let o,s,c;for(s=0;!i[t[s]]&&s<a;++s);for(c=s;s<a;++s)i[o=t[s]]||(t[c]=o,e[c]=e[s],++c);n=a-r},bisect:function(t,r){let i;return r?i=r.length:(r=e,i=n),[ez(r,t[0],0,i),tz(r,t[1],0,i)]},reindex:function(e){for(let r=0,i=n;r<i;++r)t[r]=e[t[r]]},index:()=>t,size:()=>n}}function uz(t){Ic.call(this,function(){let t=8,e=[],n=az(0),r=oz(0,t),i=oz(0,t);return{data:()=>e,seen:()=>n=function(t,e,n){return t.length>=e?t:((n=n||new t.constructor(e)).set(t),n)}(n,e.length),add(t){for(let n,r=0,i=e.length,a=t.length;r<a;++r)n=t[r],n._index=i++,e.push(n)},remove(t,n){const a=e.length,o=Array(a-t),s=e;let c,u,l;for(u=0;!n[u]&&u<a;++u)o[u]=e[u],s[u]=u;for(l=u;u<a;++u)c=e[u],n[u]?s[u]=-1:(s[u]=l,r[l]=r[u],i[l]=i[u],o[l]=c,c._index=l++),r[u]=0;return e=o,s},size:()=>e.length,curr:()=>r,prev:()=>i,reset:t=>i[t]=r[t],all:()=>t<257?255:t<65537?65535:4294967295,set(t,e){r[t]|=e},clear(t,e){r[t]&=~e},resize(e,n){(e>r.length||n>t)&&(t=Math.max(n,t),r=oz(e,t,r),i=oz(e,t))}}}(),t),this._indices=null,this._dims=null}function lz(t){Ic.call(this,null,t)}function*hz(t,e){if(null==e)for(let n of t)null!=n&&""!==n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)r=e(r,++n,t),null!=r&&""!==r&&(r=+r)>=r&&(yield r)}}function dz(t,e,n){const r=Float64Array.from(hz(t,n));return r.sort(Nu),e.map((t=>Ou(r,t)))}function fz(t,e){return dz(t,[.25,.5,.75],e)}function pz(t,e){const n=t.length,r=function(t,e){const n=function(t,e){let n,r=0,i=0,a=0;if(void 0===e)for(let o of t)null!=o&&(o=+o)>=o&&(n=o-i,i+=n/++r,a+=n*(o-i));else{let o=-1;for(let s of t)null!=(s=e(s,++o,t))&&(s=+s)>=s&&(n=s-i,i+=n/++r,a+=n*(s-i))}if(r>1)return a/(r-1)}(t,e);return n?Math.sqrt(n):n}(t,e),i=fz(t,e),a=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,a)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function gz(t){const e=t.maxbins||20,n=t.base||10,r=Math.log(n),i=t.divide||[5,2];let a,o,s,c,u,l,h=t.extent[0],d=t.extent[1];const f=t.span||d-h||Math.abs(h)||1;if(t.step)a=t.step;else if(t.steps){for(c=f/e,u=0,l=t.steps.length;u<l&&t.steps[u]<c;++u);a=t.steps[Math.max(0,u-1)]}else{for(o=Math.ceil(Math.log(e)/r),s=t.minstep||0,a=Math.max(s,Math.pow(n,Math.round(Math.log(f)/r)-o));Math.ceil(f/a)>e;)a*=n;for(u=0,l=i.length;u<l;++u)c=a/i[u],c>=s&&f/c<=e&&(a=c)}c=Math.log(a);const p=c>=0?0:1+~~(-c/r),g=Math.pow(n,-p-1);return(t.nice||void 0===t.nice)&&(c=Math.floor(h/a+g)*a,h=h<c?c-a:c,d=Math.ceil(d/a)*a),{start:h,stop:d===h?h+a:d,step:a}}uz.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},jn(uz,Ic,{transform(t,e){return this._dims?t.modified("fields")||t.fields.some((t=>e.modified(t.fields)))?this.reinit(t,e):this.eval(t,e):this.init(t,e)},init(t,e){const n=t.fields,r=t.query,i=this._indices={},a=this._dims=[],o=r.length;let s,c,u=0;for(;u<o;++u)s=n[u].fname,c=i[s]||(i[s]=cz()),a.push(sz(c,u,r[u]));return this.eval(t,e)},reinit(t,e){const n=e.materialize().fork(),r=t.fields,i=t.query,a=this._indices,o=this._dims,s=this.value,c=s.curr(),u=s.prev(),l=s.all(),h=n.rem=n.add,d=n.mod,f=i.length,p={};let g,m,v,y,b,x,w,k,_;if(u.set(c),e.rem.length&&(b=this.remove(t,e,n)),e.add.length&&s.add(e.add),e.mod.length)for(x={},y=e.mod,w=0,k=y.length;w<k;++w)x[y[w]._index]=1;for(w=0;w<f;++w)_=r[w],(!o[w]||t.modified("fields",w)||e.modified(_.fields))&&(v=_.fname,(g=p[v])||(a[v]=m=cz(),p[v]=g=m.insert(_,e.source,0)),o[w]=sz(m,w,i[w]).onAdd(g,c));for(w=0,k=s.data().length;w<k;++w)b[w]||(u[w]!==c[w]?h.push(w):x[w]&&c[w]!==l&&d.push(w));return s.mask=(1<<f)-1,n},eval(t,e){const n=e.materialize().fork(),r=this._dims.length;let i=0;return e.rem.length&&(this.remove(t,e,n),i|=(1<<r)-1),t.modified("query")&&!t.modified("fields")&&(i|=this.update(t,e,n)),e.add.length&&(this.insert(t,e,n),i|=(1<<r)-1),e.mod.length&&(this.modify(e,n),i|=(1<<r)-1),this.value.mask=i,n},insert(t,e,n){const r=e.add,i=this.value,a=this._dims,o=this._indices,s=t.fields,c={},u=n.add,l=i.size()+r.length,h=a.length;let d,f,p,g=i.size();i.resize(l,h),i.add(r);const m=i.curr(),v=i.prev(),y=i.all();for(d=0;d<h;++d)f=s[d].fname,p=c[f]||(c[f]=o[f].insert(s[d],r,g)),a[d].onAdd(p,m);for(;g<l;++g)v[g]=y,m[g]!==y&&u.push(g)},modify(t,e){const n=e.mod,r=this.value,i=r.curr(),a=r.all(),o=t.mod;let s,c,u;for(s=0,c=o.length;s<c;++s)u=o[s]._index,i[u]!==a&&n.push(u)},remove(t,e,n){const r=this._indices,i=this.value,a=i.curr(),o=i.prev(),s=i.all(),c={},u=n.rem,l=e.rem;let h,d,f,p;for(h=0,d=l.length;h<d;++h)f=l[h]._index,c[f]=1,o[f]=p=a[f],a[f]=s,p!==s&&u.push(f);for(f in r)r[f].remove(d,c);return this.reindex(e,d,c),c},reindex(t,e,n){const r=this._indices,i=this.value;t.runAfter((()=>{const t=i.remove(e,n);for(const e in r)r[e].reindex(t)}))},update(t,e,n){const r=this._dims,i=t.query,a=e.stamp,o=r.length;let s,c,u=0;for(n.filters=0,c=0;c<o;++c)t.modified("query",c)&&(s=c,++u);if(1===u)u=r[s].one,this.incrementOne(r[s],i[s],n.add,n.rem);else for(c=0,u=0;c<o;++c)t.modified("query",c)&&(u|=r[c].one,this.incrementAll(r[c],i[c],a,n.add),n.rem=n.add);return u},incrementAll(t,e,n,r){const i=this.value,a=i.seen(),o=i.curr(),s=i.prev(),c=t.index(),u=t.bisect(t.range),l=t.bisect(e),h=l[0],d=l[1],f=u[0],p=u[1],g=t.one;let m,v,y;if(h<f)for(m=h,v=Math.min(f,d);m<v;++m)y=c[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;else if(h>f)for(m=f,v=Math.min(h,p);m<v;++m)y=c[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;if(d>p)for(m=Math.max(h,p),v=d;m<v;++m)y=c[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;else if(d<p)for(m=Math.max(f,d),v=p;m<v;++m)y=c[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;t.range=e.slice()},incrementOne(t,e,n,r){const i=this.value.curr(),a=t.index(),o=t.bisect(t.range),s=t.bisect(e),c=s[0],u=s[1],l=o[0],h=o[1],d=t.one;let f,p,g;if(c<l)for(f=c,p=Math.min(l,u);f<p;++f)g=a[f],i[g]^=d,n.push(g);else if(c>l)for(f=l,p=Math.min(c,h);f<p;++f)g=a[f],i[g]^=d,r.push(g);if(u>h)for(f=Math.max(c,h),p=u;f<p;++f)g=a[f],i[g]^=d,n.push(g);else if(u<h)for(f=Math.max(l,u),p=h;f<p;++f)g=a[f],i[g]^=d,r.push(g);t.range=e.slice()}}),lz.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},jn(lz,Ic,{transform(t,e){const n=~(t.ignore||0),r=t.filter,i=r.mask;if(0===(i&n))return e.StopPropagation;const a=e.fork(e.ALL),o=r.data(),s=r.curr(),c=r.prev(),u=t=>s[t]&n?null:o[t];return a.filter(a.MOD,u),i&i-1?(a.filter(a.ADD,(t=>{const e=s[t]&n;return!e&&e^c[t]&n?o[t]:null})),a.filter(a.REM,(t=>{const e=s[t]&n;return e&&!(e^e^c[t]&n)?o[t]:null}))):(a.filter(a.ADD,u),a.filter(a.REM,(t=>(s[t]&n)===i?o[t]:null))),a.filter(a.SOURCE,(t=>u(t._index)))}});var mz=Math.random;function vz(t){mz=t}function yz(t,e,n,r){if(!t.length)return[void 0,void 0];const i=Float64Array.from(hz(t,r)),a=i.length,o=e;let s,c,u,l;for(u=0,l=Array(o);u<o;++u){for(s=0,c=0;c<a;++c)s+=i[~~(mz()*a)];l[u]=s/a}return l.sort(Nu),[Mu(l,n/2),Mu(l,1-n/2)]}function bz(t,e,n,r){r=r||(t=>t);const i=t.length,a=new Float64Array(i);let o,s=0,c=1,u=r(t[0]),l=u,h=u+e;for(;c<i;++c){if(o=r(t[c]),o>=h){for(l=(u+l)/2;s<c;++s)a[s]=l;h=o+e,u=o}l=o}for(l=(u+l)/2;s<c;++s)a[s]=l;return n?function(t,e){const n=t.length;let r,i,a=0,o=1;for(;t[a]===t[o];)++o;for(;o<n;){for(r=o+1;t[o]===t[r];)++r;if(t[o]-t[o-1]<e){for(i=o+(a+r-o-o>>1);i<o;)t[i++]=t[o];for(;i>o;)t[i--]=t[a]}a=o,o=r}return t}(a,e+e/4):a}function xz(t){return function(){return(t=(1103515245*t+12345)%2147483647)/2147483647}}function wz(t,e){let n,r,i;null==e&&(e=t,t=0);const a={min(t){return arguments.length?(n=t||0,i=r-n,a):n},max(t){return arguments.length?(r=t||0,i=r-n,a):r},sample:()=>n+Math.floor(i*mz()),pdf:t=>t===Math.floor(t)&&t>=n&&t<r?1/i:0,cdf(t){const e=Math.floor(t);return e<n?0:e>=r?1:(e-n+1)/i},icdf:t=>t>=0&&t<=1?n-1+Math.floor(t*i):NaN};return a.min(t).max(e)}const kz=Math.sqrt(2*Math.PI),_z=Math.SQRT2;let Az=NaN;function Cz(t,e){t=t||0,e=null==e?1:e;let n,r,i=0,a=0;if(Az===Az)i=Az,Az=NaN;else{do{i=2*mz()-1,a=2*mz()-1,n=i*i+a*a}while(0===n||n>1);r=Math.sqrt(-2*Math.log(n)/n),i*=r,Az=a*r}return t+i*e}function Sz(t,e,n){const r=(t-(e||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*kz)}function Ez(t,e,n){const r=(t-(e=e||0))/(n=null==n?1:n),i=Math.abs(r);let a;if(i>37)a=0;else{const t=Math.exp(-i*i/2);let e;i<7.07106781186547?(e=.0352624965998911*i+.700383064443688,e=e*i+6.37396220353165,e=e*i+33.912866078383,e=e*i+112.079291497871,e=e*i+221.213596169931,e=e*i+220.206867912376,a=t*e,e=.0883883476483184*i+1.75566716318264,e=e*i+16.064177579207,e=e*i+86.7807322029461,e=e*i+296.564248779674,e=e*i+637.333633378831,e=e*i+793.826512519948,e=e*i+440.413735824752,a/=e):(e=i+.65,e=i+4/e,e=i+3/e,e=i+2/e,e=i+1/e,a=t/e/2.506628274631)}return r>0?1-a:a}function Tz(t,e,n){return t<0||t>1?NaN:(e||0)+(null==n?1:n)*_z*function(t){let e,n=-Math.log((1-t)*(1+t));n<6.25?(n-=3.125,e=-364441206401782e-35,e=e*n-16850591381820166e-35,e=128584807152564e-32+e*n,e=11157877678025181e-33+e*n,e=e*n-1333171662854621e-31,e=20972767875968562e-33+e*n,e=6637638134358324e-30+e*n,e=e*n-4054566272975207e-29,e=e*n-8151934197605472e-29,e=26335093153082323e-28+e*n,e=e*n-12975133253453532e-27,e=e*n-5415412054294628e-26,e=1.0512122733215323e-9+e*n,e=e*n-4.112633980346984e-9,e=e*n-2.9070369957882005e-8,e=4.2347877827932404e-7+e*n,e=e*n-13654692000834679e-22,e=e*n-13882523362786469e-21,e=.00018673420803405714+e*n,e=e*n-.000740702534166267,e=e*n-.006033670871430149,e=.24015818242558962+e*n,e=1.6536545626831027+e*n):n<16?(n=Math.sqrt(n)-3.25,e=2.2137376921775787e-9,e=9.075656193888539e-8+e*n,e=e*n-2.7517406297064545e-7,e=1.8239629214389228e-8+e*n,e=15027403968909828e-22+e*n,e=e*n-4013867526981546e-21,e=29234449089955446e-22+e*n,e=12475304481671779e-21+e*n,e=e*n-47318229009055734e-21,e=6828485145957318e-20+e*n,e=24031110387097894e-21+e*n,e=e*n-.0003550375203628475,e=.0009532893797373805+e*n,e=e*n-.0016882755560235047,e=.002491442096107851+e*n,e=e*n-.003751208507569241,e=.005370914553590064+e*n,e=1.0052589676941592+e*n,e=3.0838856104922208+e*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,e=-27109920616438573e-27,e=e*n-2.555641816996525e-10,e=1.5076572693500548e-9+e*n,e=e*n-3.789465440126737e-9,e=7.61570120807834e-9+e*n,e=e*n-1.496002662714924e-8,e=2.914795345090108e-8+e*n,e=e*n-6.771199775845234e-8,e=2.2900482228026655e-7+e*n,e=e*n-9.9298272942317e-7,e=4526062597223154e-21+e*n,e=e*n-1968177810553167e-20,e=7599527703001776e-20+e*n,e=e*n-.00021503011930044477,e=e*n-.00013871931833623122,e=1.0103004648645344+e*n,e=4.849906401408584+e*n):e=1/0;return e*t}(2*t-1)}function Nz(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>Cz(n,r),pdf:t=>Sz(t,n,r),cdf:t=>Ez(t,n,r),icdf:t=>Tz(t,n,r)};return i.mean(t).stdev(e)}function Fz(t,e){const n=Nz();let r=0;const i={data(n){return arguments.length?(t=n,r=n?n.length:0,i.bandwidth(e)):t},bandwidth(n){return arguments.length?(!(e=n)&&t&&(e=pz(t)),i):e},sample:()=>t[~~(mz()*r)]+e*n.sample(),pdf(i){let a=0,o=0;for(;o<r;++o)a+=n.pdf((i-t[o])/e);return a/e/r},cdf(i){let a=0,o=0;for(;o<r;++o)a+=n.cdf((i-t[o])/e);return a/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(t)}function Dz(t,e){return t=t||0,e=null==e?1:e,Math.exp(t+Cz()*e)}function Iz(t,e,n){if(t<=0)return 0;e=e||0,n=null==n?1:n;const r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*kz*t)}function Mz(t,e,n){return Ez(Math.log(t),e,n)}function Oz(t,e,n){return Math.exp(Tz(t,e,n))}function Rz(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>Dz(n,r),pdf:t=>Iz(t,n,r),cdf:t=>Mz(t,n,r),icdf:t=>Oz(t,n,r)};return i.mean(t).stdev(e)}function zz(t,e){let n,r=0;const i={weights(t){return arguments.length?(n=function(t){const e=[];let n,i=0;for(n=0;n<r;++n)i+=e[n]=null==t[n]?1:+t[n];for(n=0;n<r;++n)e[n]/=i;return e}(e=t||[]),i):e},distributions(n){return arguments.length?(n?(r=n.length,t=n):(r=0,t=[]),i.weights(e)):t},sample(){const e=mz();let i=t[r-1],a=n[0],o=0;for(;o<r-1;a+=n[++o])if(e<a){i=t[o];break}return i.sample()},pdf(e){let i=0,a=0;for(;a<r;++a)i+=n[a]*t[a].pdf(e);return i},cdf(e){let i=0,a=0;for(;a<r;++a)i+=n[a]*t[a].cdf(e);return i},icdf(){throw Error("Mixture icdf not supported.")}};return i.distributions(t).weights(e)}function Bz(t,e){return null==e&&(e=null==t?1:t,t=0),t+(e-t)*mz()}function Lz(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=e&&t<=n?1/(n-e):0}function Pz(t,e,n){return null==n&&(n=null==e?1:e,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function jz(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=0&&t<=1?e+t*(n-e):NaN}function Uz(t,e){let n,r;const i={min(t){return arguments.length?(n=t||0,i):n},max(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>Bz(n,r),pdf:t=>Lz(t,n,r),cdf:t=>Pz(t,n,r),icdf:t=>jz(t,n,r)};return null==e&&(e=null==t?1:t,t=0),i.min(t).max(e)}function Wz(t,e,n,r){const i=r-t*t,a=Math.abs(i)<1e-24?0:(n-t*e)/i;return[e-a*t,a]}function Vz(t,e,n,r){t=t.filter((t=>{let r=e(t),i=n(t);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i})),r&&t.sort(((t,n)=>e(t)-e(n)));const i=t.length,a=new Float64Array(i),o=new Float64Array(i);let s,c,u,l=0,h=0,d=0;for(u of t)a[l]=s=+e(u),o[l]=c=+n(u),++l,h+=(s-h)/l,d+=(c-d)/l;for(l=0;l<i;++l)a[l]-=h,o[l]-=d;return[a,o,h,d]}function qz(t,e,n,r){let i,a,o=-1;for(const s of t)i=e(s),a=n(s),null!=i&&(i=+i)>=i&&null!=a&&(a=+a)>=a&&r(i,a,++o)}function Gz(t,e,n,r,i){let a=0,o=0;return qz(t,e,n,((t,e)=>{const n=e-i(t),s=e-r;a+=n*n,o+=s*s})),1-a/o}function Hz(t,e,n){let r=0,i=0,a=0,o=0,s=0;qz(t,e,n,((t,e)=>{++s,r+=(t-r)/s,i+=(e-i)/s,a+=(t*e-a)/s,o+=(t*t-o)/s}));const c=Wz(r,i,a,o),u=t=>c[0]+c[1]*t;return{coef:c,predict:u,rSquared:Gz(t,e,n,i,u)}}function Yz(t,e,n){let r=0,i=0,a=0,o=0,s=0;qz(t,e,n,((t,e)=>{++s,t=Math.log(t),r+=(t-r)/s,i+=(e-i)/s,a+=(t*e-a)/s,o+=(t*t-o)/s}));const c=Wz(r,i,a,o),u=t=>c[0]+c[1]*Math.log(t);return{coef:c,predict:u,rSquared:Gz(t,e,n,i,u)}}function Xz(t,e,n){const[r,i,a,o]=Vz(t,e,n);let s,c,u,l=0,h=0,d=0,f=0,p=0;qz(t,e,n,((t,e)=>{s=r[p++],c=Math.log(e),u=s*e,l+=(e*c-l)/p,h+=(u-h)/p,d+=(u*c-d)/p,f+=(s*u-f)/p}));const[g,m]=Wz(h/o,l/o,d/o,f/o),v=t=>Math.exp(g+m*(t-a));return{coef:[Math.exp(g-m*a),m],predict:v,rSquared:Gz(t,e,n,o,v)}}function Kz(t,e,n){let r=0,i=0,a=0,o=0,s=0,c=0;qz(t,e,n,((t,e)=>{const n=Math.log(t),u=Math.log(e);++c,r+=(n-r)/c,i+=(u-i)/c,a+=(n*u-a)/c,o+=(n*n-o)/c,s+=(e-s)/c}));const u=Wz(r,i,a,o),l=t=>u[0]*Math.pow(t,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:l,rSquared:Gz(t,e,n,s,l)}}function Qz(t,e,n){const[r,i,a,o]=Vz(t,e,n),s=r.length;let c,u,l,h,d=0,f=0,p=0,g=0,m=0;for(c=0;c<s;)u=r[c],l=i[c++],h=u*u,d+=(h-d)/c,f+=(h*u-f)/c,p+=(h*h-p)/c,g+=(u*l-g)/c,m+=(h*l-m)/c;const v=p-d*d,y=d*v-f*f,b=(m*d-g*f)/y,x=(g*v-m*f)/y,w=-b*d,k=t=>b*(t-=a)*t+x*t+w+o;return{coef:[w-x*a+b*a*a+o,x-2*b*a,b],predict:k,rSquared:Gz(t,e,n,o,k)}}function Zz(t,e,n,r){if(1===r)return Hz(t,e,n);if(2===r)return Qz(t,e,n);const[i,a,o,s]=Vz(t,e,n),c=i.length,u=[],l=[],h=r+1;let d,f,p,g,m;for(d=0;d<h;++d){for(p=0,g=0;p<c;++p)g+=Math.pow(i[p],d)*a[p];for(u.push(g),m=new Float64Array(h),f=0;f<h;++f){for(p=0,g=0;p<c;++p)g+=Math.pow(i[p],d+f);m[f]=g}l.push(m)}l.push(u);const v=function(t){const e=t.length-1,n=[];let r,i,a,o,s;for(r=0;r<e;++r){for(o=r,i=r+1;i<e;++i)Math.abs(t[r][i])>Math.abs(t[r][o])&&(o=i);for(a=r;a<e+1;++a)s=t[a][r],t[a][r]=t[a][o],t[a][o]=s;for(i=r+1;i<e;++i)for(a=e;a>=r;a--)t[a][i]-=t[a][r]*t[r][i]/t[r][r]}for(i=e-1;i>=0;--i){for(s=0,a=i+1;a<e;++a)s+=t[a][i]*n[a];n[i]=(t[e][i]-s)/t[i][i]}return n}(l),y=t=>{t-=o;let e=s+v[0]+v[1]*t+v[2]*t*t;for(d=3;d<h;++d)e+=v[d]*Math.pow(t,d);return e};return{coef:$z(h,v,-o,s),predict:y,rSquared:Gz(t,e,n,s,y)}}function $z(t,e,n,r){const i=Array(t);let a,o,s,c;for(a=0;a<t;++a)i[a]=0;for(a=t-1;a>=0;--a)for(s=e[a],c=1,i[a]+=s,o=1;o<=a;++o)c*=(a+1-o)/o,i[a-o]+=s*Math.pow(n,o)*c;return i[0]+=r,i}const Jz=2,tB=1e-12;function eB(t,e,n,r){const[i,a,o,s]=Vz(t,e,n,!0),c=i.length,u=Math.max(2,~~(r*c)),l=new Float64Array(c),h=new Float64Array(c),d=new Float64Array(c).fill(1);for(let f=-1;++f<=Jz;){const t=[0,u-1];for(let n=0;n<c;++n){const e=i[n],r=t[0],o=t[1],s=e-i[r]>i[o]-e?r:o;let c=0,u=0,f=0,p=0,g=0;const m=1/Math.abs(i[s]-e||1);for(let t=r;t<=o;++t){const n=i[t],r=a[t],o=nB(Math.abs(e-n)*m)*d[t],s=n*o;c+=o,u+=s,f+=r*o,p+=r*s,g+=n*s}const[v,y]=Wz(u/c,f/c,p/c,g/c);l[n]=v+y*e,h[n]=Math.abs(a[n]-l[n]),rB(i,n+1,t)}if(f===Jz)break;const e=Ru(h);if(Math.abs(e)<tB)break;for(let n,r,i=0;i<c;++i)n=h[i]/(6*e),d[i]=n>=1?tB:(r=1-n*n)*r}return function(t,e,n,r){const i=t.length,a=[];let o,s=0,c=0,u=[];for(;s<i;++s)o=t[s]+n,u[0]===o?u[1]+=(e[s]-u[1])/++c:(c=0,u[1]+=r,u=[o,e[s]],a.push(u));return u[1]+=r,a}(i,l,o,s)}function nB(t){return(t=1-t*t*t)*t*t}function rB(t,e,n){const r=t[e];let i=n[0],a=n[1]+1;if(!(a>=t.length))for(;e>i&&t[a]-r<=r-t[i];)n[0]=++i,n[1]=a,++a}const iB=.5*Math.PI/180;function aB(t,e,n,r){n=n||25,r=Math.max(n,r||200);const i=e=>[e,t(e)],a=e[0],o=e[1],s=o-a,c=s/r,u=[i(a)],l=[];if(n===r){for(let t=1;t<r;++t)u.push(i(a+t/n*s));return u.push(i(o)),u}l.push(i(o));for(let g=n;--g>0;)l.push(i(a+g/n*s));let h=u[0],d=l[l.length-1];const f=1/s,p=function(t,e){let n=t,r=t;const i=e.length;for(let a=0;a<i;++a){const t=e[a][1];t<n&&(n=t),t>r&&(r=t)}return 1/(r-n)}(h[1],l);for(;d;){const t=i((h[0]+d[0])/2);t[0]-h[0]>=c&&oB(h,t,d,f,p)>iB?l.push(t):(h=d,u.push(d),l.pop()),d=l[l.length-1]}return u}function oB(t,e,n,r,i){const a=Math.atan2(i*(n[1]-t[1]),r*(n[0]-t[0])),o=Math.atan2(i*(e[1]-t[1]),r*(e[0]-t[0]));return Math.abs(a-o)}function sB(t,e,n){return t.fields=e||[],t.fname=n,t}function cB(t){return 1===t.length?uB(t[0]):lB(t)}const uB=t=>function(e){return e[t]},lB=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function hB(t){throw Error(t)}function dB(t){const e=[],n=t.length;let r,i,a,o=null,s=0,c="";function u(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)c+=t.substring(r,i++),r=i;else if(a===o)u(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&u(),s=r=i+1):"]"===a&&(s||hB("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&hB("Access path missing closing bracket: "+t),o&&hB("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function fB(t,e,n){const r=dB(t);return t=1===r.length?r[0]:t,sB((n&&n.get||cB)(r),[t],e||t)}fB("id"),sB((t=>t),[],"identity");const pB=sB((()=>0),[],"zero"),gB=sB((()=>1),[],"one");sB((()=>!0),[],"true"),sB((()=>!1),[],"false");var mB=Array.isArray;function vB(t){return t[t.length-1]}function yB(t){return null!=t?mB(t)?t:[t]:[]}function bB(t){return"function"===typeof t}function xB(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const wB=Object.prototype.hasOwnProperty;function kB(t,e){return wB.call(t,e)}var _B=new Date,AB=new Date;function CB(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,a){var o,s=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r)||!(a>0))return s;do{s.push(o=new Date(+n)),e(n,a),t(n)}while(o<n&&n<r);return s},i.filter=function(n){return CB((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return _B.setTime(+e),AB.setTime(+r),t(_B),t(AB),Math.floor(n(_B,AB))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t===0}:function(e){return i.count(0,e)%t===0}):i:null}),i}const SB=1e3,EB=6e4,TB=36e5,NB=864e5,FB=6048e5;var DB=CB((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*EB)/NB),(t=>t.getDate()-1));const IB=DB;DB.range;function MB(t){return CB((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*EB)/FB}))}var OB=MB(0),RB=MB(1),zB=MB(2),BB=MB(3),LB=MB(4),PB=MB(5),jB=MB(6),UB=(OB.range,RB.range,zB.range,BB.range,LB.range,PB.range,jB.range,CB((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/NB}),(function(t){return t.getUTCDate()-1})));const WB=UB;UB.range;function VB(t){return CB((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/FB}))}var qB=VB(0),GB=VB(1),HB=VB(2),YB=VB(3),XB=VB(4),KB=VB(5),QB=VB(6),ZB=(qB.range,GB.range,HB.range,YB.range,XB.range,KB.range,QB.range,CB((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()})));ZB.every=function(t){return isFinite(t=Math.floor(t))&&t>0?CB((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};const $B=ZB;ZB.range;var JB=CB((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()}));const tL=JB;JB.range;var eL=CB((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*SB-t.getMinutes()*EB)}),(function(t,e){t.setTime(+t+e*TB)}),(function(t,e){return(e-t)/TB}),(function(t){return t.getHours()}));const nL=eL;eL.range;var rL=CB((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*SB)}),(function(t,e){t.setTime(+t+e*EB)}),(function(t,e){return(e-t)/EB}),(function(t){return t.getMinutes()}));const iL=rL;rL.range;var aL=CB((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+e*SB)}),(function(t,e){return(e-t)/SB}),(function(t){return t.getUTCSeconds()}));const oL=aL;aL.range;var sL=CB((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t}));sL.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?CB((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):sL:null};const cL=sL;sL.range;var uL=CB((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));uL.every=function(t){return isFinite(t=Math.floor(t))&&t>0?CB((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};const lL=uL;uL.range;var hL=CB((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()}));const dL=hL;hL.range;var fL=CB((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+e*TB)}),(function(t,e){return(e-t)/TB}),(function(t){return t.getUTCHours()}));const pL=fL;fL.range;var gL=CB((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+e*EB)}),(function(t,e){return(e-t)/EB}),(function(t){return t.getUTCMinutes()}));const mL=gL;gL.range;const vL="year",yL="quarter",bL="month",xL="week",wL="date",kL="day",_L="dayofyear",AL="hours",CL="minutes",SL="seconds",EL="milliseconds",TL=[vL,yL,bL,xL,wL,kL,_L,AL,CL,SL,EL],NL=TL.reduce(((t,e,n)=>(t[e]=1+n,t)),{});function FL(t){const e=yB(t).slice(),n={};e.length||hB("Missing time unit."),e.forEach((t=>{kB(NL,t)?n[t]=1:hB("Invalid time unit: ".concat(t,"."))}));return(n[xL]||n[kL]?1:0)+(n[yL]||n[bL]||n[wL]?1:0)+(n[_L]?1:0)>1&&hB("Incompatible time units: ".concat(t)),e.sort(((t,e)=>NL[t]-NL[e])),e}const DL={[vL]:"%Y ",[yL]:"Q%q ",[bL]:"%b ",[wL]:"%d ",[xL]:"W%U ",[kL]:"%a ",[_L]:"%j ",[AL]:"%H:00",[CL]:"00:%M",[SL]:":%S",[EL]:".%L",["".concat(vL,"-").concat(bL)]:"%Y-%m ",["".concat(vL,"-").concat(bL,"-").concat(wL)]:"%Y-%m-%d ",["".concat(AL,"-").concat(CL)]:"%H:%M"};function IL(t,e){const n=xB({},DL,e),r=FL(t),i=r.length;let a,o,s="",c=0;for(c=0;c<i;)for(a=r.length;a>c;--a)if(o=r.slice(c,a).join("-"),null!=n[o]){s+=n[o],c=a;break}return s.trim()}const ML=new Date;function OL(t){return ML.setFullYear(t),ML.setMonth(0),ML.setDate(1),ML.setHours(0,0,0,0),ML}function RL(t){return BL(new Date(t))}function zL(t){return LL(new Date(t))}function BL(t){return IB.count(OL(t.getFullYear())-1,t)}function LL(t){return OB.count(OL(t.getFullYear())-1,t)}function PL(t){return OL(t).getDay()}function jL(t,e,n,r,i,a,o){if(0<=t&&t<100){const s=new Date(-1,e,n,r,i,a,o);return s.setFullYear(t),s}return new Date(t,e,n,r,i,a,o)}function UL(t){return VL(new Date(t))}function WL(t){return qL(new Date(t))}function VL(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return WB.count(e-1,t)}function qL(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return qB.count(e-1,t)}function GL(t){return ML.setTime(Date.UTC(t,0,1)),ML.getUTCDay()}function HL(t,e,n,r,i,a,o){if(0<=t&&t<100){const t=new Date(Date.UTC(-1,e,n,r,i,a,o));return t.setUTCFullYear(n.y),t}return new Date(Date.UTC(t,e,n,r,i,a,o))}function YL(t,e,n,r,i){const a=e||1,o=vB(t),s=(t,e,i)=>function(t,e,n,r){const i=n<=1?t:r?(e,i)=>r+n*Math.floor((t(e,i)-r)/n):(e,r)=>n*Math.floor(t(e,r)/n);return e?(t,n)=>e(i(t,n),n):i}(n[i=i||t],r[i],t===o&&a,e),c=new Date,u=function(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}(t),l=u[vL]?s(vL):function(t){return bB(t)?t:()=>t}(2012),h=u[bL]?s(bL):u[yL]?s(yL):pB,d=u[xL]&&u[kL]?s(kL,1,xL+kL):u[xL]?s(xL,1):u[kL]?s(kL,1):u[wL]?s(wL,1):u[_L]?s(_L,1):gB,f=u[AL]?s(AL):pB,p=u[CL]?s(CL):pB,g=u[SL]?s(SL):pB,m=u[EL]?s(EL):pB;return function(t){c.setTime(+t);const e=l(c);return i(e,h(c),d(c,e),f(c),p(c),g(c),m(c))}}function XL(t,e,n){return e+7*t-(n+6)%7}const KL={[vL]:t=>t.getFullYear(),[yL]:t=>Math.floor(t.getMonth()/3),[bL]:t=>t.getMonth(),[wL]:t=>t.getDate(),[AL]:t=>t.getHours(),[CL]:t=>t.getMinutes(),[SL]:t=>t.getSeconds(),[EL]:t=>t.getMilliseconds(),[_L]:t=>BL(t),[xL]:t=>LL(t),[xL+kL]:(t,e)=>XL(LL(t),t.getDay(),PL(e)),[kL]:(t,e)=>XL(1,t.getDay(),PL(e))},QL={[yL]:t=>3*t,[xL]:(t,e)=>XL(t,0,PL(e))};function ZL(t,e){return YL(t,e||1,KL,QL,jL)}const $L={[vL]:t=>t.getUTCFullYear(),[yL]:t=>Math.floor(t.getUTCMonth()/3),[bL]:t=>t.getUTCMonth(),[wL]:t=>t.getUTCDate(),[AL]:t=>t.getUTCHours(),[CL]:t=>t.getUTCMinutes(),[SL]:t=>t.getUTCSeconds(),[EL]:t=>t.getUTCMilliseconds(),[_L]:t=>VL(t),[xL]:t=>qL(t),[kL]:(t,e)=>XL(1,t.getUTCDay(),GL(e)),[xL+kL]:(t,e)=>XL(qL(t),t.getUTCDay(),GL(e))},JL={[yL]:t=>3*t,[xL]:(t,e)=>XL(t,0,GL(e))};function tP(t,e){return YL(t,e||1,$L,JL,HL)}const eP={[vL]:$B,[yL]:tL.every(3),[bL]:tL,[xL]:OB,[wL]:IB,[kL]:IB,[_L]:IB,[AL]:nL,[CL]:iL,[SL]:oL,[EL]:cL},nP={[vL]:lL,[yL]:dL.every(3),[bL]:dL,[xL]:qB,[wL]:WB,[kL]:WB,[_L]:WB,[AL]:pL,[CL]:mL,[SL]:oL,[EL]:cL};function rP(t){return eP[t]}function iP(t){return nP[t]}function aP(t,e,n){return t?t.offset(e,n):void 0}function oP(t,e,n){return aP(rP(t),e,n)}function sP(t,e,n){return aP(iP(t),e,n)}function cP(t,e,n,r){return t?t.range(e,n,r):void 0}function uP(t,e,n,r){return cP(rP(t),e,n,r)}function lP(t,e,n,r){return cP(iP(t),e,n,r)}const hP=1e3,dP=6e4,fP=36e5,pP=864e5,gP=2592e6,mP=31536e6,vP=[vL,bL,wL,AL,CL,SL,EL],yP=vP.slice(0,-1),bP=yP.slice(0,-1),xP=bP.slice(0,-1),wP=xP.slice(0,-1),kP=[vL,bL],_P=[vL],AP=[[yP,1,hP],[yP,5,5e3],[yP,15,15e3],[yP,30,3e4],[bP,1,dP],[bP,5,3e5],[bP,15,9e5],[bP,30,18e5],[xP,1,fP],[xP,3,108e5],[xP,6,216e5],[xP,12,432e5],[wP,1,pP],[[vL,xL],1,6048e5],[kP,1,gP],[kP,3,7776e6],[_P,1,mP]];function CP(t){const e=t.extent,n=t.maxbins||40,r=Math.abs(function(t){return t&&vB(t)-t[0]||0}(e))/n;let i,a,o=Bu((t=>t[2])).right(AP,r);return o===AP.length?(i=_P,a=HS(e[0]/mP,e[1]/mP,n)):o?(o=AP[r/AP[o-1][2]<AP[o][2]/r?o-1:o],i=o[0],a=o[1]):(i=vP,a=Math.max(HS(e[0],e[1],n),1)),{units:i,step:a}}function SP(t,e,n){return t.fields=e||[],t.fname=n,t}function EP(t){return 1===t.length?TP(t[0]):NP(t)}const TP=t=>function(e){return e[t]},NP=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function FP(t){throw Error(t)}function DP(t){const e=[],n=t.length;let r,i,a,o=null,s=0,c="";function u(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)c+=t.substring(r,i++),r=i;else if(a===o)u(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&u(),s=r=i+1):"]"===a&&(s||FP("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&FP("Access path missing closing bracket: "+t),o&&FP("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function IP(t,e,n){const r=DP(t);return t=1===r.length?r[0]:t,SP((n&&n.get||EP)(r),[t],e||t)}IP("id");const MP=SP((t=>t),[],"identity");SP((()=>0),[],"zero"),SP((()=>1),[],"one"),SP((()=>!0),[],"true"),SP((()=>!1),[],"false");var OP=Array.isArray;function RP(t){return t===Object(t)}function zP(t){return null==t||""===t?null:+t}function BP(t){return"function"===typeof t}function LP(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const PP=Object.prototype.hasOwnProperty;function jP(t,e){return PP.call(t,e)}function UP(t){return"string"===typeof t}function WP(t){return OP(t)?"["+t.map(WP)+"]":RP(t)||UP(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}const VP=t=>function(t){return"number"===typeof t}(t)||function(t){return"[object Date]"===Object.prototype.toString.call(t)}(t)?t:Date.parse(t);var qP={},GP={},HP=34,YP=10,XP=13;function KP(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function QP(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function ZP(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function $P(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":function(t){return t<0?"-"+ZP(-t,6):t>9999?"+"+ZP(t,6):ZP(t,4)}(t.getUTCFullYear())+"-"+ZP(t.getUTCMonth()+1,2)+"-"+ZP(t.getUTCDate(),2)+(i?"T"+ZP(e,2)+":"+ZP(n,2)+":"+ZP(r,2)+"."+ZP(i,3)+"Z":r?"T"+ZP(e,2)+":"+ZP(n,2)+":"+ZP(r,2)+"Z":n||e?"T"+ZP(e,2)+":"+ZP(n,2)+"Z":"")}function JP(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],a=t.length,o=0,s=0,c=a<=0,u=!1;function l(){if(c)return GP;if(u)return u=!1,qP;var e,r,i=o;if(t.charCodeAt(i)===HP){for(;o++<a&&t.charCodeAt(o)!==HP||t.charCodeAt(++o)===HP;);return(e=o)>=a?c=!0:(r=t.charCodeAt(o++))===YP?u=!0:r===XP&&(u=!0,t.charCodeAt(o)===YP&&++o),t.slice(i+1,e-1).replace(/""/g,'"')}for(;o<a;){if((r=t.charCodeAt(e=o++))===YP)u=!0;else if(r===XP)u=!0,t.charCodeAt(o)===YP&&++o;else if(r!==n)continue;return t.slice(i,e)}return c=!0,t.slice(i,a)}for(t.charCodeAt(a-1)===YP&&--a,t.charCodeAt(a-1)===XP&&--a;(r=l())!==GP;){for(var h=[];r!==qP&&r!==GP;)h.push(r),r=l();e&&null==(h=e(h,s++))||i.push(h)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return o(e[t])})).join(t)}))}function a(e){return e.map(o).join(t)}function o(t){return null==t?"":t instanceof Date?$P(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,a=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=KP(t);return function(r,i){return e(n(r),i,t)}}(t,e):KP(t)}));return a.columns=i||[],a},parseRows:r,format:function(e,n){return null==n&&(n=QP(e)),[n.map(o).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=QP(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(a).join("\n")},formatRow:a,formatValue:o}}const tj=Math.sqrt(50),ej=Math.sqrt(10),nj=Math.sqrt(2);function rj(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=tj?10:a>=ej?5:a>=nj?2:1;let s,c,u;return i<0?(u=Math.pow(10,-i)/o,s=Math.round(t*u),c=Math.round(e*u),s/u<t&&++s,c/u>e&&--c,u=-u):(u=Math.pow(10,i)*o,s=Math.round(t/u),c=Math.round(e/u),s*u<t&&++s,c*u>e&&--c),c<s&&.5<=n&&n<2?rj(t,e,2*n):[s,c,u]}function ij(t,e,n){return rj(t=+t,e=+e,n=+n)[2]}const aj="year",oj="quarter",sj="month",cj="week",uj="date",lj="day",hj="dayofyear",dj="hours",fj="minutes",pj="seconds",gj="milliseconds";[aj,oj,sj,cj,uj,lj,hj,dj,fj,pj,gj].reduce(((t,e,n)=>(t[e]=1+n,t)),{});"".concat(aj,"-").concat(sj),"".concat(aj,"-").concat(sj,"-").concat(uj),"".concat(dj,"-").concat(fj);new Date;const mj={[aj]:mi,[oj]:yi.every(3),[sj]:yi,[cj]:ei,[uj]:Zr,[lj]:Zr,[hj]:Zr,[dj]:xi,[fj]:ki,[pj]:Ai,[gj]:Ci},vj={[aj]:vi,[oj]:bi.every(3),[sj]:bi,[cj]:ui,[uj]:$r,[lj]:$r,[hj]:$r,[dj]:wi,[fj]:_i,[pj]:Ai,[gj]:Ci};function yj(t){return mj[t]}function bj(t){return vj[t]}const xj=[aj,sj,uj,dj,fj,pj,gj],wj=xj.slice(0,-1),kj=wj.slice(0,-1),_j=kj.slice(0,-1);_j.slice(0,-1);function Aj(t){const e={};return n=>e[n]||(e[n]=t(n))}function Cj(t){const e=Aj(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(t){const n=Cr(t||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(t,e){return n=>{const r=t(n),i=r.indexOf(e);if(i<0)return r;let a=function(t,e){let n,r=t.lastIndexOf("e");if(r>0)return r;for(r=t.length;--r>e;)if(n=t.charCodeAt(r),n>=48&&n<=57)return r+1}(r,i);const o=a<r.length?r.slice(a):"";for(;--a>i;)if("0"!==r[a]){++a;break}return r.slice(0,a)+o}}(e(n),e(".1f")(1)[1])}return e(n)},formatSpan(t,r,i,a){a=Cr(null==a?",f":a);const o=function(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?ij(e,t,n):ij(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}(t,r,i),s=Math.max(Math.abs(t),Math.abs(r));let c;if(null==a.precision)switch(a.type){case"s":return isNaN(c=Nr(o,s))||(a.precision=c),n(a,s);case"":case"e":case"g":case"p":case"r":isNaN(c=Fr(o,s))||(a.precision=c-("e"===a.type));break;case"f":case"%":isNaN(c=Dr(o))||(a.precision=c-2*("%"===a.type))}return e(a)}}}let Sj,Ej;function Tj(){return Sj=Cj({format:zr,formatPrefix:Br})}function Nj(t,e,n){RP(n=n||{})||FP("Invalid time multi-format specifier: ".concat(n));const r=e(pj),i=e(fj),a=e(dj),o=e(uj),s=e(cj),c=e(sj),u=e(oj),l=e(aj),h=t(n[gj]||".%L"),d=t(n[pj]||":%S"),f=t(n[fj]||"%I:%M"),p=t(n[dj]||"%I %p"),g=t(n[uj]||n[lj]||"%a %d"),m=t(n[cj]||"%b %d"),v=t(n[sj]||"%B"),y=t(n[oj]||"%B"),b=t(n[aj]||"%Y");return t=>(r(t)<t?h:i(t)<t?d:a(t)<t?f:o(t)<t?p:c(t)<t?s(t)<t?g:m:l(t)<t?u(t)<t?v:y:b)(t)}function Fj(t){const e=Aj(t.format),n=Aj(t.utcFormat);return{timeFormat:t=>UP(t)?e(t):Nj(e,yj,t),utcFormat:t=>UP(t)?n(t):Nj(n,bj,t),timeParse:Aj(t.parse),utcParse:Aj(t.utcParse)}}function Dj(){return Ej=Fj({format:ja,parse:Ua,utcFormat:Wa,utcParse:Va})}function Ij(t){return Fj(La(t))}function Mj(t){return arguments.length?Ej=Ij(t):Ej}Tj(),Dj();const Oj=/^(data:|([A-Za-z]+:)?\/\/)/,Rj=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,zj=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Bj="file://";async function Lj(t,e){const n=await this.sanitize(t,e),r=n.href;return n.localFile?this.file(r):this.http(r,e)}async function Pj(t,e){e=LP({},this.options,e);const n=this.fileAccess,r={href:null};let i,a,o;const s=Rj.test(t.replace(zj,""));null!=t&&"string"===typeof t&&s||FP("Sanitize failure, invalid URI: "+WP(t));const c=Oj.test(t);return(o=e.baseURL)&&!c&&(t.startsWith("/")||o.endsWith("/")||(t="/"+t),t=o+t),a=(i=t.startsWith(Bj))||"file"===e.mode||"http"!==e.mode&&!c&&n,i?t=t.slice(Bj.length):t.startsWith("//")&&("file"===e.defaultProtocol?(t=t.slice(2),a=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(r,"localFile",{value:!!a}),r.href=t,e.target&&(r.target=e.target+""),e.rel&&(r.rel=e.rel+""),"image"===e.context&&e.crossOrigin&&(r.crossOrigin=e.crossOrigin+""),r}function jj(t){return t?e=>new Promise(((n,r)=>{t.readFile(e,((t,e)=>{t?r(t):n(e)}))})):Uj}async function Uj(){FP("No file system access.")}function Wj(t){return t?async function(e,n){const r=LP({},this.options.http,n),i=n&&n.response,a=await t(e,r);return a.ok?BP(a[i])?a[i]():a.text():FP(a.status+""+a.statusText)}:Vj}async function Vj(){FP("No HTTP fetch method available.")}const qj=t=>null!=t&&t===t,Gj=t=>!Number.isNaN(+t)&&!(t instanceof Date),Hj={boolean:function(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t},integer:zP,number:zP,date:function(t,e){return e=e||VP,null==t||""===t?null:e(t)},string:function(t){return null==t||""===t?null:t+""},unknown:MP},Yj=[t=>"true"===t||"false"===t||!0===t||!1===t,t=>Gj(t)&&Number.isInteger(+t),Gj,t=>!Number.isNaN(Date.parse(t))],Xj=["boolean","integer","number","date"];function Kj(t,e){if(!t||!t.length)return"unknown";const n=t.length,r=Yj.length,i=Yj.map(((t,e)=>e+1));for(let a,o,s=0,c=0;s<n;++s)for(o=e?t[s][e]:t[s],a=0;a<r;++a)if(i[a]&&qj(o)&&!Yj[a](o)&&(i[a]=0,++c,c===Yj.length))return"string";return Xj[i.reduce(((t,e)=>0===t?e:t),0)-1]}function Qj(t,e){return e.reduce(((e,n)=>(e[n]=Kj(t,n),e)),{})}function Zj(t){const e=function(e,n){const r={delimiter:t};return $j(e,n?LP(n,r):r)};return e.responseType="text",e}function $j(t,e){return e.header&&(t=e.header.map(WP).join(e.delimiter)+"\n"+t),JP(e.delimiter).parse(t+"")}function Jj(t,e){const n=e&&e.property?IP(e.property):MP;return!RP(t)||(r=t,"function"===typeof Buffer&&BP(Buffer.isBuffer)&&Buffer.isBuffer(r))?n(JSON.parse(t)):function(t,e){!OP(t)&&function(t){return t&&BP(t[Symbol.iterator])}(t)&&(t=[...t]);return e&&e.copy?JSON.parse(JSON.stringify(t)):t}(n(t),e);var r}$j.responseType="text",Jj.responseType="json";const tU={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function eU(t,e){let n,r,i,a;return t=Jj(t,e),e&&e.feature?(n=dr,i=e.feature):e&&e.mesh?(n=mr,i=e.mesh,a=tU[e.filter]):FP("Missing TopoJSON feature or mesh parameter."),r=(r=t.objects[i])?n(t,r,a):FP("Invalid TopoJSON object: "+i),r&&r.features||[r]}eU.responseType="json";const nU={dsv:$j,csv:Zj(","),tsv:Zj("\t"),json:Jj,topojson:eU};function rU(t,e){return arguments.length>1?(nU[t]=e,this):jP(nU,t)?nU[t]:null}function iU(t){const e=rU(t);return e&&e.responseType||"text"}function aU(t,e,n,r){const i=rU((e=e||{}).type||"json");return i||FP("Unknown data format type: "+e.type),t=i(t,e),e.parse&&function(t,e,n,r){if(!t.length)return;const i=Mj();n=n||i.timeParse,r=r||i.utcParse;let a,o,s,c,u,l,h=t.columns||Object.keys(t[0]);"auto"===e&&(e=Qj(t,h));h=Object.keys(e);const d=h.map((t=>{const i=e[t];let a,o;if(i&&(i.startsWith("date:")||i.startsWith("utc:"))){a=i.split(/:(.+)?/,2),o=a[1],("'"===o[0]&&"'"===o[o.length-1]||'"'===o[0]&&'"'===o[o.length-1])&&(o=o.slice(1,-1));return("utc"===a[0]?r:n)(o)}if(!Hj[i])throw Error("Illegal format pattern: "+t+":"+i);return Hj[i]}));for(s=0,u=t.length,l=h.length;s<u;++s)for(a=t[s],c=0;c<l;++c)o=h[c],a[o]=d[c](a[o])}(t,e.parse,n,r),jP(t,"columns")&&delete t.columns,t}const oU=function(t,e){return n=>({options:n||{},sanitize:Pj,load:Lj,fileAccess:!!e,file:jj(e),http:Wj(t)})}("undefined"!==typeof fetch&&fetch,null);function sU(t,e,n){return t.fields=e||[],t.fname=n,t}function cU(t){return 1===t.length?uU(t[0]):lU(t)}const uU=t=>function(e){return e[t]},lU=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function hU(t){throw Error(t)}function dU(t){const e=[],n=t.length;let r,i,a,o=null,s=0,c="";function u(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)c+=t.substring(r,i++),r=i;else if(a===o)u(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&u(),s=r=i+1):"]"===a&&(s||hU("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&hU("Access path missing closing bracket: "+t),o&&hU("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function fU(t,e,n){const r=dU(t);return t=1===r.length?r[0]:t,sU((n&&n.get||cU)(r),[t],e||t)}fU("id");const pU=sU((t=>t),[],"identity"),gU=(sU((()=>0),[],"zero"),sU((()=>1),[],"one"),sU((()=>!0),[],"true"));sU((()=>!1),[],"false");var mU=Array.isArray;function vU(t){return t===Object(t)}function yU(t){return t[t.length-1]}function bU(t){return null==t||""===t?null:+t}function xU(t){return null!=t?mU(t)?t:[t]:[]}function wU(t){return"function"===typeof t}function kU(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const _U=Object.prototype.hasOwnProperty;function AU(t,e){return _U.call(t,e)}function CU(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),kU(r,n)}function SU(t){return"number"===typeof t}function EU(t){return"string"===typeof t}function TU(t){return mU(t)?"["+t.map(TU)+"]":vU(t)||EU(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function NU(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function FU(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function DU(t){this._context=t}function IU(){}function MU(t){this._context=t}function OU(t){this._context=t}function RU(t,e){this._basis=new DU(t),this._beta=e}DU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:FU(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:FU(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},MU.prototype={areaStart:IU,areaEnd:IU,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:FU(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},OU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:FU(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},RU.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],a=e[0],o=t[n]-i,s=e[n]-a,c=-1;++c<=n;)r=c/n,this._basis.point(this._beta*t[c]+(1-this._beta)*(i+r*o),this._beta*e[c]+(1-this._beta)*(a+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};const zU=function t(e){function n(t){return 1===e?new DU(t):new RU(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function BU(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function LU(t,e){this._context=t,this._k=(1-e)/6}LU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:BU(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:BU(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const PU=function t(e){function n(t){return new LU(t,e)}return n.tension=function(e){return t(+e)},n}(0);function jU(t,e){this._context=t,this._k=(1-e)/6}jU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:BU(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const UU=function t(e){function n(t){return new jU(t,e)}return n.tension=function(e){return t(+e)},n}(0);function WU(t,e){this._context=t,this._k=(1-e)/6}WU.prototype={areaStart:IU,areaEnd:IU,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:BU(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const VU=function t(e){function n(t){return new WU(t,e)}return n.tension=function(e){return t(+e)},n}(0);var qU=Math.abs,GU=Math.atan2,HU=Math.cos,YU=Math.max,XU=Math.min,KU=Math.sin,QU=Math.sqrt,ZU=1e-12,$U=Math.PI,JU=$U/2,tW=2*$U;function eW(t){return t>=1?JU:t<=-1?-JU:Math.asin(t)}function nW(t,e,n){var r=t._x1,i=t._y1,a=t._x2,o=t._y2;if(t._l01_a>ZU){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>ZU){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,l=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*u+t._x1*t._l23_2a-e*t._l12_2a)/l,o=(o*u+t._y1*t._l23_2a-n*t._l12_2a)/l}t._context.bezierCurveTo(r,i,a,o,t._x2,t._y2)}function rW(t,e){this._context=t,this._alpha=e}rW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:nW(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const iW=function t(e){function n(t){return e?new rW(t,e):new LU(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function aW(t,e){this._context=t,this._alpha=e}aW.prototype={areaStart:IU,areaEnd:IU,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:nW(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const oW=function t(e){function n(t){return e?new aW(t,e):new WU(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function sW(t,e){this._context=t,this._alpha=e}sW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:nW(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const cW=function t(e){function n(t){return e?new sW(t,e):new jU(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function uW(t){this._context=t}function lW(t){return new uW(t)}function hW(t){this._context=t}function dW(t){return t<0?-1:1}function fW(t,e,n){var r=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(r||i<0&&-0),o=(n-t._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(dW(a)+dW(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function pW(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function gW(t,e,n){var r=t._x0,i=t._y0,a=t._x1,o=t._y1,s=(a-r)/3;t._context.bezierCurveTo(r+s,i+s*e,a-s,o-s*n,a,o)}function mW(t){this._context=t}function vW(t){this._context=new yW(t)}function yW(t){this._context=t}function bW(t){this._context=t}function xW(t){var e,n,r=t.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(i[r-1]=o[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(o[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function wW(t,e){this._context=t,this._t=e}uW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}},hW.prototype={areaStart:IU,areaEnd:IU,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},mW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:gW(this,this._t0,pW(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,gW(this,pW(this,n=fW(this,t,e)),n);break;default:gW(this,this._t0,n=fW(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(vW.prototype=Object.create(mW.prototype)).point=function(t,e){mW.prototype.point.call(this,e,t)},yW.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,a){this._context.bezierCurveTo(e,t,r,n,a,i)}},bW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=xW(t),i=xW(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},wW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};const kW=Math.PI,_W=2*kW,AW=1e-6,CW=_W-AW;function SW(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function EW(){return new SW}SW.prototype=EW.prototype={constructor:SW,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-t,c=r-e,u=a-t,l=o-e,h=u*u+l*l;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>AW)if(Math.abs(l*s-c*u)>AW&&i){var d=n-a,f=r-o,p=s*s+c*c,g=d*d+f*f,m=Math.sqrt(p),v=Math.sqrt(h),y=i*Math.tan((kW-Math.acos((p+h-g)/(2*m*v)))/2),b=y/v,x=y/m;Math.abs(b-1)>AW&&(this._+="L"+(t+b*u)+","+(e+b*l)),this._+="A"+i+","+i+",0,0,"+ +(l*d>u*f)+","+(this._x1=t+x*s)+","+(this._y1=e+x*c)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,a){t=+t,e=+e,a=!!a;var o=(n=+n)*Math.cos(r),s=n*Math.sin(r),c=t+o,u=e+s,l=1^a,h=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+c+","+u:(Math.abs(this._x1-c)>AW||Math.abs(this._y1-u)>AW)&&(this._+="L"+c+","+u),n&&(h<0&&(h=h%_W+_W),h>CW?this._+="A"+n+","+n+",0,1,"+l+","+(t-o)+","+(e-s)+"A"+n+","+n+",0,1,"+l+","+(this._x1=c)+","+(this._y1=u):h>AW&&(this._+="A"+n+","+n+",0,"+ +(h>=kW)+","+l+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};const TW=EW;function NW(t){return function(){return t}}function FW(t){return t.innerRadius}function DW(t){return t.outerRadius}function IW(t){return t.startAngle}function MW(t){return t.endAngle}function OW(t){return t&&t.padAngle}function RW(t,e,n,r,i,a,o){var s=t-n,c=e-r,u=(o?a:-a)/QU(s*s+c*c),l=u*c,h=-u*s,d=t+l,f=e+h,p=n+l,g=r+h,m=(d+p)/2,v=(f+g)/2,y=p-d,b=g-f,x=y*y+b*b,w=i-a,k=d*g-p*f,_=(b<0?-1:1)*QU(YU(0,w*w*x-k*k)),A=(k*b-y*_)/x,C=(-k*y-b*_)/x,S=(k*b+y*_)/x,E=(-k*y+b*_)/x,T=A-m,N=C-v,F=S-m,D=E-v;return T*T+N*N>F*F+D*D&&(A=S,C=E),{cx:A,cy:C,x01:-l,y01:-h,x11:A*(i/w-1),y11:C*(i/w-1)}}Array.prototype.slice;function zW(t){return"object"===typeof t&&"length"in t?t:Array.from(t)}function BW(t){return t[0]}function LW(t){return t[1]}function PW(t,e){var n=NW(!0),r=null,i=lW,a=null;function o(o){var s,c,u,l=(o=zW(o)).length,h=!1;for(null==r&&(a=i(u=TW())),s=0;s<=l;++s)!(s<l&&n(c=o[s],s,o))===h&&((h=!h)?a.lineStart():a.lineEnd()),h&&a.point(+t(c,s,o),+e(c,s,o));if(u)return a=null,u+""||null}return t="function"===typeof t?t:void 0===t?BW:NW(t),e="function"===typeof e?e:void 0===e?LW:NW(e),o.x=function(e){return arguments.length?(t="function"===typeof e?e:NW(+e),o):t},o.y=function(t){return arguments.length?(e="function"===typeof t?t:NW(+t),o):e},o.defined=function(t){return arguments.length?(n="function"===typeof t?t:NW(!!t),o):n},o.curve=function(t){return arguments.length?(i=t,null!=r&&(a=i(r)),o):i},o.context=function(t){return arguments.length?(null==t?r=a=null:a=i(r=t),o):r},o}function jW(t,e,n){var r=null,i=NW(!0),a=null,o=lW,s=null;function c(c){var u,l,h,d,f,p=(c=zW(c)).length,g=!1,m=new Array(p),v=new Array(p);for(null==a&&(s=o(f=TW())),u=0;u<=p;++u){if(!(u<p&&i(d=c[u],u,c))===g)if(g=!g)l=u,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=u-1;h>=l;--h)s.point(m[h],v[h]);s.lineEnd(),s.areaEnd()}g&&(m[u]=+t(d,u,c),v[u]=+e(d,u,c),s.point(r?+r(d,u,c):m[u],n?+n(d,u,c):v[u]))}if(f)return s=null,f+""||null}function u(){return PW().defined(i).curve(o).context(a)}return t="function"===typeof t?t:void 0===t?BW:NW(+t),e="function"===typeof e?e:NW(void 0===e?0:+e),n="function"===typeof n?n:void 0===n?LW:NW(+n),c.x=function(e){return arguments.length?(t="function"===typeof e?e:NW(+e),r=null,c):t},c.x0=function(e){return arguments.length?(t="function"===typeof e?e:NW(+e),c):t},c.x1=function(t){return arguments.length?(r=null==t?null:"function"===typeof t?t:NW(+t),c):r},c.y=function(t){return arguments.length?(e="function"===typeof t?t:NW(+t),n=null,c):e},c.y0=function(t){return arguments.length?(e="function"===typeof t?t:NW(+t),c):e},c.y1=function(t){return arguments.length?(n=null==t?null:"function"===typeof t?t:NW(+t),c):n},c.lineX0=c.lineY0=function(){return u().x(t).y(e)},c.lineY1=function(){return u().x(t).y(n)},c.lineX1=function(){return u().x(r).y(e)},c.defined=function(t){return arguments.length?(i="function"===typeof t?t:NW(!!t),c):i},c.curve=function(t){return arguments.length?(o=t,null!=a&&(s=o(a)),c):o},c.context=function(t){return arguments.length?(null==t?a=s=null:s=o(a=t),c):a},c}const UW={draw:function(t,e){var n=Math.sqrt(e/$U);t.moveTo(n,0),t.arc(0,0,n,0,tW)}};Math.sqrt(1/3);var WW=Math.sin($U/10)/Math.sin(7*$U/10);Math.sin(tW/10),Math.cos(tW/10);Math.sqrt(3);Math.sqrt(3),Math.sqrt(12);const VW=Math.sqrt(50),qW=Math.sqrt(10),GW=Math.sqrt(2);function HW(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=VW?10:a>=qW?5:a>=GW?2:1;let s,c,u;return i<0?(u=Math.pow(10,-i)/o,s=Math.round(t*u),c=Math.round(e*u),s/u<t&&++s,c/u>e&&--c,u=-u):(u=Math.pow(10,i)*o,s=Math.round(t/u),c=Math.round(e/u),s*u<t&&++s,c*u>e&&--c),c<s&&.5<=n&&n<2?HW(t,e,2*n):[s,c,u]}function YW(t,e,n){return HW(t=+t,e=+e,n=+n)[2]}const XW="year",KW="quarter",QW="month",ZW="week",$W="date",JW="day",tV="dayofyear",eV="hours",nV="minutes",rV="seconds",iV="milliseconds";[XW,KW,QW,ZW,$W,JW,tV,eV,nV,rV,iV].reduce(((t,e,n)=>(t[e]=1+n,t)),{});"".concat(XW,"-").concat(QW),"".concat(XW,"-").concat(QW,"-").concat($W),"".concat(eV,"-").concat(nV);new Date;const aV={[XW]:mi,[KW]:yi.every(3),[QW]:yi,[ZW]:ei,[$W]:Zr,[JW]:Zr,[tV]:Zr,[eV]:xi,[nV]:ki,[rV]:Ai,[iV]:Ci},oV={[XW]:vi,[KW]:bi.every(3),[QW]:bi,[ZW]:ui,[$W]:$r,[JW]:$r,[tV]:$r,[eV]:wi,[nV]:_i,[rV]:Ai,[iV]:Ci};function sV(t){return aV[t]}function cV(t){return oV[t]}const uV=[XW,QW,$W,eV,nV,rV,iV],lV=uV.slice(0,-1),hV=lV.slice(0,-1),dV=hV.slice(0,-1);dV.slice(0,-1);function fV(t){const e={};return n=>e[n]||(e[n]=t(n))}function pV(t){const e=fV(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(t){const n=Cr(t||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(t,e){return n=>{const r=t(n),i=r.indexOf(e);if(i<0)return r;let a=function(t,e){let n,r=t.lastIndexOf("e");if(r>0)return r;for(r=t.length;--r>e;)if(n=t.charCodeAt(r),n>=48&&n<=57)return r+1}(r,i);const o=a<r.length?r.slice(a):"";for(;--a>i;)if("0"!==r[a]){++a;break}return r.slice(0,a)+o}}(e(n),e(".1f")(1)[1])}return e(n)},formatSpan(t,r,i,a){a=Cr(null==a?",f":a);const o=function(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?YW(e,t,n):YW(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}(t,r,i),s=Math.max(Math.abs(t),Math.abs(r));let c;if(null==a.precision)switch(a.type){case"s":return isNaN(c=Nr(o,s))||(a.precision=c),n(a,s);case"":case"e":case"g":case"p":case"r":isNaN(c=Fr(o,s))||(a.precision=c-("e"===a.type));break;case"f":case"%":isNaN(c=Dr(o))||(a.precision=c-2*("%"===a.type))}return e(a)}}}let gV,mV;function vV(){return gV=pV({format:zr,formatPrefix:Br})}function yV(t,e,n){vU(n=n||{})||hU("Invalid time multi-format specifier: ".concat(n));const r=e(rV),i=e(nV),a=e(eV),o=e($W),s=e(ZW),c=e(QW),u=e(KW),l=e(XW),h=t(n[iV]||".%L"),d=t(n[rV]||":%S"),f=t(n[nV]||"%I:%M"),p=t(n[eV]||"%I %p"),g=t(n[$W]||n[JW]||"%a %d"),m=t(n[ZW]||"%b %d"),v=t(n[QW]||"%B"),y=t(n[KW]||"%B"),b=t(n[XW]||"%Y");return t=>(r(t)<t?h:i(t)<t?d:a(t)<t?f:o(t)<t?p:c(t)<t?s(t)<t?g:m:l(t)<t?u(t)<t?v:y:b)(t)}function bV(t){const e=fV(t.format),n=fV(t.utcFormat);return{timeFormat:t=>EU(t)?e(t):yV(e,sV,t),utcFormat:t=>EU(t)?n(t):yV(n,cV,t),timeParse:fV(t.parse),utcParse:fV(t.utcParse)}}function xV(){return mV=bV({format:ja,parse:Ua,utcFormat:Wa,utcParse:Va})}vV(),xV();const wV=/^(data:|([A-Za-z]+:)?\/\/)/,kV=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,_V=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,AV="file://";async function CV(t,e){const n=await this.sanitize(t,e),r=n.href;return n.localFile?this.file(r):this.http(r,e)}async function SV(t,e){e=kU({},this.options,e);const n=this.fileAccess,r={href:null};let i,a,o;const s=kV.test(t.replace(_V,""));null!=t&&"string"===typeof t&&s||hU("Sanitize failure, invalid URI: "+TU(t));const c=wV.test(t);return(o=e.baseURL)&&!c&&(t.startsWith("/")||o.endsWith("/")||(t="/"+t),t=o+t),a=(i=t.startsWith(AV))||"file"===e.mode||"http"!==e.mode&&!c&&n,i?t=t.slice(AV.length):t.startsWith("//")&&("file"===e.defaultProtocol?(t=t.slice(2),a=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(r,"localFile",{value:!!a}),r.href=t,e.target&&(r.target=e.target+""),e.rel&&(r.rel=e.rel+""),"image"===e.context&&e.crossOrigin&&(r.crossOrigin=e.crossOrigin+""),r}function EV(t){return t?e=>new Promise(((n,r)=>{t.readFile(e,((t,e)=>{t?r(t):n(e)}))})):TV}async function TV(){hU("No file system access.")}function NV(t){return t?async function(e,n){const r=kU({},this.options.http,n),i=n&&n.response,a=await t(e,r);return a.ok?wU(a[i])?a[i]():a.text():hU(a.status+""+a.statusText)}:FV}async function FV(){hU("No HTTP fetch method available.")}function DV(t){const e=function(e,n){const r={delimiter:t};return IV(e,n?kU(n,r):r)};return e.responseType="text",e}function IV(t,e){return e.header&&(t=e.header.map(TU).join(e.delimiter)+"\n"+t),lr(e.delimiter).parse(t+"")}function MV(t,e){const n=e&&e.property?fU(e.property):pU;return!vU(t)||(r=t,"function"===typeof Buffer&&wU(Buffer.isBuffer)&&Buffer.isBuffer(r))?n(JSON.parse(t)):function(t,e){!mU(t)&&function(t){return t&&wU(t[Symbol.iterator])}(t)&&(t=[...t]);return e&&e.copy?JSON.parse(JSON.stringify(t)):t}(n(t),e);var r}IV.responseType="text",MV.responseType="json";const OV={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function RV(t,e){let n,r,i,a;return t=MV(t,e),e&&e.feature?(n=dr,i=e.feature):e&&e.mesh?(n=mr,i=e.mesh,a=OV[e.filter]):hU("Missing TopoJSON feature or mesh parameter."),r=(r=t.objects[i])?n(t,r,a):hU("Invalid TopoJSON object: "+i),r&&r.features||[r]}RV.responseType="json";DV(","),DV("\t");const zV=function(t,e){return n=>({options:n||{},sanitize:SV,load:CV,fileAccess:!!e,file:EV(e),http:NV(t)})}("undefined"!==typeof fetch&&fetch,null);function BV(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function LV(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function PV(t){let e,n,r;function i(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<0?i=e+1:a=e}while(i<a)}return i}return 2!==t.length?(e=BV,n=(e,n)=>BV(t(e),n),r=(e,n)=>t(e)-n):(e=t===BV||t===LV?t:jV,n=t,r=t),{left:i,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=i(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return a>n&&r(t[a-1],e)>-r(t[a],e)?a-1:a},right:function(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<=0?i=e+1:a=e}while(i<a)}return i}}}function jV(){return 0}const UV=PV(BV),WV=UV.right,VV=(UV.left,PV((function(t){return null===t?NaN:+t})).center,WV);function qV(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function GV(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function HV(){}var YV=.7,XV=1.4285714285714286,KV="\\s*([+-]?\\d+)\\s*",QV="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ZV="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",$V=/^#([0-9a-f]{3,8})$/,JV=new RegExp("^rgb\\(".concat(KV,",").concat(KV,",").concat(KV,"\\)$")),tq=new RegExp("^rgb\\(".concat(ZV,",").concat(ZV,",").concat(ZV,"\\)$")),eq=new RegExp("^rgba\\(".concat(KV,",").concat(KV,",").concat(KV,",").concat(QV,"\\)$")),nq=new RegExp("^rgba\\(".concat(ZV,",").concat(ZV,",").concat(ZV,",").concat(QV,"\\)$")),rq=new RegExp("^hsl\\(".concat(QV,",").concat(ZV,",").concat(ZV,"\\)$")),iq=new RegExp("^hsla\\(".concat(QV,",").concat(ZV,",").concat(ZV,",").concat(QV,"\\)$")),aq={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function oq(){return this.rgb().formatHex()}function sq(){return this.rgb().formatRgb()}function cq(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=$V.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?uq(e):3===n?new fq(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?lq(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?lq(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=JV.exec(t))?new fq(e[1],e[2],e[3],1):(e=tq.exec(t))?new fq(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=eq.exec(t))?lq(e[1],e[2],e[3],e[4]):(e=nq.exec(t))?lq(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=rq.exec(t))?bq(e[1],e[2]/100,e[3]/100,1):(e=iq.exec(t))?bq(e[1],e[2]/100,e[3]/100,e[4]):aq.hasOwnProperty(t)?uq(aq[t]):"transparent"===t?new fq(NaN,NaN,NaN,0):null}function uq(t){return new fq(t>>16&255,t>>8&255,255&t,1)}function lq(t,e,n,r){return r<=0&&(t=e=n=NaN),new fq(t,e,n,r)}function hq(t){return t instanceof HV||(t=cq(t)),t?new fq((t=t.rgb()).r,t.g,t.b,t.opacity):new fq}function dq(t,e,n,r){return 1===arguments.length?hq(t):new fq(t,e,n,null==r?1:r)}function fq(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function pq(){return"#".concat(yq(this.r)).concat(yq(this.g)).concat(yq(this.b))}function gq(){const t=mq(this.opacity);return"".concat(1===t?"rgb(":"rgba(").concat(vq(this.r),", ").concat(vq(this.g),", ").concat(vq(this.b)).concat(1===t?")":", ".concat(t,")"))}function mq(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function vq(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function yq(t){return((t=vq(t))<16?"0":"")+t.toString(16)}function bq(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new kq(t,e,n,r)}function xq(t){if(t instanceof kq)return new kq(t.h,t.s,t.l,t.opacity);if(t instanceof HV||(t=cq(t)),!t)return new kq;if(t instanceof kq)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new kq(o,s,c,t.opacity)}function wq(t,e,n,r){return 1===arguments.length?xq(t):new kq(t,e,n,null==r?1:r)}function kq(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function _q(t){return(t=(t||0)%360)<0?t+360:t}function Aq(t){return Math.max(0,Math.min(1,t||0))}function Cq(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Sq(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}function Eq(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,s=r<e-1?t[r+2]:2*a-i;return Sq((n-r/e)*e,o,i,a,s)}}function Tq(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],s=t[(r+2)%e];return Sq((n-r/e)*e,i,a,o,s)}}qV(HV,cq,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:oq,formatHex:oq,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return xq(this).formatHsl()},formatRgb:sq,toString:sq}),qV(fq,dq,GV(HV,{brighter(t){return t=null==t?XV:Math.pow(XV,t),new fq(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?YV:Math.pow(YV,t),new fq(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new fq(vq(this.r),vq(this.g),vq(this.b),mq(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:pq,formatHex:pq,formatHex8:function(){return"#".concat(yq(this.r)).concat(yq(this.g)).concat(yq(this.b)).concat(yq(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:gq,toString:gq})),qV(kq,wq,GV(HV,{brighter(t){return t=null==t?XV:Math.pow(XV,t),new kq(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?YV:Math.pow(YV,t),new kq(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new fq(Cq(t>=240?t-240:t+120,i,r),Cq(t,i,r),Cq(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new kq(_q(this.h),Aq(this.s),Aq(this.l),mq(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=mq(this.opacity);return"".concat(1===t?"hsl(":"hsla(").concat(_q(this.h),", ").concat(100*Aq(this.s),"%, ").concat(100*Aq(this.l),"%").concat(1===t?")":", ".concat(t,")"))}}));const Nq=t=>()=>t;function Fq(t,e){return function(n){return t+n*e}}function Dq(t,e){var n=e-t;return n?Fq(t,n>180||n<-180?n-360*Math.round(n/360):n):Nq(isNaN(t)?e:t)}function Iq(t){return 1===(t=+t)?Mq:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Nq(isNaN(e)?n:e)}}function Mq(t,e){var n=e-t;return n?Fq(t,n):Nq(isNaN(t)?e:t)}const Oq=function t(e){var n=Iq(e);function r(t,e){var r=n((t=dq(t)).r,(e=dq(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=Mq(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function Rq(t){return function(e){var n,r,i=e.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=dq(e[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=t(a),o=t(o),s=t(s),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=s(t),r+""}}}var zq=Rq(Eq),Bq=Rq(Tq);function Lq(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(a){for(n=0;n<r;++n)i[n]=t[n]*(1-a)+e[n]*a;return i}}function Pq(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function jq(t,e){return(Pq(e)?Lq:Uq)(t,e)}function Uq(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=Xq(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}function Wq(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Vq(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function qq(t,e){var n,r={},i={};for(n in null!==t&&"object"===typeof t||(t={}),null!==e&&"object"===typeof e||(e={}),e)n in t?r[n]=Xq(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var Gq=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Hq=new RegExp(Gq.source,"g");function Yq(t,e){var n,r,i,a=Gq.lastIndex=Hq.lastIndex=0,o=-1,s=[],c=[];for(t+="",e+="";(n=Gq.exec(t))&&(r=Hq.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,c.push({i:o,x:Vq(n,r)})),a=Hq.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?c[0]?function(t){return function(e){return t(e)+""}}(c[0].x):function(t){return function(){return t}}(e):(e=c.length,function(t){for(var n,r=0;r<e;++r)s[(n=c[r]).i]=n.x(t);return s.join("")})}function Xq(t,e){var n,r=typeof e;return null==e||"boolean"===r?Nq(e):("number"===r?Vq:"string"===r?(n=cq(e))?(e=n,Oq):Yq:e instanceof cq?Oq:e instanceof Date?Wq:Pq(e)?Lq:Array.isArray(e)?Uq:"function"!==typeof e.valueOf&&"function"!==typeof e.toString||isNaN(e)?qq:Vq)(t,e)}function Kq(t,e){void 0===e&&(e=t,t=Xq);for(var n=0,r=e.length-1,i=e[0],a=new Array(r<0?0:r);n<r;)a[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return a[e](t-e)}}function Qq(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function Zq(t,e){var n=Dq(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}}function $q(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Jq,tG=180/Math.PI,eG={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function nG(t,e,n,r,i,a){var o,s,c;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),t*r<e*n&&(t=-t,e=-e,c=-c,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*tG,skewX:Math.atan(c)*tG,scaleX:o,scaleY:s}}function rG(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var s=[],c=[];return a=t(a),o=t(o),function(t,r,i,a,o,s){if(t!==i||r!==a){var c=o.push("translate(",null,e,null,n);s.push({i:c-4,x:Vq(t,i)},{i:c-2,x:Vq(r,a)})}else(i||a)&&o.push("translate("+i+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,c),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Vq(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(a.rotate,o.rotate,s,c),function(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Vq(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(a.skewX,o.skewX,s,c),function(t,e,n,r,a,o){if(t!==n||e!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:Vq(t,n)},{i:s-2,x:Vq(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,c),a=o=null,function(t){for(var e,n=-1,r=c.length;++n<r;)s[(e=c[n]).i]=e.x(t);return s.join("")}}}var iG=rG((function(t){const e=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?eG:nG(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),aG=rG((function(t){return null==t?eG:(Jq||(Jq=document.createElementNS("http://www.w3.org/2000/svg","g")),Jq.setAttribute("transform",t),(t=Jq.transform.baseVal.consolidate())?nG((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):eG)}),", ",")",")");function oG(t){return((t=Math.exp(t))+1/t)/2}const sG=function t(e,n,r){function i(t,i){var a,o,s=t[0],c=t[1],u=t[2],l=i[0],h=i[1],d=i[2],f=l-s,p=h-c,g=f*f+p*p;if(g<1e-12)o=Math.log(d/u)/e,a=function(t){return[s+t*f,c+t*p,u*Math.exp(e*t*o)]};else{var m=Math.sqrt(g),v=(d*d-u*u+r*g)/(2*u*n*m),y=(d*d-u*u-r*g)/(2*d*n*m),b=Math.log(Math.sqrt(v*v+1)-v),x=Math.log(Math.sqrt(y*y+1)-y);o=(x-b)/e,a=function(t){var r=t*o,i=oG(b),a=u/(n*m)*(i*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(e*r+b)-function(t){return((t=Math.exp(t))-1/t)/2}(b));return[s+a*f,c+a*p,u*i/oG(e*r+b)]}}return a.duration=1e3*o*e/Math.SQRT2,a}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i}(Math.SQRT2,2,4);function cG(t){return function(e,n){var r=t((e=wq(e)).h,(n=wq(n)).h),i=Mq(e.s,n.s),a=Mq(e.l,n.l),o=Mq(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=a(t),e.opacity=o(t),e+""}}}const uG=cG(Dq);var lG=cG(Mq);const hG=Math.PI/180,dG=180/Math.PI,fG=.96422,pG=1,gG=.82521,mG=4/29,vG=6/29,yG=.12841854934601665,bG=.008856451679035631;function xG(t){if(t instanceof kG)return new kG(t.l,t.a,t.b,t.opacity);if(t instanceof NG)return FG(t);t instanceof fq||(t=hq(t));var e,n,r=SG(t.r),i=SG(t.g),a=SG(t.b),o=_G((.2225045*r+.7168786*i+.0606169*a)/pG);return r===i&&i===a?e=n=o:(e=_G((.4360747*r+.3850649*i+.1430804*a)/fG),n=_G((.0139322*r+.0971045*i+.7141733*a)/gG)),new kG(116*o-16,500*(e-o),200*(o-n),t.opacity)}function wG(t,e,n,r){return 1===arguments.length?xG(t):new kG(t,e,n,null==r?1:r)}function kG(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function _G(t){return t>bG?Math.pow(t,1/3):t/yG+mG}function AG(t){return t>vG?t*t*t:yG*(t-mG)}function CG(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function SG(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function EG(t){if(t instanceof NG)return new NG(t.h,t.c,t.l,t.opacity);if(t instanceof kG||(t=xG(t)),0===t.a&&0===t.b)return new NG(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*dG;return new NG(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function TG(t,e,n,r){return 1===arguments.length?EG(t):new NG(t,e,n,null==r?1:r)}function NG(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function FG(t){if(isNaN(t.h))return new kG(t.l,0,0,t.opacity);var e=t.h*hG;return new kG(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function DG(t,e){var n=Mq((t=wG(t)).l,(e=wG(e)).l),r=Mq(t.a,e.a),i=Mq(t.b,e.b),a=Mq(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=a(e),t+""}}function IG(t){return function(e,n){var r=t((e=TG(e)).h,(n=TG(n)).h),i=Mq(e.c,n.c),a=Mq(e.l,n.l),o=Mq(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=a(t),e.opacity=o(t),e+""}}}qV(kG,wG,GV(HV,{brighter(t){return new kG(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker(t){return new kG(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new fq(CG(3.1338561*(e=fG*AG(e))-1.6168667*(t=pG*AG(t))-.4906146*(n=gG*AG(n))),CG(-.9787684*e+1.9161415*t+.033454*n),CG(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),qV(NG,TG,GV(HV,{brighter(t){return new NG(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker(t){return new NG(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb(){return FG(this).rgb()}}));const MG=IG(Dq);var OG=IG(Mq),RG=-.14861,zG=1.78277,BG=-.29227,LG=-.90649,PG=1.97294,jG=PG*LG,UG=PG*zG,WG=zG*BG-LG*RG;function VG(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof qG)return new qG(t.h,t.s,t.l,t.opacity);t instanceof fq||(t=hq(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(WG*r+jG*e-UG*n)/(WG+jG-UG),a=r-i,o=(PG*(n-i)-BG*a)/LG,s=Math.sqrt(o*o+a*a)/(PG*i*(1-i)),c=s?Math.atan2(o,a)*dG-120:NaN;return new qG(c<0?c+360:c,s,i,t.opacity)}(t):new qG(t,e,n,null==r?1:r)}function qG(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function GG(t){return function e(n){function r(e,r){var i=t((e=VG(e)).h,(r=VG(r)).h),a=Mq(e.s,r.s),o=Mq(e.l,r.l),s=Mq(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=a(t),e.l=o(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}qV(qG,VG,GV(HV,{brighter(t){return t=null==t?XV:Math.pow(XV,t),new qG(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?YV:Math.pow(YV,t),new qG(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*hG,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new fq(255*(e+n*(RG*r+zG*i)),255*(e+n*(BG*r+LG*i)),255*(e+n*(PG*r)),this.opacity)}}));const HG=GG(Dq);var YG=GG(Mq);function XG(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}const KG="linear",QG="log",ZG="pow",$G="sqrt",JG="symlog",tH="time",eH="utc",nH="sequential",rH="diverging",iH="quantile",aH="quantize",oH="threshold",sH="continuous",cH="discrete",uH="discretizing",lH="interpolating",hH="temporal";function dH(){const t=jg().unknown(void 0),e=t.domain,n=t.range;let r,i,a=[0,1],o=!1,s=0,c=0,u=.5;function l(){const t=e().length,l=a[1]<a[0],h=a[1-l],d=function(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0}(t,s,c);let f=a[l-0];r=(h-f)/(d||1),o&&(r=Math.floor(r)),f+=(h-f-r*(t-s))*u,i=r*(1-s),o&&(f=Math.round(f),i=Math.round(i));const p=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a}(t).map((t=>f+r*t));return n(l?p.reverse():p)}return delete t.unknown,t.domain=function(t){return arguments.length?(e(t),l()):e()},t.range=function(t){return arguments.length?(a=[+t[0],+t[1]],l()):a.slice()},t.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,l()},t.bandwidth=function(){return i},t.step=function(){return r},t.round=function(t){return arguments.length?(o=!!t,l()):o},t.padding=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),s=c,l()):s},t.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),l()):s},t.paddingOuter=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),l()):c},t.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),l()):u},t.invertRange=function(t){if(null==t[0]||null==t[1])return;const r=a[1]<a[0],o=r?n().reverse():n(),s=o.length-1;let c,u,l,h=+t[0],d=+t[1];return h!==h||d!==d||(d<h&&(l=h,h=d,d=l),d<o[0]||h>a[1-r])?void 0:(c=Math.max(0,WV(o,h)-1),u=h===d?c:WV(o,d)-1,h-o[c]>i+1e-10&&++c,r&&(l=c,c=s-u,u=s-l),c>u?void 0:e().slice(c,u+1))},t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return dH().domain(e()).range(a).round(o).paddingInner(s).paddingOuter(c).align(u)},l()}function fH(t){const e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return fH(e())},t}var pH=Array.prototype.map;const gH=Array.prototype.slice;const mH=new Map,vH=Symbol("vega_scale");function yH(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){let n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){const n=t.range();let r,i,a,o,s=e[0],c=e[1],u=-1;for(c<s&&(i=s,s=c,c=i),a=0,o=n.length;a<o;++a)n[a]>=s&&n[a]<=c&&(u<0&&(u=a),r=a);if(!(u<0))return s=t.invertExtent(n[u]),c=t.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===c[1]?c[0]:c[1]]}}(n):void 0),n.type=t,function(t){return t[vH]=!0,t}(n)};return r.metadata=NU(xU(n)),r}function bH(t,e,n){return arguments.length>1?(mH.set(t,yH(t,e,n)),this):function(t){return mH.has(t)}(t)?mH.get(t):void 0}function xH(t,e){const n=mH.get(t);return n&&n.metadata[e]}function wH(t){return xH(t,cH)}bH("identity",Ip),bH(KG,Dp,sH),bH(QG,Up,[sH,QG]),bH(ZG,Hp,sH),bH($G,Yp,sH),bH(JG,Zp,sH),bH(tH,gg,[sH,hH]),bH(eH,mg,[sH,hH]),bH(nH,bg,[sH,lH]),bH("".concat(nH,"-").concat(KG),bg,[sH,lH]),bH("".concat(nH,"-").concat(QG),xg,[sH,lH,QG]),bH("".concat(nH,"-").concat(ZG),kg,[sH,lH]),bH("".concat(nH,"-").concat($G),_g,[sH,lH]),bH("".concat(nH,"-").concat(JG),wg,[sH,lH]),bH("".concat(rH,"-").concat(KG),Cg,[sH,lH]),bH("".concat(rH,"-").concat(QG),Sg,[sH,lH,QG]),bH("".concat(rH,"-").concat(ZG),Tg,[sH,lH]),bH("".concat(rH,"-").concat($G),Ng,[sH,lH]),bH("".concat(rH,"-").concat(JG),Eg,[sH,lH]),bH(iH,Dg,[uH,iH]),bH(aH,Ig,uH),bH(oH,Mg,uH),bH("bin-ordinal",(function t(){let e=[],n=[];function r(t){return null==t||t!==t?void 0:n[(VV(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=function(t){return pH.call(t,bU)}(t),r):e.slice()},r.range=function(t){return arguments.length?(n=gH.call(t),r):n.slice()},r.tickFormat=function(t,n){return Np(e[0],yU(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}),[cH,uH]),bH("ordinal",jg,cH),bH("band",dH,cH),bH("point",(function(){return fH(dH().paddingInner(1))}),cH);function kH(t,e,n){return Kq(function(t,e){const n=v[function(t){return"interpolate"+t.toLowerCase().split("-").map((t=>t[0].toUpperCase()+t.slice(1))).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}(e||"rgb",n),t)}function _H(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function AH(t,e){for(const n in t)SH(n,e(t[n]))}const CH={};function SH(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(CH[t]=e,this):CH[t]}AH({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},_H),AH({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(t=>kH(_H(t))));const EH="symbol",TH="discrete",NH=t=>mU(t)?t.map((t=>String(t))):String(t),FH=(t,e)=>t[1]-e[1],DH=(t,e)=>e[1]-t[1];function IH(t,e){return t.bins?function(t,e,n){let r=t.range(),i=r[0],a=yU(r),o=FH;if(i>a&&(r=a,a=i,i=r,o=DH),i=Math.floor(i),a=Math.ceil(a),e=e.map((e=>[e,t(e)])).filter((t=>i<=t[1]&&t[1]<=a)).sort(o).map((t=>t[0])),n>0&&e.length>1){const t=[e[0],yU(e)];for(;e.length>n&&e.length>=3;)e=e.filter(((t,e)=>!(e%2)));e.length<3&&(e=t)}return e}(t,t.bins):t.ticks?t.ticks(e):t.domain()}function MH(t,e,n,r,i,a){const o=e.type;let s=NH;if(o===tH||i===tH)s=t.timeFormat(r);else if(o===eH||i===eH)s=t.utcFormat(r);else if(function(t){return xH(t,QG)}(o)){const i=t.formatFloat(r);if(a||e.bins)s=i;else{const t=OH(e,n,!1);s=e=>t(e)?i(e):""}}else if(e.tickFormat){const i=e.domain();s=t.formatSpan(i[0],i[i.length-1],n,r)}else r&&(s=t.format(r));return s}function OH(t,e,n){const r=IH(t,e),i=t.base(),a=Math.log(i),o=Math.max(1,i*e/r.length),s=t=>{let e=t/Math.pow(i,Math.round(Math.log(t)/a));return e*i<i-.5&&(e*=i),e<=o};return n?r.filter(s):s}const RH={[iH]:"quantiles",[aH]:"thresholds",[oH]:"domain"},zH={[iH]:"quantiles",[aH]:"domain"};function BH(t,e){return t.bins?function(t){const e=t.slice(0,-1);return e.max=yU(t),e}(t.bins):t.type===QG?OH(t,e,!0):RH[t.type]?function(t){const e=[-1/0].concat(t);return e.max=1/0,e}(t[RH[t.type]]()):IH(t,e)}const LH=t=>RH[t.type]||t.bins;function PH(t,e,n,r,i,a,o){const s=zH[e.type]&&a!==tH&&a!==eH?function(t,e,n){const r=e[zH[e.type]](),i=r.length;let a,o=i>1?r[1]-r[0]:r[0];for(a=1;a<i;++a)o=Math.min(o,r[a]-r[a-1]);return t.formatSpan(0,o,30,n)}(t,e,i):MH(t,e,n,i,a,o);return r===EH&&LH(e)?jH(s):r===TH?WH(s):VH(s)}const jH=t=>(e,n,r)=>{const i=UH(r[n+1],UH(r.max,1/0)),a=qH(e,t),o=qH(i,t);return a&&o?a+" \u2013 "+o:o?"< "+o:"\u2265 "+a},UH=(t,e)=>null!=t?t:e,WH=t=>(e,n)=>n?t(e):null,VH=t=>e=>t(e),qH=(t,e)=>Number.isFinite(t)?e(t):null;function GH(t,e,n,r){const i=r||e.type;return EU(n)&&function(t){return xH(t,hH)}(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||i!==tH?n||i!==eH?PH(t,e,5,null,n,r,!0):t.utcFormat("%A, %d %B %Y, %X UTC"):t.timeFormat("%A, %d %B %Y, %X")}function HH(t,e,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=GH(t,e,n.format,n.formatType);if(function(t){return xH(t,uH)}(e.type)){const t=BH(e).slice(1).map(i),n=t.length;return"".concat(n," boundar").concat(1===n?"y":"ies",": ").concat(t.join(", "))}if(wH(e.type)){const t=e.domain(),n=t.length,a=n>r?t.slice(0,r-2).map(i).join(", ")+", ending with "+t.slice(-1).map(i):t.map(i).join(", ");return"".concat(n," value").concat(1===n?"":"s",": ").concat(a)}{const t=e.domain();return"values from ".concat(i(t[0])," to ").concat(i(yU(t)))}}let YH=0;const XH="p_";function KH(t){return t&&t.gradient}function QH(t,e,n){const r=t.gradient;let i=t.id,a="radial"===r?XH:"";return i||(i=t.id="gradient_"+YH++,"radial"===r?(t.x1=ZH(t.x1,.5),t.y1=ZH(t.y1,.5),t.r1=ZH(t.r1,0),t.x2=ZH(t.x2,.5),t.y2=ZH(t.y2,.5),t.r2=ZH(t.r2,.5),a=XH):(t.x1=ZH(t.x1,0),t.y1=ZH(t.y1,0),t.x2=ZH(t.x2,1),t.y2=ZH(t.y2,0))),e[i]=t,"url("+(n||"")+"#"+a+i+")"}function ZH(t,e){return null!=t?t:e}function $H(t,e){var n,r=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:r,stop:function(t,e){return r.push({offset:t,color:e}),n}}}const JH={basis:{curve:function(t){return new DU(t)}},"basis-closed":{curve:function(t){return new MU(t)}},"basis-open":{curve:function(t){return new OU(t)}},bundle:{curve:zU,tension:"beta",value:.85},cardinal:{curve:PU,tension:"tension",value:0},"cardinal-open":{curve:UU,tension:"tension",value:0},"cardinal-closed":{curve:VU,tension:"tension",value:0},"catmull-rom":{curve:iW,tension:"alpha",value:.5},"catmull-rom-closed":{curve:oW,tension:"alpha",value:.5},"catmull-rom-open":{curve:cW,tension:"alpha",value:.5},linear:{curve:lW},"linear-closed":{curve:function(t){return new hW(t)}},monotone:{horizontal:function(t){return new vW(t)},vertical:function(t){return new mW(t)}},natural:{curve:function(t){return new bW(t)}},step:{curve:function(t){return new wW(t,.5)}},"step-after":{curve:function(t){return new wW(t,1)}},"step-before":{curve:function(t){return new wW(t,0)}}};function tY(t,e,n){var r=AU(JH,t)&&JH[t],i=null;return r&&(i=r.curve||r[e||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const eY={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},nY=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function rY(t){const e=[];let n,r,i,a,o,s,c,u,l,h;const d=t.slice().replace(nY[0],"###$1").split(nY[1]).slice(1);for(c=0,l=d.length;c<l;++c){for(n=d[c],r=n.slice(1).trim().replace(nY[2],"$1###$2").replace(nY[3],"$1###$2").split(nY[4]),o=n.charAt(0),i=[o],u=0,h=r.length;u<h;++u)(a=+r[u])===a&&i.push(a);if(s=eY[o.toLowerCase()],i.length-1>s){const t=i.length;for(u=1,e.push([o].concat(i.slice(u,u+=s))),o="M"===o?"L":"m"===o?"l":o;u<t;u+=s)e.push([o].concat(i.slice(u,u+s)))}else e.push(i)}return e}const iY=Math.PI/180,aY=Math.PI/2,oY=2*Math.PI,sY=Math.sqrt(3)/2;var cY={},uY={},lY=[].join;function hY(t){const e=lY.call(t);if(uY[e])return uY[e];var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],u=t[7];const l=u*o,h=-c*s,d=c*o,f=u*s,p=Math.cos(i),g=Math.sin(i),m=Math.cos(a),v=Math.sin(a),y=.5*(a-i),b=Math.sin(.5*y),x=8/3*b*b/Math.sin(y),w=n+p-x*g,k=r+g+x*p,_=n+m,A=r+v,C=_+x*v,S=A-x*m;return uY[e]=[l*w+h*k,d*w+f*k,l*C+h*S,d*C+f*S,l*_+h*A,d*_+f*A]}const dY=["l",0,0,0,0,0,0,0];function fY(t,e,n){const r=dY[0]=t[0];if("a"===r||"A"===r)dY[1]=e*t[1],dY[2]=n*t[2],dY[3]=t[3],dY[4]=t[4],dY[5]=t[5],dY[6]=e*t[6],dY[7]=n*t[7];else if("h"===r||"H"===r)dY[1]=e*t[1];else if("v"===r||"V"===r)dY[1]=n*t[1];else for(var i=1,a=t.length;i<a;++i)dY[i]=(i%2==1?e:n)*t[i];return dY}function pY(t,e,n,r,i,a){var o,s,c,u,l,h=null,d=0,f=0,p=0,g=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==a&&(a=i),t.beginPath&&t.beginPath();for(var m=0,v=e.length;m<v;++m){switch(o=e[m],1===i&&1===a||(o=fY(o,i,a)),o[0]){case"l":d+=o[1],f+=o[2],t.lineTo(d+n,f+r);break;case"L":d=o[1],f=o[2],t.lineTo(d+n,f+r);break;case"h":d+=o[1],t.lineTo(d+n,f+r);break;case"H":d=o[1],t.lineTo(d+n,f+r);break;case"v":f+=o[1],t.lineTo(d+n,f+r);break;case"V":f=o[1],t.lineTo(d+n,f+r);break;case"m":d+=o[1],f+=o[2],t.moveTo(d+n,f+r);break;case"M":d=o[1],f=o[2],t.moveTo(d+n,f+r);break;case"c":s=d+o[5],c=f+o[6],p=d+o[3],g=f+o[4],t.bezierCurveTo(d+o[1]+n,f+o[2]+r,p+n,g+r,s+n,c+r),d=s,f=c;break;case"C":d=o[5],f=o[6],p=o[3],g=o[4],t.bezierCurveTo(o[1]+n,o[2]+r,p+n,g+r,d+n,f+r);break;case"s":s=d+o[3],c=f+o[4],p=2*d-p,g=2*f-g,t.bezierCurveTo(p+n,g+r,d+o[1]+n,f+o[2]+r,s+n,c+r),p=d+o[1],g=f+o[2],d=s,f=c;break;case"S":s=o[3],c=o[4],p=2*d-p,g=2*f-g,t.bezierCurveTo(p+n,g+r,o[1]+n,o[2]+r,s+n,c+r),d=s,f=c,p=o[1],g=o[2];break;case"q":s=d+o[3],c=f+o[4],p=d+o[1],g=f+o[2],t.quadraticCurveTo(p+n,g+r,s+n,c+r),d=s,f=c;break;case"Q":s=o[3],c=o[4],t.quadraticCurveTo(o[1]+n,o[2]+r,s+n,c+r),d=s,f=c,p=o[1],g=o[2];break;case"t":s=d+o[1],c=f+o[2],null===h[0].match(/[QqTt]/)?(p=d,g=f):"t"===h[0]?(p=2*d-u,g=2*f-l):"q"===h[0]&&(p=2*d-p,g=2*f-g),u=p,l=g,t.quadraticCurveTo(p+n,g+r,s+n,c+r),f=c,p=(d=s)+o[1],g=f+o[2];break;case"T":s=o[1],c=o[2],p=2*d-p,g=2*f-g,t.quadraticCurveTo(p+n,g+r,s+n,c+r),d=s,f=c;break;case"a":gY(t,d+n,f+r,[o[1],o[2],o[3],o[4],o[5],o[6]+d+n,o[7]+f+r]),d+=o[6],f+=o[7];break;case"A":gY(t,d+n,f+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),d=o[6],f=o[7];break;case"z":case"Z":t.closePath()}h=o}}function gY(t,e,n,r){const i=function(t,e,n,r,i,a,o,s,c){const u=lY.call(arguments);if(cY[u])return cY[u];const l=o*iY,h=Math.sin(l),d=Math.cos(l),f=d*(s-t)*.5+h*(c-e)*.5,p=d*(c-e)*.5-h*(s-t)*.5;let g=f*f/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=d/n,v=h/n,y=-h/r,b=d/r,x=m*s+v*c,w=y*s+b*c,k=m*t+v*e,_=y*t+b*e;let A=1/((k-x)*(k-x)+(_-w)*(_-w))-.25;A<0&&(A=0);let C=Math.sqrt(A);a==i&&(C=-C);const S=.5*(x+k)-C*(_-w),E=.5*(w+_)+C*(k-x),T=Math.atan2(w-E,x-S);let N=Math.atan2(_-E,k-S)-T;N<0&&1===a?N+=oY:N>0&&0===a&&(N-=oY);const F=Math.ceil(Math.abs(N/(aY+.001))),D=[];for(let I=0;I<F;++I){const t=T+I*N/F,e=T+(I+1)*N/F;D[I]=[S,E,t,e,n,r,h,d]}return cY[u]=D}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n);for(let a=0;a<i.length;++a){const e=hY(i[a]);t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5])}}const mY=.5773502691896257,vY={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,oY)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,a=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-a),t.lineTo(i,-a),t.lineTo(0,-n),t.lineTo(-i,-a),t.lineTo(-r,-a),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=sY*n,i=r-n*mY,a=n/4;t.moveTo(0,-r-i),t.lineTo(-a,r-i),t.lineTo(a,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=sY*n,i=r-n*mY;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=sY*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=sY*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=sY*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=sY*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function yY(t){return AU(vY,t)?vY[t]:function(t){if(!AU(bY,t)){const e=rY(t);bY[t]={draw:function(t,n){pY(t,e,0,0,Math.sqrt(n)/2)}}}return bY[t]}(t)}var bY={};const xY=.448084975506;function wY(t){return t.x}function kY(t){return t.y}function _Y(t){return t.width}function AY(t){return t.height}function CY(t){return"function"===typeof t?t:()=>+t}function SY(t,e,n){return Math.max(e,Math.min(t,n))}function EY(){var t=wY,e=kY,n=_Y,r=AY,i=CY(0),a=i,o=i,s=i,c=null;function u(u,l,h){var d,f=null!=l?l:+t.call(this,u),p=null!=h?h:+e.call(this,u),g=+n.call(this,u),m=+r.call(this,u),v=Math.min(g,m)/2,y=SY(+i.call(this,u),0,v),b=SY(+a.call(this,u),0,v),x=SY(+o.call(this,u),0,v),w=SY(+s.call(this,u),0,v);if(c||(c=d=TW()),y<=0&&b<=0&&x<=0&&w<=0)c.rect(f,p,g,m);else{var k=f+g,_=p+m;c.moveTo(f+y,p),c.lineTo(k-b,p),c.bezierCurveTo(k-xY*b,p,k,p+xY*b,k,p+b),c.lineTo(k,_-w),c.bezierCurveTo(k,_-xY*w,k-xY*w,_,k-w,_),c.lineTo(f+x,_),c.bezierCurveTo(f+xY*x,_,f,_-xY*x,f,_-x),c.lineTo(f,p+y),c.bezierCurveTo(f,p+xY*y,f+xY*y,p,f+y,p),c.closePath()}if(d)return c=null,d+""||null}return u.x=function(e){return arguments.length?(t=CY(e),u):t},u.y=function(t){return arguments.length?(e=CY(t),u):e},u.width=function(t){return arguments.length?(n=CY(t),u):n},u.height=function(t){return arguments.length?(r=CY(t),u):r},u.cornerRadius=function(t,e,n,r){return arguments.length?(i=CY(t),a=null!=e?CY(e):i,s=null!=n?CY(n):i,o=null!=r?CY(r):a,u):i},u.context=function(t){return arguments.length?(c=null==t?null:t,u):c},u}function TY(){var t,e,n,r,i,a,o,s,c=null;function u(t,e,n){const r=n/2;if(i){var u=o-e,l=t-a;if(u||l){var h=Math.sqrt(u*u+l*l),d=(u/=h)*s,f=(l/=h)*s,p=Math.atan2(l,u);c.moveTo(a-d,o-f),c.lineTo(t-u*r,e-l*r),c.arc(t,e,r,p-Math.PI,p),c.lineTo(a+d,o+f),c.arc(a,o,s,p,p+Math.PI)}else c.arc(t,e,r,0,oY);c.closePath()}else i=1;a=t,o=e,s=r}function l(a){var o,s,l,h=a.length,d=!1;for(null==c&&(c=l=TW()),o=0;o<=h;++o)!(o<h&&r(s=a[o],o,a))===d&&(d=!d)&&(i=0),d&&u(+t(s,o,a),+e(s,o,a),+n(s,o,a));if(l)return c=null,l+""||null}return l.x=function(e){return arguments.length?(t=e,l):t},l.y=function(t){return arguments.length?(e=t,l):e},l.size=function(t){return arguments.length?(n=t,l):n},l.defined=function(t){return arguments.length?(r=t,l):r},l.context=function(t){return arguments.length?(c=null==t?null:t,l):c},l}function NY(t,e){return null!=t?t:e}const FY=t=>t.x||0,DY=t=>t.y||0,IY=t=>!(!1===t.defined),MY=function(){var t=FW,e=DW,n=NW(0),r=null,i=IW,a=MW,o=OW,s=null;function c(){var c,u,l=+t.apply(this,arguments),h=+e.apply(this,arguments),d=i.apply(this,arguments)-JU,f=a.apply(this,arguments)-JU,p=qU(f-d),g=f>d;if(s||(s=c=TW()),h<l&&(u=h,h=l,l=u),h>ZU)if(p>tW-ZU)s.moveTo(h*HU(d),h*KU(d)),s.arc(0,0,h,d,f,!g),l>ZU&&(s.moveTo(l*HU(f),l*KU(f)),s.arc(0,0,l,f,d,g));else{var m,v,y=d,b=f,x=d,w=f,k=p,_=p,A=o.apply(this,arguments)/2,C=A>ZU&&(r?+r.apply(this,arguments):QU(l*l+h*h)),S=XU(qU(h-l)/2,+n.apply(this,arguments)),E=S,T=S;if(C>ZU){var N=eW(C/l*KU(A)),F=eW(C/h*KU(A));(k-=2*N)>ZU?(x+=N*=g?1:-1,w-=N):(k=0,x=w=(d+f)/2),(_-=2*F)>ZU?(y+=F*=g?1:-1,b-=F):(_=0,y=b=(d+f)/2)}var D=h*HU(y),I=h*KU(y),M=l*HU(w),O=l*KU(w);if(S>ZU){var R,z=h*HU(b),B=h*KU(b),L=l*HU(x),P=l*KU(x);if(p<$U&&(R=function(t,e,n,r,i,a,o,s){var c=n-t,u=r-e,l=o-i,h=s-a,d=h*c-l*u;if(!(d*d<ZU))return[t+(d=(l*(e-a)-h*(t-i))/d)*c,e+d*u]}(D,I,L,P,z,B,M,O))){var j=D-R[0],U=I-R[1],W=z-R[0],V=B-R[1],q=1/KU(function(t){return t>1?0:t<-1?$U:Math.acos(t)}((j*W+U*V)/(QU(j*j+U*U)*QU(W*W+V*V)))/2),G=QU(R[0]*R[0]+R[1]*R[1]);E=XU(S,(l-G)/(q-1)),T=XU(S,(h-G)/(q+1))}}_>ZU?T>ZU?(m=RW(L,P,D,I,h,T,g),v=RW(z,B,M,O,h,T,g),s.moveTo(m.cx+m.x01,m.cy+m.y01),T<S?s.arc(m.cx,m.cy,T,GU(m.y01,m.x01),GU(v.y01,v.x01),!g):(s.arc(m.cx,m.cy,T,GU(m.y01,m.x01),GU(m.y11,m.x11),!g),s.arc(0,0,h,GU(m.cy+m.y11,m.cx+m.x11),GU(v.cy+v.y11,v.cx+v.x11),!g),s.arc(v.cx,v.cy,T,GU(v.y11,v.x11),GU(v.y01,v.x01),!g))):(s.moveTo(D,I),s.arc(0,0,h,y,b,!g)):s.moveTo(D,I),l>ZU&&k>ZU?E>ZU?(m=RW(M,O,z,B,l,-E,g),v=RW(D,I,L,P,l,-E,g),s.lineTo(m.cx+m.x01,m.cy+m.y01),E<S?s.arc(m.cx,m.cy,E,GU(m.y01,m.x01),GU(v.y01,v.x01),!g):(s.arc(m.cx,m.cy,E,GU(m.y01,m.x01),GU(m.y11,m.x11),!g),s.arc(0,0,l,GU(m.cy+m.y11,m.cx+m.x11),GU(v.cy+v.y11,v.cx+v.x11),g),s.arc(v.cx,v.cy,E,GU(v.y11,v.x11),GU(v.y01,v.x01),!g))):s.arc(0,0,l,w,x,g):s.lineTo(M,O)}else s.moveTo(0,0);if(s.closePath(),c)return s=null,c+""||null}return c.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-$U/2;return[HU(r)*n,KU(r)*n]},c.innerRadius=function(e){return arguments.length?(t="function"===typeof e?e:NW(+e),c):t},c.outerRadius=function(t){return arguments.length?(e="function"===typeof t?t:NW(+t),c):e},c.cornerRadius=function(t){return arguments.length?(n="function"===typeof t?t:NW(+t),c):n},c.padRadius=function(t){return arguments.length?(r=null==t?null:"function"===typeof t?t:NW(+t),c):r},c.startAngle=function(t){return arguments.length?(i="function"===typeof t?t:NW(+t),c):i},c.endAngle=function(t){return arguments.length?(a="function"===typeof t?t:NW(+t),c):a},c.padAngle=function(t){return arguments.length?(o="function"===typeof t?t:NW(+t),c):o},c.context=function(t){return arguments.length?(s=null==t?null:t,c):s},c}().startAngle((t=>t.startAngle||0)).endAngle((t=>t.endAngle||0)).padAngle((t=>t.padAngle||0)).innerRadius((t=>t.innerRadius||0)).outerRadius((t=>t.outerRadius||0)).cornerRadius((t=>t.cornerRadius||0)),OY=jW().x(FY).y1(DY).y0((t=>(t.y||0)+(t.height||0))).defined(IY),RY=jW().y(DY).x1(FY).x0((t=>(t.x||0)+(t.width||0))).defined(IY),zY=PW().x(FY).y(DY).defined(IY),BY=EY().x(FY).y(DY).width((t=>t.width||0)).height((t=>t.height||0)).cornerRadius((t=>NY(t.cornerRadiusTopLeft,t.cornerRadius)||0),(t=>NY(t.cornerRadiusTopRight,t.cornerRadius)||0),(t=>NY(t.cornerRadiusBottomRight,t.cornerRadius)||0),(t=>NY(t.cornerRadiusBottomLeft,t.cornerRadius)||0)),LY=function(t,e){var n=null;function r(){var r;if(n||(n=r=TW()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),r)return n=null,r+""||null}return t="function"===typeof t?t:NW(t||UW),e="function"===typeof e?e:NW(void 0===e?64:+e),r.type=function(e){return arguments.length?(t="function"===typeof e?e:NW(e),r):t},r.size=function(t){return arguments.length?(e="function"===typeof t?t:NW(+t),r):e},r.context=function(t){return arguments.length?(n=null==t?null:t,r):n},r}().type((t=>yY(t.shape||"circle"))).size((t=>NY(t.size,64))),PY=TY().x(FY).y(DY).defined(IY).size((t=>t.size||1));function jY(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function UY(t,e,n,r){return BY.context(t)(e,n,r)}var WY=1;function VY(){WY=1}function qY(t,e,n){var r=e.clip,i=t._defs,a=e.clip_id||(e.clip_id="clip"+WY++),o=i.clipping[a]||(i.clipping[a]={id:a});return wU(r)?o.path=r(null):jY(n)?o.path=UY(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+a+")"}function GY(t){this.clear(),t&&this.union(t)}function HY(t){this.mark=t,this.bounds=this.bounds||new GY}function YY(t){HY.call(this,t),this.items=this.items||[]}function XY(t){this._pending=0,this._loader=t||zV()}function KY(t){t._pending+=1}function QY(t){t._pending-=1}function ZY(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){const r=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(r+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}(e,r):0))}return t}GY.prototype={clone(){return new GY(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){const r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(t,e,n){var{x1:r,y1:i,x2:a,y2:o}=this,s=Math.cos(t),c=Math.sin(t),u=e-e*s+n*c,l=n-e*c-n*s;return[s*r-c*i+u,c*r+s*i+l,s*r-c*o+u,c*r+s*o+l,s*a-c*i+u,c*a+s*i+l,s*a-c*o+u,c*a+s*o+l]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},CU(YY,HY),XY.prototype={pending(){return this._pending},sanitizeURL(t){const e=this;return KY(e),e._loader.sanitize(t,{context:"href"}).then((t=>(QY(e),t))).catch((()=>(QY(e),null)))},loadImage(t){const e=this,n=$d();return KY(e),e._loader.sanitize(t,{context:"image"}).then((t=>{const r=t.href;if(!r||!n)throw{url:r};const i=new n,a=AU(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=a&&(i.crossOrigin=a),i.onload=()=>QY(e),i.onerror=()=>QY(e),i.src=r,i})).catch((t=>(QY(e),{complete:!1,width:0,height:0,src:t&&t.url||""})))},ready(){const t=this;return new Promise((e=>{!function n(r){t.pending()?setTimeout((()=>{n(!0)}),10):e(r)}(!1)}))}};const $Y=oY-1e-8;let JY,tX,eX,nX,rX,iX,aX,oX;const sX=(t,e)=>JY.add(t,e),cX=(t,e)=>sX(tX=t,eX=e),uX=t=>sX(t,JY.y1),lX=t=>sX(JY.x1,t),hX=(t,e)=>rX*t+aX*e,dX=(t,e)=>iX*t+oX*e,fX=(t,e)=>sX(hX(t,e),dX(t,e)),pX=(t,e)=>cX(hX(t,e),dX(t,e));function gX(t,e){return JY=t,e?(nX=e*iY,rX=oX=Math.cos(nX),iX=Math.sin(nX),aX=-iX):(rX=oX=1,nX=iX=aX=0),mX}const mX={beginPath(){},closePath(){},moveTo:pX,lineTo:pX,rect(t,e,n,r){nX?(fX(t+n,e),fX(t+n,e+r),fX(t,e+r),pX(t,e)):(sX(t+n,e+r),cX(t,e))},quadraticCurveTo(t,e,n,r){const i=hX(t,e),a=dX(t,e),o=hX(n,r),s=dX(n,r);vX(tX,i,o,uX),vX(eX,a,s,lX),cX(o,s)},bezierCurveTo(t,e,n,r,i,a){const o=hX(t,e),s=dX(t,e),c=hX(n,r),u=dX(n,r),l=hX(i,a),h=dX(i,a);yX(tX,o,c,l,uX),yX(eX,s,u,h,lX),cX(l,h)},arc(t,e,n,r,i,a){if(r+=nX,i+=nX,tX=n*Math.cos(i)+t,eX=n*Math.sin(i)+e,Math.abs(i-r)>$Y)sX(t-n,e-n),sX(t+n,e+n);else{const o=r=>sX(n*Math.cos(r)+t,n*Math.sin(r)+e);let s,c;if(o(r),o(i),i!==r)if((r%=oY)<0&&(r+=oY),(i%=oY)<0&&(i+=oY),i<r&&(a=!a,s=r,r=i,i=s),a)for(i-=oY,s=r-r%aY,c=0;c<4&&s>i;++c,s-=aY)o(s);else for(s=r-r%aY+aY,c=0;c<4&&s<i;++c,s+=aY)o(s)}}};function vX(t,e,n,r){const i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function yX(t,e,n,r,i){const a=r-t+3*e-3*n,o=t+n-2*e,s=t-e;let c,u=0,l=0;Math.abs(a)>1e-14?(c=o*o+s*a,c>=0&&(c=Math.sqrt(c),u=(-o+c)/a,l=(-o-c)/a)):u=.5*s/o,0<u&&u<1&&i(bX(u,t,e,n,r)),0<l&&l<1&&i(bX(l,t,e,n,r))}function bX(t,e,n,r,i){const a=1-t,o=a*a,s=t*t;return o*a*e+3*o*t*n+3*a*s*r+s*t*i}var xX=(xX=Zd(1,1))?xX.getContext("2d"):null;const wX=new GY;function kX(t){return function(e,n){if(!xX)return!0;t(xX,e),wX.clear().union(e.bounds).intersect(n).round();const{x1:r,y1:i,x2:a,y2:o}=wX;for(let t=i;t<=o;++t)for(let e=r;e<=a;++e)if(xX.isPointInPath(e,t))return!0;return!1}}function _X(t,e){return e.contains(t.x||0,t.y||0)}function AX(t,e){const n=t.x||0,r=t.y||0,i=t.width||0,a=t.height||0;return e.intersects(wX.set(n,r,n+i,r+a))}function CX(t,e){const n=t.x||0,r=t.y||0;return SX(e,n,r,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r)}function SX(t,e,n,r,i){const{x1:a,y1:o,x2:s,y2:c}=t,u=r-e,l=i-n;let h,d,f,p,g=0,m=1;for(p=0;p<4;++p){if(0===p&&(h=-u,d=-(a-e)),1===p&&(h=u,d=s-e),2===p&&(h=-l,d=-(o-n)),3===p&&(h=l,d=c-n),Math.abs(h)<1e-10&&d<0)return!1;if(f=d/h,h<0){if(f>m)return!1;f>g&&(g=f)}else if(h>0){if(f<g)return!1;f<m&&(m=f)}}return!0}function EX(t,e){t.globalCompositeOperation=e.blend||"source-over"}function TX(t,e){return null==t?e:t}function NX(t,e){const n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}function FX(t,e,n){return KH(n)?function(t,e,n){const r=n.width(),i=n.height();let a;if("radial"===e.gradient)a=t.createRadialGradient(n.x1+TX(e.x1,.5)*r,n.y1+TX(e.y1,.5)*i,Math.max(r,i)*TX(e.r1,0),n.x1+TX(e.x2,.5)*r,n.y1+TX(e.y2,.5)*i,Math.max(r,i)*TX(e.r2,.5));else{const o=TX(e.x1,0),s=TX(e.y1,0),c=TX(e.x2,1),u=TX(e.y2,0);if(o!==c&&s!==u&&r!==i){const n=Zd(Math.ceil(r),Math.ceil(i)),a=n.getContext("2d");return a.scale(r,i),a.fillStyle=NX(a.createLinearGradient(o,s,c,u),e.stops),a.fillRect(0,0,r,i),t.createPattern(n,"no-repeat")}a=t.createLinearGradient(n.x1+o*r,n.y1+s*i,n.x1+c*r,n.y1+u*i)}return NX(a,e.stops)}(t,n,e.bounds):n}function DX(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=FX(t,e,e.fill),!0)}var IX=[];function MX(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&((n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=FX(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||IX),t.lineDashOffset=e.strokeDashOffset||0),!0))}function OX(t,e){return t.zindex-e.zindex||t.index-e.index}function RX(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,a=[];for(n=0,r=i.length;n<r;++n)(e=i[n]).index=n,e.zindex&&a.push(e);return t.zdirty=!1,t.zitems=a.sort(OX)}function zX(t,e){var n,r,i=t.items;if(!i||!i.length)return;const a=RX(t);if(a&&a.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=a}for(n=0,r=i.length;n<r;++n)e(i[n])}function BX(t,e){var n,r,i=t.items;if(!i||!i.length)return null;const a=RX(t);for(a&&a.length&&(i=a),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===a)for(r=(i=t.items).length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function LX(t){return function(e,n,r){zX(n,(n=>{r&&!r.intersects(n.bounds)||jX(t,e,n,n)}))}}function PX(t){return function(e,n,r){!n.items.length||r&&!r.intersects(n.bounds)||jX(t,e,n.items[0],n.items)}}function jX(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||(EX(e,n),n.fill&&DX(e,n,i)&&e.fill(),n.stroke&&MX(e,n,i)&&e.stroke()))}function UX(t){return t=t||gU,function(e,n,r,i,a,o){return r*=e.pixelRatio,i*=e.pixelRatio,BX(n,(n=>{const s=n.bounds;if((!s||s.contains(a,o))&&s)return t(e,n,r,i,a,o)?n:void 0}))}}function WX(t,e){return function(n,r,i,a){var o,s,c=Array.isArray(r)?r[0]:r,u=null==e?c.fill:e,l=c.stroke&&n.isPointInStroke;return l&&(o=c.strokeWidth,s=c.strokeCap,n.lineWidth=null!=o?o:1,n.lineCap=null!=s?s:"butt"),!t(n,r)&&(u&&n.isPointInPath(i,a)||l&&n.isPointInStroke(i,a))}}function VX(t){return UX(WX(t))}function qX(t,e){return"translate("+t+","+e+")"}function GX(t){return"rotate("+t+")"}function HX(t){return qX(t.x||0,t.y||0)}function YX(t,e,n){function r(t,n){var r=n.x||0,i=n.y||0,a=n.angle||0;t.translate(r,i),a&&t.rotate(a*=iY),t.beginPath(),e(t,n),a&&t.rotate(-a),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",function(t){return qX(t.x||0,t.y||0)+(t.angle?" "+GX(t.angle):"")}(n)),t("d",e(null,n))},bound:function(t,n){return e(gX(t,n.angle),n),ZY(t,n).translate(n.x||0,n.y||0)},draw:LX(r),pick:VX(r),isect:n||kX(r)}}var XX=YX("arc",(function(t,e){return MY.context(t)(e)}));function KX(t,e,n){function r(t,n){t.beginPath(),e(t,n)}const i=WX(r);return{type:t,tag:"path",nested:!0,attr:function(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))},bound:function(t,n){var r=n.items;return 0===r.length?t:(e(gX(t),r),ZY(t,r[0]))},draw:PX(r),pick:function(t,e,n,r,a,o){var s=e.items,c=e.bounds;return!s||!s.length||c&&!c.contains(a,o)?null:(n*=t.pixelRatio,r*=t.pixelRatio,i(t,s,n,r)?s[0]:null)},isect:_X,tip:n}}var QX=KX("area",(function(t,e){const n=e[0],r=n.interpolate||"linear";return("horizontal"===n.orient?RY:OY).curve(tY(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i="horizontal"===t[0].orient?e[1]:e[0],a="horizontal"===t[0].orient?"y":"x",o=t.length,s=1/0;--o>=0;)!1!==t[o].defined&&(r=Math.abs(t[o][a]-i))<s&&(s=r,n=t[o]);return n}));function ZX(t,e){t.beginPath(),jY(e)?UY(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function $X(t){const e=TX(t.strokeWidth,1);return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function JX(t,e){const n=$X(e);t("d",UY(null,e,n,n))}function tK(t,e,n,r){const i=$X(e);t.beginPath(),UY(t,e,(n||0)+i,(r||0)+i)}const eK=WX(tK),nK=WX(tK,!1),rK=WX(tK,!0);var iK={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",HX(e))},bound:function(t,e){if(!e.clip&&e.items){const n=e.items,r=n.length;for(let e=0;e<r;++e)t.union(n[e].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),ZY(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n){zX(e,(e=>{const r=e.x||0,i=e.y||0,a=e.strokeForeground,o=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&o&&(tK(t,e,r,i),EX(t,e),e.fill&&DX(t,e,o)&&t.fill(),e.stroke&&!a&&MX(t,e,o)&&t.stroke()),t.save(),t.translate(r,i),e.clip&&ZX(t,e),n&&n.translate(-r,-i),zX(e,(e=>{this.draw(t,e,n)})),n&&n.translate(r,i),t.restore(),a&&e.stroke&&o&&(tK(t,e,r,i),EX(t,e),MX(t,e,o)&&t.stroke())}))},pick:function(t,e,n,r,i,a){if(e.bounds&&!e.bounds.contains(i,a)||!e.items)return null;const o=n*t.pixelRatio,s=r*t.pixelRatio;return BX(e,(c=>{let u,l,h;const d=c.bounds;if(d&&!d.contains(i,a))return;l=c.x||0,h=c.y||0;const f=l+(c.width||0),p=h+(c.height||0),g=c.clip;if(g&&(i<l||i>f||a<h||a>p))return;if(t.save(),t.translate(l,h),l=i-l,h=a-h,g&&jY(c)&&!rK(t,c,o,s))return t.restore(),null;const m=c.strokeForeground,v=!1!==e.interactive;return v&&m&&c.stroke&&nK(t,c,o,s)?(t.restore(),c):(u=BX(c,(t=>function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}(t,l,h)?this.pick(t,n,r,l,h):null)),!u&&v&&(c.fill||!m&&c.stroke)&&eK(t,c,o,s)&&(u=c),t.restore(),u||null)}))},isect:AX,content:function(t,e,n){t("clip-path",e.clip?qY(n,e,e):null)},background:function(t,e){t("class","background"),t("aria-hidden",!0),JX(t,e)},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?JX(t,e):t("d","")}},aK={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function oK(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then((e=>{t.image=e,t.image.url=t.url}))),n}function sK(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function cK(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function uK(t,e){return"center"===t?e/2:"right"===t?e:0}function lK(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var hK={type:"image",tag:"image",nested:!1,attr:function(t,e,n){const r=oK(e,n),i=sK(e,r),a=cK(e,r),o=(e.x||0)-uK(e.align,i),s=(e.y||0)-lK(e.baseline,a);t("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",aK["xmlns:xlink"],"xlink:href"),t("transform",qX(o,s)),t("width",i),t("height",a),t("preserveAspectRatio",!1===e.aspect?"none":"xMidYMid")},bound:function(t,e){const n=e.image,r=sK(e,n),i=cK(e,n),a=(e.x||0)-uK(e.align,r),o=(e.y||0)-lK(e.baseline,i);return t.set(a,o,a+r,o+i)},draw:function(t,e,n){zX(e,(e=>{if(n&&!n.intersects(e.bounds))return;const r=oK(e,this);let i=sK(e,r),a=cK(e,r);if(0===i||0===a)return;let o,s,c,u,l=(e.x||0)-uK(e.align,i),h=(e.y||0)-lK(e.baseline,a);!1!==e.aspect&&(s=r.width/r.height,c=e.width/e.height,s===s&&c===c&&s!==c&&(c<s?(u=i/s,h+=(a-u)/2,a=u):(u=a*s,l+=(i-u)/2,i=u))),(r.complete||r.toDataURL)&&(EX(t,e),t.globalAlpha=null!=(o=e.opacity)?o:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(r,l,h,i,a))}))},pick:UX(),isect:gU,get:oK,xOffset:uK,yOffset:lK},dK=KX("line",(function(t,e){const n=e[0],r=n.interpolate||"linear";return zY.curve(tY(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i=Math.pow(t[0].strokeWidth||1,2),a=t.length;--a>=0;)if(!1!==t[a].defined&&(n=t[a].x-e[0])*n+(r=t[a].y-e[1])*r<i)return t[a];return null}));function fK(t,e){var n=e.path;if(null==n)return!0;var r=e.x||0,i=e.y||0,a=e.scaleX||1,o=e.scaleY||1,s=(e.angle||0)*iY,c=e.pathCache;c&&c.path===n||((e.pathCache=c=rY(n)).path=n),s&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(s),pY(t,c,0,0,a,o),t.rotate(-s),t.translate(-r,-i)):pY(t,c,r,i,a,o)}var pK={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,r=e.scaleY||1;1===n&&1===r||t("vector-effect","non-scaling-stroke"),t("transform",function(t){return qX(t.x||0,t.y||0)+(t.angle?" "+GX(t.angle):"")+(t.scaleX||t.scaleY?" "+function(t,e){return"scale("+t+","+e+")"}(t.scaleX||1,t.scaleY||1):"")}(e)),t("d",e.path)},bound:function(t,e){return fK(gX(t,e.angle),e)?t.set(0,0,0,0):ZY(t,e,!0)},draw:LX(fK),pick:VX(fK),isect:kX(fK)};function gK(t,e){t.beginPath(),UY(t,e)}var mK={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",UY(null,e))},bound:function(t,e){var n,r;return ZY(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:LX(gK),pick:VX(gK),isect:AX};function vK(t,e,n){var r,i,a,o;return!(!e.stroke||!MX(t,e,n))&&(r=e.x||0,i=e.y||0,a=null!=e.x2?e.x2:r,o=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(a,o),!0)}var yK={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",HX(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return ZY(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)},draw:function(t,e,n){zX(e,(e=>{if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&vK(t,e,r)&&(EX(t,e),t.stroke())}}))},pick:UX((function(t,e,n,r){return!!t.isPointInStroke&&(vK(t,e,1)&&t.isPointInStroke(n,r))})),isect:CX},bK=YX("shape",(function(t,e){return(e.mark.shape||e.shape).context(t)(e)})),xK=YX("symbol",(function(t,e){return LY.context(t)(e)}),_X);const wK=function(t){let e,n,r;t=+t||1e4;const i=()=>{e={},n={},r=0},a=(i,a)=>(++r>t&&(n=e,e={},r=1),e[i]=a);return i(),{clear:i,has:t=>AU(e,t)||AU(n,t),get:t=>AU(e,t)?e[t]:AU(n,t)?a(t,n[t]):void 0,set:(t,n)=>AU(e,t)?e[t]=n:a(t,n)}}();var kK={height:TK,measureWidth:SK,estimateWidth:AK,width:AK,canvas:_K};function _K(t){kK.width=t&&xX?SK:AK}function AK(t,e){return CK(IK(t,e),TK(t))}function CK(t,e){return~~(.8*t.length*e)}function SK(t,e){return TK(t)<=0||!(e=IK(t,e))?0:EK(e,OK(t))}function EK(t,e){const n="(".concat(e,") ").concat(t);let r=wK.get(n);return void 0===r&&(xX.font=e,r=xX.measureText(t).width,wK.set(n,r)),r}function TK(t){return null!=t.fontSize?+t.fontSize||0:11}function NK(t){return null!=t.lineHeight?t.lineHeight:TK(t)+2}function FK(t){return e=t.lineBreak&&t.text&&!mU(t.text)?t.text.split(t.lineBreak):t.text,mU(e)?e.length>1?e:e[0]:e;var e}function DK(t){const e=FK(t);return(mU(e)?e.length-1:0)*NK(t)}function IK(t,e){const n=null==e?"":(e+"").trim();return t.limit>0&&n.length?function(t,e){var n=+t.limit,r=function(t){if(kK.width===SK){const e=OK(t);return t=>EK(t,e)}{const e=TK(t);return t=>CK(t,e)}}(t);if(r(e)<n)return e;var i,a=t.ellipsis||"\u2026",o="rtl"===t.dir,s=0,c=e.length;if(n-=r(a),o){for(;s<c;)i=s+c>>>1,r(e.slice(i))>n?s=i+1:c=i;return a+e.slice(s)}for(;s<c;)i=1+(s+c>>>1),r(e.slice(0,i))<n?s=i:c=i-1;return e.slice(0,s)+a}(t,n):n}function MK(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function OK(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+TK(t)+"px "+MK(t,e)}function RK(t){var e=t.baseline,n=TK(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*NK(t):"line-bottom"===e?.29*n-.5*NK(t):0)}_K(!0);const zK={left:"start",center:"middle",right:"end"},BK=new GY;function LK(t){var e,n=t.x||0,r=t.y||0,i=t.radius||0;return i&&(e=(t.theta||0)-aY,n+=i*Math.cos(e),r+=i*Math.sin(e)),BK.x1=n,BK.y1=r,BK}function PK(t,e,n){var r,i=kK.height(e),a=e.align,o=LK(e),s=o.x1,c=o.y1,u=e.dx||0,l=(e.dy||0)+RK(e)-Math.round(.8*i),h=FK(e);if(mU(h)?(i+=NK(e)*(h.length-1),r=h.reduce(((t,n)=>Math.max(t,kK.width(e,n))),0)):r=kK.width(e,h),"center"===a?u-=r/2:"right"===a&&(u-=r),t.set(u+=s,l+=c,u+r,l+i),e.angle&&!n)t.rotate(e.angle*iY,s,c);else if(2===n)return t.rotatedPoints(e.angle*iY,s,c);return t}var jK={type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,i=(e.dy||0)+RK(e),a=LK(e),o=a.x1,s=a.y1,c=e.angle||0;t("text-anchor",zK[e.align]||"start"),c?(n=qX(o,s)+" "+GX(c),(r||i)&&(n+=" "+qX(r,i))):n=qX(o+r,s+i),t("transform",n)},bound:PK,draw:function(t,e,n){zX(e,(e=>{var r,i,a,o,s,c,u,l=null==e.opacity?1:e.opacity;if(!(n&&!n.intersects(e.bounds)||0===l||e.fontSize<=0||null==e.text||0===e.text.length)){if(t.font=OK(e),t.textAlign=e.align||"left",i=(r=LK(e)).x1,a=r.y1,e.angle&&(t.save(),t.translate(i,a),t.rotate(e.angle*iY),i=a=0),i+=e.dx||0,a+=(e.dy||0)+RK(e),c=FK(e),EX(t,e),mU(c))for(s=NK(e),o=0;o<c.length;++o)u=IK(e,c[o]),e.fill&&DX(t,e,l)&&t.fillText(u,i,a),e.stroke&&MX(t,e,l)&&t.strokeText(u,i,a),a+=s;else u=IK(e,c),e.fill&&DX(t,e,l)&&t.fillText(u,i,a),e.stroke&&MX(t,e,l)&&t.strokeText(u,i,a);e.angle&&t.restore()}}))},pick:UX((function(t,e,n,r,i,a){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var o=LK(e),s=o.x1,c=o.y1,u=PK(BK,e,1),l=-e.angle*iY,h=Math.cos(l),d=Math.sin(l),f=h*i-d*a+(s-h*s+d*c),p=d*i+h*a+(c-d*s-h*c);return u.contains(f,p)})),isect:function(t,e){const n=PK(BK,t,2);return SX(e,n[0],n[1],n[2],n[3])||SX(e,n[0],n[1],n[4],n[5])||SX(e,n[4],n[5],n[6],n[7])||SX(e,n[2],n[3],n[6],n[7])}},UK=KX("trail",(function(t,e){return PY.context(t)(e)}),(function(t,e){for(var n,r,i=t.length;--i>=0;)if(!1!==t[i].defined&&(n=t[i].x-e[0])*n+(r=t[i].y-e[1])*r<(n=t[i].size||1)*n)return t[i];return null})),WK={arc:XX,area:QX,group:iK,image:hK,line:dK,path:pK,rect:mK,rule:yK,shape:bK,symbol:xK,text:jK,trail:UK};function VK(t,e,n){var r=WK[t.mark.marktype],i=e||r.bound;return r.nested&&(t=t.mark),i(t.bounds||(t.bounds=new GY),t,n)}var qK={mark:null};function GK(t,e,n){var r,i,a,o,s=WK[t.marktype],c=s.bound,u=t.items,l=u&&u.length;if(s.nested)return l?a=u[0]:(qK.mark=t,a=qK),o=VK(a,c,n),e=e&&e.union(o)||o;if(e=e||t.bounds&&t.bounds.clear()||new GY,l)for(r=0,i=u.length;r<i;++r)e.union(VK(u[r],c,n));return t.bounds=e}const HK=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function YK(t,e){return JSON.stringify(t,HK,e)}function XK(t){return KK("string"===typeof t?JSON.parse(t):t)}function KK(t){var e,n,r,i=t.marktype,a=t.items;if(a)for(n=0,r=a.length;n<r;++n)e=i?"mark":"group",a[n][e]=t,a[n].zindex&&(a[n][e].zdirty=!0),"group"===(i||e)&&KK(a[n]);return i&&GK(t),t}function QK(t){arguments.length?this.root=XK(t):(this.root=ZK({marktype:"group",name:"root",role:"frame"}),this.root.items=[new YY(this.root)])}function ZK(t,e){const n={bounds:new GY,clip:!!t.clip,group:e,interactive:!1!==t.interactive,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0};return null!=t.aria&&(n.aria=t.aria),t.description&&(n.description=t.description),n}function $K(t,e,n){return!t&&"undefined"!==typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function JK(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function tQ(t,e,n,r){var i,a=t.childNodes[e];return a&&a.tagName.toLowerCase()===n.toLowerCase()||(i=a||null,a=$K(t.ownerDocument,n,r),t.insertBefore(a,i)),a}function eQ(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function nQ(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function rQ(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function iQ(t,e){this._active=null,this._handlers={},this._loader=t||zV(),this._tooltip=e||aQ}function aQ(t,e,n,r){t.element().setAttribute("title",r||"")}function oQ(t){this._el=null,this._bgcolor=null,this._loader=new XY(t)}QK.prototype={toJSON(t){return YK(this.root,t||0)},mark(t,e,n){const r=ZK(t,e=e||this.root.items[0]);return e.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}},iQ.prototype={initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},scene(t){return arguments.length?(this._scene=t,this):this._scene},on(){},off(){},_handlerIndex(t,e,n){for(let r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},handlers(t){const e=this._handlers,n=[];if(t)n.push(...e[this.eventName(t)]);else for(const r in e)n.push(...e[r]);return n},eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then((e=>{const n=new MouseEvent(t.type,t),r=$K(null,"a");for(const t in e)r.setAttribute(t,e[t]);r.dispatchEvent(n)})).catch((()=>{}))},handleTooltip(t,e,n){if(e&&null!=e.tooltip){e=function(t,e,n,r){var i,a,o=t&&t.mark;if(o&&(i=WK[o.marktype]).tip){for((a=rQ(e,n))[0]-=r[0],a[1]-=r[1];t=t.mark.group;)a[0]-=t.x||0,a[1]-=t.y||0;t=i.tip(o.items,a)}return t}(e,t,this.canvas(),this._origin);const r=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,r)}},getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,a=i.width(),o=i.height();let s=i.x1+r[0]+n.left,c=i.y1+r[1]+n.top;for(;t.mark&&(t=t.mark.group);)s+=t.x||0,c+=t.y||0;return{x:s,y:c,width:a,height:o,left:s,top:c,right:s+a,bottom:c+o}}},oQ.prototype={initialize(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)},resize(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(t){const e=this;return e._call=function(){e._render(t)},e._call(),e._call=null,e},_render(){},renderAsync(t){const e=this.render(t);return this._ready?this._ready.then((()=>e)):Promise.resolve(e)},_load(t,e){var n=this,r=n._loader[t](e);if(!n._ready){const t=n._call;n._ready=n._loader.ready().then((e=>{e&&t(),n._ready=null}))}return r},sanitizeURL(t){return this._load("sanitizeURL",t)},loadImage(t){return this._load("loadImage",t)}};const sQ="dragenter",cQ="dragleave",uQ="dragover",lQ="mousedown",hQ="mousemove",dQ="mouseout",fQ="mouseover",pQ="click",gQ="mousewheel",mQ="touchstart",vQ="touchmove",yQ="touchend",bQ=hQ,xQ=dQ,wQ=pQ;function kQ(t,e){iQ.call(this,t,e),this._down=null,this._touch=null,this._first=!0,this._events={}}function _Q(t,e){(t=>t===mQ||t===vQ||t===yQ?[mQ,vQ,yQ]:[t])(e).forEach((e=>function(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n)))}(t,e)))}function AQ(t,e,n){return function(r){const i=this._active,a=this.pickEvent(r);a===i||(i&&i.exit||this.fire(n,r),this._active=a,this.fire(e,r)),this.fire(t,r)}}function CQ(t){return function(e){this.fire(t,e),this._active=null}}CU(kQ,iQ,{initialize(t,e,n){return this._canvas=t&&JK(t,"canvas"),[pQ,lQ,hQ,dQ,cQ].forEach((t=>_Q(this,t))),iQ.prototype.initialize.call(this,t,e,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",sQ,cQ,uQ,lQ,"mouseup",hQ,dQ,fQ,pQ,"dblclick","wheel",gQ,mQ,vQ,yQ],DOMMouseScroll(t){this.fire(gQ,t)},mousemove:AQ(hQ,fQ,dQ),dragover:AQ(uQ,sQ,cQ),mouseout:CQ(dQ),dragleave:CQ(cQ),mousedown(t){this._down=this._active,this.fire(lQ,t)},click(t){this._down===this._active&&(this.fire(pQ,t),this._down=null)},touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(mQ,t,!0)},touchmove(t){this.fire(vQ,t,!0)},touchend(t){this.fire(yQ,t,!0),this._touch=null},fire(t,e,n){const r=n?this._touch:this._active,i=this._handlers[t];if(e.vegaType=t,t===wQ&&r&&r.href?this.handleHref(e,r,r.href):t!==bQ&&t!==xQ||this.handleTooltip(e,r,t!==xQ),i)for(let a=0,o=i.length;a<o;++a)i[a].handler.call(this._obj,e,r)},on(t,e){const n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(_Q(this,t),(r[n]||(r[n]=[])).push({type:t,handler:e})),this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this},pickEvent(t){const e=rQ(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pick(t,e,n,r,i){const a=this.context();return WK[t.marktype].pick.call(this,a,t,e,n,r,i)}});var SQ="undefined"!==typeof window&&window.devicePixelRatio||1;function EQ(t){oQ.call(this,t),this._options={},this._redraw=!1,this._dirty=new GY,this._tempb=new GY}const TQ=oQ.prototype;function NQ(t,e){iQ.call(this,t,e);const n=this;n._hrefHandler=FQ(n,((t,e)=>{e&&e.href&&n.handleHref(t,e,e.href)})),n._tooltipHandler=FQ(n,((t,e)=>{n.handleTooltip(t,e,t.type!==xQ)}))}CU(EQ,oQ,{initialize(t,e,n,r,i,a){return this._options=a||{},this._canvas=this._options.externalContext?null:Zd(1,1,this._options.type),t&&this._canvas&&(eQ(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),TQ.initialize.call(this,t,e,n,r,i)},resize(t,e,n,r){if(TQ.resize.call(this,t,e,n,r),this._canvas)!function(t,e,n,r,i,a){const o="undefined"!==typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,s=t.getContext("2d"),c=o?SQ:i;t.width=e*c,t.height=n*c;for(const u in a)s[u]=a[u];o&&1!==c&&(t.style.width=e+"px",t.style.height=n+"px"),s.pixelRatio=c,s.setTransform(c,0,0,c,c*r[0],c*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const t=this._options.externalContext;t||hU("CanvasRenderer is missing a valid canvas or context"),t.scale(this._scale,this._scale),t.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)},_render(t){const e=this.context(),n=this._origin,r=this._width,i=this._height,a=this._dirty,o=((t,e,n)=>(new GY).set(0,0,e,n).translate(-t[0],-t[1]))(n,r,i);e.save();const s=this._redraw||a.empty()?(this._redraw=!1,o.expand(1)):function(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}(e,o.intersect(a),n);return this.clear(-n[0],-n[1],r,i),this.draw(e,t,s),e.restore(),a.clear(),this},draw(t,e,n){const r=WK[e.marktype];e.clip&&function(t,e){var n=e.clip;t.save(),wU(n)?(t.beginPath(),n(t),t.clip()):ZX(t,e.group)}(t,e),r.draw.call(this,t,e,n),e.clip&&t.restore()},clear(t,e,n,r){const i=this._options,a=this.context();"pdf"===i.type||i.externalContext||a.clearRect(t,e,n,r),null!=this._bgcolor&&(a.fillStyle=this._bgcolor,a.fillRect(t,e,n,r))}});const FQ=(t,e)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,e.call(t._obj,n,r)};CU(NQ,iQ,{initialize(t,e,n){let r=this._svg;return r&&(r.removeEventListener(wQ,this._hrefHandler),r.removeEventListener(bQ,this._tooltipHandler),r.removeEventListener(xQ,this._tooltipHandler)),this._svg=r=t&&JK(t,"svg"),r&&(r.addEventListener(wQ,this._hrefHandler),r.addEventListener(bQ,this._tooltipHandler),r.addEventListener(xQ,this._tooltipHandler)),iQ.prototype.initialize.call(this,t,e,n)},canvas(){return this._svg},on(t,e){const n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){const i={type:t,handler:e,listener:FQ(this,e)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const DQ="aria-hidden",IQ="aria-label",MQ="role",OQ="aria-roledescription",RQ="graphics-object",zQ="graphics-symbol",BQ=(t,e,n)=>({[MQ]:t,[OQ]:e,[IQ]:n||void 0}),LQ=NU(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),PQ={axis:{desc:"axis",caption:function(t){const e=t.datum,n=t.orient,r=e.title?qQ(t):null,i=t.context,a=i.scales[e.scale].value,o=i.dataflow.locale(),s=a.type,c="left"===n||"right"===n?"Y":"X";return"".concat(c,"-axis")+(r?" titled '".concat(r,"'"):"")+" for a ".concat(wH(s)?"discrete":s," scale")+" with ".concat(HH(o,a,t))}},legend:{desc:"legend",caption:function(t){const e=t.datum,n=e.title?qQ(t):null,r="".concat(e.type||""," legend").trim(),i=e.scales,a=Object.keys(i),o=t.context,s=o.scales[i[a[0]]].value,c=o.dataflow.locale();return function(t){return t.length?t[0].toUpperCase()+t.slice(1):t}(r)+(n?" titled '".concat(n,"'"):"")+" for ".concat(function(t){return t=t.map((t=>t+("fill"===t||"stroke"===t?" color":""))),t.length<2?t[0]:t.slice(0,-1).join(", ")+" and "+yU(t)}(a))+" with ".concat(HH(c,s,t))}},"title-text":{desc:"title",caption:t=>"Title text '".concat(VQ(t),"'")},"title-subtitle":{desc:"subtitle",caption:t=>"Subtitle text '".concat(VQ(t),"'")}},jQ={ariaRole:MQ,ariaRoleDescription:OQ,description:IQ};function UQ(t,e){const n=!1===e.aria;if(t(DQ,n||void 0),n||null==e.description)for(const r in jQ)t(jQ[r],void 0);else{const n=e.mark.marktype;t(IQ,e.description),t(MQ,e.ariaRole||("group"===n?RQ:zQ)),t(OQ,e.ariaRoleDescription||"".concat(n," mark"))}}function WQ(t){return!1===t.aria?{[DQ]:!0}:LQ[t.role]?null:PQ[t.role]?function(t,e){try{const n=t.items[0],r=e.caption||(()=>"");return BQ(e.role||zQ,e.desc,n.description||r(n))}catch(n){return null}}(t,PQ[t.role]):function(t){const e=t.marktype,n="group"===e||"text"===e||t.items.some((t=>null!=t.description&&!1!==t.aria));return BQ(n?RQ:zQ,"".concat(e," mark container"),t.description)}(t)}function VQ(t){return xU(t.text).join(" ")}function qQ(t){try{return xU(yU(t.items).items[0].text).join(" ")}catch(e){return null}}const GQ=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),HQ=t=>GQ(t).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function YQ(){let t="",e="",n="";const r=[],i=()=>e=n="",a=(t,n)=>(null!=n&&(e+=" ".concat(t,'="').concat(HQ(n),'"')),o),o={open(s){(a=>{e&&(t+="".concat(e,">").concat(n),i()),r.push(a)})(s),e="<"+s;for(var c=arguments.length,u=new Array(c>1?c-1:0),l=1;l<c;l++)u[l-1]=arguments[l];for(const t of u)for(const e in t)a(e,t[e]);return o},close(){const a=r.pop();return t+=e?e+(n?">".concat(n,"</").concat(a,">"):"/>"):"</".concat(a,">"),i(),o},attr:a,text:t=>(n+=GQ(t),o),toString:()=>t};return o}const XQ=t=>KQ(YQ(),t)+"";function KQ(t,e){if(t.open(e.tagName),e.hasAttributes()){const n=e.attributes,r=n.length;for(let e=0;e<r;++e)t.attr(n[e].name,n[e].value)}if(e.hasChildNodes()){const n=e.childNodes,r=n.length;for(let e=0;e<r;e++){const r=n[e];3===r.nodeType?t.text(r.nodeValue):KQ(t,r)}}return t.close()}const QQ={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},ZQ={fill:"none","stroke-miterlimit":10},$Q="http://www.w3.org/2000/xmlns/",JQ=aK.xmlns;function tZ(t){oQ.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const eZ=oQ.prototype;function nZ(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function rZ(t,e,n){let r,i,a;if("radial"===e.gradient){let r=tQ(t,n++,"pattern",JQ);hZ(r,{id:XH+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=tQ(r,0,"rect",JQ),hZ(r,{width:1,height:1,fill:"url(".concat(fZ(),"#").concat(e.id,")")}),hZ(t=tQ(t,n++,"radialGradient",JQ),{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else hZ(t=tQ(t,n++,"linearGradient",JQ),{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(r=0,i=e.stops.length;r<i;++r)a=tQ(t,r,"stop",JQ),a.setAttribute("offset",e.stops[r].offset),a.setAttribute("stop-color",e.stops[r].color);return eQ(t,r),n}function iZ(t,e,n){let r;return(t=tQ(t,n,"clipPath",JQ)).setAttribute("id",e.id),e.path?(r=tQ(t,0,"path",JQ),r.setAttribute("d",e.path)):(r=tQ(t,0,"rect",JQ),hZ(r,{x:0,y:0,width:e.width,height:e.height})),eQ(t,1),n+1}function aZ(t,e,n,r,i){let a,o=t._svg;if(!o&&(a=e.ownerDocument,o=$K(a,r,JQ),t._svg=o,t.mark&&(o.__data__=t,o.__values__={fill:"default"},"g"===r))){const e=$K(a,"path",JQ);o.appendChild(e),e.__data__=t;const n=$K(a,"g",JQ);o.appendChild(n),n.__data__=t;const r=$K(a,"path",JQ);o.appendChild(r),r.__data__=t,r.__values__={fill:"default"}}return(o.ownerSVGElement!==i||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}(o,n))&&e.insertBefore(o,n?n.nextSibling:e.firstChild),o}CU(tZ,oQ,{initialize(t,e,n,r,i){return this._defs={},this._clearDefs(),t&&(this._svg=tQ(t,0,"svg",JQ),this._svg.setAttributeNS($Q,"xmlns",JQ),this._svg.setAttributeNS($Q,"xmlns:xlink",aK["xmlns:xlink"]),this._svg.setAttribute("version",aK.version),this._svg.setAttribute("class","marks"),eQ(t,1),this._root=tQ(this._svg,0,"g",JQ),hZ(this._root,ZQ),eQ(this._svg,1)),this.background(this._bgcolor),eZ.initialize.call(this,t,e,n,r,i)},background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),eZ.background.apply(this,arguments)},resize(t,e,n,r){return eZ.resize.call(this,t,e,n,r),this._svg&&(hZ(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas(){return this._svg},svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=tQ(t,0,"rect",JQ),hZ(n,{width:this._width,height:this._height,fill:e}));const r=XQ(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),r},_render(t){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t),eQ(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},isDirty(t){return this._dirtyAll||!t._svg||t.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const e=++this._dirtyID;let n,r,i,a,o,s,c;for(o=0,s=t.length;o<s;++o)n=t[o],r=n.mark,r.marktype!==i&&(i=r.marktype,a=WK[i]),r.zdirty&&r.dirty!==e&&(this._dirtyAll=!1,nZ(n,e),r.items.forEach((t=>{t.dirty=e}))),r.zdirty||(n.exit?(a.nested&&r.items.length?(c=r.items[0],c._svg&&this._update(a,c._svg,c)):n._svg&&(c=n._svg.parentNode,c&&c.removeChild(n._svg)),n._svg=null):(n=a.nested?r.items[0]:n,n._update!==e&&(n._svg&&n._svg.ownerSVGElement?this._update(a,n._svg,n):(this._dirtyAll=!1,nZ(n,e)),n._update=e)));return!this._dirtyAll},mark(t,e,n){if(!this.isDirty(e))return e._svg;const r=this._svg,i=WK[e.marktype],a=!1===e.interactive?"none":null,o="g"===i.tag;let s=null,c=0;const u=aZ(e,t,n,"g",r);u.setAttribute("class",nQ(e));const l=WQ(e);for(const d in l)dZ(u,d,l[d]);o||dZ(u,"pointer-events",a),dZ(u,"clip-path",e.clip?qY(this,e,e.group):null);const h=t=>{const e=this.isDirty(t),n=aZ(t,u,s,i.tag,r);e&&(this._update(i,n,t),o&&function(t,e,n){e=e.lastChild.previousSibling;let r,i=0;zX(n,(n=>{r=t.mark(e,n,r),++i})),eQ(e,1+i)}(this,n,t)),s=n,++c};return i.nested?e.items.length&&h(e.items[0]):zX(e,h),eQ(u,c),u},_update(t,e,n){oZ=e,sZ=e.__values__,UQ(uZ,n),t.attr(uZ,n,this);const r=cZ[t.type];r&&r.call(this,t,e,n),oZ&&this.style(oZ,n)},style(t,e){if(null!=e)for(const n in QQ){let r="font"===n?MK(e):e[n];if(r===sZ[n])continue;const i=QQ[n];null==r?t.removeAttribute(i):(KH(r)&&(r=QH(r,this._defs.gradient,fZ())),t.setAttribute(i,r+"")),sZ[n]=r}},defs(){const t=this._svg,e=this._defs;let n=e.el,r=0;for(const i in e.gradient)n||(e.el=n=tQ(t,1,"defs",JQ)),r=rZ(n,e.gradient[i],r);for(const i in e.clipping)n||(e.el=n=tQ(t,1,"defs",JQ)),r=iZ(n,e.clipping[i],r);n&&(0===r?(t.removeChild(n),e.el=null):eQ(n,r))},_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}});let oZ=null,sZ=null;const cZ={group(t,e,n){const r=oZ=e.childNodes[2];sZ=r.__values__,t.foreground(uZ,n,this),sZ=e.__values__,oZ=e.childNodes[1],t.content(uZ,n,this);const i=oZ=e.childNodes[0];t.background(uZ,n,this);const a=!1===n.mark.interactive?"none":null;if(a!==sZ.events&&(dZ(r,"pointer-events",a),dZ(i,"pointer-events",a),sZ.events=a),n.strokeForeground&&n.stroke){const t=n.fill;dZ(r,"display",null),this.style(i,n),dZ(i,"stroke",null),t&&(n.fill=null),sZ=r.__values__,this.style(r,n),t&&(n.fill=t),oZ=null}else dZ(r,"display","none")},image(t,e,n){!1===n.smooth?(lZ(e,"image-rendering","optimizeSpeed"),lZ(e,"image-rendering","pixelated")):lZ(e,"image-rendering",null)},text(t,e,n){const r=FK(n);let i,a,o,s;mU(r)?(a=r.map((t=>IK(n,t))),i=a.join("\n"),i!==sZ.text&&(eQ(e,0),o=e.ownerDocument,s=NK(n),a.forEach(((t,r)=>{const i=$K(o,"tspan",JQ);i.__data__=n,i.textContent=t,r&&(i.setAttribute("x",0),i.setAttribute("dy",s)),e.appendChild(i)})),sZ.text=i)):(a=IK(n,r),a!==sZ.text&&(e.textContent=a,sZ.text=a)),dZ(e,"font-family",MK(n)),dZ(e,"font-size",TK(n)+"px"),dZ(e,"font-style",n.fontStyle),dZ(e,"font-variant",n.fontVariant),dZ(e,"font-weight",n.fontWeight)}};function uZ(t,e,n){e!==sZ[t]&&(n?function(t,e,n,r){null!=n?t.setAttributeNS(r,e,n):t.removeAttributeNS(r,e)}(oZ,t,e,n):dZ(oZ,t,e),sZ[t]=e)}function lZ(t,e,n){n!==sZ[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),sZ[e]=n)}function hZ(t,e){for(const n in e)dZ(t,n,e[n])}function dZ(t,e,n){null!=n?t.setAttribute(e,n):t.removeAttribute(e)}function fZ(){let t;return"undefined"===typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function pZ(t){oQ.call(this,t),this._text=null,this._defs={gradient:{},clipping:{}}}CU(pZ,oQ,{svg(){return this._text},_render(t){const e=YQ();e.open("svg",kU({},aK,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",ZQ,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this},mark(t,e){const n=WK[e.marktype],r=n.tag,i=[UQ,n.attr];t.open("g",{class:nQ(e),"clip-path":e.clip?qY(this,e,e.group):null},WQ(e),{"pointer-events":"g"!==r&&!1===e.interactive?"none":null});const a=a=>{const o=this.href(a);if(o&&t.open("a",o),t.open(r,this.attr(e,a,i,"g"!==r?r:null)),"text"===r){const e=FK(a);if(mU(e)){const n={x:0,dy:NK(a)};for(let r=0;r<e.length;++r)t.open("tspan",r?n:null).text(IK(a,e[r])).close()}else t.text(IK(a,e))}else if("g"===r){const r=a.strokeForeground,i=a.fill,o=a.stroke;r&&o&&(a.stroke=null),t.open("path",this.attr(e,a,n.background,"bgrect")).close(),t.open("g",this.attr(e,a,n.content)),zX(a,(e=>this.mark(t,e))),t.close(),r&&o?(i&&(a.fill=null),a.stroke=o,t.open("path",this.attr(e,a,n.foreground,"bgrect")).close(),i&&(a.fill=i)):t.open("path",this.attr(e,a,n.foreground,"bgfore")).close()}t.close(),o&&t.close()};return n.nested?e.items&&e.items.length&&a(e.items[0]):zX(e,a),t.close()},href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then((t=>{t["xlink:href"]=t.href,t.href=null,(this._hrefs||(this._hrefs={}))[e]=t}))}return null},attr(t,e,n,r){const i={},a=(t,e,n,r)=>{i[r||t]=e};return Array.isArray(n)?n.forEach((t=>t(a,e,this))):n(a,e,this),r&&function(t,e,n,r,i){if(null==e)return t;"bgrect"===r&&!1===n.interactive&&(t["pointer-events"]="none");if("bgfore"===r&&(!1===n.interactive&&(t["pointer-events"]="none"),t.display="none",null!==e.fill))return t;"image"===r&&!1===e.smooth&&(t.style="image-rendering: optimizeSpeed; image-rendering: pixelated;");"text"===r&&(t["font-family"]=MK(e),t["font-size"]=TK(e)+"px",t["font-style"]=e.fontStyle,t["font-variant"]=e.fontVariant,t["font-weight"]=e.fontWeight);for(const a in QQ){let n=e[a];const r=QQ[a];("transparent"!==n||"fill"!==r&&"stroke"!==r)&&null!=n&&(KH(n)&&(n=QH(n,i.gradient,"")),t[r]=n)}}(i,e,t,r,this._defs),i},defs(t){const e=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(e).length+Object.keys(n).length){t.open("defs");for(const n in e){const r=e[n],i=r.stops;"radial"===r.gradient?(t.open("pattern",{id:XH+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),t.close(),t.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):t.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let e=0;e<i.length;++e)t.open("stop",{offset:i[e].offset,"stop-color":i[e].color}).close();t.close()}for(const e in n){const r=n[e];t.open("clipPath",{id:e}),r.path?t.open("path",{d:r.path}).close():t.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),t.close()}t.close()}}});const gZ="canvas",mZ="none",vZ={Canvas:gZ,PNG:"png",SVG:"svg",None:mZ},yZ={};function bZ(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(yZ[t]=e,this):yZ[t]}function xZ(t,e,n){const r=[],i=(new GY).union(e),a=t.marktype;return a?wZ(t,i,n,r):"group"===a?kZ(t,i,n,r):hU("Intersect scene must be mark node or group item.")}function wZ(t,e,n,r){if(function(t,e,n){return t.bounds&&e.intersects(t.bounds)&&("group"===t.marktype||!1!==t.interactive&&(!n||n(t)))}(t,e,n)){const i=t.items,a=t.marktype,o=i.length;let s=0;if("group"===a)for(;s<o;++s)kZ(i[s],e,n,r);else for(const t=WK[a].isect;s<o;++s){const n=i[s];_Z(n,e,t)&&r.push(n)}}return r}function kZ(t,e,n,r){n&&n(t.mark)&&_Z(t,e,WK.group.isect)&&r.push(t);const i=t.items,a=i&&i.length;if(a){const o=t.x||0,s=t.y||0;e.translate(-o,-s);for(let t=0;t<a;++t)wZ(i[t],e,n,r);e.translate(o,s)}return r}function _Z(t,e,n){const r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}yZ[gZ]=yZ.png={renderer:EQ,headless:EQ,handler:kQ},yZ.svg={renderer:tZ,headless:pZ,handler:NQ},yZ[mZ]={};const AZ=new GY;function CZ(t){const e=t.clip;if(wU(e))e(gX(AZ.clear()));else{if(!e)return;AZ.set(0,0,t.group.width,t.group.height)}t.bounds.intersect(AZ)}const SZ=1e-9;function EZ(t,e,n){return t===e||("path"===n?TZ(t,e):t instanceof Date&&e instanceof Date?+t===+e:SU(t)&&SU(e)?Math.abs(t-e)<=SZ:t&&e&&(vU(t)||vU(e))?function(t,e){var n,r,i=Object.keys(t),a=Object.keys(e);if(i.length!==a.length)return!1;for(i.sort(),a.sort(),r=i.length-1;r>=0;r--)if(i[r]!=a[r])return!1;for(r=i.length-1;r>=0;r--)if(!EZ(t[n=i[r]],e[n],n))return!1;return typeof t===typeof e}(t,e):t==e)}function TZ(t,e){return EZ(rY(t),rY(e))}function NZ(){VY(),YH=0}function FZ(t,e,n){return t.fields=e||[],t.fname=n,t}function DZ(t){return 1===t.length?IZ(t[0]):MZ(t)}const IZ=t=>function(e){return e[t]},MZ=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function OZ(t){throw Error(t)}function RZ(t){const e=[],n=t.length;let r,i,a,o=null,s=0,c="";function u(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)c+=t.substring(r,i++),r=i;else if(a===o)u(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&u(),s=r=i+1):"]"===a&&(s||OZ("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&OZ("Access path missing closing bracket: "+t),o&&OZ("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function zZ(t,e,n){const r=RZ(t);return t=1===r.length?r[0]:t,FZ((n&&n.get||DZ)(r),[t],e||t)}zZ("id"),FZ((t=>t),[],"identity"),FZ((()=>0),[],"zero"),FZ((()=>1),[],"one"),FZ((()=>!0),[],"true"),FZ((()=>!1),[],"false");var BZ=Array.isArray;function LZ(t){return t[t.length-1]}function PZ(t){return null==t||""===t?null:+t}function jZ(t){return null!=t?BZ(t)?t:[t]:[]}const UZ=Object.prototype.hasOwnProperty;function WZ(t,e){return UZ.call(t,e)}function VZ(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function qZ(t,e){switch(arguments.length){case 0:break;case 1:"function"===typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"===typeof e?this.interpolator(e):this.range(e)}return this}const GZ=Symbol("implicit");function HZ(){var t=new Map,e=[],n=[],r=GZ;function i(i){var a=i+"",o=t.get(a);if(!o){if(r!==GZ)return r;t.set(a,o=e.push(i))}return n[(o-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Map;for(const r of n){const n=r+"";t.has(n)||t.set(n,e.push(r))}return i},i.range=function(t){return arguments.length?(n=Array.from(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return HZ(e,n).unknown(r)},VZ.apply(i,arguments),i}var YZ,XZ=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function KZ(t){if(!(e=XZ.exec(t)))throw new Error("invalid format: "+t);var e;return new QZ({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function QZ(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function ZZ(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function $Z(t){return(t=ZZ(Math.abs(t)))?t[1]:NaN}function JZ(t,e){var n=ZZ(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}KZ.prototype=QZ.prototype,QZ.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const t$={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>JZ(100*t,e),r:JZ,s:function(t,e){var n=ZZ(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(YZ=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+ZZ(t,Math.max(0,e+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function e$(t){return t}var n$,r$,i$,a$=Array.prototype.map,o$=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function s$(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?e$:(e=a$.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,a=[],o=0,s=e[0],c=0;i>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),a.push(t.substring(i-=s,i+s)),!((c+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?e$:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(a$.call(t.numerals,String)),c=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"\u2212":t.minus+"",l=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=KZ(t)).fill,n=t.align,h=t.sign,d=t.symbol,f=t.zero,p=t.width,g=t.comma,m=t.precision,v=t.trim,y=t.type;"n"===y?(g=!0,y="g"):t$[y]||(void 0===m&&(m=12),v=!0,y="g"),(f||"0"===e&&"="===n)&&(f=!0,e="0",n="=");var b="$"===d?i:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x="$"===d?a:/[%p]/.test(y)?c:"",w=t$[y],k=/[defgprs%]/.test(y);function _(t){var i,a,c,d=b,_=x;if("c"===y)_=w(t)+_,t="";else{var A=(t=+t)<0||1/t<0;if(t=isNaN(t)?l:w(Math.abs(t),m),v&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),A&&0===+t&&"+"!==h&&(A=!1),d=(A?"("===h?h:u:"-"===h||"("===h?"":h)+d,_=("s"===y?o$[8+YZ/3]:"")+_+(A&&"("===h?")":""),k)for(i=-1,a=t.length;++i<a;)if(48>(c=t.charCodeAt(i))||c>57){_=(46===c?o+t.slice(i+1):t.slice(i))+_,t=t.slice(0,i);break}}g&&!f&&(t=r(t,1/0));var C=d.length+t.length+_.length,S=C<p?new Array(p-C+1).join(e):"";switch(g&&f&&(t=r(S+t,S.length?p-_.length:1/0),S=""),n){case"<":t=d+t+_+S;break;case"=":t=d+S+t+_;break;case"^":t=S.slice(0,C=S.length>>1)+d+t+_+S.slice(C);break;default:t=S+d+t+_}return s(t)}return m=void 0===m?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),_.toString=function(){return t+""},_}return{format:h,formatPrefix:function(t,e){var n=h(((t=KZ(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor($Z(e)/3))),i=Math.pow(10,-r),a=o$[8+r/3];return function(t){return n(i*t)+a}}}}function c$(t,e,n,r){var i,a=HS(t,e,n);switch((r=KZ(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor($Z(e)/3)))-$Z(Math.abs(t)))}(a,o))||(r.precision=i),i$(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,$Z(e)-$Z(t))+1}(a,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-$Z(Math.abs(t)))}(a))||(r.precision=i-2*("%"===r.type))}return r$(r)}function u$(t){return+t}!function(t){n$=s$(t),r$=n$.format,i$=n$.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});var l$=[0,1];function h$(t){return t}function d$(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function f$(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=d$(i,r),a=n(o,a)):(r=d$(r,i),a=n(a,o)),function(t){return a(r(t))}}function p$(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=d$(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(e){var n=nz(t,e,1,r)-1;return a[n](i[n](e))}}function g$(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function m$(){var t,e,n,r,i,a,o=l$,s=l$,c=uS,u=h$;function l(){var t=Math.min(o.length,s.length);return u!==h$&&(u=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(o[0],o[t-1])),r=t>2?p$:f$,i=a=null,h}function h(e){return null==e||isNaN(e=+e)?n:(i||(i=r(o.map(t),s,c)))(t(u(e)))}return h.invert=function(n){return u(e((a||(a=r(s,o.map(t),iS)))(n)))},h.domain=function(t){return arguments.length?(o=Array.from(t,u$),l()):o.slice()},h.range=function(t){return arguments.length?(s=Array.from(t),l()):s.slice()},h.rangeRound=function(t){return s=Array.from(t),c=cC,l()},h.clamp=function(t){return arguments.length?(u=!!t||h$,l()):u!==h$},h.interpolate=function(t){return arguments.length?(c=t,l()):c},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,l()}}function v$(){return m$()(h$,h$)}function y$(t){var e=t.domain;return t.ticks=function(t){var n=e();return qS(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return c$(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i,a=e(),o=0,s=a.length-1,c=a[o],u=a[s],l=10;for(u<c&&(i=c,c=u,u=i,i=o,o=s,s=i);l-- >0;){if((i=GS(c,u,n))===r)return a[o]=c,a[s]=u,e(a);if(i>0)c=Math.floor(c/i)*i,u=Math.ceil(u/i)*i;else{if(!(i<0))break;c=Math.ceil(c*i)/i,u=Math.floor(u*i)/i}r=i}return t},t}function b$(t,e){var n,r=0,i=(t=t.slice()).length-1,a=t[r],o=t[i];return o<a&&(n=r,r=i,i=n,n=a,a=o,o=n),t[r]=e.floor(a),t[i]=e.ceil(o),t}function x$(t){return Math.log(t)}function w$(t){return Math.exp(t)}function k$(t){return-Math.log(-t)}function _$(t){return-Math.exp(-t)}function A$(t){return isFinite(t)?+("1e"+t):t<0?0:t}function C$(t){return function(e){return-t(-e)}}function S$(t){var e,n,r=t(x$,w$),i=r.domain,a=10;function o(){return e=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}(a),n=function(t){return 10===t?A$:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}(a),i()[0]<0?(e=C$(e),n=C$(n),t(k$,_$)):t(x$,w$),r}return r.base=function(t){return arguments.length?(a=+t,o()):a},r.domain=function(t){return arguments.length?(i(t),o()):i()},r.ticks=function(t){var r,o=i(),s=o[0],c=o[o.length-1];(r=c<s)&&(d=s,s=c,c=d);var u,l,h,d=e(s),f=e(c),p=null==t?10:+t,g=[];if(!(a%1)&&f-d<p){if(d=Math.floor(d),f=Math.ceil(f),s>0){for(;d<=f;++d)for(l=1,u=n(d);l<a;++l)if(!((h=u*l)<s)){if(h>c)break;g.push(h)}}else for(;d<=f;++d)for(l=a-1,u=n(d);l>=1;--l)if(!((h=u*l)<s)){if(h>c)break;g.push(h)}2*g.length<p&&(g=qS(s,c,p))}else g=qS(d,f,Math.min(f-d,p)).map(n);return r?g.reverse():g},r.tickFormat=function(t,i){if(null==i&&(i=10===a?".0e":","),"function"!==typeof i&&(i=r$(i)),t===1/0)return i;null==t&&(t=10);var o=Math.max(1,a*t/r.ticks().length);return function(t){var r=t/n(Math.round(e(t)));return r*a<a-.5&&(r*=a),r<=o?i(t):""}},r.nice=function(){return i(b$(i(),{floor:function(t){return n(Math.floor(e(t)))},ceil:function(t){return n(Math.ceil(e(t)))}}))},r}function E$(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function T$(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function N$(t){return t<0?-t*t:t*t}function F$(t){var e=t(h$,h$),n=1;return e.exponent=function(e){return arguments.length?1===(n=+e)?t(h$,h$):.5===n?t(T$,N$):t(E$(n),E$(1/n)):n},y$(e)}function D$(){var t=F$(m$());return t.copy=function(){return g$(t,D$()).exponent(t.exponent())},VZ.apply(t,arguments),t}function I$(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function M$(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function O$(t){var e=1,n=t(I$(e),M$(e));return n.constant=function(n){return arguments.length?t(I$(e=+n),M$(e)):e},y$(n)}const R$=1e3,z$=6e4,B$=36e5,L$=864e5,P$=6048e5,j$=2592e6,U$=31536e6;var W$=new Date,V$=new Date;function q$(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,a){var o,s=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r)||!(a>0))return s;do{s.push(o=new Date(+n)),e(n,a),t(n)}while(o<n&&n<r);return s},i.filter=function(n){return q$((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return W$.setTime(+e),V$.setTime(+r),t(W$),t(V$),Math.floor(n(W$,V$))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t===0}:function(e){return i.count(0,e)%t===0}):i:null}),i}var G$=q$((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t}));G$.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?q$((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):G$:null};const H$=G$;G$.range;var Y$=q$((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+e*R$)}),(function(t,e){return(e-t)/R$}),(function(t){return t.getUTCSeconds()}));const X$=Y$;Y$.range;var K$=q$((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*R$)}),(function(t,e){t.setTime(+t+e*z$)}),(function(t,e){return(e-t)/z$}),(function(t){return t.getMinutes()}));const Q$=K$;K$.range;var Z$=q$((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*R$-t.getMinutes()*z$)}),(function(t,e){t.setTime(+t+e*B$)}),(function(t,e){return(e-t)/B$}),(function(t){return t.getHours()}));const $$=Z$;Z$.range;var J$=q$((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*z$)/L$),(t=>t.getDate()-1));const tJ=J$;J$.range;function eJ(t){return q$((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*z$)/P$}))}var nJ=eJ(0),rJ=eJ(1),iJ=eJ(2),aJ=eJ(3),oJ=eJ(4),sJ=eJ(5),cJ=eJ(6),uJ=(nJ.range,rJ.range,iJ.range,aJ.range,oJ.range,sJ.range,cJ.range,q$((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()})));const lJ=uJ;uJ.range;var hJ=q$((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));hJ.every=function(t){return isFinite(t=Math.floor(t))&&t>0?q$((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};const dJ=hJ;hJ.range;var fJ=q$((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+e*z$)}),(function(t,e){return(e-t)/z$}),(function(t){return t.getUTCMinutes()}));const pJ=fJ;fJ.range;var gJ=q$((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+e*B$)}),(function(t,e){return(e-t)/B$}),(function(t){return t.getUTCHours()}));const mJ=gJ;gJ.range;var vJ=q$((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/L$}),(function(t){return t.getUTCDate()-1}));const yJ=vJ;vJ.range;function bJ(t){return q$((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/P$}))}var xJ=bJ(0),wJ=bJ(1),kJ=bJ(2),_J=bJ(3),AJ=bJ(4),CJ=bJ(5),SJ=bJ(6),EJ=(xJ.range,wJ.range,kJ.range,_J.range,AJ.range,CJ.range,SJ.range,q$((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})));const TJ=EJ;EJ.range;var NJ=q$((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));NJ.every=function(t){return isFinite(t=Math.floor(t))&&t>0?q$((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};const FJ=NJ;NJ.range;function DJ(t,e,n,r,i,a){const o=[[X$,1,R$],[X$,5,5e3],[X$,15,15e3],[X$,30,3e4],[a,1,z$],[a,5,3e5],[a,15,9e5],[a,30,18e5],[i,1,B$],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,L$],[r,2,1728e5],[n,1,P$],[e,1,j$],[e,3,7776e6],[t,1,U$]];function s(e,n,r){const i=Math.abs(n-e)/r,a=Bu((t=>{let[,,e]=t;return e})).right(o,i);if(a===o.length)return t.every(HS(e/U$,n/U$,r));if(0===a)return H$.every(Math.max(HS(e,n,r),1));const[s,c]=o[i/o[a-1][2]<o[a][2]/i?a-1:a];return s.every(c)}return[function(t,e,n){const r=e<t;r&&([t,e]=[e,t]);const i=n&&"function"===typeof n.range?n:s(t,e,n),a=i?i.range(t,+e+1):[];return r?a.reverse():a},s]}const[IJ,MJ]=DJ(FJ,TJ,xJ,yJ,mJ,pJ),[OJ,RJ]=DJ(dJ,lJ,nJ,tJ,$$,Q$);var zJ=new Date,BJ=new Date;function LJ(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,a){var o,s=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r)||!(a>0))return s;do{s.push(o=new Date(+n)),e(n,a),t(n)}while(o<n&&n<r);return s},i.filter=function(n){return LJ((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return zJ.setTime(+e),BJ.setTime(+r),t(zJ),t(BJ),Math.floor(n(zJ,BJ))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t===0}:function(e){return i.count(0,e)%t===0}):i:null}),i}const PJ=6e4,jJ=864e5,UJ=6048e5;function WJ(t){return LJ((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/UJ}))}var VJ=WJ(0),qJ=WJ(1),GJ=WJ(2),HJ=WJ(3),YJ=WJ(4),XJ=WJ(5),KJ=WJ(6),QJ=(VJ.range,qJ.range,GJ.range,HJ.range,YJ.range,XJ.range,KJ.range,LJ((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/jJ}),(function(t){return t.getUTCDate()-1})));const ZJ=QJ;QJ.range;function $J(t){return LJ((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*PJ)/UJ}))}var JJ=$J(0),t0=$J(1),e0=$J(2),n0=$J(3),r0=$J(4),i0=$J(5),a0=$J(6),o0=(JJ.range,t0.range,e0.range,n0.range,r0.range,i0.range,a0.range,LJ((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*PJ)/jJ),(t=>t.getDate()-1)));const s0=o0;o0.range;var c0=LJ((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));c0.every=function(t){return isFinite(t=Math.floor(t))&&t>0?LJ((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};const u0=c0;c0.range;var l0=LJ((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));l0.every=function(t){return isFinite(t=Math.floor(t))&&t>0?LJ((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};const h0=l0;l0.range;function d0(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function f0(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function p0(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}var g0,m0,v0,y0={"-":"",_:" ",0:"0"},b0=/^\s*\d+/,x0=/^%/,w0=/[\\^$*+?|[\]().{}]/g;function k0(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function _0(t){return t.replace(w0,"\\$&")}function A0(t){return new RegExp("^(?:"+t.map(_0).join("|")+")","i")}function C0(t){return new Map(t.map(((t,e)=>[t.toLowerCase(),e])))}function S0(t,e,n){var r=b0.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function E0(t,e,n){var r=b0.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function T0(t,e,n){var r=b0.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function N0(t,e,n){var r=b0.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function F0(t,e,n){var r=b0.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function D0(t,e,n){var r=b0.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function I0(t,e,n){var r=b0.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function M0(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function O0(t,e,n){var r=b0.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function R0(t,e,n){var r=b0.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function z0(t,e,n){var r=b0.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function B0(t,e,n){var r=b0.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function L0(t,e,n){var r=b0.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function P0(t,e,n){var r=b0.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function j0(t,e,n){var r=b0.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function U0(t,e,n){var r=b0.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function W0(t,e,n){var r=b0.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function V0(t,e,n){var r=x0.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function q0(t,e,n){var r=b0.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function G0(t,e,n){var r=b0.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function H0(t,e){return k0(t.getDate(),e,2)}function Y0(t,e){return k0(t.getHours(),e,2)}function X0(t,e){return k0(t.getHours()%12||12,e,2)}function K0(t,e){return k0(1+s0.count(u0(t),t),e,3)}function Q0(t,e){return k0(t.getMilliseconds(),e,3)}function Z0(t,e){return Q0(t,e)+"000"}function $0(t,e){return k0(t.getMonth()+1,e,2)}function J0(t,e){return k0(t.getMinutes(),e,2)}function t1(t,e){return k0(t.getSeconds(),e,2)}function e1(t){var e=t.getDay();return 0===e?7:e}function n1(t,e){return k0(JJ.count(u0(t)-1,t),e,2)}function r1(t){var e=t.getDay();return e>=4||0===e?r0(t):r0.ceil(t)}function i1(t,e){return t=r1(t),k0(r0.count(u0(t),t)+(4===u0(t).getDay()),e,2)}function a1(t){return t.getDay()}function o1(t,e){return k0(t0.count(u0(t)-1,t),e,2)}function s1(t,e){return k0(t.getFullYear()%100,e,2)}function c1(t,e){return k0((t=r1(t)).getFullYear()%100,e,2)}function u1(t,e){return k0(t.getFullYear()%1e4,e,4)}function l1(t,e){var n=t.getDay();return k0((t=n>=4||0===n?r0(t):r0.ceil(t)).getFullYear()%1e4,e,4)}function h1(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+k0(e/60|0,"0",2)+k0(e%60,"0",2)}function d1(t,e){return k0(t.getUTCDate(),e,2)}function f1(t,e){return k0(t.getUTCHours(),e,2)}function p1(t,e){return k0(t.getUTCHours()%12||12,e,2)}function g1(t,e){return k0(1+ZJ.count(h0(t),t),e,3)}function m1(t,e){return k0(t.getUTCMilliseconds(),e,3)}function v1(t,e){return m1(t,e)+"000"}function y1(t,e){return k0(t.getUTCMonth()+1,e,2)}function b1(t,e){return k0(t.getUTCMinutes(),e,2)}function x1(t,e){return k0(t.getUTCSeconds(),e,2)}function w1(t){var e=t.getUTCDay();return 0===e?7:e}function k1(t,e){return k0(VJ.count(h0(t)-1,t),e,2)}function _1(t){var e=t.getUTCDay();return e>=4||0===e?YJ(t):YJ.ceil(t)}function A1(t,e){return t=_1(t),k0(YJ.count(h0(t),t)+(4===h0(t).getUTCDay()),e,2)}function C1(t){return t.getUTCDay()}function S1(t,e){return k0(qJ.count(h0(t)-1,t),e,2)}function E1(t,e){return k0(t.getUTCFullYear()%100,e,2)}function T1(t,e){return k0((t=_1(t)).getUTCFullYear()%100,e,2)}function N1(t,e){return k0(t.getUTCFullYear()%1e4,e,4)}function F1(t,e){var n=t.getUTCDay();return k0((t=n>=4||0===n?YJ(t):YJ.ceil(t)).getUTCFullYear()%1e4,e,4)}function D1(){return"+0000"}function I1(){return"%"}function M1(t){return+t}function O1(t){return Math.floor(+t/1e3)}function R1(t){return new Date(t)}function z1(t){return t instanceof Date?+t:+new Date(+t)}function B1(t,e,n,r,i,a,o,s,c,u){var l=v$(),h=l.invert,d=l.domain,f=u(".%L"),p=u(":%S"),g=u("%I:%M"),m=u("%I %p"),v=u("%a %d"),y=u("%b %d"),b=u("%B"),x=u("%Y");function w(t){return(c(t)<t?f:s(t)<t?p:o(t)<t?g:a(t)<t?m:r(t)<t?i(t)<t?v:y:n(t)<t?b:x)(t)}return l.invert=function(t){return new Date(h(t))},l.domain=function(t){return arguments.length?d(Array.from(t,z1)):d().map(R1)},l.ticks=function(e){var n=d();return t(n[0],n[n.length-1],null==e?10:e)},l.tickFormat=function(t,e){return null==e?w:u(e)},l.nice=function(t){var n=d();return t&&"function"===typeof t.range||(t=e(n[0],n[n.length-1],null==t?10:t)),t?d(b$(n,t)):l},l.copy=function(){return g$(l,B1(t,e,n,r,i,a,o,s,c,u))},l}function L1(){var t,e,n,r,i,a=0,o=1,s=h$,c=!1;function u(e){return null==e||isNaN(e=+e)?i:s(0===n?.5:(e=(r(e)-t)*n,c?Math.max(0,Math.min(1,e)):e))}function l(t){return function(e){var n,r;return arguments.length?([n,r]=e,s=t(n,r),u):[s(0),s(1)]}}return u.domain=function(i){return arguments.length?([a,o]=i,t=r(a=+a),e=r(o=+o),n=t===e?0:1/(e-t),u):[a,o]},u.clamp=function(t){return arguments.length?(c=!!t,u):c},u.interpolator=function(t){return arguments.length?(s=t,u):s},u.range=l(uS),u.rangeRound=l(cC),u.unknown=function(t){return arguments.length?(i=t,u):i},function(i){return r=i,t=i(a),e=i(o),n=t===e?0:1/(e-t),u}}function P1(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function j1(){var t=y$(L1()(h$));return t.copy=function(){return P1(t,j1())},qZ.apply(t,arguments)}function U1(){var t=F$(L1());return t.copy=function(){return P1(t,U1()).exponent(t.exponent())},qZ.apply(t,arguments)}function W1(t,e){void 0===e&&(e=t,t=uS);for(var n=0,r=e.length-1,i=e[0],a=new Array(r<0?0:r);n<r;)a[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return a[e](t-e)}}function V1(){var t,e,n,r,i,a,o,s=0,c=.5,u=1,l=1,h=h$,d=!1;function f(t){return isNaN(t=+t)?o:(t=.5+((t=+a(t))-e)*(l*t<l*e?r:i),h(d?Math.max(0,Math.min(1,t)):t))}function p(t){return function(e){var n,r,i;return arguments.length?([n,r,i]=e,h=W1(t,[n,r,i]),f):[h(0),h(.5),h(1)]}}return f.domain=function(o){return arguments.length?([s,c,u]=o,t=a(s=+s),e=a(c=+c),n=a(u=+u),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),l=e<t?-1:1,f):[s,c,u]},f.clamp=function(t){return arguments.length?(d=!!t,f):d},f.interpolator=function(t){return arguments.length?(h=t,f):h},f.range=p(uS),f.rangeRound=p(cC),f.unknown=function(t){return arguments.length?(o=t,f):o},function(o){return a=o,t=o(s),e=o(c),n=o(u),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),l=e<t?-1:1,f}}function q1(){var t=F$(V1());return t.copy=function(){return P1(t,q1()).exponent(t.exponent())},qZ.apply(t,arguments)}function G1(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function H1(t,e){var n=HC(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}}!function(t){g0=function(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,a=t.days,o=t.shortDays,s=t.months,c=t.shortMonths,u=A0(i),l=C0(i),h=A0(a),d=C0(a),f=A0(o),p=C0(o),g=A0(s),m=C0(s),v=A0(c),y=C0(c),b={a:function(t){return o[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:H0,e:H0,f:Z0,g:c1,G:l1,H:Y0,I:X0,j:K0,L:Q0,m:$0,M:J0,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:M1,s:O1,S:t1,u:e1,U:n1,V:i1,w:a1,W:o1,x:null,X:null,y:s1,Y:u1,Z:h1,"%":I1},x={a:function(t){return o[t.getUTCDay()]},A:function(t){return a[t.getUTCDay()]},b:function(t){return c[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:d1,e:d1,f:v1,g:T1,G:F1,H:f1,I:p1,j:g1,L:m1,m:y1,M:b1,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:M1,s:O1,S:x1,u:w1,U:k1,V:A1,w:C1,W:S1,x:null,X:null,y:E1,Y:N1,Z:D1,"%":I1},w={a:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(t,e,n){var r=v.exec(e.slice(n));return r?(t.m=y.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(t,e,n){var r=g.exec(e.slice(n));return r?(t.m=m.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(t,n,r){return A(t,e,n,r)},d:z0,e:z0,f:W0,g:I0,G:D0,H:L0,I:L0,j:B0,L:U0,m:R0,M:P0,p:function(t,e,n){var r=u.exec(e.slice(n));return r?(t.p=l.get(r[0].toLowerCase()),n+r[0].length):-1},q:O0,Q:q0,s:G0,S:j0,u:E0,U:T0,V:N0,w:S0,W:F0,x:function(t,e,r){return A(t,n,e,r)},X:function(t,e,n){return A(t,r,e,n)},y:I0,Y:D0,Z:M0,"%":V0};function k(t,e){return function(n){var r,i,a,o=[],s=-1,c=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===t.charCodeAt(s)&&(o.push(t.slice(c,s)),null!=(i=y0[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(a=e[r])&&(r=a(n,i)),o.push(r),c=s+1);return o.push(t.slice(c,s)),o.join("")}}function _(t,e){return function(n){var r,i,a=p0(1900,void 0,1);if(A(a,t,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("s"in a)return new Date(1e3*a.s+("L"in a?a.L:0));if(e&&!("Z"in a)&&(a.Z=0),"p"in a&&(a.H=a.H%12+12*a.p),void 0===a.m&&(a.m="q"in a?a.q:0),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(i=(r=f0(p0(a.y,0,1))).getUTCDay(),r=i>4||0===i?qJ.ceil(r):qJ(r),r=ZJ.offset(r,7*(a.V-1)),a.y=r.getUTCFullYear(),a.m=r.getUTCMonth(),a.d=r.getUTCDate()+(a.w+6)%7):(i=(r=d0(p0(a.y,0,1))).getDay(),r=i>4||0===i?t0.ceil(r):t0(r),r=s0.offset(r,7*(a.V-1)),a.y=r.getFullYear(),a.m=r.getMonth(),a.d=r.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),i="Z"in a?f0(p0(a.y,0,1)).getUTCDay():d0(p0(a.y,0,1)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(i+5)%7:a.w+7*a.U-(i+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,f0(a)):d0(a)}}function A(t,e,n,r){for(var i,a,o=0,s=e.length,c=n.length;o<s;){if(r>=c)return-1;if(37===(i=e.charCodeAt(o++))){if(i=e.charAt(o++),!(a=w[i in y0?e.charAt(o++):i])||(r=a(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=k(n,b),b.X=k(r,b),b.c=k(e,b),x.x=k(n,x),x.X=k(r,x),x.c=k(e,x),{format:function(t){var e=k(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=_(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=k(t+="",x);return e.toString=function(){return t},e},utcParse:function(t){var e=_(t+="",!0);return e.toString=function(){return t},e}}}(t),m0=g0.format,g0.parse,v0=g0.utcFormat,g0.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Y1,X1=180/Math.PI,K1={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Q1(t,e,n,r,i,a){var o,s,c;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),t*r<e*n&&(t=-t,e=-e,c=-c,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*X1,skewX:Math.atan(c)*X1,scaleX:o,scaleY:s}}function Z1(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var s=[],c=[];return a=t(a),o=t(o),function(t,r,i,a,o,s){if(t!==i||r!==a){var c=o.push("translate(",null,e,null,n);s.push({i:c-4,x:iS(t,i)},{i:c-2,x:iS(r,a)})}else(i||a)&&o.push("translate("+i+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,c),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:iS(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(a.rotate,o.rotate,s,c),function(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:iS(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(a.skewX,o.skewX,s,c),function(t,e,n,r,a,o){if(t!==n||e!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:iS(t,n)},{i:s-2,x:iS(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,c),a=o=null,function(t){for(var e,n=-1,r=c.length;++n<r;)s[(e=c[n]).i]=e.x(t);return s.join("")}}}var $1=Z1((function(t){const e=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?K1:Q1(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),J1=Z1((function(t){return null==t?K1:(Y1||(Y1=document.createElementNS("http://www.w3.org/2000/svg","g")),Y1.setAttribute("transform",t),(t=Y1.transform.baseVal.consolidate())?Q1((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):K1)}),", ",")",")");function t2(t){return((t=Math.exp(t))+1/t)/2}const e2=function t(e,n,r){function i(t,i){var a,o,s=t[0],c=t[1],u=t[2],l=i[0],h=i[1],d=i[2],f=l-s,p=h-c,g=f*f+p*p;if(g<1e-12)o=Math.log(d/u)/e,a=function(t){return[s+t*f,c+t*p,u*Math.exp(e*t*o)]};else{var m=Math.sqrt(g),v=(d*d-u*u+r*g)/(2*u*n*m),y=(d*d-u*u-r*g)/(2*d*n*m),b=Math.log(Math.sqrt(v*v+1)-v),x=Math.log(Math.sqrt(y*y+1)-y);o=(x-b)/e,a=function(t){var r=t*o,i=t2(b),a=u/(n*m)*(i*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(e*r+b)-function(t){return((t=Math.exp(t))-1/t)/2}(b));return[s+a*f,c+a*p,u*i/t2(e*r+b)]}}return a.duration=1e3*o*e/Math.SQRT2,a}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i}(Math.SQRT2,2,4);function n2(t){return function(e,n){var r=t((e=LC(e)).h,(n=LC(n)).h),i=XC(e.s,n.s),a=XC(e.l,n.l),o=XC(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=a(t),e.opacity=o(t),e+""}}}const r2=n2(HC);var i2=n2(XC);const a2=Math.PI/180,o2=180/Math.PI,s2=.96422,c2=1,u2=.82521,l2=4/29,h2=6/29,d2=.12841854934601665,f2=.008856451679035631;function p2(t){if(t instanceof m2)return new m2(t.l,t.a,t.b,t.opacity);if(t instanceof _2)return A2(t);t instanceof IC||(t=FC(t));var e,n,r=x2(t.r),i=x2(t.g),a=x2(t.b),o=v2((.2225045*r+.7168786*i+.0606169*a)/c2);return r===i&&i===a?e=n=o:(e=v2((.4360747*r+.3850649*i+.1430804*a)/s2),n=v2((.0139322*r+.0971045*i+.7141733*a)/u2)),new m2(116*o-16,500*(e-o),200*(o-n),t.opacity)}function g2(t,e,n,r){return 1===arguments.length?p2(t):new m2(t,e,n,null==r?1:r)}function m2(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function v2(t){return t>f2?Math.pow(t,1/3):t/d2+l2}function y2(t){return t>h2?t*t*t:d2*(t-l2)}function b2(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function x2(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function w2(t){if(t instanceof _2)return new _2(t.h,t.c,t.l,t.opacity);if(t instanceof m2||(t=p2(t)),0===t.a&&0===t.b)return new _2(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*o2;return new _2(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function k2(t,e,n,r){return 1===arguments.length?w2(t):new _2(t,e,n,null==r?1:r)}function _2(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function A2(t){if(isNaN(t.h))return new m2(t.l,0,0,t.opacity);var e=t.h*a2;return new m2(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function C2(t,e){var n=XC((t=g2(t)).l,(e=g2(e)).l),r=XC(t.a,e.a),i=XC(t.b,e.b),a=XC(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=a(e),t+""}}function S2(t){return function(e,n){var r=t((e=k2(e)).h,(n=k2(n)).h),i=XC(e.c,n.c),a=XC(e.l,n.l),o=XC(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=a(t),e.opacity=o(t),e+""}}}uC(m2,g2,lC(hC,{brighter:function(t){return new m2(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new m2(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new IC(b2(3.1338561*(e=s2*y2(e))-1.6168667*(t=c2*y2(t))-.4906146*(n=u2*y2(n))),b2(-.9787684*e+1.9161415*t+.033454*n),b2(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),uC(_2,k2,lC(hC,{brighter:function(t){return new _2(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new _2(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return A2(this).rgb()}}));const E2=S2(HC);var T2=S2(XC),N2=-.14861,F2=1.78277,D2=-.29227,I2=-.90649,M2=1.97294,O2=M2*I2,R2=M2*F2,z2=F2*D2-I2*N2;function B2(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof L2)return new L2(t.h,t.s,t.l,t.opacity);t instanceof IC||(t=FC(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(z2*r+O2*e-R2*n)/(z2+O2-R2),a=r-i,o=(M2*(n-i)-D2*a)/I2,s=Math.sqrt(o*o+a*a)/(M2*i*(1-i)),c=s?Math.atan2(o,a)*o2-120:NaN;return new L2(c<0?c+360:c,s,i,t.opacity)}(t):new L2(t,e,n,null==r?1:r)}function L2(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function P2(t){return function e(n){function r(e,r){var i=t((e=B2(e)).h,(r=B2(r)).h),a=XC(e.s,r.s),o=XC(e.l,r.l),s=XC(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=a(t),e.l=o(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}uC(L2,B2,lC(hC,{brighter:function(t){return t=null==t?fC:Math.pow(fC,t),new L2(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?dC:Math.pow(dC,t),new L2(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*a2,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new IC(255*(e+n*(N2*r+F2*i)),255*(e+n*(D2*r+I2*i)),255*(e+n*(M2*r)),this.opacity)}}));const j2=P2(HC);var U2=P2(XC);function W2(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}const V2="year",q2="quarter",G2="month",H2="week",Y2="date",X2="day",K2="dayofyear",Q2="hours",Z2="minutes",$2="seconds",J2="milliseconds";[V2,q2,G2,H2,Y2,X2,K2,Q2,Z2,$2,J2].reduce(((t,e,n)=>(t[e]=1+n,t)),{});"".concat(V2,"-").concat(G2),"".concat(V2,"-").concat(G2,"-").concat(Y2),"".concat(Q2,"-").concat(Z2);new Date;yi.every(3),bi.every(3);const t3=[V2,G2,Y2,Q2,Z2,$2,J2],e3=t3.slice(0,-1),n3=e3.slice(0,-1),r3=n3.slice(0,-1);r3.slice(0,-1);const i3="linear",a3="log",o3="pow",s3="sqrt",c3="symlog",u3="time",l3="utc",h3="sequential",d3="diverging",f3="quantile",p3="quantize",g3="threshold",m3="continuous",v3="discrete",y3="discretizing",b3="interpolating",x3="temporal";function w3(){const t=HZ().unknown(void 0),e=t.domain,n=t.range;let r,i,a=[0,1],o=!1,s=0,c=0,u=.5;function l(){const t=e().length,l=a[1]<a[0],h=a[1-l],d=function(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0}(t,s,c);let f=a[l-0];r=(h-f)/(d||1),o&&(r=Math.floor(r)),f+=(h-f-r*(t-s))*u,i=r*(1-s),o&&(f=Math.round(f),i=Math.round(i));const p=zu(t).map((t=>f+r*t));return n(l?p.reverse():p)}return delete t.unknown,t.domain=function(t){return arguments.length?(e(t),l()):e()},t.range=function(t){return arguments.length?(a=[+t[0],+t[1]],l()):a.slice()},t.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,l()},t.bandwidth=function(){return i},t.step=function(){return r},t.round=function(t){return arguments.length?(o=!!t,l()):o},t.padding=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),s=c,l()):s},t.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),l()):s},t.paddingOuter=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),l()):c},t.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),l()):u},t.invertRange=function(t){if(null==t[0]||null==t[1])return;const r=a[1]<a[0],o=r?n().reverse():n(),s=o.length-1;let c,u,l,h=+t[0],d=+t[1];return h!==h||d!==d||(d<h&&(l=h,h=d,d=l),d<o[0]||h>a[1-r])?void 0:(c=Math.max(0,tz(o,h)-1),u=h===d?c:tz(o,d)-1,h-o[c]>i+1e-10&&++c,r&&(l=c,c=s-u,u=s-l),c>u?void 0:e().slice(c,u+1))},t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return w3().domain(e()).range(a).round(o).paddingInner(s).paddingOuter(c).align(u)},l()}function k3(t){const e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return k3(e())},t}var _3=Array.prototype.map;const A3=Array.prototype.slice;const C3={};function S3(t,e,n){return arguments.length>1?(C3[t]=function(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){let n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){const n=t.range();let r,i,a,o,s=e[0],c=e[1],u=-1;for(c<s&&(i=s,s=c,c=i),a=0,o=n.length;a<o;++a)n[a]>=s&&n[a]<=c&&(u<0&&(u=a),r=a);if(!(u<0))return s=t.invertExtent(n[u]),c=t.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===c[1]?c[0]:c[1]]}}(n):void 0),n.type=t,n};return r.metadata=function(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}(jZ(n)),r}(t,e,n),this):function(t){return WZ(C3,t)}(t)?C3[t]:void 0}S3("identity",(function t(e){var n;function r(t){return null==t||isNaN(t=+t)?n:t}return r.invert=r,r.domain=r.range=function(t){return arguments.length?(e=Array.from(t,u$),r):e.slice()},r.unknown=function(t){return arguments.length?(n=t,r):n},r.copy=function(){return t(e).unknown(n)},e=arguments.length?Array.from(e,u$):[0,1],y$(r)})),S3(i3,(function t(){var e=v$();return e.copy=function(){return g$(e,t())},VZ.apply(e,arguments),y$(e)}),m3),S3(a3,(function t(){var e=S$(m$()).domain([1,10]);return e.copy=function(){return g$(e,t()).base(e.base())},VZ.apply(e,arguments),e}),[m3,a3]),S3(o3,D$,m3),S3(s3,(function(){return D$.apply(null,arguments).exponent(.5)}),m3),S3(c3,(function t(){var e=O$(m$());return e.copy=function(){return g$(e,t()).constant(e.constant())},VZ.apply(e,arguments)}),m3),S3(u3,(function(){return VZ.apply(B1(OJ,RJ,dJ,lJ,nJ,tJ,$$,Q$,X$,m0).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}),[m3,x3]),S3(l3,(function(){return VZ.apply(B1(IJ,MJ,FJ,TJ,xJ,yJ,mJ,pJ,X$,v0).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}),[m3,x3]),S3(h3,j1,[m3,b3]),S3("".concat(h3,"-").concat(i3),j1,[m3,b3]),S3("".concat(h3,"-").concat(a3),(function t(){var e=S$(L1()).domain([1,10]);return e.copy=function(){return P1(e,t()).base(e.base())},qZ.apply(e,arguments)}),[m3,b3,a3]),S3("".concat(h3,"-").concat(o3),U1,[m3,b3]),S3("".concat(h3,"-").concat(s3),(function(){return U1.apply(null,arguments).exponent(.5)}),[m3,b3]),S3("".concat(h3,"-").concat(c3),(function t(){var e=O$(L1());return e.copy=function(){return P1(e,t()).constant(e.constant())},qZ.apply(e,arguments)}),[m3,b3]),S3("".concat(d3,"-").concat(i3),(function t(){var e=y$(V1()(h$));return e.copy=function(){return P1(e,t())},qZ.apply(e,arguments)}),[m3,b3]),S3("".concat(d3,"-").concat(a3),(function t(){var e=S$(V1()).domain([.1,1,10]);return e.copy=function(){return P1(e,t()).base(e.base())},qZ.apply(e,arguments)}),[m3,b3,a3]),S3("".concat(d3,"-").concat(o3),q1,[m3,b3]),S3("".concat(d3,"-").concat(s3),(function(){return q1.apply(null,arguments).exponent(.5)}),[m3,b3]),S3("".concat(d3,"-").concat(c3),(function t(){var e=O$(V1());return e.copy=function(){return P1(e,t()).constant(e.constant())},qZ.apply(e,arguments)}),[m3,b3]),S3(f3,(function t(){var e,n=[],r=[],i=[];function a(){var t=0,e=Math.max(1,r.length);for(i=new Array(e-1);++t<e;)i[t-1]=Ou(n,t/e);return o}function o(t){return null==t||isNaN(t=+t)?e:r[nz(i,t)]}return o.invertExtent=function(t){var e=r.indexOf(t);return e<0?[NaN,NaN]:[e>0?i[e-1]:n[0],e<i.length?i[e]:n[n.length-1]]},o.domain=function(t){if(!arguments.length)return n.slice();n=[];for(let e of t)null==e||isNaN(e=+e)||n.push(e);return n.sort(Nu),a()},o.range=function(t){return arguments.length?(r=Array.from(t),a()):r.slice()},o.unknown=function(t){return arguments.length?(e=t,o):e},o.quantiles=function(){return i.slice()},o.copy=function(){return t().domain(n).range(r).unknown(e)},VZ.apply(o,arguments)}),[y3,f3]),S3(p3,(function t(){var e,n=0,r=1,i=1,a=[.5],o=[0,1];function s(t){return null!=t&&t<=t?o[nz(a,t,0,i)]:e}function c(){var t=-1;for(a=new Array(i);++t<i;)a[t]=((t+1)*r-(t-i)*n)/(i+1);return s}return s.domain=function(t){return arguments.length?([n,r]=t,n=+n,r=+r,c()):[n,r]},s.range=function(t){return arguments.length?(i=(o=Array.from(t)).length-1,c()):o.slice()},s.invertExtent=function(t){var e=o.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,a[0]]:e>=i?[a[i-1],r]:[a[e-1],a[e]]},s.unknown=function(t){return arguments.length?(e=t,s):s},s.thresholds=function(){return a.slice()},s.copy=function(){return t().domain([n,r]).range(o).unknown(e)},VZ.apply(y$(s),arguments)}),y3),S3(g3,(function t(){var e,n=[.5],r=[0,1],i=1;function a(t){return null!=t&&t<=t?r[nz(n,t,0,i)]:e}return a.domain=function(t){return arguments.length?(n=Array.from(t),i=Math.min(n.length,r.length-1),a):n.slice()},a.range=function(t){return arguments.length?(r=Array.from(t),i=Math.min(n.length,r.length-1),a):r.slice()},a.invertExtent=function(t){var e=r.indexOf(t);return[n[e-1],n[e]]},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return t().domain(n).range(r).unknown(e)},VZ.apply(a,arguments)}),y3),S3("bin-ordinal",(function t(){let e=[],n=[];function r(t){return null==t||t!==t?void 0:n[(nz(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=function(t){return _3.call(t,PZ)}(t),r):e.slice()},r.range=function(t){return arguments.length?(n=A3.call(t),r):n.slice()},r.tickFormat=function(t,n){return c$(e[0],LZ(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}),[v3,y3]),S3("ordinal",HZ,v3),S3("band",w3,v3),S3("point",(function(){return k3(w3().paddingInner(1))}),v3);function E3(t,e){const n=e[0],r=LZ(e)-n;return function(e){return t(n+e*r)}}function T3(t,e,n){return W1(F3(e||"rgb",n),t)}function N3(t,e){const n=new Array(e),r=e+1;for(let i=0;i<e;)n[i]=t(++i/r);return n}function F3(t,e){const n=y[function(t){return"interpolate"+t.toLowerCase().split("-").map((t=>t[0].toUpperCase()+t.slice(1))).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}function D3(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function I3(t,e){for(const n in t)O3(n,e(t[n]))}const M3={};function O3(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(M3[t]=e,this):M3[t]}I3({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},D3),I3({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(t=>T3(D3(t))));const R3=t=>t;function z3(t,e){t&&L3.hasOwnProperty(t.type)&&L3[t.type](t,e)}var B3={Feature:function(t,e){z3(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)z3(n[r].geometry,e)}},L3={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){P3(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)P3(n[r],e,0)},Polygon:function(t,e){j3(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)j3(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)z3(n[r],e)}};function P3(t,e,n){var r,i=-1,a=t.length-n;for(e.lineStart();++i<a;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function j3(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)P3(t[n],e,1);e.polygonEnd()}function U3(t,e){t&&B3.hasOwnProperty(t.type)?B3[t.type](t,e):z3(t,e)}class W3{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=e[r],a=t+i,o=Math.abs(t)<Math.abs(i)?t-(a-i):i-(a-t);o&&(e[n++]=o),t=a}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,r,i=this._n,a=0;if(i>0){for(a=t[--i];i>0&&(e=a,n=t[--i],a=e+n,r=n-(a-e),!r););i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(n=2*r,e=a+n,n==e-a&&(a=e))}return a}}function V3(){}var q3,G3,H3,Y3,X3=new W3,K3=new W3,Q3={point:V3,lineStart:V3,lineEnd:V3,polygonStart:function(){Q3.lineStart=Z3,Q3.lineEnd=t4},polygonEnd:function(){Q3.lineStart=Q3.lineEnd=Q3.point=V3,X3.add(ID(K3)),K3=new W3},result:function(){var t=X3/2;return X3=new W3,t}};function Z3(){Q3.point=$3}function $3(t,e){Q3.point=J3,q3=H3=t,G3=Y3=e}function J3(t,e){K3.add(Y3*t-H3*e),H3=t,Y3=e}function t4(){J3(q3,G3)}const e4=Q3;var n4=1/0,r4=n4,i4=-n4,a4=i4,o4={point:function(t,e){t<n4&&(n4=t);t>i4&&(i4=t);e<r4&&(r4=e);e>a4&&(a4=e)},lineStart:V3,lineEnd:V3,polygonStart:V3,polygonEnd:V3,result:function(){var t=[[n4,r4],[i4,a4]];return i4=a4=-(r4=n4=1/0),t}};const s4=o4;var c4,u4,l4,h4,d4=0,f4=0,p4=0,g4=0,m4=0,v4=0,y4=0,b4=0,x4=0,w4={point:k4,lineStart:_4,lineEnd:S4,polygonStart:function(){w4.lineStart=E4,w4.lineEnd=T4},polygonEnd:function(){w4.point=k4,w4.lineStart=_4,w4.lineEnd=S4},result:function(){var t=x4?[y4/x4,b4/x4]:v4?[g4/v4,m4/v4]:p4?[d4/p4,f4/p4]:[NaN,NaN];return d4=f4=p4=g4=m4=v4=y4=b4=x4=0,t}};function k4(t,e){d4+=t,f4+=e,++p4}function _4(){w4.point=A4}function A4(t,e){w4.point=C4,k4(l4=t,h4=e)}function C4(t,e){var n=t-l4,r=e-h4,i=VD(n*n+r*r);g4+=i*(l4+t)/2,m4+=i*(h4+e)/2,v4+=i,k4(l4=t,h4=e)}function S4(){w4.point=k4}function E4(){w4.point=N4}function T4(){F4(c4,u4)}function N4(t,e){w4.point=F4,k4(c4=l4=t,u4=h4=e)}function F4(t,e){var n=t-l4,r=e-h4,i=VD(n*n+r*r);g4+=i*(l4+t)/2,m4+=i*(h4+e)/2,v4+=i,y4+=(i=h4*t-l4*e)*(l4+t),b4+=i*(h4+e),x4+=3*i,k4(l4=t,h4=e)}const D4=w4;function I4(t){this._context=t}I4.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,ND)}},result:V3};var M4,O4,R4,z4,B4,L4=new W3,P4={point:V3,lineStart:function(){P4.point=j4},lineEnd:function(){M4&&U4(O4,R4),P4.point=V3},polygonStart:function(){M4=!0},polygonEnd:function(){M4=null},result:function(){var t=+L4;return L4=new W3,t}};function j4(t,e){P4.point=U4,O4=z4=t,R4=B4=e}function U4(t,e){z4-=t,B4-=e,L4.add(VD(z4*z4+B4*B4)),z4=t,B4=e}const W4=P4;function V4(){this._string=[]}function q4(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function G4(t,e){var n,r,i=4.5;function a(t){return t&&("function"===typeof i&&r.pointRadius(+i.apply(this,arguments)),U3(t,n(r))),r.result()}return a.area=function(t){return U3(t,n(e4)),e4.result()},a.measure=function(t){return U3(t,n(W4)),W4.result()},a.bounds=function(t){return U3(t,n(s4)),s4.result()},a.centroid=function(t){return U3(t,n(D4)),D4.result()},a.projection=function(e){return arguments.length?(n=null==e?(t=null,R3):(t=e).stream,a):t},a.context=function(t){return arguments.length?(r=null==t?(e=null,new V4):new I4(e=t),"function"!==typeof i&&r.pointRadius(i),a):e},a.pointRadius=function(t){return arguments.length?(i="function"===typeof t?t:(r.pointRadius(+t),+t),a):i},a.projection(t).context(e)}function H4(){var t,e=[];return{point:function(e,n,r){t.push([e,n,r])},lineStart:function(){e.push(t=[])},lineEnd:V3,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Y4(t,e){return ID(t[0]-e[0])<AD&&ID(t[1]-e[1])<AD}function X4(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function K4(t,e,n,r,i){var a,o,s=[],c=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],o=t[e];if(Y4(r,o)){if(!r[2]&&!o[2]){for(i.lineStart(),a=0;a<e;++a)i.point((r=t[a])[0],r[1]);return void i.lineEnd()}o[0]+=2*AD}s.push(n=new X4(r,t,null,!0)),c.push(n.o=new X4(r,null,n,!1)),s.push(n=new X4(o,t,null,!1)),c.push(n.o=new X4(o,null,n,!0))}})),s.length){for(c.sort(e),Q4(s),Q4(c),a=0,o=c.length;a<o;++a)c[a].e=n=!n;for(var u,l,h=s[0];;){for(var d=h,f=!0;d.v;)if((d=d.n)===h)return;u=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(f)for(a=0,o=u.length;a<o;++a)i.point((l=u[a])[0],l[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(f)for(u=d.p.z,a=u.length-1;a>=0;--a)i.point((l=u[a])[0],l[1]);else r(d.x,d.p.x,-1,i);d=d.p}u=(d=d.o).z,f=!f}while(!d.v);i.lineEnd()}}}function Q4(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}function Z4(t){return[OD(t[1],t[0]),HD(t[2])]}function $4(t){var e=t[0],n=t[1],r=RD(n);return[r*RD(e),r*UD(e),UD(n)]}function J4(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function t7(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function e7(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function n7(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function r7(t){var e=VD(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function i7(t){return ID(t[0])<=SD?t[0]:WD(t[0])*((ID(t[0])+SD)%ND-SD)}function a7(t){return Array.from(function*(t){for(const e of t)yield*e}(t))}function o7(t,e,n,r){return function(i){var a,o,s,c=e(i),u=H4(),l=e(u),h=!1,d={point:f,lineStart:g,lineEnd:m,polygonStart:function(){d.point=v,d.lineStart=y,d.lineEnd=b,o=[],a=[]},polygonEnd:function(){d.point=f,d.lineStart=g,d.lineEnd=m,o=a7(o);var t=function(t,e){var n=i7(e),r=e[1],i=UD(r),a=[UD(n),-RD(n),0],o=0,s=0,c=new W3;1===i?r=ED+AD:-1===i&&(r=-ED-AD);for(var u=0,l=t.length;u<l;++u)if(d=(h=t[u]).length)for(var h,d,f=h[d-1],p=i7(f),g=f[1]/2+TD,m=UD(g),v=RD(g),y=0;y<d;++y,p=x,m=k,v=_,f=b){var b=h[y],x=i7(b),w=b[1]/2+TD,k=UD(w),_=RD(w),A=x-p,C=A>=0?1:-1,S=C*A,E=S>SD,T=m*k;if(c.add(OD(T*C*UD(S),v*_+T*RD(S))),o+=E?A+C*ND:A,E^p>=n^x>=n){var N=t7($4(f),$4(b));r7(N);var F=t7(a,N);r7(F);var D=(E^A>=0?-1:1)*HD(F[2]);(r>D||r===D&&(N[0]||N[1]))&&(s+=E^A>=0?1:-1)}}return(o<-AD||o<AD&&c<-CD)^1&s}(a,r);o.length?(h||(i.polygonStart(),h=!0),K4(o,c7,t,n,i)):t&&(h||(i.polygonStart(),h=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),o=a=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function f(e,n){t(e,n)&&i.point(e,n)}function p(t,e){c.point(t,e)}function g(){d.point=p,c.lineStart()}function m(){d.point=f,c.lineEnd()}function v(t,e){s.push([t,e]),l.point(t,e)}function y(){l.lineStart(),s=[]}function b(){v(s[0][0],s[0][1]),l.lineEnd();var t,e,n,r,c=l.clean(),d=u.result(),f=d.length;if(s.pop(),a.push(s),s=null,f)if(1&c){if((e=(n=d[0]).length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else f>1&&2&c&&d.push(d.pop().concat(d.shift())),o.push(d.filter(s7))}return d}}function s7(t){return t.length>1}function c7(t,e){return((t=t.x)[0]<0?t[1]-ED-AD:ED-t[1])-((e=e.x)[0]<0?e[1]-ED-AD:ED-e[1])}V4.prototype={_radius:4.5,_circle:q4(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=q4(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}};const u7=o7((function(){return!0}),(function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(a,o){var s=a>0?SD:-SD,c=ID(a-n);ID(c-SD)<AD?(t.point(n,r=(r+o)/2>0?ED:-ED),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(a,r),e=0):i!==s&&c>=SD&&(ID(n-i)<AD&&(n-=i*AD),ID(a-s)<AD&&(a-=s*AD),r=function(t,e,n,r){var i,a,o=UD(t-n);return ID(o)>AD?MD((UD(e)*(a=RD(r))*UD(n)-UD(r)*(i=RD(e))*UD(t))/(i*a*o)):(e+r)/2}(n,r,a,o),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=a,r=o),i=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var i;if(null==t)i=n*ED,r.point(-SD,i),r.point(0,i),r.point(SD,i),r.point(SD,0),r.point(SD,-i),r.point(0,-i),r.point(-SD,-i),r.point(-SD,0),r.point(-SD,i);else if(ID(t[0]-e[0])>AD){var a=t[0]<e[0]?SD:-SD;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(e[0],e[1])}),[-SD,-ED]);function l7(t,e,n,r,i,a){if(n){var o=RD(e),s=UD(e),c=r*n;null==i?(i=e+r*ND,a=e-c/2):(i=h7(o,i),a=h7(o,a),(r>0?i<a:i>a)&&(i+=r*ND));for(var u,l=i;r>0?l>a:l<a;l-=c)u=Z4([o,-s*RD(l),-s*UD(l)]),t.point(u[0],u[1])}}function h7(t,e){(e=$4(e))[0]-=t,r7(e);var n=GD(-e[1]);return((-e[2]<0?-n:n)+ND-AD)%ND}var d7=1e9,f7=-d7;function p7(t,e,n,r){function i(i,a){return t<=i&&i<=n&&e<=a&&a<=r}function a(i,a,s,u){var l=0,h=0;if(null==i||(l=o(i,s))!==(h=o(a,s))||c(i,a)<0^s>0)do{u.point(0===l||3===l?t:n,l>1?r:e)}while((l=(l+s+4)%4)!==h);else u.point(a[0],a[1])}function o(r,i){return ID(r[0]-t)<AD?i>0?0:3:ID(r[0]-n)<AD?i>0?2:1:ID(r[1]-e)<AD?i>0?1:0:i>0?3:2}function s(t,e){return c(t.x,e.x)}function c(t,e){var n=o(t,1),r=o(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(o){var c,u,l,h,d,f,p,g,m,v,y,b=o,x=H4(),w={point:k,lineStart:function(){w.point=_,u&&u.push(l=[]);v=!0,m=!1,p=g=NaN},lineEnd:function(){c&&(_(h,d),f&&m&&x.rejoin(),c.push(x.result()));w.point=k,m&&b.lineEnd()},polygonStart:function(){b=x,c=[],u=[],y=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=u.length;n<i;++n)for(var a,o,s=u[n],c=1,l=s.length,h=s[0],d=h[0],f=h[1];c<l;++c)a=d,o=f,d=(h=s[c])[0],f=h[1],o<=r?f>r&&(d-a)*(r-o)>(f-o)*(t-a)&&++e:f<=r&&(d-a)*(r-o)<(f-o)*(t-a)&&--e;return e}(),n=y&&e,i=(c=a7(c)).length;(n||i)&&(o.polygonStart(),n&&(o.lineStart(),a(null,null,1,o),o.lineEnd()),i&&K4(c,s,e,a,o),o.polygonEnd());b=o,c=u=l=null}};function k(t,e){i(t,e)&&b.point(t,e)}function _(a,o){var s=i(a,o);if(u&&l.push([a,o]),v)h=a,d=o,f=s,v=!1,s&&(b.lineStart(),b.point(a,o));else if(s&&m)b.point(a,o);else{var c=[p=Math.max(f7,Math.min(d7,p)),g=Math.max(f7,Math.min(d7,g))],x=[a=Math.max(f7,Math.min(d7,a)),o=Math.max(f7,Math.min(d7,o))];!function(t,e,n,r,i,a){var o,s=t[0],c=t[1],u=0,l=1,h=e[0]-s,d=e[1]-c;if(o=n-s,h||!(o>0)){if(o/=h,h<0){if(o<u)return;o<l&&(l=o)}else if(h>0){if(o>l)return;o>u&&(u=o)}if(o=i-s,h||!(o<0)){if(o/=h,h<0){if(o>l)return;o>u&&(u=o)}else if(h>0){if(o<u)return;o<l&&(l=o)}if(o=r-c,d||!(o>0)){if(o/=d,d<0){if(o<u)return;o<l&&(l=o)}else if(d>0){if(o>l)return;o>u&&(u=o)}if(o=a-c,d||!(o<0)){if(o/=d,d<0){if(o>l)return;o>u&&(u=o)}else if(d>0){if(o<u)return;o<l&&(l=o)}return u>0&&(t[0]=s+u*h,t[1]=c+u*d),l<1&&(e[0]=s+l*h,e[1]=c+l*d),!0}}}}}(c,x,t,e,n,r)?s&&(b.lineStart(),b.point(a,o),y=!1):(m||(b.lineStart(),b.point(c[0],c[1])),b.point(x[0],x[1]),s||b.lineEnd(),y=!1)}p=a,g=o,m=s}return w}}function g7(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n}function m7(t,e){return[ID(t)>SD?t+Math.round(-t/ND)*ND:t,e]}function v7(t,e,n){return(t%=ND)?e||n?g7(b7(t),x7(e,n)):b7(t):e||n?x7(e,n):m7}function y7(t){return function(e,n){return[(e+=t)>SD?e-ND:e<-SD?e+ND:e,n]}}function b7(t){var e=y7(t);return e.invert=y7(-t),e}function x7(t,e){var n=RD(t),r=UD(t),i=RD(e),a=UD(e);function o(t,e){var o=RD(e),s=RD(t)*o,c=UD(t)*o,u=UD(e),l=u*n+s*r;return[OD(c*i-l*a,s*n-u*r),HD(l*i+c*a)]}return o.invert=function(t,e){var o=RD(e),s=RD(t)*o,c=UD(t)*o,u=UD(e),l=u*i-c*a;return[OD(c*i+u*a,s*n+l*r),HD(l*n-s*r)]},o}function w7(t){return function(e){var n=new k7;for(var r in t)n[r]=t[r];return n.stream=e,n}}function k7(){}function _7(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),U3(n,t.stream(s4)),e(s4.result()),null!=r&&t.clipExtent(r),t}function A7(t,e,n){return _7(t,(function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],a=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),o=+e[0][0]+(r-a*(n[1][0]+n[0][0]))/2,s=+e[0][1]+(i-a*(n[1][1]+n[0][1]))/2;t.scale(150*a).translate([o,s])}),n)}function C7(t,e,n){return A7(t,[[0,0],e],n)}function S7(t,e,n){return _7(t,(function(n){var r=+e,i=r/(n[1][0]-n[0][0]),a=(r-i*(n[1][0]+n[0][0]))/2,o=-i*n[0][1];t.scale(150*i).translate([a,o])}),n)}function E7(t,e,n){return _7(t,(function(n){var r=+e,i=r/(n[1][1]-n[0][1]),a=-i*n[0][0],o=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([a,o])}),n)}m7.invert=m7,k7.prototype={constructor:k7,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var T7=16,N7=RD(30*DD);function F7(t,e){return+e?function(t,e){function n(r,i,a,o,s,c,u,l,h,d,f,p,g,m){var v=u-r,y=l-i,b=v*v+y*y;if(b>4*e&&g--){var x=o+d,w=s+f,k=c+p,_=VD(x*x+w*w+k*k),A=HD(k/=_),C=ID(ID(k)-1)<AD||ID(a-h)<AD?(a+h)/2:OD(w,x),S=t(C,A),E=S[0],T=S[1],N=E-r,F=T-i,D=y*N-v*F;(D*D/b>e||ID((v*N+y*F)/b-.5)>.3||o*d+s*f+c*p<N7)&&(n(r,i,a,o,s,c,E,T,C,x/=_,w/=_,k,g,m),m.point(E,T),n(E,T,C,x,w,k,u,l,h,d,f,p,g,m))}}return function(e){var r,i,a,o,s,c,u,l,h,d,f,p,g={point:m,lineStart:v,lineEnd:b,polygonStart:function(){e.polygonStart(),g.lineStart=x},polygonEnd:function(){e.polygonEnd(),g.lineStart=v}};function m(n,r){n=t(n,r),e.point(n[0],n[1])}function v(){l=NaN,g.point=y,e.lineStart()}function y(r,i){var a=$4([r,i]),o=t(r,i);n(l,h,u,d,f,p,l=o[0],h=o[1],u=r,d=a[0],f=a[1],p=a[2],T7,e),e.point(l,h)}function b(){g.point=m,e.lineEnd()}function x(){v(),g.point=w,g.lineEnd=k}function w(t,e){y(r=t,e),i=l,a=h,o=d,s=f,c=p,g.point=y}function k(){n(l,h,u,d,f,p,i,a,r,o,s,c,T7,e),g.lineEnd=b,b()}return g}}(t,e):function(t){return w7({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var D7=w7({point:function(t,e){this.stream.point(t*DD,e*DD)}});function I7(t,e,n,r,i,a){if(!a)return function(t,e,n,r,i){function a(a,o){return[e+t*(a*=r),n-t*(o*=i)]}return a.invert=function(a,o){return[(a-e)/t*r,(n-o)/t*i]},a}(t,e,n,r,i);var o=RD(a),s=UD(a),c=o*t,u=s*t,l=o/t,h=s/t,d=(s*n-o*e)/t,f=(s*e+o*n)/t;function p(t,a){return[c*(t*=r)-u*(a*=i)+e,n-u*t-c*a]}return p.invert=function(t,e){return[r*(l*t-h*e+d),i*(f-h*t-l*e)]},p}function M7(t){return O7((function(){return t}))()}function O7(t){var e,n,r,i,a,o,s,c,u,l,h=150,d=480,f=250,p=0,g=0,m=0,v=0,y=0,b=0,x=1,w=1,k=null,_=u7,A=null,C=R3,S=.5;function E(t){return c(t[0]*DD,t[1]*DD)}function T(t){return(t=c.invert(t[0],t[1]))&&[t[0]*FD,t[1]*FD]}function N(){var t=I7(h,0,0,x,w,b).apply(null,e(p,g)),r=I7(h,d-t[0],f-t[1],x,w,b);return n=v7(m,v,y),s=g7(e,r),c=g7(n,s),o=F7(s,S),F()}function F(){return u=l=null,E}return E.stream=function(t){return u&&l===t?u:u=D7(function(t){return w7({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}(n)(_(o(C(l=t)))))},E.preclip=function(t){return arguments.length?(_=t,k=void 0,F()):_},E.postclip=function(t){return arguments.length?(C=t,A=r=i=a=null,F()):C},E.clipAngle=function(t){return arguments.length?(_=+t?function(t){var e=RD(t),n=6*DD,r=e>0,i=ID(e)>AD;function a(t,n){return RD(t)*RD(n)>e}function o(t,n,r){var i=[1,0,0],a=t7($4(t),$4(n)),o=J4(a,a),s=a[0],c=o-s*s;if(!c)return!r&&t;var u=e*o/c,l=-e*s/c,h=t7(i,a),d=n7(i,u);e7(d,n7(a,l));var f=h,p=J4(d,f),g=J4(f,f),m=p*p-g*(J4(d,d)-1);if(!(m<0)){var v=VD(m),y=n7(f,(-p-v)/g);if(e7(y,d),y=Z4(y),!r)return y;var b,x=t[0],w=n[0],k=t[1],_=n[1];w<x&&(b=x,x=w,w=b);var A=w-x,C=ID(A-SD)<AD;if(!C&&_<k&&(b=k,k=_,_=b),C||A<AD?C?k+_>0^y[1]<(ID(y[0]-x)<AD?k:_):k<=y[1]&&y[1]<=_:A>SD^(x<=y[0]&&y[0]<=w)){var S=n7(f,(-p+v)/g);return e7(S,d),[y,Z4(S)]}}}function s(e,n){var i=r?t:SD-t,a=0;return e<-i?a|=1:e>i&&(a|=2),n<-i?a|=4:n>i&&(a|=8),a}return o7(a,(function(t){var e,n,c,u,l;return{lineStart:function(){u=c=!1,l=1},point:function(h,d){var f,p=[h,d],g=a(h,d),m=r?g?0:s(h,d):g?s(h+(h<0?SD:-SD),d):0;if(!e&&(u=c=g)&&t.lineStart(),g!==c&&(!(f=o(e,p))||Y4(e,f)||Y4(p,f))&&(p[2]=1),g!==c)l=0,g?(t.lineStart(),f=o(p,e),t.point(f[0],f[1])):(f=o(e,p),t.point(f[0],f[1],2),t.lineEnd()),e=f;else if(i&&e&&r^g){var v;m&n||!(v=o(p,e,!0))||(l=0,r?(t.lineStart(),t.point(v[0][0],v[0][1]),t.point(v[1][0],v[1][1]),t.lineEnd()):(t.point(v[1][0],v[1][1]),t.lineEnd(),t.lineStart(),t.point(v[0][0],v[0][1],3)))}!g||e&&Y4(e,p)||t.point(p[0],p[1]),e=p,c=g,n=m},lineEnd:function(){c&&t.lineEnd(),e=null},clean:function(){return l|(u&&c)<<1}}}),(function(e,r,i,a){l7(a,t,n,i,e,r)}),r?[0,-t]:[-SD,t-SD])}(k=t*DD):(k=null,u7),F()):k*FD},E.clipExtent=function(t){return arguments.length?(C=null==t?(A=r=i=a=null,R3):p7(A=+t[0][0],r=+t[0][1],i=+t[1][0],a=+t[1][1]),F()):null==A?null:[[A,r],[i,a]]},E.scale=function(t){return arguments.length?(h=+t,N()):h},E.translate=function(t){return arguments.length?(d=+t[0],f=+t[1],N()):[d,f]},E.center=function(t){return arguments.length?(p=t[0]%360*DD,g=t[1]%360*DD,N()):[p*FD,g*FD]},E.rotate=function(t){return arguments.length?(m=t[0]%360*DD,v=t[1]%360*DD,y=t.length>2?t[2]%360*DD:0,N()):[m*FD,v*FD,y*FD]},E.angle=function(t){return arguments.length?(b=t%360*DD,N()):b*FD},E.reflectX=function(t){return arguments.length?(x=t?-1:1,N()):x<0},E.reflectY=function(t){return arguments.length?(w=t?-1:1,N()):w<0},E.precision=function(t){return arguments.length?(o=F7(s,S=t*t),F()):VD(S)},E.fitExtent=function(t,e){return A7(E,t,e)},E.fitSize=function(t,e){return C7(E,t,e)},E.fitWidth=function(t,e){return S7(E,t,e)},E.fitHeight=function(t,e){return E7(E,t,e)},function(){return e=t.apply(this,arguments),E.invert=e.invert&&T,N()}}function R7(t){var e=0,n=SD/3,r=O7(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*DD,n=t[1]*DD):[e*FD,n*FD]},i}function z7(t,e){var n=UD(t),r=(n+UD(e))/2;if(ID(r)<AD)return function(t){var e=RD(t);function n(t,n){return[t*e,UD(n)/e]}return n.invert=function(t,n){return[t/e,HD(n*e)]},n}(t);var i=1+n*(2*r-n),a=VD(i)/r;function o(t,e){var n=VD(i-2*r*UD(e))/r;return[n*UD(t*=r),a-n*RD(t)]}return o.invert=function(t,e){var n=a-e,o=OD(t,ID(n))*WD(n);return n*r<0&&(o-=SD*WD(t)*WD(n)),[o/r,HD((i-(t*t+n*n)*r*r)/(2*r))]},o}function B7(){return R7(z7).scale(155.424).center([0,33.6442])}function L7(){return B7().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function P7(t){return function(e,n){var r=RD(e),i=RD(n),a=t(r*i);return a===1/0?[2,0]:[a*i*UD(e),a*UD(n)]}}function j7(t){return function(e,n){var r=VD(e*e+n*n),i=t(r),a=UD(i),o=RD(i);return[OD(e*a,r*o),HD(r&&n*a/r)]}}var U7=P7((function(t){return VD(2/(1+t))}));U7.invert=j7((function(t){return 2*HD(t/2)}));var W7=P7((function(t){return(t=GD(t))&&t/UD(t)}));function V7(t,e){return[t,PD(qD((ED+e)/2))]}function q7(t){var e,n,r,i=M7(t),a=i.center,o=i.scale,s=i.translate,c=i.clipExtent,u=null;function l(){var a=SD*o(),s=i(function(t){function e(e){return(e=t(e[0]*DD,e[1]*DD))[0]*=FD,e[1]*=FD,e}return t=v7(t[0]*DD,t[1]*DD,t.length>2?t[2]*DD:0),e.invert=function(e){return(e=t.invert(e[0]*DD,e[1]*DD))[0]*=FD,e[1]*=FD,e},e}(i.rotate()).invert([0,0]));return c(null==u?[[s[0]-a,s[1]-a],[s[0]+a,s[1]+a]]:t===V7?[[Math.max(s[0]-a,u),e],[Math.min(s[0]+a,n),r]]:[[u,Math.max(s[1]-a,e)],[n,Math.min(s[1]+a,r)]])}return i.scale=function(t){return arguments.length?(o(t),l()):o()},i.translate=function(t){return arguments.length?(s(t),l()):s()},i.center=function(t){return arguments.length?(a(t),l()):a()},i.clipExtent=function(t){return arguments.length?(null==t?u=e=n=r=null:(u=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),l()):null==u?null:[[u,e],[n,r]]},l()}function G7(t){return qD((ED+t)/2)}function H7(t,e){var n=RD(t),r=t===e?UD(t):PD(n/RD(e))/PD(G7(e)/G7(t)),i=n*jD(G7(t),r)/r;if(!r)return V7;function a(t,e){i>0?e<-ED+AD&&(e=-ED+AD):e>ED-AD&&(e=ED-AD);var n=i/jD(G7(e),r);return[n*UD(r*t),i-n*RD(r*t)]}return a.invert=function(t,e){var n=i-e,a=WD(r)*VD(t*t+n*n),o=OD(t,ID(n))*WD(n);return n*r<0&&(o-=SD*WD(t)*WD(n)),[o/r,2*MD(jD(i/a,1/r))-ED]},a}function Y7(t,e){return[t,e]}function X7(t,e){var n=RD(t),r=t===e?UD(t):(n-RD(e))/(e-t),i=n/r+t;if(ID(r)<AD)return Y7;function a(t,e){var n=i-e,a=r*t;return[n*UD(a),i-n*RD(a)]}return a.invert=function(t,e){var n=i-e,a=OD(t,ID(n))*WD(n);return n*r<0&&(a-=SD*WD(t)*WD(n)),[a/r,i-WD(r)*VD(t*t+n*n)]},a}W7.invert=j7((function(t){return t})),V7.invert=function(t,e){return[t,2*MD(BD(e))-ED]},Y7.invert=Y7;var K7=1.340264,Q7=-.081106,Z7=893e-6,$7=.003796,J7=VD(3)/2;function t8(t,e){var n=HD(J7*UD(e)),r=n*n,i=r*r*r;return[t*RD(n)/(J7*(K7+3*Q7*r+i*(7*Z7+9*$7*r))),n*(K7+Q7*r+i*(Z7+$7*r))]}function e8(t,e){var n=RD(e),r=RD(t)*n;return[n*UD(t)/r,UD(e)/r]}function n8(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function r8(t,e){return[RD(e)*UD(t),UD(e)]}function i8(t,e){var n=RD(e),r=1+RD(t)*n;return[n*UD(t)/r,UD(e)/r]}function a8(t,e){return[PD(qD((ED+e)/2)),-t]}t8.invert=function(t,e){for(var n,r=e,i=r*r,a=i*i*i,o=0;o<12&&(a=(i=(r-=n=(r*(K7+Q7*i+a*(Z7+$7*i))-e)/(K7+3*Q7*i+a*(7*Z7+9*$7*i)))*r)*i*i,!(ID(n)<CD));++o);return[J7*t*(K7+3*Q7*i+a*(7*Z7+9*$7*i))/RD(r),HD(UD(r)/J7)]},e8.invert=j7(MD),n8.invert=function(t,e){var n,r=e,i=25;do{var a=r*r,o=a*a;r-=n=(r*(1.007226+a*(.015085+o*(.028874*a-.044475-.005916*o)))-e)/(1.007226+a*(.045255+o*(.259866*a-.311325-.005916*11*o)))}while(ID(n)>AD&&--i>0);return[t/(.8707+(a=r*r)*(a*(a*a*a*(.003971-.001529*a)-.013791)-.131979)),r]},r8.invert=j7(HD),i8.invert=j7((function(t){return 2*MD(t)})),a8.invert=function(t,e){return[-e,2*MD(BD(t))-ED]};var o8=Math.abs,s8=(Math.atan,Math.atan2,Math.ceil,Math.cos),c8=(Math.exp,Math.floor,Math.log,Math.max,Math.min,Math.pow,Math.round,Math.sign,Math.sin),u8=(Math.tan,1e-6),l8=Math.PI,h8=l8/2,d8=(Math.SQRT1_2,p8(2));p8(l8);function f8(t){return t>1?h8:t<-1?-h8:Math.asin(t)}function p8(t){return t>0?Math.sqrt(t):0}function g8(t,e){var n,r=t*c8(e),i=30;do{e-=n=(e+c8(e)-r)/(1+s8(e))}while(o8(n)>u8&&--i>0);return e/2}var m8=function(t,e,n){function r(r,i){return[t*r*s8(i=g8(n,i)),e*c8(i)]}return r.invert=function(r,i){return i=f8(i/e),[r/(t*s8(i)),f8((2*i+c8(2*i))/n)]},r}(d8/h8,d8,l8);G4();const v8=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function y8(t,e){if(!t||"string"!==typeof t)throw new Error("Projection type must be a name string.");return t=t.toLowerCase(),arguments.length>1?(b8[t]=function(t,e){return function n(){const r=e();return r.type=t,r.path=G4().projection(r),r.copy=r.copy||function(){const t=n();return v8.forEach((e=>{r[e]&&t[e](r[e]())})),t.path.pointRadius(r.path.pointRadius()),t},r}}(t,e),this):b8[t]||null}const b8={albers:L7,albersusa:function(){var t,e,n,r,i,a,o=L7(),s=B7().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=B7().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(t,e){a=[t,e]}};function l(t){var e=t[0],o=t[1];return a=null,n.point(e,o),a||(r.point(e,o),a)||(i.point(e,o),a)}function h(){return t=e=null,l}return l.invert=function(t){var e=o.scale(),n=o.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?c:o).invert(t)},l.stream=function(n){return t&&e===n?t:t=function(t){var e=t.length;return{point:function(n,r){for(var i=-1;++i<e;)t[i].point(n,r)},sphere:function(){for(var n=-1;++n<e;)t[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)t[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)t[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)t[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)t[n].polygonEnd()}}}([o.stream(e=n),s.stream(n),c.stream(n)])},l.precision=function(t){return arguments.length?(o.precision(t),s.precision(t),c.precision(t),h()):o.precision()},l.scale=function(t){return arguments.length?(o.scale(t),s.scale(.35*t),c.scale(t),l.translate(o.translate())):o.scale()},l.translate=function(t){if(!arguments.length)return o.translate();var e=o.scale(),a=+t[0],l=+t[1];return n=o.translate(t).clipExtent([[a-.455*e,l-.238*e],[a+.455*e,l+.238*e]]).stream(u),r=s.translate([a-.307*e,l+.201*e]).clipExtent([[a-.425*e+AD,l+.12*e+AD],[a-.214*e-AD,l+.234*e-AD]]).stream(u),i=c.translate([a-.205*e,l+.212*e]).clipExtent([[a-.214*e+AD,l+.166*e+AD],[a-.115*e-AD,l+.234*e-AD]]).stream(u),h()},l.fitExtent=function(t,e){return A7(l,t,e)},l.fitSize=function(t,e){return C7(l,t,e)},l.fitWidth=function(t,e){return S7(l,t,e)},l.fitHeight=function(t,e){return E7(l,t,e)},l.scale(1070)},azimuthalequalarea:function(){return M7(U7).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return M7(W7).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return R7(H7).scale(109.5).parallels([30,30])},conicequalarea:B7,conicequidistant:function(){return R7(X7).scale(131.154).center([0,13.9389])},equalEarth:function(){return M7(t8).scale(177.158)},equirectangular:function(){return M7(Y7).scale(152.63)},gnomonic:function(){return M7(e8).scale(144.049).clipAngle(60)},identity:function(){var t,e,n,r,i,a,o,s=1,c=0,u=0,l=1,h=1,d=0,f=null,p=1,g=1,m=w7({point:function(t,e){var n=b([t,e]);this.stream.point(n[0],n[1])}}),v=R3;function y(){return p=s*l,g=s*h,a=o=null,b}function b(n){var r=n[0]*p,i=n[1]*g;if(d){var a=i*t-r*e;r=r*t+i*e,i=a}return[r+c,i+u]}return b.invert=function(n){var r=n[0]-c,i=n[1]-u;if(d){var a=i*t+r*e;r=r*t-i*e,i=a}return[r/p,i/g]},b.stream=function(t){return a&&o===t?a:a=m(v(o=t))},b.postclip=function(t){return arguments.length?(v=t,f=n=r=i=null,y()):v},b.clipExtent=function(t){return arguments.length?(v=null==t?(f=n=r=i=null,R3):p7(f=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),y()):null==f?null:[[f,n],[r,i]]},b.scale=function(t){return arguments.length?(s=+t,y()):s},b.translate=function(t){return arguments.length?(c=+t[0],u=+t[1],y()):[c,u]},b.angle=function(n){return arguments.length?(e=UD(d=n%360*DD),t=RD(d),y()):d*FD},b.reflectX=function(t){return arguments.length?(l=t?-1:1,y()):l<0},b.reflectY=function(t){return arguments.length?(h=t?-1:1,y()):h<0},b.fitExtent=function(t,e){return A7(b,t,e)},b.fitSize=function(t,e){return C7(b,t,e)},b.fitWidth=function(t,e){return S7(b,t,e)},b.fitHeight=function(t,e){return E7(b,t,e)},b},mercator:function(){return q7(V7).scale(961/ND)},mollweide:function(){return M7(m8).scale(169.529)},naturalEarth1:function(){return M7(n8).scale(175.295)},orthographic:function(){return M7(r8).scale(249.5).clipAngle(90+AD)},stereographic:function(){return M7(i8).scale(250).clipAngle(142)},transversemercator:function(){var t=q7(a8),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)}};for(const Set in b8)y8(Set,b8[Set]);const x8="Literal",w8="Property",k8="ArrayExpression",_8="BinaryExpression",A8="CallExpression",C8="ConditionalExpression",S8="LogicalExpression",E8="MemberExpression",T8="ObjectExpression",N8="UnaryExpression";function F8(t){this.type=t}var D8,I8,M8,O8,R8;F8.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=function(t){switch(t.type){case k8:return t.elements;case _8:case S8:return[t.left,t.right];case A8:return[t.callee].concat(t.arguments);case C8:return[t.test,t.consequent,t.alternate];case E8:return[t.object,t.property];case T8:return t.properties;case w8:return[t.key,t.value];case N8:return[t.argument];default:return[]}}(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1};var z8=1,B8=2,L8=3,P8=4,j8=5,U8=6,W8=7,V8=8;(D8={})[z8]="Boolean",D8[B8]="<end>",D8[L8]="Identifier",D8[P8]="Keyword",D8[j8]="Null",D8[U8]="Numeric",D8[W8]="Punctuator",D8[V8]="String",D8[9]="RegularExpression";var q8="ArrayExpression",G8="BinaryExpression",H8="CallExpression",Y8="ConditionalExpression",X8="Identifier",K8="Literal",Q8="LogicalExpression",Z8="MemberExpression",$8="ObjectExpression",J8="Property",t5="UnaryExpression",e5="Unexpected token %0",n5="Unexpected number",r5="Unexpected string",i5="Unexpected identifier",a5="Unexpected reserved word",o5="Unexpected end of input",s5="Invalid regular expression",c5="Invalid regular expression: missing /",u5="Octal literals are not allowed in strict mode.",l5="Duplicate data property in object literal not allowed in strict mode",h5="ILLEGAL",d5="Disabled.",f5=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),p5=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function g5(t,e){if(!t)throw new Error("ASSERT: "+e)}function m5(t){return t>=48&&t<=57}function v5(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function y5(t){return"01234567".indexOf(t)>=0}function b5(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function x5(t){return 10===t||13===t||8232===t||8233===t}function w5(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||t>=128&&f5.test(String.fromCharCode(t))}function k5(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||t>=128&&p5.test(String.fromCharCode(t))}const _5={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function A5(){for(;M8<O8;){const t=I8.charCodeAt(M8);if(!b5(t)&&!x5(t))break;++M8}}function C5(t){var e,n,r,i=0;for(n="u"===t?4:2,e=0;e<n;++e)M8<O8&&v5(I8[M8])?(r=I8[M8++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):U5({},e5,h5);return String.fromCharCode(i)}function S5(){var t,e,n,r;for(e=0,"}"===(t=I8[M8])&&U5({},e5,h5);M8<O8&&v5(t=I8[M8++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||"}"!==t)&&U5({},e5,h5),e<=65535?String.fromCharCode(e):(n=55296+(e-65536>>10),r=56320+(e-65536&1023),String.fromCharCode(n,r))}function E5(){var t,e;for(t=I8.charCodeAt(M8++),e=String.fromCharCode(t),92===t&&(117!==I8.charCodeAt(M8)&&U5({},e5,h5),++M8,(t=C5("u"))&&"\\"!==t&&w5(t.charCodeAt(0))||U5({},e5,h5),e=t);M8<O8&&k5(t=I8.charCodeAt(M8));)++M8,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==I8.charCodeAt(M8)&&U5({},e5,h5),++M8,(t=C5("u"))&&"\\"!==t&&k5(t.charCodeAt(0))||U5({},e5,h5),e+=t);return e}function T5(){var t,e;return t=M8,e=92===I8.charCodeAt(M8)?E5():function(){var t,e;for(t=M8++;M8<O8;){if(92===(e=I8.charCodeAt(M8)))return M8=t,E5();if(!k5(e))break;++M8}return I8.slice(t,M8)}(),{type:1===e.length?L8:_5.hasOwnProperty(e)?P8:"null"===e?j8:"true"===e||"false"===e?z8:L8,value:e,start:t,end:M8}}function N5(){var t,e,n,r,i=M8,a=I8.charCodeAt(M8),o=I8[M8];switch(a){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++M8,{type:W8,value:String.fromCharCode(a),start:i,end:M8};default:if(61===(t=I8.charCodeAt(M8+1)))switch(a){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return M8+=2,{type:W8,value:String.fromCharCode(a)+String.fromCharCode(t),start:i,end:M8};case 33:case 61:return M8+=2,61===I8.charCodeAt(M8)&&++M8,{type:W8,value:I8.slice(i,M8),start:i,end:M8}}}return">>>="===(r=I8.substr(M8,4))?{type:W8,value:r,start:i,end:M8+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:W8,value:n,start:i,end:M8+=3}:o===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(o)>=0||"=>"===e?{type:W8,value:e,start:i,end:M8+=2}:("//"===e&&U5({},e5,h5),"<>=!+-*%&|^/".indexOf(o)>=0?(++M8,{type:W8,value:o,start:i,end:M8}):void U5({},e5,h5))}function F5(){var t,e,n;if(g5(m5((n=I8[M8]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),e=M8,t="","."!==n){if(t=I8[M8++],n=I8[M8],"0"===t){if("x"===n||"X"===n)return++M8,function(t){let e="";for(;M8<O8&&v5(I8[M8]);)e+=I8[M8++];return 0===e.length&&U5({},e5,h5),w5(I8.charCodeAt(M8))&&U5({},e5,h5),{type:U8,value:parseInt("0x"+e,16),start:t,end:M8}}(e);if(y5(n))return function(t){let e="0"+I8[M8++];for(;M8<O8&&y5(I8[M8]);)e+=I8[M8++];return(w5(I8.charCodeAt(M8))||m5(I8.charCodeAt(M8)))&&U5({},e5,h5),{type:U8,value:parseInt(e,8),octal:!0,start:t,end:M8}}(e);n&&m5(n.charCodeAt(0))&&U5({},e5,h5)}for(;m5(I8.charCodeAt(M8));)t+=I8[M8++];n=I8[M8]}if("."===n){for(t+=I8[M8++];m5(I8.charCodeAt(M8));)t+=I8[M8++];n=I8[M8]}if("e"===n||"E"===n)if(t+=I8[M8++],"+"!==(n=I8[M8])&&"-"!==n||(t+=I8[M8++]),m5(I8.charCodeAt(M8)))for(;m5(I8.charCodeAt(M8));)t+=I8[M8++];else U5({},e5,h5);return w5(I8.charCodeAt(M8))&&U5({},e5,h5),{type:U8,value:parseFloat(t),start:e,end:M8}}function D5(){var t,e,n,r;return R8=null,A5(),t=M8,e=function(){var t,e,n,r;for(g5("/"===(t=I8[M8]),"Regular expression literal must start with a slash"),e=I8[M8++],n=!1,r=!1;M8<O8;)if(e+=t=I8[M8++],"\\"===t)x5((t=I8[M8++]).charCodeAt(0))&&U5({},c5),e+=t;else if(x5(t.charCodeAt(0)))U5({},c5);else if(n)"]"===t&&(n=!1);else{if("/"===t){r=!0;break}"["===t&&(n=!0)}return r||U5({},c5),{value:e.substr(1,e.length-2),literal:e}}(),n=function(){var t,e,n;for(e="",n="";M8<O8&&k5((t=I8[M8]).charCodeAt(0));)++M8,"\\"===t&&M8<O8?U5({},e5,h5):(n+=t,e+=t);return n.search(/[^gimuy]/g)>=0&&U5({},s5,n),{value:n,literal:e}}(),r=function(t,e){let n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,((t,e)=>{if(parseInt(e,16)<=1114111)return"x";U5({},s5)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){U5({},s5)}try{return new RegExp(t,e)}catch(i){return null}}(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:M8}}function I5(){if(A5(),M8>=O8)return{type:B8,start:M8,end:M8};const t=I8.charCodeAt(M8);return w5(t)?T5():40===t||41===t||59===t?N5():39===t||34===t?function(){var t,e,n,r,i="",a=!1;for(g5("'"===(t=I8[M8])||'"'===t,"String literal must starts with a quote"),e=M8,++M8;M8<O8;){if((n=I8[M8++])===t){t="";break}if("\\"===n)if((n=I8[M8++])&&x5(n.charCodeAt(0)))"\r"===n&&"\n"===I8[M8]&&++M8;else switch(n){case"u":case"x":"{"===I8[M8]?(++M8,i+=S5()):i+=C5(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:y5(n)?(0!==(r="01234567".indexOf(n))&&(a=!0),M8<O8&&y5(I8[M8])&&(a=!0,r=8*r+"01234567".indexOf(I8[M8++]),"0123".indexOf(n)>=0&&M8<O8&&y5(I8[M8])&&(r=8*r+"01234567".indexOf(I8[M8++]))),i+=String.fromCharCode(r)):i+=n}else{if(x5(n.charCodeAt(0)))break;i+=n}}return""!==t&&U5({},e5,h5),{type:V8,value:i,octal:a,start:e,end:M8}}():46===t?m5(I8.charCodeAt(M8+1))?F5():N5():m5(t)?F5():N5()}function M5(){const t=R8;return M8=t.end,R8=I5(),M8=t.end,t}function O5(){const t=M8;R8=I5(),M8=t}function R5(t,e,n){const r=new F8("||"===t||"&&"===t?Q8:G8);return r.operator=t,r.left=e,r.right=n,r}function z5(t,e){const n=new F8(H8);return n.callee=t,n.arguments=e,n}function B5(t){const e=new F8(X8);return e.name=t,e}function L5(t){const e=new F8(K8);return e.value=t.value,e.raw=I8.slice(t.start,t.end),t.regex&&("//"===e.raw&&(e.raw="/(?:)/"),e.regex=t.regex),e}function P5(t,e,n){const r=new F8(Z8);return r.computed="["===t,r.object=e,r.property=n,r.computed||(n.member=!0),r}function j5(t,e,n){const r=new F8(J8);return r.key=e,r.value=n,r.kind=t,r}function U5(t,e){var n,r=Array.prototype.slice.call(arguments,2),i=e.replace(/%(\d)/g,((t,e)=>(g5(e<r.length,"Message reference must be in range"),r[e])));throw(n=new Error(i)).index=M8,n.description=i,n}function W5(t){t.type===B8&&U5(t,o5),t.type===U8&&U5(t,n5),t.type===V8&&U5(t,r5),t.type===L8&&U5(t,i5),t.type===P8&&U5(t,a5),U5(t,e5,t.value)}function V5(t){const e=M5();e.type===W8&&e.value===t||W5(e)}function q5(t){return R8.type===W8&&R8.value===t}function G5(t){return R8.type===P8&&R8.value===t}function H5(){const t=[];for(M8=R8.start,V5("[");!q5("]");)q5(",")?(M5(),t.push(null)):(t.push(i6()),q5("]")||V5(","));return M5(),function(t){const e=new F8(q8);return e.elements=t,e}(t)}function Y5(){M8=R8.start;const t=M5();return t.type===V8||t.type===U8?(t.octal&&U5(t,u5),L5(t)):B5(t.value)}function X5(){var t,e,n;return M8=R8.start,(t=R8).type===L8?(n=Y5(),V5(":"),j5("init",n,i6())):t.type!==B8&&t.type!==W8?(e=Y5(),V5(":"),j5("init",e,i6())):void W5(t)}function K5(){var t,e,n=[],r={},i=String;for(M8=R8.start,V5("{");!q5("}");)e="$"+((t=X5()).key.type===X8?t.key.name:i(t.key.value)),Object.prototype.hasOwnProperty.call(r,e)?U5({},l5):r[e]=!0,n.push(t),q5("}")||V5(",");return V5("}"),function(t){const e=new F8($8);return e.properties=t,e}(n)}const Q5={if:1};function Z5(){var t,e,n;if(q5("("))return function(){V5("(");const t=a6();return V5(")"),t}();if(q5("["))return H5();if(q5("{"))return K5();if(t=R8.type,M8=R8.start,t===L8||Q5[R8.value])n=B5(M5().value);else if(t===V8||t===U8)R8.octal&&U5(R8,u5),n=L5(M5());else{if(t===P8)throw new Error(d5);t===z8?((e=M5()).value="true"===e.value,n=L5(e)):t===j8?((e=M5()).value=null,n=L5(e)):q5("/")||q5("/=")?(n=L5(D5()),O5()):W5(M5())}return n}function $5(){const t=[];if(V5("("),!q5(")"))for(;M8<O8&&(t.push(i6()),!q5(")"));)V5(",");return V5(")"),t}function J5(){M8=R8.start;const t=M5();return function(t){return t.type===L8||t.type===P8||t.type===z8||t.type===j8}(t)||W5(t),B5(t.value)}function t6(){V5("[");const t=a6();return V5("]"),t}function e6(){const t=function(){var t;for(t=Z5();;)if(q5("."))V5("."),t=P5(".",t,J5());else if(q5("("))t=z5(t,$5());else{if(!q5("["))break;t=P5("[",t,t6())}return t}();if(R8.type===W8&&(q5("++")||q5("--")))throw new Error(d5);return t}function n6(){var t,e;if(R8.type!==W8&&R8.type!==P8)e=e6();else{if(q5("++")||q5("--"))throw new Error(d5);if(q5("+")||q5("-")||q5("~")||q5("!"))t=M5(),e=n6(),e=function(t,e){const n=new F8(t5);return n.operator=t,n.argument=e,n.prefix=!0,n}(t.value,e);else{if(G5("delete")||G5("void")||G5("typeof"))throw new Error(d5);e=e6()}}return e}function r6(t){let e=0;if(t.type!==W8&&t.type!==P8)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function i6(){var t,e;return t=function(){var t,e,n,r,i,a,o,s,c,u;if(t=R8,c=n6(),0===(i=r6(r=R8)))return c;for(r.prec=i,M5(),e=[t,R8],a=[c,r,o=n6()];(i=r6(R8))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)o=a.pop(),s=a.pop().value,c=a.pop(),e.pop(),n=R5(s,c,o),a.push(n);(r=M5()).prec=i,a.push(r),e.push(R8),n=n6(),a.push(n)}for(n=a[u=a.length-1],e.pop();u>1;)e.pop(),n=R5(a[u-1].value,a[u-2],n),u-=2;return n}(),q5("?")&&(M5(),e=i6(),V5(":"),t=function(t,e,n){const r=new F8(Y8);return r.test=t,r.consequent=e,r.alternate=n,r}(t,e,i6())),t}function a6(){const t=i6();if(q5(","))throw new Error(d5);return t}var o6={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function s6(t){function e(e,n,r){return i=>function(e,n,r,i){let a=t(n[0]);return r&&(a=r+"("+a+")",0===r.lastIndexOf("new ",0)&&(a="("+a+")")),a+"."+e+(i<0?"":0===i?"()":"("+n.slice(1).map(t).join(",")+")")}(e,i,n,r)}const n="new Date",r="String",i="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(e){e.length<3&&qe("Missing arguments to clamp function."),e.length>3&&qe("Too many arguments to clamp function.");const n=e.map(t);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:e("getDate",n,0),day:e("getDay",n,0),year:e("getFullYear",n,0),month:e("getMonth",n,0),hours:e("getHours",n,0),minutes:e("getMinutes",n,0),seconds:e("getSeconds",n,0),milliseconds:e("getMilliseconds",n,0),time:e("getTime",n,0),timezoneoffset:e("getTimezoneOffset",n,0),utcdate:e("getUTCDate",n,0),utcday:e("getUTCDay",n,0),utcyear:e("getUTCFullYear",n,0),utcmonth:e("getUTCMonth",n,0),utchours:e("getUTCHours",n,0),utcminutes:e("getUTCMinutes",n,0),utcseconds:e("getUTCSeconds",n,0),utcmilliseconds:e("getUTCMilliseconds",n,0),length:e("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:e("toUpperCase",r,0),lower:e("toLowerCase",r,0),substring:e("substring",r),split:e("split",r),trim:e("trim",r,0),regexp:i,test:e("test",i),if:function(e){e.length<3&&qe("Missing arguments to if function."),e.length>3&&qe("Too many arguments to if function.");const n=e.map(t);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}class c6{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=e[r],a=t+i,o=Math.abs(t)<Math.abs(i)?t-(a-i):i-(a-t);o&&(e[n++]=o),t=a}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,r,i=this._n,a=0;if(i>0){for(a=t[--i];i>0&&(e=a,n=t[--i],a=e+n,r=n-(a-e),!r););i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(n=2*r,e=a+n,n==e-a&&(a=e))}return a}}var u6=1e-6,l6=Math.PI,h6=l6/2,d6=l6/4,f6=2*l6,p6=180/l6,g6=l6/180,m6=Math.abs,v6=(Math.atan,Math.atan2),y6=Math.cos,b6=(Math.ceil,Math.exp,Math.floor,Math.hypot),x6=(Math.log,Math.pow,Math.sin),w6=(Math.sign,Math.sqrt);Math.tan;function k6(t){return t>1?h6:t<-1?-h6:Math.asin(t)}function _6(){}function A6(t,e){t&&S6.hasOwnProperty(t.type)&&S6[t.type](t,e)}var C6={Feature:function(t,e){A6(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)A6(n[r].geometry,e)}},S6={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){E6(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)E6(n[r],e,0)},Polygon:function(t,e){T6(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)T6(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)A6(n[r],e)}};function E6(t,e,n){var r,i=-1,a=t.length-n;for(e.lineStart();++i<a;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function T6(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)E6(t[n],e,1);e.polygonEnd()}function N6(t,e){t&&C6.hasOwnProperty(t.type)?C6[t.type](t,e):A6(t,e)}var F6,D6,I6,M6,O6,R6,z6,B6,L6,P6,j6,U6,W6,V6,q6,G6,H6=new c6,Y6=new c6,X6={point:_6,lineStart:_6,lineEnd:_6,polygonStart:function(){H6=new c6,X6.lineStart=K6,X6.lineEnd=Q6},polygonEnd:function(){var t=+H6;Y6.add(t<0?f6+t:t),this.lineStart=this.lineEnd=this.point=_6},sphere:function(){Y6.add(f6)}};function K6(){X6.point=Z6}function Q6(){$6(F6,D6)}function Z6(t,e){X6.point=$6,F6=t,D6=e,I6=t*=g6,M6=y6(e=(e*=g6)/2+d6),O6=x6(e)}function $6(t,e){var n=(t*=g6)-I6,r=n>=0?1:-1,i=r*n,a=y6(e=(e*=g6)/2+d6),o=x6(e),s=O6*o,c=M6*a+s*y6(i),u=s*r*x6(i);H6.add(v6(u,c)),I6=t,M6=a,O6=o}function J6(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}var t9,e9,n9,r9,i9,a9,o9,s9,c9,u9,l9,h9,d9,f9,p9,g9,m9={point:v9,lineStart:b9,lineEnd:x9,polygonStart:function(){m9.point=w9,m9.lineStart=k9,m9.lineEnd=_9,V6=new c6,X6.polygonStart()},polygonEnd:function(){X6.polygonEnd(),m9.point=v9,m9.lineStart=b9,m9.lineEnd=x9,H6<0?(R6=-(B6=180),z6=-(L6=90)):V6>u6?L6=90:V6<-1e-6&&(z6=-90),G6[0]=R6,G6[1]=B6},sphere:function(){R6=-(B6=180),z6=-(L6=90)}};function v9(t,e){q6.push(G6=[R6=t,B6=t]),e<z6&&(z6=e),e>L6&&(L6=e)}function y9(t,e){var n=function(t){var e=t[0],n=t[1],r=y6(n);return[r*y6(e),r*x6(e),x6(n)]}([t*g6,e*g6]);if(W6){var r=J6(W6,n),i=J6([r[1],-r[0],0],r);!function(t){var e=w6(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}(i),i=function(t){return[v6(t[1],t[0]),k6(t[2])]}(i);var a,o=t-P6,s=o>0?1:-1,c=i[0]*p6*s,u=m6(o)>180;u^(s*P6<c&&c<s*t)?(a=i[1]*p6)>L6&&(L6=a):u^(s*P6<(c=(c+360)%360-180)&&c<s*t)?(a=-i[1]*p6)<z6&&(z6=a):(e<z6&&(z6=e),e>L6&&(L6=e)),u?t<P6?A9(R6,t)>A9(R6,B6)&&(B6=t):A9(t,B6)>A9(R6,B6)&&(R6=t):B6>=R6?(t<R6&&(R6=t),t>B6&&(B6=t)):t>P6?A9(R6,t)>A9(R6,B6)&&(B6=t):A9(t,B6)>A9(R6,B6)&&(R6=t)}else q6.push(G6=[R6=t,B6=t]);e<z6&&(z6=e),e>L6&&(L6=e),W6=n,P6=t}function b9(){m9.point=y9}function x9(){G6[0]=R6,G6[1]=B6,m9.point=v9,W6=null}function w9(t,e){if(W6){var n=t-P6;V6.add(m6(n)>180?n+(n>0?360:-360):n)}else j6=t,U6=e;X6.point(t,e),y9(t,e)}function k9(){X6.lineStart()}function _9(){w9(j6,U6),X6.lineEnd(),m6(V6)>u6&&(R6=-(B6=180)),G6[0]=R6,G6[1]=B6,W6=null}function A9(t,e){return(e-=t)<0?e+360:e}function C9(t,e){return t[0]-e[0]}function S9(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var E9={sphere:_6,point:T9,lineStart:F9,lineEnd:M9,polygonStart:function(){E9.lineStart=O9,E9.lineEnd=R9},polygonEnd:function(){E9.lineStart=F9,E9.lineEnd=M9}};function T9(t,e){t*=g6;var n=y6(e*=g6);N9(n*y6(t),n*x6(t),x6(e))}function N9(t,e,n){++t9,n9+=(t-n9)/t9,r9+=(e-r9)/t9,i9+=(n-i9)/t9}function F9(){E9.point=D9}function D9(t,e){t*=g6;var n=y6(e*=g6);f9=n*y6(t),p9=n*x6(t),g9=x6(e),E9.point=I9,N9(f9,p9,g9)}function I9(t,e){t*=g6;var n=y6(e*=g6),r=n*y6(t),i=n*x6(t),a=x6(e),o=v6(w6((o=p9*a-g9*i)*o+(o=g9*r-f9*a)*o+(o=f9*i-p9*r)*o),f9*r+p9*i+g9*a);e9+=o,a9+=o*(f9+(f9=r)),o9+=o*(p9+(p9=i)),s9+=o*(g9+(g9=a)),N9(f9,p9,g9)}function M9(){E9.point=T9}function O9(){E9.point=z9}function R9(){B9(h9,d9),E9.point=T9}function z9(t,e){h9=t,d9=e,t*=g6,e*=g6,E9.point=B9;var n=y6(e);f9=n*y6(t),p9=n*x6(t),g9=x6(e),N9(f9,p9,g9)}function B9(t,e){t*=g6;var n=y6(e*=g6),r=n*y6(t),i=n*x6(t),a=x6(e),o=p9*a-g9*i,s=g9*r-f9*a,c=f9*i-p9*r,u=b6(o,s,c),l=k6(u),h=u&&-l/u;c9.add(h*o),u9.add(h*s),l9.add(h*c),e9+=l,a9+=l*(f9+(f9=r)),o9+=l*(p9+(p9=i)),s9+=l*(g9+(g9=a)),N9(f9,p9,g9)}function L9(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function P9(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function j9(){}var U9=.7,W9=1.4285714285714286,V9="\\s*([+-]?\\d+)\\s*",q9="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",G9="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",H9=/^#([0-9a-f]{3,8})$/,Y9=new RegExp("^rgb\\(".concat(V9,",").concat(V9,",").concat(V9,"\\)$")),X9=new RegExp("^rgb\\(".concat(G9,",").concat(G9,",").concat(G9,"\\)$")),K9=new RegExp("^rgba\\(".concat(V9,",").concat(V9,",").concat(V9,",").concat(q9,"\\)$")),Q9=new RegExp("^rgba\\(".concat(G9,",").concat(G9,",").concat(G9,",").concat(q9,"\\)$")),Z9=new RegExp("^hsl\\(".concat(q9,",").concat(G9,",").concat(G9,"\\)$")),$9=new RegExp("^hsla\\(".concat(q9,",").concat(G9,",").concat(G9,",").concat(q9,"\\)$")),J9={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ttt(){return this.rgb().formatHex()}function ett(){return this.rgb().formatRgb()}function ntt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=H9.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?rtt(e):3===n?new stt(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?itt(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?itt(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Y9.exec(t))?new stt(e[1],e[2],e[3],1):(e=X9.exec(t))?new stt(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=K9.exec(t))?itt(e[1],e[2],e[3],e[4]):(e=Q9.exec(t))?itt(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Z9.exec(t))?ftt(e[1],e[2]/100,e[3]/100,1):(e=$9.exec(t))?ftt(e[1],e[2]/100,e[3]/100,e[4]):J9.hasOwnProperty(t)?rtt(J9[t]):"transparent"===t?new stt(NaN,NaN,NaN,0):null}function rtt(t){return new stt(t>>16&255,t>>8&255,255&t,1)}function itt(t,e,n,r){return r<=0&&(t=e=n=NaN),new stt(t,e,n,r)}function att(t){return t instanceof j9||(t=ntt(t)),t?new stt((t=t.rgb()).r,t.g,t.b,t.opacity):new stt}function ott(t,e,n,r){return 1===arguments.length?att(t):new stt(t,e,n,null==r?1:r)}function stt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function ctt(){return"#".concat(dtt(this.r)).concat(dtt(this.g)).concat(dtt(this.b))}function utt(){const t=ltt(this.opacity);return"".concat(1===t?"rgb(":"rgba(").concat(htt(this.r),", ").concat(htt(this.g),", ").concat(htt(this.b)).concat(1===t?")":", ".concat(t,")"))}function ltt(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function htt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function dtt(t){return((t=htt(t))<16?"0":"")+t.toString(16)}function ftt(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new mtt(t,e,n,r)}function ptt(t){if(t instanceof mtt)return new mtt(t.h,t.s,t.l,t.opacity);if(t instanceof j9||(t=ntt(t)),!t)return new mtt;if(t instanceof mtt)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new mtt(o,s,c,t.opacity)}function gtt(t,e,n,r){return 1===arguments.length?ptt(t):new mtt(t,e,n,null==r?1:r)}function mtt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function vtt(t){return(t=(t||0)%360)<0?t+360:t}function ytt(t){return Math.max(0,Math.min(1,t||0))}function btt(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}L9(j9,ntt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:ttt,formatHex:ttt,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return ptt(this).formatHsl()},formatRgb:ett,toString:ett}),L9(stt,ott,P9(j9,{brighter(t){return t=null==t?W9:Math.pow(W9,t),new stt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?U9:Math.pow(U9,t),new stt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new stt(htt(this.r),htt(this.g),htt(this.b),ltt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ctt,formatHex:ctt,formatHex8:function(){return"#".concat(dtt(this.r)).concat(dtt(this.g)).concat(dtt(this.b)).concat(dtt(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:utt,toString:utt})),L9(mtt,gtt,P9(j9,{brighter(t){return t=null==t?W9:Math.pow(W9,t),new mtt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?U9:Math.pow(U9,t),new mtt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new stt(btt(t>=240?t-240:t+120,i,r),btt(t,i,r),btt(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new mtt(vtt(this.h),ytt(this.s),ytt(this.l),ltt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=ltt(this.opacity);return"".concat(1===t?"hsl(":"hsla(").concat(vtt(this.h),", ").concat(100*ytt(this.s),"%, ").concat(100*ytt(this.l),"%").concat(1===t?")":", ".concat(t,")"))}}));const xtt=Math.PI/180,wtt=180/Math.PI,ktt=.96422,_tt=1,Att=.82521,Ctt=4/29,Stt=6/29,Ett=.12841854934601665,Ttt=.008856451679035631;function Ntt(t){if(t instanceof Dtt)return new Dtt(t.l,t.a,t.b,t.opacity);if(t instanceof Ltt)return Ptt(t);t instanceof stt||(t=att(t));var e,n,r=Rtt(t.r),i=Rtt(t.g),a=Rtt(t.b),o=Itt((.2225045*r+.7168786*i+.0606169*a)/_tt);return r===i&&i===a?e=n=o:(e=Itt((.4360747*r+.3850649*i+.1430804*a)/ktt),n=Itt((.0139322*r+.0971045*i+.7141733*a)/Att)),new Dtt(116*o-16,500*(e-o),200*(o-n),t.opacity)}function Ftt(t,e,n,r){return 1===arguments.length?Ntt(t):new Dtt(t,e,n,null==r?1:r)}function Dtt(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function Itt(t){return t>Ttt?Math.pow(t,1/3):t/Ett+Ctt}function Mtt(t){return t>Stt?t*t*t:Ett*(t-Ctt)}function Ott(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Rtt(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function ztt(t){if(t instanceof Ltt)return new Ltt(t.h,t.c,t.l,t.opacity);if(t instanceof Dtt||(t=Ntt(t)),0===t.a&&0===t.b)return new Ltt(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*wtt;return new Ltt(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Btt(t,e,n,r){return 1===arguments.length?ztt(t):new Ltt(t,e,n,null==r?1:r)}function Ltt(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function Ptt(t){if(isNaN(t.h))return new Dtt(t.l,0,0,t.opacity);var e=t.h*xtt;return new Dtt(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function jtt(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Utt(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Wtt(){return 0}L9(Dtt,Ftt,P9(j9,{brighter(t){return new Dtt(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker(t){return new Dtt(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new stt(Ott(3.1338561*(e=ktt*Mtt(e))-1.6168667*(t=_tt*Mtt(t))-.4906146*(n=Att*Mtt(n))),Ott(-.9787684*e+1.9161415*t+.033454*n),Ott(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),L9(Ltt,Btt,P9(j9,{brighter(t){return new Ltt(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker(t){return new Ltt(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb(){return Ptt(this).rgb()}}));Map;class Vtt extends Set{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ytt;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const n of t)this.add(n)}has(t){return super.has(qtt(this,t))}add(t){return super.add(Gtt(this,t))}delete(t){return super.delete(Htt(this,t))}}function qtt(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)?n.get(i):e}function Gtt(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)?n.get(i):(n.set(i,e),e)}function Htt(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)&&(e=n.get(i),n.delete(i)),e}function Ytt(t){return null!==t&&"object"===typeof t?t.valueOf():t}function Xtt(t){return t instanceof Vtt?t:new Vtt(t)}const Ktt=Symbol("vega_selection_getter");function Qtt(t){return t.getter&&t.getter[Ktt]||(t.getter=He(t.field),t.getter[Ktt]=!0),t.getter}const Ztt="intersect",$tt="union",Jtt="_vgsid_",tet=He(Jtt),eet="E",net="R",ret="R-E",iet="R-LE",aet="R-RE",oet="index:unit";function set(t,e){for(var n,r,i=e.fields,a=e.values,o=i.length,s=0;s<o;++s)if(Wn(n=Qtt(r=i[s])(t))&&(n=dn(n)),Wn(a[s])&&(a[s]=dn(a[s])),on(a[s])&&Wn(a[s][0])&&(a[s]=a[s].map(dn)),r.type===eet){if(on(a[s])?a[s].indexOf(n)<0:n!==a[s])return!1}else if(r.type===net){if(!Un(n,a[s]))return!1}else if(r.type===aet){if(!Un(n,a[s],!0,!1))return!1}else if(r.type===ret){if(!Un(n,a[s],!1,!1))return!1}else if(r.type===iet&&!Un(n,a[s],!1,!0))return!1;return!0}function cet(t,e,n){for(var r,i,a,o,s,c=this.context.data[t],u=c?c.values.value:[],l=c?c[oet]&&c[oet].value:void 0,h=n===Ztt,d=u.length,f=0;f<d;++f)if(r=u[f],l&&h){if(-1===(a=(i=i||{})[o=r.unit]||0))continue;if(s=set(e,r),i[o]=s?-1:++a,s&&1===l.size)return!0;if(!s&&a===l.get(o).count)return!1}else if(h^(s=set(e,r)))return s;return d&&h}const uet=function(t){let e,n,r;function i(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<0?i=e+1:a=e}while(i<a)}return i}return 2!==t.length?(e=jtt,n=(e,n)=>jtt(t(e),n),r=(e,n)=>t(e)-n):(e=t===jtt||t===Utt?t:Wtt,n=t,r=t),{left:i,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=i(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return a>n&&r(t[a-1],e)>-r(t[a],e)?a-1:a},right:function(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<=0?i=e+1:a=e}while(i<a)}return i}}}(tet),het=uet.left,det=uet.right;function fet(t,e,n){const r=this.context.data[t],i=r?r.values.value:[],a=r?r[oet]&&r[oet].value:void 0,o=n===Ztt,s=tet(e),c=het(i,s);if(c===i.length)return!1;if(tet(i[c])!==s)return!1;if(a&&o){if(1===a.size)return!0;if(det(i,s)-c<a.size)return!1}return!0}function pet(t,e){return t.map((t=>On(e.fields?{values:e.fields.map((e=>Qtt(e)(t.datum)))}:{[Jtt]:tet(t.datum)},e)))}function get(t,e,n,r){for(var i,a,o,s,c,u,l,h,d,f,p,g,m=this.context.data[t],v=m?m.values.value:[],y={},b={},x={},w=v.length,k=0;k<w;++k)if(s=(i=v[k]).unit,a=i.fields,o=i.values,a&&o){for(p=0,g=a.length;p<g;++p)c=a[p],h=(l=y[c.field]||(y[c.field]={}))[s]||(l[s]=[]),x[c.field]=d=c.type.charAt(0),f=met["".concat(d,"_union")],l[s]=f(h,An(o[p]));n&&(h=b[s]||(b[s]=[])).push(An(o).reduce(((t,e,n)=>(t[a[n].field]=e,t)),{}))}else c=Jtt,u=tet(i),(h=(l=y[c]||(y[c]={}))[s]||(l[s]=[])).push(u),n&&(h=b[s]||(b[s]=[])).push({[Jtt]:u});if(e=e||$tt,y[Jtt]?y[Jtt]=met["".concat(Jtt,"_").concat(e)](...Object.values(y[Jtt])):Object.keys(y).forEach((t=>{y[t]=Object.keys(y[t]).map((e=>y[t][e])).reduce(((n,r)=>void 0===n?r:met["".concat(x[t],"_").concat(e)](n,r)))})),v=Object.keys(b),n&&v.length){y[r?"vlPoint":"vlMulti"]=e===$tt?{or:v.reduce(((t,e)=>(t.push(...b[e]),t)),[])}:{and:v.map((t=>({or:b[t]})))}}return y}var met={["".concat(Jtt,"_union")]:function(){const t=new Vtt;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(const i of n)for(const e of i)t.add(e);return t},["".concat(Jtt,"_intersect")]:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];t=new Vtt(t),n=n.map(Xtt);t:for(const i of t)for(const e of n)if(!e.has(i)){t.delete(i);continue t}return t},E_union:function(t,e){if(!t.length)return e;for(var n=0,r=e.length;n<r;++n)t.indexOf(e[n])<0&&t.push(e[n]);return t},E_intersect:function(t,e){return t.length?t.filter((t=>e.indexOf(t)>=0)):e},R_union:function(t,e){var n=dn(e[0]),r=dn(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?(t[0]>n&&(t[0]=n),t[1]<r&&(t[1]=r),t):[n,r]},R_intersect:function(t,e){var n=dn(e[0]),r=dn(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?r<t[0]||t[1]<n?[]:(t[0]<n&&(t[0]=n),t[1]>r&&(t[1]=r),t):[n,r]}};function vet(t,e,n,r){e[0].type!==x8&&qe("First argument to selection functions must be a string literal.");const i=e[0].value,a="unit",o="@"+a,s=":"+i;(e.length>=2&&hn(e).value)!==Ztt||Bn(r,o)||(r[o]=n.getData(i).indataRef(n,a)),Bn(r,s)||(r[s]=n.getData(i).tuplesRef())}function yet(t){const e=this.context.data[t];return e?e.values.value:[]}const bet=t=>function(e,n){return this.context.dataflow.locale()[t](n)(e)},xet=bet("format"),wet=bet("timeFormat"),ket=bet("utcFormat"),_et=bet("timeParse"),Aet=bet("utcParse"),Cet=new Date(2e3,0,1);function Eet(t,e,n){return Number.isInteger(t)&&Number.isInteger(e)?(Cet.setYear(2e3),Cet.setMonth(t),Cet.setDate(e),wet.call(this,Cet,n)):""}const Tet="%",Net="$";function Fet(t,e,n,r){e[0].type!==x8&&qe("First argument to data functions must be a string literal.");const i=e[0].value,a=":"+i;if(!Bn(a,r))try{r[a]=n.getData(i).tuplesRef()}catch(o){}}function Det(t,e,n,r){if(e[0].type===x8)Iet(n,r,e[0].value);else for(t in n.scales)Iet(n,r,t)}function Iet(t,e,n){const r=Tet+n;if(!Bn(e,r))try{e[r]=t.scaleRef(n)}catch(i){}}function Met(t,e){if(Cn(t))return t;if(qn(t)){const n=e.scales[t];return n&&function(t){return t&&!0===t[by]}(n.value)?n.value:void 0}}function Oet(t,e,n){e.__bandwidth=t=>t&&t.bandwidth?t.bandwidth():0,n._bandwidth=Det,n._range=Det,n._scale=Det;const r=e=>"_["+(e.type===x8?Xn(Tet+e.value):Xn(Tet)+"+"+t(e))+"]";return{_bandwidth:t=>"this.__bandwidth(".concat(r(t[0]),")"),_range:t=>"".concat(r(t[0]),".range()"),_scale:e=>"".concat(r(e[0]),"(").concat(t(e[1]),")")}}function Ret(t,e){return function(n,r,i){if(n){const e=Met(n,(i||this).context);return e&&e.path[t](r)}return e(r)}}const zet=Ret("area",(function(t){return Y6=new c6,N6(t,X6),2*Y6})),Bet=Ret("bounds",(function(t){var e,n,r,i,a,o,s;if(L6=B6=-(R6=z6=1/0),q6=[],N6(t,m9),n=q6.length){for(q6.sort(C9),e=1,a=[r=q6[0]];e<n;++e)S9(r,(i=q6[e])[0])||S9(r,i[1])?(A9(r[0],i[1])>A9(r[0],r[1])&&(r[1]=i[1]),A9(i[0],r[1])>A9(r[0],r[1])&&(r[0]=i[0])):a.push(r=i);for(o=-1/0,e=0,r=a[n=a.length-1];e<=n;r=i,++e)i=a[e],(s=A9(r[1],i[0]))>o&&(o=s,R6=i[0],B6=r[1])}return q6=G6=null,R6===1/0||z6===1/0?[[NaN,NaN],[NaN,NaN]]:[[R6,z6],[B6,L6]]})),Let=Ret("centroid",(function(t){t9=e9=n9=r9=i9=a9=o9=s9=0,c9=new c6,u9=new c6,l9=new c6,N6(t,E9);var e=+c9,n=+u9,r=+l9,i=b6(e,n,r);return i<1e-12&&(e=a9,n=o9,r=s9,e9<u6&&(e=n9,n=r9,r=i9),(i=b6(e,n,r))<1e-12)?[NaN,NaN]:[v6(n,e)*p6,k6(r/i)*p6]}));function Pet(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(r){t.warn(r)}return n[n.length-1]}function jet(t){const e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Uet(t){const e=ott(t);return.2126*jet(e.r)+.7152*jet(e.g)+.0722*jet(e.b)}function Wet(t,e){return t===e||t!==t&&e!==e||(on(t)?!(!on(e)||t.length!==e.length)&&function(t,e){for(let n=0,r=t.length;n<r;++n)if(!Wet(t[n],e[n]))return!1;return!0}(t,e):!(!sn(t)||!sn(e))&&Vet(t,e))}function Vet(t,e){for(const n in t)if(!Wet(t[n],e[n]))return!1;return!0}function qet(t){return e=>Vet(t,e)}const Get={};function Het(t){return on(t)||ArrayBuffer.isView(t)?t:null}function Yet(t){return Het(t)||(qn(t)?t:null)}const Xet=t=>t.data;function Ket(t,e){const n=yet.call(e,t);return n.root&&n.root.lookup||{}}const Qet=()=>"undefined"!==typeof window&&window||null;function Zet(t,e,n){if(!t)return[];const[r,i]=t,a=(new rx).set(r[0],r[1],i[0],i[1]);return function(t,e,n){const r=[],i=(new rx).union(e),a=t.marktype;return a?P_(t,i,n,r):"group"===a?j_(t,i,n,r):qe("Intersect scene must be mark node or group item.")}(n||this.context.dataflow.scenegraph().root,a,function(t){let e=null;if(t){const n=An(t.marktype),r=An(t.markname);e=t=>(!n.length||n.some((e=>t.marktype===e)))&&(!r.length||r.some((e=>t.name===e)))}return e}(e))}const $et={random:()=>Qc(),cumulativeNormal:ru,cumulativeLogNormal:uu,cumulativeUniform:fu,densityNormal:nu,densityLogNormal:cu,densityUniform:du,quantileNormal:iu,quantileLogNormal:lu,quantileUniform:pu,sampleNormal:eu,sampleLogNormal:su,sampleUniform:hu,isArray:on,isBoolean:function(t){return"boolean"===typeof t},isDate:Wn,isDefined:t=>void 0!==t,isNumber:Vn,isObject:sn,isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},isString:qn,isTuple:$s,isValid:t=>null!=t&&t===t,toBoolean:Kn,toDate:t=>Zn(t),toNumber:dn,toString:$n,indexof:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Yet(t).indexOf(...n)},join:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Het(t).join(...n)},lastindexof:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Yet(t).lastIndexOf(...n)},replace:function(t,e,n){return Cn(n)&&qe("Function argument passed to replace."),String(t).replace(e,n)},reverse:function(t){return Het(t).slice().reverse()},slice:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Yet(t).slice(...n)},flush:function(t,e,n,r,i,a){if(!n&&0!==n)return a;const o=+n;let s,c=t[0],u=hn(t);u<c&&(s=c,c=u,u=s),s=Math.abs(e-c);const l=Math.abs(u-e);return s<l&&s<=o?r:l<=o?i:a},lerp:function(t,e){const n=t[0],r=hn(t),i=+e;return i?1===i?r:n+i*(r-n):n},merge:function(){const t=[].slice.call(arguments);return t.unshift({}),On(...t)},pad:function(t,e,n,r){const i=n||" ",a=t+"",o=e-a.length;return o<=0?a:"left"===r?Hn(i,o)+a:"center"===r?Hn(i,~~(o/2))+a+Hn(i,Math.ceil(o/2)):a+Hn(i,o)},peek:hn,pluck:function(t,e){const n=Get[e]||(Get[e]=He(e));return on(t)?t.map(n):n(t)},span:Yn,inrange:Un,truncate:function(t,e,n,r){const i=null!=r?r:"\u2026",a=t+"",o=a.length,s=Math.max(0,e-i.length);return o<=e?a:"left"===n?i+a.slice(o-s):"center"===n?a.slice(0,Math.ceil(s/2))+i+a.slice(o-~~(s/2)):a.slice(0,s)+i},rgb:ott,lab:Ftt,hcl:Btt,hsl:gtt,luminance:Uet,contrast:function(t,e){const n=Uet(t),r=Uet(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a},format:xet,utcFormat:ket,utcParse:Aet,utcOffset:function(t,e,n){return ya(va(t),e,n)},utcSequence:function(t,e,n,r){return ba(va(t),e,n,r)},timeFormat:wet,timeParse:_et,timeOffset:function(t,e,n){return ya(ma(t),e,n)},timeSequence:function(t,e,n,r){return ba(ma(t),e,n,r)},timeUnitSpecifier:function(t,e){const n=On({},Ki,e),r=Xi(t),i=r.length;let a,o,s="",c=0;for(c=0;c<i;)for(a=r.length;a>c;--a)if(o=r.slice(c,a).join("-"),null!=n[o]){s+=n[o],c=a;break}return s.trim()},monthFormat:function(t){return Eet.call(this,t,1,"%B")},monthAbbrevFormat:function(t){return Eet.call(this,t,1,"%b")},dayFormat:function(t){return Eet.call(this,0,2+t,"%A")},dayAbbrevFormat:function(t){return Eet.call(this,0,2+t,"%a")},quarter:function(t){return 1+~~(new Date(t).getMonth()/3)},utcquarter:function(t){return 1+~~(new Date(t).getUTCMonth()/3)},week:function(t){return Ji(new Date(t))},utcweek:function(t){return ra(new Date(t))},dayofyear:function(t){return $i(new Date(t))},utcdayofyear:function(t){return na(new Date(t))},warn:function(){return Pet(this.context.dataflow,"warn",arguments)},info:function(){return Pet(this.context.dataflow,"info",arguments)},debug:function(){return Pet(this.context.dataflow,"debug",arguments)},extent:t=>Rn(t),inScope:function(t){const e=this.context.group;let n=!1;if(e)for(;t;){if(t===e){n=!0;break}t=t.mark.group}return n},intersect:Zet,clampRange:function(t,e,n){let r,i=t[0],a=t[1];return a<i&&(r=a,a=i,i=r),r=a-i,r>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]},pinchDistance:function(t){const e=t.touches,n=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.hypot(n,r)},pinchAngle:function(t){const e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)},screen:function(){const t=Qet();return t?t.screen:{}},containerSize:function(){const t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]},windowSize:function(){const t=Qet();return t?[t.innerWidth,t.innerHeight]:[void 0,void 0]},bandspace:function(t,e,n){return Hv(t||0,e||0,n||0)},setdata:function(t,e){const n=this.context.dataflow,r=this.context.data[t].input;return n.pulse(r,n.changeset().remove(Ze).insert(e)),1},pathShape:function(t){let e=null;return function(n){return n?Nb(n,e=e||yb(t)):t}},panLinear:function(t,e){return yn(t,e,dn,Xe)},panLog:function(t,e){var n=Math.sign(t[0]);return yn(t,e,pn(n),fn(n))},panPow:function(t,e,n){return yn(t,e,vn(n),vn(1/n))},panSymlog:function(t,e,n){return yn(t,e,gn(n),mn(n))},zoomLinear:xn,zoomLog:wn,zoomPow:kn,zoomSymlog:_n,encode:function(t,e,n){if(t){const n=this.context.dataflow,r=t.mark.source;n.pulse(r,n.changeset().encode(t,e))}return void 0!==n?n:t},modify:function(t,e,n,r,i,a){const o=this.context.dataflow,s=this.context.data[t],c=s.input,u=o.stamp();let l,h,d=s.changes;if(!1===o._trigger||!(c.value.length||e||r))return 0;if((!d||d.stamp<u)&&(s.changes=d=o.changeset(),d.stamp=u,o.runAfter((()=>{s.modified=!0,o.pulse(c,d).run()}),!0,1)),n&&(l=!0===n?Ze:on(n)||$s(n)?n:qet(n),d.remove(l)),e&&d.insert(e),r&&(l=qet(r),c.value.some(l)?d.remove(l):d.insert(r)),i)for(h in a)d.modify(i,h,a[h]);return 1},lassoAppend:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;const i=(t=An(t))[t.length-1];return void 0===i||Math.hypot(i[0]-e,i[1]-n)>r?[...t,[e,n]]:t},lassoPath:function(t){return An(t).reduce(((e,n,r)=>{let[i,a]=n;return e+(0==r?"M ".concat(i,",").concat(a," "):r===t.length-1?" Z":"L ".concat(i,",").concat(a," "))}),"")},intersectLasso:function(t,e,n){const{x:r,y:i,mark:a}=n,o=(new rx).set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[s,c]of e)s<o.x1&&(o.x1=s),s>o.x2&&(o.x2=s),c<o.y1&&(o.y1=c),c>o.y2&&(o.y2=c);return o.translate(r,i),Zet([[o.x1,o.y1],[o.x2,o.y2]],t,a).filter((t=>function(t,e,n){let r=0;for(let i=0,a=n.length-1;i<n.length;a=i++){const[o,s]=n[a],[c,u]=n[i];u>e!=s>e&&t<(o-c)*(e-u)/(s-u)+c&&r++}return 1&r}(t.x,t.y,e)))}},Jet=["view","item","group","xy","x","y"],tnt="this.",ent={},nnt={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:t=>"_[".concat(Xn(Net+t),"]"),functions:function(t){const e=s6(t);Jet.forEach((t=>e[t]="event.vega."+t));for(const n in $et)e[n]=tnt+n;return On(e,Oet(t,$et,ent)),e},constants:o6,visitors:ent},rnt=function(t){const e=(t=t||{}).allowed?Jn(t.allowed):{},n=t.forbidden?Jn(t.forbidden):{},r=t.constants||o6,i=(t.functions||s6)(h),a=t.globalvar,o=t.fieldvar,s=Cn(a)?a:t=>"".concat(a,'["').concat(t,'"]');let c={},u={},l=0;function h(t){if(qn(t))return t;const e=d[t.type];return null==e&&qe("Unsupported type: "+t.type),e(t)}const d={Literal:t=>t.raw,Identifier:t=>{const i=t.name;return l>0?i:Bn(n,i)?qe("Illegal identifier: "+i):Bn(r,i)?r[i]:Bn(e,i)?i:(c[i]=1,s(i))},MemberExpression:t=>{const e=!t.computed,n=h(t.object);e&&(l+=1);const r=h(t.property);return n===o&&(u[function(t){const e=t&&t.length-1;return e&&('"'===t[0]&&'"'===t[e]||"'"===t[0]&&"'"===t[e])?t.slice(1,-1):t}(r)]=1),e&&(l-=1),n+(e?"."+r:"["+r+"]")},CallExpression:t=>{"Identifier"!==t.callee.type&&qe("Illegal callee type: "+t.callee.type);const e=t.callee.name,n=t.arguments,r=Bn(i,e)&&i[e];return r||qe("Unrecognized function: "+e),Cn(r)?r(n):r+"("+n.map(h).join(",")+")"},ArrayExpression:t=>"["+t.elements.map(h).join(",")+"]",BinaryExpression:t=>"("+h(t.left)+" "+t.operator+" "+h(t.right)+")",UnaryExpression:t=>"("+t.operator+h(t.argument)+")",ConditionalExpression:t=>"("+h(t.test)+"?"+h(t.consequent)+":"+h(t.alternate)+")",LogicalExpression:t=>"("+h(t.left)+t.operator+h(t.right)+")",ObjectExpression:t=>"{"+t.properties.map(h).join(",")+"}",Property:t=>{l+=1;const e=h(t.key);return l-=1,e+":"+h(t.value)}};function f(t){const e={code:h(t),globals:Object.keys(c),fields:Object.keys(u)};return c={},u={},e}return f.functions=i,f.constants=r,f}(nnt);function int(t,e,n){return 1===arguments.length?$et[t]:($et[t]=e,n&&(ent[t]=n),rnt&&(rnt.functions[t]=tnt+t),this)}function ant(t,e){const n={};let r;try{r=function(t){M8=0,O8=(I8=t).length,R8=null,O5();const e=a6();if(R8.type!==B8)throw new Error("Unexpect token after expression.");return e}(t=qn(t)?t:Xn(t)+"")}catch(a){qe("Expression parse error: "+t)}r.visit((t=>{if(t.type!==A8)return;const r=t.callee.name,i=nnt.visitors[r];i&&i(r,t.arguments,e,n)}));const i=rnt(r);return i.globals.forEach((t=>{const r=Net+t;!Bn(n,r)&&e.getSignal(t)&&(n[r]=e.signalRef(t))})),{$expr:On({code:i.code},e.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}int("bandwidth",(function(t,e){const n=Met(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0}),Det),int("copy",(function(t,e){const n=Met(t,(e||this).context);return n?n.copy():void 0}),Det),int("domain",(function(t,e){const n=Met(t,(e||this).context);return n?n.domain():[]}),Det),int("range",(function(t,e){const n=Met(t,(e||this).context);return n&&n.range?n.range():[]}),Det),int("invert",(function(t,e,n){const r=Met(t,(n||this).context);return r?on(e)?(r.invertRange||r.invert)(e):(r.invert||r.invertExtent)(e):void 0}),Det),int("scale",(function(t,e,n){const r=Met(t,(n||this).context);return r?r(e):void 0}),Det),int("gradient",(function(t,e,n,r,i){t=Met(t,(i||this).context);const a=function(t,e){var n,r=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:r,stop:function(t,e){return r.push({offset:t,color:e}),n}}}(e,n);let o=t.domain(),s=o[0],c=hn(o),u=Xe;return c-s?u=Iy(t,s,c):t=(t.interpolator?wy("sequential")().interpolator(t.interpolator()):wy("linear")().interpolate(t.interpolate()).range(t.range())).domain([s=0,c=1]),t.ticks&&(o=t.ticks(+r||15),s!==o[0]&&o.unshift(s),c!==hn(o)&&o.push(c)),o.forEach((e=>a.stop(u(e),t(e)))),a}),Det),int("geoArea",zet,Det),int("geoBounds",Bet,Det),int("geoCentroid",Let,Det),int("geoShape",(function(t,e,n){const r=Met(t,(n||this).context);return function(t){return r?r.path.context(t)(e):""}}),Det),int("geoScale",(function(t,e){const n=Met(t,(e||this).context);return n&&n.scale()}),Det),int("indata",(function(t,e,n){const r=this.context.data[t]["index:"+e],i=r?r.value.get(n):void 0;return i?i.count:i}),(function(t,e,n,r){e[0].type!==x8&&qe("First argument to indata must be a string literal."),e[1].type!==x8&&qe("Second argument to indata must be a string literal.");const i=e[0].value,a=e[1].value,o="@"+a;Bn(o,r)||(r[o]=n.getData(i).indataRef(n,a))})),int("data",yet,Fet),int("treePath",(function(t,e,n){const r=Ket(t,this),i=r[e],a=r[n];return i&&a?i.path(a).map(Xet):void 0}),Fet),int("treeAncestors",(function(t,e){const n=Ket(t,this)[e];return n?n.ancestors().map(Xet):void 0}),Fet),int("vlSelectionTest",cet,vet),int("vlSelectionIdTest",fet,vet),int("vlSelectionResolve",get,vet),int("vlSelectionTuples",pet);const ont=Jn(["rule"]),snt=Jn(["group","image","rect"]);function cnt(t){return(t+"").toLowerCase()}function unt(t,e,n){n.endsWith(";")||(n="return("+n+");");const r=Function(...e.concat(n));return t&&t.functions?r.bind(t.functions):r}var lnt={operator:(t,e)=>unt(t,["_"],e.code),parameter:(t,e)=>unt(t,["datum","_"],e.code),event:(t,e)=>unt(t,["event"],e.code),handler:(t,e)=>unt(t,["_","event"],"var datum=event.item&&event.item.datum;return ".concat(e.code,";")),encode:(t,e)=>{const{marktype:n,channels:r}=e;let i="var o=item,datum=o.datum,m=0,$;";for(const a in r){const t="o["+Xn(a)+"]";i+="$=".concat(r[a].code,";if(").concat(t,"!==$)").concat(t,"=$,m=1;")}return i+=function(t,e){let n="";return ont[e]||(t.x2&&(t.x?(snt[e]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),t.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),t.y2&&(t.y?(snt[e]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),t.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(r,n),i+="return m;",unt(t,["item","_"],i)},codegen:{get(t){const e="[".concat(t.map(Xn).join("]["),"]"),n=Function("_","return _".concat(e,";"));return n.path=e,n},comparator(t,e){let n;const r=Function("a","b","var u, v; return "+t.map(((t,r)=>{const i=e[r];let a,o;return t.path?(a="a".concat(t.path),o="b".concat(t.path)):((n=n||{})["f"+r]=t,a="this.f".concat(r,"(a)"),o="this.f".concat(r,"(b)")),function(t,e,n,r){return"((u = ".concat(t,") < (v = ").concat(e,") || u == null) && v != null ? ").concat(n,"\n  : (u > v || v == null) && u != null ? ").concat(r,"\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ").concat(n,"\n  : v !== v && u === u ? ").concat(r," : ")}(a,o,-i,i)})).join("")+"0;");return n?r.bind(n):r}}};function hnt(t,e,n){if(!t||!sn(t))return t;for(let r,i=0,a=dnt.length;i<a;++i)if(r=dnt[i],Bn(t,r.key))return r.parse(t,e,n);return t}var dnt=[{key:"$ref",parse:function(t,e){return e.get(t.$ref)||qe("Operator not defined: "+t.$ref)}},{key:"$key",parse:function(t,e){const n="k:"+t.$key+"_"+!!t.$flat;return e.fn[n]||(e.fn[n]=Gn(t.$key,t.$flat,e.expr.codegen))}},{key:"$expr",parse:function(t,e,n){t.$params&&e.parseParameters(t.$params,n);const r="e:"+t.$expr.code;return e.fn[r]||(e.fn[r]=Le(e.parameterExpression(t.$expr),t.$fields))}},{key:"$field",parse:function(t,e){if(!t.$field)return null;const n="f:"+t.$field+"_"+t.$name;return e.fn[n]||(e.fn[n]=He(t.$field,t.$name,e.expr.codegen))}},{key:"$encode",parse:function(t,e){const n=t.$encode,r={};for(const i in n){const t=n[i];r[i]=Le(e.encodeExpression(t.$expr),t.$fields),r[i].output=t.$output}return r}},{key:"$compare",parse:function(t,e){const n="c:"+t.$compare+"_"+t.$order,r=An(t.$compare).map((t=>t&&t.$tupleid?Js:t));return e.fn[n]||(e.fn[n]=En(r,t.$order,e.expr.codegen))}},{key:"$context",parse:function(t,e){return e}},{key:"$subflow",parse:function(t,e){const n=t.$subflow;return function(t,r,i){const a=e.fork().parse(n),o=a.get(n.operators[0].id),s=a.signals.parent;return s&&s.set(i),o.detachSubflow=()=>e.detach(a),o}}},{key:"$tupleid",parse:function(){return Js}}];const fnt={skip:!0};function pnt(t,e,n,r){return new gnt(t,e,n,r)}function gnt(t,e,n,r){this.dataflow=t,this.transforms=e,this.events=t.events.bind(t),this.expr=r||lnt,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function mnt(t){this.dataflow=t.dataflow,this.transforms=t.transforms,this.events=t.events,this.expr=t.expr,this.signals=Object.create(t.signals),this.scales=Object.create(t.scales),this.nodes=Object.create(t.nodes),this.data=Object.create(t.data),this.fn=Object.create(t.fn),t.functions&&(this.functions=Object.create(t.functions),this.functions.context=this)}function vnt(t,e){t&&(null==e?t.removeAttribute("aria-label"):t.setAttribute("aria-label",e))}gnt.prototype=mnt.prototype={fork(){const t=new mnt(this);return(this.subcontext||(this.subcontext=[])).push(t),t},detach(t){this.subcontext=this.subcontext.filter((e=>e!==t));const e=Object.keys(t.nodes);for(const n of e)t.nodes[n]._targets=null;for(const n of e)t.nodes[n].detach();t.nodes=null},get(t){return this.nodes[t]},set(t,e){return this.nodes[t]=e},add(t,e){const n=this,r=n.dataflow,i=t.value;if(n.set(t.id,e),function(t){return"collect"===cnt(t)}(t.type)&&i&&(i.$ingest?r.ingest(e,i.$ingest,i.$format):i.$request?r.preload(e,i.$request,i.$format):r.pulse(e,r.changeset().insert(i))),t.root&&(n.root=e),t.parent){let i=n.get(t.parent.$ref);i?(r.connect(i,[e]),e.targets().add(i)):(n.unresolved=n.unresolved||[]).push((()=>{i=n.get(t.parent.$ref),r.connect(i,[e]),e.targets().add(i)}))}if(t.signal&&(n.signals[t.signal]=e),t.scale&&(n.scales[t.scale]=e),t.data)for(const a in t.data){const r=n.data[a]||(n.data[a]={});t.data[a].forEach((t=>r[t]=e))}},resolve(){return(this.unresolved||[]).forEach((t=>t())),delete this.unresolved,this},operator(t,e){this.add(t,this.dataflow.add(t.value,e))},transform(t,e){this.add(t,this.dataflow.add(this.transforms[cnt(e)]))},stream(t,e){this.set(t.id,e)},update(t,e,n,r,i){this.dataflow.on(e,n,r,i,t.options)},operatorExpression(t){return this.expr.operator(this,t)},parameterExpression(t){return this.expr.parameter(this,t)},eventExpression(t){return this.expr.event(this,t)},handlerExpression(t){return this.expr.handler(this,t)},encodeExpression(t){return this.expr.encode(this,t)},parse:function(t){const e=this,n=t.operators||[];return t.background&&(e.background=t.background),t.eventConfig&&(e.eventConfig=t.eventConfig),t.locale&&(e.locale=t.locale),n.forEach((t=>e.parseOperator(t))),n.forEach((t=>e.parseOperatorParameters(t))),(t.streams||[]).forEach((t=>e.parseStream(t))),(t.updates||[]).forEach((t=>e.parseUpdate(t))),e.resolve()},parseOperator:function(t){const e=this;!function(t){return"operator"===cnt(t)}(t.type)&&t.type?e.transform(t,t.type):e.operator(t,t.update?e.operatorExpression(t.update):null)},parseOperatorParameters:function(t){const e=this;if(t.params){const n=e.get(t.id);n||qe("Invalid operator id: "+t.id),e.dataflow.connect(n,n.parameters(e.parseParameters(t.params),t.react,t.initonly))}},parseParameters:function(t,e){e=e||{};const n=this;for(const r in t){const i=t[r];e[r]=on(i)?i.map((t=>hnt(t,n,e))):hnt(i,n,e)}return e},parseStream:function(t){var e,n=this,r=null!=t.filter?n.eventExpression(t.filter):void 0,i=null!=t.stream?n.get(t.stream):void 0;t.source?i=n.events(t.source,t.type,r):t.merge&&(i=(e=t.merge.map((t=>n.get(t))))[0].merge.apply(e[0],e.slice(1))),t.between&&(e=t.between.map((t=>n.get(t))),i=i.between(e[0],e[1])),t.filter&&(i=i.filter(r)),null!=t.throttle&&(i=i.throttle(+t.throttle)),null!=t.debounce&&(i=i.debounce(+t.debounce)),null==i&&qe("Invalid stream definition: "+JSON.stringify(t)),t.consume&&i.consume(!0),n.stream(t,i)},parseUpdate:function(t){var e,n=this,r=sn(r=t.source)?r.$ref:r,i=n.get(r),a=t.update,o=void 0;i||qe("Source not defined: "+t.source),e=t.target&&t.target.$expr?n.eventExpression(t.target.$expr):n.get(t.target),a&&a.$expr&&(a.$params&&(o=n.parseParameters(a.$params)),a=n.handlerExpression(a.$expr)),n.update(t,i,e,a,o)},getState:function(t){var e=this,n={};if(t.signals){var r=n.signals={};Object.keys(e.signals).forEach((n=>{const i=e.signals[n];t.signals(n,i)&&(r[n]=i.value)}))}if(t.data){var i=n.data={};Object.keys(e.data).forEach((n=>{const r=e.data[n];t.data(n,r)&&(i[n]=r.input.value)}))}return e.subcontext&&!1!==t.recurse&&(n.subcontext=e.subcontext.map((e=>e.getState(t)))),n},setState:function(t){var e=this,n=e.dataflow,r=t.data,i=t.signals;Object.keys(i||{}).forEach((t=>{n.update(e.signals[t],i[t],fnt)})),Object.keys(r||{}).forEach((t=>{n.pulse(e.data[t].input,n.changeset().remove(Ze).insert(r[t]))})),(t.subcontext||[]).forEach(((t,n)=>{const r=e.subcontext[n];r&&r.setState(t)}))}};const ynt="default";function bnt(t,e){const n=t.globalCursor()?"undefined"!==typeof document&&document.body:t.container();if(n)return null==e?n.style.removeProperty("cursor"):n.style.cursor=e}function xnt(t,e){var n=t._runtime.data;return Bn(n,e)||qe("Unrecognized data set: "+e),n[e]}function wnt(t,e){oc(e)||qe("Second argument to changes must be a changeset.");const n=xnt(this,t);return n.modified=!0,this.pulse(n.input,e)}function knt(t){var e=t.padding();return Math.max(0,t._viewWidth+e.left+e.right)}function _nt(t){var e=t.padding();return Math.max(0,t._viewHeight+e.top+e.bottom)}function Ant(t){var e=t.padding(),n=t._origin;return[e.left+n[0],e.top+n[1]]}function Cnt(t,e,n){var r,i,a=t._renderer,o=a&&a.canvas();return o&&(i=Ant(t),(r=dk(e.changedTouches?e.changedTouches[0]:e,o))[0]-=i[0],r[1]-=i[1]),e.dataflow=t,e.item=n,e.vega=function(t,e,n){const r=e?"group"===e.mark.marktype?e:e.mark.group:null;function i(t){var n,i=r;if(t)for(n=e;n;n=n.mark.group)if(n.mark.name===t){i=n;break}return i&&i.mark&&i.mark.interactive?i:{}}function a(t){if(!t)return n;qn(t)&&(t=i(t));const e=n.slice();for(;t;)e[0]-=t.x||0,e[1]-=t.y||0,t=t.mark&&t.mark.group;return e}return{view:In(t),item:In(e||{}),group:i,xy:a,x:t=>a(t)[0],y:t=>a(t)[1]}}(t,n,r),e}const Snt="view",Ent={trap:!1};function Tnt(t,e,n,r){t._eventListeners.push({type:n,sources:An(e),handler:r})}function Nnt(t,e,n){const r=t._eventConfig&&t._eventConfig[e];return!(!1===r||sn(r)&&!r[n])||(t.warn("Blocked ".concat(e," ").concat(n," event listener.")),!1)}function Fnt(t){return t.item}function Dnt(t){return t.item.mark.source}function Int(t){return function(e,n){return n.vega.view().changeset().encode(n.item,t)}}function Mnt(t,e,n){const r=document.createElement(t);for(const i in e)r.setAttribute(i,e[i]);return null!=n&&(r.textContent=n),r}const Ont="vega-bind",Rnt="vega-bind-name",znt="vega-bind-radio";function Bnt(t,e,n,r){const i=n.event||"input",a=()=>t.update(e.value);r.signal(n.signal,e.value),e.addEventListener(i,a),Tnt(r,e,i,a),t.set=t=>{e.value=t,e.dispatchEvent(function(t){return"undefined"!==typeof Event?new Event(t):{type:t}}(i))}}function Lnt(t,e,n,r){const i=r.signal(n.signal),a=Mnt("div",{class:Ont}),o="radio"===n.input?a:a.appendChild(Mnt("label"));o.appendChild(Mnt("span",{class:Rnt},n.name||n.signal)),e.appendChild(a);let s=Pnt;switch(n.input){case"checkbox":s=jnt;break;case"select":s=Unt;break;case"radio":s=Wnt;break;case"range":s=Vnt}s(t,o,n,i)}function Pnt(t,e,n,r){const i=Mnt("input");for(const a in n)"signal"!==a&&"element"!==a&&i.setAttribute("input"===a?"type":a,n[a]);i.setAttribute("name",n.signal),i.value=r,e.appendChild(i),i.addEventListener("input",(()=>t.update(i.value))),t.elements=[i],t.set=t=>i.value=t}function jnt(t,e,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const a=Mnt("input",i);e.appendChild(a),a.addEventListener("change",(()=>t.update(a.checked))),t.elements=[a],t.set=t=>a.checked=!!t||null}function Unt(t,e,n,r){const i=Mnt("select",{name:n.signal}),a=n.labels||[];n.options.forEach(((t,e)=>{const n={value:t};qnt(t,r)&&(n.selected=!0),i.appendChild(Mnt("option",n,(a[e]||t)+""))})),e.appendChild(i),i.addEventListener("change",(()=>{t.update(n.options[i.selectedIndex])})),t.elements=[i],t.set=t=>{for(let e=0,r=n.options.length;e<r;++e)if(qnt(n.options[e],t))return void(i.selectedIndex=e)}}function Wnt(t,e,n,r){const i=Mnt("span",{class:znt}),a=n.labels||[];e.appendChild(i),t.elements=n.options.map(((e,o)=>{const s={type:"radio",name:n.signal,value:e};qnt(e,r)&&(s.checked=!0);const c=Mnt("input",s);c.addEventListener("change",(()=>t.update(e)));const u=Mnt("label",{},(a[o]||e)+"");return u.prepend(c),i.appendChild(u),c})),t.set=e=>{const n=t.elements,r=n.length;for(let t=0;t<r;++t)qnt(n[t].value,e)&&(n[t].checked=!0)}}function Vnt(t,e,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;const i=null!=n.max?n.max:Math.max(100,+r)||100,a=n.min||Math.min(0,i,+r)||0,o=n.step||HS(a,i,100),s=Mnt("input",{type:"range",name:n.signal,min:a,max:i,step:o});s.value=r;const c=Mnt("span",{},+r);e.appendChild(s),e.appendChild(c);const u=()=>{c.textContent=s.value,t.update(+s.value)};s.addEventListener("input",u),s.addEventListener("change",u),t.elements=[s],t.set=t=>{s.value=t,c.textContent=t}}function qnt(t,e){return t===e||t+""===e+""}function Gnt(t,e,n,r,i,a){return(e=e||new r(t.loader())).initialize(n,knt(t),_nt(t),Ant(t),i,a).background(t.background())}function Hnt(t,e){return e?function(){try{e.apply(this,arguments)}catch(n){t.error(n)}}:null}function Ynt(t,e,n){if("string"===typeof e){if("undefined"===typeof document)return t.error("DOM document instance not found."),null;if(!(e=document.querySelector(e)))return t.error("Signal bind element not found: "+e),null}if(e&&n)try{e.innerHTML=""}catch(r){e=null,t.error(r)}return e}const Xnt=t=>+t||0;function Knt(t){return sn(t)?{top:Xnt(t.top),bottom:Xnt(t.bottom),left:Xnt(t.left),right:Xnt(t.right)}:(t=>({top:t,bottom:t,left:t,right:t}))(Xnt(t))}async function Qnt(t,e,n,r){const i=L_(e),a=i&&i.headless;return a||qe("Unrecognized renderer type: "+e),await t.runAsync(),Gnt(t,null,null,a,n,r).renderAsync(t._scenegraph.root)}var Znt="width",$nt="height",Jnt="padding",trt={skip:!0};function ert(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===Jnt?r.left+r.right:0)}function nrt(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===Jnt?r.top+r.bottom:0)}function rrt(t,e){return e.modified&&on(e.input.value)&&t.indexOf("_:vega:_")}function irt(t,e){return!("parent"===t||e instanceof Mc.proxy)}function art(t,e,n,r){const i=t.element();i&&i.setAttribute("title",function(t){return null==t?"":on(t)?ort(t):sn(t)&&!Wn(t)?(e=t,Object.keys(e).map((t=>{const n=e[t];return t+": "+(on(n)?ort(n):srt(n))})).join("\n")):t+"";var e}(r))}function ort(t){return"["+t.map(srt).join(", ")+"]"}function srt(t){return on(t)?"[\u2026]":sn(t)&&!Wn(t)?"{\u2026}":t}function crt(t,e){const n=this;if(e=e||{},Fc.call(n),e.loader&&n.loader(e.loader),e.logger&&n.logger(e.logger),null!=e.logLevel&&n.logLevel(e.logLevel),e.locale||t.locale){const r=On({},t.locale,e.locale);n.locale(function(t,e){const n=t?fs(t):ps(),r=e?ys(e):bs();return xs(n,r)}(r.number,r.time))}n._el=null,n._elBind=null,n._renderType=e.renderer||z_.Canvas,n._scenegraph=new ak;const r=n._scenegraph.root;n._renderer=null,n._tooltip=e.tooltip||art,n._redraw=!0,n._handler=(new Rk).scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function(t){const e=On({defaults:{}},t),n=(t,e)=>{e.forEach((e=>{on(t[e])&&(t[e]=Jn(t[e]))}))};return n(e.defaults,["prevent","allow"]),n(e,["view","window","selector"]),e}(t.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=function(t,e,n){return pnt(t,Mc,$et,n).parse(e)}(n,t,e.expr);n._runtime=i,n._signals=i.signals,n._bind=(t.bindings||[]).map((t=>({state:null,param:On({},t)}))),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=ert(n,n._width),n._viewHeight=nrt(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(t){var e=t._signals,n=e[Znt],r=e[$nt],i=e[Jnt];function a(){t._autosize=t._resize=1}t._resizeWidth=t.add(null,(e=>{t._width=e.size,t._viewWidth=ert(t,e.size),a()}),{size:n}),t._resizeHeight=t.add(null,(e=>{t._height=e.size,t._viewHeight=nrt(t,e.size),a()}),{size:r});const o=t.add(null,a,{pad:i});t._resizeWidth.rank=n.rank+1,t._resizeHeight.rank=r.rank+1,o.rank=i.rank+1}(n),function(t){t.add(null,(e=>(t._background=e.bg,t._resize=1,e.bg)),{bg:t._signals.background})}(n),function(t){const e=t._signals.cursor||(t._signals.cursor=t.add({user:ynt,item:null}));t.on(t.events("view","mousemove"),e,((t,n)=>{const r=e.value,i=r?qn(r)?r:r.user:ynt,a=n.item&&n.item.cursor||null;return r&&i===r.user&&a==r.item?r:{user:i,item:a}})),t.add(null,(function(e){let n=e.cursor,r=this.value;return qn(n)||(r=n.item,n=n.user),bnt(t,n&&n!==ynt?n:r||n),r}),{cursor:e})}(n),n.description(t.description),e.hover&&n.hover(),e.container&&n.initialize(e.container,e.bind)}function urt(t,e){return Bn(t._signals,e)?t._signals[e]:qe("Unrecognized signal name: "+Xn(e))}function lrt(t,e){const n=(t._targets||[]).filter((t=>t._update&&t._update.handler===e));return n.length?n[0]:null}function hrt(t,e,n,r){let i=lrt(n,r);return i||(i=Hnt(t,(()=>r(e,n.value))),i.handler=r,t.on(n,null,i)),t}function drt(t,e,n){const r=lrt(e,n);return r&&e._targets.remove(r),t}jn(crt,Fc,{async evaluate(t,e,n){if(await Fc.prototype.evaluate.call(this,t,e),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,function(t){var e=Ant(t),n=knt(t),r=_nt(t);t._renderer.background(t.background()),t._renderer.resize(n,r,e),t._handler.origin(e),t._resizeListeners.forEach((e=>{try{e(n,r)}catch(i){t.error(i)}}))}(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&Ks(this,n),this},dirty(t){this._redraw=!0,this._renderer&&this._renderer.dirty(t)},description(t){if(arguments.length){const e=null!=t?t+"":null;return e!==this._desc&&vnt(this._el,this._desc=e),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(t,e,n){const r=urt(this,t);return 1===arguments.length?r.value:this.update(r,e,n)},width(t){return arguments.length?this.signal("width",t):this.signal("width")},height(t){return arguments.length?this.signal("height",t):this.signal("height")},padding(t){return arguments.length?this.signal("padding",Knt(t)):Knt(this.signal("padding"))},autosize(t){return arguments.length?this.signal("autosize",t):this.signal("autosize")},background(t){return arguments.length?this.signal("background",t):this.signal("background")},renderer(t){return arguments.length?(L_(t)||qe("Unrecognized renderer type: "+t),t!==this._renderType&&(this._renderType=t,this._resetRenderer()),this):this._renderType},tooltip(t){return arguments.length?(t!==this._tooltip&&(this._tooltip=t,this._resetRenderer()),this):this._tooltip},loader(t){return arguments.length?(t!==this._loader&&(Fc.prototype.loader.call(this,t),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(urt(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function(t,e,n,r,i,a){this.runAfter((o=>{let s=0;o._autosize=0,o.width()!==n&&(s=1,o.signal(Znt,n,trt),o._resizeWidth.skip(!0)),o.height()!==r&&(s=1,o.signal($nt,r,trt),o._resizeHeight.skip(!0)),o._viewWidth!==t&&(o._resize=1,o._viewWidth=t),o._viewHeight!==e&&(o._resize=1,o._viewHeight=e),o._origin[0]===i[0]&&o._origin[1]===i[1]||(o._resize=1,o._origin=i),s&&o.run("enter"),a&&o.runAfter((t=>t.resize()))}),!1,1)},addEventListener(t,e,n){let r=e;return n&&!1===n.trap||(r=Hnt(this,e),r.raw=e),this._handler.on(t,r),this},removeEventListener(t,e){for(var n,r,i=this._handler.handlers(t),a=i.length;--a>=0;)if(r=i[a].type,n=i[a].handler,t===r&&(e===n||e===n.raw)){this._handler.off(r,n);break}return this},addResizeListener(t){const e=this._resizeListeners;return e.indexOf(t)<0&&e.push(t),this},removeResizeListener(t){var e=this._resizeListeners,n=e.indexOf(t);return n>=0&&e.splice(n,1),this},addSignalListener(t,e){return hrt(this,t,urt(this,t),e)},removeSignalListener(t,e){return drt(this,urt(this,t),e)},addDataListener(t,e){return hrt(this,t,xnt(this,t).values,e)},removeDataListener(t,e){return drt(this,xnt(this,t).values,e)},globalCursor(t){if(arguments.length){if(this._globalCursor!==!!t){const e=bnt(this,null);this._globalCursor=!!t,e&&bnt(this,e)}return this}return this._globalCursor},preventDefault(t){return arguments.length?(this._preventDefault=t,this):this._preventDefault},timer:function(t,e){this._timers.push(function(t,e,n){var r=new nM,i=e;return null==e?(r.restart(t,e,n),r):(r._restart=r.restart,r.restart=function(t,e,n){e=+e,n=null==n?tM():+n,r._restart((function a(o){o+=i,r._restart(a,i+=e,n),t(o)}),e,n)},r.restart(t,e,n),r)}((function(e){t({timestamp:Date.now(),elapsed:e})}),e))},events:function(t,e,n){var r,i=this,a=new gc(n),o=function(n,r){i.runAsync(null,(()=>{t===Snt&&function(t,e){var n=t._eventConfig.defaults,r=n.prevent,i=n.allow;return!1!==r&&!0!==i&&(!0===r||!1===i||(r?r[e]:i?!i[e]:t.preventDefault()))}(i,e)&&n.preventDefault(),a.receive(Cnt(i,n,r))}))};if("timer"===t)Nnt(i,"timer",e)&&i.timer(o,e);else if(t===Snt)Nnt(i,"view",e)&&i.addEventListener(e,o,Ent);else if("window"===t?Nnt(i,"window",e)&&"undefined"!==typeof window&&(r=[window]):"undefined"!==typeof document&&Nnt(i,"selector",e)&&(r=document.querySelectorAll(t)),r){for(var s=0,c=r.length;s<c;++s)r[s].addEventListener(e,o);Tnt(i,r,e,o)}else i.warn("Can not resolve event source: "+t);return a},finalize:function(){var t,e,n,r=this._tooltip,i=this._timers,a=this._eventListeners;for(t=i.length;--t>=0;)i[t].stop();for(t=a.length;--t>=0;)for(e=(n=a[t]).sources.length;--e>=0;)n.sources[e].removeEventListener(n.type,n.handler);return r&&r.call(this,this._handler,null,null,null),this},hover:function(t,e){return e=[e||"update",(t=[t||"hover"])[0]],this.on(this.events("view","mouseover",Fnt),Dnt,Int(t)),this.on(this.events("view","mouseout",Fnt),Dnt,Int(e)),this},data:function(t,e){return arguments.length<2?xnt(this,t).values.value:wnt.call(this,t,sc().remove(Ze).insert(e))},change:wnt,insert:function(t,e){return wnt.call(this,t,sc().insert(e))},remove:function(t,e){return wnt.call(this,t,sc().remove(e))},scale:function(t){var e=this._runtime.scales;return Bn(e,t)||qe("Unrecognized scale or projection: "+t),e[t].value},initialize:function(t,e){const n=this,r=n._renderType,i=n._eventConfig.bind,a=L_(r);t=n._el=t?Ynt(n,t,!0):null,function(t){const e=t.container();e&&(e.setAttribute("role","graphics-document"),e.setAttribute("aria-roleDescription","visualization"),vnt(e,t.description()))}(n),a||n.error("Unrecognized renderer type: "+r);const o=a.handler||Rk,s=t?a.renderer:a.headless;return n._renderer=s?Gnt(n,n._renderer,t,s):null,n._handler=function(t,e,n,r){const i=new r(t.loader(),Hnt(t,t.tooltip())).scene(t.scenegraph().root).initialize(n,Ant(t),t);return e&&e.handlers().forEach((t=>{i.on(t.type,t.handler)})),i}(n,n._handler,t,o),n._redraw=!0,t&&"none"!==i&&(e=e?n._elBind=Ynt(n,e,!0):t.appendChild(Mnt("form",{class:"vega-bindings"})),n._bind.forEach((t=>{t.param.element&&"container"!==i&&(t.element=Ynt(n,t.param.element,!!t.param.input))})),n._bind.forEach((t=>{!function(t,e,n){if(!e)return;const r=n.param;let i=n.state;i||(i=n.state={elements:null,active:!1,set:null,update:e=>{e!=t.signal(r.signal)&&t.runAsync(null,(()=>{i.source=!0,t.signal(r.signal,e)}))}},r.debounce&&(i.update=Mn(r.debounce,i.update))),(null==r.input&&r.element?Bnt:Lnt)(i,e,r,t),i.active||(t.on(t._signals[r.signal],null,(()=>{i.source?i.source=!1:i.set(t.signal(r.signal))})),i.active=!0)}(n,t.element||e,t)}))),n},toImageURL:async function(t,e){t!==z_.Canvas&&t!==z_.SVG&&t!==z_.PNG&&qe("Unrecognized image type: "+t);const n=await Qnt(this,t,e);return t===z_.SVG?function(t,e){const n=new Blob([t],{type:e});return window.URL.createObjectURL(n)}(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")},toCanvas:async function(t,e){return(await Qnt(this,z_.Canvas,t,e)).canvas()},toSVG:async function(t){return(await Qnt(this,z_.SVG,t)).svg()},getState:function(t){return this._runtime.getState(t||{data:rrt,signals:irt,recurse:!0})},setState:function(t){return this.runAsync(null,(e=>{e._trigger=!1,e._runtime.setState(t)}),(t=>{t._trigger=!0})),this}});var frt,prt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function grt(t){if(!(e=prt.exec(t)))throw new Error("invalid format: "+t);var e;return new mrt({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function mrt(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function vrt(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function yrt(t){return(t=vrt(Math.abs(t)))?t[1]:NaN}function brt(t,e){var n=vrt(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}grt.prototype=mrt.prototype,mrt.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const xrt={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>brt(100*t,e),r:brt,s:function(t,e){var n=vrt(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(frt=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+vrt(t,Math.max(0,e+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function wrt(t){return t}var krt,_rt,Art,Crt=Array.prototype.map,Srt=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Ert(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?wrt:(e=Crt.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,a=[],o=0,s=e[0],c=0;i>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),a.push(t.substring(i-=s,i+s)),!((c+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?wrt:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(Crt.call(t.numerals,String)),c=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"\u2212":t.minus+"",l=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=grt(t)).fill,n=t.align,h=t.sign,d=t.symbol,f=t.zero,p=t.width,g=t.comma,m=t.precision,v=t.trim,y=t.type;"n"===y?(g=!0,y="g"):xrt[y]||(void 0===m&&(m=12),v=!0,y="g"),(f||"0"===e&&"="===n)&&(f=!0,e="0",n="=");var b="$"===d?i:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x="$"===d?a:/[%p]/.test(y)?c:"",w=xrt[y],k=/[defgprs%]/.test(y);function _(t){var i,a,c,d=b,_=x;if("c"===y)_=w(t)+_,t="";else{var A=(t=+t)<0||1/t<0;if(t=isNaN(t)?l:w(Math.abs(t),m),v&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),A&&0===+t&&"+"!==h&&(A=!1),d=(A?"("===h?h:u:"-"===h||"("===h?"":h)+d,_=("s"===y?Srt[8+frt/3]:"")+_+(A&&"("===h?")":""),k)for(i=-1,a=t.length;++i<a;)if(48>(c=t.charCodeAt(i))||c>57){_=(46===c?o+t.slice(i+1):t.slice(i))+_,t=t.slice(0,i);break}}g&&!f&&(t=r(t,1/0));var C=d.length+t.length+_.length,S=C<p?new Array(p-C+1).join(e):"";switch(g&&f&&(t=r(S+t,S.length?p-_.length:1/0),S=""),n){case"<":t=d+t+_+S;break;case"=":t=d+S+t+_;break;case"^":t=S.slice(0,C=S.length>>1)+d+t+_+S.slice(C);break;default:t=S+d+t+_}return s(t)}return m=void 0===m?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),_.toString=function(){return t+""},_}return{format:h,formatPrefix:function(t,e){var n=h(((t=grt(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(yrt(e)/3))),i=Math.pow(10,-r),a=Srt[8+r/3];return function(t){return n(i*t)+a}}}}function Trt(t,e,n){return t.fields=e||[],t.fname=n,t}function Nrt(t){return 1===t.length?Frt(t[0]):Drt(t)}!function(t){krt=Ert(t),_rt=krt.format,Art=krt.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});const Frt=t=>function(e){return e[t]},Drt=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function Irt(t){throw Error(t)}function Mrt(t){const e=[],n=t.length;let r,i,a,o=null,s=0,c="";function u(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)c+=t.substring(r,i++),r=i;else if(a===o)u(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&u(),s=r=i+1):"]"===a&&(s||Irt("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&Irt("Access path missing closing bracket: "+t),o&&Irt("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function Ort(t,e,n){const r=Mrt(t);return t=1===r.length?r[0]:t,Trt((n&&n.get||Nrt)(r),[t],e||t)}Ort("id"),Trt((t=>t),[],"identity"),Trt((()=>0),[],"zero"),Trt((()=>1),[],"one"),Trt((()=>!0),[],"true"),Trt((()=>!1),[],"false");Array.isArray;function Rrt(t){return t===Object(t)}function zrt(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}Object.prototype.hasOwnProperty;function Brt(t){return"string"===typeof t}const Lrt="year",Prt="quarter",jrt="month",Urt="week",Wrt="date",Vrt="day",qrt="dayofyear",Grt="hours",Hrt="minutes",Yrt="seconds",Xrt="milliseconds";[Lrt,Prt,jrt,Urt,Wrt,Vrt,qrt,Grt,Hrt,Yrt,Xrt].reduce(((t,e,n)=>(t[e]=1+n,t)),{});"".concat(Lrt,"-").concat(jrt),"".concat(Lrt,"-").concat(jrt,"-").concat(Wrt),"".concat(Grt,"-").concat(Hrt);new Date;const Krt={[Lrt]:mi,[Prt]:yi.every(3),[jrt]:yi,[Urt]:ei,[Wrt]:Zr,[Vrt]:Zr,[qrt]:Zr,[Grt]:xi,[Hrt]:ki,[Yrt]:Ai,[Xrt]:Ci},Qrt={[Lrt]:vi,[Prt]:bi.every(3),[jrt]:bi,[Urt]:ui,[Wrt]:$r,[Vrt]:$r,[qrt]:$r,[Grt]:wi,[Hrt]:_i,[Yrt]:Ai,[Xrt]:Ci};function Zrt(t){return Krt[t]}function $rt(t){return Qrt[t]}const Jrt=[Lrt,jrt,Wrt,Grt,Hrt,Yrt,Xrt],tit=Jrt.slice(0,-1),eit=tit.slice(0,-1),nit=eit.slice(0,-1);nit.slice(0,-1);var rit=new Date,iit=new Date;function ait(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,a){var o,s=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r)||!(a>0))return s;do{s.push(o=new Date(+n)),e(n,a),t(n)}while(o<n&&n<r);return s},i.filter=function(n){return ait((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return rit.setTime(+e),iit.setTime(+r),t(rit),t(iit),Math.floor(n(rit,iit))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t===0}:function(e){return i.count(0,e)%t===0}):i:null}),i}const oit=6e4,sit=864e5,cit=6048e5;function uit(t){return ait((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/cit}))}var lit=uit(0),hit=uit(1),dit=uit(2),fit=uit(3),pit=uit(4),git=uit(5),mit=uit(6),vit=(lit.range,hit.range,dit.range,fit.range,pit.range,git.range,mit.range,ait((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/sit}),(function(t){return t.getUTCDate()-1})));const yit=vit;vit.range;function bit(t){return ait((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*oit)/cit}))}var xit=bit(0),wit=bit(1),kit=bit(2),_it=bit(3),Ait=bit(4),Cit=bit(5),Sit=bit(6),Eit=(xit.range,wit.range,kit.range,_it.range,Ait.range,Cit.range,Sit.range,ait((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*oit)/sit),(t=>t.getDate()-1)));const Tit=Eit;Eit.range;var Nit=ait((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));Nit.every=function(t){return isFinite(t=Math.floor(t))&&t>0?ait((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};const Fit=Nit;Nit.range;var Dit=ait((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));Dit.every=function(t){return isFinite(t=Math.floor(t))&&t>0?ait((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};const Iit=Dit;Dit.range;function Mit(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Oit(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Rit(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function zit(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,a=t.days,o=t.shortDays,s=t.months,c=t.shortMonths,u=Xit(i),l=Kit(i),h=Xit(a),d=Kit(a),f=Xit(o),p=Kit(o),g=Xit(s),m=Kit(s),v=Xit(c),y=Kit(c),b={a:function(t){return o[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:mat,e:mat,f:wat,g:Iat,G:Oat,H:vat,I:yat,j:bat,L:xat,m:kat,M:_at,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:rot,s:iot,S:Aat,u:Cat,U:Sat,V:Tat,w:Nat,W:Fat,x:null,X:null,y:Dat,Y:Mat,Z:Rat,"%":not},x={a:function(t){return o[t.getUTCDay()]},A:function(t){return a[t.getUTCDay()]},b:function(t){return c[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:zat,e:zat,f:Uat,g:$at,G:tot,H:Bat,I:Lat,j:Pat,L:jat,m:Wat,M:Vat,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:rot,s:iot,S:qat,u:Gat,U:Hat,V:Xat,w:Kat,W:Qat,x:null,X:null,y:Zat,Y:Jat,Z:eot,"%":not},w={a:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(t,e,n){var r=v.exec(e.slice(n));return r?(t.m=y.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(t,e,n){var r=g.exec(e.slice(n));return r?(t.m=m.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(t,n,r){return A(t,e,n,r)},d:oat,e:oat,f:dat,g:nat,G:eat,H:cat,I:cat,j:sat,L:hat,m:aat,M:uat,p:function(t,e,n){var r=u.exec(e.slice(n));return r?(t.p=l.get(r[0].toLowerCase()),n+r[0].length):-1},q:iat,Q:pat,s:gat,S:lat,u:Zit,U:$it,V:Jit,w:Qit,W:tat,x:function(t,e,r){return A(t,n,e,r)},X:function(t,e,n){return A(t,r,e,n)},y:nat,Y:eat,Z:rat,"%":fat};function k(t,e){return function(n){var r,i,a,o=[],s=-1,c=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===t.charCodeAt(s)&&(o.push(t.slice(c,s)),null!=(i=Wit[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(a=e[r])&&(r=a(n,i)),o.push(r),c=s+1);return o.push(t.slice(c,s)),o.join("")}}function _(t,e){return function(n){var r,i,a=Rit(1900,void 0,1);if(A(a,t,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("s"in a)return new Date(1e3*a.s+("L"in a?a.L:0));if(e&&!("Z"in a)&&(a.Z=0),"p"in a&&(a.H=a.H%12+12*a.p),void 0===a.m&&(a.m="q"in a?a.q:0),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(i=(r=Oit(Rit(a.y,0,1))).getUTCDay(),r=i>4||0===i?hit.ceil(r):hit(r),r=yit.offset(r,7*(a.V-1)),a.y=r.getUTCFullYear(),a.m=r.getUTCMonth(),a.d=r.getUTCDate()+(a.w+6)%7):(i=(r=Mit(Rit(a.y,0,1))).getDay(),r=i>4||0===i?wit.ceil(r):wit(r),r=Tit.offset(r,7*(a.V-1)),a.y=r.getFullYear(),a.m=r.getMonth(),a.d=r.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),i="Z"in a?Oit(Rit(a.y,0,1)).getUTCDay():Mit(Rit(a.y,0,1)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(i+5)%7:a.w+7*a.U-(i+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,Oit(a)):Mit(a)}}function A(t,e,n,r){for(var i,a,o=0,s=e.length,c=n.length;o<s;){if(r>=c)return-1;if(37===(i=e.charCodeAt(o++))){if(i=e.charAt(o++),!(a=w[i in Wit?e.charAt(o++):i])||(r=a(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=k(n,b),b.X=k(r,b),b.c=k(e,b),x.x=k(n,x),x.X=k(r,x),x.c=k(e,x),{format:function(t){var e=k(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=_(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=k(t+="",x);return e.toString=function(){return t},e},utcParse:function(t){var e=_(t+="",!0);return e.toString=function(){return t},e}}}var Bit,Lit,Pit,jit,Uit,Wit={"-":"",_:" ",0:"0"},Vit=/^\s*\d+/,qit=/^%/,Git=/[\\^$*+?|[\]().{}]/g;function Hit(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function Yit(t){return t.replace(Git,"\\$&")}function Xit(t){return new RegExp("^(?:"+t.map(Yit).join("|")+")","i")}function Kit(t){return new Map(t.map(((t,e)=>[t.toLowerCase(),e])))}function Qit(t,e,n){var r=Vit.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Zit(t,e,n){var r=Vit.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function $it(t,e,n){var r=Vit.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Jit(t,e,n){var r=Vit.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function tat(t,e,n){var r=Vit.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function eat(t,e,n){var r=Vit.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function nat(t,e,n){var r=Vit.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function rat(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function iat(t,e,n){var r=Vit.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function aat(t,e,n){var r=Vit.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function oat(t,e,n){var r=Vit.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function sat(t,e,n){var r=Vit.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function cat(t,e,n){var r=Vit.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function uat(t,e,n){var r=Vit.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function lat(t,e,n){var r=Vit.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function hat(t,e,n){var r=Vit.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function dat(t,e,n){var r=Vit.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function fat(t,e,n){var r=qit.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function pat(t,e,n){var r=Vit.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function gat(t,e,n){var r=Vit.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function mat(t,e){return Hit(t.getDate(),e,2)}function vat(t,e){return Hit(t.getHours(),e,2)}function yat(t,e){return Hit(t.getHours()%12||12,e,2)}function bat(t,e){return Hit(1+Tit.count(Fit(t),t),e,3)}function xat(t,e){return Hit(t.getMilliseconds(),e,3)}function wat(t,e){return xat(t,e)+"000"}function kat(t,e){return Hit(t.getMonth()+1,e,2)}function _at(t,e){return Hit(t.getMinutes(),e,2)}function Aat(t,e){return Hit(t.getSeconds(),e,2)}function Cat(t){var e=t.getDay();return 0===e?7:e}function Sat(t,e){return Hit(xit.count(Fit(t)-1,t),e,2)}function Eat(t){var e=t.getDay();return e>=4||0===e?Ait(t):Ait.ceil(t)}function Tat(t,e){return t=Eat(t),Hit(Ait.count(Fit(t),t)+(4===Fit(t).getDay()),e,2)}function Nat(t){return t.getDay()}function Fat(t,e){return Hit(wit.count(Fit(t)-1,t),e,2)}function Dat(t,e){return Hit(t.getFullYear()%100,e,2)}function Iat(t,e){return Hit((t=Eat(t)).getFullYear()%100,e,2)}function Mat(t,e){return Hit(t.getFullYear()%1e4,e,4)}function Oat(t,e){var n=t.getDay();return Hit((t=n>=4||0===n?Ait(t):Ait.ceil(t)).getFullYear()%1e4,e,4)}function Rat(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Hit(e/60|0,"0",2)+Hit(e%60,"0",2)}function zat(t,e){return Hit(t.getUTCDate(),e,2)}function Bat(t,e){return Hit(t.getUTCHours(),e,2)}function Lat(t,e){return Hit(t.getUTCHours()%12||12,e,2)}function Pat(t,e){return Hit(1+yit.count(Iit(t),t),e,3)}function jat(t,e){return Hit(t.getUTCMilliseconds(),e,3)}function Uat(t,e){return jat(t,e)+"000"}function Wat(t,e){return Hit(t.getUTCMonth()+1,e,2)}function Vat(t,e){return Hit(t.getUTCMinutes(),e,2)}function qat(t,e){return Hit(t.getUTCSeconds(),e,2)}function Gat(t){var e=t.getUTCDay();return 0===e?7:e}function Hat(t,e){return Hit(lit.count(Iit(t)-1,t),e,2)}function Yat(t){var e=t.getUTCDay();return e>=4||0===e?pit(t):pit.ceil(t)}function Xat(t,e){return t=Yat(t),Hit(pit.count(Iit(t),t)+(4===Iit(t).getUTCDay()),e,2)}function Kat(t){return t.getUTCDay()}function Qat(t,e){return Hit(hit.count(Iit(t)-1,t),e,2)}function Zat(t,e){return Hit(t.getUTCFullYear()%100,e,2)}function $at(t,e){return Hit((t=Yat(t)).getUTCFullYear()%100,e,2)}function Jat(t,e){return Hit(t.getUTCFullYear()%1e4,e,4)}function tot(t,e){var n=t.getUTCDay();return Hit((t=n>=4||0===n?pit(t):pit.ceil(t)).getUTCFullYear()%1e4,e,4)}function eot(){return"+0000"}function not(){return"%"}function rot(t){return+t}function iot(t){return Math.floor(+t/1e3)}function aot(t){const e={};return n=>e[n]||(e[n]=t(n))}function oot(t){const e=aot(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(t){const n=grt(t||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(t,e){return n=>{const r=t(n),i=r.indexOf(e);if(i<0)return r;let a=function(t,e){let n,r=t.lastIndexOf("e");if(r>0)return r;for(r=t.length;--r>e;)if(n=t.charCodeAt(r),n>=48&&n<=57)return r+1}(r,i);const o=a<r.length?r.slice(a):"";for(;--a>i;)if("0"!==r[a]){++a;break}return r.slice(0,a)+o}}(e(n),e(".1f")(1)[1])}return e(n)},formatSpan(t,r,i,a){a=grt(null==a?",f":a);const o=HS(t,r,i),s=Math.max(Math.abs(t),Math.abs(r));let c;if(null==a.precision)switch(a.type){case"s":return isNaN(c=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(yrt(e)/3)))-yrt(Math.abs(t)))}(o,s))||(a.precision=c),n(a,s);case"":case"e":case"g":case"p":case"r":isNaN(c=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,yrt(e)-yrt(t))+1}(o,s))||(a.precision=c-("e"===a.type));break;case"f":case"%":isNaN(c=function(t){return Math.max(0,-yrt(Math.abs(t)))}(o))||(a.precision=c-2*("%"===a.type))}return e(a)}}}let sot,cot;function uot(){return sot=oot({format:_rt,formatPrefix:Art})}function lot(t){return oot(Ert(t))}function hot(t){return arguments.length?sot=lot(t):sot}function dot(t,e,n){Rrt(n=n||{})||Irt("Invalid time multi-format specifier: ".concat(n));const r=e(Yrt),i=e(Hrt),a=e(Grt),o=e(Wrt),s=e(Urt),c=e(jrt),u=e(Prt),l=e(Lrt),h=t(n[Xrt]||".%L"),d=t(n[Yrt]||":%S"),f=t(n[Hrt]||"%I:%M"),p=t(n[Grt]||"%I %p"),g=t(n[Wrt]||n[Vrt]||"%a %d"),m=t(n[Urt]||"%b %d"),v=t(n[jrt]||"%B"),y=t(n[Prt]||"%B"),b=t(n[Lrt]||"%Y");return t=>(r(t)<t?h:i(t)<t?d:a(t)<t?f:o(t)<t?p:c(t)<t?s(t)<t?g:m:l(t)<t?u(t)<t?v:y:b)(t)}function fot(t){const e=aot(t.format),n=aot(t.utcFormat);return{timeFormat:t=>Brt(t)?e(t):dot(e,Zrt,t),utcFormat:t=>Brt(t)?n(t):dot(n,$rt,t),timeParse:aot(t.parse),utcParse:aot(t.utcParse)}}function pot(){return cot=fot({format:Lit,parse:Pit,utcFormat:jit,utcParse:Uit})}function got(t){return fot(zit(t))}function mot(t){return arguments.length?cot=got(t):cot}!function(t){Bit=zit(t),Lit=Bit.format,Pit=Bit.parse,jit=Bit.utcFormat,Uit=Bit.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),uot(),pot();const vot=(t,e)=>zrt({},t,e);function yot(t,e){const n=t?lot(t):hot(),r=e?got(e):mot();return vot(n,r)}function bot(t,e){const n=arguments.length;return n&&2!==n&&Irt("defaultLocale expects either zero or two arguments."),n?vot(hot(t),mot(e)):vot(hot(),mot())}function xot(){return uot(),pot(),bot()}function wot(t,e,n){return t.fields=e||[],t.fname=n,t}function kot(t){return 1===t.length?_ot(t[0]):Aot(t)}const _ot=t=>function(e){return e[t]},Aot=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function Cot(t){throw Error(t)}function Sot(t){const e=[],n=t.length;let r,i,a,o=null,s=0,c="";function u(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)c+=t.substring(r,i++),r=i;else if(a===o)u(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&u(),s=r=i+1):"]"===a&&(s||Cot("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&Cot("Access path missing closing bracket: "+t),o&&Cot("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function Eot(t,e,n){const r=Sot(t);return t=1===r.length?r[0]:t,wot((n&&n.get||kot)(r),[t],e||t)}Eot("id");const Tot=wot((t=>t),[],"identity"),Not=(wot((()=>0),[],"zero"),wot((()=>1),[],"one"),wot((()=>!0),[],"true"));wot((()=>!1),[],"false");var Fot=Array.isArray;function Dot(t){return t===Object(t)}function Iot(t){return t[t.length-1]}function Mot(t){return null==t||""===t?null:+t}const Oot=t=>e=>t*Math.exp(e),Rot=t=>e=>Math.log(t*e),zot=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),Bot=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,Lot=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function Pot(t,e,n,r){const i=n(t[0]),a=n(Iot(t)),o=(a-i)*e;return[r(i-o),r(a-o)]}function jot(t,e,n,r,i){const a=r(t[0]),o=r(Iot(t)),s=null!=e?r(e):(a+o)/2;return[i(s+(a-s)*n),i(s+(o-s)*n)]}function Uot(t){return null!=t?Fot(t)?t:[t]:[]}function Wot(t){return"function"===typeof t}function Vot(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const qot=Object.prototype.hasOwnProperty;function Got(t,e){return qot.call(t,e)}function Hot(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),Vot(r,n)}function Yot(t){return"[object Date]"===Object.prototype.toString.call(t)}function Xot(t){return"number"===typeof t}function Kot(t){return"string"===typeof t}function Qot(t,e){let n="";for(;--e>=0;)n+=t;return n}function Zot(t){return Fot(t)?"["+t.map(Zot)+"]":Dot(t)||Kot(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function $ot(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t}const Jot=t=>Xot(t)||Yot(t)?t:Date.parse(t);function tst(t,e){return e=e||Jot,null==t||""===t?null:e(t)}function est(t){return null==t||""===t?null:t+""}function nst(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}const rst="Literal",ist="Property",ast="ArrayExpression",ost="BinaryExpression",sst="CallExpression",cst="ConditionalExpression",ust="LogicalExpression",lst="MemberExpression",hst="ObjectExpression",dst="UnaryExpression";function fst(t){this.type=t}var pst;fst.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=function(t){switch(t.type){case ast:return t.elements;case ost:case ust:return[t.left,t.right];case sst:return[t.callee].concat(t.arguments);case cst:return[t.test,t.consequent,t.alternate];case lst:return[t.object,t.property];case hst:return t.properties;case ist:return[t.key,t.value];case dst:return[t.argument];default:return[]}}(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1};var gst=1,mst=2,vst=3,yst=4,bst=5,xst=6,wst=7,kst=8;(pst={})[gst]="Boolean",pst[mst]="<end>",pst[vst]="Identifier",pst[yst]="Keyword",pst[bst]="Null",pst[xst]="Numeric",pst[wst]="Punctuator",pst[kst]="String",pst[9]="RegularExpression";var _st={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function Ast(t){function e(e,n,r){return i=>function(e,n,r,i){let a=t(n[0]);return r&&(a=r+"("+a+")",0===r.lastIndexOf("new ",0)&&(a="("+a+")")),a+"."+e+(i<0?"":0===i?"()":"("+n.slice(1).map(t).join(",")+")")}(e,i,n,r)}const n="new Date",r="String",i="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(e){e.length<3&&Cot("Missing arguments to clamp function."),e.length>3&&Cot("Too many arguments to clamp function.");const n=e.map(t);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:e("getDate",n,0),day:e("getDay",n,0),year:e("getFullYear",n,0),month:e("getMonth",n,0),hours:e("getHours",n,0),minutes:e("getMinutes",n,0),seconds:e("getSeconds",n,0),milliseconds:e("getMilliseconds",n,0),time:e("getTime",n,0),timezoneoffset:e("getTimezoneOffset",n,0),utcdate:e("getUTCDate",n,0),utcday:e("getUTCDay",n,0),utcyear:e("getUTCFullYear",n,0),utcmonth:e("getUTCMonth",n,0),utchours:e("getUTCHours",n,0),utcminutes:e("getUTCMinutes",n,0),utcseconds:e("getUTCSeconds",n,0),utcmilliseconds:e("getUTCMilliseconds",n,0),length:e("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:e("toUpperCase",r,0),lower:e("toLowerCase",r,0),substring:e("substring",r),split:e("split",r),trim:e("trim",r,0),regexp:i,test:e("test",i),if:function(e){e.length<3&&Cot("Missing arguments to if function."),e.length>3&&Cot("Too many arguments to if function.");const n=e.map(t);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}var Cst,Sst,Est,Tst,Nst,Fst,Dst,Ist,Mst,Ost,Rst,zst,Bst,Lst,Pst,jst,Ust=new W3,Wst=new W3,Vst={point:V3,lineStart:V3,lineEnd:V3,polygonStart:function(){Ust=new W3,Vst.lineStart=qst,Vst.lineEnd=Gst},polygonEnd:function(){var t=+Ust;Wst.add(t<0?ND+t:t),this.lineStart=this.lineEnd=this.point=V3},sphere:function(){Wst.add(ND)}};function qst(){Vst.point=Hst}function Gst(){Yst(Cst,Sst)}function Hst(t,e){Vst.point=Yst,Cst=t,Sst=e,Est=t*=DD,Tst=RD(e=(e*=DD)/2+TD),Nst=UD(e)}function Yst(t,e){var n=(t*=DD)-Est,r=n>=0?1:-1,i=r*n,a=RD(e=(e*=DD)/2+TD),o=UD(e),s=Nst*o,c=Tst*a+s*RD(i),u=s*r*UD(i);Ust.add(OD(u,c)),Est=t,Tst=a,Nst=o}var Xst,Kst,Qst,Zst,$st,Jst,tct,ect,nct,rct,ict,act,oct,sct,cct,uct,lct={point:hct,lineStart:fct,lineEnd:pct,polygonStart:function(){lct.point=gct,lct.lineStart=mct,lct.lineEnd=vct,Lst=new W3,Vst.polygonStart()},polygonEnd:function(){Vst.polygonEnd(),lct.point=hct,lct.lineStart=fct,lct.lineEnd=pct,Ust<0?(Fst=-(Ist=180),Dst=-(Mst=90)):Lst>AD?Mst=90:Lst<-AD&&(Dst=-90),jst[0]=Fst,jst[1]=Ist},sphere:function(){Fst=-(Ist=180),Dst=-(Mst=90)}};function hct(t,e){Pst.push(jst=[Fst=t,Ist=t]),e<Dst&&(Dst=e),e>Mst&&(Mst=e)}function dct(t,e){var n=$4([t*DD,e*DD]);if(Bst){var r=t7(Bst,n),i=t7([r[1],-r[0],0],r);r7(i),i=Z4(i);var a,o=t-Ost,s=o>0?1:-1,c=i[0]*FD*s,u=ID(o)>180;u^(s*Ost<c&&c<s*t)?(a=i[1]*FD)>Mst&&(Mst=a):u^(s*Ost<(c=(c+360)%360-180)&&c<s*t)?(a=-i[1]*FD)<Dst&&(Dst=a):(e<Dst&&(Dst=e),e>Mst&&(Mst=e)),u?t<Ost?yct(Fst,t)>yct(Fst,Ist)&&(Ist=t):yct(t,Ist)>yct(Fst,Ist)&&(Fst=t):Ist>=Fst?(t<Fst&&(Fst=t),t>Ist&&(Ist=t)):t>Ost?yct(Fst,t)>yct(Fst,Ist)&&(Ist=t):yct(t,Ist)>yct(Fst,Ist)&&(Fst=t)}else Pst.push(jst=[Fst=t,Ist=t]);e<Dst&&(Dst=e),e>Mst&&(Mst=e),Bst=n,Ost=t}function fct(){lct.point=dct}function pct(){jst[0]=Fst,jst[1]=Ist,lct.point=hct,Bst=null}function gct(t,e){if(Bst){var n=t-Ost;Lst.add(ID(n)>180?n+(n>0?360:-360):n)}else Rst=t,zst=e;Vst.point(t,e),dct(t,e)}function mct(){Vst.lineStart()}function vct(){gct(Rst,zst),Vst.lineEnd(),ID(Lst)>AD&&(Fst=-(Ist=180)),jst[0]=Fst,jst[1]=Ist,Bst=null}function yct(t,e){return(e-=t)<0?e+360:e}function bct(t,e){return t[0]-e[0]}function xct(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var wct={sphere:V3,point:kct,lineStart:Act,lineEnd:Ect,polygonStart:function(){wct.lineStart=Tct,wct.lineEnd=Nct},polygonEnd:function(){wct.lineStart=Act,wct.lineEnd=Ect}};function kct(t,e){t*=DD;var n=RD(e*=DD);_ct(n*RD(t),n*UD(t),UD(e))}function _ct(t,e,n){++Xst,Qst+=(t-Qst)/Xst,Zst+=(e-Zst)/Xst,$st+=(n-$st)/Xst}function Act(){wct.point=Cct}function Cct(t,e){t*=DD;var n=RD(e*=DD);sct=n*RD(t),cct=n*UD(t),uct=UD(e),wct.point=Sct,_ct(sct,cct,uct)}function Sct(t,e){t*=DD;var n=RD(e*=DD),r=n*RD(t),i=n*UD(t),a=UD(e),o=OD(VD((o=cct*a-uct*i)*o+(o=uct*r-sct*a)*o+(o=sct*i-cct*r)*o),sct*r+cct*i+uct*a);Kst+=o,Jst+=o*(sct+(sct=r)),tct+=o*(cct+(cct=i)),ect+=o*(uct+(uct=a)),_ct(sct,cct,uct)}function Ect(){wct.point=kct}function Tct(){wct.point=Fct}function Nct(){Dct(act,oct),wct.point=kct}function Fct(t,e){act=t,oct=e,t*=DD,e*=DD,wct.point=Dct;var n=RD(e);sct=n*RD(t),cct=n*UD(t),uct=UD(e),_ct(sct,cct,uct)}function Dct(t,e){t*=DD;var n=RD(e*=DD),r=n*RD(t),i=n*UD(t),a=UD(e),o=cct*a-uct*i,s=uct*r-sct*a,c=sct*i-cct*r,u=LD(o,s,c),l=HD(u),h=u&&-l/u;nct.add(h*o),rct.add(h*s),ict.add(h*c),Kst+=l,Jst+=l*(sct+(sct=r)),tct+=l*(cct+(cct=i)),ect+=l*(uct+(uct=a)),_ct(sct,cct,uct)}function Ict(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Mct(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Oct(t){let e,n,r;function i(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<0?i=e+1:a=e}while(i<a)}return i}return 2!==t.length?(e=Ict,n=(e,n)=>Ict(t(e),n),r=(e,n)=>t(e)-n):(e=t===Ict||t===Mct?t:Rct,n=t,r=t),{left:i,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=i(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return a>n&&r(t[a-1],e)>-r(t[a],e)?a-1:a},right:function(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<=0?i=e+1:a=e}while(i<a)}return i}}}function Rct(){return 0}const zct=Oct(Ict),Bct=zct.right,Lct=(zct.left,Oct((function(t){return null===t?NaN:+t})).center,Bct);function Pct(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function jct(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Uct(){}var Wct=.7,Vct=1.4285714285714286,qct="\\s*([+-]?\\d+)\\s*",Gct="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Hct="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Yct=/^#([0-9a-f]{3,8})$/,Xct=new RegExp("^rgb\\(".concat(qct,",").concat(qct,",").concat(qct,"\\)$")),Kct=new RegExp("^rgb\\(".concat(Hct,",").concat(Hct,",").concat(Hct,"\\)$")),Qct=new RegExp("^rgba\\(".concat(qct,",").concat(qct,",").concat(qct,",").concat(Gct,"\\)$")),Zct=new RegExp("^rgba\\(".concat(Hct,",").concat(Hct,",").concat(Hct,",").concat(Gct,"\\)$")),$ct=new RegExp("^hsl\\(".concat(Gct,",").concat(Hct,",").concat(Hct,"\\)$")),Jct=new RegExp("^hsla\\(".concat(Gct,",").concat(Hct,",").concat(Hct,",").concat(Gct,"\\)$")),tut={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function eut(){return this.rgb().formatHex()}function nut(){return this.rgb().formatRgb()}function rut(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Yct.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?iut(e):3===n?new cut(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?aut(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?aut(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Xct.exec(t))?new cut(e[1],e[2],e[3],1):(e=Kct.exec(t))?new cut(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Qct.exec(t))?aut(e[1],e[2],e[3],e[4]):(e=Zct.exec(t))?aut(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=$ct.exec(t))?put(e[1],e[2]/100,e[3]/100,1):(e=Jct.exec(t))?put(e[1],e[2]/100,e[3]/100,e[4]):tut.hasOwnProperty(t)?iut(tut[t]):"transparent"===t?new cut(NaN,NaN,NaN,0):null}function iut(t){return new cut(t>>16&255,t>>8&255,255&t,1)}function aut(t,e,n,r){return r<=0&&(t=e=n=NaN),new cut(t,e,n,r)}function out(t){return t instanceof Uct||(t=rut(t)),t?new cut((t=t.rgb()).r,t.g,t.b,t.opacity):new cut}function sut(t,e,n,r){return 1===arguments.length?out(t):new cut(t,e,n,null==r?1:r)}function cut(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function uut(){return"#".concat(fut(this.r)).concat(fut(this.g)).concat(fut(this.b))}function lut(){const t=hut(this.opacity);return"".concat(1===t?"rgb(":"rgba(").concat(dut(this.r),", ").concat(dut(this.g),", ").concat(dut(this.b)).concat(1===t?")":", ".concat(t,")"))}function hut(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function dut(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function fut(t){return((t=dut(t))<16?"0":"")+t.toString(16)}function put(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new vut(t,e,n,r)}function gut(t){if(t instanceof vut)return new vut(t.h,t.s,t.l,t.opacity);if(t instanceof Uct||(t=rut(t)),!t)return new vut;if(t instanceof vut)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new vut(o,s,c,t.opacity)}function mut(t,e,n,r){return 1===arguments.length?gut(t):new vut(t,e,n,null==r?1:r)}function vut(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function yut(t){return(t=(t||0)%360)<0?t+360:t}function but(t){return Math.max(0,Math.min(1,t||0))}function xut(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function wut(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}function kut(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,s=r<e-1?t[r+2]:2*a-i;return wut((n-r/e)*e,o,i,a,s)}}function _ut(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],s=t[(r+2)%e];return wut((n-r/e)*e,i,a,o,s)}}Pct(Uct,rut,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:eut,formatHex:eut,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return gut(this).formatHsl()},formatRgb:nut,toString:nut}),Pct(cut,sut,jct(Uct,{brighter(t){return t=null==t?Vct:Math.pow(Vct,t),new cut(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?Wct:Math.pow(Wct,t),new cut(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new cut(dut(this.r),dut(this.g),dut(this.b),hut(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:uut,formatHex:uut,formatHex8:function(){return"#".concat(fut(this.r)).concat(fut(this.g)).concat(fut(this.b)).concat(fut(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:lut,toString:lut})),Pct(vut,mut,jct(Uct,{brighter(t){return t=null==t?Vct:Math.pow(Vct,t),new vut(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Wct:Math.pow(Wct,t),new vut(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new cut(xut(t>=240?t-240:t+120,i,r),xut(t,i,r),xut(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new vut(yut(this.h),but(this.s),but(this.l),hut(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=hut(this.opacity);return"".concat(1===t?"hsl(":"hsla(").concat(yut(this.h),", ").concat(100*but(this.s),"%, ").concat(100*but(this.l),"%").concat(1===t?")":", ".concat(t,")"))}}));const Aut=t=>()=>t;function Cut(t,e){return function(n){return t+n*e}}function Sut(t,e){var n=e-t;return n?Cut(t,n>180||n<-180?n-360*Math.round(n/360):n):Aut(isNaN(t)?e:t)}function Eut(t){return 1===(t=+t)?Tut:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Aut(isNaN(e)?n:e)}}function Tut(t,e){var n=e-t;return n?Cut(t,n):Aut(isNaN(t)?e:t)}const Nut=function t(e){var n=Eut(e);function r(t,e){var r=n((t=sut(t)).r,(e=sut(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=Tut(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function Fut(t){return function(e){var n,r,i=e.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=sut(e[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=t(a),o=t(o),s=t(s),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=s(t),r+""}}}var Dut=Fut(kut),Iut=Fut(_ut);function Mut(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(a){for(n=0;n<r;++n)i[n]=t[n]*(1-a)+e[n]*a;return i}}function Out(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Rut(t,e){return(Out(e)?Mut:zut)(t,e)}function zut(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=Vut(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}function But(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Lut(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Put(t,e){var n,r={},i={};for(n in null!==t&&"object"===typeof t||(t={}),null!==e&&"object"===typeof e||(e={}),e)n in t?r[n]=Vut(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var jut=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Uut=new RegExp(jut.source,"g");function Wut(t,e){var n,r,i,a=jut.lastIndex=Uut.lastIndex=0,o=-1,s=[],c=[];for(t+="",e+="";(n=jut.exec(t))&&(r=Uut.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,c.push({i:o,x:Lut(n,r)})),a=Uut.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?c[0]?function(t){return function(e){return t(e)+""}}(c[0].x):function(t){return function(){return t}}(e):(e=c.length,function(t){for(var n,r=0;r<e;++r)s[(n=c[r]).i]=n.x(t);return s.join("")})}function Vut(t,e){var n,r=typeof e;return null==e||"boolean"===r?Aut(e):("number"===r?Lut:"string"===r?(n=rut(e))?(e=n,Nut):Wut:e instanceof rut?Nut:e instanceof Date?But:Out(e)?Mut:Array.isArray(e)?zut:"function"!==typeof e.valueOf&&"function"!==typeof e.toString||isNaN(e)?Put:Lut)(t,e)}function qut(t,e){void 0===e&&(e=t,t=Vut);for(var n=0,r=e.length-1,i=e[0],a=new Array(r<0?0:r);n<r;)a[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return a[e](t-e)}}function Gut(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function Hut(t,e){var n=Sut(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}}function Yut(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Xut,Kut=180/Math.PI,Qut={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Zut(t,e,n,r,i,a){var o,s,c;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),t*r<e*n&&(t=-t,e=-e,c=-c,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*Kut,skewX:Math.atan(c)*Kut,scaleX:o,scaleY:s}}function $ut(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var s=[],c=[];return a=t(a),o=t(o),function(t,r,i,a,o,s){if(t!==i||r!==a){var c=o.push("translate(",null,e,null,n);s.push({i:c-4,x:Lut(t,i)},{i:c-2,x:Lut(r,a)})}else(i||a)&&o.push("translate("+i+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,c),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Lut(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(a.rotate,o.rotate,s,c),function(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Lut(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(a.skewX,o.skewX,s,c),function(t,e,n,r,a,o){if(t!==n||e!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:Lut(t,n)},{i:s-2,x:Lut(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,c),a=o=null,function(t){for(var e,n=-1,r=c.length;++n<r;)s[(e=c[n]).i]=e.x(t);return s.join("")}}}var Jut=$ut((function(t){const e=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Qut:Zut(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),tlt=$ut((function(t){return null==t?Qut:(Xut||(Xut=document.createElementNS("http://www.w3.org/2000/svg","g")),Xut.setAttribute("transform",t),(t=Xut.transform.baseVal.consolidate())?Zut((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Qut)}),", ",")",")");function elt(t){return((t=Math.exp(t))+1/t)/2}const nlt=function t(e,n,r){function i(t,i){var a,o,s=t[0],c=t[1],u=t[2],l=i[0],h=i[1],d=i[2],f=l-s,p=h-c,g=f*f+p*p;if(g<1e-12)o=Math.log(d/u)/e,a=function(t){return[s+t*f,c+t*p,u*Math.exp(e*t*o)]};else{var m=Math.sqrt(g),v=(d*d-u*u+r*g)/(2*u*n*m),y=(d*d-u*u-r*g)/(2*d*n*m),b=Math.log(Math.sqrt(v*v+1)-v),x=Math.log(Math.sqrt(y*y+1)-y);o=(x-b)/e,a=function(t){var r=t*o,i=elt(b),a=u/(n*m)*(i*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(e*r+b)-function(t){return((t=Math.exp(t))-1/t)/2}(b));return[s+a*f,c+a*p,u*i/elt(e*r+b)]}}return a.duration=1e3*o*e/Math.SQRT2,a}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i}(Math.SQRT2,2,4);function rlt(t){return function(e,n){var r=t((e=mut(e)).h,(n=mut(n)).h),i=Tut(e.s,n.s),a=Tut(e.l,n.l),o=Tut(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=a(t),e.opacity=o(t),e+""}}}const ilt=rlt(Sut);var alt=rlt(Tut);const olt=Math.PI/180,slt=180/Math.PI,clt=.96422,ult=1,llt=.82521,hlt=4/29,dlt=6/29,flt=.12841854934601665,plt=.008856451679035631;function glt(t){if(t instanceof vlt)return new vlt(t.l,t.a,t.b,t.opacity);if(t instanceof Alt)return Clt(t);t instanceof cut||(t=out(t));var e,n,r=wlt(t.r),i=wlt(t.g),a=wlt(t.b),o=ylt((.2225045*r+.7168786*i+.0606169*a)/ult);return r===i&&i===a?e=n=o:(e=ylt((.4360747*r+.3850649*i+.1430804*a)/clt),n=ylt((.0139322*r+.0971045*i+.7141733*a)/llt)),new vlt(116*o-16,500*(e-o),200*(o-n),t.opacity)}function mlt(t,e,n,r){return 1===arguments.length?glt(t):new vlt(t,e,n,null==r?1:r)}function vlt(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function ylt(t){return t>plt?Math.pow(t,1/3):t/flt+hlt}function blt(t){return t>dlt?t*t*t:flt*(t-hlt)}function xlt(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function wlt(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function klt(t){if(t instanceof Alt)return new Alt(t.h,t.c,t.l,t.opacity);if(t instanceof vlt||(t=glt(t)),0===t.a&&0===t.b)return new Alt(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*slt;return new Alt(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function _lt(t,e,n,r){return 1===arguments.length?klt(t):new Alt(t,e,n,null==r?1:r)}function Alt(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function Clt(t){if(isNaN(t.h))return new vlt(t.l,0,0,t.opacity);var e=t.h*olt;return new vlt(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function Slt(t,e){var n=Tut((t=mlt(t)).l,(e=mlt(e)).l),r=Tut(t.a,e.a),i=Tut(t.b,e.b),a=Tut(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=a(e),t+""}}function Elt(t){return function(e,n){var r=t((e=_lt(e)).h,(n=_lt(n)).h),i=Tut(e.c,n.c),a=Tut(e.l,n.l),o=Tut(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=a(t),e.opacity=o(t),e+""}}}Pct(vlt,mlt,jct(Uct,{brighter(t){return new vlt(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker(t){return new vlt(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new cut(xlt(3.1338561*(e=clt*blt(e))-1.6168667*(t=ult*blt(t))-.4906146*(n=llt*blt(n))),xlt(-.9787684*e+1.9161415*t+.033454*n),xlt(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Pct(Alt,_lt,jct(Uct,{brighter(t){return new Alt(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker(t){return new Alt(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb(){return Clt(this).rgb()}}));const Tlt=Elt(Sut);var Nlt=Elt(Tut),Flt=-.14861,Dlt=1.78277,Ilt=-.29227,Mlt=-.90649,Olt=1.97294,Rlt=Olt*Mlt,zlt=Olt*Dlt,Blt=Dlt*Ilt-Mlt*Flt;function Llt(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof Plt)return new Plt(t.h,t.s,t.l,t.opacity);t instanceof cut||(t=out(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(Blt*r+Rlt*e-zlt*n)/(Blt+Rlt-zlt),a=r-i,o=(Olt*(n-i)-Ilt*a)/Mlt,s=Math.sqrt(o*o+a*a)/(Olt*i*(1-i)),c=s?Math.atan2(o,a)*slt-120:NaN;return new Plt(c<0?c+360:c,s,i,t.opacity)}(t):new Plt(t,e,n,null==r?1:r)}function Plt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function jlt(t){return function e(n){function r(e,r){var i=t((e=Llt(e)).h,(r=Llt(r)).h),a=Tut(e.s,r.s),o=Tut(e.l,r.l),s=Tut(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=a(t),e.l=o(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}Pct(Plt,Llt,jct(Uct,{brighter(t){return t=null==t?Vct:Math.pow(Vct,t),new Plt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Wct:Math.pow(Wct,t),new Plt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*olt,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new cut(255*(e+n*(Flt*r+Dlt*i)),255*(e+n*(Ilt*r+Mlt*i)),255*(e+n*(Olt*r)),this.opacity)}}));const Ult=jlt(Sut);var Wlt=jlt(Tut);function Vlt(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}const qlt="year",Glt="quarter",Hlt="month",Ylt="week",Xlt="date",Klt="day",Qlt="dayofyear",Zlt="hours",$lt="minutes",Jlt="seconds",tht="milliseconds",eht=[qlt,Glt,Hlt,Ylt,Xlt,Klt,Qlt,Zlt,$lt,Jlt,tht].reduce(((t,e,n)=>(t[e]=1+n,t)),{});const nht={[qlt]:"%Y ",[Glt]:"Q%q ",[Hlt]:"%b ",[Xlt]:"%d ",[Ylt]:"W%U ",[Klt]:"%a ",[Qlt]:"%j ",[Zlt]:"%H:00",[$lt]:"00:%M",[Jlt]:":%S",[tht]:".%L",["".concat(qlt,"-").concat(Hlt)]:"%Y-%m ",["".concat(qlt,"-").concat(Hlt,"-").concat(Xlt)]:"%Y-%m-%d ",["".concat(Zlt,"-").concat($lt)]:"%H:%M"};const rht=new Date;function iht(t){return rht.setFullYear(t),rht.setMonth(0),rht.setDate(1),rht.setHours(0,0,0,0),rht}function aht(t){return Zr.count(iht(t.getFullYear())-1,t)}function oht(t){return ei.count(iht(t.getFullYear())-1,t)}function sht(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return $r.count(e-1,t)}function cht(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return ui.count(e-1,t)}const uht={[qlt]:mi,[Glt]:yi.every(3),[Hlt]:yi,[Ylt]:ei,[Xlt]:Zr,[Klt]:Zr,[Qlt]:Zr,[Zlt]:xi,[$lt]:ki,[Jlt]:Ai,[tht]:Ci},lht={[qlt]:vi,[Glt]:bi.every(3),[Hlt]:bi,[Ylt]:ui,[Xlt]:$r,[Klt]:$r,[Qlt]:$r,[Zlt]:wi,[$lt]:_i,[Jlt]:Ai,[tht]:Ci};function hht(t){return uht[t]}function dht(t){return lht[t]}function fht(t,e,n){return t?t.offset(e,n):void 0}function pht(t,e,n,r){return t?t.range(e,n,r):void 0}const ght=[qlt,Hlt,Xlt,Zlt,$lt,Jlt,tht],mht=ght.slice(0,-1),vht=mht.slice(0,-1),yht=vht.slice(0,-1);yht.slice(0,-1);function bht(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0}const xht="linear",wht="log",kht="pow",_ht="sqrt",Aht="symlog",Cht="time",Sht="utc",Eht="sequential",Tht="diverging",Nht="quantile",Fht="quantize",Dht="threshold",Iht="continuous",Mht="discrete",Oht="discretizing",Rht="interpolating",zht="temporal";function Bht(){const t=jg().unknown(void 0),e=t.domain,n=t.range;let r,i,a=[0,1],o=!1,s=0,c=0,u=.5;function l(){const t=e().length,l=a[1]<a[0],h=a[1-l],d=bht(t,s,c);let f=a[l-0];r=(h-f)/(d||1),o&&(r=Math.floor(r)),f+=(h-f-r*(t-s))*u,i=r*(1-s),o&&(f=Math.round(f),i=Math.round(i));const p=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a}(t).map((t=>f+r*t));return n(l?p.reverse():p)}return delete t.unknown,t.domain=function(t){return arguments.length?(e(t),l()):e()},t.range=function(t){return arguments.length?(a=[+t[0],+t[1]],l()):a.slice()},t.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,l()},t.bandwidth=function(){return i},t.step=function(){return r},t.round=function(t){return arguments.length?(o=!!t,l()):o},t.padding=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),s=c,l()):s},t.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),l()):s},t.paddingOuter=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),l()):c},t.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),l()):u},t.invertRange=function(t){if(null==t[0]||null==t[1])return;const r=a[1]<a[0],o=r?n().reverse():n(),s=o.length-1;let c,u,l,h=+t[0],d=+t[1];return h!==h||d!==d||(d<h&&(l=h,h=d,d=l),d<o[0]||h>a[1-r])?void 0:(c=Math.max(0,Bct(o,h)-1),u=h===d?c:Bct(o,d)-1,h-o[c]>i+1e-10&&++c,r&&(l=c,c=s-u,u=s-l),c>u?void 0:e().slice(c,u+1))},t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return Bht().domain(e()).range(a).round(o).paddingInner(s).paddingOuter(c).align(u)},l()}function Lht(t){const e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return Lht(e())},t}var Pht=Array.prototype.map;const jht=Array.prototype.slice;const Uht=new Map,Wht=Symbol("vega_scale");function Vht(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){let n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){const n=t.range();let r,i,a,o,s=e[0],c=e[1],u=-1;for(c<s&&(i=s,s=c,c=i),a=0,o=n.length;a<o;++a)n[a]>=s&&n[a]<=c&&(u<0&&(u=a),r=a);if(!(u<0))return s=t.invertExtent(n[u]),c=t.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===c[1]?c[0]:c[1]]}}(n):void 0),n.type=t,function(t){return t[Wht]=!0,t}(n)};return r.metadata=nst(Uot(n)),r}function qht(t,e,n){return arguments.length>1?(Uht.set(t,Vht(t,e,n)),this):function(t){return Uht.has(t)}(t)?Uht.get(t):void 0}function Ght(t,e){const n=Uht.get(t);return n&&n.metadata[e]}function Hht(t){return Ght(t,Mht)}qht("identity",Ip),qht(xht,Dp,Iht),qht(wht,Up,[Iht,wht]),qht(kht,Hp,Iht),qht(_ht,Yp,Iht),qht(Aht,Zp,Iht),qht(Cht,gg,[Iht,zht]),qht(Sht,mg,[Iht,zht]),qht(Eht,bg,[Iht,Rht]),qht("".concat(Eht,"-").concat(xht),bg,[Iht,Rht]),qht("".concat(Eht,"-").concat(wht),xg,[Iht,Rht,wht]),qht("".concat(Eht,"-").concat(kht),kg,[Iht,Rht]),qht("".concat(Eht,"-").concat(_ht),_g,[Iht,Rht]),qht("".concat(Eht,"-").concat(Aht),wg,[Iht,Rht]),qht("".concat(Tht,"-").concat(xht),Cg,[Iht,Rht]),qht("".concat(Tht,"-").concat(wht),Sg,[Iht,Rht,wht]),qht("".concat(Tht,"-").concat(kht),Tg,[Iht,Rht]),qht("".concat(Tht,"-").concat(_ht),Ng,[Iht,Rht]),qht("".concat(Tht,"-").concat(Aht),Eg,[Iht,Rht]),qht(Nht,Dg,[Oht,Nht]),qht(Fht,Ig,Oht),qht(Dht,Mg,Oht),qht("bin-ordinal",(function t(){let e=[],n=[];function r(t){return null==t||t!==t?void 0:n[(Lct(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=function(t){return Pht.call(t,Mot)}(t),r):e.slice()},r.range=function(t){return arguments.length?(n=jht.call(t),r):n.slice()},r.tickFormat=function(t,n){return Np(e[0],Iot(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}),[Mht,Oht]),qht("ordinal",jg,Mht),qht("band",Bht,Mht),qht("point",(function(){return Lht(Bht().paddingInner(1))}),Mht);const Yht=["clamp","base","constant","exponent"];function Xht(t,e,n){return qut(function(t,e){const n=b[function(t){return"interpolate"+t.toLowerCase().split("-").map((t=>t[0].toUpperCase()+t.slice(1))).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}(e||"rgb",n),t)}function Kht(t,e,n){const r=n-e;let i,a,o;return r&&Number.isFinite(r)?(i=(a=t.type).indexOf("-"),a=i<0?a:a.slice(i+1),o=qht(a)().domain([e,n]).range([0,1]),Yht.forEach((e=>t[e]?o[e](t[e]()):0)),o):Wot(s=.5)?s:()=>s;var s}function Qht(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function Zht(t,e){for(const n in t)Jht(n,e(t[n]))}const $ht={};function Jht(t,e){return t=t&&t.toLowerCase(),arguments.length>1?($ht[t]=e,this):$ht[t]}Zht({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},Qht),Zht({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(t=>Xht(Qht(t))));const tdt="symbol",edt="discrete",ndt=t=>Fot(t)?t.map((t=>String(t))):String(t),rdt=(t,e)=>t[1]-e[1],idt=(t,e)=>e[1]-t[1];function adt(t,e){return t.bins?function(t,e,n){let r=t.range(),i=r[0],a=Iot(r),o=rdt;if(i>a&&(r=a,a=i,i=r,o=idt),i=Math.floor(i),a=Math.ceil(a),e=e.map((e=>[e,t(e)])).filter((t=>i<=t[1]&&t[1]<=a)).sort(o).map((t=>t[0])),n>0&&e.length>1){const t=[e[0],Iot(e)];for(;e.length>n&&e.length>=3;)e=e.filter(((t,e)=>!(e%2)));e.length<3&&(e=t)}return e}(t,t.bins):t.ticks?t.ticks(e):t.domain()}function odt(t,e,n,r,i,a){const o=e.type;let s=ndt;if(o===Cht||i===Cht)s=t.timeFormat(r);else if(o===Sht||i===Sht)s=t.utcFormat(r);else if(function(t){return Ght(t,wht)}(o)){const i=t.formatFloat(r);if(a||e.bins)s=i;else{const t=sdt(e,n,!1);s=e=>t(e)?i(e):""}}else if(e.tickFormat){const i=e.domain();s=t.formatSpan(i[0],i[i.length-1],n,r)}else r&&(s=t.format(r));return s}function sdt(t,e,n){const r=adt(t,e),i=t.base(),a=Math.log(i),o=Math.max(1,i*e/r.length),s=t=>{let e=t/Math.pow(i,Math.round(Math.log(t)/a));return e*i<i-.5&&(e*=i),e<=o};return n?r.filter(s):s}const cdt={[Nht]:"quantiles",[Fht]:"thresholds",[Dht]:"domain"},udt={[Nht]:"quantiles",[Fht]:"domain"};function ldt(t,e){return t.bins?function(t){const e=t.slice(0,-1);return e.max=Iot(t),e}(t.bins):t.type===wht?sdt(t,e,!0):cdt[t.type]?function(t){const e=[-1/0].concat(t);return e.max=1/0,e}(t[cdt[t.type]]()):adt(t,e)}const hdt=t=>cdt[t.type]||t.bins;function ddt(t,e,n,r,i,a,o){const s=udt[e.type]&&a!==Cht&&a!==Sht?function(t,e,n){const r=e[udt[e.type]](),i=r.length;let a,o=i>1?r[1]-r[0]:r[0];for(a=1;a<i;++a)o=Math.min(o,r[a]-r[a-1]);return t.formatSpan(0,o,30,n)}(t,e,i):odt(t,e,n,i,a,o);return r===tdt&&hdt(e)?fdt(s):r===edt?gdt(s):mdt(s)}const fdt=t=>(e,n,r)=>{const i=pdt(r[n+1],pdt(r.max,1/0)),a=vdt(e,t),o=vdt(i,t);return a&&o?a+" \u2013 "+o:o?"< "+o:"\u2265 "+a},pdt=(t,e)=>null!=t?t:e,gdt=t=>(e,n)=>n?t(e):null,mdt=t=>e=>t(e),vdt=(t,e)=>Number.isFinite(t)?e(t):null;function ydt(t,e,n,r){const i=r||e.type;return Kot(n)&&function(t){return Ght(t,zht)}(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||i!==Cht?n||i!==Sht?ddt(t,e,5,null,n,r,!0):t.utcFormat("%A, %d %B %Y, %X UTC"):t.timeFormat("%A, %d %B %Y, %X")}function bdt(t,e,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=ydt(t,e,n.format,n.formatType);if(function(t){return Ght(t,Oht)}(e.type)){const t=ldt(e).slice(1).map(i),n=t.length;return"".concat(n," boundar").concat(1===n?"y":"ies",": ").concat(t.join(", "))}if(Hht(e.type)){const t=e.domain(),n=t.length,a=n>r?t.slice(0,r-2).map(i).join(", ")+", ending with "+t.slice(-1).map(i):t.map(i).join(", ");return"".concat(n," value").concat(1===n?"":"s",": ").concat(a)}{const t=e.domain();return"values from ".concat(i(t[0])," to ").concat(i(Iot(t)))}}const xdt=Math.sqrt(50),wdt=Math.sqrt(10),kdt=Math.sqrt(2);function _dt(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=xdt?10:a>=wdt?5:a>=kdt?2:1;let s,c,u;return i<0?(u=Math.pow(10,-i)/o,s=Math.round(t*u),c=Math.round(e*u),s/u<t&&++s,c/u>e&&--c,u=-u):(u=Math.pow(10,i)*o,s=Math.round(t/u),c=Math.round(e/u),s*u<t&&++s,c*u>e&&--c),c<s&&.5<=n&&n<2?_dt(t,e,2*n):[s,c,u]}function Adt(t,e,n){return _dt(t=+t,e=+e,n=+n)[2]}function Cdt(t){const e={};return n=>e[n]||(e[n]=t(n))}function Sdt(t){const e=Cdt(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(t){const n=Cr(t||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(t,e){return n=>{const r=t(n),i=r.indexOf(e);if(i<0)return r;let a=function(t,e){let n,r=t.lastIndexOf("e");if(r>0)return r;for(r=t.length;--r>e;)if(n=t.charCodeAt(r),n>=48&&n<=57)return r+1}(r,i);const o=a<r.length?r.slice(a):"";for(;--a>i;)if("0"!==r[a]){++a;break}return r.slice(0,a)+o}}(e(n),e(".1f")(1)[1])}return e(n)},formatSpan(t,r,i,a){a=Cr(null==a?",f":a);const o=function(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?Adt(e,t,n):Adt(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}(t,r,i),s=Math.max(Math.abs(t),Math.abs(r));let c;if(null==a.precision)switch(a.type){case"s":return isNaN(c=Nr(o,s))||(a.precision=c),n(a,s);case"":case"e":case"g":case"p":case"r":isNaN(c=Fr(o,s))||(a.precision=c-("e"===a.type));break;case"f":case"%":isNaN(c=Dr(o))||(a.precision=c-2*("%"===a.type))}return e(a)}}}let Edt,Tdt;function Ndt(){return Edt=Sdt({format:zr,formatPrefix:Br})}function Fdt(t,e,n){Dot(n=n||{})||Cot("Invalid time multi-format specifier: ".concat(n));const r=e(Jlt),i=e($lt),a=e(Zlt),o=e(Xlt),s=e(Ylt),c=e(Hlt),u=e(Glt),l=e(qlt),h=t(n[tht]||".%L"),d=t(n[Jlt]||":%S"),f=t(n[$lt]||"%I:%M"),p=t(n[Zlt]||"%I %p"),g=t(n[Xlt]||n[Klt]||"%a %d"),m=t(n[Ylt]||"%b %d"),v=t(n[Hlt]||"%B"),y=t(n[Glt]||"%B"),b=t(n[qlt]||"%Y");return t=>(r(t)<t?h:i(t)<t?d:a(t)<t?f:o(t)<t?p:c(t)<t?s(t)<t?g:m:l(t)<t?u(t)<t?v:y:b)(t)}function Ddt(t){const e=Cdt(t.format),n=Cdt(t.utcFormat);return{timeFormat:t=>Kot(t)?e(t):Fdt(e,hht,t),utcFormat:t=>Kot(t)?n(t):Fdt(n,dht,t),timeParse:Cdt(t.parse),utcParse:Cdt(t.utcParse)}}function Idt(){return Tdt=Ddt({format:ja,parse:Ua,utcFormat:Wa,utcParse:Va})}Ndt(),Idt();const Mdt=/^(data:|([A-Za-z]+:)?\/\/)/,Odt=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Rdt=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,zdt="file://";async function Bdt(t,e){const n=await this.sanitize(t,e),r=n.href;return n.localFile?this.file(r):this.http(r,e)}async function Ldt(t,e){e=Vot({},this.options,e);const n=this.fileAccess,r={href:null};let i,a,o;const s=Odt.test(t.replace(Rdt,""));null!=t&&"string"===typeof t&&s||Cot("Sanitize failure, invalid URI: "+Zot(t));const c=Mdt.test(t);return(o=e.baseURL)&&!c&&(t.startsWith("/")||o.endsWith("/")||(t="/"+t),t=o+t),a=(i=t.startsWith(zdt))||"file"===e.mode||"http"!==e.mode&&!c&&n,i?t=t.slice(zdt.length):t.startsWith("//")&&("file"===e.defaultProtocol?(t=t.slice(2),a=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(r,"localFile",{value:!!a}),r.href=t,e.target&&(r.target=e.target+""),e.rel&&(r.rel=e.rel+""),"image"===e.context&&e.crossOrigin&&(r.crossOrigin=e.crossOrigin+""),r}function Pdt(t){return t?e=>new Promise(((n,r)=>{t.readFile(e,((t,e)=>{t?r(t):n(e)}))})):jdt}async function jdt(){Cot("No file system access.")}function Udt(t){return t?async function(e,n){const r=Vot({},this.options.http,n),i=n&&n.response,a=await t(e,r);return a.ok?Wot(a[i])?a[i]():a.text():Cot(a.status+""+a.statusText)}:Wdt}async function Wdt(){Cot("No HTTP fetch method available.")}function Vdt(t){const e=function(e,n){const r={delimiter:t};return qdt(e,n?Vot(n,r):r)};return e.responseType="text",e}function qdt(t,e){return e.header&&(t=e.header.map(Zot).join(e.delimiter)+"\n"+t),lr(e.delimiter).parse(t+"")}function Gdt(t,e){const n=e&&e.property?Eot(e.property):Tot;return!Dot(t)||(r=t,"function"===typeof Buffer&&Wot(Buffer.isBuffer)&&Buffer.isBuffer(r))?n(JSON.parse(t)):function(t,e){!Fot(t)&&function(t){return t&&Wot(t[Symbol.iterator])}(t)&&(t=[...t]);return e&&e.copy?JSON.parse(JSON.stringify(t)):t}(n(t),e);var r}qdt.responseType="text",Gdt.responseType="json";const Hdt={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function Ydt(t,e){let n,r,i,a;return t=Gdt(t,e),e&&e.feature?(n=dr,i=e.feature):e&&e.mesh?(n=mr,i=e.mesh,a=Hdt[e.filter]):Cot("Missing TopoJSON feature or mesh parameter."),r=(r=t.objects[i])?n(t,r,a):Cot("Invalid TopoJSON object: "+i),r&&r.features||[r]}Ydt.responseType="json";Vdt(","),Vdt("\t");const Xdt=function(t,e){return n=>({options:n||{},sanitize:Ldt,load:Bdt,fileAccess:!!e,file:Pdt(e),http:Udt(t)})}("undefined"!==typeof fetch&&fetch,null);let Kdt=0;const Qdt="p_";function Zdt(t){return t&&t.gradient}function $dt(t,e,n){const r=t.gradient;let i=t.id,a="radial"===r?Qdt:"";return i||(i=t.id="gradient_"+Kdt++,"radial"===r?(t.x1=Jdt(t.x1,.5),t.y1=Jdt(t.y1,.5),t.r1=Jdt(t.r1,0),t.x2=Jdt(t.x2,.5),t.y2=Jdt(t.y2,.5),t.r2=Jdt(t.r2,.5),a=Qdt):(t.x1=Jdt(t.x1,0),t.y1=Jdt(t.y1,0),t.x2=Jdt(t.x2,1),t.y2=Jdt(t.y2,0))),e[i]=t,"url("+(n||"")+"#"+a+i+")"}function Jdt(t,e){return null!=t?t:e}const tft={basis:{curve:dh},"basis-closed":{curve:gh},"basis-open":{curve:vh},bundle:{curve:bh,tension:"beta",value:.85},cardinal:{curve:kh,tension:"tension",value:0},"cardinal-open":{curve:Ah,tension:"tension",value:0},"cardinal-closed":{curve:Sh,tension:"tension",value:0},"catmull-rom":{curve:Uh,tension:"alpha",value:.5},"catmull-rom-closed":{curve:Vh,tension:"alpha",value:.5},"catmull-rom-open":{curve:Gh,tension:"alpha",value:.5},linear:{curve:Yh},"linear-closed":{curve:Kh},monotone:{horizontal:id,vertical:rd},natural:{curve:sd},step:{curve:ud},"step-after":{curve:hd},"step-before":{curve:ld}};function eft(t,e,n){var r=Got(tft,t)&&tft[t],i=null;return r&&(i=r.curve||r[e||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const nft={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},rft=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,ift=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,aft=/^((\s+,?\s*)|(,\s*))/,oft=/^[01]/;function sft(t){const e=[];return(t.match(rft)||[]).forEach((t=>{let n=t[0];const r=n.toLowerCase(),i=nft[r],a=function(t,e,n){const r=[];for(let i=0;e&&i<n.length;)for(let a=0;a<e;++a){const e="a"!==t||3!==a&&4!==a?ift:oft,o=n.slice(i).match(e);if(null===o)throw Error("Invalid SVG path, incorrect parameter type");i+=o[0].length,r.push(+o[0]);const s=n.slice(i).match(aft);null!==s&&(i+=s[0].length)}return r}(r,i,t.slice(1).trim()),o=a.length;if(o<i||o&&o%i!==0)throw Error("Invalid SVG path, incorrect parameter count");if(e.push([n,...a.slice(0,i)]),o!==i){"m"===r&&(n="M"===n?"L":"l");for(let t=i;t<o;t+=i)e.push([n,...a.slice(t,t+i)])}})),e}const cft=Math.PI/180,uft=Math.PI/2,lft=2*Math.PI,hft=Math.sqrt(3)/2;var dft={},fft={},pft=[].join;function gft(t){const e=pft.call(t);if(fft[e])return fft[e];var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],u=t[7];const l=u*o,h=-c*s,d=c*o,f=u*s,p=Math.cos(i),g=Math.sin(i),m=Math.cos(a),v=Math.sin(a),y=.5*(a-i),b=Math.sin(.5*y),x=8/3*b*b/Math.sin(y),w=n+p-x*g,k=r+g+x*p,_=n+m,A=r+v,C=_+x*v,S=A-x*m;return fft[e]=[l*w+h*k,d*w+f*k,l*C+h*S,d*C+f*S,l*_+h*A,d*_+f*A]}const mft=["l",0,0,0,0,0,0,0];function vft(t,e,n){const r=mft[0]=t[0];if("a"===r||"A"===r)mft[1]=e*t[1],mft[2]=n*t[2],mft[3]=t[3],mft[4]=t[4],mft[5]=t[5],mft[6]=e*t[6],mft[7]=n*t[7];else if("h"===r||"H"===r)mft[1]=e*t[1];else if("v"===r||"V"===r)mft[1]=n*t[1];else for(var i=1,a=t.length;i<a;++i)mft[i]=(i%2==1?e:n)*t[i];return mft}function yft(t,e,n,r,i,a){var o,s,c,u,l,h=null,d=0,f=0,p=0,g=0,m=0,v=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==a&&(a=i),t.beginPath&&t.beginPath();for(var y=0,b=e.length;y<b;++y){switch(o=e[y],1===i&&1===a||(o=vft(o,i,a)),o[0]){case"l":d+=o[1],f+=o[2],t.lineTo(d+n,f+r);break;case"L":d=o[1],f=o[2],t.lineTo(d+n,f+r);break;case"h":d+=o[1],t.lineTo(d+n,f+r);break;case"H":d=o[1],t.lineTo(d+n,f+r);break;case"v":f+=o[1],t.lineTo(d+n,f+r);break;case"V":f=o[1],t.lineTo(d+n,f+r);break;case"m":m=d+=o[1],v=f+=o[2],t.moveTo(d+n,f+r);break;case"M":m=d=o[1],v=f=o[2],t.moveTo(d+n,f+r);break;case"c":s=d+o[5],c=f+o[6],p=d+o[3],g=f+o[4],t.bezierCurveTo(d+o[1]+n,f+o[2]+r,p+n,g+r,s+n,c+r),d=s,f=c;break;case"C":d=o[5],f=o[6],p=o[3],g=o[4],t.bezierCurveTo(o[1]+n,o[2]+r,p+n,g+r,d+n,f+r);break;case"s":s=d+o[3],c=f+o[4],p=2*d-p,g=2*f-g,t.bezierCurveTo(p+n,g+r,d+o[1]+n,f+o[2]+r,s+n,c+r),p=d+o[1],g=f+o[2],d=s,f=c;break;case"S":s=o[3],c=o[4],p=2*d-p,g=2*f-g,t.bezierCurveTo(p+n,g+r,o[1]+n,o[2]+r,s+n,c+r),d=s,f=c,p=o[1],g=o[2];break;case"q":s=d+o[3],c=f+o[4],p=d+o[1],g=f+o[2],t.quadraticCurveTo(p+n,g+r,s+n,c+r),d=s,f=c;break;case"Q":s=o[3],c=o[4],t.quadraticCurveTo(o[1]+n,o[2]+r,s+n,c+r),d=s,f=c,p=o[1],g=o[2];break;case"t":s=d+o[1],c=f+o[2],null===h[0].match(/[QqTt]/)?(p=d,g=f):"t"===h[0]?(p=2*d-u,g=2*f-l):"q"===h[0]&&(p=2*d-p,g=2*f-g),u=p,l=g,t.quadraticCurveTo(p+n,g+r,s+n,c+r),f=c,p=(d=s)+o[1],g=f+o[2];break;case"T":s=o[1],c=o[2],p=2*d-p,g=2*f-g,t.quadraticCurveTo(p+n,g+r,s+n,c+r),d=s,f=c;break;case"a":bft(t,d+n,f+r,[o[1],o[2],o[3],o[4],o[5],o[6]+d+n,o[7]+f+r]),d+=o[6],f+=o[7];break;case"A":bft(t,d+n,f+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),d=o[6],f=o[7];break;case"z":case"Z":d=m,f=v,t.closePath()}h=o}}function bft(t,e,n,r){const i=function(t,e,n,r,i,a,o,s,c){const u=pft.call(arguments);if(dft[u])return dft[u];const l=o*cft,h=Math.sin(l),d=Math.cos(l),f=d*(s-t)*.5+h*(c-e)*.5,p=d*(c-e)*.5-h*(s-t)*.5;let g=f*f/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=d/n,v=h/n,y=-h/r,b=d/r,x=m*s+v*c,w=y*s+b*c,k=m*t+v*e,_=y*t+b*e;let A=1/((k-x)*(k-x)+(_-w)*(_-w))-.25;A<0&&(A=0);let C=Math.sqrt(A);a==i&&(C=-C);const S=.5*(x+k)-C*(_-w),E=.5*(w+_)+C*(k-x),T=Math.atan2(w-E,x-S);let N=Math.atan2(_-E,k-S)-T;N<0&&1===a?N+=lft:N>0&&0===a&&(N-=lft);const F=Math.ceil(Math.abs(N/(uft+.001))),D=[];for(let I=0;I<F;++I){const t=T+I*N/F,e=T+(I+1)*N/F;D[I]=[S,E,t,e,n,r,h,d]}return dft[u]=D}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n);for(let a=0;a<i.length;++a){const e=gft(i[a]);t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5])}}const xft=.5773502691896257,wft={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,lft)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,a=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-a),t.lineTo(i,-a),t.lineTo(0,-n),t.lineTo(-i,-a),t.lineTo(-r,-a),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=hft*n,i=r-n*xft,a=n/4;t.moveTo(0,-r-i),t.lineTo(-a,r-i),t.lineTo(a,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=hft*n,i=r-n*xft;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=hft*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=hft*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=hft*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=hft*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function kft(t){return Got(wft,t)?wft[t]:function(t){if(!Got(_ft,t)){const e=sft(t);_ft[t]={draw:function(t,n){yft(t,e,0,0,Math.sqrt(n)/2)}}}return _ft[t]}(t)}var _ft={};const Aft=.448084975506;function Cft(t){return t.x}function Sft(t){return t.y}function Eft(t){return t.width}function Tft(t){return t.height}function Nft(t){return"function"===typeof t?t:()=>+t}function Fft(t,e,n){return Math.max(e,Math.min(t,n))}function Dft(t,e){return null!=t?t:e}const Ift=t=>t.x||0,Mft=t=>t.y||0,Oft=t=>!(!1===t.defined),Rft=Wd().startAngle((t=>t.startAngle||0)).endAngle((t=>t.endAngle||0)).padAngle((t=>t.padAngle||0)).innerRadius((t=>t.innerRadius||0)).outerRadius((t=>t.outerRadius||0)).cornerRadius((t=>t.cornerRadius||0)),zft=Yd().x(Ift).y1(Mft).y0((t=>(t.y||0)+(t.height||0))).defined(Oft),Bft=Yd().y(Mft).x1(Ift).x0((t=>(t.x||0)+(t.width||0))).defined(Oft),Lft=Hd().x(Ift).y(Mft).defined(Oft),Pft=function(){var t=Cft,e=Sft,n=Eft,r=Tft,i=Nft(0),a=i,o=i,s=i,c=null;function u(u,l,h){var d,f=null!=l?l:+t.call(this,u),p=null!=h?h:+e.call(this,u),g=+n.call(this,u),m=+r.call(this,u),v=Math.min(g,m)/2,y=Fft(+i.call(this,u),0,v),b=Fft(+a.call(this,u),0,v),x=Fft(+o.call(this,u),0,v),w=Fft(+s.call(this,u),0,v);if(c||(c=d=Od()),y<=0&&b<=0&&x<=0&&w<=0)c.rect(f,p,g,m);else{var k=f+g,_=p+m;c.moveTo(f+y,p),c.lineTo(k-b,p),c.bezierCurveTo(k-Aft*b,p,k,p+Aft*b,k,p+b),c.lineTo(k,_-w),c.bezierCurveTo(k,_-Aft*w,k-Aft*w,_,k-w,_),c.lineTo(f+x,_),c.bezierCurveTo(f+Aft*x,_,f,_-Aft*x,f,_-x),c.lineTo(f,p+y),c.bezierCurveTo(f,p+Aft*y,f+Aft*y,p,f+y,p),c.closePath()}if(d)return c=null,d+""||null}return u.x=function(e){return arguments.length?(t=Nft(e),u):t},u.y=function(t){return arguments.length?(e=Nft(t),u):e},u.width=function(t){return arguments.length?(n=Nft(t),u):n},u.height=function(t){return arguments.length?(r=Nft(t),u):r},u.cornerRadius=function(t,e,n,r){return arguments.length?(i=Nft(t),a=null!=e?Nft(e):i,s=null!=n?Nft(n):i,o=null!=r?Nft(r):a,u):i},u.context=function(t){return arguments.length?(c=null==t?null:t,u):c},u}().x(Ift).y(Mft).width((t=>t.width||0)).height((t=>t.height||0)).cornerRadius((t=>Dft(t.cornerRadiusTopLeft,t.cornerRadius)||0),(t=>Dft(t.cornerRadiusTopRight,t.cornerRadius)||0),(t=>Dft(t.cornerRadiusBottomRight,t.cornerRadius)||0),(t=>Dft(t.cornerRadiusBottomLeft,t.cornerRadius)||0)),jft=Qd().type((t=>kft(t.shape||"circle"))).size((t=>Dft(t.size,64))),Uft=function(){var t,e,n,r,i,a,o,s,c=null;function u(t,e,n){const r=n/2;if(i){var u=o-e,l=t-a;if(u||l){var h=Math.hypot(u,l),d=(u/=h)*s,f=(l/=h)*s,p=Math.atan2(l,u);c.moveTo(a-d,o-f),c.lineTo(t-u*r,e-l*r),c.arc(t,e,r,p-Math.PI,p),c.lineTo(a+d,o+f),c.arc(a,o,s,p,p+Math.PI)}else c.arc(t,e,r,0,lft);c.closePath()}else i=1;a=t,o=e,s=r}function l(a){var o,s,l,h=a.length,d=!1;for(null==c&&(c=l=Od()),o=0;o<=h;++o)!(o<h&&r(s=a[o],o,a))===d&&(d=!d)&&(i=0),d&&u(+t(s,o,a),+e(s,o,a),+n(s,o,a));if(l)return c=null,l+""||null}return l.x=function(e){return arguments.length?(t=e,l):t},l.y=function(t){return arguments.length?(e=t,l):e},l.size=function(t){return arguments.length?(n=t,l):n},l.defined=function(t){return arguments.length?(r=t,l):r},l.context=function(t){return arguments.length?(c=null==t?null:t,l):c},l}().x(Ift).y(Mft).defined(Oft).size((t=>t.size||1));function Wft(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function Vft(t,e,n,r){return Pft.context(t)(e,n,r)}var qft=1;function Gft(t,e,n){var r=e.clip,i=t._defs,a=e.clip_id||(e.clip_id="clip"+qft++),o=i.clipping[a]||(i.clipping[a]={id:a});return Wot(r)?o.path=r(null):Wft(n)?o.path=Vft(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+a+")"}function Hft(t){this.clear(),t&&this.union(t)}function Yft(t){this.mark=t,this.bounds=this.bounds||new Hft}function Xft(t){Yft.call(this,t),this.items=this.items||[]}function Kft(t){this._pending=0,this._loader=t||Xdt()}function Qft(t){t._pending+=1}function Zft(t){t._pending-=1}function $ft(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){const r=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(r+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}(e,r):0))}return t}Hft.prototype={clone(){return new Hft(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){const r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(t,e,n){var{x1:r,y1:i,x2:a,y2:o}=this,s=Math.cos(t),c=Math.sin(t),u=e-e*s+n*c,l=n-e*c-n*s;return[s*r-c*i+u,c*r+s*i+l,s*r-c*o+u,c*r+s*o+l,s*a-c*i+u,c*a+s*i+l,s*a-c*o+u,c*a+s*o+l]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},Hot(Xft,Yft),Kft.prototype={pending(){return this._pending},sanitizeURL(t){const e=this;return Qft(e),e._loader.sanitize(t,{context:"href"}).then((t=>(Zft(e),t))).catch((()=>(Zft(e),null)))},loadImage(t){const e=this,n=$d();return Qft(e),e._loader.sanitize(t,{context:"image"}).then((t=>{const r=t.href;if(!r||!n)throw{url:r};const i=new n,a=Got(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=a&&(i.crossOrigin=a),i.onload=()=>Zft(e),i.onerror=()=>Zft(e),i.src=r,i})).catch((t=>(Zft(e),{complete:!1,width:0,height:0,src:t&&t.url||""})))},ready(){const t=this;return new Promise((e=>{!function n(r){t.pending()?setTimeout((()=>{n(!0)}),10):e(r)}(!1)}))}};const Jft=lft-1e-8;let tpt,ept,npt,rpt,ipt,apt,opt,spt;const cpt=(t,e)=>tpt.add(t,e),upt=(t,e)=>cpt(ept=t,npt=e),lpt=t=>cpt(t,tpt.y1),hpt=t=>cpt(tpt.x1,t),dpt=(t,e)=>ipt*t+opt*e,fpt=(t,e)=>apt*t+spt*e,ppt=(t,e)=>cpt(dpt(t,e),fpt(t,e)),gpt=(t,e)=>upt(dpt(t,e),fpt(t,e));function mpt(t,e){return tpt=t,e?(rpt=e*cft,ipt=spt=Math.cos(rpt),apt=Math.sin(rpt),opt=-apt):(ipt=spt=1,rpt=apt=opt=0),vpt}const vpt={beginPath(){},closePath(){},moveTo:gpt,lineTo:gpt,rect(t,e,n,r){rpt?(ppt(t+n,e),ppt(t+n,e+r),ppt(t,e+r),gpt(t,e)):(cpt(t+n,e+r),upt(t,e))},quadraticCurveTo(t,e,n,r){const i=dpt(t,e),a=fpt(t,e),o=dpt(n,r),s=fpt(n,r);ypt(ept,i,o,lpt),ypt(npt,a,s,hpt),upt(o,s)},bezierCurveTo(t,e,n,r,i,a){const o=dpt(t,e),s=fpt(t,e),c=dpt(n,r),u=fpt(n,r),l=dpt(i,a),h=fpt(i,a);bpt(ept,o,c,l,lpt),bpt(npt,s,u,h,hpt),upt(l,h)},arc(t,e,n,r,i,a){if(r+=rpt,i+=rpt,ept=n*Math.cos(i)+t,npt=n*Math.sin(i)+e,Math.abs(i-r)>Jft)cpt(t-n,e-n),cpt(t+n,e+n);else{const o=r=>cpt(n*Math.cos(r)+t,n*Math.sin(r)+e);let s,c;if(o(r),o(i),i!==r)if((r%=lft)<0&&(r+=lft),(i%=lft)<0&&(i+=lft),i<r&&(a=!a,s=r,r=i,i=s),a)for(i-=lft,s=r-r%uft,c=0;c<4&&s>i;++c,s-=uft)o(s);else for(s=r-r%uft+uft,c=0;c<4&&s<i;++c,s+=uft)o(s)}}};function ypt(t,e,n,r){const i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function bpt(t,e,n,r,i){const a=r-t+3*e-3*n,o=t+n-2*e,s=t-e;let c,u=0,l=0;Math.abs(a)>1e-14?(c=o*o+s*a,c>=0&&(c=Math.sqrt(c),u=(-o+c)/a,l=(-o-c)/a)):u=.5*s/o,0<u&&u<1&&i(xpt(u,t,e,n,r)),0<l&&l<1&&i(xpt(l,t,e,n,r))}function xpt(t,e,n,r,i){const a=1-t,o=a*a,s=t*t;return o*a*e+3*o*t*n+3*a*s*r+s*t*i}var wpt=(wpt=Zd(1,1))?wpt.getContext("2d"):null;const kpt=new Hft;function _pt(t){return function(e,n){if(!wpt)return!0;t(wpt,e),kpt.clear().union(e.bounds).intersect(n).round();const{x1:r,y1:i,x2:a,y2:o}=kpt;for(let t=i;t<=o;++t)for(let e=r;e<=a;++e)if(wpt.isPointInPath(e,t))return!0;return!1}}function Apt(t,e){return e.contains(t.x||0,t.y||0)}function Cpt(t,e){const n=t.x||0,r=t.y||0,i=t.width||0,a=t.height||0;return e.intersects(kpt.set(n,r,n+i,r+a))}function Spt(t,e,n,r,i){const{x1:a,y1:o,x2:s,y2:c}=t,u=r-e,l=i-n;let h,d,f,p,g=0,m=1;for(p=0;p<4;++p){if(0===p&&(h=-u,d=-(a-e)),1===p&&(h=u,d=s-e),2===p&&(h=-l,d=-(o-n)),3===p&&(h=l,d=c-n),Math.abs(h)<1e-10&&d<0)return!1;if(f=d/h,h<0){if(f>m)return!1;f>g&&(g=f)}else if(h>0){if(f<g)return!1;f<m&&(m=f)}}return!0}function Ept(t,e){t.globalCompositeOperation=e.blend||"source-over"}function Tpt(t,e){return null==t?e:t}function Npt(t,e){const n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}function Fpt(t,e,n){return Zdt(n)?function(t,e,n){const r=n.width(),i=n.height();let a;if("radial"===e.gradient)a=t.createRadialGradient(n.x1+Tpt(e.x1,.5)*r,n.y1+Tpt(e.y1,.5)*i,Math.max(r,i)*Tpt(e.r1,0),n.x1+Tpt(e.x2,.5)*r,n.y1+Tpt(e.y2,.5)*i,Math.max(r,i)*Tpt(e.r2,.5));else{const o=Tpt(e.x1,0),s=Tpt(e.y1,0),c=Tpt(e.x2,1),u=Tpt(e.y2,0);if(o!==c&&s!==u&&r!==i){const n=Zd(Math.ceil(r),Math.ceil(i)),a=n.getContext("2d");return a.scale(r,i),a.fillStyle=Npt(a.createLinearGradient(o,s,c,u),e.stops),a.fillRect(0,0,r,i),t.createPattern(n,"no-repeat")}a=t.createLinearGradient(n.x1+o*r,n.y1+s*i,n.x1+c*r,n.y1+u*i)}return Npt(a,e.stops)}(t,n,e.bounds):n}function Dpt(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=Fpt(t,e,e.fill),!0)}var Ipt=[];function Mpt(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&((n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=Fpt(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||Ipt),t.lineDashOffset=e.strokeDashOffset||0),!0))}function Opt(t,e){return t.zindex-e.zindex||t.index-e.index}function Rpt(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,a=[];for(n=0,r=i.length;n<r;++n)(e=i[n]).index=n,e.zindex&&a.push(e);return t.zdirty=!1,t.zitems=a.sort(Opt)}function zpt(t,e){var n,r,i=t.items;if(!i||!i.length)return;const a=Rpt(t);if(a&&a.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=a}for(n=0,r=i.length;n<r;++n)e(i[n])}function Bpt(t,e){var n,r,i=t.items;if(!i||!i.length)return null;const a=Rpt(t);for(a&&a.length&&(i=a),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===a)for(r=(i=t.items).length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function Lpt(t){return function(e,n,r){zpt(n,(n=>{r&&!r.intersects(n.bounds)||jpt(t,e,n,n)}))}}function Ppt(t){return function(e,n,r){!n.items.length||r&&!r.intersects(n.bounds)||jpt(t,e,n.items[0],n.items)}}function jpt(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||(Ept(e,n),n.fill&&Dpt(e,n,i)&&e.fill(),n.stroke&&Mpt(e,n,i)&&e.stroke()))}function Upt(t){return t=t||Not,function(e,n,r,i,a,o){return r*=e.pixelRatio,i*=e.pixelRatio,Bpt(n,(n=>{const s=n.bounds;if((!s||s.contains(a,o))&&s)return t(e,n,r,i,a,o)?n:void 0}))}}function Wpt(t,e){return function(n,r,i,a){var o,s,c=Array.isArray(r)?r[0]:r,u=null==e?c.fill:e,l=c.stroke&&n.isPointInStroke;return l&&(o=c.strokeWidth,s=c.strokeCap,n.lineWidth=null!=o?o:1,n.lineCap=null!=s?s:"butt"),!t(n,r)&&(u&&n.isPointInPath(i,a)||l&&n.isPointInStroke(i,a))}}function Vpt(t){return Upt(Wpt(t))}function qpt(t,e){return"translate("+t+","+e+")"}function Gpt(t){return"rotate("+t+")"}function Hpt(t){return qpt(t.x||0,t.y||0)}function Ypt(t,e,n){function r(t,n){var r=n.x||0,i=n.y||0,a=n.angle||0;t.translate(r,i),a&&t.rotate(a*=cft),t.beginPath(),e(t,n),a&&t.rotate(-a),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",function(t){return qpt(t.x||0,t.y||0)+(t.angle?" "+Gpt(t.angle):"")}(n)),t("d",e(null,n))},bound:function(t,n){return e(mpt(t,n.angle),n),$ft(t,n).translate(n.x||0,n.y||0)},draw:Lpt(r),pick:Vpt(r),isect:n||_pt(r)}}var Xpt=Ypt("arc",(function(t,e){return Rft.context(t)(e)}));function Kpt(t,e,n){function r(t,n){t.beginPath(),e(t,n)}const i=Wpt(r);return{type:t,tag:"path",nested:!0,attr:function(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))},bound:function(t,n){var r=n.items;return 0===r.length?t:(e(mpt(t),r),$ft(t,r[0]))},draw:Ppt(r),pick:function(t,e,n,r,a,o){var s=e.items,c=e.bounds;return!s||!s.length||c&&!c.contains(a,o)?null:(n*=t.pixelRatio,r*=t.pixelRatio,i(t,s,n,r)?s[0]:null)},isect:Apt,tip:n}}var Qpt=Kpt("area",(function(t,e){const n=e[0],r=n.interpolate||"linear";return("horizontal"===n.orient?Bft:zft).curve(eft(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i="horizontal"===t[0].orient?e[1]:e[0],a="horizontal"===t[0].orient?"y":"x",o=t.length,s=1/0;--o>=0;)!1!==t[o].defined&&(r=Math.abs(t[o][a]-i))<s&&(s=r,n=t[o]);return n}));function Zpt(t,e){t.beginPath(),Wft(e)?Vft(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function $pt(t){const e=Tpt(t.strokeWidth,1);return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function Jpt(t,e){const n=$pt(e);t("d",Vft(null,e,n,n))}function tgt(t,e,n,r){const i=$pt(e);t.beginPath(),Vft(t,e,(n||0)+i,(r||0)+i)}const egt=Wpt(tgt),ngt=Wpt(tgt,!1),rgt=Wpt(tgt,!0);var igt={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",Hpt(e))},bound:function(t,e){if(!e.clip&&e.items){const n=e.items,r=n.length;for(let e=0;e<r;++e)t.union(n[e].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),$ft(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n,r){zpt(e,(e=>{const i=e.x||0,a=e.y||0,o=e.strokeForeground,s=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&s&&(tgt(t,e,i,a),Ept(t,e),e.fill&&Dpt(t,e,s)&&t.fill(),e.stroke&&!o&&Mpt(t,e,s)&&t.stroke()),t.save(),t.translate(i,a),e.clip&&Zpt(t,e),n&&n.translate(-i,-a),zpt(e,(e=>{("group"===e.marktype||null==r||r.includes(e.marktype))&&this.draw(t,e,n,r)})),n&&n.translate(i,a),t.restore(),o&&e.stroke&&s&&(tgt(t,e,i,a),Ept(t,e),Mpt(t,e,s)&&t.stroke())}))},pick:function(t,e,n,r,i,a){if(e.bounds&&!e.bounds.contains(i,a)||!e.items)return null;const o=n*t.pixelRatio,s=r*t.pixelRatio;return Bpt(e,(c=>{let u,l,h;const d=c.bounds;if(d&&!d.contains(i,a))return;l=c.x||0,h=c.y||0;const f=l+(c.width||0),p=h+(c.height||0),g=c.clip;if(g&&(i<l||i>f||a<h||a>p))return;if(t.save(),t.translate(l,h),l=i-l,h=a-h,g&&Wft(c)&&!rgt(t,c,o,s))return t.restore(),null;const m=c.strokeForeground,v=!1!==e.interactive;return v&&m&&c.stroke&&ngt(t,c,o,s)?(t.restore(),c):(u=Bpt(c,(t=>function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}(t,l,h)?this.pick(t,n,r,l,h):null)),!u&&v&&(c.fill||!m&&c.stroke)&&egt(t,c,o,s)&&(u=c),t.restore(),u||null)}))},isect:Cpt,content:function(t,e,n){t("clip-path",e.clip?Gft(n,e,e):null)},background:function(t,e){t("class","background"),t("aria-hidden",!0),Jpt(t,e)},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?Jpt(t,e):t("d","")}},agt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function ogt(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then((e=>{t.image=e,t.image.url=t.url}))),n}function sgt(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function cgt(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function ugt(t,e){return"center"===t?e/2:"right"===t?e:0}function lgt(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var hgt={type:"image",tag:"image",nested:!1,attr:function(t,e,n){const r=ogt(e,n),i=sgt(e,r),a=cgt(e,r),o=(e.x||0)-ugt(e.align,i),s=(e.y||0)-lgt(e.baseline,a);t("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",agt["xmlns:xlink"],"xlink:href"),t("transform",qpt(o,s)),t("width",i),t("height",a),t("preserveAspectRatio",!1===e.aspect?"none":"xMidYMid")},bound:function(t,e){const n=e.image,r=sgt(e,n),i=cgt(e,n),a=(e.x||0)-ugt(e.align,r),o=(e.y||0)-lgt(e.baseline,i);return t.set(a,o,a+r,o+i)},draw:function(t,e,n){zpt(e,(e=>{if(n&&!n.intersects(e.bounds))return;const r=ogt(e,this);let i=sgt(e,r),a=cgt(e,r);if(0===i||0===a)return;let o,s,c,u,l=(e.x||0)-ugt(e.align,i),h=(e.y||0)-lgt(e.baseline,a);!1!==e.aspect&&(s=r.width/r.height,c=e.width/e.height,s===s&&c===c&&s!==c&&(c<s?(u=i/s,h+=(a-u)/2,a=u):(u=a*s,l+=(i-u)/2,i=u))),(r.complete||r.toDataURL)&&(Ept(t,e),t.globalAlpha=null!=(o=e.opacity)?o:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(r,l,h,i,a))}))},pick:Upt(),isect:Not,get:ogt,xOffset:ugt,yOffset:lgt},dgt=Kpt("line",(function(t,e){const n=e[0],r=n.interpolate||"linear";return Lft.curve(eft(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i=Math.pow(t[0].strokeWidth||1,2),a=t.length;--a>=0;)if(!1!==t[a].defined&&(n=t[a].x-e[0])*n+(r=t[a].y-e[1])*r<i)return t[a];return null}));function fgt(t,e){var n=e.path;if(null==n)return!0;var r=e.x||0,i=e.y||0,a=e.scaleX||1,o=e.scaleY||1,s=(e.angle||0)*cft,c=e.pathCache;c&&c.path===n||((e.pathCache=c=sft(n)).path=n),s&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(s),yft(t,c,0,0,a,o),t.rotate(-s),t.translate(-r,-i)):yft(t,c,r,i,a,o)}var pgt={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,r=e.scaleY||1;1===n&&1===r||t("vector-effect","non-scaling-stroke"),t("transform",function(t){return qpt(t.x||0,t.y||0)+(t.angle?" "+Gpt(t.angle):"")+(t.scaleX||t.scaleY?" "+function(t,e){return"scale("+t+","+e+")"}(t.scaleX||1,t.scaleY||1):"")}(e)),t("d",e.path)},bound:function(t,e){return fgt(mpt(t,e.angle),e)?t.set(0,0,0,0):$ft(t,e,!0)},draw:Lpt(fgt),pick:Vpt(fgt),isect:_pt(fgt)};function ggt(t,e){t.beginPath(),Vft(t,e)}var mgt={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",Vft(null,e))},bound:function(t,e){var n,r;return $ft(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:Lpt(ggt),pick:Vpt(ggt),isect:Cpt};function vgt(t,e,n){var r,i,a,o;return!(!e.stroke||!Mpt(t,e,n))&&(r=e.x||0,i=e.y||0,a=null!=e.x2?e.x2:r,o=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(a,o),!0)}var ygt={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",Hpt(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return $ft(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)},draw:function(t,e,n){zpt(e,(e=>{if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&vgt(t,e,r)&&(Ept(t,e),t.stroke())}}))},pick:Upt((function(t,e,n,r){return!!t.isPointInStroke&&(vgt(t,e,1)&&t.isPointInStroke(n,r))})),isect:function(t,e){const n=t.x||0,r=t.y||0;return Spt(e,n,r,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r)}},bgt=Ypt("shape",(function(t,e){return(e.mark.shape||e.shape).context(t)(e)})),xgt=Ypt("symbol",(function(t,e){return jft.context(t)(e)}),Apt);const wgt=function(t){let e,n,r;t=+t||1e4;const i=()=>{e={},n={},r=0},a=(i,a)=>(++r>t&&(n=e,e={},r=1),e[i]=a);return i(),{clear:i,has:t=>Got(e,t)||Got(n,t),get:t=>Got(e,t)?e[t]:Got(n,t)?a(t,n[t]):void 0,set:(t,n)=>Got(e,t)?e[t]=n:a(t,n)}}();var kgt={height:Tgt,measureWidth:Sgt,estimateWidth:Agt,width:Agt,canvas:_gt};function _gt(t){kgt.width=t&&wpt?Sgt:Agt}function Agt(t,e){return Cgt(Dgt(t,e),Tgt(t))}function Cgt(t,e){return~~(.8*t.length*e)}function Sgt(t,e){return Tgt(t)<=0||!(e=Dgt(t,e))?0:Egt(e,Mgt(t))}function Egt(t,e){const n="(".concat(e,") ").concat(t);let r=wgt.get(n);return void 0===r&&(wpt.font=e,r=wpt.measureText(t).width,wgt.set(n,r)),r}function Tgt(t){return null!=t.fontSize?+t.fontSize||0:11}function Ngt(t){return null!=t.lineHeight?t.lineHeight:Tgt(t)+2}function Fgt(t){return e=t.lineBreak&&t.text&&!Fot(t.text)?t.text.split(t.lineBreak):t.text,Fot(e)?e.length>1?e:e[0]:e;var e}function Dgt(t,e){const n=null==e?"":(e+"").trim();return t.limit>0&&n.length?function(t,e){var n=+t.limit,r=function(t){if(kgt.width===Sgt){const e=Mgt(t);return t=>Egt(t,e)}if(kgt.width===Agt){const e=Tgt(t);return t=>Cgt(t,e)}return e=>kgt.width(t,e)}(t);if(r(e)<n)return e;var i,a=t.ellipsis||"\u2026",o="rtl"===t.dir,s=0,c=e.length;if(n-=r(a),o){for(;s<c;)i=s+c>>>1,r(e.slice(i))>n?s=i+1:c=i;return a+e.slice(s)}for(;s<c;)i=1+(s+c>>>1),r(e.slice(0,i))<n?s=i:c=i-1;return e.slice(0,s)+a}(t,n):n}function Igt(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Mgt(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+Tgt(t)+"px "+Igt(t,e)}function Ogt(t){var e=t.baseline,n=Tgt(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*Ngt(t):"line-bottom"===e?.29*n-.5*Ngt(t):0)}_gt(!0);const Rgt={left:"start",center:"middle",right:"end"},zgt=new Hft;function Bgt(t){var e,n=t.x||0,r=t.y||0,i=t.radius||0;return i&&(e=(t.theta||0)-uft,n+=i*Math.cos(e),r+=i*Math.sin(e)),zgt.x1=n,zgt.y1=r,zgt}function Lgt(t,e,n){var r,i=kgt.height(e),a=e.align,o=Bgt(e),s=o.x1,c=o.y1,u=e.dx||0,l=(e.dy||0)+Ogt(e)-Math.round(.8*i),h=Fgt(e);if(Fot(h)?(i+=Ngt(e)*(h.length-1),r=h.reduce(((t,n)=>Math.max(t,kgt.width(e,n))),0)):r=kgt.width(e,h),"center"===a?u-=r/2:"right"===a&&(u-=r),t.set(u+=s,l+=c,u+r,l+i),e.angle&&!n)t.rotate(e.angle*cft,s,c);else if(2===n)return t.rotatedPoints(e.angle*cft,s,c);return t}var Pgt={type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,i=(e.dy||0)+Ogt(e),a=Bgt(e),o=a.x1,s=a.y1,c=e.angle||0;t("text-anchor",Rgt[e.align]||"start"),c?(n=qpt(o,s)+" "+Gpt(c),(r||i)&&(n+=" "+qpt(r,i))):n=qpt(o+r,s+i),t("transform",n)},bound:Lgt,draw:function(t,e,n){zpt(e,(e=>{var r,i,a,o,s,c,u,l=null==e.opacity?1:e.opacity;if(!(n&&!n.intersects(e.bounds)||0===l||e.fontSize<=0||null==e.text||0===e.text.length)){if(t.font=Mgt(e),t.textAlign=e.align||"left",i=(r=Bgt(e)).x1,a=r.y1,e.angle&&(t.save(),t.translate(i,a),t.rotate(e.angle*cft),i=a=0),i+=e.dx||0,a+=(e.dy||0)+Ogt(e),c=Fgt(e),Ept(t,e),Fot(c))for(s=Ngt(e),o=0;o<c.length;++o)u=Dgt(e,c[o]),e.fill&&Dpt(t,e,l)&&t.fillText(u,i,a),e.stroke&&Mpt(t,e,l)&&t.strokeText(u,i,a),a+=s;else u=Dgt(e,c),e.fill&&Dpt(t,e,l)&&t.fillText(u,i,a),e.stroke&&Mpt(t,e,l)&&t.strokeText(u,i,a);e.angle&&t.restore()}}))},pick:Upt((function(t,e,n,r,i,a){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var o=Bgt(e),s=o.x1,c=o.y1,u=Lgt(zgt,e,1),l=-e.angle*cft,h=Math.cos(l),d=Math.sin(l),f=h*i-d*a+(s-h*s+d*c),p=d*i+h*a+(c-d*s-h*c);return u.contains(f,p)})),isect:function(t,e){const n=Lgt(zgt,t,2);return Spt(e,n[0],n[1],n[2],n[3])||Spt(e,n[0],n[1],n[4],n[5])||Spt(e,n[4],n[5],n[6],n[7])||Spt(e,n[2],n[3],n[6],n[7])}},jgt=Kpt("trail",(function(t,e){return Uft.context(t)(e)}),(function(t,e){for(var n,r,i=t.length;--i>=0;)if(!1!==t[i].defined&&(n=t[i].x-e[0])*n+(r=t[i].y-e[1])*r<(n=t[i].size||1)*n)return t[i];return null})),Ugt={arc:Xpt,area:Qpt,group:igt,image:hgt,line:dgt,path:pgt,rect:mgt,rule:ygt,shape:bgt,symbol:xgt,text:Pgt,trail:jgt};function Wgt(t,e,n){return!t&&"undefined"!==typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function Vgt(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function qgt(t,e,n,r){var i,a=t.childNodes[e];return a&&a.tagName.toLowerCase()===n.toLowerCase()||(i=a||null,a=Wgt(t.ownerDocument,n,r),t.insertBefore(a,i)),a}function Ggt(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function Hgt(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function Ygt(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function Xgt(t,e){this._active=null,this._handlers={},this._loader=t||Xdt(),this._tooltip=e||Kgt}function Kgt(t,e,n,r){t.element().setAttribute("title",r||"")}function Qgt(t){this._el=null,this._bgcolor=null,this._loader=new Kft(t)}Xgt.prototype={initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},scene(t){return arguments.length?(this._scene=t,this):this._scene},on(){},off(){},_handlerIndex(t,e,n){for(let r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},handlers(t){const e=this._handlers,n=[];if(t)n.push(...e[this.eventName(t)]);else for(const r in e)n.push(...e[r]);return n},eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then((e=>{const n=new MouseEvent(t.type,t),r=Wgt(null,"a");for(const t in e)r.setAttribute(t,e[t]);r.dispatchEvent(n)})).catch((()=>{}))},handleTooltip(t,e,n){if(e&&null!=e.tooltip){e=function(t,e,n,r){var i,a,o=t&&t.mark;if(o&&(i=Ugt[o.marktype]).tip){for((a=Ygt(e,n))[0]-=r[0],a[1]-=r[1];t=t.mark.group;)a[0]-=t.x||0,a[1]-=t.y||0;t=i.tip(o.items,a)}return t}(e,t,this.canvas(),this._origin);const r=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,r)}},getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,a=i.width(),o=i.height();let s=i.x1+r[0]+n.left,c=i.y1+r[1]+n.top;for(;t.mark&&(t=t.mark.group);)s+=t.x||0,c+=t.y||0;return{x:s,y:c,width:a,height:o,left:s,top:c,right:s+a,bottom:c+o}}},Qgt.prototype={initialize(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)},resize(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(t,e){const n=this;return n._call=function(){n._render(t,e)},n._call(),n._call=null,n},_render(){},renderAsync(t,e){const n=this.render(t,e);return this._ready?this._ready.then((()=>n)):Promise.resolve(n)},_load(t,e){var n=this,r=n._loader[t](e);if(!n._ready){const t=n._call;n._ready=n._loader.ready().then((e=>{e&&t(),n._ready=null}))}return r},sanitizeURL(t){return this._load("sanitizeURL",t)},loadImage(t){return this._load("loadImage",t)}};const Zgt="dragenter",$gt="dragleave",Jgt="dragover",tmt="pointerdown",emt="pointermove",nmt="pointerout",rmt="pointerover",imt="mousedown",amt="mousemove",omt="mouseout",smt="mouseover",cmt="click",umt="mousewheel",lmt="touchstart",hmt="touchmove",dmt="touchend",fmt=emt,pmt=nmt,gmt=cmt;function mmt(t,e){Xgt.call(this,t,e),this._down=null,this._touch=null,this._first=!0,this._events={}}function vmt(t,e){(t=>t===lmt||t===hmt||t===dmt?[lmt,hmt,dmt]:[t])(e).forEach((e=>function(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n)))}(t,e)))}function ymt(t,e,n){e.forEach((e=>t.fire(e,n)))}function bmt(t,e,n){return function(r){const i=this._active,a=this.pickEvent(r);a===i||(i&&i.exit||ymt(this,n,r),this._active=a,ymt(this,e,r)),ymt(this,t,r)}}function xmt(t){return function(e){ymt(this,t,e),this._active=null}}function wmt(t,e,n,r,i,a){const o="undefined"!==typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,s=t.getContext("2d"),c=o?"undefined"!==typeof window&&window.devicePixelRatio||1:i;t.width=e*c,t.height=n*c;for(const u in a)s[u]=a[u];return o&&1!==c&&(t.style.width=e+"px",t.style.height=n+"px"),s.pixelRatio=c,s.setTransform(c,0,0,c,c*r[0],c*r[1]),t}function kmt(t){Qgt.call(this,t),this._options={},this._redraw=!1,this._dirty=new Hft,this._tempb=new Hft}Hot(mmt,Xgt,{initialize(t,e,n){return this._canvas=t&&Vgt(t,"canvas"),[cmt,imt,tmt,emt,nmt,$gt].forEach((t=>vmt(this,t))),Xgt.prototype.initialize.call(this,t,e,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",Zgt,$gt,Jgt,tmt,"pointerup",emt,nmt,rmt,imt,"mouseup",amt,omt,smt,cmt,"dblclick","wheel",umt,lmt,hmt,dmt],DOMMouseScroll(t){this.fire(umt,t)},pointermove:bmt([emt,amt],[rmt,smt],[nmt,omt]),dragover:bmt([Jgt],[Zgt],[$gt]),pointerout:xmt([nmt,omt]),dragleave:xmt([$gt]),pointerdown(t){this._down=this._active,this.fire(tmt,t)},mousedown(t){this._down=this._active,this.fire(imt,t)},click(t){this._down===this._active&&(this.fire(cmt,t),this._down=null)},touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(lmt,t,!0)},touchmove(t){this.fire(hmt,t,!0)},touchend(t){this.fire(dmt,t,!0),this._touch=null},fire(t,e,n){const r=n?this._touch:this._active,i=this._handlers[t];if(e.vegaType=t,t===gmt&&r&&r.href?this.handleHref(e,r,r.href):t!==fmt&&t!==pmt||this.handleTooltip(e,r,t!==pmt),i)for(let a=0,o=i.length;a<o;++a)i[a].handler.call(this._obj,e,r)},on(t,e){const n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(vmt(this,t),(r[n]||(r[n]=[])).push({type:t,handler:e})),this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this},pickEvent(t){const e=Ygt(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pick(t,e,n,r,i){const a=this.context();return Ugt[t.marktype].pick.call(this,a,t,e,n,r,i)}});const _mt=Qgt.prototype;function Amt(t,e){Xgt.call(this,t,e);const n=this;n._hrefHandler=Cmt(n,((t,e)=>{e&&e.href&&n.handleHref(t,e,e.href)})),n._tooltipHandler=Cmt(n,((t,e)=>{n.handleTooltip(t,e,t.type!==pmt)}))}Hot(kmt,Qgt,{initialize(t,e,n,r,i,a){return this._options=a||{},this._canvas=this._options.externalContext?null:Zd(1,1,this._options.type),t&&this._canvas&&(Ggt(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),_mt.initialize.call(this,t,e,n,r,i)},resize(t,e,n,r){if(_mt.resize.call(this,t,e,n,r),this._canvas)wmt(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const t=this._options.externalContext;t||Cot("CanvasRenderer is missing a valid canvas or context"),t.scale(this._scale,this._scale),t.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)},_render(t,e){const n=this.context(),r=this._origin,i=this._width,a=this._height,o=this._dirty,s=((t,e,n)=>(new Hft).set(0,0,e,n).translate(-t[0],-t[1]))(r,i,a);n.save();const c=this._redraw||o.empty()?(this._redraw=!1,s.expand(1)):function(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}(n,s.intersect(o),r);return this.clear(-r[0],-r[1],i,a),this.draw(n,t,c,e),n.restore(),o.clear(),this},draw(t,e,n,r){if("group"!==e.marktype&&null!=r&&!r.includes(e.marktype))return;const i=Ugt[e.marktype];e.clip&&function(t,e){var n=e.clip;t.save(),Wot(n)?(t.beginPath(),n(t),t.clip()):Zpt(t,e.group)}(t,e),i.draw.call(this,t,e,n,r),e.clip&&t.restore()},clear(t,e,n,r){const i=this._options,a=this.context();"pdf"===i.type||i.externalContext||a.clearRect(t,e,n,r),null!=this._bgcolor&&(a.fillStyle=this._bgcolor,a.fillRect(t,e,n,r))}});const Cmt=(t,e)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,e.call(t._obj,n,r)};Hot(Amt,Xgt,{initialize(t,e,n){let r=this._svg;return r&&(r.removeEventListener(gmt,this._hrefHandler),r.removeEventListener(fmt,this._tooltipHandler),r.removeEventListener(pmt,this._tooltipHandler)),this._svg=r=t&&Vgt(t,"svg"),r&&(r.addEventListener(gmt,this._hrefHandler),r.addEventListener(fmt,this._tooltipHandler),r.addEventListener(pmt,this._tooltipHandler)),Xgt.prototype.initialize.call(this,t,e,n)},canvas(){return this._svg},on(t,e){const n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){const i={type:t,handler:e,listener:Cmt(this,e)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const Smt="aria-hidden",Emt="aria-label",Tmt="role",Nmt="aria-roledescription",Fmt="graphics-object",Dmt="graphics-symbol",Imt=(t,e,n)=>({[Tmt]:t,[Nmt]:e,[Emt]:n||void 0}),Mmt=nst(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),Omt={axis:{desc:"axis",caption:function(t){const e=t.datum,n=t.orient,r=e.title?Pmt(t):null,i=t.context,a=i.scales[e.scale].value,o=i.dataflow.locale(),s=a.type,c="left"===n||"right"===n?"Y":"X";return"".concat(c,"-axis")+(r?" titled '".concat(r,"'"):"")+" for a ".concat(Hht(s)?"discrete":s," scale")+" with ".concat(bdt(o,a,t))}},legend:{desc:"legend",caption:function(t){const e=t.datum,n=e.title?Pmt(t):null,r="".concat(e.type||""," legend").trim(),i=e.scales,a=Object.keys(i),o=t.context,s=o.scales[i[a[0]]].value,c=o.dataflow.locale();return function(t){return t.length?t[0].toUpperCase()+t.slice(1):t}(r)+(n?" titled '".concat(n,"'"):"")+" for ".concat(function(t){return t=t.map((t=>t+("fill"===t||"stroke"===t?" color":""))),t.length<2?t[0]:t.slice(0,-1).join(", ")+" and "+Iot(t)}(a))+" with ".concat(bdt(c,s,t))}},"title-text":{desc:"title",caption:t=>"Title text '".concat(Lmt(t),"'")},"title-subtitle":{desc:"subtitle",caption:t=>"Subtitle text '".concat(Lmt(t),"'")}},Rmt={ariaRole:Tmt,ariaRoleDescription:Nmt,description:Emt};function zmt(t,e){const n=!1===e.aria;if(t(Smt,n||void 0),n||null==e.description)for(const r in Rmt)t(Rmt[r],void 0);else{const n=e.mark.marktype;t(Emt,e.description),t(Tmt,e.ariaRole||("group"===n?Fmt:Dmt)),t(Nmt,e.ariaRoleDescription||"".concat(n," mark"))}}function Bmt(t){return!1===t.aria?{[Smt]:!0}:Mmt[t.role]?null:Omt[t.role]?function(t,e){try{const n=t.items[0],r=e.caption||(()=>"");return Imt(e.role||Dmt,e.desc,n.description||r(n))}catch(n){return null}}(t,Omt[t.role]):function(t){const e=t.marktype,n="group"===e||"text"===e||t.items.some((t=>null!=t.description&&!1!==t.aria));return Imt(n?Fmt:Dmt,"".concat(e," mark container"),t.description)}(t)}function Lmt(t){return Uot(t.text).join(" ")}function Pmt(t){try{return Uot(Iot(t.items).items[0].text).join(" ")}catch(e){return null}}const jmt=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function Umt(){let t="",e="",n="";const r=[],i=()=>e=n="",a=(t,n)=>(null!=n&&(e+=" ".concat(t,'="').concat(jmt(n).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"),'"')),o),o={open(s){(a=>{e&&(t+="".concat(e,">").concat(n),i()),r.push(a)})(s),e="<"+s;for(var c=arguments.length,u=new Array(c>1?c-1:0),l=1;l<c;l++)u[l-1]=arguments[l];for(const t of u)for(const e in t)a(e,t[e]);return o},close(){const a=r.pop();return t+=e?e+(n?">".concat(n,"</").concat(a,">"):"/>"):"</".concat(a,">"),i(),o},attr:a,text:t=>(n+=jmt(t),o),toString:()=>t};return o}const Wmt=t=>Vmt(Umt(),t)+"";function Vmt(t,e){if(t.open(e.tagName),e.hasAttributes()){const n=e.attributes,r=n.length;for(let e=0;e<r;++e)t.attr(n[e].name,n[e].value)}if(e.hasChildNodes()){const n=e.childNodes;for(const e of n)3===e.nodeType?t.text(e.nodeValue):Vmt(t,e)}return t.close()}const qmt={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},Gmt={blend:"mix-blend-mode"},Hmt={fill:"none","stroke-miterlimit":10},Ymt="http://www.w3.org/2000/xmlns/",Xmt=agt.xmlns;function Kmt(t){Qgt.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const Qmt=Qgt.prototype;function Zmt(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function $mt(t,e,n){let r,i,a;if("radial"===e.gradient){let r=qgt(t,n++,"pattern",Xmt);ovt(r,{id:Qdt+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=qgt(r,0,"rect",Xmt),ovt(r,{width:1,height:1,fill:"url(".concat(cvt(),"#").concat(e.id,")")}),ovt(t=qgt(t,n++,"radialGradient",Xmt),{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else ovt(t=qgt(t,n++,"linearGradient",Xmt),{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(r=0,i=e.stops.length;r<i;++r)a=qgt(t,r,"stop",Xmt),a.setAttribute("offset",e.stops[r].offset),a.setAttribute("stop-color",e.stops[r].color);return Ggt(t,r),n}function Jmt(t,e,n){let r;return(t=qgt(t,n,"clipPath",Xmt)).setAttribute("id",e.id),e.path?(r=qgt(t,0,"path",Xmt),r.setAttribute("d",e.path)):(r=qgt(t,0,"rect",Xmt),ovt(r,{x:0,y:0,width:e.width,height:e.height})),Ggt(t,1),n+1}function tvt(t,e,n,r,i){let a,o=t._svg;if(!o&&(a=e.ownerDocument,o=Wgt(a,r,Xmt),t._svg=o,t.mark&&(o.__data__=t,o.__values__={fill:"default"},"g"===r))){const e=Wgt(a,"path",Xmt);o.appendChild(e),e.__data__=t;const n=Wgt(a,"g",Xmt);o.appendChild(n),n.__data__=t;const r=Wgt(a,"path",Xmt);o.appendChild(r),r.__data__=t,r.__values__={fill:"default"}}return(o.ownerSVGElement!==i||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}(o,n))&&e.insertBefore(o,n?n.nextSibling:e.firstChild),o}Hot(Kmt,Qgt,{initialize(t,e,n,r,i){return this._defs={},this._clearDefs(),t&&(this._svg=qgt(t,0,"svg",Xmt),this._svg.setAttributeNS(Ymt,"xmlns",Xmt),this._svg.setAttributeNS(Ymt,"xmlns:xlink",agt["xmlns:xlink"]),this._svg.setAttribute("version",agt.version),this._svg.setAttribute("class","marks"),Ggt(t,1),this._root=qgt(this._svg,0,"g",Xmt),ovt(this._root,Hmt),Ggt(this._svg,1)),this.background(this._bgcolor),Qmt.initialize.call(this,t,e,n,r,i)},background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),Qmt.background.apply(this,arguments)},resize(t,e,n,r){return Qmt.resize.call(this,t,e,n,r),this._svg&&(ovt(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas(){return this._svg},svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=qgt(t,0,"rect",Xmt),ovt(n,{width:this._width,height:this._height,fill:e}));const r=Wmt(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),r},_render(t,e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t,void 0,e),Ggt(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const e=++this._dirtyID;let n,r,i,a,o,s,c;for(o=0,s=t.length;o<s;++o)n=t[o],r=n.mark,r.marktype!==i&&(i=r.marktype,a=Ugt[i]),r.zdirty&&r.dirty!==e&&(this._dirtyAll=!1,Zmt(n,e),r.items.forEach((t=>{t.dirty=e}))),r.zdirty||(n.exit?(a.nested&&r.items.length?(c=r.items[0],c._svg&&this._update(a,c._svg,c)):n._svg&&(c=n._svg.parentNode,c&&c.removeChild(n._svg)),n._svg=null):(n=a.nested?r.items[0]:n,n._update!==e&&(n._svg&&n._svg.ownerSVGElement?this._update(a,n._svg,n):(this._dirtyAll=!1,Zmt(n,e)),n._update=e)));return!this._dirtyAll},mark(t,e,n,r){if(!this.isDirty(e))return e._svg;const i=this._svg,a=e.marktype,o=Ugt[a],s=!1===e.interactive?"none":null,c="g"===o.tag,u=tvt(e,t,n,"g",i);if("group"!==a&&null!=r&&!r.includes(a))return Ggt(u,0),e._svg;u.setAttribute("class",Hgt(e));const l=Bmt(e);for(const p in l)svt(u,p,l[p]);c||svt(u,"pointer-events",s),svt(u,"clip-path",e.clip?Gft(this,e,e.group):null);let h=null,d=0;const f=t=>{const e=this.isDirty(t),n=tvt(t,u,h,o.tag,i);e&&(this._update(o,n,t),c&&function(t,e,n,r){e=e.lastChild.previousSibling;let i,a=0;zpt(n,(n=>{i=t.mark(e,n,i,r),++a})),Ggt(e,1+a)}(this,n,t,r)),h=n,++d};return o.nested?e.items.length&&f(e.items[0]):zpt(e,f),Ggt(u,d),u},_update(t,e,n){evt=e,nvt=e.__values__,zmt(ivt,n),t.attr(ivt,n,this);const r=rvt[t.type];r&&r.call(this,t,e,n),evt&&this.style(evt,n)},style(t,e){if(null!=e){for(const n in qmt){let r="font"===n?Igt(e):e[n];if(r===nvt[n])continue;const i=qmt[n];null==r?t.removeAttribute(i):(Zdt(r)&&(r=$dt(r,this._defs.gradient,cvt())),t.setAttribute(i,r+"")),nvt[n]=r}for(const n in Gmt)avt(t,Gmt[n],e[n])}},defs(){const t=this._svg,e=this._defs;let n=e.el,r=0;for(const i in e.gradient)n||(e.el=n=qgt(t,1,"defs",Xmt)),r=$mt(n,e.gradient[i],r);for(const i in e.clipping)n||(e.el=n=qgt(t,1,"defs",Xmt)),r=Jmt(n,e.clipping[i],r);n&&(0===r?(t.removeChild(n),e.el=null):Ggt(n,r))},_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}});let evt=null,nvt=null;const rvt={group(t,e,n){const r=evt=e.childNodes[2];nvt=r.__values__,t.foreground(ivt,n,this),nvt=e.__values__,evt=e.childNodes[1],t.content(ivt,n,this);const i=evt=e.childNodes[0];t.background(ivt,n,this);const a=!1===n.mark.interactive?"none":null;if(a!==nvt.events&&(svt(r,"pointer-events",a),svt(i,"pointer-events",a),nvt.events=a),n.strokeForeground&&n.stroke){const t=n.fill;svt(r,"display",null),this.style(i,n),svt(i,"stroke",null),t&&(n.fill=null),nvt=r.__values__,this.style(r,n),t&&(n.fill=t),evt=null}else svt(r,"display","none")},image(t,e,n){!1===n.smooth?(avt(e,"image-rendering","optimizeSpeed"),avt(e,"image-rendering","pixelated")):avt(e,"image-rendering",null)},text(t,e,n){const r=Fgt(n);let i,a,o,s;Fot(r)?(a=r.map((t=>Dgt(n,t))),i=a.join("\n"),i!==nvt.text&&(Ggt(e,0),o=e.ownerDocument,s=Ngt(n),a.forEach(((t,r)=>{const i=Wgt(o,"tspan",Xmt);i.__data__=n,i.textContent=t,r&&(i.setAttribute("x",0),i.setAttribute("dy",s)),e.appendChild(i)})),nvt.text=i)):(a=Dgt(n,r),a!==nvt.text&&(e.textContent=a,nvt.text=a)),svt(e,"font-family",Igt(n)),svt(e,"font-size",Tgt(n)+"px"),svt(e,"font-style",n.fontStyle),svt(e,"font-variant",n.fontVariant),svt(e,"font-weight",n.fontWeight)}};function ivt(t,e,n){e!==nvt[t]&&(n?function(t,e,n,r){null!=n?t.setAttributeNS(r,e,n):t.removeAttributeNS(r,e)}(evt,t,e,n):svt(evt,t,e),nvt[t]=e)}function avt(t,e,n){n!==nvt[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),nvt[e]=n)}function ovt(t,e){for(const n in e)svt(t,n,e[n])}function svt(t,e,n){null!=n?t.setAttribute(e,n):t.removeAttribute(e)}function cvt(){let t;return"undefined"===typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function uvt(t){Qgt.call(this,t),this._text=null,this._defs={gradient:{},clipping:{}}}Hot(uvt,Qgt,{svg(){return this._text},_render(t){const e=Umt();e.open("svg",Vot({},agt,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",Hmt,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this},mark(t,e){const n=Ugt[e.marktype],r=n.tag,i=[zmt,n.attr];t.open("g",{class:Hgt(e),"clip-path":e.clip?Gft(this,e,e.group):null},Bmt(e),{"pointer-events":"g"!==r&&!1===e.interactive?"none":null});const a=a=>{const o=this.href(a);if(o&&t.open("a",o),t.open(r,this.attr(e,a,i,"g"!==r?r:null)),"text"===r){const e=Fgt(a);if(Fot(e)){const n={x:0,dy:Ngt(a)};for(let r=0;r<e.length;++r)t.open("tspan",r?n:null).text(Dgt(a,e[r])).close()}else t.text(Dgt(a,e))}else if("g"===r){const r=a.strokeForeground,i=a.fill,o=a.stroke;r&&o&&(a.stroke=null),t.open("path",this.attr(e,a,n.background,"bgrect")).close(),t.open("g",this.attr(e,a,n.content)),zpt(a,(e=>this.mark(t,e))),t.close(),r&&o?(i&&(a.fill=null),a.stroke=o,t.open("path",this.attr(e,a,n.foreground,"bgrect")).close(),i&&(a.fill=i)):t.open("path",this.attr(e,a,n.foreground,"bgfore")).close()}t.close(),o&&t.close()};return n.nested?e.items&&e.items.length&&a(e.items[0]):zpt(e,a),t.close()},href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then((t=>{t["xlink:href"]=t.href,t.href=null,(this._hrefs||(this._hrefs={}))[e]=t}))}return null},attr(t,e,n,r){const i={},a=(t,e,n,r)=>{i[r||t]=e};return Array.isArray(n)?n.forEach((t=>t(a,e,this))):n(a,e,this),r&&function(t,e,n,r,i){let a;if(null==e)return t;"bgrect"===r&&!1===n.interactive&&(t["pointer-events"]="none");if("bgfore"===r&&(!1===n.interactive&&(t["pointer-events"]="none"),t.display="none",null!==e.fill))return t;"image"===r&&!1===e.smooth&&(a=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]);"text"===r&&(t["font-family"]=Igt(e),t["font-size"]=Tgt(e)+"px",t["font-style"]=e.fontStyle,t["font-variant"]=e.fontVariant,t["font-weight"]=e.fontWeight);for(const o in qmt){let n=e[o];const r=qmt[o];("transparent"!==n||"fill"!==r&&"stroke"!==r)&&null!=n&&(Zdt(n)&&(n=$dt(n,i.gradient,"")),t[r]=n)}for(const o in Gmt){const t=e[o];null!=t&&(a=a||[],a.push("".concat(Gmt[o],": ").concat(t,";")))}a&&(t.style=a.join(" "))}(i,e,t,r,this._defs),i},defs(t){const e=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(e).length+Object.keys(n).length){t.open("defs");for(const n in e){const r=e[n],i=r.stops;"radial"===r.gradient?(t.open("pattern",{id:Qdt+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),t.close(),t.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):t.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let e=0;e<i.length;++e)t.open("stop",{offset:i[e].offset,"stop-color":i[e].color}).close();t.close()}for(const e in n){const r=n[e];t.open("clipPath",{id:e}),r.path?t.open("path",{d:r.path}).close():t.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),t.close()}t.close()}}});const lvt={svgMarkTypes:["text"],svgOnTop:!0,debug:!1};function hvt(t){Qgt.call(this,t),this._svgRenderer=new Kmt(t),this._canvasRenderer=new kmt(t)}const dvt=Qgt.prototype;function fvt(t,e){mmt.call(this,t,e)}Hot(hvt,Qgt,{initialize(t,e,n,r,i){this._root_el=qgt(t,0,"div");const a=qgt(this._root_el,0,"div"),o=qgt(this._root_el,1,"div");return this._root_el.style.position="relative",lvt.debug||(a.style.height="100%",o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.height="100%",o.style.width="100%"),this._svgEl=lvt.svgOnTop?o:a,this._canvasEl=lvt.svgOnTop?a:o,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,e,n,r,i),this._svgRenderer.initialize(this._svgEl,e,n,r,i),dvt.initialize.call(this,t,e,n,r,i)},dirty(t){return lvt.svgMarkTypes.includes(t.mark.marktype)?this._svgRenderer.dirty(t):this._canvasRenderer.dirty(t),this},_render(t,e){const n=(null!==e&&void 0!==e?e:["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter((t=>!lvt.svgMarkTypes.includes(t)));this._svgRenderer.render(t,lvt.svgMarkTypes),this._canvasRenderer.render(t,n)},resize(t,e,n,r){return dvt.resize.call(this,t,e,n,r),this._svgRenderer.resize(t,e,n,r),this._canvasRenderer.resize(t,e,n,r),this},background(t){return lvt.svgOnTop?this._canvasRenderer.background(t):this._svgRenderer.background(t),this}}),Hot(fvt,mmt,{initialize(t,e,n){const r=qgt(qgt(t,0,"div"),lvt.svgOnTop?0:1,"div");return mmt.prototype.initialize.call(this,r,e,n)}});const pvt="canvas",gvt="hybrid",mvt="none",vvt={};function yvt(t,e,n,r){if(function(t,e,n){return t.bounds&&e.intersects(t.bounds)&&("group"===t.marktype||!1!==t.interactive&&(!n||n(t)))}(t,e,n)){const i=t.items,a=t.marktype,o=i.length;let s=0;if("group"===a)for(;s<o;++s)bvt(i[s],e,n,r);else for(const t=Ugt[a].isect;s<o;++s){const n=i[s];xvt(n,e,t)&&r.push(n)}}return r}function bvt(t,e,n,r){n&&n(t.mark)&&xvt(t,e,Ugt.group.isect)&&r.push(t);const i=t.items,a=i&&i.length;if(a){const o=t.x||0,s=t.y||0;e.translate(-o,-s);for(let t=0;t<a;++t)yvt(i[t],e,n,r);e.translate(o,s)}return r}function xvt(t,e,n){const r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}vvt[pvt]=vvt.png={renderer:kmt,headless:kmt,handler:mmt},vvt.svg={renderer:Kmt,headless:uvt,handler:Amt},vvt[gvt]={renderer:hvt,headless:hvt,handler:fvt},vvt[mvt]={};new Hft;var wvt=Math.random;const kvt=Math.sqrt(2*Math.PI),_vt=Math.SQRT2;let Avt=NaN;function Cvt(t,e){t=t||0,e=null==e?1:e;let n,r,i=0,a=0;if(Avt===Avt)i=Avt,Avt=NaN;else{do{i=2*wvt()-1,a=2*wvt()-1,n=i*i+a*a}while(0===n||n>1);r=Math.sqrt(-2*Math.log(n)/n),i*=r,Avt=a*r}return t+i*e}function Svt(t,e,n){const r=(t-(e||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*kvt)}function Evt(t,e,n){const r=(t-(e=e||0))/(n=null==n?1:n),i=Math.abs(r);let a;if(i>37)a=0;else{const t=Math.exp(-i*i/2);let e;i<7.07106781186547?(e=.0352624965998911*i+.700383064443688,e=e*i+6.37396220353165,e=e*i+33.912866078383,e=e*i+112.079291497871,e=e*i+221.213596169931,e=e*i+220.206867912376,a=t*e,e=.0883883476483184*i+1.75566716318264,e=e*i+16.064177579207,e=e*i+86.7807322029461,e=e*i+296.564248779674,e=e*i+637.333633378831,e=e*i+793.826512519948,e=e*i+440.413735824752,a/=e):(e=i+.65,e=i+4/e,e=i+3/e,e=i+2/e,e=i+1/e,a=t/e/2.506628274631)}return r>0?1-a:a}function Tvt(t,e,n){return t<0||t>1?NaN:(e||0)+(null==n?1:n)*_vt*function(t){let e,n=-Math.log((1-t)*(1+t));n<6.25?(n-=3.125,e=-364441206401782e-35,e=e*n-16850591381820166e-35,e=128584807152564e-32+e*n,e=11157877678025181e-33+e*n,e=e*n-1333171662854621e-31,e=20972767875968562e-33+e*n,e=6637638134358324e-30+e*n,e=e*n-4054566272975207e-29,e=e*n-8151934197605472e-29,e=26335093153082323e-28+e*n,e=e*n-12975133253453532e-27,e=e*n-5415412054294628e-26,e=1.0512122733215323e-9+e*n,e=e*n-4.112633980346984e-9,e=e*n-2.9070369957882005e-8,e=4.2347877827932404e-7+e*n,e=e*n-13654692000834679e-22,e=e*n-13882523362786469e-21,e=.00018673420803405714+e*n,e=e*n-.000740702534166267,e=e*n-.006033670871430149,e=.24015818242558962+e*n,e=1.6536545626831027+e*n):n<16?(n=Math.sqrt(n)-3.25,e=2.2137376921775787e-9,e=9.075656193888539e-8+e*n,e=e*n-2.7517406297064545e-7,e=1.8239629214389228e-8+e*n,e=15027403968909828e-22+e*n,e=e*n-4013867526981546e-21,e=29234449089955446e-22+e*n,e=12475304481671779e-21+e*n,e=e*n-47318229009055734e-21,e=6828485145957318e-20+e*n,e=24031110387097894e-21+e*n,e=e*n-.0003550375203628475,e=.0009532893797373805+e*n,e=e*n-.0016882755560235047,e=.002491442096107851+e*n,e=e*n-.003751208507569241,e=.005370914553590064+e*n,e=1.0052589676941592+e*n,e=3.0838856104922208+e*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,e=-27109920616438573e-27,e=e*n-2.555641816996525e-10,e=1.5076572693500548e-9+e*n,e=e*n-3.789465440126737e-9,e=7.61570120807834e-9+e*n,e=e*n-1.496002662714924e-8,e=2.914795345090108e-8+e*n,e=e*n-6.771199775845234e-8,e=2.2900482228026655e-7+e*n,e=e*n-9.9298272942317e-7,e=4526062597223154e-21+e*n,e=e*n-1968177810553167e-20,e=7599527703001776e-20+e*n,e=e*n-.00021503011930044477,e=e*n-.00013871931833623122,e=1.0103004648645344+e*n,e=4.849906401408584+e*n):e=1/0;return e*t}(2*t-1)}function Nvt(t,e){return t=t||0,e=null==e?1:e,Math.exp(t+Cvt()*e)}function Fvt(t,e,n){if(t<=0)return 0;e=e||0,n=null==n?1:n;const r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*kvt*t)}function Dvt(t,e,n){return Evt(Math.log(t),e,n)}function Ivt(t,e,n){return Math.exp(Tvt(t,e,n))}function Mvt(t,e){return null==e&&(e=null==t?1:t,t=0),t+(e-t)*wvt()}function Ovt(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=e&&t<=n?1/(n-e):0}function Rvt(t,e,n){return null==n&&(n=null==e?1:e,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function zvt(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=0&&t<=1?e+t*(n-e):NaN}Math.PI;function Bvt(t){const e=this.context.data[t];return e?e.values.value:[]}const Lvt=t=>function(e,n){return this.context.dataflow.locale()[t](n)(e)},Pvt=Lvt("format"),jvt=Lvt("timeFormat"),Uvt=Lvt("utcFormat"),Wvt=Lvt("timeParse"),Vvt=Lvt("utcParse"),qvt=new Date(2e3,0,1);function Gvt(t,e,n){return Number.isInteger(t)&&Number.isInteger(e)?(qvt.setYear(2e3),qvt.setMonth(t),qvt.setDate(e),jvt.call(this,qvt,n)):""}const Hvt="%";function Yvt(t,e,n,r){e[0].type!==rst&&Cot("First argument to data functions must be a string literal.");const i=e[0].value,a=":"+i;if(!Got(a,r))try{r[a]=n.getData(i).tuplesRef()}catch(o){}}function Xvt(t,e,n,r){if(e[0].type===rst)Kvt(n,r,e[0].value);else for(t in n.scales)Kvt(n,r,t)}function Kvt(t,e,n){const r=Hvt+n;if(!Got(e,r))try{e[r]=t.scaleRef(n)}catch(i){}}function Qvt(t,e){let n;return Wot(t)?t:Kot(t)?(n=e.scales[t])&&n.value:void 0}function Zvt(t,e,n){e.__bandwidth=t=>t&&t.bandwidth?t.bandwidth():0,n._bandwidth=Xvt,n._range=Xvt,n._scale=Xvt;const r=e=>"_["+(e.type===rst?Zot(Hvt+e.value):Zot(Hvt)+"+"+t(e))+"]";return{_bandwidth:t=>"this.__bandwidth(".concat(r(t[0]),")"),_range:t=>"".concat(r(t[0]),".range()"),_scale:e=>"".concat(r(e[0]),"(").concat(t(e[1]),")")}}function $vt(t,e){return function(n,r,i){if(n){const e=Qvt(n,(i||this).context);return e&&e.path[t](r)}return e(r)}}const Jvt=$vt("area",(function(t){return Wst=new W3,U3(t,Vst),2*Wst})),tyt=$vt("bounds",(function(t){var e,n,r,i,a,o,s;if(Mst=Ist=-(Fst=Dst=1/0),Pst=[],U3(t,lct),n=Pst.length){for(Pst.sort(bct),e=1,a=[r=Pst[0]];e<n;++e)xct(r,(i=Pst[e])[0])||xct(r,i[1])?(yct(r[0],i[1])>yct(r[0],r[1])&&(r[1]=i[1]),yct(i[0],r[1])>yct(r[0],r[1])&&(r[0]=i[0])):a.push(r=i);for(o=-1/0,e=0,r=a[n=a.length-1];e<=n;r=i,++e)i=a[e],(s=yct(r[1],i[0]))>o&&(o=s,Fst=i[0],Ist=r[1])}return Pst=jst=null,Fst===1/0||Dst===1/0?[[NaN,NaN],[NaN,NaN]]:[[Fst,Dst],[Ist,Mst]]})),eyt=$vt("centroid",(function(t){Xst=Kst=Qst=Zst=$st=Jst=tct=ect=0,nct=new W3,rct=new W3,ict=new W3,U3(t,wct);var e=+nct,n=+rct,r=+ict,i=LD(e,n,r);return i<CD&&(e=Jst,n=tct,r=ect,Kst<AD&&(e=Qst,n=Zst,r=$st),(i=LD(e,n,r))<CD)?[NaN,NaN]:[OD(n,e)*FD,HD(r/i)*FD]}));function nyt(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(r){t.warn(r)}return n[n.length-1]}function ryt(t){const e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function iyt(t){const e=DC(t);return.2126*ryt(e.r)+.7152*ryt(e.g)+.0722*ryt(e.b)}function ayt(t,e){return t===e||t!==t&&e!==e||(Fot(t)?!(!Fot(e)||t.length!==e.length)&&function(t,e){for(let n=0,r=t.length;n<r;++n)if(!ayt(t[n],e[n]))return!1;return!0}(t,e):!(!Dot(t)||!Dot(e))&&oyt(t,e))}function oyt(t,e){for(const n in t)if(!ayt(t[n],e[n]))return!1;return!0}function syt(t){return e=>oyt(t,e)}const cyt={};function uyt(t){return Fot(t)||ArrayBuffer.isView(t)?t:null}function lyt(t){return uyt(t)||(Kot(t)?t:null)}const hyt=t=>t.data;function dyt(t,e){const n=Bvt.call(e,t);return n.root&&n.root.lookup||{}}const fyt=()=>"undefined"!==typeof window&&window||null;const pyt={random:()=>wvt(),cumulativeNormal:Evt,cumulativeLogNormal:Dvt,cumulativeUniform:Rvt,densityNormal:Svt,densityLogNormal:Fvt,densityUniform:Ovt,quantileNormal:Tvt,quantileLogNormal:Ivt,quantileUniform:zvt,sampleNormal:Cvt,sampleLogNormal:Nvt,sampleUniform:Mvt,isArray:Fot,isBoolean:function(t){return"boolean"===typeof t},isDate:Yot,isDefined:t=>void 0!==t,isNumber:Xot,isObject:Dot,isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},isString:Kot,isTuple:$s,isValid:t=>null!=t&&t===t,toBoolean:$ot,toDate:tst,toNumber:Mot,toString:est,indexof:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return lyt(t).indexOf(...n)},join:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return uyt(t).join(...n)},lastindexof:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return lyt(t).lastIndexOf(...n)},replace:function(t,e,n){return Wot(n)&&Cot("Function argument passed to replace."),String(t).replace(e,n)},reverse:function(t){return uyt(t).slice().reverse()},slice:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return lyt(t).slice(...n)},flush:function(t,e,n,r,i,a){if(!n&&0!==n)return a;const o=+n;let s,c=t[0],u=Iot(t);u<c&&(s=c,c=u,u=s),s=Math.abs(e-c);const l=Math.abs(u-e);return s<l&&s<=o?r:l<=o?i:a},lerp:function(t,e){const n=t[0],r=Iot(t),i=+e;return i?1===i?r:n+i*(r-n):n},merge:function(){const t=[].slice.call(arguments);return t.unshift({}),Vot(...t)},pad:function(t,e,n,r){const i=n||" ",a=t+"",o=e-a.length;return o<=0?a:"left"===r?Qot(i,o)+a:"center"===r?Qot(i,~~(o/2))+a+Qot(i,Math.ceil(o/2)):a+Qot(i,o)},peek:Iot,pluck:function(t,e){const n=cyt[e]||(cyt[e]=Eot(e));return Fot(t)?t.map(n):n(t)},span:function(t){return t&&Iot(t)-t[0]||0},inrange:function(t,e,n,r){let i,a=e[0],o=e[e.length-1];return a>o&&(i=a,a=o,o=i),r=void 0===r||r,((n=void 0===n||n)?a<=t:a<t)&&(r?t<=o:t<o)},truncate:function(t,e,n,r){const i=null!=r?r:"\u2026",a=t+"",o=a.length,s=Math.max(0,e-i.length);return o<=e?a:"left"===n?i+a.slice(o-s):"center"===n?a.slice(0,Math.ceil(s/2))+i+a.slice(o-~~(s/2)):a.slice(0,s)+i},rgb:DC,lab:g2,hcl:k2,hsl:LC,luminance:iyt,contrast:function(t,e){const n=iyt(t),r=iyt(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:zu,format:Pvt,utcFormat:Uvt,utcParse:Vvt,utcOffset:function(t,e,n){return fht(dht(t),e,n)},utcSequence:function(t,e,n,r){return pht(dht(t),e,n,r)},timeFormat:jvt,timeParse:Wvt,timeOffset:function(t,e,n){return fht(hht(t),e,n)},timeSequence:function(t,e,n,r){return pht(hht(t),e,n,r)},timeUnitSpecifier:function(t,e){const n=Vot({},nht,e),r=function(t){const e=Uot(t).slice(),n={};return e.length||Cot("Missing time unit."),e.forEach((t=>{Got(eht,t)?n[t]=1:Cot("Invalid time unit: ".concat(t,"."))})),(n[Ylt]||n[Klt]?1:0)+(n[Glt]||n[Hlt]||n[Xlt]?1:0)+(n[Qlt]?1:0)>1&&Cot("Incompatible time units: ".concat(t)),e.sort(((t,e)=>eht[t]-eht[e])),e}(t),i=r.length;let a,o,s="",c=0;for(c=0;c<i;)for(a=r.length;a>c;--a)if(o=r.slice(c,a).join("-"),null!=n[o]){s+=n[o],c=a;break}return s.trim()},monthFormat:function(t){return Gvt.call(this,t,1,"%B")},monthAbbrevFormat:function(t){return Gvt.call(this,t,1,"%b")},dayFormat:function(t){return Gvt.call(this,0,2+t,"%A")},dayAbbrevFormat:function(t){return Gvt.call(this,0,2+t,"%a")},quarter:function(t){return 1+~~(new Date(t).getMonth()/3)},utcquarter:function(t){return 1+~~(new Date(t).getUTCMonth()/3)},week:function(t){return oht(new Date(t))},utcweek:function(t){return cht(new Date(t))},dayofyear:function(t){return aht(new Date(t))},utcdayofyear:function(t){return sht(new Date(t))},warn:function(){return nyt(this.context.dataflow,"warn",arguments)},info:function(){return nyt(this.context.dataflow,"info",arguments)},debug:function(){return nyt(this.context.dataflow,"debug",arguments)},extent:function(t,e){let n,r,i,a,o=0;if(t&&(n=t.length))if(null==e){for(r=t[o];o<n&&(null==r||r!==r);r=t[++o]);for(i=a=r;o<n;++o)r=t[o],null!=r&&(r<i&&(i=r),r>a&&(a=r))}else{for(r=e(t[o]);o<n&&(null==r||r!==r);r=e(t[++o]));for(i=a=r;o<n;++o)r=e(t[o]),null!=r&&(r<i&&(i=r),r>a&&(a=r))}return[i,a]},inScope:function(t){const e=this.context.group;let n=!1;if(e)for(;t;){if(t===e){n=!0;break}t=t.mark.group}return n},intersect:function(t,e,n){if(!t)return[];const[r,i]=t,a=(new Hft).set(r[0],r[1],i[0],i[1]);return function(t,e,n){const r=[],i=(new Hft).union(e),a=t.marktype;return a?yvt(t,i,n,r):"group"===a?bvt(t,i,n,r):Cot("Intersect scene must be mark node or group item.")}(n||this.context.dataflow.scenegraph().root,a,function(t){let e=null;if(t){const n=Uot(t.marktype),r=Uot(t.markname);e=t=>(!n.length||n.some((e=>t.marktype===e)))&&(!r.length||r.some((e=>t.name===e)))}return e}(e))},clampRange:function(t,e,n){let r,i=t[0],a=t[1];return a<i&&(r=a,a=i,i=r),r=a-i,r>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]},pinchDistance:function(t){const e=t.touches,n=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(n*n+r*r)},pinchAngle:function(t){const e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)},screen:function(){const t=fyt();return t?t.screen:{}},containerSize:function(){const t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]},windowSize:function(){const t=fyt();return t?[t.innerWidth,t.innerHeight]:[void 0,void 0]},bandspace:function(t,e,n){return bht(t||0,e||0,n||0)},setdata:function(t,e){const n=this.context.dataflow,r=this.context.data[t].input;return n.pulse(r,n.changeset().remove(Not).insert(e)),1},pathShape:function(t){let e=null;return function(n){return n?yft(n,e=e||sft(t)):t}},panLinear:function(t,e){return Pot(t,e,Mot,Tot)},panLog:function(t,e){var n=Math.sign(t[0]);return Pot(t,e,Rot(n),Oot(n))},panPow:function(t,e,n){return Pot(t,e,Lot(n),Lot(1/n))},panSymlog:function(t,e,n){return Pot(t,e,zot(n),Bot(n))},zoomLinear:function(t,e,n){return jot(t,e,n,Mot,Tot)},zoomLog:function(t,e,n){const r=Math.sign(t[0]);return jot(t,e,n,Rot(r),Oot(r))},zoomPow:function(t,e,n,r){return jot(t,e,n,Lot(r),Lot(1/r))},zoomSymlog:function(t,e,n,r){return jot(t,e,n,zot(r),Bot(r))},encode:function(t,e,n){if(t){const n=this.context.dataflow,r=t.mark.source;n.pulse(r,n.changeset().encode(t,e))}return void 0!==n?n:t},modify:function(t,e,n,r,i,a){const o=this.context.dataflow,s=this.context.data[t],c=s.input,u=o.stamp();let l,h,d=s.changes;if(!1===o._trigger||!(c.value.length||e||r))return 0;if((!d||d.stamp<u)&&(s.changes=d=o.changeset(),d.stamp=u,o.runAfter((()=>{s.modified=!0,o.pulse(c,d).run()}),!0,1)),n&&(l=!0===n?Not:Fot(n)||$s(n)?n:syt(n),d.remove(l)),e&&d.insert(e),r&&(l=syt(r),c.value.some(l)?d.remove(l):d.insert(r)),i)for(h in a)d.modify(i,h,a[h]);return 1}},gyt=["view","item","group","xy","x","y"],myt="this.",vyt={},yyt={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:t=>"_[".concat(Zot("$"+t),"]"),functions:function(t){const e=Ast(t);gyt.forEach((t=>e[t]="event.vega."+t));for(const n in pyt)e[n]=myt+n;return Vot(e,Zvt(t,pyt,vyt)),e},constants:_st,visitors:vyt},byt=function(t){const e=(t=t||{}).allowed?nst(t.allowed):{},n=t.forbidden?nst(t.forbidden):{},r=t.constants||_st,i=(t.functions||Ast)(h),a=t.globalvar,o=t.fieldvar,s=Wot(a)?a:t=>"".concat(a,'["').concat(t,'"]');let c={},u={},l=0;function h(t){if(Kot(t))return t;const e=d[t.type];return null==e&&Cot("Unsupported type: "+t.type),e(t)}const d={Literal:t=>t.raw,Identifier:t=>{const i=t.name;return l>0?i:Got(n,i)?Cot("Illegal identifier: "+i):Got(r,i)?r[i]:Got(e,i)?i:(c[i]=1,s(i))},MemberExpression:t=>{const e=!t.computed,n=h(t.object);e&&(l+=1);const r=h(t.property);return n===o&&(u[function(t){const e=t&&t.length-1;return e&&('"'===t[0]&&'"'===t[e]||"'"===t[0]&&"'"===t[e])?t.slice(1,-1):t}(r)]=1),e&&(l-=1),n+(e?"."+r:"["+r+"]")},CallExpression:t=>{"Identifier"!==t.callee.type&&Cot("Illegal callee type: "+t.callee.type);const e=t.callee.name,n=t.arguments,r=Got(i,e)&&i[e];return r||Cot("Unrecognized function: "+e),Wot(r)?r(n):r+"("+n.map(h).join(",")+")"},ArrayExpression:t=>"["+t.elements.map(h).join(",")+"]",BinaryExpression:t=>"("+h(t.left)+" "+t.operator+" "+h(t.right)+")",UnaryExpression:t=>"("+t.operator+h(t.argument)+")",ConditionalExpression:t=>"("+h(t.test)+"?"+h(t.consequent)+":"+h(t.alternate)+")",LogicalExpression:t=>"("+h(t.left)+t.operator+h(t.right)+")",ObjectExpression:t=>"{"+t.properties.map(h).join(",")+"}",Property:t=>{l+=1;const e=h(t.key);return l-=1,e+":"+h(t.value)}};function f(t){const e={code:h(t),globals:Object.keys(c),fields:Object.keys(u)};return c={},u={},e}return f.functions=i,f.constants=r,f}(yyt);function xyt(t,e,n){return 1===arguments.length?pyt[t]:(pyt[t]=e,n&&(vyt[t]=n),byt&&(byt.functions[t]=myt+t),this)}xyt("bandwidth",(function(t,e){const n=Qvt(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0}),Xvt),xyt("copy",(function(t,e){const n=Qvt(t,(e||this).context);return n?n.copy():void 0}),Xvt),xyt("domain",(function(t,e){const n=Qvt(t,(e||this).context);return n?n.domain():[]}),Xvt),xyt("range",(function(t,e){const n=Qvt(t,(e||this).context);return n&&n.range?n.range():[]}),Xvt),xyt("invert",(function(t,e,n){const r=Qvt(t,(n||this).context);return r?Fot(e)?(r.invertRange||r.invert)(e):(r.invert||r.invertExtent)(e):void 0}),Xvt),xyt("scale",(function(t,e,n){const r=Qvt(t,(n||this).context);return r?r(e):void 0}),Xvt),xyt("gradient",(function(t,e,n,r,i){t=Qvt(t,(i||this).context);const a=function(t,e){var n,r=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:r,stop:function(t,e){return r.push({offset:t,color:e}),n}}}(e,n);let o=t.domain(),s=o[0],c=Iot(o),u=Tot;return c-s?u=Kht(t,s,c):t=(t.interpolator?qht("sequential")().interpolator(t.interpolator()):qht("linear")().interpolate(t.interpolate()).range(t.range())).domain([s=0,c=1]),t.ticks&&(o=t.ticks(+r||15),s!==o[0]&&o.unshift(s),c!==Iot(o)&&o.push(c)),o.forEach((e=>a.stop(u(e),t(e)))),a}),Xvt),xyt("geoArea",Jvt,Xvt),xyt("geoBounds",tyt,Xvt),xyt("geoCentroid",eyt,Xvt),xyt("geoShape",(function(t,e,n){const r=Qvt(t,(n||this).context);return function(t){return r?r.path.context(t)(e):""}}),Xvt),xyt("indata",(function(t,e,n){const r=this.context.data[t]["index:"+e],i=r?r.value.get(n):void 0;return i?i.count:i}),(function(t,e,n,r){e[0].type!==rst&&Cot("First argument to indata must be a string literal."),e[1].type!==rst&&Cot("Second argument to indata must be a string literal.");const i=e[0].value,a=e[1].value,o="@"+a;Got(o,r)||(r[o]=n.getData(i).indataRef(n,a))})),xyt("data",Bvt,Yvt),xyt("treePath",(function(t,e,n){const r=dyt(t,this),i=r[e],a=r[n];return i&&a?i.path(a).map(hyt):void 0}),Yvt),xyt("treeAncestors",(function(t,e){const n=dyt(t,this)[e];return n?n.ancestors().map(hyt):void 0}),Yvt),xyt("vlSelectionTest",cet,vet),xyt("vlSelectionIdTest",fet,vet),xyt("vlSelectionResolve",get,vet),xyt("vlSelectionTuples",pet);const wyt="view",kyt="[",_yt="]",Ayt="{",Cyt="}",Syt=":",Eyt=",",Tyt="@",Nyt=">",Fyt=/[[\]{}]/,Dyt={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let Iyt,Myt;function Oyt(t,e,n,r,i){const a=t.length;let o,s=0;for(;e<a;++e){if(o=t[e],!s&&o===n)return e;i&&i.indexOf(o)>=0?--s:r&&r.indexOf(o)>=0&&++s}return e}function Ryt(t){const e=[],n=t.length;let r=0,i=0;for(;i<n;)i=Oyt(t,i,Eyt,kyt+Ayt,_yt+Cyt),e.push(t.substring(r,i).trim()),r=++i;if(0===e.length)throw"Empty event selector: "+t;return e}function zyt(t){return"["===t[0]?function(t){const e=t.length;let n,r=1;if(r=Oyt(t,r,_yt,kyt,_yt),r===e)throw"Empty between selector: "+t;if(n=Ryt(t.substring(1,r)),2!==n.length)throw"Between selector must have two elements: "+t;if(t=t.slice(r+1).trim(),t[0]!==Nyt)throw"Expected '>' after between selector: "+t;n=n.map(zyt);const i=zyt(t.slice(1).trim());if(i.between)return{between:n,stream:i};i.between=n;return i}(t):function(t){const e={source:Iyt},n=[];let r,i,a=[0,0],o=0,s=0,c=t.length,u=0;if(t[c-1]===Cyt){if(u=t.lastIndexOf(Ayt),!(u>=0))throw"Unmatched right brace: "+t;try{a=function(t){const e=t.split(Eyt);if(!t.length||e.length>2)throw t;return e.map((e=>{const n=+e;if(n!==n)throw t;return n}))}(t.substring(u+1,c-1))}catch(l){throw"Invalid throttle specification: "+t}c=(t=t.slice(0,u).trim()).length,u=0}if(!c)throw t;t[0]===Tyt&&(o=++u);r=Oyt(t,u,Syt),r<c&&(n.push(t.substring(s,r).trim()),s=u=++r);if(u=Oyt(t,u,kyt),u===c)n.push(t.substring(s,c).trim());else if(n.push(t.substring(s,u).trim()),i=[],s=++u,s===c)throw"Unmatched left bracket: "+t;for(;u<c;){if(u=Oyt(t,u,_yt),u===c)throw"Unmatched left bracket: "+t;if(i.push(t.substring(s,u).trim()),u<c-1&&t[++u]!==kyt)throw"Expected left bracket: "+t;s=++u}if(!(c=n.length)||Fyt.test(n[c-1]))throw"Invalid event selector: "+t;c>1?(e.type=n[1],o?e.markname=n[0].slice(1):!function(t){return Myt[t]}(n[0])?e.source=n[0]:e.marktype=n[0]):e.type=n[0];"!"===e.type.slice(-1)&&(e.consume=!0,e.type=e.type.slice(0,-1));null!=i&&(e.filter=i);a[0]&&(e.throttle=a[0]);a[1]&&(e.debounce=a[1]);return e}(t)}function Byt(t){return sn(t)?t:{type:t||"pad"}}const Lyt=t=>+t||0,Pyt=t=>({top:t,bottom:t,left:t,right:t});function jyt(t){return sn(t)?t.signal?t:{top:Lyt(t.top),bottom:Lyt(t.bottom),left:Lyt(t.left),right:Lyt(t.right)}:Pyt(Lyt(t))}const Uyt=t=>sn(t)&&!on(t)?On({},t):{value:t};function Wyt(t,e,n,r){if(null!=n){return sn(n)&&!on(n)||on(n)&&n.length&&sn(n[0])?t.update[e]=n:t[r||"enter"][e]={value:n},1}return 0}function Vyt(t,e,n){for(const r in e)Wyt(t,r,e[r]);for(const r in n)Wyt(t,r,n[r],"update")}function qyt(t,e,n){for(const r in e)n&&Bn(n,r)||(t[r]=On(t[r]||{},e[r]));return t}function Gyt(t,e){return e&&(e.enter&&e.enter[t]||e.update&&e.update[t])}const Hyt="mark",Yyt="frame",Xyt="scope",Kyt="axis",Qyt="axis-domain",Zyt="axis-grid",$yt="axis-label",Jyt="axis-tick",tbt="axis-title",ebt="legend",nbt="legend-band",rbt="legend-entry",ibt="legend-gradient",abt="legend-label",obt="legend-symbol",sbt="legend-title",cbt="title",ubt="title-text",lbt="title-subtitle";function hbt(t,e,n){t[e]=n&&n.signal?{signal:n.signal}:{value:n}}const dbt=t=>qn(t)?Xn(t):t.signal?"(".concat(t.signal,")"):mbt(t);function fbt(t){if(null!=t.gradient)return function(t){const e=[t.start,t.stop,t.count].map((t=>null==t?null:Xn(t)));for(;e.length&&null==hn(e);)e.pop();return e.unshift(dbt(t.gradient)),"gradient(".concat(e.join(","),")")}(t);let e=t.signal?"(".concat(t.signal,")"):t.color?function(t){return t.c?pbt("hcl",t.h,t.c,t.l):t.h||t.s?pbt("hsl",t.h,t.s,t.l):t.l||t.a?pbt("lab",t.l,t.a,t.b):t.r||t.g||t.b?pbt("rgb",t.r,t.g,t.b):null}(t.color):null!=t.field?mbt(t.field):void 0!==t.value?Xn(t.value):void 0;return null!=t.scale&&(e=function(t,e){const n=dbt(t.scale);null!=t.range?e="lerp(_range(".concat(n,"), ").concat(+t.range,")"):(void 0!==e&&(e="_scale(".concat(n,", ").concat(e,")")),t.band&&(e=(e?e+"+":"")+"_bandwidth(".concat(n,")")+(1===+t.band?"":"*"+gbt(t.band)),t.extra&&(e="(datum.extra ? _scale(".concat(n,", datum.extra.value) : ").concat(e,")"))),null==e&&(e="0"));return e}(t,e)),void 0===e&&(e=null),null!=t.exponent&&(e="pow(".concat(e,",").concat(gbt(t.exponent),")")),null!=t.mult&&(e+="*".concat(gbt(t.mult))),null!=t.offset&&(e+="+".concat(gbt(t.offset))),t.round&&(e="round(".concat(e,")")),e}const pbt=(t,e,n,r)=>"(".concat(t,"(").concat([e,n,r].map(fbt).join(","),")+'')");function gbt(t){return sn(t)?"("+fbt(t)+")":t}function mbt(t){return vbt(sn(t)?t:{datum:t})}function vbt(t){let e,n,r;if(t.signal)e="datum",r=t.signal;else if(t.group||t.parent){for(n=Math.max(1,t.level||1),e="item";n-- >0;)e+=".mark.group";t.parent?(r=t.parent,e+=".datum"):r=t.group}else t.datum?(e="datum",r=t.datum):qe("Invalid field reference: "+Xn(t));return t.signal||(r=qn(r)?Ge(r).map(Xn).join("]["):vbt(r)),e+"["+r+"]"}function ybt(t,e,n,r,i,a){const o={};(a=a||{}).encoders={$encode:o},t=function(t,e,n,r,i){const a={},o={};let s,c,u,l;for(c in c="lineBreak","text"!==e||null==i[c]||Gyt(c,t)||hbt(a,c,i[c]),("legend"==n||String(n).startsWith("axis"))&&(n=null),l=n===Yyt?i.group:n===Hyt?On({},i.mark,i[e]):null,l)u=Gyt(c,t)||("fill"===c||"stroke"===c)&&(Gyt("fill",t)||Gyt("stroke",t)),u||hbt(a,c,l[c]);for(c in An(r).forEach((e=>{const n=i.style&&i.style[e];for(const r in n)Gyt(r,t)||hbt(a,r,n[r])})),t=On({},t),a)l=a[c],l.signal?(s=s||{})[c]=l:o[c]=l;return t.enter=On(o,t.enter),s&&(t.update=On(s,t.update)),t}(t,e,n,r,i.config);for(const s in t)o[s]=bbt(t[s],e,a,i);return a}function bbt(t,e,n,r){const i={},a={};for(const s in t)null!=t[s]&&(i[s]=xbt((o=t[s],on(o)?function(t){let e="";return t.forEach((t=>{const n=fbt(t);e+=t.test?"(".concat(t.test,")?").concat(n,":"):n})),":"===hn(e)&&(e+="null"),e}(o):fbt(o)),r,n,a));var o;return{$expr:{marktype:e,channels:i},$fields:Object.keys(a),$output:Object.keys(t)}}function xbt(t,e,n,r){const i=ant(t,e);return i.$fields.forEach((t=>r[t]=1)),On(n,i.$params),i.$expr}const wbt="outer",kbt=["value","update","init","react","bind"];function _bt(t,e){qe(t+' for "outer" push: '+Xn(e))}function Abt(t,e){const n=t.name;if(t.push===wbt)e.signals[n]||_bt("No prior signal definition",n),kbt.forEach((e=>{void 0!==t[e]&&_bt("Invalid property ",e)}));else{const r=e.addSignal(n,t.value);!1===t.react&&(r.react=!1),t.bind&&e.addBinding(n,t.bind)}}function Cbt(t,e,n,r){this.id=-1,this.type=t,this.value=e,this.params=n,r&&(this.parent=r)}function Sbt(t,e,n,r){return new Cbt(t,e,n,r)}function Ebt(t,e){return Sbt("operator",t,e)}function Tbt(t){const e={$ref:t.id};return t.id<0&&(t.refs=t.refs||[]).push(e),e}function Nbt(t,e){return e?{$field:t,$name:e}:{$field:t}}const Fbt=Nbt("key");function Dbt(t,e){return{$compare:t,$order:e}}const Ibt="descending";function Mbt(t,e){return(t&&t.signal?"$"+t.signal:t||"")+(t&&e?"_":"")+(e&&e.signal?"$"+e.signal:e||"")}const Obt="scope",Rbt="view";function zbt(t){return t&&t.signal}function Bbt(t){if(zbt(t))return!0;if(sn(t))for(const e in t)if(Bbt(t[e]))return!0;return!1}function Lbt(t,e){return null!=t?t:e}function Pbt(t){return t&&t.signal||t}const jbt="timer";function Ubt(t,e){return(t.merge?Wbt:t.stream?Vbt:t.type?qbt:qe("Invalid stream specification: "+Xn(t)))(t,e)}function Wbt(t,e){const n=t.merge.map((t=>Ubt(t,e))),r=Gbt({merge:n},t,e);return e.addStream(r).id}function Vbt(t,e){const n=Gbt({stream:Ubt(t.stream,e)},t,e);return e.addStream(n).id}function qbt(t,e){let n;t.type===jbt?(n=e.event(jbt,t.throttle),t={between:t.between,filter:t.filter}):n=e.event(function(t){return t===Obt?Rbt:t||Rbt}(t.source),t.type);const r=Gbt({stream:n},t,e);return 1===Object.keys(r).length?n:e.addStream(r).id}function Gbt(t,e,n){let r=e.between;return r&&(2!==r.length&&qe('Stream "between" parameter must have 2 entries: '+Xn(e)),t.between=[Ubt(r[0],n),Ubt(r[1],n)]),r=e.filter?[].concat(e.filter):[],(e.marktype||e.markname||e.markrole)&&r.push(function(t,e,n){const r="event.item";return r+(t&&"*"!==t?"&&"+r+".mark.marktype==='"+t+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(e?"&&"+r+".mark.name==='"+e+"'":"")}(e.marktype,e.markname,e.markrole)),e.source===Obt&&r.push("inScope(event.item)"),r.length&&(t.filter=ant("("+r.join(")&&(")+")",n).$expr),null!=(r=e.throttle)&&(t.throttle=+r),null!=(r=e.debounce)&&(t.debounce=+r),e.consume&&(t.consume=!0),t}const Hbt={code:"_.$value",ast:{type:"Identifier",value:"value"}};function Ybt(t,e,n){const r=t.encode,i={target:n};let a=t.events,o=t.update,s=[];a||qe("Signal update missing events specification."),qn(a)&&(a=function(t,e,n){return Iyt=e||wyt,Myt=n||Dyt,Ryt(t.trim()).map(zyt)}(a,e.isSubscope()?Obt:Rbt)),a=An(a).filter((t=>t.signal||t.scale?(s.push(t),0):1)),s.length>1&&(s=[Xbt(s)]),a.length&&s.push(a.length>1?{merge:a}:a[0]),null!=r&&(o&&qe("Signal encode and update are mutually exclusive."),o="encode(item(),"+Xn(r)+")"),i.update=qn(o)?ant(o,e):null!=o.expr?ant(o.expr,e):null!=o.value?o.value:null!=o.signal?{$expr:Hbt,$params:{$value:e.signalRef(o.signal)}}:qe("Invalid signal update specification."),t.force&&(i.options={force:!0}),s.forEach((t=>e.addUpdate(On(function(t,e){return{source:t.signal?e.signalRef(t.signal):t.scale?e.scaleRef(t.scale):Ubt(t,e)}}(t,e),i))))}function Xbt(t){return{signal:"["+t.map((t=>t.scale?'scale("'+t.scale+'")':t.signal))+"]"}}const Kbt=t=>(e,n,r)=>Sbt(t,n,e||void 0,r),Qbt=Kbt("aggregate"),Zbt=Kbt("axisticks"),$bt=Kbt("bound"),Jbt=Kbt("collect"),txt=Kbt("compare"),ext=Kbt("datajoin"),nxt=Kbt("encode"),rxt=Kbt("expression"),ixt=Kbt("facet"),axt=Kbt("field"),oxt=Kbt("key"),sxt=Kbt("legendentries"),cxt=Kbt("load"),uxt=Kbt("mark"),lxt=Kbt("multiextent"),hxt=Kbt("multivalues"),dxt=Kbt("overlap"),fxt=Kbt("params"),pxt=Kbt("prefacet"),gxt=Kbt("projection"),mxt=Kbt("proxy"),vxt=Kbt("relay"),yxt=Kbt("render"),bxt=Kbt("scale"),xxt=Kbt("sieve"),wxt=Kbt("sortitems"),kxt=Kbt("viewlayout"),_xt=Kbt("values");let Axt=0;const Cxt={min:"min",max:"max",count:"sum"};function Sxt(t,e){const n=e.getScale(t.name).params;let r;for(r in n.domain=Fxt(t.domain,t,e),null!=t.range&&(n.range=Lxt(t,e,n)),null!=t.interpolate&&function(t,e){e.interpolate=Ext(t.type||t),null!=t.gamma&&(e.interpolateGamma=Ext(t.gamma))}(t.interpolate,n),null!=t.nice&&(n.nice=function(t){return sn(t)?{interval:Ext(t.interval),step:Ext(t.step)}:Ext(t)}(t.nice)),null!=t.bins&&(n.bins=function(t,e){return t.signal||on(t)?Txt(t,e):e.objectProperty(t)}(t.bins,e)),t)Bn(n,r)||"name"===r||(n[r]=Ext(t[r],e))}function Ext(t,e){return sn(t)?t.signal?e.signalRef(t.signal):qe("Unsupported object: "+Xn(t)):t}function Txt(t,e){return t.signal?e.signalRef(t.signal):t.map((t=>Ext(t,e)))}function Nxt(t){qe("Can not find data set: "+Xn(t))}function Fxt(t,e,n){if(t)return t.signal?n.signalRef(t.signal):(on(t)?Dxt:t.fields?Mxt:Ixt)(t,e,n);null==e.domainMin&&null==e.domainMax||qe("No scale domain defined for domainMin/domainMax to override.")}function Dxt(t,e,n){return t.map((t=>Ext(t,n)))}function Ixt(t,e,n){const r=n.getData(t.data);return r||Nxt(t.data),Cy(e.type)?r.valuesRef(n,t.field,Rxt(t.sort,!1)):Ny(e.type)?r.domainRef(n,t.field):r.extentRef(n,t.field)}function Mxt(t,e,n){const r=t.data,i=t.fields.reduce(((t,e)=>(e=qn(e)?{data:r,field:e}:on(e)||e.signal?function(t,e){const n="_:vega:_"+Axt++,r=Jbt({});if(on(t))r.value={$ingest:t};else if(t.signal){const i="setdata("+Xn(n)+","+t.signal+")";r.params.input=e.signalRef(i)}return e.addDataPipeline(n,[r,xxt({})]),{data:n,field:"data"}}(e,n):e,t.push(e),t)),[]);return(Cy(e.type)?Oxt:Ny(e.type)?zxt:Bxt)(t,n,i)}function Oxt(t,e,n){const r=Rxt(t.sort,!0);let i,a;const o=n.map((t=>{const n=e.getData(t.data);return n||Nxt(t.data),n.countsRef(e,t.field,r)})),s={groupby:Fbt,pulse:o};r&&(i=r.op||"count",a=r.field?Mbt(i,r.field):"count",s.ops=[Cxt[i]],s.fields=[e.fieldRef(a)],s.as=[a]),i=e.add(Qbt(s));const c=e.add(Jbt({pulse:Tbt(i)}));return a=e.add(_xt({field:Fbt,sort:e.sortRef(r),pulse:Tbt(c)})),Tbt(a)}function Rxt(t,e){return t&&(t.field||t.op?t.field||"count"===t.op?e&&t.field&&t.op&&!Cxt[t.op]&&qe("Multiple domain scales can not be sorted using "+t.op):qe("No field provided for sort aggregate op: "+t.op):sn(t)?t.field="key":t={field:"key"}),t}function zxt(t,e,n){const r=n.map((t=>{const n=e.getData(t.data);return n||Nxt(t.data),n.domainRef(e,t.field)}));return Tbt(e.add(hxt({values:r})))}function Bxt(t,e,n){const r=n.map((t=>{const n=e.getData(t.data);return n||Nxt(t.data),n.extentRef(e,t.field)}));return Tbt(e.add(lxt({extents:r})))}function Lxt(t,e,n){const r=e.config.range;let i=t.range;if(i.signal)return e.signalRef(i.signal);if(qn(i)){if(r&&Bn(r,i))return Lxt(t=On({},t,{range:r[i]}),e,n);"width"===i?i=[0,{signal:"width"}]:"height"===i?i=Cy(t.type)?[0,{signal:"height"}]:[{signal:"height"},0]:qe("Unrecognized scale range value: "+Xn(i))}else{if(i.scheme)return n.scheme=on(i.scheme)?Txt(i.scheme,e):Ext(i.scheme,e),i.extent&&(n.schemeExtent=Txt(i.extent,e)),void(i.count&&(n.schemeCount=Ext(i.count,e)));if(i.step)return void(n.rangeStep=Ext(i.step,e));if(Cy(t.type)&&!on(i))return Fxt(i,t,e);on(i)||qe("Unsupported range type: "+Xn(i))}return i.map((t=>(on(t)?Txt:Ext)(t,e)))}function Pxt(t,e,n){return on(t)?t.map((t=>Pxt(t,e,n))):sn(t)?t.signal?n.signalRef(t.signal):"fit"===e?t:qe("Unsupported parameter object: "+Xn(t)):t}const jxt="top",Uxt="left",Wxt="right",Vxt="bottom",qxt="center",Gxt="vertical",Hxt="start",Yxt="end",Xxt="index",Kxt="label",Qxt="offset",Zxt="perc",$xt="perc2",Jxt="value",twt="guide-label",ewt="guide-title",nwt="group-title",rwt="group-subtitle",iwt="symbol",awt="gradient",owt="discrete",swt="size",cwt=[swt,"shape","fill","stroke","strokeWidth","strokeDash","opacity"],uwt={name:1,style:1,interactive:1},lwt={value:0},hwt={value:1},dwt="group",fwt="rect",pwt="rule",gwt="symbol",mwt="text";function vwt(t){return t.type=dwt,t.interactive=t.interactive||!1,t}function ywt(t,e){const n=(n,r)=>Lbt(t[n],Lbt(e[n],r));return n.isVertical=n=>Gxt===Lbt(t.direction,e.direction||(n?e.symbolDirection:e.gradientDirection)),n.gradientLength=()=>Lbt(t.gradientLength,e.gradientLength||e.gradientWidth),n.gradientThickness=()=>Lbt(t.gradientThickness,e.gradientThickness||e.gradientHeight),n.entryColumns=()=>Lbt(t.columns,Lbt(e.columns,+n.isVertical(!0))),n}function bwt(t,e){const n=e&&(e.update&&e.update[t]||e.enter&&e.enter[t]);return n&&n.signal?n:n?n.value:null}function xwt(t,e,n){return"item.anchor === '".concat(Hxt,"' ? ").concat(t," : item.anchor === '").concat(Yxt,"' ? ").concat(e," : ").concat(n)}const wwt=xwt(Xn(Uxt),Xn(Wxt),Xn(qxt));function kwt(t,e){return e?t?sn(t)?Object.assign({},t,{offset:kwt(t.offset,e)}):{value:t,offset:e}:e:t}function _wt(t,e){return e?(t.name=e.name,t.style=e.style||t.style,t.interactive=!!e.interactive,t.encode=qyt(t.encode,e,uwt)):t.interactive=!1,t}function Awt(t,e,n,r){const i=ywt(t,n),a=i.isVertical(),o=i.gradientThickness(),s=i.gradientLength();let c,u,l,h,d;a?(u=[0,1],l=[0,0],h=o,d=s):(u=[0,0],l=[1,0],h=s,d=o);const f={enter:c={opacity:lwt,x:lwt,y:lwt,width:Uyt(h),height:Uyt(d)},update:On({},c,{opacity:hwt,fill:{gradient:e,start:u,stop:l}}),exit:{opacity:lwt}};return Vyt(f,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),_wt({type:fwt,role:ibt,encode:f},r)}function Cwt(t,e,n,r,i){const a=ywt(t,n),o=a.isVertical(),s=a.gradientThickness(),c=a.gradientLength();let u,l,h,d,f="";o?(u="y",h="y2",l="x",d="width",f="1-"):(u="x",h="x2",l="y",d="height");const p={opacity:lwt,fill:{scale:e,field:Jxt}};p[u]={signal:f+"datum."+Zxt,mult:c},p[l]=lwt,p[h]={signal:f+"datum."+$xt,mult:c},p[d]=Uyt(s);const g={enter:p,update:On({},p,{opacity:hwt}),exit:{opacity:lwt}};return Vyt(g,{stroke:a("gradientStrokeColor"),strokeWidth:a("gradientStrokeWidth")},{opacity:a("gradientOpacity")}),_wt({type:fwt,role:nbt,key:Jxt,from:i,encode:g},r)}const Swt="datum.".concat(Zxt,'<=0?"').concat(Uxt,'":datum.').concat(Zxt,'>=1?"').concat(Wxt,'":"').concat(qxt,'"'),Ewt="datum.".concat(Zxt,'<=0?"').concat(Vxt,'":datum.').concat(Zxt,'>=1?"').concat(jxt,'":"').concat("middle",'"');function Twt(t,e,n,r){const i=ywt(t,e),a=i.isVertical(),o=Uyt(i.gradientThickness()),s=i.gradientLength();let c,u,l,h,d=i("labelOverlap"),f="";const p={enter:c={opacity:lwt},update:u={opacity:hwt,text:{field:Kxt}},exit:{opacity:lwt}};return Vyt(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:Lbt(t.labelLimit,e.gradientLabelLimit)}),a?(c.align={value:"left"},c.baseline=u.baseline={signal:Ewt},l="y",h="x",f="1-"):(c.align=u.align={signal:Swt},c.baseline={value:"top"},l="x",h="y"),c[l]=u[l]={signal:f+"datum."+Zxt,mult:s},c[h]=u[h]=o,o.offset=Lbt(t.labelOffset,e.gradientLabelOffset)||0,d=d?{separation:i("labelSeparation"),method:d,order:"datum."+Xxt}:void 0,_wt({type:mwt,role:abt,style:twt,key:Jxt,from:r,encode:p,overlap:d},n)}function Nwt(t,e,n,r,i){const a=ywt(t,e),o=n.entries,s=!(!o||!o.interactive),c=o?o.name:void 0,u=a("clipHeight"),l=a("symbolOffset"),h={data:"value"},d="(".concat(i,") ? datum.").concat(Qxt," : datum.").concat(swt),f=u?Uyt(u):{field:swt},p="datum.".concat(Xxt),g="max(1, ".concat(i,")");let m,v,y,b,x;f.mult=.5,m={enter:v={opacity:lwt,x:{signal:d,mult:.5,offset:l},y:f},update:y={opacity:hwt,x:v.x,y:v.y},exit:{opacity:lwt}};let w=null,k=null;t.fill||(w=e.symbolBaseFillColor,k=e.symbolBaseStrokeColor),Vyt(m,{fill:a("symbolFillColor",w),shape:a("symbolType"),size:a("symbolSize"),stroke:a("symbolStrokeColor",k),strokeDash:a("symbolDash"),strokeDashOffset:a("symbolDashOffset"),strokeWidth:a("symbolStrokeWidth")},{opacity:a("symbolOpacity")}),cwt.forEach((e=>{t[e]&&(y[e]=v[e]={scale:t[e],field:Jxt})}));const _=_wt({type:gwt,role:obt,key:Jxt,from:h,clip:!!u||void 0,encode:m},n.symbols),A=Uyt(l);A.offset=a("labelOffset"),m={enter:v={opacity:lwt,x:{signal:d,offset:A},y:f},update:y={opacity:hwt,text:{field:Kxt},x:v.x,y:v.y},exit:{opacity:lwt}},Vyt(m,{align:a("labelAlign"),baseline:a("labelBaseline"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontStyle:a("labelFontStyle"),fontWeight:a("labelFontWeight"),limit:a("labelLimit")});const C=_wt({type:mwt,role:abt,style:twt,key:Jxt,from:h,encode:m},n.labels);return m={enter:{noBound:{value:!u},width:lwt,height:u?Uyt(u):lwt,opacity:lwt},exit:{opacity:lwt},update:y={opacity:hwt,row:{signal:null},column:{signal:null}}},a.isVertical(!0)?(b="ceil(item.mark.items.length / ".concat(g,")"),y.row.signal="".concat(p,"%").concat(b),y.column.signal="floor(".concat(p," / ").concat(b,")"),x={field:["row",p]}):(y.row.signal="floor(".concat(p," / ").concat(g,")"),y.column.signal="".concat(p," % ").concat(g),x={field:p}),y.column.signal="(".concat(i,")?").concat(y.column.signal,":").concat(p),vwt({role:Xyt,from:r={facet:{data:r,name:"value",groupby:Xxt}},encode:qyt(m,o,uwt),marks:[_,C],name:c,interactive:s,sort:x})}const Fwt='item.orient === "left"',Dwt='item.orient === "right"',Iwt="(".concat(Fwt," || ").concat(Dwt,")"),Mwt="datum.vgrad && ".concat(Iwt),Owt=xwt('"top"','"bottom"','"middle"'),Rwt=xwt('"right"','"left"','"center"'),zwt="datum.vgrad && ".concat(Dwt," ? (").concat(Rwt,") : (").concat(Iwt," && !(datum.vgrad && ").concat(Fwt,')) ? "left" : ').concat(wwt),Bwt="item._anchor || (".concat(Iwt,' ? "middle" : "start")'),Lwt="".concat(Mwt," ? (").concat(Fwt," ? -90 : 90) : 0"),Pwt="".concat(Iwt," ? (datum.vgrad ? (").concat(Dwt,' ? "bottom" : "top") : ').concat(Owt,') : "top"');function jwt(t,e){let n;return sn(t)&&(t.signal?n=t.signal:t.path?n="pathShape("+Uwt(t.path)+")":t.sphere&&(n="geoShape("+Uwt(t.sphere)+', {type: "Sphere"})')),n?e.signalRef(n):!!t}function Uwt(t){return sn(t)&&t.signal?t.signal:Xn(t)}function Wwt(t){const e=t.role||"";return e.indexOf("axis")&&e.indexOf("legend")&&e.indexOf("title")?t.type===dwt?Xyt:e||Hyt:e}function Vwt(t){return{marktype:t.type,name:t.name||void 0,role:t.role||Wwt(t),zindex:+t.zindex||void 0,aria:t.aria,description:t.description}}function qwt(t,e){return t&&t.signal?e.signalRef(t.signal):!1!==t}function Gwt(t,e){const n=Oc(t.type);n||qe("Unrecognized transform type: "+Xn(t.type));const r=Sbt(n.type.toLowerCase(),null,Hwt(n,t,e));return t.signal&&e.addSignal(t.signal,e.proxy(r)),r.metadata=n.metadata||{},r}function Hwt(t,e,n){const r={},i=t.params.length;for(let a=0;a<i;++a){const i=t.params[a];r[i.name]=Ywt(i,e,n)}return r}function Ywt(t,e,n){const r=t.type,i=e[t.name];return"index"===r?function(t,e,n){qn(e.from)||qe('Lookup "from" parameter must be a string literal.');return n.getData(e.from).lookupRef(n,e.key)}(0,e,n):void 0!==i?"param"===r?function(t,e,n){const r=e[t.name];return t.array?(on(r)||qe("Expected an array of sub-parameters. Instead: "+Xn(r)),r.map((e=>Kwt(t,e,n)))):Kwt(t,r,n)}(t,e,n):"projection"===r?n.projectionRef(e[t.name]):t.array&&!zbt(i)?i.map((e=>Xwt(t,e,n))):Xwt(t,i,n):void(t.required&&qe("Missing required "+Xn(e.type)+" parameter: "+Xn(t.name)))}function Xwt(t,e,n){const r=t.type;if(zbt(e))return Jwt(r)?qe("Expression references can not be signals."):tkt(r)?n.fieldRef(e):ekt(r)?n.compareRef(e):n.signalRef(e.signal);{const i=t.expr||tkt(r);return i&&Qwt(e)?n.exprRef(e.expr,e.as):i&&Zwt(e)?Nbt(e.field,e.as):Jwt(r)?ant(e,n):$wt(r)?Tbt(n.getData(e).values):tkt(r)?Nbt(e):ekt(r)?n.compareRef(e):e}}function Kwt(t,e,n){const r=t.params.length;let i;for(let o=0;o<r;++o){i=t.params[o];for(const t in i.key)if(i.key[t]!==e[t]){i=null;break}if(i)break}i||qe("Unsupported parameter: "+Xn(e));const a=On(Hwt(i,e,n),i.key);return Tbt(n.add(fxt(a)))}const Qwt=t=>t&&t.expr,Zwt=t=>t&&t.field,$wt=t=>"data"===t,Jwt=t=>"expr"===t,tkt=t=>"field"===t,ekt=t=>"compare"===t;function nkt(t,e){return t.$ref?t:t.data&&t.data.$ref?t.data:Tbt(e.getData(t.data).output)}function rkt(t,e,n,r,i){this.scope=t,this.input=e,this.output=n,this.values=r,this.aggregate=i,this.index={}}function ikt(t){return qn(t)?t:null}function akt(t,e,n){const r=Mbt(n.op,n.field);let i;if(e.ops){for(let a=0,o=e.as.length;a<o;++a)if(e.as[a]===r)return}else e.ops=["count"],e.fields=[null],e.as=["count"];n.op&&(e.ops.push((i=n.op.signal)?t.signalRef(i):n.op),e.fields.push(t.fieldRef(n.field)),e.as.push(r))}function okt(t,e,n,r,i,a,o){const s=e[n]||(e[n]={}),c=function(t){return sn(t)?(t.order===Ibt?"-":"+")+Mbt(t.op,t.field):""}(a);let u,l,h=ikt(i);if(null!=h&&(t=e.scope,h+=c?"|"+c:"",u=s[h]),!u){const n=a?{field:Fbt,pulse:e.countsRef(t,i,a)}:{field:t.fieldRef(i),pulse:Tbt(e.output)};c&&(n.sort=t.sortRef(a)),l=t.add(Sbt(r,void 0,n)),o&&(e.index[i]=l),u=Tbt(l),null!=h&&(s[h]=u)}return u}function skt(t,e,n){const r=t.remove,i=t.insert,a=t.toggle,o=t.modify,s=t.values,c=e.add(Ebt()),u=ant("if("+t.trigger+',modify("'+n+'",'+[i,r,a,o,s].map((t=>null==t?"null":t)).join(",")+"),0)",e);c.update=u.$expr,c.params=u.$params}function ckt(t,e){const n=Wwt(t),r=t.type===dwt,i=t.from&&t.from.facet,a=t.overlap;let o,s,c,u,l,h,d,f=t.layout||n===Xyt||n===Yyt;const p=n===Hyt||f||i,g=function(t,e,n){let r,i,a,o,s;return t?(r=t.facet)&&(e||qe("Only group marks can be faceted."),null!=r.field?o=s=nkt(r,n):(t.data?s=Tbt(n.getData(t.data).aggregate):(a=Gwt(On({type:"aggregate",groupby:An(r.groupby)},r.aggregate),n),a.params.key=n.keyRef(r.groupby),a.params.pulse=nkt(r,n),o=s=Tbt(n.add(a))),i=n.keyRef(r.groupby,!0))):o=Tbt(n.add(Jbt(null,[{}]))),o||(o=nkt(t,n)),{key:i,pulse:o,parent:s}}(t.from,r,e);s=e.add(ext({key:g.key||(t.key?Nbt(t.key):void 0),pulse:g.pulse,clean:!r}));const m=Tbt(s);s=c=e.add(Jbt({pulse:m})),s=e.add(uxt({markdef:Vwt(t),interactive:qwt(t.interactive,e),clip:jwt(t.clip,e),context:{$context:!0},groups:e.lookup(),parent:e.signals.parent?e.signalRef("parent"):null,index:e.markpath(),pulse:Tbt(s)}));const v=Tbt(s);s=u=e.add(nxt(ybt(t.encode,t.type,n,t.style,e,{mod:!1,pulse:v}))),s.params.parent=e.encode(),t.transform&&t.transform.forEach((t=>{const n=Gwt(t,e),r=n.metadata;(r.generates||r.changes)&&qe("Mark transforms should not generate new data."),r.nomod||(u.params.mod=!0),n.params.pulse=Tbt(s),e.add(s=n)})),t.sort&&(s=e.add(wxt({sort:e.compareRef(t.sort),pulse:Tbt(s)})));const y=Tbt(s);(i||f)&&(f=e.add(kxt({layout:e.objectProperty(t.layout),legends:e.legends,mark:v,pulse:y})),h=Tbt(f));const b=e.add($bt({mark:v,pulse:h||y}));d=Tbt(b),r&&(p&&(o=e.operators,o.pop(),f&&o.pop()),e.pushState(y,h||d,m),i?function(t,e,n){const r=t.from.facet,i=r.name,a=nkt(r,e);let o;r.name||qe("Facet must have a name: "+Xn(r)),r.data||qe("Facet must reference a data set: "+Xn(r)),r.field?o=e.add(pxt({field:e.fieldRef(r.field),pulse:a})):r.groupby?o=e.add(ixt({key:e.keyRef(r.groupby),group:Tbt(e.proxy(n.parent)),pulse:a})):qe("Facet must specify groupby or field: "+Xn(r));const s=e.fork(),c=s.add(Jbt()),u=s.add(xxt({pulse:Tbt(c)}));s.addData(i,new rkt(s,c,c,u)),s.addSignal("parent",null),o.params.subflow={$subflow:s.parse(t).toRuntime()}}(t,e,g):p?function(t,e,n){const r=e.add(pxt({pulse:n.pulse})),i=e.fork();i.add(xxt()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(t).toRuntime()}}(t,e,g):e.parse(t),e.popState(),p&&(f&&o.push(f),o.push(b))),a&&(d=function(t,e,n){const r=t.method,i=t.bound,a=t.separation,o={separation:zbt(a)?n.signalRef(a.signal):a,method:zbt(r)?n.signalRef(r.signal):r,pulse:e};t.order&&(o.sort=n.compareRef({field:t.order}));if(i){const t=i.tolerance;o.boundTolerance=zbt(t)?n.signalRef(t.signal):+t,o.boundScale=n.scaleRef(i.scale),o.boundOrient=i.orient}return Tbt(n.add(dxt(o)))}(a,d,e));const x=e.add(yxt({pulse:d})),w=e.add(xxt({pulse:Tbt(x)},void 0,e.parent()));null!=t.name&&(l=t.name,e.addData(l,new rkt(e,c,x,w)),t.on&&t.on.forEach((t=>{(t.insert||t.remove||t.toggle)&&qe("Marks only support modify triggers."),skt(t,e,l)})))}function ukt(t,e){const n=e.config.legend,r=t.encode||{},i=ywt(t,n),a=r.legend||{},o=a.name||void 0,s=a.interactive,c=a.style,u={};let l,h,d,f=0;cwt.forEach((e=>t[e]?(u[e]=t[e],f=f||t[e]):0)),f||qe("Missing valid scale for legend.");const p=function(t,e){let n=t.type||iwt;t.type||1!==function(t){return cwt.reduce(((e,n)=>e+(t[n]?1:0)),0)}(t)||!t.fill&&!t.stroke||(n=Ay(e)?awt:Sy(e)?owt:iwt);return n!==awt?n:Sy(e)?owt:awt}(t,e.scaleType(f)),g={title:null!=t.title,scales:u,type:p,vgrad:"symbol"!==p&&i.isVertical()},m=Tbt(e.add(Jbt(null,[g]))),v=Tbt(e.add(sxt(h={type:p,scale:e.scaleRef(f),count:e.objectProperty(i("tickCount")),limit:e.property(i("symbolLimit")),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)})));return p===awt?(d=[Awt(t,f,n,r.gradient),Twt(t,n,r.labels,v)],h.count=h.count||e.signalRef("max(2,2*floor((".concat(Pbt(i.gradientLength()),")/100))"))):p===owt?d=[Cwt(t,f,n,r.gradient,v),Twt(t,n,r.labels,v)]:(l=function(t,e){const n=ywt(t,e);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(t,n),d=[Nwt(t,n,r,v,Pbt(l.columns))],h.size=function(t,e,n){const r=Pbt(hkt("size",t,n)),i=Pbt(hkt("strokeWidth",t,n)),a=Pbt(function(t,e,n){return bwt("fontSize",t)||function(t,e,n){const r=e.config.style[n];return r&&r[t]}("fontSize",e,n)}(n[1].encode,e,twt));return ant("max(ceil(sqrt(".concat(r,")+").concat(i,"),").concat(a,")"),e)}(t,e,d[0].marks)),d=[vwt({role:rbt,from:m,encode:{enter:{x:{value:0},y:{value:0}}},marks:d,layout:l,interactive:s})],g.title&&d.push(function(t,e,n,r){const i=ywt(t,e),a={enter:{opacity:lwt},update:{opacity:hwt,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:lwt}};return Vyt(a,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:Bwt},angle:{signal:Lwt},align:{signal:zwt},baseline:{signal:Pwt},text:t.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),_wt({type:mwt,role:sbt,style:ewt,from:r,encode:a},n)}(t,n,r.title,m)),ckt(vwt({role:ebt,from:m,encode:qyt(lkt(i,t,n),a,uwt),marks:d,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:o,interactive:s,style:c}),e)}function lkt(t,e,n){const r={enter:{},update:{}};return Vyt(r,{orient:t("orient"),offset:t("offset"),padding:t("padding"),titlePadding:t("titlePadding"),cornerRadius:t("cornerRadius"),fill:t("fillColor"),stroke:t("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:t("legendX"),y:t("legendY"),format:e.format,formatType:e.formatType}),r}function hkt(t,e,n){return e[t]?'scale("'.concat(e[t],'",datum)'):bwt(t,n[0].encode)}rkt.fromEntries=function(t,e){const n=e.length,r=e[n-1],i=e[n-2];let a=e[0],o=null,s=1;for(a&&"load"===a.type&&(a=e[1]),t.add(e[0]);s<n;++s)e[s].params.pulse=Tbt(e[s-1]),t.add(e[s]),"aggregate"===e[s].type&&(o=e[s]);return new rkt(t,a,i,r,o)},rkt.prototype={countsRef(t,e,n){const r=this,i=r.counts||(r.counts={}),a=ikt(e);let o,s,c;return null!=a&&(t=r.scope,o=i[a]),o?n&&n.field&&akt(t,o.agg.params,n):(c={groupby:t.fieldRef(e,"key"),pulse:Tbt(r.output)},n&&n.field&&akt(t,c,n),s=t.add(Qbt(c)),o=t.add(Jbt({pulse:Tbt(s)})),o={agg:s,ref:Tbt(o)},null!=a&&(i[a]=o)),o.ref},tuplesRef(){return Tbt(this.values)},extentRef(t,e){return okt(t,this,"extent","extent",e,!1)},domainRef(t,e){return okt(t,this,"domain","values",e,!1)},valuesRef(t,e,n){return okt(t,this,"vals","values",e,n||!0)},lookupRef(t,e){return okt(t,this,"lookup","tupleindex",e,!1)},indataRef(t,e){return okt(t,this,"indata","tupleindex",e,!0,!0)}};const dkt='item.orient==="'.concat(Uxt,'"?-90:item.orient==="').concat(Wxt,'"?90:0');function fkt(t,e){const n=ywt(t=qn(t)?{text:t}:t,e.config.title),r=t.encode||{},i=r.group||{},a=i.name||void 0,o=i.interactive,s=i.style,c=[],u=Tbt(e.add(Jbt(null,[{}])));return c.push(function(t,e,n,r){const i={value:0},a=t.text,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Vyt(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("color"),font:e("font"),fontSize:e("fontSize"),fontStyle:e("fontStyle"),fontWeight:e("fontWeight"),lineHeight:e("lineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),_wt({type:mwt,role:ubt,style:nwt,from:r,encode:o},n)}(t,n,function(t){const e=t.encode;return e&&e.title||On({name:t.name,interactive:t.interactive,style:t.style},e)}(t),u)),t.subtitle&&c.push(function(t,e,n,r){const i={value:0},a=t.subtitle,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Vyt(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("subtitleColor"),font:e("subtitleFont"),fontSize:e("subtitleFontSize"),fontStyle:e("subtitleFontStyle"),fontWeight:e("subtitleFontWeight"),lineHeight:e("subtitleLineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),_wt({type:mwt,role:lbt,style:rwt,from:r,encode:o},n)}(t,n,r.subtitle,u)),ckt(vwt({role:cbt,from:u,encode:pkt(n,i),marks:c,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:a,interactive:o,style:s}),e)}function pkt(t,e){const n={enter:{},update:{}};return Vyt(n,{orient:t("orient"),anchor:t("anchor"),align:{signal:wwt},angle:{signal:dkt},limit:t("limit"),frame:t("frame"),offset:t("offset")||0,padding:t("subtitlePadding")}),qyt(n,e,uwt)}function gkt(t,e){const n=[];t.transform&&t.transform.forEach((t=>{n.push(Gwt(t,e))})),t.on&&t.on.forEach((n=>{skt(n,e,t.name)})),e.addDataPipeline(t.name,function(t,e,n){const r=[];let i,a,o,s,c,u=null,l=!1,h=!1;t.values?zbt(t.values)||Bbt(t.format)?(r.push(vkt(e,t)),r.push(u=mkt())):r.push(u=mkt({$ingest:t.values,$format:t.format})):t.url?Bbt(t.url)||Bbt(t.format)?(r.push(vkt(e,t)),r.push(u=mkt())):r.push(u=mkt({$request:t.url,$format:t.format})):t.source&&(u=i=An(t.source).map((t=>Tbt(e.getData(t).output))),r.push(null));for(a=0,o=n.length;a<o;++a)s=n[a],c=s.metadata,u||c.source||r.push(u=mkt()),r.push(s),c.generates&&(h=!0),c.modifies&&!h&&(l=!0),c.source?u=s:c.changes&&(u=null);i&&(o=i.length-1,r[0]=vxt({derive:l,pulse:o?i:i[0]}),(l||o)&&r.splice(1,0,mkt()));u||r.push(mkt());return r.push(xxt({})),r}(t,e,n))}function mkt(t){const e=Jbt({},t);return e.metadata={source:!0},e}function vkt(t,e){return cxt({url:e.url?t.property(e.url):void 0,async:e.async?t.property(e.async):void 0,values:e.values?t.property(e.values):void 0,format:t.objectProperty(e.format)})}const ykt=t=>t===Vxt||t===jxt,bkt=(t,e,n)=>zbt(t)?Skt(t.signal,e,n):t===Uxt||t===jxt?e:n,xkt=(t,e,n)=>zbt(t)?Akt(t.signal,e,n):ykt(t)?e:n,wkt=(t,e,n)=>zbt(t)?Ckt(t.signal,e,n):ykt(t)?n:e,kkt=(t,e,n)=>zbt(t)?Ekt(t.signal,e,n):t===jxt?{value:e}:{value:n},_kt=(t,e,n)=>zbt(t)?Tkt(t.signal,e,n):t===Wxt?{value:e}:{value:n},Akt=(t,e,n)=>Nkt("".concat(t," === '").concat(jxt,"' || ").concat(t," === '").concat(Vxt,"'"),e,n),Ckt=(t,e,n)=>Nkt("".concat(t," !== '").concat(jxt,"' && ").concat(t," !== '").concat(Vxt,"'"),e,n),Skt=(t,e,n)=>Dkt("".concat(t," === '").concat(Uxt,"' || ").concat(t," === '").concat(jxt,"'"),e,n),Ekt=(t,e,n)=>Dkt("".concat(t," === '").concat(jxt,"'"),e,n),Tkt=(t,e,n)=>Dkt("".concat(t," === '").concat(Wxt,"'"),e,n),Nkt=(t,e,n)=>(e=null!=e?Uyt(e):e,n=null!=n?Uyt(n):n,Fkt(e)&&Fkt(n)?(e=e?e.signal||Xn(e.value):null,n=n?n.signal||Xn(n.value):null,{signal:"".concat(t," ? (").concat(e,") : (").concat(n,")")}):[On({test:t},e)].concat(n||[])),Fkt=t=>null==t||1===Object.keys(t).length,Dkt=(t,e,n)=>({signal:"".concat(t," ? (").concat(Mkt(e),") : (").concat(Mkt(n),")")}),Ikt=(t,e,n,r,i)=>({signal:(null!=r?"".concat(t," === '").concat(Uxt,"' ? (").concat(Mkt(r),") : "):"")+(null!=n?"".concat(t," === '").concat(Vxt,"' ? (").concat(Mkt(n),") : "):"")+(null!=i?"".concat(t," === '").concat(Wxt,"' ? (").concat(Mkt(i),") : "):"")+(null!=e?"".concat(t," === '").concat(jxt,"' ? (").concat(Mkt(e),") : "):"")+"(null)"}),Mkt=t=>zbt(t)?t.signal:null==t?null:Xn(t),Okt=(t,e)=>0===e?0:zbt(t)?{signal:"(".concat(t.signal,") * ").concat(e)}:{value:t*e},Rkt=(t,e)=>{const n=t.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+e.signal}:t};function zkt(t,e,n,r){let i;if(e&&Bn(e,t))return e[t];if(Bn(n,t))return n[t];if(t.startsWith("title")){switch(t){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=t[5].toLowerCase()+t.slice(6)}return r[ewt][i]}if(t.startsWith("label")){switch(t){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=t[5].toLowerCase()+t.slice(6)}return r[twt][i]}return null}function Bkt(t){const e={};for(const n of t)if(n)for(const t in n)e[t]=1;return Object.keys(e)}function Lkt(t,e){return{scale:t.scale,range:e}}function Pkt(t,e,n,r,i){const a=ywt(t,e),o=t.orient,s=t.gridScale,c=bkt(o,1,-1),u=function(t,e){if(1===e);else if(sn(t)){let n=t=On({},t);for(;null!=n.mult;){if(!sn(n.mult))return n.mult=zbt(e)?{signal:"(".concat(n.mult,") * (").concat(e.signal,")")}:n.mult*e,t;n=n.mult=On({},n.mult)}n.mult=e}else t=zbt(e)?{signal:"(".concat(e.signal,") * (").concat(t||0,")")}:e*(t||0);return t}(t.offset,c);let l,h,d;const f={enter:l={opacity:lwt},update:d={opacity:hwt},exit:h={opacity:lwt}};Vyt(f,{stroke:a("gridColor"),strokeCap:a("gridCap"),strokeDash:a("gridDash"),strokeDashOffset:a("gridDashOffset"),strokeOpacity:a("gridOpacity"),strokeWidth:a("gridWidth")});const p={scale:t.scale,field:Jxt,band:i.band,extra:i.extra,offset:i.offset,round:a("tickRound")},g=xkt(o,{signal:"height"},{signal:"width"}),m=s?{scale:s,range:0,mult:c,offset:u}:{value:0,offset:u},v=s?{scale:s,range:1,mult:c,offset:u}:On(g,{mult:c,offset:u});return l.x=d.x=xkt(o,p,m),l.y=d.y=wkt(o,p,m),l.x2=d.x2=wkt(o,v),l.y2=d.y2=xkt(o,v),h.x=xkt(o,p),h.y=wkt(o,p),_wt({type:pwt,role:Zyt,key:Jxt,from:r,encode:f},n)}function jkt(t,e,n,r,i){return{signal:'flush(range("'+t+'"), scale("'+t+'", datum.value), '+e+","+n+","+r+","+i+")"}}function Ukt(t,e,n,r){const i=ywt(t,e),a=t.orient,o=bkt(a,-1,1);let s,c;const u={enter:s={opacity:lwt,anchor:Uyt(i("titleAnchor",null)),align:{signal:wwt}},update:c=On({},s,{opacity:hwt,text:Uyt(t.title)}),exit:{opacity:lwt}},l={signal:'lerp(range("'.concat(t.scale,'"), ').concat(xwt(0,1,.5),")")};return c.x=xkt(a,l),c.y=wkt(a,l),s.angle=xkt(a,lwt,Okt(o,90)),s.baseline=xkt(a,kkt(a,Vxt,jxt),{value:Vxt}),c.angle=s.angle,c.baseline=s.baseline,Vyt(u,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),function(t,e,n,r){const i=(t,e)=>null!=t?(n.update[e]=Rkt(Uyt(t),n.update[e]),!1):!Gyt(e,r),a=i(t("titleX"),"x"),o=i(t("titleY"),"y");n.enter.auto=o===a?Uyt(o):xkt(e,Uyt(o),Uyt(a))}(i,a,u,n),u.update.align=Rkt(u.update.align,s.align),u.update.angle=Rkt(u.update.angle,s.angle),u.update.baseline=Rkt(u.update.baseline,s.baseline),_wt({type:mwt,role:tbt,style:ewt,from:r,encode:u},n)}function Wkt(t,e){const n=function(t,e){var n,r,i,a=e.config,o=a.style,s=a.axis,c="band"===e.scaleType(t.scale)&&a.axisBand,u=t.orient;if(zbt(u)){const t=Bkt([a.axisX,a.axisY]),e=Bkt([a.axisTop,a.axisBottom,a.axisLeft,a.axisRight]);for(i of(n={},t))n[i]=xkt(u,zkt(i,a.axisX,s,o),zkt(i,a.axisY,s,o));for(i of(r={},e))r[i]=Ikt(u.signal,zkt(i,a.axisTop,s,o),zkt(i,a.axisBottom,s,o),zkt(i,a.axisLeft,s,o),zkt(i,a.axisRight,s,o))}else n=u===jxt||u===Vxt?a.axisX:a.axisY,r=a["axis"+u[0].toUpperCase()+u.slice(1)];return n||r||c?On({},s,n,r,c):s}(t,e),r=t.encode||{},i=r.axis||{},a=i.name||void 0,o=i.interactive,s=i.style,c=ywt(t,n),u=function(t){const e=t("tickBand");let n,r,i=t("tickOffset");return e?e.signal?(n={signal:"(".concat(e.signal,") === 'extent' ? 1 : 0.5")},r={signal:"(".concat(e.signal,") === 'extent'")},sn(i)||(i={signal:"(".concat(e.signal,") === 'extent' ? 0 : ").concat(i)})):"extent"===e?(n=1,r=!0,i=0):(n=.5,r=!1):(n=t("bandPosition"),r=t("tickExtra")),{extra:r,band:n,offset:i}}(c),l={scale:t.scale,ticks:!!c("ticks"),labels:!!c("labels"),grid:!!c("grid"),domain:!!c("domain"),title:null!=t.title},h=Tbt(e.add(Jbt({},[l]))),d=Tbt(e.add(Zbt({scale:e.scaleRef(t.scale),extra:e.property(u.extra),count:e.objectProperty(t.tickCount),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)}))),f=[];let p;return l.grid&&f.push(Pkt(t,n,r.grid,d,u)),l.ticks&&(p=c("tickSize"),f.push(function(t,e,n,r,i,a){const o=ywt(t,e),s=t.orient,c=bkt(s,-1,1);let u,l,h;const d={enter:u={opacity:lwt},update:h={opacity:hwt},exit:l={opacity:lwt}};Vyt(d,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});const f=Uyt(i);f.mult=c;const p={scale:t.scale,field:Jxt,band:a.band,extra:a.extra,offset:a.offset,round:o("tickRound")};return h.y=u.y=xkt(s,lwt,p),h.y2=u.y2=xkt(s,f),l.x=xkt(s,p),h.x=u.x=wkt(s,lwt,p),h.x2=u.x2=wkt(s,f),l.y=wkt(s,p),_wt({type:pwt,role:Jyt,key:Jxt,from:r,encode:d},n)}(t,n,r.ticks,d,p,u))),l.labels&&(p=l.ticks?p:0,f.push(function(t,e,n,r,i,a){const o=ywt(t,e),s=t.orient,c=t.scale,u=bkt(s,-1,1),l=Pbt(o("labelFlush")),h=Pbt(o("labelFlushOffset")),d=o("labelAlign"),f=o("labelBaseline");let p,g=0===l||!!l;const m=Uyt(i);m.mult=u,m.offset=Uyt(o("labelPadding")||0),m.offset.mult=u;const v={scale:c,field:Jxt,band:.5,offset:kwt(a.offset,o("labelOffset"))},y=xkt(s,g?jkt(c,l,'"left"','"right"','"center"'):{value:"center"},_kt(s,"left","right")),b=xkt(s,kkt(s,"bottom","top"),g?jkt(c,l,'"top"','"bottom"','"middle"'):{value:"middle"}),x=jkt(c,l,"-(".concat(h,")"),h,0);g=g&&h;const w={opacity:lwt,x:xkt(s,v,m),y:wkt(s,v,m)},k={enter:w,update:p={opacity:hwt,text:{field:Kxt},x:w.x,y:w.y,align:y,baseline:b},exit:{opacity:lwt,x:w.x,y:w.y}};Vyt(k,{dx:!d&&g?xkt(s,x):null,dy:!f&&g?wkt(s,x):null}),Vyt(k,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:d,baseline:f});const _=o("labelBound");let A=o("labelOverlap");return A=A||_?{separation:o("labelSeparation"),method:A,order:"datum.index",bound:_?{scale:c,orient:s,tolerance:_}:null}:void 0,p.align!==y&&(p.align=Rkt(p.align,y)),p.baseline!==b&&(p.baseline=Rkt(p.baseline,b)),_wt({type:mwt,role:$yt,style:twt,key:Jxt,from:r,encode:k,overlap:A},n)}(t,n,r.labels,d,p,u))),l.domain&&f.push(function(t,e,n,r){const i=ywt(t,e),a=t.orient;let o,s;const c={enter:o={opacity:lwt},update:s={opacity:hwt},exit:{opacity:lwt}};Vyt(c,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const u=Lkt(t,0),l=Lkt(t,1);return o.x=s.x=xkt(a,u,lwt),o.x2=s.x2=xkt(a,l),o.y=s.y=wkt(a,u,lwt),o.y2=s.y2=wkt(a,l),_wt({type:pwt,role:Qyt,from:r,encode:c},n)}(t,n,r.domain,h)),l.title&&f.push(Ukt(t,n,r.title,h)),ckt(vwt({role:Kyt,from:h,encode:qyt(Vkt(c,t),i,uwt),marks:f,aria:c("aria"),description:c("description"),zindex:c("zindex"),name:a,interactive:o,style:s}),e)}function Vkt(t,e){const n={enter:{},update:{}};return Vyt(n,{orient:t("orient"),offset:t("offset")||0,position:Lbt(e.position,0),titlePadding:t("titlePadding"),minExtent:t("minExtent"),maxExtent:t("maxExtent"),range:{signal:'abs(span(range("'.concat(e.scale,'")))')},translate:t("translate"),format:e.format,formatType:e.formatType}),n}function qkt(t,e,n){const r=An(t.signals),i=An(t.scales);return n||r.forEach((t=>Abt(t,e))),An(t.projections).forEach((t=>function(t,e){const n=e.config.projection||{},r={};for(const i in t)"name"!==i&&(r[i]=Pxt(t[i],i,e));for(const i in n)null==r[i]&&(r[i]=Pxt(n[i],i,e));e.addProjection(t.name,r)}(t,e))),i.forEach((t=>function(t,e){const n=t.type||"linear";ky(n)||qe("Unrecognized scale type: "+Xn(n)),e.addScale(t.name,{type:n,domain:void 0})}(t,e))),An(t.data).forEach((t=>gkt(t,e))),i.forEach((t=>Sxt(t,e))),(n||r).forEach((t=>function(t,e){const n=e.getSignal(t.name);let r=t.update;t.init&&(r?qe("Signals can not include both init and update expressions."):(r=t.init,n.initonly=!0)),r&&(r=ant(r,e),n.update=r.$expr,n.params=r.$params),t.on&&t.on.forEach((t=>Ybt(t,e,n.id)))}(t,e))),An(t.axes).forEach((t=>Wkt(t,e))),An(t.marks).forEach((t=>ckt(t,e))),An(t.legends).forEach((t=>ukt(t,e))),t.title&&fkt(t.title,e),e.parseLambdas(),e}const Gkt=t=>qyt({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},t);function Hkt(t,e){const n=e.config,r=Tbt(e.root=e.add(Ebt())),i=function(t,e){const n=n=>Lbt(t[n],e[n]),r=[Ykt("background",n("background")),Ykt("autosize",Byt(n("autosize"))),Ykt("padding",jyt(n("padding"))),Ykt("width",n("width")||0),Ykt("height",n("height")||0)],i=r.reduce(((t,e)=>(t[e.name]=e,t)),{}),a={};return An(t.signals).forEach((t=>{Bn(i,t.name)?t=On(i[t.name],t):r.push(t),a[t.name]=t})),An(e.signals).forEach((t=>{Bn(a,t.name)||Bn(i,t.name)||r.push(t)})),r}(t,n);i.forEach((t=>Abt(t,e))),e.description=t.description||n.description,e.eventConfig=n.events,e.legends=e.objectProperty(n.legend&&n.legend.layout),e.locale=n.locale;const a=e.add(Jbt()),o=e.add(nxt(ybt(Gkt(t.encode),dwt,Yyt,t.style,e,{pulse:Tbt(a)}))),s=e.add(kxt({layout:e.objectProperty(t.layout),legends:e.legends,autosize:e.signalRef("autosize"),mark:r,pulse:Tbt(o)}));e.operators.pop(),e.pushState(Tbt(o),Tbt(s),null),qkt(t,e,i),e.operators.push(s);let c=e.add($bt({mark:r,pulse:Tbt(s)}));return c=e.add(yxt({pulse:Tbt(c)})),c=e.add(xxt({pulse:Tbt(c)})),e.addData("root",new rkt(e,a,a,c)),e}function Ykt(t,e){return e&&e.signal?{name:t,update:e.signal}:{name:t,value:e}}function Xkt(t,e){this.config=t||{},this.options=e||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function Kkt(t){this.config=t.config,this.options=t.options,this.legends=t.legends,this.field=Object.create(t.field),this.signals=Object.create(t.signals),this.lambdas=Object.create(t.lambdas),this.scales=Object.create(t.scales),this.events=Object.create(t.events),this.data=Object.create(t.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++t._nextsub[0],this._nextsub=t._nextsub,this._parent=t._parent.slice(),this._encode=t._encode.slice(),this._lookup=t._lookup.slice(),this._markpath=t._markpath}function Qkt(t){return(on(t)?Zkt:$kt)(t)}function Zkt(t){const e=t.length;let n="[";for(let r=0;r<e;++r){const e=t[r];n+=(r>0?",":"")+(sn(e)?e.signal||Qkt(e):Xn(e))}return n+"]"}function $kt(t){let e,n,r="{",i=0;for(e in t)n=t[e],r+=(++i>1?",":"")+Xn(e)+":"+(sn(n)?n.signal||Qkt(n):Xn(n));return r+"}"}function Jkt(t,e,n){return sn(t)||qe("Input Vega specification must be an object."),e=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(((t,e)=>{for(const n in e)if("signals"===n)t.signals=ln(t.signals,e.signals);else{const r="legend"===n?{layout:1}:"style"===n||null;un(t,n,e[n],r)}return t}),{})}(function(){const t="sans-serif",e="#4c78a8",n="#000",r="#888",i="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:e},area:{fill:e},image:null,line:{stroke:e,strokeWidth:2},path:{stroke:e},rect:{fill:e},rule:{stroke:n},shape:{stroke:e},symbol:{fill:e,size:64},text:{fill:n,font:t,fontSize:11},trail:{fill:e,size:2},style:{"guide-label":{fill:n,font:t,fontSize:10},"guide-title":{fill:n,font:t,fontSize:11,fontWeight:"bold"},"group-title":{fill:n,font:t,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:n,font:t,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:i}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:r,grid:!1,gridWidth:1,gridColor:i,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:r,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:i,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:r,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}(),e,t.config),Hkt(t,new Xkt(e,n)).toRuntime()}function t_t(t,e,n){return t.fields=e||[],t.fname=n,t}function e_t(t){return 1===t.length?n_t(t[0]):r_t(t)}Xkt.prototype=Kkt.prototype={parse(t){return qkt(t,this)},fork(){return new Kkt(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(t){return this.operators.push(t),t.id=this.id(),t.refs&&(t.refs.forEach((e=>{e.$ref=t.id})),t.refs=null),t},proxy(t){const e=t instanceof Cbt?Tbt(t):t;return this.add(mxt({value:e}))},addStream(t){return this.streams.push(t),t.id=this.id(),t},addUpdate(t){return this.updates.push(t),t},finish(){let t,e;for(t in this.root&&(this.root.root=!0),this.signals)this.signals[t].signal=t;for(t in this.scales)this.scales[t].scale=t;function n(t,e,n){let r,i;t&&(r=t.data||(t.data={}),i=r[e]||(r[e]=[]),i.push(n))}for(t in this.data){e=this.data[t],n(e.input,t,"input"),n(e.output,t,"output"),n(e.values,t,"values");for(const r in e.index)n(e.index[r],t,"index:"+r)}return this},pushState(t,e,n){this._encode.push(Tbt(this.add(xxt({pulse:t})))),this._parent.push(e),this._lookup.push(n?Tbt(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return hn(this._parent)},encode(){return hn(this._encode)},lookup(){return hn(this._lookup)},markpath(){const t=this._markpath;return++t[t.length-1]},fieldRef(t,e){if(qn(t))return Nbt(t,e);t.signal||qe("Unsupported field reference: "+Xn(t));const n=t.signal;let r=this.field[n];if(!r){const t={name:this.signalRef(n)};e&&(t.as=e),this.field[n]=r=Tbt(this.add(axt(t)))}return r},compareRef(t){let e=!1;const n=t=>zbt(t)?(e=!0,this.signalRef(t.signal)):function(t){return t&&t.expr}(t)?(e=!0,this.exprRef(t.expr)):t,r=An(t.field).map(n),i=An(t.order).map(n);return e?Tbt(this.add(txt({fields:r,orders:i}))):Dbt(r,i)},keyRef(t,e){let n=!1;const r=this.signals;return t=An(t).map((t=>zbt(t)?(n=!0,Tbt(r[t.signal])):t)),n?Tbt(this.add(oxt({fields:t,flat:e}))):function(t,e){const n={$key:t};return e&&(n.$flat=!0),n}(t,e)},sortRef(t){if(!t)return t;const e=Mbt(t.op,t.field),n=t.order||"ascending";return n.signal?Tbt(this.add(txt({fields:e,orders:this.signalRef(n.signal)}))):Dbt(e,n)},event(t,e){const n=t+":"+e;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:t,type:e}),this.events[n]=r}return this.events[n]},hasOwnSignal(t){return Bn(this.signals,t)},addSignal(t,e){this.hasOwnSignal(t)&&qe("Duplicate signal name: "+Xn(t));const n=e instanceof Cbt?e:this.add(Ebt(e));return this.signals[t]=n},getSignal(t){return this.signals[t]||qe("Unrecognized signal name: "+Xn(t)),this.signals[t]},signalRef(t){return this.signals[t]?Tbt(this.signals[t]):(Bn(this.lambdas,t)||(this.lambdas[t]=this.add(Ebt(null))),Tbt(this.lambdas[t]))},parseLambdas(){const t=Object.keys(this.lambdas);for(let e=0,n=t.length;e<n;++e){const n=t[e],r=ant(n,this),i=this.lambdas[n];i.params=r.$params,i.update=r.$expr}},property(t){return t&&t.signal?this.signalRef(t.signal):t},objectProperty(t){return t&&sn(t)?this.signalRef(t.signal||Qkt(t)):t},exprRef(t,e){const n={expr:ant(t,this)};return e&&(n.expr.$name=e),Tbt(this.add(rxt(n)))},addBinding(t,e){this.bindings||qe("Nested signals do not support binding: "+Xn(t)),this.bindings.push(On({signal:t},e))},addScaleProj(t,e){Bn(this.scales,t)&&qe("Duplicate scale or projection name: "+Xn(t)),this.scales[t]=this.add(e)},addScale(t,e){this.addScaleProj(t,bxt(e))},addProjection(t,e){this.addScaleProj(t,gxt(e))},getScale(t){return this.scales[t]||qe("Unrecognized scale name: "+Xn(t)),this.scales[t]},scaleRef(t){return Tbt(this.getScale(t))},scaleType(t){return this.getScale(t).params.type},projectionRef(t){return this.scaleRef(t)},projectionType(t){return this.scaleType(t)},addData(t,e){return Bn(this.data,t)&&qe("Duplicate data set name: "+Xn(t)),this.data[t]=e},getData(t){return this.data[t]||qe("Undefined data set name: "+Xn(t)),this.data[t]},addDataPipeline(t,e){return Bn(this.data,t)&&qe("Duplicate data set name: "+Xn(t)),this.addData(t,rkt.fromEntries(this,e))}};const n_t=t=>function(e){return e[t]},r_t=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function i_t(t){throw Error(t)}function a_t(t){const e=[],n=t.length;let r,i,a,o=null,s=0,c="";function u(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)c+=t.substring(r,i++),r=i;else if(a===o)u(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&u(),s=r=i+1):"]"===a&&(s||i_t("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&i_t("Access path missing closing bracket: "+t),o&&i_t("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function o_t(t,e,n){const r=a_t(t);return t=1===r.length?r[0]:t,t_t((n&&n.get||e_t)(r),[t],e||t)}o_t("id"),t_t((t=>t),[],"identity"),t_t((()=>0),[],"zero"),t_t((()=>1),[],"one"),t_t((()=>!0),[],"true"),t_t((()=>!1),[],"false");Array.isArray;function s_t(t){return"function"===typeof t}const c_t=Object.prototype.hasOwnProperty;function u_t(t,e){return c_t.call(t,e)}function l_t(t){return"string"===typeof t}function h_t(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}const d_t="Property",f_t="ArrayExpression",p_t="BinaryExpression",g_t="CallExpression",m_t="ConditionalExpression",v_t="LogicalExpression",y_t="MemberExpression",b_t="ObjectExpression",x_t="UnaryExpression";function w_t(t){this.type=t}var k_t,__t,A_t,C_t,S_t;w_t.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=function(t){switch(t.type){case f_t:return t.elements;case p_t:case v_t:return[t.left,t.right];case g_t:return[t.callee].concat(t.arguments);case m_t:return[t.test,t.consequent,t.alternate];case y_t:return[t.object,t.property];case b_t:return t.properties;case d_t:return[t.key,t.value];case x_t:return[t.argument];default:return[]}}(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1};var E_t=1,T_t=2,N_t=3,F_t=4,D_t=5,I_t=6,M_t=7,O_t=8;(k_t={})[E_t]="Boolean",k_t[T_t]="<end>",k_t[N_t]="Identifier",k_t[F_t]="Keyword",k_t[D_t]="Null",k_t[I_t]="Numeric",k_t[M_t]="Punctuator",k_t[O_t]="String",k_t[9]="RegularExpression";var R_t="ArrayExpression",z_t="BinaryExpression",B_t="CallExpression",L_t="ConditionalExpression",P_t="Identifier",j_t="Literal",U_t="LogicalExpression",W_t="MemberExpression",V_t="ObjectExpression",q_t="Property",G_t="UnaryExpression",H_t="Unexpected token %0",Y_t="Unexpected number",X_t="Unexpected string",K_t="Unexpected identifier",Q_t="Unexpected reserved word",Z_t="Unexpected end of input",$_t="Invalid regular expression",J_t="Invalid regular expression: missing /",tAt="Octal literals are not allowed in strict mode.",eAt="Duplicate data property in object literal not allowed in strict mode",nAt="ILLEGAL",rAt="Disabled.",iAt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),aAt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function oAt(t,e){if(!t)throw new Error("ASSERT: "+e)}function sAt(t){return t>=48&&t<=57}function cAt(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function uAt(t){return"01234567".indexOf(t)>=0}function lAt(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function hAt(t){return 10===t||13===t||8232===t||8233===t}function dAt(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||t>=128&&iAt.test(String.fromCharCode(t))}function fAt(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||t>=128&&aAt.test(String.fromCharCode(t))}const pAt={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function gAt(){for(;A_t<C_t;){const t=__t.charCodeAt(A_t);if(!lAt(t)&&!hAt(t))break;++A_t}}function mAt(t){var e,n,r,i=0;for(n="u"===t?4:2,e=0;e<n;++e)A_t<C_t&&cAt(__t[A_t])?(r=__t[A_t++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):IAt({},H_t,nAt);return String.fromCharCode(i)}function vAt(){var t,e,n,r;for(e=0,"}"===(t=__t[A_t])&&IAt({},H_t,nAt);A_t<C_t&&cAt(t=__t[A_t++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||"}"!==t)&&IAt({},H_t,nAt),e<=65535?String.fromCharCode(e):(n=55296+(e-65536>>10),r=56320+(e-65536&1023),String.fromCharCode(n,r))}function yAt(){var t,e;for(t=__t.charCodeAt(A_t++),e=String.fromCharCode(t),92===t&&(117!==__t.charCodeAt(A_t)&&IAt({},H_t,nAt),++A_t,(t=mAt("u"))&&"\\"!==t&&dAt(t.charCodeAt(0))||IAt({},H_t,nAt),e=t);A_t<C_t&&fAt(t=__t.charCodeAt(A_t));)++A_t,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==__t.charCodeAt(A_t)&&IAt({},H_t,nAt),++A_t,(t=mAt("u"))&&"\\"!==t&&fAt(t.charCodeAt(0))||IAt({},H_t,nAt),e+=t);return e}function bAt(){var t,e;return t=A_t,e=92===__t.charCodeAt(A_t)?yAt():function(){var t,e;for(t=A_t++;A_t<C_t;){if(92===(e=__t.charCodeAt(A_t)))return A_t=t,yAt();if(!fAt(e))break;++A_t}return __t.slice(t,A_t)}(),{type:1===e.length?N_t:pAt.hasOwnProperty(e)?F_t:"null"===e?D_t:"true"===e||"false"===e?E_t:N_t,value:e,start:t,end:A_t}}function xAt(){var t,e,n,r,i=A_t,a=__t.charCodeAt(A_t),o=__t[A_t];switch(a){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++A_t,{type:M_t,value:String.fromCharCode(a),start:i,end:A_t};default:if(61===(t=__t.charCodeAt(A_t+1)))switch(a){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return A_t+=2,{type:M_t,value:String.fromCharCode(a)+String.fromCharCode(t),start:i,end:A_t};case 33:case 61:return A_t+=2,61===__t.charCodeAt(A_t)&&++A_t,{type:M_t,value:__t.slice(i,A_t),start:i,end:A_t}}}return">>>="===(r=__t.substr(A_t,4))?{type:M_t,value:r,start:i,end:A_t+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:M_t,value:n,start:i,end:A_t+=3}:o===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(o)>=0||"=>"===e?{type:M_t,value:e,start:i,end:A_t+=2}:("//"===e&&IAt({},H_t,nAt),"<>=!+-*%&|^/".indexOf(o)>=0?(++A_t,{type:M_t,value:o,start:i,end:A_t}):void IAt({},H_t,nAt))}function wAt(){var t,e,n;if(oAt(sAt((n=__t[A_t]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),e=A_t,t="","."!==n){if(t=__t[A_t++],n=__t[A_t],"0"===t){if("x"===n||"X"===n)return++A_t,function(t){let e="";for(;A_t<C_t&&cAt(__t[A_t]);)e+=__t[A_t++];return 0===e.length&&IAt({},H_t,nAt),dAt(__t.charCodeAt(A_t))&&IAt({},H_t,nAt),{type:I_t,value:parseInt("0x"+e,16),start:t,end:A_t}}(e);if(uAt(n))return function(t){let e="0"+__t[A_t++];for(;A_t<C_t&&uAt(__t[A_t]);)e+=__t[A_t++];return(dAt(__t.charCodeAt(A_t))||sAt(__t.charCodeAt(A_t)))&&IAt({},H_t,nAt),{type:I_t,value:parseInt(e,8),octal:!0,start:t,end:A_t}}(e);n&&sAt(n.charCodeAt(0))&&IAt({},H_t,nAt)}for(;sAt(__t.charCodeAt(A_t));)t+=__t[A_t++];n=__t[A_t]}if("."===n){for(t+=__t[A_t++];sAt(__t.charCodeAt(A_t));)t+=__t[A_t++];n=__t[A_t]}if("e"===n||"E"===n)if(t+=__t[A_t++],"+"!==(n=__t[A_t])&&"-"!==n||(t+=__t[A_t++]),sAt(__t.charCodeAt(A_t)))for(;sAt(__t.charCodeAt(A_t));)t+=__t[A_t++];else IAt({},H_t,nAt);return dAt(__t.charCodeAt(A_t))&&IAt({},H_t,nAt),{type:I_t,value:parseFloat(t),start:e,end:A_t}}function kAt(){var t,e,n,r;return S_t=null,gAt(),t=A_t,e=function(){var t,e,n,r;for(oAt("/"===(t=__t[A_t]),"Regular expression literal must start with a slash"),e=__t[A_t++],n=!1,r=!1;A_t<C_t;)if(e+=t=__t[A_t++],"\\"===t)hAt((t=__t[A_t++]).charCodeAt(0))&&IAt({},J_t),e+=t;else if(hAt(t.charCodeAt(0)))IAt({},J_t);else if(n)"]"===t&&(n=!1);else{if("/"===t){r=!0;break}"["===t&&(n=!0)}return r||IAt({},J_t),{value:e.substr(1,e.length-2),literal:e}}(),n=function(){var t,e,n;for(e="",n="";A_t<C_t&&fAt((t=__t[A_t]).charCodeAt(0));)++A_t,"\\"===t&&A_t<C_t?IAt({},H_t,nAt):(n+=t,e+=t);return n.search(/[^gimuy]/g)>=0&&IAt({},$_t,n),{value:n,literal:e}}(),r=function(t,e){let n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,((t,e)=>{if(parseInt(e,16)<=1114111)return"x";IAt({},$_t)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){IAt({},$_t)}try{return new RegExp(t,e)}catch(i){return null}}(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:A_t}}function _At(){if(gAt(),A_t>=C_t)return{type:T_t,start:A_t,end:A_t};const t=__t.charCodeAt(A_t);return dAt(t)?bAt():40===t||41===t||59===t?xAt():39===t||34===t?function(){var t,e,n,r,i="",a=!1;for(oAt("'"===(t=__t[A_t])||'"'===t,"String literal must starts with a quote"),e=A_t,++A_t;A_t<C_t;){if((n=__t[A_t++])===t){t="";break}if("\\"===n)if((n=__t[A_t++])&&hAt(n.charCodeAt(0)))"\r"===n&&"\n"===__t[A_t]&&++A_t;else switch(n){case"u":case"x":"{"===__t[A_t]?(++A_t,i+=vAt()):i+=mAt(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:uAt(n)?(0!==(r="01234567".indexOf(n))&&(a=!0),A_t<C_t&&uAt(__t[A_t])&&(a=!0,r=8*r+"01234567".indexOf(__t[A_t++]),"0123".indexOf(n)>=0&&A_t<C_t&&uAt(__t[A_t])&&(r=8*r+"01234567".indexOf(__t[A_t++]))),i+=String.fromCharCode(r)):i+=n}else{if(hAt(n.charCodeAt(0)))break;i+=n}}return""!==t&&IAt({},H_t,nAt),{type:O_t,value:i,octal:a,start:e,end:A_t}}():46===t?sAt(__t.charCodeAt(A_t+1))?wAt():xAt():sAt(t)?wAt():xAt()}function AAt(){const t=S_t;return A_t=t.end,S_t=_At(),A_t=t.end,t}function CAt(){const t=A_t;S_t=_At(),A_t=t}function SAt(t,e,n){const r=new w_t("||"===t||"&&"===t?U_t:z_t);return r.operator=t,r.left=e,r.right=n,r}function EAt(t,e){const n=new w_t(B_t);return n.callee=t,n.arguments=e,n}function TAt(t){const e=new w_t(P_t);return e.name=t,e}function NAt(t){const e=new w_t(j_t);return e.value=t.value,e.raw=__t.slice(t.start,t.end),t.regex&&("//"===e.raw&&(e.raw="/(?:)/"),e.regex=t.regex),e}function FAt(t,e,n){const r=new w_t(W_t);return r.computed="["===t,r.object=e,r.property=n,r.computed||(n.member=!0),r}function DAt(t,e,n){const r=new w_t(q_t);return r.key=e,r.value=n,r.kind=t,r}function IAt(t,e){var n,r=Array.prototype.slice.call(arguments,2),i=e.replace(/%(\d)/g,((t,e)=>(oAt(e<r.length,"Message reference must be in range"),r[e])));throw(n=new Error(i)).index=A_t,n.description=i,n}function MAt(t){t.type===T_t&&IAt(t,Z_t),t.type===I_t&&IAt(t,Y_t),t.type===O_t&&IAt(t,X_t),t.type===N_t&&IAt(t,K_t),t.type===F_t&&IAt(t,Q_t),IAt(t,H_t,t.value)}function OAt(t){const e=AAt();e.type===M_t&&e.value===t||MAt(e)}function RAt(t){return S_t.type===M_t&&S_t.value===t}function zAt(t){return S_t.type===F_t&&S_t.value===t}function BAt(){const t=[];for(A_t=S_t.start,OAt("[");!RAt("]");)RAt(",")?(AAt(),t.push(null)):(t.push(KAt()),RAt("]")||OAt(","));return AAt(),function(t){const e=new w_t(R_t);return e.elements=t,e}(t)}function LAt(){A_t=S_t.start;const t=AAt();return t.type===O_t||t.type===I_t?(t.octal&&IAt(t,tAt),NAt(t)):TAt(t.value)}function PAt(){var t,e,n;return A_t=S_t.start,(t=S_t).type===N_t?(n=LAt(),OAt(":"),DAt("init",n,KAt())):t.type!==T_t&&t.type!==M_t?(e=LAt(),OAt(":"),DAt("init",e,KAt())):void MAt(t)}function jAt(){var t,e,n=[],r={},i=String;for(A_t=S_t.start,OAt("{");!RAt("}");)e="$"+((t=PAt()).key.type===P_t?t.key.name:i(t.key.value)),Object.prototype.hasOwnProperty.call(r,e)?IAt({},eAt):r[e]=!0,n.push(t),RAt("}")||OAt(",");return OAt("}"),function(t){const e=new w_t(V_t);return e.properties=t,e}(n)}const UAt={if:1};function WAt(){var t,e,n;if(RAt("("))return function(){OAt("(");const t=QAt();return OAt(")"),t}();if(RAt("["))return BAt();if(RAt("{"))return jAt();if(t=S_t.type,A_t=S_t.start,t===N_t||UAt[S_t.value])n=TAt(AAt().value);else if(t===O_t||t===I_t)S_t.octal&&IAt(S_t,tAt),n=NAt(AAt());else{if(t===F_t)throw new Error(rAt);t===E_t?((e=AAt()).value="true"===e.value,n=NAt(e)):t===D_t?((e=AAt()).value=null,n=NAt(e)):RAt("/")||RAt("/=")?(n=NAt(kAt()),CAt()):MAt(AAt())}return n}function VAt(){const t=[];if(OAt("("),!RAt(")"))for(;A_t<C_t&&(t.push(KAt()),!RAt(")"));)OAt(",");return OAt(")"),t}function qAt(){A_t=S_t.start;const t=AAt();return function(t){return t.type===N_t||t.type===F_t||t.type===E_t||t.type===D_t}(t)||MAt(t),TAt(t.value)}function GAt(){OAt("[");const t=QAt();return OAt("]"),t}function HAt(){const t=function(){var t;for(t=WAt();;)if(RAt("."))OAt("."),t=FAt(".",t,qAt());else if(RAt("("))t=EAt(t,VAt());else{if(!RAt("["))break;t=FAt("[",t,GAt())}return t}();if(S_t.type===M_t&&(RAt("++")||RAt("--")))throw new Error(rAt);return t}function YAt(){var t,e;if(S_t.type!==M_t&&S_t.type!==F_t)e=HAt();else{if(RAt("++")||RAt("--"))throw new Error(rAt);if(RAt("+")||RAt("-")||RAt("~")||RAt("!"))t=AAt(),e=YAt(),e=function(t,e){const n=new w_t(G_t);return n.operator=t,n.argument=e,n.prefix=!0,n}(t.value,e);else{if(zAt("delete")||zAt("void")||zAt("typeof"))throw new Error(rAt);e=HAt()}}return e}function XAt(t){let e=0;if(t.type!==M_t&&t.type!==F_t)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function KAt(){var t,e;return t=function(){var t,e,n,r,i,a,o,s,c,u;if(t=S_t,c=YAt(),0===(i=XAt(r=S_t)))return c;for(r.prec=i,AAt(),e=[t,S_t],a=[c,r,o=YAt()];(i=XAt(S_t))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)o=a.pop(),s=a.pop().value,c=a.pop(),e.pop(),n=SAt(s,c,o),a.push(n);(r=AAt()).prec=i,a.push(r),e.push(S_t),n=YAt(),a.push(n)}for(n=a[u=a.length-1],e.pop();u>1;)e.pop(),n=SAt(a[u-1].value,a[u-2],n),u-=2;return n}(),RAt("?")&&(AAt(),e=KAt(),OAt(":"),t=function(t,e,n){const r=new w_t(L_t);return r.test=t,r.consequent=e,r.alternate=n,r}(t,e,KAt())),t}function QAt(){const t=KAt();if(RAt(","))throw new Error(rAt);return t}function ZAt(t){A_t=0,C_t=(__t=t).length,S_t=null,CAt();const e=QAt();if(S_t.type!==T_t)throw new Error("Unexpect token after expression.");return e}var $At={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function JAt(t){function e(e,n,r){return i=>function(e,n,r,i){let a=t(n[0]);return r&&(a=r+"("+a+")",0===r.lastIndexOf("new ",0)&&(a="("+a+")")),a+"."+e+(i<0?"":0===i?"()":"("+n.slice(1).map(t).join(",")+")")}(e,i,n,r)}const n="new Date",r="String",i="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(e){e.length<3&&i_t("Missing arguments to clamp function."),e.length>3&&i_t("Too many arguments to clamp function.");const n=e.map(t);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:e("getDate",n,0),day:e("getDay",n,0),year:e("getFullYear",n,0),month:e("getMonth",n,0),hours:e("getHours",n,0),minutes:e("getMinutes",n,0),seconds:e("getSeconds",n,0),milliseconds:e("getMilliseconds",n,0),time:e("getTime",n,0),timezoneoffset:e("getTimezoneOffset",n,0),utcdate:e("getUTCDate",n,0),utcday:e("getUTCDay",n,0),utcyear:e("getUTCFullYear",n,0),utcmonth:e("getUTCMonth",n,0),utchours:e("getUTCHours",n,0),utcminutes:e("getUTCMinutes",n,0),utcseconds:e("getUTCSeconds",n,0),utcmilliseconds:e("getUTCMilliseconds",n,0),length:e("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:e("toUpperCase",r,0),lower:e("toLowerCase",r,0),substring:e("substring",r),split:e("split",r),trim:e("trim",r,0),regexp:i,test:e("test",i),if:function(e){e.length<3&&i_t("Missing arguments to if function."),e.length>3&&i_t("Too many arguments to if function.");const n=e.map(t);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}function tCt(t){const e=(t=t||{}).allowed?h_t(t.allowed):{},n=t.forbidden?h_t(t.forbidden):{},r=t.constants||$At,i=(t.functions||JAt)(h),a=t.globalvar,o=t.fieldvar,s=s_t(a)?a:t=>"".concat(a,'["').concat(t,'"]');let c={},u={},l=0;function h(t){if(l_t(t))return t;const e=d[t.type];return null==e&&i_t("Unsupported type: "+t.type),e(t)}const d={Literal:t=>t.raw,Identifier:t=>{const i=t.name;return l>0?i:u_t(n,i)?i_t("Illegal identifier: "+i):u_t(r,i)?r[i]:u_t(e,i)?i:(c[i]=1,s(i))},MemberExpression:t=>{const e=!t.computed,n=h(t.object);e&&(l+=1);const r=h(t.property);return n===o&&(u[function(t){const e=t&&t.length-1;return e&&('"'===t[0]&&'"'===t[e]||"'"===t[0]&&"'"===t[e])?t.slice(1,-1):t}(r)]=1),e&&(l-=1),n+(e?"."+r:"["+r+"]")},CallExpression:t=>{"Identifier"!==t.callee.type&&i_t("Illegal callee type: "+t.callee.type);const e=t.callee.name,n=t.arguments,r=u_t(i,e)&&i[e];return r||i_t("Unrecognized function: "+e),s_t(r)?r(n):r+"("+n.map(h).join(",")+")"},ArrayExpression:t=>"["+t.elements.map(h).join(",")+"]",BinaryExpression:t=>"("+h(t.left)+" "+t.operator+" "+h(t.right)+")",UnaryExpression:t=>"("+t.operator+h(t.argument)+")",ConditionalExpression:t=>"("+h(t.test)+"?"+h(t.consequent)+":"+h(t.alternate)+")",LogicalExpression:t=>"("+h(t.left)+t.operator+h(t.right)+")",ObjectExpression:t=>"{"+t.properties.map(h).join(",")+"}",Property:t=>{l+=1;const e=h(t.key);return l-=1,e+":"+h(t.value)}};function f(t){const e={code:h(t),globals:Object.keys(c),fields:Object.keys(u)};return c={},u={},e}return f.functions=i,f.constants=r,f}const eCt="view",nCt="[",rCt="]",iCt="{",aCt="}",oCt=":",sCt=",",cCt="@",uCt=">",lCt=/[[\]{}]/,hCt={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let dCt,fCt;function pCt(t,e,n){return dCt=e||eCt,fCt=n||hCt,mCt(t.trim()).map(vCt)}function gCt(t,e,n,r,i){const a=t.length;let o,s=0;for(;e<a;++e){if(o=t[e],!s&&o===n)return e;i&&i.indexOf(o)>=0?--s:r&&r.indexOf(o)>=0&&++s}return e}function mCt(t){const e=[],n=t.length;let r=0,i=0;for(;i<n;)i=gCt(t,i,sCt,nCt+iCt,rCt+aCt),e.push(t.substring(r,i).trim()),r=++i;if(0===e.length)throw"Empty event selector: "+t;return e}function vCt(t){return"["===t[0]?function(t){const e=t.length;let n,r=1;if(r=gCt(t,r,rCt,nCt,rCt),r===e)throw"Empty between selector: "+t;if(n=mCt(t.substring(1,r)),2!==n.length)throw"Between selector must have two elements: "+t;if(t=t.slice(r+1).trim(),t[0]!==uCt)throw"Expected '>' after between selector: "+t;n=n.map(vCt);const i=vCt(t.slice(1).trim());if(i.between)return{between:n,stream:i};i.between=n;return i}(t):function(t){const e={source:dCt},n=[];let r,i,a=[0,0],o=0,s=0,c=t.length,u=0;if(t[c-1]===aCt){if(u=t.lastIndexOf(iCt),!(u>=0))throw"Unmatched right brace: "+t;try{a=function(t){const e=t.split(sCt);if(!t.length||e.length>2)throw t;return e.map((e=>{const n=+e;if(n!==n)throw t;return n}))}(t.substring(u+1,c-1))}catch(l){throw"Invalid throttle specification: "+t}c=(t=t.slice(0,u).trim()).length,u=0}if(!c)throw t;t[0]===cCt&&(o=++u);r=gCt(t,u,oCt),r<c&&(n.push(t.substring(s,r).trim()),s=u=++r);if(u=gCt(t,u,nCt),u===c)n.push(t.substring(s,c).trim());else if(n.push(t.substring(s,u).trim()),i=[],s=++u,s===c)throw"Unmatched left bracket: "+t;for(;u<c;){if(u=gCt(t,u,rCt),u===c)throw"Unmatched left bracket: "+t;if(i.push(t.substring(s,u).trim()),u<c-1&&t[++u]!==nCt)throw"Expected left bracket: "+t;s=++u}if(!(c=n.length)||lCt.test(n[c-1]))throw"Invalid event selector: "+t;c>1?(e.type=n[1],o?e.markname=n[0].slice(1):!function(t){return fCt[t]}(n[0])?e.source=n[0]:e.marktype=n[0]):e.type=n[0];"!"===e.type.slice(-1)&&(e.consume=!0,e.type=e.type.slice(0,-1));null!=i&&(e.filter=i);a[0]&&(e.throttle=a[0]);a[1]&&(e.debounce=a[1]);return e}(t)}var yCt="5.20.0";oe(Mc,a,s,c,u,l,d,h,f,p,g,m);const bCt=yCt;function xCt(t,e,n){return t.fields=e||[],t.fname=n,t}function wCt(t){return 1===t.length?kCt(t[0]):_Ct(t)}const kCt=t=>function(e){return e[t]},_Ct=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function ACt(t){throw Error(t)}function CCt(t){var e,n,r,i=[],a=null,o=0,s=t.length,c="";function u(){i.push(c+t.substring(e,n)),c="",e=n+1}for(t+="",e=n=0;n<s;++n)if("\\"===(r=t[n]))c+=t.substring(e,n),c+=t.substring(++n,++n),e=n;else if(r===a)u(),a=null,o=-1;else{if(a)continue;e===o&&'"'===r||e===o&&"'"===r?(e=n+1,a=r):"."!==r||o?"["===r?(n>e&&u(),o=e=n+1):"]"===r&&(o||ACt("Access path missing open bracket: "+t),o>0&&u(),o=0,e=n+1):n>e?u():e=n+1}return o&&ACt("Access path missing closing bracket: "+t),a&&ACt("Access path missing closing quote: "+t),n>e&&(n++,u()),i}var SCt=[],ECt=(function(t,e,n){const r=CCt(t);t=1===r.length?r[0]:t,xCt((n&&n.get||wCt)(r),[t],e||t)}("id"),xCt((function(t){return t}),SCt,"identity"));xCt((function(){return 0}),SCt,"zero"),xCt((function(){return 1}),SCt,"one"),xCt((function(){return!0}),SCt,"true"),xCt((function(){return!1}),SCt,"false");function TCt(t,e,n){var r=[e].concat([].slice.call(n));console[t].apply(console,r)}const NCt=Array.isArray;function FCt(t){return t===Object(t)}const DCt=t=>"__proto__"!==t;function ICt(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(((t,e)=>{for(var n in e)if("signals"===n)t.signals=OCt(t.signals,e.signals);else{var r="legend"===n?{layout:1}:"style"===n||null;MCt(t,n,e[n],r)}return t}),{})}function MCt(t,e,n,r){var i,a;if(DCt(e))if(FCt(n)&&!NCt(n))for(i in a=FCt(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?MCt(a,i,n[i]):DCt(i)&&(a[i]=n[i]);else t[e]=n}function OCt(t,e){if(null==t)return e;const n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}function RCt(t){return null!=t?NCt(t)?t:[t]:[]}const zCt=Object.prototype.hasOwnProperty;function BCt(t,e){return zCt.call(t,e)}function LCt(t){return"boolean"===typeof t}function PCt(t){return"number"===typeof t}function jCt(t){return"string"===typeof t}function UCt(t){return NCt(t)?"["+t.map(UCt)+"]":FCt(t)||jCt(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function WCt(t){for(var e={},n=0,r=t.length;n<r;++n)e[t[n]]=!0;return e}function VCt(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}Object.create;Object.create;Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function t(){var e=isNaN(arguments[0])?1:Number(arguments[0]);return e?Array.prototype.reduce.call(this,(function(n,r){return Array.isArray(r)?n.push.apply(n,t.call(r,e-1)):n.push(r),n}),[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(t){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var qCt=n(32129),GCt=n.n(qCt),HCt=n(45355),YCt=n.n(HCt),XCt=n(14110),KCt=n.n(XCt);function QCt(t){return!!t.or}function ZCt(t){return!!t.and}function $Ct(t){return!!t.not}function JCt(t,e){if($Ct(t))JCt(t.not,e);else if(ZCt(t))for(const n of t.and)JCt(n,e);else if(QCt(t))for(const n of t.or)JCt(n,e);else e(t)}function tSt(t,e){return $Ct(t)?{not:tSt(t.not,e)}:ZCt(t)?{and:t.and.map((t=>tSt(t,e)))}:QCt(t)?{or:t.or.map((t=>tSt(t,e)))}:e(t)}const eSt=YCt(),nSt=GCt();function rSt(t,e){const n={};for(const r of e)BCt(t,r)&&(n[r]=t[r]);return n}function iSt(t,e){const n=Object.assign({},t);for(const r of e)delete n[r];return n}Set.prototype.toJSON=function(){return"Set(".concat([...this].map((t=>KCt()(t))).join(","),")")};const aSt=KCt();function oSt(t){if(PCt(t))return t;const e=jCt(t)?t:KCt()(t);if(e.length<250)return e;let n=0;for(let r=0;r<e.length;r++){n=(n<<5)-n+e.charCodeAt(r),n&=n}return n}function sSt(t){return!1===t||null===t}function cSt(t,e){return t.indexOf(e)>-1}function uSt(t,e){let n=0;for(const[r,i]of t.entries())if(e(i,r,n++))return!0;return!1}function lSt(t,e){let n=0;for(const[r,i]of t.entries())if(!e(i,r,n++))return!1;return!0}function hSt(t,e){for(const n of vSt(e))MCt(t,n,e[n],!0)}function dSt(t,e){const n=[],r={};let i;for(const a of t)i=e(a),i in r||(r[i]=1,n.push(a));return n}function fSt(t,e){for(const n of t)if(e.has(n))return!0;return!1}function pSt(t){const e=new Set;for(const n of t){const t=CCt(n).map(((t,e)=>0===e?t:"[".concat(t,"]"))),r=t.map(((e,n)=>t.slice(0,n+1).join("")));for(const n of r)e.add(n)}return e}function gSt(t,e){return void 0===t||void 0===e||fSt(pSt(t),pSt(e))}function mSt(t){return 0===vSt(t).length}const vSt=Object.keys,ySt=Object.values;function bSt(t){const e=[];for(const n in t)BCt(t,n)&&e.push({key:n,value:t[n]});return e}function xSt(t){return!0===t||!1===t}function wSt(t){const e=t.replace(/\W/g,"_");return(t.match(/^\d+/)?"_":"")+e}function kSt(t,e){return $Ct(t)?"!("+kSt(t.not,e)+")":ZCt(t)?"("+t.and.map((t=>kSt(t,e))).join(") && (")+")":QCt(t)?"("+t.or.map((t=>kSt(t,e))).join(") || (")+")":e(t)}function _St(t,e){if(0===e.length)return!0;const n=e.shift();return n in t&&_St(t[n],e)&&delete t[n],mSt(t)}function ASt(t){return t.charAt(0).toUpperCase()+t.substr(1)}function CSt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datum";const n=CCt(t),r=[];for(let i=1;i<=n.length;i++){const t="[".concat(n.slice(0,i).map(UCt).join("]["),"]");r.push("".concat(e).concat(t))}return r.join(" && ")}function SSt(t){return t.replace(/(\[|\]|\.|'|")/g,"\\$1")}function ESt(t){return"".concat(CCt(t).map(SSt).join("\\."))}function TSt(t,e,n){return t.replace(new RegExp(e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function NSt(t){return"".concat(CCt(t).join("."))}function FSt(t){return t?CCt(t).length:0}function DSt(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const r of e)if(void 0!==r)return r}let ISt=42;function MSt(t){if(void 0!==t)return(t%360+360)%360}function OSt(t){return!!PCt(t)||!isNaN(t)&&!isNaN(parseFloat(t))}const RSt={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function zSt(t){return t&&t.condition}const BSt=["domain","grid","labels","ticks","title"],LSt={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},PSt={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},jSt=Object.assign(Object.assign({},PSt),{style:1,labelExpr:1,encoding:1});function USt(t){return!!jSt[t]}vSt(jSt);const WSt={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},VSt=WSt.arc,qSt=WSt.area,GSt=WSt.bar,HSt=WSt.image,YSt=WSt.line,XSt=WSt.point,KSt=WSt.rect,QSt=WSt.rule,ZSt=WSt.text,$St=WSt.tick,JSt=WSt.trail,tEt=WSt.circle,eEt=WSt.square,nEt=WSt.geoshape;function rEt(t){return cSt(["line","area","trail"],t)}function iEt(t){return cSt(["rect","bar","image","arc"],t)}const aEt=vSt(WSt);function oEt(t){return t.type}WCt(aEt);const sEt=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit","fill","fillOpacity"],cEt=vSt({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1}),uEt={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},lEt={binSpacing:1,continuousBandSize:5,timeUnitBandPosition:.5},hEt={binSpacing:0,continuousBandSize:5,timeUnitBandPosition:.5};function dEt(t){return"mark"in t}class fEt{constructor(t,e){this.name=t,this.run=e}hasMatchingType(t){return!!dEt(t)&&function(t){return oEt(t)?t.type:t}(t.mark)===this.name}}const pEt={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},gEt={count:1,min:1,max:1};function mEt(t){return!!t&&!!t.argmin}function vEt(t){return!!t&&!!t.argmax}vSt(pEt);function yEt(t){return jCt(t)&&!!pEt[t]}const bEt=["count","valid","missing","distinct"];function xEt(t){return jCt(t)&&cSt(bEt,t)}const wEt=["count","sum","distinct","valid","missing"],kEt=WCt(["mean","average","median","q1","q3","min","max"]),_Et="row",AEt="column",CEt="facet",SEt="x",EEt="y",TEt="x2",NEt="y2",FEt="radius",DEt="radius2",IEt="theta",MEt="theta2",OEt="latitude",REt="longitude",zEt="latitude2",BEt="longitude2",LEt="color",PEt="fill",jEt="stroke",UEt="shape",WEt="size",VEt="angle",qEt="opacity",GEt="fillOpacity",HEt="strokeOpacity",YEt="strokeWidth",XEt="strokeDash",KEt="text",QEt="order",ZEt="detail",$Et="key",JEt="tooltip",tTt="href",eTt="url",nTt="description",rTt={theta:1,theta2:1,radius:1,radius2:1};function iTt(t){return t in rTt}const aTt={longitude:1,longitude2:1,latitude:1,latitude2:1};const oTt=vSt(aTt),sTt=Object.assign(Object.assign(Object.assign(Object.assign({},{x:1,y:1,x2:1,y2:1}),rTt),aTt),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function cTt(t){return t===LEt||t===PEt||t===jEt}const uTt={row:1,column:1,facet:1},lTt=vSt(uTt),hTt=Object.assign(Object.assign({},sTt),uTt),dTt=vSt(hTt),{order:fTt,detail:pTt,tooltip:gTt}=hTt,mTt=VCt(hTt,["order","detail","tooltip"]),{row:vTt,column:yTt,facet:bTt}=mTt,xTt=VCt(mTt,["row","column","facet"]);vSt(mTt),vSt(xTt);function wTt(t){return!!hTt[t]}const kTt=[TEt,NEt,zEt,BEt,MEt,DEt];function _Tt(t){return ATt(t)!==t}function ATt(t){switch(t){case TEt:return SEt;case NEt:return EEt;case zEt:return OEt;case BEt:return REt;case MEt:return IEt;case DEt:return FEt}return t}function CTt(t){if(iTt(t))switch(t){case IEt:return"startAngle";case MEt:return"endAngle";case FEt:return"outerRadius";case DEt:return"innerRadius"}return t}function STt(t){switch(t){case SEt:return TEt;case EEt:return NEt;case OEt:return zEt;case REt:return BEt;case IEt:return MEt;case FEt:return DEt}}function ETt(t){switch(t){case SEt:case TEt:return"width";case EEt:case NEt:return"height"}}vSt(sTt);const{x:TTt,y:NTt,x2:FTt,y2:DTt,latitude:ITt,longitude:MTt,latitude2:OTt,longitude2:RTt,theta:zTt,theta2:BTt,radius:LTt,radius2:PTt}=sTt,jTt=VCt(sTt,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),UTt=vSt(jTt),WTt={x:1,y:1},VTt=vSt(WTt);function qTt(t){return t in WTt}const GTt={theta:1,radius:1},HTt=vSt(GTt);function YTt(t){return"width"===t?SEt:EEt}const{text:XTt,tooltip:KTt,href:QTt,url:ZTt,description:$Tt,detail:JTt,key:tNt,order:eNt}=jTt,nNt=VCt(jTt,["text","tooltip","href","url","description","detail","key","order"]),rNt=vSt(nNt);const iNt=Object.assign(Object.assign(Object.assign({},WTt),GTt),nNt),aNt=vSt(iNt);function oNt(t){return!!iNt[t]}function sNt(t,e){return function(t){switch(t){case LEt:case PEt:case jEt:case nTt:case ZEt:case $Et:case JEt:case tTt:case QEt:case qEt:case GEt:case HEt:case YEt:case CEt:case _Et:case AEt:return cNt;case SEt:case EEt:case OEt:case REt:return lNt;case TEt:case NEt:case zEt:case BEt:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case WEt:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case XEt:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case UEt:return{point:"always",geoshape:"always"};case KEt:return{text:"always"};case VEt:return{point:"always",square:"always",text:"always"};case eTt:return{image:"always"};case IEt:case FEt:return{text:"always",arc:"always"};case MEt:case DEt:return{arc:"always"}}}(t)[e]}const cNt={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:uNt}=cNt,lNt=VCt(cNt,["geoshape"]);function hNt(t){switch(t){case SEt:case EEt:case IEt:case FEt:case WEt:case VEt:case YEt:case qEt:case GEt:case HEt:case TEt:case NEt:case MEt:case DEt:return;case CEt:case _Et:case AEt:case UEt:case XEt:case KEt:case JEt:case tTt:case eTt:case nTt:return"discrete";case LEt:case PEt:case jEt:return"flexible";case OEt:case REt:case zEt:case BEt:case ZEt:case $Et:case QEt:return}}function dNt(t){return LCt(t)&&(t=xIt(t,void 0)),"bin"+vSt(t).map((e=>mNt(t[e])?wSt("_".concat(e,"_").concat(Object.entries(t[e]))):wSt("_".concat(e,"_").concat(t[e])))).join("")}function fNt(t){return!0===t||gNt(t)&&!t.binned}function pNt(t){return"binned"===t||gNt(t)&&!0===t.binned}function gNt(t){return FCt(t)}function mNt(t){return null===t||void 0===t?void 0:t.selection}function vNt(t){switch(t){case _Et:case AEt:case WEt:case LEt:case PEt:case jEt:case YEt:case qEt:case GEt:case HEt:case UEt:return 6;case XEt:return 4;default:return 10}}function yNt(t){return"Invalid specification ".concat(JSON.stringify(t),'. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".')}const bNt='Autosize "fit" only works for single views and layered views.';function xNt(t){return"".concat("width"==t?"Width":"Height",' "container" only works for single views and layered views.')}function wNt(t){const e="width"==t?"x":"y";return"".concat("width"==t?"Width":"Height",' "container" only works well with autosize "fit" or "fit-').concat(e,'".')}function kNt(t){return t?'Dropping "fit-'.concat(t,'" because spec has discrete ').concat(ETt(t),"."):'Dropping "fit" because spec has discrete size.'}function _Nt(t){return'Cannot project a selection on encoding channel "'.concat(t,'", which has no field.')}function ANt(t,e){return'Cannot project a selection on encoding channel "'.concat(t,'" as it uses an aggregate function ("').concat(e,'").')}function CNt(t){return"Selection not supported for ".concat(t," yet.")}function SNt(t){return'The "columns" property cannot be used when "'.concat(t,'" has nested row/column.')}function ENt(t,e,n){return'An ancestor parsed field "'.concat(t,'" as ').concat(n," but a child wants to parse the field as ").concat(e,".")}function TNt(t){return"Ignoring an invalid transform: ".concat(aSt(t),".")}function NNt(t){return"Config.customFormatTypes is not true, thus custom format type and format for channel ".concat(t," are dropped.")}function FNt(t){return'Invalid field type "'.concat(t,'".')}function DNt(t,e){const{fill:n,stroke:r}=e;return"Dropping color ".concat(t," as the plot also has ").concat(n&&r?"fill and stroke":n?"fill":"stroke",".")}function INt(t,e){return"Dropping ".concat(aSt(t),' from channel "').concat(e,'" since it does not contain any data field, datum, value, or signal.')}function MNt(t,e,n){return"".concat(t,' dropped as it is incompatible with "').concat(e,'"').concat(n?" when ".concat(n):"",".")}function ONt(t){return"".concat(t," encoding should be discrete (ordinal / nominal / binned).")}function RNt(t,e){return'Using discrete channel "'.concat(t,'" to encode "').concat(e,'" field can be misleading as it does not encode ').concat("ordinal"===e?"order":"magnitude",".")}function zNt(t){return"Using unaggregated domain with raw field has no effect (".concat(aSt(t),").")}function BNt(t){return'Unaggregated domain not applicable for "'.concat(t,'" since it produces values outside the origin domain of the source data.')}function LNt(t){return"Unaggregated domain is currently unsupported for log scale (".concat(aSt(t),").")}function PNt(t,e,n){return"".concat(n,"-scale's \"").concat(e,'" is dropped as it does not work with ').concat(t," scale.")}function jNt(t){return'The step for "'.concat(t,'" is dropped because the ').concat("width"===t?"x":"y"," is continuous.")}const UNt="Domains that should be unioned has conflicting sort properties. Sort will be set to true.";function WNt(t,e){return"Invalid ".concat(t,": ").concat(aSt(e),".")}function VNt(t){return"1D error band does not support ".concat(t,".")}function qNt(t){return"Channel ".concat(t,' is required for "binned" bin.')}const GNt=function(t,e){var n=t||0;return{level:function(t){return arguments.length?(n=+t,this):n},error:function(){return n>=1&&TCt(e||"error","ERROR",arguments),this},warn:function(){return n>=2&&TCt(e||"warn","WARN",arguments),this},info:function(){return n>=3&&TCt(e||"log","INFO",arguments),this},debug:function(){return n>=4&&TCt(e||"log","DEBUG",arguments),this}}}(2);let HNt=GNt;function YNt(){return HNt=GNt,HNt}function XNt(){HNt.warn(...arguments)}function KNt(t){if(t&&FCt(t))for(const e of rFt)if(e in t)return!0;return!1}const QNt=["january","february","march","april","may","june","july","august","september","october","november","december"],ZNt=QNt.map((t=>t.substr(0,3))),$Nt=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],JNt=$Nt.map((t=>t.substr(0,3)));function tFt(t,e){const n=[];if(e&&void 0!==t.day&&vSt(t).length>1&&(XNt(function(t){return"Dropping day from datetime ".concat(aSt(t)," as day cannot be combined with other units.")}(t)),delete(t=nSt(t)).day),void 0!==t.year?n.push(t.year):n.push(2012),void 0!==t.month){const r=e?function(t){if(OSt(t)&&(t=+t),PCt(t))return t-1;{const e=t.toLowerCase(),n=QNt.indexOf(e);if(-1!==n)return n;const r=e.substr(0,3),i=ZNt.indexOf(r);if(-1!==i)return i;throw new Error(WNt("month",t))}}(t.month):t.month;n.push(r)}else if(void 0!==t.quarter){const r=e?function(t){if(OSt(t)&&(t=+t),PCt(t))return t>4&&XNt(WNt("quarter",t)),t-1;throw new Error(WNt("quarter",t))}(t.quarter):t.quarter;n.push(PCt(r)?3*r:r+"*3")}else n.push(0);if(void 0!==t.date)n.push(t.date);else if(void 0!==t.day){const r=e?function(t){if(OSt(t)&&(t=+t),PCt(t))return t%7;{const e=t.toLowerCase(),n=$Nt.indexOf(e);if(-1!==n)return n;const r=e.substr(0,3),i=JNt.indexOf(r);if(-1!==i)return i;throw new Error(WNt("day",t))}}(t.day):t.day;n.push(PCt(r)?r+1:r+"+1")}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const e=t[r];n.push("undefined"===typeof e?0:e)}return n}function eFt(t){const e=tFt(t,!0).join(", ");return t.utc?"utc(".concat(e,")"):"datetime(".concat(e,")")}const nFt={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},rFt=vSt(nFt);function iFt(t){return t.startsWith("utc")}const aFt={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function oFt(t){const e=[];for(const n of rFt)sFt(t,n)&&e.push(n);return e}function sFt(t,e){const n=t.indexOf(e);return!(n<0)&&(!(n>0&&"seconds"===e&&"i"===t.charAt(n-1))&&(!(t.length>n+3&&"day"===e&&"o"===t.charAt(n+3))&&!(n>0&&"year"===e&&"f"===t.charAt(n-1))))}function cFt(t,e){let{end:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{end:!1};const r=CSt(e),i=iFt(t)?"utc":"";let a;const o={};for(const c of rFt)sFt(t,c)&&(o[c]="quarter"===(s=c)?"(".concat(i,"quarter(").concat(r,")-1)"):"".concat(i).concat(s,"(").concat(r,")"),a=c);var s;return n&&(o[a]+="+1"),function(t){const e=tFt(t,!1).join(", ");return t.utc?"utc(".concat(e,")"):"datetime(".concat(e,")")}(o)}function uFt(t){if(!t)return;const e=oFt(t);return"timeUnitSpecifier(".concat(KCt()(e),", ").concat(KCt()(aFt),")")}function lFt(t){if(!t)return;let e;return jCt(t)?e={unit:t}:FCt(t)&&(e=Object.assign(Object.assign({},t),t.unit?{unit:t.unit}:{})),iFt(e.unit)&&(e.utc=!0,e.unit=e.unit.substr(3)),e}function hFt(t){return t&&!!t.signal}function dFt(t){return!!t.step}function fFt(t){return!NCt(t)&&("field"in t&&"data"in t)}const pFt=vSt({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1}),gFt={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},mFt=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function vFt(t){return t&&!!t.field&&void 0!==t.equal}function yFt(t){return t&&!!t.field&&void 0!==t.lt}function bFt(t){return t&&!!t.field&&void 0!==t.lte}function xFt(t){return t&&!!t.field&&void 0!==t.gt}function wFt(t){return t&&!!t.field&&void 0!==t.gte}function kFt(t){if(t&&t.field){if(NCt(t.range)&&2===t.range.length)return!0;if(hFt(t.range))return!0}return!1}function _Ft(t){return t&&!!t.field&&(NCt(t.oneOf)||NCt(t.in))}function AFt(t){return _Ft(t)||vFt(t)||kFt(t)||yFt(t)||xFt(t)||bFt(t)||wFt(t)}function CFt(t,e){return _It(t,{timeUnit:e,wrapTime:!0})}function SFt(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var n;const{field:r}=t,i=null===(n=lFt(t.timeUnit))||void 0===n?void 0:n.unit,a=i?"time("+cFt(i,r)+")":aIt(t,{expr:"datum"});if(vFt(t))return a+"==="+CFt(t.equal,i);if(yFt(t)){const e=t.lt;return"".concat(a,"<").concat(CFt(e,i))}if(xFt(t)){const e=t.gt;return"".concat(a,">").concat(CFt(e,i))}if(bFt(t)){const e=t.lte;return"".concat(a,"<=").concat(CFt(e,i))}if(wFt(t)){const e=t.gte;return"".concat(a,">=").concat(CFt(e,i))}if(_Ft(t))return"indexof([".concat(function(t,e){return t.map((t=>CFt(t,e)))}(t.oneOf,i).join(","),"], ").concat(a,") !== -1");if(function(t){return t&&!!t.field&&void 0!==t.valid}(t))return EFt(a,t.valid);if(kFt(t)){const{range:n}=t,r=hFt(n)?{signal:"".concat(n.signal,"[0]")}:n[0],o=hFt(n)?{signal:"".concat(n.signal,"[1]")}:n[1];if(null!==r&&null!==o&&e)return"inrange("+a+", ["+CFt(r,i)+", "+CFt(o,i)+"])";const s=[];return null!==r&&s.push("".concat(a," >= ").concat(CFt(r,i))),null!==o&&s.push("".concat(a," <= ").concat(CFt(o,i))),s.length>0?s.join(" && "):"true"}throw new Error("Invalid field predicate: ".concat(JSON.stringify(t)))}function EFt(t){return!(arguments.length>1&&void 0!==arguments[1])||arguments[1]?"isValid(".concat(t,") && isFinite(+").concat(t,")"):"!isValid(".concat(t,") || !isFinite(+").concat(t,")")}function TFt(t){var e;return AFt(t)&&t.timeUnit?Object.assign(Object.assign({},t),{timeUnit:null===(e=lFt(t.timeUnit))||void 0===e?void 0:e.unit}):t}const NFt={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};const FFt=NFt.quantitative,DFt=NFt.ordinal,IFt=NFt.temporal,MFt=NFt.nominal,OFt=NFt.geojson,RFt=vSt(NFt);const zFt={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},BFt={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},LFt=vSt(BFt);function PFt(t,e){const n=BFt[t],r=BFt[e];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n}const jFt={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function UFt(t){return jFt[t]}const WFt=["linear","log","pow","sqrt","symlog","time","utc"],VFt=WCt(WFt),qFt=WCt(["linear","log","pow","sqrt","symlog"]);const GFt=WCt(["quantile","quantize","threshold"]),HFt=WCt(WFt.concat(["quantile","quantize","threshold","sequential","identity"])),YFt=WCt(["ordinal","bin-ordinal","point","band"]);function XFt(t){return t in YFt}function KFt(t){return t in HFt}function QFt(t){return t in VFt}function ZFt(t){return t in GFt}function $Ft(t){return null===t||void 0===t?void 0:t.selection}const JFt={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:tDt,domain:eDt,range:nDt,scheme:rDt}=(vSt(JFt),JFt),iDt=VCt(JFt,["type","domain","range","scheme"]),aDt=vSt(iDt);!function(){var t;const e={};for(const n of dTt)for(const r of RFt)for(const i of LFt){const a=lDt(n,r);uDt(n,i)&&cDt(i,r)&&(e[a]=null!==(t=e[a])&&void 0!==t?t:[],e[a].push(i))}}();function oDt(t,e){switch(e){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!cSt(["point","band","identity"],t);case"bins":return!cSt(["point","band","identity","ordinal"],t);case"round":return QFt(t)||"band"===t||"point"===t;case"padding":return QFt(t)||cSt(["point","band"],t);case"paddingOuter":case"align":return cSt(["point","band"],t);case"paddingInner":return"band"===t;case"domainMid":case"clamp":return QFt(t);case"nice":return QFt(t)||"quantize"===t||"threshold"===t;case"exponent":return"pow"===t;case"base":return"log"===t;case"constant":return"symlog"===t;case"zero":return KFt(t)&&!cSt(["log","time","utc","threshold","quantile"],t)}}function sDt(t,e){switch(e){case"interpolate":case"scheme":case"domainMid":return cTt(t)?void 0:'Cannot use the scale property "'.concat(t,'" with non-color channel.');case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function cDt(t,e){return cSt([DFt,MFt],e)?void 0===t||XFt(t):e===IFt?cSt([zFt.TIME,zFt.UTC,void 0],t):e!==FFt||cSt([zFt.LOG,zFt.POW,zFt.SQRT,zFt.SYMLOG,zFt.QUANTILE,zFt.QUANTIZE,zFt.THRESHOLD,zFt.LINEAR,void 0],t)}function uDt(t,e){if(!oNt(t))return!1;switch(t){case SEt:case EEt:case IEt:case FEt:return QFt(e)||cSt(["band","point"],e);case WEt:case YEt:case qEt:case GEt:case HEt:case VEt:return QFt(e)||ZFt(e)||cSt(["band","point","ordinal"],e);case LEt:case PEt:case jEt:return"band"!==e;case XEt:return"ordinal"===e||ZFt(e);case UEt:return"ordinal"===e}}function lDt(t,e){return t+"_"+e}function hDt(t){const{channel:e,channelDef:n,markDef:r,scale:i,config:a}=t,o=vDt(t);return YDt(n)&&!xEt(n.aggregate)&&i&&QFt(i.get("type"))&&!1===i.get("zero")?dDt({fieldDef:n,channel:e,markDef:r,ref:o,config:a}):o}function dDt(t){let{fieldDef:e,channel:n,markDef:r,ref:i,config:a}=t;if(rEt(r.type))return i;return null===IIt("invalid",r,a)?i:[fDt(e,n),i]}function fDt(t,e){const n=pDt(t,!0),r="y"===ATt(e)?{field:{group:"height"}}:{value:0};return Object.assign({test:n},r)}function pDt(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return EFt(jCt(t)?t:aIt(t,{expr:"datum"}),!e)}function gDt(t,e,n,r){const i={};if(e&&(i.scale=e),KDt(t)){const{datum:e}=t;KNt(e)?i.signal=eFt(e):hFt(e)?i.signal=e.signal:i.value=e}else i.field=aIt(t,n);if(r){const{offset:t,band:e}=r;t&&(i.offset=t),e&&(i.band=e)}return i}function mDt(t){let{scaleName:e,fieldOrDatumDef:n,fieldOrDatumDef2:r,offset:i,startSuffix:a,band:o=.5}=t;const s=0<o&&o<1?"datum":void 0,c=aIt(n,{expr:s,suffix:a}),u=void 0!==r?aIt(r,{expr:s}):aIt(n,{suffix:"end",expr:s}),l={};if(0===o||1===o){l.scale=e;const t=0===o?c:u;l.field=t}else{const t="".concat(o," * ").concat(c," + ").concat(1-o," * ").concat(u);l.signal='scale("'.concat(e,'", ').concat(t,")")}return i&&(l.offset=i),l}function vDt(t){let{channel:e,channelDef:n,channel2Def:r,markDef:i,config:a,scaleName:o,scale:s,stack:c,offset:u,defaultRef:l,band:h}=t;var d;if(n){if($Dt(n)){if(JDt(n)){h=null!==h&&void 0!==h?h:WDt({channel:e,fieldDef:n,fieldDef2:r,markDef:i,stack:c,config:a,isMidPoint:!0});const{bin:t,timeUnit:s,type:l}=n;if(fNt(t)||h&&s&&l===IFt)return c&&c.impute?gDt(n,o,{binSuffix:"mid"},{offset:u}):h?mDt({scaleName:o,fieldOrDatumDef:n,band:h,offset:u}):gDt(n,o,CIt(n,e)?{binSuffix:"range"}:{},{offset:u});if(pNt(t)){if(YDt(r))return mDt({scaleName:o,fieldOrDatumDef:n,fieldOrDatumDef2:r,band:h,offset:u});XNt(qNt(e===SEt?TEt:NEt))}}const t=null===s||void 0===s?void 0:s.get("type");return gDt(n,o,XFt(t)?{binSuffix:"range"}:{},{offset:u,band:"band"===t?null!==(d=null!==h&&void 0!==h?h:n.band)&&void 0!==d?d:.5:void 0})}if(tIt(n)){const t=n.value,r=u?{offset:u}:{};return Object.assign(Object.assign({},yDt(e,t)),r)}}return"function"===typeof l&&(l=l()),l?Object.assign(Object.assign({},l),u?{offset:u}:{}):l}function yDt(t,e){return cSt(["x","x2"],t)&&"width"===e?{field:{group:"width"}}:cSt(["y","y2"],t)&&"height"===e?{field:{group:"height"}}:TIt(e)}function bDt(t){return t&&"number"!==t&&"time"!==t}function xDt(t,e,n){return"".concat(t,"(").concat(e).concat(n?", ".concat(JSON.stringify(n)):"",")")}const wDt=" \u2013 ";function kDt(t){let{fieldOrDatumDef:e,format:n,formatType:r,expr:i,normalizeStack:a,config:o}=t;var s,c;if(bDt(r))return ADt({fieldOrDatumDef:e,format:n,formatType:r,expr:i,config:o});const u=_Dt(e,i,a);if(kIt(e)){const t=function(t,e,n,r,i){return!e||n?(n=jCt(n)?n:r,"".concat(i?"utc":"time","Format(").concat(t,", '").concat(n,"')")):function(t,e,n){if(!t)return;const r=uFt(t),i=n||iFt(t);return"".concat(i?"utc":"time","Format(").concat(e,", ").concat(r,")")}(e,t,i)}(u,YDt(e)?null===(s=lFt(e.timeUnit))||void 0===s?void 0:s.unit:void 0,n,o.timeFormat,eIt(e)&&(null===(c=e.scale)||void 0===c?void 0:c.type)===zFt.UTC);return t?{signal:t}:void 0}if(n=EDt(XDt(e),n,o),YDt(e)&&fNt(e.bin)){return{signal:FDt(u,aIt(e,{expr:i,binSuffix:"end"}),n,r,o)}}return n||"quantitative"===XDt(e)?{signal:"".concat(TDt(u,n))}:{signal:"isValid(".concat(u,") ? ").concat(u,' : ""+').concat(u)}}function _Dt(t,e,n){return YDt(t)?n?"".concat(aIt(t,{expr:e,suffix:"end"}),"-").concat(aIt(t,{expr:e,suffix:"start"})):aIt(t,{expr:e}):function(t){const{datum:e}=t;return KNt(e)?eFt(e):"".concat(JSON.stringify(e))}(t)}function ADt(t){let{fieldOrDatumDef:e,format:n,formatType:r,expr:i,normalizeStack:a,config:o,field:s}=t;if(s=null!==s&&void 0!==s?s:_Dt(e,i,a),YDt(e)&&fNt(e.bin)){return{signal:FDt(s,aIt(e,{expr:i,binSuffix:"end"}),n,r,o)}}return{signal:xDt(r,s,n)}}function CDt(t,e,n,r,i,a){var o;if(!bDt(r)){if(kIt(t)){return function(t,e,n,r){if(t)return t;if(e)return{signal:uFt(e)};return r?void 0:n.timeFormat}(n,YDt(t)?null===(o=lFt(t.timeUnit))||void 0===o?void 0:o.unit:void 0,i,a)}return EDt(e,n,i)}}function SDt(t,e,n){return t&&(hFt(t)||"number"===t||"time"===t)?t:kIt(e)&&"time"!==n&&"utc"!==n?"time":void 0}function EDt(t,e,n){return jCt(e)?e:t===FFt?n.numberFormat:void 0}function TDt(t,e){return"format(".concat(t,', "').concat(e||"",'")')}function NDt(t,e,n,r){var i;return bDt(n)?xDt(n,t,e):TDt(t,null!==(i=jCt(e)?e:void 0)&&void 0!==i?i:r.numberFormat)}function FDt(t,e,n,r,i){const a=NDt(t,n,r,i),o=NDt(e,n,r,i);return"".concat(EFt(t,!1),' ? "null" : ').concat(a,' + "').concat(wDt,'" + ').concat(o)}const DDt="min",IDt={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function MDt(t){return t in IDt}function ODt(t){return!!t&&!!t.encoding}function RDt(t){return!!t&&("count"===t.op||!!t.field)}function zDt(t){return!!t&&NCt(t)}function BDt(t){return"row"in t||"column"in t}function LDt(t){return!!t&&"header"in t}function PDt(t){return"facet"in t}function jDt(t){const{field:e,timeUnit:n,bin:r,aggregate:i}=t;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:e})}function UDt(t){return JDt(t)&&"sort"in t}function WDt(t){let{channel:e,fieldDef:n,fieldDef2:r,markDef:i,stack:a,config:o,isMidPoint:s}=t;if($Dt(n)&&void 0!==n.band)return n.band;if(YDt(n)){const{timeUnit:t,bin:e}=n;if(t&&!r)return s?MIt("timeUnitBandPosition",i,o):iEt(i.type)?MIt("timeUnitBand",i,o):0;if(fNt(e))return iEt(i.type)&&!s?1:.5}return(null===a||void 0===a?void 0:a.fieldChannel)===e&&s?.5:void 0}function VDt(t,e,n,r,i,a){return!!(fNt(e.bin)||e.timeUnit&&JDt(e)&&"temporal"===e.type)&&!!WDt({channel:t,fieldDef:e,fieldDef2:n,stack:r,markDef:i,config:a})}function qDt(t){return!!t&&"condition"in t}function GDt(t){const e=t&&t.condition;return!!e&&!NCt(e)&&YDt(e)}function HDt(t){const e=t&&t.condition;return!!e&&!NCt(e)&&$Dt(e)}function YDt(t){return!!t&&(!!t.field||"count"===t.aggregate)}function XDt(t){return t&&t.type}function KDt(t){return!!t&&"datum"in t}function QDt(t){return JDt(t)&&sIt(t)||ZDt(t)}function ZDt(t){return KDt(t)&&PCt(t.datum)}function $Dt(t){return YDt(t)||KDt(t)}function JDt(t){return!!t&&("field"in t&&"type"in t||"count"===t.aggregate)}function tIt(t){return t&&"value"in t&&"value"in t}function eIt(t){return!!t&&("scale"in t||"sort"in t)}function nIt(t){return t&&("axis"in t||"stack"in t||"impute"in t)}function rIt(t){return!!t&&"legend"in t}function iIt(t){return!!t&&("format"in t||"formatType"in t)}function aIt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,r,i;let a=t.field;const o=e.prefix;let s=e.suffix,c="";if(function(t){return"count"===t.aggregate}(t))a=function(t){return 0===t.indexOf("__")}(u="count")?u:"__".concat(u);else{let o;if(!e.nofn)if(function(t){return"op"in t}(t))o=t.op;else{const{bin:u,aggregate:l,timeUnit:h}=t;fNt(u)?(o=dNt(u),s=(null!==(n=e.binSuffix)&&void 0!==n?n:"")+(null!==(r=e.suffix)&&void 0!==r?r:"")):l?vEt(l)?(c='["'.concat(a,'"]'),a="argmax_".concat(l.argmax)):mEt(l)?(c='["'.concat(a,'"]'),a="argmin_".concat(l.argmin)):o=String(l):h&&(o=function(t){const e=lFt(t),{utc:n}=e,r=VCt(e,["utc"]);return r.unit?(n?"utc":"")+vSt(r).map((t=>wSt("".concat("unit"===t?"":"_".concat(t,"_")).concat(r[t])))).join(""):(n?"utc":"")+"timeunit"+vSt(r).map((t=>wSt("_".concat(t,"_").concat(r[t])))).join("")}(h),s=(!cSt(["range","mid"],e.binSuffix)&&e.binSuffix||"")+(null!==(i=e.suffix)&&void 0!==i?i:""))}o&&(a=a?"".concat(o,"_").concat(a):o)}var u;return s&&(a="".concat(a,"_").concat(s)),o&&(a="".concat(o,"_").concat(a)),e.forAs?NSt(a):e.expr?function(t){return"".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datum","[").concat(UCt(CCt(t).join(".")),"]")}(a,e.expr)+c:ESt(a)+c}function oIt(t){switch(t.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return YDt(t)&&!!t.bin;case"temporal":return!1}throw new Error(FNt(t.type))}function sIt(t){return!oIt(t)}const cIt=(t,e)=>{switch(e.fieldTitle){case"plain":return t.field;case"functional":return function(t){const{aggregate:e,bin:n,timeUnit:r,field:i}=t;if(vEt(e))return"".concat(i," for argmax(").concat(e.argmax,")");if(mEt(e))return"".concat(i," for argmin(").concat(e.argmin,")");const a=lFt(r),o=e||(null===a||void 0===a?void 0:a.unit)||(null===a||void 0===a?void 0:a.maxbins)&&"timeunit"||fNt(n)&&"bin";return o?o.toUpperCase()+"("+i+")":i}(t);default:return function(t,e){var n;const{field:r,bin:i,timeUnit:a,aggregate:o}=t;if("count"===o)return e.countTitle;if(fNt(i))return"".concat(r," (binned)");if(a){const t=null===(n=lFt(a))||void 0===n?void 0:n.unit;if(t)return"".concat(r," (").concat(oFt(t).join("-"),")")}else if(o)return vEt(o)?"".concat(r," for max ").concat(o.argmax):mEt(o)?"".concat(r," for min ").concat(o.argmin):"".concat(ASt(o)," of ").concat(r);return r}(t,e)}};let uIt=cIt;function lIt(t){uIt=t}function hIt(t,e,n){let{allowDisabling:r,includeDefault:i=!0}=n;var a,o;const s=(null!==(a=dIt(t))&&void 0!==a?a:{}).title;if(!YDt(t))return s;const c=t,u=i?fIt(c,e):void 0;return r?DSt(s,c.title,u):null!==(o=null!==s&&void 0!==s?s:c.title)&&void 0!==o?o:u}function dIt(t){return nIt(t)&&t.axis?t.axis:rIt(t)&&t.legend?t.legend:LDt(t)&&t.header?t.header:void 0}function fIt(t,e){return uIt(t,e)}function pIt(t){var e;if(iIt(t)){const{format:e,formatType:n}=t;return{format:e,formatType:n}}{const n=null!==(e=dIt(t))&&void 0!==e?e:{},{format:r,formatType:i}=n;return{format:r,formatType:i}}}function gIt(t){return YDt(t)?t:GDt(t)?t.condition:void 0}function mIt(t){return $Dt(t)?t:HDt(t)?t.condition:void 0}function vIt(t,e,n){if(jCt(t)||PCt(t)||LCt(t)){return XNt(function(t,e,n){return"Channel ".concat(t," is a ").concat(e,". Converted to {value: ").concat(aSt(n),"}.")}(e,jCt(t)?"string":PCt(t)?"number":"boolean",t)),{value:t}}return $Dt(t)?yIt(t,e,n):HDt(t)?Object.assign(Object.assign({},t),{condition:yIt(t.condition,e,n)}):t}function yIt(t,e,n){if(iIt(t)){const{format:r,formatType:i}=t,a=VCt(t,["format","formatType"]);if(bDt(i)&&!n.customFormatTypes)return XNt(NNt(e)),yIt(a,e,n)}else{const r=nIt(t)?"axis":rIt(t)?"legend":LDt(t)?"header":null;if(r&&t[r]){const i=t[r],{format:a,formatType:o}=i,s=VCt(i,["format","formatType"]);if(bDt(o)&&!n.customFormatTypes)return XNt(NNt(e)),yIt(Object.assign(Object.assign({},t),{[r]:s}),e,n)}}return YDt(t)?bIt(t,e):function(t){let e=t.type;if(e)return t;const{datum:n}=t;return e=PCt(n)?"quantitative":jCt(n)?"nominal":KNt(n)?"temporal":void 0,Object.assign(Object.assign({},t),{type:e})}(t)}function bIt(t,e){const{aggregate:n,timeUnit:r,bin:i,field:a}=t,o=Object.assign({},t);if(!n||yEt(n)||vEt(n)||mEt(n)||(XNt(function(t){return'Invalid aggregation operator "'.concat(t,'".')}(n)),delete o.aggregate),r&&(o.timeUnit=lFt(r)),a&&(o.field="".concat(a)),fNt(i)&&(o.bin=xIt(i,e)),pNt(i)&&!qTt(e)&&XNt("Channel ".concat(e,' should not be used with "binned" bin.')),JDt(o)){const{type:t}=o,e=function(t){if(t)switch(t=t.toLowerCase()){case"q":case FFt:return"quantitative";case"t":case IFt:return"temporal";case"o":case DFt:return"ordinal";case"n":case MFt:return"nominal";case OFt:return"geojson"}}(t);t!==e&&(o.type=e),"quantitative"!==t&&xEt(n)&&(XNt(function(t,e){return'Invalid field type "'.concat(t,'" for aggregate: "').concat(e,'", using "quantitative" instead.')}(t,n)),o.type="quantitative")}else if(!_Tt(e)){const t=function(t,e){if(t.timeUnit)return"temporal";if(fNt(t.bin))return"quantitative";switch(hNt(e)){case"continuous":default:return"quantitative";case"discrete":case"flexible":return"nominal"}}(o,e);XNt(function(t,e){return'Missing type for channel "'.concat(t,'", using "').concat(e,'" instead.')}(e,t)),o.type=t}if(JDt(o)){const{compatible:t,warning:n}=function(t,e){const n=t.type;if("geojson"===n&&"shape"!==e)return{compatible:!1,warning:"Channel ".concat(e," should not be used with a geojson data.")};switch(e){case _Et:case AEt:case CEt:return sIt(t)?{compatible:!1,warning:ONt(e)}:wIt;case SEt:case EEt:case LEt:case PEt:case jEt:case KEt:case ZEt:case $Et:case JEt:case tTt:case eTt:case VEt:case IEt:case FEt:case nTt:return wIt;case REt:case BEt:case OEt:case zEt:return n!==FFt?{compatible:!1,warning:"Channel ".concat(e," should be used with a quantitative field only, not ").concat(t.type," field.")}:wIt;case qEt:case GEt:case HEt:case YEt:case WEt:case MEt:case DEt:case TEt:case NEt:return"nominal"!==n||t.sort?wIt:{compatible:!1,warning:"Channel ".concat(e," should not be used with an unsorted discrete field.")};case XEt:return cSt(["ordinal","nominal"],t.type)?wIt:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case UEt:return cSt(["ordinal","nominal","geojson"],t.type)?wIt:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case QEt:return"nominal"!==t.type||"sort"in t?wIt:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(o,e);t||XNt(n)}if(UDt(o)&&jCt(o.sort)){const{sort:t}=o;if(MDt(t))return Object.assign(Object.assign({},o),{sort:{encoding:t}});const e=t.substr(1);if("-"===t.charAt(0)&&MDt(e))return Object.assign(Object.assign({},o),{sort:{encoding:e,order:"descending"}})}if(LDt(o)){const{header:t}=o,{orient:e}=t,n=VCt(t,["orient"]);if(e)return Object.assign(Object.assign({},o),{header:Object.assign(Object.assign({},n),{labelOrient:t.labelOrient||e,titleOrient:t.titleOrient||e})})}return o}function xIt(t,e){return LCt(t)?{maxbins:vNt(e)}:"binned"===t?{binned:!0}:t.maxbins||t.step?t:Object.assign(Object.assign({},t),{maxbins:vNt(e)})}const wIt={compatible:!0};function kIt(t){const{formatType:e}=pIt(t);return"time"===e||!e&&function(t){return t&&("temporal"===t.type||YDt(t)&&!!t.timeUnit)}(t)}function _It(t,e){let{timeUnit:n,type:r,wrapTime:i,undefinedIfExprNotRequired:a}=e;var o;const s=n&&(null===(o=lFt(n))||void 0===o?void 0:o.unit);let c,u=s||"temporal"===r;return hFt(t)?c=t.signal:KNt(t)?(u=!0,c=eFt(t)):(jCt(t)||PCt(t))&&u&&(c="datetime(".concat(JSON.stringify(t),")"),function(t){return!!nFt[t]}(s)&&(PCt(t)&&t<1e4||jCt(t)&&isNaN(Date.parse(t)))&&(c=eFt({[s]:t}))),c?i&&u?"time(".concat(c,")"):c:a?void 0:JSON.stringify(t)}function AIt(t,e){const{type:n}=t;return e.map((e=>{const r=_It(e,{timeUnit:YDt(t)?t.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==r?{signal:r}:e}))}function CIt(t,e){return fNt(t.bin)?oNt(e)&&cSt(["ordinal","nominal"],t.type):(console.warn("Only call this method for binned field defs."),!1)}function SIt(t){const{anchor:e,frame:n,offset:r,orient:i,color:a,subtitleColor:o,subtitleFont:s,subtitleFontSize:c,subtitleFontStyle:u,subtitleFontWeight:l,subtitleLineHeight:h,subtitlePadding:d}=t,f=VCt(t,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),p=Object.assign(Object.assign({},f),a?{fill:a}:{}),g=Object.assign(Object.assign(Object.assign(Object.assign({},e?{anchor:e}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{}),m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},o?{subtitleColor:o}:{}),s?{subtitleFont:s}:{}),c?{subtitleFontSize:c}:{}),u?{subtitleFontStyle:u}:{}),l?{subtitleFontWeight:l}:{}),h?{subtitleLineHeight:h}:{}),d?{subtitlePadding:d}:{});return{titleMarkConfig:p,subtitleMarkConfig:rSt(p,["align","baseline","dx","dy","limit"]),nonMark:g,subtitle:m}}function EIt(t){return jCt(t)||NCt(t)&&jCt(t[0])}function TIt(t){return hFt(t)?t:void 0!==t?{value:t}:void 0}function NIt(t){return hFt(t)?t.signal:UCt(t.value)}function FIt(t){return hFt(t)?t.signal:null==t?null:UCt(t)}function DIt(t){var e;return[].concat(t.type,null!==(e=t.style)&&void 0!==e?e:[])}function IIt(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const{vgChannel:i,ignoreVgConfig:a}=r;return i&&void 0!==e[i]?e[i]:void 0!==e[t]?e[t]:!a||i&&i!==t?MIt(t,e,n,r):void 0}function MIt(t,e,n){let{vgChannel:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return DSt(r?OIt(t,e,n.style):void 0,OIt(t,e,n.style),r?n[e.type][r]:void 0,n[e.type][t],r?n.mark[r]:n.mark[t])}function OIt(t,e,n){return RIt(t,DIt(e),n)}function RIt(t,e,n){let r;e=RCt(e);for(const i of e){const e=n[i];e&&void 0!==e[t]&&(r=e[t])}return r}function zIt(t,e){return RCt(t).reduce(((t,n)=>{var r;return t.field.push(aIt(n,e)),t.order.push(null!==(r=n.sort)&&void 0!==r?r:"ascending"),t}),{field:[],order:[]})}function BIt(t,e){const n=[...t];return e.forEach((t=>{for(const e of n)if(eSt(e,t))return;n.push(t)})),n}function LIt(t,e){return eSt(t,e)||!e?t:t?[...RCt(t),...RCt(e)].join(", "):e}function PIt(t,e){const n=t.value,r=e.value;if(null==n||null===r)return{explicit:t.explicit,value:null};if((EIt(n)||hFt(n))&&(EIt(r)||hFt(r)))return{explicit:t.explicit,value:LIt(n,r)};if(EIt(n)||hFt(n))return{explicit:t.explicit,value:n};if(EIt(r)||hFt(r))return{explicit:t.explicit,value:r};if(!EIt(n)&&!hFt(n)&&!EIt(r)&&!hFt(r))return{explicit:t.explicit,value:BIt(n,r)};throw new Error("It should never reach here")}function jIt(t,e){const n=t&&t[e];return!!n&&(NCt(n)?uSt(n,(t=>!!t.field)):YDt(n)||GDt(n))}function UIt(t){return uSt(dTt,(e=>{if(jIt(t,e)){const n=t[e];if(NCt(n))return uSt(n,(t=>!!t.aggregate));{const t=gIt(n);return t&&!!t.aggregate}}return!1}))}function WIt(t,e){const n=[],r=[],i=[],a=[],o={};return GIt(t,((s,c)=>{if(YDt(s)){const{field:u,aggregate:l,bin:h,timeUnit:d}=s,f=VCt(s,["field","aggregate","bin","timeUnit"]);if(l||d||h){const t=dIt(s),p=t&&t.title;let g=aIt(s,{forAs:!0});const m=Object.assign(Object.assign(Object.assign({},p?[]:{title:hIt(s,e,{allowDisabling:!0})}),f),{field:g});if(l){let t;if(vEt(l)?(t="argmax",g=aIt({op:"argmax",field:l.argmax},{forAs:!0}),m.field="".concat(g,".").concat(u)):mEt(l)?(t="argmin",g=aIt({op:"argmin",field:l.argmin},{forAs:!0}),m.field="".concat(g,".").concat(u)):"boxplot"!==l&&"errorbar"!==l&&"errorband"!==l&&(t=l),t){const e={op:t,as:g};u&&(e.field=u),a.push(e)}}else if(n.push(g),JDt(s)&&fNt(h)){if(r.push({bin:h,field:u,as:g}),n.push(aIt(s,{binSuffix:"end"})),CIt(s,c)&&n.push(aIt(s,{binSuffix:"range"})),qTt(c)){const t={field:g+"_end"};o[c+"2"]=t}m.bin="binned",_Tt(c)||(m.type=FFt)}else if(d){i.push({timeUnit:d,field:u,as:g});const t=JDt(s)&&s.type!==IFt&&"time";t&&(c===KEt||c===JEt?m.formatType=t:!function(t){return!!jTt[t]}(c)?qTt(c)&&(m.axis=Object.assign({formatType:t},m.axis)):m.legend=Object.assign({formatType:t},m.legend))}o[c]=m}else n.push(u),o[c]=t[c]}else o[c]=t[c]})),{bins:r,timeUnits:i,aggregate:a,groupby:n,encoding:o}}function VIt(t,e,n){const r=e.type;return vSt(t).reduce(((i,a)=>{if(!wTt(a))return XNt(function(t){return"".concat(t,"-encoding is dropped as ").concat(t," is not a valid encoding channel.")}(a)),i;const o=t[a];if("angle"!==a||"arc"!==r||t.theta||(XNt("Arc marks uses theta channel rather than angle, replacing angle with theta."),a=IEt),!function(t,e,n){const r=sNt(e,n);if(!r)return!1;if("binned"===r){const n=t[e===TEt?SEt:EEt];return!!(YDt(n)&&YDt(t[e])&&pNt(n.bin))}return!0}(t,a,r))return XNt(MNt(a,r)),i;if(a===WEt&&"line"===r){const e=gIt(t[a]);if(null===e||void 0===e?void 0:e.aggregate)return XNt("Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead."),i}if(a===LEt&&(e.filled?"fill"in t:"stroke"in t))return XNt(DNt("encoding",{fill:"fill"in t,stroke:"stroke"in t})),i;if(a===ZEt||a===QEt&&!NCt(o)&&!tIt(o)||a===JEt&&NCt(o))o&&(i[a]=RCt(o).reduce(((t,e)=>(YDt(e)?t.push(bIt(e,a)):XNt(INt(e,a)),t)),[]));else{if(a===JEt&&null===o)i[a]=null;else if(!YDt(o)&&!KDt(o)&&!tIt(o)&&!qDt(o)&&!hFt(o))return XNt(INt(o,a)),i;i[a]=vIt(o,a,n)}return i}),{})}function qIt(t){const e=[];for(const n of vSt(t))if(jIt(t,n)){const r=RCt(t[n]);for(const t of r)YDt(t)?e.push(t):GDt(t)&&e.push(t.condition)}return e}function GIt(t,e,n){if(t)for(const r of vSt(t)){const i=t[r];if(NCt(i))for(const t of i)e.call(n,t,r);else e.call(n,i,r)}}function HIt(t,e,n,r){return t?vSt(t).reduce(((n,i)=>{const a=t[i];return NCt(a)?a.reduce(((t,n)=>e.call(r,t,n,i)),n):e.call(r,n,a,i)}),n):n}function YIt(t,e){return vSt(e).reduce(((n,r)=>{switch(r){case SEt:case EEt:case tTt:case nTt:case eTt:case TEt:case NEt:case IEt:case MEt:case FEt:case DEt:case OEt:case REt:case zEt:case BEt:case KEt:case UEt:case VEt:case JEt:return n;case QEt:if("line"===t||"trail"===t)return n;case ZEt:case $Et:{const t=e[r];if(NCt(t)||YDt(t))for(const e of RCt(t))e.aggregate||n.push(aIt(e,{}));return n}case WEt:if("trail"===t)return n;case LEt:case PEt:case jEt:case qEt:case GEt:case HEt:case XEt:case YEt:{const t=gIt(e[r]);return t&&!t.aggregate&&n.push(aIt(t,{})),n}}}),[])}function XIt(t,e,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if("tooltip"in n)return{tooltip:n.tooltip};return{tooltip:[...t.map((t=>{let{fieldPrefix:n,titlePrefix:i}=t;const a=r?" of ".concat(e.field):"";return{field:n+e.field,type:e.type,title:hFt(i)?{signal:i+'"'.concat(escape(a),'"')}:i+a}})),...qIt(n)]}}function KIt(t){const{axis:e,title:n,field:r}=t;return e&&void 0!==e.title?void 0:DSt(n,r)}function QIt(t,e,n,r,i){const{scale:a,axis:o}=n;return s=>{let{partName:c,mark:u,positionPrefix:l,endPositionPrefix:h,aria:d,extraEncoding:f={}}=s;const p=KIt(n);return ZIt(t,c,i,d,{mark:u,encoding:Object.assign(Object.assign(Object.assign({[e]:Object.assign(Object.assign(Object.assign({field:l+"_"+n.field,type:n.type},void 0!==p?{title:p}:{}),void 0!==a?{scale:a}:{}),void 0!==o?{axis:o}:{})},jCt(h)?{[e+"2"]:{field:h+"_"+n.field}}:{}),r),f)})}}function ZIt(t,e,n,r,i){const{clip:a,color:o,opacity:s}=t,c=t.type;return t[e]||void 0===t[e]&&n[e]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[e]),a?{clip:a}:{}),o?{color:o}:{}),s?{opacity:s}:{}),oEt(i.mark)?i.mark:{type:i.mark}),{style:"".concat(c,"-").concat(e)}),LCt(t[e])?{}:t[e]),!1===r?{aria:r}:{})})]:[]}function $It(t,e,n){const{encoding:r}=t,i="vertical"===e?"y":"x",a=r[i],o=r[i+"2"],s=r[i+"Error"],c=r[i+"Error2"];return{continuousAxisChannelDef:JIt(a,n),continuousAxisChannelDef2:JIt(o,n),continuousAxisChannelDefError:JIt(s,n),continuousAxisChannelDefError2:JIt(c,n),continuousAxis:i}}function JIt(t,e){if(t&&t.aggregate){const{aggregate:n}=t,r=VCt(t,["aggregate"]);return n!==e&&XNt(function(t,e){return"Continuous axis should not have customized aggregation function ".concat(t,"; ").concat(e," already agregates the axis.")}(n,e)),r}return t}function tMt(t,e){const{mark:n,encoding:r}=t,{x:i,y:a}=r;if(QDt(i)){if(QDt(a)){const t=YDt(i)&&i.aggregate,r=YDt(a)&&a.aggregate;if(t||r!==e){if(r||t!==e){if(t===e&&r===e)throw new Error("Both x and y cannot have aggregate");return oEt(n)&&n.orient?n.orient:"vertical"}return"horizontal"}return"vertical"}return"horizontal"}if(QDt(a))return"vertical";throw new Error("Need a valid continuous axis for "+e+"s")}const eMt="boxplot",nMt=new fEt(eMt,iMt);function rMt(t){return PCt(t)?"tukey":t}function iMt(t,e){let{config:n}=e;var r,i;const{mark:a,encoding:o,selection:s,projection:c}=t,u=VCt(t,["mark","encoding","selection","projection"]),l=oEt(a)?a:{type:a};s&&XNt(CNt("boxplot"));const h=null!==(r=l.extent)&&void 0!==r?r:n.boxplot.extent,d=IIt("size",l,n),f=rMt(h),{transform:p,continuousAxisChannelDef:g,continuousAxis:m,groupby:v,aggregate:y,encodingWithoutContinuousAxis:b,ticksOrient:x,boxOrient:w,customTooltipWithoutAggregatedField:k}=function(t,e,n){const r=tMt(t,eMt),{continuousAxisChannelDef:i,continuousAxis:a}=$It(t,r,eMt),o=i.field,s=rMt(e),c=[...aMt(o),{op:"median",field:o,as:"mid_box_"+o},{op:"min",field:o,as:("min-max"===s?"lower_whisker_":"min_")+o},{op:"max",field:o,as:("min-max"===s?"upper_whisker_":"max_")+o}],u="min-max"===s||"tukey"===s?[]:[{calculate:'datum["upper_box_'.concat(o,'"] - datum["lower_box_').concat(o,'"]'),as:"iqr_"+o},{calculate:'min(datum["upper_box_'.concat(o,'"] + datum["iqr_').concat(o,'"] * ').concat(e,', datum["max_').concat(o,'"])'),as:"upper_whisker_"+o},{calculate:'max(datum["lower_box_'.concat(o,'"] - datum["iqr_').concat(o,'"] * ').concat(e,', datum["min_').concat(o,'"])'),as:"lower_whisker_"+o}],l=t.encoding,h=a,d=(l[h],VCt(l,["symbol"===typeof h?h:h+""])),{customTooltipWithoutAggregatedField:f,filteredEncoding:p}=function(t){const{tooltip:e}=t,n=VCt(t,["tooltip"]);if(!e)return{filteredEncoding:t};let r,i;if(NCt(e)){for(const t of e)t.aggregate?(r||(r=[]),r.push(t)):(i||(i=[]),i.push(t));r&&(n.tooltip=r)}else e.aggregate?n.tooltip=e:i=e;return NCt(i)&&1===i.length&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}(d),{bins:g,timeUnits:m,aggregate:v,groupby:y,encoding:b}=WIt(p,n),x="vertical"===r?"horizontal":"vertical",w=r,k=[...g,...m,{aggregate:[...v,...c],groupby:y},...u];return{transform:k,groupby:y,aggregate:v,continuousAxisChannelDef:i,continuousAxis:a,encodingWithoutContinuousAxis:b,ticksOrient:x,boxOrient:w,customTooltipWithoutAggregatedField:f}}(t,h,n),{color:_,size:A}=b,C=VCt(b,["color","size"]),S=t=>QIt(l,m,g,t,n.boxplot),E=S(C),T=S(b),N=S(Object.assign(Object.assign({},C),A?{size:A}:{})),F=XIt([{fieldPrefix:"min-max"===f?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===f?"lower_whisker_":"min_",titlePrefix:"Min"}],g,b),D={type:"tick",color:"black",opacity:1,orient:x,invalid:null},I="min-max"===f?F:XIt([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],g,b),M=[...E({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",aria:!1,extraEncoding:I}),...E({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",aria:!1,extraEncoding:I}),...E({partName:"ticks",mark:D,positionPrefix:"lower_whisker",aria:!1,extraEncoding:I}),...E({partName:"ticks",mark:D,positionPrefix:"upper_whisker",aria:!1,extraEncoding:I})],O=[..."tukey"!==f?M:[],...T({partName:"box",mark:Object.assign(Object.assign({type:"bar"},d?{size:d}:{}),{orient:w,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",aria:!1,extraEncoding:F}),...N({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},FCt(n.boxplot.median)&&n.boxplot.median.color?{color:n.boxplot.median.color}:{}),d?{size:d}:{}),{orient:x,ariaRoleDescription:"box"}),positionPrefix:"mid_box",extraEncoding:F})];let R;if("min-max"!==f){const t='datum["lower_box_'.concat(g.field,'"]'),e='datum["upper_box_'.concat(g.field,'"]'),r="(".concat(e," - ").concat(t,")"),i="".concat(t," - ").concat(h," * ").concat(r),a="".concat(e," + ").concat(h," * ").concat(r),o='datum["'.concat(g.field,'"]'),s={joinaggregate:aMt(g.field),groupby:v};let c;"tukey"===f&&(c={transform:[{filter:"(".concat(i," <= ").concat(o,") && (").concat(o," <= ").concat(a,")")},{aggregate:[{op:"min",field:g.field,as:"lower_whisker_"+g.field},{op:"max",field:g.field,as:"upper_whisker_"+g.field},{op:"min",field:"lower_box_"+g.field,as:"lower_box_"+g.field},{op:"max",field:"upper_box_"+g.field,as:"upper_box_"+g.field},...y],groupby:v}],layer:M});const{tooltip:u}=C,d=VCt(C,["tooltip"]),{scale:p,axis:b}=g,x=KIt(g),w=ZIt(l,"outliers",n.boxplot,!0,{transform:[{filter:"(".concat(o," < ").concat(i,") || (").concat(o," > ").concat(a,")")}],mark:"point",encoding:Object.assign(Object.assign({[m]:Object.assign(Object.assign(Object.assign({field:g.field,type:g.type},void 0!==x?{title:x}:{}),void 0!==p?{scale:p}:{}),void 0!==b?{axis:b}:{})},d),k?{tooltip:k}:{})})[0];w&&c?R={transform:[s],layer:[w,c]}:w?(R=w,R.transform.unshift(s)):c&&(R=c,R.transform.unshift(s))}return R?Object.assign(Object.assign({},u),{layer:[R,{transform:p,layer:O}]}):Object.assign(Object.assign({},u),{transform:(null!==(i=u.transform)&&void 0!==i?i:[]).concat(p),layer:O})}function aMt(t){return[{op:"q1",field:t,as:"lower_box_"+t},{op:"q3",field:t,as:"upper_box_"+t}]}const oMt="errorbar",sMt=new fEt(oMt,cMt);function cMt(t,e){let{config:n}=e;const{transform:r,continuousAxisChannelDef:i,continuousAxis:a,encodingWithoutContinuousAxis:o,ticksOrient:s,markDef:c,outerSpec:u,tooltipEncoding:l}=lMt(t,oMt,n),h=QIt(c,a,i,o,n.errorbar),d={type:"tick",orient:s},f=[...h({partName:"ticks",mark:d,positionPrefix:"lower",aria:!1,extraEncoding:l}),...h({partName:"ticks",mark:d,positionPrefix:"upper",aria:!1,extraEncoding:l}),...h({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar"},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return Object.assign(Object.assign(Object.assign({},u),{transform:r}),f.length>1?{layer:f}:Object.assign({},f[0]))}function uMt(t,e){const{encoding:n}=t;if(function(t){return($Dt(t.x)||$Dt(t.y))&&!$Dt(t.x2)&&!$Dt(t.y2)&&!$Dt(t.xError)&&!$Dt(t.xError2)&&!$Dt(t.yError)&&!$Dt(t.yError2)}(n))return{orient:tMt(t,e),inputType:"raw"};const r=function(t){return $Dt(t.x2)||$Dt(t.y2)}(n),i=function(t){return $Dt(t.xError)||$Dt(t.xError2)||$Dt(t.yError)||$Dt(t.yError2)}(n),a=n.x,o=n.y;if(r){if(i)throw new Error("".concat(e," cannot be both type aggregated-upper-lower and aggregated-error"));const t=n.x2,r=n.y2;if($Dt(t)&&$Dt(r))throw new Error("".concat(e," cannot have both x2 and y2"));if($Dt(t)){if(QDt(a))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error("Both x and x2 have to be quantitative in ".concat(e))}if($Dt(r)){if(QDt(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error("Both y and y2 have to be quantitative in ".concat(e))}throw new Error("No ranged axis")}{const t=n.xError,r=n.xError2,i=n.yError,s=n.yError2;if($Dt(r)&&!$Dt(t))throw new Error("".concat(e," cannot have xError2 without xError"));if($Dt(s)&&!$Dt(i))throw new Error("".concat(e," cannot have yError2 without yError"));if($Dt(t)&&$Dt(i))throw new Error("".concat(e," cannot have both xError and yError with both are quantiative"));if($Dt(t)){if(QDt(a))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if($Dt(i)){if(QDt(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function lMt(t,e,n){var r;const{mark:i,encoding:a,selection:o,projection:s}=t,c=VCt(t,["mark","encoding","selection","projection"]),u=oEt(i)?i:{type:i};o&&XNt(CNt(e));const{orient:l,inputType:h}=uMt(t,e),{continuousAxisChannelDef:d,continuousAxisChannelDef2:f,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:g,continuousAxis:m}=$It(t,l,e),{errorBarSpecificAggregate:v,postAggregateCalculates:y,tooltipSummary:b,tooltipTitleWithFieldName:x}=function(t,e,n,r,i,a,o,s){let c=[],u=[];const l=e.field;let h,d=!1;if("raw"===a){const e=t.center?t.center:t.extent?"iqr"===t.extent?"median":"mean":s.errorbar.center,n=t.extent?t.extent:"mean"===e?"stderr":"iqr";if("median"===e!==("iqr"===n)&&XNt(function(t,e,n){return"".concat(t," is not usually used with ").concat(e," for ").concat(n,".")}(e,n,o)),"stderr"===n||"stdev"===n)c=[{op:n,field:l,as:"extent_"+l},{op:e,field:l,as:"center_"+l}],u=[{calculate:'datum["center_'.concat(l,'"] + datum["extent_').concat(l,'"]'),as:"upper_"+l},{calculate:'datum["center_'.concat(l,'"] - datum["extent_').concat(l,'"]'),as:"lower_"+l}],h=[{fieldPrefix:"center_",titlePrefix:ASt(e)},{fieldPrefix:"upper_",titlePrefix:hMt(e,n,"+")},{fieldPrefix:"lower_",titlePrefix:hMt(e,n,"-")}],d=!0;else{let e,r,i;t.center&&t.extent&&XNt(function(t,e){return"Center is not needed to be specified in ".concat(e," when extent is ").concat(t,".")}(t.extent,o)),"ci"===n?(e="mean",r="ci0",i="ci1"):(e="median",r="q1",i="q3"),c=[{op:r,field:l,as:"lower_"+l},{op:i,field:l,as:"upper_"+l},{op:e,field:l,as:"center_"+l}],h=[{fieldPrefix:"upper_",titlePrefix:hIt({field:l,aggregate:i,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:hIt({field:l,aggregate:r,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:hIt({field:l,aggregate:e,type:"quantitative"},s,{allowDisabling:!1})}]}}else{(t.center||t.extent)&&XNt(function(t,e){return"".concat(e?"extent ":"").concat(e&&t?"and ":"").concat(t?"center ":"").concat(e&&t?"are ":"is ","not needed when data are aggregated.")}(t.center,t.extent)),"aggregated-upper-lower"===a?(h=[],u=[{calculate:'datum["'.concat(n.field,'"]'),as:"upper_"+l},{calculate:'datum["'.concat(l,'"]'),as:"lower_"+l}]):"aggregated-error"===a&&(h=[{fieldPrefix:"",titlePrefix:l}],u=[{calculate:'datum["'.concat(l,'"] + datum["').concat(r.field,'"]'),as:"upper_"+l}],i?u.push({calculate:'datum["'.concat(l,'"] + datum["').concat(i.field,'"]'),as:"lower_"+l}):u.push({calculate:'datum["'.concat(l,'"] - datum["').concat(r.field,'"]'),as:"lower_"+l}));for(const t of u)h.push({fieldPrefix:t.as.substring(0,6),titlePrefix:TSt(TSt(t.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:u,errorBarSpecificAggregate:c,tooltipSummary:h,tooltipTitleWithFieldName:d}}(u,d,f,p,g,h,e,n),w=a,k=m,_=(w[k],"x"===m?"x2":"y2"),A=(w[_],"x"===m?"xError":"yError"),C=(w[A],"x"===m?"xError2":"yError2"),S=(w[C],VCt(w,["symbol"===typeof k?k:k+"","symbol"===typeof _?_:_+"","symbol"===typeof A?A:A+"","symbol"===typeof C?C:C+""])),{bins:E,timeUnits:T,aggregate:N,groupby:F,encoding:D}=WIt(S,n),I=[...N,...v],M="raw"!==h?[]:F,O=XIt(b,d,D,x);return{transform:[...null!==(r=c.transform)&&void 0!==r?r:[],...E,...T,...0===I.length?[]:[{aggregate:I,groupby:M}],...y],groupby:M,continuousAxisChannelDef:d,continuousAxis:m,encodingWithoutContinuousAxis:D,ticksOrient:"vertical"===l?"horizontal":"vertical",markDef:u,outerSpec:c,tooltipEncoding:O}}function hMt(t,e,n){return ASt(t)+" "+n+" "+e}const dMt="errorband",fMt=new fEt(dMt,pMt);function pMt(t,e){let{config:n}=e;const{transform:r,continuousAxisChannelDef:i,continuousAxis:a,encodingWithoutContinuousAxis:o,markDef:s,outerSpec:c,tooltipEncoding:u}=lMt(t,dMt,n),l=s,h=QIt(l,a,i,o,n.errorband),d=void 0!==t.encoding.x&&void 0!==t.encoding.y;let f={type:d?"area":"rect"},p={type:d?"line":"rule"};const g=Object.assign(Object.assign({},l.interpolate?{interpolate:l.interpolate}:{}),l.tension&&l.interpolate?{tension:l.tension}:{});return d?(f=Object.assign(Object.assign(Object.assign({},f),g),{ariaRoleDescription:"errorband"}),p=Object.assign(Object.assign({},p),g)):l.interpolate?XNt(VNt("interpolate")):l.tension&&XNt(VNt("tension")),Object.assign(Object.assign({},c),{transform:r,layer:[...h({partName:"band",mark:f,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...h({partName:"borders",mark:p,positionPrefix:"lower",aria:!1,extraEncoding:u}),...h({partName:"borders",mark:p,positionPrefix:"upper",aria:!1,extraEncoding:u})]})}const gMt={};function mMt(t,e,n){const r=new fEt(t,e);gMt[t]={normalizer:r,parts:n}}mMt(eMt,iMt,["box","median","outliers","rule","ticks"]),mMt(oMt,cMt,["ticks","rule"]),mMt(dMt,pMt,["band","borders"]);const vMt=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],yMt=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],bMt={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},xMt={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},wMt=(vSt(xMt),"_vgsid_"),kMt={single:{on:"click",fields:[wMt],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[wMt],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function _Mt(t){return!!t&&("legend"===t||!!t.legend)}function AMt(t){return _Mt(t)&&FCt(t)}function CMt(t){return"concat"in t}function SMt(t){return"vconcat"in t}function EMt(t){return"hconcat"in t}function TMt(t){return FCt(t)&&void 0!==t.step}function NMt(t){return t.view||t.width||t.height}const FMt=vSt({align:1,bounds:1,center:1,columns:1,spacing:1});function DMt(t,e){var n;return null!==(n=t[e])&&void 0!==n?n:t["width"===e?"continuousWidth":"continuousHeight"]}function IMt(t,e){const n=MMt(t,e);return TMt(n)?n.step:OMt}function MMt(t,e){var n;return DSt(null!==(n=t[e])&&void 0!==n?n:t["width"===e?"discreteWidth":"discreteHeight"],{step:t.step})}const OMt=20;const RMt={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:OMt},mark:{color:"#4c78a8",invalid:"filter",timeUnitBand:1},arc:{},area:{},bar:lEt,circle:{},geoshape:{},image:{},line:{},point:{},rect:hEt,rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:kMt,style:{},title:{},facet:{spacing:20},concat:{spacing:20}},zMt=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],BMt={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},LMt={blue:zMt[0],orange:zMt[1],red:zMt[2],teal:zMt[3],green:zMt[4],yellow:zMt[5],purple:zMt[6],pink:zMt[7],brown:zMt[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function PMt(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:e,font:n,fontSize:r}=t,i=VCt(t,["color","font","fontSize"]);return ICt({},RMt,n?function(t){return{text:{font:t},style:{"guide-label":{font:t},"guide-title":{font:t},"group-title":{font:t},"group-subtitle":{font:t}}}}(n):{},e?function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{signals:[{name:"color",value:FCt(t)?Object.assign(Object.assign({},LMt),t):LMt}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}(e):{},r?function(t){return{signals:[{name:"fontSize",value:FCt(t)?Object.assign(Object.assign({},BMt),t):BMt}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}(r):{},i||{})}const jMt=["view",...aEt],UMt=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],WMt=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},{area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]});function VMt(t){t=nSt(t);for(const e of UMt)delete t[e];if(t.axis)for(const e in t.axis)zSt(t.axis[e])&&delete t.axis[e];if(t.legend)for(const e of vMt)delete t.legend[e];if(t.mark){for(const e of cEt)delete t.mark[e];t.mark.tooltip&&FCt(t.mark.tooltip)&&delete t.mark.tooltip}for(const e of jMt){for(const r of cEt)delete t[e][r];const n=WMt[e];if(n)for(const r of n)delete t[e][r];qMt(t,e)}for(const e of vSt(gMt))delete t[e];!function(t){const{titleMarkConfig:e,subtitleMarkConfig:n,subtitle:r}=SIt(t.title);mSt(e)||(t.style["group-title"]=Object.assign(Object.assign({},t.style["group-title"]),e));mSt(n)||(t.style["group-subtitle"]=Object.assign(Object.assign({},t.style["group-subtitle"]),n));mSt(r)?delete t.title:t.title=r}(t);for(const e in t)FCt(t[e])&&mSt(t[e])&&delete t[e];return mSt(t)?void 0:t}function qMt(t,e,n,r){const i=r?t[e][r]:t[e];"view"===e&&(n="cell");const a=Object.assign(Object.assign({},i),t.style[null!==n&&void 0!==n?n:e]);mSt(a)||(t.style[null!==n&&void 0!==n?n:e]=a),r||delete t[e]}function GMt(t){return"layer"in t}class HMt{map(t,e){return PDt(t)?this.mapFacet(t,e):function(t){return"repeat"in t}(t)?this.mapRepeat(t,e):EMt(t)?this.mapHConcat(t,e):SMt(t)?this.mapVConcat(t,e):CMt(t)?this.mapConcat(t,e):this.mapLayerOrUnit(t,e)}mapLayerOrUnit(t,e){if(GMt(t))return this.mapLayer(t,e);if(dEt(t))return this.mapUnit(t,e);throw new Error(yNt(t))}mapLayer(t,e){return Object.assign(Object.assign({},t),{layer:t.layer.map((t=>this.mapLayerOrUnit(t,e)))})}mapHConcat(t,e){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map((t=>this.map(t,e)))})}mapVConcat(t,e){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map((t=>this.map(t,e)))})}mapConcat(t,e){const{concat:n}=t,r=VCt(t,["concat"]);return Object.assign(Object.assign({},r),{concat:n.map((t=>this.map(t,e)))})}mapFacet(t,e){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,e)})}mapRepeat(t,e){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,e)})}}const YMt={zero:1,center:1,normalize:1};const XMt=new Set([VSt,GSt,qSt,QSt,XSt,tEt,eEt,YSt,ZSt,$St]),KMt=new Set([GSt,qSt,VSt]);function QMt(t,e){var n,r;const i="x"===e?"y":"radius",a=t[e],o=t[i];if(YDt(a)&&YDt(o))if("quantitative"===XDt(a)&&"quantitative"===XDt(o)){if(a.stack)return e;if(o.stack)return i;const t=YDt(a)&&!!a.aggregate;if(t!==(YDt(o)&&!!o.aggregate))return t?e:i;{const t=null===(n=a.scale)||void 0===n?void 0:n.type,s=null===(r=o.scale)||void 0===r?void 0:r.type;if(t&&"linear"!==t)return i;if(s&&"linear"!==s)return e}}else{if("quantitative"===XDt(a))return e;if("quantitative"===XDt(o))return i}else{if("quantitative"===XDt(a))return e;if("quantitative"===XDt(o))return i}}function ZMt(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=oEt(t)?t.type:t;if(!XMt.has(r))return null;const i=QMt(e,"x")||QMt(e,"theta");if(!i)return null;const a=e[i],o=YDt(a)?aIt(a,{}):void 0;let s=function(t){switch(t){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}(i),c=e[s],u=YDt(c)?aIt(c,{}):void 0;u===o&&(u=void 0,c=void 0,s=void 0);const l=UTt.reduce(((t,n)=>{if("tooltip"!==n&&jIt(e,n)){const r=e[n];for(const e of RCt(r)){const r=gIt(e);if(r.aggregate)continue;const i=aIt(r,{});i&&i===u||t.push({channel:n,fieldDef:r})}}return t}),[]);let h;if(void 0!==a.stack?h=LCt(a.stack)?a.stack?"zero":null:a.stack:l.length>0&&KMt.has(r)&&(h="zero"),!h||!function(t){return t in YMt}(h))return null;if(UIt(e)&&0===l.length)return null;if(a.scale&&a.scale.type&&a.scale.type!==zFt.LINEAR){if(n.disallowNonLinearStack)return null;XNt(function(t){return"Cannot stack non-linear scale (".concat(t,").")}(a.scale.type))}return $Dt(e[STt(i)])?(void 0!==a.stack&&XNt('Cannot stack "'.concat(d=i,'" if there is already "').concat(d,'2".')),null):(YDt(a)&&a.aggregate&&!cSt(wEt,a.aggregate)&&XNt((f=a.aggregate,'Stacking is applied even though the aggregate function is non-summative ("'.concat(f,'").'))),{groupbyChannel:c?s:void 0,groupbyField:u,fieldChannel:i,impute:null!==a.impute&&rEt(r),stackBy:l,offset:h});var d,f}function $Mt(t){const{point:e,line:n}=t,r=VCt(t,["point","line"]);return vSt(r).length>1?r:r.type}function JMt(t){for(const e of["line","area","rule","trail"])t[e]&&(t=Object.assign(Object.assign({},t),{[e]:iSt(t[e],["point","line"])}));return t}function tOt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return"transparent"===t.point?{opacity:0}:t.point?FCt(t.point)?t.point:{}:void 0!==t.point?null:e.point||n.shape?FCt(e.point)?e.point:{}:void 0}function eOt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.line?!0===t.line?{}:t.line:void 0!==t.line?null:e.line?!0===e.line?{}:e.line:void 0}class nOt{constructor(){this.name="path-overlay"}hasMatchingType(t,e){if(dEt(t)){const{mark:n,encoding:r}=t,i=oEt(n)?n:{type:n};switch(i.type){case"line":case"rule":case"trail":return!!tOt(i,e[i.type],r);case"area":return!!tOt(i,e[i.type],r)||!!eOt(i,e[i.type])}}return!1}run(t,e,n){const{config:r}=e,{selection:i,projection:a,encoding:o,mark:s}=t,c=VCt(t,["selection","projection","encoding","mark"]),u=oEt(s)?s:{type:s},l=tOt(u,r[u.type],o),h="area"===u.type&&eOt(u,r[u.type]),d=[Object.assign(Object.assign({},i?{selection:i}:{}),{mark:$Mt(Object.assign(Object.assign({},"area"===u.type&&void 0===u.opacity&&void 0===u.fillOpacity?{opacity:.7}:{}),u)),encoding:iSt(o,["shape"])})],f=ZMt(u,o);let p=o;if(f){const{fieldChannel:t,offset:e}=f;p=Object.assign(Object.assign({},o),{[t]:Object.assign(Object.assign({},o[t]),e?{stack:e}:{})})}return h&&d.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"line"},rSt(u,["clip","interpolate","tension","tooltip"])),h),encoding:p})),l&&d.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},rSt(u,["clip","tooltip"])),l),encoding:p})),n(Object.assign(Object.assign({},c),{layer:d}),Object.assign(Object.assign({},e),{config:JMt(r)}))}}class rOt{constructor(){this.name="RangeStep"}hasMatchingType(t){var e;if(dEt(t)&&t.encoding)for(const n of VTt){const r=t.encoding[n];if(r&&$Dt(r)&&(null===(e=null===r||void 0===r?void 0:r.scale)||void 0===e?void 0:e.rangeStep))return!0}return!1}run(t){var e;const n={};let r=Object.assign({},t.encoding);for(const i of VTt){const t=ETt(i),a=r[i];if(a&&$Dt(a)&&(null===(e=null===a||void 0===a?void 0:a.scale)||void 0===e?void 0:e.rangeStep)){const{scale:e}=a,o=VCt(a,["scale"]),s=e,{rangeStep:c}=s,u=VCt(s,["rangeStep"]);n[t]={step:e.rangeStep},XNt('Scale\'s "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.'),r=Object.assign(Object.assign({},r),{[i]:Object.assign(Object.assign({},o),mSt(u)?{}:{scale:u})})}}return Object.assign(Object.assign(Object.assign({},n),t),{encoding:r})}}function iOt(t,e){return e?BDt(t)?lOt(t,e):sOt(t,e):t}function aOt(t,e){return e?lOt(t,e):t}function oOt(t,e,n){const r=e[t];return function(t){return t&&!jCt(t)&&"repeat"in t}(r)?r.repeat in n?Object.assign(Object.assign({},e),{[t]:n[r.repeat]}):void XNt(function(t){return'Unknown repeated value "'.concat(t,'".')}(r.repeat)):e}function sOt(t,e){if(void 0!==(t=oOt("field",t,e))){if(null===t)return null;if(UDt(t)&&RDt(t.sort)){const n=oOt("field",t.sort,e);t=Object.assign(Object.assign({},t),n?{sort:n}:{})}return t}}function cOt(t,e){if(YDt(t))return sOt(t,e);{const n=oOt("datum",t,e);return n===t||n.type||(n.type="nominal"),n}}function uOt(t,e){if(!$Dt(t)){if(HDt(t)){const n=cOt(t.condition,e);if(n)return Object.assign(Object.assign({},t),{condition:n});{const{condition:e}=t;return VCt(t,["condition"])}}return t}{const n=cOt(t,e);if(n)return n;if(qDt(t))return{condition:t.condition}}}function lOt(t,e){const n={};for(const r in t)if(BCt(t,r)){const i=t[r];if(NCt(i))n[r]=i.map((t=>uOt(t,e))).filter((t=>t));else{const t=uOt(i,e);void 0!==t&&(n[r]=t)}}return n}class hOt{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(dEt(t)){const{encoding:e,mark:n}=t;if("line"===n)for(const t of kTt){const n=e[ATt(t)];if(e[t]&&(YDt(n)&&!pNt(n.bin)||KDt(n)))return!0}}return!1}run(t,e,n){const{encoding:r}=t;var i,a;return XNt((i=!!r.x2,a=!!r.y2,"Line mark is for continuous lines and thus cannot be used with ".concat(i&&a?"x2 and y2":i?"x2":"y2",". We will use the rule mark (line segments) instead."))),n(Object.assign(Object.assign({},t),{mark:"rule"}),e)}}function dOt(t){const{parentEncoding:e,encoding:n}=t;if(e&&n){const t=vSt(e).reduce(((t,e)=>(n[e]&&t.push(e),t)),[]);t.length>0&&XNt("Layer's shared ".concat((r=t).join(",")," channel ").concat(1===r.length?"is":"are"," overriden."))}var r;const i=Object.assign(Object.assign({},null!==e&&void 0!==e?e:{}),null!==n&&void 0!==n?n:{});return mSt(i)?void 0:i}function fOt(t){const{parentProjection:e,projection:n}=t;return e&&n&&XNt(function(t){const{parentProjection:e,projection:n}=t;return"Layer's shared projection ".concat(aSt(e)," is overridden by a child projection ").concat(aSt(n),".")}({parentProjection:e,projection:n})),null!==n&&void 0!==n?n:e}function pOt(t,e){void 0===e&&(e=PMt(t.config));const n=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return gOt.map(t,{config:e})}(t,e),{width:r,height:i}=t,a=function(t,e,n){let{width:r,height:i}=e;const a=dEt(t)||GMt(t),o={};a?"container"==r&&"container"==i?(o.type="fit",o.contains="padding"):"container"==r?(o.type="fit-x",o.contains="padding"):"container"==i&&(o.type="fit-y",o.contains="padding"):("container"==r&&(XNt(xNt("width")),r=void 0),"container"==i&&(XNt(xNt("height")),i=void 0));const s=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?mOt(n.autosize):{}),mOt(t.autosize));"fit"!==s.type||a||(XNt(bNt),s.type="pad");"container"==r&&"fit"!=s.type&&"fit-x"!=s.type&&XNt(wNt("width"));"container"==i&&"fit"!=s.type&&"fit-y"!=s.type&&XNt(wNt("height"));if(eSt(s,{type:"pad"}))return;return s}(n,{width:r,height:i,autosize:t.autosize},e);return Object.assign(Object.assign({},n),a?{autosize:a}:{})}const gOt=new class extends HMt{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[nMt,sMt,fMt,new nOt,new hOt,new rOt]}map(t,e){if(dEt(t)){const n=jIt(t.encoding,_Et),r=jIt(t.encoding,AEt),i=jIt(t.encoding,CEt);if(n||r||i)return this.mapFacetedUnit(t,e)}return super.map(t,e)}mapUnit(t,e){const{parentEncoding:n,parentProjection:r}=e,i=Object.assign(Object.assign({},t),{encoding:aOt(t.encoding,e.repeater)});if(n||r)return this.mapUnitWithParentEncodingOrProjection(i,e);const a=this.mapLayerOrUnit.bind(this);for(const o of this.nonFacetUnitNormalizers)if(o.hasMatchingType(i,e.config))return o.run(i,e,a);return i}mapRepeat(t,e){return function(t){return!NCt(t.repeat)&&t.repeat.layer}(t)?this.mapLayerRepeat(t,e):this.mapNonLayerRepeat(t,e)}mapLayerRepeat(t,e){const{repeat:n,spec:r}=t,i=VCt(t,["repeat","spec"]),{row:a,column:o,layer:s}=n,{repeater:c={},repeaterPrefix:u=""}=e;return a||o?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},a?{row:a}:{}),o?{column:o}:{}),spec:{repeat:{layer:s},spec:r}}),e):Object.assign(Object.assign({},i),{layer:s.map((t=>{const n=Object.assign(Object.assign({},c),{layer:t}),i=(r.name||"")+u+"child__layer_".concat(wSt(t)),a=this.mapLayerOrUnit(r,Object.assign(Object.assign({},e),{repeater:n,repeaterPrefix:i}));return a.name=i,a}))})}mapNonLayerRepeat(t,e){var n;const{repeat:r,spec:i,data:a}=t,o=VCt(t,["repeat","spec","data"]);!NCt(r)&&t.columns&&(t=iSt(t,["columns"]),XNt(SNt("repeat")));const s=[],{repeater:c={},repeaterPrefix:u=""}=e,l=!NCt(r)&&r.row||[c?c.row:null],h=!NCt(r)&&r.column||[c?c.column:null],d=NCt(r)&&r||[c?c.repeat:null];for(const p of d)for(const t of l)for(const n of h){const a={repeat:p,row:t,column:n,layer:c.layer},o=(i.name||"")+u+"child__"+(NCt(r)?"".concat(wSt(p)):(r.row?"row_".concat(wSt(t)):"")+(r.column?"column_".concat(wSt(n)):"")),l=this.map(i,Object.assign(Object.assign({},e),{repeater:a,repeaterPrefix:o}));l.name=o,s.push(iSt(l,["data"]))}const f=NCt(r)?t.columns:r.column?r.column.length:1;return Object.assign(Object.assign({data:null!==(n=i.data)&&void 0!==n?n:a,align:"all"},o),{columns:f,concat:s})}mapFacet(t,e){const{facet:n}=t;return BDt(n)&&t.columns&&(t=iSt(t,["columns"]),XNt(SNt("facet"))),super.mapFacet(t,e)}mapUnitWithParentEncodingOrProjection(t,e){const{encoding:n,projection:r}=t,{parentEncoding:i,parentProjection:a,config:o}=e,s=fOt({parentProjection:a,projection:r}),c=dOt({parentEncoding:i,encoding:aOt(n,e.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),s?{projection:s}:{}),c?{encoding:c}:{}),{config:o})}mapFacetedUnit(t,e){const n=t.encoding,{row:r,column:i,facet:a}=n,o=VCt(n,["row","column","facet"]),{mark:s,width:c,projection:u,height:l,view:h,selection:d,encoding:f}=t,p=VCt(t,["mark","width","projection","height","view","selection","encoding"]),{facetMapping:g,layout:m}=this.getFacetMappingAndLayout({row:r,column:i,facet:a},e),v=aOt(o,e.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},p),m),{facet:g,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},c?{width:c}:{}),l?{height:l}:{}),h?{view:h}:{}),u?{projection:u}:{}),{mark:s,encoding:v}),d?{selection:d}:{})}),e)}getFacetMappingAndLayout(t,e){var n;const{row:r,column:i,facet:a}=t;if(r||i){a&&XNt((o=[...r?[_Et]:[],...i?[AEt]:[]],"Facet encoding dropped as ".concat(o.join(" and ")," ").concat(o.length>1?"are":"is"," also specified.")));const e={},s={};for(const r of[_Et,AEt]){const i=t[r];if(i){const{align:t,center:a,spacing:o,columns:c}=i,u=VCt(i,["align","center","spacing","columns"]);e[r]=u;for(const e of["align","center","spacing"])void 0!==i[e]&&(s[e]=null!==(n=s[e])&&void 0!==n?n:{},s[e][r]=i[e])}}return{facetMapping:e,layout:s}}{const{align:t,center:n,spacing:r,columns:i}=a;return{facetMapping:iOt(VCt(a,["align","center","spacing","columns"]),e.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},t?{align:t}:{}),n?{center:n}:{}),r?{spacing:r}:{}),i?{columns:i}:{})}}var o}mapLayer(t,e){var{parentEncoding:n,parentProjection:r}=e,i=VCt(e,["parentEncoding","parentProjection"]);const{encoding:a,projection:o}=t,s=VCt(t,["encoding","projection"]),c=Object.assign(Object.assign({},i),{parentEncoding:dOt({parentEncoding:n,encoding:a}),parentProjection:fOt({parentProjection:r,projection:o})});return super.mapLayer(s,c)}};function mOt(t){return jCt(t)?{type:t}:null!==t&&void 0!==t?t:{}}const vOt=["background","padding"];function yOt(t){return vOt.reduce(((e,n)=>(t&&void 0!==t[n]&&(e[n]=t[n]),e)),{})}class bOt{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.explicit=t,this.implicit=e}clone(){return new bOt(nSt(this.explicit),nSt(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return DSt(this.explicit[t],this.implicit[t])}getWithExplicit(t){return void 0!==this.explicit[t]?{explicit:!0,value:this.explicit[t]}:void 0!==this.implicit[t]?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,e){void 0!==e.value&&this.set(t,e.value,e.explicit)}set(t,e,n){return delete this[n?"implicit":"explicit"][t],this[n?"explicit":"implicit"][t]=e,this}copyKeyFromSplit(t,e){void 0!==e.explicit[t]?this.set(t,e.explicit[t],!0):void 0!==e.implicit[t]&&this.set(t,e.implicit[t],!1)}copyKeyFromObject(t,e){void 0!==e[t]&&this.set(t,e[t],!0)}copyAll(t){for(const e of vSt(t.combine())){const n=t.getWithExplicit(e);this.setWithExplicit(e,n)}}}function xOt(t){return{explicit:!0,value:t}}function wOt(t){return{explicit:!1,value:t}}function kOt(t){return(e,n,r,i)=>{const a=t(e.value,n.value);return a>0?e:a<0?n:_Ot(e,n,r,i)}}function _Ot(t,e,n,r){return t.explicit&&e.explicit&&XNt(function(t,e,n,r){return"Conflicting ".concat(e.toString(),' property "').concat(t.toString(),'" (').concat(aSt(n)," and ").concat(aSt(r),"). Using ").concat(aSt(n),".")}(n,r,t.value,e.value)),t}function AOt(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:_Ot;return void 0===t||void 0===t.value?e:t.explicit&&!e.explicit?t:e.explicit&&!t.explicit?e:eSt(t.value,e.value)?t:i(t,e,n,r)}class COt extends bOt{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(t,e),this.explicit=t,this.implicit=e,this.parseNothing=n}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function SOt(t){return"url"in t}function EOt(t){return"values"in t}function TOt(t){return"name"in t&&!SOt(t)&&!EOt(t)&&!NOt(t)}function NOt(t){return t&&(FOt(t)||DOt(t)||IOt(t))}function FOt(t){return"sequence"in t}function DOt(t){return"sphere"in t}function IOt(t){return"graticule"in t}const MOt="main",OOt="raw";function ROt(t){return"filter"in t}function zOt(t){return"lookup"in t}function BOt(t){return"pivot"in t}function LOt(t){return"density"in t}function POt(t){return"quantile"in t}function jOt(t){return"regression"in t}function UOt(t){return"loess"in t}function WOt(t){return"sample"in t}function VOt(t){return"window"in t}function qOt(t){return"joinaggregate"in t}function GOt(t){return"flatten"in t}function HOt(t){return"calculate"in t}function YOt(t){return"bin"in t}function XOt(t){return"impute"in t}function KOt(t){return"timeUnit"in t}function QOt(t){return"aggregate"in t}function ZOt(t){return"stack"in t}function $Ot(t){return"fold"in t}function JOt(t,e,n,r){const i=qDt(e)&&e.condition,a=r(e);if(i){const e=RCt(i).map((e=>{const n=r(e),i=function(t){return t.selection}(e)?gLt(t,e.selection):vLt(t,e.test);return Object.assign({test:i},n)}));return{[n]:[...e,...void 0!==a?[a]:[]]}}return void 0!==a?{[n]:a}:{}}function tRt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";const n=t.encoding[e];return JOt(t,n,e,(e=>eRt(e,t.config)))}function eRt(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"datum";if(t){if(tIt(t))return TIt(t.value);if($Dt(t)){const{format:r,formatType:i}=pIt(t);return kDt({fieldOrDatumDef:t,format:r,formatType:i,expr:n,config:e})}}}function nRt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{encoding:n,markDef:r,config:i,stack:a}=t,o=n.tooltip;if(NCt(o))return{tooltip:iRt({tooltip:o},a,i,e)};{const s=e.reactiveGeom?"datum.datum":"datum";return JOt(t,o,"tooltip",(t=>{const o=eRt(t,i,s);if(o)return o;if(null===t)return;let c=IIt("tooltip",r,i);return!0===c&&(c={content:"encoding"}),jCt(c)?{value:c}:FCt(c)?"encoding"===c.content?iRt(n,a,i,e):{signal:s}:void 0}))}}function rRt(t,e,n){let{reactiveGeom:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i={},a=r?"datum.datum":"datum",o=[];function s(r,s){const c=ATt(s),u=JDt(r)?r:Object.assign(Object.assign({},r),{type:t[c].type}),l=RCt(hIt(u,n,{allowDisabling:!1})).join(", ");let h;if(qTt(s)){const r="x"===s?"x2":"y2",o=gIt(t[r]);if(pNt(u.bin)&&o){const t=aIt(u,{expr:a}),e=aIt(o,{expr:a}),{format:s,formatType:c}=pIt(u);h=FDt(t,e,s,c,n),i[r]=!0}else if(e&&e.fieldChannel===s&&"normalize"===e.offset){const{format:t,formatType:e}=pIt(u);h=kDt({fieldOrDatumDef:u,format:t,formatType:e,expr:a,config:n,normalizeStack:!0}).signal}}h=null!==h&&void 0!==h?h:eRt(u,n,a).signal,o.push({channel:s,key:l,value:h})}GIt(t,((t,e)=>{YDt(t)?s(t,e):GDt(t)&&s(t.condition,e)}));const c={};for(const{channel:u,key:l,value:h}of o)i[u]||c[l]||(c[UCt(l)]=h);return c}function iRt(t,e,n){let{reactiveGeom:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=bSt(rRt(t,e,n,{reactiveGeom:r})).map((t=>{let{key:e,value:n}=t;return"".concat(e,": ").concat(n)}));return i.length>0?{signal:"{".concat(i.join(", "),"}")}:void 0}function aRt(t){const{markDef:e,config:n}=t,r=IIt("aria",e,n);return!1===r?{}:Object.assign(Object.assign(Object.assign({},r?{aria:r}:{}),function(t){const{mark:e,markDef:n,config:r}=t;if(!1===r.aria)return{};const i=IIt("ariaRoleDescription",n,r);if(null!=i)return{ariaRoleDescription:{value:i}};return e in gFt?{}:{ariaRoleDescription:{value:e}}}(t)),function(t){const{encoding:e,markDef:n,config:r,stack:i}=t,a=e.description;if(a)return JOt(t,a,"description",(e=>eRt(e,t.config)));const o=IIt("description",n,r);if(null!=o)return{description:TIt(o)};if(!1===r.aria)return{};const s=rRt(e,i,r);if(mSt(s))return;return{description:{signal:bSt(s).map((t=>{let{key:e,value:n}=t;return"".concat(e,' + ": " + (').concat(n,")")})).join(' + "; " + ')}}}(t))}function oRt(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{markDef:r,encoding:i,config:a}=e,{vgChannel:o}=n;let{defaultRef:s,defaultValue:c}=n;void 0===s&&(c=null!==c&&void 0!==c?c:IIt(t,r,a,{vgChannel:o,ignoreVgConfig:!0}),void 0!==c&&(s=TIt(c)));const u=i[t];return JOt(e,u,null!==o&&void 0!==o?o:t,(n=>vDt({channel:t,channelDef:n,markDef:r,config:a,scaleName:e.scaleName(t),scale:e.getScaleComponent(t),stack:null,defaultRef:s})))}function sRt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{filled:void 0};var n,r,i,a;const{markDef:o,encoding:s,config:c}=t,{type:u}=o,l=null!==(n=e.filled)&&void 0!==n?n:IIt("filled",o,c),h=cSt(["bar","point","circle","square","geoshape"],u)?"transparent":void 0,d=null!==(i=null!==(r=IIt(!0===l?"color":void 0,o,c,{vgChannel:"fill"}))&&void 0!==r?r:c.mark[!0===l&&"color"])&&void 0!==i?i:h,f=null!==(a=IIt(!1===l?"color":void 0,o,c,{vgChannel:"stroke"}))&&void 0!==a?a:c.mark[!1===l&&"color"],p=l?"fill":"stroke",g=Object.assign(Object.assign({},d?{fill:TIt(d)}:{}),f?{stroke:TIt(f)}:{});return o.color&&(l?o.fill:o.stroke)&&XNt(DNt("property",{fill:"fill"in o,stroke:"stroke"in o})),Object.assign(Object.assign(Object.assign(Object.assign({},g),oRt("color",t,{vgChannel:p,defaultValue:l?d:f})),oRt("fill",t,{defaultValue:s.fill?d:void 0})),oRt("stroke",t,{defaultValue:s.stroke?f:void 0}))}function cRt(t,e){const n=function(t){switch(t){case SEt:return"xOffset";case EEt:return"yOffset";case TEt:return"x2Offset";case NEt:return"y2Offset";case IEt:return"thetaOffset";case FEt:return"radiusOffset";case MEt:return"theta2Offset";case DEt:return"radius2Offset"}}(t),r=e[n];if(r)return r}function uRt(t,e,n){let{defaultPos:r,vgChannel:i,isMidPoint:a}=n;const{encoding:o,markDef:s,config:c,stack:u}=e,l=o[t],h=o[STt(t)],d=e.scaleName(t),f=e.getScaleComponent(t),p=cRt(t,s),g=lRt({model:e,defaultPos:r,channel:t,scaleName:d,scale:f}),m=!l&&qTt(t)&&(o.latitude||o.longitude)?{field:e.getName(t)}:function(t){const{channel:e,channelDef:n,isMidPoint:r,scaleName:i,stack:a,offset:o,markDef:s,config:c}=t;if($Dt(n)&&a&&e===a.fieldChannel){if(YDt(n)){const t=WDt({channel:e,fieldDef:n,isMidPoint:r,markDef:s,stack:a,config:c});if(void 0!==t)return mDt({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",band:t,offset:o})}return gDt(n,i,{suffix:"end"},{offset:o})}return hDt(t)}({channel:t,channelDef:l,channel2Def:h,markDef:s,config:c,isMidPoint:a,scaleName:d,scale:f,stack:u,offset:p,defaultRef:g});return m?{[i||t]:m}:void 0}function lRt(t){let{model:e,defaultPos:n,channel:r,scaleName:i,scale:a}=t;const{markDef:o,config:s}=e;return()=>{const t=ATt(r),c=CTt(r),u=IIt(r,o,s,{vgChannel:c});if(void 0!==u)return yDt(r,u);switch(n){case"zeroOrMin":case"zeroOrMax":if(i){const t=a.get("type");if(cSt([zFt.LOG,zFt.TIME,zFt.UTC],t));else if(a.domainDefinitelyIncludesZero())return{scale:i,value:0}}if("zeroOrMin"===n)return"y"===t?{field:{group:"height"}}:{value:0};switch(t){case"radius":return{signal:"min(".concat(e.width.signal,",").concat(e.height.signal,")/2")};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const t=e[ETt(r)];return Object.assign(Object.assign({},t),{mult:.5})}}}}const hRt={left:"x",center:"xc",right:"x2"},dRt={top:"y",middle:"yc",bottom:"y2"};function fRt(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"middle";if("radius"===t||"theta"===t)return CTt(t);const i=IIt("x"===t?"align":"baseline",e,n);return"x"===t?hRt[i||("top"===r?"left":"center")]:dRt[i||r]}function pRt(t,e,n){let{defaultPos:r,defaultPos2:i,range:a}=n;return a?gRt(t,e,{defaultPos:r,defaultPos2:i}):uRt(t,e,{defaultPos:r})}function gRt(t,e,n){let{defaultPos:r,defaultPos2:i}=n;const{markDef:a,config:o}=e,s=STt(t),c=ETt(t),u=function(t,e,n){const{encoding:r,mark:i,markDef:a,stack:o,config:s}=t,c=ATt(n),u=ETt(n),l=CTt(n),h=r[c],d=t.scaleName(c),f=t.getScaleComponent(c),p=cRt(n in r||n in a?n:c,t.markDef);if(!h&&("x2"===n||"y2"===n)&&(r.latitude||r.longitude))return{[l]:{field:t.getName(n)}};const g=function(t){let{channel:e,channelDef:n,channel2Def:r,markDef:i,config:a,scaleName:o,scale:s,stack:c,offset:u,defaultRef:l}=t;if($Dt(n)&&c&&e.charAt(0)===c.fieldChannel.charAt(0))return gDt(n,o,{suffix:"start"},{offset:u});return hDt({channel:e,channelDef:r,scaleName:o,scale:s,stack:c,markDef:i,config:a,offset:u,defaultRef:l})}({channel:n,channelDef:h,channel2Def:r[n],markDef:a,config:s,scaleName:d,scale:f,stack:o,offset:p,defaultRef:void 0});if(void 0!==g)return{[l]:g};return mRt(n,a)||mRt(n,{[n]:OIt(n,a,s.style),[u]:OIt(u,a,s.style)})||mRt(n,s[i])||mRt(n,s.mark)||{[l]:lRt({model:t,defaultPos:e,channel:n,scaleName:d,scale:f})()}}(e,i,s),l=u[c]?fRt(t,a,o):CTt(t);return Object.assign(Object.assign({},uRt(t,e,{defaultPos:r,vgChannel:l})),u)}function mRt(t,e){const n=ETt(t),r=CTt(t);return void 0!==e[r]?{[r]:yDt(t,e[r])}:void 0!==e[t]?{[r]:yDt(t,e[t])}:e[n]?{[n]:yDt(t,e[n])}:void 0}function vRt(t,e,n){var r,i,a,o;const{config:s,encoding:c,markDef:u,stack:l}=t,h=STt(e),d=ETt(e),f=c[e],p=c[h],g=t.getScaleComponent(e),m=g?g.get("type"):void 0,v=t.scaleName(e),y=u.orient,b=null!==(i=null!==(r=c[d])&&void 0!==r?r:c.size)&&void 0!==i?i:IIt("size",u,s,{vgChannel:d}),x="bar"===n&&("x"===e?"vertical"===y:"horizontal"===y);if(YDt(f)&&(fNt(f.bin)||pNt(f.bin)||f.timeUnit&&!p)&&!b&&!XFt(m)){const n=WDt({channel:e,fieldDef:f,stack:l,markDef:u,config:s}),r=null===(a=t.component.axes[e])||void 0===a?void 0:a[0];return function(t){let{fieldDef:e,fieldDef2:n,channel:r,band:i,scaleName:a,markDef:o,spacing:s=0,axisTranslate:c,reverse:u,config:l}=t;const h=STt(r),d=CTt(r),f=CTt(h),p=cRt(r,o);if(fNt(e.bin)||e.timeUnit)return{[f]:xRt({channel:r,fieldDef:e,scaleName:a,markDef:o,band:(1-i)/2,offset:bRt(h,s,u,c,p),config:l}),[d]:xRt({channel:r,fieldDef:e,scaleName:a,markDef:o,band:1-(1-i)/2,offset:bRt(r,s,u,c,p),config:l})};if(pNt(e.bin)){const t=gDt(e,a,{},{offset:bRt(h,s,u,c,p)});if(YDt(n))return{[f]:t,[d]:gDt(n,a,{},{offset:bRt(r,s,u,c,p)})};if(gNt(e.bin)&&e.bin.step)return{[f]:t,[d]:{signal:'scale("'.concat(a,'", ').concat(aIt(e,{expr:"datum"})," + ").concat(e.bin.step,")"),offset:bRt(r,s,u,c,p)}}}return void XNt(qNt(h))}({fieldDef:f,fieldDef2:p,channel:e,markDef:u,scaleName:v,band:n,axisTranslate:null!==(o=null===r||void 0===r?void 0:r.get("translate"))&&void 0!==o?o:.5,spacing:qTt(e)?IIt("binSpacing",u,s):void 0,reverse:g.get("reverse"),config:s})}return($Dt(f)&&XFt(m)||x)&&!p?function(t,e,n,r){var i;const{markDef:a,encoding:o,config:s,stack:c}=r,u=a.orient,l=r.scaleName(n),h=r.getScaleComponent(n),d=ETt(n),f=STt(n),p="horizontal"===u&&"y"===n||"vertical"===u&&"x"===n,g=IIt(p?"size":d,a,s,{vgChannel:d});let m;(o.size||void 0!==g)&&(p?m=oRt("size",r,{vgChannel:d,defaultValue:g}):XNt(function(t){return'Cannot apply size to non-oriented mark "'.concat(t,'".')}(a.type)));const v=null!==(i=$Dt(e)?WDt({channel:n,fieldDef:e,markDef:a,stack:c,config:s}):void 0)&&void 0!==i?i:1;m=m||{[d]:yRt(t,d,l,h,s,v)};const y="band"!==(null===h||void 0===h?void 0:h.get("type"))||!("band"in m[d]),b=fRt(n,a,s,y?"middle":"top"),x=cRt(n,a),w=hDt({channel:n,channelDef:e,markDef:a,config:s,scaleName:l,scale:h,stack:c,offset:x,defaultRef:lRt({model:r,defaultPos:"mid",channel:n,scaleName:l,scale:h}),band:y?.5:(1-v)/2});if(d)return Object.assign({[b]:w},m);{const t=CTt(f),e=m[d],n=x?Object.assign(Object.assign({},e),{offset:x}):e;return{[b]:w,[t]:NCt(w)?[w[0],Object.assign(Object.assign({},w[1]),{offset:n})]:Object.assign(Object.assign({},w),{offset:n})}}}(n,f,e,t):gRt(e,t,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function yRt(t,e,n,r,i,a){if(r){const e=r.get("type");if("point"===e||"band"===e){if(void 0!==i[t].discreteBandSize)return{value:i[t].discreteBandSize};if(e===zFt.POINT){const t=r.get("range");return dFt(t)&&PCt(t.step)?{value:t.step-2}:{value:OMt-2}}return{scale:n,band:a}}return{value:i[t].continuousBandSize}}const o=IMt(i.view,e),s=DSt(i[t].discreteBandSize,o-2);return void 0!==s?{value:s}:void 0}function bRt(t,e,n,r,i){if(iTt(t))return 0;const a="x"===t||"y2"===t?-e/2:e/2;if(hFt(n)){const t=FIt(i);return{signal:"".concat(n.signal," ? ").concat(r-a).concat(t?"-"+t:""," : ").concat(r+a).concat(t?"+"+t:"")}}if(hFt(i)){const t=r+(n?-a:a);return{signal:"".concat(t||"").concat(n?" - ":t?" + ":"").concat(i.signal)}}return i=i||0,r+(n?-i-a:+i+a)}function xRt(t){let{channel:e,fieldDef:n,scaleName:r,markDef:i,band:a,offset:o,config:s}=t;return dDt({fieldDef:n,channel:e,markDef:i,ref:mDt({scaleName:r,fieldOrDatumDef:n,band:a,offset:o}),config:s})}const wRt=new Set(["aria"]);function kRt(t,e){const{fill:n,stroke:r}="include"===e.color?sRt(t):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},function(t,e){return pFt.reduce(((n,r)=>(wRt.has(r)||void 0===t[r]||"ignore"===e[r]||(n[r]=TIt(t[r])),n)),{})}(t.markDef,e)),_Rt(t,"fill",n)),_Rt(t,"stroke",r)),oRt("opacity",t)),oRt("fillOpacity",t)),oRt("strokeOpacity",t)),oRt("strokeWidth",t)),oRt("strokeDash",t)),nRt(t)),tRt(t,"href")),aRt(t))}function _Rt(t,e,n){const{config:r,mark:i,markDef:a}=t;if("hide"===IIt("invalid",a,r)&&n&&!rEt(i)){const r=function(t,e){let{invalid:n=!1,channels:r}=e;const i=r.reduce(((e,n)=>{const r=t.getScaleComponent(n);if(r){const i=r.get("type"),a=t.vgField(n,{expr:"datum"});a&&KFt(i)&&(e[a]=!0)}return e}),{}),a=vSt(i);if(a.length>0){const t=n?"||":"&&";return a.map((t=>pDt(t,n))).join(" ".concat(t," "))}return}(t,{invalid:!0,channels:aNt});if(r)return{[e]:[{test:r,value:null},...RCt(n)]}}return n?{[e]:n}:{}}function ARt(t){const{config:e,markDef:n}=t;if(IIt("invalid",n,e)){const e=function(t,e){let{invalid:n=!1,channels:r}=e;const i=r.reduce(((e,n)=>{const r=t.getScaleComponent(n);if(r){const i=r.get("type"),a=t.vgField(n,{expr:"datum"});a&&KFt(i)&&(e[a]=!0)}return e}),{}),a=vSt(i);if(a.length>0){const t=n?"||":"&&";return a.map((t=>pDt(t,n))).join(" ".concat(t," "))}return}(t,{channels:VTt});if(e)return{defined:{signal:e}}}return{}}function CRt(t,e){if(void 0!==e)return{[t]:TIt(e)}}const SRt="voronoi",ERt={has:t=>"interval"!==t.type&&t.nearest,parse:(t,e)=>{if(e.events)for(const n of e.events)n.markname=t.getName(SRt)},marks:(t,e,n)=>{const{x:r,y:i}=e.project.hasChannel,a=t.mark;if(rEt(a))return XNt('The "nearest" transform is not supported for '.concat(a," marks.")),n;const o={name:t.getName(SRt),type:"path",interactive:!0,from:{data:t.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},nRt(t,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[t.getSizeSignalRef("width"),t.getSizeSignalRef("height")]}]};let s=0,c=!1;return n.forEach(((e,n)=>{var r;const i=null!==(r=e.name)&&void 0!==r?r:"";i===t.component.mark[0].name?s=n:i.indexOf(SRt)>=0&&(c=!0)})),c||n.splice(s+1,0,o),n}},TRt=ERt;class NRt{constructor(t,e){this.debugName=e,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,e){this._children.indexOf(t)>-1?console.warn("Attempt to add the same child twice."):void 0!==e?this._children.splice(e,0,t):this._children.push(t)}removeChild(t){const e=this._children.indexOf(t);return this._children.splice(e,1),e}remove(){let t=this._parent.removeChild(this);for(const e of this._children)e._parent=this._parent,this._parent.addChild(e,t++)}insertAsParentOf(t){const e=t.parent;e.removeChild(this),this.parent=e,t.parent=this}swapWithParent(){const t=this._parent,e=t.parent;for(const n of this._children)n.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=e,t.parent=this}}class FRt extends NRt{constructor(t,e,n,r){super(t,e),this.type=n,this.refCounts=r,this._source=this._name=e,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName="clone_"+this.debugName,t._source=this._source,t._name="clone_"+this._name,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return void 0===this._hash&&(this._hash="Output ".concat(function(t){const e=++ISt;return t?String(t)+e:e}())),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}class DRt extends NRt{constructor(t,e){super(t),this.formula=e}clone(){return new DRt(null,nSt(this.formula))}static makeFromEncoding(t,e){const n=e.reduceFieldDef(((t,n,r)=>{const{field:i,timeUnit:a}=n,o=Xjt(e)?e.encoding[STt(r)]:void 0,s=Xjt(e)&&VDt(r,n,o,e.stack,e.markDef,e.config);if(a){const e=aIt(n,{forAs:!0});t[oSt({as:e,field:i,timeUnit:a})]=Object.assign({as:e,field:i,timeUnit:a},s?{band:!0}:{})}return t}),{});return mSt(n)?null:new DRt(t,n)}static makeFromTransform(t,e){const n=Object.assign({},e),{timeUnit:r}=n,i=VCt(n,["timeUnit"]),a=lFt(r),o=Object.assign(Object.assign({},i),{timeUnit:a});return new DRt(t,{[oSt(o)]:o})}merge(t){this.formula=Object.assign({},this.formula);for(const e in t.formula)this.formula[e]&&!t.formula[e].band||(this.formula[e]=t.formula[e]);for(const e of t.children)t.removeChild(e),e.parent=this;t.remove()}producedFields(){return new Set(ySt(this.formula).map((t=>t.as)))}dependentFields(){return new Set(ySt(this.formula).map((t=>t.field)))}hash(){return"TimeUnit ".concat(oSt(this.formula))}assemble(){const t=[];for(const e of ySt(this.formula)){const{field:n,as:r,timeUnit:i}=e,a=lFt(i),{unit:o,utc:s}=a,c=VCt(a,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:ESt(n),type:"timeunit"},o?{units:oFt(o)}:{}),s?{timezone:"utc"}:{}),c),{as:[r,"".concat(r,"_end")]}))}return t}}const IRt="_tuple_fields";class MRt{constructor(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.items=e,this.hasChannel={},this.hasField={}}}const ORt={has:()=>!0,parse:(t,e,n)=>{var r,i,a;const o=e.name,s=null!==(r=e.project)&&void 0!==r?r:e.project=new MRt,c={},u={},l=new Set,h=(t,e)=>{const n="visual"===e?t.channel:t.field;let r=wSt("".concat(o,"_").concat(n));for(let i=1;l.has(r);i++)r=wSt("".concat(o,"_").concat(n,"_").concat(i));return l.add(r),{[e]:r}};if(!n.fields&&!n.encodings){const e=t.config.selection[n.type];if(n.init)for(const t of RCt(n.init))for(const r of vSt(t))xTt[r]?(n.encodings||(n.encodings=[])).push(r):"interval"===n.type?(XNt('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=e.encodings):(n.fields||(n.fields=[])).push(r);else n.encodings=e.encodings,n.fields=e.fields}for(const d of null!==(i=n.fields)&&void 0!==i?i:[]){const t={type:"E",field:d};t.signals=Object.assign({},h(t,"data")),s.items.push(t),s.hasField[d]=t}for(const d of null!==(a=n.encodings)&&void 0!==a?a:[]){const n=t.fieldDef(d);if(n){let r=n.field;if(n.aggregate){XNt(ANt(d,n.aggregate));continue}if(!r){XNt(_Nt(d));continue}if(n.timeUnit){r=t.vgField(d);const e={timeUnit:n.timeUnit,as:r,field:n.field};u[oSt(e)]=e}if(!c[r]){let i="E";if("interval"===e.type){KFt(t.getScaleComponent(d).get("type"))&&(i="R")}else n.bin&&(i="R-RE");const a={field:r,channel:d,type:i};a.signals=Object.assign(Object.assign({},h(a,"data")),h(a,"visual")),s.items.push(c[r]=a),s.hasField[r]=s.hasChannel[d]=c[r]}}else XNt(_Nt(d))}if(n.init){const t=t=>s.items.map((e=>void 0!==t[e.channel]?t[e.channel]:t[e.field]));if("interval"===n.type)e.init=t(n.init);else{const r=RCt(n.init);e.init=r.map(t)}}mSt(u)||(s.timeUnit=new DRt(null,u))},signals:(t,e,n)=>{const r=e.name+IRt,i=n.filter((t=>t.name===r));return i.length>0?n:n.concat({name:r,value:e.project.items.map((t=>{const{signals:e,hasLegend:n}=t,r=VCt(t,["signals","hasLegend"]);return r.field=ESt(r.field),r}))})}},RRt={has:t=>"single"===t.type&&"global"===t.resolve&&t.bind&&"scales"!==t.bind&&!_Mt(t.bind),parse:(t,e,n,r)=>{r.on||delete e.events,r.clear||delete e.clear},topLevelSignals:(t,e,n)=>{const r=e.name,i=e.project,a=e.bind,o=e.init&&e.init[0],s=TRt.has(e)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach(((t,i)=>{var c,u;const l=wSt("".concat(r,"_").concat(t.field)),h=n.filter((t=>t.name===l));h.length||n.unshift(Object.assign(Object.assign({name:l},o?{init:ezt(o[i])}:{value:null}),{on:e.events?[{events:e.events,update:"datum && item().mark.marktype !== 'group' ? ".concat(s,"[").concat(UCt(t.field),"] : null")}]:[],bind:null!==(u=null!==(c=a[t.field])&&void 0!==c?c:a[t.channel])&&void 0!==u?u:a}))})),n},signals:(t,e,n)=>{const r=e.name,i=e.project,a=n.filter((t=>t.name===r+dzt))[0],o=r+IRt,s=i.items.map((t=>wSt("".concat(r,"_").concat(t.field)))),c=s.map((t=>"".concat(t," !== null"))).join(" && ");return s.length&&(a.update="".concat(c," ? {fields: ").concat(o,", values: [").concat(s.join(", "),"]} : null")),delete a.value,delete a.on,n}},zRt=RRt,BRt="_toggle",LRt={has:t=>"multi"===t.type&&!!t.toggle,signals:(t,e,n)=>n.concat({name:e.name+BRt,value:!1,on:[{events:e.events,update:e.toggle}]}),modifyExpr:(t,e)=>{const n=e.name+dzt,r=e.name+BRt;return"".concat(r," ? null : ").concat(n,", ")+("global"===e.resolve?"".concat(r," ? null : true, "):"".concat(r," ? null : {unit: ").concat(vzt(t),"}, "))+"".concat(r," ? ").concat(n," : null")}},PRt={has:t=>void 0!==t.clear&&!1!==t.clear,parse:(t,e,n)=>{n.clear&&(e.clear=jCt(n.clear)?pCt(n.clear,"scope"):n.clear)},topLevelSignals:(t,e,n)=>{if(zRt.has(e))for(const r of e.project.items){const t=n.findIndex((t=>t.name===wSt("".concat(e.name,"_").concat(r.field))));-1!==t&&n[t].on.push({events:e.clear,update:"null"})}return n},signals:(t,e,n)=>{function r(t,r){-1!==t&&n[t].on&&n[t].on.push({events:e.clear,update:r})}if("interval"===e.type)for(const i of e.project.items){const t=n.findIndex((t=>t.name===i.signals.visual));if(r(t,"[0, 0]"),-1===t){r(n.findIndex((t=>t.name===i.signals.data)),"null")}}else{let t=n.findIndex((t=>t.name===e.name+dzt));r(t,"null"),LRt.has(e)&&(t=n.findIndex((t=>t.name===e.name+BRt)),r(t,"false"))}return n}},jRt={has:t=>"interval"===t.type&&"global"===t.resolve&&t.bind&&"scales"===t.bind,parse:(t,e)=>{const n=e.scales=[];for(const r of e.project.items){const i=r.channel;if(!oNt(i))continue;const a=t.getScaleComponent(i),o=a?a.get("type"):void 0;if(!a||!KFt(o)){XNt("Scale bindings are currently only supported for scales with unbinned, continuous domains.");continue}const s={selection:e.name,field:r.field};a.set("selectionExtent",s,!0),n.push(r)}},topLevelSignals:(t,e,n)=>{const r=e.scales.filter((t=>0===n.filter((e=>e.name===t.signals.data)).length));if(!t.parent||VRt(t)||0===r.length)return n;const i=n.filter((t=>t.name===e.name))[0];let a=i.update;if(a.indexOf(pzt)>=0)i.update="{".concat(r.map((t=>"".concat(UCt(t.field),": ").concat(t.signals.data))).join(", "),"}");else{for(const t of r){const e="".concat(UCt(t.field),": ").concat(t.signals.data);a.indexOf(e)<0&&(a="".concat(a.substring(0,a.length-1),", ").concat(e,"}"))}i.update=a}return n.concat(r.map((t=>({name:t.signals.data}))))},signals:(t,e,n)=>{if(t.parent&&!VRt(t))for(const r of e.scales){const t=n.filter((t=>t.name===r.signals.data))[0];t.push="outer",delete t.value,delete t.update}return n}},URt=jRt;function WRt(t,e){const n=UCt(t.scaleName(e));return"domain(".concat(n,")")}function VRt(t){var e;return t.parent&&Zjt(t.parent)&&(null!==(e=!t.parent.parent)&&void 0!==e?e:VRt(t.parent.parent))}const qRt={has:t=>{const e="global"===t.resolve&&t.bind&&_Mt(t.bind),n=1===t.project.items.length&&t.project.items[0].field!==wMt;return e&&!n&&XNt("Legend bindings are only supported for selections over an individual field or encoding channel."),e&&n},parse:(t,e,n,r)=>{var i;if(r.on||delete e.events,r.clear||delete e.clear,r.on||r.clear){const t='event.item && indexof(event.item.mark.role, "legend") < 0';for(const n of e.events)n.filter=RCt(null!==(i=n.filter)&&void 0!==i?i:[]),n.filter.indexOf(t)<0&&n.filter.push(t)}const a=AMt(e.bind)?e.bind.legend:"click",o=jCt(a)?pCt(a,"view"):RCt(a);e.bind={legend:{merge:o}}},topLevelSignals:(t,e,n)=>{const r=e.name,i=AMt(e.bind)&&e.bind.legend,a=t=>e=>{const n=nSt(e);return n.markname=t,n};for(const o of e.project.items){if(!o.hasLegend)continue;const t="".concat(wSt(o.field),"_legend"),s="".concat(r,"_").concat(t),c=n.filter((t=>t.name===s));if(0===c.length){const r=i.merge.map(a("".concat(t,"_symbols"))).concat(i.merge.map(a("".concat(t,"_labels")))).concat(i.merge.map(a("".concat(t,"_entries"))));n.unshift(Object.assign(Object.assign({name:s},e.init?{}:{value:null}),{on:[{events:r,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:"!event.item || !datum ? null : ".concat(s),force:!0}]}))}}return n},signals:(t,e,n)=>{const r=e.name,i=e.project,a=n.find((t=>t.name===r+dzt)),o=r+IRt,s=i.items.filter((t=>t.hasLegend)).map((t=>wSt("".concat(r,"_").concat(wSt(t.field),"_legend")))),c=s.map((t=>"".concat(t," !== null"))).join(" && "),u="".concat(c," ? {fields: ").concat(o,", values: [").concat(s.join(", "),"]} : null");e.events&&s.length>0?a.on.push({events:s.map((t=>({signal:t}))),update:u}):s.length>0&&(a.update=u,delete a.value,delete a.on);const l=n.find((t=>t.name===r+BRt)),h=AMt(e.bind)&&e.bind.legend;return l&&(e.events?l.on.push(Object.assign(Object.assign({},l.on[0]),{events:h})):l.on[0].events=h),n}};const GRt="_translate_anchor",HRt="_translate_delta",YRt={has:t=>"interval"===t.type&&t.translate,signals:(t,e,n)=>{const r=e.name,i=URt.has(e),a=r+GRt,{x:o,y:s}=e.project.hasChannel;let c=pCt(e.translate,"scope");return i||(c=c.map((t=>(t.between[0].markname=r+izt,t)))),n.push({name:a,value:{},on:[{events:c.map((t=>t.between[0])),update:"{x: x(unit), y: y(unit)"+(void 0!==o?", extent_x: "+(i?WRt(t,SEt):"slice(".concat(o.signals.visual,")")):"")+(void 0!==s?", extent_y: "+(i?WRt(t,EEt):"slice(".concat(s.signals.visual,")")):"")+"}"}]},{name:r+HRt,value:{},on:[{events:c,update:"{x: ".concat(a,".x - x(unit), y: ").concat(a,".y - y(unit)}")}]}),void 0!==o&&XRt(t,e,o,"width",n),void 0!==s&&XRt(t,e,s,"height",n),n}};function XRt(t,e,n,r,i){var a;const o=e.name,s=o+GRt,c=o+HRt,u=n.channel,l=URt.has(e),h=i.filter((t=>t.name===n.signals[l?"data":"visual"]))[0],d=t.getSizeSignalRef(r).signal,f=t.getScaleComponent(u),p=f.get("type"),g=l&&u===SEt?"-":"",m="".concat(s,".extent_").concat(u),v="".concat(g).concat(c,".").concat(u," / ")+(l?"".concat(d):"span(".concat(m,")")),y="".concat(l?"log"===p?"panLog":"pow"===p?"panPow":"panLinear":"panLinear","(").concat(m,", ").concat(v)+(l&&"pow"===p?", ".concat(null!==(a=f.get("exponent"))&&void 0!==a?a:1):"")+")";h.on.push({events:{signal:c},update:l?y:"clampRange(".concat(y,", 0, ").concat(d,")")})}const KRt="_zoom_anchor",QRt="_zoom_delta",ZRt={has:t=>"interval"===t.type&&t.zoom,signals:(t,e,n)=>{const r=e.name,i=URt.has(e),a=r+QRt,{x:o,y:s}=e.project.hasChannel,c=UCt(t.scaleName(SEt)),u=UCt(t.scaleName(EEt));let l=pCt(e.zoom,"scope");return i||(l=l.map((t=>(t.markname=r+izt,t)))),n.push({name:r+KRt,on:[{events:l,update:i?"{"+[c?"x: invert(".concat(c,", x(unit))"):"",u?"y: invert(".concat(u,", y(unit))"):""].filter((t=>!!t)).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:a,on:[{events:l,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==o&&$Rt(t,e,o,"width",n),void 0!==s&&$Rt(t,e,s,"height",n),n}};function $Rt(t,e,n,r,i){var a;const o=e.name,s=n.channel,c=URt.has(e),u=i.filter((t=>t.name===n.signals[c?"data":"visual"]))[0],l=t.getSizeSignalRef(r).signal,h=t.getScaleComponent(s),d=h.get("type"),f=c?WRt(t,s):u.name,p=o+QRt,g="".concat(o).concat(KRt,".").concat(s),m="".concat(c?"log"===d?"zoomLog":"pow"===d?"zoomPow":"zoomLinear":"zoomLinear","(").concat(f,", ").concat(g,", ").concat(p)+(c&&"pow"===d?", ".concat(null!==(a=h.get("exponent"))&&void 0!==a?a:1):"")+")";u.on.push({events:{signal:p},update:c?m:"clampRange(".concat(m,", 0, ").concat(l,")")})}const JRt=[ORt,LRt,URt,qRt,YRt,ZRt,zRt,TRt,PRt];function tzt(t,e){for(const n of JRt)n.has(t)&&e(n)}function ezt(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ECt;if(NCt(t)){const r=t.map((t=>ezt(t,e,n)));return e?"[".concat(r.join(", "),"]"):r}return KNt(t)?n(e?eFt(t):function(t){const e=tFt(t,!0);return t.utc?+new Date(Date.UTC(...e)):+new Date(...e)}(t)):e?n(JSON.stringify(t)):t}function nzt(t,e){return mzt(t,((n,r)=>{e=r.marks?r.marks(t,n,e):e,tzt(n,(r=>{r.marks&&(e=r.marks(t,n,e))}))})),e}function rzt(t){return t.map((t=>(t.on&&!t.on.length&&delete t.on,t)))}const izt="_brush",azt="_scale_trigger",ozt={signals:(t,e)=>{const n=e.name,r=n+IRt,i=URt.has(e),a=[],o=[],s=[];if(e.translate&&!i){const t="!event.item || event.item.mark.name !== ".concat(UCt(n+izt));szt(e,((e,n)=>{var r;const i=RCt(null!==(r=n.between[0].filter)&&void 0!==r?r:n.between[0].filter=[]);return i.indexOf(t)<0&&i.push(t),e}))}e.project.items.forEach(((n,r)=>{const i=n.channel;if(i!==SEt&&i!==EEt)return void XNt("Interval selections only support x and y encoding channels.");const c=e.init?e.init[r]:null,u=function(t,e,n,r){const i=n.channel,a=n.signals.visual,o=n.signals.data,s=URt.has(e),c=UCt(t.scaleName(i)),u=t.getScaleComponent(i),l=u?u.get("type"):void 0,h=t=>"scale(".concat(c,", ").concat(t,")"),d=t.getSizeSignalRef(i===SEt?"width":"height").signal,f="".concat(i,"(unit)"),p=szt(e,((t,e)=>[...t,{events:e.between[0],update:"[".concat(f,", ").concat(f,"]")},{events:e,update:"[".concat(a,"[0], clamp(").concat(f,", 0, ").concat(d,")]")}]));return p.push({events:{signal:e.name+azt},update:KFt(l)?"[".concat(h("".concat(o,"[0]")),", ").concat(h("".concat(o,"[1]")),"]"):"[0, 0]"}),s?[{name:o,on:[]}]:[Object.assign(Object.assign({name:a},r?{init:ezt(r,!0,h)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:o},r?{init:ezt(r)}:{}),{on:[{events:{signal:a},update:"".concat(a,"[0] === ").concat(a,"[1] ? null : invert(").concat(c,", ").concat(a,")")}]})]}(t,e,n,c),l=n.signals.data,h=n.signals.visual,d=UCt(t.scaleName(i)),f=KFt(t.getScaleComponent(i).get("type"))?"+":"";a.push(...u),o.push(l),s.push({scaleName:t.scaleName(i),expr:"(!isArray(".concat(l,") || ")+"(".concat(f,"invert(").concat(d,", ").concat(h,")[0] === ").concat(f).concat(l,"[0] && ")+"".concat(f,"invert(").concat(d,", ").concat(h,")[1] === ").concat(f).concat(l,"[1]))")})})),i||a.push({name:n+azt,value:{},on:[{events:s.map((t=>({scale:t.scaleName}))),update:s.map((t=>t.expr)).join(" && ")+" ? ".concat(n+azt," : {}")}]});const c=e.init,u="unit: ".concat(vzt(t),", fields: ").concat(r,", values");return a.concat(Object.assign(Object.assign({name:n+dzt},c?{init:"{".concat(u,": ").concat(ezt(c),"}")}:{}),{on:[{events:[{signal:o.join(" || ")}],update:o.join(" && ")+" ? {".concat(u,": [").concat(o,"]} : null")}]}))},modifyExpr:(t,e)=>e.name+dzt+", "+("global"===e.resolve?"true":"{unit: ".concat(vzt(t),"}")),marks:(t,e,n)=>{const r=e.name,{x:i,y:a}=e.project.hasChannel,o=i&&i.signals.visual,s=a&&a.signals.visual,c="data(".concat(UCt(e.name+hzt),")");if(URt.has(e))return n;const u={x:void 0!==i?{signal:"".concat(o,"[0]")}:{value:0},y:void 0!==a?{signal:"".concat(s,"[0]")}:{value:0},x2:void 0!==i?{signal:"".concat(o,"[1]")}:{field:{group:"width"}},y2:void 0!==a?{signal:"".concat(s,"[1]")}:{field:{group:"height"}}};if("global"===e.resolve)for(const m of vSt(u))u[m]=[Object.assign({test:"".concat(c,".length && ").concat(c,"[0].unit === ").concat(vzt(t))},u[m]),{value:0}];const l=e.mark,{fill:h,fillOpacity:d,cursor:f}=l,p=VCt(l,["fill","fillOpacity","cursor"]),g=vSt(p).reduce(((t,e)=>(t[e]=[{test:[void 0!==i&&"".concat(o,"[0] !== ").concat(o,"[1]"),void 0!==a&&"".concat(s,"[0] !== ").concat(s,"[1]")].filter((t=>t)).join(" && "),value:p[e]},{value:null}],t)),{});return[{name:r+izt+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:h},fillOpacity:{value:d}},update:u}},...n,{name:r+izt,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},f?{cursor:{value:f}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},u),g)}}]}};function szt(t,e){return t.events.reduce(((t,n)=>n.between?e(t,n):(XNt("".concat(n," is not an ordered event stream for interval selections.")),t)),[])}function czt(t,e){const n=e.name,r=n+IRt,i=e.project,a="(item().isVoronoi ? datum.datum : datum)",o=i.items.map((e=>{const n=t.fieldDef(e.channel);return n&&n.bin?"[".concat(a,"[").concat(UCt(t.vgField(e.channel,{})),"], ")+"".concat(a,"[").concat(UCt(t.vgField(e.channel,{binSuffix:"end"})),"]]"):"".concat(a,"[").concat(UCt(e.field),"]")})).join(", "),s="unit: ".concat(vzt(t),", fields: ").concat(r,", values"),c=e.events;return[{name:n+dzt,on:c?[{events:c,update:"datum && item().mark.marktype !== 'group' ? {".concat(s,": [").concat(o,"]} : null"),force:!0}]:[]}]}const uzt={signals:czt,modifyExpr:(t,e)=>e.name+dzt+", "+("global"===e.resolve?"null":"{unit: ".concat(vzt(t),"}"))},lzt={signals:czt,modifyExpr:(t,e)=>e.name+dzt+", "+("global"===e.resolve?"true":"{unit: ".concat(vzt(t),"}"))},hzt="_store",dzt="_tuple",fzt="_modify",pzt="vlSelectionResolve",gzt={single:lzt,multi:uzt,interval:ozt};function mzt(t,e){const n=t.component.selection;if(n)for(const r of ySt(n)){if(!0===e(r,gzt[r.type]))break}}function vzt(t){let{escape:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{escape:!0},n=e?UCt(t.name):t.name;const r=function(t){let e=t.parent;for(;e&&!Kjt(e);)e=e.parent;return e}(t);if(r){const{facet:t}=r;for(const e of lTt)t[e]&&(n+=" + '__facet_".concat(e,"_' + (facet[").concat(UCt(r.vgField(e)),"])"))}return n}function yzt(t){let e=!1;return mzt(t,(t=>{e=e||t.project.items.some((t=>t.field===wMt))})),e}const bzt="Property",xzt="ArrayExpression",wzt="BinaryExpression",kzt="CallExpression",_zt="ConditionalExpression",Azt="LogicalExpression",Czt="MemberExpression",Szt="ObjectExpression",Ezt="UnaryExpression";function Tzt(t){this.type=t}var Nzt,Fzt,Dzt,Izt,Mzt;Tzt.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=function(t){switch(t.type){case xzt:return t.elements;case wzt:case Azt:return[t.left,t.right];case kzt:return[t.callee].concat(t.arguments);case _zt:return[t.test,t.consequent,t.alternate];case Czt:return[t.object,t.property];case Szt:return t.properties;case bzt:return[t.key,t.value];case Ezt:return[t.argument];default:return[]}}(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1};var Ozt=1,Rzt=2,zzt=3,Bzt=4,Lzt=5,Pzt=6,jzt=7,Uzt=8;(Nzt={})[Ozt]="Boolean",Nzt[Rzt]="<end>",Nzt[zzt]="Identifier",Nzt[Bzt]="Keyword",Nzt[Lzt]="Null",Nzt[Pzt]="Numeric",Nzt[jzt]="Punctuator",Nzt[Uzt]="String",Nzt[9]="RegularExpression";var Wzt="ArrayExpression",Vzt="BinaryExpression",qzt="CallExpression",Gzt="ConditionalExpression",Hzt="Identifier",Yzt="Literal",Xzt="LogicalExpression",Kzt="MemberExpression",Qzt="ObjectExpression",Zzt="Property",$zt="UnaryExpression",Jzt="Unexpected token %0",tBt="Unexpected number",eBt="Unexpected string",nBt="Unexpected identifier",rBt="Unexpected reserved word",iBt="Unexpected end of input",aBt="Invalid regular expression",oBt="Invalid regular expression: missing /",sBt="Octal literals are not allowed in strict mode.",cBt="Duplicate data property in object literal not allowed in strict mode",uBt="ILLEGAL",lBt="Disabled.",hBt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),dBt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function fBt(t,e){if(!t)throw new Error("ASSERT: "+e)}function pBt(t){return t>=48&&t<=57}function gBt(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function mBt(t){return"01234567".indexOf(t)>=0}function vBt(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function yBt(t){return 10===t||13===t||8232===t||8233===t}function bBt(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||t>=128&&hBt.test(String.fromCharCode(t))}function xBt(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||t>=128&&dBt.test(String.fromCharCode(t))}var wBt={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function kBt(){for(var t;Dzt<Izt&&(vBt(t=Fzt.charCodeAt(Dzt))||yBt(t));)++Dzt}function _Bt(t){var e,n,r,i=0;for(n="u"===t?4:2,e=0;e<n;++e)Dzt<Izt&&gBt(Fzt[Dzt])?(r=Fzt[Dzt++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):PBt({},Jzt,uBt);return String.fromCharCode(i)}function ABt(){var t,e,n,r;for(e=0,"}"===(t=Fzt[Dzt])&&PBt({},Jzt,uBt);Dzt<Izt&&gBt(t=Fzt[Dzt++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||"}"!==t)&&PBt({},Jzt,uBt),e<=65535?String.fromCharCode(e):(n=55296+(e-65536>>10),r=56320+(e-65536&1023),String.fromCharCode(n,r))}function CBt(){var t,e;for(t=Fzt.charCodeAt(Dzt++),e=String.fromCharCode(t),92===t&&(117!==Fzt.charCodeAt(Dzt)&&PBt({},Jzt,uBt),++Dzt,(t=_Bt("u"))&&"\\"!==t&&bBt(t.charCodeAt(0))||PBt({},Jzt,uBt),e=t);Dzt<Izt&&xBt(t=Fzt.charCodeAt(Dzt));)++Dzt,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==Fzt.charCodeAt(Dzt)&&PBt({},Jzt,uBt),++Dzt,(t=_Bt("u"))&&"\\"!==t&&xBt(t.charCodeAt(0))||PBt({},Jzt,uBt),e+=t);return e}function SBt(){var t,e;return t=Dzt,e=92===Fzt.charCodeAt(Dzt)?CBt():function(){var t,e;for(t=Dzt++;Dzt<Izt;){if(92===(e=Fzt.charCodeAt(Dzt)))return Dzt=t,CBt();if(!xBt(e))break;++Dzt}return Fzt.slice(t,Dzt)}(),{type:1===e.length?zzt:wBt.hasOwnProperty(e)?Bzt:"null"===e?Lzt:"true"===e||"false"===e?Ozt:zzt,value:e,start:t,end:Dzt}}function EBt(){var t,e,n,r,i=Dzt,a=Fzt.charCodeAt(Dzt),o=Fzt[Dzt];switch(a){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++Dzt,{type:jzt,value:String.fromCharCode(a),start:i,end:Dzt};default:if(61===(t=Fzt.charCodeAt(Dzt+1)))switch(a){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return Dzt+=2,{type:jzt,value:String.fromCharCode(a)+String.fromCharCode(t),start:i,end:Dzt};case 33:case 61:return Dzt+=2,61===Fzt.charCodeAt(Dzt)&&++Dzt,{type:jzt,value:Fzt.slice(i,Dzt),start:i,end:Dzt}}}return">>>="===(r=Fzt.substr(Dzt,4))?{type:jzt,value:r,start:i,end:Dzt+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:jzt,value:n,start:i,end:Dzt+=3}:o===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(o)>=0||"=>"===e?{type:jzt,value:e,start:i,end:Dzt+=2}:"<>=!+-*%&|^/".indexOf(o)>=0?(++Dzt,{type:jzt,value:o,start:i,end:Dzt}):void PBt({},Jzt,uBt)}function TBt(){var t,e,n;if(fBt(pBt((n=Fzt[Dzt]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),e=Dzt,t="","."!==n){if(t=Fzt[Dzt++],n=Fzt[Dzt],"0"===t){if("x"===n||"X"===n)return++Dzt,function(t){for(var e="";Dzt<Izt&&gBt(Fzt[Dzt]);)e+=Fzt[Dzt++];return 0===e.length&&PBt({},Jzt,uBt),bBt(Fzt.charCodeAt(Dzt))&&PBt({},Jzt,uBt),{type:Pzt,value:parseInt("0x"+e,16),start:t,end:Dzt}}(e);if(mBt(n))return function(t){for(var e="0"+Fzt[Dzt++];Dzt<Izt&&mBt(Fzt[Dzt]);)e+=Fzt[Dzt++];return(bBt(Fzt.charCodeAt(Dzt))||pBt(Fzt.charCodeAt(Dzt)))&&PBt({},Jzt,uBt),{type:Pzt,value:parseInt(e,8),octal:!0,start:t,end:Dzt}}(e);n&&pBt(n.charCodeAt(0))&&PBt({},Jzt,uBt)}for(;pBt(Fzt.charCodeAt(Dzt));)t+=Fzt[Dzt++];n=Fzt[Dzt]}if("."===n){for(t+=Fzt[Dzt++];pBt(Fzt.charCodeAt(Dzt));)t+=Fzt[Dzt++];n=Fzt[Dzt]}if("e"===n||"E"===n)if(t+=Fzt[Dzt++],"+"!==(n=Fzt[Dzt])&&"-"!==n||(t+=Fzt[Dzt++]),pBt(Fzt.charCodeAt(Dzt)))for(;pBt(Fzt.charCodeAt(Dzt));)t+=Fzt[Dzt++];else PBt({},Jzt,uBt);return bBt(Fzt.charCodeAt(Dzt))&&PBt({},Jzt,uBt),{type:Pzt,value:parseFloat(t),start:e,end:Dzt}}function NBt(){var t,e,n,r;return Mzt=null,kBt(),t=Dzt,e=function(){var t,e,n,r;for(fBt("/"===(t=Fzt[Dzt]),"Regular expression literal must start with a slash"),e=Fzt[Dzt++],n=!1,r=!1;Dzt<Izt;)if(e+=t=Fzt[Dzt++],"\\"===t)yBt((t=Fzt[Dzt++]).charCodeAt(0))&&PBt({},oBt),e+=t;else if(yBt(t.charCodeAt(0)))PBt({},oBt);else if(n)"]"===t&&(n=!1);else{if("/"===t){r=!0;break}"["===t&&(n=!0)}return r||PBt({},oBt),{value:e.substr(1,e.length-2),literal:e}}(),n=function(){var t,e,n;for(e="",n="";Dzt<Izt&&xBt((t=Fzt[Dzt]).charCodeAt(0));)++Dzt,"\\"===t&&Dzt<Izt?PBt({},Jzt,uBt):(n+=t,e+=t);return n.search(/[^gimuy]/g)>=0&&PBt({},aBt,n),{value:n,literal:e}}(),r=function(t,e){var n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(t,e){if(parseInt(e,16)<=1114111)return"x";PBt({},aBt)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){PBt({},aBt)}try{return new RegExp(t,e)}catch(i){return null}}(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:Dzt}}function FBt(){var t;return kBt(),Dzt>=Izt?{type:Rzt,start:Dzt,end:Dzt}:bBt(t=Fzt.charCodeAt(Dzt))?SBt():40===t||41===t||59===t?EBt():39===t||34===t?function(){var t,e,n,r,i="",a=!1;for(fBt("'"===(t=Fzt[Dzt])||'"'===t,"String literal must starts with a quote"),e=Dzt,++Dzt;Dzt<Izt;){if((n=Fzt[Dzt++])===t){t="";break}if("\\"===n)if((n=Fzt[Dzt++])&&yBt(n.charCodeAt(0)))"\r"===n&&"\n"===Fzt[Dzt]&&++Dzt;else switch(n){case"u":case"x":"{"===Fzt[Dzt]?(++Dzt,i+=ABt()):i+=_Bt(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:mBt(n)?(0!==(r="01234567".indexOf(n))&&(a=!0),Dzt<Izt&&mBt(Fzt[Dzt])&&(a=!0,r=8*r+"01234567".indexOf(Fzt[Dzt++]),"0123".indexOf(n)>=0&&Dzt<Izt&&mBt(Fzt[Dzt])&&(r=8*r+"01234567".indexOf(Fzt[Dzt++]))),i+=String.fromCharCode(r)):i+=n}else{if(yBt(n.charCodeAt(0)))break;i+=n}}return""!==t&&PBt({},Jzt,uBt),{type:Uzt,value:i,octal:a,start:e,end:Dzt}}():46===t?pBt(Fzt.charCodeAt(Dzt+1))?TBt():EBt():pBt(t)?TBt():EBt()}function DBt(){var t;return Dzt=(t=Mzt).end,Mzt=FBt(),Dzt=t.end,t}function IBt(){var t;t=Dzt,Mzt=FBt(),Dzt=t}function MBt(t,e,n){var r=new Tzt("||"===t||"&&"===t?Xzt:Vzt);return r.operator=t,r.left=e,r.right=n,r}function OBt(t,e){var n=new Tzt(qzt);return n.callee=t,n.arguments=e,n}function RBt(t){var e=new Tzt(Hzt);return e.name=t,e}function zBt(t){var e=new Tzt(Yzt);return e.value=t.value,e.raw=Fzt.slice(t.start,t.end),t.regex&&("//"===e.raw&&(e.raw="/(?:)/"),e.regex=t.regex),e}function BBt(t,e,n){var r=new Tzt(Kzt);return r.computed="["===t,r.object=e,r.property=n,r.computed||(n.member=!0),r}function LBt(t,e,n){var r=new Tzt(Zzt);return r.key=e,r.value=n,r.kind=t,r}function PBt(t,e){var n,r=Array.prototype.slice.call(arguments,2),i=e.replace(/%(\d)/g,(function(t,e){return fBt(e<r.length,"Message reference must be in range"),r[e]}));throw(n=new Error(i)).index=Dzt,n.description=i,n}function jBt(t){t.type===Rzt&&PBt(t,iBt),t.type===Pzt&&PBt(t,tBt),t.type===Uzt&&PBt(t,eBt),t.type===zzt&&PBt(t,nBt),t.type===Bzt&&PBt(t,rBt),PBt(t,Jzt,t.value)}function UBt(t){var e=DBt();e.type===jzt&&e.value===t||jBt(e)}function WBt(t){return Mzt.type===jzt&&Mzt.value===t}function VBt(t){return Mzt.type===Bzt&&Mzt.value===t}function qBt(){var t=[];for(Dzt=Mzt.start,UBt("[");!WBt("]");)WBt(",")?(DBt(),t.push(null)):(t.push(nLt()),WBt("]")||UBt(","));return DBt(),function(t){var e=new Tzt(Wzt);return e.elements=t,e}(t)}function GBt(){var t;return Dzt=Mzt.start,(t=DBt()).type===Uzt||t.type===Pzt?(t.octal&&PBt(t,sBt),zBt(t)):RBt(t.value)}function HBt(){var t,e,n;return Dzt=Mzt.start,(t=Mzt).type===zzt?(n=GBt(),UBt(":"),LBt("init",n,nLt())):t.type!==Rzt&&t.type!==jzt?(e=GBt(),UBt(":"),LBt("init",e,nLt())):void jBt(t)}function YBt(){var t,e,n=[],r={},i=String;for(Dzt=Mzt.start,UBt("{");!WBt("}");)e="$"+((t=HBt()).key.type===Hzt?t.key.name:i(t.key.value)),Object.prototype.hasOwnProperty.call(r,e)?PBt({},cBt):r[e]=!0,n.push(t),WBt("}")||UBt(",");return UBt("}"),function(t){var e=new Tzt(Qzt);return e.properties=t,e}(n)}var XBt={if:1};function KBt(){var t,e,n;if(WBt("("))return function(){var t;return UBt("("),t=rLt(),UBt(")"),t}();if(WBt("["))return qBt();if(WBt("{"))return YBt();if(t=Mzt.type,Dzt=Mzt.start,t===zzt||XBt[Mzt.value])n=RBt(DBt().value);else if(t===Uzt||t===Pzt)Mzt.octal&&PBt(Mzt,sBt),n=zBt(DBt());else{if(t===Bzt)throw new Error(lBt);t===Ozt?((e=DBt()).value="true"===e.value,n=zBt(e)):t===Lzt?((e=DBt()).value=null,n=zBt(e)):WBt("/")||WBt("/=")?(n=zBt(NBt()),IBt()):jBt(DBt())}return n}function QBt(){var t=[];if(UBt("("),!WBt(")"))for(;Dzt<Izt&&(t.push(nLt()),!WBt(")"));)UBt(",");return UBt(")"),t}function ZBt(){var t;return Dzt=Mzt.start,function(t){return t.type===zzt||t.type===Bzt||t.type===Ozt||t.type===Lzt}(t=DBt())||jBt(t),RBt(t.value)}function $Bt(){var t;return UBt("["),t=rLt(),UBt("]"),t}function JBt(){var t=function(){var t;for(t=KBt();;)if(WBt("."))UBt("."),t=BBt(".",t,ZBt());else if(WBt("("))t=OBt(t,QBt());else{if(!WBt("["))break;t=BBt("[",t,$Bt())}return t}();if(Mzt.type===jzt&&(WBt("++")||WBt("--")))throw new Error(lBt);return t}function tLt(){var t,e;if(Mzt.type!==jzt&&Mzt.type!==Bzt)e=JBt();else{if(WBt("++")||WBt("--"))throw new Error(lBt);if(WBt("+")||WBt("-")||WBt("~")||WBt("!"))t=DBt(),e=tLt(),e=function(t,e){var n=new Tzt($zt);return n.operator=t,n.argument=e,n.prefix=!0,n}(t.value,e);else{if(VBt("delete")||VBt("void")||VBt("typeof"))throw new Error(lBt);e=JBt()}}return e}function eLt(t){var e=0;if(t.type!==jzt&&t.type!==Bzt)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function nLt(){var t,e;return t=function(){var t,e,n,r,i,a,o,s,c,u;if(t=Mzt,c=tLt(),0===(i=eLt(r=Mzt)))return c;for(r.prec=i,DBt(),e=[t,Mzt],a=[c,r,o=tLt()];(i=eLt(Mzt))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)o=a.pop(),s=a.pop().value,c=a.pop(),e.pop(),n=MBt(s,c,o),a.push(n);(r=DBt()).prec=i,a.push(r),e.push(Mzt),n=tLt(),a.push(n)}for(n=a[u=a.length-1],e.pop();u>1;)e.pop(),n=MBt(a[u-1].value,a[u-2],n),u-=2;return n}(),WBt("?")&&(DBt(),e=nLt(),UBt(":"),t=function(t,e,n){var r=new Tzt(Gzt);return r.test=t,r.consequent=e,r.alternate=n,r}(t,e,nLt())),t}function rLt(){var t=nLt();if(WBt(","))throw new Error(lBt);return t}function iLt(t,e,n){return t.fields=e||[],t.fname=n,t}function aLt(t){return 1===t.length?oLt(t[0]):sLt(t)}const oLt=t=>function(e){return e[t]},sLt=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function cLt(t){throw Error(t)}function uLt(t){const e=[],n=t.length;let r,i,a,o=null,s=0,c="";function u(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)c+=t.substring(r,i++),r=i;else if(a===o)u(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&u(),s=r=i+1):"]"===a&&(s||cLt("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&cLt("Access path missing closing bracket: "+t),o&&cLt("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function lLt(t,e,n){const r=uLt(t);return t=1===r.length?r[0]:t,iLt((n&&n.get||aLt)(r),[t],e||t)}lLt("id"),iLt((t=>t),[],"identity"),iLt((()=>0),[],"zero"),iLt((()=>1),[],"one"),iLt((()=>!0),[],"true"),iLt((()=>!1),[],"false");Array.isArray;Object.prototype.hasOwnProperty;function hLt(t){const e=[];return"Identifier"===t.type?[t.name]:"Literal"===t.type?[t.value]:("MemberExpression"===t.type&&(e.push(...hLt(t.object)),e.push(...hLt(t.property))),e)}function dLt(t){return"MemberExpression"===t.object.type?dLt(t.object):"datum"===t.object.name}function fLt(t){const e=function(t){Dzt=0,Izt=(Fzt=t).length,Mzt=null,IBt();var e=rLt();if(Mzt.type!==Rzt)throw new Error("Unexpect token after expression.");return e}(t),n=new Set;return e.visit((t=>{"MemberExpression"===t.type&&dLt(t)&&n.add(hLt(t).slice(1).join("."))})),n}class pLt extends NRt{constructor(t,e,n){super(t),this.model=e,this.filter=n,this.expr=vLt(this.model,this.filter,this),this._dependentFields=fLt(this.expr)}clone(){return new pLt(null,this.model,nSt(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return"Filter ".concat(this.expr)}}function gLt(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"datum";const i=[];const a=kSt(e,(function(e){const a=wSt(e),o=t.getSelectionComponent(a,e),s=UCt(a+hzt);if(o.project.timeUnit){const e=null!==n&&void 0!==n?n:t.component.data.raw,r=o.project.timeUnit.clone();e.parent?r.insertAsParentOf(e):e.parent=r}return"none"!==o.empty&&i.push(s),"vlSelectionTest(".concat(s,", ").concat(r)+("global"===o.resolve?")":", ".concat(UCt(o.resolve),")"))}));return(i.length?"!("+i.map((t=>"length(data(".concat(t,"))"))).join(" || ")+") || ":"")+"(".concat(a,")")}function mLt(t,e){const n=e.encoding;let r=e.field;if(n||r){if(n&&!r){const i=t.project.items.filter((t=>t.channel===n));!i.length||i.length>1?(r=t.project.items[0].field,XNt((i.length?"Multiple ":"No ")+"matching ".concat(UCt(n)," encoding found for selection ").concat(UCt(e.selection),". ")+'Using "field": '.concat(UCt(r),"."))):r=i[0].field}}else r=t.project.items[0].field,t.project.items.length>1&&XNt('A "field" or "encoding" must be specified when using a selection as a scale domain. '+'Using "field": '.concat(UCt(r),"."));return"".concat(t.name,"[").concat(UCt(r),"]")}function vLt(t,e,n){return kSt(e,(e=>jCt(e)?e:function(t){return null===t||void 0===t?void 0:t.selection}(e)?gLt(t,e.selection,n):SFt(e)))}function yLt(t,e,n,r){var i,a,o;t.encode=null!==(i=t.encode)&&void 0!==i?i:{},t.encode[e]=null!==(a=t.encode[e])&&void 0!==a?a:{},t.encode[e].update=null!==(o=t.encode[e].update)&&void 0!==o?o:{},t.encode[e].update[n]=r}function bLt(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{header:!1};var i,a;const o=t.combine(),{disable:s,orient:c,scale:u,labelExpr:l,title:h,zindex:d}=o,f=VCt(o,["disable","orient","scale","labelExpr","title","zindex"]);if(!s){for(const t in f){const n=LSt[t],r=f[t];if(n&&n!==e&&"both"!==n)delete f[t];else if(zSt(r)){const{condition:e}=r,n=VCt(r,["condition"]),i=RCt(e),a=RSt[t];if(a){const{vgProp:e,part:r}=a,o=[...i.map((t=>{const{test:e}=t,n=VCt(t,["test"]);return Object.assign({test:vLt(null,e)},n)})),n];yLt(f,r,e,o),delete f[t]}else if(null===a){const e={signal:i.map((t=>{const{test:e}=t,n=VCt(t,["test"]);return"".concat(vLt(null,e)," ? ").concat(NIt(n)," : ")})).join("")+NIt(n)};f[t]=e}}else if(hFt(r)){const e=RSt[t];if(e){const{vgProp:n,part:i}=e;yLt(f,i,n,r),delete f[t]}}}if("grid"===e){if(!f.grid)return;if(f.encode){const{grid:t}=f.encode;f.encode=Object.assign({},t?{grid:t}:{}),mSt(f.encode)&&delete f.encode}return Object.assign(Object.assign({scale:u,orient:c},f),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:DSt(d,0)})}{if(!r.header&&t.mainExtracted)return;if(void 0!==l){let t=l;(null===(a=null===(i=f.encode)||void 0===i?void 0:i.labels)||void 0===a?void 0:a.update)&&hFt(f.encode.labels.update.text)&&(t=TSt(l,"datum.label",f.encode.labels.update.text.signal)),yLt(f,"labels","text",{signal:t})}if(null===f.labelAlign&&delete f.labelAlign,f.encode){for(const e of BSt)t.hasAxisPart(e)||delete f.encode[e];mSt(f.encode)&&delete f.encode}const e=function(t,e){if(t)return NCt(t)&&!EIt(t)?t.map((t=>fIt(t,e))).join(", "):t}(h,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:u,orient:c,grid:!1},e?{title:e}:{}),f),!1===n.aria?{aria:!1}:{}),{zindex:DSt(d,0)})}}}function xLt(t){const{axes:e}=t.component,n=[];for(const r of VTt)if(e[r])for(const i of e[r])if(!i.get("disable")&&!i.get("gridScale")){const e="x"===r?"height":"width",i=t.getSizeSignalRef(e).signal;e!==i&&n.push({name:e,update:i})}return n}const wLt={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},kLt={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},_Lt=vSt(wLt),ALt=vSt(kLt);function CLt(t,e,n,r){return Object.assign.apply(null,[{},...t.map((t=>{if("axisOrient"===t){const t="x"===n?"bottom":"left",i=e["x"===n?"axisBottom":"axisLeft"]||{},a=e["x"===n?"axisTop":"axisRight"]||{},o=new Set([...vSt(i),...vSt(a)]),s={};for(const e of o.values())s[e]={signal:"".concat(r.signal,' === "').concat(t,'" ? ').concat(FIt(i[e])," : ").concat(FIt(a[e]))};return s}return e[t]}))])}function SLt(t,e,n,r){const i="band"===e?["axisDiscrete","axisBand"]:"point"===e?["axisDiscrete","axisPoint"]:function(t){return t in qFt}(e)?["axisQuantitative"]:"time"===e||"utc"===e?["axisTemporal"]:[],a="x"===t?"axisX":"axisY",o=hFt(n)?"axisOrient":"axis"+ASt(n),s=[...i,...i.map((t=>a+t.substr(4)))],c=["axis",o,a];return{vlOnlyAxisConfig:CLt(s,r,t,n),vgAxisConfig:CLt(c,r,t,n),axisConfigStyle:ELt([...c,...s],r)}}function ELt(t,e){var n;const r=[{}];for(const i of t){let t=null===(n=e[i])||void 0===n?void 0:n.style;if(t){t=RCt(t);for(const n of t)r.push(e.style[n])}}return Object.assign.apply(null,r)}function TLt(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const a=RIt(t,n,e.style);if(void 0!==a)return{configFrom:"style",configValue:a};for(const o of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(void 0!==(null===(i=r[o])||void 0===i?void 0:i[t]))return{configFrom:o,configValue:r[o][t]};return{}}const NLt={scale:t=>{let{model:e,channel:n}=t;return e.scaleName(n)},format:t=>{let{fieldOrDatumDef:e,config:n,axis:r}=t;const{format:i,formatType:a}=r;return CDt(e,e.type,i,a,n,!0)},formatType:t=>{let{axis:e,fieldOrDatumDef:n,scaleType:r}=t;const{formatType:i}=e;return SDt(i,n,r)},grid:t=>{let{fieldOrDatumDef:e,axis:n,scaleType:r}=t;var i;return(!YDt(e)||!pNt(e.bin))&&(null!==(i=n.grid)&&void 0!==i?i:function(t,e){return!XFt(t)&&YDt(e)&&!fNt(null===e||void 0===e?void 0:e.bin)}(r,e))},gridScale:t=>{let{model:e,channel:n}=t;return function(t,e){const n="x"===e?"y":"x";if(t.getScaleComponent(n))return t.scaleName(n);return}(e,n)},labelAlign:t=>{let{axis:e,labelAngle:n,orient:r,channel:i}=t;return e.labelAlign||ILt(n,r,i)},labelAngle:t=>{let{labelAngle:e}=t;return e},labelBaseline:t=>{let{axis:e,labelAngle:n,orient:r,channel:i}=t;return e.labelBaseline||DLt(n,r,i)},labelFlush:t=>{let{axis:e,fieldOrDatumDef:n,channel:r}=t;var i;return null!==(i=e.labelFlush)&&void 0!==i?i:function(t,e){if("x"===e&&cSt(["quantitative","temporal"],t))return!0;return}(n.type,r)},labelOverlap:t=>{let{axis:e,fieldOrDatumDef:n,scaleType:r}=t;var i;return null!==(i=e.labelOverlap)&&void 0!==i?i:function(t,e){if("nominal"!==t)return"log"!==e||"greedy";return}(n.type,r)},orient:t=>{let{orient:e}=t;return e},tickCount:t=>{let{channel:e,model:n,axis:r,fieldOrDatumDef:i,scaleType:a}=t;var o;const s="x"===e?"width":"y"===e?"height":void 0,c=s?n.getSizeSignalRef(s):void 0;return null!==(o=r.tickCount)&&void 0!==o?o:function(t){let{fieldOrDatumDef:e,scaleType:n,size:r,values:i}=t;var a;if(!i&&!XFt(n)&&"log"!==n){if(YDt(e)){if(fNt(e.bin))return{signal:"ceil(".concat(r.signal,"/10)")};if(e.timeUnit&&cSt(["month","hours","day","quarter"],null===(a=lFt(e.timeUnit))||void 0===a?void 0:a.unit))return}return{signal:"ceil(".concat(r.signal,"/40)")}}return}({fieldOrDatumDef:i,scaleType:a,size:c,values:r.values})},title:t=>{let{axis:e,model:n,channel:r}=t;if(void 0!==e.title)return e.title;const i=MLt(n,r);if(void 0!==i)return i;const a=n.typedFieldDef(r),o="x"===r?"x2":"y2",s=n.fieldDef(o);return BIt(a?[jDt(a)]:[],YDt(s)?[jDt(s)]:[])},values:t=>{let{axis:e,fieldOrDatumDef:n}=t;return function(t,e){const n=t.values;if(NCt(n))return AIt(e,n);if(hFt(n))return n;return}(e,n)},zindex:t=>{let{axis:e,fieldOrDatumDef:n,mark:r}=t;var i;return null!==(i=e.zindex)&&void 0!==i?i:function(t,e){if("rect"===t&&oIt(e))return 1;return 0}(r,n)}};function FLt(t){return"(((".concat(t.signal," % 360) + 360) % 360)")}function DLt(t,e,n,r){if(void 0!==t){if("x"===n){if(hFt(t)){const n=FLt(t),r=hFt(e)?"(".concat(e.signal,' === "top")'):"top"===e;return{signal:"(45 < ".concat(n," && ").concat(n," < 135) || (225 < ").concat(n," && ").concat(n,' < 315) ? "middle" :')+"(".concat(n," <= 45 || 315 <= ").concat(n,") === ").concat(r,' ? "bottom" : "top"')}}if(45<t&&t<135||225<t&&t<315)return"middle";if(hFt(e)){const n=t<=45||315<=t?"===":"!==";return{signal:"".concat(e.signal," ").concat(n,' "top" ? "bottom" : "top"')}}return(t<=45||315<=t)===("top"===e)?"bottom":"top"}if(hFt(t)){const n=FLt(t),i=hFt(e)?"(".concat(e.signal,' === "left")'):"left"===e,a=r?'"middle"':"null";return{signal:"".concat(n," <= 45 || 315 <= ").concat(n," || (135 <= ").concat(n," && ").concat(n," <= 225) ? ").concat(a," : (45 <= ").concat(n," && ").concat(n," <= 135) === ").concat(i,' ? "top" : "bottom"')}}if(t<=45||315<=t||135<=t&&t<=225)return r?"middle":null;if(hFt(e)){const n=45<=t&&t<=135?"===":"!==";return{signal:"".concat(e.signal," ").concat(n,' "left" ? "top" : "bottom"')}}return(45<=t&&t<=135)===("left"===e)?"top":"bottom"}}function ILt(t,e,n){if(void 0===t)return;const r="x"===n,i=r?0:90,a=r?"bottom":"left";if(hFt(t)){const n=FLt(t),o=hFt(e)?"(".concat(e.signal,' === "').concat(a,'")'):e===a;return{signal:"(".concat(i?"("+n+" + 90)":n," % 180 === 0) ? ").concat(r?null:'"center"'," :")+"(".concat(i," < ").concat(n," && ").concat(n," < ").concat(180+i,") === ").concat(o,' ? "left" : "right"')}}if((t+i)%180===0)return r?null:"center";if(hFt(e)){const n=i<t&&t<180+i?"===":"!==",r="".concat(e.signal," ").concat(n,' "').concat(a,'"');return{signal:"".concat(r,' ? "left" : "right"')}}return(i<t&&t<180+i)===(e===a)?"left":"right"}function MLt(t,e){const n="x"===e?"x2":"y2",r=t.fieldDef(e),i=t.fieldDef(n),a=r?r.title:void 0,o=i?i.title:void 0;return a&&o?LIt(a,o):a||(o||(void 0!==a?a:void 0!==o?o:void 0))}class OLt extends NRt{constructor(t,e){super(t),this.transform=e,this._dependentFields=fLt(this.transform.calculate)}clone(){return new OLt(null,nSt(this.transform))}static parseAllForSortIndex(t,e){return e.forEachFieldDef(((e,n)=>{if(eIt(e)&&zDt(e.sort)){const{field:r,timeUnit:i}=e,a=e.sort,o=a.map(((t,e)=>"".concat(SFt({field:r,timeUnit:i,equal:t})," ? ").concat(e," : "))).join("")+a.length;t=new OLt(t,{calculate:o,as:RLt(e,n,{forAs:!0})})}})),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return"Calculate ".concat(oSt(this.transform))}}function RLt(t,e,n){return aIt(t,Object.assign({prefix:e,suffix:"sort_index"},null!==n&&void 0!==n?n:{}))}function zLt(t,e){return cSt(["top","bottom"],e)?"column":cSt(["left","right"],e)||"row"===t?"row":"column"}function BLt(t,e,n,r){const i="row"===r?n.headerRow:"column"===r?n.headerColumn:n.headerFacet;return DSt(((null===e||void 0===e?void 0:e.header)||{})[t],i[t],n.header[t])}function LLt(t,e,n,r){const i={};for(const a of t){const t=BLt(a,e,n,r);void 0!==t&&(i[a]=t)}return i}const PLt=["row","column"],jLt=["header","footer"];function ULt(t,e){const n=t.component.layoutHeaders[e].title,r=t.config?t.config:void 0,i=t.component.layoutHeaders[e].facetFieldDef?t.component.layoutHeaders[e].facetFieldDef:void 0,{titleAnchor:a,titleAngle:o,titleOrient:s}=LLt(["titleAnchor","titleAngle","titleOrient"],i,r,e),c=zLt(e,s),u=MSt(o);return{name:"".concat(e,"-title"),type:"group",role:"".concat(c,"-title"),title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},"row"===e?{orient:"left"}:{}),{style:"guide-title"}),VLt(u,c)),WLt(c,u,a)),QLt(r,i,e,_Lt,wLt))}}function WLt(t,e){switch(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"middle"){case"start":return{align:"left"};case"end":return{align:"right"}}const n=ILt(e,"row"===t?"left":"top","row"===t?"y":"x");return n?{align:n}:{}}function VLt(t,e){const n=DLt(t,"row"===e?"left":"top","row"===e?"y":"x",!0);return n?{baseline:n}:{}}function qLt(t,e){const n=t.component.layoutHeaders[e],r=[];for(const i of jLt)if(n[i])for(const a of n[i]){const o=YLt(t,e,i,n,a);null!=o&&r.push(o)}return r}function GLt(t,e){var n;const{sort:r}=t;return RDt(r)?{field:aIt(r,{expr:"datum"}),order:null!==(n=r.order)&&void 0!==n?n:"ascending"}:NCt(r)?{field:RLt(t,e,{expr:"datum"}),order:"ascending"}:{field:aIt(t,{expr:"datum"}),order:null!==r&&void 0!==r?r:"ascending"}}function HLt(t,e,n){const{format:r,formatType:i,labelAngle:a,labelAnchor:o,labelOrient:s,labelExpr:c}=LLt(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],t,n,e),u=kDt({fieldOrDatumDef:t,format:r,formatType:i,expr:"parent",config:n}).signal,l=zLt(e,s);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:c?TSt(TSt(c,"datum.label",u),"datum.value",aIt(t,{expr:"parent"})):u}},"row"===e?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),VLt(a,l)),WLt(l,a,o)),QLt(n,t,e,ALt,kLt))}function YLt(t,e,n,r,i){if(i){let a=null;const{facetFieldDef:o}=r,s=t.config?t.config:void 0;if(o&&i.labels){const{labelOrient:t}=LLt(["labelOrient"],o,s,e);("row"===e&&!cSt(["top","bottom"],t)||"column"===e&&!cSt(["left","right"],t))&&(a=HLt(o,e,s))}const c=Kjt(t)&&!BDt(t.facet),u=i.axes,l=(null===u||void 0===u?void 0:u.length)>0;if(a||l){const s="row"===e?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:t.getName("".concat(e,"_").concat(n)),type:"group",role:"".concat(e,"-").concat(n)},r.facetFieldDef?{from:{data:t.getName(e+"_domain")},sort:GLt(o,e)}:{}),l&&c?{from:{data:t.getName("facet_domain_".concat(e))}}:{}),a?{title:a}:{}),i.sizeSignal?{encode:{update:{[s]:i.sizeSignal}}}:{}),l?{axes:u}:{})}}return null}const XLt={column:{start:0,end:1},row:{start:1,end:0}};function KLt(t,e){return XLt[e][t]}function QLt(t,e,n,r,i){const a={};for(const o of r){if(!i[o])continue;const r=BLt(o,e,t,n);void 0!==r&&(a[i[o]]=r)}return a}function ZLt(t){return[...$Lt(t,"width"),...$Lt(t,"height"),...$Lt(t,"childWidth"),...$Lt(t,"childHeight")]}function $Lt(t,e){const n="width"===e?"x":"y",r=t.component.layoutSize.get(e);if(!r||"merged"===r)return[];const i=t.getSizeSignalRef(e).signal;if("step"===r){const e=t.getScaleComponent(n);if(e){const r=e.get("type"),a=e.get("range");if(XFt(r)&&dFt(a)){const r=t.scaleName(n);if(Kjt(t.parent)){if("independent"===t.parent.component.resolve.scale[n])return[JLt(r,a)]}return[JLt(r,a),{name:i,update:tPt(r,e,"domain('".concat(r,"').length"))}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==r){const e=i.endsWith("width"),n=e?"containerSize()[0]":"containerSize()[1]",r=DMt(t.config.view,e?"width":"height"),a="isFinite(".concat(n,") ? ").concat(n," : ").concat(r);return[{name:i,init:a,on:[{update:a,events:"window:resize"}]}]}return[{name:i,value:r}]}function JLt(t,e){return{name:t+"_step",value:e.step}}function tPt(t,e,n){const r=e.get("type"),i=e.get("padding"),a=DSt(e.get("paddingOuter"),i);let o=e.get("paddingInner");return o="band"===r?void 0!==o?o:i:1,"bandspace(".concat(n,", ").concat(o,", ").concat(a,") * ").concat(t,"_step")}function ePt(t){return"childWidth"===t?"width":"childHeight"===t?"height":t}function nPt(t,e){return vSt(t).reduce(((n,r)=>{const i=t[r];return Object.assign(Object.assign({},n),JOt(e,i,r,(t=>hFt(t)?t:{value:t.value})))}),{})}function rPt(t,e){if(Zjt(e)||Kjt(e))return"shared";if(Qjt(e))return qTt(t)?"independent":"shared";throw new Error("invalid model type for resolve")}function iPt(t,e){const n=t.scale[e],r=qTt(e)?"axis":"legend";return"independent"===n?("shared"===t[r][e]&&XNt(function(t){return'Setting the scale to be independent for "'.concat(t,'" means we also have to set the guide (axis or legend) to be independent.')}(e)),"independent"):t[r][e]||"shared"}const aPt=Object.assign(Object.assign({},xMt),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),oPt=vSt(aPt);class sPt extends bOt{}const cPt={symbols:function(t,e){let{fieldOrDatumDef:n,model:r,channel:i,legendCmpt:a,legendType:o}=e;var s,c,u,l,h;if("symbol"!==o)return;const{markDef:d,encoding:f,config:p,mark:g}=r,m=d.filled&&"trail"!==g;let v=Object.assign(Object.assign({},function(t,e,n){for(const r of n){const n=MIt(r,e.markDef,e.config);void 0!==n&&(t[r]=TIt(n))}return t}({},r,sEt)),sRt(r,{filled:m}));const y=null!==(s=uPt(f.opacity))&&void 0!==s?s:d.opacity;if(v.fill)if("fill"===i||m&&i===LEt)delete v.fill;else if(v.fill.field)a.get("symbolFillColor")?delete v.fill:(v.fill=TIt(null!==(c=p.legend.symbolBaseFillColor)&&void 0!==c?c:"black"),v.fillOpacity=TIt(null!==y&&void 0!==y?y:1));else if(NCt(v.fill)){const t=null!==(h=null!==(l=lPt(null!==(u=f.fill)&&void 0!==u?u:f.color))&&void 0!==l?l:d.fill)&&void 0!==h?h:m&&d.color;t&&(v.fill=TIt(t))}if(v.stroke)if("stroke"===i||!m&&i===LEt)delete v.stroke;else if(v.stroke.field)delete v.stroke;else if(NCt(v.stroke)){const t=DSt(lPt(f.stroke||f.color),d.stroke,m?d.color:void 0);t&&(v.stroke={value:t})}if(i!==qEt){const t=YDt(n)&&dPt(r,a,n);t?v.opacity=[Object.assign({test:t},TIt(null!==y&&void 0!==y?y:1)),TIt(p.legend.unselectedOpacity)]:y&&(v.opacity=TIt(y))}return v=Object.assign(Object.assign({},v),t),mSt(v)?void 0:v},gradient:function(t,e){let{model:n,legendType:r}=e;if("gradient"!==r)return;let i={};const a=uPt(n.encoding.opacity)||n.markDef.opacity;a&&(i.opacity=TIt(a));return i=Object.assign(Object.assign({},i),t),mSt(i)?void 0:i},labels:function(t,e){let{fieldOrDatumDef:n,model:r,channel:i,legendCmpt:a}=e;const o=r.legend(i)||{},s=r.config,c=YDt(n)?dPt(r,a,n):void 0,u=c?[{test:c,value:1},{value:s.legend.unselectedOpacity}]:void 0,{format:l,formatType:h}=o,d=bDt(h)?ADt({fieldOrDatumDef:n,field:"datum.value",format:l,formatType:h,config:s}):void 0,f=Object.assign(Object.assign(Object.assign({},u?{opacity:u}:{}),d?{text:d}:{}),t);return mSt(f)?void 0:f},entries:function(t,e){let{legendCmpt:n}=e;const r=n.get("selections");return(null===r||void 0===r?void 0:r.length)?Object.assign(Object.assign({},t),{fill:{value:"transparent"}}):t}};function uPt(t){return hPt(t,((t,e)=>Math.max(t,e.value)))}function lPt(t){return hPt(t,((t,e)=>DSt(t,e.value)))}function hPt(t,e){return function(t){const e=t&&t.condition;return!!e&&(NCt(e)||tIt(e))}(t)?RCt(t.condition).reduce(e,t.value):tIt(t)?t.value:void 0}function dPt(t,e,n){const r=e.get("selections");if(!(null===r||void 0===r?void 0:r.length))return;const i=UCt(n.field);return r.map((t=>{const e=UCt(wSt(t)+hzt);return"(!length(data(".concat(e,")) || (").concat(t,"[").concat(i,"] && indexof(").concat(t,"[").concat(i,"], datum.value) >= 0))")})).join(" || ")}const fPt={direction:t=>{let{direction:e}=t;return e},format:t=>{let{fieldOrDatumDef:e,legend:n,config:r}=t;const{format:i,formatType:a}=n;return CDt(e,e.type,i,a,r,!1)},formatType:t=>{let{legend:e,fieldOrDatumDef:n,scaleType:r}=t;const{formatType:i}=e;return SDt(i,n,r)},gradientLength:t=>{var e,n;const{legend:r,legendConfig:i}=t;return null!==(n=null!==(e=r.gradientLength)&&void 0!==e?e:i.gradientLength)&&void 0!==n?n:function(t){let{legendConfig:e,model:n,direction:r,orient:i,scaleType:a}=t;const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:s,gradientVerticalMaxLength:c,gradientVerticalMinLength:u}=e;if(QFt(a))return"horizontal"===r?"top"===i||"bottom"===i?mPt(n,"width",s,o):s:mPt(n,"height",u,c);return}(t)},labelOverlap:t=>{let{legend:e,legendConfig:n,scaleType:r}=t;var i,a;return null!==(a=null!==(i=e.labelOverlap)&&void 0!==i?i:n.labelOverlap)&&void 0!==a?a:function(t){if(cSt(["quantile","threshold","log"],t))return"greedy";return}(r)},symbolType:t=>{let{legend:e,markDef:n,channel:r,encoding:i}=t;var a;return null!==(a=e.symbolType)&&void 0!==a?a:function(t,e,n,r){var i;if("shape"!==e){const t=null!==(i=lPt(n))&&void 0!==i?i:r;if(t)return t}switch(t){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(n.type,r,i.shape,n.shape)},title:t=>{let{fieldOrDatumDef:e,config:n}=t;return hIt(e,n,{allowDisabling:!0})},type:t=>{let{legendType:e,scaleType:n,channel:r}=t;if(cTt(r)&&QFt(n)){if("gradient"===e)return}else if("symbol"===e)return;return e},values:t=>{let{fieldOrDatumDef:e,legend:n}=t;return function(t,e){const n=t.values;if(NCt(n))return AIt(e,n);if(hFt(n))return n;return}(n,e)}};function pPt(t){const{legend:e}=t;return DSt(e.type,function(t){let{channel:e,timeUnit:n,scaleType:r}=t;if(cTt(e)){if(cSt(["quarter","month","day"],n))return"symbol";if(QFt(r))return"gradient"}return"symbol"}(t))}function gPt(t){let{legendConfig:e,legendType:n,orient:r,legend:i}=t;var a,o;return null!==(o=null!==(a=i.direction)&&void 0!==a?a:e[n?"gradientDirection":"symbolDirection"])&&void 0!==o?o:function(t,e){switch(t){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===e?"horizontal":void 0}}(r,n)}function mPt(t,e,n,r){const i=t.getSizeSignalRef(e).signal;return{signal:"clamp(".concat(i,", ").concat(n,", ").concat(r,")")}}function vPt(t){const e=Xjt(t)?function(t){const{encoding:e}=t,n={};for(const r of[LEt,...yMt]){const i=mIt(e[r]);i&&t.getScaleComponent(r)&&(r===UEt&&YDt(i)&&i.type===OFt||(n[r]=bPt(t,r)))}return n}(t):function(t){const{legends:e,resolve:n}=t.component;for(const r of t.children){vPt(r);for(const i of vSt(r.component.legends))n.legend[i]=iPt(t.component.resolve,i),"shared"===n.legend[i]&&(e[i]=xPt(e[i],r.component.legends[i]),e[i]||(n.legend[i]="independent",delete e[i]))}for(const r of vSt(e))for(const e of t.children)e.component.legends[r]&&"shared"===n.legend[r]&&delete e.component.legends[r];return e}(t);return t.component.legends=e,e}function yPt(t,e,n,r){switch(e){case"disable":return void 0!==n;case"values":return!!(null===n||void 0===n?void 0:n.values);case"title":if("title"===e&&t===(null===r||void 0===r?void 0:r.title))return!0}return t===(n||{})[e]}function bPt(t,e){var n,r,i;let a=t.legend(e);const{markDef:o,encoding:s,config:c}=t,u=c.legend,l=new sPt({},function(t,e){const n=t.scaleName(e);if("trail"===t.mark){if("color"===e)return{stroke:n};if("size"===e)return{strokeWidth:n}}return"color"===e?t.markDef.filled?{fill:n}:{stroke:n}:{[e]:n}}(t,e));!function(t,e,n){var r;const i=null===(r=t.fieldDef(e))||void 0===r?void 0:r.field;mzt(t,(t=>{var r,a;const o=null!==(r=t.project.hasField[i])&&void 0!==r?r:t.project.hasChannel[e];if(o&&qRt.has(t)){const e=null!==(a=n.get("selections"))&&void 0!==a?a:[];e.push(t.name),n.set("selections",e,!1),o.hasLegend=!0}}))}(t,e,l);const h=void 0!==a?!a:u.disable;if(l.set("disable",h,void 0!==a),h)return l;a=a||{};const d=t.getScaleComponent(e).get("type"),f=mIt(s[e]),p=YDt(f)?null===(n=lFt(f.timeUnit))||void 0===n?void 0:n.unit:void 0,g=a.orient||c.legend.orient||"right",m=pPt({legend:a,channel:e,timeUnit:p,scaleType:d}),v={legend:a,channel:e,model:t,markDef:o,encoding:s,fieldOrDatumDef:f,legendConfig:u,config:c,scaleType:d,orient:g,legendType:m,direction:gPt({legend:a,legendType:m,orient:g,legendConfig:u})};for(const k of oPt){const n=k in fPt?fPt[k](v):a[k];if(void 0!==n){const r=yPt(n,k,a,t.fieldDef(e));(r||void 0===c.legend[k])&&l.set(k,n,r)}}const y=null!==(r=null===a||void 0===a?void 0:a.encoding)&&void 0!==r?r:{},b=l.get("selections"),x={},w={fieldOrDatumDef:f,model:t,channel:e,legendCmpt:l,legendType:m};for(const k of["labels","legend","title","symbols","gradient","entries"]){const e=nPt(null!==(i=y[k])&&void 0!==i?i:{},t),n=k in cPt?cPt[k](e,w):e;void 0===n||mSt(n)||(x[k]=Object.assign(Object.assign(Object.assign({},(null===b||void 0===b?void 0:b.length)&&YDt(f)?{name:"".concat(wSt(f.field),"_legend_").concat(k)}:{}),(null===b||void 0===b?void 0:b.length)?{interactive:!!b}:{}),{update:n}))}return mSt(x)||l.set("encode",x,!!(null===a||void 0===a?void 0:a.encoding)),l}function xPt(t,e){var n,r,i,a;if(!t)return e.clone();const o=t.getWithExplicit("orient"),s=e.getWithExplicit("orient");if(o.explicit&&s.explicit&&o.value!==s.value)return;let c=!1;for(const u of oPt){const n=AOt(t.getWithExplicit(u),e.getWithExplicit(u),u,"legend",((t,e)=>{switch(u){case"symbolType":return wPt(t,e);case"title":return PIt(t,e);case"type":return c=!0,wOt("symbol")}return _Ot(t,e,u,"legend")}));t.setWithExplicit(u,n)}return c&&((null===(r=null===(n=t.implicit)||void 0===n?void 0:n.encode)||void 0===r?void 0:r.gradient)&&_St(t.implicit,["encode","gradient"]),(null===(a=null===(i=t.explicit)||void 0===i?void 0:i.encode)||void 0===a?void 0:a.gradient)&&_St(t.explicit,["encode","gradient"])),t}function wPt(t,e){return"circle"===e.value?e:t}function kPt(t,e,n,r){var i,a,o;t.encode=null!==(i=t.encode)&&void 0!==i?i:{},t.encode[e]=null!==(a=t.encode[e])&&void 0!==a?a:{},t.encode[e].update=null!==(o=t.encode[e].update)&&void 0!==o?o:{},t.encode[e].update[n]=r}function _Pt(t){const e=t.component.legends,n={};for(const i of vSt(e)){const r=t.getScaleComponent(i),a=aSt(r.get("domains"));if(n[a])for(const t of n[a]){xPt(t,e[i])||n[a].push(e[i])}else n[a]=[e[i].clone()]}const r=ySt(n).flat().map((e=>function(t,e){var n,r,i;const a=t.combine(),{disable:o,labelExpr:s,selections:c}=a,u=VCt(a,["disable","labelExpr","selections"]);if(o)return;!1===e.aria&&void 0==u.aria&&(u.aria=!1);if(null===(n=u.encode)||void 0===n?void 0:n.symbols){const t=u.encode.symbols.update;!t.fill||"transparent"===t.fill.value||t.stroke||u.stroke||(t.stroke={value:"transparent"});for(const e of yMt)u[e]&&delete t[e]}u.title||delete u.title;if(void 0!==s){let t=s;(null===(i=null===(r=u.encode)||void 0===r?void 0:r.labels)||void 0===i?void 0:i.update)&&hFt(u.encode.labels.update.text)&&(t=TSt(s,"datum.label",u.encode.labels.update.text.signal)),kPt(u,"labels","text",{signal:t})}for(const l in u){const t=u[l];if(hFt(t)){const e=bMt[l];if(e){const{vgProp:n,part:r}=e;kPt(u,r,n,t),delete u[l]}}}return u}(e,t.config))).filter((t=>void 0!==t));return r}function APt(t){return Zjt(t)||Qjt(t)?function(t){return t.children.reduce(((t,e)=>t.concat(e.assembleProjections())),CPt(t))}(t):CPt(t)}function CPt(t){const e=t.component.projection;if(!e||e.merged)return[];const n=e.combine(),{name:r}=n;if(e.data){const i={signal:"[".concat(e.size.map((t=>t.signal)).join(", "),"]")},a=e.data.reduce(((e,n)=>{const r=hFt(n)?n.signal:"data('".concat(t.lookupDataSource(n),"')");return cSt(e,r)||e.push(r),e}),[]);if(a.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:i,fit:{signal:a.length>1?"[".concat(a.join(", "),"]"):a[0]}},n)]}return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const SPt=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class EPt extends bOt{constructor(t,e,n,r){super(Object.assign({},e),{name:t}),this.specifiedProjection=e,this.size=n,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function TPt(t){t.component.projection=Xjt(t)?function(t){var e;if(t.hasProjection){const n=t.specifiedProjection,r=!(n&&(null!=n.scale||null!=n.translate)),i=r?[t.getSizeSignalRef("width"),t.getSizeSignalRef("height")]:void 0,a=r?function(t){const e=[],{encoding:n}=t;for(const r of[[REt,OEt],[BEt,zEt]])(mIt(n[r[0]])||mIt(n[r[1]]))&&e.push({signal:t.getName("geojson_".concat(e.length))});t.channelHasField(UEt)&&t.typedFieldDef(UEt).type===OFt&&e.push({signal:t.getName("geojson_".concat(e.length))});0===e.length&&e.push(t.requestDataName(MOt));return e}(t):void 0;return new EPt(t.projectionName(!0),Object.assign(Object.assign({},null!==(e=t.config.projection)&&void 0!==e?e:{}),null!==n&&void 0!==n?n:{}),i,a)}return}(t):function(t){if(0===t.children.length)return;let e;for(const r of t.children)TPt(r);const n=lSt(t.children,(t=>{const n=t.component.projection;if(n){if(e){const t=function(t,e){const n=lSt(SPt,(n=>!BCt(t.explicit,n)&&!BCt(e.explicit,n)||!(!BCt(t.explicit,n)||!BCt(e.explicit,n)||aSt(t.get(n))!==aSt(e.get(n))))),r=aSt(t.size)===aSt(e.size);if(r){if(n)return t;if(aSt(t.explicit)===aSt({}))return e;if(aSt(e.explicit)===aSt({}))return t}return null}(e,n);return t&&(e=t),!!t}return e=n,!0}return!0}));if(e&&n){const n=t.projectionName(!0),r=new EPt(n,e.specifiedProjection,e.size,nSt(e.data));for(const e of t.children){const t=e.component.projection;t&&(t.isFit&&r.data.push(...e.component.projection.data),e.renameProjection(t.get("name"),n),t.merged=!0)}return r}return}(t)}function NPt(t,e){return"".concat(dNt(t),"_").concat(e)}function FPt(t,e,n){var r;const i=NPt(null!==(r=xIt(n,void 0))&&void 0!==r?r:{},e);return t.getName("".concat(i,"_bins"))}function DPt(t,e,n){let r,i;r=function(t){return"as"in t}(t)?jCt(t.as)?[t.as,"".concat(t.as,"_end")]:[t.as[0],t.as[1]]:[aIt(t,{forAs:!0}),aIt(t,{binSuffix:"end",forAs:!0})];const a=Object.assign({},xIt(e,void 0)),o=NPt(a,t.field),{signal:s,extentSignal:c}=function(t,e){return{signal:t.getName("".concat(e,"_bins")),extentSignal:t.getName("".concat(e,"_extent"))}}(n,o);if(mNt(a.extent)){const t=a.extent,e=t.selection;i=mLt(n.getSelectionComponent(wSt(e),e),t),delete a.extent}return{key:o,binComponent:Object.assign(Object.assign(Object.assign({bin:a,field:t.field,as:[r]},s?{signal:s}:{}),c?{extentSignal:c}:{}),i?{span:i}:{})}}class IPt extends NRt{constructor(t,e){super(t),this.bins=e}clone(){return new IPt(null,nSt(this.bins))}static makeFromEncoding(t,e){const n=e.reduceFieldDef(((t,n,r)=>{if(JDt(n)&&fNt(n.bin)){const{key:i,binComponent:a}=DPt(n,n.bin,e);t[i]=Object.assign(Object.assign(Object.assign({},a),t[i]),function(t,e,n,r){var i,a;if(CIt(e,n)){const o=Xjt(t)&&null!==(a=null!==(i=t.axis(n))&&void 0!==i?i:t.legend(n))&&void 0!==a?a:{},s=aIt(e,{expr:"datum"}),c=aIt(e,{expr:"datum",binSuffix:"end"});return{formulaAs:aIt(e,{binSuffix:"range",forAs:!0}),formula:FDt(s,c,o.format,o.formatType,r)}}return{}}(e,n,r,e.config))}return t}),{});return mSt(n)?null:new IPt(t,n)}static makeFromTransform(t,e,n){const{key:r,binComponent:i}=DPt(e,e.bin,n);return new IPt(t,{[r]:i})}merge(t,e){for(const n of vSt(t.bins))n in this.bins?(e(t.bins[n].signal,this.bins[n].signal),this.bins[n].as=dSt([...this.bins[n].as,...t.bins[n].as],oSt)):this.bins[n]=t.bins[n];for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}producedFields(){return new Set(ySt(this.bins).map((t=>t.as)).flat(2))}dependentFields(){return new Set(ySt(this.bins).map((t=>t.field)))}hash(){return"Bin ".concat(oSt(this.bins))}assemble(){return ySt(this.bins).flatMap((t=>{const e=[],[n,...r]=t.as,i=t.bin,{extent:a}=i,o=VCt(i,["extent"]),s=Object.assign(Object.assign(Object.assign({type:"bin",field:ESt(t.field),as:n,signal:t.signal},mNt(a)?{extent:null}:{extent:a}),t.span?{span:{signal:"span(".concat(t.span,")")}}:{}),o);!a&&t.extentSignal&&(e.push({type:"extent",field:ESt(t.field),signal:t.extentSignal}),s.extent={signal:t.extentSignal}),e.push(s);for(const c of r)for(let t=0;t<2;t++)e.push({type:"formula",expr:aIt({field:n[t]},{expr:"datum"}),as:c[t]});return t.formula&&e.push({type:"formula",expr:t.formula,as:t.formulaAs}),e}))}}class MPt extends NRt{constructor(t){let e;if(super(null),NOt(t=null!==t&&void 0!==t?t:{name:"source"})||(e=t.format?Object.assign({},iSt(t.format,["parse"])):{}),EOt(t))this._data={values:t.values};else if(SOt(t)){if(this._data={url:t.url},!e.type){let n=/(?:\.([^.]+))?$/.exec(t.url)[1];cSt(["json","csv","tsv","dsv","topojson"],n)||(n="json"),e.type=n}}else DOt(t)?this._data={values:[{type:"Sphere"}]}:(TOt(t)||NOt(t))&&(this._data={});this._generator=NOt(t),t.name&&(this._name=t.name),e&&!mSt(e)&&(this._data.format=e)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}function OPt(t){for(const e of t){for(const t of e.children)if(t.parent!==e)return console.error("Dataflow graph is inconsistent.",e,t),!1;if(!OPt(e.children))return!1}return!0}class RPt extends NRt{constructor(t,e){super(t),this.params=e}clone(){return new RPt(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return"Graticule ".concat(oSt(this.params))}assemble(){return Object.assign({type:"graticule"},!0===this.params?{}:this.params)}}class zPt extends NRt{constructor(t,e){super(t),this.params=e}clone(){return new zPt(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([null!==(t=this.params.as)&&void 0!==t?t:"data"])}hash(){return"Hash ".concat(oSt(this.params))}assemble(){return Object.assign({type:"sequence"},this.params)}}function BPt(t){return t instanceof MPt||t instanceof RPt||t instanceof zPt}class LPt{constructor(){this._mutated=!1}setMutated(){this._mutated=!0}get mutatedFlag(){return this._mutated}}class PPt extends LPt{constructor(){super(),this._continue=!1}setContinue(){this._continue=!0}get continueFlag(){return this._continue}get flags(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}}set flags(t){let{continueFlag:e,mutatedFlag:n}=t;e&&this.setContinue(),n&&this.setMutated()}reset(){}optimizeNextFromLeaves(t){if(BPt(t))return!1;const e=t.parent,{continueFlag:n}=this.run(t);return n&&this.optimizeNextFromLeaves(e),this.mutatedFlag}}class jPt extends LPt{}function UPt(t,e,n,r){const i=Xjt(r)?r.encoding[STt(e)]:void 0;if(JDt(n)&&Xjt(r)&&VDt(e,n,i,r.stack,r.markDef,r.config))t.add(aIt(n,{})),t.add(aIt(n,{suffix:"end"})),n.bin&&CIt(n,e)&&t.add(aIt(n,{binSuffix:"range"}));else if(function(t){return t in aTt}(e)){const n=function(t){switch(t){case OEt:return"y";case zEt:return"y2";case REt:return"x";case BEt:return"x2"}}(e);t.add(r.getName(n))}else t.add(aIt(n));return t}class WPt extends NRt{constructor(t,e,n){super(t),this.dimensions=e,this.measures=n}clone(){return new WPt(null,new Set(this.dimensions),nSt(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,e){let n=!1;e.forEachFieldDef((t=>{t.aggregate&&(n=!0)}));const r={},i=new Set;return n?(e.forEachFieldDef(((t,n)=>{var a,o,s,c;const{aggregate:u,field:l}=t;if(u)if("count"===u)r["*"]=null!==(a=r["*"])&&void 0!==a?a:{},r["*"].count=new Set([aIt(t,{forAs:!0})]);else{if(mEt(u)||vEt(u)){const t=mEt(u)?"argmin":"argmax",e=u[t];r[e]=null!==(o=r[e])&&void 0!==o?o:{},r[e][t]=new Set([aIt({op:t,field:e},{forAs:!0})])}else r[l]=null!==(s=r[l])&&void 0!==s?s:{},r[l][u]=new Set([aIt(t,{forAs:!0})]);oNt(n)&&"unaggregated"===e.scaleDomain(n)&&(r[l]=null!==(c=r[l])&&void 0!==c?c:{},r[l].min=new Set([aIt({field:l,aggregate:"min"},{forAs:!0})]),r[l].max=new Set([aIt({field:l,aggregate:"max"},{forAs:!0})]))}else UPt(i,n,t,e)})),i.size+vSt(r).length===0?null:new WPt(t,i,r)):null}static makeFromTransform(t,e){var n,r,i;const a=new Set,o={};for(const s of e.aggregate){const{op:t,field:e,as:i}=s;t&&("count"===t?(o["*"]=null!==(n=o["*"])&&void 0!==n?n:{},o["*"].count=new Set([i||aIt(s,{forAs:!0})])):(o[e]=null!==(r=o[e])&&void 0!==r?r:{},o[e][t]=new Set([i||aIt(s,{forAs:!0})])))}for(const s of null!==(i=e.groupby)&&void 0!==i?i:[])a.add(s);return a.size+vSt(o).length===0?null:new WPt(t,a,o)}merge(t){return function(t,e){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}(this.dimensions,t.dimensions)?(function(t,e){var n;for(const r of vSt(e)){const i=e[r];for(const e of vSt(i))r in t?t[r][e]=new Set([...null!==(n=t[r][e])&&void 0!==n?n:[],...i[e]]):t[r]={[e]:i[e]}}}(this.measures,t.measures),!0):(function(){HNt.debug(...arguments)}("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...vSt(this.measures)])}producedFields(){const t=new Set;for(const e of vSt(this.measures))for(const n of vSt(this.measures[e])){const r=this.measures[e][n];0===r.size?t.add("".concat(n,"_").concat(e)):r.forEach(t.add,t)}return t}hash(){return"Aggregate ".concat(oSt({dimensions:this.dimensions,measures:this.measures}))}assemble(){const t=[],e=[],n=[];for(const r of vSt(this.measures))for(const i of vSt(this.measures[r]))for(const a of this.measures[r][i])n.push(a),t.push(i),e.push("*"===r?null:ESt(r));return{type:"aggregate",groupby:[...this.dimensions].map(ESt),ops:t,fields:e,as:n}}}class VPt extends NRt{constructor(t,e,n,r){super(t),this.model=e,this.name=n,this.data=r;for(const i of lTt){const t=e.facet[i];if(t){const{bin:n,sort:r}=t;this[i]=Object.assign({name:e.getName("".concat(i,"_domain")),fields:[aIt(t),...fNt(n)?[aIt(t,{binSuffix:"end"})]:[]]},RDt(r)?{sortField:r}:NCt(r)?{sortIndexField:RLt(t,i)}:{})}}this.childModel=e.child}hash(){let t="Facet";for(const e of lTt)this[e]&&(t+=" ".concat(e.charAt(0),":").concat(oSt(this[e])));return t}get fields(){var t;const e=[];for(const n of lTt)(null===(t=this[n])||void 0===t?void 0:t.fields)&&e.push(...this[n].fields);return e}dependentFields(){const t=new Set(this.fields);for(const e of lTt)this[e]&&(this[e].sortField&&t.add(this[e].sortField.field),this[e].sortIndexField&&t.add(this[e].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const e of VTt){const n=this.childModel.component.scales[e];if(n&&!n.merged){const r=n.get("type"),i=n.get("range");if(XFt(r)&&dFt(i)){const n=Ejt(Tjt(this.childModel,e));n?t[e]=n:XNt("Unknown field for ".concat(e,". Cannot calculate view size."))}}}return t}assembleRowColumnHeaderData(t,e,n){const r={row:"y",column:"x"}[t],i=[],a=[],o=[];n&&n[r]&&(e?(i.push("distinct_".concat(n[r])),a.push("max")):(i.push(n[r]),a.push("distinct")),o.push("distinct_".concat(n[r])));const{sortField:s,sortIndexField:c}=this[t];if(s){const{op:t=DDt,field:e}=s;i.push(e),a.push(t),o.push(aIt(s,{forAs:!0}))}else c&&(i.push(c),a.push("max"),o.push(c));return{name:this[t].name,source:null!==e&&void 0!==e?e:this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},i.length?{fields:i,ops:a,as:o}:{})]}}assembleFacetHeaderData(t){var e,n;const{columns:r}=this.model.layout,{layoutHeaders:i}=this.model.component,a=[],o={};for(const u of PLt){for(const t of jLt){const r=null!==(e=i[u]&&i[u][t])&&void 0!==e?e:[];for(const t of r)if((null===(n=t.axes)||void 0===n?void 0:n.length)>0){o[u]=!0;break}}if(o[u]){const t='length(data("'.concat(this.facet.name,'"))'),e="row"===u?r?{signal:"ceil(".concat(t," / ").concat(r,")")}:1:r?{signal:"min(".concat(t,", ").concat(r,")")}:{signal:t};a.push({name:"".concat(this.facet.name,"_").concat(u),transform:[{type:"sequence",start:0,stop:e}]})}}const{row:s,column:c}=o;return(s||c)&&a.unshift(this.assembleRowColumnHeaderData("facet",null,t)),a}assemble(){var t,e;const n=[];let r=null;const i=this.getChildIndependentFieldsWithStep(),{column:a,row:o,facet:s}=this;if(a&&o&&(i.x||i.y)){r="cross_".concat(this.column.name,"_").concat(this.row.name);const a=[].concat(null!==(t=i.x)&&void 0!==t?t:[],null!==(e=i.y)&&void 0!==e?e:[]),o=a.map((()=>"distinct"));n.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:a,ops:o}]})}for(const c of[AEt,_Et])this[c]&&n.push(this.assembleRowColumnHeaderData(c,r,i));if(s){const t=this.assembleFacetHeaderData(i);t&&n.push(...t)}return n}}function qPt(t){return"'"===t[0]&&"'"===t[t.length-1]||'"'===t[0]&&'"'===t[t.length-1]?t.slice(1,-1):t}function GPt(t){const e={};return JCt(t.filter,(t=>{var n;if(AFt(t)){let r=null;vFt(t)?r=t.equal:kFt(t)?r=t.range[0]:_Ft(t)&&(r=(null!==(n=t.oneOf)&&void 0!==n?n:t.in)[0]),r&&(KNt(r)?e[t.field]="date":PCt(r)?e[t.field]="number":jCt(r)&&(e[t.field]="string")),t.timeUnit&&(e[t.field]="date")}})),e}function HPt(t){const e={};function n(t){var n;kIt(t)?e[t.field]="date":"quantitative"===t.type&&(jCt(n=t.aggregate)&&cSt(["min","max"],n))?e[t.field]="number":FSt(t.field)>1?t.field in e||(e[t.field]="flatten"):eIt(t)&&RDt(t.sort)&&FSt(t.sort.field)>1&&(t.sort.field in e||(e[t.sort.field]="flatten"))}if((Xjt(t)||Kjt(t))&&t.forEachFieldDef(((e,r)=>{if(JDt(e))n(e);else{const i=ATt(r),a=t.fieldDef(i);n(Object.assign(Object.assign({},e),{type:a.type}))}})),Xjt(t)){const{mark:n,markDef:r,encoding:i}=t;if(rEt(n)&&!t.encoding.order){const t=i["horizontal"===r.orient?"y":"x"];YDt(t)&&"quantitative"===t.type&&!(t.field in e)&&(e[t.field]="number")}}return e}class YPt extends NRt{constructor(t,e){super(t),this._parse=e}clone(){return new YPt(null,nSt(this._parse))}hash(){return"Parse ".concat(oSt(this._parse))}static makeExplicit(t,e,n){let r={};const i=e.data;return!NOt(i)&&i&&i.format&&i.format.parse&&(r=i.format.parse),this.makeWithAncestors(t,r,{},n)}static makeWithAncestors(t,e,n,r){for(const o of vSt(n)){const t=r.getWithExplicit(o);void 0!==t.value&&(t.explicit||t.value===n[o]||"derived"===t.value||"flatten"===n[o]?delete n[o]:XNt(ENt(o,n[o],t.value)))}for(const o of vSt(e)){const t=r.get(o);void 0!==t&&(t===e[o]?delete e[o]:XNt(ENt(o,e[o],t)))}const i=new bOt(e,n);r.copyAll(i);const a={};for(const o of vSt(i.combine())){const t=i.get(o);null!==t&&(a[o]=t)}return 0===vSt(a).length||r.parseNothing?null:new YPt(t,a)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const e of vSt(this._parse)){const n=this._parse[e];1===FSt(e)&&(t[e]=n)}return t}producedFields(){return new Set(vSt(this._parse))}dependentFields(){return new Set(vSt(this._parse))}assembleTransforms(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return vSt(this._parse).filter((e=>!t||FSt(e)>1)).map((t=>{const e=function(t,e){const n=CSt(t);if("number"===e)return"toNumber(".concat(n,")");if("boolean"===e)return"toBoolean(".concat(n,")");if("string"===e)return"toString(".concat(n,")");if("date"===e)return"toDate(".concat(n,")");if("flatten"===e)return n;if(0===e.indexOf("date:")){const t=qPt(e.slice(5,e.length));return"timeParse(".concat(n,",'").concat(t,"')")}if(0===e.indexOf("utc:")){const t=qPt(e.slice(4,e.length));return"utcParse(".concat(n,",'").concat(t,"')")}return XNt('Unrecognized parse "'.concat(e,'".')),null}(t,this._parse[t]);if(!e)return null;return{type:"formula",expr:e,as:NSt(t)}})).filter((t=>null!==t))}}class XPt extends NRt{clone(){return new XPt(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([wMt])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:wMt}}}class KPt extends NRt{constructor(t,e){super(t),this.transform=e}clone(){return new KPt(null,nSt(this.transform))}addDimensions(t){this.transform.groupby=dSt(this.transform.groupby.concat(t),(t=>t))}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map((t=>t.field)).filter((t=>void 0!==t)).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var e;return null!==(e=t.as)&&void 0!==e?e:aIt(t)}hash(){return"JoinAggregateTransform ".concat(oSt(this.transform))}assemble(){const t=[],e=[],n=[];for(const i of this.transform.joinaggregate)e.push(i.op),n.push(this.getDefaultName(i)),t.push(void 0===i.field?null:i.field);const r=this.transform.groupby;return Object.assign({type:"joinaggregate",as:n,ops:e,fields:t},void 0!==r?{groupby:r}:{})}}class QPt extends NRt{constructor(t,e){super(t),this._stack=e}clone(){return new QPt(null,nSt(this._stack))}static makeFromTransform(t,e){const{stack:n,groupby:r,as:i,offset:a="zero"}=e,o=[],s=[];if(void 0!==e.sort)for(const l of e.sort)o.push(l.field),s.push(DSt(l.order,"ascending"));const c={field:o,order:s};let u;return u=function(t){return NCt(t)&&t.every((t=>jCt(t)))&&t.length>1}(i)?i:jCt(i)?[i,i+"_end"]:[e.stack+"_start",e.stack+"_end"],new QPt(t,{stackField:n,groupby:r,offset:a,sort:c,facetby:[],as:u})}static makeFromEncoding(t,e){const n=e.stack,{encoding:r}=e;if(!n)return null;const{groupbyChannel:i,fieldChannel:a,offset:o,impute:s}=n;let c;if(i){c=gIt(r[i])}const u=function(t){return t.stack.stackBy.reduce(((t,e)=>{const n=aIt(e.fieldDef);return n&&t.push(n),t}),[])}(e),l=e.encoding.order;let h;return h=NCt(l)||YDt(l)?zIt(l):u.reduce(((t,e)=>(t.field.push(e),t.order.push("y"===a?"descending":"ascending"),t)),{field:[],order:[]}),new QPt(t,{dimensionFieldDef:c,stackField:e.vgField(a),facetby:[],stackby:u,sort:h,offset:o,impute:s,as:[e.vgField(a,{suffix:"start",forAs:!0}),e.vgField(a,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return"Stack ".concat(oSt(this._stack))}getGroupbyFields(){const{dimensionFieldDef:t,impute:e,groupby:n}=this._stack;return t?t.bin?e?[aIt(t,{binSuffix:"mid"})]:[aIt(t,{}),aIt(t,{binSuffix:"end"})]:[aIt(t)]:null!==n&&void 0!==n?n:[]}assemble(){const t=[],{facetby:e,dimensionFieldDef:n,stackField:r,stackby:i,sort:a,offset:o,impute:s,as:c}=this._stack;if(s&&n){const{band:a=.5,bin:o}=n;o&&t.push({type:"formula",expr:"".concat(a,"*")+aIt(n,{expr:"datum"})+"+".concat(1-a,"*")+aIt(n,{expr:"datum",binSuffix:"end"}),as:aIt(n,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:r,groupby:[...i,...e],key:aIt(n,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...e],field:r,sort:a,as:c,offset:o}),t}}class ZPt extends NRt{constructor(t,e){super(t),this.transform=e}clone(){return new ZPt(null,nSt(this.transform))}addDimensions(t){this.transform.groupby=dSt(this.transform.groupby.concat(t),(t=>t))}dependentFields(){var t,e;const n=new Set;return(null!==(t=this.transform.groupby)&&void 0!==t?t:[]).forEach(n.add,n),(null!==(e=this.transform.sort)&&void 0!==e?e:[]).forEach((t=>n.add(t.field))),this.transform.window.map((t=>t.field)).filter((t=>void 0!==t)).forEach(n.add,n),n}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var e;return null!==(e=t.as)&&void 0!==e?e:aIt(t)}hash(){return"WindowTransform ".concat(oSt(this.transform))}assemble(){var t;const e=[],n=[],r=[],i=[];for(const h of this.transform.window)n.push(h.op),r.push(this.getDefaultName(h)),i.push(void 0===h.param?null:h.param),e.push(void 0===h.field?null:h.field);const a=this.transform.frame,o=this.transform.groupby;if(a&&null===a[0]&&null===a[1]&&n.every((t=>yEt(t))))return Object.assign({type:"joinaggregate",as:r,ops:n,fields:e},void 0!==o?{groupby:o}:{});const s=[],c=[];if(void 0!==this.transform.sort)for(const h of this.transform.sort)s.push(h.field),c.push(null!==(t=h.order)&&void 0!==t?t:"ascending");const u={field:s,order:c},l=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:i,as:r,ops:n,fields:e,sort:u},void 0!==l?{ignorePeers:l}:{}),void 0!==o?{groupby:o}:{}),void 0!==a?{frame:a}:{})}}class $Pt extends PPt{run(t){const e=t.parent;if(t instanceof YPt){if(BPt(e))return this.flags;if(e.numChildren()>1)return this.setContinue(),this.flags;if(e instanceof YPt)this.setMutated(),e.merge(t);else{if(gSt(e.producedFields(),t.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),t.swapWithParent()}}return this.setContinue(),this.flags}}class JPt extends jPt{mergeNodes(t,e){const n=e.shift();for(const r of e)t.removeChild(r),r.parent=n,r.remove()}run(t){const e=t.children.map((t=>t.hash())),n={};for(let r=0;r<e.length;r++)void 0===n[e[r]]?n[e[r]]=[t.children[r]]:n[e[r]].push(t.children[r]);for(const r of vSt(n))n[r].length>1&&(this.setMutated(),this.mergeNodes(t,n[r]));for(const r of t.children)this.run(r);return this.mutatedFlag}}class tjt extends PPt{run(t){return t instanceof FRt||t.numChildren()>0||t instanceof VPt||(this.setMutated(),t.remove()),this.flags}}class ejt extends PPt{constructor(){super(...arguments),this.fields=new Set,this.prev=null}run(t){if(this.setContinue(),t instanceof DRt){const e=t.producedFields();fSt(e,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([...this.fields,...e]),this.prev=t}return this.flags}reset(){this.fields.clear()}}class njt extends PPt{run(t){this.setContinue();const e=t.parent.children.filter((t=>t instanceof DRt)),n=e.pop();for(const r of e)this.setMutated(),n.merge(r);return this.flags}}function rjt(t){if(t instanceof VPt)if(1!==t.numChildren()||t.children[0]instanceof FRt){const n=t.model.component.data.main;ijt(n);const r=(e=t,function t(n){if(!(n instanceof VPt)){const r=n.clone();if(r instanceof FRt){const t=hjt+r.getSource();r.setSource(t),e.model.component.data.outputNodes[t]=r}else(r instanceof WPt||r instanceof QPt||r instanceof ZPt||r instanceof KPt)&&r.addDimensions(e.fields);for(const e of n.children.flatMap(t))e.parent=r;return[r]}return n.children.flatMap(t)}),i=t.children.map(r).flat();for(const t of i)t.parent=n}else{const e=t.children[0];(e instanceof WPt||e instanceof QPt||e instanceof ZPt||e instanceof KPt)&&e.addDimensions(t.fields),e.swapWithParent(),rjt(t)}else t.children.map(rjt);var e}function ijt(t){if(t instanceof FRt&&t.type===MOt&&1===t.numChildren()){const e=t.children[0];e instanceof VPt||(e.swapWithParent(),ijt(t))}}class ajt extends jPt{constructor(){super()}run(t){t instanceof FRt&&!t.isRequired()&&(this.setMutated(),t.remove());for(const e of t.children)this.run(e);return this.mutatedFlag}}class ojt extends jPt{constructor(t){super(),this.requiresSelectionId=t&&yzt(t)}run(t){t instanceof XPt&&(this.requiresSelectionId&&(BPt(t.parent)||t.parent instanceof WPt||t.parent instanceof YPt)||(this.setMutated(),t.remove()));for(const e of t.children)this.run(e);return this.mutatedFlag}}class sjt extends PPt{run(t){const e=t.parent,n=[...e.children],r=e.children.filter((t=>t instanceof YPt));if(e.numChildren()>1&&r.length>=1){const t={},i=new Set;for(const e of r){const n=e.parse;for(const e of vSt(n))e in t?t[e]!==n[e]&&i.add(e):t[e]=n[e]}for(const e of i)delete t[e];if(!mSt(t)){this.setMutated();const r=new YPt(e,t);for(const i of n){if(i instanceof YPt)for(const e of vSt(t))delete i.parse[e];e.removeChild(i),i.parent=r,i instanceof YPt&&0===vSt(i.parse).length&&i.remove()}}}return this.setContinue(),this.flags}}class cjt extends PPt{run(t){const e=t.parent,n=e.children.filter((t=>t instanceof WPt)),r={};for(const i of n){const t=oSt(i.groupBy);t in r||(r[t]=[]),r[t].push(i)}for(const i of vSt(r)){const t=r[i];if(t.length>1){const n=t.pop();for(const r of t)n.merge(r)&&(e.removeChild(r),r.parent=n,r.remove(),this.setMutated())}}return this.setContinue(),this.flags}}class ujt extends PPt{constructor(t){super(),this.model=t}run(t){const e=t.parent,n=!(BPt(e)||e instanceof pLt||e instanceof YPt||e instanceof XPt),r=[],i=[];for(const a of e.children)a instanceof IPt&&(n&&!gSt(e.producedFields(),a.dependentFields())?r.push(a):i.push(a));if(r.length>0){const t=r.pop();for(const e of r)t.merge(e,this.model.renameSignal.bind(this.model));this.setMutated(),e instanceof IPt?e.merge(t,this.model.renameSignal.bind(this.model)):t.swapWithParent()}if(i.length>1){const t=i.pop();for(const e of i)t.merge(e,this.model.renameSignal.bind(this.model));this.setMutated()}return this.setContinue(),this.flags}}class ljt extends PPt{run(t){const e=t.parent,n=[...e.children];if(!uSt(n,(t=>t instanceof FRt))||e.numChildren()<=1)return this.setContinue(),this.flags;const r=[];let i;for(const a of n)if(a instanceof FRt){let t=a;for(;1===t.numChildren();){const e=t.children[0];if(!(e instanceof FRt))break;t=e}r.push(...t.children),i?(e.removeChild(a),a.parent=i.parent,i.parent.removeChild(i),i.parent=t,this.setMutated()):i=t}else r.push(a);if(r.length){this.setMutated();for(const t of r)t.parent.removeChild(t),t.parent=i}return this.setContinue(),this.flags}}const hjt="scale_",djt=5;function fjt(t){const e=[];function n(t){if(0===t.numChildren())e.push(t);else for(const e of t.children)n(e)}for(const r of t)n(r);return e}function pjt(t){return t}function gjt(t,e){return e.map((e=>{if(t instanceof PPt){const n=t.optimizeNextFromLeaves(e);return t.reset(),n}return t.run(e)})).some(pjt)}function mjt(t,e){let n=t.sources;const r=new Set;return r.add(gjt(new ajt,n)),r.add(gjt(new ojt(e),n)),n=n.filter((t=>t.numChildren()>0)),r.add(gjt(new tjt,fjt(n))),n=n.filter((t=>t.numChildren()>0)),r.add(gjt(new $Pt,fjt(n))),r.add(gjt(new ujt(e),fjt(n))),r.add(gjt(new ejt,fjt(n))),r.add(gjt(new sjt,fjt(n))),r.add(gjt(new cjt,fjt(n))),r.add(gjt(new njt,fjt(n))),r.add(gjt(new JPt,n)),r.add(gjt(new ljt,fjt(n))),t.sources=n,r.has(!0)}class vjt{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,e){return new vjt((()=>t(e)))}}function yjt(t){Xjt(t)?function(t){const e=t.component.scales;for(const n of vSt(e)){const r=bjt(t,n);if(e[n].setWithExplicit("domains",r),_jt(t,n),t.component.data.isFaceted){let e=t;for(;!Kjt(e)&&e.parent;)e=e.parent;if("shared"===e.component.resolve.scale[n])for(const t of r.value)fFt(t)&&(t.data=hjt+t.data.replace(hjt,""))}}}(t):function(t){for(const n of t.children)yjt(n);const e=t.component.scales;for(const n of vSt(e)){let r,i=null;for(const e of t.children){const t=e.component.scales[n];if(t){r=void 0===r?t.getWithExplicit("domains"):AOt(r,t.getWithExplicit("domains"),"domains","scale",Cjt);const e=t.get("selectionExtent");i&&e&&i.selection!==e.selection&&XNt("The same selection must be used to override scale domains in a layered view."),i=e}}e[n].setWithExplicit("domains",r),i&&e[n].set("selectionExtent",i,!0)}}(t)}function bjt(t,e){const n=t.getScaleComponent(e).get("type"),{encoding:r}=t,i=function(t,e,n,r){if("unaggregated"===t){const{valid:t,reason:r}=Ajt(e,n);if(!t)return void XNt(r)}else if(void 0===t&&r.useUnaggregatedDomain){const{valid:t}=Ajt(e,n);if(t)return"unaggregated"}return t}(t.scaleDomain(e),t.typedFieldDef(e),n,t.config.scale);return i!==t.scaleDomain(e)&&(t.specifiedScales[e]=Object.assign(Object.assign({},t.specifiedScales[e]),{domain:i})),"x"===e&&mIt(r.x2)?mIt(r.x)?AOt(wjt(n,i,t,"x"),wjt(n,i,t,"x2"),"domain","scale",Cjt):wjt(n,i,t,"x2"):"y"===e&&mIt(r.y2)?mIt(r.y)?AOt(wjt(n,i,t,"y"),wjt(n,i,t,"y2"),"domain","scale",Cjt):wjt(n,i,t,"y2"):wjt(n,i,t,e)}function xjt(t,e,n){var r;const i=null===(r=lFt(n))||void 0===r?void 0:r.unit;return"temporal"===e||i?function(t,e,n){return t.map((t=>{const r=_It(t,{timeUnit:n,type:e});return{signal:"{data: ".concat(r,"}")}}))}(t,e,i):[t]}function wjt(t,e,n,r){const{encoding:i}=n,a=mIt(i[r]),{type:o}=a,s=a.timeUnit;if(function(t){return t&&t.unionWith}(e)){const i=wjt(t,void 0,n,r),a=xjt(e.unionWith,o,s);return xOt([...i.value,...a])}if(hFt(e))return xOt([e]);if(e&&"unaggregated"!==e&&!$Ft(e))return xOt(xjt(e,o,s));const c=n.stack;if(c&&r===c.fieldChannel){if("normalize"===c.offset)return wOt([[0,1]]);const t=n.requestDataName(MOt);return wOt([{data:t,field:n.vgField(r,{suffix:"start"})},{data:t,field:n.vgField(r,{suffix:"end"})}])}const u=oNt(r)&&YDt(a)?function(t,e,n){if(!XFt(n))return;const r=t.fieldDef(e),i=r.sort;if(zDt(i))return{op:"min",field:RLt(r,e),order:"ascending"};const{stack:a}=t,o=a?[...a.groupbyField?[a.groupbyField]:[],...a.stackBy.map((t=>t.fieldDef.field))]:void 0;if(RDt(i)){return kjt(i,a&&!cSt(o,i.field))}if(ODt(i)){const{encoding:e,order:n}=i,r=t.fieldDef(e),{aggregate:s,field:c}=r,u=a&&!cSt(o,c);if(mEt(s)||vEt(s))return kjt({field:aIt(r),order:n},u);if(yEt(s)||!s)return kjt({op:s,field:c,order:n},u)}else{if("descending"===i)return{op:"min",field:t.vgField(e),order:"descending"};if(cSt(["ascending",void 0],i))return!0}return}(n,r,t):void 0;if(KDt(a)){return wOt(xjt([a.datum],o,s))}const l=a;if("unaggregated"===e){const t=n.requestDataName(MOt),{field:e}=a;return wOt([{data:t,field:aIt({field:e,aggregate:"min"})},{data:t,field:aIt({field:e,aggregate:"max"})}])}if(fNt(l.bin)){if(XFt(t))return wOt("bin-ordinal"===t?[]:[{data:xSt(u)?n.requestDataName(MOt):n.requestDataName(OOt),field:n.vgField(r,CIt(l,r)?{binSuffix:"range"}:{}),sort:!0!==u&&FCt(u)?u:{field:n.vgField(r,{}),op:"min"}}]);{const{bin:t}=l;if(fNt(t)){const e=FPt(n,l.field,t);return wOt([new vjt((()=>{const t=n.getSignalName(e);return"[".concat(t,".start, ").concat(t,".stop]")}))])}return wOt([{data:n.requestDataName(MOt),field:n.vgField(r,{})}])}}if(l.timeUnit&&cSt(["time","utc"],t)&&VDt(r,l,Xjt(n)?n.encoding[STt(r)]:void 0,n.stack,n.markDef,n.config)){const t=n.requestDataName(MOt);return wOt([{data:t,field:n.vgField(r)},{data:t,field:n.vgField(r,{suffix:"end"})}])}return wOt(u?[{data:xSt(u)?n.requestDataName(MOt):n.requestDataName(OOt),field:n.vgField(r),sort:u}]:[{data:n.requestDataName(MOt),field:n.vgField(r)}])}function kjt(t,e){const{op:n,field:r,order:i}=t;return Object.assign(Object.assign({op:null!==n&&void 0!==n?n:e?"sum":DDt},r?{field:ESt(r)}:{}),i?{order:i}:{})}function _jt(t,e){var n;const r=t.component.scales[e],i=t.specifiedScales[e].domain,a=null===(n=t.fieldDef(e))||void 0===n?void 0:n.bin,o=$Ft(i)&&i,s=gNt(a)&&mNt(a.extent)&&a.extent;(o||s)&&r.set("selectionExtent",null!==o&&void 0!==o?o:s,!0)}function Ajt(t,e){const{aggregate:n,type:r}=t;return n?jCt(n)&&!kEt[n]?{valid:!1,reason:BNt(n)}:"quantitative"===r&&"log"===e?{valid:!1,reason:LNt(t)}:{valid:!0}:{valid:!1,reason:zNt(t)}}function Cjt(t,e,n,r){return t.explicit&&e.explicit&&XNt(function(t,e,n,r){return"Conflicting ".concat(e.toString(),' property "').concat(t.toString(),'" (').concat(aSt(n)," and ").concat(aSt(r),"). Using the union of the two domains.")}(n,r,t.value,e.value)),{explicit:t.explicit,value:[...t.value,...e.value]}}function Sjt(t){const e=dSt(t.map((t=>{if(fFt(t)){const{sort:e}=t;return VCt(t,["sort"])}return t})),oSt),n=dSt(t.map((t=>{if(fFt(t)){const e=t.sort;return void 0===e||xSt(e)||("op"in e&&"count"===e.op&&delete e.field,"ascending"===e.order&&delete e.order),e}})).filter((t=>void 0!==t)),oSt);if(0===e.length)return;if(1===e.length){const e=t[0];if(fFt(e)&&n.length>0){let t=n[0];if(n.length>1)XNt(UNt),t=!0;else if(FCt(t)&&"field"in t){const n=t.field;e.field===n&&(t=!t.order||{order:t.order})}return Object.assign(Object.assign({},e),{sort:t})}return e}const r=dSt(n.map((t=>xSt(t)||!("op"in t)||t.op in gEt?t:(XNt(function(t){return"Dropping sort property ".concat(aSt(t),' as unioned domains only support boolean or op "count", "min", and "max".')}(t)),!0))),oSt);let i;1===r.length?i=r[0]:r.length>1&&(XNt(UNt),i=!0);const a=dSt(t.map((t=>fFt(t)?t.data:null)),(t=>t));if(1===a.length&&null!==a[0]){return Object.assign({data:a[0],fields:e.map((t=>t.field))},i?{sort:i}:{})}return Object.assign({fields:e},i?{sort:i}:{})}function Ejt(t){if(fFt(t)&&jCt(t.field))return t.field;if(function(t){return!NCt(t)&&"fields"in t&&!("data"in t)}(t)){let e;for(const n of t.fields)if(fFt(n)&&jCt(n.field))if(e){if(e!==n.field)return XNt("Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect."),e}else e=n.field;return XNt("Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect."),e}if(function(t){return!NCt(t)&&"fields"in t&&"data"in t}(t)){XNt("Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.");const e=t.fields[0];return jCt(e)?e:void 0}}function Tjt(t,e){const n=t.component.scales[e].get("domains").map((e=>(fFt(e)&&(e.data=t.lookupDataSource(e.data)),e)));return Sjt(n)}function Njt(t){return Zjt(t)||Qjt(t)?t.children.reduce(((t,e)=>t.concat(Njt(e))),Fjt(t)):Fjt(t)}function Fjt(t){return vSt(t.component.scales).reduce(((e,n)=>{const r=t.component.scales[n];if(r.merged)return e;const i=r.combine(),{name:a,type:o,selectionExtent:s,domains:c,range:u,reverse:l}=i,h=VCt(i,["name","type","selectionExtent","domains","range","reverse"]),d=function(t,e,n){if(qTt(n)&&dFt(t))return{step:{signal:e+"_step"}};return t}(i.range,a,n);let f;s&&(f=function(t,e){const n=e.selection;return{signal:mLt(t.getSelectionComponent(n,wSt(n)),e)}}(t,s));const p=Tjt(t,n);return e.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:a,type:o},p?{domain:p}:{}),f?{domainRaw:f}:{}),{range:d}),void 0!==l?{reverse:l}:{}),h)),e}),[])}class Djt extends bOt{constructor(t,e){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",e)}domainDefinitelyIncludesZero(){return!1!==this.get("zero")||uSt(this.get("domains"),(t=>NCt(t)&&2===t.length&&t[0]<=0&&t[1]>=0))}}const Ijt=["range","scheme"];function Mjt(t){return"x"===t?"width":"y"===t?"height":void 0}function Ojt(t,e){const n=t.fieldDef(e);if(n&&n.bin&&fNt(n.bin)){const r=FPt(t,n.field,n.bin),i=Mjt(e),a=t.getName(i);return new vjt((()=>{const e=t.getSignalName(r),n="(".concat(e,".stop - ").concat(e,".start) / ").concat(e,".step");return"".concat(t.getSignalName(a)," / (").concat(n,")")}))}}function Rjt(t,e){const n=e.specifiedScales[t],{size:r}=e,i=e.getScaleComponent(t).get("type");for(const a of Ijt)if(void 0!==n[a]){const r=oDt(i,a),o=sDt(t,a);if(r)if(o)XNt(o);else switch(a){case"range":return NCt(n.range)&&qTt(t)?xOt(n.range.map((t=>{if("width"===t||"height"===t){const n=e.getName(t),r=e.getSignalName.bind(e);return vjt.fromName(r,n)}return t}))):xOt(n.range);case"scheme":return xOt(zjt(n[a]))}else XNt(PNt(i,a,t))}if(t===SEt||t===EEt){const e=t===SEt?"width":"height",n=r[e];if(TMt(n)){if(XFt(i))return xOt({step:n.step});XNt(jNt(e))}}return wOt(function(t,e){const{size:n,config:r,mark:i,encoding:a}=e,o=e.getSignalName.bind(e),{type:s}=mIt(a[t]),c=e.getScaleComponent(t),u=c.get("type"),{domain:l,domainMid:h}=e.specifiedScales[t];switch(t){case SEt:case EEt:{if(cSt(["point","band"],u))if(t!==SEt||n.width){if(t===EEt&&!n.height){const t=MMt(r.view,"height");if(TMt(t))return t}}else{const t=MMt(r.view,"width");if(TMt(t))return t}const i=Mjt(t),a=e.getName(i);return t===EEt&&KFt(u)?[vjt.fromName(o,a),0]:[0,vjt.fromName(o,a)]}case WEt:{const a=Bjt(i,e.component.scales[t].get("zero"),r),o=function(t,e,n,r){const i={x:Ojt(n,"x"),y:Ojt(n,"y")};switch(t){case"bar":case"tick":{if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;const t=Pjt(e,i,r.view);return PCt(t)?t-1:new vjt((()=>"".concat(t.signal," - 1")))}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const t=Pjt(e,i,r.view);return PCt(t)?Math.pow(Ljt*t,2):new vjt((()=>"pow(".concat(Ljt," * ").concat(t.signal,", 2)")))}}throw new Error(MNt("size",t))}(i,n,e,r);return ZFt(u)?function(t,e,n){const r=()=>{const r=FIt(e),i=FIt(t),a="(".concat(r," - ").concat(i,") / (").concat(n," - 1)");return"sequence(".concat(i,", ").concat(r," + ").concat(a,", ").concat(a,")")};return hFt(e)?new vjt(r):{signal:r()}}(a,o,function(t,e,n,r){switch(t){case"quantile":return e.scale.quantileCount;case"quantize":return e.scale.quantizeCount;case"threshold":return void 0!==n&&NCt(n)?n.length+1:(XNt(function(t){return"Domain for ".concat(t," is required for threshold scale.")}(r)),3)}}(u,r,l,t)):[a,o]}case IEt:return[0,2*Math.PI];case VEt:return[0,360];case FEt:return[0,new vjt((()=>{const t=e.getSignalName("width"),n=e.getSignalName("height");return"min(".concat(t,",").concat(n,")/2")}))];case YEt:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case XEt:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case UEt:return"symbol";case LEt:case PEt:case jEt:return"ordinal"===u?"nominal"===s?"category":"ordinal":void 0!==h?"diverging":"rect"===i||"geoshape"===i?"heatmap":"ramp";case qEt:case GEt:case HEt:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error("Scale range undefined for channel ".concat(t))}(t,e))}function zjt(t){return function(t){return!jCt(t)&&!!t.name}(t)?Object.assign({scheme:t.name},iSt(t,["name"])):{scheme:t}}function Bjt(t,e,n){if(e)return hFt(e)?{signal:"".concat(e.signal," ? 0 : ").concat(Bjt(t,!1,n))}:0;switch(t){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(MNt("size",t))}const Ljt=.95;function Pjt(t,e,n){const r=TMt(t.width)?t.width.step:IMt(n,"width"),i=TMt(t.height)?t.height.step:IMt(n,"height");return e.x||e.y?new vjt((()=>{const t=[e.x?e.x.signal:r,e.y?e.y.signal:i];return"min(".concat(t.join(", "),")")})):Math.min(r,i)}function jjt(t,e){Xjt(t)?function(t,e){const n=t.component.scales,{config:r,encoding:i,markDef:a,specifiedScales:o}=t;for(const s of vSt(n)){const c=o[s],u=n[s],l=t.getScaleComponent(s),h=mIt(i[s]),d=c[e],f=l.get("type"),p=l.get("padding"),g=l.get("paddingInner"),m=oDt(f,e),v=sDt(s,e);if(void 0!==d&&(m?v&&XNt(v):XNt(PNt(f,e,s))),m&&void 0===v)if(void 0!==d)u.copyKeyFromObject(e,c);else{const n=e in Ujt?Ujt[e]({model:t,channel:s,fieldOrDatumDef:h,scaleType:f,scalePadding:p,scalePaddingInner:g,domain:c.domain,markDef:a,config:r}):r.scale[e];void 0!==n&&u.set(e,n,!1)}}}(t,e):Vjt(t,e)}const Ujt={bins:t=>{let{model:e,fieldOrDatumDef:n}=t;return YDt(n)?function(t,e){const n=e.bin;if(fNt(n)){const r=FPt(t,e.field,n);return new vjt((()=>t.getSignalName(r)))}if(pNt(n)&&gNt(n)&&void 0!==n.step)return{step:n.step};return}(e,n):void 0},interpolate:t=>{let{channel:e,fieldOrDatumDef:n}=t;return function(t,e){if(cSt([LEt,PEt,jEt],t)&&"nominal"!==e)return"hcl";return}(e,n.type)},nice:t=>{let{scaleType:e,channel:n,fieldOrDatumDef:r}=t;return function(t,e,n){var r;if((null===(r=gIt(n))||void 0===r?void 0:r.bin)||cSt([zFt.TIME,zFt.UTC],t))return;return e in WTt||void 0}(e,n,r)},padding:t=>{let{channel:e,scaleType:n,fieldOrDatumDef:r,markDef:i,config:a}=t;return function(t,e,n,r,i,a){if(t in WTt){if(QFt(e)){if(void 0!==n.continuousPadding)return n.continuousPadding;const{type:e,orient:o}=i;if("bar"===e&&(!YDt(r)||!r.bin&&!r.timeUnit)&&("vertical"===o&&"x"===t||"horizontal"===o&&"y"===t))return a.continuousBandSize}if(e===zFt.POINT)return n.pointPadding}return}(e,n,a.scale,r,i,a.bar)},paddingInner:t=>{let{scalePadding:e,channel:n,markDef:r,config:i}=t;return function(t,e,n,r){if(void 0!==t)return;if(e in WTt){const{bandPaddingInner:t,barBandPaddingInner:e,rectBandPaddingInner:i}=r;return DSt(t,"bar"===n?e:i)}return}(e,n,r.type,i.scale)},paddingOuter:t=>{let{scalePadding:e,channel:n,scaleType:r,markDef:i,scalePaddingInner:a,config:o}=t;return function(t,e,n,r,i,a){if(void 0!==t)return;if(e in WTt&&n===zFt.BAND){const{bandPaddingOuter:t}=a;return DSt(t,hFt(i)?{signal:"".concat(i.signal,"/2")}:i/2)}return}(e,n,r,i.type,a,o.scale)},reverse:t=>{let{fieldOrDatumDef:e,scaleType:n,channel:r,config:i}=t;return function(t,e,n,r){if("x"===n&&void 0!==r.xReverse)return KFt(t)&&"descending"===e?hFt(r.xReverse)?{signal:"!".concat(r.xReverse.signal)}:!r.xReverse:r.xReverse;if(KFt(t)&&"descending"===e)return!0;return}(n,YDt(e)?e.sort:void 0,r,i.scale)},zero:t=>{let{channel:e,fieldOrDatumDef:n,domain:r,markDef:i,scaleType:a}=t;return function(t,e,n,r,i){if(n&&"unaggregated"!==n&&KFt(i)){if(NCt(n)){const t=n[0],e=n[n.length-1];if(t<=0&&e>=0)return!0}return!1}if("size"===t&&"quantitative"===e.type&&!ZFt(i))return!0;if((!YDt(e)||!e.bin)&&cSt([...VTt,...HTt],t)){const{orient:e,type:n}=r;return!cSt(["bar","area","line","trail"],n)||!("horizontal"===e&&"y"===t||"vertical"===e&&"x"===t)}return!1}(e,n,r,i,a)}};function Wjt(t){Xjt(t)?function(t){const e=t.component.scales;for(const n of aNt){const r=e[n];if(!r)continue;const i=Rjt(n,t);r.setWithExplicit("range",i)}}(t):Vjt(t,"range")}function Vjt(t,e){const n=t.component.scales;for(const r of t.children)"range"===e?Wjt(r):jjt(r,e);for(const r of vSt(n)){let i;for(const n of t.children){const t=n.component.scales[r];if(t){i=AOt(i,t.getWithExplicit(e),e,"scale",kOt(((t,n)=>"range"===e&&t.step&&n.step?t.step-n.step:0)))}}n[r].setWithExplicit(e,i)}}function qjt(t,e,n,r){const i=function(t,e,n){var r;switch(e.type){case"nominal":case"ordinal":if(cTt(t)||"discrete"===hNt(t))return"shape"===t&&"ordinal"===e.type&&XNt(RNt(t,"ordinal")),"ordinal";if(t in WTt){if(cSt(["rect","bar","image","rule"],n))return"band"}else if("arc"===n&&t in GTt)return"band";return void 0!==e.band||nIt(e)&&(null===(r=e.axis)||void 0===r?void 0:r.tickBand)?"band":"point";case"temporal":return cTt(t)?"time":"discrete"===hNt(t)?(XNt(RNt(t,"temporal")),"ordinal"):YDt(e)&&e.timeUnit&&lFt(e.timeUnit).utc?"utc":"time";case"quantitative":return cTt(t)?YDt(e)&&fNt(e.bin)?"bin-ordinal":"linear":"discrete"===hNt(t)?(XNt(RNt(t,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(FNt(e.type))}(e,n,r),{type:a}=t;return oNt(e)?void 0!==a?uDt(e,a)?YDt(n)&&!cDt(a,n.type)?(XNt(function(t,e){return'FieldDef does not work with "'.concat(t,'" scale. We are using "').concat(e,'" scale instead.')}(a,i)),i):a:(XNt(function(t,e,n){return'Channel "'.concat(t,'" does not work with "').concat(e,'" scale. We are using "').concat(n,'" scale instead.')}(e,a,i)),i):i:null}function Gjt(t){Xjt(t)?t.component.scales=function(t){const{encoding:e,mark:n}=t;return aNt.reduce(((r,i)=>{const a=mIt(e[i]);if(a&&n===nEt&&i===UEt&&a.type===OFt)return r;let o=a&&a.scale;if(a&&null!==o&&!1!==o){o=null!==o&&void 0!==o?o:{};const e=qjt(o,i,a,n);r[i]=new Djt(t.scaleName(i+"",!0),{value:e,explicit:o.type===e})}return r}),{})}(t):t.component.scales=function(t){var e;const n=t.component.scales={},r={},i=t.component.resolve;for(const a of t.children){Gjt(a);for(const n of vSt(a.component.scales))if(i.scale[n]=null!==(e=i.scale[n])&&void 0!==e?e:rPt(n,t),"shared"===i.scale[n]){const t=r[n],e=a.component.scales[n].getWithExplicit("type");t?PFt(t.value,e.value)?r[n]=AOt(t,e,"type","scale",Hjt):(i.scale[n]="independent",delete r[n]):r[n]=e}}for(const a of vSt(r)){const e=t.scaleName(a,!0),i=r[a];n[a]=new Djt(e,i);for(const n of t.children){const t=n.component.scales[a];t&&(n.renameScale(t.get("name"),e),t.merged=!0)}}return n}(t)}const Hjt=kOt(((t,e)=>UFt(t)-UFt(e)));class Yjt{constructor(){this.nameMap={}}rename(t,e){this.nameMap[t]=e}has(t){return void 0!==this.nameMap[t]}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function Xjt(t){return"unit"===(null===t||void 0===t?void 0:t.type)}function Kjt(t){return"facet"===(null===t||void 0===t?void 0:t.type)}function Qjt(t){return"concat"===(null===t||void 0===t?void 0:t.type)}function Zjt(t){return"layer"===(null===t||void 0===t?void 0:t.type)}class $jt{constructor(t,e,n,r,i,a,o){var s,c;this.type=e,this.parent=n,this.config=i,this.view=o,this.children=[],this.correctDataNames=t=>(t.from&&t.from.data&&(t.from.data=this.lookupDataSource(t.from.data)),t.from&&t.from.facet&&t.from.facet.data&&(t.from.facet.data=this.lookupDataSource(t.from.facet.data)),t),this.parent=n,this.config=i,this.name=null!==(s=t.name)&&void 0!==s?s:r,this.title=EIt(t.title)?{text:t.title}:t.title,this.scaleNameMap=n?n.scaleNameMap:new Yjt,this.projectionNameMap=n?n.projectionNameMap:new Yjt,this.signalNameMap=n?n.signalNameMap:new Yjt,this.data=t.data,this.description=t.description,this.transforms=function(t){return t.map((t=>ROt(t)?{filter:tSt(t.filter,TFt)}:t))}(null!==(c=t.transform)&&void 0!==c?c:[]),this.layout="layer"===e||"unit"===e?{}:function(t,e,n){var r,i;const a=n[e],o={},{spacing:s,columns:c}=a;void 0!==s&&(o.spacing=s),void 0!==c&&(PDt(t)&&!BDt(t.facet)||CMt(t))&&(o.columns=c),SMt(t)&&(o.columns=1);for(const u of FMt)if(void 0!==t[u])if("spacing"===u){const e=t[u];o[u]=PCt(e)?e:{row:null!==(r=e.row)&&void 0!==r?r:s,column:null!==(i=e.column)&&void 0!==i?i:s}}else o[u]=t[u];return o}(t,e,i),this.component={data:{sources:n?n.component.data.sources:[],outputNodes:n?n.component.data.outputNodes:{},outputNodeRefCounts:n?n.component.data.outputNodeRefCounts:{},isFaceted:PDt(t)||n&&n.component.data.isFaceted&&void 0===t.data},layoutSize:new bOt,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},a?nSt(a):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){!function(t){let{ignoreRange:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Gjt(t),yjt(t);for(const n of aDt)jjt(t,n);e||Wjt(t)}(this)}parseProjection(){TPt(this)}renameTopLevelLayoutSizeSignal(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}parseLegends(){vPt(this)}assembleGroupStyle(){var t,e;if("unit"===this.type||"layer"===this.type)return null!==(e=null===(t=this.view)||void 0===t?void 0:t.style)&&void 0!==e?e:"cell"}assembleEncodeFromView(t){const{style:e}=t,n=VCt(t,["style"]),r={};for(const i of vSt(n)){const t=n[i];void 0!==t&&(r[i]=TIt(t))}return r}assembleGroupEncodeEntry(t){let e={};return this.view&&(e=this.assembleEncodeFromView(this.view)),t||(this.description&&(e.description=TIt(this.description)),"unit"!==this.type&&"layer"!==this.type)?mSt(e)?void 0:e:Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},null!==e&&void 0!==e?e:{})}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:e}=t,n=VCt(t,["spacing"]),{component:r,config:i}=this,a=function(t,e){const n={};for(const r of lTt){const i=t[r];if(null===i||void 0===i?void 0:i.facetFieldDef){const{titleAnchor:t,titleOrient:a}=LLt(["titleAnchor","titleOrient"],i.facetFieldDef,e,r),o=zLt(r,a),s=KLt(t,o);void 0!==s&&(n[o]=s)}}return mSt(n)?void 0:n}(r.layoutHeaders,i);return Object.assign(Object.assign(Object.assign({padding:e},this.assembleDefaultLayout()),n),a?{titleBand:a}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let e=[];for(const n of lTt)t[n].title&&e.push(ULt(this,n));for(const n of PLt)e=e.concat(qLt(this,n));return e}assembleAxes(){return function(t,e){const{x:n=[],y:r=[]}=t;return[...n.map((t=>bLt(t,"grid",e))),...r.map((t=>bLt(t,"grid",e))),...n.map((t=>bLt(t,"main",e))),...r.map((t=>bLt(t,"main",e)))].filter((t=>t))}(this.component.axes,this.config)}assembleLegends(){return _Pt(this)}assembleProjections(){return APt(this)}assembleTitle(){var t,e,n;const r=null!==(t=this.title)&&void 0!==t?t:{},{encoding:i}=r,a=VCt(r,["encoding"]),o=Object.assign(Object.assign(Object.assign({},SIt(this.config.title).nonMark),a),i?{encode:{update:i}}:{});if(o.text)return cSt(["unit","layer"],this.type)?cSt(["middle",void 0],o.anchor)&&(o.frame=null!==(e=o.frame)&&void 0!==e?e:"group"):o.anchor=null!==(n=o.anchor)&&void 0!==n?n:"start",mSt(o)?void 0:o}assembleGroup(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e={};t=t.concat(this.assembleSignals()),t.length>0&&(e.signals=t);const n=this.assembleLayout();n&&(e.layout=n),e.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||Kjt(this.parent)?Njt(this):[];r.length>0&&(e.scales=r);const i=this.assembleAxes();i.length>0&&(e.axes=i);const a=this.assembleLegends();return a.length>0&&(e.legends=a),e}getName(t){return wSt((this.name?this.name+"_":"")+t)}requestDataName(t){var e;const n=this.getName(t),r=this.component.data.outputNodeRefCounts;return r[n]=(null!==(e=r[n])&&void 0!==e?e:0)+1,n}getSizeSignalRef(t){if(Kjt(this.parent)){const e=YTt(ePt(t)),n=this.component.scales[e];if(n&&!n.merged){const t=n.get("type"),r=n.get("range");if(XFt(t)&&dFt(r)){const t=n.get("name"),r=Ejt(Tjt(this,e));if(r){return{signal:tPt(t,n,aIt({aggregate:"distinct",field:r},{expr:"datum"}))}}return XNt("Unknown field for ".concat(e,". Cannot calculate view size.")),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const e=this.component.data.outputNodes[t];return e?e.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,e){this.signalNameMap.rename(t,e)}renameScale(t,e){this.scaleNameMap.rename(t,e)}renameProjection(t,e){this.projectionNameMap.rename(t,e)}scaleName(t,e){return e?this.getName(t):wTt(t)&&oNt(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t))?this.scaleNameMap.get(this.getName(t)):void 0}projectionName(t){return t?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const e=this.component.scales[t];return e&&!e.merged?e:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,e){let n=this.component.selection[t];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(t,e)),!n)throw new Error('Cannot find a selection named "'.concat(e,'".'));return n}hasAxisOrientSignalRef(){var t,e;return(null===(t=this.component.axes.x)||void 0===t?void 0:t.some((t=>t.hasOrientSignalRef())))||(null===(e=this.component.axes.y)||void 0===e?void 0:e.some((t=>t.hasOrientSignalRef())))}}class Jjt extends $jt{vgField(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.fieldDef(t);if(n)return aIt(n,e)}reduceFieldDef(t,e){return HIt(this.getMapping(),((e,n,r)=>{const i=gIt(n);return i?t(e,i,r):e}),e)}forEachFieldDef(t,e){GIt(this.getMapping(),((e,n)=>{const r=gIt(e);r&&t(r,n)}),e)}}class tUt extends NRt{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=nSt(e);const a=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=a[0])&&void 0!==r?r:"value",null!==(i=a[1])&&void 0!==i?i:"density"]}clone(){return new tUt(null,nSt(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"DensityTransform ".concat(oSt(this.transform))}assemble(){const t=this.transform,{density:e}=t,n=VCt(t,["density"]);return Object.assign({type:"kde",field:e},n)}}class eUt extends NRt{constructor(t,e){super(t),this.filter=e}clone(){return new eUt(null,Object.assign({},this.filter))}static make(t,e){const{config:n,mark:r,markDef:i}=e;if("filter"!==IIt("invalid",i,n))return null;const a=e.reduceFieldDef(((t,n,i)=>{const a=oNt(i)&&e.getScaleComponent(i);if(a){KFt(a.get("type"))&&"count"!==n.aggregate&&!rEt(r)&&(t[n.field]=n)}return t}),{});return vSt(a).length?new eUt(t,a):null}dependentFields(){return new Set(vSt(this.filter))}producedFields(){return new Set}hash(){return"FilterInvalid ".concat(oSt(this.filter))}assemble(){const t=vSt(this.filter).reduce(((t,e)=>{const n=this.filter[e],r=aIt(n,{expr:"datum"});return null!==n&&("temporal"===n.type?t.push("(isDate(".concat(r,") || (isValid(").concat(r,") && isFinite(+").concat(r,")))")):"quantitative"===n.type&&(t.push("isValid(".concat(r,")")),t.push("isFinite(+".concat(r,")")))),t}),[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class nUt extends NRt{constructor(t,e){super(t),this.transform=e,this.transform=nSt(e);const{flatten:n,as:r=[]}=this.transform;this.transform.as=n.map(((t,e)=>{var n;return null!==(n=r[e])&&void 0!==n?n:t}))}clone(){return new nUt(this.parent,nSt(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return"FlattenTransform ".concat(oSt(this.transform))}assemble(){const{flatten:t,as:e}=this.transform;return{type:"flatten",fields:t,as:e}}}class rUt extends NRt{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=nSt(e);const a=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=a[0])&&void 0!==r?r:"key",null!==(i=a[1])&&void 0!==i?i:"value"]}clone(){return new rUt(null,nSt(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return"FoldTransform ".concat(oSt(this.transform))}assemble(){const{fold:t,as:e}=this.transform;return{type:"fold",fields:t,as:e}}}class iUt extends NRt{constructor(t,e,n,r){super(t),this.fields=e,this.geojson=n,this.signal=r}clone(){return new iUt(null,nSt(this.fields),this.geojson,this.signal)}static parseAll(t,e){if(e.component.projection&&!e.component.projection.isFit)return t;let n=0;for(const r of[[REt,OEt],[BEt,zEt]]){const i=r.map((t=>{const n=mIt(e.encoding[t]);return YDt(n)?n.field:KDt(n)?{expr:"".concat(n.datum)}:tIt(n)?{expr:"".concat(n.value)}:void 0}));(i[0]||i[1])&&(t=new iUt(t,i,null,e.getName("geojson_".concat(n++))))}if(e.channelHasField(UEt)){const r=e.typedFieldDef(UEt);r.type===OFt&&(t=new iUt(t,null,r.field,e.getName("geojson_".concat(n++))))}return t}dependentFields(){var t;const e=(null!==(t=this.fields)&&void 0!==t?t:[]).filter(jCt);return new Set([...this.geojson?[this.geojson]:[],...e])}producedFields(){return new Set}hash(){return"GeoJSON ".concat(this.geojson," ").concat(this.signal," ").concat(oSt(this.fields))}assemble(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}class aUt extends NRt{constructor(t,e,n,r){super(t),this.projection=e,this.fields=n,this.as=r}clone(){return new aUt(null,this.projection,nSt(this.fields),nSt(this.as))}static parseAll(t,e){if(!e.projectionName())return t;for(const n of[[REt,OEt],[BEt,zEt]]){const r=n.map((t=>{const n=mIt(e.encoding[t]);return YDt(n)?n.field:KDt(n)?{expr:"".concat(n.datum)}:tIt(n)?{expr:"".concat(n.value)}:void 0})),i=n[0]===BEt?"2":"";(r[0]||r[1])&&(t=new aUt(t,e.projectionName(),r,[e.getName("x"+i),e.getName("y"+i)]))}return t}dependentFields(){return new Set(this.fields.filter(jCt))}producedFields(){return new Set(this.as)}hash(){return"Geopoint ".concat(this.projection," ").concat(oSt(this.fields)," ").concat(oSt(this.as))}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class oUt extends NRt{constructor(t,e){super(t),this.transform=e}clone(){return new oUt(null,nSt(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:e=0,stop:n,step:r}=t,i=[e,n,...r?[r]:[]].join(",");return{signal:"sequence(".concat(i,")")}}static makeFromTransform(t,e){return new oUt(t,e)}static makeFromEncoding(t,e){const n=e.encoding,r=n.x,i=n.y;if(YDt(r)&&YDt(i)){const a=r.impute?r:i.impute?i:void 0;if(void 0===a)return;const o=r.impute?i:i.impute?r:void 0,{method:s,value:c,frame:u,keyvals:l}=a.impute,h=YIt(e.mark,n);return new oUt(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:a.field,key:o.field},s?{method:s}:{}),void 0!==c?{value:c}:{}),u?{frame:u}:{}),void 0!==l?{keyvals:l}:{}),h.length?{groupby:h}:{}))}return null}hash(){return"Impute ".concat(oSt(this.transform))}assemble(){const{impute:t,key:e,keyvals:n,method:r,groupby:i,value:a,frame:o=[null,null]}=this.transform,s=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:e},n?{keyvals:(c=n,void 0!==(null===c||void 0===c?void 0:c.stop)?this.processSequence(n):n)}:{}),{method:"value"}),i?{groupby:i}:{}),{value:r&&"value"!==r?null:a});var c;if(r&&"value"!==r){return[s,Object.assign({type:"window",as:["imputed_".concat(t,"_value")],ops:[r],fields:[t],frame:o,ignorePeers:!1},i?{groupby:i}:{}),{type:"formula",expr:"datum.".concat(t," === null ? datum.imputed_").concat(t,"_value : datum.").concat(t),as:t}]}return[s]}}class sUt extends NRt{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=nSt(e);const a=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=a[0])&&void 0!==r?r:e.on,null!==(i=a[1])&&void 0!==i?i:e.loess]}clone(){return new sUt(null,nSt(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"LoessTransform ".concat(oSt(this.transform))}assemble(){const t=this.transform,{loess:e,on:n}=t,r=VCt(t,["loess","on"]);return Object.assign({type:"loess",x:n,y:e},r)}}class cUt extends NRt{constructor(t,e,n){super(t),this.transform=e,this.secondary=n}clone(){return new cUt(null,nSt(this.transform),this.secondary)}static make(t,e,n,r){const i=e.component.data.sources,{from:a}=n;let o=null;if(function(t){return"data"in t}(a)){let t=AUt(a.data,i);t||(t=new MPt(a.data),i.push(t));const n=e.getName("lookup_".concat(r));o=new FRt(t,n,"lookup",e.component.data.outputNodeRefCounts),e.component.data.outputNodes[n]=o}else if(function(t){return"selection"in t}(a)){const t=a.selection;if(n=Object.assign({as:t},n),o=e.getSelectionComponent(wSt(t),t).materialized,!o)throw new Error('Cannot define and lookup the "'.concat(t,'" selection in the same view. ')+"Try moving the lookup into a second, layered view?")}return new cUt(t,n,o.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?RCt(this.transform.as):this.transform.from.fields)}hash(){return"Lookup ".concat(oSt({transform:this.transform,secondary:this.secondary}))}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:RCt(this.transform.as)}:{});else{let e=this.transform.as;jCt(e)||(XNt('If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.'),e="_lookup"),t={as:[e]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}class uUt extends NRt{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=nSt(e);const a=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=a[0])&&void 0!==r?r:"prob",null!==(i=a[1])&&void 0!==i?i:"value"]}clone(){return new uUt(null,nSt(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"QuantileTransform ".concat(oSt(this.transform))}assemble(){const t=this.transform,{quantile:e}=t,n=VCt(t,["quantile"]);return Object.assign({type:"quantile",field:e},n)}}class lUt extends NRt{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=nSt(e);const a=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=a[0])&&void 0!==r?r:e.on,null!==(i=a[1])&&void 0!==i?i:e.regression]}clone(){return new lUt(null,nSt(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"RegressionTransform ".concat(oSt(this.transform))}assemble(){const t=this.transform,{regression:e,on:n}=t,r=VCt(t,["regression","on"]);return Object.assign({type:"regression",x:n,y:e},r)}}class hUt extends NRt{constructor(t,e){super(t),this.transform=e}clone(){return new hUt(null,nSt(this.transform))}addDimensions(t){var e;this.transform.groupby=dSt((null!==(e=this.transform.groupby)&&void 0!==e?e:[]).concat(t),(t=>t))}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}hash(){return"PivotTransform ".concat(oSt(this.transform))}assemble(){const{pivot:t,value:e,groupby:n,limit:r,op:i}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:e},void 0!==r?{limit:r}:{}),void 0!==i?{op:i}:{}),void 0!==n?{groupby:n}:{})}}class dUt extends NRt{constructor(t,e){super(t),this.transform=e}clone(){return new dUt(null,nSt(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return"SampleTransform ".concat(oSt(this.transform))}assemble(){return{type:"sample",size:this.transform.sample}}}function fUt(t){let e=0;return function n(r,i){var a;if(r instanceof MPt&&!r.isGenerator&&!SOt(r.data)){t.push(i);i={name:null,source:i.name,transform:[]}}if(r instanceof YPt&&(r.parent instanceof MPt&&!i.source?(i.format=Object.assign(Object.assign({},null!==(a=i.format)&&void 0!==a?a:{}),{parse:r.assembleFormatParse()}),i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof VPt){i.name||(i.name="data_".concat(e++)),!i.source||i.transform.length>0?(t.push(i),r.data=i.name):r.data=i.source;for(const e of r.assemble())t.push(e)}else{if((r instanceof RPt||r instanceof zPt||r instanceof eUt||r instanceof pLt||r instanceof OLt||r instanceof aUt||r instanceof iUt||r instanceof WPt||r instanceof cUt||r instanceof ZPt||r instanceof KPt||r instanceof rUt||r instanceof nUt||r instanceof tUt||r instanceof sUt||r instanceof uUt||r instanceof lUt||r instanceof XPt||r instanceof dUt||r instanceof hUt)&&i.transform.push(r.assemble()),(r instanceof IPt||r instanceof DRt||r instanceof oUt||r instanceof QPt)&&i.transform.push(...r.assemble()),r instanceof FRt)if(i.source&&0===i.transform.length)r.setSource(i.source);else if(r.parent instanceof FRt)r.setSource(i.name);else if(i.name||(i.name="data_".concat(e++)),r.setSource(i.name),1===r.numChildren()){t.push(i);i={name:null,source:i.name,transform:[]}}switch(r.numChildren()){case 0:r instanceof FRt&&(!i.source||i.transform.length>0)&&t.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name="data_".concat(e++));let a=i.name;!i.source||i.transform.length>0?t.push(i):a=i.source;for(const t of r.children){n(t,{name:null,source:a,transform:[]})}break}}}}}function pUt(t){return"top"===t||"left"===t||hFt(t)?"header":"footer"}function gUt(t,e){var n;const{facet:r,config:i,child:a,component:o}=t;if(t.channelHasField(e)){const s=r[e],c=BLt("title",null,i,e);let u=hIt(s,i,{allowDisabling:!0,includeDefault:void 0===c||!!c});a.component.layoutHeaders[e].title&&(u=NCt(u)?u.join(", "):u,u+=" / "+a.component.layoutHeaders[e].title,a.component.layoutHeaders[e].title=null);const l=BLt("labelOrient",s,i,e),h=DSt((null!==(n=s.header)&&void 0!==n?n:{}).labels,i.header.labels,!0),d=cSt(["bottom","right"],l)?"footer":"header";o.layoutHeaders[e]={title:u,facetFieldDef:s,[d]:"facet"===e?[]:[mUt(t,e,h)]}}}function mUt(t,e,n){const r="row"===e?"height":"width";return{labels:n,sizeSignal:t.child.component.layoutSize.get(r)?t.child.getSizeSignalRef(r):void 0,axes:[]}}function vUt(t,e){var n;const{child:r}=t;if(r.component.axes[e]){const{layoutHeaders:i,resolve:a}=t.component;if(a.axis[e]=iPt(a,e),"shared"===a.axis[e]){const a="x"===e?"column":"row",o=i[a];for(const i of r.component.axes[e]){const e=pUt(i.get("orient"));o[e]=null!==(n=o[e])&&void 0!==n?n:[mUt(t,a,!1)];const r=bLt(i,"main",t.config,{header:!0});r&&o[e][0].axes.push(r),i.mainExtracted=!0}}}}function yUt(t){bUt(t);const e=1===t.layout.columns?"width":"childWidth",n=void 0===t.layout.columns?"height":"childHeight";xUt(t,e),xUt(t,n)}function bUt(t){for(const e of t.children)e.parseLayoutSize()}function xUt(t,e){const n=ePt(e),r=YTt(n),i=t.component.resolve,a=t.component.layoutSize;let o;for(const s of t.children){const t=s.component.layoutSize.getWithExplicit(n),e=i.scale[r];if("independent"===e&&"step"===t.value){o=void 0;break}if(o){if("independent"===e&&o.value!==t.value){o=void 0;break}o=AOt(o,t,n,"")}else o=t}if(o){for(const r of t.children)t.renameSignal(r.getName(n),t.getName(e)),r.component.layoutSize.set(n,"merged",!1);a.setWithExplicit(e,o)}else a.setWithExplicit(e,{explicit:!1,value:void 0})}function wUt(t,e){const n="width"===e?"x":"y",r=t.config,i=t.getScaleComponent(n);if(i){const t=i.get("type"),n=i.get("range");if(XFt(t)){const t=MMt(r.view,e);return dFt(n)||TMt(t)?"step":t}return DMt(r.view,e)}if(t.hasProjection||"arc"===t.mark)return DMt(r.view,e);{const t=MMt(r.view,e);return TMt(t)?t.step:t}}function kUt(t,e,n){return aIt(e,Object.assign({suffix:"by_".concat(aIt(t))},null!==n&&void 0!==n?n:{}))}class _Ut extends Jjt{constructor(t,e,n,r){super(t,"facet",e,n,r,t.resolve),this.child=QUt(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet,r)}initFacet(t,e){return BDt(t)?HIt(t,((t,n,r)=>cSt([_Et,AEt],r)?void 0===n.field?(XNt(INt(n,r)),t):(t[r]=vIt(n,r,e),t):(XNt(MNt(r,"facet")),t)),{}):{facet:vIt(t,"facet",e)}}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=SUt(this),this.child.parseData()}parseLayoutSize(){bUt(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),function(t){for(const e of lTt)gUt(t,e);vUt(t,"x"),vUt(t,"y")}(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,e,n;const r={};for(const i of lTt)for(const a of jLt){const o=this.component.layoutHeaders[i],s=o[a],{facetFieldDef:c}=o;if(c){const e=BLt("titleOrient",c,this.config,i);if(cSt(["right","bottom"],e)){const n=zLt(i,e);r.titleAnchor=null!==(t=r.titleAnchor)&&void 0!==t?t:{},r.titleAnchor[n]="end"}}if(null===s||void 0===s?void 0:s[0]){const t="row"===i?"height":"width",s="header"===a?"headerBand":"footerBand";"facet"===i||this.child.component.layoutSize.get(t)||(r[s]=null!==(e=r[s])&&void 0!==e?e:{},r[s][i]=.5),o.title&&(r.offset=null!==(n=r.offset)&&void 0!==n?n:{},r.offset["row"===i?"rowTitle":"columnTitle"]=10)}}return r}assembleDefaultLayout(){const{column:t,row:e}=this.facet,n=t?this.columnDistinctSignal():e?1:void 0;let r="all";return(e||"independent"!==this.component.resolve.scale.x)&&(t||"independent"!==this.component.resolve.scale.y)||(r="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),n?{columns:n}:{}),{bounds:"full",align:r})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof _Ut)){const t=this.getName("column_domain");return{signal:"length(data('".concat(t,"'))")}}}assembleGroup(t){return this.parent&&this.parent instanceof _Ut?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:aIt(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],e=[],n=[];if(this.child instanceof _Ut){if(this.child.channelHasField("column")){const r=aIt(this.child.facet.column);t.push(r),e.push("distinct"),n.push("distinct_".concat(r))}}else for(const r of VTt){const i=this.child.component.scales[r];if(i&&!i.merged){const a=i.get("type"),o=i.get("range");if(XFt(a)&&dFt(o)){const i=Ejt(Tjt(this.child,r));i?(t.push(i),e.push("distinct"),n.push("distinct_".concat(i))):XNt("Unknown field for ".concat(r,". Cannot calculate view size."))}}}return{fields:t,ops:e,as:n}}assembleFacet(){const{name:t,data:e}=this.component.data.facetRoot,{row:n,column:r}=this.facet,{fields:i,ops:a,as:o}=this.getCardinalityAggregateForChild(),s=[];for(const u of lTt){const t=this.facet[u];if(t){s.push(aIt(t));const{bin:e,sort:c}=t;if(fNt(e)&&s.push(aIt(t,{binSuffix:"end"})),RDt(c)){const{field:e,op:s=DDt}=c,u=kUt(t,c);n&&r?(i.push(u),a.push("max"),o.push(u)):(i.push(e),a.push(s),o.push(u))}else if(NCt(c)){const e=RLt(t,u);i.push(e),a.push("max"),o.push(e)}}}const c=!!n&&!!r;return Object.assign({name:t,data:e,groupby:s},c||i.length>0?{aggregate:Object.assign(Object.assign({},c?{cross:c}:{}),i.length?{fields:i,ops:a,as:o}:{})}:{})}facetSortFields(t){const{facet:e}=this,n=e[t];return n?RDt(n.sort)?[kUt(n,n.sort,{expr:"datum"})]:NCt(n.sort)?[RLt(n,t,{expr:"datum"})]:[aIt(n,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:e}=this,n=e[t];if(n){const{sort:t}=n;return[(RDt(t)?t.order:!NCt(t)&&t)||"ascending"]}return[]}assembleLabelTitle(){const{facet:t,config:e}=this;if(t.facet)return HLt(t.facet,"facet",e);const n={row:["top","bottom"],column:["left","right"]};for(const r of PLt)if(t[r]){const i=BLt("labelOrient",t[r],e,r);if(cSt(n[r],i))return HLt(t[r],r,e)}}assembleMarks(){const{child:t}=this,e=function(t){const e=[],n=fUt(e);for(const r of t.children)n(r,{source:t.name,name:null,transform:[]});return e}(this.component.data.facetRoot),n=t.assembleGroupEncodeEntry(!1),r=this.assembleLabelTitle()||t.assembleTitle(),i=t.assembleGroupStyle(),a=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},r?{title:r}:{}),i?{style:i}:{}),{from:{facet:this.assembleFacet()},sort:{field:lTt.map((t=>this.facetSortFields(t))).flat(),order:lTt.map((t=>this.facetSortOrder(t))).flat()}}),e.length>0?{data:e}:{}),n?{encode:{update:n}}:{}),t.assembleGroup(function(t,e){if(t.component.selection&&vSt(t.component.selection).length){const n=UCt(t.getName("cell"));e.unshift({name:"facet",value:{},on:[{events:pCt("mousemove","scope"),update:"isTuple(facet) ? facet : group(".concat(n,").datum")}]})}return rzt(e)}(this,[])));return[a]}getMapping(){return this.facet}}function AUt(t,e){var n,r,i,a,o,s,c,u,l,h;for(const d of e){const e=d.data;if((!t.name||!d.hasName()||t.name===d.dataName)&&((!(null===(n=t.format)||void 0===n?void 0:n.mesh)||!(null===(r=e.format)||void 0===r?void 0:r.feature))&&(!(null===(i=t.format)||void 0===i?void 0:i.feature)&&!(null===(a=e.format)||void 0===a?void 0:a.feature)||(null===(o=t.format)||void 0===o?void 0:o.feature)===(null===(s=e.format)||void 0===s?void 0:s.feature))&&(!(null===(c=t.format)||void 0===c?void 0:c.mesh)&&!(null===(u=e.format)||void 0===u?void 0:u.mesh)||(null===(l=t.format)||void 0===l?void 0:l.mesh)===(null===(h=e.format)||void 0===h?void 0:h.mesh))))if(EOt(t)&&EOt(e)){if(eSt(t.values,e.values))return d}else if(SOt(t)&&SOt(e)){if(t.url===e.url)return d}else if(TOt(t)&&t.name===d.dataName)return d}return null}function CUt(t,e){if(t.data||!t.parent){if(null===t.data){const t=new MPt({values:[]});return e.push(t),t}const n=AUt(t.data,e);if(n)return NOt(t.data)||(n.data.format=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(const i of n)hSt(t,null!==i&&void 0!==i?i:{});return t}({},t.data.format,n.data.format)),!n.hasName()&&t.data.name&&(n.dataName=t.data.name),n;{const n=new MPt(t.data);return e.push(n),n}}return t.parent.component.data.facetRoot?t.parent.component.data.facetRoot:t.parent.component.data.main}function SUt(t){var e,n,r,i,a,o,s,c,u,l;let h=CUt(t,t.component.data.sources);const{outputNodes:d,outputNodeRefCounts:f}=t.component.data,p=t.parent?t.parent.component.data.ancestorParse.clone():new COt,g=t.data;NOt(g)?(FOt(g)?h=new zPt(h,g.sequence):IOt(g)&&(h=new RPt(h,g.graticule)),p.parseNothing=!0):null===(null===(e=null===g||void 0===g?void 0:g.format)||void 0===e?void 0:e.parse)&&(p.parseNothing=!0),h=null!==(n=YPt.makeExplicit(h,t,p))&&void 0!==n?n:h,h=new XPt(h);const m=t.parent&&Zjt(t.parent);(Xjt(t)||Kjt(t))&&m&&(h=null!==(r=IPt.makeFromEncoding(h,t))&&void 0!==r?r:h),t.transforms.length>0&&(h=function(t,e,n){var r,i;let a=0;for(const o of e.transforms){let s,c;if(HOt(o))c=t=new OLt(t,o),s="derived";else if(ROt(o)){const i=GPt(o);c=t=null!==(r=YPt.makeWithAncestors(t,{},i,n))&&void 0!==r?r:t,t=new pLt(t,e,o.filter)}else if(YOt(o))c=t=IPt.makeFromTransform(t,o,e),s="number";else if(KOt(o))s="date",void 0===n.getWithExplicit(o.field).value&&(t=new YPt(t,{[o.field]:s}),n.set(o.field,s,!1)),c=t=DRt.makeFromTransform(t,o);else if(QOt(o))c=t=WPt.makeFromTransform(t,o),s="number",yzt(e)&&(t=new XPt(t));else if(zOt(o))c=t=cUt.make(t,e,o,a++),s="derived";else if(VOt(o))c=t=new ZPt(t,o),s="number";else if(qOt(o))c=t=new KPt(t,o),s="number";else if(ZOt(o))c=t=QPt.makeFromTransform(t,o),s="derived";else if($Ot(o))c=t=new rUt(t,o),s="derived";else if(GOt(o))c=t=new nUt(t,o),s="derived";else if(BOt(o))c=t=new hUt(t,o),s="derived";else if(WOt(o))t=new dUt(t,o);else if(XOt(o))c=t=oUt.makeFromTransform(t,o),s="derived";else if(LOt(o))c=t=new tUt(t,o),s="derived";else if(POt(o))c=t=new uUt(t,o),s="derived";else if(jOt(o))c=t=new lUt(t,o),s="derived";else{if(!UOt(o)){XNt(TNt(o));continue}c=t=new sUt(t,o),s="derived"}if(c&&void 0!==s)for(const t of null!==(i=c.producedFields())&&void 0!==i?i:[])n.set(t,s,!1)}return t}(h,t,p));const v=function(t){const e={};if(Xjt(t)&&t.component.selection)for(const n of vSt(t.component.selection)){const r=t.component.selection[n];for(const t of r.project.items)!t.channel&&FSt(t.field)>1&&(e[t.field]="flatten")}return e}(t),y=HPt(t);h=null!==(i=YPt.makeWithAncestors(h,{},Object.assign(Object.assign({},v),y),p))&&void 0!==i?i:h,Xjt(t)&&(h=iUt.parseAll(h,t),h=aUt.parseAll(h,t)),(Xjt(t)||Kjt(t))&&(m||(h=null!==(a=IPt.makeFromEncoding(h,t))&&void 0!==a?a:h),h=null!==(o=DRt.makeFromEncoding(h,t))&&void 0!==o?o:h,h=OLt.parseAllForSortIndex(h,t));const b=t.getName(OOt),x=new FRt(h,b,OOt,f);if(d[b]=x,h=x,Xjt(t)){const e=WPt.makeFromEncoding(h,t);e&&(h=e,yzt(t)&&(h=new XPt(h))),h=null!==(s=oUt.makeFromEncoding(h,t))&&void 0!==s?s:h,h=null!==(c=QPt.makeFromEncoding(h,t))&&void 0!==c?c:h}Xjt(t)&&(h=null!==(u=eUt.make(h,t))&&void 0!==u?u:h);const w=t.getName(MOt),k=new FRt(h,w,MOt,f);d[w]=k,h=k,Xjt(t)&&function(t,e){mzt(t,(n=>{const r=n.name,i=t.getName("lookup_".concat(r));t.component.data.outputNodes[i]=n.materialized=new FRt(new pLt(e,t,{selection:r}),i,"lookup",t.component.data.outputNodeRefCounts)}))}(t,k);let _=null;if(Kjt(t)){const e=t.getName("facet");h=null!==(l=function(t,e){const{row:n,column:r}=e;if(n&&r){let e=null;for(const i of[n,r])if(RDt(i.sort)){const{field:n,op:r=DDt}=i.sort;t=e=new KPt(t,{joinaggregate:[{op:r,field:n,as:kUt(i,i.sort,{forAs:!0})}],groupby:[aIt(i)]})}return e}return null}(h,t.facet))&&void 0!==l?l:h,_=new VPt(h,t,e,k.getSource()),d[e]=_}return Object.assign(Object.assign({},t.component.data),{outputNodes:d,outputNodeRefCounts:f,raw:x,main:k,facetRoot:_,ancestorParse:p})}class EUt extends $jt{constructor(t,e,n,r){var i,a,o,s;super(t,"concat",e,n,r,t.resolve),"shared"!==(null===(a=null===(i=t.resolve)||void 0===i?void 0:i.axis)||void 0===a?void 0:a.x)&&"shared"!==(null===(s=null===(o=t.resolve)||void 0===o?void 0:o.axis)||void 0===s?void 0:s.y)||XNt("Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415)."),this.children=this.getChildren(t).map(((t,e)=>QUt(t,this,this.getName("concat_"+e),void 0,r)))}parseData(){this.component.data=SUt(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const e of vSt(t.component.selection))this.component.selection[e]=t.component.selection[e]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return SMt(t)?t.vconcat:EMt(t)?t.hconcat:t.concat}parseLayoutSize(){yUt(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce(((t,e)=>e.assembleSelectionTopLevelSignals(t)),t)}assembleSignals(){return this.children.forEach((t=>t.assembleSignals())),[]}assembleLayoutSignals(){const t=ZLt(this);for(const e of this.children)t.push(...e.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce(((t,e)=>e.assembleSelectionData(t)),t)}assembleMarks(){return this.children.map((t=>{const e=t.assembleTitle(),n=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},e?{title:e}:{}),n?{style:n}:{}),r?{encode:{update:r}}:{}),t.assembleGroup())}))}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},null!=t?{columns:t}:{}),{bounds:"full",align:"each"})}}const TUt=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},PSt),{labelExpr:1,encode:1}),NUt=vSt(TUt);class FUt extends bOt{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(),this.explicit=t,this.implicit=e,this.mainExtracted=n}clone(){return new FUt(nSt(this.explicit),nSt(this.implicit),this.mainExtracted)}hasAxisPart(t){return"axis"===t||("grid"===t||"title"===t?!!this.get(t):!(!1===(e=this.get(t))||null===e));var e}hasOrientSignalRef(){return hFt(this.explicit.orient)}}const DUt={bottom:"top",top:"bottom",left:"right",right:"left"};function IUt(t,e){if(!t)return e.map((t=>t.clone()));{if(t.length!==e.length)return;const n=t.length;for(let r=0;r<n;r++){const n=t[r],i=e[r];if(!!n!==!!i)return;if(n&&i){const e=n.getWithExplicit("orient"),a=i.getWithExplicit("orient");if(e.explicit&&a.explicit&&e.value!==a.value)return;t[r]=MUt(n,i)}}}return t}function MUt(t,e){for(const n of NUt){const r=AOt(t.getWithExplicit(n),e.getWithExplicit(n),n,"axis",((t,e)=>{switch(n){case"title":return PIt(t,e);case"gridScale":return{explicit:t.explicit,value:DSt(t.value,e.value)}}return _Ot(t,e,n,"axis")}));t.setWithExplicit(n,r)}return t}function OUt(t,e,n,r,i){if("disable"===e)return void 0!==n;switch(n=n||{},e){case"titleAngle":case"labelAngle":return t===(hFt(n.labelAngle)?n.labelAngle:MSt(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(t===MLt(r,i))return!0}return t===n[e]}const RUt=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function zUt(t,e){var n,r,i;let a=e.axis(t);const o=new FUt,s=mIt(e.encoding[t]),{mark:c,config:u}=e,l=(null===a||void 0===a?void 0:a.orient)||(null===(n=u["x"===t?"axisX":"axisY"])||void 0===n?void 0:n.orient)||(null===(r=u.axis)||void 0===r?void 0:r.orient)||function(t){return"x"===t?"bottom":"left"}(t),h=e.getScaleComponent(t).get("type"),d=SLt(t,h,l,e.config),f=void 0!==a?!a:TLt("disable",u,null===a||void 0===a?void 0:a.style,d).configValue;if(o.set("disable",f,void 0!==a),f)return o;a=a||{};const p=function(t,e,n,r,i){const a=null===e||void 0===e?void 0:e.labelAngle;if(void 0!==a)return hFt(a)?a:MSt(a);{const{configValue:a}=TLt("labelAngle",t.config,null===e||void 0===e?void 0:e.style,i);return void 0!==a?MSt(a):n===SEt&&cSt([MFt,DFt],r.type)?270:void 0}}(e,a,t,s,d),g={fieldOrDatumDef:s,axis:a,channel:t,model:e,scaleType:h,orient:l,labelAngle:p,mark:c,config:u};for(const y of NUt){const n=y in NLt?NLt[y](g):USt(y)?a[y]:void 0,r=void 0!==n,i=OUt(n,y,a,e,t);if(r&&i)o.set(y,n,i);else{const{configValue:t,configFrom:s}=USt(y)&&"values"!==y?TLt(y,e.config,a.style,d):{},c=void 0!==t;r&&!c?o.set(y,n,i):("vgAxisConfig"!==s||RUt.has(y)&&c||zSt(t)||hFt(t))&&o.set(y,t,!1)}}const m=null!==(i=a.encoding)&&void 0!==i?i:{},v=BSt.reduce(((n,r)=>{var i;if(!o.hasAxisPart(r))return n;const a=nPt(null!==(i=m[r])&&void 0!==i?i:{},e),s="labels"===r?function(t,e,n){var r;const{encoding:i,config:a}=t,o=null!==(r=mIt(i[e]))&&void 0!==r?r:mIt(i[STt(e)]),s=t.axis(e)||{},{format:c,formatType:u}=s;return bDt(u)?Object.assign({text:ADt({fieldOrDatumDef:o,field:"datum.value",format:c,formatType:u,config:a})},n):n}(e,t,a):a;return void 0===s||mSt(s)||(n[r]={update:s}),n}),{});return mSt(v)||o.set("encode",v,!!a.encoding||void 0!==a.labelAngle),o}function BUt(t,e,n,r){let{graticule:i}=r;const a=oEt(t)?Object.assign({},t):{type:t},o=IIt("orient",a,n);var s,c;if(a.orient=function(t,e,n){switch(t){case XSt:case tEt:case eEt:case ZSt:case KSt:case HSt:return}const{x:r,y:i,x2:a,y2:o}=e;switch(t){case GSt:if(YDt(r)&&(pNt(r.bin)||YDt(i)&&i.aggregate&&!r.aggregate))return"vertical";if(YDt(i)&&(pNt(i.bin)||YDt(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(o||a){if(n)return n;if(!a&&(YDt(r)&&r.type===FFt&&!fNt(r.bin)||ZDt(r)))return"horizontal";if(!o&&(YDt(i)&&i.type===FFt&&!fNt(i.bin)||ZDt(i)))return"vertical"}case QSt:if(a&&(!YDt(r)||!pNt(r.bin))&&o&&(!YDt(i)||!pNt(i.bin)))return;case qSt:if(o)return YDt(i)&&pNt(i.bin)?"horizontal":"vertical";if(a)return YDt(r)&&pNt(r.bin)?"vertical":"horizontal";if(t===QSt){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case YSt:case $St:{const e=QDt(r),a=QDt(i);if(e&&!a)return"tick"!==t?"horizontal":"vertical";if(!e&&a)return"tick"!==t?"vertical":"horizontal";if(e&&a){const e=r,a=i,o=e.type===IFt,s=a.type===IFt;return o&&!s?"tick"!==t?"vertical":"horizontal":!o&&s?"tick"!==t?"horizontal":"vertical":!e.aggregate&&a.aggregate?"tick"!==t?"vertical":"horizontal":e.aggregate&&!a.aggregate?"tick"!==t?"horizontal":"vertical":n||"vertical"}return n||void 0}}return"vertical"}(a.type,e,o),void 0!==o&&o!==a.orient&&XNt((s=a.orient,c=o,'Specified orient "'.concat(s,'" overridden with "').concat(c,'".'))),"bar"===a.type&&a.orient){const t=IIt("cornerRadiusEnd",a,n);if(void 0!==t){const n="horizontal"===a.orient&&e.x2||"vertical"===a.orient&&e.y2?["cornerRadius"]:uEt[a.orient];for(const e of n)a[e]=t;void 0!==a.cornerRadiusEnd&&delete a.cornerRadiusEnd}}void 0===IIt("opacity",a,n)&&(a.opacity=function(t,e){if(cSt([XSt,$St,tEt,eEt],t)&&!UIt(e))return.7;return}(a.type,e));void 0===a.filled&&(a.filled=!i&&function(t,e){const n=MIt("filled",t,e),r=t.type;return DSt(n,r!==XSt&&r!==YSt&&r!==QSt)}(a,n));return void 0===IIt("cursor",a,n)&&(a.cursor=function(t,e,n){if(e.href||t.href||IIt("href",t,n))return"pointer";return t.cursor}(a,e,n)),a}function LUt(t,e){const{config:n}=t;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},kRt(t,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),uRt("x",t,{defaultPos:"mid"})),uRt("y",t,{defaultPos:"mid"})),oRt("size",t)),oRt("angle",t)),function(t,e,n){if(n)return{shape:{value:n}};return oRt("shape",t)}(t,0,e))}const PUt={vgMark:"rule",encodeEntry:t=>{const{markDef:e}=t,n=e.orient;return t.encoding.x||t.encoding.y||t.encoding.latitude||t.encoding.longitude?Object.assign(Object.assign(Object.assign(Object.assign({},kRt(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),pRt("x",t,{defaultPos:"horizontal"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==n})),pRt("y",t,{defaultPos:"vertical"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==n})),oRt("size",t,{vgChannel:"strokeWidth"})):{}}},jUt={vgMark:"text",encodeEntry:t=>{const{config:e,encoding:n}=t;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},kRt(t,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),uRt("x",t,{defaultPos:"mid"})),uRt("y",t,{defaultPos:"mid"})),tRt(t)),oRt("size",t,{vgChannel:"fontSize"})),oRt("angle",t)),CRt("align",function(t,e,n){const r=IIt("align",t,n);if(void 0===r)return"center";return}(t.markDef,0,e))),CRt("baseline",function(t,e,n){const r=IIt("baseline",t,n);if(void 0===r)return"middle";return}(t.markDef,0,e))),uRt("radius",t,{defaultPos:null,isMidPoint:!0})),uRt("theta",t,{defaultPos:null,isMidPoint:!0}))}};const UUt={vgMark:"rect",encodeEntry:t=>{const{config:e,markDef:n}=t,r=n.orient,i="horizontal"===r?"width":"height",a="horizontal"===r?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},kRt(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),uRt("x",t,{defaultPos:"mid",vgChannel:"xc"})),uRt("y",t,{defaultPos:"mid",vgChannel:"yc"})),oRt("size",t,{defaultValue:WUt(t),vgChannel:i})),{[a]:TIt(IIt("thickness",n,e))})}};function WUt(t){var e;const{config:n,markDef:r}=t,{orient:i}=r,a="horizontal"===i?"width":"height",o=t.getScaleComponent("horizontal"===i?"x":"y"),s=null!==(e=IIt("size",r,n,{vgChannel:a}))&&void 0!==e?e:n.tick.bandSize;if(void 0!==s)return s;{const t=o?o.get("range"):void 0;if(t&&dFt(t)&&PCt(t.step))return 3*t.step/4;return 3*IMt(n.view,a)/4}}const VUt={arc:{vgMark:"arc",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},kRt(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),uRt("x",t,{defaultPos:"mid"})),uRt("y",t,{defaultPos:"mid"})),vRt(t,"radius","arc")),vRt(t,"theta","arc"))},area:{vgMark:"area",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign({},kRt(t,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),pRt("x",t,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===t.markDef.orient})),pRt("y",t,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===t.markDef.orient})),ARt(t))},bar:{vgMark:"rect",encodeEntry:t=>Object.assign(Object.assign(Object.assign({},kRt(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),vRt(t,"x","bar")),vRt(t,"y","bar"))},circle:{vgMark:"symbol",encodeEntry:t=>LUt(t,"circle")},geoshape:{vgMark:"shape",encodeEntry:t=>Object.assign({},kRt(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:t=>{const{encoding:e}=t,n=e.shape;return[Object.assign({type:"geoshape",projection:t.projectionName()},n&&YDt(n)&&n.type===OFt?{field:aIt(n,{expr:"datum"})}:{})]}},image:{vgMark:"image",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign({},kRt(t,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),vRt(t,"x","image")),vRt(t,"y","image")),tRt(t,"url"))},line:{vgMark:"line",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},kRt(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),uRt("x",t,{defaultPos:"mid"})),uRt("y",t,{defaultPos:"mid"})),oRt("size",t,{vgChannel:"strokeWidth"})),ARt(t))},point:{vgMark:"symbol",encodeEntry:t=>LUt(t)},rect:{vgMark:"rect",encodeEntry:t=>Object.assign(Object.assign(Object.assign({},kRt(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),vRt(t,"x","rect")),vRt(t,"y","rect"))},rule:PUt,square:{vgMark:"symbol",encodeEntry:t=>LUt(t,"square")},text:jUt,tick:UUt,trail:{vgMark:"trail",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},kRt(t,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),uRt("x",t,{defaultPos:"mid"})),uRt("y",t,{defaultPos:"mid"})),oRt("size",t)),ARt(t))}};function qUt(t){return cSt([YSt,qSt,JSt],t.mark)?function(t){const e=YIt(t.mark,t.encoding),n=YUt(t,{fromPrefix:e.length>0?GUt:""});return e.length>0?[{name:t.getName("pathgroup"),type:"group",from:{facet:{name:GUt+t.requestDataName(MOt),data:t.requestDataName(MOt),groupby:e}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}(t):cSt([GSt],t.mark)?function(t){const e=mFt.some((e=>IIt(e,t.markDef,t.config)));if(t.stack&&!t.fieldDef("size")&&e){const[e]=YUt(t,{fromPrefix:HUt}),n=t.scaleName(t.stack.fieldChannel),r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.vgField(t.stack.fieldChannel,e)},i=(t,e)=>{const i=[r({prefix:"min",suffix:"start",expr:e}),r({prefix:"max",suffix:"start",expr:e}),r({prefix:"min",suffix:"end",expr:e}),r({prefix:"max",suffix:"end",expr:e})];return"".concat(t,"(").concat(i.map((t=>"scale('".concat(n,"',").concat(t,")"))).join(","),")")};let a,o;"x"===t.stack.fieldChannel?(a=Object.assign(Object.assign({},rSt(e.encode.update,["y","yc","y2","height",...mFt])),{x:{signal:i("min","datum")},x2:{signal:i("max","datum")},clip:{value:!0}}),o={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},e.encode.update=Object.assign(Object.assign({},iSt(e.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(a=Object.assign(Object.assign({},rSt(e.encode.update,["x","xc","x2","width"])),{y:{signal:i("min","datum")},y2:{signal:i("max","datum")},clip:{value:!0}}),o={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},e.encode.update=Object.assign(Object.assign({},iSt(e.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const u of mFt){const n=MIt(u,t.markDef,t.config);e.encode.update[u]?(a[u]=e.encode.update[u],delete e.encode.update[u]):n&&(a[u]=TIt(n)),n&&(e.encode.update[u]={value:0})}const s=t.fieldDef(t.stack.groupbyChannel),c=aIt(s)?[aIt(s)]:[];((null===s||void 0===s?void 0:s.bin)||(null===s||void 0===s?void 0:s.timeUnit))&&c.push(aIt(s,{binSuffix:"end"}));return a=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce(((n,r)=>{if(e.encode.update[r])return Object.assign(Object.assign({},n),{[r]:e.encode.update[r]});{const e=MIt(r,t.markDef,t.config);return void 0!==e?Object.assign(Object.assign({},n),{[r]:TIt(e)}):n}}),a),a.stroke&&(a.strokeForeground={value:!0},a.strokeOffset={value:0}),[{type:"group",from:{facet:{data:t.requestDataName(MOt),name:HUt+t.requestDataName(MOt),groupby:c,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:a},marks:[{type:"group",encode:{update:o},marks:[e]}]}]}return YUt(t)}(t):YUt(t)}const GUt="faceted_path_";const HUt="stack_group_";function YUt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fromPrefix:""};const{mark:n,markDef:r,config:i}=t,a=DSt(r.clip,function(t){const e=t.getScaleComponent("x"),n=t.getScaleComponent("y");return!!(e&&e.get("selectionExtent")||n&&n.get("selectionExtent"))||void 0}(t),function(t){const e=t.component.projection;return!(!e||e.isFit)||void 0}(t)),o=DIt(r),s=t.encoding.key,c=function(t){const{encoding:e,stack:n,mark:r,markDef:i,config:a}=t,o=e.order;if(!(!NCt(o)&&tIt(o)&&sSt(o.value)||!o&&sSt(IIt("order",i,a)))){if((NCt(o)||YDt(o))&&!n)return zIt(o,{expr:"datum"});if(rEt(r)){const n="horizontal"===i.orient?"y":"x",r=e[n];if(YDt(r)){const e=r.sort;return NCt(e)?{field:aIt(r,{prefix:n,suffix:"sort_index",expr:"datum"})}:RDt(e)?{field:aIt({aggregate:UIt(t.encoding)?e.op:void 0,field:e.field},{expr:"datum"})}:ODt(e)?{field:aIt(t.fieldDef(e.encoding),{expr:"datum"}),order:e.order}:null===e?void 0:{field:aIt(r,{binSuffix:t.stack&&t.stack.impute?"mid":void 0,expr:"datum"})}}}}}(t),u=function(t){if(!t.component.selection)return null;const e=vSt(t.component.selection).length;let n=e,r=t.parent;for(;r&&0===n;)n=vSt(r.component.selection).length,r=r.parent;return n?{interactive:e>0}:null}(t),l=IIt("aria",r,i),h=VUt[n].postEncodingTransform?VUt[n].postEncodingTransform(t):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:t.getName("marks"),type:VUt[n].vgMark},a?{clip:!0}:{}),o?{style:o}:{}),s?{key:s.field}:{}),c?{sort:c}:{}),u||{}),!1===l?{aria:l}:{}),{from:{data:e.fromPrefix+t.requestDataName(MOt)},encode:{update:VUt[n].encodeEntry(t)}}),h?{transform:h}:{})]}class XUt extends Jjt{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4?arguments[4]:void 0;var a,o;super(t,"unit",e,n,i,void 0,NMt(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection={},this.children=[];const s=oEt(t.mark)?t.mark.type:t.mark;this.markDef=BUt(t.mark,null!==(a=t.encoding)&&void 0!==a?a:{},i,{graticule:t.data&&IOt(t.data)});const c=this.encoding=VIt(null!==(o=t.encoding)&&void 0!==o?o:{},this.markDef,i);this.size=function(t){let{encoding:e,size:n}=t;for(const r of VTt){const t=ETt(r);TMt(n[t])&&QDt(e[r])&&(delete n[t],XNt(jNt(t)))}return n}({encoding:c,size:NMt(t)?Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):r}),this.stack=ZMt(s,c),this.specifiedScales=this.initScales(s,c),this.specifiedAxes=this.initAxes(c),this.specifiedLegends=this.initLegend(c),this.specifiedProjection=t.projection,this.selection=t.selection}get hasProjection(){const{encoding:t}=this,e=this.mark===nEt,n=t&&oTt.some((e=>$Dt(t[e])));return e||n}scaleDomain(t){const e=this.specifiedScales[t];return e?e.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,e){return aNt.reduce(((t,n)=>{var r;const i=mIt(e[n]);return i&&(t[n]=null!==(r=i.scale)&&void 0!==r?r:{}),t}),{})}initAxes(t){return VTt.reduce(((e,n)=>{const r=t[n];if($Dt(r)||n===SEt&&$Dt(t.x2)||n===EEt&&$Dt(t.y2)){const t=$Dt(r)?r.axis:void 0;e[n]=t?Object.assign({},t):t}return e}),{})}initLegend(t){return rNt.reduce(((e,n)=>{const r=mIt(t[n]);if(r&&function(t){switch(t){case LEt:case PEt:case jEt:case WEt:case UEt:case qEt:case YEt:case XEt:return!0;case GEt:case HEt:case VEt:return!1}}(n)){const t=r.legend;e[n]=t?Object.assign({},t):t}return e}),{})}parseData(){this.component.data=SUt(this)}parseLayoutSize(){!function(t){const{size:e,component:n}=t;for(const r of VTt){const i=ETt(r);if(e[i]){const t=e[i];n.layoutSize.set(i,TMt(t)?"step":t,!0)}else{const e=wUt(t,i);n.layoutSize.set(i,e,!1)}}}(this)}parseSelections(){this.component.selection=function(t,e){var n;const r={},i=t.config.selection;for(const a of vSt(null!==e&&void 0!==e?e:{})){const o=nSt(e[a]),s=i[o.type],{fields:c,encodings:u}=s,l=VCt(s,["fields","encodings"]);for(const t in l)"encodings"===t&&o.fields||"fields"===t&&o.encodings||("mark"===t&&(o[t]=Object.assign(Object.assign({},l[t]),o[t])),void 0!==o[t]&&!0!==o[t]||(o[t]=null!==(n=l[t])&&void 0!==n?n:o[t]));const h=wSt(a),d=r[h]=Object.assign(Object.assign({},o),{name:h,events:jCt(o.on)?pCt(o.on,"scope"):nSt(o.on)});tzt(d,(n=>{n.has(d)&&n.parse&&n.parse(t,d,o,e[a])}))}return r}(this,this.selection)}parseMarkGroup(){this.component.mark=qUt(this)}parseAxesAndHeaders(){var t;this.component.axes=(t=this,VTt.reduce(((e,n)=>(t.component.scales[n]&&(e[n]=[zUt(n,t)]),e)),{}))}assembleSelectionTopLevelSignals(t){return function(t,e){let n=!1;if(mzt(t,((r,i)=>{const a=r.name,o=UCt(a+hzt),s=e.filter((t=>t.name===a));if(0===s.length){const t="global"===r.resolve?"union":r.resolve,n="multi"===r.type?", true)":")";e.push({name:r.name,update:"".concat(pzt,"(").concat(o,", ").concat(UCt(t)).concat(n)})}n=!0,i.topLevelSignals&&(e=i.topLevelSignals(t,r,e)),tzt(r,(n=>{n.topLevelSignals&&(e=n.topLevelSignals(t,r,e))}))})),n){const t=e.filter((t=>"unit"===t.name));0===t.length&&e.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]})}return rzt(e)}(this,t)}assembleSignals(){return[...xLt(this),...(t=this,e=[],mzt(t,((n,r)=>{const i=n.name;let a=r.modifyExpr(t,n);e.push(...r.signals(t,n)),tzt(n,(r=>{r.signals&&(e=r.signals(t,n,e)),r.modifyExpr&&(a=r.modifyExpr(t,n,a))})),e.push({name:i+fzt,on:[{events:{signal:n.name+dzt},update:"modify(".concat(UCt(n.name+hzt),", ").concat(a,")")}]})})),rzt(e))];var t,e}assembleSelectionData(t){return function(t,e){const n=[...e];return mzt(t,(e=>{const r={name:e.name+hzt};if(e.init){const n=e.project.items.map((t=>{const{signals:e}=t;return VCt(t,["signals"])})),i=e.init.map((t=>ezt(t,!1)));r.values="interval"===e.type?[{unit:vzt(t,{escape:!1}),fields:n,values:i}]:i.map((e=>({unit:vzt(t,{escape:!1}),fields:n,values:e})))}n.filter((t=>t.name===e.name+hzt)).length||n.push(r)})),n}(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return ZLt(this)}assembleMarks(){var t;let e=null!==(t=this.component.mark)&&void 0!==t?t:[];return this.parent&&Zjt(this.parent)||(e=nzt(this,e)),e.map(this.correctDataNames)}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return jIt(this.encoding,t)}fieldDef(t){return gIt(this.encoding[t])}typedFieldDef(t){const e=this.fieldDef(t);return JDt(e)?e:null}}class KUt extends $jt{constructor(t,e,n,r,i){super(t,"layer",e,n,i,t.resolve,t.view);const a=Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map(((t,e)=>{if(GMt(t))return new KUt(t,this,this.getName("layer_"+e),a,i);if(dEt(t))return new XUt(t,this,this.getName("layer_"+e),a,i);throw new Error(yNt(t))}))}parseData(){this.component.data=SUt(this);for(const t of this.children)t.parseData()}parseLayoutSize(){var t;bUt(t=this),xUt(t,"width"),xUt(t,"height")}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const e of vSt(t.component.selection))this.component.selection[e]=t.component.selection[e]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){!function(t){var e;const{axes:n,resolve:r}=t.component,i={top:0,bottom:0,right:0,left:0};for(const a of t.children){a.parseAxesAndHeaders();for(const e of vSt(a.component.axes))r.axis[e]=iPt(t.component.resolve,e),"shared"===r.axis[e]&&(n[e]=IUt(n[e],a.component.axes[e]),n[e]||(r.axis[e]="independent",delete n[e]))}for(const a of VTt){for(const o of t.children)if(o.component.axes[a]){if("independent"===r.axis[a]){n[a]=(null!==(e=n[a])&&void 0!==e?e:[]).concat(o.component.axes[a]);for(const t of o.component.axes[a]){const{value:e,explicit:n}=t.getWithExplicit("orient");if(!hFt(e)){if(i[e]>0&&!n){const n=DUt[e];i[e]>i[n]&&t.set("orient",n,!1)}i[e]++}}}delete o.component.axes[a]}if("independent"===r.axis[a]&&n[a]&&n[a].length>1)for(const t of n[a])t.get("grid")&&!t.explicit.grid&&(t.implicit.grid=!1)}}(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce(((t,e)=>e.assembleSelectionTopLevelSignals(t)),t)}assembleSignals(){return this.children.reduce(((t,e)=>t.concat(e.assembleSignals())),xLt(this))}assembleLayoutSignals(){return this.children.reduce(((t,e)=>t.concat(e.assembleLayoutSignals())),ZLt(this))}assembleSelectionData(t){return this.children.reduce(((t,e)=>e.assembleSelectionData(t)),t)}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const e of this.children)if(t=e.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return function(t,e){for(const n of t.children)Xjt(n)&&(e=nzt(n,e));return e}(this,this.children.flatMap((t=>t.assembleMarks())))}assembleLegends(){return this.children.reduce(((t,e)=>t.concat(e.assembleLegends())),_Pt(this))}}function QUt(t,e,n,r,i){if(PDt(t))return new _Ut(t,e,n,i);if(GMt(t))return new KUt(t,e,n,r,i);if(dEt(t))return new XUt(t,e,n,r,i);if(function(t){return SMt(t)||EMt(t)||CMt(t)}(t))return new EUt(t,e,n,i);throw new Error(yNt(t))}function ZUt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;e.logger&&(n=e.logger,HNt=n),e.fieldTitle&&lIt(e.fieldTitle);try{const n=PMt(ICt(e.config,t.config)),r=pOt(t,n),i=QUt(r,null,"",void 0,n);i.parse(),function(t,e){OPt(t.sources);let n=0,r=0;for(let i=0;i<djt&&mjt(t,e);i++)n++;t.sources.map(rjt);for(let i=0;i<djt&&mjt(t,e);i++)r++;OPt(t.sources),Math.max(n,r)===djt&&XNt("Maximum optimization runs(".concat(djt,") reached."))}(i.component.data,i);const a=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;const i=t.config?VMt(t.config):void 0,a=[].concat(t.assembleSelectionData([]),function(t,e){var n,r;const i=[],a=fUt(i);let o=0;for(const c of t.sources){c.hasName()||(c.dataName="source_".concat(o++));const t=c.assemble();a(c,t)}for(const c of i)0===c.transform.length&&delete c.transform;let s=0;for(const[c,u]of i.entries())0!==(null!==(n=u.transform)&&void 0!==n?n:[]).length||u.source||i.splice(s++,0,i.splice(c,1)[0]);for(const c of i)for(const e of null!==(r=c.transform)&&void 0!==r?r:[])"lookup"===e.type&&(e.from=t.outputNodes[e.from].getSource());for(const c of i)c.name in e&&(c.values=e[c.name]);return i}(t.component.data,n)),o=t.assembleProjections(),s=t.assembleTitle(),c=t.assembleGroupStyle(),u=t.assembleGroupEncodeEntry(!0);let l=t.assembleLayoutSignals();return l=l.filter((t=>"width"!==t.name&&"height"!==t.name||void 0===t.value||(e[t.name]=+t.value,!1))),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},t.description?{description:t.description}:{}),e),s?{title:s}:{}),c?{style:c}:{}),u?{encode:{update:u}}:{}),{data:a}),o.length>0?{projections:o}:{}),t.assembleGroup([...l,...t.assembleSelectionTopLevelSignals([])])),i?{config:i}:{}),r?{usermeta:r}:{})}(i,function(t,e,n,r){const i=r.component.layoutSize.get("width"),a=r.component.layoutSize.get("height");void 0===e?(e={type:"pad"},r.hasAxisOrientSignalRef()&&(e.resize=!0)):jCt(e)&&(e={type:e});if(i&&a&&(o=e.type,"fit"===o||"fit-x"===o||"fit-y"===o))if("step"===i&&"step"===a)XNt(kNt()),e.type="pad";else if("step"===i||"step"===a){const t="step"===i?"width":"height";XNt(kNt(YTt(t)));const n="width"===t?"height":"width";e.type=function(t){return t?"fit-".concat(YTt(t)):"fit"}(n)}var o;return Object.assign(Object.assign(Object.assign({},1===vSt(e).length&&e.type?"pad"===e.type?{}:{autosize:e.type}:{autosize:e}),yOt(n)),yOt(t))}(t,r.autosize,n,i),t.datasets,t.usermeta);return{spec:a,normalized:r}}finally{e.logger&&YNt(),e.fieldTitle&&lIt(cIt)}}const $Ut=new class extends HMt{mapUnit(t,e){let{config:n}=e;if(t.encoding){const{encoding:e,transform:r}=t,{bins:i,timeUnits:a,aggregate:o,groupby:s,encoding:c}=WIt(e,n),u=[...r||[],...i,...a,...0===o.length?[]:[{aggregate:o,groupby:s}]];return Object.assign(Object.assign(Object.assign({},t),u.length>0?{transform:u}:{}),{encoding:c})}return t}};function JUt(t,e){return $Ut.map(t,{config:e})}const tWt="4.13.1";const eWt=function(t){const[e,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(t).slice(1,3);return{library:e,version:n}};var nWt="2.14.0";const rWt="#fff",iWt="#888",aWt={background:"#333",view:{stroke:iWt},title:{color:rWt,subtitleColor:rWt},style:{"guide-label":{fill:rWt},"guide-title":{fill:rWt}},axis:{domainColor:rWt,gridColor:iWt,tickColor:rWt}},oWt="#4572a7",sWt={background:"#fff",arc:{fill:oWt},area:{fill:oWt},line:{stroke:oWt,strokeWidth:2},path:{stroke:oWt},rect:{fill:oWt},shape:{stroke:oWt},symbol:{fill:oWt,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},cWt="#30a2da",uWt="#cbcbcb",lWt="#f0f0f0",hWt="#333",dWt={arc:{fill:cWt},area:{fill:cWt},axis:{domainColor:uWt,grid:!0,gridColor:uWt,gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:uWt,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:lWt,group:{fill:lWt},legend:{labelColor:hWt,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:hWt,titleFontSize:14,titlePadding:10},line:{stroke:cWt,strokeWidth:2},path:{stroke:cWt,strokeWidth:.5},rect:{fill:cWt},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:cWt},bar:{binSpacing:2,fill:cWt,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},fWt="#000",pWt={group:{fill:"#e5e5e5"},arc:{fill:fWt},area:{fill:fWt},line:{stroke:fWt},path:{stroke:fWt},rect:{fill:fWt},shape:{stroke:fWt},symbol:{fill:fWt,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},gWt="Benton Gothic, sans-serif",mWt="#82c6df",vWt="Benton Gothic Bold, sans-serif",yWt="normal",bWt={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},xWt={background:"#ffffff",title:{anchor:"start",color:"#000000",font:vWt,fontSize:22,fontWeight:"normal"},arc:{fill:mWt},area:{fill:mWt},line:{stroke:mWt,strokeWidth:2},path:{stroke:mWt},rect:{fill:mWt},shape:{stroke:mWt},symbol:{fill:mWt,size:30},axis:{labelFont:gWt,labelFontSize:11.5,labelFontWeight:"normal",titleFont:vWt,titleFontSize:13,titleFontWeight:yWt},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:gWt,labelFontSize:11.5,symbolType:"square",titleFont:vWt,titleFontSize:13,titleFontWeight:yWt},range:{category:bWt["category-6"],diverging:bWt["fireandice-6"],heatmap:bWt["fire-7"],ordinal:bWt["fire-7"],ramp:bWt["fire-7"]}},wWt="#ab5787",kWt="#979797",_Wt={background:"#f9f9f9",arc:{fill:wWt},area:{fill:wWt},line:{stroke:wWt},path:{stroke:wWt},rect:{fill:wWt},shape:{stroke:wWt},symbol:{fill:wWt,size:30},axis:{domainColor:kWt,domainWidth:.5,gridWidth:.2,labelColor:kWt,tickColor:kWt,tickWidth:.2,titleColor:kWt},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},AWt="#3e5c69",CWt={background:"#fff",arc:{fill:AWt},area:{fill:AWt},line:{stroke:AWt},path:{stroke:AWt},rect:{fill:AWt},shape:{stroke:AWt},symbol:{fill:AWt},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},SWt="#1696d2",EWt="#000000",TWt="Lato",NWt="Lato",FWt={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},DWt={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:TWt},axisX:{domain:!0,domainColor:EWt,domainWidth:1,grid:!1,labelFontSize:12,labelFont:NWt,labelAngle:0,tickColor:EWt,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:TWt},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:NWt,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:TWt,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:NWt,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:TWt,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:FWt["six-groups-cat-1"],diverging:FWt["diverging-colors"],heatmap:FWt["diverging-colors"],ordinal:FWt["six-groups-seq"],ramp:FWt["shades-blue"]},area:{fill:SWt},rect:{fill:SWt},line:{color:SWt,stroke:SWt,strokeWidth:5},trail:{color:SWt,stroke:SWt,strokeWidth:0,size:1},path:{stroke:SWt,strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:SWt,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:SWt,stroke:null}},arc:{fill:SWt},shape:{stroke:SWt},symbol:{fill:SWt,size:30}},IWt="#3366CC",MWt="#ccc",OWt="Arial, sans-serif",RWt={arc:{fill:IWt},area:{fill:IWt},path:{stroke:IWt},rect:{fill:IWt},shape:{stroke:IWt},symbol:{stroke:IWt},circle:{fill:IWt},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:OWt,fontSize:12},"guide-title":{font:OWt,fontSize:12},"group-title":{font:OWt,fontSize:12}},title:{font:OWt,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:MWt,tickColor:MWt,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},zWt=t=>t*(1/3+1),BWt=zWt(9),LWt=zWt(10),PWt=zWt(12),jWt="Segoe UI",UWt="wf_standard-font, helvetica, arial, sans-serif",WWt="#252423",VWt="#605E5C",qWt="transparent",GWt="#118DFF",HWt="#DEEFFF",YWt=[HWt,GWt],XWt={view:{stroke:qWt},background:qWt,font:jWt,header:{titleFont:UWt,titleFontSize:PWt,titleColor:WWt,labelFont:jWt,labelFontSize:LWt,labelColor:VWt},axis:{ticks:!1,grid:!1,domain:!1,labelColor:VWt,labelFontSize:BWt,titleFont:UWt,titleColor:WWt,titleFontSize:PWt,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:"#C8C6C4",gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:GWt},line:{stroke:GWt,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:jWt,fontSize:BWt,fill:VWt},arc:{fill:GWt},area:{fill:GWt,line:!0,opacity:.6},path:{stroke:GWt},rect:{fill:GWt},point:{fill:GWt,filled:!0,size:75},shape:{stroke:GWt},symbol:{fill:GWt,strokeWidth:1.5,size:50},legend:{titleFont:jWt,titleFontWeight:"bold",titleColor:VWt,labelFont:jWt,labelFontSize:LWt,labelColor:VWt,symbolType:"circle",symbolSize:75},range:{category:[GWt,"#12239E","#E66C37","#6B007B","#E044A7","#744EC2","#D9B300","#D64550"],diverging:YWt,heatmap:YWt,ordinal:[HWt,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",GWt]}},KWt='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',QWt=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],ZWt=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function $Wt(t){let{type:e,background:n}=t;const r="dark"===e?"#161616":"#ffffff",i="dark"===e?"#f4f4f4":"#161616",a="dark"===e?"#d4bbff":"#6929c4";return{background:n,arc:{fill:a},area:{fill:a},path:{stroke:a},rect:{fill:a},shape:{stroke:a},symbol:{stroke:a},circle:{fill:a},view:{fill:r,stroke:r},group:{fill:r},title:{color:i,anchor:"start",dy:-15,fontSize:16,font:KWt,fontWeight:600},axis:{labelColor:i,labelFontSize:12,grid:!0,gridColor:"#525252",titleColor:i,labelAngle:0},style:{"guide-label":{font:KWt,fill:i,fontWeight:400},"guide-title":{font:KWt,fill:i,fontWeight:400}},range:{category:"dark"===e?QWt:ZWt,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}const JWt=$Wt({type:"light",background:"#ffffff"}),tVt=$Wt({type:"light",background:"#f4f4f4"}),eVt=$Wt({type:"dark",background:"#262626"}),nVt=$Wt({type:"dark",background:"#161616"}),rVt=nWt;const iVt="vg-tooltip-element",aVt={offsetX:10,offsetY:10,id:iVt,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2};function oVt(t,e,n){if(on(t))return"[".concat(t.map((t=>e(qn(t)?t:sVt(t,n)))).join(", "),"]");if(sn(t)){let r="";const i=t,{title:a,image:o}=i,s=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(i,["title","image"]);a&&(r+="<h2>".concat(e(a),"</h2>")),o&&(r+='<img src="'.concat(e(o),'">'));const c=Object.keys(s);if(c.length>0){r+="<table>";for(const t of c){let i=s[t];void 0!==i&&(sn(i)&&(i=sVt(i,n)),r+='<tr><td class="key">'.concat(e(t),':</td><td class="value">').concat(e(i),"</td></tr>"))}r+="</table>"}return r||"{}"}return e(t)}function sVt(t,e){return JSON.stringify(t,function(t){const e=[];return function(n,r){if("object"!==typeof r||null===r)return r;const i=e.indexOf(this)+1;return e.length=i,e.length>t?"[Object]":e.indexOf(r)>=0?"[Circular]":(e.push(r),r)}}(e))}class cVt{constructor(t){this.options=Object.assign(Object.assign({},aVt),t);const e=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const t=document.createElement("style");t.setAttribute("id",this.options.styleId),t.innerHTML=function(t){if(!/^[A-Za-z]+[-:.\w]*$/.test(t))throw new Error("Invalid HTML ID");return"#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black; }\n  #vg-tooltip-element.visible {\n    visibility: visible; }\n  #vg-tooltip-element h2 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 13px; }\n  #vg-tooltip-element img {\n    max-width: 200px;\n    max-height: 200px; }\n  #vg-tooltip-element table {\n    border-spacing: 0; }\n    #vg-tooltip-element table tr {\n      border: none; }\n      #vg-tooltip-element table tr td {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        padding-top: 2px;\n        padding-bottom: 2px; }\n        #vg-tooltip-element table tr td.key {\n          color: #808080;\n          max-width: 150px;\n          text-align: right;\n          padding-right: 4px; }\n        #vg-tooltip-element table tr td.value {\n          display: block;\n          max-width: 300px;\n          max-height: 7em;\n          text-align: left; }\n  #vg-tooltip-element.dark-theme {\n    background-color: rgba(32, 32, 32, 0.9);\n    border: 1px solid #f5f5f5;\n    color: white; }\n    #vg-tooltip-element.dark-theme td.key {\n      color: #bfbfbf; }\n".toString().replace(iVt,t)}(e);const n=document.head;n.childNodes.length>0?n.insertBefore(t,n.childNodes[0]):n.appendChild(t)}}tooltipHandler(t,e,n,r){this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el));if((null!=document.fullscreenElement?document.fullscreenElement:document.body).appendChild(this.el),null==r||""===r)return void this.el.classList.remove("visible","".concat(this.options.theme,"-theme"));this.el.innerHTML=oVt(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible","".concat(this.options.theme,"-theme"));const{x:i,y:a}=function(t,e,n,r){let i=t.clientX+n;i+e.width>window.innerWidth&&(i=+t.clientX-n-e.width);let a=t.clientY+r;return a+e.height>window.innerHeight&&(a=+t.clientY-r-e.height),{x:i,y:a}}(e,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style","top: ".concat(a,"px; left: ").concat(i,"px"))}}function uVt(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):function(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(o,s)}c((r=r.apply(t,e||[])).next())}))}var lVt,hVt='.vega-embed {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box; }\n  .vega-embed.has-actions {\n    padding-right: 38px; }\n  .vega-embed details:not([open]) > :not(summary) {\n    display: none !important; }\n  .vega-embed summary {\n    list-style: none;\n    position: absolute;\n    top: 0;\n    right: 0;\n    padding: 6px;\n    z-index: 1000;\n    background: white;\n    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n    color: #1b1e23;\n    border: 1px solid #aaa;\n    border-radius: 999px;\n    opacity: 0.2;\n    transition: opacity 0.4s ease-in;\n    outline: none;\n    cursor: pointer;\n    line-height: 0px; }\n    .vega-embed summary::-webkit-details-marker {\n      display: none; }\n    .vega-embed summary:active {\n      box-shadow: #aaa 0px 0px 0px 1px inset; }\n    .vega-embed summary svg {\n      width: 14px;\n      height: 14px; }\n  .vega-embed details[open] summary {\n    opacity: 0.7; }\n  .vega-embed:hover summary,\n  .vega-embed:focus summary {\n    opacity: 1 !important;\n    transition: opacity 0.2s ease; }\n  .vega-embed .vega-actions {\n    position: absolute;\n    z-index: 1001;\n    top: 35px;\n    right: -9px;\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 8px;\n    padding-top: 8px;\n    border-radius: 4px;\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n    border: 1px solid #d9d9d9;\n    background: white;\n    animation-duration: 0.15s;\n    animation-name: scale-in;\n    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n    text-align: left; }\n    .vega-embed .vega-actions a {\n      padding: 8px 16px;\n      font-family: sans-serif;\n      font-size: 14px;\n      font-weight: 600;\n      white-space: nowrap;\n      color: #434a56;\n      text-decoration: none; }\n      .vega-embed .vega-actions a:hover {\n        background-color: #f7f7f9;\n        color: black; }\n    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n      content: "";\n      display: inline-block;\n      position: absolute; }\n    .vega-embed .vega-actions::before {\n      left: auto;\n      right: 14px;\n      top: -16px;\n      border: 8px solid #0000;\n      border-bottom-color: #d9d9d9; }\n    .vega-embed .vega-actions::after {\n      left: auto;\n      right: 15px;\n      top: -14px;\n      border: 7px solid #0000;\n      border-bottom-color: #fff; }\n  .vega-embed .chart-wrapper {\n    width: 100%;\n    height: 100%; }\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: auto;\n  padding-right: 14px; }\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6); }\n  to {\n    opacity: 1;\n    transform: scale(1); } }\n';function dVt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(const i of n)fVt(t,i);return t}function fVt(t,e){for(const n of Object.keys(e))Tt(t,n,e[n],!0)}String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(!e||e<0?0:+e,t.length)===t});const pVt=x;let gVt=w;const mVt="undefined"!==typeof window?window:void 0;void 0===gVt&&(null===(lVt=null===mVt||void 0===mVt?void 0:mVt.vl)||void 0===lVt?void 0:lVt.compile)&&(gVt=mVt.vl);const vVt={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},yVt={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},bVt={vega:"Vega","vega-lite":"Vega-Lite"},xVt={vega:pVt.version,"vega-lite":gVt?gVt.version:"not available"},wVt={vega:t=>t,"vega-lite":(t,e)=>gVt.compile(t,{config:e}).spec},kVt='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>',_Vt="chart-wrapper";function AVt(t,e,n,r){const i="<html><head>".concat(e,'</head><body><pre><code class="json">'),a="</code></pre>".concat(n,"</body></html>"),o=window.open("");o.document.write(i+t+a),o.document.title="".concat(bVt[r]," JSON Source")}function CVt(t,e){var n;if(t.$schema){const r=eWt(t.$schema);e&&e!==r.library&&console.warn("The given visualization spec is written in ".concat(bVt[r.library],", but mode argument sets ").concat(null!==(n=bVt[e])&&void 0!==n?n:e,"."));const i=r.library;return(0,et.satisfies)(xVt[i],"^".concat(r.version.slice(1)))||console.warn("The input spec uses ".concat(bVt[i]," ").concat(r.version,", but the current version of ").concat(bVt[i]," is v").concat(xVt[i],".")),i}return"mark"in t||"encoding"in t||"layer"in t||"hconcat"in t||"vconcat"in t||"facet"in t||"repeat"in t?"vega-lite":"marks"in t||"signals"in t||"scales"in t||"axes"in t?"vega":null!==e&&void 0!==e?e:"vega"}function SVt(t){return(e=t)&&"load"in e?t:pVt.loader(t);var e}function EVt(t){var e;return null!==(e=t.usermeta&&t.usermeta.embedOptions)&&void 0!==e?e:{}}function TVt(t,e){var n;return uVt(this,void 0,void 0,(function*(){const r=we(t.config)?JSON.parse(yield e.load(t.config)):null!==(n=t.config)&&void 0!==n?n:{},i=we(t.patch)?JSON.parse(yield e.load(t.patch)):t.patch;return Object.assign(Object.assign(Object.assign({},t),i?{patch:i}:{}),r?{config:r}:{})}))}const NVt=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var r,i,a;return uVt(this,void 0,void 0,(function*(){let o,s;we(e)?(s=SVt(n.loader),o=JSON.parse(yield s.load(e))):o=e;const c=EVt(o).loader;s&&!c||(s=SVt(null!==(r=n.loader)&&void 0!==r?r:c));const u=yield TVt(EVt(o),s),l=yield TVt(n,s),h=Object.assign(Object.assign({},dVt(l,u)),{config:Et(null!==(i=l.config)&&void 0!==i?i:{},null!==(a=u.config)&&void 0!==a?a:{})});return yield function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;var i,a,o,s,c,u;return uVt(this,void 0,void 0,(function*(){const l=n.theme?Et(k[n.theme],null!==(i=n.config)&&void 0!==i?i:{}):n.config,h=me(n.actions)?n.actions:dVt({},vVt,null!==(a=n.actions)&&void 0!==a?a:{}),d=Object.assign(Object.assign({},yVt),n.i18n),f=null!==(o=n.renderer)&&void 0!==o?o:"canvas",p=null!==(s=n.logLevel)&&void 0!==s?s:pVt.Warn,g=null!==(c=n.downloadFileName)&&void 0!==c?c:"visualization",m="string"===typeof t?document.querySelector(t):t;if(!m)throw new Error("".concat(t," does not exist"));if(!1!==n.defaultStyle){const t="vega-embed-style",{root:e,rootContainer:r}=function(t){var e;const n=t.getRootNode?t.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:null!==(e=document.head)&&void 0!==e?e:document.body}}(m);if(!e.getElementById(t)){const e=document.createElement("style");e.id=t,e.innerText=void 0===n.defaultStyle||!0===n.defaultStyle?hVt.toString():n.defaultStyle,r.appendChild(e)}}const v=CVt(e,n.mode);let y=wVt[v](e,l);if("vega-lite"===v&&y.$schema){const t=eWt(y.$schema);(0,et.satisfies)(xVt.vega,"^".concat(t.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat(t.version,", but current version is v").concat(xVt.vega,"."))}m.classList.add("vega-embed"),h&&m.classList.add("has-actions"),m.innerHTML="";let b=m;if(h){const t=document.createElement("div");t.classList.add(_Vt),m.appendChild(t),b=t}const x=n.patch;x&&(y=x instanceof Function?x(y):j(y,x,!0,!1).newDocument),n.formatLocale&&pVt.formatLocale(n.formatLocale),n.timeFormatLocale&&pVt.timeFormatLocale(n.timeFormatLocale);const{ast:w}=n,_=pVt.parse(y,"vega-lite"===v?{}:l,{ast:w}),A=new(n.viewClass||pVt.View)(_,Object.assign({loader:r,logLevel:p,renderer:f},w?{expr:pVt.expressionInterpreter}:{}));if(!1!==n.tooltip){let t;t=function(t){return"function"===typeof t}(n.tooltip)?n.tooltip:new cVt(!0===n.tooltip?{}:n.tooltip).call,A.tooltip(t)}let C,{hover:S}=n;if(void 0===S&&(S="vega"===v),S){const{hoverSet:t,updateSet:e}="boolean"===typeof S?{}:S;A.hover(t,e)}if(n&&(null!=n.width&&A.width(n.width),null!=n.height&&A.height(n.height),null!=n.padding&&A.padding(n.padding)),yield A.initialize(b,n.bind).runAsync(),!1!==h){let t=m;if(!1!==n.defaultStyle){const e=document.createElement("details");e.title=d.CLICK_TO_VIEW_ACTIONS,m.append(e),t=e;const n=document.createElement("summary");n.innerHTML=kVt,e.append(n),C=t=>{e.contains(t.target)||e.removeAttribute("open")},document.addEventListener("click",C)}const r=document.createElement("div");if(t.append(r),r.classList.add("vega-actions"),!0===h||!1!==h.export)for(const e of["svg","png"])if(!0===h||!0===h.export||h.export[e]){const t=d["".concat(e.toUpperCase(),"_ACTION")],i=document.createElement("a");i.text=t,i.href="#",i.target="_blank",i.download="".concat(g,".").concat(e),i.addEventListener("mousedown",(function(t){return uVt(this,void 0,void 0,(function*(){t.preventDefault();const r=yield A.toImageURL(e,n.scaleFactor);this.href=r}))})),r.append(i)}if(!0===h||!1!==h.source){const t=document.createElement("a");t.text=d.SOURCE_ACTION,t.href="#",t.addEventListener("click",(function(t){var r,i;AVt(tt()(e),null!==(r=n.sourceHeader)&&void 0!==r?r:"",null!==(i=n.sourceFooter)&&void 0!==i?i:"",v),t.preventDefault()})),r.append(t)}if("vega-lite"===v&&(!0===h||!1!==h.compiled)){const t=document.createElement("a");t.text=d.COMPILED_ACTION,t.href="#",t.addEventListener("click",(function(t){var e,r;AVt(tt()(y),null!==(e=n.sourceHeader)&&void 0!==e?e:"",null!==(r=n.sourceFooter)&&void 0!==r?r:"","vega"),t.preventDefault()})),r.append(t)}if(!0===h||!1!==h.editor){const t=null!==(u=n.editorUrl)&&void 0!==u?u:"https://vega.github.io/editor/",i=document.createElement("a");i.text=d.EDITOR_ACTION,i.href="#",i.addEventListener("click",(function(n){!function(t,e,n){const r=t.open(e),{origin:i}=new URL(e);let a=40;t.addEventListener("message",(function e(n){n.source===r&&(a=0,t.removeEventListener("message",e,!1))}),!1),setTimeout((function t(){a<=0||(r.postMessage(n,i),setTimeout(t,250),a-=1)}),250)}(window,t,{config:l,mode:v,renderer:f,spec:tt()(e)}),n.preventDefault()})),r.append(i)}}function E(){C&&document.removeEventListener("click",C),A.finalize()}return{view:A,spec:e,vgSpec:y,finalize:E}}))}(t,o,h,s)}))}},25189:(t,e,n)=>{const r=Symbol("SemVer ANY");class i{static get ANY(){return r}constructor(t,e){if(e=a(e),t instanceof i){if(t.loose===!!e.loose)return t;t=t.value}t=t.trim().split(/\s+/).join(" "),u("comparator",t,e),this.options=e,this.loose=!!e.loose,this.parse(t),this.semver===r?this.value="":this.value=this.operator+this.semver.version,u("comp",this)}parse(t){const e=this.options.loose?o[s.COMPARATORLOOSE]:o[s.COMPARATOR],n=t.match(e);if(!n)throw new TypeError("Invalid comparator: ".concat(t));this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new l(n[2],this.options.loose):this.semver=r}toString(){return this.value}test(t){if(u("Comparator.test",t,this.options.loose),this.semver===r||t===r)return!0;if("string"===typeof t)try{t=new l(t,this.options)}catch(e){return!1}return c(t,this.operator,this.semver,this.options)}intersects(t,e){if(!(t instanceof i))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new h(t.value,e).test(this.value):""===t.operator?""===t.value||new h(this.value,e).test(t.semver):(!(e=a(e)).includePrerelease||"<0.0.0-0"!==this.value&&"<0.0.0-0"!==t.value)&&(!(!e.includePrerelease&&(this.value.startsWith("<0.0.0")||t.value.startsWith("<0.0.0")))&&(!(!this.operator.startsWith(">")||!t.operator.startsWith(">"))||(!(!this.operator.startsWith("<")||!t.operator.startsWith("<"))||(!(this.semver.version!==t.semver.version||!this.operator.includes("=")||!t.operator.includes("="))||(!!(c(this.semver,"<",t.semver,e)&&this.operator.startsWith(">")&&t.operator.startsWith("<"))||!!(c(this.semver,">",t.semver,e)&&this.operator.startsWith("<")&&t.operator.startsWith(">")))))))}}t.exports=i;const a=n(1102),{safeRe:o,t:s}=n(83153),c=n(44620),u=n(80073),l=n(3485),h=n(77356)},77356:(t,e,n)=>{class r{constructor(t,e){if(e=a(e),t instanceof r)return t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease?t:new r(t.raw,e);if(t instanceof o)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=t.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map((t=>this.parseRange(t.trim()))).filter((t=>t.length)),!this.set.length)throw new TypeError("Invalid SemVer Range: ".concat(this.raw));if(this.set.length>1){const t=this.set[0];if(this.set=this.set.filter((t=>!m(t[0]))),0===this.set.length)this.set=[t];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&v(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((t=>t.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(t){const e=((this.options.includePrerelease&&p)|(this.options.loose&&g))+":"+t,n=i.get(e);if(n)return n;const r=this.options.loose,a=r?u[l.HYPHENRANGELOOSE]:u[l.HYPHENRANGE];t=t.replace(a,N(this.options.includePrerelease)),s("hyphen replace",t),t=t.replace(u[l.COMPARATORTRIM],h),s("comparator trim",t),t=t.replace(u[l.TILDETRIM],d),s("tilde trim",t),t=t.replace(u[l.CARETTRIM],f),s("caret trim",t);let c=t.split(" ").map((t=>b(t,this.options))).join(" ").split(/\s+/).map((t=>T(t,this.options)));r&&(c=c.filter((t=>(s("loose invalid filter",t,this.options),!!t.match(u[l.COMPARATORLOOSE]))))),s("range list",c);const v=new Map,y=c.map((t=>new o(t,this.options)));for(const i of y){if(m(i))return[i];v.set(i.value,i)}v.size>1&&v.has("")&&v.delete("");const x=[...v.values()];return i.set(e,x),x}intersects(t,e){if(!(t instanceof r))throw new TypeError("a Range is required");return this.set.some((n=>y(n,e)&&t.set.some((t=>y(t,e)&&n.every((n=>t.every((t=>n.intersects(t,e)))))))))}test(t){if(!t)return!1;if("string"===typeof t)try{t=new c(t,this.options)}catch(e){return!1}for(let n=0;n<this.set.length;n++)if(F(this.set[n],t,this.options))return!0;return!1}}t.exports=r;const i=new(n(88027))({max:1e3}),a=n(1102),o=n(25189),s=n(80073),c=n(3485),{safeRe:u,t:l,comparatorTrimReplace:h,tildeTrimReplace:d,caretTrimReplace:f}=n(83153),{FLAG_INCLUDE_PRERELEASE:p,FLAG_LOOSE:g}=n(84447),m=t=>"<0.0.0-0"===t.value,v=t=>""===t.value,y=(t,e)=>{let n=!0;const r=t.slice();let i=r.pop();for(;n&&r.length;)n=r.every((t=>i.intersects(t,e))),i=r.pop();return n},b=(t,e)=>(s("comp",t,e),t=_(t,e),s("caret",t),t=w(t,e),s("tildes",t),t=C(t,e),s("xrange",t),t=E(t,e),s("stars",t),t),x=t=>!t||"x"===t.toLowerCase()||"*"===t,w=(t,e)=>t.trim().split(/\s+/).map((t=>k(t,e))).join(" "),k=(t,e)=>{const n=e.loose?u[l.TILDELOOSE]:u[l.TILDE];return t.replace(n,((e,n,r,i,a)=>{let o;return s("tilde",t,e,n,r,i,a),x(n)?o="":x(r)?o=">=".concat(n,".0.0 <").concat(+n+1,".0.0-0"):x(i)?o=">=".concat(n,".").concat(r,".0 <").concat(n,".").concat(+r+1,".0-0"):a?(s("replaceTilde pr",a),o=">=".concat(n,".").concat(r,".").concat(i,"-").concat(a," <").concat(n,".").concat(+r+1,".0-0")):o=">=".concat(n,".").concat(r,".").concat(i," <").concat(n,".").concat(+r+1,".0-0"),s("tilde return",o),o}))},_=(t,e)=>t.trim().split(/\s+/).map((t=>A(t,e))).join(" "),A=(t,e)=>{s("caret",t,e);const n=e.loose?u[l.CARETLOOSE]:u[l.CARET],r=e.includePrerelease?"-0":"";return t.replace(n,((e,n,i,a,o)=>{let c;return s("caret",t,e,n,i,a,o),x(n)?c="":x(i)?c=">=".concat(n,".0.0").concat(r," <").concat(+n+1,".0.0-0"):x(a)?c="0"===n?">=".concat(n,".").concat(i,".0").concat(r," <").concat(n,".").concat(+i+1,".0-0"):">=".concat(n,".").concat(i,".0").concat(r," <").concat(+n+1,".0.0-0"):o?(s("replaceCaret pr",o),c="0"===n?"0"===i?">=".concat(n,".").concat(i,".").concat(a,"-").concat(o," <").concat(n,".").concat(i,".").concat(+a+1,"-0"):">=".concat(n,".").concat(i,".").concat(a,"-").concat(o," <").concat(n,".").concat(+i+1,".0-0"):">=".concat(n,".").concat(i,".").concat(a,"-").concat(o," <").concat(+n+1,".0.0-0")):(s("no pr"),c="0"===n?"0"===i?">=".concat(n,".").concat(i,".").concat(a).concat(r," <").concat(n,".").concat(i,".").concat(+a+1,"-0"):">=".concat(n,".").concat(i,".").concat(a).concat(r," <").concat(n,".").concat(+i+1,".0-0"):">=".concat(n,".").concat(i,".").concat(a," <").concat(+n+1,".0.0-0")),s("caret return",c),c}))},C=(t,e)=>(s("replaceXRanges",t,e),t.split(/\s+/).map((t=>S(t,e))).join(" ")),S=(t,e)=>{t=t.trim();const n=e.loose?u[l.XRANGELOOSE]:u[l.XRANGE];return t.replace(n,((n,r,i,a,o,c)=>{s("xRange",t,n,r,i,a,o,c);const u=x(i),l=u||x(a),h=l||x(o),d=h;return"="===r&&d&&(r=""),c=e.includePrerelease?"-0":"",u?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&d?(l&&(a=0),o=0,">"===r?(r=">=",l?(i=+i+1,a=0,o=0):(a=+a+1,o=0)):"<="===r&&(r="<",l?i=+i+1:a=+a+1),"<"===r&&(c="-0"),n="".concat(r+i,".").concat(a,".").concat(o).concat(c)):l?n=">=".concat(i,".0.0").concat(c," <").concat(+i+1,".0.0-0"):h&&(n=">=".concat(i,".").concat(a,".0").concat(c," <").concat(i,".").concat(+a+1,".0-0")),s("xRange return",n),n}))},E=(t,e)=>(s("replaceStars",t,e),t.trim().replace(u[l.STAR],"")),T=(t,e)=>(s("replaceGTE0",t,e),t.trim().replace(u[e.includePrerelease?l.GTE0PRE:l.GTE0],"")),N=t=>(e,n,r,i,a,o,s,c,u,l,h,d,f)=>(n=x(r)?"":x(i)?">=".concat(r,".0.0").concat(t?"-0":""):x(a)?">=".concat(r,".").concat(i,".0").concat(t?"-0":""):o?">=".concat(n):">=".concat(n).concat(t?"-0":""),c=x(u)?"":x(l)?"<".concat(+u+1,".0.0-0"):x(h)?"<".concat(u,".").concat(+l+1,".0-0"):d?"<=".concat(u,".").concat(l,".").concat(h,"-").concat(d):t?"<".concat(u,".").concat(l,".").concat(+h+1,"-0"):"<=".concat(c),"".concat(n," ").concat(c).trim()),F=(t,e,n)=>{for(let r=0;r<t.length;r++)if(!t[r].test(e))return!1;if(e.prerelease.length&&!n.includePrerelease){for(let n=0;n<t.length;n++)if(s(t[n].semver),t[n].semver!==o.ANY&&t[n].semver.prerelease.length>0){const r=t[n].semver;if(r.major===e.major&&r.minor===e.minor&&r.patch===e.patch)return!0}return!1}return!0}},3485:(t,e,n)=>{const r=n(80073),{MAX_LENGTH:i,MAX_SAFE_INTEGER:a}=n(84447),{safeRe:o,t:s}=n(83153),c=n(1102),{compareIdentifiers:u}=n(94470);class l{constructor(t,e){if(e=c(e),t instanceof l){if(t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease)return t;t=t.version}else if("string"!==typeof t)throw new TypeError('Invalid version. Must be a string. Got type "'.concat(typeof t,'".'));if(t.length>i)throw new TypeError("version is longer than ".concat(i," characters"));r("SemVer",t,e),this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease;const n=t.trim().match(e.loose?o[s.LOOSE]:o[s.FULL]);if(!n)throw new TypeError("Invalid Version: ".concat(t));if(this.raw=t,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>a||this.major<0)throw new TypeError("Invalid major version");if(this.minor>a||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>a||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((t=>{if(/^[0-9]+$/.test(t)){const e=+t;if(e>=0&&e<a)return e}return t})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}toString(){return this.version}compare(t){if(r("SemVer.compare",this.version,this.options,t),!(t instanceof l)){if("string"===typeof t&&t===this.version)return 0;t=new l(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof l||(t=new l(t,this.options)),u(this.major,t.major)||u(this.minor,t.minor)||u(this.patch,t.patch)}comparePre(t){if(t instanceof l||(t=new l(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let e=0;do{const n=this.prerelease[e],i=t.prerelease[e];if(r("prerelease compare",e,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++e)}compareBuild(t){t instanceof l||(t=new l(t,this.options));let e=0;do{const n=this.build[e],i=t.build[e];if(r("prerelease compare",e,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++e)}inc(t,e,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e,n),this.inc("pre",e,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",e,n),this.inc("pre",e,n);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const t=Number(n)?1:0;if(!e&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[t];else{let r=this.prerelease.length;for(;--r>=0;)"number"===typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);if(-1===r){if(e===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(t)}}if(e){let r=[e,t];!1===n&&(r=[e]),0===u(this.prerelease[0],e)?isNaN(this.prerelease[1])&&(this.prerelease=r):this.prerelease=r}break}default:throw new Error("invalid increment argument: ".concat(t))}return this.raw=this.format(),this.build.length&&(this.raw+="+".concat(this.build.join("."))),this}}t.exports=l},50881:(t,e,n)=>{const r=n(95371);t.exports=(t,e)=>{const n=r(t.trim().replace(/^[=v]+/,""),e);return n?n.version:null}},44620:(t,e,n)=>{const r=n(52776),i=n(96052),a=n(90265),o=n(90186),s=n(62886),c=n(88063);t.exports=(t,e,n,u)=>{switch(e){case"===":return"object"===typeof t&&(t=t.version),"object"===typeof n&&(n=n.version),t===n;case"!==":return"object"===typeof t&&(t=t.version),"object"===typeof n&&(n=n.version),t!==n;case"":case"=":case"==":return r(t,n,u);case"!=":return i(t,n,u);case">":return a(t,n,u);case">=":return o(t,n,u);case"<":return s(t,n,u);case"<=":return c(t,n,u);default:throw new TypeError("Invalid operator: ".concat(e))}}},26743:(t,e,n)=>{const r=n(3485),i=n(95371),{safeRe:a,t:o}=n(83153);t.exports=(t,e)=>{if(t instanceof r)return t;if("number"===typeof t&&(t=String(t)),"string"!==typeof t)return null;let n=null;if((e=e||{}).rtl){const r=e.includePrerelease?a[o.COERCERTLFULL]:a[o.COERCERTL];let i;for(;(i=r.exec(t))&&(!n||n.index+n[0].length!==t.length);)n&&i.index+i[0].length===n.index+n[0].length||(n=i),r.lastIndex=i.index+i[1].length+i[2].length;r.lastIndex=-1}else n=t.match(e.includePrerelease?a[o.COERCEFULL]:a[o.COERCE]);if(null===n)return null;const s=n[2],c=n[3]||"0",u=n[4]||"0",l=e.includePrerelease&&n[5]?"-".concat(n[5]):"",h=e.includePrerelease&&n[6]?"+".concat(n[6]):"";return i("".concat(s,".").concat(c,".").concat(u).concat(l).concat(h),e)}},47154:(t,e,n)=>{const r=n(3485);t.exports=(t,e,n)=>{const i=new r(t,n),a=new r(e,n);return i.compare(a)||i.compareBuild(a)}},89260:(t,e,n)=>{const r=n(6803);t.exports=(t,e)=>r(t,e,!0)},6803:(t,e,n)=>{const r=n(3485);t.exports=(t,e,n)=>new r(t,n).compare(new r(e,n))},36829:(t,e,n)=>{const r=n(95371);t.exports=(t,e)=>{const n=r(t,null,!0),i=r(e,null,!0),a=n.compare(i);if(0===a)return null;const o=a>0,s=o?n:i,c=o?i:n,u=!!s.prerelease.length;if(!!c.prerelease.length&&!u)return c.patch||c.minor?s.patch?"patch":s.minor?"minor":"major":"major";const l=u?"pre":"";return n.major!==i.major?l+"major":n.minor!==i.minor?l+"minor":n.patch!==i.patch?l+"patch":"prerelease"}},52776:(t,e,n)=>{const r=n(6803);t.exports=(t,e,n)=>0===r(t,e,n)},90265:(t,e,n)=>{const r=n(6803);t.exports=(t,e,n)=>r(t,e,n)>0},90186:(t,e,n)=>{const r=n(6803);t.exports=(t,e,n)=>r(t,e,n)>=0},49596:(t,e,n)=>{const r=n(3485);t.exports=(t,e,n,i,a)=>{"string"===typeof n&&(a=i,i=n,n=void 0);try{return new r(t instanceof r?t.version:t,n).inc(e,i,a).version}catch(o){return null}}},62886:(t,e,n)=>{const r=n(6803);t.exports=(t,e,n)=>r(t,e,n)<0},88063:(t,e,n)=>{const r=n(6803);t.exports=(t,e,n)=>r(t,e,n)<=0},5317:(t,e,n)=>{const r=n(3485);t.exports=(t,e)=>new r(t,e).major},31361:(t,e,n)=>{const r=n(3485);t.exports=(t,e)=>new r(t,e).minor},96052:(t,e,n)=>{const r=n(6803);t.exports=(t,e,n)=>0!==r(t,e,n)},95371:(t,e,n)=>{const r=n(3485);t.exports=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t instanceof r)return t;try{return new r(t,e)}catch(i){if(!n)return null;throw i}}},7082:(t,e,n)=>{const r=n(3485);t.exports=(t,e)=>new r(t,e).patch},32700:(t,e,n)=>{const r=n(95371);t.exports=(t,e)=>{const n=r(t,e);return n&&n.prerelease.length?n.prerelease:null}},3803:(t,e,n)=>{const r=n(6803);t.exports=(t,e,n)=>r(e,t,n)},64778:(t,e,n)=>{const r=n(47154);t.exports=(t,e)=>t.sort(((t,n)=>r(n,t,e)))},49157:(t,e,n)=>{const r=n(77356);t.exports=(t,e,n)=>{try{e=new r(e,n)}catch(i){return!1}return e.test(t)}},61058:(t,e,n)=>{const r=n(47154);t.exports=(t,e)=>t.sort(((t,n)=>r(t,n,e)))},28162:(t,e,n)=>{const r=n(95371);t.exports=(t,e)=>{const n=r(t,e);return n?n.version:null}},28394:(t,e,n)=>{const r=n(83153),i=n(84447),a=n(3485),o=n(94470),s=n(95371),c=n(28162),u=n(50881),l=n(49596),h=n(36829),d=n(5317),f=n(31361),p=n(7082),g=n(32700),m=n(6803),v=n(3803),y=n(89260),b=n(47154),x=n(61058),w=n(64778),k=n(90265),_=n(62886),A=n(52776),C=n(96052),S=n(90186),E=n(88063),T=n(44620),N=n(26743),F=n(25189),D=n(77356),I=n(49157),M=n(56324),O=n(39751),R=n(21589),z=n(96616),B=n(56131),L=n(90542),P=n(85378),j=n(81271),U=n(2903),W=n(10062),V=n(33151);t.exports={parse:s,valid:c,clean:u,inc:l,diff:h,major:d,minor:f,patch:p,prerelease:g,compare:m,rcompare:v,compareLoose:y,compareBuild:b,sort:x,rsort:w,gt:k,lt:_,eq:A,neq:C,gte:S,lte:E,cmp:T,coerce:N,Comparator:F,Range:D,satisfies:I,toComparators:M,maxSatisfying:O,minSatisfying:R,minVersion:z,validRange:B,outside:L,gtr:P,ltr:j,intersects:U,simplifyRange:W,subset:V,SemVer:a,re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:i.SEMVER_SPEC_VERSION,RELEASE_TYPES:i.RELEASE_TYPES,compareIdentifiers:o.compareIdentifiers,rcompareIdentifiers:o.rcompareIdentifiers}},84447:t=>{const e=Number.MAX_SAFE_INTEGER||9007199254740991;t.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:e,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},80073:t=>{const e="object"===typeof process&&{NODE_ENV:"production",PUBLIC_URL:"/rl",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.NODE_DEBUG&&/\bsemver\b/i.test({NODE_ENV:"production",PUBLIC_URL:"/rl",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.NODE_DEBUG)?function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return console.error("SEMVER",...e)}:()=>{};t.exports=e},94470:t=>{const e=/^[0-9]+$/,n=(t,n)=>{const r=e.test(t),i=e.test(n);return r&&i&&(t=+t,n=+n),t===n?0:r&&!i?-1:i&&!r?1:t<n?-1:1};t.exports={compareIdentifiers:n,rcompareIdentifiers:(t,e)=>n(e,t)}},1102:t=>{const e=Object.freeze({loose:!0}),n=Object.freeze({});t.exports=t=>t?"object"!==typeof t?e:t:n},83153:(t,e,n)=>{const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:a}=n(84447),o=n(80073),s=(e=t.exports={}).re=[],c=e.safeRe=[],u=e.src=[],l=e.t={};let h=0;const d="[a-zA-Z0-9-]",f=[["\\s",1],["\\d",a],[d,i]],p=(t,e,n)=>{const r=(t=>{for(const[e,n]of f)t=t.split("".concat(e,"*")).join("".concat(e,"{0,").concat(n,"}")).split("".concat(e,"+")).join("".concat(e,"{1,").concat(n,"}"));return t})(e),i=h++;o(t,i,e),l[t]=i,u[i]=e,s[i]=new RegExp(e,n?"g":void 0),c[i]=new RegExp(r,n?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-]".concat(d,"*")),p("MAINVERSION","(".concat(u[l.NUMERICIDENTIFIER],")\\.")+"(".concat(u[l.NUMERICIDENTIFIER],")\\.")+"(".concat(u[l.NUMERICIDENTIFIER],")")),p("MAINVERSIONLOOSE","(".concat(u[l.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(u[l.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(u[l.NUMERICIDENTIFIERLOOSE],")")),p("PRERELEASEIDENTIFIER","(?:".concat(u[l.NUMERICIDENTIFIER],"|").concat(u[l.NONNUMERICIDENTIFIER],")")),p("PRERELEASEIDENTIFIERLOOSE","(?:".concat(u[l.NUMERICIDENTIFIERLOOSE],"|").concat(u[l.NONNUMERICIDENTIFIER],")")),p("PRERELEASE","(?:-(".concat(u[l.PRERELEASEIDENTIFIER],"(?:\\.").concat(u[l.PRERELEASEIDENTIFIER],")*))")),p("PRERELEASELOOSE","(?:-?(".concat(u[l.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(u[l.PRERELEASEIDENTIFIERLOOSE],")*))")),p("BUILDIDENTIFIER","".concat(d,"+")),p("BUILD","(?:\\+(".concat(u[l.BUILDIDENTIFIER],"(?:\\.").concat(u[l.BUILDIDENTIFIER],")*))")),p("FULLPLAIN","v?".concat(u[l.MAINVERSION]).concat(u[l.PRERELEASE],"?").concat(u[l.BUILD],"?")),p("FULL","^".concat(u[l.FULLPLAIN],"$")),p("LOOSEPLAIN","[v=\\s]*".concat(u[l.MAINVERSIONLOOSE]).concat(u[l.PRERELEASELOOSE],"?").concat(u[l.BUILD],"?")),p("LOOSE","^".concat(u[l.LOOSEPLAIN],"$")),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE","".concat(u[l.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),p("XRANGEIDENTIFIER","".concat(u[l.NUMERICIDENTIFIER],"|x|X|\\*")),p("XRANGEPLAIN","[v=\\s]*(".concat(u[l.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(u[l.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(u[l.XRANGEIDENTIFIER],")")+"(?:".concat(u[l.PRERELEASE],")?").concat(u[l.BUILD],"?")+")?)?"),p("XRANGEPLAINLOOSE","[v=\\s]*(".concat(u[l.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(u[l.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(u[l.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(u[l.PRERELEASELOOSE],")?").concat(u[l.BUILD],"?")+")?)?"),p("XRANGE","^".concat(u[l.GTLT],"\\s*").concat(u[l.XRANGEPLAIN],"$")),p("XRANGELOOSE","^".concat(u[l.GTLT],"\\s*").concat(u[l.XRANGEPLAINLOOSE],"$")),p("COERCEPLAIN","".concat("(^|[^\\d])(\\d{1,").concat(r,"})")+"(?:\\.(\\d{1,".concat(r,"}))?")+"(?:\\.(\\d{1,".concat(r,"}))?")),p("COERCE","".concat(u[l.COERCEPLAIN],"(?:$|[^\\d])")),p("COERCEFULL",u[l.COERCEPLAIN]+"(?:".concat(u[l.PRERELEASE],")?")+"(?:".concat(u[l.BUILD],")?")+"(?:$|[^\\d])"),p("COERCERTL",u[l.COERCE],!0),p("COERCERTLFULL",u[l.COERCEFULL],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM","(\\s*)".concat(u[l.LONETILDE],"\\s+"),!0),e.tildeTrimReplace="$1~",p("TILDE","^".concat(u[l.LONETILDE]).concat(u[l.XRANGEPLAIN],"$")),p("TILDELOOSE","^".concat(u[l.LONETILDE]).concat(u[l.XRANGEPLAINLOOSE],"$")),p("LONECARET","(?:\\^)"),p("CARETTRIM","(\\s*)".concat(u[l.LONECARET],"\\s+"),!0),e.caretTrimReplace="$1^",p("CARET","^".concat(u[l.LONECARET]).concat(u[l.XRANGEPLAIN],"$")),p("CARETLOOSE","^".concat(u[l.LONECARET]).concat(u[l.XRANGEPLAINLOOSE],"$")),p("COMPARATORLOOSE","^".concat(u[l.GTLT],"\\s*(").concat(u[l.LOOSEPLAIN],")$|^$")),p("COMPARATOR","^".concat(u[l.GTLT],"\\s*(").concat(u[l.FULLPLAIN],")$|^$")),p("COMPARATORTRIM","(\\s*)".concat(u[l.GTLT],"\\s*(").concat(u[l.LOOSEPLAIN],"|").concat(u[l.XRANGEPLAIN],")"),!0),e.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE","^\\s*(".concat(u[l.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(u[l.XRANGEPLAIN],")")+"\\s*$"),p("HYPHENRANGELOOSE","^\\s*(".concat(u[l.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(u[l.XRANGEPLAINLOOSE],")")+"\\s*$"),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},85378:(t,e,n)=>{const r=n(90542);t.exports=(t,e,n)=>r(t,e,">",n)},2903:(t,e,n)=>{const r=n(77356);t.exports=(t,e,n)=>(t=new r(t,n),e=new r(e,n),t.intersects(e,n))},81271:(t,e,n)=>{const r=n(90542);t.exports=(t,e,n)=>r(t,e,"<",n)},39751:(t,e,n)=>{const r=n(3485),i=n(77356);t.exports=(t,e,n)=>{let a=null,o=null,s=null;try{s=new i(e,n)}catch(c){return null}return t.forEach((t=>{s.test(t)&&(a&&-1!==o.compare(t)||(a=t,o=new r(a,n)))})),a}},21589:(t,e,n)=>{const r=n(3485),i=n(77356);t.exports=(t,e,n)=>{let a=null,o=null,s=null;try{s=new i(e,n)}catch(c){return null}return t.forEach((t=>{s.test(t)&&(a&&1!==o.compare(t)||(a=t,o=new r(a,n)))})),a}},96616:(t,e,n)=>{const r=n(3485),i=n(77356),a=n(90265);t.exports=(t,e)=>{t=new i(t,e);let n=new r("0.0.0");if(t.test(n))return n;if(n=new r("0.0.0-0"),t.test(n))return n;n=null;for(let i=0;i<t.set.length;++i){const e=t.set[i];let o=null;e.forEach((t=>{const e=new r(t.semver.version);switch(t.operator){case">":0===e.prerelease.length?e.patch++:e.prerelease.push(0),e.raw=e.format();case"":case">=":o&&!a(e,o)||(o=e);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: ".concat(t.operator))}})),!o||n&&!a(n,o)||(n=o)}return n&&t.test(n)?n:null}},90542:(t,e,n)=>{const r=n(3485),i=n(25189),{ANY:a}=i,o=n(77356),s=n(49157),c=n(90265),u=n(62886),l=n(88063),h=n(90186);t.exports=(t,e,n,d)=>{let f,p,g,m,v;switch(t=new r(t,d),e=new o(e,d),n){case">":f=c,p=l,g=u,m=">",v=">=";break;case"<":f=u,p=h,g=c,m="<",v="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(t,e,d))return!1;for(let r=0;r<e.set.length;++r){const n=e.set[r];let o=null,s=null;if(n.forEach((t=>{t.semver===a&&(t=new i(">=0.0.0")),o=o||t,s=s||t,f(t.semver,o.semver,d)?o=t:g(t.semver,s.semver,d)&&(s=t)})),o.operator===m||o.operator===v)return!1;if((!s.operator||s.operator===m)&&p(t,s.semver))return!1;if(s.operator===v&&g(t,s.semver))return!1}return!0}},10062:(t,e,n)=>{const r=n(49157),i=n(6803);t.exports=(t,e,n)=>{const a=[];let o=null,s=null;const c=t.sort(((t,e)=>i(t,e,n)));for(const i of c){r(i,e,n)?(s=i,o||(o=i)):(s&&a.push([o,s]),s=null,o=null)}o&&a.push([o,null]);const u=[];for(const[r,i]of a)r===i?u.push(r):i||r!==c[0]?i?r===c[0]?u.push("<=".concat(i)):u.push("".concat(r," - ").concat(i)):u.push(">=".concat(r)):u.push("*");const l=u.join(" || "),h="string"===typeof e.raw?e.raw:String(e);return l.length<h.length?l:e}},33151:(t,e,n)=>{const r=n(77356),i=n(25189),{ANY:a}=i,o=n(49157),s=n(6803),c=[new i(">=0.0.0-0")],u=[new i(">=0.0.0")],l=(t,e,n)=>{if(t===e)return!0;if(1===t.length&&t[0].semver===a){if(1===e.length&&e[0].semver===a)return!0;t=n.includePrerelease?c:u}if(1===e.length&&e[0].semver===a){if(n.includePrerelease)return!0;e=u}const r=new Set;let i,l,f,p,g,m,v;for(const a of t)">"===a.operator||">="===a.operator?i=h(i,a,n):"<"===a.operator||"<="===a.operator?l=d(l,a,n):r.add(a.semver);if(r.size>1)return null;if(i&&l){if(f=s(i.semver,l.semver,n),f>0)return null;if(0===f&&(">="!==i.operator||"<="!==l.operator))return null}for(const a of r){if(i&&!o(a,String(i),n))return null;if(l&&!o(a,String(l),n))return null;for(const t of e)if(!o(a,String(t),n))return!1;return!0}let y=!(!l||n.includePrerelease||!l.semver.prerelease.length)&&l.semver,b=!(!i||n.includePrerelease||!i.semver.prerelease.length)&&i.semver;y&&1===y.prerelease.length&&"<"===l.operator&&0===y.prerelease[0]&&(y=!1);for(const a of e){if(v=v||">"===a.operator||">="===a.operator,m=m||"<"===a.operator||"<="===a.operator,i)if(b&&a.semver.prerelease&&a.semver.prerelease.length&&a.semver.major===b.major&&a.semver.minor===b.minor&&a.semver.patch===b.patch&&(b=!1),">"===a.operator||">="===a.operator){if(p=h(i,a,n),p===a&&p!==i)return!1}else if(">="===i.operator&&!o(i.semver,String(a),n))return!1;if(l)if(y&&a.semver.prerelease&&a.semver.prerelease.length&&a.semver.major===y.major&&a.semver.minor===y.minor&&a.semver.patch===y.patch&&(y=!1),"<"===a.operator||"<="===a.operator){if(g=d(l,a,n),g===a&&g!==l)return!1}else if("<="===l.operator&&!o(l.semver,String(a),n))return!1;if(!a.operator&&(l||i)&&0!==f)return!1}return!(i&&m&&!l&&0!==f)&&(!(l&&v&&!i&&0!==f)&&(!b&&!y))},h=(t,e,n)=>{if(!t)return e;const r=s(t.semver,e.semver,n);return r>0?t:r<0||">"===e.operator&&">="===t.operator?e:t},d=(t,e,n)=>{if(!t)return e;const r=s(t.semver,e.semver,n);return r<0?t:r>0||"<"===e.operator&&"<="===t.operator?e:t};t.exports=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t===e)return!0;t=new r(t,n),e=new r(e,n);let i=!1;t:for(const r of t.set){for(const t of e.set){const e=l(r,t,n);if(i=i||null!==e,e)continue t}if(i)return!1}return!0}},56324:(t,e,n)=>{const r=n(77356);t.exports=(t,e)=>new r(t,e).set.map((t=>t.map((t=>t.value)).join(" ").trim().split(" ")))},56131:(t,e,n)=>{const r=n(77356);t.exports=(t,e)=>{try{return new r(t,e).range||"*"}catch(n){return null}}},17725:t=>{"use strict";t.exports=function(t){t.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}},72453:(t,e,n)=>{"use strict";function r(t){var e=this;if(e instanceof r||(e=new r),e.tail=null,e.head=null,e.length=0,t&&"function"===typeof t.forEach)t.forEach((function(t){e.push(t)}));else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)e.push(arguments[n]);return e}function i(t,e,n){var r=e===t.head?new s(n,null,e,t):new s(n,e,e.next,t);return null===r.next&&(t.tail=r),null===r.prev&&(t.head=r),t.length++,r}function a(t,e){t.tail=new s(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function o(t,e){t.head=new s(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function s(t,e,n,r){if(!(this instanceof s))return new s(t,e,n,r);this.list=r,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}t.exports=r,r.Node=s,r.create=r,r.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,n=t.prev;return e&&(e.prev=n),n&&(n.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=n),t.list.length--,t.next=null,t.prev=null,t.list=null,e},r.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},r.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}},r.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)a(this,arguments[t]);return this.length},r.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)o(this,arguments[t]);return this.length},r.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},r.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},r.prototype.forEach=function(t,e){e=e||this;for(var n=this.head,r=0;null!==n;r++)t.call(e,n.value,r,this),n=n.next},r.prototype.forEachReverse=function(t,e){e=e||this;for(var n=this.tail,r=this.length-1;null!==n;r--)t.call(e,n.value,r,this),n=n.prev},r.prototype.get=function(t){for(var e=0,n=this.head;null!==n&&e<t;e++)n=n.next;if(e===t&&null!==n)return n.value},r.prototype.getReverse=function(t){for(var e=0,n=this.tail;null!==n&&e<t;e++)n=n.prev;if(e===t&&null!==n)return n.value},r.prototype.map=function(t,e){e=e||this;for(var n=new r,i=this.head;null!==i;)n.push(t.call(e,i.value,this)),i=i.next;return n},r.prototype.mapReverse=function(t,e){e=e||this;for(var n=new r,i=this.tail;null!==i;)n.push(t.call(e,i.value,this)),i=i.prev;return n},r.prototype.reduce=function(t,e){var n,r=this.head;if(arguments.length>1)n=e;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=t(n,r.value,i),r=r.next;return n},r.prototype.reduceReverse=function(t,e){var n,r=this.tail;if(arguments.length>1)n=e;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=t(n,r.value,i),r=r.prev;return n},r.prototype.toArray=function(){for(var t=new Array(this.length),e=0,n=this.head;null!==n;e++)t[e]=n.value,n=n.next;return t},r.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,n=this.tail;null!==n;e++)t[e]=n.value,n=n.prev;return t},r.prototype.slice=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var n=new r;if(e<t||e<0)return n;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=0,a=this.head;null!==a&&i<t;i++)a=a.next;for(;null!==a&&i<e;i++,a=a.next)n.push(a.value);return n},r.prototype.sliceReverse=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var n=new r;if(e<t||e<0)return n;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=this.length,a=this.tail;null!==a&&i>e;i--)a=a.prev;for(;null!==a&&i>t;i--,a=a.prev)n.push(a.value);return n},r.prototype.splice=function(t,e){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var n=0,r=this.head;null!==r&&n<t;n++)r=r.next;var a=[];for(n=0;r&&n<e;n++)a.push(r.value),r=this.removeNode(r);null===r&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev);for(n=0;n<(arguments.length<=2?0:arguments.length-2);n++)r=i(this,r,n+2<2||arguments.length<=n+2?void 0:arguments[n+2]);return a},r.prototype.reverse=function(){for(var t=this.head,e=this.tail,n=t;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=e,this.tail=t,this};try{n(17725)(r)}catch(c){}},1403:t=>{"use strict";var e=/("(?:[^\\"]|\\.)*")|[:,]/g;t.exports=function(t,n){var r,i,a;return n=n||{},r=JSON.stringify([1],void 0,void 0===n.indent?2:n.indent).slice(2,-3),i=""===r?1/0:void 0===n.maxLength?80:n.maxLength,a=n.replacer,function t(n,o,s){var c,u,l,h,d,f,p,g,m,v,y,b;if(n&&"function"===typeof n.toJSON&&(n=n.toJSON()),void 0===(y=JSON.stringify(n,a)))return y;if(p=i-o.length-s,y.length<=p&&(m=y.replace(e,(function(t,e){return e||t+" "}))).length<=p)return m;if(null!=a&&(n=JSON.parse(y),a=void 0),"object"===typeof n&&null!==n){if(g=o+r,l=[],u=0,Array.isArray(n))for(v="[",c="]",p=n.length;u<p;u++)l.push(t(n[u],g,u===p-1?0:1)||"null");else for(v="{",c="}",p=(f=Object.keys(n)).length;u<p;u++)h=f[u],d=JSON.stringify(h)+": ",void 0!==(b=t(n[h],g,d.length+(u===p-1?0:1)))&&l.push(d+b);if(l.length>0)return[v,r+l.join(",\n"+g),c].join("\n"+o)}return y}(t,"",0)}},6431:(t,e,n)=>{"use strict";function r(t){return null!=t&&"object"===typeof t&&!0===t["@@functional/placeholder"]}function i(t){return function e(n){return 0===arguments.length||r(n)?e:t.apply(this,arguments)}}function a(t){return function e(n,a){switch(arguments.length){case 0:return e;case 1:return r(n)?e:i((function(e){return t(n,e)}));default:return r(n)&&r(a)?e:r(n)?i((function(e){return t(e,a)})):r(a)?i((function(e){return t(n,e)})):t(n,a)}}}n.d(e,{A:()=>o});const o=a((function(t,e){for(var n={},r=0;r<t.length;)t[r]in e&&(n[t[r]]=e[t[r]]),r+=1;return n}))}}]);