/*! For license information please see main.a26e18ec.js.LICENSE.txt */
(()=>{var t={68099:(t,e,n)=>{"use strict";n.d(e,{GJ:()=>r,uI:()=>i});class r{constructor(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,e){this.dataIdsCount++,this.data.set(t,e)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class i{refCount(t){return a("refCount")}incRef(t){return a("incRef")}timerAvailable(){return!0}time(t){return a("time")}read(t){return a("read")}readSync(t){return a("readSync")}readToGPU(t,e){return a("readToGPU")}numDataIds(){return a("numDataIds")}disposeData(t,e){return a("disposeData")}write(t,e,n){return a("write")}move(t,e,n,r,i){return a("move")}createTensorFromGPUData(t,e,n){return a("createTensorFromGPUData")}memory(){return a("memory")}floatPrecision(){return a("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return a("dispose")}}function a(t){throw new Error("'".concat(t,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}},74164:(t,e,n)=>{"use strict";n.d(e,{ljI:()=>K.ljI,Vvy:()=>K.Vvy,PH8:()=>K.PH8,K$F:()=>It.K,ah4:()=>Mt.a,FYc:()=>Ot.F,oC7:()=>Rt.o,OMN:()=>K.OMN,EkD:()=>K.EkD,u8Z:()=>K.u8Z,FSt:()=>K.FSt,Jp_:()=>K.Jp_,p_m:()=>K.p_m,QKF:()=>K.QKF,epO:()=>K.epO,TyE:()=>K.TyE,lxb:()=>K.lxb,zP9:()=>K.zP9,ho8:()=>K.ho8,cS:()=>K.cS,wwC:()=>K.wwC,VCH:()=>K.VCH,jAQ:()=>K.jAQ,Ik2:()=>K.Ik2,N4F:()=>K.N4F,HNs:()=>K.HNs,vj7:()=>K.vj7,LB5:()=>K.LB5,KXH:()=>K.KXH,QDP:()=>K.QDP,vaV:()=>K.vaV,pr3:()=>K.pr3,$zE:()=>K.$zE,$dB:()=>K.$dB,p2J:()=>K.p2J,rFm:()=>K.rFm,jfg:()=>K.jfg,A1h:()=>K.A1h,iGz:()=>K.iGz,gC7:()=>K.gC7,Mn0:()=>K.Mn0,MnK:()=>K.MnK,MRQ:()=>K.MRQ,jj_:()=>K.jj_,nY8:()=>K.nY8,GJx:()=>hs.GJ,wNW:()=>K.wNW,TMz:()=>K.TMz,tGH:()=>K.tGH,X$8:()=>K.X$8,nVu:()=>K.nVu,ORI:()=>K.ORI,jxD:()=>K.jxD,pk0:()=>K.pk0,bP9:()=>K.bP9,XmO:()=>K.XmO,Kmu:()=>f.Km,Qgm:()=>K.Qgm,Pah:()=>K.Pah,rsH:()=>K.rsH,OH$:()=>f.OH,BRl:()=>K.BRl,_s9:()=>K._s9,ox3:()=>K.ox3,ybN:()=>K.ybN,ybj:()=>K.ybj,rGP:()=>K.rGP,SQl:()=>K.SQl,BxF:()=>K.BxF,ZgB:()=>K.ZgB,ElG:()=>K.ElG,awo:()=>K.awo,i5R:()=>K.i5R,aAr:()=>K.aAr,T7M:()=>K.T7M,O4G:()=>K.O4G,mxL:()=>K.mxL,XhZ:()=>K.XhZ,lLS:()=>K.lLS,OAQ:()=>K.OAQ,lzr:()=>K.lzr,dv8:()=>K.dv8,gIW:()=>K.gIW,E3$:()=>K.E3$,iPs:()=>K.iPs,uI_:()=>hs.uI,jM4:()=>K.jM4,ToN:()=>K.ToN,X0$:()=>K.X0$,mIA:()=>K.mIA,CwD:()=>K.CwD,mnI:()=>K.mnI,tG8:()=>K.tG8,Cg$:()=>K.Cg$,zfU:()=>K.zfU,RUm:()=>K.RUm,nZd:()=>K.nZd,LXA:()=>K.LXA,RW8:()=>K.RW8,yPW:()=>K.yPW,WRv:()=>K.WRv,VAI:()=>K.VAI,t3d:()=>K.t3d,ySp:()=>K.ySp,cHb:()=>K.cHb,RXX:()=>K.RXX,TL8:()=>K.TL8,LDN:()=>K.LDN,g5A:()=>K.g5A,lNG:()=>K.lNG,LG0:()=>K.LG0,x7F:()=>K.x7F,BLA:()=>K.BLA,Qu_:()=>zt.Q,WT3:()=>K.WT3,xu7:()=>K.xu7,l0G:()=>K.l0G,SDM:()=>K.SDM,Zl4:()=>K.Zl4,e0f:()=>K.e0f,ylV:()=>K.ylV,BTT:()=>q.B,urI:()=>K.urI,LWX:()=>K.LWX,ELo:()=>Bt.E,L5p:()=>jt,mM$:()=>K.mM$,ODT:()=>K.ODT,bCz:()=>K.bCz,pyJ:()=>K.pyJ,Ncv:()=>K.Ncv,kdj:()=>K.kdj,PS5:()=>Lt.P,oJ2:()=>K.oJ2,CQC:()=>K.CQC,mH5:()=>K.mH5,Q6t:()=>K.Q6t,rgM:()=>Ut.rg,LRy:()=>K.LRy,sDr:()=>K.sDr,huO:()=>K.huO,iDl:()=>Da,fUj:()=>K.fUj,P_L:()=>K.P_L,R23:()=>K.R23,hgw:()=>K.hgw,FCQ:()=>K.FCQ,jOE:()=>K.jOE,XQy:()=>K.XQy,D7i:()=>K.D7i,BK4:()=>K.BK4,hVg:()=>K.hVg,TOR:()=>K.TOR,SYI:()=>Pt.S,pJc:()=>K.pJc,uWl:()=>K.uWl,l6P:()=>K.l6P,u$b:()=>K.u$b,vI1:()=>K.vI1,YVe:()=>K.YVe,hql:()=>K.hql,J3C:()=>K.J3C,JiE:()=>K.JiE,rFG:()=>K.rFG,Fin:()=>K.Fin,A8B:()=>K.A8B,C8s:()=>K.C8s,BoJ:()=>K.BoJ,L6G:()=>K.L6G,DvZ:()=>K.DvZ,jgd:()=>K.jgd,Blb:()=>K.Blb,dFH:()=>K.dFH,M6A:()=>K.M6A,Ddj:()=>K.Ddj,GZp:()=>K.GZp,pnw:()=>K.pnw,UcO:()=>K.UcO,YAb:()=>K.YAb,iW0:()=>K.iW0,$jE:()=>K.$jE,PbM:()=>K.PbM,WuN:()=>K.WuN,oFs:()=>K.oFs,iuW:()=>K.iuW,qYS:()=>Z.qY,ylz:()=>Z.yl,X4r:()=>K.X4r,FAs:()=>K.FAs,TBb:()=>K.TBb,dLy:()=>K.dLy,wx0:()=>K.wx0,EwU:()=>K.EwU,dXR:()=>K.dXR,pPe:()=>K.pPe,RMm:()=>K.RMm,rTt:()=>Z.rT,xJ3:()=>K.xJ3,Dr:()=>K.Dr,tnl:()=>Wt.t,HQu:()=>Vt.H,FqL:()=>qt.F,WQq:()=>Gt.W,QiD:()=>Ht,Q7R:()=>Yt.Q,bzn:()=>Xt.b,FLi:()=>Kt.F,XRg:()=>$t.X,qRo:()=>Zt.q,yHs:()=>Qt.y,rYl:()=>Jt.r,FPz:()=>te.F,rfv:()=>ee.r,$jT:()=>ne.$,sub:()=>ae,Hs:()=>Ea.Hs,C0T:()=>h,lZX:()=>he,$v7:()=>fe.$,BFc:()=>pe,kSi:()=>ge,T5N:()=>me,GTe:()=>de.G,HbZ:()=>ye,vjT:()=>ve,ftb:()=>Ti,ROE:()=>be,hOW:()=>xe.h,ZEY:()=>Y,TaL:()=>a,ra8:()=>we.r,wgE:()=>U.w,mkO:()=>ke.m,zQh:()=>_e.z,o8B:()=>Se.o,faB:()=>Ae.f,xWs:()=>oe.x,I1m:()=>Ce,RPU:()=>Ee,O5O:()=>Te,P1l:()=>Ne,kA9:()=>De.k,Xtf:()=>Fe.X,wX9:()=>Ie.w,IPL:()=>Me,jIJ:()=>Re,Cfv:()=>$.Cf,gnS:()=>ze.g,yIG:()=>Be.y,_jP:()=>zi,Lp0:()=>Le.L,rCv:()=>Pe.r,_Xg:()=>Li._X,aOp:()=>je,fLc:()=>Ea.fL,Rj8:()=>Ue.R,Gl3:()=>We.G,eMq:()=>ls,smy:()=>Ve,X7t:()=>qe.X,ISJ:()=>Ea.IS,ASo:()=>Ea.AS,rm6:()=>Ea.rm,y4m:()=>Ge.y,ek5:()=>He.e,Omf:()=>Ye.O,EZY:()=>Oi,_3C:()=>Xe,Pqc:()=>Ke.P,gYU:()=>Ea.gY,SmG:()=>Ea.Sm,FJY:()=>Ri,Hi9:()=>Ea.Hi,QP2:()=>$e,_K2:()=>f._K,LCg:()=>Ze.L,Y12:()=>Qe.Y,p4S:()=>Je.p,oNF:()=>tn.o,UG6:()=>en.U,IYd:()=>nn.I,y5U:()=>an,hVP:()=>$r.h,GSj:()=>on.G,goy:()=>Ea.go,W4C:()=>Ea.W4,RIf:()=>sn.R,wh_:()=>cn.w,cZk:()=>u,kgh:()=>un.k,SY9:()=>Mi,FJy:()=>o,jz4:()=>Ea.jz,vQR:()=>$.vQ,_5H:()=>$._5,OpK:()=>$.Op,Dvk:()=>Li.Dv,ok9:()=>Li.ok,rhj:()=>ln.r,DQN:()=>hn.D,KGM:()=>Zr.K,ngS:()=>dn.n,Slp:()=>$a,U4u:()=>Bi,io:()=>r,ggX:()=>Qr.g,MIs:()=>fn.M,EN4:()=>pn.E,yrW:()=>gn.y,aCs:()=>Ea.aC,kpo:()=>d,H8d:()=>mn.H,M7h:()=>yn.M,InN:()=>vn.I,mPL:()=>Za,mT8:()=>bn,Kgs:()=>xn.K,Rm2:()=>wn.R,Kko:()=>kn.K,nqI:()=>_n.n,HPB:()=>Sn.H,VZ:()=>An.V,n76:()=>Cn.n,NSZ:()=>En.N,ztW:()=>Tn.z,rxB:()=>Nn.r,YYh:()=>Qa,yzS:()=>In,NoW:()=>W.N,DyF:()=>i,T9B:()=>Mn.T,jgi:()=>On.j,NYV:()=>Rn,RO:()=>zn,PhQ:()=>Bn.P,i2o:()=>Ln.i,m1Z:()=>Ea.m1,OYQ:()=>jn,jkA:()=>Un.j,BpO:()=>Wn.B,FFZ:()=>Vn.F,ziu:()=>qn.z,Clk:()=>Xn,CRk:()=>Di,lKK:()=>se.l,YDF:()=>Kn,OjQ:()=>$n,HZy:()=>Zn.H,dA1:()=>ro,xbf:()=>Ni.x,Ec:()=>Qn.E,Mw0:()=>V.M,SaS:()=>Pn.S,P61:()=>Jn.P,op:()=>q.op,X4o:()=>tr,eVF:()=>er.e,BZs:()=>nr,grY:()=>rr,XHu:()=>ir,WLX:()=>ar,dzn:()=>or.d,n7C:()=>sr.n,NsG:()=>cr.N,yyV:()=>ur.y,_eU:()=>lr._,MEE:()=>Ea.ME,whe:()=>hr,iyU:()=>dr,Q0_:()=>fr,_9M:()=>pr,pR9:()=>br,FE$:()=>xr,m0H:()=>wr,YeY:()=>kr,HYA:()=>_r,y17:()=>Sr,Gc4:()=>Ea.Gc,xav:()=>Ar.x,VOZ:()=>Cr.V,gJX:()=>Ea.gJ,krJ:()=>$.kr,tAK:()=>$.tA,VVh:()=>Er.V,j__:()=>Tr.j,rEj:()=>Ea.rE,tQQ:()=>ie.t,BEg:()=>Nr.B,QD2:()=>Dr,LMr:()=>Fr,I2l:()=>Ir,JYU:()=>Mr,z8$:()=>Jr.z,LIG:()=>Or.L,Z$r:()=>Rr.Z,d_2:()=>zr.d,NFr:()=>Fi,g23:()=>s,sZg:()=>Fn,WfX:()=>Br.W,wdz:()=>Lr.w,JFn:()=>pt,jh6:()=>Ea.jh,OkC:()=>Ea.Ok,F12:()=>Pr,ry7:()=>ce.r,_SZ:()=>jr._,vPA:()=>Ka,F8e:()=>Ur.F,L0l:()=>Wr.L,dik:()=>ue.d,Q$M:()=>Vr,zAd:()=>qr,wck:()=>Gr,R0O:()=>Hr,Kro:()=>ft,Vs9:()=>Yr.V,lw0:()=>Xr.l,eDJ:()=>Kr.e,lMo:()=>Ja,Zhr:()=>Ii,lOn:()=>Xa,lDo:()=>ti.l,RZD:()=>ei.R,EwI:()=>Hn.E,Pbu:()=>ni.P,r2V:()=>ri.r,t$z:()=>ii.t,PMw:()=>ai.P,Ym9:()=>oi.Y,YjP:()=>to,jbE:()=>Yn.j,czq:()=>si.c,chL:()=>Ut.ch,Mlm:()=>ci.M,ymU:()=>le.y,OEK:()=>ui.O,tGX:()=>li,KtR:()=>hi,$_$:()=>J,g9W:()=>di,Lpo:()=>fi,yxw:()=>pi,NNh:()=>gi,d_S:()=>gt,Obs:()=>c,DZQ:()=>Ea.DZ,Vsq:()=>rn.V,kBw:()=>Ea.kB,rfw:()=>mi.r,BaG:()=>eo,mgz:()=>G.m,efE:()=>yi,AmM:()=>vi.A,rYx:()=>$.rY,iPt:()=>$.iP,zAU:()=>bi.z,K$i:()=>xi.K,TuY:()=>Ut.Tu,rni:()=>wi,ZSL:()=>mt,jYt:()=>Li.jY,muS:()=>Li.mu,bvq:()=>ki,y7e:()=>Li.y7,bgA:()=>Ft,_M9:()=>_i._,YJN:()=>Ai,Ul9:()=>Ci.U,POl:()=>Ei.P});var r={};n.r(r),n.d(r,{CompositeArrayBuffer:()=>m.D,browserFiles:()=>x,browserHTTPRequest:()=>F,concatenateArrayBuffers:()=>p.AQ,copyModel:()=>P.xk,decodeWeights:()=>p.CY,decodeWeightsStream:()=>p.s5,encodeWeights:()=>p.aG,fromMemory:()=>R,fromMemorySync:()=>z,getLoadHandlers:()=>g.C9,getModelArtifactsForJSON:()=>p.Ej,getModelArtifactsForJSONSync:()=>p.Rl,getModelArtifactsInfoForJSON:()=>p.oR,getSaveHandlers:()=>g.x3,getWeightSpecs:()=>p.Xf,http:()=>D,isHTTPScheme:()=>T,listModels:()=>P.D,loadWeights:()=>A,moveModel:()=>P.Vo,registerLoadRouter:()=>g.R4,registerSaveRouter:()=>g.Yd,removeModel:()=>P.az,weightsLoaderFactory:()=>C,withSaveHandler:()=>B,withSaveHandlerSync:()=>L});var i={};n.r(i),n.d(i,{confusionMatrix:()=>H});var a={};n.r(a),n.d(a,{draw:()=>st,fromPixels:()=>ct,fromPixelsAsync:()=>it,toPixels:()=>ot});var o={};n.r(o),n.d(o,{prepareAndValidate:()=>ut});var s={};n.r(s),n.d(s,{calculateShapes:()=>dt,validateInput:()=>ht,validateUpdateShape:()=>lt});var c={};n.r(c),n.d(c,{TEST_EPSILON_FLOAT16:()=>vt,createVideoElement:()=>Nt,encodeStrings:()=>Tt,expectArrayBuffersEqual:()=>Et,expectArraysClose:()=>bt,expectArraysEqual:()=>_t,expectNumbersClose:()=>St,expectPromiseToFail:()=>kt,expectValuesInRange:()=>Ct,play:()=>Dt,testEpsilon:()=>xt});var u={};n.r(u),n.d(u,{conv2d:()=>Gi,depthwiseConv2d:()=>Xi,matMul:()=>Ki});var l={};n.r(l),n.d(l,{collectGatherOpShapeInfo:()=>ss,computeOutShape:()=>os,segOpComputeOptimalWindowSize:()=>as});var h={};n.r(h),n.d(h,{ERF_A1:()=>ko,ERF_A2:()=>_o,ERF_A3:()=>So,ERF_A4:()=>Ao,ERF_A5:()=>Co,ERF_P:()=>wo,PARALLELIZE_THRESHOLD:()=>ho,RowPartitionType:()=>oo,SELU_SCALE:()=>xo.X,SELU_SCALEALPHA:()=>xo.j,applyActivation:()=>Vi,assertAndGetBroadcastShape:()=>Y.assertAndGetBroadcastShape,assertAxesAreInnerMostDims:()=>Gn.WC,assertParamsConsistent:()=>io,assignToTypedArray:()=>Mo,axesAreInnerMostDims:()=>Gn.WH,calculateShapes:()=>dt,checkEinsumDimSizes:()=>Wo,checkPadOnDimRoundingMode:()=>re.s_,combineLocations:()=>Gn.aF,combineRaggedTensorToTensorShapes:()=>so,complexWithEvenIndex:()=>Do,complexWithOddIndex:()=>Fo,computeConv2DInfo:()=>re.uf,computeConv3DInfo:()=>re.p$,computeDefaultPad:()=>re.G8,computeDilation2DInfo:()=>re.YQ,computeOptimalWindowSize:()=>fo,computeOutAndReduceShapes:()=>Gn.lb,computeOutShape:()=>ao,computePool2DInfo:()=>re.E6,computePool3DInfo:()=>re.l5,convertConv2DDataFormat:()=>re.$Q,decodeEinsumEquation:()=>jo,eitherStridesOrDilationsAreOne:()=>re.G0,expandShapeToKeepDim:()=>Gn.SM,exponent:()=>Ro,exponents:()=>Oo,fromStringArrayToUint8:()=>us,fromUint8ToStringArray:()=>cs,getAxesPermutation:()=>Gn.Em,getBroadcastDims:()=>Y.getBroadcastDims,getComplexWithIndex:()=>Io,getEinsumComputePath:()=>Vo,getEinsumPermutation:()=>Uo,getFusedBiasGradient:()=>Wi,getFusedDyActivation:()=>Ui,getImageCenter:()=>po,getInnerMostAxes:()=>Gn.fK,getPermuted:()=>mo,getRaggedRank:()=>uo,getReductionAxes:()=>Y.getReductionAxes,getReshaped:()=>go,getReshapedPermuted:()=>yo,getRowPartitionTypesHelper:()=>co,getSliceBeginCoords:()=>vo,getSliceSize:()=>bo,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>Yo,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>Xo,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>Ko,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>Qo,getSparseReshapeInputOutputMismatchErrorMessage:()=>ts,getSparseReshapeInputOutputMultipleErrorMessage:()=>Jo,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>$o,getSparseReshapeNegativeOutputDimErrorMessage:()=>Zo,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>is,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>es,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>ns,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>rs,getUndoAxesPermutation:()=>Gn.gx,isIdentityPermutation:()=>qo,log:()=>Eo.R,mergeRealAndImagArrays:()=>To,prepareAndValidate:()=>ut,prepareSplitSize:()=>Ho,segment_util:()=>l,shouldFuse:()=>qi,slice_util:()=>ft,splitRealAndImagArrays:()=>No,stridesOrDilationsArePositive:()=>re.qk,tupleValuesAreOne:()=>re.Dh,upcastType:()=>Ut.Tu,validateDefaultValueShape:()=>lo,validateInput:()=>ht,validateUpdateShape:()=>lt,warn:()=>Eo.i});var d={};n.r(d),n.d(d,{nonMaxSuppressionV3Impl:()=>ua,nonMaxSuppressionV4Impl:()=>la,nonMaxSuppressionV5Impl:()=>ha,whereImpl:()=>Si});n(59624),n(53259),n(41130);var f=n(89e3),p=n(92834),g=n(93131),m=n(76544);function y(t){return new Promise((t=>setTimeout(t))).then(t)}class v{constructor(t){if(!(0,f._K)().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(v.URL_SCHEME)&&(t=t.slice(v.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelJsonFileName=t+".json",this.weightDataFileName=t+".weights.bin"}async save(t){if("undefined"===typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const e=m.D.join(t.weightData),n=window.URL.createObjectURL(new Blob([e],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const e=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],r=(0,p.zV)(t,e),i=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),a=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=i,await y((()=>a.dispatchEvent(new MouseEvent("click")))),null!=t.weightData){const t=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;t.download=this.weightDataFileName,t.href=n,await y((()=>t.dispatchEvent(new MouseEvent("click"))))}return{modelArtifactsInfo:(0,p.oR)(t)}}}}v.URL_SCHEME="downloads://";class b{constructor(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(t));this.jsonFile=t[0],this.weightsFiles=t.slice(1)}async load(){return new Promise(((t,e)=>{const n=new FileReader;n.onload=n=>{const r=JSON.parse(n.target.result),i=r.modelTopology;if(null==i)return void e(new Error("modelTopology field is missing from file ".concat(this.jsonFile.name)));if(null==r.weightsManifest)return void e(new Error("weightManifest field is missing from file ".concat(this.jsonFile.name)));if(0===this.weightsFiles.length)return void t({modelTopology:i});const a=(0,p.Ej)(r,(t=>this.loadWeights(t)));t(a)},n.onerror=t=>e("Failed to read model topology and weights manifest JSON "+"from file '".concat(this.jsonFile.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only."),n.readAsText(this.jsonFile)}))}loadWeights(t){const e=[],n=[];for(const a of t)e.push(...a.weights),n.push(...a.paths);const r=this.checkManifestAndWeightFiles(t),i=n.map((t=>this.loadWeightsFile(t,r[t])));return Promise.all(i).then((t=>[e,t]))}loadWeightsFile(t,e){return new Promise(((n,r)=>{const i=new FileReader;i.onload=t=>{const e=t.target.result;n(e)},i.onerror=e=>r("Failed to weights data from file of path '".concat(t,"'.")),i.readAsArrayBuffer(e)}))}checkManifestAndWeightFiles(t){const e=[],n=this.weightsFiles.map((t=>(0,p.P8)(t.name))),r={};for(const i of t)i.paths.forEach((t=>{const i=(0,p.P8)(t);if(-1!==e.indexOf(i))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(i,"'"));if(e.push(i),-1===n.indexOf(i))throw new Error("Weight file with basename '".concat(i,"' is not provided."));r[t]=this.weightsFiles[n.indexOf(i)]}));if(e.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(e.length,") and the number of weight files provided ")+"(".concat(this.weightsFiles.length,")."));return r}}function x(t){return new b(t)}g.bM.registerSaveRouter((t=>(0,f._K)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(v.URL_SCHEME)?function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new v(t)}(t.slice(v.URL_SCHEME.length)):null));var w=n(23869);function k(t,e,n,r){!function(t){(0,w.vA)(null!=t&&Array.isArray(t)&&t.length>0,(()=>"promises must be a none empty array"))}(t),function(t,e){(0,w.vA)(t>=0&&t<=1,(()=>"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(t))),(0,w.vA)(e>=0&&e<=1,(()=>"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(e))),(0,w.vA)(e>=t,(()=>"startFraction must be no more than endFraction, but "+"got startFraction ".concat(t," and endFraction ")+"".concat(e)))}(n=null==n?0:n,r=null==r?1:r);let i=0;return Promise.all(t.map((a=>(a.then((a=>{const o=n+ ++i/t.length*(r-n);return e(o),a})),a))))}var _=n(64511);async function S(t,e){null==e&&(e={});const n=null==e.fetchFunc?(0,f._K)().platform.fetch:e.fetchFunc,r=t.map((t=>n(t,e.requestInit,{isBinary:!0}))),i=(null==e.onProgress?await Promise.all(r):await k(r,e.onProgress,0,.5)).map((t=>t.arrayBuffer()));return null==e.onProgress?await Promise.all(i):await k(i,e.onProgress,.5,1)}async function A(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return C((t=>S(t,{requestInit:r})))(t,e,n)}function C(t){return async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;const i=e.map((()=>!1)),a={},o=null!=r?r.map((()=>!1)):[],s=[];if(e.forEach(((t,e)=>{let n=0;t.weights.forEach((t=>{const c="quantization"in t?t.quantization.dtype:t.dtype,u=_.i[c]*w.Ze(t.shape),l=()=>{i[e]=!0,null==a[e]&&(a[e]=[]),a[e].push({manifestEntry:t,groupOffset:n,sizeBytes:u})};null!=r?r.forEach(((e,n)=>{e===t.name&&(l(),o[n]=!0)})):l(),s.push(t.name),n+=u}))})),!o.every((t=>t))){const t=r.filter(((t,e)=>!o[e]));throw new Error("Could not find weights in manifest with names: "+"".concat(t.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(s.join(", "),"."))}const c=i.reduce(((t,e,n)=>(e&&t.push(n),t)),[]),u=[];c.forEach((t=>{e[t].paths.forEach((t=>{const e=n+(n.endsWith("/")?"":"/")+t;u.push(e)}))}));const l=await t(u),h={};let d=0;return c.forEach((t=>{const n=e[t].paths.length,r=new m.D(l.slice(d,d+n));a[t].forEach((t=>{const e=r.slice(t.groupOffset,t.groupOffset+t.sizeBytes),n=(0,p.CY)(e,[t.manifestEntry]);for(const r in n)h[r]=n[r]})),d+=n})),h}}class E{constructor(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.weightUrlConverter=e.weightUrlConverter,null!=e.fetchFunc?((0,w.vA)("function"===typeof e.fetchFunc,(()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)")),this.fetch=e.fetchFunc):this.fetch=(0,f._K)().platform.fetch,(0,w.vA)(null!=t&&t.length>0,(()=>"URL path for http must not be null, undefined or empty.")),Array.isArray(t)&&(0,w.vA)(2===t.length,(()=>"URL paths for http must have a length of 2, "+"(actual length is ".concat(t.length,")."))),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{},this.loadOptions=e}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);e.body=new FormData;const n=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],r=(0,p.zV)(t,n);if(e.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=t.weightData){const n=m.D.join(t.weightData);e.body.append("model.weights.bin",new Blob([n],{type:"application/octet-stream"}),"model.weights.bin")}const i=await this.fetch(this.path,e);if(i.ok)return{modelArtifactsInfo:(0,p.oR)(t),responses:[i]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(i.status,"."))}async loadModelJSON(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(t.status,". Please verify this URL points to ")+"the model JSON of the model to load.");let e;try{e=await t.json()}catch(i){let t="Failed to parse model JSON of response from ".concat(this.path,".");throw this.path.endsWith(".pb")?t+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":t+=" Please make sure the server is serving valid JSON for this request.",new Error(t)}const n=e.modelTopology,r=e.weightsManifest;if(null==n&&null==r)throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");return e}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const t=await this.loadModelJSON();return(0,p.Ej)(t,(t=>this.loadWeights(t)))}async loadStream(){const t=await this.loadModelJSON(),e=await this.getWeightUrls(t.weightsManifest),n=(0,p.Xf)(t.weightsManifest);return Object.assign(Object.assign({},t),{weightSpecs:n,getWeightStream:()=>function(t,e){var n;const r=null==e.fetchFunc?(0,f._K)().platform.fetch:e.fetchFunc;let i,a=0;return null===(n=e.onProgress)||void 0===n||n.call(e,0),new ReadableStream({pull:async n=>{for(var o;a<t.length;){if(!i){const n=(await r(t[a],e.requestInit,{isBinary:!0})).body;i=n.getReader()}const{done:s,value:c}=await i.read();if(!s)return void n.enqueue(c);a++,i=void 0,null===(o=e.onProgress)||void 0===o||o.call(e,a/t.length)}n.close()}})}(e,this.loadOptions)})}async getWeightUrls(t){const e=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=function(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),i=n>e?t.substring(n):"";return[r+"/",i]}(e),i=this.weightPathPrefix||n,a=[],o=[];for(const s of t)for(const t of s.paths)null!=this.weightUrlConverter?o.push(this.weightUrlConverter(t)):a.push(i+t+r);return this.weightUrlConverter&&a.push(...await Promise.all(o)),a}async loadWeights(t){const e=await this.getWeightUrls(t);return[(0,p.Xf)(t),await S(e,this.loadOptions)]}}function T(t){return null!=t.match(E.URL_SCHEME_REGEX)}E.URL_SCHEME_REGEX=/^https?:\/\//;const N=(t,e)=>{if("undefined"===typeof fetch&&(null==e||null==e.fetchFunc))return null;{let n=!0;if(n=Array.isArray(t)?t.every((t=>T(t))):T(t),n)return D(t,e)}return null};function D(t,e){return new E(t,e)}function F(t,e){return D(t,e)}g.bM.registerSaveRouter(N),g.bM.registerLoadRouter(N);class I{constructor(t){this.modelArtifacts=t}load(){return this.modelArtifacts}}class M{constructor(t){this.saveHandler=t}save(t){return this.saveHandler(t)}}class O{constructor(t){t.load&&(this.load=()=>Promise.resolve(t.load())),t.save&&(this.save=e=>Promise.resolve(t.save(e)))}}function R(t,e,n,r){return new O(z(...arguments))}function z(t,e,n,r){if(1===arguments.length){return null!=t.modelTopology||null!=t.weightSpecs?new I(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new I({modelTopology:t}))}return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new I({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r})}function B(t){return new M(t)}function L(t){return new M(t)}var P=n(69897),j=n(52863),U=n(69779),W=n(65849),V=n(48926),q=n(26039),G=n(15977);const H=(0,q.op)({confusionMatrix_:function(t,e,n){const r=(0,j.YT)(t,"labels","confusionMatrix"),i=(0,j.YT)(e,"predictions","confusionMatrix");w.vA(null==n||n>0&&Number.isInteger(n),(()=>"If provided, numClasses must be a positive integer, "+"but got ".concat(n))),w.vA(1===r.rank,(()=>"Expected the rank of labels to be 1, but got ".concat(r.rank))),w.vA(1===i.rank,(()=>"Expected the rank of predictions to be 1, "+"but got ".concat(i.rank))),w.vA(r.shape[0]===i.shape[0],(()=>"Mismatch in the number of examples: "+"".concat(r.shape[0]," vs. ").concat(i.shape[0],". ")+"Labels and predictions should have the same number of elements.")),w.vA(n>0&&Number.isInteger(n),(()=>"numClasses is required to be a positive integer, but got "+"".concat(n)));const a=(0,V.M)((0,U.w)(r,"int32"),n),o=(0,V.M)((0,U.w)(i,"int32"),n),s=(0,G.m)(a),c=(0,W.N)(s,o);return(0,U.w)(c,"int32")}});var Y=n(84824),X=n(37484),K=n(87311),$=n(46780),Z=n(90739),Q=n(47921);function J(t,e,n){if((0,w.HO)(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");const r=(0,j.MZ)(t,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return(0,Q.Q)(t,e,r,n)}let tt,et=!1;function nt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,i=!1,a=!1,o=!1,s=!1;if(t.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&t instanceof ImageData)r=!0;else if("undefined"!==typeof HTMLVideoElement&&t instanceof HTMLVideoElement)i=!0;else if("undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement)a=!0;else if(null!=t.getContext)o=!0;else{if(!("undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(t.constructor.name));s=!0}if(null!=(0,$._5)(K.awo,X.T2.backendName)){const n={pixels:t},r={numChannels:e};return X.T2.runKernel(K.awo,n,r)}const[c,u]=i?[t.videoWidth,t.videoHeight]:[t.width,t.height];let l,h;if(o)l=t.getContext("2d").getImageData(0,0,c,u).data;else if(r||n)l=t.data;else if(a||i||s){if(null==tt)if("undefined"===typeof document){if("undefined"===typeof OffscreenCanvas||"undefined"===typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");tt=new OffscreenCanvas(1,1).getContext("2d")}else tt=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});tt.canvas.width=c,tt.canvas.height=u,tt.drawImage(t,0,0,c,u),l=tt.getImageData(0,0,c,u).data}if(4===e)h=new Int32Array(l);else{const t=c*u;h=new Int32Array(t*e);for(let n=0;n<t;n++)for(let t=0;t<e;++t)h[n*e+t]=l[4*n+t]}return J(h,[u,c,e],"int32")}function rt(t){return"undefined"!==typeof window&&"undefined"!==typeof ImageBitmap&&window.hasOwnProperty("createImageBitmap")&&!(t instanceof ImageBitmap)&&function(t){return null!=t&&0!==t.width&&0!==t.height}(t)&&!function(t){return null!=t&&t.data instanceof Uint8Array}(t)}async function it(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=null;if((0,f._K)().getBool("WRAP_TO_IMAGEBITMAP")&&rt(t)){let e;try{e=await createImageBitmap(t,{premultiplyAlpha:"none"})}catch(r){e=null}n=null!=e&&e.width===t.width&&e.height===t.height?e:t}else n=t;return nt(n,e)}function at(t){if(2!==t.rank&&3!==t.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(t.rank,"."));const e=2===t.rank?1:t.shape[2];if(e>4||2===e)throw new Error("toPixels only supports depth of size "+"1, 3 or 4 but got ".concat(e));if("float32"!==t.dtype&&"int32"!==t.dtype)throw new Error("Unsupported type for toPixels: ".concat(t.dtype,".")+" Please use float32 or int32 tensors.")}async function ot(t,e){let n=(0,j.YT)(t,"img","toPixels");if(!(t instanceof Z.qY)){const t=n;n=(0,U.w)(t,"int32"),t.dispose()}at(n);const[r,i]=n.shape.slice(0,2),a=2===n.rank?1:n.shape[2],o=await n.data(),s="float32"===n.dtype?255:1,c=new Uint8ClampedArray(i*r*4);for(let u=0;u<r*i;++u){const t=[0,0,0,255];for(let r=0;r<a;r++){const e=o[u*a+r];if("float32"===n.dtype){if(e<0||e>1)throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(e,"."))}else if("int32"===n.dtype&&(e<0||e>255))throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(e,"."));1===a?(t[0]=e*s,t[1]=e*s,t[2]=e*s):t[r]=e*s}const e=4*u;c[e+0]=Math.round(t[0]),c[e+1]=Math.round(t[1]),c[e+2]=Math.round(t[2]),c[e+3]=Math.round(t[3])}if(null!=e){if(!et){null!=(0,$._5)(K.XmO,X.T2.backendName)&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),et=!0)}e.width=i,e.height=r;const t=e.getContext("2d"),n=new ImageData(c,i,r);t.putImageData(n,0,0)}return n!==t&&n.dispose(),c}function st(t,e,n){let r=(0,j.YT)(t,"img","draw");if(!(t instanceof Z.qY)){const t=r;r=(0,U.w)(t,"int32"),t.dispose()}at(r),function(t){const e=(null===t||void 0===t?void 0:t.alpha)||1;if(e>1||e<0)throw new Error("Alpha value ".concat(e," is suppoed to be in range [0 - 1]."))}(null===n||void 0===n?void 0:n.imageOptions);const i={image:r},a={canvas:e,options:n};X.T2.runKernel(K.XmO,i,a)}const ct=(0,q.op)({fromPixels_:nt});function ut(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(r,"."));if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(e.shape[r-1]," vs. ").concat(n));if(0===(0,w.Ze)(t.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(t.shape,"."));const i=e.shape,a=i[i.length-1];let o=1;for(let h=0;h<i.length-1;++h)o*=i[h];const s=t.shape,c=i.slice();c.pop();let u=1;for(let h=a;h<n;++h)u*=s[h],c.push(s[h]);const l=[...(0,w.Ur)(t.shape).map((t=>t/u)),1].slice(0,a);return[c,o,u,l]}function lt(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,a="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(e.shape,", shape: ").concat(t)+", sliceDim: ".concat(r,", and batchDim: ").concat(i,".");if(n.rank<i)throw new Error(a+" update.rank < ".concat(i,". "));if(t.length<r+(n.rank-i))throw new Error(a+" Output shape length < ".concat(r+(n.rank-i)));if(n.rank!==i+t.length-r)throw new Error(a+" update.rank != ".concat(i+t.length-r));for(let o=0;o<i;++o)if(n.shape[o]!==e.shape[o])throw new Error(a+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(e.shape[o],")."));for(let o=0;o<n.rank-i;++o)if(n.shape[o+i]!==t[o+r])throw new Error(a+" updates.shape[".concat(o+i,"] (").concat(n.shape[o+i],") != shape[").concat(o+i,"] (").concat(t[o+i],")"))}function ht(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(e.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: ".concat(e.shape));if(0===t.size)throw new Error("Updates specified for empty output. updates shape: ".concat(t.shape))}lt(n,e,t)}function dt(t,e,n){const r=e.shape.length,i=r>1?e.shape[r-1]:1,a=n.length;let o=1;for(let c=i;c<a;++c)o*=n[c];const s=i<1?1:i;return{sliceRank:i,numUpdates:(0,w.Ze)(e.shape)/s,sliceSize:o,strides:[...(0,w.Ur)(n.slice(0,i)),1],outputSize:(0,w.Ze)(n)}}var ft=n(48791),pt=n(50581),gt=n(48683),mt=n(73837);const yt=.001,vt=.1;function bt(t,e,n){return null==n&&(n=xt()),wt(t,e,((t,e)=>At(t,e,n)))}function xt(){return 32===X.T2.backend.floatPrecision()?yt:vt}function wt(t,e,n){let r=!0;if(((0,mt.isTypedArray)(t)||(0,mt.isTypedArray)(e))&&(r=!1),(0,mt.isTypedArray)(t)&&(0,mt.isTypedArray)(e)&&(r=!0),r){const n=t.constructor.name,r=e.constructor.name;if(n!==r)throw new Error("Arrays are of different type. Actual: ".concat(n,". ")+"Expected: ".concat(r))}if(Array.isArray(t)&&Array.isArray(e)){const n=(0,j.MZ)(t),r=(0,j.MZ)(e);if(!(0,w.r1)(n,r))throw new Error("Arrays have different shapes. "+"Actual: [".concat(n,"]. Expected: [").concat(r,"]"))}const i=(0,mt.isTypedArray)(t)?t:(0,mt.flatten)(t),a=(0,mt.isTypedArray)(e)?e:(0,mt.flatten)(e);if(i.length!==a.length)throw new Error("Arrays have different lengths actual: ".concat(i.length," vs ")+"expected: ".concat(a.length,".\n")+"Actual:   ".concat(i,".\n")+"Expected: ".concat(a,"."));for(let o=0;o<a.length;++o){const t=i[o],e=a[o];if(!n(t,e))throw new Error("Arrays differ: actual[".concat(o,"] = ").concat(t,", expected[").concat(o,"] = ").concat(e,".\n")+"Actual:   ".concat(i,".\n")+"Expected: ".concat(a,"."))}"undefined"!==typeof expect&&expect().nothing()}function kt(t,e){t().then((()=>e.fail()),(()=>e())),"undefined"!==typeof expect&&expect().nothing()}function _t(t,e){const n="string"===typeof e||"number"===typeof e||"boolean"===typeof e?[e]:e;return(0,w.Kg)(t)||(0,w.Kg)(t[0])||(0,w.Kg)(e)||(0,w.Kg)(e[0])?wt(t,n,((t,e)=>t==e)):wt(t,e,((t,e)=>At(t,e,0)))}function St(t,e,n){if(null==n&&(n=xt()),!At(t,e,n))throw new Error("Numbers differ: actual === ".concat(t,", expected === ").concat(e));"undefined"!==typeof expect&&expect().nothing()}function At(t,e,n){return!isFinite(t)&&!isFinite(e)||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}function Ct(t,e,n){for(let r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error("Value out of range:".concat(t[r]," low: ").concat(e,", high: ").concat(n))}function Et(t,e){const n=new Float32Array(t),r=new Float32Array(e);if(n.length!==r.length)throw new Error("Expected ArrayBuffer to be of length "+"".concat(r.length,", but it was ").concat(n.length));for(let i=0;i<r.length;i++)if(n[i]!==r[i])throw new Error("Expected ArrayBuffer value at ".concat(i," to be ")+"".concat(r[i]," but got ").concat(n[i]," instead"))}function Tt(t){for(let e=0;e<t.length;e++){const n=t[e];Array.isArray(n)?Tt(n):t[e]=(0,mt.encodeString)(n)}return t}function Nt(t){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(t),new Promise((t=>{e.addEventListener("loadeddata",(n=>t(e))),e.load()}))}async function Dt(t){await t.play(),"requestVideoFrameCallback"in t&&await new Promise((e=>{t.requestVideoFrameCallback(e)}))}const Ft="4.17.0";var It=n(52342),Mt=n(51662),Ot=n(19527),Rt=n(74190),zt=n(59490),Bt=n(59777),Lt=n(95241),Pt=n(67060);class jt{static sgd(t){return new Pt.S(t)}static momentum(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new zt.Q(t,e,n)}static rmsprop(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return new Lt.P(t,e,n,r,i)}static adam(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Ot.F(t,e,n,r)}static adadelta(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new It.K(t,e,n)}static adamax(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return new Rt.o(t,e,n,r,i)}static adagrad(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return new Mt.a(t,e)}}var Ut=n(15188),Wt=n(59470),Vt=n(75090),qt=n(34528),Gt=n(67281);const Ht=(0,q.op)({addN_:function(t){w.vA(Array.isArray(t),(()=>"The argument passed to tf.addN() must be a list of tensors")),w.vA(t.length>=1,(()=>"Must pass at least one tensor to tf.addN(), but got "+"".concat(t.length)));const e=t.map(((t,e)=>(0,j.YT)(t,"tensors".concat(e),"addN"))),n=e[0];e.forEach((t=>{if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((t=>{if(!w.r1(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));const r=e;return X.T2.runKernel(K.EkD,r)}});var Yt=n(86465),Xt=n(25552),Kt=n(31003),$t=n(72345),Zt=n(50155),Qt=n(94467),Jt=n(16802),te=n(67986),ee=n(68080),ne=n(70963),re=n(157),ie=n(89068);const ae=(0,q.op)({avgPool3d_:function(t,e,n,r,i){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC";const o=(0,j.YT)(t,"x","avgPool3d","float32");let s=o,c=!1;4===o.rank&&(c=!0,s=(0,ie.t)(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),w.vA(5===s.rank,(()=>"Error in avgPool3d: x must be rank 5 but got rank ".concat(s.rank,"."))),w.vA("NDHWC"===a,(()=>"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(a))),w.vA("number"===typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,(()=>"Error in avgPool3d: Stride must be > 0, but got '".concat(n,"'"))),(0,re.s_)("avgPool3d",r,i);const u={x:s},l={filterSize:e,strides:n,pad:r,dimRoundingMode:i,dataFormat:a};let h=X.T2.runKernel(K.cS,u,l);return h=(0,U.w)(h,s.dtype),c?(0,ie.t)(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});var oe=n(89360),se=n(86272),ce=n(1242),ue=n(8016),le=n(47173);const he=(0,q.op)({basicLSTMCell_:function(t,e,n,r,i,a){const o=(0,j.YT)(t,"forgetBias","basicLSTMCell"),s=(0,j.YT)(e,"lstmKernel","basicLSTMCell"),c=(0,j.YT)(n,"lstmBias","basicLSTMCell"),u=(0,j.YT)(r,"data","basicLSTMCell"),l=(0,j.YT)(i,"c","basicLSTMCell"),h=(0,j.YT)(a,"h","basicLSTMCell"),d=(0,oe.x)([u,h],1),f=(0,W.N)(d,s),p=(0,Gt.W)(f,c),g=p.shape[0],m=p.shape[1]/4,y=[g,m],v=(0,ue.d)(p,[0,0],y),b=(0,ue.d)(p,[0,m],y),x=(0,ue.d)(p,[0,2*m],y),w=(0,ue.d)(p,[0,3*m],y),k=(0,Gt.W)((0,se.l)((0,ce.r)(v),(0,le.y)(b)),(0,se.l)(l,(0,ce.r)((0,Gt.W)(o,x))));return[k,(0,se.l)((0,le.y)(k),(0,ce.r)(w))]}});var de=n(81406),fe=n(26670);const pe=(0,q.op)({batchNorm2d_:function(t,e,n,r,i,a){const o=(0,j.YT)(t,"x","batchNorm"),s=(0,j.YT)(e,"mean","batchNorm"),c=(0,j.YT)(n,"variance","batchNorm");let u,l;return null!=i&&(u=(0,j.YT)(i,"scale","batchNorm")),null!=r&&(l=(0,j.YT)(r,"offset","batchNorm")),w.vA(2===o.rank,(()=>"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(o.rank,"."))),w.vA(2===s.rank||1===s.rank,(()=>"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(s.rank,"."))),w.vA(2===c.rank||1===c.rank,(()=>"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(c.rank,"."))),null!=u&&w.vA(2===u.rank||1===u.rank,(()=>"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(u.rank,"."))),null!=l&&w.vA(2===l.rank||1===l.rank,(()=>"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,"."))),(0,fe.$)(o,s,c,l,u,a)}});const ge=(0,q.op)({batchNorm3d_:function(t,e,n,r,i,a){const o=(0,j.YT)(t,"x","batchNorm"),s=(0,j.YT)(e,"mean","batchNorm"),c=(0,j.YT)(n,"variance","batchNorm");let u,l;return null!=i&&(u=(0,j.YT)(i,"scale","batchNorm")),null!=r&&(l=(0,j.YT)(r,"offset","batchNorm")),w.vA(3===o.rank,(()=>"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(o.rank,"."))),w.vA(3===s.rank||1===s.rank,(()=>"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(s.rank,"."))),w.vA(3===c.rank||1===c.rank,(()=>"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(c.rank,"."))),null!=u&&w.vA(3===u.rank||1===u.rank,(()=>"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(u.rank,"."))),null!=l&&w.vA(3===l.rank||1===l.rank,(()=>"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,"."))),(0,fe.$)(o,s,c,l,u,a)}});const me=(0,q.op)({batchNorm4d_:function(t,e,n,r,i,a){const o=(0,j.YT)(t,"x","batchNorm"),s=(0,j.YT)(e,"mean","batchNorm"),c=(0,j.YT)(n,"variance","batchNorm");let u,l;return null!=i&&(u=(0,j.YT)(i,"scale","batchNorm")),null!=r&&(l=(0,j.YT)(r,"offset","batchNorm")),w.vA(4===o.rank,(()=>"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(o.rank,"."))),w.vA(4===s.rank||1===s.rank,(()=>"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(s.rank,"."))),w.vA(4===c.rank||1===c.rank,(()=>"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(c.rank,"."))),null!=u&&w.vA(4===u.rank||1===u.rank,(()=>"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(u.rank,"."))),null!=l&&w.vA(4===l.rank||1===l.rank,(()=>"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,"."))),(0,fe.$)(o,s,c,l,u,a)}});const ye=(0,q.op)({bincount_:function(t,e,n){const r=(0,j.YT)(t,"x","bincount"),i=(0,j.YT)(e,"weights","bincount");w.vA("int32"===r.dtype,(()=>"Error in bincount: input "+"dtype must be int32, but got ".concat(r.dtype))),w.vA(n>=0,(()=>"size must be non-negative, but got ".concat(n,"."))),w.vA(i.size===r.size||0===i.size,(()=>"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(r.shape,", weights shape: ")+"".concat(i.shape,".")));const a={x:r,weights:i},o={size:n};return X.T2.runKernel(K.N4F,a,o)}});const ve=(0,q.op)({bitwiseAnd_:function(t,e){const n=(0,j.YT)(t,"x","bitwiseAnd"),r=(0,j.YT)(e,"y","bitwiseAnd");if(!(0,w.r1)(n.shape,r.shape))throw new Error("BitwiseAnd: Tensors must have the same shape. x: ".concat(n.shape,", y: ").concat(r.shape));if("int32"!==n.dtype||"int32"!==r.dtype)throw new Error("BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ".concat(n.dtype," and type of y: ").concat(r.dtype));const i={a:n,b:r};return X.T2.runKernel(K.HNs,i)}});const be=(0,q.op)({broadcastArgs_:function(t,e){const n=(0,j.YT)(t,"s0","broadcastArgs","int32"),r=(0,j.YT)(e,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error("broadcastArgs(): first input must be a vector (rank=1). "+"Has rank ".concat(n.rank));if(1!==r.rank)throw new Error("broadcastArgs(): second input must be a vector (rank=1). "+"Has rank ".concat(r.rank));const i={s0:n,s1:r};return X.T2.runKernel(K.vj7,i)}});var xe=n(99965),we=n(80186),ke=n(33989),_e=n(68042),Se=n(62503),Ae=n(76234);const Ce=(0,q.op)({concat1d_:function(t){return(0,oe.x)(t,0)}});const Ee=(0,q.op)({concat2d_:function(t,e){return(0,oe.x)(t,e)}});const Te=(0,q.op)({concat3d_:function(t,e){return(0,oe.x)(t,e)}});const Ne=(0,q.op)({concat4d_:function(t,e){return(0,oe.x)(t,e)}});var De=n(65783),Fe=n(31880),Ie=n(80824);const Me=(0,q.op)({conv3d_:function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1];const o=(0,j.YT)(t,"x","conv3d"),s=(0,j.YT)(e,"filter","conv3d");let c=o,u=!1;4===o.rank&&(u=!0,c=(0,ie.t)(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),w.vA(5===c.rank,(()=>"Error in conv3d: input must be rank 5, but got rank ".concat(c.rank,"."))),w.vA(5===s.rank,(()=>"Error in conv3d: filter must be rank 5, but got rank "+"".concat(s.rank,"."))),w.vA(c.shape[4]===s.shape[3],(()=>"Error in conv3d: depth of input (".concat(c.shape[4],") must match ")+"input depth for filter ".concat(s.shape[3],"."))),w.vA((0,re.G0)(n,a),(()=>"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(a,"'"))),w.vA("NDHWC"===i,(()=>"Error in conv3d: got dataFormat of ".concat(i," but only NDHWC is currently supported."))),w.vA((0,re.qk)(a),(()=>"Error in conv3D: Dilated rates should be larger than 0.")),w.vA((0,re.qk)(n),(()=>"Error in conv3D: Strides should be larger than 0."));const l={x:c,filter:s},h={strides:n,pad:r,dataFormat:i,dilations:a},d=X.T2.runKernel(K.A1h,l,h);return u?(0,ie.t)(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});var Oe=n(20289);const Re=(0,q.op)({conv3dTranspose_:function(t,e,n,r,i){const a=(0,j.YT)(t,"x","conv3dTranspose"),o=(0,j.YT)(e,"filter","conv3dTranspose");return(0,Oe.c)(n,a,o,r,i)}});var ze=n(48133),Be=n(84033),Le=n(79808),Pe=n(91482);const je=(0,q.op)({denseBincount_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=(0,j.YT)(t,"x","denseBincount"),a=(0,j.YT)(e,"weights","denseBincount");w.vA("int32"===i.dtype,(()=>"Error in denseBincount: input "+"dtype must be int32, but got ".concat(i.dtype))),w.vA(i.rank<=2,(()=>"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(i.rank,"."))),w.vA(n>=0,(()=>"size must be non-negative, but got ".concat(n,"."))),w.vA(a.size===i.size||0===a.size,(()=>"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(i.shape,", weights shape: ")+"".concat(a.shape,".")));const o={x:i,weights:a},s={size:n,binaryOutput:r};return X.T2.runKernel(K.wNW,o,s)}});var Ue=n(89854),We=n(92302);const Ve=(0,q.op)({diag_:function(t){const e={x:(0,j.YT)(t,"x","diag")};return X.T2.runKernel(K.ORI,e)}});var qe=n(14640),Ge=n(64113),He=n(83645),Ye=n(33185);const Xe=(0,q.op)({einsum_:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];const i=n.map(((t,e)=>(0,j.YT)(t,"tensors".concat(e),"einsum"))),a={equation:t};return X.T2.runKernel(K.Qgm,i,a)}});var Ke=n(62534);const $e=(0,q.op)({ensureShape_:function(t,e){const n=(0,j.YT)(t,"x","ensureShape","string_or_numeric");if(!(0,w.e_)(n.shape,e))throw new Error("EnsureShape: Shape of tensor ".concat(n.shape," is not compatible with expected shape ").concat(e));return t}});var Ze=n(92138),Qe=n(47829),Je=n(13779),tn=n(48389),en=n(70816),nn=n(54195),rn=n(35716);const an=(0,q.op)({eye_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";null==e&&(e=t);const i=(0,we.r)([t,e],r),a=t<=e?t:e;for(let s=0;s<a;++s)i.set(1,s,s);const o=(0,ie.t)(i.toTensor(),[t,e]);if(null==n)return o;if(1===n.length)return(0,rn.V)((0,en.U)(o,0),[n[0],1,1]);if(2===n.length)return(0,rn.V)((0,en.U)((0,en.U)(o,0),0),[n[0],n[1],1,1]);if(3===n.length)return(0,rn.V)((0,en.U)((0,en.U)((0,en.U)(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}});var on=n(99333),sn=n(96812),cn=n(64149),un=n(50511),ln=n(60228),hn=n(39103),dn=n(66758),fn=n(38660),pn=n(37304),gn=n(42310),mn=n(51965),yn=n(72969),vn=n(64210);function bn(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:t,stop:e,num:n};return X.T2.runKernel(K.mnI,{},r)}var xn=n(85593),wn=n(18688),kn=n(90781),_n=n(34675),Sn=n(8229),An=n(45492),Cn=n(21183),En=n(87375),Tn=n(65497),Nn=n(6699);const Dn=2147483648;const Fn=(0,q.op)({searchSorted_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left";const r=(0,j.YT)(t,"sortedSequence","searchSorted"),i=(0,j.YT)(e,"values","searchSorted"),a=r.shape[r.shape.length-1],o=i.shape[i.shape.length-1],s=(0,ie.t)(r,[-1,a]),c=(0,ie.t)(i,[-1,o]);if(s.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(s.shape[0]!==c.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if((0,w.Ze)(c.shape)>=Dn)throw new Error("values tensor size must less than ".concat(Dn));if(s.shape[1]>=Dn)throw new Error("trailing dim_size must less than ".concat(Dn," for int32 output type, was ").concat(s.shape[1]));const u={sortedSequence:s,values:c},l={side:n};return X.T2.runKernel(K.uWl,u,l)}});function In(t,e){return Fn(t,e,"left")}var Mn=n(73e3),On=n(8853);const Rn=(0,q.op)({maxPool3d_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC";const o=(0,j.YT)(t,"x","maxPool3d");let s=o,c=!1;4===o.rank&&(c=!0,s=(0,ie.t)(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),w.vA(5===s.rank,(()=>"Error in maxPool3d: x must be rank 5 but got rank ".concat(s.rank,"."))),w.vA("NDHWC"===a,(()=>"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(a))),(0,re.s_)("maxPool3d",r,i);const u={x:s},l={filterSize:e,strides:n,pad:r,dimRoundingMode:i,dataFormat:a},h=X.T2.runKernel(K.ySp,u,l);return c?(0,ie.t)(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});const zn=(0,q.op)({maxPoolWithArgmax_:function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const a={x:(0,j.YT)(t,"x","maxPoolWithArgmax")},o={filterSize:e,strides:n,pad:r,includeBatchInIndex:i},s=X.T2.runKernel(K.TL8,a,o);return{result:s[0],indexes:s[1]}}});var Bn=n(98104),Ln=n(49577),Pn=n(88865);function jn(t,e){let{indexing:n="xy"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("xy"!==n&&"ij"!==n)throw new TypeError("".concat(n," is not a valid third argument to meshgrid"));if(void 0===t)return[];let r=(0,j.YT)(t,"x","meshgrid",t instanceof Z.qY?t.dtype:"float32");if(void 0===e)return[r];let i=(0,j.YT)(e,"y","meshgrid",e instanceof Z.qY?e.dtype:"float32");const a=(0,w.Ze)(r.shape),o=(0,w.Ze)(i.shape);return"xy"===n?(r=(0,ie.t)(r,[1,-1]),i=(0,ie.t)(i,[-1,1]),[(0,W.N)((0,Pn.S)([o,1],r.dtype),r),(0,W.N)(i,(0,Pn.S)([1,a],i.dtype))]):(r=(0,ie.t)(r,[-1,1]),i=(0,ie.t)(i,[1,-1]),[(0,W.N)(r,(0,Pn.S)([1,o],r.dtype)),(0,W.N)((0,Pn.S)([a,1],i.dtype),i)])}var Un=n(60278),Wn=n(91086),Vn=n(32509),qn=n(5634),Gn=n(58724),Hn=n(95195),Yn=n(77820);const Xn=(0,q.op)({moments_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t=(0,j.YT)(t,"x","moments");const r=(0,w.Y6)(e,t.shape),i=(0,Ln.i)(t,r,n);let a=i.shape;n||(a=(0,Gn.SM)(i.shape,r));const o=(0,Hn.E)((0,Yn.j)((0,U.w)(t,"float32"),(0,ie.t)(i,a)));return{mean:i,variance:(0,Ln.i)(o,r,n)}}});const Kn=(0,q.op)({multiRNNCell_:function(t,e,n,r){const i=(0,j.YT)(e,"data","multiRNNCell"),a=(0,j.j1)(n,"c","multiRNNCell"),o=(0,j.j1)(r,"h","multiRNNCell");let s=i;const c=[];for(let h=0;h<t.length;h++){const e=t[h](s,a[h],o[h]);c.push(e[0]),c.push(e[1]),s=e[1]}const u=[],l=[];for(let h=0;h<c.length;h+=2)u.push(c[h]),l.push(c[h+1]);return[u,l]}});const $n=(0,q.op)({multinomial_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=(0,j.YT)(t,"logits","multinomial"),a=i.size,o=i.rank;if(a<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(a,"."));if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(o));n=n||Math.random();const s={logits:1===o?(0,ie.t)(i,[1,-1]):i},c={numSamples:e,seed:n,normalized:r},u=X.T2.runKernel(K.WT3,s,c);return 1===o?(0,ie.t)(u,[u.size]):u}});var Zn=n(5008),Qn=n(73848),Jn=n(98903);const tr=(0,q.op)({outerProduct_:function(t,e){const n=(0,j.YT)(t,"v1","outerProduct"),r=(0,j.YT)(e,"v2","outerProduct");w.vA(1===n.rank&&1===r.rank,(()=>"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")));const i=(0,ie.t)(n,[-1,1]),a=(0,ie.t)(r,[1,-1]);return(0,W.N)(i,a)}});var er=n(67507);const nr=(0,q.op)({pad1d_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,w.vA)(2===e.length,(()=>"Invalid number of paddings. Must be length of 2.")),(0,er.e)(t,[e],n)}});const rr=(0,q.op)({pad2d_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,w.vA)(2===e.length&&2===e[0].length&&2===e[1].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),(0,er.e)(t,e,n)}});const ir=(0,q.op)({pad3d_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,w.vA)(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),(0,er.e)(t,e,n)}});const ar=(0,q.op)({pad4d_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,w.vA)(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),(0,er.e)(t,e,n)}});var or=n(18570),sr=n(78188),cr=n(83860),ur=n(30629),lr=n(38517);const hr=(0,q.op)({raggedGather_:function(t,e,n,r){const i={paramsNestedSplits:t.map(((t,e)=>(0,j.YT)(t,"tensors".concat(e),"raggedGather","int32"))),paramsDenseValues:(0,j.YT)(e,"paramsDenseValues","raggedGather"),indices:(0,j.YT)(n,"indices","raggedGather","int32")},a={outputRaggedRank:r},o=X.T2.runKernel(K.oJ2,i,a);return{outputNestedSplits:o.slice(0,o.length-1),outputDenseValues:o[o.length-1]}}});const dr=(0,q.op)({raggedRange_:function(t,e,n){const r=(0,j.YT)(t,"starts","raggedRange"),i={starts:r,limits:(0,j.YT)(e,"limits","raggedRange",r.dtype),deltas:(0,j.YT)(n,"deltas","raggedRange",r.dtype)},a=X.T2.runKernel(K.CQC,i);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}});const fr=(0,q.op)({raggedTensorToTensor_:function(t,e,n,r,i){const a=(0,j.YT)(t,"shape","raggedTensorToTensor","int32"),o=(0,j.YT)(e,"values","raggedTensorToTensor"),s={shape:a,values:o,defaultValue:(0,j.YT)(n,"defaultValue","raggedTensorToTensor",o.dtype),rowPartitionTensors:r.map(((t,e)=>(0,j.YT)(t,"tensors".concat(e),"raggedTensorToTensor","int32")))},c={rowPartitionTypes:i};return X.T2.runKernel(K.mH5,s,c)}});const pr=(0,q.op)({rand_:function(t,e,n){(0,w.SA)(t);const r=(0,w.Ze)(t);let i=null;if(null==n||"float32"===n)i=new Float32Array(r);else if("int32"===n)i=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));i=new Uint8Array(r)}for(let a=0;a<r;a++)i[a]=e();return X.T2.makeTensor(i,t,n)}});var gr=n(11053);class mr{constructor(t,e,n,r,i){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const a=i||Math.random();this.random=gr.alea(a.toString())}nextValue(){if(!isNaN(this.nextVal)){const t=this.nextVal;return this.nextVal=NaN,t}let t,e,n=!1;for(;!n;){let r,i,a;do{r=2*this.random()-1,i=2*this.random()-1,a=r*r+i*i}while(a>=1||0===a);const o=Math.sqrt(-2*Math.log(a)/a);t=this.mean+this.stdDev*r*o,e=this.mean+this.stdDev*i*o,this.truncated&&!this.isValidTruncated(t)||(n=!0)}return this.truncated&&!this.isValidTruncated(e)||(this.nextVal=this.convertValue(e)),this.convertValue(t)}convertValue(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class yr{constructor(t,e,n,r){this.alpha=t,this.beta=1/e,this.dtype=n;const i=r||Math.random();this.randu=gr.alea(i.toString()),this.randn=new mr(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,e,n,r,i,a;for(;;){do{r=this.randn.nextValue(),a=1+this.c*r}while(a<=0);if(a*=a*a,t=r*r,e=1-.331*t*t,n=.5*t+this.d*(1-a+Math.log(a)),i=this.randu(),i<e||Math.log(i)<n)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)}convertValue(t){return"float32"===this.dtype?t:Math.round(t)}}class vr{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"===typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(t," - ").concat(e," <= 1 and dtype is not float"));this.random=gr.alea(r)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const br=(0,q.op)({randomGamma_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",i=arguments.length>4?arguments[4]:void 0;if((0,w.SA)(t),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type ".concat(r));const a=new yr(e,n,r,i),o=(0,we.r)(t,r);for(let s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}});const xr=(0,q.op)({randomNormal_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if((0,w.SA)(t),null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));const a=new mr(e,n,r,!1,i),o=(0,we.r)(t,r);for(let s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}});const wr=(0,q.op)({randomStandardNormal_:function(t,e,n){if(null!=e&&"bool"===e)throw new Error("Unsupported data type ".concat(e));return xr(t,0,1,e,n)}});const kr=(0,q.op)({randomUniform_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",i=arguments.length>4?arguments[4]:void 0;(0,w.SA)(t);const a=(0,we.r)(t,r),o=new vr(e,n,null,i);for(let s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}});const _r=(0,q.op)({randomUniformInt_:function(t,e,n,r){return kr(t,e,n,"int32",r)}});function Sr(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");const i={start:t,stop:e,step:n,dtype:r};return X.T2.runKernel(K.Q6t,{},i)}var Ar=n(86372),Cr=n(95868),Er=n(38414),Tr=n(6650),Nr=n(23540);const Dr=(0,q.op)({reverse1d_:function(t){const e=(0,j.YT)(t,"x","reverse");return w.vA(1===e.rank,(()=>"Error in reverse1D: x must be rank 1 but got rank ".concat(e.rank,"."))),(0,Nr.B)(e,0)}});const Fr=(0,q.op)({reverse2d_:function(t,e){const n=(0,j.YT)(t,"x","reverse");return w.vA(2===n.rank,(()=>"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,"."))),(0,Nr.B)(n,e)}});const Ir=(0,q.op)({reverse3d_:function(t,e){const n=(0,j.YT)(t,"x","reverse");return w.vA(3===n.rank,(()=>"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,"."))),(0,Nr.B)(n,e)}});const Mr=(0,q.op)({reverse4d_:function(t,e){const n=(0,j.YT)(t,"x","reverse");return w.vA(4===n.rank,(()=>"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,"."))),(0,Nr.B)(n,e)}});var Or=n(16242),Rr=n(30414),zr=n(90844),Br=n(52203),Lr=n(848);const Pr=async function(t,e){const n=(0,j.YT)(t,"x","setdiff1d"),r=(0,j.YT)(e,"y","setdiff1d");w.vA(n.dtype===r.dtype,(()=>"x and y should have the same dtype, but got x (".concat(n.dtype,") and y (").concat(r.dtype,")."))),w.vA(1===n.rank,(()=>"x should be 1D tensor, but got x (".concat(n.shape,")."))),w.vA(1===r.rank,(()=>"y should be 1D tensor, but got y (".concat(r.shape,").")));const i=await n.data(),a=await r.data(),o=new Set(a);let s=0;for(let l=0;l<i.length;l++)o.has(i[l])||s++;const c=new Z.yl([s],n.dtype),u=new Z.yl([s],"int32");for(let l=0,h=0;l<i.length;l++)o.has(i[l])||(c.values[h]=i[l],u.values[h]=l,h++);return[c.toTensor(),u.toTensor()]};var jr=n(5601),Ur=n(85956),Wr=n(15990);const Vr=(0,q.op)({slice1d_:function(t,e,n){const r=(0,j.YT)(t,"x","slice1d");return w.vA(1===r.rank,(()=>"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor"))),(0,ue.d)(r,[e],[n])}});const qr=(0,q.op)({slice2d_:function(t,e,n){const r=(0,j.YT)(t,"x","slice2d");return w.vA(2===r.rank,(()=>"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor"))),(0,ue.d)(r,e,n)}});const Gr=(0,q.op)({slice3d_:function(t,e,n){const r=(0,j.YT)(t,"x","slice3d");return w.vA(3===r.rank,(()=>"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor"))),(0,ue.d)(r,e,n)}});const Hr=(0,q.op)({slice4d_:function(t,e,n){const r=(0,j.YT)(t,"x","slice4d");return w.vA(4===r.rank,(()=>"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor"))),(0,ue.d)(r,e,n)}});var Yr=n(80724),Xr=n(22824),Kr=n(90602),$r=n(42587),Zr=n(93674),Qr=n(30890),Jr=n(35721),ti=n(77554),ei=n(45766),ni=n(77189),ri=n(2330),ii=n(22190),ai=n(52946),oi=n(57136),si=n(17937),ci=n(66465),ui=n(98869);function li(t,e){(0,w.HO)(t);const n=(0,j.MZ)(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return(0,Q.Q)(t,null,n,e)}function hi(t,e,n){if((0,w.HO)(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");const r=(0,j.MZ)(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return(0,Q.Q)(t,e,r,n)}function di(t,e,n){if((0,w.HO)(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");const r=(0,j.MZ)(t,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return(0,Q.Q)(t,e,r,n)}function fi(t,e,n){if((0,w.HO)(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");const r=(0,j.MZ)(t,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return(0,Q.Q)(t,e,r,n)}function pi(t,e,n){if((0,w.HO)(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");const r=(0,j.MZ)(t,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,(0,Q.Q)(t,e,r,n)}const gi=(0,q.op)({tensorScatterUpdate_:function(t,e,n){const r=(0,j.YT)(t,"tensor","tensorScatterupdate"),i=(0,j.YT)(e,"indices","tensorScatterupdate","int32"),a=(0,j.YT)(n,"updates","tensorScatterupdate");if(ht(a,i,r.shape),r.dtype!==a.dtype)throw new Error("tensor and updates must have the same dtype, instead they are ".concat(r.dtype," and ").concat(a.dtype,"."));const o={tensor:r,indices:i,updates:a};return X.T2.runKernel(K.X4r,o,{})}});var mi=n(87984);const yi=(0,q.op)({truncatedNormal_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if((0,w.SA)(t),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");const a=new mr(e,n,r,!0,i),o=(0,we.r)(t,r);for(let s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}});var vi=n(68583),bi=n(66788),xi=n(84491);function wi(t,e){return Fn(t,e,"right")}function ki(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return X.T2.makeVariable(t,e,n,r)}var _i=n(52117);function Si(t,e){const n=[];for(let a=0;a<e.length;a++)e[a]&&n.push(a);const r=(0,we.r)(t,"int32"),i=(0,we.r)([n.length,t.length],"int32");for(let a=0;a<n.length;a++){const e=r.indexToLoc(n[a]),o=a*t.length;i.values.set(e,o)}return i.toTensor()}const Ai=async function(t){const e=(0,j.YT)(t,"condition","whereAsync","bool"),n=await e.data(),r=Si(e.shape,n);return t!==e&&e.dispose(),r};var Ci=n(38197),Ei=n(90043);const Ti=async function(t,e,n){const r=(0,j.YT)(t,"tensor","boolMask"),i=(0,j.YT)(e,"mask","boolMask","bool"),a=null==n?0:n,o=i.rank,s=r.shape;w.vA(o>0,(()=>"mask cannot be scalar")),w.O3(s.slice(a,a+o),i.shape,"mask's shape must match the first K dimensions of tensor's shape,");let c=1;for(let g=a;g<a+o;g++)c*=s[g];const u=s.slice(0,a).concat([c],s.slice(a+o)),l=(0,ie.t)(r,u),h=(0,ie.t)(i,[-1]),d=await Ai(h),f=(0,ri.r)(d,[1]),p=(0,un.k)(l,f,a);return t!==r&&r.dispose(),e!==i&&i.dispose(),f.dispose(),l.dispose(),h.dispose(),d.dispose(),p};var Ni=n(48306);const Di=(0,q.op)({movingAverage_:function(t,e,n,r){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const a=(0,j.YT)(t,"v","movingAverage"),o=(0,j.YT)(e,"x","movingAverage"),s=(0,j.YT)(n,"decay","movingAverage");(0,gt.assertTypesMatch)(a,o),w.vA(w.r1(a.shape,o.shape),(()=>"Shape mismatch in v and x"));const c=(0,zr.d)(1),u=(0,Yn.j)(c,s);let l=(0,se.l)((0,Yn.j)(o,a),u);if(i){w.vA(null!=r,(()=>"When using zeroDebias: true, step is required."));const t=(0,j.YT)(r,"step","movingAverage");l=(0,Ge.y)(l,(0,Yn.j)(c,(0,sr.n)(s,t)))}return(0,Gt.W)(a,l)}});const Fi=(0,q.op)({scatterND_:function(t,e,n){(0,w.SA)(n);const r=(0,j.YT)(t,"indices","scatterND","int32"),i=(0,j.YT)(e,"updates","scatterND");ht(i,r,n);const a={indices:r,updates:i},o={shape:n};return X.T2.runKernel(K.pJc,a,o)}});const Ii=(0,q.op)({sparseToDense_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,w.SA)(n);const i=(0,j.YT)(t,"sparseIndices","sparseToDense","int32"),a=(0,j.YT)(e,"sparseValues","sparseToDense","string_or_numeric"),o=(0,j.YT)(r,"defaultValue","sparseToDense",a.dtype);!function(t,e,n,r){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(t.shape,"."));const i=t.rank>0?t.shape[0]:1,a=t.rank>1?t.shape[1]:1;if(n.length!==a)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(a,"."));const o=e.size;if(0!==e.rank&&(1!==e.rank||o!==i))throw new Error("sparseValues has incorrect shape "+"".concat(e.shape,", should be [] or [").concat(i,"]"));if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,a,n,o);const s={sparseIndices:i,sparseValues:a,defaultValue:o},c={outputShape:n};return X.T2.runKernel(K.jgd,s,c)}});const Mi=(0,q.op)({gatherND_:function(t,e){const n=(0,j.YT)(e,"indices","gatherND","int32"),r={params:(0,j.YT)(t,"x","gatherND","string_or_numeric"),indices:n};return X.T2.runKernel(K.O4G,r)}});const Oi=(0,q.op)({dropout_:function(t,e,n,r){const i=(0,j.YT)(t,"x","dropout");if(w.vA("float32"===i.dtype,(()=>"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(i.dtype," tensor instead."))),w.vA(e>=0&&e<1,(()=>"rate must be a float in the range [0, 1), but got ".concat(e,"."))),0===e)return t instanceof Z.qY?i.clone():i;const a=function(t,e){if(null==e)return t.shape.slice();if(w.r1(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)null==e[r]&&null!=t.shape[r]?n.push(t.shape[r]):n.push(e[r]);return n}return e}(i,n),o=1-e,s=(0,Ge.y)((0,sn.R)((0,Gt.W)(kr(a,0,1,"float32",r),o)),o);return(0,se.l)(i,s)}});function Ri(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function zi(t,e,n){const r=1-t%2,i=new Float32Array(t);for(let a=0;a<t;++a){const o=2*Math.PI*a/(t+r-1);i[a]=e-n*Math.cos(o)}return li(i,"float32")}const Bi=async function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const r=(0,j.YT)(t,"predictions","inTopK"),i=(0,j.YT)(e,"targets","inTopK");(0,w.vA)(r.rank>1,(()=>"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(r.rank))),(0,w.vA)(r.rank-1===i.rank,(()=>"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(r.rank," and targets rank ").concat(i.rank))),(0,w.O3)(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const a=r.shape[r.shape.length-1];(0,w.vA)(n>0&&n<=a,(()=>"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(a,"), but got ").concat(n)));const o=await r.data(),s=await i.data(),[c,u]=[o.length/a,a],l=(0,w.ce)("bool",c);for(let h=0;h<c;h++){const t=h*u,e=o.subarray(t,t+u),r=[];for(let n=0;n<e.length;n++)r.push({value:e[n],index:n});r.sort(((t,e)=>e.value-t.value)),l[h]=0;for(let i=0;i<n;i++)if(r[i].index===s[h]){l[h]=1;break}}return t!==r&&r.dispose(),e!==i&&i.dispose(),(0,ui.O)(l,i.shape,"bool")};var Li=n(57832),Pi=n(23458),ji=n(51294);function Ui(t,e,n){if(null==n||"linear"===n)return t;if("relu"===n)return(0,se.l)(t,(0,ai.P)(e));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function Wi(t,e){let n=e;const r=Y.getReductionAxes(t.shape,e.shape);return r.length>0&&(n=(0,si.c)(n,r)),(0,ie.t)(n,t.shape)}function Vi(t,e,n,r){if("linear"===e)return t;if("relu"===e)return(0,Er.V)(t);if("elu"===e)return(0,Ke.P)(t);if("relu6"===e)return(0,Tr.j)(t);if("prelu"===e)return(0,cr.N)(t,n);if("leakyrelu"===e)return(0,mn.H)(t,r);if("sigmoid"===e)return(0,ce.r)(t);throw new Error("Unknown fused activation ".concat(e,"."))}const qi=(t,e)=>!(t>0)||"linear"===e;const Gi=(0,q.op)({fusedConv2d_:function(t){let{x:e,filter:n,strides:r,pad:i,dataFormat:a="NHWC",dilations:o=[1,1],dimRoundingMode:s,bias:c,activation:u="linear",preluActivationWeights:l,leakyreluAlpha:h}=t;if(u=u||"linear",!1===qi(X.T2.state.gradientDepth,u)){w.vA("NHWC"===a,(()=>"Error in fused conv2d: got dataFormat of ".concat(a," but ")+"only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear."));let t=(0,Fe.X)(e,n,r,i,a,o,s);return null!=c&&(t=(0,Gt.W)(t,c)),Vi(t,u,l,h)}const d=(0,j.YT)(e,"x","conv2d","float32"),f=(0,j.YT)(n,"filter","conv2d","float32");let p=d,g=!1;3===d.rank&&(g=!0,p=(0,ie.t)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),w.vA(4===p.rank,(()=>"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(p.rank,"."))),w.vA(4===f.rank,(()=>"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(f.rank,"."))),re.s_("fused conv2d",i,s);const m="NHWC"===a?p.shape[3]:p.shape[1];w.vA(f.shape[2]===m,(()=>"Error in conv2d: depth of input (".concat(m,") must match ")+"input depth for filter ".concat(f.shape[2],"."))),w.vA(re.G0(r,o),(()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(o,"'")));const y=re.uf(p.shape,f.shape,r,o,i,s);let v,b;if(null!=c&&(v=(0,j.YT)(c,"bias","fused conv2d"),[v]=(0,gt.makeTypesMatch)(v,d),"NHWC"===a?Y.assertAndGetBroadcastShape(y.outShape,v.shape):(w.vA(v.shape.length<=1,(()=>"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of "+"rank-".concat(v.shape.length,"."))),w.vA(0===v.shape.length||v.shape[0]===y.outChannels||1===v.shape[0],(()=>"Error in fused conv2d: bias shape (".concat(v.shape,") is not ")+"compatible with the number of output channels "+"(".concat(y.outChannels,")"))))),null!=l){const t=l.shape;if(w.vA(t.length<=1||3===t.length,(()=>"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of "+"rank-".concat(t.length,"."))),1===t.length)w.vA(1===t[0]||t[0]===y.outChannels,(()=>"Error in fused conv2d: PReLU activation weights "+"(".concat(t,") is not compatible with the number of output ")+"channels (".concat(y.outChannels,").")));else if(3===t.length)try{Y.assertAndGetBroadcastShape(t,y.outShape)}catch(S){const e="Error in fused conv2d: PReLU activation weights (".concat(t,") ")+"is not compatible with the output shape of the conv2d "+"(".concat(y.outShape,").");throw Error(e)}b=(0,j.YT)(l,"prelu weights","fused conv2d")}const x=(t,e)=>{w.vA("NHWC"===a,(()=>"Error in gradient of fused conv2D: got dataFormat of ".concat(a," but only NHWC is currently supported.")));const[n,s,c,l]=e,h=Ui(t,c,u);w.vA(re.Dh(o),(()=>"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(o,"'")));const d=[(0,ji.v)(s.shape,h,n,r,i),(0,Pi.H)(s,h,n.shape,r,i)];if(null!=l){const t=Wi(l,h);d.push(t)}return d},k={x:p,filter:f,bias:v,preluActivationWeights:b},_={strides:r,pad:i,dataFormat:a,dilations:o,dimRoundingMode:s,activation:u,leakyreluAlpha:h};if(null==c){const t=(0,Li._X)(((t,e,n)=>{let r=X.T2.runKernel(K.aAr,k,_);return n([e,t,r]),g&&(r=(0,ie.t)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:x}}));return t(p,f)}{const t=(0,Li._X)(((t,e,n,r)=>{let i=X.T2.runKernel(K.aAr,k,_);return r([e,t,i,n]),g&&(i=(0,ie.t)(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:x}}));return t(p,f,v)}}});var Hi=n(85408),Yi=n(59068);const Xi=(0,q.op)({fusedDepthwiseConv2d_:function(t){let{x:e,filter:n,strides:r,pad:i,dataFormat:a="NHWC",dilations:o=[1,1],dimRoundingMode:s,bias:c,activation:u="linear",preluActivationWeights:l,leakyreluAlpha:h}=t;if(!1===qi(X.T2.state.gradientDepth,u)){let t=(0,We.G)(e,n,r,i,a,o,s);return null!=c&&(t=(0,Gt.W)(t,c)),Vi(t,u,l,h)}const d=(0,j.YT)(e,"x","depthwiseConv2d","float32"),f=(0,j.YT)(n,"filter","depthwiseConv2d","float32");let p=d,g=!1;3===d.rank&&(g=!0,p=(0,ie.t)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),w.vA(4===p.rank,(()=>"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(p.rank,"."))),w.vA(4===f.rank,(()=>"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(f.rank,"."))),w.vA(p.shape[3]===f.shape[2],(()=>"Error in fused depthwiseConv2d: number of input channels "+"(".concat(p.shape[3],") must match the inChannels dimension in ")+"filter ".concat(f.shape[2],"."))),null==o&&(o=[1,1]),w.vA(re.G0(r,o),(()=>"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(r," and dilations '").concat(o,"'"))),re.s_("fused depthwiseConv2d",i,s);const m=re.uf(p.shape,f.shape,r,o,i,s,!0);let y,v;null!=c&&(y=(0,j.YT)(c,"bias","fused conv2d"),[y]=(0,gt.makeTypesMatch)(y,d),Y.assertAndGetBroadcastShape(m.outShape,y.shape)),null!=l&&(v=(0,j.YT)(l,"prelu weights","fused depthwiseConv2d"));const b=(t,e)=>{w.vA(re.Dh(o),(()=>"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(o,"'")));const[n,a,c,l]=e,h=Ui(t,c,u),d=(0,Yi.l)(a.shape,h,n,r,i,o,s),f=(0,Hi.x)(a,h,n.shape,r,i,o,s);if(null!=l){return[d,f,Wi(y,h)]}return[d,f]},x={x:p,filter:f,bias:y,preluActivationWeights:v},k={strides:r,pad:i,dataFormat:a,dilations:o,dimRoundingMode:s,activation:u,leakyreluAlpha:h};if(null==c){const t=(0,Li._X)(((t,e,n)=>{let r=X.T2.runKernel(K.T7M,x,k);return n([e,t,r]),g&&(r=(0,ie.t)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:b}}));return t(p,f)}{const t=(0,Li._X)(((t,e,n,r)=>{let i=X.T2.runKernel(K.T7M,x,k);return r([e,t,i,n]),g&&(i=(0,ie.t)(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:b}}));return t(p,f,y)}}});const Ki=(0,q.op)({fusedMatMul_:function(t){let{a:e,b:n,transposeA:r=!1,transposeB:i=!1,bias:a,activation:o="linear",preluActivationWeights:s,leakyreluAlpha:c=.2}=t;if(!1===qi(X.T2.state.gradientDepth,o)){let t=(0,W.N)(e,n,r,i);return null!=a&&(t=(0,Gt.W)(t,a)),Vi(t,o,s,c)}let u=(0,j.YT)(e,"a","fused matMul"),l=(0,j.YT)(n,"b","fused matMul");[u,l]=(0,gt.makeTypesMatch)(u,l);const h=r?u.shape[u.rank-2]:u.shape[u.rank-1],d=i?l.shape[l.rank-1]:l.shape[l.rank-2],f=r?u.shape[u.rank-1]:u.shape[u.rank-2],p=i?l.shape[l.rank-2]:l.shape[l.rank-1],g=u.shape.slice(0,-2),m=l.shape.slice(0,-2),y=w.Ze(g),v=w.Ze(m);w.vA(h===d,(()=>"Error in fused matMul: inner shapes (".concat(h,") and (")+"".concat(d,") of Tensors with shapes ").concat(u.shape," and ")+"".concat(l.shape," and transposeA=").concat(r)+" and transposeB=".concat(i," must match.")));const b=Y.assertAndGetBroadcastShape(u.shape.slice(0,-2),l.shape.slice(0,-2)).concat([f,p]),x=r?(0,ie.t)(u,[y,h,f]):(0,ie.t)(u,[y,f,h]),k=i?(0,ie.t)(l,[v,p,d]):(0,ie.t)(l,[v,d,p]);let _,S;null!=a&&(_=(0,j.YT)(a,"bias","fused matMul"),[_]=(0,gt.makeTypesMatch)(_,u),Y.assertAndGetBroadcastShape(b,_.shape)),null!=s&&(S=(0,j.YT)(s,"prelu weights","fused matMul"));const A=(t,e)=>{const[n,s,c,u]=e,l=Ui((0,ie.t)(t,c.shape),c,o);let h,d;if(r||i?!r&&i?(h=(0,W.N)(l,s,!1,!1),d=(0,W.N)(l,n,!0,!1)):r&&!i?(h=(0,W.N)(s,l,!1,!0),d=(0,W.N)(n,l,!1,!1)):(h=(0,W.N)(s,l,!0,!0),d=(0,W.N)(l,n,!0,!0)):(h=(0,W.N)(l,s,!1,!0),d=(0,W.N)(n,l,!0,!1)),null!=a){return[h,d,Wi(u,l)]}return[h,d]},C={a:x,b:k,bias:_,preluActivationWeights:S},E={transposeA:r,transposeB:i,activation:o,leakyreluAlpha:c};if(null==a){const t=(0,Li._X)(((t,e,n)=>{const r=X.T2.runKernel(K.Dr,C,E);return n([t,e,r]),{value:(0,ie.t)(r,b),gradFunc:A}}));return t(x,k)}{const t=(0,Li._X)(((t,e,n,r)=>{const i=X.T2.runKernel(K.Dr,C,E);return r([t,e,i,n]),{value:(0,ie.t)(i,b),gradFunc:A}}));return t(x,k,_)}}});const $i=(0,q.op)({hammingWindow_:function(t){return zi(t,.54,.46)}});const Zi=(0,q.op)({hannWindow_:function(t){return zi(t,.5,.5)}});const Qi=(0,q.op)({frame_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=0;const o=[];for(;a+e<=t.size;)o.push((0,ue.d)(t,a,e)),a+=n;if(r)for(;a<t.size;){const r=a+e-t.size,s=(0,oe.x)([(0,ue.d)(t,a,e-r),(0,on.G)([r],i)]);o.push(s),a+=n}return 0===o.length?hi([],[0,e]):(0,ie.t)((0,oe.x)(o),[o.length,e])}});const Ji=(0,q.op)({stft_:function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Zi;null==r&&(r=Ri(e));const a=Qi(t,e,n),o=(0,se.l)(a,i(e));return(0,Jr.z)(o,r)}});const ta=(0,q.op)({cropAndResize_:function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=(0,j.YT)(t,"image","cropAndResize"),s=(0,j.YT)(e,"boxes","cropAndResize","float32"),c=(0,j.YT)(n,"boxInd","cropAndResize","int32"),u=s.shape[0];w.vA(4===o.rank,(()=>"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(o.rank,"."))),w.vA(2===s.rank&&4===s.shape[1],(()=>"Error in cropAndResize: boxes must be have size [".concat(u,",4] ")+"but had shape ".concat(s.shape,"."))),w.vA(1===c.rank&&c.shape[0]===u,(()=>"Error in cropAndResize: boxInd must be have size [".concat(u,"] ")+"but had shape ".concat(s.shape,"."))),w.vA(2===r.length,(()=>"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,"."))),w.vA(r[0]>=1&&r[1]>=1,(()=>"cropSize must be atleast [1,1], but was ".concat(r))),w.vA("bilinear"===i||"nearest"===i,(()=>"method must be bilinear or nearest, but was ".concat(i)));const l={image:o,boxes:s,boxInd:c},h={method:i,extrapolationValue:a,cropSize:r};return X.T2.runKernel(K.MRQ,l,h)}});const ea=(0,q.op)({flipLeftRight_:function(t){const e=(0,j.YT)(t,"image","flipLeftRight","float32");w.vA(4===e.rank,(()=>"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(e.rank,".")));const n={image:e};return X.T2.runKernel(K.BxF,n,{})}});const na=(0,q.op)({grayscaleToRGB_:function(t){const e=(0,j.YT)(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];w.vA(e.rank>=2,(()=>"Error in grayscaleToRGB: images must be at least rank 2, "+"but got rank ".concat(e.rank,"."))),w.vA(1===r,(()=>"Error in grayscaleToRGB: last dimension of a grayscale image "+"should be size 1, but got size ".concat(r,".")));const i=new Array(e.rank);return i.fill(1,0,n),i[n]=3,(0,rn.V)(e,i)}});const ra=(0,q.op)({rgbToGrayscale_:function(t){const e=(0,j.YT)(t,"image","RGBToGrayscale"),n=e.rank-1,r=e.shape[n];w.vA(e.rank>=2,(()=>"Error in RGBToGrayscale: images must be at least rank 2, "+"but got rank ".concat(e.rank,"."))),w.vA(3===r,(()=>"Error in RGBToGrayscale: last dimension of an RGB image "+"should be size 3, but got size ".concat(r,".")));const i=e.dtype,a=(0,U.w)(e,"float32"),o=li([.2989,.587,.114]);let s;switch(e.rank){case 2:s=Xe("ij,j->i",a,o);break;case 3:s=Xe("ijk,k->ij",a,o);break;case 4:s=Xe("ijkl,l->ijk",a,o);break;case 5:s=Xe("ijklm,m->ijkl",a,o);break;case 6:s=Xe("ijklmn,n->ijklm",a,o);break;default:throw new Error("Not a valid tensor rank.")}return s=(0,en.U)(s,-1),(0,U.w)(s,i)}});const ia=(0,q.op)({rotateWithOffset_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const i=(0,j.YT)(t,"image","rotateWithOffset","float32");w.vA(4===i.rank,(()=>"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(i.rank,".")));const a={image:i},o={radians:e,fillValue:n,center:r};return X.T2.runKernel(K.BK4,a,o)}});function aa(t,e,n,r,i,a){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY),null==a&&(a=0);const o=t.shape[0];return n=Math.min(n,o),w.vA(0<=r&&r<=1,(()=>"iouThreshold must be in [0, 1], but was '".concat(r,"'"))),w.vA(2===t.rank,(()=>"boxes must be a 2D tensor, but was of rank '".concat(t.rank,"'"))),w.vA(4===t.shape[1],(()=>"boxes must have 4 columns, but 2nd dimension was ".concat(t.shape[1]))),w.vA(1===e.rank,(()=>"scores must be a 1D tensor")),w.vA(e.shape[0]===o,(()=>"scores has incompatible shape with boxes. Expected ".concat(o,", ")+"but was ".concat(e.shape[0]))),w.vA(0<=a&&a<=1,(()=>"softNmsSigma must be in [0, 1], but was '".concat(a,"'"))),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a}}const oa=(0,q.op)({nonMaxSuppression_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const a=(0,j.YT)(t,"boxes","nonMaxSuppression","float32"),o=(0,j.YT)(e,"scores","nonMaxSuppression","float32"),s=aa(a,o,n,r,i);n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold;const c={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return X.T2.runKernel(K.SDM,{boxes:a,scores:o},c)}});function sa(t,e,n){const r=function(t,e,n){return function(t,e,n){let r=0,i=t.length,a=0,o=!1;for(;r<i;){a=r+(i-r>>>1);const s=n(e,t[a]);s>0?r=a+1:(i=a,o=!s)}return o?r:-r-1}(t,e,n||ca)}(t,e,n),i=r<0?-(r+1):r;t.splice(i,0,e)}function ca(t,e){return t>e?1:t<e?-1:0}function ua(t,e,n,r,i){return da(t,e,n,r,i,0)}function la(t,e,n,r,i,a){return da(t,e,n,r,i,0,!1,a,!0)}function ha(t,e,n,r,i,a){return da(t,e,n,r,i,a,!0)}function da(t,e,n,r,i,a){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];const u=[];for(let m=0;m<e.length;m++)e[m]>i&&u.push({score:e[m],boxIndex:m,suppressBeginIndex:0});u.sort(ga);const l=a>0?-.5/a:0,h=[],d=[];for(;h.length<n&&u.length>0;){const e=u.pop(),{score:n,boxIndex:a,suppressBeginIndex:o}=e;if(n<i)break;let s=!1;for(let c=h.length-1;c>=o;--c){const n=fa(t,a,h[c]);if(n>=r){s=!0;break}if(e.score=e.score*pa(r,l,n),e.score<=i)break}e.suppressBeginIndex=h.length,s||(e.score===n?(h.push(a),d.push(e.score)):e.score>i&&sa(u,e,ga))}const f=h.length,p=n-f;s&&p>0&&(h.push(...new Array(p).fill(0)),d.push(...new Array(p).fill(0)));const g={selectedIndices:h};return o&&(g.selectedScores=d),c&&(g.validOutputs=f),g}function fa(t,e,n){const r=t.subarray(4*e,4*e+4),i=t.subarray(4*n,4*n+4),a=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),c=Math.max(r[1],r[3]),u=Math.min(i[0],i[2]),l=Math.min(i[1],i[3]),h=Math.max(i[0],i[2]),d=Math.max(i[1],i[3]),f=(s-a)*(c-o),p=(h-u)*(d-l);if(f<=0||p<=0)return 0;const g=Math.max(a,u),m=Math.max(o,l),y=Math.min(s,h),v=Math.min(c,d),b=Math.max(y-g,0)*Math.max(v-m,0);return b/(f+p-b)}function pa(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function ga(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}const ma=async function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const a=(0,j.YT)(t,"boxes","nonMaxSuppressionAsync"),o=(0,j.YT)(e,"scores","nonMaxSuppressionAsync"),s=aa(a,o,n,r,i);n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold;const c=await Promise.all([a.data(),o.data()]),u=c[0],l=c[1],{selectedIndices:h}=ua(u,l,n,r,i);return a!==t&&a.dispose(),o!==e&&o.dispose(),li(h,"int32")};const ya=(0,q.op)({nonMaxSuppressionWithScore_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=(0,j.YT)(t,"boxes","nonMaxSuppression"),s=(0,j.YT)(e,"scores","nonMaxSuppression"),c=aa(o,s,n,r,i,a);n=c.maxOutputSize,r=c.iouThreshold,i=c.scoreThreshold,a=c.softNmsSigma;const u={boxes:o,scores:s},l={maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a},h=X.T2.runKernel(K.e0f,u,l);return{selectedIndices:h[0],selectedScores:h[1]}}});const va=async function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=(0,j.YT)(t,"boxes","nonMaxSuppressionAsync"),s=(0,j.YT)(e,"scores","nonMaxSuppressionAsync"),c=aa(o,s,n,r,i,a);n=c.maxOutputSize,r=c.iouThreshold,i=c.scoreThreshold,a=c.softNmsSigma;const u=await Promise.all([o.data(),s.data()]),l=u[0],h=u[1],{selectedIndices:d,selectedScores:f}=ha(l,h,n,r,i,a);return o!==t&&o.dispose(),s!==e&&s.dispose(),{selectedIndices:li(d,"int32"),selectedScores:li(f)}};const ba=(0,q.op)({nonMaxSuppressionPadded_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=(0,j.YT)(t,"boxes","nonMaxSuppression"),s=(0,j.YT)(e,"scores","nonMaxSuppression"),c=aa(o,s,n,r,i,null),u={boxes:o,scores:s},l={maxOutputSize:c.maxOutputSize,iouThreshold:c.iouThreshold,scoreThreshold:c.scoreThreshold,padToMaxOutputSize:a},h=X.T2.runKernel(K.Zl4,u,l);return{selectedIndices:h[0],validOutputs:h[1]}}});const xa=async function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=(0,j.YT)(t,"boxes","nonMaxSuppressionAsync"),s=(0,j.YT)(e,"scores","nonMaxSuppressionAsync"),c=aa(o,s,n,r,i,null),u=c.maxOutputSize,l=c.iouThreshold,h=c.scoreThreshold,[d,f]=await Promise.all([o.data(),s.data()]),{selectedIndices:p,validOutputs:g}=la(d,f,u,l,h,a);return o!==t&&o.dispose(),s!==e&&s.dispose(),{selectedIndices:li(p,"int32"),validOutputs:(0,zr.d)(g,"int32")}};var wa=n(20537),ka=n(80828);const _a=(0,q.op)({threshold_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const i=(0,j.YT)(t,"image","threshold"),a=i.shape[0]*i.shape[1];let o,s,c,u,l=(0,se.l)(li([r]),255);if(w.vA(3===i.rank,(()=>"Error in threshold: image must be rank 3,"+"but got rank ".concat(i.rank,"."))),w.vA(3===i.shape[2]||1===i.shape[2],(()=>"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(i.shape[2],"."))),w.vA("int32"===i.dtype||"float32"===i.dtype,(()=>"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(i.dtype,"."))),w.vA("otsu"===e||"binary"===e,(()=>"Method must be binary or otsu, but was ".concat(e))),3===i.shape[2]){[o,s,c]=(0,ti.l)(i,[1,1,1],-1);const t=(0,se.l)(o,.2989),e=(0,se.l)(s,.587),n=(0,se.l)(c,.114);u=(0,Gt.W)((0,Gt.W)(t,e),n)}else u=t;if("otsu"===e){l=function(t,e){let n,r,i,a,o,s,c=li([-1]),u=li([0]),l=li([0]);for(let h=0;h<t.size-1;h++){n=(0,ue.d)(t,0,h+1),r=(0,ue.d)(t,h+1),o=(0,Ge.y)((0,si.c)(n),e),s=(0,Ge.y)((0,si.c)(r),e);const d=(0,si.c)((0,se.l)(n,Sr(0,n.size)));i=(0,Ge.y)(d,(0,si.c)(n));const f=(0,on.G)(r.shape,n.size),p=(0,Gt.W)(Sr(0,r.size),f),g=(0,se.l)(r,p);a=(0,Ge.y)((0,si.c)(g),(0,si.c)(r));const m=(0,Yn.j)(i,a),y=(0,Yn.j)(i,a),v=(0,se.l)(o,s);l=(0,se.l)((0,se.l)(v,m),y);const b=(0,ln.r)(l,u);u=(0,_i._)(b,l,u),c=(0,_i._)(b,li([h]),c)}return c}(ye((0,U.w)((0,Or.L)(u),"int32"),(0,ui.O)([]),256),a)}const h=n?(0,vn.I)(u,l):(0,ln.r)(u,l);return(0,U.w)((0,se.l)(h,255),"int32")}});const Sa=(0,q.op)({transform_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5?arguments[5]:void 0;const o=(0,j.YT)(t,"image","transform","float32"),s=(0,j.YT)(e,"transforms","transform","float32");w.vA(4===o.rank,(()=>"Error in transform: image must be rank 4,"+"but got rank ".concat(o.rank,"."))),w.vA(2===s.rank&&(s.shape[0]===o.shape[0]||1===s.shape[0])&&8===s.shape[1],(()=>"Error in transform: Input transform should be batch x 8 or 1 x 8")),w.vA(null==a||2===a.length,(()=>"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(a,".")));const c={image:o,transforms:s},u={interpolation:n,fillMode:r,fillValue:i,outputShape:a};return X.T2.runKernel(K.dLy,c,u)}});const Aa=(0,q.op)({bandPart_:function(t,e,n){const r=(0,j.YT)(t,"a","bandPart");(0,w.vA)(r.rank>=2,(()=>"bandPart(): Rank must be at least 2, got ".concat(r.rank,".")));const i=r.shape,[a,o]=r.shape.slice(-2);let s,c;"number"===typeof e?((0,w.vA)(e%1===0,(()=>"bandPart(): numLower must be an integer, got ".concat(e,"."))),(0,w.vA)(e<=a,(()=>"bandPart(): numLower (".concat(e,")")+" must not be greater than the number of rows (".concat(a,")."))),s=(0,j.YT)(e<0?a:e,"numLower","bandPart")):((0,w.vA)("int32"===e.dtype,(()=>"bandPart(): numLower's dtype must be an int32.")),s=(0,_i._)((0,yn.M)(e,0),a,(0,Wn.B)(e,a))),"number"===typeof n?((0,w.vA)(n%1===0,(()=>"bandPart(): numUpper must be an integer, got ".concat(n,"."))),(0,w.vA)(n<=o,(()=>"bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(o,")."))),c=(0,j.YT)(n<0?o:n,"numUpper","bandPart")):((0,w.vA)("int32"===n.dtype,(()=>"bandPart(): numUpper's dtype must be an int32.")),c=(0,_i._)((0,yn.M)(n,0),o,(0,Wn.B)(n,o)));const u=(0,ie.t)(Sr(0,a,1,"int32"),[-1,1]),l=Sr(0,o,1,"int32"),h=(0,Yn.j)(u,l),d=(0,Cn.n)((0,vn.I)(h,s),(0,hn.D)(h,(0,Zn.H)(c))),f=(0,Ci.U)([a,o],r.dtype);return(0,ie.t)((0,ii.t)((0,xi.K)((0,ie.t)(r,[-1,a,o])).map((t=>(0,_i._)(d,t,f)))),i)}});const Ca=(0,q.op)({gramSchmidt_:function(t){let e;if(Array.isArray(t)){e=!1,(0,w.vA)(null!=t&&t.length>0,(()=>"Gram-Schmidt process: input must not be null, undefined, or empty"));const n=t[0].shape[0];for(let e=1;e<t.length;++e)(0,w.vA)(t[e].shape[0]===n,(()=>"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(t[e].shape[0]," vs. ").concat(n,")")))}else e=!0,t=(0,ti.l)(t,t.shape[0],0).map((t=>(0,ri.r)(t,[0])));(0,w.vA)(t.length<=t[0].shape[0],(()=>"Gram-Schmidt: Number of vectors (".concat(t.length,") exceeds ")+"number of dimensions (".concat(t[0].shape[0],").")));const n=[],r=t;for(let i=0;i<t.length;++i)n.push(X.T2.tidy((()=>{let t=r[i];if(i>0)for(let e=0;e<i;++e){const r=(0,se.l)((0,si.c)((0,se.l)(n[e],t)),n[e]);t=(0,Yn.j)(t,r)}return(0,Ge.y)(t,(0,Ni.x)(t,"euclidean"))})));return e?(0,ii.t)(n,0):n}});var Ea=n(23129);function Ta(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return X.T2.tidy((()=>{(0,w.vA)(2===t.shape.length,(()=>"qr2d() requires a 2D Tensor, but got a ".concat(t.shape.length,"D Tensor.")));const n=t.shape[0],r=t.shape[1];let i=an(n),a=(0,Se.o)(t);const o=hi([[1]],[1,1]);let s=(0,Se.o)(o);const c=n>=r?r:n;for(let t=0;t<c;++t){const e=a,c=s,u=i;[s,a,i]=X.T2.tidy((()=>{const e=(0,ue.d)(a,[t,t],[n-t,1]),c=(0,Ni.x)(e),u=(0,ue.d)(a,[t,t],[1,1]),l=(0,_i._)((0,ln.r)(u,0),hi([[-1]]),hi([[1]])),h=(0,Yn.j)(u,(0,se.l)(l,c)),d=(0,Ge.y)(e,h);s=1===d.shape[0]?(0,Se.o)(o):(0,oe.x)([o,(0,ue.d)(d,[1,0],[d.shape[0]-1,d.shape[1]])],0);const f=(0,Zn.H)((0,Ge.y)((0,W.N)(l,h),c)),p=(0,ue.d)(a,[t,0],[n-t,r]),g=(0,se.l)(f,s),m=(0,G.m)(s);if(0===t)a=(0,Yn.j)(p,(0,W.N)(g,(0,W.N)(m,p)));else{const e=(0,Yn.j)(p,(0,W.N)(g,(0,W.N)(m,p)));a=(0,oe.x)([(0,ue.d)(a,[0,0],[t,r]),e],0)}const y=(0,G.m)(g),v=(0,ue.d)(i,[0,t],[n,i.shape[1]-t]);if(0===t)i=(0,Yn.j)(v,(0,W.N)((0,W.N)(v,s),y));else{const e=(0,Yn.j)(v,(0,W.N)((0,W.N)(v,s),y));i=(0,oe.x)([(0,ue.d)(i,[0,0],[n,t]),e],1)}return[s,a,i]})),(0,Ea.AS)([e,c,u])}return!e&&n>r&&(i=(0,ue.d)(i,[0,0],[n,r]),a=(0,ue.d)(a,[0,0],[r,r])),[i,a]}))}const Na=(0,q.op)({qr_:function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((0,w.vA)(t.rank>=2,(()=>"qr() requires input tensor to have a rank >= 2, but got rank ".concat(t.rank))),2===t.rank)return Ta(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce(((t,e)=>t*e)),r=(0,xi.K)((0,ie.t)(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),i=[],a=[];r.forEach((t=>{const[n,r]=Ta(t,e);i.push(n),a.push(r)}));return[(0,ie.t)((0,ii.t)(i,0),t.shape),(0,ie.t)((0,ii.t)(a,0),t.shape)]}}});var Da;!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(Da||(Da={}));const Fa=(0,q.op)({computeWeightedLoss_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Da.SUM_BY_NONZERO_WEIGHTS;const r=(0,j.YT)(t,"losses","computeWeightedLoss");let i=null;null!=e&&(i=(0,j.YT)(e,"weights","computeWeightedLoss"));const a=null==i?r:(0,se.l)(r,i);if(n===Da.NONE)return a;if(n===Da.SUM)return(0,si.c)(a);if(n===Da.MEAN){if(null==i)return(0,Ln.i)(a);{const t=r.size/i.size,e=(0,Ge.y)((0,si.c)(a),(0,si.c)(i));return t>1?(0,Ge.y)(e,(0,zr.d)(t)):e}}if(n===Da.SUM_BY_NONZERO_WEIGHTS){if(null==i)return(0,Ge.y)((0,si.c)(a),(0,zr.d)(r.size));{const t=(0,se.l)(i,(0,Pn.S)(r.shape)),e=(0,U.w)((0,si.c)((0,Qn.E)(t,(0,zr.d)(0))),"float32");return(0,Ge.y)((0,si.c)(a),e)}}throw Error("Unknown reduction: ".concat(n))}});const Ia=(0,q.op)({absoluteDifference_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Da.SUM_BY_NONZERO_WEIGHTS;const i=(0,j.YT)(t,"labels","absoluteDifference"),a=(0,j.YT)(e,"predictions","absoluteDifference");let o=null;null!=n&&(o=(0,j.YT)(n,"weights","absoluteDifference")),(0,w.O3)(i.shape,a.shape,"Error in absoluteDifference: ");const s=(0,Wt.t)((0,Yn.j)(i,a));return Fa(s,o,r)}});const Ma=(0,q.op)({cosineDistance_:function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Da.SUM_BY_NONZERO_WEIGHTS;const a=(0,j.YT)(t,"labels","cosineDistance"),o=(0,j.YT)(e,"predictions","cosineDistance");let s=null;null!=r&&(s=(0,j.YT)(r,"weights","cosineDistance")),(0,w.O3)(a.shape,o.shape,"Error in cosineDistance: ");const c=(0,zr.d)(1),u=(0,Yn.j)(c,(0,si.c)((0,se.l)(a,o),n,!0));return Fa(u,s,i)}});const Oa=(0,q.op)({hingeLoss_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Da.SUM_BY_NONZERO_WEIGHTS,i=(0,j.YT)(t,"labels","hingeLoss");const a=(0,j.YT)(e,"predictions","hingeLoss");let o=null;null!=n&&(o=(0,j.YT)(n,"weights","hingeLoss")),(0,w.O3)(i.shape,a.shape,"Error in hingeLoss: ");const s=(0,zr.d)(1);i=(0,Yn.j)((0,se.l)((0,zr.d)(2),i),s);const c=(0,Er.V)((0,Yn.j)(s,(0,se.l)(i,a)));return Fa(c,o,r)}});const Ra=(0,q.op)({huberLoss_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Da.SUM_BY_NONZERO_WEIGHTS;const a=(0,j.YT)(t,"labels","huberLoss"),o=(0,j.YT)(e,"predictions","huberLoss");let s=null;null!=n&&(s=(0,j.YT)(n,"weights","huberLoss")),(0,w.O3)(a.shape,o.shape,"Error in huberLoss: ");const c=(0,zr.d)(r),u=(0,Wt.t)((0,Yn.j)(o,a)),l=(0,Wn.B)(u,c),h=(0,Yn.j)(u,l),d=(0,Gt.W)((0,se.l)((0,zr.d)(.5),(0,Hn.E)(l)),(0,se.l)(c,h));return Fa(d,s,i)}});const za=(0,q.op)({logLoss_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Da.SUM_BY_NONZERO_WEIGHTS;const a=(0,j.YT)(t,"labels","logLoss"),o=(0,j.YT)(e,"predictions","logLoss");let s=null;null!=n&&(s=(0,j.YT)(n,"weights","logLoss")),(0,w.O3)(a.shape,o.shape,"Error in logLoss: ");const c=(0,zr.d)(1),u=(0,zr.d)(r),l=(0,Zn.H)((0,se.l)(a,(0,wn.R)((0,Gt.W)(o,u)))),h=(0,se.l)((0,Yn.j)(c,a),(0,wn.R)((0,Gt.W)((0,Yn.j)(c,o),u))),d=(0,Yn.j)(l,h);return Fa(d,s,i)}});const Ba=(0,q.op)({meanSquaredError_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Da.SUM_BY_NONZERO_WEIGHTS;const i=(0,j.YT)(t,"labels","meanSquaredError"),a=(0,j.YT)(e,"predictions","meanSquaredError");let o=null;null!=n&&(o=(0,j.YT)(n,"weights","meanSquaredError")),(0,w.O3)(i.shape,a.shape,"Error in meanSquaredError: ");const s=(0,ni.P)(i,a);return Fa(s,o,r)}});const La=(0,q.op)({sigmoidCrossEntropy_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Da.SUM_BY_NONZERO_WEIGHTS,a=(0,j.YT)(t,"multiClassLabels","sigmoidCrossEntropy");const o=(0,j.YT)(e,"logits","sigmoidCrossEntropy");let s=null;if(null!=n&&(s=(0,j.YT)(n,"weights","sigmoidCrossEntropy")),(0,w.O3)(a.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){const t=(0,zr.d)(r),e=(0,zr.d)(1),n=(0,zr.d)(.5);a=(0,Gt.W)((0,se.l)(a,(0,Yn.j)(e,t)),(0,se.l)(n,t))}const c=function(t,e){const n=(0,j.YT)(t,"labels","sigmoidCrossEntropyWithLogits"),r=(0,j.YT)(e,"logits","sigmoidCrossEntropyWithLogits");(0,w.O3)(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const i=(0,Er.V)(r),a=(0,se.l)(r,n),o=(0,kn.K)((0,tn.o)((0,Zn.H)((0,Wt.t)(r))));return(0,Gt.W)((0,Yn.j)(i,a),o)}(a,o);return Fa(c,s,i)}});const Pa=(0,q.op)({softmaxCrossEntropy_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Da.SUM_BY_NONZERO_WEIGHTS,a=(0,j.YT)(t,"onehotLabels","softmaxCrossEntropy");const o=(0,j.YT)(e,"logits","softmaxCrossEntropy");let s=null;if(null!=n&&(s=(0,j.YT)(n,"weights","softmaxCrossEntropy")),(0,w.O3)(a.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){const t=(0,zr.d)(r),e=(0,zr.d)(1),n=(0,zr.d)(a.shape[1]);a=(0,Gt.W)((0,se.l)(a,(0,Yn.j)(e,t)),(0,Ge.y)(t,n))}const c=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(e.rank," ")+"and dim was ".concat(n));const r=(0,Li._X)(((t,e,r)=>{const i=(0,An.V)(e,[n],!0),a=(0,Yn.j)((0,U.w)(e,"float32"),i);r([t,a]);const o=(0,Zn.H)((0,se.l)(a,t));return{value:(0,si.c)(o,[n]),gradFunc:(t,e)=>{const[r,i]=e,a=(0,Gn.SM)(t.shape,[n]);return[(0,se.l)((0,ie.t)(t,a),(0,Yn.j)((0,U.w)(r,"float32"),(0,tn.o)(i))),(0,se.l)((0,ie.t)(t,a),(0,Yn.j)((0,tn.o)(i),(0,U.w)(r,"float32")))]}}}));return r(t,e)}(a,o);return Fa(c,s,i)}});const ja=(0,q.op)({sparseFillEmptyRows_:function(t,e,n,r){const i=(0,j.YT)(t,"indices","sparseFillEmptyRows","int32"),a=(0,j.YT)(e,"values","sparseFillEmptyRows"),o=(0,j.YT)(n,"denseShape","sparseFillEmptyRows","int32"),s=(0,j.YT)(r,"defaultValue","sparseFillEmptyRows",a.dtype);if(2!==i.rank)throw new Error("Indices should be Tensor2D but received shape\n        ".concat(i.shape));if(1!==a.rank)throw new Error("Values should be Tensor1D but received shape ".concat(a.shape));if(1!==o.rank)throw new Error("Dense shape should be Tensor1D but received shape ".concat(o.shape));if(0!==s.rank)throw new Error("Default value should be a scalar but received shape ".concat(s.shape));const c={indices:i,values:a,denseShape:o,defaultValue:s},u=X.T2.runKernel(K.C8s,c);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}});const Ua=(0,q.op)({sparseReshape_:function(t,e,n){const r=(0,j.YT)(t,"inputIndices","sparseReshape","int32"),i=(0,j.YT)(e,"inputShape","sparseReshape","int32"),a=(0,j.YT)(n,"newShape","sparseReshape","int32");if(2!==r.rank)throw new Error("Input indices should be Tensor2D but received shape\n        ".concat(r.shape));if(1!==i.rank)throw new Error("Input shape should be Tensor1D but received shape ".concat(i.shape));if(1!==a.rank)throw new Error("New shape should be Tensor1D but received shape ".concat(a.shape));const o={inputIndices:r,inputShape:i,newShape:a},s=X.T2.runKernel(K.BoJ,o);return{outputIndices:s[0],outputShape:s[1]}}});const Wa=(0,q.op)({sparseSegmentMean_:function(t,e,n){const r=(0,j.YT)(t,"data","sparseSegmentMean"),i=(0,j.YT)(e,"indices","sparseSegmentMean","int32"),a=(0,j.YT)(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.rank)throw new Error("Indices should be Tensor1D but received shape\n          ".concat(i.shape));if(1!==a.rank)throw new Error("Segment ids should be Tensor1D but received shape\n          ".concat(a.shape));const o={data:r,indices:i,segmentIds:a};return X.T2.runKernel(K.L6G,o)}});const Va=(0,q.op)({sparseSegmentSum_:function(t,e,n){const r=(0,j.YT)(t,"data","sparseSegmentSum"),i=(0,j.YT)(e,"indices","sparseSegmentSum","int32"),a=(0,j.YT)(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.rank)throw new Error("Indices should be Tensor1D but received shape\n         ".concat(i.shape));if(1!==a.rank)throw new Error("Segment ids should be Tensor1D but received shape\n         ".concat(a.shape));const o={data:r,indices:i,segmentIds:a};return X.T2.runKernel(K.DvZ,o)}});const qa=(0,q.op)({stringNGrams_:function(t,e,n,r,i,a,o,s){const c=(0,j.YT)(t,"data","stringNGrams","string");if("string"!==c.dtype)throw new Error("Data must be of datatype string");if(1!==c.shape.length)throw new Error("Data must be a vector, saw: ".concat(c.shape));const u=(0,j.YT)(e,"dataSplits","stringNGrams");if("int32"!==u.dtype)throw new Error("Data splits must be of datatype int32");const l={separator:n,nGramWidths:r,leftPad:i,rightPad:a,padWidth:o,preserveShortSequences:s},h={data:c,dataSplits:u},d=X.T2.runKernel(K.YAb,h,l);return{nGrams:d[0],nGramsSplits:d[1]}}});const Ga=(0,q.op)({stringSplit_:function(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=(0,j.YT)(t,"input","stringSplit","string"),i=(0,j.YT)(e,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error("Input should be Tensor1D but received shape ".concat(r.shape));if(0!==i.rank)throw new Error("Delimiter should be a scalar but received shape ".concat(i.shape));const a={skipEmpty:n},o={input:r,delimiter:i},s=X.T2.runKernel(K.iW0,o,a);return{indices:s[0],values:s[1],shape:s[2]}}});const Ha=(0,q.op)({stringToHashBucketFast_:function(t,e){const n=(0,j.YT)(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const i={input:n};return X.T2.runKernel(K.$jE,i,r)}});const Ya=(0,q.op)({staticRegexReplace_:function(t,e,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=(0,j.YT)(t,"input","staticRegexReplace","string"),a={pattern:e,rewrite:n,replaceGlobal:r};return X.T2.runKernel(K.GZp,{x:i},a)}}),Xa={fft:$r.h,ifft:Zr.K,rfft:Jr.z,irfft:Qr.g},Ka={hammingWindow:$i,hannWindow:Zi,frame:Qi,stft:Ji},$a={flipLeftRight:ea,grayscaleToRGB:na,resizeNearestNeighbor:ka.b,resizeBilinear:wa.v,rgbToGrayscale:ra,rotateWithOffset:ia,cropAndResize:ta,nonMaxSuppression:oa,nonMaxSuppressionAsync:ma,nonMaxSuppressionWithScore:ya,nonMaxSuppressionWithScoreAsync:va,nonMaxSuppressionPadded:ba,nonMaxSuppressionPaddedAsync:xa,threshold:_a,transform:Sa},Za={bandPart:Aa,gramSchmidt:Ca,qr:Na},Qa={absoluteDifference:Ia,computeWeightedLoss:Fa,cosineDistance:Ma,hingeLoss:Oa,huberLoss:Ra,logLoss:za,meanSquaredError:Ba,sigmoidCrossEntropy:La,softmaxCrossEntropy:Pa},Ja={sparseFillEmptyRows:ja,sparseReshape:Ua,sparseSegmentMean:Wa,sparseSegmentSum:Va},to={stringNGrams:qa,stringSplit:Ga,stringToHashBucketFast:Ha,staticRegexReplace:Ya},eo=jt,no="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:t=>t();function ro(){return new Promise((t=>no((()=>t()))))}function io(t,e){const n=t[0].length;t.forEach(((t,e)=>{w.vA(t.length===n,(()=>"Error in concat".concat(n,"D: rank of tensors[").concat(e,"] must be the same ")+"as the rank of the rest (".concat(n,")")))})),w.vA(e>=0&&e<n,(()=>"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")));const r=t[0];t.forEach(((t,i)=>{for(let a=0;a<n;a++)w.vA(a===e||t[a]===r[a],(()=>"Error in concat".concat(n,"D: Shape of tensors[").concat(i,"] (").concat(t,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(i,".")))}))}function ao(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}var oo;function so(t,e,n){let r=new Array;if(null==n&&null==e)return r;if(null==e)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(null==n)return r;if(t+n.length!==r.length)throw new Error("rt input.shape and shape=".concat(e," are incompatible: rt input.rank = ").concat(t+n.length,", but shape.rank = ").concat(r.length));for(let i=1;i<n.length;++i){const a=n[i],o=r[r.length-n.length+i],s=r[o];if(a>=0)if(s>=0){if(s!==a)throw new Error("rt input.shape and shape=".concat(e," are incompatible: rt input.shape[").concat(i+t,"] = ").concat(a," but shape[").concat(i+t,"] = ").concat(s))}else r[o]=a}return r}function co(t){const e={FIRST_DIM_SIZE:oo.FIRST_DIM_SIZE,VALUE_ROWIDS:oo.VALUE_ROWIDS,ROW_LENGTHS:oo.ROW_LENGTHS,ROW_SPLITS:oo.ROW_SPLITS,ROW_LIMITS:oo.ROW_LIMITS,ROW_STARTS:oo.ROW_STARTS},n=[];for(const r of t){if(!(r in e))break;n.push(e[r])}return n}function uo(t){return 0===t.length?0:t[0]===oo.FIRST_DIM_SIZE?t.length-1:t.length}function lo(t,e){if(null==t||null==e)return;const n=t.length,r=e.length;if(n>=r)throw new Error("defaultValue.shape=".concat(t," and ragged tensor flatValues.shape=").concat(e,", are incompatible: defaultValue.rank = ").concat(n," must be less than ragged tensor input flatValues.rank = ").concat(r,")"));for(let i=0;i<Math.min(n,r-1);++i){const n=t[i],r=e[i+1];if(n>=0&&r>=0&&1!==n&&n!==r)throw new Error("defaultValue.shape=".concat(t,", and ragged tensor input flatValues.shape=").concat(e," are incompatible: defaultValue.shape[").concat(i-t.length,"] = ").concat(n," but ragged tensor input.flatValues.shape[").concat(i-t.length,"] = ").concat(r))}}!function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"}(oo||(oo={}));const ho=30;function fo(t){return t<=ho?t:(0,w.lK)(t,Math.floor(Math.sqrt(t)))}function po(t,e,n){return[n*("number"===typeof t?t:t[0]),e*("number"===typeof t?t:t[1])]}function go(t,e,n){let r=[];if(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])r=r.concat(e.slice(0)),r.push(t[0]/n),r=r.concat(t.slice(1));else{r=r.concat(t[0]);const n=e.length;for(let i=0;i<n;++i)r=r.concat([t[i+1]/e[i],e[i]]);r=r.concat(t.slice(n+1))}return r}function mo(t,e){const n=[];if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]){n.push(e);for(let r=e+1;r<t;++r)r<=2*e?(n.push(r),n.push(r-(e+1))):n.push(r)}else{const r=[],i=[];for(let n=1;n<t;++n)n>=2*e+1||n%2===1?i.push(n):r.push(n);n.push(...r),n.push(0),n.push(...i)}return n}function yo(t,e,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=[];r?i.push(t[0]/n):i.push(t[0]*n);for(let a=1;a<t.length;++a)a<=e.length?r?i.push(e[a-1]*t[a]):i.push(t[a]/e[a-1]):i.push(t[a]);return i}function vo(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function bo(t,e,n){const r=t.slice(0,1);for(let i=0;i<n;++i)r.push(t[i+1]-e[i][0]-e[i][1]);return r}var xo=n(84102);const wo=.3275911,ko=.254829592,_o=-.284496736,So=1.421413741,Ao=-1.453152027,Co=1.061405429;var Eo=n(94851);function To(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(t.length,", imag: ").concat(e.length,"."));const n=new Float32Array(2*t.length);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function No(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function Do(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let i=0;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}function Fo(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let i=2;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}function Io(t,e){return{real:t[2*e],imag:t[2*e+1]}}function Mo(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function Oo(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let i=0;i<Math.ceil(t/2);i++){const a=(e?2:-2)*Math.PI*(i/t);n[i]=Math.cos(a),r[i]=Math.sin(a)}return{real:n,imag:r}}function Ro(t,e,n){const r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}const zo="->",Bo=/->/g,Lo=",",Po="...";function jo(t,e){const n=((t=t.replace(/\s/g,"")).length-t.replace(Bo,"").length)/zo.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat(zo,'").'));const[r,i]=t.split(zo);(0,w.vA)(-1===r.indexOf(Po),(()=>'The ellipsis notation ("'.concat(Po,'") is not supported yet.')));const a=r.split(Lo),o=a.length;if(e!==o)throw new Error("Expected ".concat(o," input tensors, received ").concat(e));if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const s=[];for(let h=0;h<i.length;++h){const t=i[h];if(!a.some((e=>-1!==e.indexOf(t))))throw new Error("Output subscripts contain the label ".concat(t," ")+"not present in the input subscripts.");-1===s.indexOf(t)&&s.push(t)}for(let h=0;h<r.length;++h){const t=r[h];-1===s.indexOf(t)&&t!==Lo&&s.push(t)}const c=new Array(a.length);for(let h=0;h<o;++h){if(new Set(a[h].split("")).size!==a[h].length)throw new Error("Found duplicate axes in input component ".concat(a[h],". ")+"Support for duplicate axes in input is not implemented yet.");c[h]=[];for(let t=0;t<a[h].length;++t)c[h].push(s.indexOf(a[h][t]))}const u=s.length,l=[];for(let h=i.length;h<u;++h)l.push(h);return{allDims:s,summedDims:l,idDims:c}}function Uo(t,e){let n=new Array(t);n.fill(-1);for(let i=0;i<e.length;++i)n[e[i]]=i;const r=[];for(let i=0;i<t;++i)-1===n[i]&&r.push(i);return n=n.filter((t=>-1!==t)),{permutationIndices:n,expandDims:r}}function Wo(t,e,n){const r=new Array(t);for(let i=0;i<n.length;++i){const t=n[i].shape;for(let n=0;n<e[i].length;++n)void 0===r[e[i][n]]?r[e[i][n]]=t[n]:(0,w.vA)(r[e[i][n]]===t[n],(()=>"Expected dimension ".concat(r[e[i][n]]," at axis ").concat(n," ")+"of input shaped ".concat(JSON.stringify(t),", ")+"but got dimension ".concat(t[n])))}}function Vo(t,e){const n=t,r=[];let i=0;0===t.length&&n.push(-1),i=t.length+1;for(let o=0;o<i;++o)r.push([]);const a=[];for(let o=0;o<n.length;++o){const t=Go(e,n[o]);for(const e of t)-1===a.indexOf(e)&&(r[o].push(e),a.push(e))}return{path:n,steps:r}}function qo(t){return t.every(((t,e)=>t===e))}function Go(t,e){const n=[];for(let r=0;r<t.length;++r)0!==t[r].length&&-1===t[r].indexOf(e)&&-1!==e||n.push(r);return n}function Ho(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof e)(0,w.vA)(t.shape[n]%e===0,(()=>"Number of splits must evenly divide the axis.")),r=new Array(e).fill(t.shape[n]/e);else{const i=e.reduce(((t,e)=>(-1===e&&(t+=1),t)),0);(0,w.vA)(i<=1,(()=>"There should be only one negative value in split array."));const a=e.indexOf(-1);if(-1!==a){const r=e.reduce(((t,e)=>e>0?t+e:t));e[a]=t.shape[n]-r}(0,w.vA)(t.shape[n]===e.reduce(((t,e)=>t+e)),(()=>"The sum of sizes must match the size of the axis dimension.")),r=e}return r}function Yo(t){return"Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(t)}function Xo(t,e){return"indices(".concat(t,", 0) is invalid: ").concat(e," < 0")}function Ko(t,e,n){return"indices(".concat(t,", 0) is invalid: ").concat(e," >= ").concat(n)}function $o(t,e){return"only one output dimension may be -1, not both ".concat(t," and ").concat(e)}function Zo(t,e){return"size ".concat(t," must be non-negative, not ").concat(e)}function Qo(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function Jo(t,e){const n=(0,w.Ze)(t),r=(0,w.Ze)(e);return"Input to reshape is a SparseTensor with ".concat(n,"\n  dense values, but the requested shape requires a multiple of ").concat(r,". inputShape=").concat(t," outputShape= ").concat(e)}function ts(t,e){const n=(0,w.Ze)(t),r=(0,w.Ze)(e);return"Input to reshape is a tensor with ".concat(n," dense values, but the requested shape has ").concat(r,". inputShape=").concat(t," outputShape=").concat(e)}function es(){return"segment ids must be >= 0"}function ns(){return"segment ids are not increasing"}function rs(t,e){return"Segment id ".concat(t," out of range [0, ").concat(e,"), possibly because segmentIds input is not sorted.")}function is(t,e,n){return"Bad: indices[".concat(t,"] == ").concat(e," out of range [0, ").concat(n,")")}function as(t,e){let n,r=!1;for(t<=ho?(n=t,r=!0):n=(0,w.lK)(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=(0,w.lK)(t,n+1);return n}function os(t,e,n){const r=[],i=t.length;for(let a=0;a<i;a++)a!==e?r.push(t[a]):r.push(n);return r}function ss(t,e,n,r){const i=e.shape.length,a=t.shape.length;if(0!==r&&(r<-i||r>i))throw new Error("Expect batchDims in the range of [-".concat(i,", ").concat(i,"], but got ").concat(r));if(r<0&&(r+=i),r>a)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(a,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(let h=0;h<r;++h)if(t.shape[h]!==e.shape[h])throw new Error("x.shape[".concat(h,"]: ").concat(t.shape[h]," should be equal to indices.shape[").concat(h,"]: ").concat(e.shape[h],"."));const o=t.shape[n],s=[];let c=1,u=1,l=1;for(let h=0;h<r;++h)s.push(t.shape[h]),c*=t.shape[h];for(let h=r;h<n;h++)s.push(t.shape[h]),u*=t.shape[h];for(let h=r;h<i;h++)s.push(e.shape[h]);for(let h=n+1;h<a;h++)s.push(t.shape[h]),l*=t.shape[h];return{batchSize:c,sliceSize:l,outerSize:u,dimSize:o,outputShape:s}}function cs(t){try{return t.map((t=>(0,mt.decodeString)(t)))}catch(e){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(e))}}function us(t){return t.map((t=>(0,mt.encodeString)(t)))}var ls=n(80106),hs=n(68099)},5965:(t,e,n)=>{"use strict";var r=n(37484),i=(n(41130),n(89e3)),a=n(59624),o=n(53259),s=n(69897),c=n(84634);class u{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,e){return fetch(t,e)}now(){return performance.now()}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got ".concat(e));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,e){return new TextDecoder(e).decode(t)}setTimeoutCustom(t,e){"undefined"!==typeof window&&(0,i._K)().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(t),setTimeout((()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")}),e),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",(t=>{if(t.source===window&&t.data.name===this.messageName){t.stopPropagation();(0,this.functionRefs[t.data.index])(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}}),!0))):setTimeout(t,e)}isTypedArray(t){return(0,c.Y)(t)}}if((0,i._K)().get("IS_BROWSER")){(0,i._K)().setPlatform("browser",new u);try{s.dy.registerManager(o.ZT.URL_SCHEME,new o.Cd)}catch(b){}try{s.dy.registerManager(a.mn.URL_SCHEME,new a.lQ)}catch(b){}}const l=()=>n(85817);let h;class d{constructor(){this.util=n(18590),this.textEncoder=new this.util.TextEncoder}fetch(t,e){return null!=(0,i._K)().global.fetch?(0,i._K)().global.fetch(t,e):(null==h&&(h=l()),h(t,e))}now(){const t=process.hrtime();return 1e3*t[0]+t[1]/1e6}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(e));return this.textEncoder.encode(t)}decode(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)}isTypedArray(t){return this.util.types.isFloat32Array(t)||this.util.types.isInt32Array(t)||this.util.types.isUint8Array(t)||this.util.types.isUint8ClampedArray(t)}}(0,i._K)().get("IS_NODE")&&!(0,i._K)().get("IS_BROWSER")&&(0,i._K)().setPlatform("node",new d);var f=n(80186),p=n(69779),g=n(62503),m=n(30629),y=n(90739);(0,r.Ye)();const v={buffer:f.r,cast:p.w,clone:g.o,print:m.y};(0,y.Q5)(v)},80106:(t,e,n)=>{"use strict";let r;function i(t){r=t}function a(t){if(void 0!==r)return r;if(t||"undefined"!==typeof navigator&&null!=navigator){if(t||(t=navigator),"ReactNative"===t.product)return!0;const e=t.userAgent||t.vendor||("undefined"!==typeof window?window.opera:"");if(!e){const e=t;return e.userAgentData&&e.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function o(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}n.r(e),n.d(e,{isBrowser:()=>o,isMobile:()=>a,mockIsMobile:()=>i})},37484:(t,e,n)=>{"use strict";n.d(e,{T2:()=>x,Ye:()=>b});var r=n(68099),i=n(89e3),a=n(86177),o=n(87311),s=n(46780),c=n(94851),u=n(73837),l=n(23869);class h{constructor(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new f)}profileKernel(t,e,n){let r;const a=()=>{r=n()};let o;const s=u.now();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(a);else{a();for(const t of r)t.dataSync();o=Promise.resolve({kernelMs:u.now()-s})}if((0,i._K)().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let i=0;i<r.length;i++){const e=r[i];e.data().then((n=>{d(n,e.dtype,t)}))}return{kernelName:t,outputs:r,inputs:e,timeMs:o.then((t=>t.kernelMs)),extraInfo:o.then((t=>null!=t.getExtraProfileInfo?t.getExtraProfileInfo():""))}}logKernelProfile(t){const{kernelName:e,outputs:n,timeMs:r,inputs:i,extraInfo:a}=t;n.forEach((t=>{Promise.all([t.data(),r,a]).then((n=>{this.logger.logKernelProfile(e,t,n[0],n[1],i,n[2])}))}))}}function d(t,e,n){if("float32"!==e)return!1;for(let r=0;r<t.length;r++){const e=t[r];if(isNaN(e)||!isFinite(e))return console.warn("Found ".concat(e," in the result of '").concat(n,"'")),!0}return!1}class f{logKernelProfile(t,e,n,r,i,a){const o="number"===typeof r?l.av("".concat(r,"ms"),9):r.error,s=l.av(t,25),c=e.rank,u=e.size,h=l.av(e.shape.toString(),14);let d="";for(const l in i){const t=i[l];if(null!=t){const n=t.shape||e.shape,r=n.length;d+="".concat(l,": ").concat(r,"D ").concat(r>0?n:""," ")}}console.log("%c".concat(s,"\t%c").concat(o,"\t%c").concat(c,"D ").concat(h,"\t%c").concat(u,"\t%c").concat(d,"\t%c").concat(a),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}var p=n(90739),g=n(48683);function m(t){return null!=t.kernelName}class y{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((t=>t.name))))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class v{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new y}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then((()=>{}));if(null!=this.backendInstance)return;const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e];if(await this.initializeBackend(n).success)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){const{name:t,asyncInit:e}=this.initializeBackendsAndReturnBest();if(e)throw new Error("The highest priority backend '".concat(t,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;{const{asyncInit:e}=this.initializeBackend(t);if(e)return null}}return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t in this.registryFactory?(c.i("".concat(t," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)}async setBackend(t){if(null==this.registryFactory[t])throw new Error("Backend name '".concat(t,"' not found in registry"));if(this.backendName=t,null==this.registry[t]){this.backendInstance=null;const{success:e,asyncInit:n}=this.initializeBackend(t);if(!(n?await e:e))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new h(this.backendInstance),!0}setupRegisteredKernels(){(0,s.Op)(this.backendName).forEach((t=>{null!=t.setupFunc&&t.setupFunc(this.backendInstance)}))}disposeRegisteredKernels(t){(0,s.Op)(t).forEach((e=>{null!=e.disposeFunc&&e.disposeFunc(this.registry[t])}))}initializeBackend(t){const e=this.registryFactory[t];if(null==e)throw new Error("Cannot initialize backend ".concat(t,", no registration found."));try{const n=e.factory();if(!n||n instanceof r.uI||"function"!==typeof n.then)return this.registry[t]=n,{success:!0,asyncInit:!1};{const e=++this.pendingBackendInitId,r=n.then((n=>!(e<this.pendingBackendInitId)&&(this.registry[t]=n,this.pendingBackendInit=null,!0))).catch((n=>(e<this.pendingBackendInitId||(this.pendingBackendInit=null,c.i("Initialization of backend ".concat(t," failed")),c.i(n.stack||n.message)),!1)));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}}catch(n){return c.i("Initialization of backend ".concat(t," failed")),c.i(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error("".concat(t," backend not found in registry"));this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(((t,e)=>this.registryFactory[e].priority-this.registryFactory[t].priority))}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e],{success:r,asyncInit:i}=this.initializeBackend(n);if(i||r)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,e){const n=this.state.tensorInfo.get(e),r=n.backend,i=this.readSync(e),a=r.refCount(e);r.disposeData(e,!0),n.backend=t,t.move(e,i,n.shape,n.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,e){let n,r=null;if(null==e){if("function"!==typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!==typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=t}return this.scopedRun((()=>this.startScope(r)),(()=>this.endScope(n)),(()=>(n=e(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n)))}scopedRun(t,e,n){t();try{const t=n();return e(),t}catch(r){throw e(),r}}nextTensorId(){return v.nextTensorId++}nextVariableId(){return v.nextVariableId++}clone(t){const e=x.runKernel(o.lzr,{x:t}),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],(t=>({x:()=>{const e={x:t},n={dtype:"float32"};return x.runKernel(o.KXH,e,n)}})),[],{}),e}runKernel(t,e,n){null==this.backendName&&this.backend;if(!(null!=(0,s._5)(t,this.backendName)))throw new Error("Kernel '".concat(t,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:t,inputs:e,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,e,n){const r=this.backend.numDataIds();let i=0;n.forEach((t=>{i+="complex64"===t.dtype?3:1}));const a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-e-i-a;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(o," data ids) after running '").concat(t,"'"))}runKernelFunc(t){let e,n=[];const r=this.isTapeOn(),i=this.state.numBytes,a=this.state.numTensors;let o,c;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;const u=m(t)?t.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(m(t)){const{kernelName:e,inputs:i,attrs:a}=t;null==this.backendName&&this.backend;const u=(0,s._5)(e,this.backendName);l.vA(null!=u,(()=>"Cannot find registered kernel '".concat(e,"' for backend '").concat(this.backendName,"'"))),o=()=>{const t=this.backend.numDataIds();c=u.kernelFunc({inputs:i,attrs:a,backend:this.backend});const o=Array.isArray(c)?c:[c];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(e,t,o);const s=o.map((t=>null!=t.rank?t:this.makeTensorFromTensorInfo(t)));if(r){const t=this.getTensorsForGradient(e,i,s);n=this.saveTensorsForBackwardMode(t)}return s}}else{const{forwardFunc:e}=t,i=t=>{r&&(n=t.map((t=>this.keep(this.clone(t)))))};o=()=>{const t=this.backend.numDataIds();c=this.tidy((()=>e(this.backend,i)));const n=Array.isArray(c)?c:[c];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,t,n),n}}const{inputs:h,attrs:d}=t,f=m(t)?null:t.backwardsFunc;let p;return this.scopedRun((()=>this.state.kernelDepth++),(()=>this.state.kernelDepth--),(()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(p=this.profiler.profileKernel(u,h,(()=>o())),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(p),e=p.outputs):e=o()})),r&&this.addTapeNode(u,h,e,f,n,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(h).map((t=>null!=h[t]?h[t].shape:null)),outputShapes:e.map((t=>t.shape)),kernelTimeMs:p.timeMs,extraInfo:p.extraInfo}),Array.isArray(c)?e:e[0]}saveTensorsForBackwardMode(t){const e=t.map((t=>this.keep(this.clone(t))));return e}getTensorsForGradient(t,e,n){const r=(0,s.vQ)(t);if(null!=r){const t=r.inputsToSave||[],i=r.outputsToSave||[];let a;r.saveAllInputs?(l.vA(Array.isArray(e),(()=>"saveAllInputs is true, expected inputs to be an array.")),a=Object.keys(e).map((t=>e[t]))):a=t.map((t=>e[t]));const o=n.filter(((t,e)=>i[e]));return a.concat(o)}return[]}makeTensor(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let i=t;"string"===n&&l.Kg(t[0])&&(i=t.map((t=>u.encodeString(t))));const a=r.write(i,e,n),o=new p.qY(e,n,a,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){const t=this.state.tensorInfo.get(a),e=(0,l.SL)(i);this.state.numBytes+=e-t.bytes,t.bytes=e}return o}makeTensorFromDataId(t,e,n,r){const i={dataId:t,shape:e,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(t,e){const{dataId:n,shape:r,dtype:i}=t,a=new p.qY(r,i,n,this.nextTensorId());return this.trackTensor(a,e),a}makeVariable(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.cast(r));const i=new p.rT(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw new Error("Variable with name ".concat(i.name," was already registered"));return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(t,e){this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(n=t.size*l.jv(t.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:n})),t instanceof p.rT||this.track(t)}incRef(t,e){this.trackTensor(t,e),this.backend.incRef(t.dataId)}removeDataId(t,e){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===e&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;const e=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,"string"===t.dtype&&(this.state.numStringTensors--,this.state.numBytes-=e.bytes),"complex64"!==t.dtype&&"string"!==t.dtype){const e=t.size*l.jv(t.dtype);this.state.numBytes-=e}e.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,e.backend)}disposeVariables(){for(const t in this.state.registeredVariables){const e=this.state.registeredVariables[t];this.disposeVariable(e)}}disposeVariable(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const e=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map((t=>t.totalBytesSnapshot))),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(t,e,n,r,i,a){const o={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:i},c=(0,s.vQ)(t);null!=c&&(r=c.gradFunc),null!=r&&(o.gradient=t=>(t=t.map(((t,e)=>{if(null==t){const t=n[e],r=l.Ty(t.size,t.dtype);return this.makeTensor(r,t.shape,t.dtype)}return t})),r(t.length>1?t:t[0],i,a))),this.state.activeTape.push(o)}keep(t){return t.kept=!0,t}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e}endScope(t){const e=(0,g.getTensorsInContainer)(t),n=new Set(e.map((t=>t.id)));for(let i=0;i<this.state.activeScope.track.length;i++){const t=this.state.activeScope.track[i];t.kept||n.has(t.id)||t.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],e.forEach((t=>{t.kept||t.scopeId!==r.id||this.track(t)}))}gradients(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(l.vA(e.length>0,(()=>"gradients() received an empty list of xs.")),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));const i=this.scopedRun((()=>this.startTape()),(()=>this.endTape()),(()=>this.tidy("forward",t)));l.vA(i instanceof p.qY,(()=>"The result y returned by f() must be a tensor."));const a=function(t,e,n){const r={},i={};for(let c=0;c<e.length;c++)r[e[c].id]=!0;for(let c=0;c<t.length;c++){const n=t[c],a=n.inputs;for(const t in a){const o=a[t];let s=!1;for(let t=0;t<e.length;t++)if(r[o.id]){n.outputs.forEach((t=>r[t.id]=!0)),s=!0,i[n.id]=!0;break}if(s)break}}const a={};a[n.id]=!0;const o={};for(let c=t.length-1;c>=0;c--){const e=t[c],n=e.inputs;for(let t=0;t<e.outputs.length;t++)if(a[e.outputs[t].id]){for(const t in n)a[n[t].id]=!0,o[e.id]=!0;break}}const s=[];for(let c=0;c<t.length;c++){const e=t[c];if(i[e.id]&&o[e.id]){const t={};for(const i in e.inputs){const n=e.inputs[i];r[n.id]&&(t[i]=n)}const n=Object.assign({},e);n.inputs=t,n.outputs=e.outputs,s.push(n)}}return s}(this.state.activeTape,e,i);if(!r&&0===a.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(()=>{const t={};t[i.id]=null==n?function(t){const e=(0,l.FZ)((0,l.Ze)(t),"float32");return x.makeTensor(e,t,"float32")}(i.shape):n,function(t,e,n,r){for(let i=e.length-1;i>=0;i--){const a=e[i],o=[];if(a.outputs.forEach((e=>{const n=t[e.id];null!=n?o.push(n):o.push(null)})),null==a.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(a.kernelName,"."));const s=a.gradient(o);for(const e in a.inputs){if(!(e in s))throw new Error("Cannot backprop through input ".concat(e,". ")+"Available gradients found: ".concat(Object.keys(s),"."));const i=n((()=>s[e]()));if("float32"!==i.dtype)throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"".concat(e," must have 'float32' dtype, but has '").concat(i.dtype,"'"));const o=a.inputs[e];if(!l.r1(i.shape,o.shape))throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"'".concat(e,"' has shape '").concat(i.shape,"', which does not match ")+"the shape of the input '".concat(o.shape,"'"));if(null==t[o.id])t[o.id]=i;else{const e=t[o.id];t[o.id]=r(e,i),e.dispose()}}}}(t,a,(t=>this.tidy(t)),w);const r=e.map((e=>t[e.id]));return 0===this.state.gradientDepth&&(this.state.activeTape.forEach((t=>{for(const e of t.saved)e.dispose()})),this.state.activeTape=null),{value:i,grads:r}}))}customGrad(t){var e=this;return l.vA(l.Tn(t),(()=>"The f passed in customGrad(f) must be a function.")),function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];let a;l.vA(r.every((t=>t instanceof p.qY)),(()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors"));const o={};r.forEach(((t,e)=>{o[e]=t}));return e.runKernelFunc({forwardFunc:(e,n)=>(a=t(...r,n),l.vA(a.value instanceof p.qY,(()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor")),l.vA(l.Tn(a.gradFunc),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function.")),a.value),backwardsFunc:(t,e)=>{const n=a.gradFunc(t,e),i=Array.isArray(n)?n:[n];l.vA(i.length===r.length,(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...).")),l.vA(i.every((t=>t instanceof p.qY)),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."));const o={};return i.forEach(((t,e)=>{o[e]=()=>t})),o},inputs:o})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}readToGPU(t,e){return this.state.tensorInfo.get(t).backend.readToGPU(t,e)}async time(t){const e=(0,u.now)(),n=await this.backend.time(t);return n.wallMs=(0,u.now)()-e,n}track(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new y;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function b(){const t=(0,a.L)();if(null==t._tfengine){const e=new i.OH(t);t._tfengine=new v(e)}return(0,i.tj)(t._tfengine.ENV),(0,p.qP)((()=>t._tfengine)),t._tfengine}v.nextTensorId=0,v.nextVariableId=0;const x=b();function w(t,e){const n={a:t,b:e};return x.runKernel(o.OMN,n)}},89e3:(t,e,n)=>{"use strict";n.d(e,{Km:()=>c,OH:()=>a,_K:()=>s,tj:()=>u});var r=n(23869);const i="tfjsflags";class a{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=o,this.populateURLFlags()}setPlatform(t,e){null!=this.platform&&(s().getBool("IS_TEST")||s().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(t,"."))),this.platformName=t,this.platform=e}registerFlag(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){const e=this.urlFlags[t];s().getBool("IS_TEST")||s().getBool("PROD")||console.warn("Setting feature override from URL ".concat(t,": ").concat(e,".")),this.set(t,e)}}async getAsync(t){return t in this.flags||(this.flags[t]=await this.evaluateFlag(t)),this.flags[t]}get(t){if(t in this.flags)return this.flags[t];const e=this.evaluateFlag(t);if((0,r.yL)(e))throw new Error("Flag ".concat(t," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[t]=e,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getString(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag ".concat(t," as it has not been registered."));this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '".concat(t,"': no evaluation function found."));return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if("undefined"===typeof this.global||"undefined"===typeof this.global.location||"undefined"===typeof this.global.location.search)return;const t=this.getQueryParams(this.global.location.search);if(i in t){t[i].split(",").forEach((t=>{const[e,n]=t.split(":");this.urlFlags[e]=function(t,e){const n=e.toLowerCase();return"true"===n||"false"===n?"true"===n:"".concat(+n)===n?+n:e}(0,n)}))}}}function o(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(e,r[0],r[1]),r.join("=")})),e}function s(){return c}let c=null;function u(t){c=t}},41130:(t,e,n)=>{"use strict";n(37484);var r=n(80106);const i=(0,n(89e3)._K)();i.registerFlag("DEBUG",(()=>!1),(t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),i.registerFlag("IS_BROWSER",(()=>r.isBrowser())),i.registerFlag("IS_NODE",(()=>"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node)),i.registerFlag("IS_CHROME",(()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor))),i.registerFlag("IS_SAFARI",(()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor))),i.registerFlag("PROD",(()=>!1)),i.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(()=>i.getBool("DEBUG"))),i.registerFlag("DEPRECATION_WARNINGS_ENABLED",(()=>!0)),i.registerFlag("IS_TEST",(()=>!1)),i.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(()=>i.getBool("DEBUG"))),i.registerFlag("WRAP_TO_IMAGEBITMAP",(()=>!1)),i.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",(()=>!1)),i.registerFlag("USE_SETTIMEOUTCUSTOM",(()=>!1))},86177:(t,e,n)=>{"use strict";let r;function i(){if(null==r){let t;if("undefined"!==typeof window)t=window;else if("undefined"!==typeof n.g)t=n.g;else if("undefined"!==typeof process)t=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");t=self}r=t}return r}function a(t,e){const n=function(){const t=i();return null==t._tfGlobals&&(t._tfGlobals=new Map),t._tfGlobals}();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}n.d(e,{L:()=>i,m:()=>a})},23129:(t,e,n)=>{"use strict";n.d(e,{AS:()=>m,DZ:()=>g,Gc:()=>x,Hi:()=>d,Hs:()=>C,IS:()=>u,ME:()=>p,Ok:()=>E,Sm:()=>s,W4:()=>S,aC:()=>y,fL:()=>l,gJ:()=>A,gY:()=>c,go:()=>_,jh:()=>b,jz:()=>w,kB:()=>v,m1:()=>f,rE:()=>k,rm:()=>h});var r=n(37484),i=n(89e3),a=n(90739),o=n(48683);function s(){(0,i._K)().set("PROD",!0)}function c(){(0,i._K)().set("DEBUG",!0)}function u(){(0,i._K)().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function l(t){(0,i._K)().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function h(){r.T2.disposeVariables()}function d(){return r.T2}function f(){return r.T2.memory()}function p(t){return r.T2.profile(t)}function g(t,e){return r.T2.tidy(t,e)}function m(t){(0,o.getTensorsInContainer)(t).forEach((t=>t.dispose()))}function y(t){return r.T2.keep(t)}function v(t){return r.T2.time(t)}function b(t){return r.T2.setBackend(t)}function x(){return r.T2.ready()}function w(){return r.T2.backendName}function k(t){r.T2.removeBackend(t)}function _(t){return r.T2.findBackend(t)}function S(t){return r.T2.findBackendFactory(t)}function A(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return r.T2.registerBackend(t,e,n)}function C(){return r.T2.backend}function E(t,e){(0,i._K)().setPlatform(t,e)}(0,a.B4)(l)},57832:(t,e,n)=>{"use strict";n.d(e,{Dv:()=>s,_X:()=>d,jY:()=>u,mu:()=>l,ok:()=>c,y7:()=>h});var r=n(37484),i=n(90739),a=n(52863),o=n(23869);function s(t){return o.vA(o.Tn(t),(()=>"The f passed in grad(f) must be a function")),(e,n)=>{const i=(0,a.YT)(e,"x","tf.grad","string_or_numeric"),s=null!=n?(0,a.YT)(n,"dy","tf.grad"):null;return r.T2.tidy((()=>{const{value:e,grads:n}=r.T2.gradients((()=>t(i)),[i],s);return null!=s&&o.O3(e.shape,s.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),f(n),n[0]}))}}function c(t){return o.vA(o.Tn(t),(()=>"The f passed in grads(f) must be a function")),(e,n)=>{o.vA(Array.isArray(e),(()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"));const i=(0,a.j1)(e,"args","tf.grads","string_or_numeric"),s=null!=n?(0,a.YT)(n,"dy","tf.grads"):null;return r.T2.tidy((()=>{const{value:e,grads:n}=r.T2.gradients((()=>t(...i)),i,s);return null!=s&&o.O3(e.shape,s.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),f(n),n}))}}function u(t){return o.vA(o.Tn(t),(()=>"The f passed in valueAndGrad(f) must be a function")),(e,n)=>{o.vA(e instanceof i.qY,(()=>"The x passed in valueAndGrad(f)(x) must be a tensor")),o.vA(null==n||n instanceof i.qY,(()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"));const{grads:a,value:s}=r.T2.gradients((()=>t(e)),[e],n);return f(a),{grad:a[0],value:s}}}function l(t){return o.vA(o.Tn(t),(()=>"The f passed in valueAndGrads(f) must be a function")),(e,n)=>{o.vA(Array.isArray(e)&&e.every((t=>t instanceof i.qY)),(()=>"The args passed in valueAndGrads(f)(args) must be array of tensors")),o.vA(null==n||n instanceof i.qY,(()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"));const a=r.T2.gradients((()=>t(...e)),e,n);return null!=n&&o.O3(a.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),f(a.grads),a}}function h(t,e){o.vA(o.Tn(t),(()=>"The f passed in variableGrads(f) must be a function")),o.vA(null==e||Array.isArray(e)&&e.every((t=>t instanceof i.rT)),(()=>"The varList passed in variableGrads(f, varList) must be an array of variables"));const n=null!=e;if(!n){e=[];for(const t in r.T2.registeredVariables)e.push(r.T2.registeredVariables[t])}const a=n?e.filter((t=>!t.trainable)):null,s=e.length;e=e.filter((t=>t.trainable)),o.vA(e.length>0,(()=>"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(s," variables is ")+"trainable."));const{value:c,grads:u}=r.T2.gradients(t,e,null,!0);o.vA(u.some((t=>null!=t)),(()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize().")),o.vA(0===c.rank,(()=>"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(c.rank," tensor")));const l={};return e.forEach(((t,e)=>{null!=u[e]&&(l[t.name]=u[e])})),null!=a&&a.forEach((t=>l[t.name]=null)),{value:c,grads:l}}function d(t){return r.T2.customGrad(t)}function f(t){if(t.filter((t=>null==t)).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}},37837:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Abs:()=>i.ljI,Acos:()=>i.Vvy,Acosh:()=>i.PH8,AdadeltaOptimizer:()=>i.K$F,AdagradOptimizer:()=>i.ah4,AdamOptimizer:()=>i.FYc,AdamaxOptimizer:()=>i.oC7,Add:()=>i.OMN,AddN:()=>i.EkD,All:()=>i.u8Z,Any:()=>i.FSt,ArgMax:()=>i.Jp_,ArgMin:()=>i.p_m,Asin:()=>i.QKF,Asinh:()=>i.epO,Atan:()=>i.TyE,Atan2:()=>i.lxb,Atanh:()=>i.zP9,AvgPool:()=>i.ho8,AvgPool3D:()=>i.cS,AvgPool3DGrad:()=>i.wwC,AvgPoolGrad:()=>i.VCH,BatchMatMul:()=>i.jAQ,BatchToSpaceND:()=>i.Ik2,Bincount:()=>i.N4F,BitwiseAnd:()=>i.HNs,BroadcastArgs:()=>i.vj7,BroadcastTo:()=>i.LB5,Cast:()=>i.KXH,Ceil:()=>i.QDP,ClipByValue:()=>i.vaV,Complex:()=>i.pr3,ComplexAbs:()=>i.$zE,Concat:()=>i.$dB,Conv2D:()=>i.p2J,Conv2DBackpropFilter:()=>i.rFm,Conv2DBackpropInput:()=>i.jfg,Conv3D:()=>i.A1h,Conv3DBackpropFilterV2:()=>i.iGz,Conv3DBackpropInputV2:()=>i.gC7,Cos:()=>i.Mn0,Cosh:()=>i.MnK,CropAndResize:()=>i.MRQ,Cumprod:()=>i.jj_,Cumsum:()=>i.nY8,DataStorage:()=>i.GJx,DenseBincount:()=>i.wNW,DepthToSpace:()=>i.TMz,DepthwiseConv2dNative:()=>i.tGH,DepthwiseConv2dNativeBackpropFilter:()=>i.X$8,DepthwiseConv2dNativeBackpropInput:()=>i.nVu,Diag:()=>i.ORI,Dilation2D:()=>i.jxD,Dilation2DBackpropFilter:()=>i.pk0,Dilation2DBackpropInput:()=>i.bP9,Draw:()=>i.XmO,ENV:()=>i.Kmu,Einsum:()=>i.Qgm,Elu:()=>i.Pah,EluGrad:()=>i.rsH,Environment:()=>i.OH$,Equal:()=>i.BRl,Erf:()=>i._s9,Exp:()=>i.ox3,ExpandDims:()=>i.ybN,Expm1:()=>i.ybj,FFT:()=>i.rGP,Fill:()=>i.SQl,FlipLeftRight:()=>i.BxF,Floor:()=>i.ZgB,FloorDiv:()=>i.ElG,FromPixels:()=>i.awo,FusedBatchNorm:()=>i.i5R,FusedConv2D:()=>i.aAr,FusedDepthwiseConv2D:()=>i.T7M,GatherNd:()=>i.O4G,GatherV2:()=>i.mxL,Greater:()=>i.XhZ,GreaterEqual:()=>i.lLS,IFFT:()=>i.OAQ,Identity:()=>i.lzr,Imag:()=>i.dv8,IsFinite:()=>i.gIW,IsInf:()=>i.E3$,IsNan:()=>i.iPs,KernelBackend:()=>i.uI_,LRN:()=>i.jM4,LRNGrad:()=>i.ToN,LeakyRelu:()=>i.X0$,Less:()=>i.mIA,LessEqual:()=>i.CwD,LinSpace:()=>i.mnI,Log:()=>i.tG8,Log1p:()=>i.Cg$,LogSoftmax:()=>i.zfU,LogicalAnd:()=>i.RUm,LogicalNot:()=>i.nZd,LogicalOr:()=>i.LXA,LogicalXor:()=>i.RW8,LowerBound:()=>i.yPW,MatrixBandPart:()=>i.WRv,Max:()=>i.VAI,MaxPool:()=>i.t3d,MaxPool3D:()=>i.ySp,MaxPool3DGrad:()=>i.cHb,MaxPoolGrad:()=>i.RXX,MaxPoolWithArgmax:()=>i.TL8,Maximum:()=>i.LDN,Mean:()=>i.g5A,Min:()=>i.lNG,Minimum:()=>i.LG0,MirrorPad:()=>i.x7F,Mod:()=>i.BLA,MomentumOptimizer:()=>i.Qu_,Multinomial:()=>i.WT3,Multiply:()=>i.xu7,Neg:()=>i.l0G,NonMaxSuppressionV3:()=>i.SDM,NonMaxSuppressionV4:()=>i.Zl4,NonMaxSuppressionV5:()=>i.e0f,NotEqual:()=>i.ylV,OP_SCOPE_SUFFIX:()=>i.BTT,OneHot:()=>i.urI,OnesLike:()=>i.LWX,Optimizer:()=>i.ELo,OptimizerConstructors:()=>i.L5p,Pack:()=>i.mM$,PadV2:()=>i.ODT,Pool:()=>i.bCz,Pow:()=>i.pyJ,Prelu:()=>i.Ncv,Prod:()=>i.kdj,RMSPropOptimizer:()=>i.PS5,RaggedGather:()=>i.oJ2,RaggedRange:()=>i.CQC,RaggedTensorToTensor:()=>i.mH5,Range:()=>i.Q6t,Rank:()=>i.rgM,Real:()=>i.LRy,RealDiv:()=>i.sDr,Reciprocal:()=>i.huO,Reduction:()=>i.iDl,Relu:()=>i.fUj,Relu6:()=>i.P_L,Reshape:()=>i.R23,ResizeBilinear:()=>i.hgw,ResizeBilinearGrad:()=>i.FCQ,ResizeNearestNeighbor:()=>i.jOE,ResizeNearestNeighborGrad:()=>i.XQy,Reverse:()=>i.D7i,RotateWithOffset:()=>i.BK4,Round:()=>i.hVg,Rsqrt:()=>i.TOR,SGDOptimizer:()=>i.SYI,ScatterNd:()=>i.pJc,SearchSorted:()=>i.uWl,Select:()=>i.l6P,Selu:()=>i.u$b,Sigmoid:()=>i.vI1,Sign:()=>i.YVe,Sin:()=>i.hql,Sinh:()=>i.J3C,Slice:()=>i.JiE,Softmax:()=>i.rFG,Softplus:()=>i.Fin,SpaceToBatchND:()=>i.A8B,SparseFillEmptyRows:()=>i.C8s,SparseReshape:()=>i.BoJ,SparseSegmentMean:()=>i.L6G,SparseSegmentSum:()=>i.DvZ,SparseToDense:()=>i.jgd,SplitV:()=>i.Blb,Sqrt:()=>i.dFH,Square:()=>i.M6A,SquaredDifference:()=>i.Ddj,StaticRegexReplace:()=>i.GZp,Step:()=>i.pnw,StridedSlice:()=>i.UcO,StringNGrams:()=>i.YAb,StringSplit:()=>i.iW0,StringToHashBucketFast:()=>i.$jE,Sub:()=>i.PbM,Sum:()=>i.WuN,Tan:()=>i.oFs,Tanh:()=>i.iuW,Tensor:()=>i.qYS,TensorBuffer:()=>i.ylz,TensorScatterUpdate:()=>i.X4r,Tile:()=>i.FAs,TopK:()=>i.TBb,Transform:()=>i.dLy,Transpose:()=>i.wx0,Unique:()=>i.EwU,Unpack:()=>i.dXR,UnsortedSegmentSum:()=>i.pPe,UpperBound:()=>i.RMm,Variable:()=>i.rTt,ZerosLike:()=>i.xJ3,_FusedMatMul:()=>i.Dr,abs:()=>i.tnl,acos:()=>i.HQu,acosh:()=>i.FqL,add:()=>i.WQq,addN:()=>i.QiD,all:()=>i.Q7R,any:()=>i.bzn,argMax:()=>i.FLi,argMin:()=>i.XRg,asin:()=>i.qRo,asinh:()=>i.yHs,atan:()=>i.rYl,atan2:()=>i.FPz,atanh:()=>i.rfv,avgPool:()=>i.$jT,avgPool3d:()=>i.sub,backend:()=>i.Hs,backend_util:()=>i.C0T,basicLSTMCell:()=>i.lZX,batchNorm:()=>i.$v7,batchNorm2d:()=>i.BFc,batchNorm3d:()=>i.kSi,batchNorm4d:()=>i.T5N,batchToSpaceND:()=>i.GTe,bincount:()=>i.HbZ,bitwiseAnd:()=>i.vjT,booleanMaskAsync:()=>i.ftb,broadcastArgs:()=>i.ROE,broadcastTo:()=>i.hOW,broadcast_util:()=>i.ZEY,browser:()=>i.TaL,buffer:()=>i.ra8,cast:()=>i.wgE,ceil:()=>i.mkO,clipByValue:()=>i.zQh,clone:()=>i.o8B,complex:()=>i.faB,concat:()=>i.xWs,concat1d:()=>i.I1m,concat2d:()=>i.RPU,concat3d:()=>i.O5O,concat4d:()=>i.P1l,conv1d:()=>i.kA9,conv2d:()=>i.Xtf,conv2dTranspose:()=>i.wX9,conv3d:()=>i.IPL,conv3dTranspose:()=>i.jIJ,copyRegisteredKernels:()=>i.Cfv,cos:()=>i.gnS,cosh:()=>i.yIG,cosineWindow:()=>i._jP,cumprod:()=>i.Lp0,cumsum:()=>i.rCv,customGrad:()=>i._Xg,denseBincount:()=>i.aOp,deprecationWarn:()=>i.fLc,depthToSpace:()=>i.Rj8,depthwiseConv2d:()=>i.Gl3,device_util:()=>i.eMq,diag:()=>i.smy,dilation2d:()=>i.X7t,disableDeprecationWarnings:()=>i.ISJ,dispose:()=>i.ASo,disposeVariables:()=>i.rm6,div:()=>i.y4m,divNoNan:()=>i.ek5,dot:()=>i.Omf,dropout:()=>i.EZY,einsum:()=>i._3C,elu:()=>i.Pqc,enableDebugMode:()=>i.gYU,enableProdMode:()=>i.SmG,enclosingPowerOfTwo:()=>i.FJY,engine:()=>i.Hi9,ensureShape:()=>i.QP2,env:()=>i._K2,equal:()=>i.LCg,erf:()=>i.Y12,euclideanNorm:()=>i.p4S,exp:()=>i.oNF,expandDims:()=>i.UG6,expm1:()=>i.IYd,eye:()=>i.y5U,fft:()=>i.hVP,fill:()=>i.GSj,findBackend:()=>i.goy,findBackendFactory:()=>i.W4C,floor:()=>i.RIf,floorDiv:()=>i.wh_,fused:()=>i.cZk,gather:()=>i.kgh,gatherND:()=>i.SY9,gather_util:()=>i.FJy,getBackend:()=>i.jz4,getGradient:()=>i.vQR,getKernel:()=>i._5H,getKernelsForBackend:()=>i.OpK,grad:()=>i.Dvk,grads:()=>i.ok9,greater:()=>i.rhj,greaterEqual:()=>i.DQN,ifft:()=>i.KGM,imag:()=>i.ngS,image:()=>i.Slp,inTopKAsync:()=>i.U4u,io:()=>i.io,irfft:()=>i.ggX,isFinite:()=>i.MIs,isInf:()=>i.EN4,isNaN:()=>i.yrW,keep:()=>i.aCs,kernel_impls:()=>i.kpo,leakyRelu:()=>i.H8d,less:()=>i.M7h,lessEqual:()=>i.InN,linalg:()=>i.mPL,linspace:()=>i.mT8,localResponseNormalization:()=>i.Kgs,log:()=>i.Rm2,log1p:()=>i.Kko,logSigmoid:()=>i.nqI,logSoftmax:()=>i.HPB,logSumExp:()=>i.VZ,logicalAnd:()=>i.n76,logicalNot:()=>i.NSZ,logicalOr:()=>i.ztW,logicalXor:()=>i.rxB,losses:()=>i.YYh,lowerBound:()=>i.yzS,matMul:()=>i.NoW,math:()=>i.DyF,max:()=>i.T9B,maxPool:()=>i.jgi,maxPool3d:()=>i.NYV,maxPoolWithArgmax:()=>i.RO,maximum:()=>i.PhQ,mean:()=>i.i2o,memory:()=>i.m1Z,meshgrid:()=>i.OYQ,min:()=>i.jkA,minimum:()=>i.BpO,mirrorPad:()=>i.FFZ,mod:()=>i.ziu,moments:()=>i.Clk,movingAverage:()=>i.CRk,mul:()=>i.lKK,multiRNNCell:()=>i.YDF,multinomial:()=>i.OjQ,neg:()=>i.HZy,nextFrame:()=>i.dA1,norm:()=>i.xbf,notEqual:()=>i.Ec,oneHot:()=>i.Mw0,ones:()=>i.SaS,onesLike:()=>i.P61,op:()=>i.op,outerProduct:()=>i.X4o,pad:()=>i.eVF,pad1d:()=>i.BZs,pad2d:()=>i.grY,pad3d:()=>i.XHu,pad4d:()=>i.WLX,pool:()=>i.dzn,pow:()=>i.n7C,prelu:()=>i.NsG,print:()=>i.yyV,prod:()=>i._eU,profile:()=>i.MEE,raggedGather:()=>i.whe,raggedRange:()=>i.iyU,raggedTensorToTensor:()=>i.Q0_,rand:()=>i._9M,randomGamma:()=>i.pR9,randomNormal:()=>i.FE$,randomStandardNormal:()=>i.m0H,randomUniform:()=>i.YeY,randomUniformInt:()=>i.HYA,range:()=>i.y17,ready:()=>i.Gc4,real:()=>i.xav,reciprocal:()=>i.VOZ,registerBackend:()=>i.gJX,registerGradient:()=>i.krJ,registerKernel:()=>i.tAK,relu:()=>i.VVh,relu6:()=>i.j__,removeBackend:()=>i.rEj,reshape:()=>i.tQQ,reverse:()=>i.BEg,reverse1d:()=>i.QD2,reverse2d:()=>i.LMr,reverse3d:()=>i.I2l,reverse4d:()=>i.JYU,rfft:()=>i.z8$,round:()=>i.LIG,rsqrt:()=>i.Z$r,scalar:()=>i.d_2,scatterND:()=>i.NFr,scatter_util:()=>i.g23,searchSorted:()=>i.sZg,selu:()=>i.WfX,separableConv2d:()=>i.wdz,serialization:()=>i.JFn,setBackend:()=>i.jh6,setPlatform:()=>i.OkC,setdiff1dAsync:()=>i.F12,sigmoid:()=>i.ry7,sign:()=>i._SZ,signal:()=>i.vPA,sin:()=>i.F8e,sinh:()=>i.L0l,slice:()=>i.dik,slice1d:()=>i.Q$M,slice2d:()=>i.zAd,slice3d:()=>i.wck,slice4d:()=>i.R0O,slice_util:()=>i.Kro,softmax:()=>i.Vs9,softplus:()=>i.lw0,spaceToBatchND:()=>i.eDJ,sparse:()=>i.lMo,sparseToDense:()=>i.Zhr,spectral:()=>i.lOn,split:()=>i.lDo,sqrt:()=>i.RZD,square:()=>i.EwI,squaredDifference:()=>i.Pbu,squeeze:()=>i.r2V,stack:()=>i.t$z,step:()=>i.PMw,stridedSlice:()=>i.Ym9,string:()=>i.YjP,sub:()=>i.jbE,sum:()=>i.czq,sumOutType:()=>i.chL,tan:()=>i.Mlm,tanh:()=>i.ymU,tensor:()=>i.OEK,tensor1d:()=>i.tGX,tensor2d:()=>i.KtR,tensor3d:()=>i.$_$,tensor4d:()=>i.g9W,tensor5d:()=>i.Lpo,tensor6d:()=>i.yxw,tensorScatterUpdate:()=>i.NNh,tensor_util:()=>i.d_S,test_util:()=>i.Obs,tidy:()=>i.DZQ,tile:()=>i.Vsq,time:()=>i.kBw,topk:()=>i.rfw,train:()=>i.BaG,transpose:()=>i.mgz,truncatedNormal:()=>i.efE,unique:()=>i.AmM,unregisterGradient:()=>i.rYx,unregisterKernel:()=>i.iPt,unsortedSegmentSum:()=>i.zAU,unstack:()=>i.K$i,upcastType:()=>i.TuY,upperBound:()=>i.rni,util:()=>i.ZSL,valueAndGrad:()=>i.jYt,valueAndGrads:()=>i.muS,variable:()=>i.bvq,variableGrads:()=>i.y7e,version_core:()=>i.bgA,where:()=>i._M9,whereAsync:()=>i.YJN,zeros:()=>i.Ul9,zerosLike:()=>i.POl});n(5965);var r=n(20940),i=n(74164);(0,r.i)()},76544:(t,e,n)=>{"use strict";n.d(e,{D:()=>i});var r=n(73837);class i{static join(t){return new i(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,null==t)return;if(t instanceof Array||(t=[t]),0===(t=t.map((t=>r.isTypedArray(t)?t.buffer:t))).length)return;this.bufferUniformSize=t[0].byteLength;let e=0;for(let n=0;n<t.length;n++){const r=t[n];n!==t.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=e+r.byteLength;this.shards.push({buffer:r,start:e,end:i}),e=i}0===this.shards.length&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength;if(0===this.shards.length)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,e=isNaN(Number(e))?0:e,t=Math.max(0,t),e=Math.min(this.byteLength,e),e<=t)return new ArrayBuffer(0);const n=this.findShardForByte(t);if(-1===n)throw new Error("Could not find start shard for byte ".concat(t));const r=new ArrayBuffer(e-t),i=new Uint8Array(r);let a=0;for(let o=n;o<this.shards.length;o++){const n=this.shards[o],r=t+a-n.start,s=a,c=Math.min(e,n.end)-n.start,u=new Uint8Array(n.buffer,r,c-r);if(i.set(u,s),a+=u.length,e<n.end)break}return r}findShardForByte(t){if(0===this.shards.length||t<0||t>=this.byteLength)return-1;if(null!=this.bufferUniformSize)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function e(e){return t<e.start?-1:t>=e.end?1:0}if(0===e(this.shards[this.previousShardIndex]))return this.previousShardIndex;const n=function(t,e){let n=0,r=t.length;for(;n<=r;){const i=Math.floor((r-n)/2)+n,a=e(t[i]);if(0===a)return i;a<0?r=i:n=i+1}return-1}(this.shards,e);return-1===n?-1:(this.previousShardIndex=n,this.previousShardIndex)}}},59624:(t,e,n)=>{"use strict";n.d(e,{lQ:()=>p,mn:()=>d});n(41130);var r=n(89e3),i=n(92834),a=n(93131),o=n(76544);const s="tensorflowjs",c="models_store",u="model_info_store";function l(){if(!(0,r._K)().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t="undefined"===typeof window?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function h(t){const e=t.result;e.createObjectStore(c,{keyPath:"modelPath"}),e.createObjectStore(u,{keyPath:"modelPath"})}class d{constructor(t){if(this.indexedDB=l(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,e){return new Promise(((t,n)=>{const r=this.indexedDB.open(s,1);r.onupgradeneeded=()=>h(r),r.onsuccess=()=>{const a=r.result;if(null==e){const e=a.transaction(c,"readonly"),r=e.objectStore(c).get(this.modelPath);r.onsuccess=()=>{if(null==r.result)return a.close(),n(new Error("Cannot find model with path '".concat(this.modelPath,"' ")+"in IndexedDB."));t(r.result.modelArtifacts)},r.onerror=t=>(a.close(),n(r.error)),e.oncomplete=()=>a.close()}else{e.weightData=o.D.join(e.weightData);const r=(0,i.oR)(e),l=a.transaction(u,"readwrite");let h,d,f=l.objectStore(u);try{h=f.put({modelPath:this.modelPath,modelArtifactsInfo:r})}catch(s){return n(s)}h.onsuccess=()=>{d=a.transaction(c,"readwrite");const i=d.objectStore(c);let o;try{o=i.put({modelPath:this.modelPath,modelArtifacts:e,modelArtifactsInfo:r})}catch(s){return n(s)}o.onsuccess=()=>t({modelArtifactsInfo:r}),o.onerror=t=>{f=l.objectStore(u);const e=f.delete(this.modelPath);e.onsuccess=()=>(a.close(),n(o.error)),e.onerror=t=>(a.close(),n(o.error))}},h.onerror=t=>(a.close(),n(h.error)),l.oncomplete=()=>{null==d?a.close():d.oncomplete=()=>a.close()}}},r.onerror=t=>n(r.error)}))}}d.URL_SCHEME="indexeddb://";const f=t=>{return(0,r._K)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(d.URL_SCHEME)?(e=t.slice(d.URL_SCHEME.length),new d(e)):null;var e};a.bM.registerSaveRouter(f),a.bM.registerLoadRouter(f);class p{constructor(){this.indexedDB=l()}async listModels(){return new Promise(((t,e)=>{const n=this.indexedDB.open(s,1);n.onupgradeneeded=()=>h(n),n.onsuccess=()=>{const r=n.result,i=r.transaction(u,"readonly"),a=i.objectStore(u).getAll();a.onsuccess=()=>{const e={};for(const t of a.result)e[t.modelPath]=t.modelArtifactsInfo;t(e)},a.onerror=t=>(r.close(),e(a.error)),i.oncomplete=()=>r.close()},n.onerror=t=>e(n.error)}))}async removeModel(t){var e;return t=(e=t).startsWith(d.URL_SCHEME)?e.slice(d.URL_SCHEME.length):e,new Promise(((e,n)=>{const r=this.indexedDB.open(s,1);r.onupgradeneeded=()=>h(r),r.onsuccess=()=>{const i=r.result,a=i.transaction(u,"readwrite"),o=a.objectStore(u),s=o.get(t);let l;s.onsuccess=()=>{if(null==s.result)return i.close(),n(new Error("Cannot find model with path '".concat(t,"' ")+"in IndexedDB."));{const r=o.delete(t),a=()=>{l=i.transaction(c,"readwrite");const r=l.objectStore(c).delete(t);r.onsuccess=()=>e(s.result.modelArtifactsInfo),r.onerror=t=>n(s.error)};r.onsuccess=a,r.onerror=t=>(a(),i.close(),n(s.error))}},s.onerror=t=>(i.close(),n(s.error)),a.oncomplete=()=>{null==l?i.close():l.oncomplete=()=>i.close()}},r.onerror=t=>n(r.error)}))}}},92834:(t,e,n)=>{"use strict";n.d(e,{AQ:()=>_,CY:()=>d,Ej:()=>E,P8:()=>S,Rl:()=>C,Xf:()=>N,aG:()=>h,jf:()=>k,l3:()=>w,oR:()=>T,s5:()=>y,zV:()=>A});var r=n(76234),i=n(98869),a=n(23869),o=n(64511),s=n(76544),c=n(23129),u=n(89e3);const l=4;async function h(t,e){const n=[],r=[],i=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);for(let a=0;a<i.length;++a){const o=i[a],s=Array.isArray(t)?t[a].tensor:t[o];if("float32"!==s.dtype&&"int32"!==s.dtype&&"bool"!==s.dtype&&"string"!==s.dtype&&"complex64"!==s.dtype)throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(s.dtype));const c={name:o,shape:s.shape,dtype:s.dtype};if("string"===s.dtype){const t=new Promise((async t=>{const e=await s.bytes(),n=e.reduce(((t,e)=>t+e.length),0)+l*e.length,r=new Uint8Array(n);let i=0;for(let a=0;a<e.length;a++){const t=e[a],n=new Uint8Array(new Uint32Array([t.length]).buffer);r.set(n,i),i+=l,r.set(t,i),i+=t.length}t(r)}));r.push(t)}else r.push(s.data());null!=e&&(c.group=e),n.push(c)}return{data:v(await Promise.all(r)),specs:n}}function d(t,e){const n=new s.D(t),r={};let i=0;for(const a of e){const t=f(a,((t,e)=>n.slice(i+t,i+e)));r[a.name]=g(a,n.slice(i,i+t)),i+=t}return r}function f(t,e){const n=(0,a.Ze)(t.shape);let r;if("quantization"in t){const e=t.quantization;r=o.i[e.dtype]}else{if("string"===t.dtype){let t=0;for(let r=0;r<n;r++)t+=l+new Uint32Array(e(t,t+l))[0];return t}r=o.i[t.dtype]}return n*r}async function p(t,e){const n=(0,a.Ze)(t.shape);let r;if("quantization"in t){const e=t.quantization;r=o.i[e.dtype]}else{if("string"===t.dtype){let t=0;for(let r=0;r<n;r++)t+=l+new Uint32Array(await e(t,t+l))[0];return t}r=o.i[t.dtype]}return n*r}function g(t,e){const n=t.name,s=t.dtype,c=t.shape,u=(0,a.Ze)(c);let h,d=0;if("quantization"in t){const r=t.quantization;if("uint8"===r.dtype||"uint16"===r.dtype){if(!("min"in r)||!("scale"in r))throw new Error("Weight ".concat(t.name," with quantization ").concat(r.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==r.dtype)throw new Error("Weight ".concat(t.name," has unknown ")+"quantization dtype ".concat(r.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==s)throw new Error("Weight ".concat(t.name," is quantized with ").concat(r.dtype," ")+"which only supports weights of type float32 not ".concat(s,"."))}const i=o.i[r.dtype],a="uint8"===r.dtype?new Uint8Array(e):new Uint16Array(e);if("float32"===s)if("uint8"===r.dtype||"uint16"===r.dtype){h=new Float32Array(a.length);for(let t=0;t<a.length;t++){const e=a[t];h[t]=e*r.scale+r.min}}else{if("float16"!==r.dtype)throw new Error("Unsupported quantization type ".concat(r.dtype," ")+"for weight type float32.");{const t=function(){const t=function(){const t=t=>{let e=t<<13,n=0;for(;0===(8388608&e);)n-=8388608,e<<=1;return e&=-8388609,n+=947912704,e|n},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}(),e=function(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}(),n=function(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}();return r=>{const i=new ArrayBuffer(4*r.length),a=new Uint32Array(i);for(let o=0;o<r.length;o++){const i=r[o],s=t[n[i>>10]+(1023&i)]+e[i>>10];a[o]=s}return new Float32Array(i)}}();h=t(a)}}else{if("int32"!==s)throw new Error("Unsupported dtype in weight '".concat(n,"': ").concat(s));if("uint8"!==r.dtype&&"uint16"!==r.dtype)throw new Error("Unsupported quantization type ".concat(r.dtype," ")+"for weight type int32.");h=new Int32Array(a.length);for(let t=0;t<a.length;t++){const e=a[t];h[t]=Math.round(e*r.scale+r.min)}}d+=u*i}else if("string"===s){const n=(0,a.Ze)(t.shape);h=[];for(let t=0;t<n;t++){const t=new Uint32Array(e.slice(d,d+l))[0];d+=l;const n=new Uint8Array(e.slice(d,d+t));h.push(n),d+=t}}else{const t=o.i[s];if("float32"===s)h=new Float32Array(e);else if("int32"===s)h=new Int32Array(e);else{if("bool"!==s){if("complex64"===s){h=new Float32Array(e);const t=new Float32Array(h.length/2),n=new Float32Array(h.length/2);for(let e=0;e<t.length;e++)t[e]=h[2*e],n[e]=h[2*e+1];const a=(0,i.O)(t,c,"float32"),o=(0,i.O)(n,c,"float32"),s=(0,r.f)(a,o);return a.dispose(),o.dispose(),s}throw new Error("Unsupported dtype in weight '".concat(n,"': ").concat(s))}h=new Uint8Array(e)}d+=u*t}return(0,i.O)(h,c,s)}async function m(t,e,n){let r=new Uint8Array(e);for(;r.byteLength<n;){const{done:e,value:i}=await t.read();if(e&&null==i){const t=n-r.byteLength;throw new Error("Reader is done but ".concat(t," bytes are still expected"))}const a=new Uint8Array(r.length+i.byteLength);a.set(r,0),a.set(new Uint8Array(i),r.length),r=a}return r.buffer}async function y(t,e){const n={},r=t.getReader();let i=new ArrayBuffer(0);for(const o of e){const t=await p(o,(async(t,e)=>(i=await m(r,i,e),i.slice(t,e))));i=await m(r,i,t);const e=i.slice(0,t);i=i.slice(t);const s=g(o,e);if(n[o.name]=s,"webgpu"===(0,c.jz)()){const t=(0,c.Hs)();"uploadToGPU"in t&&(0,a.Ze)(s.shape)>=(0,u._K)().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&t.uploadToGPU(s.dataId)}}return n}function v(t){if(null===t)throw new Error("Invalid input value: ".concat(JSON.stringify(t)));let e=0;const n=[];t.forEach((t=>{if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(t.constructor.name))}));const r=new Uint8Array(e);let i=0;return n.forEach((t=>{r.set(new Uint8Array(t.buffer),i),i+=t.byteLength})),r.buffer}const b="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function x(t){return b?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function w(t){if(b)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,i=e.length;r<i;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function k(t){if(b){const e=Buffer.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function _(t){return s.D.join(t)}function S(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);const e=t.split("/");return e[e.length-1]}function A(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return null!=t.signature&&(n.signature=t.signature),null!=t.userDefinedMetadata&&(n.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(n.modelInitializer=t.modelInitializer),null!=t.initializerSignature&&(n.initializerSignature=t.initializerSignature),null!=t.trainingConfig&&(n.trainingConfig=t.trainingConfig),n}function C(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(null!=t.trainingConfig&&(r.trainingConfig=t.trainingConfig),null!=t.weightsManifest){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return null!=t.signature&&(r.signature=t.signature),null!=t.userDefinedMetadata&&(r.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(r.modelInitializer=t.modelInitializer),null!=t.initializerSignature&&(r.initializerSignature=t.initializerSignature),r}async function E(t,e){let n,r;return null!=t.weightsManifest&&([n,r]=await e(t.weightsManifest)),C(t,n,r)}function T(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:x(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:x(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:new s.D(t.weightData).byteLength}}function N(t){const e=[];for(const n of t)e.push(...n.weights);return e}},53259:(t,e,n)=>{"use strict";n.d(e,{Cd:()=>x,ZT:()=>v});n(41130);var r=n(89e3),i=n(23869),a=n(92834),o=n(76544),s=n(93131);const c="/",u="tensorflowjs_models",l="info",h="model_topology",d="weight_specs",f="weight_data",p="model_metadata";function g(t){return{info:[u,t,l].join(c),topology:[u,t,h].join(c),weightSpecs:[u,t,d].join(c),weightData:[u,t,f].join(c),modelMetadata:[u,t,p].join(c)}}function m(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function y(t){const e=t.split(c);if(e.length<3)throw new Error("Invalid key format: ".concat(t));return e.slice(1,e.length-1).join(c)}class v{constructor(t){if(!(0,r._K)().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=g(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),i=(0,a.oR)(t),s=o.D.join(t.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,(0,a.l3)(s));const e={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:null!=t.signature?t.signature:void 0,userDefinedMetadata:null!=t.userDefinedMetadata?t.userDefinedMetadata:void 0,modelInitializer:null!=t.modelInitializer?t.modelInitializer:void 0,initializerSignature:null!=t.initializerSignature?t.initializerSignature:void 0,trainingConfig:null!=t.trainingConfig?t.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(e)),{modelArtifactsInfo:i}}catch(e){throw m(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(i.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(i.weightSpecsBytes,", ")+"weightDataBytes=".concat(i.weightDataBytes,"."))}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(null==t)throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const e={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");e.modelTopology=n;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");e.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(null!=i){const t=JSON.parse(i);e.format=t.format,e.generatedBy=t.generatedBy,e.convertedBy=t.convertedBy,null!=t.signature&&(e.signature=t.signature),null!=t.userDefinedMetadata&&(e.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(e.modelInitializer=t.modelInitializer),null!=t.initializerSignature&&(e.initializerSignature=t.initializerSignature),null!=t.trainingConfig&&(e.trainingConfig=t.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(null==o)throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));return e.weightData=(0,a.jf)(o),e}}v.URL_SCHEME="localstorage://";const b=t=>{return(0,r._K)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(v.URL_SCHEME)?(e=t.slice(v.URL_SCHEME.length),new v(e)):null;var e};s.bM.registerSaveRouter(b),s.bM.registerLoadRouter(b);class x{constructor(){(0,i.vA)((0,r._K)().getBool("IS_BROWSER"),(()=>"Current environment is not a web browser")),(0,i.vA)("undefined"===typeof window||"undefined"!==typeof window.localStorage,(()=>"Current browser does not appear to support localStorage")),this.LS=window.localStorage}async listModels(){const t={},e=u+c,n=c+l;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);if(i.startsWith(e)&&i.endsWith(n)){t[y(i)]=JSON.parse(this.LS.getItem(i))}}return t}async removeModel(t){var e;const n=g(t=(e=t).startsWith(v.URL_SCHEME)?e.slice(v.URL_SCHEME.length):e);if(null==this.LS.getItem(n.info))throw new Error("Cannot find model at path '".concat(t,"'"));const r=JSON.parse(this.LS.getItem(n.info));return m(n),r}}},69897:(t,e,n)=>{"use strict";n.d(e,{D:()=>u,Vo:()=>d,az:()=>l,dy:()=>o,xk:()=>h});var r=n(23869),i=n(93131);const a="://";class o{constructor(){this.managers={}}static getInstance(){return null==o.instance&&(o.instance=new o),o.instance}static registerManager(t,e){(0,r.vA)(null!=t,(()=>"scheme must not be undefined or null.")),t.endsWith(a)&&(t=t.slice(0,t.indexOf(a))),(0,r.vA)(t.length>0,(()=>"scheme must not be an empty string."));const n=o.getInstance();(0,r.vA)(null==n.managers[t],(()=>"A model store manager is already registered for scheme '".concat(t,"'."))),n.managers[t]=e}static getManager(t){const e=o.getInstance().managers[t];if(null==e)throw new Error("Cannot find model manager for scheme '".concat(t,"'"));return e}static getSchemes(){return Object.keys(o.getInstance().managers)}}function s(t){if(-1===t.indexOf(a))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(o.getSchemes().join(",")));return{scheme:t.split(a)[0],path:t.split(a)[1]}}async function c(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(0,r.vA)(t!==e,(()=>"Old path and new path are the same: '".concat(t,"'")));const a=i.bM.getLoadHandlers(t);(0,r.vA)(a.length>0,(()=>"Copying failed because no load handler is found for source URL ".concat(t,"."))),(0,r.vA)(a.length<2,(()=>"Copying failed because more than one (".concat(a.length,") ")+"load handlers for source URL ".concat(t,".")));const c=a[0],u=i.bM.getSaveHandlers(e);(0,r.vA)(u.length>0,(()=>"Copying failed because no save handler is found for destination "+"URL ".concat(e,"."))),(0,r.vA)(u.length<2,(()=>"Copying failed because more than one (".concat(a.length,") ")+"save handlers for destination URL ".concat(e,".")));const l=u[0],h=s(t).scheme,d=s(t).path,f=h===s(t).scheme,p=await c.load();n&&f&&await o.getManager(h).removeModel(d);const g=await l.save(p);return n&&!f&&await o.getManager(h).removeModel(d),g.modelArtifactsInfo}async function u(){const t=o.getSchemes(),e={};for(const n of t){const t=await o.getManager(n).listModels();for(const r in t){e[n+a+r]=t[r]}}return e}async function l(t){const e=s(t);return o.getManager(e.scheme).removeModel(e.path)}async function h(t,e){return c(t,e,!1)}async function d(t,e){return c(t,e,!0)}},93131:(t,e,n)=>{"use strict";n.d(e,{C9:()=>s,R4:()=>a,Yd:()=>i,bM:()=>r,x3:()=>o});class r{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==r.instance&&(r.instance=new r),r.instance}static registerSaveRouter(t){r.getInstance().saveRouters.push(t)}static registerLoadRouter(t){r.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return r.getHandlers(t,"save")}static getLoadHandlers(t,e){return r.getHandlers(t,"load",e)}static getHandlers(t,e,n){const i=[];return("load"===e?r.getInstance().loadRouters:r.getInstance().saveRouters).forEach((e=>{const r=e(t,n);null!==r&&i.push(r)})),i}}const i=t=>r.registerSaveRouter(t),a=t=>r.registerLoadRouter(t),o=t=>r.getSaveHandlers(t),s=(t,e)=>r.getLoadHandlers(t,e)},64511:(t,e,n)=>{"use strict";n.d(e,{i:()=>r});const r={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8}},87311:(t,e,n)=>{"use strict";n.d(e,{$dB:()=>I,$jE:()=>nn,$zE:()=>F,A1h:()=>z,A8B:()=>We,BK4:()=>vn,BLA:()=>Zt,BRl:()=>at,Blb:()=>Ve,BoJ:()=>He,BxF:()=>ht,C8s:()=>Ge,CQC:()=>pe,Cg$:()=>Dt,CwD:()=>Et,D7i:()=>Ce,Ddj:()=>$e,Dr:()=>bn,DvZ:()=>Xe,E3$:()=>_t,EkD:()=>s,ElG:()=>ft,EwU:()=>hn,FAs:()=>sn,FCQ:()=>Se,FSt:()=>u,Fin:()=>Pe,GZp:()=>Qe,HNs:()=>S,Ik2:()=>k,J3C:()=>ze,JiE:()=>Oe,Jp_:()=>l,KXH:()=>E,L6G:()=>Ye,LB5:()=>A,LDN:()=>Ut,LG0:()=>Kt,LRy:()=>ye,LWX:()=>ae,LXA:()=>Mt,M6A:()=>Ze,MRQ:()=>V,Mn0:()=>P,MnK:()=>j,N4F:()=>_,Ncv:()=>he,O4G:()=>mt,OAQ:()=>xt,ODT:()=>ce,OMN:()=>o,ORI:()=>K,PH8:()=>a,P_L:()=>Ae,Pah:()=>nt,PbM:()=>rn,Q6t:()=>me,QDP:()=>T,QKF:()=>d,Qgm:()=>et,R23:()=>xe,RMm:()=>pn,RUm:()=>Ft,RW8:()=>Ot,RXX:()=>Vt,SDM:()=>ne,SQl:()=>lt,T7M:()=>wn,TBb:()=>cn,TL8:()=>Ht,TMz:()=>G,TOR:()=>Te,ToN:()=>Lt,TyE:()=>p,UcO:()=>Je,VAI:()=>jt,VCH:()=>v,Vvy:()=>i,WRv:()=>Pt,WT3:()=>Qt,WuN:()=>Ue,X$8:()=>Y,X0$:()=>At,X4r:()=>De,XQy:()=>ke,XhZ:()=>yt,XmO:()=>J,YAb:()=>tn,YVe:()=>Be,ZgB:()=>dt,Zl4:()=>re,_s9:()=>it,aAr:()=>xn,awo:()=>yn,bCz:()=>ue,bP9:()=>Z,cHb:()=>Gt,cS:()=>b,dFH:()=>je,dLy:()=>un,dXR:()=>dn,dv8:()=>wt,e0f:()=>ie,epO:()=>f,fUj:()=>be,g5A:()=>Yt,gC7:()=>L,gIW:()=>kt,hVg:()=>Ee,hgw:()=>_e,ho8:()=>y,hql:()=>Re,huO:()=>ve,i5R:()=>pt,iGz:()=>B,iPs:()=>St,iW0:()=>en,iuW:()=>on,jAQ:()=>w,jM4:()=>Bt,jOE:()=>we,jfg:()=>R,jgd:()=>Ke,jj_:()=>U,jxD:()=>$,kdj:()=>de,l0G:()=>te,l6P:()=>Ie,lLS:()=>vt,lNG:()=>Xt,ljI:()=>r,lxb:()=>m,lzr:()=>bt,mH5:()=>ge,mIA:()=>Ct,mM$:()=>se,mnI:()=>Tt,mxL:()=>gt,nVu:()=>X,nY8:()=>W,nZd:()=>It,oFs:()=>an,oJ2:()=>fe,ox3:()=>ot,p2J:()=>M,pJc:()=>Ne,pPe:()=>fn,p_m:()=>h,pk0:()=>Q,pnw:()=>mn,pr3:()=>D,pyJ:()=>le,rFG:()=>qe,rFm:()=>O,rGP:()=>ut,rsH:()=>rt,sDr:()=>tt,t3d:()=>Wt,tG8:()=>Nt,tGH:()=>H,u$b:()=>Me,u8Z:()=>c,uWl:()=>Fe,urI:()=>oe,vI1:()=>Le,vaV:()=>N,vj7:()=>C,wNW:()=>q,wwC:()=>x,wx0:()=>ln,x7F:()=>$t,xJ3:()=>gn,xu7:()=>Jt,yPW:()=>zt,ySp:()=>qt,ybN:()=>st,ybj:()=>ct,ylV:()=>ee,zP9:()=>g,zfU:()=>Rt});const r="Abs",i="Acos",a="Acosh",o="Add",s="AddN",c="All",u="Any",l="ArgMax",h="ArgMin",d="Asin",f="Asinh",p="Atan",g="Atanh",m="Atan2",y="AvgPool",v="AvgPoolGrad",b="AvgPool3D",x="AvgPool3DGrad",w="BatchMatMul",k="BatchToSpaceND",_="Bincount",S="BitwiseAnd",A="BroadcastTo",C="BroadcastArgs",E="Cast",T="Ceil",N="ClipByValue",D="Complex",F="ComplexAbs",I="Concat",M="Conv2D",O="Conv2DBackpropFilter",R="Conv2DBackpropInput",z="Conv3D",B="Conv3DBackpropFilterV2",L="Conv3DBackpropInputV2",P="Cos",j="Cosh",U="Cumprod",W="Cumsum",V="CropAndResize",q="DenseBincount",G="DepthToSpace",H="DepthwiseConv2dNative",Y="DepthwiseConv2dNativeBackpropFilter",X="DepthwiseConv2dNativeBackpropInput",K="Diag",$="Dilation2D",Z="Dilation2DBackpropInput",Q="Dilation2DBackpropFilter",J="Draw",tt="RealDiv",et="Einsum",nt="Elu",rt="EluGrad",it="Erf",at="Equal",ot="Exp",st="ExpandDims",ct="Expm1",ut="FFT",lt="Fill",ht="FlipLeftRight",dt="Floor",ft="FloorDiv",pt="FusedBatchNorm",gt="GatherV2",mt="GatherNd",yt="Greater",vt="GreaterEqual",bt="Identity",xt="IFFT",wt="Imag",kt="IsFinite",_t="IsInf",St="IsNan",At="LeakyRelu",Ct="Less",Et="LessEqual",Tt="LinSpace",Nt="Log",Dt="Log1p",Ft="LogicalAnd",It="LogicalNot",Mt="LogicalOr",Ot="LogicalXor",Rt="LogSoftmax",zt="LowerBound",Bt="LRN",Lt="LRNGrad",Pt="MatrixBandPart",jt="Max",Ut="Maximum",Wt="MaxPool",Vt="MaxPoolGrad",qt="MaxPool3D",Gt="MaxPool3DGrad",Ht="MaxPoolWithArgmax",Yt="Mean",Xt="Min",Kt="Minimum",$t="MirrorPad",Zt="Mod",Qt="Multinomial",Jt="Multiply",te="Neg",ee="NotEqual",ne="NonMaxSuppressionV3",re="NonMaxSuppressionV4",ie="NonMaxSuppressionV5",ae="OnesLike",oe="OneHot",se="Pack",ce="PadV2",ue="Pool",le="Pow",he="Prelu",de="Prod",fe="RaggedGather",pe="RaggedRange",ge="RaggedTensorToTensor",me="Range",ye="Real",ve="Reciprocal",be="Relu",xe="Reshape",we="ResizeNearestNeighbor",ke="ResizeNearestNeighborGrad",_e="ResizeBilinear",Se="ResizeBilinearGrad",Ae="Relu6",Ce="Reverse",Ee="Round",Te="Rsqrt",Ne="ScatterNd",De="TensorScatterUpdate",Fe="SearchSorted",Ie="Select",Me="Selu",Oe="Slice",Re="Sin",ze="Sinh",Be="Sign",Le="Sigmoid",Pe="Softplus",je="Sqrt",Ue="Sum",We="SpaceToBatchND",Ve="SplitV",qe="Softmax",Ge="SparseFillEmptyRows",He="SparseReshape",Ye="SparseSegmentMean",Xe="SparseSegmentSum",Ke="SparseToDense",$e="SquaredDifference",Ze="Square",Qe="StaticRegexReplace",Je="StridedSlice",tn="StringNGrams",en="StringSplit",nn="StringToHashBucketFast",rn="Sub",an="Tan",on="Tanh",sn="Tile",cn="TopK",un="Transform",ln="Transpose",hn="Unique",dn="Unpack",fn="UnsortedSegmentSum",pn="UpperBound",gn="ZerosLike",mn="Step",yn="FromPixels",vn="RotateWithOffset",bn="_FusedMatMul",xn="FusedConv2D",wn="FusedDepthwiseConv2D"},46780:(t,e,n)=>{"use strict";n.d(e,{Cf:()=>g,Op:()=>l,_5:()=>c,iP:()=>f,kr:()=>d,rY:()=>p,tA:()=>h,vQ:()=>u});var r=n(89e3),i=n(86177),a=n(94851);const o=(0,i.m)("kernelRegistry",(()=>new Map)),s=(0,i.m)("gradRegistry",(()=>new Map));function c(t,e){const n=m(t,e);return o.get(n)}function u(t){return s.get(t)}function l(t){const e=o.entries(),n=[];for(;;){const{done:r,value:i}=e.next();if(r)break;const[a,o]=i,[s]=a.split("_");s===t&&n.push(o)}return n}function h(t){const{kernelName:e,backendName:n}=t,r=m(e,n);o.has(r)&&a.i("The kernel '".concat(e,"' for backend ")+"'".concat(n,"' is already registered")),o.set(r,t)}function d(t){const{kernelName:e}=t;s.has(e)&&(0,r._K)().getBool("DEBUG")&&a.i("Overriding the gradient for '".concat(e,"'")),s.set(e,t)}function f(t,e){const n=m(t,e);if(!o.has(n))throw new Error("The kernel '".concat(t,"' for backend ")+"'".concat(e,"' is not registered"));o.delete(n)}function p(t){if(!s.has(t))throw new Error("The gradient '".concat(t,"' for backend is not registered"));s.delete(t)}function g(t,e){l(t).forEach((t=>{h(Object.assign({},t,{backendName:e}))}))}function m(t,e){return"".concat(e,"_").concat(t)}},94851:(t,e,n)=>{"use strict";n.d(e,{R:()=>a,i:()=>i});var r=n(89e3);function i(){(0,r._K)().getBool("IS_TEST")||(0,r._K)().getBool("PROD")||console.warn(...arguments)}function a(){(0,r._K)().getBool("IS_TEST")||(0,r._K)().getBool("PROD")||console.log(...arguments)}},59470:(t,e,n)=>{"use strict";n.d(e,{t:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({abs_:function(t){const e=(0,a.YT)(t,"x","abs");if("complex64"===e.dtype){const t={x:e};return r.T2.runKernel(i.$zE,t)}{const t={x:e};return r.T2.runKernel(i.ljI,t)}}})},75090:(t,e,n)=>{"use strict";n.d(e,{H:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({acos_:function(t){const e={x:(0,a.YT)(t,"x","acos")};return r.T2.runKernel(i.Vvy,e)}})},34528:(t,e,n)=>{"use strict";n.d(e,{F:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({acosh_:function(t){const e={x:(0,a.YT)(t,"x","acosh")};return r.T2.runKernel(i.PH8,e)}})},67281:(t,e,n)=>{"use strict";n.d(e,{W:()=>s});var r=n(37484),i=n(87311),a=n(48683),o=n(52863);const s=(0,n(26039).op)({add_:function(t,e){let n=(0,o.YT)(t,"a","add"),s=(0,o.YT)(e,"b","add");[n,s]=(0,a.makeTypesMatch)(n,s);const c={a:n,b:s};return r.T2.runKernel(i.OMN,c)}})},86465:(t,e,n)=>{"use strict";n.d(e,{Q:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({all_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o={x:(0,a.YT)(t,"x","all","bool")},s={axis:e,keepDims:n};return r.T2.runKernel(i.u8Z,o,s)}})},25552:(t,e,n)=>{"use strict";n.d(e,{b:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({any_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o={x:(0,a.YT)(t,"x","any","bool")},s={axis:e,keepDims:n};return r.T2.runKernel(i.FSt,o,s)}})},31003:(t,e,n)=>{"use strict";n.d(e,{F:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({argMax_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:(0,a.YT)(t,"x","argMax")},o={axis:e};return r.T2.runKernel(i.Jp_,n,o)}})},72345:(t,e,n)=>{"use strict";n.d(e,{X:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({argMin_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:(0,a.YT)(t,"x","argMin")},o={axis:e};return r.T2.runKernel(i.p_m,n,o)}})},50155:(t,e,n)=>{"use strict";n.d(e,{q:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({asin_:function(t){const e={x:(0,a.YT)(t,"x","asin")};return r.T2.runKernel(i.QKF,e)}})},94467:(t,e,n)=>{"use strict";n.d(e,{y:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({asinh_:function(t){const e={x:(0,a.YT)(t,"x","asinh")};return r.T2.runKernel(i.epO,e)}})},16802:(t,e,n)=>{"use strict";n.d(e,{r:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({atan_:function(t){const e={x:(0,a.YT)(t,"x","atan")};return r.T2.runKernel(i.TyE,e)}})},67986:(t,e,n)=>{"use strict";n.d(e,{F:()=>s});var r=n(37484),i=n(87311),a=n(48683),o=n(52863);const s=(0,n(26039).op)({atan2_:function(t,e){let n=(0,o.YT)(t,"a","atan2"),s=(0,o.YT)(e,"b","atan2");[n,s]=(0,a.makeTypesMatch)(n,s);const c={a:n,b:s};return r.T2.runKernel(i.lxb,c)}})},68080:(t,e,n)=>{"use strict";n.d(e,{r:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({atanh_:function(t){const e={x:(0,a.YT)(t,"x","atanh")};return r.T2.runKernel(i.zP9,e)}})},70963:(t,e,n)=>{"use strict";n.d(e,{$:()=>h});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(69779),c=n(157),u=n(26039),l=n(89068);const h=(0,u.op)({avgPool_:function(t,e,n,u,h){const d=(0,a.YT)(t,"x","avgPool","float32");o.vA(c.G0(n,1),(()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")));let f=d,p=!1;3===d.rank&&(p=!0,f=(0,l.t)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),o.vA(4===f.rank,(()=>"Error in avgPool: x must be rank 4 but got rank ".concat(f.rank,"."))),c.s_("avgPool",u,h);const g={x:f},m={filterSize:e,strides:n,pad:u,dimRoundingMode:h};let y=r.T2.runKernel(i.ho8,g,m);return y=(0,s.w)(y,d.dtype),p?(0,l.t)(y,[y.shape[1],y.shape[2],y.shape[3]]):y}})},58724:(t,e,n)=>{"use strict";n.d(e,{Em:()=>u,SM:()=>s,WC:()=>c,WH:()=>i,aF:()=>a,fK:()=>h,gx:()=>l,lb:()=>o});var r=n(23869);function i(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function a(t,e,n){const r=t.length+e.length,i=[];let a=0,o=0;for(let s=0;s<r;s++)-1===n.indexOf(s)?i.push(t[a++]):i.push(e[o++]);return i}function o(t,e){const n=[],r=t.length;for(let i=0;i<r;i++)-1===e.indexOf(i)&&n.push(t[i]);return[n,e.map((e=>t[e]))]}function s(t,e){return a(t,e.map((t=>1)),e)}function c(t,e,n){r.vA(i(e,n),(()=>"".concat(t," supports only inner-most axes for now. ")+"Got axes ".concat(e," and rank-").concat(n," input.")))}function u(t,e){if(i(t,e))return null;const n=[];for(let r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach((t=>n.push(t))),n}function l(t){return t.map(((t,e)=>[e,t])).sort(((t,e)=>t[1]-e[1])).map((t=>t[0]))}function h(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}},81406:(t,e,n)=>{"use strict";n.d(e,{G:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({batchToSpaceND_:function(t,e,n){const s=(0,a.YT)(t,"x","batchToSpaceND"),c=e.reduce(((t,e)=>t*e));o.vA(s.rank>=1+e.length,(()=>"input rank is ".concat(s.rank," but should be > than blockShape.length ").concat(e.length))),o.vA(n.length===e.length,(()=>"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(e.length))),o.vA(s.shape[0]%c===0,(()=>"input tensor batch is ".concat(s.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(e.join(" * ")," === ").concat(c)));const u={x:s},l={blockShape:e,crops:n};return r.T2.runKernel(i.Ik2,u,l)}})},26670:(t,e,n)=>{"use strict";n.d(e,{$:()=>c});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(89068);const c=(0,n(26039).op)({batchNorm_:function(t,e,n,c,u,l){null==l&&(l=.001);const h=(0,a.YT)(t,"x","batchNorm"),d=(0,a.YT)(e,"mean","batchNorm"),f=(0,a.YT)(n,"variance","batchNorm");let p,g;null!=u&&(p=(0,a.YT)(u,"scale","batchNorm")),null!=c&&(g=(0,a.YT)(c,"offset","batchNorm")),o.vA(d.rank===f.rank,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),o.vA(null==g||d.rank===g.rank,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),o.vA(null==p||d.rank===p.rank,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));const m={x:function(t){let e;return e=0===t.rank||1===t.rank?(0,s.t)(t,[1,1,1,t.size]):2===t.rank?(0,s.t)(t,[1,1,t.shape[0],t.shape[1]]):3===t.rank?(0,s.t)(t,[1,t.shape[0],t.shape[1],t.shape[2]]):t,e}(h),scale:p,offset:g,mean:d,variance:f},y={varianceEpsilon:l},v=r.T2.runKernel(i.i5R,m,y);return(0,s.t)(v,h.shape)}})},99965:(t,e,n)=>{"use strict";n.d(e,{h:()=>l});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(62503),c=n(26039),u=n(89068);const l=(0,c.op)({broadcastTo_:function(t,e){let n=(0,a.YT)(t,"broadcastTo","x");const c=n.shape;if((0,o.SA)(e),e.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(e.length," < input.rank=").concat(n.rank,"."));if(e.length>n.rank){const t=n.shape.slice();for(;t.length<e.length;)t.unshift(1);n=(0,u.t)(n,t)}const l=n.shape,h=Array.from(e);for(let r=e.length-1;r>=0;r--)if(l[r]===e[r])h[r]=1;else if(1!==n.shape[r])throw new Error("broadcastTo(): [".concat(c,"] cannot be broadcast to [").concat(e,"]."));if(0===h.map(((t,e)=>t>1?e:-1)).filter((t=>t>=0)).length)return(0,s.o)(n);const d={x:n},f={reps:h};return r.T2.runKernel(i.FAs,d,f)}})},84824:(t,e,n)=>{"use strict";function r(t,e){const n=t.length,r=[];for(let i=0;i<n;i++){const a=n-1-i,o=t[a]||1;(e[e.length-1-i]||1)>1&&1===o&&r.unshift(a)}return r}function i(t,e){const n=[];for(let r=0;r<e.length;r++){const i=t[t.length-r-1],a=e.length-r-1,o=e[a];(null==i||1===i&&o>1)&&n.unshift(a)}return n}function a(t,e){const n=Math.max(t.length,e.length),r=new Array(n);for(let i=0;i<n;i++){let a=t[t.length-i-1];null==a&&(a=1);let o=e[e.length-i-1];if(null==o&&(o=1),1===a)r[n-i-1]=o;else if(1===o)r[n-i-1]=a;else{if(a!==o){const n="Operands could not be broadcast together with shapes "+"".concat(t," and ").concat(e,".");throw Error(n)}r[n-i-1]=a}}return r}n.r(e),n.d(e,{assertAndGetBroadcastShape:()=>a,getBroadcastDims:()=>r,getReductionAxes:()=>i})},80186:(t,e,n)=>{"use strict";n.d(e,{r:()=>a});var r=n(90739),i=n(23869);function a(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return e=e||"float32",i.SA(t),new r.yl(t,e,n)}},69779:(t,e,n)=>{"use strict";n.d(e,{w:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({cast_:function(t,e){const n=(0,a.YT)(t,"x","cast");if(!o.xn(e))throw new Error("Failed to cast to unknown dtype ".concat(e));if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");const s={x:n},c={dtype:e};return r.T2.runKernel(i.KXH,s,c)}})},33989:(t,e,n)=>{"use strict";n.d(e,{m:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({ceil_:function(t){const e={x:(0,a.YT)(t,"x","ceil","float32")};return r.T2.runKernel(i.QDP,e)}})},68042:(t,e,n)=>{"use strict";n.d(e,{z:()=>c});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(99333);const c=(0,n(26039).op)({clipByValue_:function(t,e,n){const c=(0,a.YT)(t,"x","clipByValue");if(o.vA(e<=n,(()=>"Error in clip: min (".concat(e,") must be ")+"less than or equal to max (".concat(n,")."))),e===n)return(0,s.G)(c.shape,e,c.dtype);const u={x:c},l={clipValueMin:e,clipValueMax:n};return r.T2.runKernel(i.vaV,u,l)}})},62503:(t,e,n)=>{"use strict";n.d(e,{o:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({clone_:function(t){const e={x:(0,a.YT)(t,"x","clone","string_or_numeric")};return r.T2.runKernel(i.lzr,e)}})},76234:(t,e,n)=>{"use strict";n.d(e,{f:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({complex_:function(t,e){const n=(0,a.YT)(t,"real","complex"),s=(0,a.YT)(e,"imag","complex");o.O3(n.shape,s.shape,"real and imag shapes, ".concat(n.shape," and ").concat(s.shape,", ")+"must match in call to tf.complex().");const c={real:n,imag:s};return r.T2.runKernel(i.pr3,c)}})},89360:(t,e,n)=>{"use strict";n.d(e,{x:()=>c});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(62503);const c=(0,n(26039).op)({concat_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,o.vA)(t.length>=1,(()=>"Pass at least one tensor to concat"));const n=(0,a.j1)(t,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((t=>{if("complex64"!==t.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(t.dtype,". "))})),1===n.length)return(0,s.o)(n[0]);const c=n,u={axis:e};return r.T2.runKernel(i.$dB,c,u)}})},65783:(t,e,n)=>{"use strict";n.d(e,{k:()=>u});var r=n(52863),i=n(23869),a=n(31880),o=n(157),s=n(26039),c=n(89068);const u=(0,s.op)({conv1d_:function(t,e,n,s){let u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,h=arguments.length>6?arguments[6]:void 0;const d=(0,r.YT)(t,"x","conv1d"),f=(0,r.YT)(e,"filter","conv1d");let p=d,g=!1;2===d.rank&&(g=!0,p=(0,c.t)(d,[1,d.shape[0],d.shape[1]])),i.vA(3===p.rank,(()=>"Error in conv1d: input must be rank 3, but got rank ".concat(p.rank,"."))),i.vA(3===f.rank,(()=>"Error in conv1d: filter must be rank 3, but got rank "+"".concat(f.rank,"."))),o.s_("conv1d",s,h),i.vA(p.shape[2]===f.shape[1],(()=>"Error in conv1d: depth of input (".concat(p.shape[2],") must match ")+"input depth for filter ".concat(f.shape[1],"."))),i.vA(o.G0(n,l),(()=>"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(l,"'"))),i.vA(o.qk(l),(()=>"Error in conv1D: Dilated rates should be larger than 0.")),i.vA(o.qk(n),(()=>"Error in conv1D: Stride should be larger than 0.")),i.vA("NWC"===u,(()=>"Error in conv1d: got dataFormat of ".concat(u," but only NWC is currently supported.")));const m=(0,c.t)(f,[1,f.shape[0],f.shape[1],f.shape[2]]),y=(0,c.t)(p,[p.shape[0],1,p.shape[1],p.shape[2]]),v=[1,n],b=[1,l],x=(0,a.X)(y,m,v,s,"NHWC",b,h);return g?(0,c.t)(x,[x.shape[2],x.shape[3]]):(0,c.t)(x,[x.shape[0],x.shape[2],x.shape[3]])}})},31880:(t,e,n)=>{"use strict";n.d(e,{X:()=>l});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(157),c=n(26039),u=n(89068);const l=(0,c.op)({conv2d_:function(t,e,n,c){let l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],d=arguments.length>6?arguments[6]:void 0;const f=(0,a.YT)(t,"x","conv2d","float32"),p=(0,a.YT)(e,"filter","conv2d","float32");let g=f,m=!1;3===f.rank&&(m=!0,g=(0,u.t)(f,[1,f.shape[0],f.shape[1],f.shape[2]])),o.vA(4===g.rank,(()=>"Error in conv2d: input must be rank 4, but got rank ".concat(g.rank,"."))),o.vA(4===p.rank,(()=>"Error in conv2d: filter must be rank 4, but got rank "+"".concat(p.rank,"."))),s.s_("conv2d",c,d);const y="NHWC"===l?g.shape[3]:g.shape[1];o.vA(y===p.shape[2],(()=>"Error in conv2d: depth of input (".concat(y,") must match ")+"input depth for filter ".concat(p.shape[2],"."))),o.vA(s.G0(n,h),(()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(h,"'"))),o.vA(s.qk(h),(()=>"Error in conv2D: Dilated rates should be larger than 0.")),o.vA(s.qk(n),(()=>"Error in conv2D: Strides should be larger than 0."));const v={x:g,filter:p},b={strides:n,pad:c,dataFormat:l,dilations:h,dimRoundingMode:d},x=r.T2.runKernel(i.p2J,v,b);return m?(0,u.t)(x,[x.shape[1],x.shape[2],x.shape[3]]):x}})},23458:(t,e,n)=>{"use strict";n.d(e,{H:()=>u});var r=n(37484),i=n(87311),a=n(23869),o=n(157),s=n(26039),c=n(89068);const u=(0,s.op)({conv2DBackpropFilter_:function(t,e,n,s,u){let l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",h=arguments.length>6?arguments[6]:void 0,d=t;3===t.rank&&(d=(0,c.t)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let f=e;3===f.rank&&(f=(0,c.t)(e,[1,e.shape[0],e.shape[1],e.shape[2]])),a.vA(4===d.rank,(()=>"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(d.shape,"."))),a.vA(4===f.rank,(()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(f.shape,"."))),a.vA(4===n.length,(()=>"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")));const p="NHWC"===l?d.shape[3]:d.shape[1],g="NHWC"===l?f.shape[3]:f.shape[1];a.vA(p===n[2],(()=>"Error in conv2dDerFilter: depth of input ".concat(p,") must ")+"match input depth in filter (".concat(n[2],"."))),a.vA(g===n[3],(()=>"Error in conv2dDerFilter: depth of dy (".concat(g,") must ")+"match output depth for filter (".concat(n[3],")."))),o.s_("conv2dDerFilter",u,h);const m={x:d,dy:f},y={strides:s,pad:u,dataFormat:l,dimRoundingMode:h,filterShape:n};return r.T2.runKernel(i.rFm,m,y)}})},51294:(t,e,n)=>{"use strict";n.d(e,{v:()=>u});var r=n(37484),i=n(87311),a=n(23869),o=n(157),s=n(26039),c=n(89068);const u=(0,s.op)({conv2DBackpropInput_:function(t,e,n,s,u){let l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",h=arguments.length>6?arguments[6]:void 0;a.vA(t.length===e.rank,(()=>"Length of inShape "+"(".concat(t.length,") and rank of dy (").concat(e.rank,") must match")));let d=t,f=e,p=!1;3===e.rank&&(p=!0,f=(0,c.t)(e,[1,e.shape[0],e.shape[1],e.shape[2]]),d=[1,t[0],t[1],t[2]]),a.vA(4===d.length,(()=>"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(d.length,"."))),a.vA(4===f.rank,(()=>"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(f.rank))),a.vA(4===n.rank,(()=>"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)));const g="NHWC"===l?d[3]:d[1],m="NHWC"===l?f.shape[3]:f.shape[1];a.vA(g===n.shape[2],(()=>"Error in conv2dDerInput: depth of input (".concat(g,") must ")+"match input depth for filter ".concat(n.shape[2],"."))),a.vA(m===n.shape[3],(()=>"Error in conv2dDerInput: depth of output (".concat(m,") must ")+"match output depth for filter ".concat(n.shape[3],"."))),o.s_("conv2dDerInput",u,h);const y={dy:f,filter:n},v={strides:s,pad:u,dataFormat:l,dimRoundingMode:h,inputShape:d},b=r.T2.runKernel(i.jfg,y,v);return p?(0,c.t)(b,[b.shape[1],b.shape[2],b.shape[3]]):b}})},80824:(t,e,n)=>{"use strict";n.d(e,{w:()=>a});var r=n(52863),i=n(51294);const a=(0,n(26039).op)({conv2dTranspose_:function(t,e,n,a,o,s){const c=(0,r.YT)(t,"x","conv2dTranspose"),u=(0,r.YT)(e,"filter","conv2dTranspose");return(0,i.v)(n,c,u,a,o,"NHWC",s)}})},20289:(t,e,n)=>{"use strict";n.d(e,{c:()=>c});var r=n(37484),i=n(87311),a=n(23869),o=n(26039),s=n(89068);const c=(0,o.op)({conv3DBackpropInput_:function(t,e,n,o,c){a.vA(t.length===e.rank,(()=>"Length of inShape "+"(".concat(t.length,") and rank of dy (").concat(e.rank,") must match")));let u=t,l=e,h=!1;4===e.rank&&(h=!0,l=(0,s.t)(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),u=[1,t[0],t[1],t[2],t[3]]);const d=u[4],f=l.shape[4];a.vA(5===u.length,(()=>"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(u.length,"."))),a.vA(5===l.rank,(()=>"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(l.rank))),a.vA(5===n.rank,(()=>"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank))),a.vA(d===n.shape[3],(()=>"Error in conv3dDerInput: depth of input (".concat(d,") must ")+"match input depth for filter ".concat(n.shape[3],"."))),a.vA(f===n.shape[4],(()=>"Error in conv3dDerInput: depth of output (".concat(f,") must ")+"match output depth for filter ".concat(n.shape[4],".")));const p={dy:l,filter:n},g={pad:c,strides:o,inputShape:u},m=r.T2.runKernel(i.gC7,p,g);return h?(0,s.t)(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}})},157:(t,e,n)=>{"use strict";n.d(e,{$Q:()=>y,Dh:()=>p,E6:()=>a,G0:()=>g,G8:()=>u,YQ:()=>i,l5:()=>o,p$:()=>c,qk:()=>m,s_:()=>v,uf:()=>s});var r=n(23869);function i(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",a=arguments.length>5?arguments[5]:void 0;return s(t,[...e,t[3]],n,a,r,null,null,y(i))}function a(t,e,n,r,i,a){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast";const[c,u]=l(e);let h;if("channelsLast"===o)h=[c,u,t[3],t[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));h=[c,u,t[1],t[1]]}return s(t,h,n,r,i,a,!1,o)}function o(t,e,n,r,i,a){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC";const[s,u,l]=h(e);let d,f;if("NDHWC"===o)f="channelsLast",d=[s,u,l,t[4],t[4]];else{if("NCDHW"!==o)throw new Error("Unknown dataFormat ".concat(o));f="channelsFirst",d=[s,u,l,t[1],t[1]]}return c(t,d,n,r,i,!1,f,a)}function s(t,e,n,r,i,a){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",[c,h,p,g]=[-1,-1,-1,-1];if("channelsLast"===s)[c,h,p,g]=t;else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));[c,g,h,p]=t}const[m,y,,v]=e,[b,x]=l(n),[w,k]=l(r),_=d(m,w),S=d(y,k),{padInfo:A,outHeight:C,outWidth:E}=function(t,e,n,r,i,a,o,s,c){let l,h,d;if("number"===typeof t){l={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};const i=function(t,e,n,r,i){null==r&&(r=u(t,e,n));const a=t[0],o=t[1],s=f((a-e+2*r)/n+1,i),c=f((o-e+2*r)/n+1,i);return[s,c]}([e,n],a,r,t,s);h=i[0],d=i[1]}else if("same"===t){h=Math.ceil(e/r),d=Math.ceil(n/i);const t=Math.max(0,(h-1)*r+a-e),s=Math.max(0,(d-1)*i+o-n),c=Math.floor(t/2),u=t-c,f=Math.floor(s/2);l={top:c,bottom:u,left:f,right:s-f,type:"SAME"}}else if("valid"===t)l={top:0,bottom:0,left:0,right:0,type:"VALID"},h=Math.ceil((e-a+1)/r),d=Math.ceil((n-o+1)/i);else{if("object"!==typeof t)throw Error("Unknown padding parameter: ".concat(t));{const u="channelsLast"===c?t[1][0]:t[2][0],p="channelsLast"===c?t[1][1]:t[2][1],g="channelsLast"===c?t[2][0]:t[3][0],m="channelsLast"===c?t[2][1]:t[3][1];l={top:u,bottom:p,left:g,right:m,type:0===u&&0===p&&0===g&&0===m?"VALID":"EXPLICIT"},h=f((e-a+u+p)/r+1,s),d=f((n-o+g+m)/i+1,s)}}return{padInfo:l,outHeight:h,outWidth:d}}(i,h,p,b,x,_,S,a,s),T=o?v*g:v;let N;return"channelsFirst"===s?N=[c,T,C,E]:"channelsLast"===s&&(N=[c,C,E,T]),{batchSize:c,dataFormat:s,inHeight:h,inWidth:p,inChannels:g,outHeight:C,outWidth:E,outChannels:T,padInfo:A,strideHeight:b,strideWidth:x,filterHeight:m,filterWidth:y,effectiveFilterHeight:_,effectiveFilterWidth:S,dilationHeight:w,dilationWidth:k,inShape:t,outShape:N,filterShape:e}}function c(t,e,n,r,i){let a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",s=arguments.length>7?arguments[7]:void 0,[c,l,p,g,m]=[-1,-1,-1,-1,-1];if("channelsLast"===o)[c,l,p,g,m]=t;else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));[c,m,l,p,g]=t}const[y,v,b,,x]=e,[w,k,_]=h(n),[S,A,C]=h(r),E=d(y,S),T=d(v,A),N=d(b,C),{padInfo:D,outDepth:F,outHeight:I,outWidth:M}=function(t,e,n,r,i,a,o,s,c,l,h){let d,p,g,m;"valid"===t&&(t=0);if("number"===typeof t){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};const y=function(t,e,n,r,i,a){null==i&&(i=u(t,e[0],r[0]));const o=[0,0,0,n];for(let s=0;s<3;s++)t[s]+2*i>=e[s]&&(o[s]=f((t[s]-e[s]+2*i)/r[s]+1,a));return o}([e,n,r,1],[s,c,l],1,[i,a,o],t,h);p=y[0],g=y[1],m=y[2]}else{if("same"!==t)throw Error("Unknown padding parameter: ".concat(t));{p=Math.ceil(e/i),g=Math.ceil(n/a),m=Math.ceil(r/o);const t=(p-1)*i+s-e,u=(g-1)*a+c-n,h=(m-1)*o+l-r,f=Math.floor(t/2),y=t-f,v=Math.floor(u/2),b=u-v,x=Math.floor(h/2);d={top:v,bottom:b,left:x,right:h-x,front:f,back:y,type:"SAME"}}}return{padInfo:d,outDepth:p,outHeight:g,outWidth:m}}(i,l,p,g,w,k,_,E,T,N,s),O=a?x*m:x;let R;return"channelsFirst"===o?R=[c,O,F,I,M]:"channelsLast"===o&&(R=[c,F,I,M,O]),{batchSize:c,dataFormat:o,inDepth:l,inHeight:p,inWidth:g,inChannels:m,outDepth:F,outHeight:I,outWidth:M,outChannels:O,padInfo:D,strideDepth:w,strideHeight:k,strideWidth:_,filterDepth:y,filterHeight:v,filterWidth:b,effectiveFilterDepth:E,effectiveFilterHeight:T,effectiveFilterWidth:N,dilationDepth:S,dilationHeight:A,dilationWidth:C,inShape:t,outShape:R,filterShape:e}}function u(t,e,n){const r=d(e,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1);return Math.floor((t[0]*(n-1)-n+r)/2)}function l(t){return"number"===typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function h(t){return"number"===typeof t?[t,t,t]:t}function d(t,e){return e<=1?t:t+(t-1)*(e-1)}function f(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode ".concat(e))}}function p(t){const[e,n,r]=l(t);return 1===e&&1===n&&1===r}function g(t,e){return p(t)||p(e)}function m(t){return l(t).every((t=>t>0))}function y(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(t))}function v(t,e,n){if(null!=n){if("string"===typeof e)throw Error("Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,"."));if("number"===typeof e)r.vA(r.E6(e),(()=>"Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,".")));else{if("object"!==typeof e)throw Error("Error in ".concat(t,": Unknown padding parameter: ").concat(e));e.forEach((e=>{e.forEach((e=>{r.vA(r.E6(e),(()=>"Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,".")))}))}))}}}},48133:(t,e,n)=>{"use strict";n.d(e,{g:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({cos_:function(t){const e={x:(0,a.YT)(t,"x","cos","float32")};return r.T2.runKernel(i.Mn0,e)}})},84033:(t,e,n)=>{"use strict";n.d(e,{y:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({cosh_:function(t){const e={x:(0,a.YT)(t,"x","cosh","float32")};return r.T2.runKernel(i.MnK,e)}})},79808:(t,e,n)=>{"use strict";n.d(e,{L:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({cumprod_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s={x:(0,a.YT)(t,"x","cumprod")},c={axis:e,exclusive:n,reverse:o};return r.T2.runKernel(i.jj_,s,c)}})},91482:(t,e,n)=>{"use strict";n.d(e,{r:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({cumsum_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s={x:(0,a.YT)(t,"x","cumsum")},c={axis:e,exclusive:n,reverse:o};return r.T2.runKernel(i.nY8,s,c)}})},89854:(t,e,n)=>{"use strict";n.d(e,{R:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({depthToSpace_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC";const s=(0,a.YT)(t,"x","depthToSpace","float32"),c="NHWC"===n?s.shape[1]:s.shape[2],u="NHWC"===n?s.shape[2]:s.shape[3],l="NHWC"===n?s.shape[3]:s.shape[1];o.vA(e>1,(()=>"blockSize should be > 1 for depthToSpace, but was: ".concat(e))),o.vA(c*e>=0,(()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(c," and ").concat(e,"  for depthToSpace with input shape\n    ").concat(s.shape))),o.vA(u*e>=0,(()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(u," and ").concat(e," for depthToSpace with input shape\n        ").concat(s.shape))),o.vA(l%(e*e)===0,(()=>"Dimension size must be evenly divisible by ".concat(e*e," but is ").concat(l," for depthToSpace with input shape ").concat(s.shape)));const h={x:s},d={blockSize:e,dataFormat:n};return r.T2.runKernel(i.TMz,h,d)}})},92302:(t,e,n)=>{"use strict";n.d(e,{G:()=>l});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(157),c=n(26039),u=n(89068);const l=(0,c.op)({depthwiseConv2d_:function(t,e,n,c){let l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],d=arguments.length>6?arguments[6]:void 0;const f=(0,a.YT)(t,"x","depthwiseConv2d","float32"),p=(0,a.YT)(e,"filter","depthwiseConv2d","float32");let g=f,m=!1;3===f.rank&&(m=!0,g=(0,u.t)(f,[1,f.shape[0],f.shape[1],f.shape[2]])),o.vA(4===g.rank,(()=>"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(g.rank,"."))),o.vA(4===p.rank,(()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(p.rank,".")));const y="NHWC"===l?g.shape[3]:g.shape[1];o.vA(y===p.shape[2],(()=>"Error in depthwiseConv2d: number of input channels "+"(".concat(y,") must match the inChannels dimension in ")+"filter ".concat(p.shape[2],"."))),s.s_("depthwiseConv2d",c,d);const v={x:g,filter:p},b={strides:n,pad:c,dataFormat:l,dilations:h,dimRoundingMode:d},x=r.T2.runKernel(i.tGH,v,b);return m?(0,u.t)(x,[x.shape[1],x.shape[2],x.shape[3]]):x}})},85408:(t,e,n)=>{"use strict";n.d(e,{x:()=>s});var r=n(37484),i=n(87311),a=n(26039),o=n(89068);const s=(0,a.op)({depthwiseConv2dNativeBackpropFilter_:function(t,e,n,a,s){let c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],u=arguments.length>6?arguments[6]:void 0,l=t;3===t.rank&&(l=(0,o.t)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let h=e;3===h.rank&&(h=(0,o.t)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const d={x:l,dy:h},f={strides:a,pad:s,dimRoundingMode:u,dilations:c,filterShape:n};return r.T2.runKernel(i.X$8,d,f)}})},59068:(t,e,n)=>{"use strict";n.d(e,{l:()=>s});var r=n(37484),i=n(87311),a=n(26039),o=n(89068);const s=(0,a.op)({depthwiseConv2dNativeBackpropInput_:function(t,e,n,a,s){let c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],u=arguments.length>6?arguments[6]:void 0,l=e,h=!1;3===e.rank&&(h=!0,l=(0,o.t)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const d={dy:l,filter:n},f={strides:a,pad:s,dimRoundingMode:u,dilations:c,inputShape:t},p=r.T2.runKernel(i.nVu,d,f);return h?(0,o.t)(p,[p.shape[1],p.shape[2],p.shape[3]]):p}})},14640:(t,e,n)=>{"use strict";n.d(e,{X:()=>u});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(26039),c=n(89068);const u=(0,s.op)({dilation2d_:function(t,e,n,s){let u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC";const h=(0,a.YT)(t,"x","dilation2d"),d=(0,a.YT)(e,"filter","dilation2d");o.vA(3===h.rank||4===h.rank,(()=>"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(h.rank,"."))),o.vA(3===d.rank,(()=>"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(d.rank,"."))),o.vA("NHWC"===l,(()=>"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(l)));let f=h,p=!1;3===h.rank&&(f=(0,c.t)(h,[1,h.shape[0],h.shape[1],h.shape[2]]),p=!0),o.vA(f.shape[3]===d.shape[2],(()=>"Error in dilation2d:  input and filter must have the same depth: ".concat(f.shape[3]," vs ").concat(d.shape[2])));const g={x:f,filter:d},m={strides:n,pad:s,dilations:u},y=r.T2.runKernel(i.jxD,g,m);return p?(0,c.t)(y,[y.shape[1],y.shape[2],y.shape[3]]):y}})},64113:(t,e,n)=>{"use strict";n.d(e,{y:()=>c});var r=n(37484),i=n(87311),a=n(48683),o=n(52863),s=n(64149);const c=(0,n(26039).op)({div_:function(t,e){let n=(0,o.YT)(t,"a","div"),c=(0,o.YT)(e,"b","div");if([n,c]=(0,a.makeTypesMatch)(n,c),"int32"===n.dtype&&"int32"===c.dtype)return(0,s.w)(n,c);const u={a:n,b:c};return r.T2.runKernel(i.sDr,u,{})}})},83645:(t,e,n)=>{"use strict";n.d(e,{e:()=>l});var r=n(48683),i=n(52863),a=n(64113),o=n(92138),s=n(26039),c=n(52117),u=n(90043);const l=(0,s.op)({divNoNan_:function(t,e){let n=(0,i.YT)(t,"a","div"),s=(0,i.YT)(e,"b","div");[n,s]=(0,r.makeTypesMatch)(n,s);const l=(0,a.y)(n,s),h=(0,u.P)(l),d=(0,o.L)(s,h);return(0,c._)(d,h,l)}})},33185:(t,e,n)=>{"use strict";n.d(e,{O:()=>c});var r=n(52863),i=n(23869),a=n(65849),o=n(26039),s=n(89068);const c=(0,o.op)({dot_:function(t,e){const n=(0,r.YT)(t,"t1","dot"),o=(0,r.YT)(e,"t2","dot");i.vA((1===n.rank||2===n.rank)&&(1===o.rank||2===o.rank),(()=>"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(o.rank,".")));const c=1===n.rank?n.size:n.shape[1],u=1===o.rank?o.size:o.shape[0];if(i.vA(c===u,(()=>"Error in dot: inner dimensions of inputs must match, but got "+"".concat(c," and ").concat(u,"."))),1===n.rank&&1===o.rank){const t=(0,s.t)(n,[1,-1]),e=(0,s.t)(o,[-1,1]),r=(0,a.N)(t,e);return(0,s.t)(r,[])}if(1===n.rank&&2===o.rank){const t=(0,s.t)(n,[1,-1]),e=(0,s.t)(o,[o.shape[0],o.shape[1]]),r=(0,a.N)(t,e);return(0,s.t)(r,[r.size])}if(2===n.rank&&1===o.rank){const t=(0,s.t)(o,[-1,1]),e=(0,a.N)(n,t);return(0,s.t)(e,[e.size])}{const t=(0,s.t)(o,[o.shape[0],o.shape[1]]);return(0,a.N)(n,t)}}})},62534:(t,e,n)=>{"use strict";n.d(e,{P:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({elu_:function(t){const e={x:(0,a.YT)(t,"x","elu","float32")};return r.T2.runKernel(i.Pah,e)}})},92138:(t,e,n)=>{"use strict";n.d(e,{L:()=>c});var r=n(37484),i=n(87311),a=n(48683),o=n(52863),s=n(84824);const c=(0,n(26039).op)({equal_:function(t,e){let n=(0,o.YT)(t,"a","equal","string_or_numeric"),c=(0,o.YT)(e,"b","equal","string_or_numeric");[n,c]=(0,a.makeTypesMatch)(n,c),(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);const u={a:n,b:c};return r.T2.runKernel(i.BRl,u)}})},47829:(t,e,n)=>{"use strict";n.d(e,{Y:()=>c});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(69779);const c=(0,n(26039).op)({erf_:function(t){let e=(0,a.YT)(t,"x","erf");o.vA("int32"===e.dtype||"float32"===e.dtype,(()=>"Input dtype must be `int32` or `float32`.")),"int32"===e.dtype&&(e=(0,s.w)(e,"float32"));const n={x:e};return r.T2.runKernel(i._s9,n)}})},13779:(t,e,n)=>{"use strict";n.d(e,{p:()=>i});var r=n(48306);const i=(0,n(26039).op)({euclideanNorm_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,r.x)(t,"euclidean",e,n)}})},48389:(t,e,n)=>{"use strict";n.d(e,{o:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({exp_:function(t){const e={x:(0,a.YT)(t,"x","exp")};return r.T2.runKernel(i.ox3,e)}})},70816:(t,e,n)=>{"use strict";n.d(e,{U:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({expandDims_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(0,a.YT)(t,"x","expandDims","string_or_numeric");o.vA(e<=n.rank,(()=>"Axis must be <= rank of the tensor"));const s={input:n},c={dim:e};return r.T2.runKernel(i.ybN,s,c)}})},54195:(t,e,n)=>{"use strict";n.d(e,{I:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({expm1_:function(t){const e={x:(0,a.YT)(t,"x","expm1")};return r.T2.runKernel(i.ybj,e)}})},99333:(t,e,n)=>{"use strict";n.d(e,{G:()=>o});var r=n(37484),i=n(87311),a=n(23869);function o(t,e,n){(0,a.SA)(t);const o={shape:t,value:e,dtype:n=n||(0,a.X$)(e)};return r.T2.runKernel(i.SQl,{},o)}},96812:(t,e,n)=>{"use strict";n.d(e,{R:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({floor_:function(t){const e={x:(0,a.YT)(t,"x","floor","float32")};return r.T2.runKernel(i.ZgB,e)}})},64149:(t,e,n)=>{"use strict";n.d(e,{w:()=>s});var r=n(37484),i=n(87311),a=n(48683),o=n(52863);const s=(0,n(26039).op)({floorDiv_:function(t,e){let n=(0,o.YT)(t,"a","floorDiv"),s=(0,o.YT)(e,"b","floorDiv");[n,s]=(0,a.makeTypesMatch)(n,s);const c={a:n,b:s};return r.T2.runKernel(i.ElG,c)}})},50511:(t,e,n)=>{"use strict";n.d(e,{k:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({gather_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const s={x:(0,a.YT)(t,"x","gather"),indices:(0,a.YT)(e,"indices","gather","int32")},c={axis:n,batchDims:o};return r.T2.runKernel(i.mxL,s,c)}})},60228:(t,e,n)=>{"use strict";n.d(e,{r:()=>c});var r=n(37484),i=n(87311),a=n(48683),o=n(52863),s=n(84824);const c=(0,n(26039).op)({greater_:function(t,e){let n=(0,o.YT)(t,"a","greater","string_or_numeric"),c=(0,o.YT)(e,"b","greater","string_or_numeric");[n,c]=(0,a.makeTypesMatch)(n,c),(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);const u={a:n,b:c};return r.T2.runKernel(i.XhZ,u)}})},39103:(t,e,n)=>{"use strict";n.d(e,{D:()=>c});var r=n(37484),i=n(87311),a=n(48683),o=n(52863),s=n(84824);const c=(0,n(26039).op)({greaterEqual_:function(t,e){let n=(0,o.YT)(t,"a","greaterEqual","string_or_numeric"),c=(0,o.YT)(e,"b","greaterEqual","string_or_numeric");[n,c]=(0,a.makeTypesMatch)(n,c),(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);const u={a:n,b:c};return r.T2.runKernel(i.lLS,u)}})},66758:(t,e,n)=>{"use strict";n.d(e,{n:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({imag_:function(t){const e={input:(0,a.YT)(t,"input","imag")};return r.T2.runKernel(i.dv8,e)}})},20537:(t,e,n)=>{"use strict";n.d(e,{v:()=>u});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(26039),c=n(89068);const u=(0,s.op)({resizeBilinear_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const u=(0,a.YT)(t,"images","resizeBilinear");o.vA(3===u.rank||4===u.rank,(()=>"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(u.rank,"."))),o.vA(2===e.length,(()=>"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(e,"."))),o.vA(!1===s||!1===n,(()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."));let l=u,h=!1;3===u.rank&&(h=!0,l=(0,c.t)(u,[1,u.shape[0],u.shape[1],u.shape[2]]));const[]=e,d={images:l},f={alignCorners:n,halfPixelCenters:s,size:e},p=r.T2.runKernel(i.hgw,d,f);return h?(0,c.t)(p,[p.shape[1],p.shape[2],p.shape[3]]):p}})},80828:(t,e,n)=>{"use strict";n.d(e,{b:()=>u});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(26039),c=n(89068);const u=(0,s.op)({resizeNearestNeighbor_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const u=(0,a.YT)(t,"images","resizeNearestNeighbor");o.vA(3===u.rank||4===u.rank,(()=>"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(u.rank,"."))),o.vA(2===e.length,(()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(e,"."))),o.vA("float32"===u.dtype||"int32"===u.dtype,(()=>"`images` must have `int32` or `float32` as dtype")),o.vA(!1===s||!1===n,(()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."));let l=u,h=!1;3===u.rank&&(h=!0,l=(0,c.t)(u,[1,u.shape[0],u.shape[1],u.shape[2]]));const[]=e,d={images:l},f={alignCorners:n,halfPixelCenters:s,size:e},p=r.T2.runKernel(i.jOE,d,f);return h?(0,c.t)(p,[p.shape[1],p.shape[2],p.shape[3]]):p}})},38660:(t,e,n)=>{"use strict";n.d(e,{M:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({isFinite_:function(t){const e={x:(0,a.YT)(t,"x","isFinite")};return r.T2.runKernel(i.gIW,e)}})},37304:(t,e,n)=>{"use strict";n.d(e,{E:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({isInf_:function(t){const e={x:(0,a.YT)(t,"x","isInf")};return r.T2.runKernel(i.E3$,e)}})},42310:(t,e,n)=>{"use strict";n.d(e,{y:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({isNaN_:function(t){const e={x:(0,a.YT)(t,"x","isNaN")};return r.T2.runKernel(i.iPs,e)}})},51965:(t,e,n)=>{"use strict";n.d(e,{H:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({leakyRelu_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2;const n={x:(0,a.YT)(t,"x","leakyRelu")},o={alpha:e};return r.T2.runKernel(i.X0$,n,o)}})},72969:(t,e,n)=>{"use strict";n.d(e,{M:()=>c});var r=n(37484),i=n(87311),a=n(48683),o=n(52863),s=n(84824);const c=(0,n(26039).op)({less_:function(t,e){let n=(0,o.YT)(t,"a","less","string_or_numeric"),c=(0,o.YT)(e,"b","less","string_or_numeric");[n,c]=(0,a.makeTypesMatch)(n,c),(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);const u={a:n,b:c};return r.T2.runKernel(i.mIA,u)}})},64210:(t,e,n)=>{"use strict";n.d(e,{I:()=>c});var r=n(37484),i=n(87311),a=n(48683),o=n(52863),s=n(84824);const c=(0,n(26039).op)({lessEqual_:function(t,e){let n=(0,o.YT)(t,"a","lessEqual","string_or_numeric"),c=(0,o.YT)(e,"b","lessEqual","string_or_numeric");[n,c]=(0,a.makeTypesMatch)(n,c),(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);const u={a:n,b:c};return r.T2.runKernel(i.CwD,u)}})},85593:(t,e,n)=>{"use strict";n.d(e,{K:()=>u});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(26039),c=n(89068);const u=(0,s.op)({localResponseNormalization_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;const l=(0,a.YT)(t,"x","localResponseNormalization");o.vA(4===l.rank||3===l.rank,(()=>"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(l.rank,"."))),o.vA(o.E6(e),(()=>"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(e,".")));let h=l,d=!1;3===l.rank&&(d=!0,h=(0,c.t)(l,[1,l.shape[0],l.shape[1],l.shape[2]]));const f={x:h},p={depthRadius:e,bias:n,alpha:s,beta:u},g=r.T2.runKernel(i.jM4,f,p);return d?(0,c.t)(g,[g.shape[1],g.shape[2],g.shape[3]]):g}})},18688:(t,e,n)=>{"use strict";n.d(e,{R:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({log_:function(t){const e={x:(0,a.YT)(t,"x","log","float32")};return r.T2.runKernel(i.tG8,e)}})},90781:(t,e,n)=>{"use strict";n.d(e,{K:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({log1p_:function(t){const e={x:(0,a.YT)(t,"x","log1p")};return r.T2.runKernel(i.Cg$,e)}})},34675:(t,e,n)=>{"use strict";n.d(e,{n:()=>l});var r=n(57832),i=n(52863),a=n(86272),o=n(5008),s=n(26039),c=n(1242),u=n(22824);const l=(0,s.op)({logSigmoid_:function(t){const e=(0,i.YT)(t,"x","logSigmoid");return(0,r._X)((t=>({value:(0,o.H)((0,u.l)((0,o.H)(t))),gradFunc:e=>(0,a.l)(e,(0,c.r)((0,o.H)(t)))})))(e)}})},8229:(t,e,n)=>{"use strict";n.d(e,{H:()=>f});var r=n(57832),i=n(52863),a=n(69779),o=n(48389),s=n(18688),c=n(73e3),u=n(86272),l=n(26039),h=n(77820),d=n(17937);const f=(0,l.op)({logSoftmax_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=(0,i.YT)(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(e));return(0,r._X)(((t,n)=>{const r=(0,c.T)(t,e,!0),i=(0,h.j)(t,r),l=(0,h.j)((0,a.w)(i,"float32"),(0,s.R)((0,d.c)((0,o.o)(i),e,!0)));n([l]);return{value:l,gradFunc:(t,n)=>{const[r]=n,i=(0,o.o)(r);return(0,h.j)(t,(0,u.l)((0,d.c)(t,e,!0),i))}}}))(n)}})},45492:(t,e,n)=>{"use strict";n.d(e,{V:()=>p});var r=n(52863),i=n(23869),a=n(67281),o=n(58724),s=n(48389),c=n(18688),u=n(73e3),l=n(26039),h=n(89068),d=n(77820),f=n(17937);const p=(0,l.op)({logSumExp_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const l=(0,r.YT)(t,"x","logSumExp"),p=(0,i.Y6)(e,l.shape),g=(0,u.T)(l,p,!0),m=(0,d.j)(l,g),y=(0,s.o)(m),v=(0,f.c)(y,p),b=(0,c.R)(v),x=(0,a.W)((0,h.t)(g,b.shape),b);if(n){const t=(0,o.SM)(x.shape,p);return(0,h.t)(x,t)}return x}})},21183:(t,e,n)=>{"use strict";n.d(e,{n:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(84824);const s=(0,n(26039).op)({logicalAnd_:function(t,e){const n=(0,a.YT)(t,"a","logicalAnd","bool"),s=(0,a.YT)(e,"b","logicalAnd","bool");(0,o.assertAndGetBroadcastShape)(n.shape,s.shape);const c={a:n,b:s};return r.T2.runKernel(i.RUm,c)}})},87375:(t,e,n)=>{"use strict";n.d(e,{N:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({logicalNot_:function(t){const e={x:(0,a.YT)(t,"x","logicalNot","bool")};return r.T2.runKernel(i.nZd,e)}})},65497:(t,e,n)=>{"use strict";n.d(e,{z:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(84824);const s=(0,n(26039).op)({logicalOr_:function(t,e){const n=(0,a.YT)(t,"a","logicalOr","bool"),s=(0,a.YT)(e,"b","logicalOr","bool");(0,o.assertAndGetBroadcastShape)(n.shape,s.shape);const c={a:n,b:s};return r.T2.runKernel(i.LXA,c)}})},6699:(t,e,n)=>{"use strict";n.d(e,{r:()=>c});var r=n(52863),i=n(84824),a=n(21183),o=n(87375),s=n(65497);const c=(0,n(26039).op)({logicalXor_:function(t,e){const n=(0,r.YT)(t,"a","logicalXor","bool"),c=(0,r.YT)(e,"b","logicalXor","bool");return(0,i.assertAndGetBroadcastShape)(n.shape,c.shape),(0,a.n)((0,s.z)(t,e),(0,o.N)((0,a.n)(t,e)))}})},65849:(t,e,n)=>{"use strict";n.d(e,{N:()=>s});var r=n(37484),i=n(87311),a=n(48683),o=n(52863);const s=(0,n(26039).op)({matMul_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=(0,o.YT)(t,"a","matMul"),u=(0,o.YT)(e,"b","matMul");[c,u]=(0,a.makeTypesMatch)(c,u);const l={a:c,b:u},h={transposeA:n,transposeB:s};return r.T2.runKernel(i.jAQ,l,h)}})},73e3:(t,e,n)=>{"use strict";n.d(e,{T:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({max_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o={x:(0,a.YT)(t,"x","max")},s={reductionIndices:e,keepDims:n};return r.T2.runKernel(i.VAI,o,s)}})},8853:(t,e,n)=>{"use strict";n.d(e,{j:()=>l});var r=n(37484),i=n(87311),a=n(52863),o=n(23869),s=n(157),c=n(26039),u=n(89068);const l=(0,c.op)({maxPool_:function(t,e,n,c,l){const h=(0,a.YT)(t,"x","maxPool");let d=h,f=!1;3===h.rank&&(f=!0,d=(0,u.t)(h,[1,h.shape[0],h.shape[1],h.shape[2]])),o.vA(4===d.rank,(()=>"Error in maxPool: input must be rank 4 but got rank ".concat(d.rank,"."))),o.vA(s.G0(n,1),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'"))),s.s_("maxPool",c,l);const p={x:d},g={filterSize:e,strides:n,pad:c,dimRoundingMode:l},m=r.T2.runKernel(i.t3d,p,g);return f?(0,u.t)(m,[m.shape[1],m.shape[2],m.shape[3]]):m}})},98104:(t,e,n)=>{"use strict";n.d(e,{P:()=>u});var r=n(37484),i=n(87311),a=n(48683),o=n(52863),s=n(84824),c=n(69779);const u=(0,n(26039).op)({maximum_:function(t,e){let n=(0,o.YT)(t,"a","maximum"),u=(0,o.YT)(e,"b","maximum");[n,u]=(0,a.makeTypesMatch)(n,u),"bool"===n.dtype&&(n=(0,c.w)(n,"int32"),u=(0,c.w)(u,"int32")),(0,s.assertAndGetBroadcastShape)(n.shape,u.shape);const l={a:n,b:u};return r.T2.runKernel(i.LDN,l)}})},49577:(t,e,n)=>{"use strict";n.d(e,{i:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({mean_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o={x:(0,a.YT)(t,"x","mean")},s={axis:e,keepDims:n};return r.T2.runKernel(i.g5A,o,s)}})},60278:(t,e,n)=>{"use strict";n.d(e,{j:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({min_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o={x:(0,a.YT)(t,"x","min")},s={axis:e,keepDims:n};return r.T2.runKernel(i.lNG,o,s)}})},91086:(t,e,n)=>{"use strict";n.d(e,{B:()=>u});var r=n(37484),i=n(87311),a=n(48683),o=n(52863),s=n(84824),c=n(69779);const u=(0,n(26039).op)({minimum_:function(t,e){let n=(0,o.YT)(t,"a","minimum"),u=(0,o.YT)(e,"b","minimum");[n,u]=(0,a.makeTypesMatch)(n,u),"bool"===n.dtype&&(n=(0,c.w)(n,"int32"),u=(0,c.w)(u,"int32")),(0,s.assertAndGetBroadcastShape)(n.shape,u.shape);const l={a:n,b:u};return r.T2.runKernel(i.LG0,l)}})},32509:(t,e,n)=>{"use strict";n.d(e,{F:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({mirrorPad_:function(t,e,n){o.vA("reflect"===n||"symmetric"===n,(()=>"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,".")));const s=(0,a.YT)(t,"x","mirrorPad");if(0===s.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");o.vA(e.length===s.rank,(()=>"Padding doesn't match input. Must be ".concat(s.rank,". ")+"Got ".concat(e.length,".")));const c="reflect"===n?1:0;for(let r=0;r<s.rank;r++)o.vA(2===e[r].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),o.vA(e[r][0]>=0&&e[r][0]<=s.shape[r]-c&&e[r][1]>=0&&e[r][1]<=s.shape[r]-c,(()=>"Padding in dimension ".concat(r," cannot be greater than or equal ")+"to ".concat(s.shape[r]-c," or less than 0 for input of ")+"shape ".concat(s.shape)));const u={paddings:e,mode:n},l={x:s};return r.T2.runKernel(i.x7F,l,u)}})},5634:(t,e,n)=>{"use strict";n.d(e,{z:()=>s});var r=n(37484),i=n(87311),a=n(48683),o=n(52863);const s=(0,n(26039).op)({mod_:function(t,e){let n=(0,o.YT)(t,"a","mod"),s=(0,o.YT)(e,"b","mod");[n,s]=(0,a.makeTypesMatch)(n,s);const c={a:n,b:s};return r.T2.runKernel(i.BLA,c)}})},86272:(t,e,n)=>{"use strict";n.d(e,{l:()=>s});var r=n(37484),i=n(87311),a=n(48683),o=n(52863);const s=(0,n(26039).op)({mul_:function(t,e){let n=(0,o.YT)(t,"a","mul"),s=(0,o.YT)(e,"b","mul");[n,s]=(0,a.makeTypesMatch)(n,s);const c={a:n,b:s};return r.T2.runKernel(i.xu7,c)}})},5008:(t,e,n)=>{"use strict";n.d(e,{H:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({neg_:function(t){const e={x:(0,a.YT)(t,"x","neg")};return r.T2.runKernel(i.l0G,e)}})},48306:(t,e,n)=>{"use strict";n.d(e,{x:()=>y});var r=n(52863),i=n(23869),a=n(59470),o=n(58724),s=n(73e3),c=n(60278),u=n(26039),l=n(78188),h=n(89068),d=n(90844),f=n(45766),p=n(95195),g=n(17937);function m(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===t.rank)return(0,a.t)(t);if(1!==t.rank&&null===n)return m((0,h.t)(t,[-1]),e,n);if(1===t.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===e)return(0,g.c)((0,a.t)(t),n);if(e===1/0)return(0,s.T)((0,a.t)(t),n);if(e===-1/0)return(0,c.j)((0,a.t)(t),n);if("euclidean"===e||2===e)return(0,f.R)((0,g.c)((0,l.n)((0,a.t)(t),(0,d.d)(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(e))}if(Array.isArray(n)&&2===n.length){if(1===e)return(0,s.T)((0,g.c)((0,a.t)(t),n[0]),n[1]-1);if(e===1/0)return(0,s.T)((0,g.c)((0,a.t)(t),n[1]),n[0]);if(e===-1/0)return(0,c.j)((0,g.c)((0,a.t)(t),n[1]),n[0]);if("fro"===e||"euclidean"===e)return(0,f.R)((0,g.c)((0,p.E)(t),n));throw new Error("Error in norm: invalid ord value: ".concat(e))}throw new Error("Error in norm: invalid axis: ".concat(n))}const y=(0,u.op)({norm_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=m(t=(0,r.YT)(t,"x","norm"),e,n);let c=s.shape;if(a){const e=(0,i.Y6)(n,t.shape);c=o.SM(s.shape,e)}return(0,h.t)(s,c)}})},73848:(t,e,n)=>{"use strict";n.d(e,{E:()=>c});var r=n(37484),i=n(87311),a=n(48683),o=n(52863),s=n(84824);const c=(0,n(26039).op)({notEqual_:function(t,e){let n=(0,o.YT)(t,"a","notEqual","string_or_numeric"),c=(0,o.YT)(e,"b","notEqual","string_or_numeric");[n,c]=(0,a.makeTypesMatch)(n,c),(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);const u={a:n,b:c};return r.T2.runKernel(i.ylV,u)}})},48926:(t,e,n)=>{"use strict";n.d(e,{M:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({oneHot_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"int32";if(e<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(e));const c={indices:(0,a.YT)(t,"indices","oneHot","int32")},u={dtype:s,depth:e,onValue:n,offValue:o};return r.T2.runKernel(i.urI,c,u)}})},88865:(t,e,n)=>{"use strict";n.d(e,{S:()=>s});var r=n(37484),i=n(23869),a=n(76234),o=n(38197);function s(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if((0,i.SA)(t),"complex64"===e){const e=s(t,"float32"),n=(0,o.U)(t,"float32");return(0,a.f)(e,n)}const n=(0,i.FZ)((0,i.Ze)(t),e);return r.T2.makeTensor(n,t,e)}},98903:(t,e,n)=>{"use strict";n.d(e,{P:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({onesLike_:function(t){const e={x:(0,a.YT)(t,"x","onesLike")};return r.T2.runKernel(i.LWX,e)}})},26039:(t,e,n)=>{"use strict";n.d(e,{B:()=>a,op:()=>o});var r=n(37484),i=n(23869);const a="__op";function o(t){const e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(e.length," keys."));let n=e[0];const o=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=a;const s=function(){r.T2.startScope(n);try{const t=o(...arguments);return(0,i.yL)(t)&&console.error("Cannot return a Promise inside of tidy."),r.T2.endScope(t),t}catch(t){throw r.T2.endScope(null),t}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}},67507:(t,e,n)=>{"use strict";n.d(e,{e:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({pad_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=(0,a.YT)(t,"x","pad");if(0===o.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:n},c={x:o};return r.T2.runKernel(i.ODT,c,s)}})},18570:(t,e,n)=>{"use strict";n.d(e,{d:()=>d});var r=n(52863),i=n(23869),a=n(70963),o=n(81406),s=n(157),c=n(8853),u=n(26039),l=n(89068),h=n(90602);const d=(0,u.op)({pool_:function(t,e,n,u,d,f,p){null==d&&(d=[1,1]),null==f&&(f=1),0===u&&(u="valid");const g=(0,r.YT)(t,"x","maxPool");let m=g,y=!1;3===g.rank&&(y=!0,m=(0,l.t)(g,[1,g.shape[0],g.shape[1],g.shape[2]])),i.vA(s.G0(f,d),(()=>"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(f," and dilations '").concat(d,"'")));const v=s.E6(m.shape,e,f,d,u),b=[v.dilationHeight,v.dilationWidth];let x;x="same"===u?function(t,e){const n=t.map(((t,n)=>t+(t-1)*(e[n]-1))),r=n.map((t=>t-1)),i=r.map((t=>Math.floor(t/2))),a=r.map(((t,e)=>t-i[e]));return r.map(((t,e)=>[i[e],a[e]]))}([v.filterHeight,v.filterWidth],b):[[0,0],[0,0]];const w=1===b[0]&&1===b[1],[k,_]=function(t,e,n){const r=n.map((t=>t[0])),i=n.map((t=>t[1])),a=t.concat(r,i),o=e.map(((t,e)=>(t-a[e]%t)%t)),s=i.map(((t,e)=>t+o[e])),c=e.map(((t,e)=>[r[e],s[e]])),u=e.map(((t,e)=>[0,o[e]]));return[c,u]}([v.inHeight,v.inWidth],b,x),S=w?u:"valid",A=w?m:(0,h.e)(m,b,k),C=("avg"===n?()=>(0,a.$)(A,e,f,S,p):()=>(0,c.j)(A,e,f,S,p))(),E=w?C:(0,o.G)(C,b,_);return y?(0,l.t)(E,[E.shape[1],E.shape[2],E.shape[3]]):E}})},78188:(t,e,n)=>{"use strict";n.d(e,{n:()=>s});var r=n(37484),i=n(87311),a=n(48683),o=n(52863);const s=(0,n(26039).op)({pow_:function(t,e){let n=(0,o.YT)(t,"base","pow"),s=(0,o.YT)(e,"exp","pow");[n,s]=(0,a.makeTypesMatch)(n,s);const c={a:n,b:s};return r.T2.runKernel(i.pyJ,c)}})},83860:(t,e,n)=>{"use strict";n.d(e,{N:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({prelu_:function(t,e){const n={x:(0,a.YT)(t,"x","prelu"),alpha:(0,a.YT)(e,"alpha","prelu")};return r.T2.runKernel(i.Ncv,n)}})},30629:(t,e,n)=>{"use strict";function r(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(t.toString(e))}n.d(e,{y:()=>r})},38517:(t,e,n)=>{"use strict";n.d(e,{_:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(69779);const s=(0,n(26039).op)({prod_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=(0,a.YT)(t,"x","prod");"bool"===s.dtype&&(s=(0,o.w)(s,"int32"));const c={x:s},u={axis:e,keepDims:n};return r.T2.runKernel(i.kdj,c,u)}})},86372:(t,e,n)=>{"use strict";n.d(e,{x:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({real_:function(t){const e={input:(0,a.YT)(t,"input","real")};return r.T2.runKernel(i.LRy,e)}})},95868:(t,e,n)=>{"use strict";n.d(e,{V:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({reciprocal_:function(t){const e={x:(0,a.YT)(t,"x","reciprocal")};return r.T2.runKernel(i.huO,e)}})},38414:(t,e,n)=>{"use strict";n.d(e,{V:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({relu_:function(t){const e={x:(0,a.YT)(t,"x","relu")};return r.T2.runKernel(i.fUj,e)}})},6650:(t,e,n)=>{"use strict";n.d(e,{j:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({relu6_:function(t){const e={x:(0,a.YT)(t,"x","relu6")};return r.T2.runKernel(i.P_L,e)}})},89068:(t,e,n)=>{"use strict";n.d(e,{t:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({reshape_:function(t,e){const n={x:(0,a.YT)(t,"x","reshape","string_or_numeric")},o={shape:e};return r.T2.runKernel(i.R23,n,o)}})},23540:(t,e,n)=>{"use strict";n.d(e,{B:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({reverse_:function(t,e){const n={x:(0,a.YT)(t,"x","reverse")},o={dims:e};return r.T2.runKernel(i.D7i,n,o)}})},16242:(t,e,n)=>{"use strict";n.d(e,{L:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({round_:function(t){const e={x:(0,a.YT)(t,"x","round")};return r.T2.runKernel(i.hVg,e)}})},30414:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({rsqrt_:function(t){const e={x:(0,a.YT)(t,"x","rsqrt","float32")};return r.T2.runKernel(i.TOR,e)}})},90844:(t,e,n)=>{"use strict";n.d(e,{d:()=>a});var r=n(73837),i=n(47921);function a(t,e){if(((0,r.isTypedArray)(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&(0,r.isTypedArray)(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return(0,i.Q)(t,[],[],e)}},52203:(t,e,n)=>{"use strict";n.d(e,{W:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({selu_:function(t){const e={x:(0,a.YT)(t,"x","selu")};return r.T2.runKernel(i.u$b,e)}})},84102:(t,e,n)=>{"use strict";n.d(e,{X:()=>i,j:()=>r});const r=1.7580993408473768,i=1.0507009873554805},848:(t,e,n)=>{"use strict";n.d(e,{w:()=>u});var r=n(52863),i=n(23869),a=n(31880),o=n(92302),s=n(26039),c=n(89068);const u=(0,s.op)({separableConv2d_:function(t,e,n,s,u){let l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC";const d=(0,r.YT)(t,"x","separableConv2d"),f=(0,r.YT)(e,"depthwiseFilter","separableConv2d"),p=(0,r.YT)(n,"pointwiseFilter","separableConv2d");let g=d,m=!1;if(3===d.rank&&(m=!0,g=(0,c.t)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),"NCHW"===h)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");i.vA(4===g.rank,(()=>"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(g.rank,"."))),i.vA(4===f.rank,(()=>"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(f.rank,"."))),i.vA(4===p.rank,(()=>"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(f.rank,"."))),i.vA(1===p.shape[0],(()=>"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(p.shape[0],"."))),i.vA(1===p.shape[1],(()=>"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(p.shape[1],".")));const y=f.shape[2],v=f.shape[3];i.vA(p.shape[2]===y*v,(()=>"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(y*v,", ")+"but got ".concat(p.shape[2],".")));const b=(0,o.G)(g,f,s,u,h,l),x=(0,a.X)(b,p,1,"valid",h);return m?(0,c.t)(x,[x.shape[1],x.shape[2],x.shape[3]]):x}})},1242:(t,e,n)=>{"use strict";n.d(e,{r:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({sigmoid_:function(t){const e={x:(0,a.YT)(t,"x","sigmoid","float32")};return r.T2.runKernel(i.vI1,e)}})},5601:(t,e,n)=>{"use strict";n.d(e,{_:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({sign_:function(t){const e={x:(0,a.YT)(t,"x","sign")};return r.T2.runKernel(i.YVe,e)}})},85956:(t,e,n)=>{"use strict";n.d(e,{F:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({sin_:function(t){const e={x:(0,a.YT)(t,"x","sin","float32")};return r.T2.runKernel(i.hql,e)}})},15990:(t,e,n)=>{"use strict";n.d(e,{L:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({sinh_:function(t){const e={x:(0,a.YT)(t,"x","sinh")};return r.T2.runKernel(i.J3C,e)}})},8016:(t,e,n)=>{"use strict";n.d(e,{d:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({slice_:function(t,e,n){const o=(0,a.YT)(t,"x","slice","string_or_numeric");if(0===o.rank)throw new Error("Slicing scalar is not possible");const s={x:o},c={begin:e,size:n};return r.T2.runKernel(i.JiE,s,c)}})},48791:(t,e,n)=>{"use strict";n.r(e),n.d(e,{assertParamsValid:()=>o,computeFlatOffset:()=>b,computeOutShape:()=>c,getNormalizedAxes:()=>d,isSliceContinous:()=>v,maskToAxes:()=>s,parseSliceParams:()=>x,sliceInfo:()=>w,startForAxis:()=>m,startIndicesWithElidedDims:()=>f,stopForAxis:()=>y,stopIndicesWithElidedDims:()=>p,stridesForAxis:()=>g,stridesWithElidedDims:()=>u});var r=n(23869);const i=-2,a=-1;function o(t,e,n){const i=t.shape.length;r.vA(i===e.length,(()=>"Error in slice".concat(i,"D: Length of begin ").concat(e," must ")+"match the rank of the array (".concat(i,")."))),r.vA(i===n.length,(()=>"Error in slice".concat(i,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(i,").")));for(let a=0;a<i;++a)r.vA(e[a]+n[a]<=t.shape[a],(()=>"Error in slice".concat(i,"D: begin[").concat(a,"] + size[").concat(a,"] ")+"(".concat(e[a]+n[a],") would overflow input.shape[").concat(a,"] (").concat(t.shape[a],")")))}function s(t){const e=[];let n=0;for(;t>0;)1&t&&e.push(n),t/=2,n++;return e}function c(t,e,n){const r=[];for(let i=0;i<t.length;i++)r[i]=Math.ceil((e[i]-t[i])/n[i]);return r}function u(t,e,n,r){const i=[...t];for(let a=i.length;a<r.length;a++)i.push(1);for(let a=0;a<n;a++)0===a?i[e]=1:(i.splice(e,0,1),i.pop());return i}function l(t,e,n){return n<=t?n:n-(e-1)}function h(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function d(t,e,n,r,i,a,o,s,c){const l=t.length;let h=new Array(l),d=new Array(l),v=new Array(l);if(e.length&&n>0){const c=e[0],l=n+1;h=f(o,c,l,r,t),d=p(s,c,l,i,t),v=u(a,c,l,t)}else for(let u=0;u<l;u++)h[u]=m(o,r,a,t,u,c),d[u]=y(s,i,a,t,u,c),v[u]=g(a,u,c);return{begin:h,end:d,strides:v}}function f(t,e,n,r,i){const a=[...i],o=h(n,e);for(let s=0;s<a.length;s++)if(o.indexOf(s)>-1)a[s]=0;else{const i=l(e,n,s);let o=r[i];t&1<<i&&(o=0),a[s]=o}return a}function p(t,e,n,i,a){const o=[...a],s=h(n,e);for(let r=0;r<o.length;r++)if(s.indexOf(r)>-1)o[r]=Number.MAX_SAFE_INTEGER;else{const a=l(e,n,r);let s=i[a];t&1<<a&&(s=Number.MAX_SAFE_INTEGER),o[r]=s}for(let c=0;c<o.length;c++){const t=a[c];o[c]<0&&(o[c]+=t),o[c]=r.qE(0,o[c],a[c])}return o}function g(t,e,n){let r=t[e];return(n&1<<e||null==r)&&(r=1),r}function m(t,e,n,i,a,o){let s=e[a];const c=n[a]||1;(t&1<<a||o&1<<a||null==s)&&(s=c>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const u=i[a];return s<0&&(s+=u),s=r.qE(0,s,u-1),s}function y(t,e,n,i,a,o){let s=e[a];const c=n[a]||1;(t&1<<a||o&1<<a||null==s)&&(s=c>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const u=i[a];return s<0&&(s+=u),s=c>0?r.qE(0,s,u):r.qE(-1,s,u-1),s}function v(t,e,n){let r=n.length;for(let i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(let i=r+1;i<n.length;i++)if(e[i]>0||n[i]!==t[i])return!1;return!0}function b(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function x(t,e,n){let i;const a=t.shape.length;let o;return i="number"===typeof e?[e,...new Array(a-1).fill(0)]:e.length<a?e.concat(new Array(a-e.length).fill(0)):e.slice(),i.forEach((t=>{r.vA(-1!==t,(()=>"slice() does not support negative begin indexing."))})),o=null==n?new Array(a).fill(-1):"number"===typeof n?[n,...new Array(a-1).fill(-1)]:n.length<a?n.concat(new Array(a-n.length).fill(-1)):n,o=o.map(((e,n)=>e>=0?e:(r.vA(-1===e,(()=>"Negative size values should be exactly -1 but got "+"".concat(e," for the slice() size at index ").concat(n,"."))),t.shape[n]-i[n]))),[i,o]}function w(t,e,n,r,o,s,c,u,l){let h;if(null==r?(h=new Array(e.length),h.fill(1)):h=r,null!=c&&0!==(c&c-1))throw new Error("Multiple ellipses in slice is not allowed.");let d=!1;const f={dims:h.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:h.slice(),beginMask:o,endMask:s,ellipsisMask:c,newAxisMask:u,shrinkAxisMask:l};for(let i=0;i<f.dims;i++)d&&0!==(1<<i&u)&&f.numAddAxisAfterEllipsis++,1<<i&c&&(d=!0);d||(f.ellipsisMask|=1<<f.dims,f.dims++);const p={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=null!=t.begin,e.endValid=null!=t.end,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const i=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<i;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(i),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error("Index out of range using input dim ".concat(n,"; input ")+"has only ".concat(e.dims," dims, ").concat(e.begin.length,"."));null!=t.begin&&(e.begin[n]=t.begin[r]),null!=t.end&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(a),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}(f,p);let g=!0,m=!0,y=!0;const v=[],b=[];for(let i=0;i<t.length;++i){if(0===p.strides[i])throw Error("strides[".concat(i,"] must be non-zero"));const e=!!(p.shrinkAxisMask&1<<i),n=t[i];if(-1===n){v.push(e?1:-1);continue}const r=[p.beginMask&1<<i,p.endMask&1<<i],a=[p.strides[i]>0?0:-1,p.strides[i]>0?n:n-1];if(e&&p.strides[i]<=0)throw Error("only stride 1 allowed on non-range indexing.");y=y&&1===p.strides[i];const o=!!(p.beginMask&1<<i&&p.endMask&1<<i);if(p.beginValid&&p.endValid){if(e){const t=p.begin[i]<0?n+p.begin[i]:p.begin[i];if(p.begin[i]=t,p.end[i]=p.begin[i]+1,t<0||t>=n)throw Error("slice index ".concat(p.begin[i]," of dimension ").concat(i," out of bounds."))}else p.begin[i]=k(p.begin[i],0,p.strides[i],n,r,a),p.end[i]=k(p.end[i],1,p.strides[i],n,r,a);const t=1===p.strides[i]&&0===p.begin[i]&&p.end[i]===n;g=g&&t,m=m&&(0===i&&1===p.strides[i]||t)}else g=g&&1===p.strides[i]&&o,m=m&&(0===i&&1===p.strides[i]||o);let s,c=!1;if(p.beginValid&&p.endValid?(s=p.end[i]-p.begin[i],c=!0):e?(s=1,c=!0):o&&n>=0&&(s=p.strides[i]<0?-n:n,c=!0),c){let t;t=0===s||s<0!==p.strides[i]<0?0:Math.trunc(s/p.strides[i])+(s%p.strides[i]!==0?1:0),v.push(t)}else v.push(-1)}for(let a=0;a<p.finalShapeGatherIndices.length;++a){const t=p.finalShapeGatherIndices[a];t>=0?b.push(v[t]):t===i&&b.push(1)}return{finalShapeSparse:b.filter(((t,e)=>p.finalShapeGatherIndices[e]!==i)),finalShape:b,isIdentity:g,sliceDim0:m,isSimpleSlice:y,begin:p.begin,end:p.end,strides:p.strides}}function k(t,e,n,r,i,a){if(i[e])return n>0?a[e]:a[e+1&1];{const e=t<0?r+t:t;return e<a[0]?a[0]:e>a[1]?a[1]:e}}},80724:(t,e,n)=>{"use strict";n.d(e,{V:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({softmax_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=(0,a.YT)(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(e));const o={logits:n},s={dim:e};return r.T2.runKernel(i.rFG,o,s)}})},22824:(t,e,n)=>{"use strict";n.d(e,{l:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({softplus_:function(t){const e={x:(0,a.YT)(t,"x","softplus")};return r.T2.runKernel(i.Fin,e)}})},90602:(t,e,n)=>{"use strict";n.d(e,{e:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({spaceToBatchND_:function(t,e,n){const s=(0,a.YT)(t,"x","spaceToBatchND");o.vA(s.rank>=1+e.length,(()=>"input rank ".concat(s.rank," should be > than [blockShape] ").concat(e.length))),o.vA(n.length===e.length,(()=>"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(e.length))),o.vA(s.shape.reduce(((t,r,i)=>i>0&&i<=e.length?t&&(r+n[i-1][0]+n[i-1][1])%e[i-1]===0:t),!0),(()=>"input spatial dimensions ".concat(s.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(e.toString())));const c={x:s},u={blockShape:e,paddings:n};return r.T2.runKernel(i.A8B,c,u)}})},42587:(t,e,n)=>{"use strict";n.d(e,{h:()=>o});var r=n(37484),i=n(87311),a=n(23869);const o=(0,n(26039).op)({fft_:function(t){(0,a.vA)("complex64"===t.dtype,(()=>"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(t.dtype,".")));const e={input:t};return r.T2.runKernel(i.rGP,e)}})},93674:(t,e,n)=>{"use strict";n.d(e,{K:()=>o});var r=n(37484),i=n(87311),a=n(23869);const o=(0,n(26039).op)({ifft_:function(t){(0,a.vA)("complex64"===t.dtype,(()=>"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(t.dtype,".")));const e={input:t};return r.T2.runKernel(i.OAQ,e)}})},30890:(t,e,n)=>{"use strict";n.d(e,{g:()=>p});var r=n(76234),i=n(89360),a=n(66758),o=n(86272),s=n(26039),c=n(86372),u=n(89068),l=n(23540),h=n(90844),d=n(8016),f=n(93674);const p=(0,s.op)({irfft_:function(t){const e=t.shape[t.shape.length-1],n=t.size/e;let s;if(e<=2){const r=(0,u.t)(t,[n,e]);s=(0,f.K)(r)}else{const p=[n,2*(e-1)],g=(0,u.t)((0,c.x)(t),[n,e]),m=(0,u.t)((0,a.n)(t),[n,e]),y=(0,l.B)((0,d.d)(g,[0,1],[n,e-2]),1),v=(0,o.l)((0,l.B)((0,d.d)(m,[0,1],[n,e-2]),1),(0,h.d)(-1)),b=(0,i.x)([g,y],1),x=(0,i.x)([m,v],1),w=(0,u.t)((0,r.f)(b,x),[p[0],p[1]]);s=(0,f.K)(w)}if(s=(0,c.x)(s),3===t.rank&&0!==t.shape[0]){const e=s,n=t.shape[0];s=(0,u.t)(s,[n,s.shape[0]/n,s.shape[1]]),e.dispose()}return s}})},35721:(t,e,n)=>{"use strict";n.d(e,{z:()=>g});var r=n(23869),i=n(76234),a=n(89360),o=n(66758),s=n(26039),c=n(86372),u=n(89068),l=n(8016),h=n(77554),d=n(38197),f=n(90043),p=n(42587);const g=(0,s.op)({rfft_:function(t,e){(0,r.vA)("float32"===t.dtype,(()=>"The dtype for rfft() must be real value but got ".concat(t.dtype)));let n=t.shape[t.shape.length-1];const s=t.size/n;let g;if(null!=e&&e<n){const r=t.shape.map((t=>0)),i=t.shape.map((t=>t));i[t.shape.length-1]=e,g=(0,l.d)(t,r,i),n=e}else if(null!=e&&e>n){const r=t.shape.map((t=>t));r[t.shape.length-1]=e-n,g=(0,a.x)([t,(0,d.U)(r)],t.shape.length-1),n=e}else g=t;const m=(0,f.P)(g),y=(0,u.t)((0,i.f)(g,m),[s,n]),v=(0,p.h)(y),b=Math.floor(n/2)+1,x=(0,c.x)(v),w=(0,o.n)(v),k=(0,h.l)(x,[b,n-b],x.shape.length-1),_=(0,h.l)(w,[b,n-b],w.shape.length-1),S=g.shape.slice();return S[g.shape.length-1]=b,(0,u.t)((0,i.f)(k[0],_[0]),S)}})},77554:(t,e,n)=>{"use strict";n.d(e,{l:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({split_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o={x:(0,a.YT)(t,"x","split")},s={numOrSizeSplits:e,axis:n};return r.T2.runKernel(i.Blb,o,s)}})},45766:(t,e,n)=>{"use strict";n.d(e,{R:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({sqrt_:function(t){const e={x:(0,a.YT)(t,"x","sqrt","float32")};return r.T2.runKernel(i.dFH,e)}})},95195:(t,e,n)=>{"use strict";n.d(e,{E:()=>a});var r=n(37484),i=n(52863);const a=(0,n(26039).op)({square_:function(t){const e=(0,i.YT)(t,"x","square");return r.T2.runKernel("Square",{x:e},{})}})},77189:(t,e,n)=>{"use strict";n.d(e,{P:()=>c});var r=n(37484),i=n(87311),a=n(48683),o=n(52863),s=n(84824);const c=(0,n(26039).op)({squaredDifference_:function(t,e){let n=(0,o.YT)(t,"a","squaredDifference"),c=(0,o.YT)(e,"b","squaredDifference");[n,c]=(0,a.makeTypesMatch)(n,c),(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);const u={a:n,b:c};return r.T2.runKernel(i.Ddj,u,{})}})},2330:(t,e,n)=>{"use strict";n.d(e,{r:()=>s});var r=n(52863),i=n(23869),a=n(26039),o=n(89068);const s=(0,a.op)({squeeze_:function(t,e){const n=(0,r.YT)(t,"x","squeeze","string_or_numeric");return(0,o.t)(n,(0,i.gx)(n.shape,e).newShape)}})},22190:(t,e,n)=>{"use strict";n.d(e,{t:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({stack_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(0,a.j1)(t,"tensors","stack","string_or_numeric");o.vA(n.length>=1,(()=>"Pass at least one tensor to tf.stack")),n.length>0&&o.vA(e<=n[0].rank,(()=>"Axis must be <= rank of the tensor"));const s=n,c={axis:e};return r.T2.runKernel(i.mM$,s,c)}})},52946:(t,e,n)=>{"use strict";n.d(e,{P:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({step_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:(0,a.YT)(t,"x","step")},o={alpha:e};return r.T2.runKernel(i.pnw,n,o)}})},57136:(t,e,n)=>{"use strict";n.d(e,{Y:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({stridedSlice_:function(t,e,n,o){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;const d={x:(0,a.YT)(t,"x","stridedSlice","string_or_numeric")},f={begin:e,end:n,strides:o,beginMask:s,endMask:c,ellipsisMask:u,newAxisMask:l,shrinkAxisMask:h};return r.T2.runKernel(i.UcO,d,f)}})},77820:(t,e,n)=>{"use strict";n.d(e,{j:()=>s});var r=n(37484),i=n(87311),a=n(48683),o=n(52863);const s=(0,n(26039).op)({sub_:function(t,e){let n=(0,o.YT)(t,"a","sub"),s=(0,o.YT)(e,"b","sub");[n,s]=(0,a.makeTypesMatch)(n,s);const c={a:n,b:s};return r.T2.runKernel(i.PbM,c)}})},17937:(t,e,n)=>{"use strict";n.d(e,{c:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(69779);const s=(0,n(26039).op)({sum_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=(0,a.YT)(t,"x","sum");"bool"===s.dtype&&(s=(0,o.w)(s,"int32"));const c={x:s},u={axis:e,keepDims:n};return r.T2.runKernel(i.WuN,c,u)}})},66465:(t,e,n)=>{"use strict";n.d(e,{M:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({tan_:function(t){const e={x:(0,a.YT)(t,"x","tan","float32")};return r.T2.runKernel(i.oFs,e)}})},47173:(t,e,n)=>{"use strict";n.d(e,{y:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({tanh_:function(t){const e={x:(0,a.YT)(t,"x","tanh","float32")};return r.T2.runKernel(i.iuW,e)}})},98869:(t,e,n)=>{"use strict";n.d(e,{O:()=>a});var r=n(52863),i=n(47921);function a(t,e,n){const a=(0,r.MZ)(t,n);return(0,i.Q)(t,e,a,n)}},47921:(t,e,n)=>{"use strict";n.d(e,{Q:()=>s});var r=n(37484),i=n(15188),a=n(23869),o=n(73837);function s(t,e,n,s){if(null==s)s=(0,a.X$)(t);else if("complex64"===s)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if((0,i.Nw)(t)||(0,i.Oj)(t)){if("float32"!==s&&"int32"!==s)throw new Error("Creating tensor from GPU data only supports "+"'float32'|'int32' dtype, while the dtype is ".concat(s,"."));return r.T2.backend.createTensorFromGPUData(t,e||n,s)}if(!(0,o.isTypedArray)(t)&&!Array.isArray(t)&&"number"!==typeof t&&"boolean"!==typeof t&&"string"!==typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){(0,a.SA)(e);const t=(0,a.Ze)(e),r=(0,a.Ze)(n);(0,a.vA)(t===r,(()=>"Based on the provided shape, [".concat(e,"], the tensor should have ")+"".concat(t," values but has ").concat(r)));for(let i=0;i<n.length;++i){const t=n[i],r=i!==n.length-1||t!==(0,a.Ze)(e.slice(i));(0,a.vA)(n[i]===e[i]||!r,(()=>"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(e,"). ")))}}return(0,o.isTypedArray)(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==s?(0,o.toTypedArray)(t,s):(0,o.flatten)(t,[],!0),r.T2.makeTensor(t,e,s)}},35716:(t,e,n)=>{"use strict";n.d(e,{V:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({tile_:function(t,e){const n=(0,a.YT)(t,"x","tile","string_or_numeric");o.vA(n.rank===e.length,(()=>"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(e,".")));const s={x:n},c={reps:e};return r.T2.runKernel(i.FAs,s,c)}})},87984:(t,e,n)=>{"use strict";n.d(e,{r:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({topk_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=(0,a.YT)(t,"x","topk");if(0===o.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const s=o.shape[o.shape.length-1];if(e<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(e));if(e>s)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(s,") ")+"but got ".concat(e));const c={x:o},u={k:e,sorted:n},[l,h]=r.T2.runKernel(i.TBb,c,u);return{values:l,indices:h}}})},15977:(t,e,n)=>{"use strict";n.d(e,{m:()=>f});var r=n(37484),i=n(23129),a=n(87311),o=n(52863),s=n(23869),c=n(76234),u=n(66758),l=n(5008),h=n(26039),d=n(86372);const f=(0,h.op)({transpose_:function(t,e,n){const h=(0,o.YT)(t,"x","transpose");if(null==e&&(e=h.shape.map(((t,e)=>e)).reverse()),s.vA(h.rank===e.length,(()=>"Error in transpose: rank of input ".concat(h.rank," ")+"must match length of perm ".concat(e,"."))),e.forEach((t=>{s.vA(t>=0&&t<h.rank,(()=>"All entries in 'perm' must be between 0 and ".concat(h.rank-1)+" but got ".concat(e)))})),h.rank<=1)return h.clone();const f={x:h},p={perm:e};return"complex64"===h.dtype?(0,i.DZ)((()=>{let t=(0,d.x)(h),e=(0,u.n)(h);return t=r.T2.runKernel(a.wx0,{x:t},p),e=r.T2.runKernel(a.wx0,{x:e},p),n&&(e=(0,l.H)(e)),(0,c.f)(t,e)})):r.T2.runKernel(a.wx0,f,p)}})},68583:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({unique_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(0,a.YT)(t,"x","unique","string_or_numeric");(0,o.vA)(n.rank>0,(()=>"The input tensor must be at least 1D"));const s={x:n},c={axis:e},[u,l]=r.T2.runKernel(i.EwU,s,c);return{values:u,indices:l}}})},66788:(t,e,n)=>{"use strict";n.d(e,{z:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({unsortedSegmentSum_:function(t,e,n){const s=(0,a.YT)(t,"x","unsortedSegmentSum"),c=(0,a.YT)(e,"segmentIds","unsortedSegmentSum","int32");(0,o.vA)((0,o.E6)(n),(()=>"numSegments must be of dtype int"));const u={x:s,segmentIds:c},l={numSegments:n};return r.T2.runKernel(i.pPe,u,l)}})},84491:(t,e,n)=>{"use strict";n.d(e,{K:()=>s});var r=n(37484),i=n(87311),a=n(52863),o=n(23869);const s=(0,n(26039).op)({unstack_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(0,a.YT)(t,"x","unstack","string_or_numeric");o.vA(e>=-n.shape.length&&e<n.shape.length,(()=>"Axis = ".concat(e," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")));const s={value:n},c={axis:e};return r.T2.runKernel(i.dXR,s,c)}})},52117:(t,e,n)=>{"use strict";n.d(e,{_:()=>c});var r=n(37484),i=n(87311),a=n(52863),o=n(99965),s=n(84824);const c=(0,n(26039).op)({where_:function(t,e,n){const c=(0,a.YT)(e,"a","where"),u=(0,a.YT)(n,"b","where"),l=(0,a.YT)(t,"condition","where","bool"),h=(0,s.assertAndGetBroadcastShape)((0,s.assertAndGetBroadcastShape)(l.shape,c.shape),u.shape),d={condition:(0,o.h)(l,h),t:(0,o.h)(c,h),e:(0,o.h)(u,h)};return r.T2.runKernel(i.l6P,d)}})},38197:(t,e,n)=>{"use strict";n.d(e,{U:()=>o});var r=n(37484),i=n(23869),a=n(76234);function o(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if((0,i.SA)(t),"complex64"===e){const e=o(t,"float32"),n=o(t,"float32");return(0,a.f)(e,n)}const n=(0,i.Ty)((0,i.Ze)(t),e);return r.T2.makeTensor(n,t,e)}},90043:(t,e,n)=>{"use strict";n.d(e,{P:()=>o});var r=n(37484),i=n(87311),a=n(52863);const o=(0,n(26039).op)({zerosLike_:function(t){const e={x:(0,a.YT)(t,"x","zerosLike")};return r.T2.runKernel(i.xJ3,e)}})},52342:(t,e,n)=>{"use strict";n.d(e,{K:()=>d});var r=n(37484),i=n(23129),a=n(67281),o=n(64113),s=n(86272),c=n(45766),u=n(95195),l=n(90043),h=n(59777);class d extends h.E{static get className(){return"Adadelta"}constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(),this.learningRate=t,this.rho=e,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=r.T2.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const h=r.T2.registeredVariables[e];null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:"".concat(e,"/accum_grad"),variable:(0,i.DZ)((()=>(0,l.P)(h).variable(false)))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:"".concat(e,"/accum_var"),variable:(0,i.DZ)((()=>(0,l.P)(h).variable(false)))});const d=Array.isArray(t)?t[n].tensor:t[e];if(null==d)return;const f=this.accumulatedGrads[n].variable,p=this.accumulatedUpdates[n].variable;(0,i.DZ)((()=>{const t=(0,a.W)((0,s.l)(f,this.rho),(0,s.l)((0,u.E)(d),1-this.rho)),e=(0,s.l)((0,o.y)((0,c.R)((0,a.W)(p,this.epsilon)),(0,c.R)((0,a.W)(f,this.epsilon))),d),n=(0,a.W)((0,s.l)(p,this.rho),(0,s.l)((0,u.E)(e),1-this.rho));f.assign(t),p.assign(n);const r=(0,a.W)((0,s.l)(e,-this.learningRate),h);h.assign(r)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&((0,i.AS)(this.accumulatedGrads.map((t=>t.variable))),(0,i.AS)(this.accumulatedUpdates.map((t=>t.variable))))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){const e=(t=await this.extractIterations(t)).length/2;this.accumulatedGrads=t.slice(0,e).map((t=>({originalName:t.name,variable:t.tensor.variable(false)}))),this.accumulatedUpdates=t.slice(e,2*e).map((t=>({originalName:t.name,variable:t.tensor.variable(false)})))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.rho,e.epsilon)}}},51662:(t,e,n)=>{"use strict";n.d(e,{a:()=>d});var r=n(37484),i=n(23129),a=n(67281),o=n(64113),s=n(99333),c=n(86272),u=n(45766),l=n(95195),h=n(59777);class d extends h.E{static get className(){return"Adagrad"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;super(),this.learningRate=t,this.initialAccumulatorValue=e,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const h=r.T2.registeredVariables[e];if(null==this.accumulatedGrads[n]){const t=!1;this.accumulatedGrads[n]={originalName:"".concat(e,"/accumulator"),variable:(0,i.DZ)((()=>(0,s.G)(h.shape,this.initialAccumulatorValue).variable(t)))}}const d=Array.isArray(t)?t[n].tensor:t[e];if(null==d)return;const f=this.accumulatedGrads[n].variable;(0,i.DZ)((()=>{const t=(0,a.W)(f,(0,l.E)(d));f.assign(t);const e=(0,a.W)((0,c.l)((0,o.y)(d,(0,u.R)((0,a.W)(t,r.T2.backend.epsilon()))),-this.learningRate),h);h.assign(e)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&(0,i.AS)(this.accumulatedGrads.map((t=>t.variable)))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t);this.accumulatedGrads=t.map((t=>({originalName:t.name,variable:t.tensor.variable(false)})))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,e){return new t(e.learningRate,e.initialAccumulatorValue)}}},19527:(t,e,n)=>{"use strict";n.d(e,{F:()=>g});var r=n(37484),i=n(23129),a=n(67281),o=n(64113),s=n(86272),c=n(78188),u=n(90844),l=n(45766),h=n(95195),d=n(77820),f=n(90043),p=n(59777);class g extends p.E{static get className(){return"Adam"}constructor(t,e,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=a,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],(0,i.DZ)((()=>{this.accBeta1=(0,u.d)(e).variable(),this.accBeta2=(0,u.d)(n).variable()})),null==a&&(this.epsilon=r.T2.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);(0,i.DZ)((()=>{const n=(0,d.j)(1,this.accBeta1),c=(0,d.j)(1,this.accBeta2);e.forEach(((e,u)=>{const d=r.T2.registeredVariables[e];null==this.accumulatedFirstMoment[u]&&(this.accumulatedFirstMoment[u]={originalName:"".concat(e,"/m"),variable:(0,i.DZ)((()=>(0,f.P)(d).variable(false)))}),null==this.accumulatedSecondMoment[u]&&(this.accumulatedSecondMoment[u]={originalName:"".concat(e,"/v"),variable:(0,i.DZ)((()=>(0,f.P)(d).variable(false)))});const p=Array.isArray(t)?t[u].tensor:t[e];if(null==p)return;const g=this.accumulatedFirstMoment[u].variable,m=this.accumulatedSecondMoment[u].variable,y=(0,a.W)((0,s.l)(g,this.beta1),(0,s.l)(p,1-this.beta1)),v=(0,a.W)((0,s.l)(m,this.beta2),(0,s.l)((0,h.E)(p),1-this.beta2)),b=(0,o.y)(y,n),x=(0,o.y)(v,c);g.assign(y),m.assign(v);const w=(0,a.W)((0,s.l)((0,o.y)(b,(0,a.W)((0,l.R)(x),this.epsilon)),-this.learningRate),d);d.assign(w)})),this.accBeta1.assign((0,s.l)(this.accBeta1,this.beta1)),this.accBeta2.assign((0,s.l)(this.accBeta2,this.beta2))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&(0,i.AS)(this.accumulatedFirstMoment.map((t=>t.variable))),null!=this.accumulatedSecondMoment&&(0,i.AS)(this.accumulatedSecondMoment.map((t=>t.variable)))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t),(0,i.DZ)((()=>{this.accBeta1.assign((0,c.n)(this.beta1,this.iterations_+1)),this.accBeta2.assign((0,c.n)(this.beta2,this.iterations_+1))}));const e=t.length/2;this.accumulatedFirstMoment=t.slice(0,e).map((t=>({originalName:t.name,variable:t.tensor.variable(false)}))),this.accumulatedSecondMoment=t.slice(e,2*e).map((t=>({originalName:t.name,variable:t.tensor.variable(false)})))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)}}},74190:(t,e,n)=>{"use strict";n.d(e,{o:()=>p});var r=n(37484),i=n(23129),a=n(59470),o=n(67281),s=n(64113),c=n(98104),u=n(86272),l=n(90844),h=n(77820),d=n(90043),f=n(59777);class p extends f.E{static get className(){return"Adamax"}constructor(t,e,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=a,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],(0,i.DZ)((()=>{this.iteration=(0,l.d)(0).variable(),this.accBeta1=(0,l.d)(e).variable()})),null==a&&(this.epsilon=r.T2.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);(0,i.DZ)((()=>{const n=(0,h.j)(1,this.accBeta1),i=(0,s.y)(-this.learningRate,(0,o.W)((0,u.l)(this.iteration,this.decay),1));e.forEach(((e,l)=>{const h=r.T2.registeredVariables[e];null==this.accumulatedFirstMoment[l]&&(this.accumulatedFirstMoment[l]={originalName:"".concat(e,"/m"),variable:(0,d.P)(h).variable(false)}),null==this.accumulatedWeightedInfNorm[l]&&(this.accumulatedWeightedInfNorm[l]={originalName:"".concat(e,"/v"),variable:(0,d.P)(h).variable(false)});const f=Array.isArray(t)?t[l].tensor:t[e];if(null==f)return;const p=this.accumulatedFirstMoment[l].variable,g=this.accumulatedWeightedInfNorm[l].variable,m=(0,o.W)((0,u.l)(p,this.beta1),(0,u.l)(f,1-this.beta1)),y=(0,u.l)(g,this.beta2),v=(0,a.t)(f),b=(0,c.P)(y,v);p.assign(m),g.assign(b);const x=(0,o.W)((0,u.l)((0,s.y)(i,n),(0,s.y)(m,(0,o.W)(b,this.epsilon))),h);h.assign(x)})),this.iteration.assign((0,o.W)(this.iteration,1)),this.accBeta1.assign((0,u.l)(this.accBeta1,this.beta1))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&(0,i.AS)(this.accumulatedFirstMoment.map((t=>t.variable))),null!=this.accumulatedWeightedInfNorm&&(0,i.AS)(this.accumulatedWeightedInfNorm.map((t=>t.variable)))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)}}},59490:(t,e,n)=>{"use strict";n.d(e,{Q:()=>l});var r=n(37484),i=n(23129),a=n(67281),o=n(86272),s=n(90844),c=n(90043),u=n(67060);class l extends u.S{static get className(){return"Momentum"}constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(t),this.learningRate=t,this.momentum=e,this.useNesterov=n,this.accumulations=[],this.m=(0,s.d)(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const s=r.T2.registeredVariables[e];if(null==this.accumulations[n]){const t=!1;this.accumulations[n]={originalName:"".concat(e,"/momentum"),variable:(0,i.DZ)((()=>(0,c.P)(s).variable(t)))}}const u=this.accumulations[n].variable,l=Array.isArray(t)?t[n].tensor:t[e];null!=l&&(0,i.DZ)((()=>{let t;const e=(0,a.W)((0,o.l)(this.m,u),l);t=this.useNesterov?(0,a.W)((0,o.l)(this.c,(0,a.W)(l,(0,o.l)(e,this.m))),s):(0,a.W)((0,o.l)(this.c,e),s),u.assign(e),s.assign(t)}))})),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&(0,i.AS)(this.accumulations.map((t=>t.variable)))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t);this.accumulations=t.map((t=>({originalName:t.name,variable:t.tensor.variable(false)})))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)}}},59777:(t,e,n)=>{"use strict";n.d(e,{E:()=>s});var r=n(23129),i=n(57832),a=n(90844),o=n(50581);class s extends o.Serializable{minimize(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;const{value:i,grads:a}=this.computeGradients(t,n);if(null!=n){const t=n.map((t=>({name:t.name,tensor:a[t.name]})));this.applyGradients(t)}else this.applyGradients(a);return(0,r.AS)(a),e?i:(i.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,e){return(0,i.y7)(t,e)}dispose(){null!=this.iterations_&&(0,r.AS)(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:(0,a.d)(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()))}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(s,Symbol.hasInstance,{value:t=>null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients})},20940:(t,e,n)=>{"use strict";n.d(e,{i:()=>d});var r=n(52342),i=n(51662),a=n(19527),o=n(74190),s=n(59490),c=n(95241),u=n(67060),l=n(50581);const h=[r.K,i.a,a.F,o.o,s.Q,c.P,u.S];function d(){for(const t of h)(0,l.registerClass)(t)}},95241:(t,e,n)=>{"use strict";n.d(e,{P:()=>f});var r=n(37484),i=n(23129),a=n(67281),o=n(64113),s=n(86272),c=n(45766),u=n(95195),l=n(77820),h=n(90043),d=n(59777);class f extends d.E{static get className(){return"RMSProp"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(super(),this.learningRate=t,this.decay=e,this.momentum=n,this.epsilon=i,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,null==i&&(this.epsilon=r.T2.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const d=r.T2.registeredVariables[e],f=!1;null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:"".concat(e,"/rms"),variable:(0,i.DZ)((()=>(0,h.P)(d).variable(f)))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:"".concat(e,"/momentum"),variable:(0,i.DZ)((()=>(0,h.P)(d).variable(f)))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:"".concat(e,"/mg"),variable:(0,i.DZ)((()=>(0,h.P)(d).variable(f)))});const p=Array.isArray(t)?t[n].tensor:t[e];if(null==p)return;const g=this.accumulatedMeanSquares[n].variable,m=this.accumulatedMoments[n].variable;(0,i.DZ)((()=>{const t=(0,a.W)((0,s.l)(g,this.decay),(0,s.l)((0,u.E)(p),1-this.decay));if(this.centered){const e=this.accumulatedMeanGrads[n].variable,r=(0,a.W)((0,s.l)(e,this.decay),(0,s.l)(p,1-this.decay)),i=(0,o.y)((0,s.l)(p,this.learningRate),(0,c.R)((0,l.j)(t,(0,a.W)((0,u.E)(r),this.epsilon)))),h=(0,a.W)((0,s.l)(m,this.momentum),i);g.assign(t),e.assign(r),m.assign(h);const f=(0,l.j)(d,h);d.assign(f)}else{const t=(0,a.W)((0,s.l)(g,this.decay),(0,s.l)((0,u.E)(p),1-this.decay)),e=(0,a.W)((0,s.l)(m,this.momentum),(0,o.y)((0,s.l)(p,this.learningRate),(0,c.R)((0,a.W)(t,this.epsilon))));g.assign(t),m.assign(e);const n=(0,l.j)(d,e);d.assign(n)}}))})),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&(0,i.AS)(this.accumulatedMeanSquares.map((t=>t.variable))),null!=this.accumulatedMeanGrads&&this.centered&&(0,i.AS)(this.accumulatedMeanGrads.map((t=>t.variable))),null!=this.accumulatedMoments&&(0,i.AS)(this.accumulatedMoments.map((t=>t.variable)))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t);const e=this.centered?t.length/3:t.length/2,n=!1;this.accumulatedMeanSquares=t.slice(0,e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)}))),this.accumulatedMoments=t.slice(e,2*e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)}))),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)}))))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)}}},67060:(t,e,n)=>{"use strict";n.d(e,{S:()=>u});var r=n(37484),i=n(23129),a=n(67281),o=n(86272),s=n(90844),c=n(59777);class u extends c.E{static get className(){return"SGD"}constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const s=Array.isArray(t)?t[n].tensor:t[e];if(null==s)return;const c=r.T2.registeredVariables[e];(0,i.DZ)((()=>{const t=(0,a.W)((0,o.l)(this.c,s),c);c.assign(t)}))})),this.incrementIterations()}setLearningRate(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=(0,i.aC)((0,s.d)(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(0!==(t=await this.extractIterations(t)).length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,e){return new t(e.learningRate)}}},84634:(t,e,n)=>{"use strict";function r(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}n.d(e,{Y:()=>r})},58914:(t,e,n)=>{"use strict";n.r(e);var r=n(59470),i=n(90739);(0,i.tp)().prototype.abs=function(){return this.throwIfDisposed(),(0,r.t)(this)};var a=n(75090);(0,i.tp)().prototype.acos=function(){return this.throwIfDisposed(),(0,a.H)(this)};var o=n(34528);(0,i.tp)().prototype.acosh=function(){return this.throwIfDisposed(),(0,o.F)(this)};var s=n(67281);(0,i.tp)().prototype.add=function(t){return this.throwIfDisposed(),(0,s.W)(this,t)};var c=n(86465);(0,i.tp)().prototype.all=function(t,e){return this.throwIfDisposed(),(0,c.Q)(this,t,e)};var u=n(25552);(0,i.tp)().prototype.any=function(t,e){return this.throwIfDisposed(),(0,u.b)(this,t,e)};var l=n(31003);(0,i.tp)().prototype.argMax=function(t){return this.throwIfDisposed(),(0,l.F)(this,t)};var h=n(72345);(0,i.tp)().prototype.argMin=function(t){return this.throwIfDisposed(),(0,h.X)(this,t)};var d=n(89068),f=n(23869);(0,i.tp)().prototype.asScalar=function(){return this.throwIfDisposed(),(0,f.vA)(1===this.size,(()=>"The array must have only 1 element.")),(0,d.t)(this,[])};var p=n(69779);(0,i.tp)().prototype.asType=function(t){return this.throwIfDisposed(),(0,p.w)(this,t)},(0,i.tp)().prototype.as1D=function(){return this.throwIfDisposed(),(0,d.t)(this,[this.size])},(0,i.tp)().prototype.as2D=function(t,e){return this.throwIfDisposed(),(0,d.t)(this,[t,e])},(0,i.tp)().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),(0,d.t)(this,[t,e,n])},(0,i.tp)().prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),(0,d.t)(this,[t,e,n,r])},(0,i.tp)().prototype.as5D=function(t,e,n,r,i){return this.throwIfDisposed(),(0,d.t)(this,[t,e,n,r,i])};var g=n(50155);(0,i.tp)().prototype.asin=function(){return this.throwIfDisposed(),(0,g.q)(this)};var m=n(94467);(0,i.tp)().prototype.asinh=function(){return this.throwIfDisposed(),(0,m.y)(this)};var y=n(16802);(0,i.tp)().prototype.atan=function(){return this.throwIfDisposed(),(0,y.r)(this)};var v=n(67986);(0,i.tp)().prototype.atan2=function(t){return this.throwIfDisposed(),(0,v.F)(this,t)};var b=n(68080);(0,i.tp)().prototype.atanh=function(){return this.throwIfDisposed(),(0,b.r)(this)};var x=n(70963);(0,i.tp)().prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),(0,x.$)(this,t,e,n,r)};var w=n(81406);(0,i.tp)().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),(0,w.G)(this,t,e)};var k=n(26670);(0,i.tp)().prototype.batchNorm=function(t,e,n,r,i){return this.throwIfDisposed(),(0,k.$)(this,t,e,n,r,i)};var _=n(99965);(0,i.tp)().prototype.broadcastTo=function(t){return this.throwIfDisposed(),(0,_.h)(this,t)},(0,i.tp)().prototype.cast=function(t){return this.throwIfDisposed(),(0,p.w)(this,t)};var S=n(33989);(0,i.tp)().prototype.ceil=function(){return this.throwIfDisposed(),(0,S.m)(this)};var A=n(68042);(0,i.tp)().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),(0,A.z)(this,t,e)};var C=n(89360);(0,i.tp)().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof i.qY&&(t=[t]),(0,C.x)([this,...t],e)};var E=n(65783);(0,i.tp)().prototype.conv1d=function(t,e,n,r,i,a){return this.throwIfDisposed(),(0,E.k)(this,t,e,n,r,i,a)};var T=n(80824);(0,i.tp)().prototype.conv2dTranspose=function(t,e,n,r,i){return this.throwIfDisposed(),(0,T.w)(this,t,e,n,r,i)};var N=n(31880);(0,i.tp)().prototype.conv2d=function(t,e,n,r,i,a){return this.throwIfDisposed(),(0,N.X)(this,t,e,n,r,i,a)};var D=n(48133);(0,i.tp)().prototype.cos=function(){return this.throwIfDisposed(),(0,D.g)(this)};var F=n(84033);(0,i.tp)().prototype.cosh=function(){return this.throwIfDisposed(),(0,F.y)(this)};var I=n(79808);(0,i.tp)().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),(0,I.L)(this,t,e,n)};var M=n(91482);(0,i.tp)().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),(0,M.r)(this,t,e,n)};var O=n(89854);(0,i.tp)().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),(0,O.R)(this,t,e)};var R=n(92302);(0,i.tp)().prototype.depthwiseConv2d=function(t,e,n,r,i,a){return this.throwIfDisposed(),(0,R.G)(this,t,e,n,r,i,a)};var z=n(14640);(0,i.tp)().prototype.dilation2d=function(t,e,n,r,i){return this.throwIfDisposed(),(0,z.X)(this,t,e,n,r,i)};var B=n(83645);(0,i.tp)().prototype.divNoNan=function(t){return this.throwIfDisposed(),(0,B.e)(this,t)};var L=n(64113);(0,i.tp)().prototype.div=function(t){return this.throwIfDisposed(),(0,L.y)(this,t)};var P=n(33185);(0,i.tp)().prototype.dot=function(t){return this.throwIfDisposed(),(0,P.O)(this,t)};var j=n(62534);(0,i.tp)().prototype.elu=function(){return this.throwIfDisposed(),(0,j.P)(this)};var U=n(92138);(0,i.tp)().prototype.equal=function(t){return this.throwIfDisposed(),(0,U.L)(this,t)};var W=n(47829);(0,i.tp)().prototype.erf=function(){return this.throwIfDisposed(),(0,W.Y)(this)};var V=n(13779);(0,i.tp)().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),(0,V.p)(this,t,e)};var q=n(48389);(0,i.tp)().prototype.exp=function(){return this.throwIfDisposed(),(0,q.o)(this)};var G=n(70816);(0,i.tp)().prototype.expandDims=function(t){return this.throwIfDisposed(),(0,G.U)(this,t)};var H=n(54195);(0,i.tp)().prototype.expm1=function(){return this.throwIfDisposed(),(0,H.I)(this)};var Y=n(42587);(0,i.tp)().prototype.fft=function(){return this.throwIfDisposed(),(0,Y.h)(this)},(0,i.tp)().prototype.flatten=function(){return this.throwIfDisposed(),(0,d.t)(this,[this.size])};var X=n(96812);(0,i.tp)().prototype.floor=function(){return this.throwIfDisposed(),(0,X.R)(this)};var K=n(64149);(0,i.tp)().prototype.floorDiv=function(t){return this.throwIfDisposed(),(0,K.w)(this,t)};var $=n(50511);(0,i.tp)().prototype.gather=function(t,e,n){return this.throwIfDisposed(),(0,$.k)(this,t,e,n)};var Z=n(39103);(0,i.tp)().prototype.greaterEqual=function(t){return this.throwIfDisposed(),(0,Z.D)(this,t)};var Q=n(60228);(0,i.tp)().prototype.greater=function(t){return this.throwIfDisposed(),(0,Q.r)(this,t)};var J=n(93674);(0,i.tp)().prototype.ifft=function(){return this.throwIfDisposed(),(0,J.K)(this)};var tt=n(30890);(0,i.tp)().prototype.irfft=function(){return this.throwIfDisposed(),(0,tt.g)(this)};var et=n(38660);(0,i.tp)().prototype.isFinite=function(){return this.throwIfDisposed(),(0,et.M)(this)};var nt=n(37304);(0,i.tp)().prototype.isInf=function(){return this.throwIfDisposed(),(0,nt.E)(this)};var rt=n(42310);(0,i.tp)().prototype.isNaN=function(){return this.throwIfDisposed(),(0,rt.y)(this)};var it=n(51965);(0,i.tp)().prototype.leakyRelu=function(t){return this.throwIfDisposed(),(0,it.H)(this,t)};var at=n(64210);(0,i.tp)().prototype.lessEqual=function(t){return this.throwIfDisposed(),(0,at.I)(this,t)};var ot=n(72969);(0,i.tp)().prototype.less=function(t){return this.throwIfDisposed(),(0,ot.M)(this,t)};var st=n(85593);(0,i.tp)().prototype.localResponseNormalization=function(t,e,n,r){return this.throwIfDisposed(),(0,st.K)(this,t,e,n,r)};var ct=n(34675);(0,i.tp)().prototype.logSigmoid=function(){return this.throwIfDisposed(),(0,ct.n)(this)};var ut=n(8229);(0,i.tp)().prototype.logSoftmax=function(t){return this.throwIfDisposed(),(0,ut.H)(this,t)};var lt=n(45492);(0,i.tp)().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),(0,lt.V)(this,t,e)};var ht=n(18688);(0,i.tp)().prototype.log=function(){return this.throwIfDisposed(),(0,ht.R)(this)};var dt=n(90781);(0,i.tp)().prototype.log1p=function(){return this.throwIfDisposed(),(0,dt.K)(this)};var ft=n(21183);(0,i.tp)().prototype.logicalAnd=function(t){return this.throwIfDisposed(),(0,ft.n)(this,t)};var pt=n(87375);(0,i.tp)().prototype.logicalNot=function(){return this.throwIfDisposed(),(0,pt.N)(this)};var gt=n(65497);(0,i.tp)().prototype.logicalOr=function(t){return this.throwIfDisposed(),(0,gt.z)(this,t)};var mt=n(6699);(0,i.tp)().prototype.logicalXor=function(t){return this.throwIfDisposed(),(0,mt.r)(this,t)};var yt=n(65849);(0,i.tp)().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),(0,yt.N)(this,t,e,n)};var vt=n(8853);(0,i.tp)().prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),(0,vt.j)(this,t,e,n,r)};var bt=n(73e3);(0,i.tp)().prototype.max=function(t,e){return this.throwIfDisposed(),(0,bt.T)(this,t,e)};var xt=n(98104);(0,i.tp)().prototype.maximum=function(t){return this.throwIfDisposed(),(0,xt.P)(this,t)};var wt=n(49577);(0,i.tp)().prototype.mean=function(t,e){return this.throwIfDisposed(),(0,wt.i)(this,t,e)};var kt=n(60278);(0,i.tp)().prototype.min=function(t,e){return this.throwIfDisposed(),(0,kt.j)(this,t,e)};var _t=n(91086);(0,i.tp)().prototype.minimum=function(t){return this.throwIfDisposed(),(0,_t.B)(this,t)};var St=n(32509);(0,i.tp)().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),(0,St.F)(this,t,e)};var At=n(5634);(0,i.tp)().prototype.mod=function(t){return this.throwIfDisposed(),(0,At.z)(this,t)};var Ct=n(86272);(0,i.tp)().prototype.mul=function(t){return this.throwIfDisposed(),(0,Ct.l)(this,t)};var Et=n(5008);(0,i.tp)().prototype.neg=function(){return this.throwIfDisposed(),(0,Et.H)(this)};var Tt=n(48306);(0,i.tp)().prototype.norm=function(t,e,n){return this.throwIfDisposed(),(0,Tt.x)(this,t,e,n)};var Nt=n(73848);(0,i.tp)().prototype.notEqual=function(t){return this.throwIfDisposed(),(0,Nt.E)(this,t)};var Dt=n(48926);(0,i.tp)().prototype.oneHot=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),(0,Dt.M)(this,t,e,n)};var Ft=n(98903);(0,i.tp)().prototype.onesLike=function(){return this.throwIfDisposed(),(0,Ft.P)(this)};var It=n(67507);(0,i.tp)().prototype.pad=function(t,e){return this.throwIfDisposed(),(0,It.e)(this,t,e)};var Mt=n(18570);(0,i.tp)().prototype.pool=function(t,e,n,r,i,a){return this.throwIfDisposed(),(0,Mt.d)(this,t,e,n,r,i,a)};var Ot=n(78188);(0,i.tp)().prototype.pow=function(t){return this.throwIfDisposed(),(0,Ot.n)(this,t)};var Rt=n(83860);(0,i.tp)().prototype.prelu=function(t){return this.throwIfDisposed(),(0,Rt.N)(this,t)};var zt=n(38517);(0,i.tp)().prototype.prod=function(t,e){return this.throwIfDisposed(),(0,zt._)(this,t,e)};var Bt=n(95868);(0,i.tp)().prototype.reciprocal=function(){return this.throwIfDisposed(),(0,Bt.V)(this)};var Lt=n(38414);(0,i.tp)().prototype.relu=function(){return this.throwIfDisposed(),(0,Lt.V)(this)};var Pt=n(6650);(0,i.tp)().prototype.relu6=function(){return this.throwIfDisposed(),(0,Pt.j)(this)},(0,i.tp)().prototype.reshapeAs=function(t){return this.throwIfDisposed(),(0,d.t)(this,t.shape)},(0,i.tp)().prototype.reshape=function(t){return this.throwIfDisposed(),(0,d.t)(this,t)};var jt=n(20537);(0,i.tp)().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),(0,jt.v)(this,t,e,n)};var Ut=n(80828);(0,i.tp)().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),(0,Ut.b)(this,t,e,n)};var Wt=n(23540);(0,i.tp)().prototype.reverse=function(t){return this.throwIfDisposed(),(0,Wt.B)(this,t)};var Vt=n(35721);(0,i.tp)().prototype.rfft=function(){return this.throwIfDisposed(),(0,Vt.z)(this)};var qt=n(16242);(0,i.tp)().prototype.round=function(){return this.throwIfDisposed(),(0,qt.L)(this)};var Gt=n(30414);(0,i.tp)().prototype.rsqrt=function(){return this.throwIfDisposed(),(0,Gt.Z)(this)};var Ht=n(52203);(0,i.tp)().prototype.selu=function(){return this.throwIfDisposed(),(0,Ht.W)(this)};var Yt=n(848);(0,i.tp)().prototype.separableConv2d=function(t,e,n,r,i,a){return this.throwIfDisposed(),(0,Yt.w)(this,t,e,n,r,i,a)};var Xt=n(1242);(0,i.tp)().prototype.sigmoid=function(){return this.throwIfDisposed(),(0,Xt.r)(this)};var Kt=n(5601);(0,i.tp)().prototype.sign=function(){return this.throwIfDisposed(),(0,Kt._)(this)};var $t=n(85956);(0,i.tp)().prototype.sin=function(){return this.throwIfDisposed(),(0,$t.F)(this)};var Zt=n(15990);(0,i.tp)().prototype.sinh=function(){return this.throwIfDisposed(),(0,Zt.L)(this)};var Qt=n(8016);(0,i.tp)().prototype.slice=function(t,e){return this.throwIfDisposed(),(0,Qt.d)(this,t,e)};var Jt=n(80724);(0,i.tp)().prototype.softmax=function(t){return this.throwIfDisposed(),(0,Jt.V)(this,t)};var te=n(22824);(0,i.tp)().prototype.softplus=function(){return this.throwIfDisposed(),(0,te.l)(this)};var ee=n(90602);(0,i.tp)().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),(0,ee.e)(this,t,e)};var ne=n(77554);(0,i.tp)().prototype.split=function(t,e){return this.throwIfDisposed(),(0,ne.l)(this,t,e)};var re=n(45766);(0,i.tp)().prototype.sqrt=function(){return this.throwIfDisposed(),(0,re.R)(this)};var ie=n(95195);(0,i.tp)().prototype.square=function(){return this.throwIfDisposed(),(0,ie.E)(this)};var ae=n(77189);(0,i.tp)().prototype.squaredDifference=function(t){return this.throwIfDisposed(),(0,ae.P)(this,t)};var oe=n(2330);(0,i.tp)().prototype.squeeze=function(t){return this.throwIfDisposed(),(0,oe.r)(this,t)};var se=n(22190);(0,i.tp)().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof i.qY?[this,t]:[this,...t];return(0,se.t)(n,e)};var ce=n(52946);(0,i.tp)().prototype.step=function(t){return this.throwIfDisposed(),(0,ce.P)(this,t)};var ue=n(57136);(0,i.tp)().prototype.stridedSlice=function(t,e,n,r,i,a,o,s){return this.throwIfDisposed(),(0,ue.Y)(this,t,e,n,r,i,a,o,s)};var le=n(77820);(0,i.tp)().prototype.sub=function(t){return this.throwIfDisposed(),(0,le.j)(this,t)};var he=n(17937);(0,i.tp)().prototype.sum=function(t,e){return this.throwIfDisposed(),(0,he.c)(this,t,e)};var de=n(66465);(0,i.tp)().prototype.tan=function(){return this.throwIfDisposed(),(0,de.M)(this)};var fe=n(47173);(0,i.tp)().prototype.tanh=function(){return this.throwIfDisposed(),(0,fe.y)(this)};var pe=n(35716);(0,i.tp)().prototype.tile=function(t){return this.throwIfDisposed(),(0,pe.V)(this,t)},(0,i.tp)().prototype.toBool=function(){return this.throwIfDisposed(),(0,p.w)(this,"bool")},(0,i.tp)().prototype.toFloat=function(){return this.throwIfDisposed(),(0,p.w)(this,"float32")},(0,i.tp)().prototype.toInt=function(){return this.throwIfDisposed(),(0,p.w)(this,"int32")};var ge=n(87984);(0,i.tp)().prototype.topk=function(t,e){return this.throwIfDisposed(),(0,ge.r)(this,t,e)};var me=n(15977);(0,i.tp)().prototype.transpose=function(t){return this.throwIfDisposed(),(0,me.m)(this,t)};var ye=n(68583);(0,i.tp)().prototype.unique=function(t){return this.throwIfDisposed(),(0,ye.A)(this,t)};var ve=n(66788);(0,i.tp)().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),(0,ve.z)(this,t,e)};var be=n(84491);(0,i.tp)().prototype.unstack=function(t){return this.throwIfDisposed(),(0,be.K)(this,t)};var xe=n(52117);(0,i.tp)().prototype.where=function(t,e){return this.throwIfDisposed(),(0,xe._)(t,this,e)};var we=n(90043);(0,i.tp)().prototype.zerosLike=function(){return this.throwIfDisposed(),(0,we.P)(this)}},50581:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Serializable:()=>o,SerializationMap:()=>s,getRegisteredName:()=>u,registerClass:()=>c});var r=n(23869);const i=new Map,a=new Map;class o{getClassName(){return this.constructor.className}static fromConfig(t,e){return new t(e)}}class s{constructor(){this.classNameMap={}}static getMap(){return null==s.instance&&(s.instance=new s),s.instance}static register(t){s.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function c(t,e,n){(0,r.vA)(null!=t.className,(()=>"Class being registered does not have the static className property defined.")),(0,r.vA)("string"===typeof t.className,(()=>"className is required to be a string, but got type "+typeof t.className)),(0,r.vA)(t.className.length>0,(()=>"Class being registered has an empty-string as its className, which is disallowed.")),"undefined"===typeof e&&(e="Custom"),"undefined"===typeof n&&(n=t.className);const o=e+">"+n;return s.register(t),i.set(o,t),a.set(t,o),t}function u(t){return a.has(t)?a.get(t):t.className}},90739:(t,e,n)=>{"use strict";n.d(e,{qY:()=>w,yl:()=>p,rT:()=>_,tp:()=>k,B4:()=>x,Q5:()=>b,qP:()=>v});var r=n(86177),i=n(23869);const a=20,o=3,s=7;function c(t,e,n,r){const a=(0,i.Ur)(e),o=function(t,e,n,r){const a=(0,i.Ze)(e),o=r[r.length-1],s=new Array(o).fill(0),c=e.length,l="complex64"===n?d(t):t;if(c>1)for(let i=0;i<a/o;i++){const t=i*o;for(let e=0;e<o;e++)s[e]=Math.max(s[e],u(l[t+e],0,n).length)}return s}(t,e,n,a),s=e.length,c=h(t,e,n,a,o),l=["Tensor"];return r&&(l.push("  dtype: ".concat(n)),l.push("  rank: ".concat(s)),l.push("  shape: [".concat(e,"]")),l.push("  values:")),l.push(c.map((t=>"    "+t)).join("\n")),l.join("\n")}function u(t,e,n){let r;return r=Array.isArray(t)?"".concat(parseFloat(t[0].toFixed(s))," + ")+"".concat(parseFloat(t[1].toFixed(s)),"j"):(0,i.Kg)(t)?"'".concat(t,"'"):"bool"===n?l(t):parseFloat(t.toFixed(s)).toString(),(0,i.av)(r,e)}function l(t){return 0===t?"false":"true"}function h(t,e,n,r,i){let s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];const c="complex64"===n?2:1,f=e[0],p=e.length;if(0===p){if("complex64"===n){return[u(d(t)[0],0,n)]}return"bool"===n?[l(t[0])]:[t[0].toString()]}if(1===p){if(f>a){const e=o*c;let r=Array.from(t.slice(0,e)),a=Array.from(t.slice((f-o)*c,f*c));return"complex64"===n&&(r=d(r),a=d(a)),["["+r.map(((t,e)=>u(t,i[e],n))).join(", ")+", ..., "+a.map(((t,e)=>u(t,i[f-o+e],n))).join(", ")+"]"]}return["["+("complex64"===n?d(t):Array.from(t)).map(((t,e)=>u(t,i[e],n))).join(", ")+"]"]}const g=e.slice(1),m=r.slice(1),y=r[0]*c,v=[];if(f>a){for(let e=0;e<o;e++){const r=e*y,a=r+y;v.push(...h(t.slice(r,a),g,n,m,i,!1))}v.push("...");for(let e=f-o;e<f;e++){const r=e*y,a=r+y;v.push(...h(t.slice(r,a),g,n,m,i,e===f-1))}}else for(let a=0;a<f;a++){const e=a*y,r=e+y;v.push(...h(t.slice(e,r),g,n,m,i,a===f-1))}const b=2===p?",":"";v[0]="["+(f>0?v[0]+b:"");for(let a=1;a<v.length-1;a++)v[a]=" "+v[a]+b;let x=",\n";for(let a=2;a<p;a++)x+="\n";return v[v.length-1]=" "+v[v.length-1]+"]"+(s?"":x),v}function d(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var f=n(73837);class p{constructor(t,e,n){if(this.dtype=e,this.shape=t.slice(),this.size=i.Ze(t),null!=n){const t=n.length;i.vA(t===this.size,(()=>"Length of values '".concat(t,"' does not match the size ")+"inferred by the shape '".concat(this.size,"'.")))}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||i.Ab(e,this.size),this.strides=(0,i.Ur)(t)}set(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),i.vA(n.length===this.rank,(()=>"The number of provided coordinates (".concat(n.length,") must ")+"match the rank (".concat(this.rank,")")));const a=this.locToIndex(n);this.values[a]=t}get(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];0===e.length&&(e=[0]);let r=0;for(const a of e){if(a<0||a>=this.shape[r]){const t="Requested out of range element at ".concat(e,". ")+"  Buffer shape=".concat(this.shape);throw new Error(t)}r++}let i=e[e.length-1];for(let a=0;a<e.length-1;++a)i+=this.strides[a]*e[a];return this.values[i]}locToIndex(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];let e=t[t.length-1];for(let n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e}indexToLoc(t){if(0===this.rank)return[];if(1===this.rank)return[t];const e=new Array(this.shape.length);for(let n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e}get rank(){return this.shape.length}toTensor(){return g().makeTensor(this.values,this.shape,this.dtype)}}let g=null,m=null,y=null;function v(t){g=t}function b(t){m=t}function x(t){y=t}class w{constructor(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=i.Ze(t),this.strides=(0,i.Ur)(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return m.buffer(this.shape,this.dtype,t)}bufferSync(){return m.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return(0,i.yw)(this.shape,t,"complex64"===this.dtype)}arraySync(){return(0,i.yw)(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();const t=g().read(this.dataId);if("string"===this.dtype){const n=await t;try{return n.map((t=>f.decodeString(t)))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataToGPU(t){return this.throwIfDisposed(),g().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=g().readSync(this.dataId);if("string"===this.dtype)try{return t.map((t=>f.decodeString(t)))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await g().read(this.dataId);return"string"===this.dtype?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),g().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return m.print(this,t)}clone(){return this.throwIfDisposed(),m.clone(this)}toString(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return c(this.dataSync(),this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),m.cast(this,t)}variable(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),g().makeVariable(this,t,e,n)}}function k(){return(0,r.m)("Tensor",(()=>w))}Object.defineProperty(w,Symbol.hasInstance,{value:t=>!!t&&null!=t.data&&null!=t.dataSync&&null!=t.throwIfDisposed}),k();class _ extends w{constructor(t,e,n,r){super(t.shape,t.dtype,t.dataId,r),this.trainable=e,this.name=n}assign(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(t.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!i.r1(t.shape,this.shape))throw new Error("shape of the new value (".concat(t.shape,") and ")+"previous value (".concat(this.shape,") must match"));g().disposeTensor(this),this.dataId=t.dataId,g().incRef(this,null)}dispose(){g().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(_,Symbol.hasInstance,{value:t=>t instanceof w&&null!=t.assign&&t.assign instanceof Function})},48683:(t,e,n)=>{"use strict";n.r(e),n.d(e,{assertTypesMatch:()=>s,getTensorsInContainer:()=>u,isTensorInList:()=>c,makeTypesMatch:()=>o});var r=n(90739),i=n(15188),a=n(23869);function o(t,e){if(t.dtype===e.dtype)return[t,e];const n=(0,i.Tu)(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function s(t,e){(0,a.vA)(t.dtype===e.dtype,(()=>"The dtypes of the first(".concat(t.dtype,") and")+" second(".concat(e.dtype,") input must match")))}function c(t,e){return e.some((e=>e.id===t.id))}function u(t){const e=[];return l(t,e,new Set),e}function l(t,e,n){if(null==t)return;if(t instanceof r.qY)return void e.push(t);if(i=t,!Array.isArray(i)&&"object"!==typeof i)return;var i;const a=t;for(const r in a){const t=a[r];n.has(t)||(n.add(t),l(t,e,n))}}},52863:(t,e,n)=>{"use strict";n.d(e,{MZ:()=>u,YT:()=>d,j1:()=>f});var r=n(37484),i=n(89e3),a=n(90739),o=n(15188),s=n(73837),c=n(23869);function u(t,e){let n=t;if((0,s.isTypedArray)(t))return"string"===e?[]:[t.length];if((0,o.Oj)(t)){const e=t.channels||"RGBA";return[t.height,t.width*e.length]}if((0,o.Nw)(t))return[t.buffer.size/(null==e?4:(0,c.jv)(e))];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||(0,s.isTypedArray)(n)&&"string"!==e;)r.push(n.length),n=n[0];return Array.isArray(t)&&(0,i._K)().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&l(t,r,[]),r}function l(t,e,n){if(n=n||[],!Array.isArray(t)&&!(0,s.isTypedArray)(t))return void(0,c.vA)(0===e.length,(()=>"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(e[0]," elements")));(0,c.vA)(e.length>0,(()=>"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(t.length," elements"))),(0,c.vA)(t.length===e[0],(()=>"Element arr[".concat(n.join("]["),"] should have ").concat(e[0]," ")+"elements, but has ".concat(t.length," elements")));const r=e.slice(1);for(let i=0;i<t.length;++i)l(t[i],r,n.concat(i))}function h(t,e,n,r){if("string_or_numeric"!==t){if(null==t)throw new Error("Expected dtype cannot be null.");if("numeric"!==t&&t!==e||"numeric"===t&&"string"===e)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(t," tensor, but got ").concat(e," tensor"))}}function d(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(t instanceof(0,a.tp)())return h(i,t.dtype,e,n),t;let o=(0,c.X$)(t);if("string"!==o&&["bool","int32","float32"].indexOf(i)>=0&&(o=i),h(i,o,e,n),null==t||!(0,s.isTypedArray)(t)&&!Array.isArray(t)&&"number"!==typeof t&&"boolean"!==typeof t&&"string"!==typeof t){const r=null==t?"null":t.constructor.name;throw new Error("Argument '".concat(e,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(r,"'"))}const l=u(t,o);(0,s.isTypedArray)(t)||Array.isArray(t)||(t=[t]);const d="string"!==o?(0,s.toTypedArray)(t,o):(0,s.flatten)(t,[],!0);return r.T2.makeTensor(d,l,o)}function f(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(t))throw new Error("Argument ".concat(e," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");return t.map(((t,i)=>d(t,"".concat(e,"[").concat(i,"]"),n,r)))}},15188:(t,e,n)=>{"use strict";var r,i,a,o,s;n.d(e,{Nw:()=>d,Oj:()=>h,Tu:()=>u,ch:()=>l,rg:()=>r}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(r||(r={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(i||(i={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(a||(a={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(o||(o={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(s||(s={}));const c={float32:o,int32:i,bool:a,complex64:s};function u(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast ".concat(t," with ").concat(e))}return c[t][e]}function l(t){return u(t,"int32")}function h(t){return null!=t&&"object"===typeof t&&"texture"in t&&t.texture instanceof WebGLTexture}function d(t){return"undefined"!==typeof GPUBuffer&&null!=t&&"object"===typeof t&&"buffer"in t&&t.buffer instanceof GPUBuffer}},73837:(t,e,n)=>{"use strict";n.r(e),n.d(e,{arraysEqual:()=>a.r1,arraysEqualWithNull:()=>a.e_,assert:()=>a.vA,assertNonNegativeIntegerDimensions:()=>a.SA,assertNonNull:()=>a.HO,assertShapesMatch:()=>a.O3,bytesFromStringArray:()=>a.SL,bytesPerElement:()=>a.jv,checkConversionForErrors:()=>a.nd,clamp:()=>a.qE,computeStrides:()=>a.Ur,convertBackendValuesAndArrayBuffer:()=>a.o2,createScalarValue:()=>x,createShuffledIndices:()=>a.P8,decodeString:()=>A,distSquared:()=>a.oO,encodeString:()=>S,fetch:()=>_,fingerPrint64:()=>b,flatten:()=>E,getArrayFromDType:()=>a.Ab,getTypedArrayFromDType:()=>a.ce,hasEncodingLoss:()=>a.BE,hexToLong:()=>c,indexToLoc:()=>a._k,inferDtype:()=>a.X$,inferFromImplicitShape:()=>a.XT,isBoolean:()=>a.Lm,isFunction:()=>a.Tn,isInt:()=>a.E6,isNumber:()=>a.Et,isPromise:()=>a.yL,isScalarShape:()=>a.Sf,isString:()=>a.Kg,isTypedArray:()=>C,isValidDtype:()=>a.xn,locToIndex:()=>a.sX,makeOnesTypedArray:()=>a.FZ,makeZerosNestedTypedArray:()=>a.c7,makeZerosTypedArray:()=>a.Ty,nearestDivisor:()=>a.lK,nearestLargerEven:()=>a.eV,now:()=>k,parseAxisParam:()=>a.Y6,randUniform:()=>a.so,repeatedTry:()=>a._q,rightPad:()=>a.av,shuffle:()=>a.k4,shuffleCombo:()=>a.a0,sizeFromShape:()=>a.Ze,sizeToSquarishShape:()=>a.gS,squeezeShape:()=>a.gx,sum:()=>a.cz,swap:()=>a.wg,tanh:()=>a.ym,toNestedArray:()=>a.yw,toTypedArray:()=>w});var r=n(89e3),i=n(84634),a=n(23869),o=n(61072);const s=n.n(o)()||o;function c(t){return s.fromString(t,!0,16)}const u=c("c3a5c85c97cb3127"),l=c("b492b66fbe98f273"),h=c("9ae16a3b2f90404f");function d(t){return t.xor(t.shru(47))}function f(t,e,n){const r=t.slice(e,e+n);return s.fromBytes(Array.from(r),!0,!0)}function p(t,e){return f(t,e,8)}function g(t,e){return f(t,e,4)}function m(t,e){return 0===e?t:t.shru(e).or(t.shl(64-e))}function y(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c("9ddfea08eb382d69"),r=t.xor(e).mul(n);r=r.xor(r.shru(47));let i=e.xor(r).mul(n);return i=i.xor(i.shru(47)),i=i.mul(n),i}function v(t,e,n,r){return function(t,e,n,r,i,a){i=i.add(t),a=m(a.add(i).add(r),21);const o=i;return i=(i=i.add(e)).add(n),a=a.add(m(i,44)),[i.add(r),a.add(o)]}(p(t,e),p(t,e+8),p(t,e+16),p(t,e+24),n,r)}function b(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;const n=s.fromNumber(81,!0);if(e<=32)return e<=16?function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;if(e>=8){const n=h.add(2*e),r=p(t,0).add(h),i=p(t,e-8);return y(m(i,37).mul(n).add(r),m(r,25).add(i).mul(n),n)}if(e>=4){const n=h.add(2*e);return y(g(t,0).shl(3).add(e),g(t,e-4),n)}if(e>0){const n=t[0]+(t[e>>1]<<8),r=e+(t[e-1]<<2);return d(h.mul(n).xor(u.mul(r))).mul(h)}return h}(t,e):function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;const n=h.add(2*e),r=p(t,0).mul(l),i=p(t,8),a=p(t,e-8).mul(n),o=p(t,e-16).mul(h);return y(m(r.add(i),43).add(m(a,30)).add(o),r.add(m(i.add(h),18)).add(a),n)}(t,e);if(e<=64)return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;const n=h.add(2*e),r=p(t,0).mul(h),i=p(t,8),a=p(t,e-8).mul(n),o=p(t,e-16).mul(h),s=m(r.add(i),43).add(m(a,30)).add(o),c=y(s,r.add(m(i.add(h),18)).add(a),n),u=p(t,16).mul(n),l=p(t,24),d=s.add(p(t,e-32)).mul(n),f=c.add(p(t,e-24)).mul(n);return y(m(u.add(l),43).add(m(d,30)).add(f),u.add(m(l.add(r),18)).add(d),n)}(t,e);let r=n,i=n.mul(l).add(113),a=d(i.mul(h).add(113)).mul(h),o=[s.UZERO,s.UZERO],c=[s.UZERO,s.UZERO];r=r.mul(h).add(p(t,0));let f=0;const b=64*(e-1>>6),x=b+(e-1&63)-63;do{r=m(r.add(i).add(o[0]).add(p(t,f+8)),37).mul(l),i=m(i.add(o[1]).add(p(t,f+48)),42).mul(l),r=r.xor(c[1]),i=i.add(o[0]).add(p(t,f+40)),a=m(a.add(c[0]),33).mul(l),o=v(t,f,o[1].mul(l),r.add(c[0])),c=v(t,f+32,a.add(c[1]),i.add(p(t,f+16))),[a,r]=[r,a],f+=64}while(f!==b);const w=l.add(a.and(255).shl(1));return f=x,c[0]=c[0].add(e-1&63),o[0]=o[0].add(c[0]),c[0]=c[0].add(o[0]),r=m(r.add(i).add(o[0]).add(p(t,f+8)),37).mul(w),i=m(i.add(o[1]).add(p(t,f+48)),42).mul(w),r=r.xor(c[1].mul(9)),i=i.add(o[0].mul(9).add(p(t,f+40))),a=m(a.add(c[0]),33).mul(w),o=v(t,f,o[1].mul(w),r.add(c[0])),c=v(t,f+32,a.add(c[1]),i.add(p(t,f+16))),[a,r]=[r,a],y(y(o[0],c[0],w).add(d(i).mul(u)).add(a),y(o[1],c[1],w).add(r),w)}function x(t,e){return"string"===e?S(t):w([t],e)}function w(t,e){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=E(t)),(0,r._K)().getBool("DEBUG")&&a.nd(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){const e=new Uint8Array(t.length);for(let n=0;n<e.length;++n)0!==Math.round(t[n])&&(e[n]=1);return e}throw new Error("Unknown data type ".concat(e))}function k(){return(0,r._K)().platform.now()}function _(t,e){return(0,r._K)().platform.fetch(t,e)}function S(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return e=e||"utf-8",(0,r._K)().platform.encode(t,e)}function A(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return e=e||"utf-8",(0,r._K)().platform.decode(t,e)}function C(t){return null!=(0,r._K)().platform.isTypedArray?(0,r._K)().platform.isTypedArray(t):(0,i.Y)(t)}function E(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e&&(e=[]),"boolean"===typeof t||"number"===typeof t||"string"===typeof t||a.yL(t)||null==t||C(t)&&n)e.push(t);else if(Array.isArray(t)||C(t))for(let r=0;r<t.length;++r)E(t[r],e,n);else{let r=-1;for(const e of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(e)&&(r=Math.max(r,Number(e)));for(let i=0;i<=r;i++)E(t[i],e,n)}return e}},23869:(t,e,n)=>{"use strict";function r(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,s(t,e,n)}function i(t,e){if(t.length!==e.length)throw new Error("Array sizes must match to be shuffled together "+"First array length was ".concat(t.length)+"Second array length was ".concat(e.length));let n=t.length,r=0;for(;n>0;)r=Math.random()*n|0,n--,s(t,n,r),s(e,n,r)}function a(t,e,n){return Math.max(t,Math.min(e,n))}function o(t){return t%2===0?t:t+1}function s(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function c(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function u(t,e){const n=Math.random();return e*n+(1-n)*t}function l(t,e){let n=0;for(let r=0;r<t.length;r++){const i=Number(t[r])-Number(e[r]);n+=i*i}return n}function h(t,e){if(!t)throw new Error("string"===typeof e?e:e())}function d(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";h(y(t,e),(()=>n+" Shapes ".concat(t," and ").concat(e," must match")))}function f(t){h(null!=t,(()=>"The input to the tensor constructor must be a non-null value."))}function p(t){if(0===t.length)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function g(t){return 0===t.length}function m(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(null!==t[n]&&null!==e[n]&&t[n]!==e[n])return!1;return!0}function y(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function v(t){return t%1===0}function b(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function x(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function w(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return r(e),e}function k(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function _(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t=>0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return new Promise(((i,a)=>{let o=0;const s=()=>{if(t())return void i();o++;const c=e(o);null!=n&&o>=n?a():null!=r?r(s,c):setTimeout(s,c)};s()}))}function S(t,e){let n=1,r=-1;for(let a=0;a<t.length;++a)if(t[a]>=0)n*=t[a];else if(-1===t[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(a));r=a}else if(t[a]<0)throw Error("Shapes can not be < 0. Found ".concat(t[a]," at dim ").concat(a));if(-1===r){if(e>0&&e!==n)throw Error("Size(".concat(e,") must match the product of shape ").concat(t));return t}if(0===n)throw Error("Cannot infer the missing size in [".concat(t,"] when ")+"there are 0 elements");if(e%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(e," / ").concat(n));const i=t.slice();return i[r]=e/n,i}function A(t,e){const n=e.length;return h((t=null==t?e.map(((t,e)=>e)):[].concat(t)).every((t=>t>=-n&&t<n)),(()=>"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(t))),h(t.every((t=>v(t))),(()=>"All values in axis param must be integers but "+"got axis ".concat(t))),t.map((t=>t<0?n+t:t))}function C(t,e){const n=[],r=[],i=null!=e&&Array.isArray(e)&&0===e.length,a=null==e||i?null:A(e,t).sort();let o=0;for(let s=0;s<t.length;++s){if(null!=a){if(a[o]===s&&1!==t[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(t[s],"' is not 1"));(null==a[o]||a[o]>s)&&1===t[s]&&(n.push(t[s]),r.push(s)),a[o]<=s&&o++}1!==t[s]&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function E(t,e){return T(t,e)}function T(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type ".concat(t));n=new Array(e)}return n}function N(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(e," being uploaded contains ").concat(r,"."))}}function D(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function F(t,e){return"complex64"!==e&&(("float32"!==e||"complex64"===t)&&(("int32"!==e||"float32"===t||"complex64"===t)&&("bool"!==e||"bool"!==t)))}function I(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype ".concat(t))}function M(t){if(null==t)return 0;let e=0;return t.forEach((t=>e+=t.length)),e}function O(t){return"string"===typeof t||t instanceof String}function R(t){return"boolean"===typeof t}function z(t){return"number"===typeof t}function B(t){return Array.isArray(t)?B(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":z(t)?"float32":O(t)?"string":R(t)?"bool":"float32"}function L(t){return!!(t&&t.constructor&&t.call&&t.apply)}function P(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function j(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function U(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=new Array;if(1===e.length){const a=e[0]*(r?2:1);for(let e=0;e<a;e++)i[e]=n[t+e]}else{const a=e[0],o=e.slice(1),s=o.reduce(((t,e)=>t*e))*(r?2:1);for(let e=0;e<a;e++)i[e]=U(t+e*s,o,n,r)}return i}function W(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===t.length)return e[0];const r=t.reduce(((t,e)=>t*e))*(n?2:1);if(0===r)return[];if(r!==e.length)throw new Error("[".concat(t,"] does not match the input size ").concat(e.length).concat(n?" for a complex tensor":"","."));return U(0,t,e,n)}function V(t,e){if(Array.isArray(t))return t;if("float32"===e)return t instanceof Float32Array?t:new Float32Array(t);if("int32"===e)return t instanceof Int32Array?t:new Int32Array(t);if("bool"===e||"string"===e)return Uint8Array.from(new Int32Array(t));throw new Error("Unknown dtype ".concat(e))}function q(t,e){const n=G(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function G(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type ".concat(e))}function H(t,e){const n=t.reduce(((t,e)=>t*e),1);if(null==e||"float32"===e)return W(t,new Float32Array(n));if("int32"===e)return W(t,new Int32Array(n));if("bool"===e)return W(t,new Uint8Array(n));throw new Error("Unknown data type ".concat(e))}function Y(t){t.forEach((e=>{h(Number.isInteger(e)&&e>=0,(()=>"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(t,"].")))}))}function X(t,e,n){if(0===e)return 0;if(1===e)return t[0];let r=t[t.length-1];for(let i=0;i<t.length-1;++i)r+=n[i]*t[i];return r}function K(t,e,n){if(0===e)return[];if(1===e)return[t];const r=new Array(e);for(let i=0;i<r.length-1;++i)r[i]=Math.floor(t/n[i]),t-=r[i]*n[i];return r[r.length-1]=t,r}function $(t){return t&&t.then&&"function"===typeof t.then}n.d(e,{Ab:()=>T,BE:()=>F,E6:()=>v,Et:()=>z,FZ:()=>q,HO:()=>f,Kg:()=>O,Lm:()=>R,O3:()=>d,P8:()=>w,SA:()=>Y,SL:()=>M,Sf:()=>g,Tn:()=>L,Ty:()=>G,Ur:()=>j,X$:()=>B,XT:()=>S,Y6:()=>A,Ze:()=>p,_k:()=>K,_q:()=>_,a0:()=>i,av:()=>k,c7:()=>H,ce:()=>E,cz:()=>c,eV:()=>o,e_:()=>m,gS:()=>x,gx:()=>C,jv:()=>I,k4:()=>r,lK:()=>P,nd:()=>N,o2:()=>V,oO:()=>l,qE:()=>a,r1:()=>y,sX:()=>X,so:()=>u,vA:()=>h,wg:()=>s,xn:()=>D,yL:()=>$,ym:()=>b,yw:()=>W})},99906:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(28927),i=n(17975);class a extends r.Component{componentDidMount(){const{name:t,tab:e}=this.props;this.props.registerSurface(t,e,this)}componentDidUpdate(){return!1}render(){const{name:t,visible:e,styles:n}=this.props,o=Object.assign({},a.defaultStyles,n),{width:s,height:c}=o;let{maxHeight:u,maxWidth:l}=o;u=c===a.defaultStyles.height?u:c,l=s===a.defaultStyles.width?l:s;const h=i.css({display:e?"block":"none",backgroundColor:"white",marginTop:"10px",marginBottom:"10px",boxShadow:"0 0 6px -3px #777",padding:"10px !important",height:c,width:s,maxHeight:u,maxWidth:l,overflow:"auto"}),d=i.css({backgroundColor:"white",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",marginBottom:"20px",fontWeight:"600",textAlign:"center"}),f=i.css({boxSizing:"border-box"});return r.h("div",{className:"".concat(h," tf-surface"),ref:t=>this.container=t,"data-visible":e},r.h("div",{className:"".concat(d," tf-label"),ref:t=>this.label=t},t),r.h("div",{className:"".concat(f," tf-draw-area"),ref:t=>this.drawArea=t}))}}a.defaultStyles={maxWidth:"550px",maxHeight:"580px",height:"auto",width:"auto"},e.SurfaceComponent=a},15217:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(28927),i=n(17975);class a extends r.Component{render(){const{tabNames:t,activeTab:e,handleClick:n}=this.props,a=t.length>0?t.map((t=>r.h(o,{key:t,id:t,handleClick:n,isActive:t===e},t))):null,s=i.css({overflowX:"scroll",overflowY:"hidden",whiteSpace:"nowrap",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"#eee",paddingBottom:"1rem",marginTop:"1rem"});return r.h("div",{className:"".concat(s," visor-tabs")},a)}}e.Tabs=a;class o extends r.Component{render(){const{children:t,isActive:e,handleClick:n,id:a}=this.props,o=i.css({borderBottomColor:e?"#357EDD":"#AAAAAA",borderBottomWidth:"1px",borderBottomStyle:"solid",cursor:"pointer",":hover":{color:"#357EDD"},display:"inline-block",marginRight:"1rem",padding:".5rem",fontSize:"1rem",fontWeight:"bold"});return r.h("a",{className:"".concat(o," tf-tab"),"data-isactive":e,onClick:()=>n(a)},t)}}},89570:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(28927),i=n(17975),a=n(99906),o=n(15217);class s extends r.Component{static render(t,e,n){return r.render(r.h(s,Object.assign({},n)),t,e)}constructor(t){super(t),this.surfaces=new Map;const e=null==t.startOpen||t.startOpen;this.state={isOpen:e,isFullscreen:!1,activeTab:null,tabs:new Set},this.keyHandler=this.keyHandler.bind(this)}close(){this.setState({isOpen:!1})}open(){this.setState({isOpen:!0})}toggle(){this.setState({isOpen:!this.state.isOpen})}toggleFullScreen(){this.setState({isFullscreen:!this.state.isFullscreen})}isOpen(){return this.state.isOpen}isFullscreen(){return this.state.isFullscreen}getSurface(t,e){const n=this.surfaceId(t,e);let r;if(!this.surfaces.has(n))throw Error("Surface not found with id: ".concat(n));return r=this.surfaces.get(n),{container:r.container,label:r.label,drawArea:r.drawArea}}bindKeys(){document.addEventListener("keydown",this.keyHandler,!1)}unbindKeys(){document.removeEventListener("keydown",this.keyHandler)}surfaceId(t,e){return t+e}setTabs(t){const e=t.map((t=>t.tab)),n=this.state.tabs;let r;for(const i of e)n.has(i)||(n.add(i),r=i);null!=r&&this.setState({tabs:n,activeTab:r})}getTabs(){return this.state.tabs}registerSurface(t,e,n){const r=this.surfaceId(t,e);this.surfaces.set(r,n)}keyHandler(t){192===t.keyCode&&(t.shiftKey?this.toggleFullScreen():this.toggle())}setActiveTab(t){this.setState({activeTab:t})}componentDidMount(){this.bindKeys()}componentWillMount(){this.setTabs(this.props.surfaceList)}componentWillReceiveProps(t){this.setTabs(t.surfaceList)}render(){const{isOpen:t,isFullscreen:e,activeTab:n}=this.state,{surfaceList:s}=this.props,u=Array.from(this.getTabs().values()),l=e?"90vw":"550px",h=i.css({width:l,height:"100%",backgroundColor:"#fafafa",boxSizing:"border-box",padding:"10px",position:"fixed",top:"0px",transition:"right 0.5s cubic-bezier(0.645, 0.045, 0.355, 1), width 0.5s cubic-bezier(0.645, 0.045, 0.355, 1)",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.12), 0 2px 5px rgba(0, 0, 0, 0.24)",overflow:"auto",fontFamily:"sans-serif",fontSize:"14px",zIndex:1e3}),d=i.css({right:"0"}),f=i.css({right:"calc(-".concat(l," - 10px)")}),p=t?d:f,g=i.css({});return r.h("div",{className:"".concat(h," ").concat(p," visor"),"data-isopen":t,"data-isfullscreen":e},r.h(c,{fullScreenHandler:this.toggleFullScreen.bind(this),closeHandler:this.close.bind(this),isFullScreen:e}),r.h(o.Tabs,{tabNames:u,activeTab:n,handleClick:this.setActiveTab.bind(this)}),r.h("div",{className:"".concat(g," visor-surfaces")},s.map((t=>r.h(a.SurfaceComponent,{key:t.name+t.tab,name:t.name,tab:t.tab,styles:t.styles,registerSurface:this.registerSurface.bind(this),visible:n===t.tab})))))}}function c(t){const{isFullScreen:e,fullScreenHandler:n,closeHandler:a}=t,o=i.css({display:"flex",backgroundColor:"white",border:"1px solid white",padding:"6px",paddingTop:"10px",marginBottom:"10px",borderRadius:"6px",marginTop:"-16px"}),s=i.css({fontSize:".875rem",borderRadius:".25rem",paddingLeft:"1rem",paddingRight:"1rem",paddingTop:".5rem",paddingBottom:".5rem",textDecoration:"none",transition:"color .15s ease-in",color:"#111"}),c=i.css({marginLeft:"auto"});return r.h("div",{className:"".concat(o," visor-controls")},r.h("button",{className:"".concat(s),onClick:n},e?"Minimize":"Maximize"),r.h("button",{className:"".concat(s," ").concat(c),onClick:a},"Hide"))}e.VisorComponent=s},86112:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(37837),n(58914);const r=n(18794),i=n(92977),a=n(46737),o=n(34115),s=n(72003),c=n(96683),u=n(56557),l=n(86920),h=n(8777),d=n(56957),f=n(35927),p=n(99151),g=n(15884);e.version_vis=g.version;const m={barchart:r.barchart,table:u.table,histogram:o.histogram,linechart:s.linechart,scatterplot:c.scatterplot,confusionMatrix:i.confusionMatrix,heatmap:a.heatmap};e.render=m;const y={accuracy:p.accuracy,perClassAccuracy:p.perClassAccuracy,confusionMatrix:p.confusionMatrix};e.metrics=y;const v={history:l.history,fitCallbacks:l.fitCallbacks,perClassAccuracy:d.perClassAccuracy,valuesDistribution:f.valuesDistribution,layer:h.layer,modelSummary:h.modelSummary};e.show=v;var b=n(67543);e.visor=b.visor,function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(55525))},18794:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(n(66836)),o=n(26513),s=n(11447);e.barchart=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r(this,void 0,void 0,(function*(){const r=s.getDrawArea(t),i=e,l=Object.assign({},c,n);if(u.has(r)){const t=u.get(r);if(s.shallowEquals(l,t.lastOptions)){yield s.nextFrame();const e=t.view,n=e.changeset().remove((()=>!0)).insert(i);return void(yield e.change("values",n).runAsync())}}const{xLabel:h,yLabel:d,xType:f,yType:p}=l;let g=null;null!=h&&(g={title:h});let m=null;null!=d&&(m={title:d});let y;y=null!=l.color?Array.isArray(l.color)?{field:"index",type:"nominal",scale:{range:l.color}}:{value:l.color}:{value:"#4C78A0"};const v={width:l.width||o.getDefaultWidth(r),height:l.height||o.getDefaultHeight(r),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:l.fontSize,titleFontSize:l.fontSize},text:{fontSize:l.fontSize},legend:{labelFontSize:l.fontSize,titleFontSize:l.fontSize}},data:{values:i,name:"values"},mark:{type:"bar",tooltip:!0},encoding:{x:{field:"index",type:f,axis:g},y:{field:"value",type:p,axis:m},color:y}};yield s.nextFrame();const b=yield a.default(r,v,{actions:!1,mode:"vega-lite",defaultStyle:!1});u.set(r,{view:b.view,lastOptions:l})}))};const c={xLabel:"",yLabel:"",xType:"ordinal",yType:"quantitative",fontSize:11},u=new Map},92977:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(n(66836)),o=n(26513),s=n(11447);e.confusionMatrix=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r(this,void 0,void 0,(function*(){const r=Object.assign({},c,n),i=s.getDrawArea(t),u=[],l=e.values,h=e.tickLabels||[],d=0===h.length;let f=!0;for(let t=0;t<l.length;t++){const e=d?"Class ".concat(t):h[t];d&&h.push(e);for(let n=0;n<l[t].length;n++){const i=d?"Class ".concat(n):h[n],a=l[t][n];t!==n||r.shadeDiagonal?(u.push({label:e,prediction:i,count:a,scaleCount:a}),0!==a&&(f=!1)):u.push({label:e,prediction:i,count:a,noFill:!0})}}if(!r.shadeDiagonal&&f)for(const t of u)!0===t.noFill&&(t.noFill=!1,t.scaleCount=t.count);const p={width:r.width||o.getDefaultWidth(i),height:r.height||o.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize}},data:{values:u},encoding:{x:{field:"prediction",type:"ordinal",title:r.xLabel||"prediction",scale:{domain:h}},y:{field:"label",type:"ordinal",title:r.yLabel||"label",scale:{domain:h}}},layer:[{transform:[{filter:"datum.noFill != true"}],mark:{type:"rect"},encoding:{color:{field:"scaleCount",type:"quantitative",scale:{range:r.colorMap}},tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}]};!1===r.shadeDiagonal&&p.layer.push({transform:[{filter:"datum.noFill == true"}],mark:{type:"rect",fill:"white"},encoding:{tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}),r.showTextOverlay&&p.layer.push({mark:{type:"text",baseline:"middle"},encoding:{text:{field:"count",type:"nominal"}}});const g="string"===typeof r.colorMap?{scheme:r.colorMap}:r.colorMap;p.layer[0].encoding.color.scale.range=g,yield a.default(i,p,{actions:!1,mode:"vega-lite",defaultStyle:!1})}))};const c={xLabel:null,yLabel:null,xType:"nominal",yType:"nominal",shadeDiagonal:!0,fontSize:12,showTextOverlay:!0,height:400,colorMap:["#f7fbff","#4292c6"]}},46737:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=i(n(37837)),s=a(n(66836)),c=n(26513),u=n(27332),l=n(11447);function h(t,e,n){const r=t instanceof o.Tensor?t.shape:[t.length,t[0].length];0===n?u.assert(r[0]===e.length,"Length of xTickLabels (".concat(e.length,") must match number of rows")+" (".concat(r[0],")")):1===n&&u.assert(r[1]===e.length,"Length of yTickLabels (".concat(e.length,") must match number of columns (").concat(r[1],")"))}e.heatmap=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r(this,void 0,void 0,(function*(){const i=Object.assign({},d,n),a=l.getDrawArea(t);let f=e.values;i.rowMajor&&(f=yield function(t){return r(this,void 0,void 0,(function*(){let e,n;t instanceof o.Tensor?(e=t.shape,n=t.transpose()):(e=[t.length,t[0].length],n=o.tidy((()=>o.tensor2d(t).transpose()))),u.assert(2===n.rank,"Input to renderHeatmap must be a 2d array or Tensor2d");const r=yield n.array();n.dispose();const i=[r.length,r[0].length];return u.assert(e[0]===i[1]&&e[1]===i[0],"Unexpected transposed shape. Original ".concat(e," : Transposed ").concat(i)),r}))}(e.values));const{xTickLabels:p,yTickLabels:g}=e;if(null!=p){h(f,p,0)}if(null!=g){h(f,g,1)}const m="@tfidx@",y=[];if(f instanceof o.Tensor){u.assert(2===f.rank,"Input to renderHeatmap must be a 2d array or Tensor2d");const t=yield f.data(),[e,n]=f.shape;for(let r=0;r<e;r++){const e=p?"".concat(p[r]).concat(m).concat(r):r;for(let i=0;i<n;i++){const a=g?"".concat(g[i]).concat(m).concat(i):i,o=t[r*n+i];y.push({x:e,y:a,value:o})}}}else{const t=f;for(let e=0;e<t.length;e++){const n=p?"".concat(p[e]).concat(m).concat(e):e;for(let r=0;r<t[e].length;r++){const i=g?"".concat(g[r]).concat(m).concat(r):r,a=t[e][r];y.push({x:n,y:i,value:a})}}}const v={actions:!1,mode:"vega-lite",defaultStyle:!1},b={width:i.width||c.getDefaultWidth(a),height:i.height||c.getDefaultHeight(a),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},text:{fontSize:i.fontSize},legend:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},scale:{bandPaddingInner:0,bandPaddingOuter:0}},data:{values:y},mark:{type:"rect",tooltip:!0},encoding:{x:{field:"x",type:i.xType,title:i.xLabel,sort:!1},y:{field:"y",type:i.yType,title:i.yLabel,sort:!1},fill:{field:"value",type:"quantitative"}}},x="".concat(m,"\\d+$"),w=new RegExp(x);let k;switch(p&&(b.encoding.x.axis={labelExpr:"replace(datum.value, regexp(/".concat(x,"/), '')")}),g&&(b.encoding.y.axis={labelExpr:"replace(datum.value, regexp(/".concat(x,"/), '')")}),(p||g)&&(v.tooltip={sanitize:t=>String(t).replace(w,"")}),i.colorMap){case"blues":k=["#f7fbff","#4292c6"];break;case"greyscale":k=["#000000","#ffffff"];break;default:k="viridis"}if("viridis"!==k){b.encoding.fill.scale={range:k}}if(i.domain){const t=b.encoding.fill;null!=t.scale?t.scale=Object.assign({},t.scale,{domain:i.domain}):t.scale={domain:i.domain}}yield s.default(a,b,v)}))};const d={xLabel:null,yLabel:null,xType:"ordinal",yType:"ordinal",colorMap:"viridis",fontSize:12,domain:null,rowMajor:!1}},34115:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=n(67637),o=i(n(66836)),s=n(26513),c=n(99151),u=n(56557),l={maxBins:12,fontSize:11};e.histogram=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r(this,void 0,void 0,(function*(){const r=function(t){if(null==t.length)throw new Error("input data must be an array");if(0===t.length)return[];if("object"===typeof t[0]){if(null==t[0].value)throw new Error("input data must have a value field");return t}{const e=Array(t.length);for(let n=0;n<t.length;n++)e[n]={value:t[n]};return e}}(e),i=Object.assign({},l,n),h=s.subSurface(t,"histogram");if(!1!==n.stats){const e=s.subSurface(t,"stats",{prepend:!0});let o;o=n.stats?n.stats:c.arrayStats(r.map((t=>t.value))),function(t,e,n){const r=a.format(",.4~f"),i=a.format(".4~p"),o=[],s=[];null!=t.numVals&&(o.push("Num Vals"),s.push(r(t.numVals)));null!=t.min&&(o.push("Min"),s.push(r(t.min)));null!=t.max&&(o.push("Max"),s.push(r(t.max)));if(null!=t.numZeros){o.push("# Zeros");let e="";t.numVals&&(e=t.numZeros>0?"(".concat(i(t.numZeros/t.numVals),")"):""),s.push("".concat(r(t.numZeros)," ").concat(e))}if(null!=t.numNans){o.push("# NaNs");let e="";t.numVals&&(e=t.numNans>0?"(".concat(i(t.numNans/t.numVals),")"):""),s.push("".concat(r(t.numNans)," ").concat(e))}if(null!=t.numInfs){o.push("# Infinity");let e="";t.numVals&&(e=t.numInfs>0?"(".concat(i(t.numInfs/t.numVals),")"):""),s.push("".concat(r(t.numInfs)," ").concat(e))}u.table(e,{headers:o,values:[s]},n)}(o,e,{fontSize:i.fontSize})}if(0===r.length)return;const d=[];for(let t=0;t<r.length;t++){const e=r[t].value;null!=e&&isFinite(e)&&d.push(r[t])}const f={width:i.width||s.getDefaultWidth(h),height:i.height||s.getDefaultHeight(h),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},data:{values:d},mark:{type:"bar",tooltip:!0},config:{axis:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},text:{fontSize:i.fontSize},legend:{labelFontSize:i.fontSize,titleFontSize:i.fontSize}},encoding:{x:{bin:{maxbins:i.maxBins},field:"value",type:"quantitative"},y:{aggregate:"count",type:"quantitative"},color:{value:i.color||"#001B44"}}};return o.default(h,f,{actions:!1,mode:"vega-lite",defaultStyle:!1})}))}},72003:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(n(66836)),o=n(26513),s=n(27332),c=n(11447);e.linechart=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r(this,void 0,void 0,(function*(){const r=Array.isArray(e.values[0])?e.values:[e.values],i=r[0].length,l=e.series?e.series:r.map(((t,e)=>"Series ".concat(e+1)));s.assert(l.length===r.length,"Must have an equal number of series labels as there are data series"),null!=n.seriesColors&&s.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const h=[];for(let t=0;t<i;t++){const e={x:t};l.forEach(((n,i)=>{const a=r[i][t].y;e[n]=a,e["".concat(n,"-name")]=n})),h.push(e)}const d=Object.assign({},u,n),f={x:{field:"x",type:d.xType,title:d.xLabel},tooltip:[{field:"x",type:"quantitative"},...l.map((t=>({field:t,type:"quantitative"})))]},p=l.map((t=>({data:void 0,mark:{type:"line",clip:!0},encoding:{y:{field:t,type:d.yType,title:d.yLabel,scale:d.zoomToFit?{zero:!1}:null!=d.yAxisDomain?{domain:d.yAxisDomain}:void 0},color:{field:"".concat(t,"-name"),type:"nominal",legend:{values:l,title:null},scale:{range:d.seriesColors}}}}))),g=c.getDrawArea(t),m={width:d.width||o.getDefaultWidth(g),height:d.height||o.getDefaultHeight(g),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:d.fontSize,titleFontSize:d.fontSize},text:{fontSize:d.fontSize},legend:{labelFontSize:d.fontSize,titleFontSize:d.fontSize}},data:{values:h},encoding:f,layer:[...p,{mark:"rule",selection:{hover:{type:"single",on:"mouseover",nearest:!0,clear:"mouseout"}},encoding:{color:{value:"grey",condition:{selection:{not:"hover"},value:"transparent"}}}}]};return yield a.default(g,m,{actions:!1,mode:"vega-lite",defaultStyle:!1}),Promise.resolve()}))};const u={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11}},11447:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n(55525),a=n(67543);e.getDrawArea=function(t){if(t instanceof HTMLElement)return t;if(i.isSurface(t))return t.drawArea;if(i.isSurfaceInfo(t)){return a.visor().surface({name:t.name,tab:t.tab,styles:t.styles}).drawArea}throw new Error("Not a drawable")},e.shallowEquals=function(t,e){const n=Object.getOwnPropertyNames(t),r=Object.getOwnPropertyNames(e);if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++){const r=n[i];if(t[r]!==e[r])return!1}return!0},e.nextFrame=function(){return r(this,void 0,void 0,(function*(){yield new Promise((t=>requestAnimationFrame(t)))}))}},96683:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(n(66836)),o=n(26513),s=n(27332),c=n(11447);e.scatterplot=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r(this,void 0,void 0,(function*(){let r=e.values;const i=null==e.series?[]:e.series;r=Array.isArray(r[0])?r:[r];const l=[];r.forEach(((t,e)=>{const n=null!=i[e]?i[e]:"Series ".concat(e+1),r=t.map((t=>Object.assign({},t,{series:n})));l.push(...r)})),null!=n.seriesColors&&s.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const h=c.getDrawArea(t),d=Object.assign({},u,n),f={width:d.width||o.getDefaultWidth(h),height:d.height||o.getDefaultHeight(h),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:d.fontSize,titleFontSize:d.fontSize},text:{fontSize:d.fontSize},legend:{labelFontSize:d.fontSize,titleFontSize:d.fontSize}},data:{values:l},mark:{type:"point",clip:!0,tooltip:{content:"data"}},encoding:{x:{field:"x",type:d.xType,title:d.xLabel,scale:d.zoomToFit?{zero:!1}:null!=d.xAxisDomain?{domain:d.xAxisDomain}:void 0},y:{field:"y",type:d.yType,title:d.yLabel,scale:d.zoomToFit?{zero:!1}:null!=d.yAxisDomain?{domain:d.yAxisDomain}:void 0},color:{field:"series",type:"nominal",scale:{range:d.seriesColors}},shape:{field:"series",type:"nominal"}}};return yield a.default(h,f,{actions:!1,mode:"vega-lite",defaultStyle:!1}),Promise.resolve()}))};const u={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11}},56557:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(67637),i=n(27954),a=n(17975),o=n(11447);e.table=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e&&null==e.headers)throw new Error('Data to render must have a "headers" property');if(e&&null==e.values)throw new Error('Data to render must have a "values" property');const c=o.getDrawArea(t),u=Object.assign({},s,n);let l=i.select(c).select("table.tf-table");const h=a.css({fontSize:u.fontSize||".875rem",width:"100%",maxWidth:"64rem",marginRight:"auto",marginLeft:"auto"});if(0===l.size()&&(l=i.select(c).append("table"),l.attr("class"," ".concat(h," tf-table")),l.append("thead").append("tr"),l.append("tbody")),1!==l.size())throw new Error("Error inserting table");const d=a.css({fontWeight:"600",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )",textAlign:"left",paddingBottom:"1rem",paddingRight:"1rem",backgroundColor:"#fff"}),f=l.select("thead").select("tr").selectAll("th").data(e.headers),p=f.enter().append("th").attr("class","".concat(d));f.merge(p).html((t=>t)),f.exit().remove();const g=r.format(",.4~f"),m=l.select("tbody").selectAll("tr").data(e.values),y=m.enter().append("tr"),v=a.css({padding:"0.25rem",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )"}),b=m.merge(y).selectAll("td").data((t=>t)),x=b.enter().append("td").attr("class","".concat(v));b.merge(x).html((t=>"number"===typeof t?g(t):t)),b.exit().remove(),m.exit().remove()};const s={fontSize:14}},86920:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n(72003),a=n(11447),o=n(26513);function s(t,e,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return r(this,void 0,void 0,(function*(){const r=a.getDrawArea(t),l={};for(const t of n)if(/val_/.test(t)){const r=t.replace("val_","");c(l,r);const i=u(e,t,n.indexOf(t));l[r].series.push(t),l[r].values.push(i)}else{const r=u(e,t,n.indexOf(t));c(l,t),l[t].series.push(t),l[t].values.push(r)}const h=Object.keys(l),d=Object.assign({},{xLabel:"Iteration",yLabel:"Value"},s),f=[];for(const t of h){const e=o.subSurface(r,t),n=l[t].series,a=l[t].values;n.every((t=>Boolean(t.match("acc"))))&&(d.zoomToFitAccuracy?d.zoomToFit=!0:(d.yAxisDomain=[0,1],delete d.zoomToFit));const s=i.linechart(e,{values:a,series:n},d);f.push(s)}yield Promise.all(f)}))}function c(t,e){null==t[e]&&(t[e]={series:[],values:[]})}function u(t,e,n){if(Array.isArray(t)){const r=Array.isArray(t[0])?t[n]:t,i=[];for(let t=0;t<r.length;t++){const n=r[t];i.push({x:t,y:n[e]})}return i}return t.history[e].map(((t,e)=>({x:e,y:t})))}function l(t,e,n){return null==t[e]&&(t[e]={}),null==t[e][n]&&(t[e][n]=[]),t[e][n]}e.history=s,e.fitCallbacks=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i={},c=n.callbacks||["onEpochEnd","onBatchEnd"],u=a.getDrawArea(t),h=Object.assign({},n);delete h.callbacks;const d={};return c.forEach((t=>{d[t]=function(t){return(n,c)=>r(this,void 0,void 0,(function*(){/batch/i.test(t)?h.xLabel="Batch":/epoch/i.test(t)&&(h.xLabel="Epoch");const n=[],r=[];for(const a of e)if(null!=c[a]){r.push(a);const e=l(i,t,a);e.push({[a]:c[a]}),n.push(e)}s(o.subSurface(u,t,{title:t}),n,r,h),yield a.nextFrame()}))}(t)})),d}},8777:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n(34115),a=n(11447),o=n(56557),s=n(26513),c=n(99151);function u(t){let e;if(Array.isArray(t.outputShape[0])){const n=t.outputShape.map((t=>l(t)));e="[".concat(n.join(", "),"]")}else e=l(t.outputShape);return{name:t.name,trainable:t.trainable,parameters:t.countParams(),outputShape:e}}function l(t){const e=t.slice();return 0===e.length?"Scalar":(null===e[0]&&(e[0]="batch"),"[".concat(e.join(","),"]"))}e.modelSummary=function(t,e){return r(this,void 0,void 0,(function*(){const n=a.getDrawArea(t),r=function(t){return{layers:t.layers.map(u)}}(e),i=r.layers.map((t=>[t.name,t.outputShape,t.parameters,t.trainable]));o.table(n,{headers:["Layer Name","Output Shape","# Of Params","Trainable"],values:i})}))},e.layer=function(t,e){return r(this,void 0,void 0,(function*(){const n=a.getDrawArea(t),u=yield function(t){return r(this,void 0,void 0,(function*(){const e=t.getWeights(),n=t.weights,r=e.map(c.tensorStats),i=yield Promise.all(r),a=e.map((t=>t.shape));return e.map(((t,e)=>({name:n[e].name,stats:i[e],shape:l(a[e]),weight:t})))}))}(e),h=s.subSurface(n,"layer-weights-info"),d=u.map((t=>[t.name,t.shape,t.stats.min,t.stats.max,t.weight.size,t.stats.numZeros,t.stats.numNans,t.stats.numInfs]));o.table(h,{headers:["Weight Name","Shape","Min","Max","# Params","# Zeros","# NaNs","# Infinity"],values:d});const f=s.subSurface(n,"select-layer"),p=s.subSurface(n,"param-distribution");!function(t,e,n){const r="\n    <select>\n      ".concat(t.map((t=>"<option value=".concat(t,">").concat(t,"</option>"))),"\n    </select>\n  "),i="<div>".concat("<button>Show Values Distribution for:</button>").concat(r,"</div>");e.innerHTML=i;const a=e.querySelector("button"),o=e.querySelector("select");a.addEventListener("click",(()=>{n(o.selectedOptions[0].label)}))}(u.map((t=>t.name)),f,(t=>r(this,void 0,void 0,(function*(){const e=u.filter((e=>e.name===t))[0],n=yield e.weight.data();i.histogram(p,n,{height:150,width:460,stats:!1})}))))}))}},56957:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n(11447),a=n(56557);e.perClassAccuracy=function(t,e,n){return r(this,void 0,void 0,(function*(){const r=i.getDrawArea(t),o=[];for(let t=0;t<e.length;t++){const r=n?n[t]:t.toString(),i=e[t];o.push([r,i.accuracy,i.count])}return a.table(r,{headers:["Class","Accuracy","# Samples"],values:o})}))}},35927:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n(34115),a=n(11447),o=n(99151);e.valuesDistribution=function(t,e){return r(this,void 0,void 0,(function*(){const n=a.getDrawArea(t),r=yield o.tensorStats(e),s=yield e.data();i.histogram(n,s,{height:150,stats:r})}))}},55525:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isSurfaceInfo=function(t){return null!=t.name},e.isSurface=function(t){return t.drawArea instanceof HTMLElement}},26513:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(17975),i=n(11447),a={prepend:!1};e.subSurface=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=i.getDrawArea(t),s=r.css({"& canvas":{display:"block"},marginTop:".5rem",marginBottom:".5rem"}),c=r.css({backgroundColor:"white",display:"inline-block",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",padding:"0 10px 0 10px",marginBottom:"20px",fontWeight:"600",textAlign:"left"}),u=Object.assign({},a,n);let l=o.querySelector("div[data-name=".concat(e,"]"));if(!l){if(l=document.createElement("div"),l.setAttribute("class","".concat(s)),l.dataset.name=e,u.title){const t=document.createElement("div");t.setAttribute("class","subsurface-title ".concat(c)),t.innerText=u.title,l.appendChild(t)}u.prepend?o.insertBefore(l,o.firstChild):o.appendChild(l)}return l},e.getDefaultWidth=function(t){let e=0,n=t;for(;n&&0===n.clientWidth;)n=n.parentElement,e=50;return n.clientWidth-e},e.getDefaultHeight=function(t){return 0===t.clientHeight?200:t.clientHeight}},99151:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n(37837),a=n(27332);e.arrayStats=function(t){if(!Array.isArray(t))throw new Error("input must be an array");if(0===t.length)return{numVals:0,numNans:0,numZeros:0,max:void 0,min:void 0};const e=t.length;let n=-1/0,r=1/0,i=0,a=0,o=0;for(let c=0;c<e;c++){const e=t[c];e>n&&(n=e),e<r&&(r=e),0===e&&(i+=1),isNaN(e)?a+=1:isFinite(e)||(o+=1)}const s={numVals:e,numZeros:i,numNans:a,max:n,min:r,numInfs:o};return s.max===-1/0&&(s.max=NaN),s.min===1/0&&(s.min=NaN),s},e.tensorStats=function(t){return r(this,void 0,void 0,(function*(){const[e,n,r]=i.tidy((()=>{const e=i.scalar(0,t.dtype);return[t.min(),t.max(),t.equal(e).sum()]}));return Promise.all([t.data(),e.data(),n.data(),r.data()]).then((t=>{let[e,n,r,i]=t;const a=e.length;let o=0,s=0;for(let l=0;l<a;l++){const t=e[l];isNaN(t)?o+=1:isFinite(t)||(s+=1)}let c=n[0],u=r[0];o===a&&(c=NaN,u=NaN);return{numVals:a,numZeros:i[0],numNans:o,min:c,max:u,numInfs:s}}))}))},e.confusionMatrix=function(t,e,n,o){return r(this,void 0,void 0,(function*(){a.assert(1===t.rank,"labels must be a 1D tensor"),a.assert(1===e.rank,"predictions must be a 1D tensor"),a.assert(t.size===e.size,"labels and predictions must be the same length"),null!=o&&a.assert(o.size===e.size,"labels and predictions must be the same length");const r=t.cast("int32"),s=e.cast("int32");null==n&&(n=i.tidy((()=>i.maximum(r.max(),s.max()).cast("int32").dataSync()[0]+1)));let c=Promise.resolve(null);return null!=o&&(c=o.data()),Promise.all([r.data(),s.data(),c]).then((t=>{let[e,r,i]=t;const a=Array(n).fill(0);for(let o=0;o<n;o++)a[o]=Array(n).fill(0);for(let n=0;n<e.length;n++){const t=e[n],o=r[n];a[t][o]+=null!=i?i[n]:1}return a}))}))},e.accuracy=function(t,e){return r(this,void 0,void 0,(function*(){a.assertShapesMatch(t.shape,e.shape,"Error computing accuracy.");const n=t.equal(e),r=n.mean(),o=(yield r.data())[0];return i.dispose([n,r]),o}))},e.perClassAccuracy=function(t,e,n){return r(this,void 0,void 0,(function*(){return a.assert(1===t.rank,"labels must be a 1D tensor"),a.assert(1===e.rank,"predictions must be a 1D tensor"),a.assert(t.size===e.size,"labels and predictions must be the same length"),null==n&&(n=i.tidy((()=>i.maximum(t.max(),e.max()).dataSync()[0]+1))),Promise.all([t.data(),e.data()]).then((t=>{let[e,r]=t;const i=Array(n).fill(0),a=Array(n).fill(0);for(let n=0;n<e.length;n++){const t=e[n],o=r[n];i[t]+=1,t===o&&(a[t]+=1)}const o=[];for(let n=0;n<i.length;n++)o.push({count:i[n],accuracy:0===i[n]?0:a[n]/i[n]});return o}))}))}},27332:(t,e)=>{"use strict";function n(t,e){if(!t)throw new Error("string"===typeof e?e:e())}function r(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}Object.defineProperty(e,"__esModule",{value:!0}),e.assert=n,e.assertShapesMatch=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";n(r(t,e),i+" Shapes ".concat(t," and ").concat(e," must match"))},e.arraysEqual=r,e.DECIMAL_PLACES_TO_CHECK=4},15884:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.version="1.5.1"},67543:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(89570);let i;const a="tfjs-visor-container";e.visor=function(){if("undefined"===typeof document)throw new Error("No document defined. This library needs a browser/dom to work");if(document.getElementById(a)&&null!=i)return i;let t,e=document.getElementById(a);function n(e,n){let i=null;return t=r.VisorComponent.render(e,t,{ref:t=>i=t,surfaceList:Array.from(n.values())}),i}null==e&&(e=document.createElement("div"),e.id=a,document.body.appendChild(e));const s=new Map,c=n(e,s);return i=new o(c,e,s,n),i};class o{constructor(t,e,n,r){this.visorComponent=t,this.el=e,this.surfaceList=n,this.renderVisor=r}surface(t){const{name:e}=t,n=null==t.tab?"Visor":t.tab;if(null==e||!("string"===typeof e||e instanceof String))throw new Error("You must pass a config object with a 'name' property to create or retrieve a surface");const r=Object.assign({},t,{tab:n}),i="".concat(e,"-").concat(n);return this.surfaceList.has(i)||this.surfaceList.set(i,r),this.renderVisor(this.el,this.surfaceList),this.visorComponent.getSurface(e,n)}isFullscreen(){return this.visorComponent.isFullscreen()}isOpen(){return this.visorComponent.isOpen()}close(){return this.visorComponent.close()}open(){return this.visorComponent.open()}toggle(){return this.visorComponent.toggle()}toggleFullScreen(){return this.visorComponent.toggleFullScreen()}bindKeys(){return this.visorComponent.bindKeys()}unbindKeys(){return this.visorComponent.unbindKeys()}setActiveTab(t){if(!this.visorComponent.state.tabs.has(t))throw new Error("Tab '".concat(t,"' does not exist"));this.visorComponent.setState({activeTab:t})}}e.Visor=o},67637:(t,e,n)=>{"use strict";function r(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function i(t){return(t=r(Math.abs(t)))?t[1]:NaN}n.r(e),n.d(e,{format:()=>f,formatDefaultLocale:()=>y,formatLocale:()=>m,formatPrefix:()=>p,formatSpecifier:()=>s,precisionFixed:()=>v,precisionPrefix:()=>b,precisionRound:()=>x});var a,o=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function s(t){return new c(t)}function c(t){if(!(e=o.exec(t)))throw new Error("invalid format: "+t);var e;this.fill=e[1]||" ",this.align=e[2]||">",this.sign=e[3]||"-",this.symbol=e[4]||"",this.zero=!!e[5],this.width=e[6]&&+e[6],this.comma=!!e[7],this.precision=e[8]&&+e[8].slice(1),this.trim=!!e[9],this.type=e[10]||""}function u(t,e){var n=r(t,e);if(!n)return t+"";var i=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+i:i.length>a+1?i.slice(0,a+1)+"."+i.slice(a+1):i+new Array(a-i.length+2).join("0")}s.prototype=c.prototype,c.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const l={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return u(100*t,e)},r:u,s:function(t,e){var n=r(t,e);if(!n)return t+"";var i=n[0],o=n[1],s=o-(a=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,c=i.length;return s===c?i:s>c?i+new Array(s-c+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+r(t,Math.max(0,e+s-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function h(t){return t}var d,f,p,g=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function m(t){var e,n,r=t.grouping&&t.thousands?(e=t.grouping,n=t.thousands,function(t,r){for(var i=t.length,a=[],o=0,s=e[0],c=0;i>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),a.push(t.substring(i-=s,i+s)),!((c+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}):h,o=t.currency,c=t.decimal,u=t.numerals?function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(t.numerals):h,d=t.percent||"%";function f(t){var e=(t=s(t)).fill,n=t.align,i=t.sign,h=t.symbol,f=t.zero,p=t.width,m=t.comma,y=t.precision,v=t.trim,b=t.type;"n"===b?(m=!0,b="g"):l[b]||(null==y&&(y=12),v=!0,b="g"),(f||"0"===e&&"="===n)&&(f=!0,e="0",n="=");var x="$"===h?o[0]:"#"===h&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",w="$"===h?o[1]:/[%p]/.test(b)?d:"",k=l[b],_=/[defgprs%]/.test(b);function S(t){var o,s,l,h=x,d=w;if("c"===b)d=k(t)+d,t="";else{var S=(t=+t)<0;if(t=k(Math.abs(t),y),v&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(i>0){if(!+t[r])break t;i=0}}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),S&&0===+t&&(S=!1),h=(S?"("===i?i:"-":"-"===i||"("===i?"":i)+h,d=("s"===b?g[8+a/3]:"")+d+(S&&"("===i?")":""),_)for(o=-1,s=t.length;++o<s;)if(48>(l=t.charCodeAt(o))||l>57){d=(46===l?c+t.slice(o+1):t.slice(o))+d,t=t.slice(0,o);break}}m&&!f&&(t=r(t,1/0));var A=h.length+t.length+d.length,C=A<p?new Array(p-A+1).join(e):"";switch(m&&f&&(t=r(C+t,C.length?p-d.length:1/0),C=""),n){case"<":t=h+t+d+C;break;case"=":t=h+C+t+d;break;case"^":t=C.slice(0,A=C.length>>1)+h+t+d+C.slice(A);break;default:t=C+h+t+d}return u(t)}return y=null==y?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y)),S.toString=function(){return t+""},S}return{format:f,formatPrefix:function(t,e){var n=f(((t=s(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(i(e)/3))),a=Math.pow(10,-r),o=g[8+r/3];return function(t){return n(a*t)+o}}}}function y(t){return d=m(t),f=d.format,p=d.formatPrefix,d}function v(t){return Math.max(0,-i(Math.abs(t)))}function b(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(i(e)/3)))-i(Math.abs(t)))}function x(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,i(e)-i(t))+1}y({decimal:".",thousands:",",grouping:[3],currency:["$",""]})},32129:t=>{var e=function(){"use strict";function t(t,e){return null!=e&&t instanceof e}var e,n,r;try{e=Map}catch(s){e=function(){}}try{n=Set}catch(s){n=function(){}}try{r=Promise}catch(s){r=function(){}}function i(a,s,c,u,l){"object"===typeof s&&(c=s.depth,u=s.prototype,l=s.includeNonEnumerable,s=s.circular);var h=[],d=[],f="undefined"!=typeof Buffer;return"undefined"==typeof s&&(s=!0),"undefined"==typeof c&&(c=1/0),function a(c,p){if(null===c)return null;if(0===p)return c;var g,m;if("object"!=typeof c)return c;if(t(c,e))g=new e;else if(t(c,n))g=new n;else if(t(c,r))g=new r((function(t,e){c.then((function(e){t(a(e,p-1))}),(function(t){e(a(t,p-1))}))}));else if(i.__isArray(c))g=[];else if(i.__isRegExp(c))g=new RegExp(c.source,o(c)),c.lastIndex&&(g.lastIndex=c.lastIndex);else if(i.__isDate(c))g=new Date(c.getTime());else{if(f&&Buffer.isBuffer(c))return g=Buffer.allocUnsafe?Buffer.allocUnsafe(c.length):new Buffer(c.length),c.copy(g),g;t(c,Error)?g=Object.create(c):"undefined"==typeof u?(m=Object.getPrototypeOf(c),g=Object.create(m)):(g=Object.create(u),m=u)}if(s){var y=h.indexOf(c);if(-1!=y)return d[y];h.push(c),d.push(g)}for(var v in t(c,e)&&c.forEach((function(t,e){var n=a(e,p-1),r=a(t,p-1);g.set(n,r)})),t(c,n)&&c.forEach((function(t){var e=a(t,p-1);g.add(e)})),c){var b;m&&(b=Object.getOwnPropertyDescriptor(m,v)),b&&null==b.set||(g[v]=a(c[v],p-1))}if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(c);for(v=0;v<x.length;v++){var w=x[v];(!(_=Object.getOwnPropertyDescriptor(c,w))||_.enumerable||l)&&(g[w]=a(c[w],p-1),_.enumerable||Object.defineProperty(g,w,{enumerable:!1}))}}if(l){var k=Object.getOwnPropertyNames(c);for(v=0;v<k.length;v++){var _,S=k[v];(_=Object.getOwnPropertyDescriptor(c,S))&&_.enumerable||(g[S]=a(c[S],p-1),Object.defineProperty(g,S,{enumerable:!1}))}}return g}(a,c)}function a(t){return Object.prototype.toString.call(t)}function o(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return i.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},i.__objToStr=a,i.__isDate=function(t){return"object"===typeof t&&"[object Date]"===a(t)},i.__isArray=function(t){return"object"===typeof t&&"[object Array]"===a(t)},i.__isRegExp=function(t){return"object"===typeof t&&"[object RegExp]"===a(t)},i.__getRegExpFlags=o,i}();t.exports&&(t.exports=e)},61243:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return(0,a.default)(t)};var r,i=n(73231),a=(r=i)&&r.__esModule?r:{default:r};t.exports=e.default},53584:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return"string"===typeof t&&n.test(t)};var n=/-webkit-|-moz-|-ms-/;t.exports=e.default},27954:(t,e,n)=>{"use strict";n.r(e),n.d(e,{clientPoint:()=>_t,create:()=>vt,creator:()=>c,customEvent:()=>ut,event:()=>it,local:()=>xt,matcher:()=>m,mouse:()=>St,namespace:()=>a,namespaces:()=>i,select:()=>yt,selectAll:()=>At,selection:()=>mt,selector:()=>l,selectorAll:()=>d,style:()=>M,touch:()=>Ct,touches:()=>Et,window:()=>N});var r="http://www.w3.org/1999/xhtml";const i={svg:"http://www.w3.org/2000/svg",xhtml:r,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function a(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),i.hasOwnProperty(e)?{space:i[e],local:t}:t}function o(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===r&&e.documentElement.namespaceURI===r?e.createElement(t):e.createElementNS(n,t)}}function s(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function c(t){var e=a(t);return(e.local?s:o)(e)}function u(){}function l(t){return null==t?u:function(){return this.querySelector(t)}}function h(){return[]}function d(t){return null==t?h:function(){return this.querySelectorAll(t)}}var f=function(t){return function(){return this.matches(t)}};if("undefined"!==typeof document){var p=document.documentElement;if(!p.matches){var g=p.webkitMatchesSelector||p.msMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector;f=function(t){return function(){return g.call(this,t)}}}}const m=f;function y(t){return new Array(t.length)}function v(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}v.prototype={constructor:v,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var b="$";function x(t,e,n,r,i,a){for(var o,s=0,c=e.length,u=a.length;s<u;++s)(o=e[s])?(o.__data__=a[s],r[s]=o):n[s]=new v(t,a[s]);for(;s<c;++s)(o=e[s])&&(i[s]=o)}function w(t,e,n,r,i,a,o){var s,c,u,l={},h=e.length,d=a.length,f=new Array(h);for(s=0;s<h;++s)(c=e[s])&&(f[s]=u=b+o.call(c,c.__data__,s,e),u in l?i[s]=c:l[u]=c);for(s=0;s<d;++s)(c=l[u=b+o.call(t,a[s],s,a)])?(r[s]=c,c.__data__=a[s],l[u]=null):n[s]=new v(t,a[s]);for(s=0;s<h;++s)(c=e[s])&&l[f[s]]===c&&(i[s]=c)}function k(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function _(t){return function(){this.removeAttribute(t)}}function S(t){return function(){this.removeAttributeNS(t.space,t.local)}}function A(t,e){return function(){this.setAttribute(t,e)}}function C(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function E(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function T(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function N(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function D(t){return function(){this.style.removeProperty(t)}}function F(t,e,n){return function(){this.style.setProperty(t,e,n)}}function I(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function M(t,e){return t.style.getPropertyValue(e)||N(t).getComputedStyle(t,null).getPropertyValue(e)}function O(t){return function(){delete this[t]}}function R(t,e){return function(){this[t]=e}}function z(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function B(t){return t.trim().split(/^|\s+/)}function L(t){return t.classList||new P(t)}function P(t){this._node=t,this._names=B(t.getAttribute("class")||"")}function j(t,e){for(var n=L(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function U(t,e){for(var n=L(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function W(t){return function(){j(this,t)}}function V(t){return function(){U(this,t)}}function q(t,e){return function(){(e.apply(this,arguments)?j:U)(this,t)}}function G(){this.textContent=""}function H(t){return function(){this.textContent=t}}function Y(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function X(){this.innerHTML=""}function K(t){return function(){this.innerHTML=t}}function $(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Z(){this.nextSibling&&this.parentNode.appendChild(this)}function Q(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function J(){return null}function tt(){var t=this.parentNode;t&&t.removeChild(this)}function et(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function nt(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}P.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var rt={},it=null;"undefined"!==typeof document&&("onmouseenter"in document.documentElement||(rt={mouseenter:"mouseover",mouseleave:"mouseout"}));function at(t,e,n){return t=ot(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function ot(t,e,n){return function(r){var i=it;it=r;try{t.call(this,this.__data__,e,n)}finally{it=i}}}function st(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,a=e.length;r<a;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function ct(t,e,n){var r=rt.hasOwnProperty(t.type)?at:ot;return function(i,a,o){var s,c=this.__on,u=r(e,a,o);if(c)for(var l=0,h=c.length;l<h;++l)if((s=c[l]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=u,s.capture=n),void(s.value=e);this.addEventListener(t.type,u,n),s={type:t.type,name:t.name,value:e,listener:u,capture:n},c?c.push(s):this.__on=[s]}}function ut(t,e,n,r){var i=it;t.sourceEvent=it,it=t;try{return e.apply(n,r)}finally{it=i}}function lt(t,e,n){var r=N(t),i=r.CustomEvent;"function"===typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function ht(t,e){return function(){return lt(this,t,e)}}function dt(t,e){return function(){return lt(this,t,e.apply(this,arguments))}}var ft=[null];function pt(t,e){this._groups=t,this._parents=e}function gt(){return new pt([[document.documentElement]],ft)}pt.prototype=gt.prototype={constructor:pt,select:function(t){"function"!==typeof t&&(t=l(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o,s=e[i],c=s.length,u=r[i]=new Array(c),h=0;h<c;++h)(a=s[h])&&(o=t.call(a,a.__data__,h,s))&&("__data__"in a&&(o.__data__=a.__data__),u[h]=o);return new pt(r,this._parents)},selectAll:function(t){"function"!==typeof t&&(t=d(t));for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var o,s=e[a],c=s.length,u=0;u<c;++u)(o=s[u])&&(r.push(t.call(o,o.__data__,u,s)),i.push(o));return new pt(r,i)},filter:function(t){"function"!==typeof t&&(t=m(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,c=r[i]=[],u=0;u<s;++u)(a=o[u])&&t.call(a,a.__data__,u,o)&&c.push(a);return new pt(r,this._parents)},data:function(t,e){if(!t)return p=new Array(this.size()),l=-1,this.each((function(t){p[++l]=t})),p;var n,r=e?w:x,i=this._parents,a=this._groups;"function"!==typeof t&&(n=t,t=function(){return n});for(var o=a.length,s=new Array(o),c=new Array(o),u=new Array(o),l=0;l<o;++l){var h=i[l],d=a[l],f=d.length,p=t.call(h,h&&h.__data__,l,i),g=p.length,m=c[l]=new Array(g),y=s[l]=new Array(g);r(h,d,m,y,u[l]=new Array(f),p,e);for(var v,b,k=0,_=0;k<g;++k)if(v=m[k]){for(k>=_&&(_=k+1);!(b=y[_])&&++_<g;);v._next=b||null}}return(s=new pt(s,i))._enter=c,s._exit=u,s},enter:function(){return new pt(this._enter||this._groups.map(y),this._parents)},exit:function(){return new pt(this._exit||this._groups.map(y),this._parents)},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var c,u=e[s],l=n[s],h=u.length,d=o[s]=new Array(h),f=0;f<h;++f)(c=u[f]||l[f])&&(d[f]=c);for(;s<r;++s)o[s]=e[s];return new pt(o,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&o!==r.nextSibling&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=k);for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o,s=n[a],c=s.length,u=i[a]=new Array(c),l=0;l<c;++l)(o=s[l])&&(u[l]=o);u.sort(e)}return new pt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,a=e[n],o=0,s=a.length;o<s;++o)(i=a[o])&&t.call(i,i.__data__,o,a);return this},attr:function(t,e){var n=a(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?S:_:"function"===typeof e?n.local?T:E:n.local?C:A)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?D:"function"===typeof e?I:F)(t,e,null==n?"":n)):M(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?O:"function"===typeof e?z:R)(t,e)):this.node()[t]},classed:function(t,e){var n=B(t+"");if(arguments.length<2){for(var r=L(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"===typeof e?q:e?W:V)(n,e))},text:function(t){return arguments.length?this.each(null==t?G:("function"===typeof t?Y:H)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?X:("function"===typeof t?$:K)(t)):this.node().innerHTML},raise:function(){return this.each(Z)},lower:function(){return this.each(Q)},append:function(t){var e="function"===typeof t?t:c(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"===typeof t?t:c(t),r=null==e?J:"function"===typeof e?e:l(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(tt)},clone:function(t){return this.select(t?nt:et)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,a=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}(t+""),o=a.length;if(!(arguments.length<2)){for(s=e?ct:st,null==n&&(n=!1),r=0;r<o;++r)this.each(s(a[r],e,n));return this}var s=this.node().__on;if(s)for(var c,u=0,l=s.length;u<l;++u)for(r=0,c=s[u];r<o;++r)if((i=a[r]).type===c.type&&i.name===c.name)return c.value},dispatch:function(t,e){return this.each(("function"===typeof e?dt:ht)(t,e))}};const mt=gt;function yt(t){return"string"===typeof t?new pt([[document.querySelector(t)]],[document.documentElement]):new pt([[t]],ft)}function vt(t){return yt(c(t).call(document.documentElement))}var bt=0;function xt(){return new wt}function wt(){this._="@"+(++bt).toString(36)}function kt(){for(var t,e=it;t=e.sourceEvent;)e=t;return e}function _t(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}function St(t){var e=kt();return e.changedTouches&&(e=e.changedTouches[0]),_t(t,e)}function At(t){return"string"===typeof t?new pt([document.querySelectorAll(t)],[document.documentElement]):new pt([null==t?[]:t],ft)}function Ct(t,e,n){arguments.length<3&&(n=e,e=kt().changedTouches);for(var r,i=0,a=e?e.length:0;i<a;++i)if((r=e[i]).identifier===n)return _t(t,r);return null}function Et(t,e){null==e&&(e=kt().touches);for(var n=0,r=e?e.length:0,i=new Array(r);n<r;++n)i[n]=_t(t,e[n]);return i}wt.prototype=xt.prototype={constructor:wt,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}}},45355:t=>{"use strict";t.exports=function t(e,n){if(e===n)return!0;if(e&&n&&"object"==typeof e&&"object"==typeof n){if(e.constructor!==n.constructor)return!1;var r,i,a;if(Array.isArray(e)){if((r=e.length)!=n.length)return!1;for(i=r;0!==i--;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if((r=(a=Object.keys(e)).length)!==Object.keys(n).length)return!1;for(i=r;0!==i--;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return!1;for(i=r;0!==i--;){var o=a[i];if(!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n}},14110:t=>{"use strict";t.exports=function(t,e){e||(e={}),"function"===typeof e&&(e={cmp:e});var n,r="boolean"===typeof e.cycles&&e.cycles,i=e.cmp&&(n=e.cmp,function(t){return function(e,r){var i={key:e,value:t[e]},a={key:r,value:t[r]};return n(i,a)}}),a=[];return function t(e){if(e&&e.toJSON&&"function"===typeof e.toJSON&&(e=e.toJSON()),void 0!==e){if("number"==typeof e)return isFinite(e)?""+e:"null";if("object"!==typeof e)return JSON.stringify(e);var n,o;if(Array.isArray(e)){for(o="[",n=0;n<e.length;n++)n&&(o+=","),o+=t(e[n])||"null";return o+"]"}if(null===e)return"null";if(-1!==a.indexOf(e)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=a.push(e)-1,c=Object.keys(e).sort(i&&i(e));for(o="",n=0;n<c.length;n++){var u=c[n],l=t(e[u]);l&&(o&&(o+=","),o+=JSON.stringify(u)+":"+l)}return a.splice(s,1),"{"+o+"}"}}(t)}},76866:t=>{"use strict";var e=/-(.)/g;t.exports=function(t){return t.replace(e,(function(t,e){return e.toUpperCase()}))}},29522:(t,e,n)=>{"use strict";var r=n(76866),i=/^-ms-/;t.exports=function(t){return r(t.replace(i,"ms-"))}},10601:t=>{"use strict";function e(t){return function(){return t}}var n=function(){};n.thatReturns=e,n.thatReturnsFalse=e(!1),n.thatReturnsTrue=e(!0),n.thatReturnsNull=e(null),n.thatReturnsThis=function(){return this},n.thatReturnsArgument=function(t){return t},t.exports=n},54836:t=>{"use strict";var e=/([A-Z])/g;t.exports=function(t){return t.replace(e,"-$1").toLowerCase()}},90184:(t,e,n)=>{"use strict";var r=n(54836),i=/^ms-/;t.exports=function(t){return r(t).replace(i,"-ms-")}},75899:t=>{"use strict";t.exports=function(t){var e={};return function(n){return e.hasOwnProperty(n)||(e[n]=t.call(this,n)),e[n]}}},77600:(t,e,n)=>{"use strict";var r=n(10601);t.exports=r},64822:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowStart:!0,gridRowEnd:!0,gridColumn:!0,gridColumnStart:!0,gridColumnEnd:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};var r=["Webkit","ms","Moz","O"];Object.keys(n).forEach((function(t){r.forEach((function(e){n[function(t,e){return t+e.charAt(0).toUpperCase()+e.substring(1)}(e,t)]=n[t]}))}));var i={isUnitlessNumber:n,shorthandPropertyExpansions:{background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}}};e.default=i},20514:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(n(64822));i(n(77600));function i(t){return t&&t.__esModule?t:{default:t}}var a=r.default.isUnitlessNumber;e.default=function(t,e,n){return null==e||"boolean"===typeof e||""===e?"":isNaN(e)||0===e||a.hasOwnProperty(t)&&a[t]?""+e:("string"===typeof e&&(e=e.trim()),e+"px")}},8484:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.processStyleName=void 0,e.createMarkupForStyles=function(t,e){var n="";for(var i in t){var a=0===i.indexOf("--");if(t.hasOwnProperty(i)&&"label"!==i){var o=t[i];0,null!=o&&(a?n+=i+":"+o+";":(n+=s(i)+":",n+=(0,r.default)(i,o,e)+";"))}}return n||null};o(n(29522));var r=o(n(20514)),i=o(n(90184)),a=o(n(75899));o(n(77600));function o(t){return t&&t.__esModule?t:{default:t}}var s=e.processStyleName=(0,a.default)(i.default)},66678:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function r(t){if(function(t){return null===t||void 0===t||!1===t||"object"===("undefined"===typeof t?"undefined":n(t))&&0===Object.keys(t).length}(t))return null;if("object"!==("undefined"===typeof t?"undefined":n(t)))return t;for(var e={},r=Object.keys(t),a=!1,o=0;o<r.length;o++){var s=t[r[o]],c=i(s);null!==c&&c===s||(a=!0),null!==c&&(e[r[o]]=c)}return 0===Object.keys(e).length?null:a?e:t}function i(t){return Array.isArray(t)?function(t){var e=!1,n=[];return t.forEach((function(t){var r=i(t);null!==r&&r===t||(e=!0),null!==r&&n.push(r)})),0==n.length?null:e?n:t}(t):r(t)}e.default=i},70259:(t,e)=>{"use strict";function n(t,e){return t.charCodeAt(e++)+(t.charCodeAt(e++)<<8)+(t.charCodeAt(e++)<<16)+(t.charCodeAt(e)<<24)}function r(t,e){return t.charCodeAt(e++)+(t.charCodeAt(e++)<<8)}function i(t,e){return(65535&(t|=0))*(e|=0)+(((t>>>16)*e&65535)<<16)|0}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var a=1540483477,o=e^t.length,s=t.length,c=0;for(;s>=4;){var u=n(t,c);u=i(u,a),u=i(u^=u>>>24,a),o=i(o,a),o^=u,c+=4,s-=4}switch(s){case 3:o^=r(t,c),o=i(o^=t.charCodeAt(c+2)<<16,a);break;case 2:o=i(o^=r(t,c),a);break;case 1:o=i(o^=t.charCodeAt(c),a)}return o=i(o^=o>>>13,a),(o^=o>>>15)>>>0}},17975:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.compose=e.merge=e.$=e.style=e.presets=e.keyframes=e.fontFace=e.insertGlobal=e.insertRule=e.plugins=e.styleSheet=void 0,e.speedy=function(t){return h.speedy(t)},e.simulations=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];m=!!t},e.simulate=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(!(e=(0,o.default)(e)))return{};if(!m)return y||(console.warn("can't simulate without once calling simulations(true)"),y=!0),f||p||v||(console.warn("don't use simulation outside dev"),v=!0),{};return e.reduce((function(t,e){return t["data-simulate-"+x(e)]="",t}),{})},e.cssLabels=function(t){b=!!t},e.isLikeRule=k,e.idFor=_,e.css=H,e.rehydrate=function(t){(0,r.default)(D,t.reduce((function(t,e){return t[e]=!0,t}),{}))},e.flush=function(){D=h.inserted={},F=h.registered={},M={},h.flush(),h.inject()},e.select=X,e.parent=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return H(l({},t+" &",n))},e.media=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return H(l({},"@media "+t,n))},e.pseudo=K,e.active=function(t){return K(":active",t)},e.any=function(t){return K(":any",t)},e.checked=function(t){return K(":checked",t)},e.disabled=function(t){return K(":disabled",t)},e.empty=function(t){return K(":empty",t)},e.enabled=function(t){return K(":enabled",t)},e._default=function(t){return K(":default",t)},e.first=function(t){return K(":first",t)},e.firstChild=function(t){return K(":first-child",t)},e.firstOfType=function(t){return K(":first-of-type",t)},e.fullscreen=function(t){return K(":fullscreen",t)},e.focus=function(t){return K(":focus",t)},e.hover=function(t){return K(":hover",t)},e.indeterminate=function(t){return K(":indeterminate",t)},e.inRange=function(t){return K(":in-range",t)},e.invalid=function(t){return K(":invalid",t)},e.lastChild=function(t){return K(":last-child",t)},e.lastOfType=function(t){return K(":last-of-type",t)},e.left=function(t){return K(":left",t)},e.link=function(t){return K(":link",t)},e.onlyChild=function(t){return K(":only-child",t)},e.onlyOfType=function(t){return K(":only-of-type",t)},e.optional=function(t){return K(":optional",t)},e.outOfRange=function(t){return K(":out-of-range",t)},e.readOnly=function(t){return K(":read-only",t)},e.readWrite=function(t){return K(":read-write",t)},e.required=function(t){return K(":required",t)},e.right=function(t){return K(":right",t)},e.root=function(t){return K(":root",t)},e.scope=function(t){return K(":scope",t)},e.target=function(t){return K(":target",t)},e.valid=function(t){return K(":valid",t)},e.visited=function(t){return K(":visited",t)},e.dir=function(t,e){return K(":dir("+t+")",e)},e.lang=function(t,e){return K(":lang("+t+")",e)},e.not=function(t,e){var n=t.split(",").map((function(t){return t.trim()})).map((function(t){return":not("+t+")"}));if(1===n.length)return K(":not("+t+")",e);return X(n.join(""),e)},e.nthChild=function(t,e){return K(":nth-child("+t+")",e)},e.nthLastChild=function(t,e){return K(":nth-last-child("+t+")",e)},e.nthLastOfType=function(t,e){return K(":nth-last-of-type("+t+")",e)},e.nthOfType=function(t,e){return K(":nth-of-type("+t+")",e)},e.after=function(t){return K("::after",t)},e.before=function(t){return K("::before",t)},e.firstLetter=function(t){return K("::first-letter",t)},e.firstLine=function(t){return K("::first-line",t)},e.selection=function(t){return K("::selection",t)},e.backdrop=function(t){return K("::backdrop",t)},e.placeholder=function(t){return H({"::placeholder":t})},e.cssFor=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return(e=(0,o.default)(e))?e.map((function(t){var e={label:[]};return P(e,{src:t}),N(w(e),T(e)).join("")})).join(""):""},e.attribsFor=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return(e=(0,o.default)(e))?e.map((function(t){_(t);var e=Object.keys(t)[0];return e+'="'+(t[e]||"")+'"'})).join(" "):""};var r=u(n(26470)),i=n(1484),a=n(8484),o=u(n(66678)),s=n(99139),c=u(n(70259));function u(t){return t&&t.__esModule?t:{default:t}}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var h=e.styleSheet=new i.StyleSheet;h.inject();var d=e.plugins=h.plugins=new s.PluginSet([s.prefixes,s.contentWrap,s.fallbacks]);d.media=new s.PluginSet,d.fontFace=new s.PluginSet,d.keyframes=new s.PluginSet([s.prefixes,s.fallbacks]);var f=!1,p=!1,g="undefined"!==typeof window,m=f,y=!1,v=!1;var b=f;function x(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t.toLowerCase().replace(/[^a-z0-9]/g,e)}function w(t){var e=JSON.stringify(t),n=(0,c.default)(e).toString(36);return t.label&&t.label.length>0&&f?x(t.label.join("."),"-")+"-"+n:n}function k(t){var e=Object.keys(t).filter((function(t){return"toString"!==t}));return 1===e.length&&!!/data\-css\-([a-zA-Z0-9\-_]+)/.exec(e[0])}function _(t){var e=Object.keys(t).filter((function(t){return"toString"!==t}));if(1!==e.length)throw new Error("not a rule");var n=/data\-css\-([a-zA-Z0-9\-_]+)/.exec(e[0]);if(!n)throw new Error("not a rule");return n[1]}var S=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function A(t){if(-1===t.indexOf(","))return[t];for(var e,n=[],r=[],i=0;e=S.exec(t);)switch(e[0]){case"(":i++;break;case")":i--;break;case",":if(i)break;n.push(e.index)}for(e=n.length;e--;)r.unshift(t.slice(n[e]+1)),t=t.slice(0,n[e]);return r.unshift(t),r}function C(t,e){if(!t)return e.replace(/\&/g,"");if(!e)return".css-"+t+",[data-css-"+t+"]";var n=A(e).map((function(e){return e.indexOf("&")>=0?[e.replace(/\&/gm,".css-"+t),e.replace(/\&/gm,"[data-css-"+t+"]")].join(","):".css-"+t+e+",[data-css-"+t+"]"+e})).join(",");return m&&/^\&\:/.exec(e)&&!/\s/.exec(e)&&(n+=",.css-"+t+"[data-simulate-"+x(e)+"],[data-css-"+t+"][data-simulate-"+x(e)+"]"),n}function E(t){var e=t.selector,n=t.style,r=d.transform({selector:e,style:n});return r.selector+"{"+(0,a.createMarkupForStyles)(r.style)+"}"}function T(t){var e=void 0,n=void 0,r=void 0,i=void 0;return Object.keys(t).forEach((function(a){a.indexOf("&")>=0?(n=n||{})[a]=t[a]:0===a.indexOf("@media")?(r=r||{})[a]=T(t[a]):0===a.indexOf("@supports")?(i=i||{})[a]=T(t[a]):"label"===a?t.label.length>0&&((e=e||{}).label=b?t.label.join("."):""):(e=e||{})[a]=t[a]})),{plain:e,selects:n,medias:r,supports:i}}function N(t,e){var n=[],r=e.plain,i=e.selects,a=e.medias,o=e.supports;return r&&n.push(E({style:r,selector:C(t)})),i&&Object.keys(i).forEach((function(e){return n.push(E({style:i[e],selector:C(t,e)}))})),a&&Object.keys(a).forEach((function(e){return n.push(e+"{"+N(t,a[e]).join("")+"}")})),o&&Object.keys(o).forEach((function(e){return n.push(e+"{"+N(t,o[e]).join("")+"}")})),n}var D=h.inserted={};var F=h.registered={};function I(t){F[t.id]||(F[t.id]=t)}var M={};function O(t){if(I(t),function(t){if(!D[t.id]){D[t.id]=!0;var e=T(t.style),n=N(t.id,e);D[t.id]=!!g||n,n.forEach((function(t){return h.insert(t)}))}}(t),M[t.id])return M[t.id];var e=l({},"data-css-"+t.id,b&&t.label||"");return Object.defineProperty(e,"toString",{enumerable:!1,value:function(){return"css-"+t.id}}),M[t.id]=e,e}function R(t,e){var n=A(t).map((function(t){return t.indexOf("&")>=0?t:"&"+t})),r=A(e).map((function(t){return t.indexOf("&")>=0?t:"&"+t}));return r.reduce((function(t,e){return t.concat(n.map((function(t){return e.replace(/\&/g,t)})))}),[]).join(",")}function z(t,e){return t?"@supports "+t.substring(9)+" and "+e.substring(9):e}function B(t){for(var e=[],n=0;n<t.length;n++)e=Array.isArray(t[n])?e.concat(B(t[n])):e.concat(t[n]);return e}var L={"::placeholder":["::-webkit-input-placeholder","::-moz-placeholder","::-ms-input-placeholder"],":fullscreen":[":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"]};function P(t,e){var n=e.selector,r=void 0===n?"":n,i=e.mq,a=void 0===i?"":i,s=e.supp,c=void 0===s?"":s,u=e.src,l=void 0===u?{}:u;Array.isArray(l)||(l=[l]),(l=B(l)).forEach((function(e){if(k(e)){var n=function(t){if(k(t)){var e=F[_(t)];if(null==e)throw new Error("[glamor] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79");return e}return t}(e);if("css"!==n.type)throw new Error("cannot merge this rule");e=n.style}(e=(0,o.default)(e))&&e.composes&&P(t,{selector:r,mq:a,supp:c,src:e.composes}),Object.keys(e||{}).forEach((function(n){if(function(t){for(var e=[":",".","[",">"," "],n=!1,r=t.charAt(0),i=0;i<e.length;i++)if(r===e[i]){n=!0;break}return n||t.indexOf("&")>=0}(n))L[n]&&L[n].forEach((function(i){return P(t,{selector:R(r,i),mq:a,supp:c,src:e[n]})})),P(t,{selector:R(r,n),mq:a,supp:c,src:e[n]});else if(function(t){return 0===t.indexOf("@media")}(n))P(t,{selector:r,mq:(o=a,s=n,o?"@media "+o.substring(6)+" and "+s.substring(6):s),supp:c,src:e[n]});else if(function(t){return 0===t.indexOf("@supports")}(n))P(t,{selector:r,mq:a,supp:z(c,n),src:e[n]});else if("composes"===n);else{var i=t;c&&(i[c]=i[c]||{},i=i[c]),a&&(i[a]=i[a]||{},i=i[a]),r&&(i[r]=i[r]||{},i=i[r]),"label"===n?b&&(t.label=t.label.concat(e.label)):i[n]=e[n]}var o,s}))}))}function j(t){var e={label:[]};return P(e,{src:t}),O({id:w(e),style:e,label:b?e.label.join("."):"",type:"css"})}var U={};Object.defineProperty(U,"toString",{enumerable:!1,value:function(){return"css-nil"}});var W="undefined"!==typeof WeakMap?[U,new WeakMap,new WeakMap,new WeakMap]:[U],V=!1;var q,G="undefined"!==typeof WeakMap?(q=j,function(t){if(W[t.length]){for(var e=W[t.length],n=0;n<t.length-1;)e.has(t[n])||e.set(t[n],new WeakMap),e=e.get(t[n]),n++;if(e.has(t[t.length-1])){var r=e.get(t[n]);if(F[r.toString().substring(4)])return r}}var i=q(t);if(W[t.length]){for(var a=0,o=W[t.length];a<t.length-1;)o=o.get(t[a]),a++;try{o.set(t[a],i)}catch(c){var s;f&&!V&&(V=!0,(s=console).warn.apply(s,["failed setting the WeakMap cache for args:"].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(t))),console.warn("this should NOT happen, please file a bug on the github repo."))}}return i}):j;function H(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(e[0]&&e[0].length&&e[0].raw)throw new Error("you forgot to include glamor/babel in your babel plugins.");return(e=(0,o.default)(e))?G(e):U}H.insert=function(t){var e={id:w(t),css:t,type:"raw"};I(e),D[e.id]||(h.insert(e.css),D[e.id]=!!g||[e.css])};e.insertRule=H.insert;H.global=function(t,e){if(e=(0,o.default)(e))return H.insert(E({selector:t,style:e}))};e.insertGlobal=H.global;H.keyframes=function(t,e){e||(e=t,t="animation");var n={id:w({name:t,kfs:e=(0,o.default)(e)||{}}),type:"keyframes",name:t,keyframes:e};return I(n),function(t){if(!D[t.id]){var e=Object.keys(t.keyframes).map((function(e){var n=d.keyframes.transform({id:t.id,name:e,style:t.keyframes[e]});return n.name+"{"+(0,a.createMarkupForStyles)(n.style)+"}"})).join(""),n=["-webkit-","-moz-","-o-",""].map((function(n){return"@"+n+"keyframes "+t.name+"_"+t.id+"{"+e+"}"}));n.forEach((function(t){return h.insert(t)})),D[t.id]=!!g||n}}(n),t+"_"+n.id},H.fontFace=function(t){var e={id:w(t=(0,o.default)(t)),type:"font-face",font:t};return I(e),function(t){if(!D[t.id]){var e="@font-face{"+(0,a.createMarkupForStyles)(t.font)+"}";h.insert(e),D[t.id]=!!g||[e]}}(e),t.fontFamily};e.fontFace=H.fontFace,e.keyframes=H.keyframes;e.presets={mobile:"(min-width: 400px)",Mobile:"@media (min-width: 400px)",phablet:"(min-width: 550px)",Phablet:"@media (min-width: 550px)",tablet:"(min-width: 750px)",Tablet:"@media (min-width: 750px)",desktop:"(min-width: 1000px)",Desktop:"@media (min-width: 1000px)",hd:"(min-width: 1200px)",Hd:"@media (min-width: 1200px)"};var Y=e.style=H;function X(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t?H(l({},t,n)):Y(n)}e.$=X;e.merge=H,e.compose=H;function K(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return H(l({},t,n))}},99139:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};e.PluginSet=c,e.fallbacks=function(t){if(Object.keys(t.style).map((function(e){return Array.isArray(t.style[e])})).indexOf(!0)>=0){var e=t.style,n=Object.keys(e).reduce((function(t,n){return t[n]=Array.isArray(e[n])?e[n].join("; "+(0,a.processStyleName)(n)+": "):e[n],t}),{});return(0,i.default)({},t,{style:n})}return t},e.contentWrap=function(t){if(t.style.content){var e=t.style.content;return u.indexOf(e)>=0||/^(attr|calc|counters?|url)\(/.test(e)?t:e.charAt(0)!==e.charAt(e.length-1)||'"'!==e.charAt(0)&&"'"!==e.charAt(0)?r({},t,{style:r({},t.style,{content:'"'+e+'"'})}):t}return t},e.prefixes=function(t){return(0,i.default)({},t,{style:(0,o.default)(r({},t.style))})};var i=s(n(26470)),a=n(8484),o=s(n(16084));function s(t){return t&&t.__esModule?t:{default:t}}function c(t){this.fns=t||[]}(0,i.default)(c.prototype,{add:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach((function(e){t.fns.indexOf(e)>=0||(t.fns=[e].concat(t.fns))}))},remove:function(t){this.fns=this.fns.filter((function(e){return e!==t}))},clear:function(){this.fns=[]},transform:function(t){return this.fns.reduce((function(t,e){return e(t)}),t)}});var u=["normal","none","counter","open-quote","close-quote","no-open-quote","no-close-quote","initial","inherit"]},16084:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){for(var e in t){var n=t[e],r=(0,a.default)(y,e,n,t,v);r&&(t[e]=r),(0,i.default)(v,e,t)}return t};var r=m(n(48155)),i=m(n(56083)),a=m(n(8713)),o=m(n(19618)),s=m(n(244)),c=m(n(80966)),u=m(n(40699)),l=m(n(83657)),h=m(n(54412)),d=m(n(86407)),f=m(n(97287)),p=m(n(93518)),g=m(n(92995));function m(t){return t&&t.__esModule?t:{default:t}}var y=[s.default,o.default,c.default,l.default,h.default,d.default,f.default,p.default,g.default,u.default],v=r.default.prefixMap},1484:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StyleSheet=f;var r,i=n(26470),a=(r=i)&&r.__esModule?r:{default:r};function o(t){return t[t.length-1]}function s(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}var c="undefined"!==typeof window,u=!1,l=!1,h=function(){if(c){var t=document.createElement("div");return t.innerHTML="\x3c!--[if lt IE 10]><i></i><![endif]--\x3e",1===t.getElementsByTagName("i").length}}();function d(){var t=document.createElement("style");return t.type="text/css",t.setAttribute("data-glamor",""),t.appendChild(document.createTextNode("")),(document.head||document.getElementsByTagName("head")[0]).appendChild(t),t}function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.speedy,n=void 0===e?!u&&!l:e,r=t.maxLength,i=void 0===r?c&&h?4e3:65e3:r;this.isSpeedy=n,this.sheet=void 0,this.tags=[],this.maxLength=i,this.ctr=0}(0,a.default)(f.prototype,{getSheet:function(){return s(o(this.tags))},inject:function(){var t=this;if(this.injected)throw new Error("already injected stylesheet!");c?this.tags[0]=d():this.sheet={cssRules:[],insertRule:function(e){t.sheet.cssRules.push({cssText:e})}},this.injected=!0},speedy:function(t){if(0!==this.ctr)throw new Error("cannot change speedy mode after inserting any rule to sheet. Either call speedy("+t+") earlier in your app, or call flush() before speedy("+t+")");this.isSpeedy=!!t},_insert:function(t){try{var e=this.getSheet();e.insertRule(t,-1!==t.indexOf("@import")?0:e.cssRules.length)}catch(n){u&&console.warn("whoops, illegal rule inserted",t)}},insert:function(t){if(c)if(this.isSpeedy&&this.getSheet().insertRule)this._insert(t);else if(-1!==t.indexOf("@import")){var e=o(this.tags);e.insertBefore(document.createTextNode(t),e.firstChild)}else o(this.tags).appendChild(document.createTextNode(t));else this.sheet.insertRule(t,-1!==t.indexOf("@import")?0:this.sheet.cssRules.length);return this.ctr++,c&&this.ctr%this.maxLength===0&&this.tags.push(d()),this.ctr-1},delete:function(t){return this.replace(t,"")},flush:function(){c?(this.tags.forEach((function(t){return t.parentNode.removeChild(t)})),this.tags=[],this.sheet=null,this.ctr=0):this.sheet.cssRules=[],this.injected=!1},rules:function(){if(!c)return this.sheet.cssRules;var t=[];return this.tags.forEach((function(e){return t.splice.apply(t,[t.length,0].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(Array.from(s(e).cssRules))))})),t}})},73231:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>s});var r=/[A-Z]/g,i=/^ms-/,a={};function o(t){return"-"+t.toLowerCase()}const s=function(t){if(a.hasOwnProperty(t))return a[t];var e=t.replace(r,o);return a[t]=i.test(e)?"-"+e:e}},244:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("string"===typeof e&&!(0,a.default)(e)&&e.indexOf("cross-fade(")>-1)return o.map((function(t){return e.replace(/cross-fade\(/g,t+"cross-fade(")}))};var r,i=n(53584),a=(r=i)&&r.__esModule?r:{default:r};var o=["-webkit-",""];t.exports=e.default},19618:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("cursor"===t&&r.hasOwnProperty(e))return n.map((function(t){return t+e}))};var n=["-webkit-","-moz-",""],r={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};t.exports=e.default},80966:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("string"===typeof e&&!(0,a.default)(e)&&e.indexOf("filter(")>-1)return o.map((function(t){return e.replace(/filter\(/g,t+"filter(")}))};var r,i=n(53584),a=(r=i)&&r.__esModule?r:{default:r};var o=["-webkit-",""];t.exports=e.default},40699:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("display"===t&&n.hasOwnProperty(e))return n[e]};var n={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};t.exports=e.default},83657:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,i){"flexDirection"===t&&"string"===typeof e&&(e.indexOf("column")>-1?i.WebkitBoxOrient="vertical":i.WebkitBoxOrient="horizontal",e.indexOf("reverse")>-1?i.WebkitBoxDirection="reverse":i.WebkitBoxDirection="normal");r.hasOwnProperty(t)&&(i[r[t]]=n[e]||e)};var n={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},r={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};t.exports=e.default},54412:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("string"===typeof e&&!(0,a.default)(e)&&s.test(e))return o.map((function(t){return t+e}))};var r,i=n(53584),a=(r=i)&&r.__esModule?r:{default:r};var o=["-webkit-","-moz-",""],s=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;t.exports=e.default},86407:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("string"===typeof e&&!(0,a.default)(e)&&e.indexOf("image-set(")>-1)return o.map((function(t){return e.replace(/image-set\(/g,t+"image-set(")}))};var r,i=n(53584),a=(r=i)&&r.__esModule?r:{default:r};var o=["-webkit-",""];t.exports=e.default},97287:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("position"===t&&"sticky"===e)return["-webkit-sticky","sticky"]},t.exports=e.default},93518:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if(r.hasOwnProperty(t)&&i.hasOwnProperty(e))return n.map((function(t){return t+e}))};var n=["-webkit-","-moz-",""],r={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},i={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};t.exports=e.default},92995:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n,o){if("string"===typeof e&&s.hasOwnProperty(t)){var u=function(t,e){if((0,i.default)(t))return t;for(var n=t.split(/,(?![^()]*(?:\([^()]*\))?\))/g),a=0,o=n.length;a<o;++a){var s=n[a],u=[s];for(var l in e){var h=(0,r.default)(l);if(s.indexOf(h)>-1&&"order"!==h)for(var d=e[l],f=0,p=d.length;f<p;++f)u.unshift(s.replace(h,c[d[f]]+h))}n[a]=u.join(",")}return n.join(",")}(e,o),l=u.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter((function(t){return!/-moz-|-ms-/.test(t)})).join(",");if(t.indexOf("Webkit")>-1)return l;var h=u.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter((function(t){return!/-webkit-|-ms-/.test(t)})).join(",");return t.indexOf("Moz")>-1?h:(n["Webkit"+(0,a.default)(t)]=l,n["Moz"+(0,a.default)(t)]=h,u)}};var r=o(n(61243)),i=o(n(53584)),a=o(n(52753));function o(t){return t&&t.__esModule?t:{default:t}}var s={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},c={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};t.exports=e.default},48155:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=["Webkit"],r=["Moz"],i=["ms"],a=["Webkit","Moz"],o=["Webkit","ms"],s=["Webkit","Moz","ms"];e.default={plugins:[],prefixMap:{appearance:a,userSelect:s,textEmphasisPosition:n,textEmphasis:n,textEmphasisStyle:n,textEmphasisColor:n,boxDecorationBreak:n,clipPath:n,maskImage:n,maskMode:n,maskRepeat:n,maskPosition:n,maskClip:n,maskOrigin:n,maskSize:n,maskComposite:n,mask:n,maskBorderSource:n,maskBorderMode:n,maskBorderSlice:n,maskBorderWidth:n,maskBorderOutset:n,maskBorderRepeat:n,maskBorder:n,maskType:n,textDecorationStyle:n,textDecorationSkip:n,textDecorationLine:n,textDecorationColor:n,filter:n,fontFeatureSettings:n,breakAfter:s,breakBefore:s,breakInside:s,columnCount:a,columnFill:a,columnGap:a,columnRule:a,columnRuleColor:a,columnRuleStyle:a,columnRuleWidth:a,columns:a,columnSpan:a,columnWidth:a,writingMode:o,flex:n,flexBasis:n,flexDirection:n,flexGrow:n,flexFlow:n,flexShrink:n,flexWrap:n,alignContent:n,alignItems:n,alignSelf:n,justifyContent:n,order:n,transform:n,transformOrigin:n,transformOriginX:n,transformOriginY:n,backfaceVisibility:n,perspective:n,perspectiveOrigin:n,transformStyle:n,transformOriginZ:n,animation:n,animationDelay:n,animationDirection:n,animationFillMode:n,animationDuration:n,animationIterationCount:n,animationName:n,animationPlayState:n,animationTimingFunction:n,backdropFilter:n,fontKerning:n,scrollSnapType:o,scrollSnapPointsX:o,scrollSnapPointsY:o,scrollSnapDestination:o,scrollSnapCoordinate:o,shapeImageThreshold:n,shapeImageMargin:n,shapeImageOutside:n,hyphens:s,flowInto:o,flowFrom:o,regionFragment:o,textAlignLast:r,tabSize:r,wrapFlow:i,wrapThrough:i,wrapMargin:i,gridTemplateColumns:i,gridTemplateRows:i,gridTemplateAreas:i,gridTemplate:i,gridAutoColumns:i,gridAutoRows:i,gridAutoFlow:i,grid:i,gridRowStart:i,gridColumnStart:i,gridRowEnd:i,gridRow:i,gridColumn:i,gridColumnEnd:i,gridColumnGap:i,gridRowGap:i,gridArea:i,gridGap:i,textSizeAdjust:o,borderImage:n,borderImageOutset:n,borderImageRepeat:n,borderImageSlice:n,borderImageSource:n,borderImageWidth:n,transitionDelay:n,transitionDuration:n,transitionProperty:n,transitionTimingFunction:n}},t.exports=e.default},52753:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},t.exports=e.default},56083:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){if(t.hasOwnProperty(e))for(var r=t[e],i=0,o=r.length;i<o;++i)n[r[i]+(0,a.default)(e)]=n[e]};var r,i=n(52753),a=(r=i)&&r.__esModule?r:{default:r};t.exports=e.default},8713:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n,r,i){for(var a=0,o=t.length;a<o;++a){var s=t[a](e,n,r,i);if(s)return s}},t.exports=e.default},61072:t=>{t.exports=n;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(A){}function n(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function r(t){return!0===(t&&t.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var i={},a={};function o(t,e){var n,r,o;return e?(o=0<=(t>>>=0)&&t<256)&&(r=a[t])?r:(n=c(t,(0|t)<0?-1:0,!0),o&&(a[t]=n),n):(o=-128<=(t|=0)&&t<128)&&(r=i[t])?r:(n=c(t,t<0?-1:0,!1),o&&(i[t]=n),n)}function s(t,e){if(isNaN(t))return e?y:m;if(e){if(t<0)return y;if(t>=f)return k}else{if(t<=-p)return _;if(t+1>=p)return w}return t<0?s(-t,e).neg():c(t%d|0,t/d|0,e)}function c(t,e,r){return new n(t,e,r)}n.fromInt=o,n.fromNumber=s,n.fromBits=c;var u=Math.pow;function l(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return m;if("number"===typeof e?(n=e,e=!1):e=!!e,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return l(t.substring(1),e,n).neg();for(var i=s(u(n,8)),a=m,o=0;o<t.length;o+=8){var c=Math.min(8,t.length-o),h=parseInt(t.substring(o,o+c),n);if(c<8){var d=s(u(n,c));a=a.mul(d).add(s(h))}else a=(a=a.mul(i)).add(s(h))}return a.unsigned=e,a}function h(t,e){return"number"===typeof t?s(t,e):"string"===typeof t?l(t,e):c(t.low,t.high,"boolean"===typeof e?e:t.unsigned)}n.fromString=l,n.fromValue=h;var d=4294967296,f=d*d,p=f/2,g=o(1<<24),m=o(0);n.ZERO=m;var y=o(0,!0);n.UZERO=y;var v=o(1);n.ONE=v;var b=o(1,!0);n.UONE=b;var x=o(-1);n.NEG_ONE=x;var w=c(-1,2147483647,!1);n.MAX_VALUE=w;var k=c(-1,-1,!0);n.MAX_UNSIGNED_VALUE=k;var _=c(0,-2147483648,!1);n.MIN_VALUE=_;var S=n.prototype;S.toInt=function(){return this.unsigned?this.low>>>0:this.low},S.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},S.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(_)){var e=s(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var i=s(u(t,6),this.unsigned),a=this,o="";;){var c=a.div(i),l=(a.sub(c.mul(i)).toInt()>>>0).toString(t);if((a=c).isZero())return l+o;for(;l.length<6;)l="0"+l;o=""+l+o}},S.getHighBits=function(){return this.high},S.getHighBitsUnsigned=function(){return this.high>>>0},S.getLowBits=function(){return this.low},S.getLowBitsUnsigned=function(){return this.low>>>0},S.getNumBitsAbs=function(){if(this.isNegative())return this.eq(_)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},S.isZero=function(){return 0===this.high&&0===this.low},S.eqz=S.isZero,S.isNegative=function(){return!this.unsigned&&this.high<0},S.isPositive=function(){return this.unsigned||this.high>=0},S.isOdd=function(){return 1===(1&this.low)},S.isEven=function(){return 0===(1&this.low)},S.equals=function(t){return r(t)||(t=h(t)),(this.unsigned===t.unsigned||this.high>>>31!==1||t.high>>>31!==1)&&(this.high===t.high&&this.low===t.low)},S.eq=S.equals,S.notEquals=function(t){return!this.eq(t)},S.neq=S.notEquals,S.ne=S.notEquals,S.lessThan=function(t){return this.comp(t)<0},S.lt=S.lessThan,S.lessThanOrEqual=function(t){return this.comp(t)<=0},S.lte=S.lessThanOrEqual,S.le=S.lessThanOrEqual,S.greaterThan=function(t){return this.comp(t)>0},S.gt=S.greaterThan,S.greaterThanOrEqual=function(t){return this.comp(t)>=0},S.gte=S.greaterThanOrEqual,S.ge=S.greaterThanOrEqual,S.compare=function(t){if(r(t)||(t=h(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},S.comp=S.compare,S.negate=function(){return!this.unsigned&&this.eq(_)?_:this.not().add(v)},S.neg=S.negate,S.add=function(t){r(t)||(t=h(t));var e=this.high>>>16,n=65535&this.high,i=this.low>>>16,a=65535&this.low,o=t.high>>>16,s=65535&t.high,u=t.low>>>16,l=0,d=0,f=0,p=0;return f+=(p+=a+(65535&t.low))>>>16,d+=(f+=i+u)>>>16,l+=(d+=n+s)>>>16,l+=e+o,c((f&=65535)<<16|(p&=65535),(l&=65535)<<16|(d&=65535),this.unsigned)},S.subtract=function(t){return r(t)||(t=h(t)),this.add(t.neg())},S.sub=S.subtract,S.multiply=function(t){if(this.isZero())return m;if(r(t)||(t=h(t)),e)return c(e.mul(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned);if(t.isZero())return m;if(this.eq(_))return t.isOdd()?_:m;if(t.eq(_))return this.isOdd()?_:m;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(g)&&t.lt(g))return s(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,i=65535&this.high,a=this.low>>>16,o=65535&this.low,u=t.high>>>16,l=65535&t.high,d=t.low>>>16,f=65535&t.low,p=0,y=0,v=0,b=0;return v+=(b+=o*f)>>>16,y+=(v+=a*f)>>>16,v&=65535,y+=(v+=o*d)>>>16,p+=(y+=i*f)>>>16,y&=65535,p+=(y+=a*d)>>>16,y&=65535,p+=(y+=o*l)>>>16,p+=n*f+i*d+a*l+o*u,c((v&=65535)<<16|(b&=65535),(p&=65535)<<16|(y&=65535),this.unsigned)},S.mul=S.multiply,S.divide=function(t){if(r(t)||(t=h(t)),t.isZero())throw Error("division by zero");var n,i,a;if(e)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?c((this.unsigned?e.div_u:e.div_s)(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?y:m;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return y;if(t.gt(this.shru(1)))return b;a=y}else{if(this.eq(_))return t.eq(v)||t.eq(x)?_:t.eq(_)?v:(n=this.shr(1).div(t).shl(1)).eq(m)?t.isNegative()?v:x:(i=this.sub(t.mul(n)),a=n.add(i.div(t)));if(t.eq(_))return this.unsigned?y:m;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();a=m}for(i=this;i.gte(t);){n=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),l=o<=48?1:u(2,o-48),d=s(n),f=d.mul(t);f.isNegative()||f.gt(i);)f=(d=s(n-=l,this.unsigned)).mul(t);d.isZero()&&(d=v),a=a.add(d),i=i.sub(f)}return a},S.div=S.divide,S.modulo=function(t){return r(t)||(t=h(t)),e?c((this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},S.mod=S.modulo,S.rem=S.modulo,S.not=function(){return c(~this.low,~this.high,this.unsigned)},S.and=function(t){return r(t)||(t=h(t)),c(this.low&t.low,this.high&t.high,this.unsigned)},S.or=function(t){return r(t)||(t=h(t)),c(this.low|t.low,this.high|t.high,this.unsigned)},S.xor=function(t){return r(t)||(t=h(t)),c(this.low^t.low,this.high^t.high,this.unsigned)},S.shiftLeft=function(t){return r(t)&&(t=t.toInt()),0===(t&=63)?this:t<32?c(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):c(0,this.low<<t-32,this.unsigned)},S.shl=S.shiftLeft,S.shiftRight=function(t){return r(t)&&(t=t.toInt()),0===(t&=63)?this:t<32?c(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):c(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},S.shr=S.shiftRight,S.shiftRightUnsigned=function(t){if(r(t)&&(t=t.toInt()),0===(t&=63))return this;var e=this.high;return t<32?c(this.low>>>t|e<<32-t,e>>>t,this.unsigned):c(32===t?e:e>>>t-32,0,this.unsigned)},S.shru=S.shiftRightUnsigned,S.shr_u=S.shiftRightUnsigned,S.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},S.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},S.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},S.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},S.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},n.fromBytes=function(t,e,r){return r?n.fromBytesLE(t,e):n.fromBytesBE(t,e)},n.fromBytesLE=function(t,e){return new n(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},n.fromBytesBE=function(t,e){return new n(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)}},88027:(t,e,n)=>{"use strict";const r=n(72453),i=Symbol("max"),a=Symbol("length"),o=Symbol("lengthCalculator"),s=Symbol("allowStale"),c=Symbol("maxAge"),u=Symbol("dispose"),l=Symbol("noDisposeOnSet"),h=Symbol("lruList"),d=Symbol("cache"),f=Symbol("updateAgeOnGet"),p=()=>1;const g=(t,e,n)=>{const r=t[d].get(e);if(r){const e=r.value;if(m(t,e)){if(v(t,r),!t[s])return}else n&&(t[f]&&(r.value.now=Date.now()),t[h].unshiftNode(r));return e.value}},m=(t,e)=>{if(!e||!e.maxAge&&!t[c])return!1;const n=Date.now()-e.now;return e.maxAge?n>e.maxAge:t[c]&&n>t[c]},y=t=>{if(t[a]>t[i])for(let e=t[h].tail;t[a]>t[i]&&null!==e;){const n=e.prev;v(t,e),e=n}},v=(t,e)=>{if(e){const n=e.value;t[u]&&t[u](n.key,n.value),t[a]-=n.length,t[d].delete(n.key),t[h].removeNode(e)}};class b{constructor(t,e,n,r,i){this.key=t,this.value=e,this.length=n,this.now=r,this.maxAge=i||0}}const x=(t,e,n,r)=>{let i=n.value;m(t,i)&&(v(t,n),t[s]||(i=void 0)),i&&e.call(r,i.value,i.key,t)};t.exports=class{constructor(t){if("number"===typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!==typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[i]=t.max||1/0;const e=t.length||p;if(this[o]="function"!==typeof e?p:e,this[s]=t.stale||!1,t.maxAge&&"number"!==typeof t.maxAge)throw new TypeError("maxAge must be a number");this[c]=t.maxAge||0,this[u]=t.dispose,this[l]=t.noDisposeOnSet||!1,this[f]=t.updateAgeOnGet||!1,this.reset()}set max(t){if("number"!==typeof t||t<0)throw new TypeError("max must be a non-negative number");this[i]=t||1/0,y(this)}get max(){return this[i]}set allowStale(t){this[s]=!!t}get allowStale(){return this[s]}set maxAge(t){if("number"!==typeof t)throw new TypeError("maxAge must be a non-negative number");this[c]=t,y(this)}get maxAge(){return this[c]}set lengthCalculator(t){"function"!==typeof t&&(t=p),t!==this[o]&&(this[o]=t,this[a]=0,this[h].forEach((t=>{t.length=this[o](t.value,t.key),this[a]+=t.length}))),y(this)}get lengthCalculator(){return this[o]}get length(){return this[a]}get itemCount(){return this[h].length}rforEach(t,e){e=e||this;for(let n=this[h].tail;null!==n;){const r=n.prev;x(this,t,n,e),n=r}}forEach(t,e){e=e||this;for(let n=this[h].head;null!==n;){const r=n.next;x(this,t,n,e),n=r}}keys(){return this[h].toArray().map((t=>t.key))}values(){return this[h].toArray().map((t=>t.value))}reset(){this[u]&&this[h]&&this[h].length&&this[h].forEach((t=>this[u](t.key,t.value))),this[d]=new Map,this[h]=new r,this[a]=0}dump(){return this[h].map((t=>!m(this,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)})).toArray().filter((t=>t))}dumpLru(){return this[h]}set(t,e,n){if((n=n||this[c])&&"number"!==typeof n)throw new TypeError("maxAge must be a number");const r=n?Date.now():0,s=this[o](e,t);if(this[d].has(t)){if(s>this[i])return v(this,this[d].get(t)),!1;const o=this[d].get(t).value;return this[u]&&(this[l]||this[u](t,o.value)),o.now=r,o.maxAge=n,o.value=e,this[a]+=s-o.length,o.length=s,this.get(t),y(this),!0}const f=new b(t,e,s,r,n);return f.length>this[i]?(this[u]&&this[u](t,e),!1):(this[a]+=f.length,this[h].unshift(f),this[d].set(t,this[h].head),y(this),!0)}has(t){if(!this[d].has(t))return!1;const e=this[d].get(t).value;return!m(this,e)}get(t){return g(this,t,!0)}peek(t){return g(this,t,!1)}pop(){const t=this[h].tail;return t?(v(this,t),t.value):null}del(t){v(this,this[d].get(t))}load(t){this.reset();const e=Date.now();for(let n=t.length-1;n>=0;n--){const r=t[n],i=r.e||0;if(0===i)this.set(r.k,r.v);else{const t=i-e;t>0&&this.set(r.k,r.v,t)}}}prune(){this[d].forEach(((t,e)=>g(this,e,!1)))}}},26470:t=>{"use strict";var e=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(i){return!1}}()?Object.assign:function(t,i){for(var a,o,s=function(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),c=1;c<arguments.length;c++){for(var u in a=Object(arguments[c]))n.call(a,u)&&(s[u]=a[u]);if(e){o=e(a);for(var l=0;l<o.length;l++)r.call(a,o[l])&&(s[o[l]]=a[o[l]])}}return s}},28927:(t,e,n)=>{"use strict";function r(){}n.r(e),n.d(e,{Component:()=>z,cloneElement:()=>l,createElement:()=>s,default:()=>L,h:()=>s,options:()=>i,render:()=>B,rerender:()=>p});var i={},a=[],o=[];function s(t,e){var n,s,c,u,l=o;for(u=arguments.length;u-- >2;)a.push(arguments[u]);for(e&&null!=e.children&&(a.length||a.push(e.children),delete e.children);a.length;)if((s=a.pop())&&void 0!==s.pop)for(u=s.length;u--;)a.push(s[u]);else"boolean"===typeof s&&(s=null),(c="function"!==typeof t)&&(null==s?s="":"number"===typeof s?s=String(s):"string"!==typeof s&&(c=!1)),c&&n?l[l.length-1]+=s:l===o?l=[s]:l.push(s),n=c;var h=new r;return h.nodeName=t,h.children=l,h.attributes=null==e?void 0:e,h.key=null==e?void 0:e.key,void 0!==i.vnode&&i.vnode(h),h}function c(t,e){for(var n in e)t[n]=e[n];return t}var u="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function l(t,e){return s(t.nodeName,c(c({},t.attributes),e),arguments.length>2?[].slice.call(arguments,2):t.children)}var h=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,d=[];function f(t){!t._dirty&&(t._dirty=!0)&&1==d.push(t)&&(i.debounceRendering||u)(p)}function p(){var t,e=d;for(d=[];t=e.pop();)t._dirty&&O(t)}function g(t,e,n){return"string"===typeof e||"number"===typeof e?void 0!==t.splitText:"string"===typeof e.nodeName?!t._componentConstructor&&m(t,e.nodeName):n||t._componentConstructor===e.nodeName}function m(t,e){return t.normalizedNodeName===e||t.nodeName.toLowerCase()===e.toLowerCase()}function y(t){var e=c({},t.attributes);e.children=t.children;var n=t.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===e[r]&&(e[r]=n[r]);return e}function v(t){var e=t.parentNode;e&&e.removeChild(t)}function b(t,e,n,r,i){if("className"===e&&(e="class"),"key"===e);else if("ref"===e)n&&n(null),r&&r(t);else if("class"!==e||i)if("style"===e){if(r&&"string"!==typeof r&&"string"!==typeof n||(t.style.cssText=r||""),r&&"object"===typeof r){if("string"!==typeof n)for(var a in n)a in r||(t.style[a]="");for(var a in r)t.style[a]="number"===typeof r[a]&&!1===h.test(a)?r[a]+"px":r[a]}}else if("dangerouslySetInnerHTML"===e)r&&(t.innerHTML=r.__html||"");else if("o"==e[0]&&"n"==e[1]){var o=e!==(e=e.replace(/Capture$/,""));e=e.toLowerCase().substring(2),r?n||t.addEventListener(e,x,o):t.removeEventListener(e,x,o),(t._listeners||(t._listeners={}))[e]=r}else if("list"!==e&&"type"!==e&&!i&&e in t)!function(t,e,n){try{t[e]=n}catch(r){}}(t,e,null==r?"":r),null!=r&&!1!==r||t.removeAttribute(e);else{var s=i&&e!==(e=e.replace(/^xlink:?/,""));null==r||!1===r?s?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.removeAttribute(e):"function"!==typeof r&&(s?t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),r):t.setAttribute(e,r))}else t.className=r||""}function x(t){return this._listeners[t.type](i.event&&i.event(t)||t)}var w=[],k=0,_=!1,S=!1;function A(){for(var t;t=w.pop();)i.afterMount&&i.afterMount(t),t.componentDidMount&&t.componentDidMount()}function C(t,e,n,r,i,a){k++||(_=null!=i&&void 0!==i.ownerSVGElement,S=null!=t&&!("__preactattr_"in t));var o=E(t,e,n,r,a);return i&&o.parentNode!==i&&i.appendChild(o),--k||(S=!1,a||A()),o}function E(t,e,n,r,i){var a=t,o=_;if(null!=e&&"boolean"!==typeof e||(e=""),"string"===typeof e||"number"===typeof e)return t&&void 0!==t.splitText&&t.parentNode&&(!t._component||i)?t.nodeValue!=e&&(t.nodeValue=e):(a=document.createTextNode(e),t&&(t.parentNode&&t.parentNode.replaceChild(a,t),T(t,!0))),a.__preactattr_=!0,a;var s=e.nodeName;if("function"===typeof s)return function(t,e,n,r){var i=t&&t._component,a=i,o=t,s=i&&t._componentConstructor===e.nodeName,c=s,u=y(e);for(;i&&!c&&(i=i._parentComponent);)c=i.constructor===e.nodeName;i&&c&&(!r||i._component)?(M(i,u,3,n,r),t=i.base):(a&&!s&&(R(a),t=o=null),i=F(e.nodeName,u,n),t&&!i.nextBase&&(i.nextBase=t,o=null),M(i,u,1,n,r),t=i.base,o&&t!==o&&(o._component=null,T(o,!1)));return t}(t,e,n,r);if(_="svg"===s||"foreignObject"!==s&&_,s=String(s),(!t||!m(t,s))&&(a=function(t,e){var n=e?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t);return n.normalizedNodeName=t,n}(s,_),t)){for(;t.firstChild;)a.appendChild(t.firstChild);t.parentNode&&t.parentNode.replaceChild(a,t),T(t,!0)}var c=a.firstChild,u=a.__preactattr_,l=e.children;if(null==u){u=a.__preactattr_={};for(var h=a.attributes,d=h.length;d--;)u[h[d].name]=h[d].value}return!S&&l&&1===l.length&&"string"===typeof l[0]&&null!=c&&void 0!==c.splitText&&null==c.nextSibling?c.nodeValue!=l[0]&&(c.nodeValue=l[0]):(l&&l.length||null!=c)&&function(t,e,n,r,i){var a,o,s,c,u,l=t.childNodes,h=[],d={},f=0,p=0,m=l.length,y=0,b=e?e.length:0;if(0!==m)for(var x=0;x<m;x++){var w=l[x],k=w.__preactattr_;null!=(_=b&&k?w._component?w._component.__key:k.key:null)?(f++,d[_]=w):(k||(void 0!==w.splitText?!i||w.nodeValue.trim():i))&&(h[y++]=w)}if(0!==b)for(x=0;x<b;x++){var _;if(u=null,null!=(_=(c=e[x]).key))f&&void 0!==d[_]&&(u=d[_],d[_]=void 0,f--);else if(!u&&p<y)for(a=p;a<y;a++)if(void 0!==h[a]&&g(o=h[a],c,i)){u=o,h[a]=void 0,a===y-1&&y--,a===p&&p++;break}u=E(u,c,n,r),s=l[x],u&&u!==t&&u!==s&&(null==s?t.appendChild(u):u===s.nextSibling?v(s):t.insertBefore(u,s))}if(f)for(var x in d)void 0!==d[x]&&T(d[x],!1);for(;p<=y;)void 0!==(u=h[y--])&&T(u,!1)}(a,l,n,r,S||null!=u.dangerouslySetInnerHTML),function(t,e,n){var r;for(r in n)e&&null!=e[r]||null==n[r]||b(t,r,n[r],n[r]=void 0,_);for(r in e)"children"===r||"innerHTML"===r||r in n&&e[r]===("value"===r||"checked"===r?t[r]:n[r])||b(t,r,n[r],n[r]=e[r],_)}(a,e.attributes,u),_=o,a}function T(t,e){var n=t._component;n?R(n):(null!=t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),!1!==e&&null!=t.__preactattr_||v(t),N(t))}function N(t){for(t=t.lastChild;t;){var e=t.previousSibling;T(t,!0),t=e}}var D={};function F(t,e,n){var r,i=D[t.name];if(t.prototype&&t.prototype.render?(r=new t(e,n),z.call(r,e,n)):((r=new z(e,n)).constructor=t,r.render=I),i)for(var a=i.length;a--;)if(i[a].constructor===t){r.nextBase=i[a].nextBase,i.splice(a,1);break}return r}function I(t,e,n){return this.constructor(t,n)}function M(t,e,n,r,a){t._disable||(t._disable=!0,(t.__ref=e.ref)&&delete e.ref,(t.__key=e.key)&&delete e.key,!t.base||a?t.componentWillMount&&t.componentWillMount():t.componentWillReceiveProps&&t.componentWillReceiveProps(e,r),r&&r!==t.context&&(t.prevContext||(t.prevContext=t.context),t.context=r),t.prevProps||(t.prevProps=t.props),t.props=e,t._disable=!1,0!==n&&(1!==n&&!1===i.syncComponentUpdates&&t.base?f(t):O(t,1,a)),t.__ref&&t.__ref(t))}function O(t,e,n,r){if(!t._disable){var a,o,s,u=t.props,l=t.state,h=t.context,d=t.prevProps||u,f=t.prevState||l,p=t.prevContext||h,g=t.base,m=t.nextBase,v=g||m,b=t._component,x=!1;if(g&&(t.props=d,t.state=f,t.context=p,2!==e&&t.shouldComponentUpdate&&!1===t.shouldComponentUpdate(u,l,h)?x=!0:t.componentWillUpdate&&t.componentWillUpdate(u,l,h),t.props=u,t.state=l,t.context=h),t.prevProps=t.prevState=t.prevContext=t.nextBase=null,t._dirty=!1,!x){a=t.render(u,l,h),t.getChildContext&&(h=c(c({},h),t.getChildContext()));var _,S,E=a&&a.nodeName;if("function"===typeof E){var N=y(a);(o=b)&&o.constructor===E&&N.key==o.__key?M(o,N,1,h,!1):(_=o,t._component=o=F(E,N,h),o.nextBase=o.nextBase||m,o._parentComponent=t,M(o,N,0,h,!1),O(o,1,n,!0)),S=o.base}else s=v,(_=b)&&(s=t._component=null),(v||1===e)&&(s&&(s._component=null),S=C(s,a,h,n||!g,v&&v.parentNode,!0));if(v&&S!==v&&o!==b){var D=v.parentNode;D&&S!==D&&(D.replaceChild(S,v),_||(v._component=null,T(v,!1)))}if(_&&R(_),t.base=S,S&&!r){for(var I=t,z=t;z=z._parentComponent;)(I=z).base=S;S._component=I,S._componentConstructor=I.constructor}}if(!g||n?w.unshift(t):x||(t.componentDidUpdate&&t.componentDidUpdate(d,f,p),i.afterUpdate&&i.afterUpdate(t)),null!=t._renderCallbacks)for(;t._renderCallbacks.length;)t._renderCallbacks.pop().call(t);k||r||A()}}function R(t){i.beforeUnmount&&i.beforeUnmount(t);var e=t.base;t._disable=!0,t.componentWillUnmount&&t.componentWillUnmount(),t.base=null;var n=t._component;n?R(n):e&&(e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),t.nextBase=e,v(e),function(t){var e=t.constructor.name;(D[e]||(D[e]=[])).push(t)}(t),N(e)),t.__ref&&t.__ref(null)}function z(t,e){this._dirty=!0,this.context=e,this.props=t,this.state=this.state||{}}function B(t,e,n){return C(n,t,{},!1,e,!1)}c(z.prototype,{setState:function(t,e){var n=this.state;this.prevState||(this.prevState=c({},n)),c(n,"function"===typeof t?t(n,this.props):t),e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),f(this)},forceUpdate:function(t){t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),O(this,2)},render:function(){}});const L={h:s,createElement:s,cloneElement:l,Component:z,render:B,rerender:p,options:i}},38345:(t,e,n)=>{"use strict";var r=n(9950),i=n(75340);function a(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function c(t,e){u(t,e),u(t+"Capture",e)}function u(t,e){for(s[t]=e,t=0;t<e.length;t++)o.add(e[t])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(t,e,n,r,i,a,o){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=o}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){m[t]=new g(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];m[e]=new g(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){m[t]=new g(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){m[t]=new g(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){m[t]=new g(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){m[t]=new g(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){m[t]=new g(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){m[t]=new g(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){m[t]=new g(t,5,!1,t.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function v(t){return t[1].toUpperCase()}function b(t,e,n,r){var i=m.hasOwnProperty(e)?m[e]:null;(null!==i?0!==i.type:r||!(2<e.length)||"o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1])&&(function(t,e,n,r){if(null===e||"undefined"===typeof e||function(t,e,n,r){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,i,r)&&(n=null),r||null===i?function(t){return!!h.call(p,t)||!h.call(f,t)&&(d.test(t)?p[t]=!0:(f[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=null===n?3!==i.type&&"":n:(e=i.attributeName,r=i.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(y,v);m[e]=new g(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(y,v);m[e]=new g(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(y,v);m[e]=new g(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){m[t]=new g(t,1,!1,t.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){m[t]=new g(t,1,!1,t.toLowerCase(),null,!0,!0)}));var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),k=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),E=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),I=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var M=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function R(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=O&&t[O]||t["@@iterator"])?t:null}var z,B=Object.assign;function L(t){if(void 0===z)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);z=e&&e[1]||""}return"\n"+z+t}var P=!1;function j(t,e){if(!t||P)return"";P=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&"string"===typeof u.stack){for(var i=u.stack.split("\n"),a=r.stack.split("\n"),o=i.length-1,s=a.length-1;1<=o&&0<=s&&i[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(i[o]!==a[s]){if(1!==o||1!==s)do{if(o--,0>--s||i[o]!==a[s]){var c="\n"+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}}while(1<=o&&0<=s);break}}}finally{P=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?L(t):""}function U(t){switch(t.tag){case 5:return L(t.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return t=j(t.type,!1);case 11:return t=j(t.type.render,!1);case 1:return t=j(t.type,!0);default:return""}}function W(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case _:return"Fragment";case k:return"Portal";case A:return"Profiler";case S:return"StrictMode";case N:return"Suspense";case D:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case E:return(t.displayName||"Context")+".Consumer";case C:return(t._context.displayName||"Context")+".Provider";case T:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case F:return null!==(e=t.displayName||null)?e:W(t.type)||"Memo";case I:e=t._payload,t=t._init;try{return W(t(e))}catch(n){}}return null}function V(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=(t=e.render).displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return W(e);case 8:return e===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e}return null}function q(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":case"object":return t;default:return""}}function G(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function H(t){t._valueTracker||(t._valueTracker=function(t){var e=G(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(t){r=""+t,a.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(t){r=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function Y(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=G(t)?t.checked?"true":"false":t.value),(t=r)!==n&&(e.setValue(t),!0)}function X(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function K(t,e){var n=e.checked;return B({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function $(t,e){var n=null==e.defaultValue?"":e.defaultValue,r=null!=e.checked?e.checked:e.defaultChecked;n=q(null!=e.value?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function Z(t,e){null!=(e=e.checked)&&b(t,"checked",e,!1)}function Q(t,e){Z(t,e);var n=q(e.value),r=e.type;if(null!=n)"number"===r?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===r||"reset"===r)return void t.removeAttribute("value");e.hasOwnProperty("value")?tt(t,e.type,n):e.hasOwnProperty("defaultValue")&&tt(t,e.type,q(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function J(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!("submit"!==r&&"reset"!==r||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function tt(t,e,n){"number"===e&&X(t.ownerDocument)===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var et=Array.isArray;function nt(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+q(n),e=null,i=0;i<t.length;i++){if(t[i].value===n)return t[i].selected=!0,void(r&&(t[i].defaultSelected=!0));null!==e||t[i].disabled||(e=t[i])}null!==e&&(e.selected=!0)}}function rt(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(a(91));return B({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function it(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(a(92));if(et(n)){if(1<n.length)throw Error(a(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:q(n)}}function at(t,e){var n=q(e.value),r=q(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=r&&(t.defaultValue=""+r)}function ot(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}function st(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ct(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?st(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var ut,lt,ht=(lt=function(t,e){if("http://www.w3.org/2000/svg"!==t.namespaceURI||"innerHTML"in t)t.innerHTML=e;else{for((ut=ut||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ut.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,r){MSApp.execUnsafeLocalFunction((function(){return lt(t,e)}))}:lt);function dt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var ft={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pt=["Webkit","ms","Moz","O"];function gt(t,e,n){return null==e||"boolean"===typeof e||""===e?"":n||"number"!==typeof e||0===e||ft.hasOwnProperty(t)&&ft[t]?(""+e).trim():e+"px"}function mt(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=gt(n,e[n],r);"float"===n&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}Object.keys(ft).forEach((function(t){pt.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ft[e]=ft[t]}))}));var yt=B({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vt(t,e){if(e){if(yt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(a(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(a(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(a(62))}}function bt(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xt=null;function wt(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var kt=null,_t=null,St=null;function At(t){if(t=bi(t)){if("function"!==typeof kt)throw Error(a(280));var e=t.stateNode;e&&(e=wi(e),kt(t.stateNode,t.type,e))}}function Ct(t){_t?St?St.push(t):St=[t]:_t=t}function Et(){if(_t){var t=_t,e=St;if(St=_t=null,At(t),e)for(t=0;t<e.length;t++)At(e[t])}}function Tt(t,e){return t(e)}function Nt(){}var Dt=!1;function Ft(t,e,n){if(Dt)return t(e,n);Dt=!0;try{return Tt(t,e,n)}finally{Dt=!1,(null!==_t||null!==St)&&(Nt(),Et())}}function It(t,e){var n=t.stateNode;if(null===n)return null;var r=wi(n);if(null===r)return null;n=r[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!r;break t;default:t=!1}if(t)return null;if(n&&"function"!==typeof n)throw Error(a(231,e,typeof n));return n}var Mt=!1;if(l)try{var Ot={};Object.defineProperty(Ot,"passive",{get:function(){Mt=!0}}),window.addEventListener("test",Ot,Ot),window.removeEventListener("test",Ot,Ot)}catch(lt){Mt=!1}function Rt(t,e,n,r,i,a,o,s,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(l){this.onError(l)}}var zt=!1,Bt=null,Lt=!1,Pt=null,jt={onError:function(t){zt=!0,Bt=t}};function Ut(t,e,n,r,i,a,o,s,c){zt=!1,Bt=null,Rt.apply(jt,arguments)}function Wt(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(4098&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function Vt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function qt(t){if(Wt(t)!==t)throw Error(a(188))}function Gt(t){return null!==(t=function(t){var e=t.alternate;if(!e){if(null===(e=Wt(t)))throw Error(a(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return qt(i),t;if(o===r)return qt(i),e;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,c=i.child;c;){if(c===n){s=!0,n=i,r=o;break}if(c===r){s=!0,r=i,n=o;break}c=c.sibling}if(!s){for(c=o.child;c;){if(c===n){s=!0,n=o,r=i;break}if(c===r){s=!0,r=o,n=i;break}c=c.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?t:e}(t))?Ht(t):null}function Ht(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var e=Ht(t);if(null!==e)return e;t=t.sibling}return null}var Yt=i.unstable_scheduleCallback,Xt=i.unstable_cancelCallback,Kt=i.unstable_shouldYield,$t=i.unstable_requestPaint,Zt=i.unstable_now,Qt=i.unstable_getCurrentPriorityLevel,Jt=i.unstable_ImmediatePriority,te=i.unstable_UserBlockingPriority,ee=i.unstable_NormalPriority,ne=i.unstable_LowPriority,re=i.unstable_IdlePriority,ie=null,ae=null;var oe=Math.clz32?Math.clz32:function(t){return t>>>=0,0===t?32:31-(se(t)/ce|0)|0},se=Math.log,ce=Math.LN2;var ue=64,le=4194304;function he(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&t;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&t;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function de(t,e){var n=t.pendingLanes;if(0===n)return 0;var r=0,i=t.suspendedLanes,a=t.pingedLanes,o=268435455&n;if(0!==o){var s=o&~i;0!==s?r=he(s):0!==(a&=o)&&(r=he(a))}else 0!==(o=n&~i)?r=he(o):0!==a&&(r=he(a));if(0===r)return 0;if(0!==e&&e!==r&&0===(e&i)&&((i=r&-r)>=(a=e&-e)||16===i&&0!==(4194240&a)))return e;if(0!==(4&r)&&(r|=16&n),0!==(e=t.entangledLanes))for(t=t.entanglements,e&=r;0<e;)i=1<<(n=31-oe(e)),r|=t[n],e&=~i;return r}function fe(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function pe(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function ge(){var t=ue;return 0===(4194240&(ue<<=1))&&(ue=64),t}function me(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ye(t,e,n){t.pendingLanes|=e,536870912!==e&&(t.suspendedLanes=0,t.pingedLanes=0),(t=t.eventTimes)[e=31-oe(e)]=n}function ve(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-oe(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var be=0;function xe(t){return 1<(t&=-t)?4<t?0!==(268435455&t)?16:536870912:4:1}var we,ke,_e,Se,Ae,Ce=!1,Ee=[],Te=null,Ne=null,De=null,Fe=new Map,Ie=new Map,Me=[],Oe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Re(t,e){switch(t){case"focusin":case"focusout":Te=null;break;case"dragenter":case"dragleave":Ne=null;break;case"mouseover":case"mouseout":De=null;break;case"pointerover":case"pointerout":Fe.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ie.delete(e.pointerId)}}function ze(t,e,n,r,i,a){return null===t||t.nativeEvent!==a?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},null!==e&&(null!==(e=bi(e))&&ke(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,null!==i&&-1===e.indexOf(i)&&e.push(i),t)}function Be(t){var e=vi(t.target);if(null!==e){var n=Wt(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=Vt(n)))return t.blockedOn=e,void Ae(t.priority,(function(){_e(n)}))}else if(3===e&&n.stateNode.current.memoizedState.isDehydrated)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function Le(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var n=Ke(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n)return null!==(e=bi(n))&&ke(e),t.blockedOn=n,!1;var r=new(n=t.nativeEvent).constructor(n.type,n);xt=r,n.target.dispatchEvent(r),xt=null,e.shift()}return!0}function Pe(t,e,n){Le(t)&&n.delete(e)}function je(){Ce=!1,null!==Te&&Le(Te)&&(Te=null),null!==Ne&&Le(Ne)&&(Ne=null),null!==De&&Le(De)&&(De=null),Fe.forEach(Pe),Ie.forEach(Pe)}function Ue(t,e){t.blockedOn===e&&(t.blockedOn=null,Ce||(Ce=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,je)))}function We(t){function e(e){return Ue(e,t)}if(0<Ee.length){Ue(Ee[0],t);for(var n=1;n<Ee.length;n++){var r=Ee[n];r.blockedOn===t&&(r.blockedOn=null)}}for(null!==Te&&Ue(Te,t),null!==Ne&&Ue(Ne,t),null!==De&&Ue(De,t),Fe.forEach(e),Ie.forEach(e),n=0;n<Me.length;n++)(r=Me[n]).blockedOn===t&&(r.blockedOn=null);for(;0<Me.length&&null===(n=Me[0]).blockedOn;)Be(n),null===n.blockedOn&&Me.shift()}var Ve=x.ReactCurrentBatchConfig,qe=!0;function Ge(t,e,n,r){var i=be,a=Ve.transition;Ve.transition=null;try{be=1,Ye(t,e,n,r)}finally{be=i,Ve.transition=a}}function He(t,e,n,r){var i=be,a=Ve.transition;Ve.transition=null;try{be=4,Ye(t,e,n,r)}finally{be=i,Ve.transition=a}}function Ye(t,e,n,r){if(qe){var i=Ke(t,e,n,r);if(null===i)qr(t,e,r,Xe,n),Re(t,r);else if(function(t,e,n,r,i){switch(e){case"focusin":return Te=ze(Te,t,e,n,r,i),!0;case"dragenter":return Ne=ze(Ne,t,e,n,r,i),!0;case"mouseover":return De=ze(De,t,e,n,r,i),!0;case"pointerover":var a=i.pointerId;return Fe.set(a,ze(Fe.get(a)||null,t,e,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Ie.set(a,ze(Ie.get(a)||null,t,e,n,r,i)),!0}return!1}(i,t,e,n,r))r.stopPropagation();else if(Re(t,r),4&e&&-1<Oe.indexOf(t)){for(;null!==i;){var a=bi(i);if(null!==a&&we(a),null===(a=Ke(t,e,n,r))&&qr(t,e,r,Xe,n),a===i)break;i=a}null!==i&&r.stopPropagation()}else qr(t,e,r,null,n)}}var Xe=null;function Ke(t,e,n,r){if(Xe=null,null!==(t=vi(t=wt(r))))if(null===(e=Wt(t)))t=null;else if(13===(n=e.tag)){if(null!==(t=Vt(e)))return t;t=null}else if(3===n){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Xe=t,null}function $e(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qt()){case Jt:return 1;case te:return 4;case ee:case ne:return 16;case re:return 536870912;default:return 16}default:return 16}}var Ze=null,Qe=null,Je=null;function tn(){if(Je)return Je;var t,e,n=Qe,r=n.length,i="value"in Ze?Ze.value:Ze.textContent,a=i.length;for(t=0;t<r&&n[t]===i[t];t++);var o=r-t;for(e=1;e<=o&&n[r-e]===i[a-e];e++);return Je=i.slice(t,1<e?1-e:void 0)}function en(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function nn(){return!0}function rn(){return!1}function an(t){function e(e,n,r,i,a){for(var o in this._reactName=e,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,t)t.hasOwnProperty(o)&&(e=t[o],this[o]=e?e(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return B(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),e}var on,sn,cn,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=an(un),hn=B({},un,{view:0,detail:0}),dn=an(hn),fn=B({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:An,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==cn&&(cn&&"mousemove"===t.type?(on=t.screenX-cn.screenX,sn=t.screenY-cn.screenY):sn=on=0,cn=t),on)},movementY:function(t){return"movementY"in t?t.movementY:sn}}),pn=an(fn),gn=an(B({},fn,{dataTransfer:0})),mn=an(B({},hn,{relatedTarget:0})),yn=an(B({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=B({},un,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),bn=an(vn),xn=an(B({},un,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_n={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=_n[t])&&!!e[t]}function An(){return Sn}var Cn=B({},hn,{key:function(t){if(t.key){var e=wn[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=en(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?kn[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:An,charCode:function(t){return"keypress"===t.type?en(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?en(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),En=an(Cn),Tn=an(B({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=an(B({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:An})),Dn=an(B({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),Fn=B({},fn,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),In=an(Fn),Mn=[9,13,27,32],On=l&&"CompositionEvent"in window,Rn=null;l&&"documentMode"in document&&(Rn=document.documentMode);var zn=l&&"TextEvent"in window&&!Rn,Bn=l&&(!On||Rn&&8<Rn&&11>=Rn),Ln=String.fromCharCode(32),Pn=!1;function jn(t,e){switch(t){case"keyup":return-1!==Mn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var Wn=!1;var Vn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Vn[t.type]:"textarea"===e}function Gn(t,e,n,r){Ct(r),0<(e=Hr(e,"onChange")).length&&(n=new ln("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Hn=null,Yn=null;function Xn(t){Lr(t,0)}function Kn(t){if(Y(xi(t)))return t}function $n(t,e){if("change"===t)return e}var Zn=!1;if(l){var Qn;if(l){var Jn="oninput"in document;if(!Jn){var tr=document.createElement("div");tr.setAttribute("oninput","return;"),Jn="function"===typeof tr.oninput}Qn=Jn}else Qn=!1;Zn=Qn&&(!document.documentMode||9<document.documentMode)}function er(){Hn&&(Hn.detachEvent("onpropertychange",nr),Yn=Hn=null)}function nr(t){if("value"===t.propertyName&&Kn(Yn)){var e=[];Gn(e,Yn,t,wt(t)),Ft(Xn,e)}}function rr(t,e,n){"focusin"===t?(er(),Yn=n,(Hn=e).attachEvent("onpropertychange",nr)):"focusout"===t&&er()}function ir(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Kn(Yn)}function ar(t,e){if("click"===t)return Kn(e)}function or(t,e){if("input"===t||"change"===t)return Kn(e)}var sr="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e};function cr(t,e){if(sr(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!h.call(e,i)||!sr(t[i],e[i]))return!1}return!0}function ur(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function lr(t,e){var n,r=ur(t);for(t=0;r;){if(3===r.nodeType){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=ur(r)}}function hr(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?hr(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function dr(){for(var t=window,e=X();e instanceof t.HTMLIFrameElement;){try{var n="string"===typeof e.contentWindow.location.href}catch(r){n=!1}if(!n)break;e=X((t=e.contentWindow).document)}return e}function fr(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}function pr(t){var e=dr(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(e=r.start,void 0===(t=r.end)&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if((t=(e=n.ownerDocument||document)&&e.defaultView||window).getSelection){t=t.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=void 0===r.end?a:Math.min(r.end,i),!t.extend&&a>r&&(i=r,r=a,a=i),i=lr(n,a);var o=lr(n,r);i&&o&&(1!==t.rangeCount||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&((e=e.createRange()).setStart(i.node,i.offset),t.removeAllRanges(),a>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}for(e=[],t=n;t=t.parentNode;)1===t.nodeType&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<e.length;n++)(t=e[n]).element.scrollLeft=t.left,t.element.scrollTop=t.top}}var gr=l&&"documentMode"in document&&11>=document.documentMode,mr=null,yr=null,vr=null,br=!1;function xr(t,e,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==mr||mr!==X(r)||("selectionStart"in(r=mr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&cr(vr,r)||(vr=r,0<(r=Hr(yr,"onSelect")).length&&(e=new ln("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=mr)))}function wr(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var kr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},_r={},Sr={};function Ar(t){if(_r[t])return _r[t];if(!kr[t])return t;var e,n=kr[t];for(e in n)if(n.hasOwnProperty(e)&&e in Sr)return _r[t]=n[e];return t}l&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var Cr=Ar("animationend"),Er=Ar("animationiteration"),Tr=Ar("animationstart"),Nr=Ar("transitionend"),Dr=new Map,Fr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ir(t,e){Dr.set(t,e),c(e,[t])}for(var Mr=0;Mr<Fr.length;Mr++){var Or=Fr[Mr];Ir(Or.toLowerCase(),"on"+(Or[0].toUpperCase()+Or.slice(1)))}Ir(Cr,"onAnimationEnd"),Ir(Er,"onAnimationIteration"),Ir(Tr,"onAnimationStart"),Ir("dblclick","onDoubleClick"),Ir("focusin","onFocus"),Ir("focusout","onBlur"),Ir(Nr,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rr));function Br(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,function(t,e,n,r,i,o,s,c,u){if(Ut.apply(this,arguments),zt){if(!zt)throw Error(a(198));var l=Bt;zt=!1,Bt=null,Lt||(Lt=!0,Pt=l)}}(r,e,void 0,t),t.currentTarget=null}function Lr(t,e){e=0!==(4&e);for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;t:{var a=void 0;if(e)for(var o=r.length-1;0<=o;o--){var s=r[o],c=s.instance,u=s.currentTarget;if(s=s.listener,c!==a&&i.isPropagationStopped())break t;Br(i,s,u),a=c}else for(o=0;o<r.length;o++){if(c=(s=r[o]).instance,u=s.currentTarget,s=s.listener,c!==a&&i.isPropagationStopped())break t;Br(i,s,u),a=c}}}if(Lt)throw t=Pt,Lt=!1,Pt=null,t}function Pr(t,e){var n=e[gi];void 0===n&&(n=e[gi]=new Set);var r=t+"__bubble";n.has(r)||(Vr(e,t,2,!1),n.add(r))}function jr(t,e,n){var r=0;e&&(r|=4),Vr(n,t,r,e)}var Ur="_reactListening"+Math.random().toString(36).slice(2);function Wr(t){if(!t[Ur]){t[Ur]=!0,o.forEach((function(e){"selectionchange"!==e&&(zr.has(e)||jr(e,!1,t),jr(e,!0,t))}));var e=9===t.nodeType?t:t.ownerDocument;null===e||e[Ur]||(e[Ur]=!0,jr("selectionchange",!1,e))}}function Vr(t,e,n,r){switch($e(e)){case 1:var i=Ge;break;case 4:i=He;break;default:i=Ye}n=i.bind(null,e,n,t),i=void 0,!Mt||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(i=!0),r?void 0!==i?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):void 0!==i?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function qr(t,e,n,r,i){var a=r;if(0===(1&e)&&0===(2&e)&&null!==r)t:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var c=o.tag;if((3===c||4===c)&&((c=o.stateNode.containerInfo)===i||8===c.nodeType&&c.parentNode===i))return;o=o.return}for(;null!==s;){if(null===(o=vi(s)))return;if(5===(c=o.tag)||6===c){r=a=o;continue t}s=s.parentNode}}r=r.return}Ft((function(){var r=a,i=wt(n),o=[];t:{var s=Dr.get(t);if(void 0!==s){var c=ln,u=t;switch(t){case"keypress":if(0===en(n))break t;case"keydown":case"keyup":c=En;break;case"focusin":u="focus",c=mn;break;case"focusout":u="blur",c=mn;break;case"beforeblur":case"afterblur":c=mn;break;case"click":if(2===n.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=Nn;break;case Cr:case Er:case Tr:c=yn;break;case Nr:c=Dn;break;case"scroll":c=dn;break;case"wheel":c=In;break;case"copy":case"cut":case"paste":c=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=Tn}var l=0!==(4&e),h=!l&&"scroll"===t,d=l?null!==s?s+"Capture":null:s;l=[];for(var f,p=r;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==d&&(null!=(g=It(p,d))&&l.push(Gr(p,g,f)))),h)break;p=p.return}0<l.length&&(s=new c(s,u,null,n,i),o.push({event:s,listeners:l}))}}if(0===(7&e)){if(c="mouseout"===t||"pointerout"===t,(!(s="mouseover"===t||"pointerover"===t)||n===xt||!(u=n.relatedTarget||n.fromElement)||!vi(u)&&!u[pi])&&(c||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?vi(u):null)&&(u!==(h=Wt(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(c=null,u=r),c!==u)){if(l=pn,g="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==t&&"pointerover"!==t||(l=Tn,g="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==c?s:xi(c),f=null==u?s:xi(u),(s=new l(g,p+"leave",c,n,i)).target=h,s.relatedTarget=f,g=null,vi(i)===r&&((l=new l(d,p+"enter",u,n,i)).target=f,l.relatedTarget=h,g=l),h=g,c&&u)t:{for(d=u,p=0,f=l=c;f;f=Yr(f))p++;for(f=0,g=d;g;g=Yr(g))f++;for(;0<p-f;)l=Yr(l),p--;for(;0<f-p;)d=Yr(d),f--;for(;p--;){if(l===d||null!==d&&l===d.alternate)break t;l=Yr(l),d=Yr(d)}l=null}else l=null;null!==c&&Xr(o,s,c,l,!1),null!==u&&null!==h&&Xr(o,h,u,l,!0)}if("select"===(c=(s=r?xi(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===c&&"file"===s.type)var m=$n;else if(qn(s))if(Zn)m=or;else{m=ir;var y=rr}else(c=s.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=ar);switch(m&&(m=m(t,r))?Gn(o,m,n,i):(y&&y(t,s,r),"focusout"===t&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&tt(s,"number",s.value)),y=r?xi(r):window,t){case"focusin":(qn(y)||"true"===y.contentEditable)&&(mr=y,yr=r,vr=null);break;case"focusout":vr=yr=mr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(o,n,i);break;case"selectionchange":if(gr)break;case"keydown":case"keyup":xr(o,n,i)}var v;if(On)t:{switch(t){case"compositionstart":var b="onCompositionStart";break t;case"compositionend":b="onCompositionEnd";break t;case"compositionupdate":b="onCompositionUpdate";break t}b=void 0}else Wn?jn(t,n)&&(b="onCompositionEnd"):"keydown"===t&&229===n.keyCode&&(b="onCompositionStart");b&&(Bn&&"ko"!==n.locale&&(Wn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Wn&&(v=tn()):(Qe="value"in(Ze=i)?Ze.value:Ze.textContent,Wn=!0)),0<(y=Hr(r,b)).length&&(b=new xn(b,t,null,n,i),o.push({event:b,listeners:y}),v?b.data=v:null!==(v=Un(n))&&(b.data=v))),(v=zn?function(t,e){switch(t){case"compositionend":return Un(e);case"keypress":return 32!==e.which?null:(Pn=!0,Ln);case"textInput":return(t=e.data)===Ln&&Pn?null:t;default:return null}}(t,n):function(t,e){if(Wn)return"compositionend"===t||!On&&jn(t,e)?(t=tn(),Je=Qe=Ze=null,Wn=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Bn&&"ko"!==e.locale?null:e.data}}(t,n))&&(0<(r=Hr(r,"onBeforeInput")).length&&(i=new xn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=v))}Lr(o,e)}))}function Gr(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Hr(t,e){for(var n=e+"Capture",r=[];null!==t;){var i=t,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=It(t,n))&&r.unshift(Gr(t,a,i)),null!=(a=It(t,e))&&r.push(Gr(t,a,i))),t=t.return}return r}function Yr(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function Xr(t,e,n,r,i){for(var a=e._reactName,o=[];null!==n&&n!==r;){var s=n,c=s.alternate,u=s.stateNode;if(null!==c&&c===r)break;5===s.tag&&null!==u&&(s=u,i?null!=(c=It(n,a))&&o.unshift(Gr(n,c,s)):i||null!=(c=It(n,a))&&o.push(Gr(n,c,s))),n=n.return}0!==o.length&&t.push({event:e,listeners:o})}var Kr=/\r\n?/g,$r=/\u0000|\uFFFD/g;function Zr(t){return("string"===typeof t?t:""+t).replace(Kr,"\n").replace($r,"")}function Qr(t,e,n){if(e=Zr(e),Zr(t)!==e&&n)throw Error(a(425))}function Jr(){}var ti=null,ei=null;function ni(t,e){return"textarea"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,ai="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ai?function(t){return ai.resolve(null).then(t).catch(si)}:ri;function si(t){setTimeout((function(){throw t}))}function ci(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return t.removeChild(i),void We(e);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);We(e)}function ui(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=t.data)||"$!"===e||"$?"===e)break;if("/$"===e)return null}}return t}function li(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var hi=Math.random().toString(36).slice(2),di="__reactFiber$"+hi,fi="__reactProps$"+hi,pi="__reactContainer$"+hi,gi="__reactEvents$"+hi,mi="__reactListeners$"+hi,yi="__reactHandles$"+hi;function vi(t){var e=t[di];if(e)return e;for(var n=t.parentNode;n;){if(e=n[pi]||n[di]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=li(t);null!==t;){if(n=t[di])return n;t=li(t)}return e}n=(t=n).parentNode}return null}function bi(t){return!(t=t[di]||t[pi])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function xi(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(a(33))}function wi(t){return t[fi]||null}var ki=[],_i=-1;function Si(t){return{current:t}}function Ai(t){0>_i||(t.current=ki[_i],ki[_i]=null,_i--)}function Ci(t,e){_i++,ki[_i]=t.current,t.current=e}var Ei={},Ti=Si(Ei),Ni=Si(!1),Di=Ei;function Fi(t,e){var n=t.type.contextTypes;if(!n)return Ei;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=e[i];return r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function Ii(t){return null!==(t=t.childContextTypes)&&void 0!==t}function Mi(){Ai(Ni),Ai(Ti)}function Oi(t,e,n){if(Ti.current!==Ei)throw Error(a(168));Ci(Ti,e),Ci(Ni,n)}function Ri(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in e))throw Error(a(108,V(t)||"Unknown",i));return B({},n,r)}function zi(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ei,Di=Ti.current,Ci(Ti,t),Ci(Ni,Ni.current),!0}function Bi(t,e,n){var r=t.stateNode;if(!r)throw Error(a(169));n?(t=Ri(t,e,Di),r.__reactInternalMemoizedMergedChildContext=t,Ai(Ni),Ai(Ti),Ci(Ti,t)):Ai(Ni),Ci(Ni,n)}var Li=null,Pi=!1,ji=!1;function Ui(t){null===Li?Li=[t]:Li.push(t)}function Wi(){if(!ji&&null!==Li){ji=!0;var t=0,e=be;try{var n=Li;for(be=1;t<n.length;t++){var r=n[t];do{r=r(!0)}while(null!==r)}Li=null,Pi=!1}catch(i){throw null!==Li&&(Li=Li.slice(t+1)),Yt(Jt,Wi),i}finally{be=e,ji=!1}}return null}var Vi=[],qi=0,Gi=null,Hi=0,Yi=[],Xi=0,Ki=null,$i=1,Zi="";function Qi(t,e){Vi[qi++]=Hi,Vi[qi++]=Gi,Gi=t,Hi=e}function Ji(t,e,n){Yi[Xi++]=$i,Yi[Xi++]=Zi,Yi[Xi++]=Ki,Ki=t;var r=$i;t=Zi;var i=32-oe(r)-1;r&=~(1<<i),n+=1;var a=32-oe(e)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,$i=1<<32-oe(e)+i|n<<i|r,Zi=a+t}else $i=1<<a|n<<i|r,Zi=t}function ta(t){null!==t.return&&(Qi(t,1),Ji(t,1,0))}function ea(t){for(;t===Gi;)Gi=Vi[--qi],Vi[qi]=null,Hi=Vi[--qi],Vi[qi]=null;for(;t===Ki;)Ki=Yi[--Xi],Yi[Xi]=null,Zi=Yi[--Xi],Yi[Xi]=null,$i=Yi[--Xi],Yi[Xi]=null}var na=null,ra=null,ia=!1,aa=null;function oa(t,e){var n=Iu(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,null===(e=t.deletions)?(t.deletions=[n],t.flags|=16):e.push(n)}function sa(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,na=t,ra=ui(e.firstChild),!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,na=t,ra=null,!0);case 13:return null!==(e=8!==e.nodeType?null:e)&&(n=null!==Ki?{id:$i,overflow:Zi}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},(n=Iu(18,null,null,0)).stateNode=e,n.return=t,t.child=n,na=t,ra=null,!0);default:return!1}}function ca(t){return 0!==(1&t.mode)&&0===(128&t.flags)}function ua(t){if(ia){var e=ra;if(e){var n=e;if(!sa(t,e)){if(ca(t))throw Error(a(418));e=ui(n.nextSibling);var r=na;e&&sa(t,e)?oa(r,n):(t.flags=-4097&t.flags|2,ia=!1,na=t)}}else{if(ca(t))throw Error(a(418));t.flags=-4097&t.flags|2,ia=!1,na=t}}}function la(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;na=t}function ha(t){if(t!==na)return!1;if(!ia)return la(t),ia=!0,!1;var e;if((e=3!==t.tag)&&!(e=5!==t.tag)&&(e="head"!==(e=t.type)&&"body"!==e&&!ni(t.type,t.memoizedProps)),e&&(e=ra)){if(ca(t))throw da(),Error(a(418));for(;e;)oa(t,e),e=ui(e.nextSibling)}if(la(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(a(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){ra=ui(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}ra=null}}else ra=na?ui(t.stateNode.nextSibling):null;return!0}function da(){for(var t=ra;t;)t=ui(t.nextSibling)}function fa(){ra=na=null,ia=!1}function pa(t){null===aa?aa=[t]:aa.push(t)}var ga=x.ReactCurrentBatchConfig;function ma(t,e){if(t&&t.defaultProps){for(var n in e=B({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}return e}var ya=Si(null),va=null,ba=null,xa=null;function wa(){xa=ba=va=null}function ka(t){var e=ya.current;Ai(ya),t._currentValue=e}function _a(t,e,n){for(;null!==t;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==r&&(r.childLanes|=e)):null!==r&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Sa(t,e){va=t,xa=ba=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!==(t.lanes&e)&&(xs=!0),t.firstContext=null)}function Aa(t){var e=t._currentValue;if(xa!==t)if(t={context:t,memoizedValue:e,next:null},null===ba){if(null===va)throw Error(a(308));ba=t,va.dependencies={lanes:0,firstContext:t}}else ba=ba.next=t;return e}var Ca=null;function Ea(t){null===Ca?Ca=[t]:Ca.push(t)}function Ta(t,e,n,r){var i=e.interleaved;return null===i?(n.next=n,Ea(e)):(n.next=i.next,i.next=n),e.interleaved=n,Na(t,r)}function Na(t,e){t.lanes|=e;var n=t.alternate;for(null!==n&&(n.lanes|=e),n=t,t=t.return;null!==t;)t.childLanes|=e,null!==(n=t.alternate)&&(n.childLanes|=e),n=t,t=t.return;return 3===n.tag?n.stateNode:null}var Da=!1;function Fa(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ia(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ma(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Oa(t,e,n){var r=t.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Nc)){var i=r.pending;return null===i?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Na(t,n)}return null===(i=r.interleaved)?(e.next=e,Ea(r)):(e.next=i.next,i.next=e),r.interleaved=e,Na(t,n)}function Ra(t,e,n){if(null!==(e=e.updateQueue)&&(e=e.shared,0!==(4194240&n))){var r=e.lanes;n|=r&=t.pendingLanes,e.lanes=n,ve(t,n)}}function za(t,e){var n=t.updateQueue,r=t.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=o:a=a.next=o,n=n.next}while(null!==n);null===a?i=a=e:a=a.next=e}else i=a=e;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ba(t,e,n,r){var i=t.updateQueue;Da=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var c=s,u=c.next;c.next=null,null===o?a=u:o.next=u,o=c;var l=t.alternate;null!==l&&((s=(l=l.updateQueue).lastBaseUpdate)!==o&&(null===s?l.firstBaseUpdate=u:s.next=u,l.lastBaseUpdate=c))}if(null!==a){var h=i.baseState;for(o=0,l=u=c=null,s=a;;){var d=s.lane,f=s.eventTime;if((r&d)===d){null!==l&&(l=l.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});t:{var p=t,g=s;switch(d=e,f=n,g.tag){case 1:if("function"===typeof(p=g.payload)){h=p.call(f,h,d);break t}h=p;break t;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=g.payload)?p.call(f,h,d):p)||void 0===d)break t;h=B({},h,d);break t;case 2:Da=!0}}null!==s.callback&&0!==s.lane&&(t.flags|=64,null===(d=i.effects)?i.effects=[s]:d.push(s))}else f={eventTime:f,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===l?(u=l=f,c=h):l=l.next=f,o|=d;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(d=s).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===l&&(c=h),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=l,null!==(e=i.shared.interleaved)){i=e;do{o|=i.lane,i=i.next}while(i!==e)}else null===a&&(i.shared.lanes=0);Bc|=o,t.lanes=o,t.memoizedState=h}}function La(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(a(191,i));i.call(r)}}}var Pa=(new r.Component).refs;function ja(t,e,n,r){n=null===(n=n(r,e=t.memoizedState))||void 0===n?e:B({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var Ua={isMounted:function(t){return!!(t=t._reactInternals)&&Wt(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=eu(),i=nu(t),a=Ma(r,i);a.payload=e,void 0!==n&&null!==n&&(a.callback=n),null!==(e=Oa(t,a,i))&&(ru(e,t,i,r),Ra(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=eu(),i=nu(t),a=Ma(r,i);a.tag=1,a.payload=e,void 0!==n&&null!==n&&(a.callback=n),null!==(e=Oa(t,a,i))&&(ru(e,t,i,r),Ra(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=eu(),r=nu(t),i=Ma(n,r);i.tag=2,void 0!==e&&null!==e&&(i.callback=e),null!==(e=Oa(t,i,r))&&(ru(e,t,r,n),Ra(e,t,r))}};function Wa(t,e,n,r,i,a,o){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(r,a,o):!e.prototype||!e.prototype.isPureReactComponent||(!cr(n,r)||!cr(i,a))}function Va(t,e,n){var r=!1,i=Ei,a=e.contextType;return"object"===typeof a&&null!==a?a=Aa(a):(i=Ii(e)?Di:Ti.current,a=(r=null!==(r=e.contextTypes)&&void 0!==r)?Fi(t,i):Ei),e=new e(n,a),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=Ua,t.stateNode=e,e._reactInternals=t,r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e}function qa(t,e,n,r){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,r),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Ua.enqueueReplaceState(e,e.state,null)}function Ga(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=Pa,Fa(t);var a=e.contextType;"object"===typeof a&&null!==a?i.context=Aa(a):(a=Ii(e)?Di:Ti.current,i.context=Fi(t,a)),i.state=t.memoizedState,"function"===typeof(a=e.getDerivedStateFromProps)&&(ja(t,e,a,n),i.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(e=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),e!==i.state&&Ua.enqueueReplaceState(i,i.state,null),Ba(t,n,i,r),i.state=t.memoizedState),"function"===typeof i.componentDidMount&&(t.flags|=4194308)}function Ha(t,e,n){if(null!==(t=n.ref)&&"function"!==typeof t&&"object"!==typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,t));var i=r,o=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===o?e.ref:(e=function(t){var e=i.refs;e===Pa&&(e=i.refs={}),null===t?delete e[o]:e[o]=t},e._stringRef=o,e)}if("string"!==typeof t)throw Error(a(284));if(!n._owner)throw Error(a(290,t))}return t}function Ya(t,e){throw t=Object.prototype.toString.call(e),Error(a(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Xa(t){return(0,t._init)(t._payload)}function Ka(t){function e(e,n){if(t){var r=e.deletions;null===r?(e.deletions=[n],e.flags|=16):r.push(n)}}function n(n,r){if(!t)return null;for(;null!==r;)e(n,r),r=r.sibling;return null}function r(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(t,e){return(t=Ou(t,e)).index=0,t.sibling=null,t}function o(e,n,r){return e.index=r,t?null!==(r=e.alternate)?(r=r.index)<n?(e.flags|=2,n):r:(e.flags|=2,n):(e.flags|=1048576,n)}function s(e){return t&&null===e.alternate&&(e.flags|=2),e}function c(t,e,n,r){return null===e||6!==e.tag?((e=Lu(n,t.mode,r)).return=t,e):((e=i(e,n)).return=t,e)}function u(t,e,n,r){var a=n.type;return a===_?h(t,e,n.props.children,r,n.key):null!==e&&(e.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===I&&Xa(a)===e.type)?((r=i(e,n.props)).ref=Ha(t,e,n),r.return=t,r):((r=Ru(n.type,n.key,n.props,null,t.mode,r)).ref=Ha(t,e,n),r.return=t,r)}function l(t,e,n,r){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Pu(n,t.mode,r)).return=t,e):((e=i(e,n.children||[])).return=t,e)}function h(t,e,n,r,a){return null===e||7!==e.tag?((e=zu(n,t.mode,r,a)).return=t,e):((e=i(e,n)).return=t,e)}function d(t,e,n){if("string"===typeof e&&""!==e||"number"===typeof e)return(e=Lu(""+e,t.mode,n)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case w:return(n=Ru(e.type,e.key,e.props,null,t.mode,n)).ref=Ha(t,null,e),n.return=t,n;case k:return(e=Pu(e,t.mode,n)).return=t,e;case I:return d(t,(0,e._init)(e._payload),n)}if(et(e)||R(e))return(e=zu(e,t.mode,n,null)).return=t,e;Ya(t,e)}return null}function f(t,e,n,r){var i=null!==e?e.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:c(t,e,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===i?u(t,e,n,r):null;case k:return n.key===i?l(t,e,n,r):null;case I:return f(t,e,(i=n._init)(n._payload),r)}if(et(n)||R(n))return null!==i?null:h(t,e,n,r,null);Ya(t,n)}return null}function p(t,e,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return c(e,t=t.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return u(e,t=t.get(null===r.key?n:r.key)||null,r,i);case k:return l(e,t=t.get(null===r.key?n:r.key)||null,r,i);case I:return p(t,e,n,(0,r._init)(r._payload),i)}if(et(r)||R(r))return h(e,t=t.get(n)||null,r,i,null);Ya(e,r)}return null}function g(i,a,s,c){for(var u=null,l=null,h=a,g=a=0,m=null;null!==h&&g<s.length;g++){h.index>g?(m=h,h=null):m=h.sibling;var y=f(i,h,s[g],c);if(null===y){null===h&&(h=m);break}t&&h&&null===y.alternate&&e(i,h),a=o(y,a,g),null===l?u=y:l.sibling=y,l=y,h=m}if(g===s.length)return n(i,h),ia&&Qi(i,g),u;if(null===h){for(;g<s.length;g++)null!==(h=d(i,s[g],c))&&(a=o(h,a,g),null===l?u=h:l.sibling=h,l=h);return ia&&Qi(i,g),u}for(h=r(i,h);g<s.length;g++)null!==(m=p(h,i,g,s[g],c))&&(t&&null!==m.alternate&&h.delete(null===m.key?g:m.key),a=o(m,a,g),null===l?u=m:l.sibling=m,l=m);return t&&h.forEach((function(t){return e(i,t)})),ia&&Qi(i,g),u}function m(i,s,c,u){var l=R(c);if("function"!==typeof l)throw Error(a(150));if(null==(c=l.call(c)))throw Error(a(151));for(var h=l=null,g=s,m=s=0,y=null,v=c.next();null!==g&&!v.done;m++,v=c.next()){g.index>m?(y=g,g=null):y=g.sibling;var b=f(i,g,v.value,u);if(null===b){null===g&&(g=y);break}t&&g&&null===b.alternate&&e(i,g),s=o(b,s,m),null===h?l=b:h.sibling=b,h=b,g=y}if(v.done)return n(i,g),ia&&Qi(i,m),l;if(null===g){for(;!v.done;m++,v=c.next())null!==(v=d(i,v.value,u))&&(s=o(v,s,m),null===h?l=v:h.sibling=v,h=v);return ia&&Qi(i,m),l}for(g=r(i,g);!v.done;m++,v=c.next())null!==(v=p(g,i,m,v.value,u))&&(t&&null!==v.alternate&&g.delete(null===v.key?m:v.key),s=o(v,s,m),null===h?l=v:h.sibling=v,h=v);return t&&g.forEach((function(t){return e(i,t)})),ia&&Qi(i,m),l}return function t(r,a,o,c){if("object"===typeof o&&null!==o&&o.type===_&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case w:t:{for(var u=o.key,l=a;null!==l;){if(l.key===u){if((u=o.type)===_){if(7===l.tag){n(r,l.sibling),(a=i(l,o.props.children)).return=r,r=a;break t}}else if(l.elementType===u||"object"===typeof u&&null!==u&&u.$$typeof===I&&Xa(u)===l.type){n(r,l.sibling),(a=i(l,o.props)).ref=Ha(r,l,o),a.return=r,r=a;break t}n(r,l);break}e(r,l),l=l.sibling}o.type===_?((a=zu(o.props.children,r.mode,c,o.key)).return=r,r=a):((c=Ru(o.type,o.key,o.props,null,r.mode,c)).ref=Ha(r,a,o),c.return=r,r=c)}return s(r);case k:t:{for(l=o.key;null!==a;){if(a.key===l){if(4===a.tag&&a.stateNode.containerInfo===o.containerInfo&&a.stateNode.implementation===o.implementation){n(r,a.sibling),(a=i(a,o.children||[])).return=r,r=a;break t}n(r,a);break}e(r,a),a=a.sibling}(a=Pu(o,r.mode,c)).return=r,r=a}return s(r);case I:return t(r,a,(l=o._init)(o._payload),c)}if(et(o))return g(r,a,o,c);if(R(o))return m(r,a,o,c);Ya(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==a&&6===a.tag?(n(r,a.sibling),(a=i(a,o)).return=r,r=a):(n(r,a),(a=Lu(o,r.mode,c)).return=r,r=a),s(r)):n(r,a)}}var $a=Ka(!0),Za=Ka(!1),Qa={},Ja=Si(Qa),to=Si(Qa),eo=Si(Qa);function no(t){if(t===Qa)throw Error(a(174));return t}function ro(t,e){switch(Ci(eo,e),Ci(to,t),Ci(Ja,Qa),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ct(null,"");break;default:e=ct(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}Ai(Ja),Ci(Ja,e)}function io(){Ai(Ja),Ai(to),Ai(eo)}function ao(t){no(eo.current);var e=no(Ja.current),n=ct(e,t.type);e!==n&&(Ci(to,t),Ci(Ja,n))}function oo(t){to.current===t&&(Ai(Ja),Ai(to))}var so=Si(0);function co(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var uo=[];function lo(){for(var t=0;t<uo.length;t++)uo[t]._workInProgressVersionPrimary=null;uo.length=0}var ho=x.ReactCurrentDispatcher,fo=x.ReactCurrentBatchConfig,po=0,go=null,mo=null,yo=null,vo=!1,bo=!1,xo=0,wo=0;function ko(){throw Error(a(321))}function _o(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!sr(t[n],e[n]))return!1;return!0}function So(t,e,n,r,i,o){if(po=o,go=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ho.current=null===t||null===t.memoizedState?ss:cs,t=n(r,i),bo){o=0;do{if(bo=!1,xo=0,25<=o)throw Error(a(301));o+=1,yo=mo=null,e.updateQueue=null,ho.current=us,t=n(r,i)}while(bo)}if(ho.current=os,e=null!==mo&&null!==mo.next,po=0,yo=mo=go=null,vo=!1,e)throw Error(a(300));return t}function Ao(){var t=0!==xo;return xo=0,t}function Co(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===yo?go.memoizedState=yo=t:yo=yo.next=t,yo}function Eo(){if(null===mo){var t=go.alternate;t=null!==t?t.memoizedState:null}else t=mo.next;var e=null===yo?go.memoizedState:yo.next;if(null!==e)yo=e,mo=t;else{if(null===t)throw Error(a(310));t={memoizedState:(mo=t).memoizedState,baseState:mo.baseState,baseQueue:mo.baseQueue,queue:mo.queue,next:null},null===yo?go.memoizedState=yo=t:yo=yo.next=t}return yo}function To(t,e){return"function"===typeof e?e(t):e}function No(t){var e=Eo(),n=e.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=t;var r=mo,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var c=s=null,u=null,l=o;do{var h=l.lane;if((po&h)===h)null!==u&&(u=u.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:t(r,l.action);else{var d={lane:h,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===u?(c=u=d,s=r):u=u.next=d,go.lanes|=h,Bc|=h}l=l.next}while(null!==l&&l!==o);null===u?s=r:u.next=c,sr(r,e.memoizedState)||(xs=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=u,n.lastRenderedState=r}if(null!==(t=n.interleaved)){i=t;do{o=i.lane,go.lanes|=o,Bc|=o,i=i.next}while(i!==t)}else null===i&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Do(t){var e=Eo(),n=e.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{o=t(o,s.action),s=s.next}while(s!==i);sr(o,e.memoizedState)||(xs=!0),e.memoizedState=o,null===e.baseQueue&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function Fo(){}function Io(t,e){var n=go,r=Eo(),i=e(),o=!sr(r.memoizedState,i);if(o&&(r.memoizedState=i,xs=!0),r=r.queue,qo(Ro.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||null!==yo&&1&yo.memoizedState.tag){if(n.flags|=2048,Po(9,Oo.bind(null,n,r,i,e),void 0,null),null===Dc)throw Error(a(349));0!==(30&po)||Mo(n,e,i)}return i}function Mo(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},null===(e=go.updateQueue)?(e={lastEffect:null,stores:null},go.updateQueue=e,e.stores=[t]):null===(n=e.stores)?e.stores=[t]:n.push(t)}function Oo(t,e,n,r){e.value=n,e.getSnapshot=r,zo(e)&&Bo(t)}function Ro(t,e,n){return n((function(){zo(e)&&Bo(t)}))}function zo(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!sr(t,n)}catch(r){return!0}}function Bo(t){var e=Na(t,1);null!==e&&ru(e,t,1,-1)}function Lo(t){var e=Co();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:To,lastRenderedState:t},e.queue=t,t=t.dispatch=ns.bind(null,go,t),[e.memoizedState,t]}function Po(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},null===(e=go.updateQueue)?(e={lastEffect:null,stores:null},go.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t),t}function jo(){return Eo().memoizedState}function Uo(t,e,n,r){var i=Co();go.flags|=t,i.memoizedState=Po(1|e,n,void 0,void 0===r?null:r)}function Wo(t,e,n,r){var i=Eo();r=void 0===r?null:r;var a=void 0;if(null!==mo){var o=mo.memoizedState;if(a=o.destroy,null!==r&&_o(r,o.deps))return void(i.memoizedState=Po(e,n,a,r))}go.flags|=t,i.memoizedState=Po(1|e,n,a,r)}function Vo(t,e){return Uo(8390656,8,t,e)}function qo(t,e){return Wo(2048,8,t,e)}function Go(t,e){return Wo(4,2,t,e)}function Ho(t,e){return Wo(4,4,t,e)}function Yo(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function Xo(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Wo(4,4,Yo.bind(null,e,t),n)}function Ko(){}function $o(t,e){var n=Eo();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&_o(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Zo(t,e){var n=Eo();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&_o(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Qo(t,e,n){return 0===(21&po)?(t.baseState&&(t.baseState=!1,xs=!0),t.memoizedState=n):(sr(n,e)||(n=ge(),go.lanes|=n,Bc|=n,t.baseState=!0),e)}function Jo(t,e){var n=be;be=0!==n&&4>n?n:4,t(!0);var r=fo.transition;fo.transition={};try{t(!1),e()}finally{be=n,fo.transition=r}}function ts(){return Eo().memoizedState}function es(t,e,n){var r=nu(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rs(t))is(e,n);else if(null!==(n=Ta(t,e,n,r))){ru(n,t,r,eu()),as(n,e,r)}}function ns(t,e,n){var r=nu(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rs(t))is(e,i);else{var a=t.alternate;if(0===t.lanes&&(null===a||0===a.lanes)&&null!==(a=e.lastRenderedReducer))try{var o=e.lastRenderedState,s=a(o,n);if(i.hasEagerState=!0,i.eagerState=s,sr(s,o)){var c=e.interleaved;return null===c?(i.next=i,Ea(e)):(i.next=c.next,c.next=i),void(e.interleaved=i)}}catch(u){}null!==(n=Ta(t,e,i,r))&&(ru(n,t,r,i=eu()),as(n,e,r))}}function rs(t){var e=t.alternate;return t===go||null!==e&&e===go}function is(t,e){bo=vo=!0;var n=t.pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function as(t,e,n){if(0!==(4194240&n)){var r=e.lanes;n|=r&=t.pendingLanes,e.lanes=n,ve(t,n)}}var os={readContext:Aa,useCallback:ko,useContext:ko,useEffect:ko,useImperativeHandle:ko,useInsertionEffect:ko,useLayoutEffect:ko,useMemo:ko,useReducer:ko,useRef:ko,useState:ko,useDebugValue:ko,useDeferredValue:ko,useTransition:ko,useMutableSource:ko,useSyncExternalStore:ko,useId:ko,unstable_isNewReconciler:!1},ss={readContext:Aa,useCallback:function(t,e){return Co().memoizedState=[t,void 0===e?null:e],t},useContext:Aa,useEffect:Vo,useImperativeHandle:function(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Uo(4194308,4,Yo.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Uo(4194308,4,t,e)},useInsertionEffect:function(t,e){return Uo(4,2,t,e)},useMemo:function(t,e){var n=Co();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Co();return e=void 0!==n?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=es.bind(null,go,t),[r.memoizedState,t]},useRef:function(t){return t={current:t},Co().memoizedState=t},useState:Lo,useDebugValue:Ko,useDeferredValue:function(t){return Co().memoizedState=t},useTransition:function(){var t=Lo(!1),e=t[0];return t=Jo.bind(null,t[1]),Co().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=go,i=Co();if(ia){if(void 0===n)throw Error(a(407));n=n()}else{if(n=e(),null===Dc)throw Error(a(349));0!==(30&po)||Mo(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,Vo(Ro.bind(null,r,o,t),[t]),r.flags|=2048,Po(9,Oo.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=Co(),e=Dc.identifierPrefix;if(ia){var n=Zi;e=":"+e+"R"+(n=($i&~(1<<32-oe($i)-1)).toString(32)+n),0<(n=xo++)&&(e+="H"+n.toString(32)),e+=":"}else e=":"+e+"r"+(n=wo++).toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},cs={readContext:Aa,useCallback:$o,useContext:Aa,useEffect:qo,useImperativeHandle:Xo,useInsertionEffect:Go,useLayoutEffect:Ho,useMemo:Zo,useReducer:No,useRef:jo,useState:function(){return No(To)},useDebugValue:Ko,useDeferredValue:function(t){return Qo(Eo(),mo.memoizedState,t)},useTransition:function(){return[No(To)[0],Eo().memoizedState]},useMutableSource:Fo,useSyncExternalStore:Io,useId:ts,unstable_isNewReconciler:!1},us={readContext:Aa,useCallback:$o,useContext:Aa,useEffect:qo,useImperativeHandle:Xo,useInsertionEffect:Go,useLayoutEffect:Ho,useMemo:Zo,useReducer:Do,useRef:jo,useState:function(){return Do(To)},useDebugValue:Ko,useDeferredValue:function(t){var e=Eo();return null===mo?e.memoizedState=t:Qo(e,mo.memoizedState,t)},useTransition:function(){return[Do(To)[0],Eo().memoizedState]},useMutableSource:Fo,useSyncExternalStore:Io,useId:ts,unstable_isNewReconciler:!1};function ls(t,e){try{var n="",r=e;do{n+=U(r),r=r.return}while(r);var i=n}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:t,source:e,stack:i,digest:null}}function hs(t,e,n){return{value:t,source:null,stack:null!=n?n:null,digest:null!=e?e:null}}function ds(t,e){try{console.error(e.value)}catch(n){setTimeout((function(){throw n}))}}var fs="function"===typeof WeakMap?WeakMap:Map;function ps(t,e,n){(n=Ma(-1,n)).tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Gc||(Gc=!0,Hc=r),ds(0,e)},n}function gs(t,e,n){(n=Ma(-1,n)).tag=3;var r=t.type.getDerivedStateFromError;if("function"===typeof r){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){ds(0,e)}}var a=t.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){ds(0,e),"function"!==typeof r&&(null===Yc?Yc=new Set([this]):Yc.add(this));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),n}function ms(t,e,n){var r=t.pingCache;if(null===r){r=t.pingCache=new fs;var i=new Set;r.set(e,i)}else void 0===(i=r.get(e))&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=Cu.bind(null,t,e,n),e.then(t,t))}function ys(t){do{var e;if((e=13===t.tag)&&(e=null===(e=t.memoizedState)||null!==e.dehydrated),e)return t;t=t.return}while(null!==t);return null}function vs(t,e,n,r,i){return 0===(1&t.mode)?(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((e=Ma(-1,1)).tag=2,Oa(n,e,1))),n.lanes|=1),t):(t.flags|=65536,t.lanes=i,t)}var bs=x.ReactCurrentOwner,xs=!1;function ws(t,e,n,r){e.child=null===t?Za(e,null,n,r):$a(e,t.child,n,r)}function ks(t,e,n,r,i){n=n.render;var a=e.ref;return Sa(e,i),r=So(t,e,n,r,a,i),n=Ao(),null===t||xs?(ia&&n&&ta(e),e.flags|=1,ws(t,e,r,i),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Gs(t,e,i))}function _s(t,e,n,r,i){if(null===t){var a=n.type;return"function"!==typeof a||Mu(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Ru(n.type,null,r,e,e.mode,i)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=a,Ss(t,e,a,r,i))}if(a=t.child,0===(t.lanes&i)){var o=a.memoizedProps;if((n=null!==(n=n.compare)?n:cr)(o,r)&&t.ref===e.ref)return Gs(t,e,i)}return e.flags|=1,(t=Ou(a,r)).ref=e.ref,t.return=e,e.child=t}function Ss(t,e,n,r,i){if(null!==t){var a=t.memoizedProps;if(cr(a,r)&&t.ref===e.ref){if(xs=!1,e.pendingProps=r=a,0===(t.lanes&i))return e.lanes=t.lanes,Gs(t,e,i);0!==(131072&t.flags)&&(xs=!0)}}return Es(t,e,n,r,i)}function As(t,e,n){var r=e.pendingProps,i=r.children,a=null!==t?t.memoizedState:null;if("hidden"===r.mode)if(0===(1&e.mode))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ci(Oc,Mc),Mc|=n;else{if(0===(1073741824&n))return t=null!==a?a.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ci(Oc,Mc),Mc|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,Ci(Oc,Mc),Mc|=r}else null!==a?(r=a.baseLanes|n,e.memoizedState=null):r=n,Ci(Oc,Mc),Mc|=r;return ws(t,e,i,n),e.child}function Cs(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Es(t,e,n,r,i){var a=Ii(n)?Di:Ti.current;return a=Fi(e,a),Sa(e,i),n=So(t,e,n,r,a,i),r=Ao(),null===t||xs?(ia&&r&&ta(e),e.flags|=1,ws(t,e,n,i),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Gs(t,e,i))}function Ts(t,e,n,r,i){if(Ii(n)){var a=!0;zi(e)}else a=!1;if(Sa(e,i),null===e.stateNode)qs(t,e),Va(e,n,r),Ga(e,n,r,i),r=!0;else if(null===t){var o=e.stateNode,s=e.memoizedProps;o.props=s;var c=o.context,u=n.contextType;"object"===typeof u&&null!==u?u=Aa(u):u=Fi(e,u=Ii(n)?Di:Ti.current);var l=n.getDerivedStateFromProps,h="function"===typeof l||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||c!==u)&&qa(e,o,r,u),Da=!1;var d=e.memoizedState;o.state=d,Ba(e,r,o,i),c=e.memoizedState,s!==r||d!==c||Ni.current||Da?("function"===typeof l&&(ja(e,n,l,r),c=e.memoizedState),(s=Da||Wa(e,n,s,r,d,c,u))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(e.flags|=4194308)):("function"===typeof o.componentDidMount&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=s):("function"===typeof o.componentDidMount&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Ia(t,e),s=e.memoizedProps,u=e.type===e.elementType?s:ma(e.type,s),o.props=u,h=e.pendingProps,d=o.context,"object"===typeof(c=n.contextType)&&null!==c?c=Aa(c):c=Fi(e,c=Ii(n)?Di:Ti.current);var f=n.getDerivedStateFromProps;(l="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==h||d!==c)&&qa(e,o,r,c),Da=!1,d=e.memoizedState,o.state=d,Ba(e,r,o,i);var p=e.memoizedState;s!==h||d!==p||Ni.current||Da?("function"===typeof f&&(ja(e,n,f,r),p=e.memoizedState),(u=Da||Wa(e,n,u,r,d,p,c)||!1)?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,c),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,c)),"function"===typeof o.componentDidUpdate&&(e.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=c,r=u):("function"!==typeof o.componentDidUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),r=!1)}return Ns(t,e,n,r,a,i)}function Ns(t,e,n,r,i,a){Cs(t,e);var o=0!==(128&e.flags);if(!r&&!o)return i&&Bi(e,n,!1),Gs(t,e,a);r=e.stateNode,bs.current=e;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return e.flags|=1,null!==t&&o?(e.child=$a(e,t.child,null,a),e.child=$a(e,null,s,a)):ws(t,e,s,a),e.memoizedState=r.state,i&&Bi(e,n,!0),e.child}function Ds(t){var e=t.stateNode;e.pendingContext?Oi(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Oi(0,e.context,!1),ro(t,e.containerInfo)}function Fs(t,e,n,r,i){return fa(),pa(i),e.flags|=256,ws(t,e,n,r),e.child}var Is,Ms,Os,Rs,zs={dehydrated:null,treeContext:null,retryLane:0};function Bs(t){return{baseLanes:t,cachePool:null,transitions:null}}function Ls(t,e,n){var r,i=e.pendingProps,o=so.current,s=!1,c=0!==(128&e.flags);if((r=c)||(r=(null===t||null!==t.memoizedState)&&0!==(2&o)),r?(s=!0,e.flags&=-129):null!==t&&null===t.memoizedState||(o|=1),Ci(so,1&o),null===t)return ua(e),null!==(t=e.memoizedState)&&null!==(t=t.dehydrated)?(0===(1&e.mode)?e.lanes=1:"$!"===t.data?e.lanes=8:e.lanes=1073741824,null):(c=i.children,t=i.fallback,s?(i=e.mode,s=e.child,c={mode:"hidden",children:c},0===(1&i)&&null!==s?(s.childLanes=0,s.pendingProps=c):s=Bu(c,i,0,null),t=zu(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Bs(n),e.memoizedState=zs,t):Ps(e,c));if(null!==(o=t.memoizedState)&&null!==(r=o.dehydrated))return function(t,e,n,r,i,o,s){if(n)return 256&e.flags?(e.flags&=-257,js(t,e,s,r=hs(Error(a(422))))):null!==e.memoizedState?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=Bu({mode:"visible",children:r.children},i,0,null),(o=zu(o,i,s,null)).flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,0!==(1&e.mode)&&$a(e,t.child,null,s),e.child.memoizedState=Bs(s),e.memoizedState=zs,o);if(0===(1&e.mode))return js(t,e,s,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var c=r.dgst;return r=c,js(t,e,s,r=hs(o=Error(a(419)),r,void 0))}if(c=0!==(s&t.childLanes),xs||c){if(null!==(r=Dc)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|s))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Na(t,i),ru(r,t,i,-1))}return mu(),js(t,e,s,r=hs(Error(a(421))))}return"$?"===i.data?(e.flags|=128,e.child=t.child,e=Tu.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,ra=ui(i.nextSibling),na=e,ia=!0,aa=null,null!==t&&(Yi[Xi++]=$i,Yi[Xi++]=Zi,Yi[Xi++]=Ki,$i=t.id,Zi=t.overflow,Ki=e),e=Ps(e,r.children),e.flags|=4096,e)}(t,e,c,i,r,o,n);if(s){s=i.fallback,c=e.mode,r=(o=t.child).sibling;var u={mode:"hidden",children:i.children};return 0===(1&c)&&e.child!==o?((i=e.child).childLanes=0,i.pendingProps=u,e.deletions=null):(i=Ou(o,u)).subtreeFlags=14680064&o.subtreeFlags,null!==r?s=Ou(r,s):(s=zu(s,c,n,null)).flags|=2,s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,c=null===(c=t.child.memoizedState)?Bs(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},s.memoizedState=c,s.childLanes=t.childLanes&~n,e.memoizedState=zs,i}return t=(s=t.child).sibling,i=Ou(s,{mode:"visible",children:i.children}),0===(1&e.mode)&&(i.lanes=n),i.return=e,i.sibling=null,null!==t&&(null===(n=e.deletions)?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function Ps(t,e){return(e=Bu({mode:"visible",children:e},t.mode,0,null)).return=t,t.child=e}function js(t,e,n,r){return null!==r&&pa(r),$a(e,t.child,null,n),(t=Ps(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function Us(t,e,n){t.lanes|=e;var r=t.alternate;null!==r&&(r.lanes|=e),_a(t.return,e,n)}function Ws(t,e,n,r,i){var a=t.memoizedState;null===a?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function Vs(t,e,n){var r=e.pendingProps,i=r.revealOrder,a=r.tail;if(ws(t,e,r.children,n),0!==(2&(r=so.current)))r=1&r|2,e.flags|=128;else{if(null!==t&&0!==(128&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&Us(t,n,e);else if(19===t.tag)Us(t,n,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ci(so,r),0===(1&e.mode))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;null!==n;)null!==(t=n.alternate)&&null===co(t)&&(i=n),n=n.sibling;null===(n=i)?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Ws(e,!1,i,n,a);break;case"backwards":for(n=null,i=e.child,e.child=null;null!==i;){if(null!==(t=i.alternate)&&null===co(t)){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Ws(e,!0,n,null,a);break;case"together":Ws(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function qs(t,e){0===(1&e.mode)&&null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Gs(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),Bc|=e.lanes,0===(n&e.childLanes))return null;if(null!==t&&e.child!==t.child)throw Error(a(153));if(null!==e.child){for(n=Ou(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Ou(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function Hs(t,e){if(!ia)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?e||null===t.tail?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ys(t){var e=null!==t.alternate&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=t,i=i.sibling;else for(i=t.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Xs(t,e,n){var r=e.pendingProps;switch(ea(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ys(e),null;case 1:case 17:return Ii(e.type)&&Mi(),Ys(e),null;case 3:return r=e.stateNode,io(),Ai(Ni),Ai(Ti),lo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==t&&null!==t.child||(ha(e)?e.flags|=4:null===t||t.memoizedState.isDehydrated&&0===(256&e.flags)||(e.flags|=1024,null!==aa&&(su(aa),aa=null))),Ms(t,e),Ys(e),null;case 5:oo(e);var i=no(eo.current);if(n=e.type,null!==t&&null!=e.stateNode)Os(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(null===e.stateNode)throw Error(a(166));return Ys(e),null}if(t=no(Ja.current),ha(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[di]=e,r[fi]=o,t=0!==(1&e.mode),n){case"dialog":Pr("cancel",r),Pr("close",r);break;case"iframe":case"object":case"embed":Pr("load",r);break;case"video":case"audio":for(i=0;i<Rr.length;i++)Pr(Rr[i],r);break;case"source":Pr("error",r);break;case"img":case"image":case"link":Pr("error",r),Pr("load",r);break;case"details":Pr("toggle",r);break;case"input":$(r,o),Pr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Pr("invalid",r);break;case"textarea":it(r,o),Pr("invalid",r)}for(var c in vt(n,o),i=null,o)if(o.hasOwnProperty(c)){var u=o[c];"children"===c?"string"===typeof u?r.textContent!==u&&(!0!==o.suppressHydrationWarning&&Qr(r.textContent,u,t),i=["children",u]):"number"===typeof u&&r.textContent!==""+u&&(!0!==o.suppressHydrationWarning&&Qr(r.textContent,u,t),i=["children",""+u]):s.hasOwnProperty(c)&&null!=u&&"onScroll"===c&&Pr("scroll",r)}switch(n){case"input":H(r),J(r,o,!0);break;case"textarea":H(r),ot(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Jr)}r=i,e.updateQueue=r,null!==r&&(e.flags|=4)}else{c=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===t&&(t=st(n)),"http://www.w3.org/1999/xhtml"===t?"script"===n?((t=c.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof r.is?t=c.createElement(n,{is:r.is}):(t=c.createElement(n),"select"===n&&(c=t,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):t=c.createElementNS(t,n),t[di]=e,t[fi]=r,Is(t,e,!1,!1),e.stateNode=t;t:{switch(c=bt(n,r),n){case"dialog":Pr("cancel",t),Pr("close",t),i=r;break;case"iframe":case"object":case"embed":Pr("load",t),i=r;break;case"video":case"audio":for(i=0;i<Rr.length;i++)Pr(Rr[i],t);i=r;break;case"source":Pr("error",t),i=r;break;case"img":case"image":case"link":Pr("error",t),Pr("load",t),i=r;break;case"details":Pr("toggle",t),i=r;break;case"input":$(t,r),i=K(t,r),Pr("invalid",t);break;case"option":default:i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=B({},r,{value:void 0}),Pr("invalid",t);break;case"textarea":it(t,r),i=rt(t,r),Pr("invalid",t)}for(o in vt(n,i),u=i)if(u.hasOwnProperty(o)){var l=u[o];"style"===o?mt(t,l):"dangerouslySetInnerHTML"===o?null!=(l=l?l.__html:void 0)&&ht(t,l):"children"===o?"string"===typeof l?("textarea"!==n||""!==l)&&dt(t,l):"number"===typeof l&&dt(t,""+l):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=l&&"onScroll"===o&&Pr("scroll",t):null!=l&&b(t,o,l,c))}switch(n){case"input":H(t),J(t,r,!1);break;case"textarea":H(t),ot(t);break;case"option":null!=r.value&&t.setAttribute("value",""+q(r.value));break;case"select":t.multiple=!!r.multiple,null!=(o=r.value)?nt(t,!!r.multiple,o,!1):null!=r.defaultValue&&nt(t,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(t.onclick=Jr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break t;case"img":r=!0;break t;default:r=!1}}r&&(e.flags|=4)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return Ys(e),null;case 6:if(t&&null!=e.stateNode)Rs(t,e,t.memoizedProps,r);else{if("string"!==typeof r&&null===e.stateNode)throw Error(a(166));if(n=no(eo.current),no(Ja.current),ha(e)){if(r=e.stateNode,n=e.memoizedProps,r[di]=e,(o=r.nodeValue!==n)&&null!==(t=na))switch(t.tag){case 3:Qr(r.nodeValue,n,0!==(1&t.mode));break;case 5:!0!==t.memoizedProps.suppressHydrationWarning&&Qr(r.nodeValue,n,0!==(1&t.mode))}o&&(e.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[di]=e,e.stateNode=r}return Ys(e),null;case 13:if(Ai(so),r=e.memoizedState,null===t||null!==t.memoizedState&&null!==t.memoizedState.dehydrated){if(ia&&null!==ra&&0!==(1&e.mode)&&0===(128&e.flags))da(),fa(),e.flags|=98560,o=!1;else if(o=ha(e),null!==r&&null!==r.dehydrated){if(null===t){if(!o)throw Error(a(318));if(!(o=null!==(o=e.memoizedState)?o.dehydrated:null))throw Error(a(317));o[di]=e}else fa(),0===(128&e.flags)&&(e.memoizedState=null),e.flags|=4;Ys(e),o=!1}else null!==aa&&(su(aa),aa=null),o=!0;if(!o)return 65536&e.flags?e:null}return 0!==(128&e.flags)?(e.lanes=n,e):((r=null!==r)!==(null!==t&&null!==t.memoizedState)&&r&&(e.child.flags|=8192,0!==(1&e.mode)&&(null===t||0!==(1&so.current)?0===Rc&&(Rc=3):mu())),null!==e.updateQueue&&(e.flags|=4),Ys(e),null);case 4:return io(),Ms(t,e),null===t&&Wr(e.stateNode.containerInfo),Ys(e),null;case 10:return ka(e.type._context),Ys(e),null;case 19:if(Ai(so),null===(o=e.memoizedState))return Ys(e),null;if(r=0!==(128&e.flags),null===(c=o.rendering))if(r)Hs(o,!1);else{if(0!==Rc||null!==t&&0!==(128&t.flags))for(t=e.child;null!==t;){if(null!==(c=co(t))){for(e.flags|=128,Hs(o,!1),null!==(r=c.updateQueue)&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;null!==n;)t=r,(o=n).flags&=14680066,null===(c=o.alternate)?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=c.childLanes,o.lanes=c.lanes,o.child=c.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=c.memoizedProps,o.memoizedState=c.memoizedState,o.updateQueue=c.updateQueue,o.type=c.type,t=c.dependencies,o.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ci(so,1&so.current|2),e.child}t=t.sibling}null!==o.tail&&Zt()>Vc&&(e.flags|=128,r=!0,Hs(o,!1),e.lanes=4194304)}else{if(!r)if(null!==(t=co(c))){if(e.flags|=128,r=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.flags|=4),Hs(o,!0),null===o.tail&&"hidden"===o.tailMode&&!c.alternate&&!ia)return Ys(e),null}else 2*Zt()-o.renderingStartTime>Vc&&1073741824!==n&&(e.flags|=128,r=!0,Hs(o,!1),e.lanes=4194304);o.isBackwards?(c.sibling=e.child,e.child=c):(null!==(n=o.last)?n.sibling=c:e.child=c,o.last=c)}return null!==o.tail?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Zt(),e.sibling=null,n=so.current,Ci(so,r?1&n|2:1&n),e):(Ys(e),null);case 22:case 23:return du(),r=null!==e.memoizedState,null!==t&&null!==t.memoizedState!==r&&(e.flags|=8192),r&&0!==(1&e.mode)?0!==(1073741824&Mc)&&(Ys(e),6&e.subtreeFlags&&(e.flags|=8192)):Ys(e),null;case 24:case 25:return null}throw Error(a(156,e.tag))}function Ks(t,e){switch(ea(e),e.tag){case 1:return Ii(e.type)&&Mi(),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return io(),Ai(Ni),Ai(Ti),lo(),0!==(65536&(t=e.flags))&&0===(128&t)?(e.flags=-65537&t|128,e):null;case 5:return oo(e),null;case 13:if(Ai(so),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(a(340));fa()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return Ai(so),null;case 4:return io(),null;case 10:return ka(e.type._context),null;case 22:case 23:return du(),null;default:return null}}Is=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ms=function(){},Os=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,no(Ja.current);var a,o=null;switch(n){case"input":i=K(t,i),r=K(t,r),o=[];break;case"select":i=B({},i,{value:void 0}),r=B({},r,{value:void 0}),o=[];break;case"textarea":i=rt(t,i),r=rt(t,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(t.onclick=Jr)}for(l in vt(n,r),n=null,i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&null!=i[l])if("style"===l){var c=i[l];for(a in c)c.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(s.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var u=r[l];if(c=null!=i?i[l]:void 0,r.hasOwnProperty(l)&&u!==c&&(null!=u||null!=c))if("style"===l)if(c){for(a in c)!c.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&c[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(o||(o=[]),o.push(l,n)),n=u;else"dangerouslySetInnerHTML"===l?(u=u?u.__html:void 0,c=c?c.__html:void 0,null!=u&&c!==u&&(o=o||[]).push(l,u)):"children"===l?"string"!==typeof u&&"number"!==typeof u||(o=o||[]).push(l,""+u):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(s.hasOwnProperty(l)?(null!=u&&"onScroll"===l&&Pr("scroll",t),o||c===u||(o=[])):(o=o||[]).push(l,u))}n&&(o=o||[]).push("style",n);var l=o;(e.updateQueue=l)&&(e.flags|=4)}},Rs=function(t,e,n,r){n!==r&&(e.flags|=4)};var $s=!1,Zs=!1,Qs="function"===typeof WeakSet?WeakSet:Set,Js=null;function tc(t,e){var n=t.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Au(t,e,r)}else n.current=null}function ec(t,e,n){try{n()}catch(r){Au(t,e,r)}}var nc=!1;function rc(t,e,n){var r=e.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&t)===t){var a=i.destroy;i.destroy=void 0,void 0!==a&&ec(e,n,a)}i=i.next}while(i!==r)}}function ic(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function ac(t){var e=t.ref;if(null!==e){var n=t.stateNode;t.tag,t=n,"function"===typeof e?e(t):e.current=t}}function oc(t){var e=t.alternate;null!==e&&(t.alternate=null,oc(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&(null!==(e=t.stateNode)&&(delete e[di],delete e[fi],delete e[gi],delete e[mi],delete e[yi])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function sc(t){return 5===t.tag||3===t.tag||4===t.tag}function cc(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||sc(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function uc(t,e,n){var r=t.tag;if(5===r||6===r)t=t.stateNode,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!==(n=n._reactRootContainer)&&void 0!==n||null!==e.onclick||(e.onclick=Jr));else if(4!==r&&null!==(t=t.child))for(uc(t,e,n),t=t.sibling;null!==t;)uc(t,e,n),t=t.sibling}function lc(t,e,n){var r=t.tag;if(5===r||6===r)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==r&&null!==(t=t.child))for(lc(t,e,n),t=t.sibling;null!==t;)lc(t,e,n),t=t.sibling}var hc=null,dc=!1;function fc(t,e,n){for(n=n.child;null!==n;)pc(t,e,n),n=n.sibling}function pc(t,e,n){if(ae&&"function"===typeof ae.onCommitFiberUnmount)try{ae.onCommitFiberUnmount(ie,n)}catch(s){}switch(n.tag){case 5:Zs||tc(n,e);case 6:var r=hc,i=dc;hc=null,fc(t,e,n),dc=i,null!==(hc=r)&&(dc?(t=hc,n=n.stateNode,8===t.nodeType?t.parentNode.removeChild(n):t.removeChild(n)):hc.removeChild(n.stateNode));break;case 18:null!==hc&&(dc?(t=hc,n=n.stateNode,8===t.nodeType?ci(t.parentNode,n):1===t.nodeType&&ci(t,n),We(t)):ci(hc,n.stateNode));break;case 4:r=hc,i=dc,hc=n.stateNode.containerInfo,dc=!0,fc(t,e,n),hc=r,dc=i;break;case 0:case 11:case 14:case 15:if(!Zs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,void 0!==o&&(0!==(2&a)||0!==(4&a))&&ec(n,e,o),i=i.next}while(i!==r)}fc(t,e,n);break;case 1:if(!Zs&&(tc(n,e),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Au(n,e,s)}fc(t,e,n);break;case 21:fc(t,e,n);break;case 22:1&n.mode?(Zs=(r=Zs)||null!==n.memoizedState,fc(t,e,n),Zs=r):fc(t,e,n);break;default:fc(t,e,n)}}function gc(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new Qs),e.forEach((function(e){var r=Nu.bind(null,t,e);n.has(e)||(n.add(e),e.then(r,r))}))}}function mc(t,e){var n=e.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,s=e,c=s;t:for(;null!==c;){switch(c.tag){case 5:hc=c.stateNode,dc=!1;break t;case 3:case 4:hc=c.stateNode.containerInfo,dc=!0;break t}c=c.return}if(null===hc)throw Error(a(160));pc(o,s,i),hc=null,dc=!1;var u=i.alternate;null!==u&&(u.return=null),i.return=null}catch(l){Au(i,e,l)}}if(12854&e.subtreeFlags)for(e=e.child;null!==e;)yc(e,t),e=e.sibling}function yc(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(mc(e,t),vc(t),4&r){try{rc(3,t,t.return),ic(3,t)}catch(m){Au(t,t.return,m)}try{rc(5,t,t.return)}catch(m){Au(t,t.return,m)}}break;case 1:mc(e,t),vc(t),512&r&&null!==n&&tc(n,n.return);break;case 5:if(mc(e,t),vc(t),512&r&&null!==n&&tc(n,n.return),32&t.flags){var i=t.stateNode;try{dt(i,"")}catch(m){Au(t,t.return,m)}}if(4&r&&null!=(i=t.stateNode)){var o=t.memoizedProps,s=null!==n?n.memoizedProps:o,c=t.type,u=t.updateQueue;if(t.updateQueue=null,null!==u)try{"input"===c&&"radio"===o.type&&null!=o.name&&Z(i,o),bt(c,s);var l=bt(c,o);for(s=0;s<u.length;s+=2){var h=u[s],d=u[s+1];"style"===h?mt(i,d):"dangerouslySetInnerHTML"===h?ht(i,d):"children"===h?dt(i,d):b(i,h,d,l)}switch(c){case"input":Q(i,o);break;case"textarea":at(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?nt(i,!!o.multiple,p,!1):f!==!!o.multiple&&(null!=o.defaultValue?nt(i,!!o.multiple,o.defaultValue,!0):nt(i,!!o.multiple,o.multiple?[]:"",!1))}i[fi]=o}catch(m){Au(t,t.return,m)}}break;case 6:if(mc(e,t),vc(t),4&r){if(null===t.stateNode)throw Error(a(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(m){Au(t,t.return,m)}}break;case 3:if(mc(e,t),vc(t),4&r&&null!==n&&n.memoizedState.isDehydrated)try{We(e.containerInfo)}catch(m){Au(t,t.return,m)}break;case 4:default:mc(e,t),vc(t);break;case 13:mc(e,t),vc(t),8192&(i=t.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(Wc=Zt())),4&r&&gc(t);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&t.mode?(Zs=(l=Zs)||h,mc(e,t),Zs=l):mc(e,t),vc(t),8192&r){if(l=null!==t.memoizedState,(t.stateNode.isHidden=l)&&!h&&0!==(1&t.mode))for(Js=t,h=t.child;null!==h;){for(d=Js=h;null!==Js;){switch(p=(f=Js).child,f.tag){case 0:case 11:case 14:case 15:rc(4,f,f.return);break;case 1:tc(f,f.return);var g=f.stateNode;if("function"===typeof g.componentWillUnmount){r=f,n=f.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(m){Au(r,n,m)}}break;case 5:tc(f,f.return);break;case 22:if(null!==f.memoizedState){kc(d);continue}}null!==p?(p.return=f,Js=p):kc(d)}h=h.sibling}t:for(h=null,d=t;;){if(5===d.tag){if(null===h){h=d;try{i=d.stateNode,l?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(c=d.stateNode,s=void 0!==(u=d.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,c.style.display=gt("display",s))}catch(m){Au(t,t.return,m)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(m){Au(t,t.return,m)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===t)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===t)break t;for(;null===d.sibling;){if(null===d.return||d.return===t)break t;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:mc(e,t),vc(t),4&r&&gc(t);case 21:}}function vc(t){var e=t.flags;if(2&e){try{t:{for(var n=t.return;null!==n;){if(sc(n)){var r=n;break t}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(dt(i,""),r.flags&=-33),lc(t,cc(t),i);break;case 3:case 4:var o=r.stateNode.containerInfo;uc(t,cc(t),o);break;default:throw Error(a(161))}}catch(s){Au(t,t.return,s)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function bc(t,e,n){Js=t,xc(t,e,n)}function xc(t,e,n){for(var r=0!==(1&t.mode);null!==Js;){var i=Js,a=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||$s;if(!o){var s=i.alternate,c=null!==s&&null!==s.memoizedState||Zs;s=$s;var u=Zs;if($s=o,(Zs=c)&&!u)for(Js=i;null!==Js;)c=(o=Js).child,22===o.tag&&null!==o.memoizedState?_c(i):null!==c?(c.return=o,Js=c):_c(i);for(;null!==a;)Js=a,xc(a,e,n),a=a.sibling;Js=i,$s=s,Zs=u}wc(t)}else 0!==(8772&i.subtreeFlags)&&null!==a?(a.return=i,Js=a):wc(t)}}function wc(t){for(;null!==Js;){var e=Js;if(0!==(8772&e.flags)){var n=e.alternate;try{if(0!==(8772&e.flags))switch(e.tag){case 0:case 11:case 15:Zs||ic(5,e);break;case 1:var r=e.stateNode;if(4&e.flags&&!Zs)if(null===n)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:ma(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;null!==o&&La(e,o,r);break;case 3:var s=e.updateQueue;if(null!==s){if(n=null,null!==e.child)switch(e.child.tag){case 5:case 1:n=e.child.stateNode}La(e,s,n)}break;case 5:var c=e.stateNode;if(null===n&&4&e.flags){n=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===e.memoizedState){var l=e.alternate;if(null!==l){var h=l.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&We(d)}}}break;default:throw Error(a(163))}Zs||512&e.flags&&ac(e)}catch(f){Au(e,e.return,f)}}if(e===t){Js=null;break}if(null!==(n=e.sibling)){n.return=e.return,Js=n;break}Js=e.return}}function kc(t){for(;null!==Js;){var e=Js;if(e===t){Js=null;break}var n=e.sibling;if(null!==n){n.return=e.return,Js=n;break}Js=e.return}}function _c(t){for(;null!==Js;){var e=Js;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{ic(4,e)}catch(c){Au(e,n,c)}break;case 1:var r=e.stateNode;if("function"===typeof r.componentDidMount){var i=e.return;try{r.componentDidMount()}catch(c){Au(e,i,c)}}var a=e.return;try{ac(e)}catch(c){Au(e,a,c)}break;case 5:var o=e.return;try{ac(e)}catch(c){Au(e,o,c)}}}catch(c){Au(e,e.return,c)}if(e===t){Js=null;break}var s=e.sibling;if(null!==s){s.return=e.return,Js=s;break}Js=e.return}}var Sc,Ac=Math.ceil,Cc=x.ReactCurrentDispatcher,Ec=x.ReactCurrentOwner,Tc=x.ReactCurrentBatchConfig,Nc=0,Dc=null,Fc=null,Ic=0,Mc=0,Oc=Si(0),Rc=0,zc=null,Bc=0,Lc=0,Pc=0,jc=null,Uc=null,Wc=0,Vc=1/0,qc=null,Gc=!1,Hc=null,Yc=null,Xc=!1,Kc=null,$c=0,Zc=0,Qc=null,Jc=-1,tu=0;function eu(){return 0!==(6&Nc)?Zt():-1!==Jc?Jc:Jc=Zt()}function nu(t){return 0===(1&t.mode)?1:0!==(2&Nc)&&0!==Ic?Ic&-Ic:null!==ga.transition?(0===tu&&(tu=ge()),tu):0!==(t=be)?t:t=void 0===(t=window.event)?16:$e(t.type)}function ru(t,e,n,r){if(50<Zc)throw Zc=0,Qc=null,Error(a(185));ye(t,n,r),0!==(2&Nc)&&t===Dc||(t===Dc&&(0===(2&Nc)&&(Lc|=n),4===Rc&&cu(t,Ic)),iu(t,r),1===n&&0===Nc&&0===(1&e.mode)&&(Vc=Zt()+500,Pi&&Wi()))}function iu(t,e){var n=t.callbackNode;!function(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes;0<a;){var o=31-oe(a),s=1<<o,c=i[o];-1===c?0!==(s&n)&&0===(s&r)||(i[o]=fe(s,e)):c<=e&&(t.expiredLanes|=s),a&=~s}}(t,e);var r=de(t,t===Dc?Ic:0);if(0===r)null!==n&&Xt(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(null!=n&&Xt(n),1===e)0===t.tag?function(t){Pi=!0,Ui(t)}(uu.bind(null,t)):Ui(uu.bind(null,t)),oi((function(){0===(6&Nc)&&Wi()})),n=null;else{switch(xe(r)){case 1:n=Jt;break;case 4:n=te;break;case 16:default:n=ee;break;case 536870912:n=re}n=Du(n,au.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function au(t,e){if(Jc=-1,tu=0,0!==(6&Nc))throw Error(a(327));var n=t.callbackNode;if(_u()&&t.callbackNode!==n)return null;var r=de(t,t===Dc?Ic:0);if(0===r)return null;if(0!==(30&r)||0!==(r&t.expiredLanes)||e)e=yu(t,r);else{e=r;var i=Nc;Nc|=2;var o=gu();for(Dc===t&&Ic===e||(qc=null,Vc=Zt()+500,fu(t,e));;)try{bu();break}catch(c){pu(t,c)}wa(),Cc.current=o,Nc=i,null!==Fc?e=0:(Dc=null,Ic=0,e=Rc)}if(0!==e){if(2===e&&(0!==(i=pe(t))&&(r=i,e=ou(t,i))),1===e)throw n=zc,fu(t,0),cu(t,r),iu(t,Zt()),n;if(6===e)cu(t,r);else{if(i=t.current.alternate,0===(30&r)&&!function(t){for(var e=t;;){if(16384&e.flags){var n=e.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!sr(a(),i))return!1}catch(s){return!1}}}if(n=e.child,16384&e.subtreeFlags&&null!==n)n.return=e,e=n;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(i)&&(2===(e=yu(t,r))&&(0!==(o=pe(t))&&(r=o,e=ou(t,o))),1===e))throw n=zc,fu(t,0),cu(t,r),iu(t,Zt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(a(345));case 2:case 5:ku(t,Uc,qc);break;case 3:if(cu(t,r),(130023424&r)===r&&10<(e=Wc+500-Zt())){if(0!==de(t,0))break;if(((i=t.suspendedLanes)&r)!==r){eu(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=ri(ku.bind(null,t,Uc,qc),e);break}ku(t,Uc,qc);break;case 4:if(cu(t,r),(4194240&r)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-oe(r);o=1<<s,(s=e[s])>i&&(i=s),r&=~o}if(r=i,10<(r=(120>(r=Zt()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Ac(r/1960))-r)){t.timeoutHandle=ri(ku.bind(null,t,Uc,qc),r);break}ku(t,Uc,qc);break;default:throw Error(a(329))}}}return iu(t,Zt()),t.callbackNode===n?au.bind(null,t):null}function ou(t,e){var n=jc;return t.current.memoizedState.isDehydrated&&(fu(t,e).flags|=256),2!==(t=yu(t,e))&&(e=Uc,Uc=n,null!==e&&su(e)),t}function su(t){null===Uc?Uc=t:Uc.push.apply(Uc,t)}function cu(t,e){for(e&=~Pc,e&=~Lc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-oe(e),r=1<<n;t[n]=-1,e&=~r}}function uu(t){if(0!==(6&Nc))throw Error(a(327));_u();var e=de(t,0);if(0===(1&e))return iu(t,Zt()),null;var n=yu(t,e);if(0!==t.tag&&2===n){var r=pe(t);0!==r&&(e=r,n=ou(t,r))}if(1===n)throw n=zc,fu(t,0),cu(t,e),iu(t,Zt()),n;if(6===n)throw Error(a(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ku(t,Uc,qc),iu(t,Zt()),null}function lu(t,e){var n=Nc;Nc|=1;try{return t(e)}finally{0===(Nc=n)&&(Vc=Zt()+500,Pi&&Wi())}}function hu(t){null!==Kc&&0===Kc.tag&&0===(6&Nc)&&_u();var e=Nc;Nc|=1;var n=Tc.transition,r=be;try{if(Tc.transition=null,be=1,t)return t()}finally{be=r,Tc.transition=n,0===(6&(Nc=e))&&Wi()}}function du(){Mc=Oc.current,Ai(Oc)}function fu(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,ii(n)),null!==Fc)for(n=Fc.return;null!==n;){var r=n;switch(ea(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Mi();break;case 3:io(),Ai(Ni),Ai(Ti),lo();break;case 5:oo(r);break;case 4:io();break;case 13:case 19:Ai(so);break;case 10:ka(r.type._context);break;case 22:case 23:du()}n=n.return}if(Dc=t,Fc=t=Ou(t.current,null),Ic=Mc=e,Rc=0,zc=null,Pc=Lc=Bc=0,Uc=jc=null,null!==Ca){for(e=0;e<Ca.length;e++)if(null!==(r=(n=Ca[e]).interleaved)){n.interleaved=null;var i=r.next,a=n.pending;if(null!==a){var o=a.next;a.next=i,r.next=o}n.pending=r}Ca=null}return t}function pu(t,e){for(;;){var n=Fc;try{if(wa(),ho.current=os,vo){for(var r=go.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}vo=!1}if(po=0,yo=mo=go=null,bo=!1,xo=0,Ec.current=null,null===n||null===n.return){Rc=1,zc=e,Fc=null;break}t:{var o=t,s=n.return,c=n,u=e;if(e=Ic,c.flags|=32768,null!==u&&"object"===typeof u&&"function"===typeof u.then){var l=u,h=c,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=ys(s);if(null!==p){p.flags&=-257,vs(p,s,c,0,e),1&p.mode&&ms(o,l,e),u=l;var g=(e=p).updateQueue;if(null===g){var m=new Set;m.add(u),e.updateQueue=m}else g.add(u);break t}if(0===(1&e)){ms(o,l,e),mu();break t}u=Error(a(426))}else if(ia&&1&c.mode){var y=ys(s);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),vs(y,s,c,0,e),pa(ls(u,c));break t}}o=u=ls(u,c),4!==Rc&&(Rc=2),null===jc?jc=[o]:jc.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e,za(o,ps(0,u,e));break t;case 1:c=u;var v=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Yc||!Yc.has(b)))){o.flags|=65536,e&=-e,o.lanes|=e,za(o,gs(o,c,e));break t}}o=o.return}while(null!==o)}wu(n)}catch(x){e=x,Fc===n&&null!==n&&(Fc=n=n.return);continue}break}}function gu(){var t=Cc.current;return Cc.current=os,null===t?os:t}function mu(){0!==Rc&&3!==Rc&&2!==Rc||(Rc=4),null===Dc||0===(268435455&Bc)&&0===(268435455&Lc)||cu(Dc,Ic)}function yu(t,e){var n=Nc;Nc|=2;var r=gu();for(Dc===t&&Ic===e||(qc=null,fu(t,e));;)try{vu();break}catch(i){pu(t,i)}if(wa(),Nc=n,Cc.current=r,null!==Fc)throw Error(a(261));return Dc=null,Ic=0,Rc}function vu(){for(;null!==Fc;)xu(Fc)}function bu(){for(;null!==Fc&&!Kt();)xu(Fc)}function xu(t){var e=Sc(t.alternate,t,Mc);t.memoizedProps=t.pendingProps,null===e?wu(t):Fc=e,Ec.current=null}function wu(t){var e=t;do{var n=e.alternate;if(t=e.return,0===(32768&e.flags)){if(null!==(n=Xs(n,e,Mc)))return void(Fc=n)}else{if(null!==(n=Ks(n,e)))return n.flags&=32767,void(Fc=n);if(null===t)return Rc=6,void(Fc=null);t.flags|=32768,t.subtreeFlags=0,t.deletions=null}if(null!==(e=e.sibling))return void(Fc=e);Fc=e=t}while(null!==e);0===Rc&&(Rc=5)}function ku(t,e,n){var r=be,i=Tc.transition;try{Tc.transition=null,be=1,function(t,e,n,r){do{_u()}while(null!==Kc);if(0!==(6&Nc))throw Error(a(327));n=t.finishedWork;var i=t.finishedLanes;if(null===n)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(a(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-oe(n),a=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~a}}(t,o),t===Dc&&(Fc=Dc=null,Ic=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Xc||(Xc=!0,Du(ee,(function(){return _u(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Tc.transition,Tc.transition=null;var s=be;be=1;var c=Nc;Nc|=4,Ec.current=null,function(t,e){if(ti=qe,fr(t=dr())){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else t:{var r=(n=(n=t.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(w){n=null;break t}var s=0,c=-1,u=-1,l=0,h=0,d=t,f=null;e:for(;;){for(var p;d!==n||0!==i&&3!==d.nodeType||(c=s+i),d!==o||0!==r&&3!==d.nodeType||(u=s+r),3===d.nodeType&&(s+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===t)break e;if(f===n&&++l===i&&(c=s),f===o&&++h===r&&(u=s),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===c||-1===u?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(ei={focusedElem:t,selectionRange:n},qe=!1,Js=e;null!==Js;)if(t=(e=Js).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,Js=t;else for(;null!==Js;){e=Js;try{var g=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,y=g.memoizedState,v=e.stateNode,b=v.getSnapshotBeforeUpdate(e.elementType===e.type?m:ma(e.type,m),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=e.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(a(163))}}catch(w){Au(e,e.return,w)}if(null!==(t=e.sibling)){t.return=e.return,Js=t;break}Js=e.return}g=nc,nc=!1}(t,n),yc(n,t),pr(ei),qe=!!ti,ei=ti=null,t.current=n,bc(n,t,i),$t(),Nc=c,be=s,Tc.transition=o}else t.current=n;if(Xc&&(Xc=!1,Kc=t,$c=i),o=t.pendingLanes,0===o&&(Yc=null),function(t){if(ae&&"function"===typeof ae.onCommitFiberRoot)try{ae.onCommitFiberRoot(ie,t,void 0,128===(128&t.current.flags))}catch(e){}}(n.stateNode),iu(t,Zt()),null!==e)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Gc)throw Gc=!1,t=Hc,Hc=null,t;0!==(1&$c)&&0!==t.tag&&_u(),o=t.pendingLanes,0!==(1&o)?t===Qc?Zc++:(Zc=0,Qc=t):Zc=0,Wi()}(t,e,n,r)}finally{Tc.transition=i,be=r}return null}function _u(){if(null!==Kc){var t=xe($c),e=Tc.transition,n=be;try{if(Tc.transition=null,be=16>t?16:t,null===Kc)var r=!1;else{if(t=Kc,Kc=null,$c=0,0!==(6&Nc))throw Error(a(331));var i=Nc;for(Nc|=4,Js=t.current;null!==Js;){var o=Js,s=o.child;if(0!==(16&Js.flags)){var c=o.deletions;if(null!==c){for(var u=0;u<c.length;u++){var l=c[u];for(Js=l;null!==Js;){var h=Js;switch(h.tag){case 0:case 11:case 15:rc(8,h,o)}var d=h.child;if(null!==d)d.return=h,Js=d;else for(;null!==Js;){var f=(h=Js).sibling,p=h.return;if(oc(h),h===l){Js=null;break}if(null!==f){f.return=p,Js=f;break}Js=p}}}var g=o.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(null!==m)}}Js=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Js=s;else t:for(;null!==Js;){if(0!==(2048&(o=Js).flags))switch(o.tag){case 0:case 11:case 15:rc(9,o,o.return)}var v=o.sibling;if(null!==v){v.return=o.return,Js=v;break t}Js=o.return}}var b=t.current;for(Js=b;null!==Js;){var x=(s=Js).child;if(0!==(2064&s.subtreeFlags)&&null!==x)x.return=s,Js=x;else t:for(s=b;null!==Js;){if(0!==(2048&(c=Js).flags))try{switch(c.tag){case 0:case 11:case 15:ic(9,c)}}catch(k){Au(c,c.return,k)}if(c===s){Js=null;break t}var w=c.sibling;if(null!==w){w.return=c.return,Js=w;break t}Js=c.return}}if(Nc=i,Wi(),ae&&"function"===typeof ae.onPostCommitFiberRoot)try{ae.onPostCommitFiberRoot(ie,t)}catch(k){}r=!0}return r}finally{be=n,Tc.transition=e}}return!1}function Su(t,e,n){t=Oa(t,e=ps(0,e=ls(n,e),1),1),e=eu(),null!==t&&(ye(t,1,e),iu(t,e))}function Au(t,e,n){if(3===t.tag)Su(t,t,n);else for(;null!==e;){if(3===e.tag){Su(e,t,n);break}if(1===e.tag){var r=e.stateNode;if("function"===typeof e.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Yc||!Yc.has(r))){e=Oa(e,t=gs(e,t=ls(n,t),1),1),t=eu(),null!==e&&(ye(e,1,t),iu(e,t));break}}e=e.return}}function Cu(t,e,n){var r=t.pingCache;null!==r&&r.delete(e),e=eu(),t.pingedLanes|=t.suspendedLanes&n,Dc===t&&(Ic&n)===n&&(4===Rc||3===Rc&&(130023424&Ic)===Ic&&500>Zt()-Wc?fu(t,0):Pc|=n),iu(t,e)}function Eu(t,e){0===e&&(0===(1&t.mode)?e=1:(e=le,0===(130023424&(le<<=1))&&(le=4194304)));var n=eu();null!==(t=Na(t,e))&&(ye(t,e,n),iu(t,n))}function Tu(t){var e=t.memoizedState,n=0;null!==e&&(n=e.retryLane),Eu(t,n)}function Nu(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(e),Eu(t,n)}function Du(t,e){return Yt(t,e)}function Fu(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Iu(t,e,n,r){return new Fu(t,e,n,r)}function Mu(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Ou(t,e){var n=t.alternate;return null===n?((n=Iu(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&t.flags,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ru(t,e,n,r,i,o){var s=2;if(r=t,"function"===typeof t)Mu(t)&&(s=1);else if("string"===typeof t)s=5;else t:switch(t){case _:return zu(n.children,i,o,e);case S:s=8,i|=8;break;case A:return(t=Iu(12,n,e,2|i)).elementType=A,t.lanes=o,t;case N:return(t=Iu(13,n,e,i)).elementType=N,t.lanes=o,t;case D:return(t=Iu(19,n,e,i)).elementType=D,t.lanes=o,t;case M:return Bu(n,i,o,e);default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case C:s=10;break t;case E:s=9;break t;case T:s=11;break t;case F:s=14;break t;case I:s=16,r=null;break t}throw Error(a(130,null==t?t:typeof t,""))}return(e=Iu(s,n,e,i)).elementType=t,e.type=r,e.lanes=o,e}function zu(t,e,n,r){return(t=Iu(7,t,r,e)).lanes=n,t}function Bu(t,e,n,r){return(t=Iu(22,t,r,e)).elementType=M,t.lanes=n,t.stateNode={isHidden:!1},t}function Lu(t,e,n){return(t=Iu(6,t,null,e)).lanes=n,t}function Pu(t,e,n){return(e=Iu(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function ju(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=me(0),this.expirationTimes=me(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=me(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Uu(t,e,n,r,i,a,o,s,c){return t=new ju(t,e,n,s,c),1===e?(e=1,!0===a&&(e|=8)):e=0,a=Iu(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fa(a),t}function Wu(t){if(!t)return Ei;t:{if(Wt(t=t._reactInternals)!==t||1!==t.tag)throw Error(a(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(Ii(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(null!==e);throw Error(a(171))}if(1===t.tag){var n=t.type;if(Ii(n))return Ri(t,n,e)}return e}function Vu(t,e,n,r,i,a,o,s,c){return(t=Uu(n,r,!0,t,0,a,0,s,c)).context=Wu(null),n=t.current,(a=Ma(r=eu(),i=nu(n))).callback=void 0!==e&&null!==e?e:null,Oa(n,a,i),t.current.lanes=i,ye(t,i,r),iu(t,r),t}function qu(t,e,n,r){var i=e.current,a=eu(),o=nu(i);return n=Wu(n),null===e.context?e.context=n:e.pendingContext=n,(e=Ma(a,o)).payload={element:t},null!==(r=void 0===r?null:r)&&(e.callback=r),null!==(t=Oa(i,e,o))&&(ru(t,i,o,a),Ra(t,i,o)),o}function Gu(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function Hu(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function Yu(t,e){Hu(t,e),(t=t.alternate)&&Hu(t,e)}Sc=function(t,e,n){if(null!==t)if(t.memoizedProps!==e.pendingProps||Ni.current)xs=!0;else{if(0===(t.lanes&n)&&0===(128&e.flags))return xs=!1,function(t,e,n){switch(e.tag){case 3:Ds(e),fa();break;case 5:ao(e);break;case 1:Ii(e.type)&&zi(e);break;case 4:ro(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ci(ya,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=e.memoizedState))return null!==r.dehydrated?(Ci(so,1&so.current),e.flags|=128,null):0!==(n&e.child.childLanes)?Ls(t,e,n):(Ci(so,1&so.current),null!==(t=Gs(t,e,n))?t.sibling:null);Ci(so,1&so.current);break;case 19:if(r=0!==(n&e.childLanes),0!==(128&t.flags)){if(r)return Vs(t,e,n);e.flags|=128}if(null!==(i=e.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ci(so,so.current),r)break;return null;case 22:case 23:return e.lanes=0,As(t,e,n)}return Gs(t,e,n)}(t,e,n);xs=0!==(131072&t.flags)}else xs=!1,ia&&0!==(1048576&e.flags)&&Ji(e,Hi,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;qs(t,e),t=e.pendingProps;var i=Fi(e,Ti.current);Sa(e,n),i=So(null,e,r,t,i,n);var o=Ao();return e.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ii(r)?(o=!0,zi(e)):o=!1,e.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Fa(e),i.updater=Ua,e.stateNode=i,i._reactInternals=e,Ga(e,r,t,n),e=Ns(null,e,r,!0,o,n)):(e.tag=0,ia&&o&&ta(e),ws(null,e,i,n),e=e.child),e;case 16:r=e.elementType;t:{switch(qs(t,e),t=e.pendingProps,r=(i=r._init)(r._payload),e.type=r,i=e.tag=function(t){if("function"===typeof t)return Mu(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===T)return 11;if(t===F)return 14}return 2}(r),t=ma(r,t),i){case 0:e=Es(null,e,r,t,n);break t;case 1:e=Ts(null,e,r,t,n);break t;case 11:e=ks(null,e,r,t,n);break t;case 14:e=_s(null,e,r,ma(r.type,t),n);break t}throw Error(a(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,Es(t,e,r,i=e.elementType===r?i:ma(r,i),n);case 1:return r=e.type,i=e.pendingProps,Ts(t,e,r,i=e.elementType===r?i:ma(r,i),n);case 3:t:{if(Ds(e),null===t)throw Error(a(387));r=e.pendingProps,i=(o=e.memoizedState).element,Ia(t,e),Ba(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,256&e.flags){e=Fs(t,e,r,n,i=ls(Error(a(423)),e));break t}if(r!==i){e=Fs(t,e,r,n,i=ls(Error(a(424)),e));break t}for(ra=ui(e.stateNode.containerInfo.firstChild),na=e,ia=!0,aa=null,n=Za(e,null,r,n),e.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fa(),r===i){e=Gs(t,e,n);break t}ws(t,e,r,n)}e=e.child}return e;case 5:return ao(e),null===t&&ua(e),r=e.type,i=e.pendingProps,o=null!==t?t.memoizedProps:null,s=i.children,ni(r,i)?s=null:null!==o&&ni(r,o)&&(e.flags|=32),Cs(t,e),ws(t,e,s,n),e.child;case 6:return null===t&&ua(e),null;case 13:return Ls(t,e,n);case 4:return ro(e,e.stateNode.containerInfo),r=e.pendingProps,null===t?e.child=$a(e,null,r,n):ws(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,ks(t,e,r,i=e.elementType===r?i:ma(r,i),n);case 7:return ws(t,e,e.pendingProps,n),e.child;case 8:case 12:return ws(t,e,e.pendingProps.children,n),e.child;case 10:t:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,Ci(ya,r._currentValue),r._currentValue=s,null!==o)if(sr(o.value,s)){if(o.children===i.children&&!Ni.current){e=Gs(t,e,n);break t}}else for(null!==(o=e.child)&&(o.return=e);null!==o;){var c=o.dependencies;if(null!==c){s=o.child;for(var u=c.firstContext;null!==u;){if(u.context===r){if(1===o.tag){(u=Ma(-1,n&-n)).tag=2;var l=o.updateQueue;if(null!==l){var h=(l=l.shared).pending;null===h?u.next=u:(u.next=h.next,h.next=u),l.pending=u}}o.lanes|=n,null!==(u=o.alternate)&&(u.lanes|=n),_a(o.return,n,e),c.lanes|=n;break}u=u.next}}else if(10===o.tag)s=o.type===e.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(a(341));s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),_a(s,n,e),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===e){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}ws(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Sa(e,n),r=r(i=Aa(i)),e.flags|=1,ws(t,e,r,n),e.child;case 14:return i=ma(r=e.type,e.pendingProps),_s(t,e,r,i=ma(r.type,i),n);case 15:return Ss(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ma(r,i),qs(t,e),e.tag=1,Ii(r)?(t=!0,zi(e)):t=!1,Sa(e,n),Va(e,r,i),Ga(e,r,i,n),Ns(null,e,r,!0,t,n);case 19:return Vs(t,e,n);case 22:return As(t,e,n)}throw Error(a(156,e.tag))};var Xu="function"===typeof reportError?reportError:function(t){console.error(t)};function Ku(t){this._internalRoot=t}function $u(t){this._internalRoot=t}function Zu(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)}function Qu(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function Ju(){}function tl(t,e,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if("function"===typeof i){var s=i;i=function(){var t=Gu(o);s.call(t)}}qu(e,o,t,i)}else o=function(t,e,n,r,i){if(i){if("function"===typeof r){var a=r;r=function(){var t=Gu(o);a.call(t)}}var o=Vu(e,r,t,0,null,!1,0,"",Ju);return t._reactRootContainer=o,t[pi]=o.current,Wr(8===t.nodeType?t.parentNode:t),hu(),o}for(;i=t.lastChild;)t.removeChild(i);if("function"===typeof r){var s=r;r=function(){var t=Gu(c);s.call(t)}}var c=Uu(t,0,!1,null,0,!1,0,"",Ju);return t._reactRootContainer=c,t[pi]=c.current,Wr(8===t.nodeType?t.parentNode:t),hu((function(){qu(e,c,n,r)})),c}(n,e,t,i,r);return Gu(o)}$u.prototype.render=Ku.prototype.render=function(t){var e=this._internalRoot;if(null===e)throw Error(a(409));qu(t,e,null,null)},$u.prototype.unmount=Ku.prototype.unmount=function(){var t=this._internalRoot;if(null!==t){this._internalRoot=null;var e=t.containerInfo;hu((function(){qu(null,t,null,null)})),e[pi]=null}},$u.prototype.unstable_scheduleHydration=function(t){if(t){var e=Se();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Me.length&&0!==e&&e<Me[n].priority;n++);Me.splice(n,0,t),0===n&&Be(t)}},we=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=he(e.pendingLanes);0!==n&&(ve(e,1|n),iu(e,Zt()),0===(6&Nc)&&(Vc=Zt()+500,Wi()))}break;case 13:hu((function(){var e=Na(t,1);if(null!==e){var n=eu();ru(e,t,1,n)}})),Yu(t,1)}},ke=function(t){if(13===t.tag){var e=Na(t,134217728);if(null!==e)ru(e,t,134217728,eu());Yu(t,134217728)}},_e=function(t){if(13===t.tag){var e=nu(t),n=Na(t,e);if(null!==n)ru(n,t,e,eu());Yu(t,e)}},Se=function(){return be},Ae=function(t,e){var n=be;try{return be=t,e()}finally{be=n}},kt=function(t,e,n){switch(e){case"input":if(Q(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=wi(r);if(!i)throw Error(a(90));Y(r),Q(r,i)}}}break;case"textarea":at(t,n);break;case"select":null!=(e=n.value)&&nt(t,!!n.multiple,e,!1)}},Tt=lu,Nt=hu;var el={usingClientEntryPoint:!1,Events:[bi,xi,wi,Ct,Et,lu]},nl={findFiberByHostInstance:vi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rl={bundleType:nl.bundleType,version:nl.version,rendererPackageName:nl.rendererPackageName,rendererConfig:nl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=Gt(t))?null:t.stateNode},findFiberByHostInstance:nl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var il=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!il.isDisabled&&il.supportsFiber)try{ie=il.inject(rl),ae=il}catch(lt){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=el,e.createPortal=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Zu(e))throw Error(a(200));return function(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==r?null:""+r,children:t,containerInfo:e,implementation:n}}(t,e,null,n)},e.createRoot=function(t,e){if(!Zu(t))throw Error(a(299));var n=!1,r="",i=Xu;return null!==e&&void 0!==e&&(!0===e.unstable_strictMode&&(n=!0),void 0!==e.identifierPrefix&&(r=e.identifierPrefix),void 0!==e.onRecoverableError&&(i=e.onRecoverableError)),e=Uu(t,1,!1,null,0,n,0,r,i),t[pi]=e.current,Wr(8===t.nodeType?t.parentNode:t),new Ku(e)},e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(a(188));throw t=Object.keys(t).join(","),Error(a(268,t))}return t=null===(t=Gt(e))?null:t.stateNode},e.flushSync=function(t){return hu(t)},e.hydrate=function(t,e,n){if(!Qu(e))throw Error(a(200));return tl(null,t,e,!0,n)},e.hydrateRoot=function(t,e,n){if(!Zu(t))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",s=Xu;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),e=Vu(e,null,t,1,null!=n?n:null,i,0,o,s),t[pi]=e.current,Wr(t),r)for(t=0;t<r.length;t++)i=(i=(n=r[t])._getVersion)(n._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new $u(e)},e.render=function(t,e,n){if(!Qu(e))throw Error(a(200));return tl(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!Qu(t))throw Error(a(40));return!!t._reactRootContainer&&(hu((function(){tl(null,null,t,!1,(function(){t._reactRootContainer=null,t[pi]=null}))})),!0)},e.unstable_batchedUpdates=lu,e.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Qu(n))throw Error(a(200));if(null==t||void 0===t._reactInternals)throw Error(a(38));return tl(t,e,n,!1,r)},e.version="18.2.0-next-9e3b772b8-20220608"},1352:(t,e,n)=>{"use strict";var r=n(17119);e.createRoot=r.createRoot,e.hydrateRoot=r.hydrateRoot},17119:(t,e,n)=>{"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=n(38345)},32654:(t,e,n)=>{"use strict";var r=n(9950),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function u(t,e,n){var r,a={},u=null,l=null;for(r in void 0!==n&&(u=""+n),void 0!==e.key&&(u=""+e.key),void 0!==e.ref&&(l=e.ref),e)o.call(e,r)&&!c.hasOwnProperty(r)&&(a[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps)void 0===a[r]&&(a[r]=e[r]);return{$$typeof:i,type:t,key:u,ref:l,props:a,_owner:s.current}}e.jsx=u,e.jsxs=u},32049:(t,e)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function y(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||p}function v(){}function b(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||p}y.prototype.isReactComponent={},y.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},y.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},v.prototype=y.prototype;var x=b.prototype=new v;x.constructor=b,g(x,y.prototype),x.isPureReactComponent=!0;var w=Array.isArray,k=Object.prototype.hasOwnProperty,_={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function A(t,e,r){var i,a={},o=null,s=null;if(null!=e)for(i in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(o=""+e.key),e)k.call(e,i)&&!S.hasOwnProperty(i)&&(a[i]=e[i]);var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){for(var u=Array(c),l=0;l<c;l++)u[l]=arguments[l+2];a.children=u}if(t&&t.defaultProps)for(i in c=t.defaultProps)void 0===a[i]&&(a[i]=c[i]);return{$$typeof:n,type:t,key:o,ref:s,props:a,_owner:_.current}}function C(t){return"object"===typeof t&&null!==t&&t.$$typeof===n}var E=/\/+/g;function T(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function N(t,e,i,a,o){var s=typeof t;"undefined"!==s&&"boolean"!==s||(t=null);var c=!1;if(null===t)c=!0;else switch(s){case"string":case"number":c=!0;break;case"object":switch(t.$$typeof){case n:case r:c=!0}}if(c)return o=o(c=t),t=""===a?"."+T(c,0):a,w(o)?(i="",null!=t&&(i=t.replace(E,"$&/")+"/"),N(o,e,i,"",(function(t){return t}))):null!=o&&(C(o)&&(o=function(t,e){return{$$typeof:n,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(o,i+(!o.key||c&&c.key===o.key?"":(""+o.key).replace(E,"$&/")+"/")+t)),e.push(o)),1;if(c=0,a=""===a?".":a+":",w(t))for(var u=0;u<t.length;u++){var l=a+T(s=t[u],u);c+=N(s,e,i,l,o)}else if(l=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=f&&t[f]||t["@@iterator"])?t:null}(t),"function"===typeof l)for(t=l.call(t),u=0;!(s=t.next()).done;)c+=N(s=s.value,e,i,l=a+T(s,u++),o);else if("object"===s)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return c}function D(t,e,n){if(null==t)return t;var r=[],i=0;return N(t,r,"","",(function(t){return e.call(n,t,i++)})),r}function F(t){if(-1===t._status){var e=t._result;(e=e()).then((function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)}),(function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)})),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var I={current:null},M={transition:null},O={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:M,ReactCurrentOwner:_};e.Children={map:D,forEach:function(t,e,n){D(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return D(t,(function(){e++})),e},toArray:function(t){return D(t,(function(t){return t}))||[]},only:function(t){if(!C(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=y,e.Fragment=i,e.Profiler=o,e.PureComponent=b,e.StrictMode=a,e.Suspense=l,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,e.cloneElement=function(t,e,r){if(null===t||void 0===t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=g({},t.props),a=t.key,o=t.ref,s=t._owner;if(null!=e){if(void 0!==e.ref&&(o=e.ref,s=_.current),void 0!==e.key&&(a=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)k.call(e,u)&&!S.hasOwnProperty(u)&&(i[u]=void 0===e[u]&&void 0!==c?c[u]:e[u])}var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){c=Array(u);for(var l=0;l<u;l++)c[l]=arguments[l+2];i.children=c}return{$$typeof:n,type:t.type,key:a,ref:o,props:i,_owner:s}},e.createContext=function(t){return(t={$$typeof:c,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:t},t.Consumer=t},e.createElement=A,e.createFactory=function(t){var e=A.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:u,render:t}},e.isValidElement=C,e.lazy=function(t){return{$$typeof:d,_payload:{_status:-1,_result:t},_init:F}},e.memo=function(t,e){return{$$typeof:h,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=M.transition;M.transition={};try{t()}finally{M.transition=e}},e.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},e.useCallback=function(t,e){return I.current.useCallback(t,e)},e.useContext=function(t){return I.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return I.current.useDeferredValue(t)},e.useEffect=function(t,e){return I.current.useEffect(t,e)},e.useId=function(){return I.current.useId()},e.useImperativeHandle=function(t,e,n){return I.current.useImperativeHandle(t,e,n)},e.useInsertionEffect=function(t,e){return I.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return I.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return I.current.useMemo(t,e)},e.useReducer=function(t,e,n){return I.current.useReducer(t,e,n)},e.useRef=function(t){return I.current.useRef(t)},e.useState=function(t){return I.current.useState(t)},e.useSyncExternalStore=function(t,e,n){return I.current.useSyncExternalStore(t,e,n)},e.useTransition=function(){return I.current.useTransition()},e.version="18.2.0"},9950:(t,e,n)=>{"use strict";t.exports=n(32049)},44414:(t,e,n)=>{"use strict";t.exports=n(32654)},31761:(t,e)=>{"use strict";function n(t,e){var n=t.length;t.push(e);t:for(;0<n;){var r=n-1>>>1,i=t[r];if(!(0<a(i,e)))break t;t[r]=e,t[n]=i,n=r}}function r(t){return 0===t.length?null:t[0]}function i(t){if(0===t.length)return null;var e=t[0],n=t.pop();if(n!==e){t[0]=n;t:for(var r=0,i=t.length,o=i>>>1;r<o;){var s=2*(r+1)-1,c=t[s],u=s+1,l=t[u];if(0>a(c,n))u<i&&0>a(l,c)?(t[r]=l,t[u]=n,r=u):(t[r]=c,t[s]=n,r=s);else{if(!(u<i&&0>a(l,n)))break t;t[r]=l,t[u]=n,r=u}}}return e}function a(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,c=s.now();e.unstable_now=function(){return s.now()-c}}var u=[],l=[],h=1,d=null,f=3,p=!1,g=!1,m=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(t){for(var e=r(l);null!==e;){if(null===e.callback)i(l);else{if(!(e.startTime<=t))break;i(l),e.sortIndex=e.expirationTime,n(u,e)}e=r(l)}}function w(t){if(m=!1,x(t),!g)if(null!==r(u))g=!0,M(k);else{var e=r(l);null!==e&&O(w,e.startTime-t)}}function k(t,n){g=!1,m&&(m=!1,v(C),C=-1),p=!0;var a=f;try{for(x(n),d=r(u);null!==d&&(!(d.expirationTime>n)||t&&!N());){var o=d.callback;if("function"===typeof o){d.callback=null,f=d.priorityLevel;var s=o(d.expirationTime<=n);n=e.unstable_now(),"function"===typeof s?d.callback=s:d===r(u)&&i(u),x(n)}else i(u);d=r(u)}if(null!==d)var c=!0;else{var h=r(l);null!==h&&O(w,h.startTime-n),c=!1}return c}finally{d=null,f=a,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,S=!1,A=null,C=-1,E=5,T=-1;function N(){return!(e.unstable_now()-T<E)}function D(){if(null!==A){var t=e.unstable_now();T=t;var n=!0;try{n=A(!0,t)}finally{n?_():(S=!1,A=null)}}else S=!1}if("function"===typeof b)_=function(){b(D)};else if("undefined"!==typeof MessageChannel){var F=new MessageChannel,I=F.port2;F.port1.onmessage=D,_=function(){I.postMessage(null)}}else _=function(){y(D,0)};function M(t){A=t,S||(S=!0,_())}function O(t,n){C=y((function(){t(e.unstable_now())}),n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){g||p||(g=!0,M(k))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(t){switch(f){case 1:case 2:case 3:var e=3;break;default:e=f}var n=f;f=e;try{return t()}finally{f=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=f;f=t;try{return e()}finally{f=n}},e.unstable_scheduleCallback=function(t,i,a){var o=e.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?o+a:o:a=o,t){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return t={id:h++,callback:i,priorityLevel:t,startTime:a,expirationTime:s=a+s,sortIndex:-1},a>o?(t.sortIndex=a,n(l,t),null===r(u)&&t===r(l)&&(m?(v(C),C=-1):m=!0,O(w,a-o))):(t.sortIndex=s,n(u,t),g||p||(g=!0,M(k))),t},e.unstable_shouldYield=N,e.unstable_wrapCallback=function(t){var e=f;return function(){var n=f;f=e;try{return t.apply(this,arguments)}finally{f=n}}}},75340:(t,e,n)=>{"use strict";t.exports=n(31761)},11053:(t,e,n)=>{var r=n(52658),i=n(93271),a=n(50545),o=n(84281),s=n(94647),c=n(82855),u=n(2583);u.alea=r,u.xor128=i,u.xorwow=a,u.xorshift7=o,u.xor4096=s,u.tychei=c,t.exports=u},52658:function(t,e,n){var r;!function(t,i,a){function o(t){var e=this,n=function(){var t=4022871197,e=function(e){e=String(e);for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)};return e}();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function s(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function c(t,e){var n=new o(t),r=e&&e.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=c:n.amdD&&n.amdO?void 0===(r=function(){return c}.call(e,n,e,i))||(i.exports=r):this.alea=c}(0,t=n.nmd(t),n.amdD)},82855:function(t,e,n){var r;!function(t,i,a){function o(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function s(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function c(t,e){var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=c:n.amdD&&n.amdO?void 0===(r=function(){return c}.call(e,n,e,i))||(i.exports=r):this.tychei=c}(0,t=n.nmd(t),n.amdD)},93271:function(t,e,n){var r;!function(t,i,a){function o(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function c(t,e){var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=c:n.amdD&&n.amdO?void 0===(r=function(){return c}.call(e,n,e,i))||(i.exports=r):this.xor128=c}(0,t=n.nmd(t),n.amdD)},94647:function(t,e,n){var r;!function(t,i,a){function o(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,a=e.i;return e.w=r=r+1640531527|0,n=i[a+34&127],t=i[a=a+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[a]=n^t,e.i=a,n+(r^r>>>16)|0},function(t,e){var n,r,i,a,o,s=[],c=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,c=Math.max(c,e.length)),i=0,a=-32;a<c;++a)e&&(r^=e.charCodeAt((a+32)%e.length)),0===a&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(o=o+1640531527|0,i=0==(n=s[127&a]^=r+o)?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,a=512;a>0;--a)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;t.w=o,t.X=s,t.i=i}(e,t)}function s(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function c(t,e){null==t&&(t=+new Date);var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&(r.X&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=c:n.amdD&&n.amdO?void 0===(r=function(){return c}.call(e,n,e,i))||(i.exports=r):this.xor4096=c}(0,t=n.nmd(t),n.amdD)},84281:function(t,e,n){var r;!function(t,i,a){function o(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function s(t,e){return e.x=t.x.slice(),e.i=t.i,e}function c(t,e){null==t&&(t=+new Date);var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&(r.x&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=c:n.amdD&&n.amdO?void 0===(r=function(){return c}.call(e,n,e,i))||(i.exports=r):this.xorshift7=c}(0,t=n.nmd(t),n.amdD)},50545:function(t,e,n){var r;!function(t,i,a){function o(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function c(t,e){var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=c:n.amdD&&n.amdO?void 0===(r=function(){return c}.call(e,n,e,i))||(i.exports=r):this.xorwow=c}(0,t=n.nmd(t),n.amdD)},2583:function(t,e,n){var r;!function(i,a,o){var s,c=256,u=o.pow(c,6),l=o.pow(2,52),h=2*l,d=c-1;function f(t,e,n){var r=[],d=y(m((e=1==e?{entropy:!0}:e||{}).entropy?[t,v(a)]:null==t?function(){try{var t;return s&&(t=s.randomBytes)?t=t(c):(t=new Uint8Array(c),(i.crypto||i.msCrypto).getRandomValues(t)),v(t)}catch(r){var e=i.navigator,n=e&&e.plugins;return[+new Date,i,n,i.screen,v(a)]}}():t,3),r),f=new p(r),b=function(){for(var t=f.g(6),e=u,n=0;t<l;)t=(t+n)*c,e*=c,n=f.g(1);for(;t>=h;)t/=2,e/=2,n>>>=1;return(t+n)/e};return b.int32=function(){return 0|f.g(4)},b.quick=function(){return f.g(4)/4294967296},b.double=b,y(v(f.S),a),(e.pass||n||function(t,e,n,r){return r&&(r.S&&g(r,f),t.state=function(){return g(f,{})}),n?(o.random=t,e):t})(b,d,"global"in e?e.global:this==o,e.state)}function p(t){var e,n=t.length,r=this,i=0,a=r.i=r.j=0,o=r.S=[];for(n||(t=[n++]);i<c;)o[i]=i++;for(i=0;i<c;i++)o[i]=o[a=d&a+t[i%n]+(e=o[i])],o[a]=e;(r.g=function(t){for(var e,n=0,i=r.i,a=r.j,o=r.S;t--;)e=o[i=d&i+1],n=n*c+o[d&(o[i]=o[a=d&a+e])+(o[a]=e)];return r.i=i,r.j=a,n})(c)}function g(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function m(t,e){var n,r=[],i=typeof t;if(e&&"object"==i)for(n in t)try{r.push(m(t[n],e-1))}catch(a){}return r.length?r:"string"==i?t:t+"\0"}function y(t,e){for(var n,r=t+"",i=0;i<r.length;)e[d&i]=d&(n^=19*e[d&i])+r.charCodeAt(i++);return v(e)}function v(t){return String.fromCharCode.apply(0,t)}if(y(o.random(),a),t.exports){t.exports=f;try{s=n(41234)}catch(b){}}else void 0===(r=function(){return f}.call(e,n,e,t))||(t.exports=r)}("undefined"!==typeof self?self:this,[],Math)},66836:(t,e,n)=>{"use strict";n.r(e),n.d(e,{DEFAULT_ACTIONS:()=>yVt,default:()=>NVt,guessMode:()=>AVt,vega:()=>pVt,vegaLite:()=>gVt});var r={};n.r(r),n.d(r,{JsonPatchError:()=>O,_areEquals:()=>q,applyOperation:()=>P,applyPatch:()=>j,applyReducer:()=>U,deepClone:()=>R,getValueByPointer:()=>L,validate:()=>V,validator:()=>W});var i={};n.r(i),n.d(i,{compare:()=>Q,generate:()=>$,observe:()=>K,unobserve:()=>X});var a={};n.r(a),n.d(a,{aggregate:()=>Ju,bin:()=>tl,collect:()=>nl,compare:()=>rl,countpattern:()=>al,cross:()=>ol,density:()=>ll,dotbin:()=>gl,expression:()=>ml,extent:()=>vl,facet:()=>xl,field:()=>wl,filter:()=>_l,flatten:()=>Sl,fold:()=>Al,formula:()=>Cl,generate:()=>El,impute:()=>Dl,joinaggregate:()=>Fl,kde:()=>Il,key:()=>Ml,load:()=>Rl,lookup:()=>Bl,multiextent:()=>Ll,multivalues:()=>jl,params:()=>Wl,pivot:()=>Vl,prefacet:()=>ql,project:()=>Gl,proxy:()=>Hl,quantile:()=>Yl,relay:()=>Xl,sample:()=>Kl,sequence:()=>$l,sieve:()=>Zl,subflow:()=>bl,timeunit:()=>Ql,tupleindex:()=>th,values:()=>eh,window:()=>oh});var o={};n.r(o),n.d(o,{interpolate:()=>Gm,interpolateArray:()=>Bm,interpolateBasis:()=>Sm,interpolateBasisClosed:()=>Am,interpolateCubehelix:()=>Vy,interpolateCubehelixLong:()=>qy,interpolateDate:()=>Pm,interpolateDiscrete:()=>Ym,interpolateHcl:()=>Dy,interpolateHclLong:()=>Fy,interpolateHsl:()=>oy,interpolateHslLong:()=>sy,interpolateHue:()=>Xm,interpolateLab:()=>Ty,interpolateNumber:()=>jm,interpolateNumberArray:()=>Rm,interpolateObject:()=>Um,interpolateRgb:()=>Fm,interpolateRgbBasis:()=>Mm,interpolateRgbBasisClosed:()=>Om,interpolateRound:()=>Km,interpolateString:()=>qm,interpolateTransformCss:()=>ey,interpolateTransformSvg:()=>ny,interpolateZoom:()=>iy,piecewise:()=>Hm,quantize:()=>Gy});var s={};n.r(s),n.d(s,{bound:()=>CS,identifier:()=>NS,mark:()=>DS,overlap:()=>FS,render:()=>LS,viewlayout:()=>oA});var c={};n.r(c),n.d(c,{axisticks:()=>lC,datajoin:()=>hC,encode:()=>fC,legendentries:()=>pC,linkpath:()=>bC,pie:()=>SC,scale:()=>TC,sortitems:()=>IC,stack:()=>BC});var u={};n.r(u),n.d(u,{contour:()=>fI,geojson:()=>mI,geopath:()=>yI,geopoint:()=>vI,geoshape:()=>bI,graticule:()=>xI,heatmap:()=>wI,isocontour:()=>rI,kde2d:()=>lI,projection:()=>_I});var l={};n.r(l),n.d(l,{force:()=>kM});var h={};n.r(h),n.d(h,{nest:()=>kO,pack:()=>TO,partition:()=>DO,stratify:()=>FO,tree:()=>OO,treelinks:()=>RO,treemap:()=>LO});var d={};n.r(d),n.d(d,{label:()=>uR});var f={};n.r(f),n.d(f,{loess:()=>hR,regression:()=>fR});var p={};n.r(p),n.d(p,{voronoi:()=>zR});var g={};n.r(g),n.d(g,{wordcloud:()=>QR});var m={};n.r(m),n.d(m,{crossfilter:()=>uz,resolvefilter:()=>lz});var y={};n.r(y),n.d(y,{interpolate:()=>Xq,interpolateArray:()=>jq,interpolateBasis:()=>Eq,interpolateBasisClosed:()=>Tq,interpolateCubehelix:()=>HG,interpolateCubehelixLong:()=>YG,interpolateDate:()=>Wq,interpolateDiscrete:()=>$q,interpolateHcl:()=>MG,interpolateHclLong:()=>OG,interpolateHsl:()=>uG,interpolateHslLong:()=>lG,interpolateHue:()=>Zq,interpolateLab:()=>FG,interpolateNumber:()=>Vq,interpolateNumberArray:()=>Lq,interpolateObject:()=>qq,interpolateRgb:()=>Oq,interpolateRgbBasis:()=>zq,interpolateRgbBasisClosed:()=>Bq,interpolateRound:()=>Qq,interpolateString:()=>Yq,interpolateTransformCss:()=>iG,interpolateTransformSvg:()=>aG,interpolateZoom:()=>sG,piecewise:()=>Kq,quantize:()=>XG});var v={};n.r(v),n.d(v,{interpolate:()=>uC,interpolateArray:()=>eC,interpolateBasis:()=>WA,interpolateBasisClosed:()=>VA,interpolateCubehelix:()=>j2,interpolateCubehelixLong:()=>U2,interpolateDate:()=>rC,interpolateDiscrete:()=>G1,interpolateHcl:()=>E2,interpolateHclLong:()=>T2,interpolateHsl:()=>r2,interpolateHslLong:()=>i2,interpolateHue:()=>H1,interpolateLab:()=>A2,interpolateNumber:()=>iC,interpolateNumberArray:()=>JA,interpolateObject:()=>aC,interpolateRgb:()=>KA,interpolateRgbBasis:()=>ZA,interpolateRgbBasisClosed:()=>QA,interpolateRound:()=>cA,interpolateString:()=>cC,interpolateTransformCss:()=>Q1,interpolateTransformSvg:()=>J1,interpolateZoom:()=>e2,piecewise:()=>W1,quantize:()=>W2});var b={};n.r(b),n.d(b,{interpolate:()=>Vut,interpolateArray:()=>Rut,interpolateBasis:()=>kut,interpolateBasisClosed:()=>_ut,interpolateCubehelix:()=>Ult,interpolateCubehelixLong:()=>Wlt,interpolateDate:()=>But,interpolateDiscrete:()=>Gut,interpolateHcl:()=>Tlt,interpolateHclLong:()=>Nlt,interpolateHsl:()=>ilt,interpolateHslLong:()=>alt,interpolateHue:()=>Hut,interpolateLab:()=>Clt,interpolateNumber:()=>Lut,interpolateNumberArray:()=>Mut,interpolateObject:()=>Put,interpolateRgb:()=>Nut,interpolateRgbBasis:()=>Fut,interpolateRgbBasisClosed:()=>Iut,interpolateRound:()=>Yut,interpolateString:()=>Wut,interpolateTransformCss:()=>Jut,interpolateTransformSvg:()=>tlt,interpolateZoom:()=>nlt,piecewise:()=>qut,quantize:()=>Vlt});var x={};n.r(x),n.d(x,{Bounds:()=>GY,CanvasHandler:()=>k$,CanvasRenderer:()=>E$,DATE:()=>wL,DAY:()=>kL,DAYOFYEAR:()=>_L,Dataflow:()=>Dc,Debug:()=>kt,Error:()=>bt,EventStream:()=>gc,Gradient:()=>QH,GroupItem:()=>YY,HOURS:()=>SL,Handler:()=>i$,Info:()=>wt,Item:()=>HY,MILLISECONDS:()=>EL,MINUTES:()=>AL,MONTH:()=>bL,Marks:()=>WK,MultiPulse:()=>Ac,None:()=>vt,Operator:()=>dc,Parameters:()=>uc,Pulse:()=>wc,QUARTER:()=>vL,RenderType:()=>yZ,Renderer:()=>o$,ResourceLoader:()=>XY,SECONDS:()=>CL,SVGHandler:()=>N$,SVGRenderer:()=>tZ,SVGStringRenderer:()=>pZ,Scenegraph:()=>$K,TIME_UNITS:()=>TL,Transform:()=>Ic,View:()=>crt,WEEK:()=>xL,Warn:()=>xt,YEAR:()=>yL,accessor:()=>nt,accessorFields:()=>it,accessorName:()=>rt,array:()=>Kt,ascending:()=>te,bandwidthNRD:()=>pz,bin:()=>gz,bootstrapCI:()=>vz,boundClip:()=>AZ,boundContext:()=>gX,boundItem:()=>VK,boundMark:()=>GK,boundStroke:()=>ZY,changeset:()=>sc,clampRange:()=>$t,codegenExpression:()=>tAt,compare:()=>Jt,constant:()=>ie,cumulativeLogNormal:()=>Mz,cumulativeNormal:()=>Ez,cumulativeUniform:()=>Pz,dayofyear:()=>RL,debounce:()=>ae,defaultLocale:()=>bot,definition:()=>Oc,densityLogNormal:()=>Iz,densityNormal:()=>Cz,densityUniform:()=>Lz,domChild:()=>t$,domClear:()=>e$,domCreate:()=>QK,domFind:()=>JK,dotbin:()=>bz,error:()=>ct,expressionFunction:()=>xvt,extend:()=>oe,extent:()=>se,extentIndex:()=>ce,falsy:()=>mt,fastmap:()=>de,field:()=>lt,flush:()=>fe,font:()=>OK,fontFamily:()=>MK,fontSize:()=>TK,format:()=>nU,formatLocale:()=>hot,formats:()=>rU,hasOwnProperty:()=>le,id:()=>ht,identity:()=>dt,inferType:()=>Kj,inferTypes:()=>$j,ingest:()=>ec,inherits:()=>pe,inrange:()=>ge,interpolate:()=>D3,interpolateColors:()=>T3,interpolateRange:()=>E3,intersect:()=>xZ,intersectBoxLine:()=>CX,intersectPath:()=>kX,intersectPoint:()=>_X,intersectRule:()=>AX,isArray:()=>St,isBoolean:()=>me,isDate:()=>ye,isFunction:()=>Zt,isIterable:()=>ve,isNumber:()=>be,isObject:()=>At,isRegExp:()=>xe,isString:()=>we,isTuple:()=>Qs,key:()=>ke,lerp:()=>_e,lineHeight:()=>NK,loader:()=>oU,locale:()=>vot,logger:()=>_t,lruCache:()=>Ae,markup:()=>Y$,merge:()=>Ce,mergeConfig:()=>Et,multiLineOffset:()=>FK,one:()=>pt,pad:()=>Te,panLinear:()=>Lt,panLog:()=>Pt,panPow:()=>jt,panSymlog:()=>Ut,parse:()=>Jkt,parseExpression:()=>ZSt,parseSelector:()=>pAt,pathCurves:()=>tY,pathEqual:()=>TZ,pathParse:()=>rY,pathRectangle:()=>EY,pathRender:()=>pY,pathSymbols:()=>vY,pathTrail:()=>TY,peek:()=>Dt,point:()=>r$,projection:()=>v6,quantileLogNormal:()=>Oz,quantileNormal:()=>Tz,quantileUniform:()=>jz,quantiles:()=>dz,quantizeInterpolator:()=>N3,quarter:()=>Yt,quartiles:()=>fz,random:()=>mz,randomInteger:()=>wz,randomKDE:()=>Dz,randomLCG:()=>xz,randomLogNormal:()=>Rz,randomMixture:()=>zz,randomNormal:()=>Nz,randomUniform:()=>Uz,read:()=>aU,regressionExp:()=>Xz,regressionLinear:()=>Hz,regressionLoess:()=>eB,regressionLog:()=>Yz,regressionPoly:()=>Zz,regressionPow:()=>Kz,regressionQuad:()=>$z,renderModule:()=>bZ,repeat:()=>Ee,resetDefaultLocale:()=>xot,resetSVGClipId:()=>VY,resetSVGDefIds:()=>NZ,responseType:()=>iU,runtimeContext:()=>pnt,sampleCurve:()=>aB,sampleLogNormal:()=>Fz,sampleNormal:()=>Az,sampleUniform:()=>Bz,scale:()=>C3,sceneEqual:()=>EZ,sceneFromJSON:()=>XK,scenePickVisit:()=>BX,sceneToJSON:()=>YK,sceneVisit:()=>zX,sceneZOrder:()=>RX,scheme:()=>O3,serializeXML:()=>X$,setRandom:()=>yz,span:()=>Ne,splitAccessPath:()=>ut,stringValue:()=>De,textMetrics:()=>kK,timeBin:()=>AP,timeFloor:()=>ZL,timeFormatLocale:()=>mot,timeInterval:()=>rP,timeOffset:()=>oP,timeSequence:()=>uP,timeUnitSpecifier:()=>IL,timeUnits:()=>DL,toBoolean:()=>Fe,toDate:()=>Me,toNumber:()=>Ft,toSet:()=>Re,toString:()=>Oe,transform:()=>Rc,transforms:()=>Mc,truncate:()=>ze,truthy:()=>gt,tupleid:()=>Js,typeParsers:()=>Hj,utcFloor:()=>tP,utcInterval:()=>iP,utcOffset:()=>sP,utcSequence:()=>lP,utcdayofyear:()=>UL,utcquarter:()=>Xt,utcweek:()=>WL,version:()=>bAt,visitArray:()=>Be,week:()=>zL,writeConfig:()=>Tt,zero:()=>ft,zoomLinear:()=>Vt,zoomLog:()=>qt,zoomPow:()=>Gt,zoomSymlog:()=>Ht});var w={};n.r(w),n.d(w,{compile:()=>ZUt,extractTransforms:()=>JUt,normalize:()=>pOt,version:()=>tWt});var k={};n.r(k),n.d(k,{carbong10:()=>tVt,carbong100:()=>nVt,carbong90:()=>eVt,carbonwhite:()=>JWt,dark:()=>aWt,excel:()=>sWt,fivethirtyeight:()=>dWt,ggplot2:()=>pWt,googlecharts:()=>RWt,latimes:()=>xWt,powerbi:()=>XWt,quartz:()=>_Wt,urbaninstitute:()=>FWt,version:()=>rVt,vox:()=>AWt});var _=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),S=Object.prototype.hasOwnProperty;function A(t,e){return S.call(t,e)}function C(t){if(Array.isArray(t)){for(var e=new Array(t.length),n=0;n<e.length;n++)e[n]=""+n;return e}if(Object.keys)return Object.keys(t);var r=[];for(var i in t)A(t,i)&&r.push(i);return r}function E(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function T(t){for(var e,n=0,r=t.length;n<r;){if(!((e=t.charCodeAt(n))>=48&&e<=57))return!1;n++}return!0}function N(t){return-1===t.indexOf("/")&&-1===t.indexOf("~")?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function D(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function F(t){if(void 0===t)return!0;if(t)if(Array.isArray(t)){for(var e=0,n=t.length;e<n;e++)if(F(t[e]))return!0}else if("object"===typeof t)for(var r=C(t),i=r.length,a=0;a<i;a++)if(F(t[r[a]]))return!0;return!1}function I(t,e){var n=[t];for(var r in e){var i="object"===typeof e[r]?JSON.stringify(e[r],null,2):e[r];"undefined"!==typeof i&&n.push(r+": "+i)}return n.join("\n")}var M=function(t){function e(e,n,r,i,a){var o=this.constructor,s=t.call(this,I(e,{name:n,index:r,operation:i,tree:a}))||this;return s.name=n,s.index=r,s.operation=i,s.tree=a,Object.setPrototypeOf(s,o.prototype),s.message=I(e,{name:n,index:r,operation:i,tree:a}),s}return _(e,t),e}(Error),O=M,R=E,z={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var r=t[e];return delete t[e],{newDocument:n,removed:r}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:function(t,e,n){var r=L(n,this.path);r&&(r=E(r));var i=P(n,{op:"remove",path:this.from}).removed;return P(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(t,e,n){var r=L(n,this.from);return P(n,{op:"add",path:this.path,value:E(r)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:q(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}},B={add:function(t,e,n){return T(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){return{newDocument:n,removed:t.splice(e,1)[0]}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:z.move,copy:z.copy,test:z.test,_get:z._get};function L(t,e){if(""==e)return t;var n={op:"_get",path:e};return P(t,n),n.value}function P(t,e,n,r,i,a){if(void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===i&&(i=!0),void 0===a&&(a=0),n&&("function"==typeof n?n(e,0,t,e.path):W(e,0)),""===e.path){var o={newDocument:t};if("add"===e.op)return o.newDocument=e.value,o;if("replace"===e.op)return o.newDocument=e.value,o.removed=t,o;if("move"===e.op||"copy"===e.op)return o.newDocument=L(t,e.from),"move"===e.op&&(o.removed=t),o;if("test"===e.op){if(o.test=q(t,e.value),!1===o.test)throw new O("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return o.newDocument=t,o}if("remove"===e.op)return o.removed=t,o.newDocument=null,o;if("_get"===e.op)return e.value=t,o;if(n)throw new O("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,e,t);return o}r||(t=E(t));var s=(e.path||"").split("/"),c=t,u=1,l=s.length,h=void 0,d=void 0,f=void 0;for(f="function"==typeof n?n:W;;){if((d=s[u])&&-1!=d.indexOf("~")&&(d=D(d)),i&&("__proto__"==d||"prototype"==d&&u>0&&"constructor"==s[u-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===h&&(void 0===c[d]?h=s.slice(0,u).join("/"):u==l-1&&(h=e.path),void 0!==h&&f(e,0,t,h)),u++,Array.isArray(c)){if("-"===d)d=c.length;else{if(n&&!T(d))throw new O("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,e,t);T(d)&&(d=~~d)}if(u>=l){if(n&&"add"===e.op&&d>c.length)throw new O("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,e,t);if(!1===(o=B[e.op].call(e,c,d,t)).test)throw new O("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return o}}else if(u>=l){if(!1===(o=z[e.op].call(e,c,d,t)).test)throw new O("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return o}if(c=c[d],n&&u<l&&(!c||"object"!==typeof c))throw new O("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",a,e,t)}}function j(t,e,n,r,i){if(void 0===r&&(r=!0),void 0===i&&(i=!0),n&&!Array.isArray(e))throw new O("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(t=E(t));for(var a=new Array(e.length),o=0,s=e.length;o<s;o++)a[o]=P(t,e[o],n,!0,i,o),t=a[o].newDocument;return a.newDocument=t,a}function U(t,e,n){var r=P(t,e);if(!1===r.test)throw new O("Test operation failed","TEST_OPERATION_FAILED",n,e,t);return r.newDocument}function W(t,e,n,r){if("object"!==typeof t||null===t||Array.isArray(t))throw new O("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(!z[t.op])throw new O("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n);if("string"!==typeof t.path)throw new O("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(0!==t.path.indexOf("/")&&t.path.length>0)throw new O('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if(("move"===t.op||"copy"===t.op)&&"string"!==typeof t.from)throw new O("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&void 0===t.value)throw new O("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&F(t.value))throw new O("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n)if("add"==t.op){var i=t.path.split("/").length,a=r.split("/").length;if(i!==a+1&&i!==a)throw new O("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if("replace"===t.op||"remove"===t.op||"_get"===t.op){if(t.path!==r)throw new O("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if("move"===t.op||"copy"===t.op){var o=V([{op:"_get",path:t.from,value:void 0}],n);if(o&&"OPERATION_PATH_UNRESOLVABLE"===o.name)throw new O("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}function V(t,e,n){try{if(!Array.isArray(t))throw new O("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)j(E(e),E(t),n||!0);else{n=n||W;for(var r=0;r<t.length;r++)n(t[r],r,e,void 0)}}catch(i){if(i instanceof O)return i;throw i}}function q(t,e){if(t===e)return!0;if(t&&e&&"object"==typeof t&&"object"==typeof e){var n,r,i,a=Array.isArray(t),o=Array.isArray(e);if(a&&o){if((r=t.length)!=e.length)return!1;for(n=r;0!==n--;)if(!q(t[n],e[n]))return!1;return!0}if(a!=o)return!1;var s=Object.keys(t);if((r=s.length)!==Object.keys(e).length)return!1;for(n=r;0!==n--;)if(!e.hasOwnProperty(s[n]))return!1;for(n=r;0!==n--;)if(!q(t[i=s[n]],e[i]))return!1;return!0}return t!==t&&e!==e}var G=new WeakMap,H=function(t){this.observers=new Map,this.obj=t},Y=function(t,e){this.callback=t,this.observer=e};function X(t,e){e.unobserve()}function K(t,e){var n,r=function(t){return G.get(t)}(t);if(r){var i=function(t,e){return t.observers.get(e)}(r,e);n=i&&i.observer}else r=new H(t),G.set(t,r);if(n)return n;if(n={},r.value=E(t),e){n.callback=e,n.next=null;var a=function(){$(n)},o=function(){clearTimeout(n.next),n.next=setTimeout(a)};"undefined"!==typeof window&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return n.patches=[],n.object=t,n.unobserve=function(){$(n),clearTimeout(n.next),function(t,e){t.observers.delete(e.callback)}(r,n),"undefined"!==typeof window&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},r.observers.set(e,new Y(e,n)),n}function $(t,e){void 0===e&&(e=!1);var n=G.get(t.object);Z(n.value,t.object,t.patches,"",e),t.patches.length&&j(n.value,t.patches);var r=t.patches;return r.length>0&&(t.patches=[],t.callback&&t.callback(r)),r}function Z(t,e,n,r,i){if(e!==t){"function"===typeof e.toJSON&&(e=e.toJSON());for(var a=C(e),o=C(t),s=!1,c=o.length-1;c>=0;c--){var u=t[h=o[c]];if(!A(e,h)||void 0===e[h]&&void 0!==u&&!1===Array.isArray(e))Array.isArray(t)===Array.isArray(e)?(i&&n.push({op:"test",path:r+"/"+N(h),value:E(u)}),n.push({op:"remove",path:r+"/"+N(h)}),s=!0):(i&&n.push({op:"test",path:r,value:t}),n.push({op:"replace",path:r,value:e}),!0);else{var l=e[h];"object"==typeof u&&null!=u&&"object"==typeof l&&null!=l&&Array.isArray(u)===Array.isArray(l)?Z(u,l,n,r+"/"+N(h),i):u!==l&&(!0,i&&n.push({op:"test",path:r+"/"+N(h),value:E(u)}),n.push({op:"replace",path:r+"/"+N(h),value:E(l)}))}}if(s||a.length!=o.length)for(c=0;c<a.length;c++){var h;A(t,h=a[c])||void 0===e[h]||n.push({op:"add",path:r+"/"+N(h),value:E(e[h])})}}}function Q(t,e,n){void 0===n&&(n=!1);var r=[];return Z(t,e,r,"",n),r}Object.assign({},r,i,{JsonPatchError:M,deepClone:E,escapePathComponent:N,unescapePathComponent:D});var J=n(1403),tt=n.n(J),et=n(28394);function nt(t,e,n){return t.fields=e||[],t.fname=n,t}function rt(t){return null==t?null:t.fname}function it(t){return null==t?null:t.fields}function at(t){return 1===t.length?ot(t[0]):st(t)}const ot=t=>function(e){return e[t]},st=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function ct(t){throw Error(t)}function ut(t){const e=[],n=t.length;let r,i,a,o=null,s=0,c="";function u(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)c+=t.substring(r,i),c+=t.substring(++i,++i),r=i;else if(a===o)u(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&u(),s=r=i+1):"]"===a&&(s||ct("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&ct("Access path missing closing bracket: "+t),o&&ct("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function lt(t,e,n){const r=ut(t);return t=1===r.length?r[0]:t,nt((n&&n.get||at)(r),[t],e||t)}const ht=lt("id"),dt=nt((t=>t),[],"identity"),ft=nt((()=>0),[],"zero"),pt=nt((()=>1),[],"one"),gt=nt((()=>!0),[],"true"),mt=nt((()=>!1),[],"false");function yt(t,e,n){const r=[e].concat([].slice.call(n));console[t].apply(console,r)}const vt=0,bt=1,xt=2,wt=3,kt=4;function _t(t,e){let n=t||vt;return{level(t){return arguments.length?(n=+t,this):n},error(){return n>=bt&&yt(e||"error","ERROR",arguments),this},warn(){return n>=xt&&yt(e||"warn","WARN",arguments),this},info(){return n>=wt&&yt(e||"log","INFO",arguments),this},debug(){return n>=kt&&yt(e||"log","DEBUG",arguments),this}}}var St=Array.isArray;function At(t){return t===Object(t)}const Ct=t=>"__proto__"!==t;function Et(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(((t,e)=>{for(const n in e)if("signals"===n)t.signals=Nt(t.signals,e.signals);else{const r="legend"===n?{layout:1}:"style"===n||null;Tt(t,n,e[n],r)}return t}),{})}function Tt(t,e,n,r){if(!Ct(e))return;let i,a;if(At(n)&&!St(n))for(i in a=At(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?Tt(a,i,n[i]):Ct(i)&&(a[i]=n[i]);else t[e]=n}function Nt(t,e){if(null==t)return e;const n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}function Dt(t){return t[t.length-1]}function Ft(t){return null==t||""===t?null:+t}const It=t=>e=>t*Math.exp(e),Mt=t=>e=>Math.log(t*e),Ot=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),Rt=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,zt=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function Bt(t,e,n,r){const i=n(t[0]),a=n(Dt(t)),o=(a-i)*e;return[r(i-o),r(a-o)]}function Lt(t,e){return Bt(t,e,Ft,dt)}function Pt(t,e){var n=Math.sign(t[0]);return Bt(t,e,Mt(n),It(n))}function jt(t,e,n){return Bt(t,e,zt(n),zt(1/n))}function Ut(t,e,n){return Bt(t,e,Ot(n),Rt(n))}function Wt(t,e,n,r,i){const a=r(t[0]),o=r(Dt(t)),s=null!=e?r(e):(a+o)/2;return[i(s+(a-s)*n),i(s+(o-s)*n)]}function Vt(t,e,n){return Wt(t,e,n,Ft,dt)}function qt(t,e,n){const r=Math.sign(t[0]);return Wt(t,e,n,Mt(r),It(r))}function Gt(t,e,n,r){return Wt(t,e,n,zt(r),zt(1/r))}function Ht(t,e,n,r){return Wt(t,e,n,Ot(r),Rt(r))}function Yt(t){return 1+~~(new Date(t).getMonth()/3)}function Xt(t){return 1+~~(new Date(t).getUTCMonth()/3)}function Kt(t){return null!=t?St(t)?t:[t]:[]}function $t(t,e,n){let r,i=t[0],a=t[1];return a<i&&(r=a,a=i,i=r),r=a-i,r>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]}function Zt(t){return"function"===typeof t}const Qt="descending";function Jt(t,e,n){n=n||{},e=Kt(e)||[];const r=[],i=[],a={},o=n.comparator||ee;return Kt(t).forEach(((t,o)=>{null!=t&&(r.push(e[o]===Qt?-1:1),i.push(t=Zt(t)?t:lt(t,null,n)),(it(t)||[]).forEach((t=>a[t]=1)))})),0===i.length?null:nt(o(i,r),Object.keys(a))}const te=(t,e)=>(t<e||null==t)&&null!=e?-1:(t>e||null==e)&&null!=t?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e===e?-1:e!==e&&t===t?1:0),ee=(t,e)=>1===t.length?ne(t[0],e[0]):re(t,e,t.length),ne=(t,e)=>function(n,r){return te(t(n),t(r))*e},re=(t,e,n)=>(e.push(0),function(r,i){let a,o=0,s=-1;for(;0===o&&++s<n;)a=t[s],o=te(a(r),a(i));return o*e[s]});function ie(t){return Zt(t)?t:()=>t}function ae(t,e){let n;return r=>{n&&clearTimeout(n),n=setTimeout((()=>(e(r),n=null)),t)}}function oe(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}function se(t,e){let n,r,i,a,o=0;if(t&&(n=t.length))if(null==e){for(r=t[o];o<n&&(null==r||r!==r);r=t[++o]);for(i=a=r;o<n;++o)r=t[o],null!=r&&(r<i&&(i=r),r>a&&(a=r))}else{for(r=e(t[o]);o<n&&(null==r||r!==r);r=e(t[++o]));for(i=a=r;o<n;++o)r=e(t[o]),null!=r&&(r<i&&(i=r),r>a&&(a=r))}return[i,a]}function ce(t,e){const n=t.length;let r,i,a,o,s,c=-1;if(null==e){for(;++c<n;)if(i=t[c],null!=i&&i>=i){r=a=i;break}if(c===n)return[-1,-1];for(o=s=c;++c<n;)i=t[c],null!=i&&(r>i&&(r=i,o=c),a<i&&(a=i,s=c))}else{for(;++c<n;)if(i=e(t[c],c,t),null!=i&&i>=i){r=a=i;break}if(c===n)return[-1,-1];for(o=s=c;++c<n;)i=e(t[c],c,t),null!=i&&(r>i&&(r=i,o=c),a<i&&(a=i,s=c))}return[o,s]}const ue=Object.prototype.hasOwnProperty;function le(t,e){return ue.call(t,e)}const he={};function de(t){let e,n={};function r(t){return le(n,t)&&n[t]!==he}const i={size:0,empty:0,object:n,has:r,get:t=>r(t)?n[t]:void 0,set(t,e){return r(t)||(++i.size,n[t]===he&&--i.empty),n[t]=e,this},delete(t){return r(t)&&(--i.size,++i.empty,n[t]=he),this},clear(){i.size=i.empty=0,i.object=n={}},test(t){return arguments.length?(e=t,i):e},clean(){const t={};let r=0;for(const i in n){const a=n[i];a===he||e&&e(a)||(t[i]=a,++r)}i.size=r,i.empty=0,i.object=n=t}};return t&&Object.keys(t).forEach((e=>{i.set(e,t[e])})),i}function fe(t,e,n,r,i,a){if(!n&&0!==n)return a;const o=+n;let s,c=t[0],u=Dt(t);u<c&&(s=c,c=u,u=s),s=Math.abs(e-c);const l=Math.abs(u-e);return s<l&&s<=o?r:l<=o?i:a}function pe(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),oe(r,n)}function ge(t,e,n,r){let i,a=e[0],o=e[e.length-1];return a>o&&(i=a,a=o,o=i),r=void 0===r||r,((n=void 0===n||n)?a<=t:a<t)&&(r?t<=o:t<o)}function me(t){return"boolean"===typeof t}function ye(t){return"[object Date]"===Object.prototype.toString.call(t)}function ve(t){return t&&Zt(t[Symbol.iterator])}function be(t){return"number"===typeof t}function xe(t){return"[object RegExp]"===Object.prototype.toString.call(t)}function we(t){return"string"===typeof t}function ke(t,e,n){t&&(t=e?Kt(t).map((t=>t.replace(/\\(.)/g,"$1"))):Kt(t));const r=t&&t.length,i=n&&n.get||at,a=t=>i(e?[t]:ut(t));let o;if(r)if(1===r){const e=a(t[0]);o=function(t){return""+e(t)}}else{const e=t.map(a);o=function(t){let n=""+e[0](t),i=0;for(;++i<r;)n+="|"+e[i](t);return n}}else o=function(){return""};return nt(o,t,"key")}function _e(t,e){const n=t[0],r=Dt(t),i=+e;return i?1===i?r:n+i*(r-n):n}const Se=1e4;function Ae(t){let e,n,r;t=+t||Se;const i=()=>{e={},n={},r=0},a=(i,a)=>(++r>t&&(n=e,e={},r=1),e[i]=a);return i(),{clear:i,has:t=>le(e,t)||le(n,t),get:t=>le(e,t)?e[t]:le(n,t)?a(t,n[t]):void 0,set:(t,n)=>le(e,t)?e[t]=n:a(t,n)}}function Ce(t,e,n,r){const i=e.length,a=n.length;if(!a)return e;if(!i)return n;const o=r||new e.constructor(i+a);let s=0,c=0,u=0;for(;s<i&&c<a;++u)o[u]=t(e[s],n[c])>0?n[c++]:e[s++];for(;s<i;++s,++u)o[u]=e[s];for(;c<a;++c,++u)o[u]=n[c];return o}function Ee(t,e){let n="";for(;--e>=0;)n+=t;return n}function Te(t,e,n,r){const i=n||" ",a=t+"",o=e-a.length;return o<=0?a:"left"===r?Ee(i,o)+a:"center"===r?Ee(i,~~(o/2))+a+Ee(i,Math.ceil(o/2)):a+Ee(i,o)}function Ne(t){return t&&Dt(t)-t[0]||0}function De(t){return St(t)?"["+t.map(De)+"]":At(t)||we(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function Fe(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t}const Ie=t=>be(t)||ye(t)?t:Date.parse(t);function Me(t,e){return e=e||Ie,null==t||""===t?null:e(t)}function Oe(t){return null==t||""===t?null:t+""}function Re(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function ze(t,e,n,r){const i=null!=r?r:"\u2026",a=t+"",o=a.length,s=Math.max(0,e-i.length);return o<=e?a:"left"===n?i+a.slice(o-s):"center"===n?a.slice(0,Math.ceil(s/2))+i+a.slice(o-~~(s/2)):a.slice(0,s)+i}function Be(t,e,n){if(t)if(e){const r=t.length;for(let i=0;i<r;++i){const r=e(t[i]);r&&n(r,i,t)}}else t.forEach(n)}function Le(t,e,n){return t.fields=e||[],t.fname=n,t}function Pe(t){return null==t?null:t.fname}function je(t){return null==t?null:t.fields}function Ue(t){return 1===t.length?We(t[0]):Ve(t)}const We=t=>function(e){return e[t]},Ve=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function qe(t){throw Error(t)}function Ge(t){const e=[],n=t.length;let r,i,a,o=null,s=0,c="";function u(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)c+=t.substring(r,i++),r=i;else if(a===o)u(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&u(),s=r=i+1):"]"===a&&(s||qe("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&qe("Access path missing closing bracket: "+t),o&&qe("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function He(t,e,n){const r=Ge(t);return t=1===r.length?r[0]:t,Le((n&&n.get||Ue)(r),[t],e||t)}const Ye=He("id"),Xe=Le((t=>t),[],"identity"),Ke=Le((()=>0),[],"zero"),$e=Le((()=>1),[],"one"),Ze=Le((()=>!0),[],"true"),Qe=Le((()=>!1),[],"false");function Je(t,e,n){const r=[e].concat([].slice.call(n));console[t].apply(console,r)}const tn=0,en=1,nn=2,rn=3,an=4;var on=Array.isArray;function sn(t){return t===Object(t)}const cn=t=>"__proto__"!==t;function un(t,e,n,r){if(!cn(e))return;let i,a;if(sn(n)&&!on(n))for(i in a=sn(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?un(a,i,n[i]):cn(i)&&(a[i]=n[i]);else t[e]=n}function ln(t,e){if(null==t)return e;const n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}function hn(t){return t[t.length-1]}function dn(t){return null==t||""===t?null:+t}const fn=t=>e=>t*Math.exp(e),pn=t=>e=>Math.log(t*e),gn=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),mn=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,yn=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function vn(t,e,n,r){const i=n(t[0]),a=n(hn(t)),o=(a-i)*e;return[r(i-o),r(a-o)]}function bn(t,e,n,r,i){const a=r(t[0]),o=r(hn(t)),s=null!=e?r(e):(a+o)/2;return[i(s+(a-s)*n),i(s+(o-s)*n)]}function xn(t,e,n){return bn(t,e,n,dn,Xe)}function wn(t,e,n){const r=Math.sign(t[0]);return bn(t,e,n,pn(r),fn(r))}function kn(t,e,n,r){return bn(t,e,n,yn(r),yn(1/r))}function _n(t,e,n,r){return bn(t,e,n,gn(r),mn(r))}function Sn(t){return null!=t?on(t)?t:[t]:[]}function An(t){return"function"===typeof t}const Cn="descending";function En(t,e,n){n=n||{},e=Sn(e)||[];const r=[],i=[],a={},o=n.comparator||Nn;return Sn(t).forEach(((t,o)=>{null!=t&&(r.push(e[o]===Cn?-1:1),i.push(t=An(t)?t:He(t,null,n)),(je(t)||[]).forEach((t=>a[t]=1)))})),0===i.length?null:Le(o(i,r),Object.keys(a))}const Tn=(t,e)=>(t<e||null==t)&&null!=e?-1:(t>e||null==e)&&null!=t?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e===e?-1:e!==e&&t===t?1:0),Nn=(t,e)=>1===t.length?Dn(t[0],e[0]):Fn(t,e,t.length),Dn=(t,e)=>function(n,r){return Tn(t(n),t(r))*e},Fn=(t,e,n)=>(e.push(0),function(r,i){let a,o=0,s=-1;for(;0===o&&++s<n;)a=t[s],o=Tn(a(r),a(i));return o*e[s]});function In(t){return An(t)?t:()=>t}function Mn(t,e){let n;return r=>{n&&clearTimeout(n),n=setTimeout((()=>(e(r),n=null)),t)}}function On(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}function Rn(t,e){let n,r,i,a,o=0;if(t&&(n=t.length))if(null==e){for(r=t[o];o<n&&(null==r||r!==r);r=t[++o]);for(i=a=r;o<n;++o)r=t[o],null!=r&&(r<i&&(i=r),r>a&&(a=r))}else{for(r=e(t[o]);o<n&&(null==r||r!==r);r=e(t[++o]));for(i=a=r;o<n;++o)r=e(t[o]),null!=r&&(r<i&&(i=r),r>a&&(a=r))}return[i,a]}const zn=Object.prototype.hasOwnProperty;function Bn(t,e){return zn.call(t,e)}const Ln={};function Pn(t){let e,n={};function r(t){return Bn(n,t)&&n[t]!==Ln}const i={size:0,empty:0,object:n,has:r,get:t=>r(t)?n[t]:void 0,set(t,e){return r(t)||(++i.size,n[t]===Ln&&--i.empty),n[t]=e,this},delete(t){return r(t)&&(--i.size,++i.empty,n[t]=Ln),this},clear(){i.size=i.empty=0,i.object=n={}},test(t){return arguments.length?(e=t,i):e},clean(){const t={};let r=0;for(const i in n){const a=n[i];a===Ln||e&&e(a)||(t[i]=a,++r)}i.size=r,i.empty=0,i.object=n=t}};return t&&Object.keys(t).forEach((e=>{i.set(e,t[e])})),i}function jn(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),On(r,n)}function Un(t,e,n,r){let i,a=e[0],o=e[e.length-1];return a>o&&(i=a,a=o,o=i),r=void 0===r||r,((n=void 0===n||n)?a<=t:a<t)&&(r?t<=o:t<o)}function Wn(t){return"[object Date]"===Object.prototype.toString.call(t)}function Vn(t){return"number"===typeof t}function qn(t){return"string"===typeof t}function Gn(t,e,n){t&&(t=e?Sn(t).map((t=>t.replace(/\\(.)/g,"$1"))):Sn(t));const r=t&&t.length,i=n&&n.get||Ue,a=t=>i(e?[t]:Ge(t));let o;if(r)if(1===r){const e=a(t[0]);o=function(t){return""+e(t)}}else{const e=t.map(a);o=function(t){let n=""+e[0](t),i=0;for(;++i<r;)n+="|"+e[i](t);return n}}else o=function(){return""};return Le(o,t,"key")}function Hn(t,e){let n="";for(;--e>=0;)n+=t;return n}function Yn(t){return t&&hn(t)-t[0]||0}function Xn(t){return on(t)?"["+t.map(Xn)+"]":sn(t)||qn(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function Kn(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t}const $n=t=>Vn(t)||Wn(t)?t:Date.parse(t);function Zn(t,e){return e=e||$n,null==t||""===t?null:e(t)}function Qn(t){return null==t||""===t?null:t+""}function Jn(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function tr(t,e,n){if(t)if(e){const r=t.length;for(let i=0;i<r;++i){const r=e(t[i]);r&&n(r,i,t)}}else t.forEach(n)}var er={},nr={},rr=34,ir=10,ar=13;function or(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function sr(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function cr(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function ur(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":function(t){return t<0?"-"+cr(-t,6):t>9999?"+"+cr(t,6):cr(t,4)}(t.getUTCFullYear())+"-"+cr(t.getUTCMonth()+1,2)+"-"+cr(t.getUTCDate(),2)+(i?"T"+cr(e,2)+":"+cr(n,2)+":"+cr(r,2)+"."+cr(i,3)+"Z":r?"T"+cr(e,2)+":"+cr(n,2)+":"+cr(r,2)+"Z":n||e?"T"+cr(e,2)+":"+cr(n,2)+"Z":"")}function lr(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],a=t.length,o=0,s=0,c=a<=0,u=!1;function l(){if(c)return nr;if(u)return u=!1,er;var e,r,i=o;if(t.charCodeAt(i)===rr){for(;o++<a&&t.charCodeAt(o)!==rr||t.charCodeAt(++o)===rr;);return(e=o)>=a?c=!0:(r=t.charCodeAt(o++))===ir?u=!0:r===ar&&(u=!0,t.charCodeAt(o)===ir&&++o),t.slice(i+1,e-1).replace(/""/g,'"')}for(;o<a;){if((r=t.charCodeAt(e=o++))===ir)u=!0;else if(r===ar)u=!0,t.charCodeAt(o)===ir&&++o;else if(r!==n)continue;return t.slice(i,e)}return c=!0,t.slice(i,a)}for(t.charCodeAt(a-1)===ir&&--a,t.charCodeAt(a-1)===ar&&--a;(r=l())!==nr;){for(var h=[];r!==er&&r!==nr;)h.push(r),r=l();e&&null==(h=e(h,s++))||i.push(h)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return o(e[t])})).join(t)}))}function a(e){return e.map(o).join(t)}function o(t){return null==t?"":t instanceof Date?ur(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,a=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=or(t);return function(r,i){return e(n(r),i,t)}}(t,e):or(t)}));return a.columns=i||[],a},parseRows:r,format:function(e,n){return null==n&&(n=sr(e)),[n.map(o).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=sr(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(a).join("\n")},formatRow:a,formatValue:o}}function hr(t){return t}function dr(t,e){return"string"===typeof e&&(e=t.objects[e]),"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map((function(e){return fr(t,e)}))}:fr(t,e)}function fr(t,e){var n=e.id,r=e.bbox,i=null==e.properties?{}:e.properties,a=pr(t,e);return null==n&&null==r?{type:"Feature",properties:i,geometry:a}:null==r?{type:"Feature",id:n,properties:i,geometry:a}:{type:"Feature",id:n,bbox:r,properties:i,geometry:a}}function pr(t,e){var n=function(t){if(null==t)return hr;var e,n,r=t.scale[0],i=t.scale[1],a=t.translate[0],o=t.translate[1];return function(t,s){s||(e=n=0);var c=2,u=t.length,l=new Array(u);for(l[0]=(e+=t[0])*r+a,l[1]=(n+=t[1])*i+o;c<u;)l[c]=t[c],++c;return l}}(t.transform),r=t.arcs;function i(t,e){e.length&&e.pop();for(var i=r[t<0?~t:t],a=0,o=i.length;a<o;++a)e.push(n(i[a],a));t<0&&function(t,e){for(var n,r=t.length,i=r-e;i<--r;)n=t[i],t[i++]=t[r],t[r]=n}(e,o)}function a(t){return n(t)}function o(t){for(var e=[],n=0,r=t.length;n<r;++n)i(t[n],e);return e.length<2&&e.push(e[0]),e}function s(t){for(var e=o(t);e.length<4;)e.push(e[0]);return e}function c(t){return t.map(s)}return function t(e){var n,r=e.type;switch(r){case"GeometryCollection":return{type:r,geometries:e.geometries.map(t)};case"Point":n=a(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(a);break;case"LineString":n=o(e.arcs);break;case"MultiLineString":n=e.arcs.map(o);break;case"Polygon":n=c(e.arcs);break;case"MultiPolygon":n=e.arcs.map(c);break;default:return null}return{type:r,coordinates:n}}(e)}function gr(t,e){var n={},r={},i={},a=[],o=-1;function s(t,e){for(var r in t){var i=t[r];delete e[i.start],delete i.start,delete i.end,i.forEach((function(t){n[t<0?~t:t]=1})),a.push(i)}}return e.forEach((function(n,r){var i,a=t.arcs[n<0?~n:n];a.length<3&&!a[1][0]&&!a[1][1]&&(i=e[++o],e[o]=n,e[r]=i)})),e.forEach((function(e){var n,a,o=function(e){var n,r=t.arcs[e<0?~e:e],i=r[0];t.transform?(n=[0,0],r.forEach((function(t){n[0]+=t[0],n[1]+=t[1]}))):n=r[r.length-1];return e<0?[n,i]:[i,n]}(e),s=o[0],c=o[1];if(n=i[s])if(delete i[n.end],n.push(e),n.end=c,a=r[c]){delete r[a.start];var u=a===n?n:n.concat(a);r[u.start=n.start]=i[u.end=a.end]=u}else r[n.start]=i[n.end]=n;else if(n=r[c])if(delete r[n.start],n.unshift(e),n.start=s,a=i[s]){delete i[a.end];var l=a===n?n:a.concat(n);r[l.start=a.start]=i[l.end=n.end]=l}else r[n.start]=i[n.end]=n;else r[(n=[e]).start=s]=i[n.end=c]=n})),s(i,r),s(r,i),e.forEach((function(t){n[t<0?~t:t]||a.push([t])})),a}function mr(t){return pr(t,yr.apply(this,arguments))}function yr(t,e,n){var r,i,a;if(arguments.length>1)r=function(t,e,n){var r,i=[],a=[];function o(t){var e=t<0?~t:t;(a[e]||(a[e]=[])).push({i:t,g:r})}function s(t){t.forEach(o)}function c(t){t.forEach(s)}function u(t){t.forEach(c)}function l(t){switch(r=t,t.type){case"GeometryCollection":t.geometries.forEach(l);break;case"LineString":s(t.arcs);break;case"MultiLineString":case"Polygon":c(t.arcs);break;case"MultiPolygon":u(t.arcs)}}return l(e),a.forEach(null==n?function(t){i.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&i.push(t[0].i)}),i}(0,e,n);else for(i=0,r=new Array(a=t.arcs.length);i<a;++i)r[i]=i;return{type:"MultiLineString",arcs:gr(t,r)}}const vr=Math.sqrt(50),br=Math.sqrt(10),xr=Math.sqrt(2);function wr(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=vr?10:a>=br?5:a>=xr?2:1;let s,c,u;return i<0?(u=Math.pow(10,-i)/o,s=Math.round(t*u),c=Math.round(e*u),s/u<t&&++s,c/u>e&&--c,u=-u):(u=Math.pow(10,i)*o,s=Math.round(t/u),c=Math.round(e/u),s*u<t&&++s,c*u>e&&--c),c<s&&.5<=n&&n<2?wr(t,e,2*n):[s,c,u]}function kr(t,e,n){return wr(t=+t,e=+e,n=+n)[2]}var _r,Sr=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ar(t){if(!(e=Sr.exec(t)))throw new Error("invalid format: "+t);var e;return new Cr({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Cr(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Er(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Tr(t){return(t=Er(Math.abs(t)))?t[1]:NaN}function Nr(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Tr(e)/3)))-Tr(Math.abs(t)))}function Dr(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Tr(e)-Tr(t))+1}function Fr(t){return Math.max(0,-Tr(Math.abs(t)))}function Ir(t,e){var n=Er(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}Ar.prototype=Cr.prototype,Cr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Mr={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Ir(100*t,e),r:Ir,s:function(t,e){var n=Er(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(_r=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+Er(t,Math.max(0,e+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Or(t){return t}var Rr,zr,Br,Lr=Array.prototype.map,Pr=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function jr(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?Or:(e=Lr.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,a=[],o=0,s=e[0],c=0;i>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),a.push(t.substring(i-=s,i+s)),!((c+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?Or:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(Lr.call(t.numerals,String)),c=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"\u2212":t.minus+"",l=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=Ar(t)).fill,n=t.align,h=t.sign,d=t.symbol,f=t.zero,p=t.width,g=t.comma,m=t.precision,y=t.trim,v=t.type;"n"===v?(g=!0,v="g"):Mr[v]||(void 0===m&&(m=12),y=!0,v="g"),(f||"0"===e&&"="===n)&&(f=!0,e="0",n="=");var b="$"===d?i:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",x="$"===d?a:/[%p]/.test(v)?c:"",w=Mr[v],k=/[defgprs%]/.test(v);function _(t){var i,a,c,d=b,_=x;if("c"===v)_=w(t)+_,t="";else{var S=(t=+t)<0||1/t<0;if(t=isNaN(t)?l:w(Math.abs(t),m),y&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),S&&0===+t&&"+"!==h&&(S=!1),d=(S?"("===h?h:u:"-"===h||"("===h?"":h)+d,_=("s"===v?Pr[8+_r/3]:"")+_+(S&&"("===h?")":""),k)for(i=-1,a=t.length;++i<a;)if(48>(c=t.charCodeAt(i))||c>57){_=(46===c?o+t.slice(i+1):t.slice(i))+_,t=t.slice(0,i);break}}g&&!f&&(t=r(t,1/0));var A=d.length+t.length+_.length,C=A<p?new Array(p-A+1).join(e):"";switch(g&&f&&(t=r(C+t,C.length?p-_.length:1/0),C=""),n){case"<":t=d+t+_+C;break;case"=":t=d+C+t+_;break;case"^":t=C.slice(0,A=C.length>>1)+d+t+_+C.slice(A);break;default:t=C+d+t+_}return s(t)}return m=void 0===m?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),_.toString=function(){return t+""},_}return{format:h,formatPrefix:function(t,e){var n=h(((t=Ar(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Tr(e)/3))),i=Math.pow(10,-r),a=Pr[8+r/3];return function(t){return n(i*t)+a}}}}!function(t){Rr=jr(t),zr=Rr.format,Br=Rr.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});const Ur=new Date,Wr=new Date;function Vr(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=e=>(t(e=new Date(+e)),e),i.ceil=n=>(t(n=new Date(n-1)),e(n,1),t(n),n),i.round=t=>{const e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=(t,n)=>(e(t=new Date(+t),null==n?1:Math.floor(n)),t),i.range=(n,r,a)=>{const o=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r)||!(a>0))return o;let s;do{o.push(s=new Date(+n)),e(n,a),t(n)}while(s<n&&n<r);return o},i.filter=n=>Vr((e=>{if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),((t,r)=>{if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););})),n&&(i.count=(e,r)=>(Ur.setTime(+e),Wr.setTime(+r),t(Ur),t(Wr),Math.floor(n(Ur,Wr))),i.every=t=>(t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?e=>r(e)%t===0:e=>i.count(0,e)%t===0):i:null)),i}const qr=1e3,Gr=6e4,Hr=36e5,Yr=864e5,Xr=6048e5,Kr=2592e6,$r=31536e6,Zr=Vr((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Gr)/Yr),(t=>t.getDate()-1)),Qr=(Zr.range,Vr((t=>{t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+e)}),((t,e)=>(e-t)/Yr),(t=>t.getUTCDate()-1))),Jr=(Qr.range,Vr((t=>{t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+e)}),((t,e)=>(e-t)/Yr),(t=>Math.floor(t/Yr))));Jr.range;function ti(t){return Vr((e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),((t,e)=>{t.setDate(t.getDate()+7*e)}),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Gr)/Xr))}const ei=ti(0),ni=ti(1),ri=ti(2),ii=ti(3),ai=ti(4),oi=ti(5),si=ti(6);ei.range,ni.range,ri.range,ii.range,ai.range,oi.range,si.range;function ci(t){return Vr((e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+7*e)}),((t,e)=>(e-t)/Xr))}const ui=ci(0),li=ci(1),hi=ci(2),di=ci(3),fi=ci(4),pi=ci(5),gi=ci(6),mi=(ui.range,li.range,hi.range,di.range,fi.range,pi.range,gi.range,Vr((t=>{t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,e)=>{t.setFullYear(t.getFullYear()+e)}),((t,e)=>e.getFullYear()-t.getFullYear()),(t=>t.getFullYear())));mi.every=t=>isFinite(t=Math.floor(t))&&t>0?Vr((e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,n)=>{e.setFullYear(e.getFullYear()+n*t)})):null;mi.range;const yi=Vr((t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)}),((t,e)=>e.getUTCFullYear()-t.getUTCFullYear()),(t=>t.getUTCFullYear()));yi.every=t=>isFinite(t=Math.floor(t))&&t>0?Vr((e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null;yi.range;const vi=Vr((t=>{t.setDate(1),t.setHours(0,0,0,0)}),((t,e)=>{t.setMonth(t.getMonth()+e)}),((t,e)=>e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())),(t=>t.getMonth())),bi=(vi.range,Vr((t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)}),((t,e)=>e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())),(t=>t.getUTCMonth()))),xi=(bi.range,Vr((t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*qr-t.getMinutes()*Gr)}),((t,e)=>{t.setTime(+t+e*Hr)}),((t,e)=>(e-t)/Hr),(t=>t.getHours()))),wi=(xi.range,Vr((t=>{t.setUTCMinutes(0,0,0)}),((t,e)=>{t.setTime(+t+e*Hr)}),((t,e)=>(e-t)/Hr),(t=>t.getUTCHours()))),ki=(wi.range,Vr((t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*qr)}),((t,e)=>{t.setTime(+t+e*Gr)}),((t,e)=>(e-t)/Gr),(t=>t.getMinutes()))),_i=(ki.range,Vr((t=>{t.setUTCSeconds(0,0)}),((t,e)=>{t.setTime(+t+e*Gr)}),((t,e)=>(e-t)/Gr),(t=>t.getUTCMinutes()))),Si=(_i.range,Vr((t=>{t.setTime(t-t.getMilliseconds())}),((t,e)=>{t.setTime(+t+e*qr)}),((t,e)=>(e-t)/qr),(t=>t.getUTCSeconds()))),Ai=(Si.range,Vr((()=>{}),((t,e)=>{t.setTime(+t+e)}),((t,e)=>e-t)));Ai.every=t=>(t=Math.floor(t),isFinite(t)&&t>0?t>1?Vr((e=>{e.setTime(Math.floor(e/t)*t)}),((e,n)=>{e.setTime(+e+n*t)}),((e,n)=>(n-e)/t)):Ai:null);Ai.range;function Ci(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Ei(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Ti(){return 0}const Ni=Math.sqrt(50),Di=Math.sqrt(10),Fi=Math.sqrt(2);function Ii(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=Ni?10:a>=Di?5:a>=Fi?2:1;let s,c,u;return i<0?(u=Math.pow(10,-i)/o,s=Math.round(t*u),c=Math.round(e*u),s/u<t&&++s,c/u>e&&--c,u=-u):(u=Math.pow(10,i)*o,s=Math.round(t/u),c=Math.round(e/u),s*u<t&&++s,c*u>e&&--c),c<s&&.5<=n&&n<2?Ii(t,e,2*n):[s,c,u]}function Mi(t,e,n){return Ii(t=+t,e=+e,n=+n)[2]}function Oi(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?Mi(e,t,n):Mi(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}const Ri="year",zi="quarter",Bi="month",Li="week",Pi="date",ji="day",Ui="dayofyear",Wi="hours",Vi="minutes",qi="seconds",Gi="milliseconds",Hi=[Ri,zi,Bi,Li,Pi,ji,Ui,Wi,Vi,qi,Gi],Yi=Hi.reduce(((t,e,n)=>(t[e]=1+n,t)),{});function Xi(t){const e=Sn(t).slice(),n={};e.length||qe("Missing time unit."),e.forEach((t=>{Bn(Yi,t)?n[t]=1:qe("Invalid time unit: ".concat(t,"."))}));return(n[Li]||n[ji]?1:0)+(n[zi]||n[Bi]||n[Pi]?1:0)+(n[Ui]?1:0)>1&&qe("Incompatible time units: ".concat(t)),e.sort(((t,e)=>Yi[t]-Yi[e])),e}const Ki={[Ri]:"%Y ",[zi]:"Q%q ",[Bi]:"%b ",[Pi]:"%d ",[Li]:"W%U ",[ji]:"%a ",[Ui]:"%j ",[Wi]:"%H:00",[Vi]:"00:%M",[qi]:":%S",[Gi]:".%L",["".concat(Ri,"-").concat(Bi)]:"%Y-%m ",["".concat(Ri,"-").concat(Bi,"-").concat(Pi)]:"%Y-%m-%d ",["".concat(Wi,"-").concat(Vi)]:"%H:%M"};const $i=new Date;function Zi(t){return $i.setFullYear(t),$i.setMonth(0),$i.setDate(1),$i.setHours(0,0,0,0),$i}function Qi(t){return Zr.count(Zi(t.getFullYear())-1,t)}function Ji(t){return ei.count(Zi(t.getFullYear())-1,t)}function ta(t){return Zi(t).getDay()}function ea(t,e,n,r,i,a,o){if(0<=t&&t<100){const s=new Date(-1,e,n,r,i,a,o);return s.setFullYear(t),s}return new Date(t,e,n,r,i,a,o)}function na(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return Qr.count(e-1,t)}function ra(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return ui.count(e-1,t)}function ia(t){return $i.setTime(Date.UTC(t,0,1)),$i.getUTCDay()}function aa(t,e,n,r,i,a,o){if(0<=t&&t<100){const t=new Date(Date.UTC(-1,e,n,r,i,a,o));return t.setUTCFullYear(n.y),t}return new Date(Date.UTC(t,e,n,r,i,a,o))}function oa(t,e,n,r,i){const a=e||1,o=hn(t),s=(t,e,i)=>function(t,e,n,r){const i=n<=1?t:r?(e,i)=>r+n*Math.floor((t(e,i)-r)/n):(e,r)=>n*Math.floor(t(e,r)/n);return e?(t,n)=>e(i(t,n),n):i}(n[i=i||t],r[i],t===o&&a,e),c=new Date,u=Jn(t),l=u[Ri]?s(Ri):In(2012),h=u[Bi]?s(Bi):u[zi]?s(zi):Ke,d=u[Li]&&u[ji]?s(ji,1,Li+ji):u[Li]?s(Li,1):u[ji]?s(ji,1):u[Pi]?s(Pi,1):u[Ui]?s(Ui,1):$e,f=u[Wi]?s(Wi):Ke,p=u[Vi]?s(Vi):Ke,g=u[qi]?s(qi):Ke,m=u[Gi]?s(Gi):Ke;return function(t){c.setTime(+t);const e=l(c);return i(e,h(c),d(c,e),f(c),p(c),g(c),m(c))}}function sa(t,e,n){return e+7*t-(n+6)%7}const ca={[Ri]:t=>t.getFullYear(),[zi]:t=>Math.floor(t.getMonth()/3),[Bi]:t=>t.getMonth(),[Pi]:t=>t.getDate(),[Wi]:t=>t.getHours(),[Vi]:t=>t.getMinutes(),[qi]:t=>t.getSeconds(),[Gi]:t=>t.getMilliseconds(),[Ui]:t=>Qi(t),[Li]:t=>Ji(t),[Li+ji]:(t,e)=>sa(Ji(t),t.getDay(),ta(e)),[ji]:(t,e)=>sa(1,t.getDay(),ta(e))},ua={[zi]:t=>3*t,[Li]:(t,e)=>sa(t,0,ta(e))};function la(t,e){return oa(t,e||1,ca,ua,ea)}const ha={[Ri]:t=>t.getUTCFullYear(),[zi]:t=>Math.floor(t.getUTCMonth()/3),[Bi]:t=>t.getUTCMonth(),[Pi]:t=>t.getUTCDate(),[Wi]:t=>t.getUTCHours(),[Vi]:t=>t.getUTCMinutes(),[qi]:t=>t.getUTCSeconds(),[Gi]:t=>t.getUTCMilliseconds(),[Ui]:t=>na(t),[Li]:t=>ra(t),[ji]:(t,e)=>sa(1,t.getUTCDay(),ia(e)),[Li+ji]:(t,e)=>sa(ra(t),t.getUTCDay(),ia(e))},da={[zi]:t=>3*t,[Li]:(t,e)=>sa(t,0,ia(e))};function fa(t,e){return oa(t,e||1,ha,da,aa)}const pa={[Ri]:mi,[zi]:vi.every(3),[Bi]:vi,[Li]:ei,[Pi]:Zr,[ji]:Zr,[Ui]:Zr,[Wi]:xi,[Vi]:ki,[qi]:Si,[Gi]:Ai},ga={[Ri]:yi,[zi]:bi.every(3),[Bi]:bi,[Li]:ui,[Pi]:Qr,[ji]:Qr,[Ui]:Qr,[Wi]:wi,[Vi]:_i,[qi]:Si,[Gi]:Ai};function ma(t){return pa[t]}function ya(t){return ga[t]}function va(t,e,n){return t?t.offset(e,n):void 0}function ba(t,e,n,r){return t?t.range(e,n,r):void 0}const xa=1e3,wa=6e4,ka=36e5,_a=864e5,Sa=2592e6,Aa=31536e6,Ca=[Ri,Bi,Pi,Wi,Vi,qi,Gi],Ea=Ca.slice(0,-1),Ta=Ea.slice(0,-1),Na=Ta.slice(0,-1),Da=Na.slice(0,-1),Fa=[Ri,Bi],Ia=[Ri],Ma=[[Ea,1,xa],[Ea,5,5e3],[Ea,15,15e3],[Ea,30,3e4],[Ta,1,wa],[Ta,5,3e5],[Ta,15,9e5],[Ta,30,18e5],[Na,1,ka],[Na,3,108e5],[Na,6,216e5],[Na,12,432e5],[Da,1,_a],[[Ri,Li],1,6048e5],[Fa,1,Sa],[Fa,3,7776e6],[Ia,1,Aa]];function Oa(t){const e=t.extent,n=t.maxbins||40,r=Math.abs(Yn(e))/n;let i,a,o=function(t){let e,n,r;function i(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<0?i=e+1:a=e}while(i<a)}return i}return 2!==t.length?(e=Ci,n=(e,n)=>Ci(t(e),n),r=(e,n)=>t(e)-n):(e=t===Ci||t===Ei?t:Ti,n=t,r=t),{left:i,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=i(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return a>n&&r(t[a-1],e)>-r(t[a],e)?a-1:a},right:function(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<=0?i=e+1:a=e}while(i<a)}return i}}}((t=>t[2])).right(Ma,r);return o===Ma.length?(i=Ia,a=Oi(e[0]/Aa,e[1]/Aa,n)):o?(o=Ma[r/Ma[o-1][2]<Ma[o][2]/r?o-1:o],i=o[0],a=o[1]):(i=Ca,a=Math.max(Oi(e[0],e[1],n),1)),{units:i,step:a}}function Ra(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function za(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Ba(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function La(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,a=t.days,o=t.shortDays,s=t.months,c=t.shortMonths,u=$a(i),l=Za(i),h=$a(a),d=Za(a),f=$a(o),p=Za(o),g=$a(s),m=Za(s),y=$a(c),v=Za(c),b={a:function(t){return o[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:bo,e:bo,f:So,g:Ro,G:Bo,H:xo,I:wo,j:ko,L:_o,m:Ao,M:Co,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:os,s:ss,S:Eo,u:To,U:No,V:Fo,w:Io,W:Mo,x:null,X:null,y:Oo,Y:zo,Z:Lo,"%":as},x={a:function(t){return o[t.getUTCDay()]},A:function(t){return a[t.getUTCDay()]},b:function(t){return c[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:Po,e:Po,f:qo,g:es,G:rs,H:jo,I:Uo,j:Wo,L:Vo,m:Go,M:Ho,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:os,s:ss,S:Yo,u:Xo,U:Ko,V:Zo,w:Qo,W:Jo,x:null,X:null,y:ts,Y:ns,Z:is,"%":as},w={a:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(t,e,n){var r=y.exec(e.slice(n));return r?(t.m=v.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(t,e,n){var r=g.exec(e.slice(n));return r?(t.m=m.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(t,n,r){return S(t,e,n,r)},d:co,e:co,f:go,g:io,G:ro,H:lo,I:lo,j:uo,L:po,m:so,M:ho,p:function(t,e,n){var r=u.exec(e.slice(n));return r?(t.p=l.get(r[0].toLowerCase()),n+r[0].length):-1},q:oo,Q:yo,s:vo,S:fo,u:Ja,U:to,V:eo,w:Qa,W:no,x:function(t,e,r){return S(t,n,e,r)},X:function(t,e,n){return S(t,r,e,n)},y:io,Y:ro,Z:ao,"%":mo};function k(t,e){return function(n){var r,i,a,o=[],s=-1,c=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===t.charCodeAt(s)&&(o.push(t.slice(c,s)),null!=(i=qa[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(a=e[r])&&(r=a(n,i)),o.push(r),c=s+1);return o.push(t.slice(c,s)),o.join("")}}function _(t,e){return function(n){var r,i,a=Ba(1900,void 0,1);if(S(a,t,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("s"in a)return new Date(1e3*a.s+("L"in a?a.L:0));if(e&&!("Z"in a)&&(a.Z=0),"p"in a&&(a.H=a.H%12+12*a.p),void 0===a.m&&(a.m="q"in a?a.q:0),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(i=(r=za(Ba(a.y,0,1))).getUTCDay(),r=i>4||0===i?li.ceil(r):li(r),r=Qr.offset(r,7*(a.V-1)),a.y=r.getUTCFullYear(),a.m=r.getUTCMonth(),a.d=r.getUTCDate()+(a.w+6)%7):(i=(r=Ra(Ba(a.y,0,1))).getDay(),r=i>4||0===i?ni.ceil(r):ni(r),r=Zr.offset(r,7*(a.V-1)),a.y=r.getFullYear(),a.m=r.getMonth(),a.d=r.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),i="Z"in a?za(Ba(a.y,0,1)).getUTCDay():Ra(Ba(a.y,0,1)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(i+5)%7:a.w+7*a.U-(i+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,za(a)):Ra(a)}}function S(t,e,n,r){for(var i,a,o=0,s=e.length,c=n.length;o<s;){if(r>=c)return-1;if(37===(i=e.charCodeAt(o++))){if(i=e.charAt(o++),!(a=w[i in qa?e.charAt(o++):i])||(r=a(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=k(n,b),b.X=k(r,b),b.c=k(e,b),x.x=k(n,x),x.X=k(r,x),x.c=k(e,x),{format:function(t){var e=k(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=_(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=k(t+="",x);return e.toString=function(){return t},e},utcParse:function(t){var e=_(t+="",!0);return e.toString=function(){return t},e}}}var Pa,ja,Ua,Wa,Va,qa={"-":"",_:" ",0:"0"},Ga=/^\s*\d+/,Ha=/^%/,Ya=/[\\^$*+?|[\]().{}]/g;function Xa(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function Ka(t){return t.replace(Ya,"\\$&")}function $a(t){return new RegExp("^(?:"+t.map(Ka).join("|")+")","i")}function Za(t){return new Map(t.map(((t,e)=>[t.toLowerCase(),e])))}function Qa(t,e,n){var r=Ga.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Ja(t,e,n){var r=Ga.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function to(t,e,n){var r=Ga.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function eo(t,e,n){var r=Ga.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function no(t,e,n){var r=Ga.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function ro(t,e,n){var r=Ga.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function io(t,e,n){var r=Ga.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function ao(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function oo(t,e,n){var r=Ga.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function so(t,e,n){var r=Ga.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function co(t,e,n){var r=Ga.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function uo(t,e,n){var r=Ga.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function lo(t,e,n){var r=Ga.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function ho(t,e,n){var r=Ga.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function fo(t,e,n){var r=Ga.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function po(t,e,n){var r=Ga.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function go(t,e,n){var r=Ga.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function mo(t,e,n){var r=Ha.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function yo(t,e,n){var r=Ga.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function vo(t,e,n){var r=Ga.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function bo(t,e){return Xa(t.getDate(),e,2)}function xo(t,e){return Xa(t.getHours(),e,2)}function wo(t,e){return Xa(t.getHours()%12||12,e,2)}function ko(t,e){return Xa(1+Zr.count(mi(t),t),e,3)}function _o(t,e){return Xa(t.getMilliseconds(),e,3)}function So(t,e){return _o(t,e)+"000"}function Ao(t,e){return Xa(t.getMonth()+1,e,2)}function Co(t,e){return Xa(t.getMinutes(),e,2)}function Eo(t,e){return Xa(t.getSeconds(),e,2)}function To(t){var e=t.getDay();return 0===e?7:e}function No(t,e){return Xa(ei.count(mi(t)-1,t),e,2)}function Do(t){var e=t.getDay();return e>=4||0===e?ai(t):ai.ceil(t)}function Fo(t,e){return t=Do(t),Xa(ai.count(mi(t),t)+(4===mi(t).getDay()),e,2)}function Io(t){return t.getDay()}function Mo(t,e){return Xa(ni.count(mi(t)-1,t),e,2)}function Oo(t,e){return Xa(t.getFullYear()%100,e,2)}function Ro(t,e){return Xa((t=Do(t)).getFullYear()%100,e,2)}function zo(t,e){return Xa(t.getFullYear()%1e4,e,4)}function Bo(t,e){var n=t.getDay();return Xa((t=n>=4||0===n?ai(t):ai.ceil(t)).getFullYear()%1e4,e,4)}function Lo(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Xa(e/60|0,"0",2)+Xa(e%60,"0",2)}function Po(t,e){return Xa(t.getUTCDate(),e,2)}function jo(t,e){return Xa(t.getUTCHours(),e,2)}function Uo(t,e){return Xa(t.getUTCHours()%12||12,e,2)}function Wo(t,e){return Xa(1+Qr.count(yi(t),t),e,3)}function Vo(t,e){return Xa(t.getUTCMilliseconds(),e,3)}function qo(t,e){return Vo(t,e)+"000"}function Go(t,e){return Xa(t.getUTCMonth()+1,e,2)}function Ho(t,e){return Xa(t.getUTCMinutes(),e,2)}function Yo(t,e){return Xa(t.getUTCSeconds(),e,2)}function Xo(t){var e=t.getUTCDay();return 0===e?7:e}function Ko(t,e){return Xa(ui.count(yi(t)-1,t),e,2)}function $o(t){var e=t.getUTCDay();return e>=4||0===e?fi(t):fi.ceil(t)}function Zo(t,e){return t=$o(t),Xa(fi.count(yi(t),t)+(4===yi(t).getUTCDay()),e,2)}function Qo(t){return t.getUTCDay()}function Jo(t,e){return Xa(li.count(yi(t)-1,t),e,2)}function ts(t,e){return Xa(t.getUTCFullYear()%100,e,2)}function es(t,e){return Xa((t=$o(t)).getUTCFullYear()%100,e,2)}function ns(t,e){return Xa(t.getUTCFullYear()%1e4,e,4)}function rs(t,e){var n=t.getUTCDay();return Xa((t=n>=4||0===n?fi(t):fi.ceil(t)).getUTCFullYear()%1e4,e,4)}function is(){return"+0000"}function as(){return"%"}function os(t){return+t}function ss(t){return Math.floor(+t/1e3)}function cs(t){const e={};return n=>e[n]||(e[n]=t(n))}function us(t){const e=cs(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(t){const n=Ar(t||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(t,e){return n=>{const r=t(n),i=r.indexOf(e);if(i<0)return r;let a=function(t,e){let n,r=t.lastIndexOf("e");if(r>0)return r;for(r=t.length;--r>e;)if(n=t.charCodeAt(r),n>=48&&n<=57)return r+1}(r,i);const o=a<r.length?r.slice(a):"";for(;--a>i;)if("0"!==r[a]){++a;break}return r.slice(0,a)+o}}(e(n),e(".1f")(1)[1])}return e(n)},formatSpan(t,r,i,a){a=Ar(null==a?",f":a);const o=function(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?kr(e,t,n):kr(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}(t,r,i),s=Math.max(Math.abs(t),Math.abs(r));let c;if(null==a.precision)switch(a.type){case"s":return isNaN(c=Nr(o,s))||(a.precision=c),n(a,s);case"":case"e":case"g":case"p":case"r":isNaN(c=Dr(o,s))||(a.precision=c-("e"===a.type));break;case"f":case"%":isNaN(c=Fr(o))||(a.precision=c-2*("%"===a.type))}return e(a)}}}let ls,hs;function ds(){return ls=us({format:zr,formatPrefix:Br})}function fs(t){return us(jr(t))}function ps(t){return arguments.length?ls=fs(t):ls}function gs(t,e,n){sn(n=n||{})||qe("Invalid time multi-format specifier: ".concat(n));const r=e(qi),i=e(Vi),a=e(Wi),o=e(Pi),s=e(Li),c=e(Bi),u=e(zi),l=e(Ri),h=t(n[Gi]||".%L"),d=t(n[qi]||":%S"),f=t(n[Vi]||"%I:%M"),p=t(n[Wi]||"%I %p"),g=t(n[Pi]||n[ji]||"%a %d"),m=t(n[Li]||"%b %d"),y=t(n[Bi]||"%B"),v=t(n[zi]||"%B"),b=t(n[Ri]||"%Y");return t=>(r(t)<t?h:i(t)<t?d:a(t)<t?f:o(t)<t?p:c(t)<t?s(t)<t?g:m:l(t)<t?u(t)<t?y:v:b)(t)}function ms(t){const e=cs(t.format),n=cs(t.utcFormat);return{timeFormat:t=>qn(t)?e(t):gs(e,ma,t),utcFormat:t=>qn(t)?n(t):gs(n,ya,t),timeParse:cs(t.parse),utcParse:cs(t.utcParse)}}function ys(){return hs=ms({format:ja,parse:Ua,utcFormat:Wa,utcParse:Va})}function vs(t){return ms(La(t))}function bs(t){return arguments.length?hs=vs(t):hs}!function(t){Pa=La(t),ja=Pa.format,Ua=Pa.parse,Wa=Pa.utcFormat,Va=Pa.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),ds(),ys();const xs=(t,e)=>On({},t,e);function ws(t,e){const n=arguments.length;return n&&2!==n&&qe("defaultLocale expects either zero or two arguments."),n?xs(ps(t),bs(e)):xs(ps(),bs())}const ks=/^(data:|([A-Za-z]+:)?\/\/)/,_s=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Ss=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,As="file://";async function Cs(t,e){const n=await this.sanitize(t,e),r=n.href;return n.localFile?this.file(r):this.http(r,e)}async function Es(t,e){e=On({},this.options,e);const n=this.fileAccess,r={href:null};let i,a,o;const s=_s.test(t.replace(Ss,""));null!=t&&"string"===typeof t&&s||qe("Sanitize failure, invalid URI: "+Xn(t));const c=ks.test(t);return(o=e.baseURL)&&!c&&(t.startsWith("/")||o.endsWith("/")||(t="/"+t),t=o+t),a=(i=t.startsWith(As))||"file"===e.mode||"http"!==e.mode&&!c&&n,i?t=t.slice(As.length):t.startsWith("//")&&("file"===e.defaultProtocol?(t=t.slice(2),a=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(r,"localFile",{value:!!a}),r.href=t,e.target&&(r.target=e.target+""),e.rel&&(r.rel=e.rel+""),"image"===e.context&&e.crossOrigin&&(r.crossOrigin=e.crossOrigin+""),r}function Ts(t){return t?e=>new Promise(((n,r)=>{t.readFile(e,((t,e)=>{t?r(t):n(e)}))})):Ns}async function Ns(){qe("No file system access.")}function Ds(t){return t?async function(e,n){const r=On({},this.options.http,n),i=n&&n.response,a=await t(e,r);return a.ok?An(a[i])?a[i]():a.text():qe(a.status+""+a.statusText)}:Fs}async function Fs(){qe("No HTTP fetch method available.")}const Is=t=>null!=t&&t===t,Ms=t=>!Number.isNaN(+t)&&!(t instanceof Date),Os={boolean:Kn,integer:dn,number:dn,date:Zn,string:Qn,unknown:Xe},Rs=[t=>"true"===t||"false"===t||!0===t||!1===t,t=>Ms(t)&&Number.isInteger(+t),Ms,t=>!Number.isNaN(Date.parse(t))],zs=["boolean","integer","number","date"];function Bs(t,e){return e.reduce(((e,n)=>(e[n]=function(t,e){if(!t||!t.length)return"unknown";const n=t.length,r=Rs.length,i=Rs.map(((t,e)=>e+1));for(let a,o,s=0,c=0;s<n;++s)for(o=e?t[s][e]:t[s],a=0;a<r;++a)if(i[a]&&Is(o)&&!Rs[a](o)&&(i[a]=0,++c,c===Rs.length))return"string";return zs[i.reduce(((t,e)=>0===t?e:t),0)-1]}(t,n),e)),{})}function Ls(t){const e=function(e,n){const r={delimiter:t};return Ps(e,n?On(n,r):r)};return e.responseType="text",e}function Ps(t,e){return e.header&&(t=e.header.map(Xn).join(e.delimiter)+"\n"+t),lr(e.delimiter).parse(t+"")}function js(t,e){const n=e&&e.property?He(e.property):Xe;return!sn(t)||(r=t,"function"===typeof Buffer&&An(Buffer.isBuffer)&&Buffer.isBuffer(r))?n(JSON.parse(t)):function(t,e){!on(t)&&function(t){return t&&An(t[Symbol.iterator])}(t)&&(t=[...t]);return e&&e.copy?JSON.parse(JSON.stringify(t)):t}(n(t),e);var r}Ps.responseType="text",js.responseType="json";const Us={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function Ws(t,e){let n,r,i,a;return t=js(t,e),e&&e.feature?(n=dr,i=e.feature):e&&e.mesh?(n=mr,i=e.mesh,a=Us[e.filter]):qe("Missing TopoJSON feature or mesh parameter."),r=(r=t.objects[i])?n(t,r,a):qe("Invalid TopoJSON object: "+i),r&&r.features||[r]}Ws.responseType="json";const Vs={dsv:Ps,csv:Ls(","),tsv:Ls("\t"),json:js,topojson:Ws};function qs(t,e){return arguments.length>1?(Vs[t]=e,this):Bn(Vs,t)?Vs[t]:null}function Gs(t){const e=qs(t);return e&&e.responseType||"text"}function Hs(t,e,n,r){const i=qs((e=e||{}).type||"json");return i||qe("Unknown data format type: "+e.type),t=i(t,e),e.parse&&function(t,e,n,r){if(!t.length)return;const i=bs();n=n||i.timeParse,r=r||i.utcParse;let a,o,s,c,u,l,h=t.columns||Object.keys(t[0]);"auto"===e&&(e=Bs(t,h));h=Object.keys(e);const d=h.map((t=>{const i=e[t];let a,o;if(i&&(i.startsWith("date:")||i.startsWith("utc:"))){a=i.split(/:(.+)?/,2),o=a[1],("'"===o[0]&&"'"===o[o.length-1]||'"'===o[0]&&'"'===o[o.length-1])&&(o=o.slice(1,-1));return("utc"===a[0]?r:n)(o)}if(!Os[i])throw Error("Illegal format pattern: "+t+":"+i);return Os[i]}));for(s=0,u=t.length,l=h.length;s<u;++s)for(a=t[s],c=0;c<l;++c)o=h[c],a[o]=d[c](a[o])}(t,e.parse,n,r),Bn(t,"columns")&&delete t.columns,t}const Ys=function(t,e){return n=>({options:n||{},sanitize:Es,load:Cs,fileAccess:!!e,file:Ts(e),http:Ds(t)})}("undefined"!==typeof fetch&&fetch,null);function Xs(t){const e=t||Xe,n=[],r={};return n.add=t=>{const i=e(t);return r[i]||(r[i]=1,n.push(t)),n},n.remove=t=>{const i=e(t);if(r[i]){r[i]=0;const e=n.indexOf(t);e>=0&&n.splice(e,1)}return n},n}async function Ks(t,e){try{await e(t)}catch(n){t.error(n)}}const $s=Symbol("vega_id");let Zs=1;function Qs(t){return!(!t||!Js(t))}function Js(t){return t[$s]}function tc(t,e){return t[$s]=e,t}function ec(t){const e=t===Object(t)?t:{data:t};return Js(e)?e:tc(e,Zs++)}function nc(t){return rc(t,ec({}))}function rc(t,e){for(const n in t)e[n]=t[n];return e}function ic(t,e){return tc(e,Js(t))}function ac(t,e){return t?e?(n,r)=>t(n,r)||Js(e(n))-Js(e(r)):(e,n)=>t(e,n)||Js(e)-Js(n):null}function oc(t){return t&&t.constructor===sc}function sc(){const t=[],e=[],n=[],r=[],i=[];let a=null,o=!1;return{constructor:sc,insert(e){const n=Sn(e),r=n.length;for(let i=0;i<r;++i)t.push(n[i]);return this},remove(t){const n=An(t)?r:e,i=Sn(t),a=i.length;for(let e=0;e<a;++e)n.push(i[e]);return this},modify(t,e,r){const a={field:e,value:In(r)};return An(t)?(a.filter=t,i.push(a)):(a.tuple=t,n.push(a)),this},encode(t,e){return An(t)?i.push({filter:t,field:e}):n.push({tuple:t,field:e}),this},clean(t){return a=t,this},reflow(){return o=!0,this},pulse(s,c){const u={},l={};let h,d,f,p,g,m;for(h=0,d=c.length;h<d;++h)u[Js(c[h])]=1;for(h=0,d=e.length;h<d;++h)g=e[h],u[Js(g)]=-1;for(h=0,d=r.length;h<d;++h)p=r[h],c.forEach((t=>{p(t)&&(u[Js(t)]=-1)}));for(h=0,d=t.length;h<d;++h)g=t[h],m=Js(g),u[m]?u[m]=1:s.add.push(ec(t[h]));for(h=0,d=c.length;h<d;++h)g=c[h],u[Js(g)]<0&&s.rem.push(g);function y(t,e,n){n?t[e]=n(t):s.encode=e,o||(l[Js(t)]=t)}for(h=0,d=n.length;h<d;++h)f=n[h],g=f.tuple,p=f.field,m=u[Js(g)],m>0&&(y(g,p,f.value),s.modifies(p));for(h=0,d=i.length;h<d;++h)f=i[h],p=f.filter,c.forEach((t=>{p(t)&&u[Js(t)]>0&&y(t,f.field,f.value)})),s.modifies(f.field);if(o)s.mod=e.length||r.length?c.filter((t=>u[Js(t)]>0)):c.slice();else for(m in l)s.mod.push(l[m]);return(a||null==a&&(e.length||r.length))&&s.clean(!0),s}}}const cc="_:mod:_";function uc(){Object.defineProperty(this,cc,{writable:!0,value:{}})}uc.prototype={set(t,e,n,r){const i=this,a=i[t],o=i[cc];return null!=e&&e>=0?(a[e]!==n||r)&&(a[e]=n,o[e+":"+t]=-1,o[t]=-1):(a!==n||r)&&(i[t]=n,o[t]=on(n)?1+n.length:-1),i},modified(t,e){const n=this[cc];if(!arguments.length){for(const t in n)if(n[t])return!0;return!1}if(on(t)){for(let e=0;e<t.length;++e)if(n[t[e]])return!0;return!1}return null!=e&&e>=0?e+1<n[t]||!!n[e+":"+t]:!!n[t]},clear(){return this[cc]={},this}};let lc=0;const hc=new uc;function dc(t,e,n,r){this.id=++lc,this.value=t,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,e&&(this._update=e),n&&this.parameters(n,r)}function fc(t){return function(e){const n=this.flags;return 0===arguments.length?!!(n&t):(this.flags=e?n|t:n&~t,this)}}dc.prototype={targets(){return this._targets||(this._targets=Xs(Ye))},set(t){return this.value!==t?(this.value=t,1):0},skip:fc(1),modified:fc(2),parameters(t,e,n){e=!1!==e;const r=this._argval=this._argval||new uc,i=this._argops=this._argops||[],a=[];let o,s,c,u;const l=(t,n,o)=>{o instanceof dc?(o!==this&&(e&&o.targets().add(this),a.push(o)),i.push({op:o,name:t,index:n})):r.set(t,n,o)};for(o in t)if(s=t[o],"pulse"===o)Sn(s).forEach((t=>{t instanceof dc?t!==this&&(t.targets().add(this),a.push(t)):qe("Pulse parameters must be operator instances.")})),this.source=s;else if(on(s))for(r.set(o,-1,Array(c=s.length)),u=0;u<c;++u)l(o,u,s[u]);else l(o,-1,s);return this.marshall().clear(),n&&(i.initonly=!0),a},marshall(t){const e=this._argval||hc,n=this._argops;let r,i,a,o;if(n){const s=n.length;for(i=0;i<s;++i)r=n[i],a=r.op,o=a.modified()&&a.stamp===t,e.set(r.name,r.index,a.value,o);if(n.initonly){for(i=0;i<s;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return e},detach(){const t=this._argops;let e,n,r,i;if(t)for(e=0,n=t.length;e<n;++e)r=t[e],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(t){const e=this._update;if(e){const n=this.marshall(t.stamp),r=e.call(this,n,t);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return t.StopPropagation}},run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?(this.skip(!1),e=0):e=this.evaluate(t),this.pulse=e||t}};let pc=0;function gc(t,e,n){this.id=++pc,this.value=null,n&&(this.receive=n),t&&(this._filter=t),e&&(this._apply=e)}function mc(t,e,n){return new gc(t,e,n)}gc.prototype={_filter:Ze,_apply:Xe,targets(){return this._targets||(this._targets=Xs(Ye))},consume(t){return arguments.length?(this._consume=!!t,this):!!this._consume},receive(t){if(this._filter(t)){const e=this.value=this._apply(t),n=this._targets,r=n?n.length:0;for(let t=0;t<r;++t)n[t].receive(e);this._consume&&(t.preventDefault(),t.stopPropagation())}},filter(t){const e=mc(t);return this.targets().add(e),e},apply(t){const e=mc(null,t);return this.targets().add(e),e},merge(){const t=mc();this.targets().add(t);for(let e=0,n=arguments.length;e<n;++e)arguments[e].targets().add(t);return t},throttle(t){let e=-1;return this.filter((()=>{const n=Date.now();return n-e>t?(e=n,1):0}))},debounce(t){const e=mc();return this.targets().add(mc(null,null,Mn(t,(t=>{const n=t.dataflow;e.receive(t),n&&n.run&&n.run()})))),e},between(t,e){let n=!1;return t.targets().add(mc(null,null,(()=>n=!0))),e.targets().add(mc(null,null,(()=>n=!1))),this.filter((()=>n))},detach(){this._filter=Ze,this._targets=null}};const yc={skip:!0};function vc(t,e,n,r,i,a){const o=On({},a,yc);let s,c;An(n)||(n=In(n)),void 0===r?s=e=>t.touch(n(e)):An(r)?(c=new dc(null,r,i,!1),s=e=>{c.evaluate(e);const r=n(e),i=c.value;oc(i)?t.pulse(r,i,a):t.update(r,i,o)}):s=e=>t.update(n(e),r,o),e.apply(s)}function bc(t,e,n,r,i,a){if(void 0===r)e.targets().add(n);else{const o=a||{},s=new dc(null,function(t,e){return e=An(e)?e:In(e),t?function(n,r){const i=e(n,r);return t.skip()||(t.skip(i!==this.value).value=i),i}:e}(n,r),i,!1);s.modified(o.force),s.rank=e.rank,e.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),t.connect(n,[s]))}}const xc={};function wc(t,e,n){this.dataflow=t,this.stamp=null==e?-1:e,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function kc(t,e){const n=[];return tr(t,e,(t=>n.push(t))),n}function _c(t,e){const n={};return t.visit(e,(t=>{n[Js(t)]=1})),t=>n[Js(t)]?null:t}function Sc(t,e){return t?(n,r)=>t(n,r)&&e(n,r):e}function Ac(t,e,n,r){const i=this;let a=0;this.dataflow=t,this.stamp=e,this.fields=null,this.encode=r||null,this.pulses=n;for(const o of n)if(o.stamp===e){if(o.fields){const t=i.fields||(i.fields={});for(const e in o.fields)t[e]=1}o.changed(i.ADD)&&(a|=i.ADD),o.changed(i.REM)&&(a|=i.REM),o.changed(i.MOD)&&(a|=i.MOD)}this.changes=a}function Cc(t){return t.error("Dataflow already running. Use runAsync() to chain invocations."),t}wc.prototype={StopPropagation:xc,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork(t){return new wc(this.dataflow).init(this,t)},clone(){const t=this.fork(7);return t.add=t.add.slice(),t.rem=t.rem.slice(),t.mod=t.mod.slice(),t.source&&(t.source=t.source.slice()),t.materialize(23)},addAll(){let t=this;return!t.source||t.add===t.rem||!t.rem.length&&t.source.length===t.add.length||(t=new wc(this.dataflow).init(this),t.add=t.source,t.rem=[]),t},init(t,e){const n=this;return n.stamp=t.stamp,n.encode=t.encode,!t.fields||64&e||(n.fields=t.fields),1&e?(n.addF=t.addF,n.add=t.add):(n.addF=null,n.add=[]),2&e?(n.remF=t.remF,n.rem=t.rem):(n.remF=null,n.rem=[]),4&e?(n.modF=t.modF,n.mod=t.mod):(n.modF=null,n.mod=[]),32&e?(n.srcF=null,n.source=null):(n.srcF=t.srcF,n.source=t.source,t.cleans&&(n.cleans=t.cleans)),n},runAfter(t){this.dataflow.runAfter(t)},changed(t){const e=t||7;return 1&e&&this.add.length||2&e&&this.rem.length||4&e&&this.mod.length},reflow(t){if(t)return this.fork(7).reflow();const e=this.add.length,n=this.source&&this.source.length;return n&&n!==e&&(this.mod=this.source,e&&this.filter(4,_c(this,1))),this},clean(t){return arguments.length?(this.cleans=!!t,this):this.cleans},modifies(t){const e=this.fields||(this.fields={});return on(t)?t.forEach((t=>e[t]=!0)):e[t]=!0,this},modified(t,e){const n=this.fields;return!(!e&&!this.mod.length||!n)&&(arguments.length?on(t)?t.some((t=>n[t])):n[t]:!!n)},filter(t,e){const n=this;return 1&t&&(n.addF=Sc(n.addF,e)),2&t&&(n.remF=Sc(n.remF,e)),4&t&&(n.modF=Sc(n.modF,e)),16&t&&(n.srcF=Sc(n.srcF,e)),n},materialize(t){const e=this;return 1&(t=t||7)&&e.addF&&(e.add=kc(e.add,e.addF),e.addF=null),2&t&&e.remF&&(e.rem=kc(e.rem,e.remF),e.remF=null),4&t&&e.modF&&(e.mod=kc(e.mod,e.modF),e.modF=null),16&t&&e.srcF&&(e.source=e.source.filter(e.srcF),e.srcF=null),e},visit(t,e){const n=this,r=e;if(16&t)return tr(n.source,n.srcF,r),n;1&t&&tr(n.add,n.addF,r),2&t&&tr(n.rem,n.remF,r),4&t&&tr(n.mod,n.modF,r);const i=n.source;if(8&t&&i){const t=n.add.length+n.mod.length;t===i.length||tr(i,t?_c(n,5):n.srcF,r)}return n}},jn(Ac,wc,{fork(t){const e=new wc(this.dataflow).init(this,t&this.NO_FIELDS);return void 0!==t&&(t&e.ADD&&this.visit(e.ADD,(t=>e.add.push(t))),t&e.REM&&this.visit(e.REM,(t=>e.rem.push(t))),t&e.MOD&&this.visit(e.MOD,(t=>e.mod.push(t)))),e},changed(t){return this.changes&t},modified(t){const e=this,n=e.fields;return n&&e.changes&e.MOD?on(t)?t.some((t=>n[t])):n[t]:0},filter(){qe("MultiPulse does not support filtering.")},materialize(){qe("MultiPulse does not support materialization.")},visit(t,e){const n=this,r=n.pulses,i=r.length;let a=0;if(t&n.SOURCE)for(;a<i;++a)r[a].visit(t,e);else for(;a<i;++a)r[a].stamp===n.stamp&&r[a].visit(t,e);return n}});const Ec={skip:!1,force:!1};function Tc(t){let e=[];return{clear:()=>e=[],size:()=>e.length,peek:()=>e[0],push:n=>(e.push(n),Nc(e,0,e.length-1,t)),pop:()=>{const n=e.pop();let r;return e.length?(r=e[0],e[0]=n,function(t,e,n){const r=e,i=t.length,a=t[e];let o,s=1+(e<<1);for(;s<i;)o=s+1,o<i&&n(t[s],t[o])>=0&&(s=o),t[e]=t[s],s=1+((e=s)<<1);t[e]=a,Nc(t,r,e,n)}(e,0,t)):r=n,r}}}function Nc(t,e,n,r){let i,a;const o=t[n];for(;n>e&&(a=n-1>>1,i=t[a],r(o,i)<0);)t[n]=i,n=a;return t[n]=o}function Dc(){this.logger(function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Je,r=t||tn;return{level(t){return arguments.length?(r=+t,this):r},error(){return r>=en&&n(e||"error","ERROR",arguments),this},warn(){return r>=nn&&n(e||"warn","WARN",arguments),this},info(){return r>=rn&&n(e||"log","INFO",arguments),this},debug(){return r>=an&&n(e||"log","DEBUG",arguments),this}}}()),this.logLevel(en),this._clock=0,this._rank=0,this._locale=ws();try{this._loader=Ys()}catch(t){}this._touched=Xs(Ye),this._input={},this._pulse=null,this._heap=Tc(((t,e)=>t.qrank-e.qrank)),this._postrun=[]}function Fc(t){return function(){return this._log[t].apply(this,arguments)}}function Ic(t,e){dc.call(this,t,null,e)}Dc.prototype={stamp(){return this._clock},loader(t){return arguments.length?(this._loader=t,this):this._loader},locale(t){return arguments.length?(this._locale=t,this):this._locale},logger(t){return arguments.length?(this._log=t,this):this._log},error:Fc("error"),warn:Fc("warn"),info:Fc("info"),debug:Fc("debug"),logLevel:Fc("level"),cleanThreshold:1e4,add:function(t,e,n,r){let i,a=1;return t instanceof dc?i=t:t&&t.prototype instanceof dc?i=new t:An(t)?i=new dc(null,t):(a=0,i=new dc(t,e)),this.rank(i),a&&(r=n,n=e),n&&this.connect(i,i.parameters(n,r)),this.touch(i),i},connect:function(t,e){const n=t.rank,r=e.length;for(let i=0;i<r;++i)if(n<e[i].rank)return void this.rerank(t)},rank:function(t){t.rank=++this._rank},rerank:function(t){const e=[t];let n,r,i;for(;e.length;)if(this.rank(n=e.pop()),r=n._targets)for(i=r.length;--i>=0;)e.push(n=r[i]),n===t&&qe("Cycle detected in dataflow graph.")},pulse:function(t,e,n){this.touch(t,n||Ec);const r=new wc(this,this._clock+(this._pulse?0:1)),i=t.pulse&&t.pulse.source||[];return r.target=t,this._input[t.id]=e.pulse(r,i),this},touch:function(t,e){const n=e||Ec;return this._pulse?this._enqueue(t):this._touched.add(t),n.skip&&t.skip(!0),this},update:function(t,e,n){const r=n||Ec;return(t.set(e)||r.force)&&this.touch(t,r),this},changeset:sc,ingest:function(t,e,n){return e=this.parse(e,n),this.pulse(t,this.changeset().insert(e))},parse:function(t,e){const n=this.locale();return Hs(t,e,n.timeParse,n.utcParse)},preload:async function(t,e,n){const r=this,i=r._pending||function(t){let e;const n=new Promise((t=>e=t));return n.requests=0,n.done=()=>{0===--n.requests&&(t._pending=null,e(t))},t._pending=n}(r);i.requests+=1;const a=await r.request(e,n);return r.pulse(t,r.changeset().remove(Ze).insert(a.data||[])),i.done(),a},request:async function(t,e){const n=this;let r,i=0;try{r=await n.loader().load(t,{context:"dataflow",response:Gs(e&&e.type)});try{r=n.parse(r,e)}catch(a){i=-2,n.warn("Data ingestion failed",t,a)}}catch(a){i=-1,n.warn("Loading failed",t,a)}return{data:r,status:i}},events:function(t,e,n,r){const i=this,a=mc(n,r),o=function(t){t.dataflow=i;try{a.receive(t)}catch(e){i.error(e)}finally{i.run()}};let s;s="string"===typeof t&&"undefined"!==typeof document?document.querySelectorAll(t):Sn(t);const c=s.length;for(let u=0;u<c;++u)s[u].addEventListener(e,o);return a},on:function(t,e,n,r,i){return(t instanceof dc?bc:vc)(this,t,e,n,r,i),this},evaluate:async function(t,e,n){const r=this,i=[];if(r._pulse)return Cc(r);if(r._pending&&await r._pending,e&&await Ks(r,e),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const a=++r._clock;r._pulse=new wc(r,a,t),r._touched.forEach((t=>r._enqueue(t,!0))),r._touched=Xs(Ye);let o,s,c,u=0;try{for(;r._heap.size()>0;)o=r._heap.pop(),o.rank===o.qrank?(s=o.run(r._getPulse(o,t)),s.then?s=await s:s.async&&(i.push(s.async),s=xc),s!==xc&&o._targets&&o._targets.forEach((t=>r._enqueue(t))),++u):r._enqueue(o,!0)}catch(l){r._heap.clear(),c=l}if(r._input={},r._pulse=null,r.debug("Pulse ".concat(a,": ").concat(u," operators")),c&&(r._postrun=[],r.error(c)),r._postrun.length){const t=r._postrun.sort(((t,e)=>e.priority-t.priority));r._postrun=[];for(let e=0;e<t.length;++e)await Ks(r,t[e].callback)}return n&&await Ks(r,n),i.length&&Promise.all(i).then((t=>r.runAsync(null,(()=>{t.forEach((t=>{try{t(r)}catch(l){r.error(l)}}))})))),r},run:function(t,e,n){return this._pulse?Cc(this):(this.evaluate(t,e,n),this)},runAsync:async function(t,e,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(t,e,n)).then(r,r),this._running},runAfter:function(t,e,n){if(this._pulse||e)this._postrun.push({priority:n||0,callback:t});else try{t(this)}catch(r){this.error(r)}},_enqueue:function(t,e){const n=t.stamp<this._clock;n&&(t.stamp=this._clock),(n||e)&&(t.qrank=t.rank,this._heap.push(t))},_getPulse:function(t,e){const n=t.source,r=this._clock;return n&&on(n)?new Ac(this,r,n.map((t=>t.pulse)),e):this._input[t.id]||function(t,e){if(e&&e.stamp===t.stamp)return e;t=t.fork(),e&&e!==xc&&(t.source=e.source);return t}(this._pulse,n&&n.pulse)}},jn(Ic,dc,{run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?this.skip(!1):e=this.evaluate(t),e=e||t,e.then?e=e.then((t=>this.pulse=t)):e!==t.StopPropagation&&(this.pulse=e),e},evaluate(t){const e=this.marshall(t.stamp),n=this.transform(e,t);return e.clear(),n},transform(){}});const Mc={};function Oc(t){const e=Rc(t);return e&&e.Definition||null}function Rc(t){return t=t&&t.toLowerCase(),Bn(Mc,t)?Mc[t]:null}function zc(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Bc(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function Lc(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function Pc(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zc;if(t===zc)return jc;if("function"!==typeof t)throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||0===r?r:(0===t(n,n))-(0===t(e,e))}}function jc(t,e){return(null==t||!(t>=t))-(null==e||!(e>=e))||(t<e?-1:t>e?1:0)}function Uc(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,i=arguments.length>4?arguments[4]:void 0;if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(i=void 0===i?jc:Pc(i);r>n;){if(r-n>600){const a=r-n+1,o=e-n+1,s=Math.log(a),c=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*c*(a-c)/a)*(o-a/2<0?-1:1);Uc(t,e,Math.max(n,Math.floor(e-o*c/a+u)),Math.min(r,Math.floor(e+(a-o)*c/a+u)),i)}const a=t[e];let o=n,s=r;for(Wc(t,n,e),i(t[r],a)>0&&Wc(t,n,r);o<s;){for(Wc(t,o,s),++o,--s;i(t[o],a)<0;)++o;for(;i(t[s],a)>0;)--s}0===i(t[n],a)?Wc(t,n,s):(++s,Wc(t,s,r)),s<=e&&(n=s+1),e<=s&&(r=s-1)}return t}function Wc(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function Vc(t){return null===t?NaN:+t}function qc(t,e,n){if(t=Float64Array.from(function*(t,e){if(void 0===e)for(let n of t)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(r=+r)>=r&&(yield r)}}(t,n)),(r=t.length)&&!isNaN(e=+e)){if(e<=0||r<2)return Lc(t);if(e>=1)return Bc(t);var r,i=(r-1)*e,a=Math.floor(i),o=Bc(Uc(t,a).subarray(0,a+1));return o+(Lc(t.subarray(a+1))-o)*(i-a)}}function Gc(t,e){return qc(t,.5,e)}function*Hc(t,e){if(null==e)for(let n of t)null!=n&&""!==n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)r=e(r,++n,t),null!=r&&""!==r&&(r=+r)>=r&&(yield r)}}function Yc(t,e,n){const r=Float64Array.from(Hc(t,n));return r.sort(zc),e.map((t=>function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Vc;if((r=t.length)&&!isNaN(e=+e)){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,a=Math.floor(i),o=+n(t[a],a,t);return o+(+n(t[a+1],a+1,t)-o)*(i-a)}}(r,t)))}function Xc(t,e){return Yc(t,[.25,.5,.75],e)}function Kc(t,e){const n=t.length,r=function(t,e){const n=function(t,e){let n,r=0,i=0,a=0;if(void 0===e)for(let o of t)null!=o&&(o=+o)>=o&&(n=o-i,i+=n/++r,a+=n*(o-i));else{let o=-1;for(let s of t)null!=(s=e(s,++o,t))&&(s=+s)>=s&&(n=s-i,i+=n/++r,a+=n*(s-i))}if(r>1)return a/(r-1)}(t,e);return n?Math.sqrt(n):n}(t,e),i=Xc(t,e),a=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,a)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}var $c=Math.random;function Zc(t,e,n,r){r=r||(t=>t);const i=t.length,a=new Float64Array(i);let o,s=0,c=1,u=r(t[0]),l=u,h=u+e;for(;c<i;++c){if(o=r(t[c]),o>=h){for(l=(u+l)/2;s<c;++s)a[s]=l;h=o+e,u=o}l=o}for(l=(u+l)/2;s<c;++s)a[s]=l;return n?function(t,e){const n=t.length;let r,i,a=0,o=1;for(;t[a]===t[o];)++o;for(;o<n;){for(r=o+1;t[o]===t[r];)++r;if(t[o]-t[o-1]<e){for(i=o+(a+r-o-o>>1);i<o;)t[i++]=t[o];for(;i>o;)t[i--]=t[a]}a=o,o=r}return t}(a,e+e/4):a}const Qc=Math.sqrt(2*Math.PI),Jc=Math.SQRT2;let tu=NaN;function eu(t,e){t=t||0,e=null==e?1:e;let n,r,i=0,a=0;if(tu===tu)i=tu,tu=NaN;else{do{i=2*$c()-1,a=2*$c()-1,n=i*i+a*a}while(0===n||n>1);r=Math.sqrt(-2*Math.log(n)/n),i*=r,tu=a*r}return t+i*e}function nu(t,e,n){const r=(t-(e||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*Qc)}function ru(t,e,n){const r=(t-(e=e||0))/(n=null==n?1:n),i=Math.abs(r);let a;if(i>37)a=0;else{const t=Math.exp(-i*i/2);let e;i<7.07106781186547?(e=.0352624965998911*i+.700383064443688,e=e*i+6.37396220353165,e=e*i+33.912866078383,e=e*i+112.079291497871,e=e*i+221.213596169931,e=e*i+220.206867912376,a=t*e,e=.0883883476483184*i+1.75566716318264,e=e*i+16.064177579207,e=e*i+86.7807322029461,e=e*i+296.564248779674,e=e*i+637.333633378831,e=e*i+793.826512519948,e=e*i+440.413735824752,a/=e):(e=i+.65,e=i+4/e,e=i+3/e,e=i+2/e,e=i+1/e,a=t/e/2.506628274631)}return r>0?1-a:a}function iu(t,e,n){return t<0||t>1?NaN:(e||0)+(null==n?1:n)*Jc*function(t){let e,n=-Math.log((1-t)*(1+t));n<6.25?(n-=3.125,e=-364441206401782e-35,e=e*n-16850591381820166e-35,e=128584807152564e-32+e*n,e=11157877678025181e-33+e*n,e=e*n-1333171662854621e-31,e=20972767875968562e-33+e*n,e=6637638134358324e-30+e*n,e=e*n-4054566272975207e-29,e=e*n-8151934197605472e-29,e=26335093153082323e-28+e*n,e=e*n-12975133253453532e-27,e=e*n-5415412054294628e-26,e=1.0512122733215323e-9+e*n,e=e*n-4.112633980346984e-9,e=e*n-2.9070369957882005e-8,e=4.2347877827932404e-7+e*n,e=e*n-13654692000834679e-22,e=e*n-13882523362786469e-21,e=.00018673420803405714+e*n,e=e*n-.000740702534166267,e=e*n-.006033670871430149,e=.24015818242558962+e*n,e=1.6536545626831027+e*n):n<16?(n=Math.sqrt(n)-3.25,e=2.2137376921775787e-9,e=9.075656193888539e-8+e*n,e=e*n-2.7517406297064545e-7,e=1.8239629214389228e-8+e*n,e=15027403968909828e-22+e*n,e=e*n-4013867526981546e-21,e=29234449089955446e-22+e*n,e=12475304481671779e-21+e*n,e=e*n-47318229009055734e-21,e=6828485145957318e-20+e*n,e=24031110387097894e-21+e*n,e=e*n-.0003550375203628475,e=.0009532893797373805+e*n,e=e*n-.0016882755560235047,e=.002491442096107851+e*n,e=e*n-.003751208507569241,e=.005370914553590064+e*n,e=1.0052589676941592+e*n,e=3.0838856104922208+e*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,e=-27109920616438573e-27,e=e*n-2.555641816996525e-10,e=1.5076572693500548e-9+e*n,e=e*n-3.789465440126737e-9,e=7.61570120807834e-9+e*n,e=e*n-1.496002662714924e-8,e=2.914795345090108e-8+e*n,e=e*n-6.771199775845234e-8,e=2.2900482228026655e-7+e*n,e=e*n-9.9298272942317e-7,e=4526062597223154e-21+e*n,e=e*n-1968177810553167e-20,e=7599527703001776e-20+e*n,e=e*n-.00021503011930044477,e=e*n-.00013871931833623122,e=1.0103004648645344+e*n,e=4.849906401408584+e*n):e=1/0;return e*t}(2*t-1)}function au(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>eu(n,r),pdf:t=>nu(t,n,r),cdf:t=>ru(t,n,r),icdf:t=>iu(t,n,r)};return i.mean(t).stdev(e)}function ou(t,e){const n=au();let r=0;const i={data(n){return arguments.length?(t=n,r=n?n.length:0,i.bandwidth(e)):t},bandwidth(n){return arguments.length?(!(e=n)&&t&&(e=Kc(t)),i):e},sample:()=>t[~~($c()*r)]+e*n.sample(),pdf(i){let a=0,o=0;for(;o<r;++o)a+=n.pdf((i-t[o])/e);return a/e/r},cdf(i){let a=0,o=0;for(;o<r;++o)a+=n.cdf((i-t[o])/e);return a/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(t)}function su(t,e){return t=t||0,e=null==e?1:e,Math.exp(t+eu()*e)}function cu(t,e,n){if(t<=0)return 0;e=e||0,n=null==n?1:n;const r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*Qc*t)}function uu(t,e,n){return ru(Math.log(t),e,n)}function lu(t,e,n){return Math.exp(iu(t,e,n))}function hu(t,e){return null==e&&(e=null==t?1:t,t=0),t+(e-t)*$c()}function du(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=e&&t<=n?1/(n-e):0}function fu(t,e,n){return null==n&&(n=null==e?1:e,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function pu(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=0&&t<=1?e+t*(n-e):NaN}function gu(t,e,n,r){const i=r-t*t,a=Math.abs(i)<1e-24?0:(n-t*e)/i;return[e-a*t,a]}function mu(t,e,n,r){t=t.filter((t=>{let r=e(t),i=n(t);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i})),r&&t.sort(((t,n)=>e(t)-e(n)));const i=t.length,a=new Float64Array(i),o=new Float64Array(i);let s,c,u,l=0,h=0,d=0;for(u of t)a[l]=s=+e(u),o[l]=c=+n(u),++l,h+=(s-h)/l,d+=(c-d)/l;for(l=0;l<i;++l)a[l]-=h,o[l]-=d;return[a,o,h,d]}function yu(t,e,n,r){let i,a,o=-1;for(const s of t)i=e(s),a=n(s),null!=i&&(i=+i)>=i&&null!=a&&(a=+a)>=a&&r(i,a,++o)}function vu(t,e,n,r,i){let a=0,o=0;return yu(t,e,n,((t,e)=>{const n=e-i(t),s=e-r;a+=n*n,o+=s*s})),1-a/o}function bu(t,e,n){let r=0,i=0,a=0,o=0,s=0;yu(t,e,n,((t,e)=>{++s,r+=(t-r)/s,i+=(e-i)/s,a+=(t*e-a)/s,o+=(t*t-o)/s}));const c=gu(r,i,a,o),u=t=>c[0]+c[1]*t;return{coef:c,predict:u,rSquared:vu(t,e,n,i,u)}}function xu(t,e,n){const[r,i,a,o]=mu(t,e,n),s=r.length;let c,u,l,h,d=0,f=0,p=0,g=0,m=0;for(c=0;c<s;)u=r[c],l=i[c++],h=u*u,d+=(h-d)/c,f+=(h*u-f)/c,p+=(h*h-p)/c,g+=(u*l-g)/c,m+=(h*l-m)/c;const y=p-d*d,v=d*y-f*f,b=(m*d-g*f)/v,x=(g*y-m*f)/v,w=-b*d,k=t=>b*(t-=a)*t+x*t+w+o;return{coef:[w-x*a+b*a*a+o,x-2*b*a,b],predict:k,rSquared:vu(t,e,n,o,k)}}function wu(t,e,n,r){const i=Array(t);let a,o,s,c;for(a=0;a<t;++a)i[a]=0;for(a=t-1;a>=0;--a)for(s=e[a],c=1,i[a]+=s,o=1;o<=a;++o)c*=(a+1-o)/o,i[a-o]+=s*Math.pow(n,o)*c;return i[0]+=r,i}function ku(t){return(t=1-t*t*t)*t*t}function _u(t,e,n){const r=t[e];let i=n[0],a=n[1]+1;if(!(a>=t.length))for(;e>i&&t[a]-r<=r-t[i];)n[0]=++i,n[1]=a,++a}const Su=.5*Math.PI/180;function Au(t,e,n,r){n=n||25,r=Math.max(n,r||200);const i=e=>[e,t(e)],a=e[0],o=e[1],s=o-a,c=s/r,u=[i(a)],l=[];if(n===r){for(let t=1;t<r;++t)u.push(i(a+t/n*s));return u.push(i(o)),u}l.push(i(o));for(let g=n;--g>0;)l.push(i(a+g/n*s));let h=u[0],d=l[l.length-1];const f=1/s,p=function(t,e){let n=t,r=t;const i=e.length;for(let a=0;a<i;++a){const t=e[a][1];t<n&&(n=t),t>r&&(r=t)}return 1/(r-n)}(h[1],l);for(;d;){const t=i((h[0]+d[0])/2);t[0]-h[0]>=c&&Cu(h,t,d,f,p)>Su?l.push(t):(h=d,u.push(d),l.pop()),d=l[l.length-1]}return u}function Cu(t,e,n,r,i){const a=Math.atan2(i*(n[1]-t[1]),r*(n[0]-t[0])),o=Math.atan2(i*(e[1]-t[1]),r*(e[0]-t[0]));return Math.abs(a-o)}function Eu(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function Tu(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function Nu(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Du(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length-1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Nu;for(;r>n;){if(r-n>600){const a=r-n+1,o=e-n+1,s=Math.log(a),c=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*c*(a-c)/a)*(o-a/2<0?-1:1);Du(t,e,Math.max(n,Math.floor(e-o*c/a+u)),Math.min(r,Math.floor(e+(a-o)*c/a+u)),i)}const a=t[e];let o=n,s=r;for(Fu(t,n,e),i(t[r],a)>0&&Fu(t,n,r);o<s;){for(Fu(t,o,s),++o,--s;i(t[o],a)<0;)++o;for(;i(t[s],a)>0;)--s}0===i(t[n],a)?Fu(t,n,s):(++s,Fu(t,s,r)),s<=e&&(n=s+1),e<=s&&(r=s-1)}return t}function Fu(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function Iu(t){return null===t?NaN:+t}function Mu(t,e,n){if(t=Float64Array.from(function*(t,e){if(void 0===e)for(let n of t)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(r=+r)>=r&&(yield r)}}(t,n)),r=t.length){if((e=+e)<=0||r<2)return Tu(t);if(e>=1)return Eu(t);var r,i=(r-1)*e,a=Math.floor(i),o=Eu(Du(t,a).subarray(0,a+1));return o+(Tu(t.subarray(a+1))-o)*(i-a)}}function Ou(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Iu;if(r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,a=Math.floor(i),o=+n(t[a],a,t);return o+(+n(t[a+1],a+1,t)-o)*(i-a)}}function Ru(t,e){return Mu(t,.5,e)}function zu(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a}function Bu(t){let e=t,n=t;function r(t,e,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){const a=r+i>>>1;n(t[a],e)<0?r=a+1:i=a}return r}return 1===t.length&&(e=(e,n)=>t(e)-n,n=function(t){return(e,n)=>Nu(t(e),n)}(t)),{left:r,center:function(t,n,i,a){null==i&&(i=0),null==a&&(a=t.length);const o=r(t,n,i,a-1);return o>i&&e(t[o-1],n)>-e(t[o],n)?o-1:o},right:function(t,e,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){const a=r+i>>>1;n(t[a],e)>0?i=a:r=a+1}return r}}}function Lu(t){return t&&t.length?1===t.length?t[0]:(e=t,t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}):function(){return""};var e}function Pu(t,e,n){return n||t+(e?"_"+e:"")}const ju=()=>{},Uu={init:ju,add:ju,rem:ju,idx:0},Wu={values:{init:t=>t.cell.store=!0,value:t=>t.cell.data.values(),idx:-1},count:{value:t=>t.cell.num},__count__:{value:t=>t.missing+t.valid},missing:{value:t=>t.missing},valid:{value:t=>t.valid},sum:{init:t=>t.sum=0,value:t=>t.sum,add:(t,e)=>t.sum+=+e,rem:(t,e)=>t.sum-=e},product:{init:t=>t.product=1,value:t=>t.valid?t.product:void 0,add:(t,e)=>t.product*=e,rem:(t,e)=>t.product/=e},mean:{init:t=>t.mean=0,value:t=>t.valid?t.mean:void 0,add:(t,e)=>(t.mean_d=e-t.mean,t.mean+=t.mean_d/t.valid),rem:(t,e)=>(t.mean_d=e-t.mean,t.mean-=t.valid?t.mean_d/t.valid:t.mean)},average:{value:t=>t.valid?t.mean:void 0,req:["mean"],idx:1},variance:{init:t=>t.dev=0,value:t=>t.valid>1?t.dev/(t.valid-1):void 0,add:(t,e)=>t.dev+=t.mean_d*(e-t.mean),rem:(t,e)=>t.dev-=t.mean_d*(e-t.mean),req:["mean"],idx:1},variancep:{value:t=>t.valid>1?t.dev/t.valid:void 0,req:["variance"],idx:2},stdev:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:t=>t.valid>1?Math.sqrt(t.dev/t.valid):void 0,req:["variance"],idx:2},stderr:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid*(t.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:t=>t.cell.data.distinct(t.get),req:["values"],idx:3},ci0:{value:t=>t.cell.data.ci0(t.get),req:["values"],idx:3},ci1:{value:t=>t.cell.data.ci1(t.get),req:["values"],idx:3},median:{value:t=>t.cell.data.q2(t.get),req:["values"],idx:3},q1:{value:t=>t.cell.data.q1(t.get),req:["values"],idx:3},q3:{value:t=>t.cell.data.q3(t.get),req:["values"],idx:3},min:{init:t=>t.min=void 0,value:t=>t.min=Number.isNaN(t.min)?t.cell.data.min(t.get):t.min,add:(t,e)=>{(e<t.min||void 0===t.min)&&(t.min=e)},rem:(t,e)=>{e<=t.min&&(t.min=NaN)},req:["values"],idx:4},max:{init:t=>t.max=void 0,value:t=>t.max=Number.isNaN(t.max)?t.cell.data.max(t.get):t.max,add:(t,e)=>{(e>t.max||void 0===t.max)&&(t.max=e)},rem:(t,e)=>{e>=t.max&&(t.max=NaN)},req:["values"],idx:4},argmin:{init:t=>t.argmin=void 0,value:t=>t.argmin||t.cell.data.argmin(t.get),add:(t,e,n)=>{e<t.min&&(t.argmin=n)},rem:(t,e)=>{e<=t.min&&(t.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:t=>t.argmax=void 0,value:t=>t.argmax||t.cell.data.argmax(t.get),add:(t,e,n)=>{e>t.max&&(t.argmax=n)},rem:(t,e)=>{e>=t.max&&(t.argmax=void 0)},req:["max","values"],idx:3}},Vu=Object.keys(Wu);function qu(t,e){return Wu[t](e)}function Gu(t,e){return t.idx-e.idx}function Hu(){this.valid=0,this.missing=0,this._ops.forEach((t=>t.init(this)))}function Yu(t,e){null!=t&&""!==t?t===t&&(++this.valid,this._ops.forEach((n=>n.add(this,t,e)))):++this.missing}function Xu(t,e){null!=t&&""!==t?t===t&&(--this.valid,this._ops.forEach((n=>n.rem(this,t,e)))):--this.missing}function Ku(t){return this._out.forEach((e=>t[e.out]=e.value(this))),t}function $u(t,e){const n=e||Xe,r=function(t){const e={};t.forEach((t=>e[t.name]=t));const n=t=>{t.req&&t.req.forEach((t=>{e[t]||n(e[t]=Wu[t]())}))};return t.forEach(n),Object.values(e).sort(Gu)}(t),i=t.slice().sort(Gu);function a(t){this._ops=r,this._out=i,this.cell=t,this.init()}return a.prototype.init=Hu,a.prototype.add=Yu,a.prototype.rem=Xu,a.prototype.set=Ku,a.prototype.get=n,a.fields=t.map((t=>t.out)),a}function Zu(t){this._key=t?He(t):Js,this.reset()}Vu.forEach((t=>{Wu[t]=function(t,e){return n=>On({name:t,out:n||t},Uu,e)}(t,Wu[t])}));const Qu=Zu.prototype;function Ju(t){Ic.call(this,null,t),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Qu.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},Qu.add=function(t){this._add.push(t)},Qu.rem=function(t){this._rem.push(t)},Qu.values=function(){if(this._get=null,0===this._rem.length)return this._add;const t=this._add,e=this._rem,n=this._key,r=t.length,i=e.length,a=Array(r-i),o={};let s,c,u;for(s=0;s<i;++s)o[n(e[s])]=1;for(s=0,c=0;s<r;++s)o[n(u=t[s])]?o[n(u)]=0:a[c++]=u;return this._rem=[],this._add=a},Qu.distinct=function(t){const e=this.values(),n={};let r,i=e.length,a=0;for(;--i>=0;)r=t(e[i])+"",Bn(n,r)||(n[r]=1,++a);return a},Qu.extent=function(t){if(this._get!==t||!this._ext){const e=this.values(),n=function(t,e){const n=t.length;let r,i,a,o,s,c=-1;if(null==e){for(;++c<n;)if(i=t[c],null!=i&&i>=i){r=a=i;break}if(c===n)return[-1,-1];for(o=s=c;++c<n;)i=t[c],null!=i&&(r>i&&(r=i,o=c),a<i&&(a=i,s=c))}else{for(;++c<n;)if(i=e(t[c],c,t),null!=i&&i>=i){r=a=i;break}if(c===n)return[-1,-1];for(o=s=c;++c<n;)i=e(t[c],c,t),null!=i&&(r>i&&(r=i,o=c),a<i&&(a=i,s=c))}return[o,s]}(e,t);this._ext=[e[n[0]],e[n[1]]],this._get=t}return this._ext},Qu.argmin=function(t){return this.extent(t)[0]||{}},Qu.argmax=function(t){return this.extent(t)[1]||{}},Qu.min=function(t){const e=this.extent(t)[0];return null!=e?t(e):void 0},Qu.max=function(t){const e=this.extent(t)[1];return null!=e?t(e):void 0},Qu.quartile=function(t){return this._get===t&&this._q||(this._q=Xc(this.values(),t),this._get=t),this._q},Qu.q1=function(t){return this.quartile(t)[0]},Qu.q2=function(t){return this.quartile(t)[1]},Qu.q3=function(t){return this.quartile(t)[2]},Qu.ci=function(t){return this._get===t&&this._ci||(this._ci=function(t,e,n,r){if(!t.length)return[void 0,void 0];const i=Float64Array.from(Hc(t,r)),a=i.length,o=e;let s,c,u,l;for(u=0,l=Array(o);u<o;++u){for(s=0,c=0;c<a;++c)s+=i[~~($c()*a)];l[u]=s/a}return l.sort(zc),[qc(l,n/2),qc(l,1-n/2)]}(this.values(),1e3,.05,t),this._get=t),this._ci},Qu.ci0=function(t){return this.ci(t)[0]},Qu.ci1=function(t){return this.ci(t)[1]},Ju.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Vu},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},jn(Ju,Ic,{transform(t,e){const n=this,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.modified();return n.stamp=r.stamp,n.value&&(i||e.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(t):{},e.visit(e.SOURCE,(t=>n.add(t)))):(n.value=n.value||n.init(t),e.visit(e.REM,(t=>n.rem(t))),e.visit(e.ADD,(t=>n.add(t)))),r.modifies(n._outputs),n._drop=!1!==t.drop,t.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),e.clean()&&n._drop&&r.clean(!0).runAfter((()=>this.clean())),n.changes(r)},cross(){const t=this,e=t.value,n=t._dnames,r=n.map((()=>({}))),i=n.length;function a(t){let e,a,o,s;for(e in t)for(o=t[e].tuple,a=0;a<i;++a)r[a][s=o[n[a]]]=s}a(t._prev),a(e),function a(o,s,c){const u=n[c],l=r[c++];for(const n in l){const r=o?o+"|"+n:n;s[u]=l[n],c<i?a(r,s,c):e[r]||t.cell(r,s)}}("",{},0)},init(t){const e=this._inputs=[],n=this._outputs=[],r={};function i(t){const n=Sn(je(t)),i=n.length;let a,o=0;for(;o<i;++o)r[a=n[o]]||(r[a]=1,e.push(a))}this._dims=Sn(t.groupby),this._dnames=this._dims.map((t=>{const e=Pe(t);return i(t),n.push(e),e})),this.cellkey=t.key?t.key:Lu(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const a=t.fields||[null],o=t.ops||["count"],s=t.as||[],c=a.length,u={};let l,h,d,f,p,g;for(c!==o.length&&qe("Unmatched number of fields and aggregate ops."),g=0;g<c;++g)l=a[g],h=o[g],null==l&&"count"!==h&&qe("Null aggregate field specified."),f=Pe(l),p=Pu(h,f,s[g]),n.push(p),"count"!==h?(d=u[f],d||(i(l),d=u[f]=[],d.field=l,this._measures.push(d)),"count"!==h&&(this._countOnly=!1),d.push(qu(h,p))):this._counts.push(p);return this._measures=this._measures.map((t=>$u(t,t.field))),{}},cellkey:Lu(),cell(t,e){let n=this.value[t];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[t]=this.newcell(t,e),this._adds[this._alen++]=n),n},newcell(t,e){const n={key:t,num:0,agg:null,tuple:this.newtuple(e,this._prev&&this._prev[t]),stamp:this.stamp,store:!1};if(!this._countOnly){const t=this._measures,e=t.length;n.agg=Array(e);for(let r=0;r<e;++r)n.agg[r]=new t[r](n)}return n.store&&(n.data=new Zu),n},newtuple(t,e){const n=this._dnames,r=this._dims,i=r.length,a={};for(let o=0;o<i;++o)a[n[o]]=r[o](t);return e?ic(e.tuple,a):ec(a)},clean(){const t=this.value;for(const e in t)0===t[e].num&&delete t[e]},add(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(t);const r=n.agg;for(let i=0,a=r.length;i<a;++i)r[i].add(r[i].get(t),t)},rem(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(t);const r=n.agg;for(let i=0,a=r.length;i<a;++i)r[i].rem(r[i].get(t),t)},celltuple(t){const e=t.tuple,n=this._counts;t.store&&t.data.values();for(let r=0,i=n.length;r<i;++r)e[n[r]]=t.num;if(!this._countOnly){const n=t.agg;for(let t=0,r=n.length;t<r;++t)n[t].set(e)}return e},changes(t){const e=this._adds,n=this._mods,r=this._prev,i=this._drop,a=t.add,o=t.rem,s=t.mod;let c,u,l,h;if(r)for(u in r)c=r[u],i&&!c.num||o.push(c.tuple);for(l=0,h=this._alen;l<h;++l)a.push(this.celltuple(e[l])),e[l]=null;for(l=0,h=this._mlen;l<h;++l)c=n[l],(0===c.num&&i?o:s).push(this.celltuple(c)),n[l]=null;return this._alen=this._mlen=0,this._prev=null,t}});function tl(t){Ic.call(this,null,t)}function el(t,e,n){const r=t;let i=e||[],a=n||[],o={},s=0;return{add:t=>a.push(t),remove:t=>o[r(t)]=++s,size:()=>i.length,data:(t,e)=>(s&&(i=i.filter((t=>!o[r(t)])),o={},s=0),e&&t&&i.sort(t),a.length&&(i=t?function(t,e,n,r){const i=e.length,a=n.length;if(!a)return e;if(!i)return n;const o=r||new e.constructor(i+a);let s=0,c=0,u=0;for(;s<i&&c<a;++u)o[u]=t(e[s],n[c])>0?n[c++]:e[s++];for(;s<i;++s,++u)o[u]=e[s];for(;c<a;++c,++u)o[u]=n[c];return o}(t,i,a.sort(t)):i.concat(a),a=[]),i)}}function nl(t){Ic.call(this,[],t)}function rl(t){dc.call(this,null,il,t)}function il(t){return this.value&&!t.modified()?this.value:En(t.fields,t.orders)}function al(t){Ic.call(this,null,t)}function ol(t){Ic.call(this,null,t)}tl.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},jn(tl,Ic,{transform(t,e){const n=!1!==t.interval,r=this._bins(t),i=r.start,a=r.step,o=t.as||["bin0","bin1"],s=o[0],c=o[1];let u;return u=t.modified()?(e=e.reflow(!0)).SOURCE:e.modified(je(t.field))?e.ADD_MOD:e.ADD,e.visit(u,n?t=>{const e=r(t);t[s]=e,t[c]=null==e?null:i+a*(1+(e-i)/a)}:t=>t[s]=r(t)),e.modifies(n?o:s)},_bins(t){if(this.value&&!t.modified())return this.value;const e=t.field,n=function(t){const e=t.maxbins||20,n=t.base||10,r=Math.log(n),i=t.divide||[5,2];let a,o,s,c,u,l,h=t.extent[0],d=t.extent[1];const f=t.span||d-h||Math.abs(h)||1;if(t.step)a=t.step;else if(t.steps){for(c=f/e,u=0,l=t.steps.length;u<l&&t.steps[u]<c;++u);a=t.steps[Math.max(0,u-1)]}else{for(o=Math.ceil(Math.log(e)/r),s=t.minstep||0,a=Math.max(s,Math.pow(n,Math.round(Math.log(f)/r)-o));Math.ceil(f/a)>e;)a*=n;for(u=0,l=i.length;u<l;++u)c=a/i[u],c>=s&&f/c<=e&&(a=c)}c=Math.log(a);const p=c>=0?0:1+~~(-c/r),g=Math.pow(n,-p-1);return(t.nice||void 0===t.nice)&&(c=Math.floor(h/a+g)*a,h=h<c?c-a:c,d=Math.ceil(d/a)*a),{start:h,stop:d===h?h+a:d,step:a}}(t),r=n.step;let i,a,o=n.start,s=o+Math.ceil((n.stop-o)/r)*r;null!=(i=t.anchor)&&(a=i-(o+r*Math.floor((i-o)/r)),o+=a,s+=a);const c=function(t){let n=dn(e(t));return null==n?null:n<o?-1/0:n>s?1/0:(n=Math.max(o,Math.min(n,s-r)),o+r*Math.floor(1e-14+(n-o)/r))};return c.start=o,c.stop=n.stop,c.step=r,this.value=Le(c,je(e),t.name||"bin_"+Pe(e))}}),nl.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},jn(nl,Ic,{transform(t,e){const n=e.fork(e.ALL),r=el(Js,this.value,n.materialize(n.ADD).add),i=t.sort,a=e.changed()||i&&(t.modified("sort")||e.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(a),this.value=n.source=r.data(ac(i),a),e.source&&e.source.root&&(this.value.root=e.source.root),n}}),jn(rl,dc),al.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},jn(al,Ic,{transform(t,e){const n=e=>n=>{for(var r,i=function(t,e,n){switch(e){case"upper":t=t.toUpperCase();break;case"lower":t=t.toLowerCase()}return t.match(n)}(s(n),t.case,a)||[],c=0,u=i.length;c<u;++c)o.test(r=i[c])||e(r)},r=this._parameterCheck(t,e),i=this._counts,a=this._match,o=this._stop,s=t.field,c=t.as||["text","count"],u=n((t=>i[t]=1+(i[t]||0))),l=n((t=>i[t]-=1));return r?e.visit(e.SOURCE,u):(e.visit(e.ADD,u),e.visit(e.REM,l)),this._finish(e,c)},_parameterCheck(t,e){let n=!1;return!t.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(t.stopwords||"")+"$","i"),n=!0),!t.modified("pattern")&&this._match||(this._match=new RegExp(t.pattern||"[\\w']+","g"),n=!0),(t.modified("field")||e.modified(t.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(t,e){const n=this._counts,r=this._tuples||(this._tuples={}),i=e[0],a=e[1],o=t.fork(t.NO_SOURCE|t.NO_FIELDS);let s,c,u;for(s in n)c=r[s],u=n[s]||0,!c&&u?(r[s]=c=ec({}),c[i]=s,c[a]=u,o.add.push(c)):0===u?(c&&o.rem.push(c),n[s]=null,r[s]=null):c[a]!==u&&(c[a]=u,o.mod.push(c));return o.modifies(e)}}),ol.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},jn(ol,Ic,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.as||["a","b"],i=r[0],a=r[1],o=!this.value||e.changed(e.ADD_REM)||t.modified("as")||t.modified("filter");let s=this.value;return o?(s&&(n.rem=s),s=e.materialize(e.SOURCE).source,n.add=this.value=function(t,e,n,r){for(var i,a,o=[],s={},c=t.length,u=0;u<c;++u)for(s[e]=a=t[u],i=0;i<c;++i)s[n]=t[i],r(s)&&(o.push(ec(s)),(s={})[e]=a);return o}(s,i,a,t.filter||Ze)):n.mod=s,n.source=this.value,n.modifies(r)}});const sl={kde:ou,mixture:function(t,e){let n,r=0;const i={weights(t){return arguments.length?(n=function(t){const e=[];let n,i=0;for(n=0;n<r;++n)i+=e[n]=null==t[n]?1:+t[n];for(n=0;n<r;++n)e[n]/=i;return e}(e=t||[]),i):e},distributions(n){return arguments.length?(n?(r=n.length,t=n):(r=0,t=[]),i.weights(e)):t},sample(){const e=$c();let i=t[r-1],a=n[0],o=0;for(;o<r-1;a+=n[++o])if(e<a){i=t[o];break}return i.sample()},pdf(e){let i=0,a=0;for(;a<r;++a)i+=n[a]*t[a].pdf(e);return i},cdf(e){let i=0,a=0;for(;a<r;++a)i+=n[a]*t[a].cdf(e);return i},icdf(){throw Error("Mixture icdf not supported.")}};return i.distributions(t).weights(e)},normal:au,lognormal:function(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>su(n,r),pdf:t=>cu(t,n,r),cdf:t=>uu(t,n,r),icdf:t=>lu(t,n,r)};return i.mean(t).stdev(e)},uniform:function(t,e){let n,r;const i={min(t){return arguments.length?(n=t||0,i):n},max(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>hu(n,r),pdf:t=>du(t,n,r),cdf:t=>fu(t,n,r),icdf:t=>pu(t,n,r)};return null==e&&(e=null==t?1:t,t=0),i.min(t).max(e)}},cl="function";function ul(t,e){const n=t[cl];Bn(sl,n)||qe("Unknown distribution function: "+n);const r=sl[n]();for(const i in t)"field"===i?r.data((t.from||e()).map(t[i])):"distributions"===i?r[i](t[i].map((t=>ul(t,e)))):typeof r[i]===cl&&r[i](t[i]);return r}function ll(t){Ic.call(this,null,t)}const hl=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],dl={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:hl},{name:"weights",type:"number",array:!0}]};function fl(t,e){return t?t.map(((t,n)=>e[n]||Pe(t))):null}function pl(t,e,n){const r=[],i=t=>t(c);let a,o,s,c,u,l;if(null==e)r.push(t.map(n));else for(a={},o=0,s=t.length;o<s;++o)c=t[o],u=e.map(i),l=a[u],l||(a[u]=l=[],l.dims=u,r.push(l)),l.push(n(c));return r}ll.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:hl.concat(dl)},{name:"as",type:"string",array:!0,default:["value","density"]}]},jn(ll,Ic,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=ul(t.distribution,function(t){return()=>t.materialize(t.SOURCE).source}(e)),i=t.steps||t.minsteps||25,a=t.steps||t.maxsteps||200;let o=t.method||"pdf";"pdf"!==o&&"cdf"!==o&&qe("Invalid density method: "+o),t.extent||r.data||qe("Missing density extent parameter."),o=r[o];const s=t.as||["value","density"],c=Au(o,t.extent||Rn(r.data()),i,a).map((t=>{const e={};return e[s[0]]=t[0],e[s[1]]=t[1],ec(e)}));this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}});function gl(t){Ic.call(this,null,t)}gl.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]};function ml(t){dc.call(this,null,yl,t),this.modified(!0)}function yl(t){const e=t.expr;return this.value&&!t.modified("expr")?this.value:Le((n=>e(n,t)),je(e),Pe(e))}function vl(t){Ic.call(this,[void 0,void 0],t)}function bl(t,e){dc.call(this,t),this.parent=e,this.count=0}function xl(t){Ic.call(this,{},t),this._keys=Pn();const e=this._targets=[];e.active=0,e.forEach=t=>{for(let n=0,r=e.active;n<r;++n)t(e[n],n,e)}}function wl(t){dc.call(this,null,kl,t)}function kl(t){return this.value&&!t.modified()?this.value:on(t.name)?Sn(t.name).map((t=>He(t))):He(t.name,t.as)}function _l(t){Ic.call(this,Pn(),t)}function Sl(t){Ic.call(this,[],t)}function Al(t){Ic.call(this,[],t)}function Cl(t){Ic.call(this,null,t)}function El(t){Ic.call(this,[],t)}jn(gl,Ic,{transform(t,e){if(this.value&&!t.modified()&&!e.changed())return e;const n=e.materialize(e.SOURCE).source,r=pl(e.source,t.groupby,Xe),i=t.smooth||!1,a=t.field,o=t.step||((t,e)=>Yn(Rn(t,e))/30)(n,a),s=ac(((t,e)=>a(t)-a(e))),c=t.as||"bin",u=r.length;let l,h=1/0,d=-1/0,f=0;for(;f<u;++f){const t=r[f].sort(s);l=-1;for(const e of Zc(t,o,i,a))e<h&&(h=e),e>d&&(d=e),t[++l][c]=e}return this.value={start:h,stop:d,step:o},e.reflow(!0).modifies(c)}}),jn(ml,dc),vl.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},jn(vl,Ic,{transform(t,e){const n=this.value,r=t.field,i=e.changed()||e.modified(r.fields)||t.modified("field");let a=n[0],o=n[1];if((i||null==a)&&(a=1/0,o=-1/0),e.visit(i?e.SOURCE:e.ADD,(t=>{const e=dn(r(t));null!=e&&(e<a&&(a=e),e>o&&(o=e))})),!Number.isFinite(a)||!Number.isFinite(o)){let t=Pe(r);t&&(t=' for field "'.concat(t,'"')),e.dataflow.warn("Infinite extent".concat(t,": [").concat(a,", ").concat(o,"]")),a=o=void 0}this.value=[a,o]}}),jn(bl,dc,{connect(t){return this.detachSubflow=t.detachSubflow,this.targets().add(t),t.source=this},add(t){this.count+=1,this.value.add.push(t)},rem(t){this.count-=1,this.value.rem.push(t)},mod(t){this.value.mod.push(t)},init(t){this.value.init(t,t.NO_SOURCE)},evaluate(){return this.value}}),jn(xl,Ic,{activate(t){this._targets[this._targets.active++]=t},subflow(t,e,n,r){const i=this.value;let a,o,s=Bn(i,t)&&i[t];return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(o=r||(o=this._group[t])&&o.tuple,a=n.dataflow,s=new bl(n.fork(n.NO_SOURCE),this),a.add(s).connect(e(a,t,o)),i[t]=s,this.activate(s)),s},clean(){const t=this.value;let e=0;for(const n in t)if(0===t[n].count){const r=t[n].detachSubflow;r&&r(),delete t[n],++e}if(e){const t=this._targets.filter((t=>t&&t.count>0));this.initTargets(t)}},initTargets(t){const e=this._targets,n=e.length,r=t?t.length:0;let i=0;for(;i<r;++i)e[i]=t[i];for(;i<n&&null!=e[i];++i)e[i]=null;e.active=r},transform(t,e){const n=e.dataflow,r=t.key,i=t.subflow,a=this._keys,o=t.modified("key"),s=t=>this.subflow(t,i,e);return this._group=t.group||{},this.initTargets(),e.visit(e.REM,(t=>{const e=Js(t),n=a.get(e);void 0!==n&&(a.delete(e),s(n).rem(t))})),e.visit(e.ADD,(t=>{const e=r(t);a.set(Js(t),e),s(e).add(t)})),o||e.modified(r.fields)?e.visit(e.MOD,(t=>{const e=Js(t),n=a.get(e),i=r(t);n===i?s(i).mod(t):(a.set(e,i),s(n).rem(t),s(i).add(t))})):e.changed(e.MOD)&&e.visit(e.MOD,(t=>{s(a.get(Js(t))).mod(t)})),o&&e.visit(e.REFLOW,(t=>{const e=Js(t),n=a.get(e),i=r(t);n!==i&&(a.set(e,i),s(n).rem(t),s(i).add(t))})),e.clean()?n.runAfter((()=>{this.clean(),a.clean()})):a.empty>n.cleanThreshold&&n.runAfter(a.clean),e}}),jn(wl,dc),_l.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},jn(_l,Ic,{transform(t,e){const n=e.dataflow,r=this.value,i=e.fork(),a=i.add,o=i.rem,s=i.mod,c=t.expr;let u=!0;function l(e){const n=Js(e),i=c(e,t),l=r.get(n);i&&l?(r.delete(n),a.push(e)):i||l?u&&i&&!l&&s.push(e):(r.set(n,1),o.push(e))}return e.visit(e.REM,(t=>{const e=Js(t);r.has(e)?r.delete(e):o.push(t)})),e.visit(e.ADD,(e=>{c(e,t)?a.push(e):r.set(Js(e),1)})),e.visit(e.MOD,l),t.modified()&&(u=!1,e.visit(e.REFLOW,l)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}}),Sl.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},jn(Sl,Ic,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=fl(r,t.as||[]),a=t.index||null,o=i.length;return n.rem=this.value,e.visit(e.SOURCE,(t=>{const e=r.map((e=>e(t))),s=e.reduce(((t,e)=>Math.max(t,e.length)),0);let c,u,l,h=0;for(;h<s;++h){for(u=nc(t),c=0;c<o;++c)u[i[c]]=null==(l=e[c][h])?null:l;a&&(u[a]=h),n.add.push(u)}})),this.value=n.source=n.add,a&&n.modifies(a),n.modifies(i)}}),Al.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},jn(Al,Ic,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=r.map(Pe),a=t.as||["key","value"],o=a[0],s=a[1],c=r.length;return n.rem=this.value,e.visit(e.SOURCE,(t=>{for(let e,a=0;a<c;++a)e=nc(t),e[o]=i[a],e[s]=r[a](t),n.add.push(e)})),this.value=n.source=n.add,n.modifies(a)}}),Cl.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},jn(Cl,Ic,{transform(t,e){const n=t.expr,r=t.as,i=t.modified(),a=t.initonly?e.ADD:i?e.SOURCE:e.modified(n.fields)||e.modified(r)?e.ADD_MOD:e.ADD;return i&&(e=e.materialize().reflow(!0)),t.initonly||e.modifies(r),e.visit(a,(e=>e[r]=n(e,t)))}}),jn(El,Ic,{transform(t,e){const n=e.fork(e.ALL),r=t.generator;let i,a,o,s=this.value,c=t.size-s.length;if(c>0){for(i=[];--c>=0;)i.push(o=ec(r(t))),s.push(o);n.add=n.add.length?n.materialize(n.ADD).add.concat(i):i}else a=s.slice(0,-c),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,s=s.slice(-c);return n.source=this.value=s,n}});const Tl={value:"value",median:Ru,mean:function(t,e){let n=0,r=0;if(void 0===e)for(let i of t)null!=i&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let a of t)null!=(a=e(a,++i,t))&&(a=+a)>=a&&(++n,r+=a)}if(n)return r/n},min:Tu,max:Eu},Nl=[];function Dl(t){Ic.call(this,[],t)}function Fl(t){Ju.call(this,t)}function Il(t){Ic.call(this,null,t)}function Ml(t){dc.call(this,null,Ol,t)}function Ol(t){return this.value&&!t.modified()?this.value:Gn(t.fields,t.flat)}function Rl(t){Ic.call(this,[],t),this._pending=null}function zl(t,e,n){n.forEach(ec);const r=e.fork(e.NO_FIELDS&e.NO_SOURCE);return r.rem=t.value,t.value=r.source=r.add=n,t._pending=null,r.rem.length&&r.clean(!0),r}function Bl(t){Ic.call(this,{},t)}function Ll(t){dc.call(this,null,Pl,t)}function Pl(t){if(this.value&&!t.modified())return this.value;const e=t.extents,n=e.length;let r,i,a=1/0,o=-1/0;for(r=0;r<n;++r)i=e[r],i[0]<a&&(a=i[0]),i[1]>o&&(o=i[1]);return[a,o]}function jl(t){dc.call(this,null,Ul,t)}function Ul(t){return this.value&&!t.modified()?this.value:t.values.reduce(((t,e)=>t.concat(e)),[])}function Wl(t){Ic.call(this,null,t)}function Vl(t){Ju.call(this,t)}function ql(t){xl.call(this,t)}function Gl(t){Ic.call(this,null,t)}function Hl(t){Ic.call(this,null,t)}function Yl(t){Ic.call(this,null,t)}Dl.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},jn(Dl,Ic,{transform(t,e){var n,r,i,a,o,s,c,u,l,h,d=e.fork(e.ALL),f=function(t){var e,n=t.method||Tl.value;if(null!=Tl[n])return n===Tl.value?(e=void 0!==t.value?t.value:0,()=>e):Tl[n];qe("Unrecognized imputation method: "+n)}(t),p=function(t){const e=t.field;return t=>t?e(t):NaN}(t),g=Pe(t.field),m=Pe(t.key),y=(t.groupby||[]).map(Pe),v=function(t,e,n,r){var i,a,o,s,c,u,l,h,d=t=>t(h),f=[],p=r?r.slice():[],g={},m={};for(p.forEach(((t,e)=>g[t]=e+1)),s=0,l=t.length;s<l;++s)u=n(h=t[s]),c=g[u]||(g[u]=p.push(u)),(o=m[a=(i=e?e.map(d):Nl)+""])||(o=m[a]=[],f.push(o),o.values=i),o[c-1]=h;return f.domain=p,f}(e.source,t.groupby,t.key,t.keyvals),b=[],x=this.value,w=v.domain.length;for(o=0,u=v.length;o<u;++o)for(i=(n=v[o]).values,r=NaN,c=0;c<w;++c)if(null==n[c]){for(a=v.domain[c],h={_impute:!0},s=0,l=i.length;s<l;++s)h[y[s]]=i[s];h[m]=a,h[g]=Number.isNaN(r)?r=f(n,p):r,b.push(ec(h))}return b.length&&(d.add=d.materialize(d.ADD).add.concat(b)),x.length&&(d.rem=d.materialize(d.REM).rem.concat(x)),this.value=b,d}}),Fl.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Vu},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},jn(Fl,Ju,{transform(t,e){const n=this,r=t.modified();let i;return n.value&&(r||e.modified(n._inputs,!0))?(i=n.value=r?n.init(t):{},e.visit(e.SOURCE,(t=>n.add(t)))):(i=n.value=n.value||this.init(t),e.visit(e.REM,(t=>n.rem(t))),e.visit(e.ADD,(t=>n.add(t)))),n.changes(),e.visit(e.SOURCE,(t=>{On(t,i[n.cellkey(t)].tuple)})),e.reflow(r).modifies(this._outputs)},changes(){const t=this._adds,e=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(t[n]),t[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(e[n]),e[n]=null;this._alen=this._mlen=0}}),Il.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},jn(Il,Ic,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=e.materialize(e.SOURCE).source,i=pl(r,t.groupby,t.field),a=(t.groupby||[]).map(Pe),o=t.bandwidth,s=t.cumulative?"cdf":"pdf",c=t.as||["value","density"],u=[];let l=t.extent,h=t.steps||t.minsteps||25,d=t.steps||t.maxsteps||200;"pdf"!==s&&"cdf"!==s&&qe("Invalid density method: "+s),"shared"===t.resolve&&(l||(l=Rn(r,t.field)),h=d=t.steps||d),i.forEach((e=>{const n=ou(e,o)[s],r=t.counts?e.length:1;Au(n,l||Rn(e),h,d).forEach((t=>{const n={};for(let r=0;r<a.length;++r)n[a[r]]=e.dims[r];n[c[0]]=t[0],n[c[1]]=t[1]*r,u.push(ec(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}}),jn(Ml,dc),jn(Rl,Ic,{transform(t,e){const n=e.dataflow;if(this._pending)return zl(this,e,this._pending);if(function(t){return t.modified("async")&&!(t.modified("values")||t.modified("url")||t.modified("format"))}(t))return e.StopPropagation;if(t.values)return zl(this,e,n.parse(t.values,t.format));if(t.async){const e=n.request(t.url,t.format).then((t=>(this._pending=Sn(t.data),t=>t.touch(this))));return{async:e}}return n.request(t.url,t.format).then((t=>zl(this,e,Sn(t.data))))}}),Bl.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},jn(Bl,Ic,{transform(t,e){const n=t.fields,r=t.index,i=t.values,a=null==t.default?null:t.default,o=t.modified(),s=n.length;let c,u,l,h=o?e.SOURCE:e.ADD,d=e,f=t.as;return i?(u=i.length,s>1&&!f&&qe('Multi-field lookup requires explicit "as" parameter.'),f&&f.length!==s*u&&qe('The "as" parameter has too few output field names.'),f=f||i.map(Pe),c=function(t){for(var e,o,c=0,l=0;c<s;++c)if(null==(o=r.get(n[c](t))))for(e=0;e<u;++e,++l)t[f[l]]=a;else for(e=0;e<u;++e,++l)t[f[l]]=i[e](o)}):(f||qe("Missing output field names."),c=function(t){for(var e,i=0;i<s;++i)e=r.get(n[i](t)),t[f[i]]=null==e?a:e}),o?d=e.reflow(!0):(l=n.some((t=>e.modified(t.fields))),h|=l?e.MOD:0),e.visit(h,c),d.modifies(f)}}),jn(Ll,dc),jn(jl,dc),jn(Wl,Ic,{transform(t,e){return this.modified(t.modified()),this.value=t,e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),Vl.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:Vu,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},jn(Vl,Ju,{_transform:Ju.prototype.transform,transform(t,e){return this._transform(function(t,e){const n=t.field,r=t.value,i=("count"===t.op?"__count__":t.op)||"sum",a=je(n).concat(je(r)),o=function(t,e,n){const r={},i=[];return n.visit(n.SOURCE,(e=>{const n=t(e);r[n]||(r[n]=1,i.push(n))})),i.sort(Tn),e?i.slice(0,e):i}(n,t.limit||0,e);e.changed()&&t.set("__pivot__",null,null,!0);return{key:t.key,groupby:t.groupby,ops:o.map((()=>i)),fields:o.map((t=>function(t,e,n,r){return Le((r=>e(r)===t?n(r):NaN),r,t+"")}(t,n,r,a))),as:o.map((t=>t+"")),modified:t.modified.bind(t)}}(t,e),e)}}),jn(ql,xl,{transform(t,e){const n=t.subflow,r=t.field,i=t=>this.subflow(Js(t),n,e,t);return(t.modified("field")||r&&e.modified(je(r)))&&qe("PreFacet does not support field modification."),this.initTargets(),r?(e.visit(e.MOD,(t=>{const e=i(t);r(t).forEach((t=>e.mod(t)))})),e.visit(e.ADD,(t=>{const e=i(t);r(t).forEach((t=>e.add(ec(t))))})),e.visit(e.REM,(t=>{const e=i(t);r(t).forEach((t=>e.rem(t)))}))):(e.visit(e.MOD,(t=>i(t).mod(t))),e.visit(e.ADD,(t=>i(t).add(t))),e.visit(e.REM,(t=>i(t).rem(t)))),e.clean()&&e.runAfter((()=>this.clean())),e}}),Gl.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},jn(Gl,Ic,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=fl(t.fields,t.as||[]),a=r?(t,e)=>function(t,e,n,r){for(let i=0,a=n.length;i<a;++i)e[r[i]]=n[i](t);return e}(t,e,r,i):rc;let o;return this.value?o=this.value:(e=e.addAll(),o=this.value={}),e.visit(e.REM,(t=>{const e=Js(t);n.rem.push(o[e]),o[e]=null})),e.visit(e.ADD,(t=>{const e=a(t,ec({}));o[Js(t)]=e,n.add.push(e)})),e.visit(e.MOD,(t=>{n.mod.push(a(t,o[Js(t)]))})),n}}),jn(Hl,Ic,{transform(t,e){return this.value=t.value,t.modified("value")?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}}),Yl.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};function Xl(t){Ic.call(this,null,t)}function Kl(t){Ic.call(this,[],t),this.count=0}function $l(t){Ic.call(this,null,t)}function Zl(t){Ic.call(this,null,t),this.modified(!0)}function Ql(t){Ic.call(this,null,t)}jn(Yl,Ic,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=t.as||["prob","value"];if(this.value&&!t.modified()&&!e.changed())return n.source=this.value,n;const i=pl(e.materialize(e.SOURCE).source,t.groupby,t.field),a=(t.groupby||[]).map(Pe),o=[],s=t.step||.01,c=t.probs||zu(s/2,1-1e-14,s),u=c.length;return i.forEach((t=>{const e=Yc(t,c);for(let n=0;n<u;++n){const i={};for(let e=0;e<a.length;++e)i[a[e]]=t.dims[e];i[r[0]]=c[n],i[r[1]]=e[n],o.push(ec(i))}})),this.value&&(n.rem=this.value),this.value=n.add=n.source=o,n}}),jn(Xl,Ic,{transform(t,e){let n,r;return this.value?r=this.value:(n=e=e.addAll(),r=this.value={}),t.derive&&(n=e.fork(e.NO_SOURCE),e.visit(e.REM,(t=>{const e=Js(t);n.rem.push(r[e]),r[e]=null})),e.visit(e.ADD,(t=>{const e=nc(t);r[Js(t)]=e,n.add.push(e)})),e.visit(e.MOD,(t=>{const e=r[Js(t)];for(const r in t)e[r]=t[r],n.modifies(r);n.mod.push(e)}))),n}}),Kl.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},jn(Kl,Ic,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.modified("size"),i=t.size,a=this.value.reduce(((t,e)=>(t[Js(e)]=1,t)),{});let o=this.value,s=this.count,c=0;function u(t){let e,r;o.length<i?o.push(t):(r=~~((s+1)*$c()),r<o.length&&r>=c&&(e=o[r],a[Js(e)]&&n.rem.push(e),o[r]=t)),++s}if(e.rem.length&&(e.visit(e.REM,(t=>{const e=Js(t);a[e]&&(a[e]=-1,n.rem.push(t)),--s})),o=o.filter((t=>-1!==a[Js(t)]))),(e.rem.length||r)&&o.length<i&&e.source&&(c=s=o.length,e.visit(e.SOURCE,(t=>{a[Js(t)]||u(t)})),c=-1),r&&o.length>i){const t=o.length-i;for(let e=0;e<t;++e)a[Js(o[e])]=-1,n.rem.push(o[e]);o=o.slice(t)}return e.mod.length&&e.visit(e.MOD,(t=>{a[Js(t)]&&n.mod.push(t)})),e.add.length&&e.visit(e.ADD,u),(e.add.length||c<0)&&(n.add=o.filter((t=>!a[Js(t)]))),this.count=s,this.value=n.source=o,n}}),$l.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},jn($l,Ic,{transform(t,e){if(this.value&&!t.modified())return;const n=e.materialize().fork(e.MOD),r=t.as||"data";return n.rem=this.value?e.rem.concat(this.value):e.rem,this.value=zu(t.start,t.stop,t.step||1).map((t=>{const e={};return e[r]=t,ec(e)})),n.add=e.add.concat(this.value),n}}),jn(Zl,Ic,{transform(t,e){return this.value=e.source,e.changed()?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}});const Jl=["unit0","unit1"];function th(t){Ic.call(this,Pn(),t)}function eh(t){Ic.call(this,null,t)}Ql.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:Hi,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:Jl}]},jn(Ql,Ic,{transform(t,e){const n=t.field,r=!1!==t.interval,i="utc"===t.timezone,a=this._floor(t,e),o=(i?ya:ma)(a.unit).offset,s=t.as||Jl,c=s[0],u=s[1],l=a.step;let h=a.start||1/0,d=a.stop||-1/0,f=e.ADD;return(t.modified()||e.modified(je(n)))&&(f=(e=e.reflow(!0)).SOURCE,h=1/0,d=-1/0),e.visit(f,(t=>{const e=n(t);let i,s;null==e?(t[c]=null,r&&(t[u]=null)):(t[c]=i=s=a(e),r&&(t[u]=s=o(i,l)),i<h&&(h=i),s>d&&(d=s))})),a.start=h,a.stop=d,e.modifies(r?s:c)},_floor(t,e){const n="utc"===t.timezone,{units:r,step:i}=t.units?{units:t.units,step:t.step||1}:Oa({extent:t.extent||Rn(e.materialize(e.SOURCE).source,t.field),maxbins:t.maxbins}),a=Xi(r),o=this.value||{},s=(n?fa:la)(a,i);return s.unit=hn(a),s.units=a,s.step=i,s.start=o.start,s.stop=o.stop,this.value=s}}),jn(th,Ic,{transform(t,e){const n=e.dataflow,r=t.field,i=this.value,a=t=>i.set(r(t),t);let o=!0;return t.modified("field")||e.modified(r.fields)?(i.clear(),e.visit(e.SOURCE,a)):e.changed()?(e.visit(e.REM,(t=>i.delete(r(t)))),e.visit(e.ADD,a)):o=!1,this.modified(o),i.empty>n.cleanThreshold&&n.runAfter(i.clean),e.fork()}}),jn(eh,Ic,{transform(t,e){(!this.value||t.modified("field")||t.modified("sort")||e.changed()||t.sort&&e.modified(t.sort.fields))&&(this.value=(t.sort?e.source.slice().sort(ac(t.sort)):e.source).map(t.field))}});const nh={row_number:function(){return{next:t=>t.index+1}},rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?t=n+1:t}}},dense_rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?++t:t}}},percent_rank:function(){const t=nh.rank(),e=t.next;return{init:t.init,next:t=>(e(t)-1)/(t.data.length-1)}},cume_dist:function(){let t;return{init:()=>t=0,next:e=>{const n=e.data,r=e.compare;let i=e.index;if(t<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;t=i}return(1+t)/n.length}}},ntile:function(t,e){(e=+e)>0||qe("ntile num must be greater than zero.");const n=nh.cume_dist(),r=n.next;return{init:n.init,next:t=>Math.ceil(e*r(t))}},lag:function(t,e){return e=+e||1,{next:n=>{const r=n.index-e;return r>=0?t(n.data[r]):null}}},lead:function(t,e){return e=+e||1,{next:n=>{const r=n.index+e,i=n.data;return r<i.length?t(i[r]):null}}},first_value:function(t){return{next:e=>t(e.data[e.i0])}},last_value:function(t){return{next:e=>t(e.data[e.i1-1])}},nth_value:function(t,e){return(e=+e)>0||qe("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(e-1);return r<n.i1?t(n.data[r]):null}}},prev_value:function(t){let e;return{init:()=>e=null,next:n=>{const r=t(n.data[n.index]);return null!=r?e=r:e}}},next_value:function(t){let e,n;return{init:()=>(e=null,n=-1),next:r=>{const i=r.data;return r.index<=n?e:(n=function(t,e,n){for(let r=e.length;n<r;++n){if(null!=t(e[n]))return n}return-1}(t,i,r.index))<0?(n=i.length,e=null):e=t(i[n])}}}};const rh=Object.keys(nh);function ih(t){const e=Sn(t.ops),n=Sn(t.fields),r=Sn(t.params),i=Sn(t.as),a=this.outputs=[],o=this.windows=[],s={},c={},u=[],l=[];let h=!0;function d(t){Sn(je(t)).forEach((t=>s[t]=1))}d(t.sort),e.forEach(((t,e)=>{const s=n[e],f=Pe(s),p=Pu(t,f,i[e]);if(d(s),a.push(p),Bn(nh,t))o.push(function(t,e,n,r){const i=nh[t](e,n);return{init:i.init||Ke,update:function(t,e){e[r]=i.next(t)}}}(t,n[e],r[e],p));else{if(null==s&&"count"!==t&&qe("Null aggregate field specified."),"count"===t)return void u.push(p);h=!1;let e=c[f];e||(e=c[f]=[],e.field=s,l.push(e)),e.push(qu(t,p))}})),(u.length||l.length)&&(this.cell=function(t,e,n){t=t.map((t=>$u(t,t.field)));const r={num:0,agg:null,store:!1,count:e};if(!n)for(var i=t.length,a=r.agg=Array(i),o=0;o<i;++o)a[o]=new t[o](r);if(r.store)var s=r.data=new Zu;return r.add=function(t){if(r.num+=1,!n){s&&s.add(t);for(let e=0;e<i;++e)a[e].add(a[e].get(t),t)}},r.rem=function(t){if(r.num-=1,!n){s&&s.rem(t);for(let e=0;e<i;++e)a[e].rem(a[e].get(t),t)}},r.set=function(t){let i,o;for(s&&s.values(),i=0,o=e.length;i<o;++i)t[e[i]]=r.num;if(!n)for(i=0,o=a.length;i<o;++i)a[i].set(t)},r.init=function(){r.num=0,s&&s.reset();for(let t=0;t<i;++t)a[t].init()},r}(l,u,h)),this.inputs=Object.keys(s)}const ah=ih.prototype;function oh(t){Ic.call(this,{},t),this._mlen=0,this._mods=[]}function sh(t,e,n,r){const i=r.sort,a=i&&!r.ignorePeers,o=r.frame||[null,0],s=t.data(n),c=s.length,u=a?Bu(i):null,l={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:i||In(-1)};e.init();for(let h=0;h<c;++h)ch(l,o,h,c),a&&uh(l,u),e.update(l,s[h])}function ch(t,e,n,r){t.p0=t.i0,t.p1=t.i1,t.i0=null==e[0]?0:Math.max(0,n-Math.abs(e[0])),t.i1=null==e[1]?r:Math.min(r,n+Math.abs(e[1])+1),t.index=n}function uh(t,e){const n=t.i0,r=t.i1-1,i=t.compare,a=t.data,o=a.length-1;n>0&&!i(a[n],a[n-1])&&(t.i0=e.left(a,a[n])),r<o&&!i(a[r],a[r+1])&&(t.i1=e.right(a,a[r]))}function lh(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function hh(t){this._context=t}function dh(t){return new hh(t)}function fh(){}function ph(t){this._context=t}function gh(t){return new ph(t)}function mh(t){this._context=t}function yh(t){return new mh(t)}function vh(t,e){this._basis=new hh(t),this._beta=e}ah.init=function(){this.windows.forEach((t=>t.init())),this.cell&&this.cell.init()},ah.update=function(t,e){const n=this.cell,r=this.windows,i=t.data,a=r&&r.length;let o;if(n){for(o=t.p0;o<t.i0;++o)n.rem(i[o]);for(o=t.p1;o<t.i1;++o)n.add(i[o]);n.set(e)}for(o=0;o<a;++o)r[o].update(t,e)},oh.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:rh.concat(Vu)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},jn(oh,Ic,{transform(t,e){this.stamp=e.stamp;const n=t.modified(),r=ac(t.sort),i=Lu(t.groupby),a=t=>this.group(i(t));let o=this.state;o&&!n||(o=this.state=new ih(t)),n||e.modified(o.inputs)?(this.value={},e.visit(e.SOURCE,(t=>a(t).add(t)))):(e.visit(e.REM,(t=>a(t).remove(t))),e.visit(e.ADD,(t=>a(t).add(t))));for(let s=0,c=this._mlen;s<c;++s)sh(this._mods[s],o,r,t);return this._mlen=0,this._mods=[],e.reflow(n).modifies(o.outputs)},group(t){let e=this.value[t];return e||(e=this.value[t]=el(Js),e.stamp=-1),e.stamp<this.stamp&&(e.stamp=this.stamp,this._mods[this._mlen++]=e),e}}),hh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:lh(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:lh(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},ph.prototype={areaStart:fh,areaEnd:fh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:lh(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},mh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:lh(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},vh.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],a=e[0],o=t[n]-i,s=e[n]-a,c=-1;++c<=n;)r=c/n,this._basis.point(this._beta*t[c]+(1-this._beta)*(i+r*o),this._beta*e[c]+(1-this._beta)*(a+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};const bh=function t(e){function n(t){return 1===e?new hh(t):new vh(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function xh(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function wh(t,e){this._context=t,this._k=(1-e)/6}wh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:xh(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:xh(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const kh=function t(e){function n(t){return new wh(t,e)}return n.tension=function(e){return t(+e)},n}(0);function _h(t,e){this._context=t,this._k=(1-e)/6}_h.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:xh(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Sh=function t(e){function n(t){return new _h(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Ah(t,e){this._context=t,this._k=(1-e)/6}Ah.prototype={areaStart:fh,areaEnd:fh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:xh(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Ch=function t(e){function n(t){return new Ah(t,e)}return n.tension=function(e){return t(+e)},n}(0),Eh=Math.abs,Th=Math.atan2,Nh=Math.cos,Dh=Math.max,Fh=Math.min,Ih=Math.sin,Mh=Math.sqrt,Oh=1e-12,Rh=Math.PI,zh=Rh/2,Bh=2*Rh;function Lh(t){return t>=1?zh:t<=-1?-zh:Math.asin(t)}function Ph(t,e,n){var r=t._x1,i=t._y1,a=t._x2,o=t._y2;if(t._l01_a>Oh){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>Oh){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,l=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*u+t._x1*t._l23_2a-e*t._l12_2a)/l,o=(o*u+t._y1*t._l23_2a-n*t._l12_2a)/l}t._context.bezierCurveTo(r,i,a,o,t._x2,t._y2)}function jh(t,e){this._context=t,this._alpha=e}jh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:Ph(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Uh=function t(e){function n(t){return e?new jh(t,e):new wh(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Wh(t,e){this._context=t,this._alpha=e}Wh.prototype={areaStart:fh,areaEnd:fh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Ph(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Vh=function t(e){function n(t){return e?new Wh(t,e):new Ah(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function qh(t,e){this._context=t,this._alpha=e}qh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ph(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Gh=function t(e){function n(t){return e?new qh(t,e):new _h(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Hh(t){this._context=t}function Yh(t){return new Hh(t)}function Xh(t){this._context=t}function Kh(t){return new Xh(t)}function $h(t){return t<0?-1:1}function Zh(t,e,n){var r=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(r||i<0&&-0),o=(n-t._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return($h(a)+$h(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function Qh(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Jh(t,e,n){var r=t._x0,i=t._y0,a=t._x1,o=t._y1,s=(a-r)/3;t._context.bezierCurveTo(r+s,i+s*e,a-s,o-s*n,a,o)}function td(t){this._context=t}function ed(t){this._context=new nd(t)}function nd(t){this._context=t}function rd(t){return new td(t)}function id(t){return new ed(t)}function ad(t){this._context=t}function od(t){var e,n,r=t.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(i[r-1]=o[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(o[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function sd(t){return new ad(t)}function cd(t,e){this._context=t,this._t=e}function ud(t){return new cd(t,.5)}function ld(t){return new cd(t,0)}function hd(t){return new cd(t,1)}function dd(t){return function(){return t}}function fd(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var pd,gd,md,yd,vd,bd,xd,wd,kd,_d,Sd,Ad,Cd,Ed;Hh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}},Xh.prototype={areaStart:fh,areaEnd:fh,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},td.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Jh(this,this._t0,Qh(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Jh(this,Qh(this,n=Zh(this,t,e)),n);break;default:Jh(this,this._t0,n=Zh(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(ed.prototype=Object.create(td.prototype)).point=function(t,e){td.prototype.point.call(this,e,t)},nd.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,a){this._context.bezierCurveTo(e,t,r,n,a,i)}},ad.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=od(t),i=od(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},cd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};const Td=Math.PI,Nd=2*Td,Dd=1e-6,Fd=Nd-Dd;function Id(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}class Md{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?Id:function(t){let e=Math.floor(t);if(!(e>=0))throw new Error("invalid digits: ".concat(t));if(e>15)return Id;const n=10**e;return function(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=Math.round(arguments[e]*n)/n+t[e]}}(t)}moveTo(t,e){this._append(pd||(pd=fd(["M",",",""])),this._x0=this._x1=+t,this._y0=this._y1=+e)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(gd||(gd=fd(["Z"]))))}lineTo(t,e){this._append(md||(md=fd(["L",",",""])),this._x1=+t,this._y1=+e)}quadraticCurveTo(t,e,n,r){this._append(yd||(yd=fd(["Q",",",",",",",""])),+t,+e,this._x1=+n,this._y1=+r)}bezierCurveTo(t,e,n,r,i,a){this._append(vd||(vd=fd(["C",",",",",",",",",",",""])),+t,+e,+n,+r,this._x1=+i,this._y1=+a)}arcTo(t,e,n,r,i){if(t=+t,e=+e,n=+n,r=+r,(i=+i)<0)throw new Error("negative radius: ".concat(i));let a=this._x1,o=this._y1,s=n-t,c=r-e,u=a-t,l=o-e,h=u*u+l*l;if(null===this._x1)this._append(bd||(bd=fd(["M",",",""])),this._x1=t,this._y1=e);else if(h>Dd)if(Math.abs(l*s-c*u)>Dd&&i){let d=n-a,f=r-o,p=s*s+c*c,g=d*d+f*f,m=Math.sqrt(p),y=Math.sqrt(h),v=i*Math.tan((Td-Math.acos((p+h-g)/(2*m*y)))/2),b=v/y,x=v/m;Math.abs(b-1)>Dd&&this._append(wd||(wd=fd(["L",",",""])),t+b*u,e+b*l),this._append(kd||(kd=fd(["A",",",",0,0,",",",",",""])),i,i,+(l*d>u*f),this._x1=t+x*s,this._y1=e+x*c)}else this._append(xd||(xd=fd(["L",",",""])),this._x1=t,this._y1=e);else;}arc(t,e,n,r,i,a){if(t=+t,e=+e,a=!!a,(n=+n)<0)throw new Error("negative radius: ".concat(n));let o=n*Math.cos(r),s=n*Math.sin(r),c=t+o,u=e+s,l=1^a,h=a?r-i:i-r;null===this._x1?this._append(_d||(_d=fd(["M",",",""])),c,u):(Math.abs(this._x1-c)>Dd||Math.abs(this._y1-u)>Dd)&&this._append(Sd||(Sd=fd(["L",",",""])),c,u),n&&(h<0&&(h=h%Nd+Nd),h>Fd?this._append(Ad||(Ad=fd(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),n,n,l,t-o,e-s,n,n,l,this._x1=c,this._y1=u):h>Dd&&this._append(Cd||(Cd=fd(["A",",",",0,",",",",",",",""])),n,n,+(h>=Td),l,this._x1=t+n*Math.cos(i),this._y1=e+n*Math.sin(i)))}rect(t,e,n,r){this._append(Ed||(Ed=fd(["M",",","h","v","h","Z"])),this._x0=this._x1=+t,this._y0=this._y1=+e,n=+n,+r,-n)}toString(){return this._}}function Od(){return new Md}function Rd(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(null==n)e=null;else{const t=Math.floor(n);if(!(t>=0))throw new RangeError("invalid digits: ".concat(n));e=t}return t},()=>new Md(e)}function zd(t){return t.innerRadius}function Bd(t){return t.outerRadius}function Ld(t){return t.startAngle}function Pd(t){return t.endAngle}function jd(t){return t&&t.padAngle}function Ud(t,e,n,r,i,a,o){var s=t-n,c=e-r,u=(o?a:-a)/Mh(s*s+c*c),l=u*c,h=-u*s,d=t+l,f=e+h,p=n+l,g=r+h,m=(d+p)/2,y=(f+g)/2,v=p-d,b=g-f,x=v*v+b*b,w=i-a,k=d*g-p*f,_=(b<0?-1:1)*Mh(Dh(0,w*w*x-k*k)),S=(k*b-v*_)/x,A=(-k*v-b*_)/x,C=(k*b+v*_)/x,E=(-k*v+b*_)/x,T=S-m,N=A-y,D=C-m,F=E-y;return T*T+N*N>D*D+F*F&&(S=C,A=E),{cx:S,cy:A,x01:-l,y01:-h,x11:S*(i/w-1),y11:A*(i/w-1)}}function Wd(){var t=zd,e=Bd,n=dd(0),r=null,i=Ld,a=Pd,o=jd,s=null,c=Rd(u);function u(){var u,l,h=+t.apply(this,arguments),d=+e.apply(this,arguments),f=i.apply(this,arguments)-zh,p=a.apply(this,arguments)-zh,g=Eh(p-f),m=p>f;if(s||(s=u=c()),d<h&&(l=d,d=h,h=l),d>Oh)if(g>Bh-Oh)s.moveTo(d*Nh(f),d*Ih(f)),s.arc(0,0,d,f,p,!m),h>Oh&&(s.moveTo(h*Nh(p),h*Ih(p)),s.arc(0,0,h,p,f,m));else{var y,v,b=f,x=p,w=f,k=p,_=g,S=g,A=o.apply(this,arguments)/2,C=A>Oh&&(r?+r.apply(this,arguments):Mh(h*h+d*d)),E=Fh(Eh(d-h)/2,+n.apply(this,arguments)),T=E,N=E;if(C>Oh){var D=Lh(C/h*Ih(A)),F=Lh(C/d*Ih(A));(_-=2*D)>Oh?(w+=D*=m?1:-1,k-=D):(_=0,w=k=(f+p)/2),(S-=2*F)>Oh?(b+=F*=m?1:-1,x-=F):(S=0,b=x=(f+p)/2)}var I=d*Nh(b),M=d*Ih(b),O=h*Nh(k),R=h*Ih(k);if(E>Oh){var z,B=d*Nh(x),L=d*Ih(x),P=h*Nh(w),j=h*Ih(w);if(g<Rh)if(z=function(t,e,n,r,i,a,o,s){var c=n-t,u=r-e,l=o-i,h=s-a,d=h*c-l*u;if(!(d*d<Oh))return[t+(d=(l*(e-a)-h*(t-i))/d)*c,e+d*u]}(I,M,P,j,B,L,O,R)){var U=I-z[0],W=M-z[1],V=B-z[0],q=L-z[1],G=1/Ih(function(t){return t>1?0:t<-1?Rh:Math.acos(t)}((U*V+W*q)/(Mh(U*U+W*W)*Mh(V*V+q*q)))/2),H=Mh(z[0]*z[0]+z[1]*z[1]);T=Fh(E,(h-H)/(G-1)),N=Fh(E,(d-H)/(G+1))}else T=N=0}S>Oh?N>Oh?(y=Ud(P,j,I,M,d,N,m),v=Ud(B,L,O,R,d,N,m),s.moveTo(y.cx+y.x01,y.cy+y.y01),N<E?s.arc(y.cx,y.cy,N,Th(y.y01,y.x01),Th(v.y01,v.x01),!m):(s.arc(y.cx,y.cy,N,Th(y.y01,y.x01),Th(y.y11,y.x11),!m),s.arc(0,0,d,Th(y.cy+y.y11,y.cx+y.x11),Th(v.cy+v.y11,v.cx+v.x11),!m),s.arc(v.cx,v.cy,N,Th(v.y11,v.x11),Th(v.y01,v.x01),!m))):(s.moveTo(I,M),s.arc(0,0,d,b,x,!m)):s.moveTo(I,M),h>Oh&&_>Oh?T>Oh?(y=Ud(O,R,B,L,h,-T,m),v=Ud(I,M,P,j,h,-T,m),s.lineTo(y.cx+y.x01,y.cy+y.y01),T<E?s.arc(y.cx,y.cy,T,Th(y.y01,y.x01),Th(v.y01,v.x01),!m):(s.arc(y.cx,y.cy,T,Th(y.y01,y.x01),Th(y.y11,y.x11),!m),s.arc(0,0,h,Th(y.cy+y.y11,y.cx+y.x11),Th(v.cy+v.y11,v.cx+v.x11),m),s.arc(v.cx,v.cy,T,Th(v.y11,v.x11),Th(v.y01,v.x01),!m))):s.arc(0,0,h,k,w,m):s.lineTo(O,R)}else s.moveTo(0,0);if(s.closePath(),u)return s=null,u+""||null}return u.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-Rh/2;return[Nh(r)*n,Ih(r)*n]},u.innerRadius=function(e){return arguments.length?(t="function"===typeof e?e:dd(+e),u):t},u.outerRadius=function(t){return arguments.length?(e="function"===typeof t?t:dd(+t),u):e},u.cornerRadius=function(t){return arguments.length?(n="function"===typeof t?t:dd(+t),u):n},u.padRadius=function(t){return arguments.length?(r=null==t?null:"function"===typeof t?t:dd(+t),u):r},u.startAngle=function(t){return arguments.length?(i="function"===typeof t?t:dd(+t),u):i},u.endAngle=function(t){return arguments.length?(a="function"===typeof t?t:dd(+t),u):a},u.padAngle=function(t){return arguments.length?(o="function"===typeof t?t:dd(+t),u):o},u.context=function(t){return arguments.length?(s=null==t?null:t,u):s},u}Od.prototype=Md.prototype;Array.prototype.slice;function Vd(t){return"object"===typeof t&&"length"in t?t:Array.from(t)}function qd(t){return t[0]}function Gd(t){return t[1]}function Hd(t,e){var n=dd(!0),r=null,i=Yh,a=null,o=Rd(s);function s(s){var c,u,l,h=(s=Vd(s)).length,d=!1;for(null==r&&(a=i(l=o())),c=0;c<=h;++c)!(c<h&&n(u=s[c],c,s))===d&&((d=!d)?a.lineStart():a.lineEnd()),d&&a.point(+t(u,c,s),+e(u,c,s));if(l)return a=null,l+""||null}return t="function"===typeof t?t:void 0===t?qd:dd(t),e="function"===typeof e?e:void 0===e?Gd:dd(e),s.x=function(e){return arguments.length?(t="function"===typeof e?e:dd(+e),s):t},s.y=function(t){return arguments.length?(e="function"===typeof t?t:dd(+t),s):e},s.defined=function(t){return arguments.length?(n="function"===typeof t?t:dd(!!t),s):n},s.curve=function(t){return arguments.length?(i=t,null!=r&&(a=i(r)),s):i},s.context=function(t){return arguments.length?(null==t?r=a=null:a=i(r=t),s):r},s}function Yd(t,e,n){var r=null,i=dd(!0),a=null,o=Yh,s=null,c=Rd(u);function u(u){var l,h,d,f,p,g=(u=Vd(u)).length,m=!1,y=new Array(g),v=new Array(g);for(null==a&&(s=o(p=c())),l=0;l<=g;++l){if(!(l<g&&i(f=u[l],l,u))===m)if(m=!m)h=l,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),d=l-1;d>=h;--d)s.point(y[d],v[d]);s.lineEnd(),s.areaEnd()}m&&(y[l]=+t(f,l,u),v[l]=+e(f,l,u),s.point(r?+r(f,l,u):y[l],n?+n(f,l,u):v[l]))}if(p)return s=null,p+""||null}function l(){return Hd().defined(i).curve(o).context(a)}return t="function"===typeof t?t:void 0===t?qd:dd(+t),e="function"===typeof e?e:dd(void 0===e?0:+e),n="function"===typeof n?n:void 0===n?Gd:dd(+n),u.x=function(e){return arguments.length?(t="function"===typeof e?e:dd(+e),r=null,u):t},u.x0=function(e){return arguments.length?(t="function"===typeof e?e:dd(+e),u):t},u.x1=function(t){return arguments.length?(r=null==t?null:"function"===typeof t?t:dd(+t),u):r},u.y=function(t){return arguments.length?(e="function"===typeof t?t:dd(+t),n=null,u):e},u.y0=function(t){return arguments.length?(e="function"===typeof t?t:dd(+t),u):e},u.y1=function(t){return arguments.length?(n=null==t?null:"function"===typeof t?t:dd(+t),u):n},u.lineX0=u.lineY0=function(){return l().x(t).y(e)},u.lineY1=function(){return l().x(t).y(n)},u.lineX1=function(){return l().x(r).y(e)},u.defined=function(t){return arguments.length?(i="function"===typeof t?t:dd(!!t),u):i},u.curve=function(t){return arguments.length?(o=t,null!=a&&(s=o(a)),u):o},u.context=function(t){return arguments.length?(null==t?a=s=null:s=o(a=t),u):a},u}Mh(3);const Xd={draw(t,e){const n=Mh(e/Rh);t.moveTo(n,0),t.arc(0,0,n,0,Bh)}},Kd=(Mh(1/3),Ih(Rh/10)/Ih(7*Rh/10));Ih(Bh/10),Nh(Bh/10),Mh(3),Mh(3),Mh(3),Mh(12);function $d(t,e){let n=null,r=Rd(i);function i(){let i;if(n||(n=i=r()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),i)return n=null,i+""||null}return t="function"===typeof t?t:dd(t||Xd),e="function"===typeof e?e:dd(void 0===e?64:+e),i.type=function(e){return arguments.length?(t="function"===typeof e?e:dd(e),i):t},i.size=function(t){return arguments.length?(e="function"===typeof t?t:dd(+t),i):e},i.context=function(t){return arguments.length?(n=null==t?null:t,i):n},i}function Zd(t,e){if("undefined"!==typeof document&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=t,n.height=e,n}return null}const Qd=()=>"undefined"!==typeof Image?Image:null;function Jd(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function tf(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function ef(t){let e,n,r;function i(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<0?i=e+1:a=e}while(i<a)}return i}return 2!==t.length?(e=Jd,n=(e,n)=>Jd(t(e),n),r=(e,n)=>t(e)-n):(e=t===Jd||t===tf?t:nf,n=t,r=t),{left:i,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=i(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return a>n&&r(t[a-1],e)>-r(t[a],e)?a-1:a},right:function(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<=0?i=e+1:a=e}while(i<a)}return i}}}function nf(){return 0}const rf=ef(Jd),af=rf.right,of=(rf.left,ef((function(t){return null===t?NaN:+t})).center,af),sf=Math.sqrt(50),cf=Math.sqrt(10),uf=Math.sqrt(2);function lf(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=sf?10:a>=cf?5:a>=uf?2:1;let s,c,u;return i<0?(u=Math.pow(10,-i)/o,s=Math.round(t*u),c=Math.round(e*u),s/u<t&&++s,c/u>e&&--c,u=-u):(u=Math.pow(10,i)*o,s=Math.round(t/u),c=Math.round(e/u),s*u<t&&++s,c*u>e&&--c),c<s&&.5<=n&&n<2?lf(t,e,2*n):[s,c,u]}function hf(t,e,n){if(!((n=+n)>0))return[];if((t=+t)===(e=+e))return[t];const r=e<t,[i,a,o]=r?lf(e,t,n):lf(t,e,n);if(!(a>=i))return[];const s=a-i+1,c=new Array(s);if(r)if(o<0)for(let u=0;u<s;++u)c[u]=(a-u)/-o;else for(let u=0;u<s;++u)c[u]=(a-u)*o;else if(o<0)for(let u=0;u<s;++u)c[u]=(i+u)/-o;else for(let u=0;u<s;++u)c[u]=(i+u)*o;return c}function df(t,e,n){return lf(t=+t,e=+e,n=+n)[2]}function ff(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function pf(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function gf(t){let e,n,r;function i(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<0?i=e+1:a=e}while(i<a)}return i}return 2!==t.length?(e=ff,n=(e,n)=>ff(t(e),n),r=(e,n)=>t(e)-n):(e=t===ff||t===pf?t:mf,n=t,r=t),{left:i,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=i(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return a>n&&r(t[a-1],e)>-r(t[a],e)?a-1:a},right:function(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<=0?i=e+1:a=e}while(i<a)}return i}}}function mf(){return 0}function yf(t){return null===t?NaN:+t}const vf=gf(ff),bf=vf.right,xf=(vf.left,gf(yf).center,bf);function wf(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function kf(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function _f(){}var Sf=.7,Af=1/Sf,Cf="\\s*([+-]?\\d+)\\s*",Ef="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Tf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Nf=/^#([0-9a-f]{3,8})$/,Df=new RegExp("^rgb\\(".concat(Cf,",").concat(Cf,",").concat(Cf,"\\)$")),Ff=new RegExp("^rgb\\(".concat(Tf,",").concat(Tf,",").concat(Tf,"\\)$")),If=new RegExp("^rgba\\(".concat(Cf,",").concat(Cf,",").concat(Cf,",").concat(Ef,"\\)$")),Mf=new RegExp("^rgba\\(".concat(Tf,",").concat(Tf,",").concat(Tf,",").concat(Ef,"\\)$")),Of=new RegExp("^hsl\\(".concat(Ef,",").concat(Tf,",").concat(Tf,"\\)$")),Rf=new RegExp("^hsla\\(".concat(Ef,",").concat(Tf,",").concat(Tf,",").concat(Ef,"\\)$")),zf={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Bf(){return this.rgb().formatHex()}function Lf(){return this.rgb().formatRgb()}function Pf(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Nf.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?jf(e):3===n?new Vf(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Uf(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Uf(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Df.exec(t))?new Vf(e[1],e[2],e[3],1):(e=Ff.exec(t))?new Vf(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=If.exec(t))?Uf(e[1],e[2],e[3],e[4]):(e=Mf.exec(t))?Uf(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Of.exec(t))?Kf(e[1],e[2]/100,e[3]/100,1):(e=Rf.exec(t))?Kf(e[1],e[2]/100,e[3]/100,e[4]):zf.hasOwnProperty(t)?jf(zf[t]):"transparent"===t?new Vf(NaN,NaN,NaN,0):null}function jf(t){return new Vf(t>>16&255,t>>8&255,255&t,1)}function Uf(t,e,n,r){return r<=0&&(t=e=n=NaN),new Vf(t,e,n,r)}function Wf(t,e,n,r){return 1===arguments.length?((i=t)instanceof _f||(i=Pf(i)),i?new Vf((i=i.rgb()).r,i.g,i.b,i.opacity):new Vf):new Vf(t,e,n,null==r?1:r);var i}function Vf(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function qf(){return"#".concat(Xf(this.r)).concat(Xf(this.g)).concat(Xf(this.b))}function Gf(){const t=Hf(this.opacity);return"".concat(1===t?"rgb(":"rgba(").concat(Yf(this.r),", ").concat(Yf(this.g),", ").concat(Yf(this.b)).concat(1===t?")":", ".concat(t,")"))}function Hf(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Yf(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Xf(t){return((t=Yf(t))<16?"0":"")+t.toString(16)}function Kf(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Zf(t,e,n,r)}function $f(t){if(t instanceof Zf)return new Zf(t.h,t.s,t.l,t.opacity);if(t instanceof _f||(t=Pf(t)),!t)return new Zf;if(t instanceof Zf)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new Zf(o,s,c,t.opacity)}function Zf(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Qf(t){return(t=(t||0)%360)<0?t+360:t}function Jf(t){return Math.max(0,Math.min(1,t||0))}function tp(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function ep(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}wf(_f,Pf,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Bf,formatHex:Bf,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return $f(this).formatHsl()},formatRgb:Lf,toString:Lf}),wf(Vf,Wf,kf(_f,{brighter(t){return t=null==t?Af:Math.pow(Af,t),new Vf(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?Sf:Math.pow(Sf,t),new Vf(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Vf(Yf(this.r),Yf(this.g),Yf(this.b),Hf(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:qf,formatHex:qf,formatHex8:function(){return"#".concat(Xf(this.r)).concat(Xf(this.g)).concat(Xf(this.b)).concat(Xf(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:Gf,toString:Gf})),wf(Zf,(function(t,e,n,r){return 1===arguments.length?$f(t):new Zf(t,e,n,null==r?1:r)}),kf(_f,{brighter(t){return t=null==t?Af:Math.pow(Af,t),new Zf(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Sf:Math.pow(Sf,t),new Zf(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Vf(tp(t>=240?t-240:t+120,i,r),tp(t,i,r),tp(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Zf(Qf(this.h),Jf(this.s),Jf(this.l),Hf(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Hf(this.opacity);return"".concat(1===t?"hsl(":"hsla(").concat(Qf(this.h),", ").concat(100*Jf(this.s),"%, ").concat(100*Jf(this.l),"%").concat(1===t?")":", ".concat(t,")"))}}));const np=t=>()=>t;function rp(t,e){return function(n){return t+n*e}}function ip(t){return 1===(t=+t)?ap:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):np(isNaN(e)?n:e)}}function ap(t,e){var n=e-t;return n?rp(t,n):np(isNaN(t)?e:t)}const op=function t(e){var n=ip(e);function r(t,e){var r=n((t=Wf(t)).r,(e=Wf(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=ap(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function sp(t){return function(e){var n,r,i=e.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Wf(e[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=t(a),o=t(o),s=t(s),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=s(t),r+""}}}sp((function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,s=r<e-1?t[r+2]:2*a-i;return ep((n-r/e)*e,o,i,a,s)}})),sp((function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],s=t[(r+2)%e];return ep((n-r/e)*e,i,a,o,s)}}));function cp(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=mp(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}function up(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function lp(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function hp(t,e){var n,r={},i={};for(n in null!==t&&"object"===typeof t||(t={}),null!==e&&"object"===typeof e||(e={}),e)n in t?r[n]=mp(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var dp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,fp=new RegExp(dp.source,"g");function pp(t,e){var n,r,i,a=dp.lastIndex=fp.lastIndex=0,o=-1,s=[],c=[];for(t+="",e+="";(n=dp.exec(t))&&(r=fp.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,c.push({i:o,x:lp(n,r)})),a=fp.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?c[0]?function(t){return function(e){return t(e)+""}}(c[0].x):function(t){return function(){return t}}(e):(e=c.length,function(t){for(var n,r=0;r<e;++r)s[(n=c[r]).i]=n.x(t);return s.join("")})}function gp(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(a){for(n=0;n<r;++n)i[n]=t[n]*(1-a)+e[n]*a;return i}}function mp(t,e){var n,r=typeof e;return null==e||"boolean"===r?np(e):("number"===r?lp:"string"===r?(n=Pf(e))?(e=n,op):pp:e instanceof Pf?op:e instanceof Date?up:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}(e)?gp:Array.isArray(e)?cp:"function"!==typeof e.valueOf&&"function"!==typeof e.toString||isNaN(e)?hp:lp)(t,e)}function yp(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function vp(t){return+t}var bp=[0,1];function xp(t){return t}function wp(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function kp(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=wp(i,r),a=n(o,a)):(r=wp(r,i),a=n(a,o)),function(t){return a(r(t))}}function _p(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=wp(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(e){var n=xf(t,e,1,r)-1;return a[n](i[n](e))}}function Sp(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Ap(){var t,e,n,r,i,a,o=bp,s=bp,c=mp,u=xp;function l(){var t=Math.min(o.length,s.length);return u!==xp&&(u=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(o[0],o[t-1])),r=t>2?_p:kp,i=a=null,h}function h(e){return null==e||isNaN(e=+e)?n:(i||(i=r(o.map(t),s,c)))(t(u(e)))}return h.invert=function(n){return u(e((a||(a=r(s,o.map(t),lp)))(n)))},h.domain=function(t){return arguments.length?(o=Array.from(t,vp),l()):o.slice()},h.range=function(t){return arguments.length?(s=Array.from(t),l()):s.slice()},h.rangeRound=function(t){return s=Array.from(t),c=yp,l()},h.clamp=function(t){return arguments.length?(u=!!t||xp,l()):u!==xp},h.interpolate=function(t){return arguments.length?(c=t,l()):c},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,l()}}function Cp(){return Ap()(xp,xp)}function Ep(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function Tp(t,e){switch(arguments.length){case 0:break;case 1:"function"===typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"===typeof e?this.interpolator(e):this.range(e)}return this}function Np(t,e,n,r){var i,a=function(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?df(e,t,n):df(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}(t,e,n);switch((r=Ar(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=Nr(a,o))||(r.precision=i),Br(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=Dr(a,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=Fr(a))||(r.precision=i-2*("%"===r.type))}return zr(r)}function Dp(t){var e=t.domain;return t.ticks=function(t){var n=e();return hf(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return Np(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i,a=e(),o=0,s=a.length-1,c=a[o],u=a[s],l=10;for(u<c&&(i=c,c=u,u=i,i=o,o=s,s=i);l-- >0;){if((i=df(c,u,n))===r)return a[o]=c,a[s]=u,e(a);if(i>0)c=Math.floor(c/i)*i,u=Math.ceil(u/i)*i;else{if(!(i<0))break;c=Math.ceil(c*i)/i,u=Math.floor(u*i)/i}r=i}return t},t}function Fp(){var t=Cp();return t.copy=function(){return Sp(t,Fp())},Ep.apply(t,arguments),Dp(t)}function Ip(t){var e;function n(t){return null==t||isNaN(t=+t)?e:t}return n.invert=n,n.domain=n.range=function(e){return arguments.length?(t=Array.from(e,vp),n):t.slice()},n.unknown=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return Ip(t).unknown(e)},t=arguments.length?Array.from(t,vp):[0,1],Dp(n)}function Mp(t,e){var n,r=0,i=(t=t.slice()).length-1,a=t[r],o=t[i];return o<a&&(n=r,r=i,i=n,n=a,a=o,o=n),t[r]=e.floor(a),t[i]=e.ceil(o),t}function Op(t){return Math.log(t)}function Rp(t){return Math.exp(t)}function zp(t){return-Math.log(-t)}function Bp(t){return-Math.exp(-t)}function Lp(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Pp(t){return(e,n)=>-t(-e,n)}function jp(t){const e=t(Op,Rp),n=e.domain;let r,i,a=10;function o(){return r=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}(a),i=function(t){return 10===t?Lp:t===Math.E?Math.exp:e=>Math.pow(t,e)}(a),n()[0]<0?(r=Pp(r),i=Pp(i),t(zp,Bp)):t(Op,Rp),e}return e.base=function(t){return arguments.length?(a=+t,o()):a},e.domain=function(t){return arguments.length?(n(t),o()):n()},e.ticks=t=>{const e=n();let o=e[0],s=e[e.length-1];const c=s<o;c&&([o,s]=[s,o]);let u,l,h=r(o),d=r(s);const f=null==t?10:+t;let p=[];if(!(a%1)&&d-h<f){if(h=Math.floor(h),d=Math.ceil(d),o>0){for(;h<=d;++h)for(u=1;u<a;++u)if(l=h<0?u/i(-h):u*i(h),!(l<o)){if(l>s)break;p.push(l)}}else for(;h<=d;++h)for(u=a-1;u>=1;--u)if(l=h>0?u/i(-h):u*i(h),!(l<o)){if(l>s)break;p.push(l)}2*p.length<f&&(p=hf(o,s,f))}else p=hf(h,d,Math.min(d-h,f)).map(i);return c?p.reverse():p},e.tickFormat=(t,n)=>{if(null==t&&(t=10),null==n&&(n=10===a?"s":","),"function"!==typeof n&&(a%1||null!=(n=Ar(n)).precision||(n.trim=!0),n=zr(n)),t===1/0)return n;const o=Math.max(1,a*t/e.ticks().length);return t=>{let e=t/i(Math.round(r(t)));return e*a<a-.5&&(e*=a),e<=o?n(t):""}},e.nice=()=>n(Mp(n(),{floor:t=>i(Math.floor(r(t))),ceil:t=>i(Math.ceil(r(t)))})),e}function Up(){const t=jp(Ap()).domain([1,10]);return t.copy=()=>Sp(t,Up()).base(t.base()),Ep.apply(t,arguments),t}function Wp(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Vp(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function qp(t){return t<0?-t*t:t*t}function Gp(t){var e=t(xp,xp),n=1;return e.exponent=function(e){return arguments.length?1===(n=+e)?t(xp,xp):.5===n?t(Vp,qp):t(Wp(n),Wp(1/n)):n},Dp(e)}function Hp(){var t=Gp(Ap());return t.copy=function(){return Sp(t,Hp()).exponent(t.exponent())},Ep.apply(t,arguments),t}function Yp(){return Hp.apply(null,arguments).exponent(.5)}function Xp(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Kp(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function $p(t){var e=1,n=t(Xp(e),Kp(e));return n.constant=function(n){return arguments.length?t(Xp(e=+n),Kp(e)):e},Dp(n)}function Zp(){var t=$p(Ap());return t.copy=function(){return Sp(t,Zp()).constant(t.constant())},Ep.apply(t,arguments)}function Qp(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Jp(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function tg(){return 0}const eg=Math.sqrt(50),ng=Math.sqrt(10),rg=Math.sqrt(2);function ig(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=eg?10:a>=ng?5:a>=rg?2:1;let s,c,u;return i<0?(u=Math.pow(10,-i)/o,s=Math.round(t*u),c=Math.round(e*u),s/u<t&&++s,c/u>e&&--c,u=-u):(u=Math.pow(10,i)*o,s=Math.round(t/u),c=Math.round(e/u),s*u<t&&++s,c*u>e&&--c),c<s&&.5<=n&&n<2?ig(t,e,2*n):[s,c,u]}function ag(t,e,n){return ig(t=+t,e=+e,n=+n)[2]}function og(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?ag(e,t,n):ag(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function sg(t,e,n,r,i,a){const o=[[Si,1,qr],[Si,5,5e3],[Si,15,15e3],[Si,30,3e4],[a,1,Gr],[a,5,3e5],[a,15,9e5],[a,30,18e5],[i,1,Hr],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,Yr],[r,2,1728e5],[n,1,Xr],[e,1,Kr],[e,3,7776e6],[t,1,$r]];function s(e,n,r){const i=Math.abs(n-e)/r,a=function(t){let e,n,r;function i(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<0?i=e+1:a=e}while(i<a)}return i}return 2!==t.length?(e=Qp,n=(e,n)=>Qp(t(e),n),r=(e,n)=>t(e)-n):(e=t===Qp||t===Jp?t:tg,n=t,r=t),{left:i,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=i(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return a>n&&r(t[a-1],e)>-r(t[a],e)?a-1:a},right:function(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<=0?i=e+1:a=e}while(i<a)}return i}}}((t=>{let[,,e]=t;return e})).right(o,i);if(a===o.length)return t.every(og(e/$r,n/$r,r));if(0===a)return Ai.every(Math.max(og(e,n,r),1));const[s,c]=o[i/o[a-1][2]<o[a][2]/i?a-1:a];return s.every(c)}return[function(t,e,n){const r=e<t;r&&([t,e]=[e,t]);const i=n&&"function"===typeof n.range?n:s(t,e,n),a=i?i.range(t,+e+1):[];return r?a.reverse():a},s]}const[cg,ug]=sg(yi,bi,ui,Jr,wi,_i),[lg,hg]=sg(mi,vi,ei,Zr,xi,ki);function dg(t){return new Date(t)}function fg(t){return t instanceof Date?+t:+new Date(+t)}function pg(t,e,n,r,i,a,o,s,c,u){var l=Cp(),h=l.invert,d=l.domain,f=u(".%L"),p=u(":%S"),g=u("%I:%M"),m=u("%I %p"),y=u("%a %d"),v=u("%b %d"),b=u("%B"),x=u("%Y");function w(t){return(c(t)<t?f:s(t)<t?p:o(t)<t?g:a(t)<t?m:r(t)<t?i(t)<t?y:v:n(t)<t?b:x)(t)}return l.invert=function(t){return new Date(h(t))},l.domain=function(t){return arguments.length?d(Array.from(t,fg)):d().map(dg)},l.ticks=function(e){var n=d();return t(n[0],n[n.length-1],null==e?10:e)},l.tickFormat=function(t,e){return null==e?w:u(e)},l.nice=function(t){var n=d();return t&&"function"===typeof t.range||(t=e(n[0],n[n.length-1],null==t?10:t)),t?d(Mp(n,t)):l},l.copy=function(){return Sp(l,pg(t,e,n,r,i,a,o,s,c,u))},l}function gg(){return Ep.apply(pg(lg,hg,mi,vi,ei,Zr,xi,ki,Si,ja).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function mg(){return Ep.apply(pg(cg,ug,yi,bi,ui,Qr,wi,_i,Si,Wa).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function yg(){var t,e,n,r,i,a=0,o=1,s=xp,c=!1;function u(e){return null==e||isNaN(e=+e)?i:s(0===n?.5:(e=(r(e)-t)*n,c?Math.max(0,Math.min(1,e)):e))}function l(t){return function(e){var n,r;return arguments.length?([n,r]=e,s=t(n,r),u):[s(0),s(1)]}}return u.domain=function(i){return arguments.length?([a,o]=i,t=r(a=+a),e=r(o=+o),n=t===e?0:1/(e-t),u):[a,o]},u.clamp=function(t){return arguments.length?(c=!!t,u):c},u.interpolator=function(t){return arguments.length?(s=t,u):s},u.range=l(mp),u.rangeRound=l(yp),u.unknown=function(t){return arguments.length?(i=t,u):i},function(i){return r=i,t=i(a),e=i(o),n=t===e?0:1/(e-t),u}}function vg(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function bg(){var t=Dp(yg()(xp));return t.copy=function(){return vg(t,bg())},Tp.apply(t,arguments)}function xg(){var t=jp(yg()).domain([1,10]);return t.copy=function(){return vg(t,xg()).base(t.base())},Tp.apply(t,arguments)}function wg(){var t=$p(yg());return t.copy=function(){return vg(t,wg()).constant(t.constant())},Tp.apply(t,arguments)}function kg(){var t=Gp(yg());return t.copy=function(){return vg(t,kg()).exponent(t.exponent())},Tp.apply(t,arguments)}function _g(){return kg.apply(null,arguments).exponent(.5)}function Sg(){var t,e,n,r,i,a,o,s=0,c=.5,u=1,l=1,h=xp,d=!1;function f(t){return isNaN(t=+t)?o:(t=.5+((t=+a(t))-e)*(l*t<l*e?r:i),h(d?Math.max(0,Math.min(1,t)):t))}function p(t){return function(e){var n,r,i;return arguments.length?([n,r,i]=e,h=function(t,e){void 0===e&&(e=t,t=mp);for(var n=0,r=e.length-1,i=e[0],a=new Array(r<0?0:r);n<r;)a[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return a[e](t-e)}}(t,[n,r,i]),f):[h(0),h(.5),h(1)]}}return f.domain=function(o){return arguments.length?([s,c,u]=o,t=a(s=+s),e=a(c=+c),n=a(u=+u),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),l=e<t?-1:1,f):[s,c,u]},f.clamp=function(t){return arguments.length?(d=!!t,f):d},f.interpolator=function(t){return arguments.length?(h=t,f):h},f.range=p(mp),f.rangeRound=p(yp),f.unknown=function(t){return arguments.length?(o=t,f):o},function(o){return a=o,t=o(s),e=o(c),n=o(u),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),l=e<t?-1:1,f}}function Ag(){var t=Dp(Sg()(xp));return t.copy=function(){return vg(t,Ag())},Tp.apply(t,arguments)}function Cg(){var t=jp(Sg()).domain([.1,1,10]);return t.copy=function(){return vg(t,Cg()).base(t.base())},Tp.apply(t,arguments)}function Eg(){var t=$p(Sg());return t.copy=function(){return vg(t,Eg()).constant(t.constant())},Tp.apply(t,arguments)}function Tg(){var t=Gp(Sg());return t.copy=function(){return vg(t,Tg()).exponent(t.exponent())},Tp.apply(t,arguments)}function Ng(){return Tg.apply(null,arguments).exponent(.5)}function Dg(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:yf;if((r=t.length)&&!isNaN(e=+e)){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,a=Math.floor(i),o=+n(t[a],a,t);return o+(+n(t[a+1],a+1,t)-o)*(i-a)}}function Fg(){var t,e=[],n=[],r=[];function i(){var t=0,i=Math.max(1,n.length);for(r=new Array(i-1);++t<i;)r[t-1]=Dg(e,t/i);return a}function a(e){return null==e||isNaN(e=+e)?t:n[xf(r,e)]}return a.invertExtent=function(t){var i=n.indexOf(t);return i<0?[NaN,NaN]:[i>0?r[i-1]:e[0],i<r.length?r[i]:e[e.length-1]]},a.domain=function(t){if(!arguments.length)return e.slice();e=[];for(let n of t)null==n||isNaN(n=+n)||e.push(n);return e.sort(ff),i()},a.range=function(t){return arguments.length?(n=Array.from(t),i()):n.slice()},a.unknown=function(e){return arguments.length?(t=e,a):t},a.quantiles=function(){return r.slice()},a.copy=function(){return Fg().domain(e).range(n).unknown(t)},Ep.apply(a,arguments)}function Ig(){var t,e=0,n=1,r=1,i=[.5],a=[0,1];function o(e){return null!=e&&e<=e?a[xf(i,e,0,r)]:t}function s(){var t=-1;for(i=new Array(r);++t<r;)i[t]=((t+1)*n-(t-r)*e)/(r+1);return o}return o.domain=function(t){return arguments.length?([e,n]=t,e=+e,n=+n,s()):[e,n]},o.range=function(t){return arguments.length?(r=(a=Array.from(t)).length-1,s()):a.slice()},o.invertExtent=function(t){var o=a.indexOf(t);return o<0?[NaN,NaN]:o<1?[e,i[0]]:o>=r?[i[r-1],n]:[i[o-1],i[o]]},o.unknown=function(e){return arguments.length?(t=e,o):o},o.thresholds=function(){return i.slice()},o.copy=function(){return Ig().domain([e,n]).range(a).unknown(t)},Ep.apply(Dp(o),arguments)}function Mg(){var t,e=[.5],n=[0,1],r=1;function i(i){return null!=i&&i<=i?n[xf(e,i,0,r)]:t}return i.domain=function(t){return arguments.length?(e=Array.from(t),r=Math.min(e.length,n.length-1),i):e.slice()},i.range=function(t){return arguments.length?(n=Array.from(t),r=Math.min(e.length,n.length-1),i):n.slice()},i.invertExtent=function(t){var r=n.indexOf(t);return[e[r-1],e[r]]},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return Mg().domain(e).range(n).unknown(t)},Ep.apply(i,arguments)}class Og extends Map{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Lg;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[n,r]of t)this.set(n,r)}get(t){return super.get(Rg(this,t))}has(t){return super.has(Rg(this,t))}set(t,e){return super.set(zg(this,t),e)}delete(t){return super.delete(Bg(this,t))}}Set;function Rg(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)?n.get(i):e}function zg(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)?n.get(i):(n.set(i,e),e)}function Bg(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)&&(e=n.get(i),n.delete(i)),e}function Lg(t){return null!==t&&"object"===typeof t?t.valueOf():t}const Pg=Symbol("implicit");function jg(){var t=new Og,e=[],n=[],r=Pg;function i(i){let a=t.get(i);if(void 0===a){if(r!==Pg)return r;t.set(i,a=e.push(i)-1)}return n[a%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Og;for(const r of n)t.has(r)||t.set(r,e.push(r)-1);return i},i.range=function(t){return arguments.length?(n=Array.from(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return jg(e,n).unknown(r)},Ep.apply(i,arguments),i}function Ug(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Wg(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Vg(){}var qg=.7,Gg=1/qg,Hg="\\s*([+-]?\\d+)\\s*",Yg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Xg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Kg=/^#([0-9a-f]{3,8})$/,$g=new RegExp("^rgb\\(".concat(Hg,",").concat(Hg,",").concat(Hg,"\\)$")),Zg=new RegExp("^rgb\\(".concat(Xg,",").concat(Xg,",").concat(Xg,"\\)$")),Qg=new RegExp("^rgba\\(".concat(Hg,",").concat(Hg,",").concat(Hg,",").concat(Yg,"\\)$")),Jg=new RegExp("^rgba\\(".concat(Xg,",").concat(Xg,",").concat(Xg,",").concat(Yg,"\\)$")),tm=new RegExp("^hsl\\(".concat(Yg,",").concat(Xg,",").concat(Xg,"\\)$")),em=new RegExp("^hsla\\(".concat(Yg,",").concat(Xg,",").concat(Xg,",").concat(Yg,"\\)$")),nm={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function rm(){return this.rgb().formatHex()}function im(){return this.rgb().formatRgb()}function am(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Kg.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?om(e):3===n?new lm(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?sm(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?sm(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=$g.exec(t))?new lm(e[1],e[2],e[3],1):(e=Zg.exec(t))?new lm(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Qg.exec(t))?sm(e[1],e[2],e[3],e[4]):(e=Jg.exec(t))?sm(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=tm.exec(t))?mm(e[1],e[2]/100,e[3]/100,1):(e=em.exec(t))?mm(e[1],e[2]/100,e[3]/100,e[4]):nm.hasOwnProperty(t)?om(nm[t]):"transparent"===t?new lm(NaN,NaN,NaN,0):null}function om(t){return new lm(t>>16&255,t>>8&255,255&t,1)}function sm(t,e,n,r){return r<=0&&(t=e=n=NaN),new lm(t,e,n,r)}function cm(t){return t instanceof Vg||(t=am(t)),t?new lm((t=t.rgb()).r,t.g,t.b,t.opacity):new lm}function um(t,e,n,r){return 1===arguments.length?cm(t):new lm(t,e,n,null==r?1:r)}function lm(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function hm(){return"#".concat(gm(this.r)).concat(gm(this.g)).concat(gm(this.b))}function dm(){const t=fm(this.opacity);return"".concat(1===t?"rgb(":"rgba(").concat(pm(this.r),", ").concat(pm(this.g),", ").concat(pm(this.b)).concat(1===t?")":", ".concat(t,")"))}function fm(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function pm(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function gm(t){return((t=pm(t))<16?"0":"")+t.toString(16)}function mm(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new bm(t,e,n,r)}function ym(t){if(t instanceof bm)return new bm(t.h,t.s,t.l,t.opacity);if(t instanceof Vg||(t=am(t)),!t)return new bm;if(t instanceof bm)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new bm(o,s,c,t.opacity)}function vm(t,e,n,r){return 1===arguments.length?ym(t):new bm(t,e,n,null==r?1:r)}function bm(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function xm(t){return(t=(t||0)%360)<0?t+360:t}function wm(t){return Math.max(0,Math.min(1,t||0))}function km(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function _m(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}function Sm(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,s=r<e-1?t[r+2]:2*a-i;return _m((n-r/e)*e,o,i,a,s)}}function Am(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],s=t[(r+2)%e];return _m((n-r/e)*e,i,a,o,s)}}Ug(Vg,am,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:rm,formatHex:rm,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return ym(this).formatHsl()},formatRgb:im,toString:im}),Ug(lm,um,Wg(Vg,{brighter(t){return t=null==t?Gg:Math.pow(Gg,t),new lm(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?qg:Math.pow(qg,t),new lm(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new lm(pm(this.r),pm(this.g),pm(this.b),fm(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:hm,formatHex:hm,formatHex8:function(){return"#".concat(gm(this.r)).concat(gm(this.g)).concat(gm(this.b)).concat(gm(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:dm,toString:dm})),Ug(bm,vm,Wg(Vg,{brighter(t){return t=null==t?Gg:Math.pow(Gg,t),new bm(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?qg:Math.pow(qg,t),new bm(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new lm(km(t>=240?t-240:t+120,i,r),km(t,i,r),km(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new bm(xm(this.h),wm(this.s),wm(this.l),fm(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=fm(this.opacity);return"".concat(1===t?"hsl(":"hsla(").concat(xm(this.h),", ").concat(100*wm(this.s),"%, ").concat(100*wm(this.l),"%").concat(1===t?")":", ".concat(t,")"))}}));const Cm=t=>()=>t;function Em(t,e){return function(n){return t+n*e}}function Tm(t,e){var n=e-t;return n?Em(t,n>180||n<-180?n-360*Math.round(n/360):n):Cm(isNaN(t)?e:t)}function Nm(t){return 1===(t=+t)?Dm:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Cm(isNaN(e)?n:e)}}function Dm(t,e){var n=e-t;return n?Em(t,n):Cm(isNaN(t)?e:t)}const Fm=function t(e){var n=Nm(e);function r(t,e){var r=n((t=um(t)).r,(e=um(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=Dm(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function Im(t){return function(e){var n,r,i=e.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=um(e[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=t(a),o=t(o),s=t(s),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=s(t),r+""}}}var Mm=Im(Sm),Om=Im(Am);function Rm(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(a){for(n=0;n<r;++n)i[n]=t[n]*(1-a)+e[n]*a;return i}}function zm(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Bm(t,e){return(zm(e)?Rm:Lm)(t,e)}function Lm(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=Gm(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}function Pm(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function jm(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Um(t,e){var n,r={},i={};for(n in null!==t&&"object"===typeof t||(t={}),null!==e&&"object"===typeof e||(e={}),e)n in t?r[n]=Gm(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var Wm=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Vm=new RegExp(Wm.source,"g");function qm(t,e){var n,r,i,a=Wm.lastIndex=Vm.lastIndex=0,o=-1,s=[],c=[];for(t+="",e+="";(n=Wm.exec(t))&&(r=Vm.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,c.push({i:o,x:jm(n,r)})),a=Vm.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?c[0]?function(t){return function(e){return t(e)+""}}(c[0].x):function(t){return function(){return t}}(e):(e=c.length,function(t){for(var n,r=0;r<e;++r)s[(n=c[r]).i]=n.x(t);return s.join("")})}function Gm(t,e){var n,r=typeof e;return null==e||"boolean"===r?Cm(e):("number"===r?jm:"string"===r?(n=am(e))?(e=n,Fm):qm:e instanceof am?Fm:e instanceof Date?Pm:zm(e)?Rm:Array.isArray(e)?Lm:"function"!==typeof e.valueOf&&"function"!==typeof e.toString||isNaN(e)?Um:jm)(t,e)}function Hm(t,e){void 0===e&&(e=t,t=Gm);for(var n=0,r=e.length-1,i=e[0],a=new Array(r<0?0:r);n<r;)a[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return a[e](t-e)}}function Ym(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function Xm(t,e){var n=Tm(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}}function Km(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var $m,Zm=180/Math.PI,Qm={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Jm(t,e,n,r,i,a){var o,s,c;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),t*r<e*n&&(t=-t,e=-e,c=-c,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*Zm,skewX:Math.atan(c)*Zm,scaleX:o,scaleY:s}}function ty(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var s=[],c=[];return a=t(a),o=t(o),function(t,r,i,a,o,s){if(t!==i||r!==a){var c=o.push("translate(",null,e,null,n);s.push({i:c-4,x:jm(t,i)},{i:c-2,x:jm(r,a)})}else(i||a)&&o.push("translate("+i+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,c),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:jm(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(a.rotate,o.rotate,s,c),function(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:jm(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(a.skewX,o.skewX,s,c),function(t,e,n,r,a,o){if(t!==n||e!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:jm(t,n)},{i:s-2,x:jm(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,c),a=o=null,function(t){for(var e,n=-1,r=c.length;++n<r;)s[(e=c[n]).i]=e.x(t);return s.join("")}}}var ey=ty((function(t){const e=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Qm:Jm(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),ny=ty((function(t){return null==t?Qm:($m||($m=document.createElementNS("http://www.w3.org/2000/svg","g")),$m.setAttribute("transform",t),(t=$m.transform.baseVal.consolidate())?Jm((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Qm)}),", ",")",")");function ry(t){return((t=Math.exp(t))+1/t)/2}const iy=function t(e,n,r){function i(t,i){var a,o,s=t[0],c=t[1],u=t[2],l=i[0],h=i[1],d=i[2],f=l-s,p=h-c,g=f*f+p*p;if(g<1e-12)o=Math.log(d/u)/e,a=function(t){return[s+t*f,c+t*p,u*Math.exp(e*t*o)]};else{var m=Math.sqrt(g),y=(d*d-u*u+r*g)/(2*u*n*m),v=(d*d-u*u-r*g)/(2*d*n*m),b=Math.log(Math.sqrt(y*y+1)-y),x=Math.log(Math.sqrt(v*v+1)-v);o=(x-b)/e,a=function(t){var r=t*o,i=ry(b),a=u/(n*m)*(i*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(e*r+b)-function(t){return((t=Math.exp(t))-1/t)/2}(b));return[s+a*f,c+a*p,u*i/ry(e*r+b)]}}return a.duration=1e3*o*e/Math.SQRT2,a}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i}(Math.SQRT2,2,4);function ay(t){return function(e,n){var r=t((e=vm(e)).h,(n=vm(n)).h),i=Dm(e.s,n.s),a=Dm(e.l,n.l),o=Dm(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=a(t),e.opacity=o(t),e+""}}}const oy=ay(Tm);var sy=ay(Dm);const cy=Math.PI/180,uy=180/Math.PI,ly=.96422,hy=1,dy=.82521,fy=4/29,py=6/29,gy=3*py*py,my=.008856451679035631;function yy(t){if(t instanceof by)return new by(t.l,t.a,t.b,t.opacity);if(t instanceof Cy)return Ey(t);t instanceof lm||(t=cm(t));var e,n,r=_y(t.r),i=_y(t.g),a=_y(t.b),o=xy((.2225045*r+.7168786*i+.0606169*a)/hy);return r===i&&i===a?e=n=o:(e=xy((.4360747*r+.3850649*i+.1430804*a)/ly),n=xy((.0139322*r+.0971045*i+.7141733*a)/dy)),new by(116*o-16,500*(e-o),200*(o-n),t.opacity)}function vy(t,e,n,r){return 1===arguments.length?yy(t):new by(t,e,n,null==r?1:r)}function by(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function xy(t){return t>my?Math.pow(t,1/3):t/gy+fy}function wy(t){return t>py?t*t*t:gy*(t-fy)}function ky(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function _y(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Sy(t){if(t instanceof Cy)return new Cy(t.h,t.c,t.l,t.opacity);if(t instanceof by||(t=yy(t)),0===t.a&&0===t.b)return new Cy(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*uy;return new Cy(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Ay(t,e,n,r){return 1===arguments.length?Sy(t):new Cy(t,e,n,null==r?1:r)}function Cy(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function Ey(t){if(isNaN(t.h))return new by(t.l,0,0,t.opacity);var e=t.h*cy;return new by(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function Ty(t,e){var n=Dm((t=vy(t)).l,(e=vy(e)).l),r=Dm(t.a,e.a),i=Dm(t.b,e.b),a=Dm(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=a(e),t+""}}function Ny(t){return function(e,n){var r=t((e=Ay(e)).h,(n=Ay(n)).h),i=Dm(e.c,n.c),a=Dm(e.l,n.l),o=Dm(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=a(t),e.opacity=o(t),e+""}}}Ug(by,vy,Wg(Vg,{brighter(t){return new by(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker(t){return new by(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new lm(ky(3.1338561*(e=ly*wy(e))-1.6168667*(t=hy*wy(t))-.4906146*(n=dy*wy(n))),ky(-.9787684*e+1.9161415*t+.033454*n),ky(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Ug(Cy,Ay,Wg(Vg,{brighter(t){return new Cy(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker(t){return new Cy(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb(){return Ey(this).rgb()}}));const Dy=Ny(Tm);var Fy=Ny(Dm),Iy=-.14861,My=1.78277,Oy=-.29227,Ry=-.90649,zy=1.97294,By=zy*Ry,Ly=zy*My,Py=My*Oy-Ry*Iy;function jy(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof Uy)return new Uy(t.h,t.s,t.l,t.opacity);t instanceof lm||(t=cm(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(Py*r+By*e-Ly*n)/(Py+By-Ly),a=r-i,o=(zy*(n-i)-Oy*a)/Ry,s=Math.sqrt(o*o+a*a)/(zy*i*(1-i)),c=s?Math.atan2(o,a)*uy-120:NaN;return new Uy(c<0?c+360:c,s,i,t.opacity)}(t):new Uy(t,e,n,null==r?1:r)}function Uy(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Wy(t){return function e(n){function r(e,r){var i=t((e=jy(e)).h,(r=jy(r)).h),a=Dm(e.s,r.s),o=Dm(e.l,r.l),s=Dm(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=a(t),e.l=o(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}Ug(Uy,jy,Wg(Vg,{brighter(t){return t=null==t?Gg:Math.pow(Gg,t),new Uy(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?qg:Math.pow(qg,t),new Uy(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*cy,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new lm(255*(e+n*(Iy*r+My*i)),255*(e+n*(Oy*r+Ry*i)),255*(e+n*(zy*r)),this.opacity)}}));const Vy=Wy(Tm);var qy=Wy(Dm);function Gy(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}function Hy(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0}const Yy="linear",Xy="log",Ky="pow",$y="sqrt",Zy="symlog",Qy="time",Jy="utc",tv="sequential",ev="diverging",nv="quantile",rv="quantize",iv="threshold",av="ordinal",ov="point",sv="band",cv="bin-ordinal",uv="continuous",lv="discrete",hv="discretizing",dv="interpolating",fv="temporal";function pv(){const t=jg().unknown(void 0),e=t.domain,n=t.range;let r,i,a=[0,1],o=!1,s=0,c=0,u=.5;function l(){const t=e().length,l=a[1]<a[0],h=a[1-l],d=Hy(t,s,c);let f=a[l-0];r=(h-f)/(d||1),o&&(r=Math.floor(r)),f+=(h-f-r*(t-s))*u,i=r*(1-s),o&&(f=Math.round(f),i=Math.round(i));const p=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a}(t).map((t=>f+r*t));return n(l?p.reverse():p)}return delete t.unknown,t.domain=function(t){return arguments.length?(e(t),l()):e()},t.range=function(t){return arguments.length?(a=[+t[0],+t[1]],l()):a.slice()},t.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,l()},t.bandwidth=function(){return i},t.step=function(){return r},t.round=function(t){return arguments.length?(o=!!t,l()):o},t.padding=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),s=c,l()):s},t.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),l()):s},t.paddingOuter=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),l()):c},t.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),l()):u},t.invertRange=function(t){if(null==t[0]||null==t[1])return;const r=a[1]<a[0],o=r?n().reverse():n(),s=o.length-1;let c,u,l,h=+t[0],d=+t[1];return h!==h||d!==d||(d<h&&(l=h,h=d,d=l),d<o[0]||h>a[1-r])?void 0:(c=Math.max(0,af(o,h)-1),u=h===d?c:af(o,d)-1,h-o[c]>i+1e-10&&++c,r&&(l=c,c=s-u,u=s-l),c>u?void 0:e().slice(c,u+1))},t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return pv().domain(e()).range(a).round(o).paddingInner(s).paddingOuter(c).align(u)},l()}function gv(t){const e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return gv(e())},t}var mv=Array.prototype.map;const yv=Array.prototype.slice;const vv=new Map,bv=Symbol("vega_scale");function xv(t){return t[bv]=!0,t}function wv(t,e,n){return arguments.length>1?(vv.set(t,function(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){let n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){const n=t.range();let r,i,a,o,s=e[0],c=e[1],u=-1;for(c<s&&(i=s,s=c,c=i),a=0,o=n.length;a<o;++a)n[a]>=s&&n[a]<=c&&(u<0&&(u=a),r=a);if(!(u<0))return s=t.invertExtent(n[u]),c=t.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===c[1]?c[0]:c[1]]}}(n):void 0),n.type=t,xv(n)};return r.metadata=Jn(Sn(n)),r}(t,e,n)),this):kv(t)?vv.get(t):void 0}function kv(t){return vv.has(t)}function _v(t,e){const n=vv.get(t);return n&&n.metadata[e]}function Sv(t){return _v(t,uv)}function Av(t){return _v(t,lv)}function Cv(t){return _v(t,hv)}function Ev(t){return _v(t,Xy)}function Tv(t){return _v(t,dv)}function Nv(t){return _v(t,nv)}wv("identity",Ip),wv(Yy,Fp,uv),wv(Xy,Up,[uv,Xy]),wv(Ky,Hp,uv),wv($y,Yp,uv),wv(Zy,Zp,uv),wv(Qy,gg,[uv,fv]),wv(Jy,mg,[uv,fv]),wv(tv,bg,[uv,dv]),wv("".concat(tv,"-").concat(Yy),bg,[uv,dv]),wv("".concat(tv,"-").concat(Xy),xg,[uv,dv,Xy]),wv("".concat(tv,"-").concat(Ky),kg,[uv,dv]),wv("".concat(tv,"-").concat($y),_g,[uv,dv]),wv("".concat(tv,"-").concat(Zy),wg,[uv,dv]),wv("".concat(ev,"-").concat(Yy),Ag,[uv,dv]),wv("".concat(ev,"-").concat(Xy),Cg,[uv,dv,Xy]),wv("".concat(ev,"-").concat(Ky),Tg,[uv,dv]),wv("".concat(ev,"-").concat($y),Ng,[uv,dv]),wv("".concat(ev,"-").concat(Zy),Eg,[uv,dv]),wv(nv,Fg,[hv,nv]),wv(rv,Ig,hv),wv(iv,Mg,hv),wv(cv,(function t(){let e=[],n=[];function r(t){return null==t||t!==t?void 0:n[(of(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=function(t){return mv.call(t,dn)}(t),r):e.slice()},r.range=function(t){return arguments.length?(n=yv.call(t),r):n.slice()},r.tickFormat=function(t,n){return Np(e[0],hn(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}),[lv,hv]),wv(av,jg,lv),wv(sv,pv,lv),wv(ov,(function(){return gv(pv().paddingInner(1))}),lv);const Dv=["clamp","base","constant","exponent"];function Fv(t,e,n){return Hm(Mv(e||"rgb",n),t)}function Iv(t,e,n){const r=n-e;let i,a,o;return r&&Number.isFinite(r)?(i=(a=t.type).indexOf("-"),a=i<0?a:a.slice(i+1),o=wv(a)().domain([e,n]).range([0,1]),Dv.forEach((e=>t[e]?o[e](t[e]()):0)),o):In(.5)}function Mv(t,e){const n=o[function(t){return"interpolate"+t.toLowerCase().split("-").map((t=>t[0].toUpperCase()+t.slice(1))).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}function Ov(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function Rv(t,e){for(const n in t)Bv(n,e(t[n]))}const zv={};function Bv(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(zv[t]=e,this):zv[t]}Rv({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},Ov),Rv({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(t=>Fv(Ov(t))));const Lv="symbol",Pv="discrete",jv=t=>on(t)?t.map((t=>String(t))):String(t),Uv=(t,e)=>t[1]-e[1],Wv=(t,e)=>e[1]-t[1];function Vv(t,e,n){let r;return Vn(e)&&(t.bins&&(e=Math.max(e,t.bins.length)),null!=n&&(e=Math.min(e,Math.floor(Yn(t.domain())/n||1)+1))),sn(e)&&(r=e.step,e=e.interval),qn(e)&&(e=t.type===Qy?ma(e):t.type==Jy?ya(e):qe("Only time and utc scales accept interval strings."),r&&(e=e.every(r))),e}function qv(t,e,n){let r=t.range(),i=r[0],a=hn(r),o=Uv;if(i>a&&(r=a,a=i,i=r,o=Wv),i=Math.floor(i),a=Math.ceil(a),e=e.map((e=>[e,t(e)])).filter((t=>i<=t[1]&&t[1]<=a)).sort(o).map((t=>t[0])),n>0&&e.length>1){const t=[e[0],hn(e)];for(;e.length>n&&e.length>=3;)e=e.filter(((t,e)=>!(e%2)));e.length<3&&(e=t)}return e}function Gv(t,e){return t.bins?qv(t,t.bins):t.ticks?t.ticks(e):t.domain()}function Hv(t,e,n,r,i,a){const o=e.type;let s=jv;if(o===Qy||i===Qy)s=t.timeFormat(r);else if(o===Jy||i===Jy)s=t.utcFormat(r);else if(Ev(o)){const i=t.formatFloat(r);if(a||e.bins)s=i;else{const t=Yv(e,n,!1);s=e=>t(e)?i(e):""}}else if(e.tickFormat){const i=e.domain();s=t.formatSpan(i[0],i[i.length-1],n,r)}else r&&(s=t.format(r));return s}function Yv(t,e,n){const r=Gv(t,e),i=t.base(),a=Math.log(i),o=Math.max(1,i*e/r.length),s=t=>{let e=t/Math.pow(i,Math.round(Math.log(t)/a));return e*i<i-.5&&(e*=i),e<=o};return n?r.filter(s):s}const Xv={[nv]:"quantiles",[rv]:"thresholds",[iv]:"domain"},Kv={[nv]:"quantiles",[rv]:"domain"};function $v(t,e){return t.bins?function(t){const e=t.slice(0,-1);return e.max=hn(t),e}(t.bins):t.type===Xy?Yv(t,e,!0):Xv[t.type]?function(t){const e=[-1/0].concat(t);return e.max=1/0,e}(t[Xv[t.type]]()):Gv(t,e)}const Zv=t=>Xv[t.type]||t.bins;function Qv(t,e,n,r,i,a,o){const s=Kv[e.type]&&a!==Qy&&a!==Jy?function(t,e,n){const r=e[Kv[e.type]](),i=r.length;let a,o=i>1?r[1]-r[0]:r[0];for(a=1;a<i;++a)o=Math.min(o,r[a]-r[a-1]);return t.formatSpan(0,o,30,n)}(t,e,i):Hv(t,e,n,i,a,o);return r===Lv&&Zv(e)?Jv(s):r===Pv?eb(s):nb(s)}const Jv=t=>(e,n,r)=>{const i=tb(r[n+1],tb(r.max,1/0)),a=rb(e,t),o=rb(i,t);return a&&o?a+" \u2013 "+o:o?"< "+o:"\u2265 "+a},tb=(t,e)=>null!=t?t:e,eb=t=>(e,n)=>n?t(e):null,nb=t=>e=>t(e),rb=(t,e)=>Number.isFinite(t)?e(t):null;function ib(t,e,n,r){const i=r||e.type;return qn(n)&&function(t){return _v(t,fv)}(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||i!==Qy?n||i!==Jy?Qv(t,e,5,null,n,r,!0):t.utcFormat("%A, %d %B %Y, %X UTC"):t.timeFormat("%A, %d %B %Y, %X")}function ab(t,e,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=ib(t,e,n.format,n.formatType);if(Cv(e.type)){const t=$v(e).slice(1).map(i),n=t.length;return"".concat(n," boundar").concat(1===n?"y":"ies",": ").concat(t.join(", "))}if(Av(e.type)){const t=e.domain(),n=t.length,a=n>r?t.slice(0,r-2).map(i).join(", ")+", ending with "+t.slice(-1).map(i):t.map(i).join(", ");return"".concat(n," value").concat(1===n?"":"s",": ").concat(a)}{const t=e.domain();return"values from ".concat(i(t[0])," to ").concat(i(hn(t)))}}let ob=0;const sb="p_";function cb(t){return t&&t.gradient}function ub(t,e,n){const r=t.gradient;let i=t.id,a="radial"===r?sb:"";return i||(i=t.id="gradient_"+ob++,"radial"===r?(t.x1=lb(t.x1,.5),t.y1=lb(t.y1,.5),t.r1=lb(t.r1,0),t.x2=lb(t.x2,.5),t.y2=lb(t.y2,.5),t.r2=lb(t.r2,.5),a=sb):(t.x1=lb(t.x1,0),t.y1=lb(t.y1,0),t.x2=lb(t.x2,1),t.y2=lb(t.y2,0))),e[i]=t,"url("+(n||"")+"#"+a+i+")"}function lb(t,e){return null!=t?t:e}const hb={basis:{curve:dh},"basis-closed":{curve:gh},"basis-open":{curve:yh},bundle:{curve:bh,tension:"beta",value:.85},cardinal:{curve:kh,tension:"tension",value:0},"cardinal-open":{curve:Sh,tension:"tension",value:0},"cardinal-closed":{curve:Ch,tension:"tension",value:0},"catmull-rom":{curve:Uh,tension:"alpha",value:.5},"catmull-rom-closed":{curve:Vh,tension:"alpha",value:.5},"catmull-rom-open":{curve:Gh,tension:"alpha",value:.5},linear:{curve:Yh},"linear-closed":{curve:Kh},monotone:{horizontal:id,vertical:rd},natural:{curve:sd},step:{curve:ud},"step-after":{curve:hd},"step-before":{curve:ld}};function db(t,e,n){var r=Bn(hb,t)&&hb[t],i=null;return r&&(i=r.curve||r[e||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const fb={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},pb=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,gb=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,mb=/^((\s+,?\s*)|(,\s*))/,yb=/^[01]/;function vb(t){const e=[];return(t.match(pb)||[]).forEach((t=>{let n=t[0];const r=n.toLowerCase(),i=fb[r],a=function(t,e,n){const r=[];for(let i=0;e&&i<n.length;)for(let a=0;a<e;++a){const e="a"!==t||3!==a&&4!==a?gb:yb,o=n.slice(i).match(e);if(null===o)throw Error("Invalid SVG path, incorrect parameter type");i+=o[0].length,r.push(+o[0]);const s=n.slice(i).match(mb);null!==s&&(i+=s[0].length)}return r}(r,i,t.slice(1).trim()),o=a.length;if(o<i||o&&o%i!==0)throw Error("Invalid SVG path, incorrect parameter count");if(e.push([n,...a.slice(0,i)]),o!==i){"m"===r&&(n="M"===n?"L":"l");for(let t=i;t<o;t+=i)e.push([n,...a.slice(t,t+i)])}})),e}const bb=Math.PI/180,xb=Math.PI/2,wb=2*Math.PI,kb=Math.sqrt(3)/2;var _b={},Sb={},Ab=[].join;function Cb(t){const e=Ab.call(t);if(Sb[e])return Sb[e];var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],u=t[7];const l=u*o,h=-c*s,d=c*o,f=u*s,p=Math.cos(i),g=Math.sin(i),m=Math.cos(a),y=Math.sin(a),v=.5*(a-i),b=Math.sin(.5*v),x=8/3*b*b/Math.sin(v),w=n+p-x*g,k=r+g+x*p,_=n+m,S=r+y,A=_+x*y,C=S-x*m;return Sb[e]=[l*w+h*k,d*w+f*k,l*A+h*C,d*A+f*C,l*_+h*S,d*_+f*S]}const Eb=["l",0,0,0,0,0,0,0];function Tb(t,e,n){const r=Eb[0]=t[0];if("a"===r||"A"===r)Eb[1]=e*t[1],Eb[2]=n*t[2],Eb[3]=t[3],Eb[4]=t[4],Eb[5]=t[5],Eb[6]=e*t[6],Eb[7]=n*t[7];else if("h"===r||"H"===r)Eb[1]=e*t[1];else if("v"===r||"V"===r)Eb[1]=n*t[1];else for(var i=1,a=t.length;i<a;++i)Eb[i]=(i%2==1?e:n)*t[i];return Eb}function Nb(t,e,n,r,i,a){var o,s,c,u,l,h=null,d=0,f=0,p=0,g=0,m=0,y=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==a&&(a=i),t.beginPath&&t.beginPath();for(var v=0,b=e.length;v<b;++v){switch(o=e[v],1===i&&1===a||(o=Tb(o,i,a)),o[0]){case"l":d+=o[1],f+=o[2],t.lineTo(d+n,f+r);break;case"L":d=o[1],f=o[2],t.lineTo(d+n,f+r);break;case"h":d+=o[1],t.lineTo(d+n,f+r);break;case"H":d=o[1],t.lineTo(d+n,f+r);break;case"v":f+=o[1],t.lineTo(d+n,f+r);break;case"V":f=o[1],t.lineTo(d+n,f+r);break;case"m":m=d+=o[1],y=f+=o[2],t.moveTo(d+n,f+r);break;case"M":m=d=o[1],y=f=o[2],t.moveTo(d+n,f+r);break;case"c":s=d+o[5],c=f+o[6],p=d+o[3],g=f+o[4],t.bezierCurveTo(d+o[1]+n,f+o[2]+r,p+n,g+r,s+n,c+r),d=s,f=c;break;case"C":d=o[5],f=o[6],p=o[3],g=o[4],t.bezierCurveTo(o[1]+n,o[2]+r,p+n,g+r,d+n,f+r);break;case"s":s=d+o[3],c=f+o[4],p=2*d-p,g=2*f-g,t.bezierCurveTo(p+n,g+r,d+o[1]+n,f+o[2]+r,s+n,c+r),p=d+o[1],g=f+o[2],d=s,f=c;break;case"S":s=o[3],c=o[4],p=2*d-p,g=2*f-g,t.bezierCurveTo(p+n,g+r,o[1]+n,o[2]+r,s+n,c+r),d=s,f=c,p=o[1],g=o[2];break;case"q":s=d+o[3],c=f+o[4],p=d+o[1],g=f+o[2],t.quadraticCurveTo(p+n,g+r,s+n,c+r),d=s,f=c;break;case"Q":s=o[3],c=o[4],t.quadraticCurveTo(o[1]+n,o[2]+r,s+n,c+r),d=s,f=c,p=o[1],g=o[2];break;case"t":s=d+o[1],c=f+o[2],null===h[0].match(/[QqTt]/)?(p=d,g=f):"t"===h[0]?(p=2*d-u,g=2*f-l):"q"===h[0]&&(p=2*d-p,g=2*f-g),u=p,l=g,t.quadraticCurveTo(p+n,g+r,s+n,c+r),f=c,p=(d=s)+o[1],g=f+o[2];break;case"T":s=o[1],c=o[2],p=2*d-p,g=2*f-g,t.quadraticCurveTo(p+n,g+r,s+n,c+r),d=s,f=c;break;case"a":Db(t,d+n,f+r,[o[1],o[2],o[3],o[4],o[5],o[6]+d+n,o[7]+f+r]),d+=o[6],f+=o[7];break;case"A":Db(t,d+n,f+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),d=o[6],f=o[7];break;case"z":case"Z":d=m,f=y,t.closePath()}h=o}}function Db(t,e,n,r){const i=function(t,e,n,r,i,a,o,s,c){const u=Ab.call(arguments);if(_b[u])return _b[u];const l=o*bb,h=Math.sin(l),d=Math.cos(l),f=d*(s-t)*.5+h*(c-e)*.5,p=d*(c-e)*.5-h*(s-t)*.5;let g=f*f/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=d/n,y=h/n,v=-h/r,b=d/r,x=m*s+y*c,w=v*s+b*c,k=m*t+y*e,_=v*t+b*e;let S=1/((k-x)*(k-x)+(_-w)*(_-w))-.25;S<0&&(S=0);let A=Math.sqrt(S);a==i&&(A=-A);const C=.5*(x+k)-A*(_-w),E=.5*(w+_)+A*(k-x),T=Math.atan2(w-E,x-C);let N=Math.atan2(_-E,k-C)-T;N<0&&1===a?N+=wb:N>0&&0===a&&(N-=wb);const D=Math.ceil(Math.abs(N/(xb+.001))),F=[];for(let I=0;I<D;++I){const t=T+I*N/D,e=T+(I+1)*N/D;F[I]=[C,E,t,e,n,r,h,d]}return _b[u]=F}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n);for(let a=0;a<i.length;++a){const e=Cb(i[a]);t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5])}}const Fb=.5773502691896257,Ib={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,wb)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,a=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-a),t.lineTo(i,-a),t.lineTo(0,-n),t.lineTo(-i,-a),t.lineTo(-r,-a),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=kb*n,i=r-n*Fb,a=n/4;t.moveTo(0,-r-i),t.lineTo(-a,r-i),t.lineTo(a,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=kb*n,i=r-n*Fb;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=kb*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=kb*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=kb*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=kb*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function Mb(t){return Bn(Ib,t)?Ib[t]:function(t){if(!Bn(Ob,t)){const e=vb(t);Ob[t]={draw:function(t,n){Nb(t,e,0,0,Math.sqrt(n)/2)}}}return Ob[t]}(t)}var Ob={};const Rb=.448084975506;function zb(t){return t.x}function Bb(t){return t.y}function Lb(t){return t.width}function Pb(t){return t.height}function jb(t){return"function"===typeof t?t:()=>+t}function Ub(t,e,n){return Math.max(e,Math.min(t,n))}function Wb(t,e){return null!=t?t:e}const Vb=t=>t.x||0,qb=t=>t.y||0,Gb=t=>!(!1===t.defined),Hb=Wd().startAngle((t=>t.startAngle||0)).endAngle((t=>t.endAngle||0)).padAngle((t=>t.padAngle||0)).innerRadius((t=>t.innerRadius||0)).outerRadius((t=>t.outerRadius||0)).cornerRadius((t=>t.cornerRadius||0)),Yb=Yd().x(Vb).y1(qb).y0((t=>(t.y||0)+(t.height||0))).defined(Gb),Xb=Yd().y(qb).x1(Vb).x0((t=>(t.x||0)+(t.width||0))).defined(Gb),Kb=Hd().x(Vb).y(qb).defined(Gb),$b=function(){var t=zb,e=Bb,n=Lb,r=Pb,i=jb(0),a=i,o=i,s=i,c=null;function u(u,l,h){var d,f=null!=l?l:+t.call(this,u),p=null!=h?h:+e.call(this,u),g=+n.call(this,u),m=+r.call(this,u),y=Math.min(g,m)/2,v=Ub(+i.call(this,u),0,y),b=Ub(+a.call(this,u),0,y),x=Ub(+o.call(this,u),0,y),w=Ub(+s.call(this,u),0,y);if(c||(c=d=Od()),v<=0&&b<=0&&x<=0&&w<=0)c.rect(f,p,g,m);else{var k=f+g,_=p+m;c.moveTo(f+v,p),c.lineTo(k-b,p),c.bezierCurveTo(k-Rb*b,p,k,p+Rb*b,k,p+b),c.lineTo(k,_-w),c.bezierCurveTo(k,_-Rb*w,k-Rb*w,_,k-w,_),c.lineTo(f+x,_),c.bezierCurveTo(f+Rb*x,_,f,_-Rb*x,f,_-x),c.lineTo(f,p+v),c.bezierCurveTo(f,p+Rb*v,f+Rb*v,p,f+v,p),c.closePath()}if(d)return c=null,d+""||null}return u.x=function(e){return arguments.length?(t=jb(e),u):t},u.y=function(t){return arguments.length?(e=jb(t),u):e},u.width=function(t){return arguments.length?(n=jb(t),u):n},u.height=function(t){return arguments.length?(r=jb(t),u):r},u.cornerRadius=function(t,e,n,r){return arguments.length?(i=jb(t),a=null!=e?jb(e):i,s=null!=n?jb(n):i,o=null!=r?jb(r):a,u):i},u.context=function(t){return arguments.length?(c=null==t?null:t,u):c},u}().x(Vb).y(qb).width((t=>t.width||0)).height((t=>t.height||0)).cornerRadius((t=>Wb(t.cornerRadiusTopLeft,t.cornerRadius)||0),(t=>Wb(t.cornerRadiusTopRight,t.cornerRadius)||0),(t=>Wb(t.cornerRadiusBottomRight,t.cornerRadius)||0),(t=>Wb(t.cornerRadiusBottomLeft,t.cornerRadius)||0)),Zb=$d().type((t=>Mb(t.shape||"circle"))).size((t=>Wb(t.size,64))),Qb=function(){var t,e,n,r,i,a,o,s,c=null;function u(t,e,n){const r=n/2;if(i){var u=o-e,l=t-a;if(u||l){var h=Math.hypot(u,l),d=(u/=h)*s,f=(l/=h)*s,p=Math.atan2(l,u);c.moveTo(a-d,o-f),c.lineTo(t-u*r,e-l*r),c.arc(t,e,r,p-Math.PI,p),c.lineTo(a+d,o+f),c.arc(a,o,s,p,p+Math.PI)}else c.arc(t,e,r,0,wb);c.closePath()}else i=1;a=t,o=e,s=r}function l(a){var o,s,l,h=a.length,d=!1;for(null==c&&(c=l=Od()),o=0;o<=h;++o)!(o<h&&r(s=a[o],o,a))===d&&(d=!d)&&(i=0),d&&u(+t(s,o,a),+e(s,o,a),+n(s,o,a));if(l)return c=null,l+""||null}return l.x=function(e){return arguments.length?(t=e,l):t},l.y=function(t){return arguments.length?(e=t,l):e},l.size=function(t){return arguments.length?(n=t,l):n},l.defined=function(t){return arguments.length?(r=t,l):r},l.context=function(t){return arguments.length?(c=null==t?null:t,l):c},l}().x(Vb).y(qb).defined(Gb).size((t=>t.size||1));function Jb(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function tx(t,e,n,r){return $b.context(t)(e,n,r)}var ex=1;function nx(t,e,n){var r=e.clip,i=t._defs,a=e.clip_id||(e.clip_id="clip"+ex++),o=i.clipping[a]||(i.clipping[a]={id:a});return An(r)?o.path=r(null):Jb(n)?o.path=tx(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+a+")"}function rx(t){this.clear(),t&&this.union(t)}function ix(t){this.mark=t,this.bounds=this.bounds||new rx}function ax(t){ix.call(this,t),this.items=this.items||[]}function ox(t){this._pending=0,this._loader=t||Ys()}function sx(t){t._pending+=1}function cx(t){t._pending-=1}function ux(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){const r=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(r+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}(e,r):0))}return t}rx.prototype={clone(){return new rx(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){const r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(t,e,n){var{x1:r,y1:i,x2:a,y2:o}=this,s=Math.cos(t),c=Math.sin(t),u=e-e*s+n*c,l=n-e*c-n*s;return[s*r-c*i+u,c*r+s*i+l,s*r-c*o+u,c*r+s*o+l,s*a-c*i+u,c*a+s*i+l,s*a-c*o+u,c*a+s*o+l]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},jn(ax,ix),ox.prototype={pending(){return this._pending},sanitizeURL(t){const e=this;return sx(e),e._loader.sanitize(t,{context:"href"}).then((t=>(cx(e),t))).catch((()=>(cx(e),null)))},loadImage(t){const e=this,n=Qd();return sx(e),e._loader.sanitize(t,{context:"image"}).then((t=>{const r=t.href;if(!r||!n)throw{url:r};const i=new n,a=Bn(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=a&&(i.crossOrigin=a),i.onload=()=>cx(e),i.onerror=()=>cx(e),i.src=r,i})).catch((t=>(cx(e),{complete:!1,width:0,height:0,src:t&&t.url||""})))},ready(){const t=this;return new Promise((e=>{!function n(r){t.pending()?setTimeout((()=>{n(!0)}),10):e(r)}(!1)}))}};const lx=wb-1e-8;let hx,dx,fx,px,gx,mx,yx,vx;const bx=(t,e)=>hx.add(t,e),xx=(t,e)=>bx(dx=t,fx=e),wx=t=>bx(t,hx.y1),kx=t=>bx(hx.x1,t),_x=(t,e)=>gx*t+yx*e,Sx=(t,e)=>mx*t+vx*e,Ax=(t,e)=>bx(_x(t,e),Sx(t,e)),Cx=(t,e)=>xx(_x(t,e),Sx(t,e));function Ex(t,e){return hx=t,e?(px=e*bb,gx=vx=Math.cos(px),mx=Math.sin(px),yx=-mx):(gx=vx=1,px=mx=yx=0),Tx}const Tx={beginPath(){},closePath(){},moveTo:Cx,lineTo:Cx,rect(t,e,n,r){px?(Ax(t+n,e),Ax(t+n,e+r),Ax(t,e+r),Cx(t,e)):(bx(t+n,e+r),xx(t,e))},quadraticCurveTo(t,e,n,r){const i=_x(t,e),a=Sx(t,e),o=_x(n,r),s=Sx(n,r);Nx(dx,i,o,wx),Nx(fx,a,s,kx),xx(o,s)},bezierCurveTo(t,e,n,r,i,a){const o=_x(t,e),s=Sx(t,e),c=_x(n,r),u=Sx(n,r),l=_x(i,a),h=Sx(i,a);Dx(dx,o,c,l,wx),Dx(fx,s,u,h,kx),xx(l,h)},arc(t,e,n,r,i,a){if(r+=px,i+=px,dx=n*Math.cos(i)+t,fx=n*Math.sin(i)+e,Math.abs(i-r)>lx)bx(t-n,e-n),bx(t+n,e+n);else{const o=r=>bx(n*Math.cos(r)+t,n*Math.sin(r)+e);let s,c;if(o(r),o(i),i!==r)if((r%=wb)<0&&(r+=wb),(i%=wb)<0&&(i+=wb),i<r&&(a=!a,s=r,r=i,i=s),a)for(i-=wb,s=r-r%xb,c=0;c<4&&s>i;++c,s-=xb)o(s);else for(s=r-r%xb+xb,c=0;c<4&&s<i;++c,s+=xb)o(s)}}};function Nx(t,e,n,r){const i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function Dx(t,e,n,r,i){const a=r-t+3*e-3*n,o=t+n-2*e,s=t-e;let c,u=0,l=0;Math.abs(a)>1e-14?(c=o*o+s*a,c>=0&&(c=Math.sqrt(c),u=(-o+c)/a,l=(-o-c)/a)):u=.5*s/o,0<u&&u<1&&i(Fx(u,t,e,n,r)),0<l&&l<1&&i(Fx(l,t,e,n,r))}function Fx(t,e,n,r,i){const a=1-t,o=a*a,s=t*t;return o*a*e+3*o*t*n+3*a*s*r+s*t*i}var Ix=(Ix=Zd(1,1))?Ix.getContext("2d"):null;const Mx=new rx;function Ox(t){return function(e,n){if(!Ix)return!0;t(Ix,e),Mx.clear().union(e.bounds).intersect(n).round();const{x1:r,y1:i,x2:a,y2:o}=Mx;for(let t=i;t<=o;++t)for(let e=r;e<=a;++e)if(Ix.isPointInPath(e,t))return!0;return!1}}function Rx(t,e){return e.contains(t.x||0,t.y||0)}function zx(t,e){const n=t.x||0,r=t.y||0,i=t.width||0,a=t.height||0;return e.intersects(Mx.set(n,r,n+i,r+a))}function Bx(t,e,n,r,i){const{x1:a,y1:o,x2:s,y2:c}=t,u=r-e,l=i-n;let h,d,f,p,g=0,m=1;for(p=0;p<4;++p){if(0===p&&(h=-u,d=-(a-e)),1===p&&(h=u,d=s-e),2===p&&(h=-l,d=-(o-n)),3===p&&(h=l,d=c-n),Math.abs(h)<1e-10&&d<0)return!1;if(f=d/h,h<0){if(f>m)return!1;f>g&&(g=f)}else if(h>0){if(f<g)return!1;f<m&&(m=f)}}return!0}function Lx(t,e){t.globalCompositeOperation=e.blend||"source-over"}function Px(t,e){return null==t?e:t}function jx(t,e){const n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}function Ux(t,e,n){return cb(n)?function(t,e,n){const r=n.width(),i=n.height();let a;if("radial"===e.gradient)a=t.createRadialGradient(n.x1+Px(e.x1,.5)*r,n.y1+Px(e.y1,.5)*i,Math.max(r,i)*Px(e.r1,0),n.x1+Px(e.x2,.5)*r,n.y1+Px(e.y2,.5)*i,Math.max(r,i)*Px(e.r2,.5));else{const o=Px(e.x1,0),s=Px(e.y1,0),c=Px(e.x2,1),u=Px(e.y2,0);if(o!==c&&s!==u&&r!==i){const n=Zd(Math.ceil(r),Math.ceil(i)),a=n.getContext("2d");return a.scale(r,i),a.fillStyle=jx(a.createLinearGradient(o,s,c,u),e.stops),a.fillRect(0,0,r,i),t.createPattern(n,"no-repeat")}a=t.createLinearGradient(n.x1+o*r,n.y1+s*i,n.x1+c*r,n.y1+u*i)}return jx(a,e.stops)}(t,n,e.bounds):n}function Wx(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=Ux(t,e,e.fill),!0)}var Vx=[];function qx(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&((n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=Ux(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||Vx),t.lineDashOffset=e.strokeDashOffset||0),!0))}function Gx(t,e){return t.zindex-e.zindex||t.index-e.index}function Hx(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,a=[];for(n=0,r=i.length;n<r;++n)(e=i[n]).index=n,e.zindex&&a.push(e);return t.zdirty=!1,t.zitems=a.sort(Gx)}function Yx(t,e){var n,r,i=t.items;if(!i||!i.length)return;const a=Hx(t);if(a&&a.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=a}for(n=0,r=i.length;n<r;++n)e(i[n])}function Xx(t,e){var n,r,i=t.items;if(!i||!i.length)return null;const a=Hx(t);for(a&&a.length&&(i=a),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===a)for(r=(i=t.items).length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function Kx(t){return function(e,n,r){Yx(n,(n=>{r&&!r.intersects(n.bounds)||Zx(t,e,n,n)}))}}function $x(t){return function(e,n,r){!n.items.length||r&&!r.intersects(n.bounds)||Zx(t,e,n.items[0],n.items)}}function Zx(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||(Lx(e,n),n.fill&&Wx(e,n,i)&&e.fill(),n.stroke&&qx(e,n,i)&&e.stroke()))}function Qx(t){return t=t||Ze,function(e,n,r,i,a,o){return r*=e.pixelRatio,i*=e.pixelRatio,Xx(n,(n=>{const s=n.bounds;if((!s||s.contains(a,o))&&s)return t(e,n,r,i,a,o)?n:void 0}))}}function Jx(t,e){return function(n,r,i,a){var o,s,c=Array.isArray(r)?r[0]:r,u=null==e?c.fill:e,l=c.stroke&&n.isPointInStroke;return l&&(o=c.strokeWidth,s=c.strokeCap,n.lineWidth=null!=o?o:1,n.lineCap=null!=s?s:"butt"),!t(n,r)&&(u&&n.isPointInPath(i,a)||l&&n.isPointInStroke(i,a))}}function tw(t){return Qx(Jx(t))}function ew(t,e){return"translate("+t+","+e+")"}function nw(t){return"rotate("+t+")"}function rw(t){return ew(t.x||0,t.y||0)}function iw(t,e,n){function r(t,n){var r=n.x||0,i=n.y||0,a=n.angle||0;t.translate(r,i),a&&t.rotate(a*=bb),t.beginPath(),e(t,n),a&&t.rotate(-a),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",function(t){return ew(t.x||0,t.y||0)+(t.angle?" "+nw(t.angle):"")}(n)),t("d",e(null,n))},bound:function(t,n){return e(Ex(t,n.angle),n),ux(t,n).translate(n.x||0,n.y||0)},draw:Kx(r),pick:tw(r),isect:n||Ox(r)}}var aw=iw("arc",(function(t,e){return Hb.context(t)(e)}));function ow(t,e,n){function r(t,n){t.beginPath(),e(t,n)}const i=Jx(r);return{type:t,tag:"path",nested:!0,attr:function(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))},bound:function(t,n){var r=n.items;return 0===r.length?t:(e(Ex(t),r),ux(t,r[0]))},draw:$x(r),pick:function(t,e,n,r,a,o){var s=e.items,c=e.bounds;return!s||!s.length||c&&!c.contains(a,o)?null:(n*=t.pixelRatio,r*=t.pixelRatio,i(t,s,n,r)?s[0]:null)},isect:Rx,tip:n}}var sw=ow("area",(function(t,e){const n=e[0],r=n.interpolate||"linear";return("horizontal"===n.orient?Xb:Yb).curve(db(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i="horizontal"===t[0].orient?e[1]:e[0],a="horizontal"===t[0].orient?"y":"x",o=t.length,s=1/0;--o>=0;)!1!==t[o].defined&&(r=Math.abs(t[o][a]-i))<s&&(s=r,n=t[o]);return n}));function cw(t,e){t.beginPath(),Jb(e)?tx(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function uw(t){const e=Px(t.strokeWidth,1);return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function lw(t,e){const n=uw(e);t("d",tx(null,e,n,n))}function hw(t,e,n,r){const i=uw(e);t.beginPath(),tx(t,e,(n||0)+i,(r||0)+i)}const dw=Jx(hw),fw=Jx(hw,!1),pw=Jx(hw,!0);var gw={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",rw(e))},bound:function(t,e){if(!e.clip&&e.items){const n=e.items,r=n.length;for(let e=0;e<r;++e)t.union(n[e].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),ux(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n,r){Yx(e,(e=>{const i=e.x||0,a=e.y||0,o=e.strokeForeground,s=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&s&&(hw(t,e,i,a),Lx(t,e),e.fill&&Wx(t,e,s)&&t.fill(),e.stroke&&!o&&qx(t,e,s)&&t.stroke()),t.save(),t.translate(i,a),e.clip&&cw(t,e),n&&n.translate(-i,-a),Yx(e,(e=>{("group"===e.marktype||null==r||r.includes(e.marktype))&&this.draw(t,e,n,r)})),n&&n.translate(i,a),t.restore(),o&&e.stroke&&s&&(hw(t,e,i,a),Lx(t,e),qx(t,e,s)&&t.stroke())}))},pick:function(t,e,n,r,i,a){if(e.bounds&&!e.bounds.contains(i,a)||!e.items)return null;const o=n*t.pixelRatio,s=r*t.pixelRatio;return Xx(e,(c=>{let u,l,h;const d=c.bounds;if(d&&!d.contains(i,a))return;l=c.x||0,h=c.y||0;const f=l+(c.width||0),p=h+(c.height||0),g=c.clip;if(g&&(i<l||i>f||a<h||a>p))return;if(t.save(),t.translate(l,h),l=i-l,h=a-h,g&&Jb(c)&&!pw(t,c,o,s))return t.restore(),null;const m=c.strokeForeground,y=!1!==e.interactive;return y&&m&&c.stroke&&fw(t,c,o,s)?(t.restore(),c):(u=Xx(c,(t=>function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}(t,l,h)?this.pick(t,n,r,l,h):null)),!u&&y&&(c.fill||!m&&c.stroke)&&dw(t,c,o,s)&&(u=c),t.restore(),u||null)}))},isect:zx,content:function(t,e,n){t("clip-path",e.clip?nx(n,e,e):null)},background:function(t,e){t("class","background"),t("aria-hidden",!0),lw(t,e)},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?lw(t,e):t("d","")}},mw={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function yw(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then((e=>{t.image=e,t.image.url=t.url}))),n}function vw(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function bw(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function xw(t,e){return"center"===t?e/2:"right"===t?e:0}function ww(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var kw={type:"image",tag:"image",nested:!1,attr:function(t,e,n){const r=yw(e,n),i=vw(e,r),a=bw(e,r),o=(e.x||0)-xw(e.align,i),s=(e.y||0)-ww(e.baseline,a);t("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",mw["xmlns:xlink"],"xlink:href"),t("transform",ew(o,s)),t("width",i),t("height",a),t("preserveAspectRatio",!1===e.aspect?"none":"xMidYMid")},bound:function(t,e){const n=e.image,r=vw(e,n),i=bw(e,n),a=(e.x||0)-xw(e.align,r),o=(e.y||0)-ww(e.baseline,i);return t.set(a,o,a+r,o+i)},draw:function(t,e,n){Yx(e,(e=>{if(n&&!n.intersects(e.bounds))return;const r=yw(e,this);let i=vw(e,r),a=bw(e,r);if(0===i||0===a)return;let o,s,c,u,l=(e.x||0)-xw(e.align,i),h=(e.y||0)-ww(e.baseline,a);!1!==e.aspect&&(s=r.width/r.height,c=e.width/e.height,s===s&&c===c&&s!==c&&(c<s?(u=i/s,h+=(a-u)/2,a=u):(u=a*s,l+=(i-u)/2,i=u))),(r.complete||r.toDataURL)&&(Lx(t,e),t.globalAlpha=null!=(o=e.opacity)?o:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(r,l,h,i,a))}))},pick:Qx(),isect:Ze,get:yw,xOffset:xw,yOffset:ww},_w=ow("line",(function(t,e){const n=e[0],r=n.interpolate||"linear";return Kb.curve(db(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i=Math.pow(t[0].strokeWidth||1,2),a=t.length;--a>=0;)if(!1!==t[a].defined&&(n=t[a].x-e[0])*n+(r=t[a].y-e[1])*r<i)return t[a];return null}));function Sw(t,e){var n=e.path;if(null==n)return!0;var r=e.x||0,i=e.y||0,a=e.scaleX||1,o=e.scaleY||1,s=(e.angle||0)*bb,c=e.pathCache;c&&c.path===n||((e.pathCache=c=vb(n)).path=n),s&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(s),Nb(t,c,0,0,a,o),t.rotate(-s),t.translate(-r,-i)):Nb(t,c,r,i,a,o)}var Aw={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,r=e.scaleY||1;1===n&&1===r||t("vector-effect","non-scaling-stroke"),t("transform",function(t){return ew(t.x||0,t.y||0)+(t.angle?" "+nw(t.angle):"")+(t.scaleX||t.scaleY?" "+function(t,e){return"scale("+t+","+e+")"}(t.scaleX||1,t.scaleY||1):"")}(e)),t("d",e.path)},bound:function(t,e){return Sw(Ex(t,e.angle),e)?t.set(0,0,0,0):ux(t,e,!0)},draw:Kx(Sw),pick:tw(Sw),isect:Ox(Sw)};function Cw(t,e){t.beginPath(),tx(t,e)}var Ew={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",tx(null,e))},bound:function(t,e){var n,r;return ux(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:Kx(Cw),pick:tw(Cw),isect:zx};function Tw(t,e,n){var r,i,a,o;return!(!e.stroke||!qx(t,e,n))&&(r=e.x||0,i=e.y||0,a=null!=e.x2?e.x2:r,o=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(a,o),!0)}var Nw={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",rw(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return ux(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)},draw:function(t,e,n){Yx(e,(e=>{if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&Tw(t,e,r)&&(Lx(t,e),t.stroke())}}))},pick:Qx((function(t,e,n,r){return!!t.isPointInStroke&&(Tw(t,e,1)&&t.isPointInStroke(n,r))})),isect:function(t,e){const n=t.x||0,r=t.y||0;return Bx(e,n,r,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r)}},Dw=iw("shape",(function(t,e){return(e.mark.shape||e.shape).context(t)(e)})),Fw=iw("symbol",(function(t,e){return Zb.context(t)(e)}),Rx);const Iw=function(t){let e,n,r;t=+t||1e4;const i=()=>{e={},n={},r=0},a=(i,a)=>(++r>t&&(n=e,e={},r=1),e[i]=a);return i(),{clear:i,has:t=>Bn(e,t)||Bn(n,t),get:t=>Bn(e,t)?e[t]:Bn(n,t)?a(t,n[t]):void 0,set:(t,n)=>Bn(e,t)?e[t]=n:a(t,n)}}();var Mw={height:Pw,measureWidth:Bw,estimateWidth:Rw,width:Rw,canvas:Ow};function Ow(t){Mw.width=t&&Ix?Bw:Rw}function Rw(t,e){return zw(Vw(t,e),Pw(t))}function zw(t,e){return~~(.8*t.length*e)}function Bw(t,e){return Pw(t)<=0||!(e=Vw(t,e))?0:Lw(e,Gw(t))}function Lw(t,e){const n="(".concat(e,") ").concat(t);let r=Iw.get(n);return void 0===r&&(Ix.font=e,r=Ix.measureText(t).width,Iw.set(n,r)),r}function Pw(t){return null!=t.fontSize?+t.fontSize||0:11}function jw(t){return null!=t.lineHeight?t.lineHeight:Pw(t)+2}function Uw(t){return e=t.lineBreak&&t.text&&!on(t.text)?t.text.split(t.lineBreak):t.text,on(e)?e.length>1?e:e[0]:e;var e}function Ww(t){const e=Uw(t);return(on(e)?e.length-1:0)*jw(t)}function Vw(t,e){const n=null==e?"":(e+"").trim();return t.limit>0&&n.length?function(t,e){var n=+t.limit,r=function(t){if(Mw.width===Bw){const e=Gw(t);return t=>Lw(t,e)}if(Mw.width===Rw){const e=Pw(t);return t=>zw(t,e)}return e=>Mw.width(t,e)}(t);if(r(e)<n)return e;var i,a=t.ellipsis||"\u2026",o="rtl"===t.dir,s=0,c=e.length;if(n-=r(a),o){for(;s<c;)i=s+c>>>1,r(e.slice(i))>n?s=i+1:c=i;return a+e.slice(s)}for(;s<c;)i=1+(s+c>>>1),r(e.slice(0,i))<n?s=i:c=i-1;return e.slice(0,s)+a}(t,n):n}function qw(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Gw(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+Pw(t)+"px "+qw(t,e)}function Hw(t){var e=t.baseline,n=Pw(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*jw(t):"line-bottom"===e?.29*n-.5*jw(t):0)}Ow(!0);const Yw={left:"start",center:"middle",right:"end"},Xw=new rx;function Kw(t){var e,n=t.x||0,r=t.y||0,i=t.radius||0;return i&&(e=(t.theta||0)-xb,n+=i*Math.cos(e),r+=i*Math.sin(e)),Xw.x1=n,Xw.y1=r,Xw}function $w(t,e,n){var r,i=Mw.height(e),a=e.align,o=Kw(e),s=o.x1,c=o.y1,u=e.dx||0,l=(e.dy||0)+Hw(e)-Math.round(.8*i),h=Uw(e);if(on(h)?(i+=jw(e)*(h.length-1),r=h.reduce(((t,n)=>Math.max(t,Mw.width(e,n))),0)):r=Mw.width(e,h),"center"===a?u-=r/2:"right"===a&&(u-=r),t.set(u+=s,l+=c,u+r,l+i),e.angle&&!n)t.rotate(e.angle*bb,s,c);else if(2===n)return t.rotatedPoints(e.angle*bb,s,c);return t}var Zw={type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,i=(e.dy||0)+Hw(e),a=Kw(e),o=a.x1,s=a.y1,c=e.angle||0;t("text-anchor",Yw[e.align]||"start"),c?(n=ew(o,s)+" "+nw(c),(r||i)&&(n+=" "+ew(r,i))):n=ew(o+r,s+i),t("transform",n)},bound:$w,draw:function(t,e,n){Yx(e,(e=>{var r,i,a,o,s,c,u,l=null==e.opacity?1:e.opacity;if(!(n&&!n.intersects(e.bounds)||0===l||e.fontSize<=0||null==e.text||0===e.text.length)){if(t.font=Gw(e),t.textAlign=e.align||"left",i=(r=Kw(e)).x1,a=r.y1,e.angle&&(t.save(),t.translate(i,a),t.rotate(e.angle*bb),i=a=0),i+=e.dx||0,a+=(e.dy||0)+Hw(e),c=Uw(e),Lx(t,e),on(c))for(s=jw(e),o=0;o<c.length;++o)u=Vw(e,c[o]),e.fill&&Wx(t,e,l)&&t.fillText(u,i,a),e.stroke&&qx(t,e,l)&&t.strokeText(u,i,a),a+=s;else u=Vw(e,c),e.fill&&Wx(t,e,l)&&t.fillText(u,i,a),e.stroke&&qx(t,e,l)&&t.strokeText(u,i,a);e.angle&&t.restore()}}))},pick:Qx((function(t,e,n,r,i,a){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var o=Kw(e),s=o.x1,c=o.y1,u=$w(Xw,e,1),l=-e.angle*bb,h=Math.cos(l),d=Math.sin(l),f=h*i-d*a+(s-h*s+d*c),p=d*i+h*a+(c-d*s-h*c);return u.contains(f,p)})),isect:function(t,e){const n=$w(Xw,t,2);return Bx(e,n[0],n[1],n[2],n[3])||Bx(e,n[0],n[1],n[4],n[5])||Bx(e,n[4],n[5],n[6],n[7])||Bx(e,n[2],n[3],n[6],n[7])}},Qw=ow("trail",(function(t,e){return Qb.context(t)(e)}),(function(t,e){for(var n,r,i=t.length;--i>=0;)if(!1!==t[i].defined&&(n=t[i].x-e[0])*n+(r=t[i].y-e[1])*r<(n=t[i].size||1)*n)return t[i];return null})),Jw={arc:aw,area:sw,group:gw,image:kw,line:_w,path:Aw,rect:Ew,rule:Nw,shape:Dw,symbol:Fw,text:Zw,trail:Qw};function tk(t,e,n){var r=Jw[t.mark.marktype],i=e||r.bound;return r.nested&&(t=t.mark),i(t.bounds||(t.bounds=new rx),t,n)}var ek={mark:null};const nk=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function rk(t){return ik("string"===typeof t?JSON.parse(t):t)}function ik(t){var e,n,r,i=t.marktype,a=t.items;if(a)for(n=0,r=a.length;n<r;++n)e=i?"mark":"group",a[n][e]=t,a[n].zindex&&(a[n][e].zdirty=!0),"group"===(i||e)&&ik(a[n]);return i&&function(t,e,n){var r,i,a,o,s=Jw[t.marktype],c=s.bound,u=t.items,l=u&&u.length;if(s.nested)return l?a=u[0]:(ek.mark=t,a=ek),o=tk(a,c,n),e&&e.union(o)||o;if(e=e||t.bounds&&t.bounds.clear()||new rx,l)for(r=0,i=u.length;r<i;++r)e.union(tk(u[r],c,n));t.bounds=e}(t),t}function ak(t){arguments.length?this.root=rk(t):(this.root=ok({marktype:"group",name:"root",role:"frame"}),this.root.items=[new ax(this.root)])}function ok(t,e){const n={bounds:new rx,clip:!!t.clip,group:e,interactive:!1!==t.interactive,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0};return null!=t.aria&&(n.aria=t.aria),t.description&&(n.description=t.description),n}function sk(t,e,n){return!t&&"undefined"!==typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function ck(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function uk(t,e,n,r){var i,a=t.childNodes[e];return a&&a.tagName.toLowerCase()===n.toLowerCase()||(i=a||null,a=sk(t.ownerDocument,n,r),t.insertBefore(a,i)),a}function lk(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function hk(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function dk(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function fk(t,e){this._active=null,this._handlers={},this._loader=t||Ys(),this._tooltip=e||pk}function pk(t,e,n,r){t.element().setAttribute("title",r||"")}function gk(t){this._el=null,this._bgcolor=null,this._loader=new ox(t)}ak.prototype={toJSON(t){return function(t,e){return JSON.stringify(t,nk,e)}(this.root,t||0)},mark(t,e,n){const r=ok(t,e=e||this.root.items[0]);return e.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}},fk.prototype={initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},scene(t){return arguments.length?(this._scene=t,this):this._scene},on(){},off(){},_handlerIndex(t,e,n){for(let r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},handlers(t){const e=this._handlers,n=[];if(t)n.push(...e[this.eventName(t)]);else for(const r in e)n.push(...e[r]);return n},eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then((e=>{const n=new MouseEvent(t.type,t),r=sk(null,"a");for(const t in e)r.setAttribute(t,e[t]);r.dispatchEvent(n)})).catch((()=>{}))},handleTooltip(t,e,n){if(e&&null!=e.tooltip){e=function(t,e,n,r){var i,a,o=t&&t.mark;if(o&&(i=Jw[o.marktype]).tip){for((a=dk(e,n))[0]-=r[0],a[1]-=r[1];t=t.mark.group;)a[0]-=t.x||0,a[1]-=t.y||0;t=i.tip(o.items,a)}return t}(e,t,this.canvas(),this._origin);const r=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,r)}},getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,a=i.width(),o=i.height();let s=i.x1+r[0]+n.left,c=i.y1+r[1]+n.top;for(;t.mark&&(t=t.mark.group);)s+=t.x||0,c+=t.y||0;return{x:s,y:c,width:a,height:o,left:s,top:c,right:s+a,bottom:c+o}}},gk.prototype={initialize(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)},resize(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(t,e){const n=this;return n._call=function(){n._render(t,e)},n._call(),n._call=null,n},_render(){},renderAsync(t,e){const n=this.render(t,e);return this._ready?this._ready.then((()=>n)):Promise.resolve(n)},_load(t,e){var n=this,r=n._loader[t](e);if(!n._ready){const t=n._call;n._ready=n._loader.ready().then((e=>{e&&t(),n._ready=null}))}return r},sanitizeURL(t){return this._load("sanitizeURL",t)},loadImage(t){return this._load("loadImage",t)}};const mk="dragenter",yk="dragleave",vk="dragover",bk="pointerdown",xk="pointermove",wk="pointerout",kk="pointerover",_k="mousedown",Sk="mousemove",Ak="mouseout",Ck="mouseover",Ek="click",Tk="mousewheel",Nk="touchstart",Dk="touchmove",Fk="touchend",Ik=xk,Mk=wk,Ok=Ek;function Rk(t,e){fk.call(this,t,e),this._down=null,this._touch=null,this._first=!0,this._events={}}function zk(t,e){(t=>t===Nk||t===Dk||t===Fk?[Nk,Dk,Fk]:[t])(e).forEach((e=>function(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n)))}(t,e)))}function Bk(t,e,n){e.forEach((e=>t.fire(e,n)))}function Lk(t,e,n){return function(r){const i=this._active,a=this.pickEvent(r);a===i||(i&&i.exit||Bk(this,n,r),this._active=a,Bk(this,e,r)),Bk(this,t,r)}}function Pk(t){return function(e){Bk(this,t,e),this._active=null}}function jk(t,e,n,r,i,a){const o="undefined"!==typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,s=t.getContext("2d"),c=o?"undefined"!==typeof window&&window.devicePixelRatio||1:i;t.width=e*c,t.height=n*c;for(const u in a)s[u]=a[u];return o&&1!==c&&(t.style.width=e+"px",t.style.height=n+"px"),s.pixelRatio=c,s.setTransform(c,0,0,c,c*r[0],c*r[1]),t}function Uk(t){gk.call(this,t),this._options={},this._redraw=!1,this._dirty=new rx,this._tempb=new rx}jn(Rk,fk,{initialize(t,e,n){return this._canvas=t&&ck(t,"canvas"),[Ek,_k,bk,xk,wk,yk].forEach((t=>zk(this,t))),fk.prototype.initialize.call(this,t,e,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",mk,yk,vk,bk,"pointerup",xk,wk,kk,_k,"mouseup",Sk,Ak,Ck,Ek,"dblclick","wheel",Tk,Nk,Dk,Fk],DOMMouseScroll(t){this.fire(Tk,t)},pointermove:Lk([xk,Sk],[kk,Ck],[wk,Ak]),dragover:Lk([vk],[mk],[yk]),pointerout:Pk([wk,Ak]),dragleave:Pk([yk]),pointerdown(t){this._down=this._active,this.fire(bk,t)},mousedown(t){this._down=this._active,this.fire(_k,t)},click(t){this._down===this._active&&(this.fire(Ek,t),this._down=null)},touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(Nk,t,!0)},touchmove(t){this.fire(Dk,t,!0)},touchend(t){this.fire(Fk,t,!0),this._touch=null},fire(t,e,n){const r=n?this._touch:this._active,i=this._handlers[t];if(e.vegaType=t,t===Ok&&r&&r.href?this.handleHref(e,r,r.href):t!==Ik&&t!==Mk||this.handleTooltip(e,r,t!==Mk),i)for(let a=0,o=i.length;a<o;++a)i[a].handler.call(this._obj,e,r)},on(t,e){const n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(zk(this,t),(r[n]||(r[n]=[])).push({type:t,handler:e})),this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this},pickEvent(t){const e=dk(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pick(t,e,n,r,i){const a=this.context();return Jw[t.marktype].pick.call(this,a,t,e,n,r,i)}});const Wk=gk.prototype;function Vk(t,e){fk.call(this,t,e);const n=this;n._hrefHandler=qk(n,((t,e)=>{e&&e.href&&n.handleHref(t,e,e.href)})),n._tooltipHandler=qk(n,((t,e)=>{n.handleTooltip(t,e,t.type!==Mk)}))}jn(Uk,gk,{initialize(t,e,n,r,i,a){return this._options=a||{},this._canvas=this._options.externalContext?null:Zd(1,1,this._options.type),t&&this._canvas&&(lk(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),Wk.initialize.call(this,t,e,n,r,i)},resize(t,e,n,r){if(Wk.resize.call(this,t,e,n,r),this._canvas)jk(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const t=this._options.externalContext;t||qe("CanvasRenderer is missing a valid canvas or context"),t.scale(this._scale,this._scale),t.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)},_render(t,e){const n=this.context(),r=this._origin,i=this._width,a=this._height,o=this._dirty,s=((t,e,n)=>(new rx).set(0,0,e,n).translate(-t[0],-t[1]))(r,i,a);n.save();const c=this._redraw||o.empty()?(this._redraw=!1,s.expand(1)):function(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}(n,s.intersect(o),r);return this.clear(-r[0],-r[1],i,a),this.draw(n,t,c,e),n.restore(),o.clear(),this},draw(t,e,n,r){if("group"!==e.marktype&&null!=r&&!r.includes(e.marktype))return;const i=Jw[e.marktype];e.clip&&function(t,e){var n=e.clip;t.save(),An(n)?(t.beginPath(),n(t),t.clip()):cw(t,e.group)}(t,e),i.draw.call(this,t,e,n,r),e.clip&&t.restore()},clear(t,e,n,r){const i=this._options,a=this.context();"pdf"===i.type||i.externalContext||a.clearRect(t,e,n,r),null!=this._bgcolor&&(a.fillStyle=this._bgcolor,a.fillRect(t,e,n,r))}});const qk=(t,e)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,e.call(t._obj,n,r)};jn(Vk,fk,{initialize(t,e,n){let r=this._svg;return r&&(r.removeEventListener(Ok,this._hrefHandler),r.removeEventListener(Ik,this._tooltipHandler),r.removeEventListener(Mk,this._tooltipHandler)),this._svg=r=t&&ck(t,"svg"),r&&(r.addEventListener(Ok,this._hrefHandler),r.addEventListener(Ik,this._tooltipHandler),r.addEventListener(Mk,this._tooltipHandler)),fk.prototype.initialize.call(this,t,e,n)},canvas(){return this._svg},on(t,e){const n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){const i={type:t,handler:e,listener:qk(this,e)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const Gk="aria-hidden",Hk="aria-label",Yk="role",Xk="aria-roledescription",Kk="graphics-object",$k="graphics-symbol",Zk=(t,e,n)=>({[Yk]:t,[Xk]:e,[Hk]:n||void 0}),Qk=Jn(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),Jk={axis:{desc:"axis",caption:function(t){const e=t.datum,n=t.orient,r=e.title?i_(t):null,i=t.context,a=i.scales[e.scale].value,o=i.dataflow.locale(),s=a.type,c="left"===n||"right"===n?"Y":"X";return"".concat(c,"-axis")+(r?" titled '".concat(r,"'"):"")+" for a ".concat(Av(s)?"discrete":s," scale")+" with ".concat(ab(o,a,t))}},legend:{desc:"legend",caption:function(t){const e=t.datum,n=e.title?i_(t):null,r="".concat(e.type||""," legend").trim(),i=e.scales,a=Object.keys(i),o=t.context,s=o.scales[i[a[0]]].value,c=o.dataflow.locale();return function(t){return t.length?t[0].toUpperCase()+t.slice(1):t}(r)+(n?" titled '".concat(n,"'"):"")+" for ".concat(function(t){return t=t.map((t=>t+("fill"===t||"stroke"===t?" color":""))),t.length<2?t[0]:t.slice(0,-1).join(", ")+" and "+hn(t)}(a))+" with ".concat(ab(c,s,t))}},"title-text":{desc:"title",caption:t=>"Title text '".concat(r_(t),"'")},"title-subtitle":{desc:"subtitle",caption:t=>"Subtitle text '".concat(r_(t),"'")}},t_={ariaRole:Yk,ariaRoleDescription:Xk,description:Hk};function e_(t,e){const n=!1===e.aria;if(t(Gk,n||void 0),n||null==e.description)for(const r in t_)t(t_[r],void 0);else{const n=e.mark.marktype;t(Hk,e.description),t(Yk,e.ariaRole||("group"===n?Kk:$k)),t(Xk,e.ariaRoleDescription||"".concat(n," mark"))}}function n_(t){return!1===t.aria?{[Gk]:!0}:Qk[t.role]?null:Jk[t.role]?function(t,e){try{const n=t.items[0],r=e.caption||(()=>"");return Zk(e.role||$k,e.desc,n.description||r(n))}catch(n){return null}}(t,Jk[t.role]):function(t){const e=t.marktype,n="group"===e||"text"===e||t.items.some((t=>null!=t.description&&!1!==t.aria));return Zk(n?Kk:$k,"".concat(e," mark container"),t.description)}(t)}function r_(t){return Sn(t.text).join(" ")}function i_(t){try{return Sn(hn(t.items).items[0].text).join(" ")}catch(e){return null}}const a_=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function o_(){let t="",e="",n="";const r=[],i=()=>e=n="",a=(t,n)=>(null!=n&&(e+=" ".concat(t,'="').concat(a_(n).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"),'"')),o),o={open(s){(a=>{e&&(t+="".concat(e,">").concat(n),i()),r.push(a)})(s),e="<"+s;for(var c=arguments.length,u=new Array(c>1?c-1:0),l=1;l<c;l++)u[l-1]=arguments[l];for(const t of u)for(const e in t)a(e,t[e]);return o},close(){const a=r.pop();return t+=e?e+(n?">".concat(n,"</").concat(a,">"):"/>"):"</".concat(a,">"),i(),o},attr:a,text:t=>(n+=a_(t),o),toString:()=>t};return o}const s_=t=>c_(o_(),t)+"";function c_(t,e){if(t.open(e.tagName),e.hasAttributes()){const n=e.attributes,r=n.length;for(let e=0;e<r;++e)t.attr(n[e].name,n[e].value)}if(e.hasChildNodes()){const n=e.childNodes;for(const e of n)3===e.nodeType?t.text(e.nodeValue):c_(t,e)}return t.close()}const u_={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},l_={blend:"mix-blend-mode"},h_={fill:"none","stroke-miterlimit":10},d_="http://www.w3.org/2000/xmlns/",f_=mw.xmlns;function p_(t){gk.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const g_=gk.prototype;function m_(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function y_(t,e,n){let r,i,a;if("radial"===e.gradient){let r=uk(t,n++,"pattern",f_);A_(r,{id:sb+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=uk(r,0,"rect",f_),A_(r,{width:1,height:1,fill:"url(".concat(E_(),"#").concat(e.id,")")}),A_(t=uk(t,n++,"radialGradient",f_),{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else A_(t=uk(t,n++,"linearGradient",f_),{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(r=0,i=e.stops.length;r<i;++r)a=uk(t,r,"stop",f_),a.setAttribute("offset",e.stops[r].offset),a.setAttribute("stop-color",e.stops[r].color);return lk(t,r),n}function v_(t,e,n){let r;return(t=uk(t,n,"clipPath",f_)).setAttribute("id",e.id),e.path?(r=uk(t,0,"path",f_),r.setAttribute("d",e.path)):(r=uk(t,0,"rect",f_),A_(r,{x:0,y:0,width:e.width,height:e.height})),lk(t,1),n+1}function b_(t,e,n,r,i){let a,o=t._svg;if(!o&&(a=e.ownerDocument,o=sk(a,r,f_),t._svg=o,t.mark&&(o.__data__=t,o.__values__={fill:"default"},"g"===r))){const e=sk(a,"path",f_);o.appendChild(e),e.__data__=t;const n=sk(a,"g",f_);o.appendChild(n),n.__data__=t;const r=sk(a,"path",f_);o.appendChild(r),r.__data__=t,r.__values__={fill:"default"}}return(o.ownerSVGElement!==i||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}(o,n))&&e.insertBefore(o,n?n.nextSibling:e.firstChild),o}jn(p_,gk,{initialize(t,e,n,r,i){return this._defs={},this._clearDefs(),t&&(this._svg=uk(t,0,"svg",f_),this._svg.setAttributeNS(d_,"xmlns",f_),this._svg.setAttributeNS(d_,"xmlns:xlink",mw["xmlns:xlink"]),this._svg.setAttribute("version",mw.version),this._svg.setAttribute("class","marks"),lk(t,1),this._root=uk(this._svg,0,"g",f_),A_(this._root,h_),lk(this._svg,1)),this.background(this._bgcolor),g_.initialize.call(this,t,e,n,r,i)},background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),g_.background.apply(this,arguments)},resize(t,e,n,r){return g_.resize.call(this,t,e,n,r),this._svg&&(A_(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas(){return this._svg},svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=uk(t,0,"rect",f_),A_(n,{width:this._width,height:this._height,fill:e}));const r=s_(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),r},_render(t,e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t,void 0,e),lk(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const e=++this._dirtyID;let n,r,i,a,o,s,c;for(o=0,s=t.length;o<s;++o)n=t[o],r=n.mark,r.marktype!==i&&(i=r.marktype,a=Jw[i]),r.zdirty&&r.dirty!==e&&(this._dirtyAll=!1,m_(n,e),r.items.forEach((t=>{t.dirty=e}))),r.zdirty||(n.exit?(a.nested&&r.items.length?(c=r.items[0],c._svg&&this._update(a,c._svg,c)):n._svg&&(c=n._svg.parentNode,c&&c.removeChild(n._svg)),n._svg=null):(n=a.nested?r.items[0]:n,n._update!==e&&(n._svg&&n._svg.ownerSVGElement?this._update(a,n._svg,n):(this._dirtyAll=!1,m_(n,e)),n._update=e)));return!this._dirtyAll},mark(t,e,n,r){if(!this.isDirty(e))return e._svg;const i=this._svg,a=e.marktype,o=Jw[a],s=!1===e.interactive?"none":null,c="g"===o.tag,u=b_(e,t,n,"g",i);if("group"!==a&&null!=r&&!r.includes(a))return lk(u,0),e._svg;u.setAttribute("class",hk(e));const l=n_(e);for(const p in l)C_(u,p,l[p]);c||C_(u,"pointer-events",s),C_(u,"clip-path",e.clip?nx(this,e,e.group):null);let h=null,d=0;const f=t=>{const e=this.isDirty(t),n=b_(t,u,h,o.tag,i);e&&(this._update(o,n,t),c&&function(t,e,n,r){e=e.lastChild.previousSibling;let i,a=0;Yx(n,(n=>{i=t.mark(e,n,i,r),++a})),lk(e,1+a)}(this,n,t,r)),h=n,++d};return o.nested?e.items.length&&f(e.items[0]):Yx(e,f),lk(u,d),u},_update(t,e,n){x_=e,w_=e.__values__,e_(__,n),t.attr(__,n,this);const r=k_[t.type];r&&r.call(this,t,e,n),x_&&this.style(x_,n)},style(t,e){if(null!=e){for(const n in u_){let r="font"===n?qw(e):e[n];if(r===w_[n])continue;const i=u_[n];null==r?t.removeAttribute(i):(cb(r)&&(r=ub(r,this._defs.gradient,E_())),t.setAttribute(i,r+"")),w_[n]=r}for(const n in l_)S_(t,l_[n],e[n])}},defs(){const t=this._svg,e=this._defs;let n=e.el,r=0;for(const i in e.gradient)n||(e.el=n=uk(t,1,"defs",f_)),r=y_(n,e.gradient[i],r);for(const i in e.clipping)n||(e.el=n=uk(t,1,"defs",f_)),r=v_(n,e.clipping[i],r);n&&(0===r?(t.removeChild(n),e.el=null):lk(n,r))},_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}});let x_=null,w_=null;const k_={group(t,e,n){const r=x_=e.childNodes[2];w_=r.__values__,t.foreground(__,n,this),w_=e.__values__,x_=e.childNodes[1],t.content(__,n,this);const i=x_=e.childNodes[0];t.background(__,n,this);const a=!1===n.mark.interactive?"none":null;if(a!==w_.events&&(C_(r,"pointer-events",a),C_(i,"pointer-events",a),w_.events=a),n.strokeForeground&&n.stroke){const t=n.fill;C_(r,"display",null),this.style(i,n),C_(i,"stroke",null),t&&(n.fill=null),w_=r.__values__,this.style(r,n),t&&(n.fill=t),x_=null}else C_(r,"display","none")},image(t,e,n){!1===n.smooth?(S_(e,"image-rendering","optimizeSpeed"),S_(e,"image-rendering","pixelated")):S_(e,"image-rendering",null)},text(t,e,n){const r=Uw(n);let i,a,o,s;on(r)?(a=r.map((t=>Vw(n,t))),i=a.join("\n"),i!==w_.text&&(lk(e,0),o=e.ownerDocument,s=jw(n),a.forEach(((t,r)=>{const i=sk(o,"tspan",f_);i.__data__=n,i.textContent=t,r&&(i.setAttribute("x",0),i.setAttribute("dy",s)),e.appendChild(i)})),w_.text=i)):(a=Vw(n,r),a!==w_.text&&(e.textContent=a,w_.text=a)),C_(e,"font-family",qw(n)),C_(e,"font-size",Pw(n)+"px"),C_(e,"font-style",n.fontStyle),C_(e,"font-variant",n.fontVariant),C_(e,"font-weight",n.fontWeight)}};function __(t,e,n){e!==w_[t]&&(n?function(t,e,n,r){null!=n?t.setAttributeNS(r,e,n):t.removeAttributeNS(r,e)}(x_,t,e,n):C_(x_,t,e),w_[t]=e)}function S_(t,e,n){n!==w_[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),w_[e]=n)}function A_(t,e){for(const n in e)C_(t,n,e[n])}function C_(t,e,n){null!=n?t.setAttribute(e,n):t.removeAttribute(e)}function E_(){let t;return"undefined"===typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function T_(t){gk.call(this,t),this._text=null,this._defs={gradient:{},clipping:{}}}jn(T_,gk,{svg(){return this._text},_render(t){const e=o_();e.open("svg",On({},mw,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",h_,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this},mark(t,e){const n=Jw[e.marktype],r=n.tag,i=[e_,n.attr];t.open("g",{class:hk(e),"clip-path":e.clip?nx(this,e,e.group):null},n_(e),{"pointer-events":"g"!==r&&!1===e.interactive?"none":null});const a=a=>{const o=this.href(a);if(o&&t.open("a",o),t.open(r,this.attr(e,a,i,"g"!==r?r:null)),"text"===r){const e=Uw(a);if(on(e)){const n={x:0,dy:jw(a)};for(let r=0;r<e.length;++r)t.open("tspan",r?n:null).text(Vw(a,e[r])).close()}else t.text(Vw(a,e))}else if("g"===r){const r=a.strokeForeground,i=a.fill,o=a.stroke;r&&o&&(a.stroke=null),t.open("path",this.attr(e,a,n.background,"bgrect")).close(),t.open("g",this.attr(e,a,n.content)),Yx(a,(e=>this.mark(t,e))),t.close(),r&&o?(i&&(a.fill=null),a.stroke=o,t.open("path",this.attr(e,a,n.foreground,"bgrect")).close(),i&&(a.fill=i)):t.open("path",this.attr(e,a,n.foreground,"bgfore")).close()}t.close(),o&&t.close()};return n.nested?e.items&&e.items.length&&a(e.items[0]):Yx(e,a),t.close()},href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then((t=>{t["xlink:href"]=t.href,t.href=null,(this._hrefs||(this._hrefs={}))[e]=t}))}return null},attr(t,e,n,r){const i={},a=(t,e,n,r)=>{i[r||t]=e};return Array.isArray(n)?n.forEach((t=>t(a,e,this))):n(a,e,this),r&&function(t,e,n,r,i){let a;if(null==e)return t;"bgrect"===r&&!1===n.interactive&&(t["pointer-events"]="none");if("bgfore"===r&&(!1===n.interactive&&(t["pointer-events"]="none"),t.display="none",null!==e.fill))return t;"image"===r&&!1===e.smooth&&(a=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]);"text"===r&&(t["font-family"]=qw(e),t["font-size"]=Pw(e)+"px",t["font-style"]=e.fontStyle,t["font-variant"]=e.fontVariant,t["font-weight"]=e.fontWeight);for(const o in u_){let n=e[o];const r=u_[o];("transparent"!==n||"fill"!==r&&"stroke"!==r)&&null!=n&&(cb(n)&&(n=ub(n,i.gradient,"")),t[r]=n)}for(const o in l_){const t=e[o];null!=t&&(a=a||[],a.push("".concat(l_[o],": ").concat(t,";")))}a&&(t.style=a.join(" "))}(i,e,t,r,this._defs),i},defs(t){const e=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(e).length+Object.keys(n).length){t.open("defs");for(const n in e){const r=e[n],i=r.stops;"radial"===r.gradient?(t.open("pattern",{id:sb+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),t.close(),t.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):t.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let e=0;e<i.length;++e)t.open("stop",{offset:i[e].offset,"stop-color":i[e].color}).close();t.close()}for(const e in n){const r=n[e];t.open("clipPath",{id:e}),r.path?t.open("path",{d:r.path}).close():t.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),t.close()}t.close()}}});const N_={svgMarkTypes:["text"],svgOnTop:!0,debug:!1};function D_(t){gk.call(this,t),this._svgRenderer=new p_(t),this._canvasRenderer=new Uk(t)}const F_=gk.prototype;function I_(t,e){Rk.call(this,t,e)}jn(D_,gk,{initialize(t,e,n,r,i){this._root_el=uk(t,0,"div");const a=uk(this._root_el,0,"div"),o=uk(this._root_el,1,"div");return this._root_el.style.position="relative",N_.debug||(a.style.height="100%",o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.height="100%",o.style.width="100%"),this._svgEl=N_.svgOnTop?o:a,this._canvasEl=N_.svgOnTop?a:o,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,e,n,r,i),this._svgRenderer.initialize(this._svgEl,e,n,r,i),F_.initialize.call(this,t,e,n,r,i)},dirty(t){return N_.svgMarkTypes.includes(t.mark.marktype)?this._svgRenderer.dirty(t):this._canvasRenderer.dirty(t),this},_render(t,e){const n=(null!==e&&void 0!==e?e:["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter((t=>!N_.svgMarkTypes.includes(t)));this._svgRenderer.render(t,N_.svgMarkTypes),this._canvasRenderer.render(t,n)},resize(t,e,n,r){return F_.resize.call(this,t,e,n,r),this._svgRenderer.resize(t,e,n,r),this._canvasRenderer.resize(t,e,n,r),this},background(t){return N_.svgOnTop?this._canvasRenderer.background(t):this._svgRenderer.background(t),this}}),jn(I_,Rk,{initialize(t,e,n){const r=uk(uk(t,0,"div"),N_.svgOnTop?0:1,"div");return Rk.prototype.initialize.call(this,r,e,n)}});const M_="canvas",O_="hybrid",R_="none",z_={Canvas:M_,PNG:"png",SVG:"svg",Hybrid:O_,None:R_},B_={};function L_(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(B_[t]=e,this):B_[t]}function P_(t,e,n,r){if(function(t,e,n){return t.bounds&&e.intersects(t.bounds)&&("group"===t.marktype||!1!==t.interactive&&(!n||n(t)))}(t,e,n)){const i=t.items,a=t.marktype,o=i.length;let s=0;if("group"===a)for(;s<o;++s)j_(i[s],e,n,r);else for(const t=Jw[a].isect;s<o;++s){const n=i[s];U_(n,e,t)&&r.push(n)}}return r}function j_(t,e,n,r){n&&n(t.mark)&&U_(t,e,Jw.group.isect)&&r.push(t);const i=t.items,a=i&&i.length;if(a){const o=t.x||0,s=t.y||0;e.translate(-o,-s);for(let t=0;t<a;++t)P_(i[t],e,n,r);e.translate(o,s)}return r}function U_(t,e,n){const r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}B_[M_]=B_.png={renderer:Uk,headless:Uk,handler:Rk},B_.svg={renderer:p_,headless:T_,handler:Vk},B_[O_]={renderer:D_,headless:D_,handler:I_},B_[R_]={};const W_=new rx;const V_="top",q_="left",G_="right",H_="bottom",Y_="top-left",X_="top-right",K_="bottom-left",$_="bottom-right",Z_="start",Q_="middle",J_="end",tS="x",eS="y",nS="group",rS="axis",iS="title",aS="frame",oS="scope",sS="legend",cS="row-header",uS="row-footer",lS="row-title",hS="column-header",dS="column-footer",fS="column-title",pS="padding",gS="symbol",mS="fit",yS="fit-x",vS="fit-y",bS="pad",xS="none",wS="all",kS="each",_S="flush",SS="column",AS="row";function CS(t){Ic.call(this,null,t)}function ES(t,e,n){return e(t.bounds.clear(),t,n)}jn(CS,Ic,{transform(t,e){const n=e.dataflow,r=t.mark,i=r.marktype,a=Jw[i],o=a.bound;let s,c=r.bounds;if(a.nested)r.items.length&&n.dirty(r.items[0]),c=ES(r,o),r.items.forEach((t=>{t.bounds.clear().union(c)}));else if(i===nS||t.modified())switch(e.visit(e.MOD,(t=>n.dirty(t))),c.clear(),r.items.forEach((t=>c.union(ES(t,o)))),r.role){case rS:case sS:case iS:e.reflow()}else s=e.changed(e.REM),e.visit(e.ADD,(t=>{c.union(ES(t,o))})),e.visit(e.MOD,(t=>{s=s||c.alignsWith(t.bounds),n.dirty(t),c.union(ES(t,o))})),s&&(c.clear(),r.items.forEach((t=>c.union(t.bounds))));return function(t){const e=t.clip;if(An(e))e(Ex(W_.clear()));else{if(!e)return;W_.set(0,0,t.group.width,t.group.height)}t.bounds.intersect(W_)}(r),e.modifies("bounds")}});const TS=":vega_identifier:";function NS(t){Ic.call(this,0,t)}function DS(t){Ic.call(this,null,t)}function FS(t){Ic.call(this,null,t)}NS.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},jn(NS,Ic,{transform(t,e){const n=(i=e.dataflow)._signals[TS]||(i._signals[TS]=i.add(0)),r=t.as;var i;let a=n.value;return e.visit(e.ADD,(t=>t[r]=t[r]||++a)),n.set(this.value=a),e}}),jn(DS,Ic,{transform(t,e){let n=this.value;n||(n=e.dataflow.scenegraph().mark(t.markdef,function(t){const e=t.groups,n=t.parent;return e&&1===e.size?e.get(Object.keys(e.object)[0]):e&&n?e.lookup(n):null}(t),t.index),n.group.context=t.context,t.context.group||(t.context.group=n.group),n.source=this.source,n.clip=t.clip,n.interactive=t.interactive,this.value=n);const r=n.marktype===nS?ax:ix;return e.visit(e.ADD,(t=>r.call(t,n))),(t.modified("clip")||t.modified("interactive"))&&(n.clip=t.clip,n.interactive=!!t.interactive,n.zdirty=!0,e.reflow()),n.items=e.source,e}});const IS={parity:t=>t.filter(((t,e)=>e%2?t.opacity=0:1)),greedy:(t,e)=>{let n;return t.filter(((t,r)=>r&&MS(n.bounds,t.bounds,e)?t.opacity=0:(n=t,1)))}},MS=(t,e,n)=>n>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2),OS=(t,e)=>{for(var n,r=1,i=t.length,a=t[0].bounds;r<i;a=n,++r)if(MS(a,n=t[r].bounds,e))return!0},RS=t=>{const e=t.bounds;return e.width()>1&&e.height()>1},zS=t=>(t.forEach((t=>t.opacity=1)),t),BS=(t,e)=>t.reflow(e.modified()).modifies("opacity");function LS(t){Ic.call(this,null,t)}jn(FS,Ic,{transform(t,e){const n=IS[t.method]||IS.parity,r=t.separation||0;let i,a,o=e.materialize(e.SOURCE).source;if(!o||!o.length)return;if(!t.method)return t.modified("method")&&(zS(o),e=BS(e,t)),e;if(o=o.filter(RS),!o.length)return;if(t.sort&&(o=o.slice().sort(t.sort)),i=zS(o),e=BS(e,t),i.length>=3&&OS(i,r)){do{i=n(i,r)}while(i.length>=3&&OS(i,r));i.length<3&&!hn(o).opacity&&(i.length>1&&(hn(i).opacity=0),hn(o).opacity=1)}t.boundScale&&t.boundTolerance>=0&&(a=((t,e,n)=>{var r=t.range(),i=new rx;return e===V_||e===H_?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),t=>i.encloses(t.bounds)})(t.boundScale,t.boundOrient,+t.boundTolerance),o.forEach((t=>{a(t)||(t.opacity=0)})));const s=i[0].mark.bounds.clear();return o.forEach((t=>{t.opacity&&s.union(t.bounds)})),e}}),jn(LS,Ic,{transform(t,e){const n=e.dataflow;if(e.visit(e.ALL,(t=>n.dirty(t))),e.fields&&e.fields.zindex){const t=e.source&&e.source[0];t&&(t.mark.zdirty=!0)}}});const PS=new rx;function jS(t,e,n){return t[e]===n?0:(t[e]=n,1)}function US(t){var e=t.items[0].orient;return e===q_||e===G_}function WS(t,e,n,r){var i,a,o=e.items[0],s=o.datum,c=null!=o.translate?o.translate:.5,u=o.orient,l=function(t){let e=+t.grid;return[t.ticks?e++:-1,t.labels?e++:-1,e+ +t.domain]}(s),h=o.range,d=o.offset,f=o.position,p=o.minExtent,g=o.maxExtent,m=s.title&&o.items[l[2]].items[0],y=o.titlePadding,v=o.bounds,b=m&&Ww(m),x=0,w=0;switch(PS.clear().union(v),v.clear(),(i=l[0])>-1&&v.union(o.items[i].bounds),(i=l[1])>-1&&v.union(o.items[i].bounds),u){case V_:x=f||0,w=-d,a=Math.max(p,Math.min(g,-v.y1)),v.add(0,-a).add(h,0),m&&VS(t,m,a,y,b,0,-1,v);break;case q_:x=-d,w=f||0,a=Math.max(p,Math.min(g,-v.x1)),v.add(-a,0).add(0,h),m&&VS(t,m,a,y,b,1,-1,v);break;case G_:x=n+d,w=f||0,a=Math.max(p,Math.min(g,v.x2)),v.add(0,0).add(a,h),m&&VS(t,m,a,y,b,1,1,v);break;case H_:x=f||0,w=r+d,a=Math.max(p,Math.min(g,v.y2)),v.add(0,0).add(h,a),m&&VS(t,m,a,y,0,0,1,v);break;default:x=o.x,w=o.y}return ux(v.translate(x,w),o),jS(o,"x",x+c)|jS(o,"y",w+c)&&(o.bounds=PS,t.dirty(o),o.bounds=v,t.dirty(o)),o.mark.bounds.clear().union(v)}function VS(t,e,n,r,i,a,o,s){const c=e.bounds;if(e.auto){const s=o*(n+i+r);let u=0,l=0;t.dirty(e),a?u=(e.x||0)-(e.x=s):l=(e.y||0)-(e.y=s),e.mark.bounds.clear().union(c.translate(-u,-l)),t.dirty(e)}s.union(c)}const qS=(t,e)=>Math.floor(Math.min(t,e)),GS=(t,e)=>Math.ceil(Math.max(t,e));function HS(t){return(new rx).set(0,0,t.width||0,t.height||0)}function YS(t){const e=t.bounds.clone();return e.empty()?e.set(0,0,0,0):e.translate(-(t.x||0),-(t.y||0))}function XS(t,e,n){const r=sn(t)?t[e]:t;return null!=r?r:void 0!==n?n:0}function KS(t){return t<0?Math.ceil(-t):0}function $S(t,e,n){var r,i,a,o,s,c,u,l,h,d,f,p=!n.nodirty,g=n.bounds===_S?HS:YS,m=PS.set(0,0,0,0),y=XS(n.align,SS),v=XS(n.align,AS),b=XS(n.padding,SS),x=XS(n.padding,AS),w=n.columns||e.length,k=w<=0?1:Math.ceil(e.length/w),_=e.length,S=Array(_),A=Array(w),C=0,E=Array(_),T=Array(k),N=0,D=Array(_),F=Array(_),I=Array(_);for(i=0;i<w;++i)A[i]=0;for(i=0;i<k;++i)T[i]=0;for(i=0;i<_;++i)c=e[i],s=I[i]=g(c),c.x=c.x||0,D[i]=0,c.y=c.y||0,F[i]=0,a=i%w,o=~~(i/w),C=Math.max(C,u=Math.ceil(s.x2)),N=Math.max(N,l=Math.ceil(s.y2)),A[a]=Math.max(A[a],u),T[o]=Math.max(T[o],l),S[i]=b+KS(s.x1),E[i]=x+KS(s.y1),p&&t.dirty(e[i]);for(i=0;i<_;++i)i%w===0&&(S[i]=0),i<w&&(E[i]=0);if(y===kS)for(a=1;a<w;++a){for(f=0,i=a;i<_;i+=w)f<S[i]&&(f=S[i]);for(i=a;i<_;i+=w)S[i]=f+A[a-1]}else if(y===wS){for(f=0,i=0;i<_;++i)i%w&&f<S[i]&&(f=S[i]);for(i=0;i<_;++i)i%w&&(S[i]=f+C)}else for(y=!1,a=1;a<w;++a)for(i=a;i<_;i+=w)S[i]+=A[a-1];if(v===kS)for(o=1;o<k;++o){for(f=0,r=(i=o*w)+w;i<r;++i)f<E[i]&&(f=E[i]);for(i=o*w;i<r;++i)E[i]=f+T[o-1]}else if(v===wS){for(f=0,i=w;i<_;++i)f<E[i]&&(f=E[i]);for(i=w;i<_;++i)E[i]=f+N}else for(v=!1,o=1;o<k;++o)for(r=(i=o*w)+w;i<r;++i)E[i]+=T[o-1];for(h=0,i=0;i<_;++i)h=S[i]+(i%w?h:0),D[i]+=h-e[i].x;for(a=0;a<w;++a)for(d=0,i=a;i<_;i+=w)d+=E[i],F[i]+=d-e[i].y;if(y&&XS(n.center,SS)&&k>1)for(i=0;i<_;++i)(h=(s=y===wS?C:A[i%w])-I[i].x2-e[i].x-D[i])>0&&(D[i]+=h/2);if(v&&XS(n.center,AS)&&1!==w)for(i=0;i<_;++i)(d=(s=v===wS?N:T[~~(i/w)])-I[i].y2-e[i].y-F[i])>0&&(F[i]+=d/2);for(i=0;i<_;++i)m.union(I[i].translate(D[i],F[i]));switch(h=XS(n.anchor,tS),d=XS(n.anchor,eS),XS(n.anchor,SS)){case J_:h-=m.width();break;case Q_:h-=m.width()/2}switch(XS(n.anchor,AS)){case J_:d-=m.height();break;case Q_:d-=m.height()/2}for(h=Math.round(h),d=Math.round(d),m.clear(),i=0;i<_;++i)e[i].mark.bounds.clear();for(i=0;i<_;++i)(c=e[i]).x+=D[i]+=h,c.y+=F[i]+=d,m.union(c.mark.bounds.union(c.bounds.translate(D[i],F[i]))),p&&t.dirty(c);return m}function ZS(t,e,n){var r,i,a,o,s,c,u,l=function(t){var e,n,r=t.items,i=r.length,a=0;const o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;a<i;++a)if(n=(e=r[a]).items,e.marktype===nS)switch(e.role){case rS:case sS:case iS:break;case cS:o.rowheaders.push(...n);break;case uS:o.rowfooters.push(...n);break;case hS:o.colheaders.push(...n);break;case dS:o.colfooters.push(...n);break;case lS:o.rowtitle=n[0];break;case fS:o.coltitle=n[0];break;default:o.marks.push(...n)}return o}(e),h=l.marks,d=n.bounds===_S?QS:JS,f=n.offset,p=n.columns||h.length,g=p<=0?1:Math.ceil(h.length/p),m=g*p;const y=$S(t,h,n);y.empty()&&y.set(0,0,0,0),l.rowheaders&&(c=XS(n.headerBand,AS,null),r=tA(t,l.rowheaders,h,p,g,-XS(f,"rowHeader"),qS,0,d,"x1",0,p,1,c)),l.colheaders&&(c=XS(n.headerBand,SS,null),i=tA(t,l.colheaders,h,p,p,-XS(f,"columnHeader"),qS,1,d,"y1",0,1,p,c)),l.rowfooters&&(c=XS(n.footerBand,AS,null),a=tA(t,l.rowfooters,h,p,g,XS(f,"rowFooter"),GS,0,d,"x2",p-1,p,1,c)),l.colfooters&&(c=XS(n.footerBand,SS,null),o=tA(t,l.colfooters,h,p,p,XS(f,"columnFooter"),GS,1,d,"y2",m-p,1,p,c)),l.rowtitle&&(s=XS(n.titleAnchor,AS),u=XS(f,"rowTitle"),u=s===J_?a+u:r-u,c=XS(n.titleBand,AS,.5),eA(t,l.rowtitle,u,0,y,c)),l.coltitle&&(s=XS(n.titleAnchor,SS),u=XS(f,"columnTitle"),u=s===J_?o+u:i-u,c=XS(n.titleBand,SS,.5),eA(t,l.coltitle,u,1,y,c))}function QS(t,e){return"x1"===e?t.x||0:"y1"===e?t.y||0:"x2"===e?(t.x||0)+(t.width||0):"y2"===e?(t.y||0)+(t.height||0):void 0}function JS(t,e){return t.bounds[e]}function tA(t,e,n,r,i,a,o,s,c,u,l,h,d,f){var p,g,m,y,v,b,x,w,k,_=n.length,S=0,A=0;if(!_)return S;for(p=l;p<_;p+=h)n[p]&&(S=o(S,c(n[p],u)));if(!e.length)return S;for(e.length>i&&(t.warn("Grid headers exceed limit: "+i),e=e.slice(0,i)),S+=a,g=0,y=e.length;g<y;++g)t.dirty(e[g]),e[g].mark.bounds.clear();for(p=l,g=0,y=e.length;g<y;++g,p+=h){for(v=(b=e[g]).mark.bounds,m=p;m>=0&&null==(x=n[m]);m-=d);s?(w=null==f?x.x:Math.round(x.bounds.x1+f*x.bounds.width()),k=S):(w=S,k=null==f?x.y:Math.round(x.bounds.y1+f*x.bounds.height())),v.union(b.bounds.translate(w-(b.x||0),k-(b.y||0))),b.x=w,b.y=k,t.dirty(b),A=o(A,v[u])}return A}function eA(t,e,n,r,i,a){if(e){t.dirty(e);var o=n,s=n;r?o=Math.round(i.x1+a*i.width()):s=Math.round(i.y1+a*i.height()),e.bounds.translate(o-(e.x||0),s-(e.y||0)),e.mark.bounds.clear().union(e.bounds),e.x=o,e.y=s,t.dirty(e)}}function nA(t,e,n,r,i,a,o){const s=function(t,e){const n=t[e]||{};return(e,r)=>null!=n[e]?n[e]:null!=t[e]?t[e]:r}(n,e),c=function(t,e){let n=-1/0;return t.forEach((t=>{null!=t.offset&&(n=Math.max(n,t.offset))})),n>-1/0?n:e}(t,s("offset",0)),u=s("anchor",Z_),l=u===J_?1:u===Q_?.5:0,h={align:kS,bounds:s("bounds",_S),columns:"vertical"===s("direction")?1:t.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(e){case q_:h.anchor={x:Math.floor(r.x1)-c,column:J_,y:l*(o||r.height()+2*r.y1),row:u};break;case G_:h.anchor={x:Math.ceil(r.x2)+c,y:l*(o||r.height()+2*r.y1),row:u};break;case V_:h.anchor={y:Math.floor(i.y1)-c,row:J_,x:l*(a||i.width()+2*i.x1),column:u};break;case H_:h.anchor={y:Math.ceil(i.y2)+c,x:l*(a||i.width()+2*i.x1),column:u};break;case Y_:h.anchor={x:c,y:c};break;case X_:h.anchor={x:a-c,y:c,column:J_};break;case K_:h.anchor={x:c,y:o-c,row:J_};break;case $_:h.anchor={x:a-c,y:o-c,column:J_,row:J_}}return h}function rA(t,e){var n,r,i=e.items[0],a=i.datum,o=i.orient,s=i.bounds,c=i.x,u=i.y;return i._bounds?i._bounds.clear().union(s):i._bounds=s.clone(),s.clear(),function(t,e,n){var r=e.padding,i=r-n.x,a=r-n.y;if(e.datum.title){var o=e.items[1].items[0],s=o.anchor,c=e.titlePadding||0,u=r-o.x,l=r-o.y;switch(o.orient){case q_:i+=Math.ceil(o.bounds.width())+c;break;case G_:case H_:break;default:a+=o.bounds.height()+c}switch((i||a)&&aA(t,n,i,a),o.orient){case q_:l+=iA(e,n,o,s,1,1);break;case G_:u+=iA(e,n,o,J_,0,0)+c,l+=iA(e,n,o,s,1,1);break;case H_:u+=iA(e,n,o,s,0,0),l+=iA(e,n,o,J_,-1,0,1)+c;break;default:u+=iA(e,n,o,s,0,0)}(u||l)&&aA(t,o,u,l),(u=Math.round(o.bounds.x1-r))<0&&(aA(t,n,-u,0),aA(t,o,-u,0))}else(i||a)&&aA(t,n,i,a)}(t,i,i.items[0].items[0]),s=function(t,e){return t.items.forEach((t=>e.union(t.bounds))),e.x1=t.padding,e.y1=t.padding,e}(i,s),n=2*i.padding,r=2*i.padding,s.empty()||(n=Math.ceil(s.width()+n),r=Math.ceil(s.height()+r)),a.type===gS&&function(t){const e=t.reduce(((t,e)=>(t[e.column]=Math.max(e.bounds.x2-e.x,t[e.column]||0),t)),{});t.forEach((t=>{t.width=e[t.column],t.height=t.bounds.y2-t.y}))}(i.items[0].items[0].items[0].items),o!==xS&&(i.x=c=0,i.y=u=0),i.width=n,i.height=r,ux(s.set(c,u,c+n,u+r),i),i.mark.bounds.clear().union(s),i}function iA(t,e,n,r,i,a,o){const s="symbol"!==t.datum.type,c=n.datum.vgrad,u=(!s||!a&&c||o?e:e.items[0]).bounds[i?"y2":"x2"]-t.padding,l=c&&a?u:0,h=c&&a?0:u,d=i<=0?0:Ww(n);return Math.round(r===Z_?l:r===J_?h-d:.5*(u-d))}function aA(t,e,n,r){e.x+=n,e.y+=r,e.bounds.translate(n,r),e.mark.bounds.translate(n,r),t.dirty(e)}function oA(t){Ic.call(this,null,t)}function sA(t,e){let n=0;if(void 0===e)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}function cA(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function uA(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function lA(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function hA(){}jn(oA,Ic,{transform(t,e){const n=e.dataflow;return t.mark.items.forEach((e=>{t.layout&&ZS(n,e,t.layout),function(t,e,n){var r,i,a,o,s,c=e.items,u=Math.max(0,e.width||0),l=Math.max(0,e.height||0),h=(new rx).set(0,0,u,l),d=h.clone(),f=h.clone(),p=[];for(o=0,s=c.length;o<s;++o)switch((i=c[o]).role){case rS:(US(i)?d:f).union(WS(t,i,u,l));break;case iS:r=i;break;case sS:p.push(rA(t,i));break;case aS:case oS:case cS:case uS:case lS:case hS:case dS:case fS:d.union(i.bounds),f.union(i.bounds);break;default:h.union(i.bounds)}if(p.length){const e={};p.forEach((t=>{(a=t.orient||G_)!==xS&&(e[a]||(e[a]=[])).push(t)}));for(const r in e){const i=e[r];$S(t,i,nA(i,r,n.legends,d,f,u,l))}p.forEach((e=>{const r=e.bounds;if(r.equals(e._bounds)||(e.bounds=e._bounds,t.dirty(e),e.bounds=r,t.dirty(e)),!n.autosize||n.autosize.type!==mS&&n.autosize.type!==yS&&n.autosize.type!==vS)h.union(r);else switch(e.orient){case q_:case G_:h.add(r.x1,0).add(r.x2,0);break;case V_:case H_:h.add(0,r.y1).add(0,r.y2)}}))}h.union(d).union(f),r&&h.union(function(t,e,n,r,i){var a,o=e.items[0],s=o.frame,c=o.orient,u=o.anchor,l=o.offset,h=o.padding,d=o.items[0].items[0],f=o.items[1]&&o.items[1].items[0],p=c===q_||c===G_?r:n,g=0,m=0,y=0,v=0,b=0;if(s!==nS?c===q_?(g=i.y2,p=i.y1):c===G_?(g=i.y1,p=i.y2):(g=i.x1,p=i.x2):c===q_&&(g=r,p=0),a=u===Z_?g:u===J_?p:(g+p)/2,f&&f.text){switch(c){case V_:case H_:b=d.bounds.height()+h;break;case q_:v=d.bounds.width()+h;break;case G_:v=-d.bounds.width()-h}PS.clear().union(f.bounds),PS.translate(v-(f.x||0),b-(f.y||0)),jS(f,"x",v)|jS(f,"y",b)&&(t.dirty(f),f.bounds.clear().union(PS),f.mark.bounds.clear().union(PS),t.dirty(f)),PS.clear().union(f.bounds)}else PS.clear();switch(PS.union(d.bounds),c){case V_:m=a,y=i.y1-PS.height()-l;break;case q_:m=i.x1-PS.width()-l,y=a;break;case G_:m=i.x2+PS.width()+l,y=a;break;case H_:m=a,y=i.y2+l;break;default:m=o.x,y=o.y}return jS(o,"x",m)|jS(o,"y",y)&&(PS.translate(m,y),t.dirty(o),o.bounds.clear().union(PS),e.bounds.clear().union(PS),t.dirty(o)),o.bounds}(t,r,u,l,h));e.clip&&h.set(0,0,e.width||0,e.height||0);!function(t,e,n,r){const i=r.autosize||{},a=i.type;if(t._autosize<1||!a)return;let o=t._width,s=t._height,c=Math.max(0,e.width||0),u=Math.max(0,Math.ceil(-n.x1)),l=Math.max(0,e.height||0),h=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-c)),f=Math.max(0,Math.ceil(n.y2-l));if(i.contains===pS){const e=t.padding();o-=e.left+e.right,s-=e.top+e.bottom}a===xS?(u=0,h=0,c=o,l=s):a===mS?(c=Math.max(0,o-u-d),l=Math.max(0,s-h-f)):a===yS?(c=Math.max(0,o-u-d),s=l+h+f):a===vS?(o=c+u+d,l=Math.max(0,s-h-f)):a===bS&&(o=c+u+d,s=l+h+f);t._resizeView(o,s,c,l,[u,h],i.resize)}(t,e,h,n)}(n,e,t)})),function(t){return t&&"legend-entry"!==t.mark.role}(t.mark.group)?e.reflow():e}});var dA=.7,fA=1.4285714285714286,pA="\\s*([+-]?\\d+)\\s*",gA="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",mA="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",yA=/^#([0-9a-f]{3,8})$/,vA=new RegExp("^rgb\\("+[pA,pA,pA]+"\\)$"),bA=new RegExp("^rgb\\("+[mA,mA,mA]+"\\)$"),xA=new RegExp("^rgba\\("+[pA,pA,pA,gA]+"\\)$"),wA=new RegExp("^rgba\\("+[mA,mA,mA,gA]+"\\)$"),kA=new RegExp("^hsl\\("+[gA,mA,mA]+"\\)$"),_A=new RegExp("^hsla\\("+[gA,mA,mA,gA]+"\\)$"),SA={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function AA(){return this.rgb().formatHex()}function CA(){return this.rgb().formatRgb()}function EA(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=yA.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?TA(e):3===n?new IA(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?NA(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?NA(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=vA.exec(t))?new IA(e[1],e[2],e[3],1):(e=bA.exec(t))?new IA(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=xA.exec(t))?NA(e[1],e[2],e[3],e[4]):(e=wA.exec(t))?NA(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=kA.exec(t))?zA(e[1],e[2]/100,e[3]/100,1):(e=_A.exec(t))?zA(e[1],e[2]/100,e[3]/100,e[4]):SA.hasOwnProperty(t)?TA(SA[t]):"transparent"===t?new IA(NaN,NaN,NaN,0):null}function TA(t){return new IA(t>>16&255,t>>8&255,255&t,1)}function NA(t,e,n,r){return r<=0&&(t=e=n=NaN),new IA(t,e,n,r)}function DA(t){return t instanceof hA||(t=EA(t)),t?new IA((t=t.rgb()).r,t.g,t.b,t.opacity):new IA}function FA(t,e,n,r){return 1===arguments.length?DA(t):new IA(t,e,n,null==r?1:r)}function IA(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function MA(){return"#"+RA(this.r)+RA(this.g)+RA(this.b)}function OA(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function RA(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function zA(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new PA(t,e,n,r)}function BA(t){if(t instanceof PA)return new PA(t.h,t.s,t.l,t.opacity);if(t instanceof hA||(t=EA(t)),!t)return new PA;if(t instanceof PA)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new PA(o,s,c,t.opacity)}function LA(t,e,n,r){return 1===arguments.length?BA(t):new PA(t,e,n,null==r?1:r)}function PA(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function jA(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function UA(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}function WA(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,s=r<e-1?t[r+2]:2*a-i;return UA((n-r/e)*e,o,i,a,s)}}function VA(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],s=t[(r+2)%e];return UA((n-r/e)*e,i,a,o,s)}}uA(hA,EA,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:AA,formatHex:AA,formatHsl:function(){return BA(this).formatHsl()},formatRgb:CA,toString:CA}),uA(IA,FA,lA(hA,{brighter:function(t){return t=null==t?fA:Math.pow(fA,t),new IA(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?dA:Math.pow(dA,t),new IA(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:MA,formatHex:MA,formatRgb:OA,toString:OA})),uA(PA,LA,lA(hA,{brighter:function(t){return t=null==t?fA:Math.pow(fA,t),new PA(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?dA:Math.pow(dA,t),new PA(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new IA(jA(t>=240?t-240:t+120,i,r),jA(t,i,r),jA(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));const qA=t=>()=>t;function GA(t,e){return function(n){return t+n*e}}function HA(t,e){var n=e-t;return n?GA(t,n>180||n<-180?n-360*Math.round(n/360):n):qA(isNaN(t)?e:t)}function YA(t){return 1===(t=+t)?XA:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):qA(isNaN(e)?n:e)}}function XA(t,e){var n=e-t;return n?GA(t,n):qA(isNaN(t)?e:t)}const KA=function t(e){var n=YA(e);function r(t,e){var r=n((t=FA(t)).r,(e=FA(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=XA(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function $A(t){return function(e){var n,r,i=e.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=FA(e[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=t(a),o=t(o),s=t(s),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=s(t),r+""}}}var ZA=$A(WA),QA=$A(VA);function JA(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(a){for(n=0;n<r;++n)i[n]=t[n]*(1-a)+e[n]*a;return i}}function tC(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function eC(t,e){return(tC(e)?JA:nC)(t,e)}function nC(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=uC(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}function rC(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function iC(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function aC(t,e){var n,r={},i={};for(n in null!==t&&"object"===typeof t||(t={}),null!==e&&"object"===typeof e||(e={}),e)n in t?r[n]=uC(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var oC=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,sC=new RegExp(oC.source,"g");function cC(t,e){var n,r,i,a=oC.lastIndex=sC.lastIndex=0,o=-1,s=[],c=[];for(t+="",e+="";(n=oC.exec(t))&&(r=sC.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,c.push({i:o,x:iC(n,r)})),a=sC.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?c[0]?function(t){return function(e){return t(e)+""}}(c[0].x):function(t){return function(){return t}}(e):(e=c.length,function(t){for(var n,r=0;r<e;++r)s[(n=c[r]).i]=n.x(t);return s.join("")})}function uC(t,e){var n,r=typeof e;return null==e||"boolean"===r?qA(e):("number"===r?iC:"string"===r?(n=EA(e))?(e=n,KA):cC:e instanceof EA?KA:e instanceof Date?rC:tC(e)?JA:Array.isArray(e)?nC:"function"!==typeof e.valueOf&&"function"!==typeof e.toString||isNaN(e)?aC:iC)(t,e)}function lC(t){Ic.call(this,null,t)}function hC(t){Ic.call(this,null,t)}function dC(){return ec({})}function fC(t){Ic.call(this,null,t)}function pC(t){Ic.call(this,[],t)}jn(lC,Ic,{transform(t,e){if(this.value&&!t.modified())return e.StopPropagation;var n=e.dataflow.locale(),r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=this.value,a=t.scale,o=Vv(a,null==t.count?t.values?t.values.length:10:t.count,t.minstep),s=t.format||Hv(n,a,o,t.formatSpecifier,t.formatType,!!t.values),c=t.values?qv(a,t.values,o):Gv(a,o);return i&&(r.rem=i),i=c.map(((t,e)=>ec({index:e/(c.length-1||1),value:t,label:s(t)}))),t.extra&&i.length&&i.push(ec({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}}),jn(hC,Ic,{transform(t,e){var n=e.dataflow,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.item||dC,a=t.key||Js,o=this.value;return on(r.encode)&&(r.encode=null),o&&(t.modified("key")||e.modified(a))&&qe("DataJoin does not support modified key function or fields."),o||(e=e.addAll(),this.value=o=function(t){const e=Pn().test((t=>t.exit));return e.lookup=n=>e.get(t(n)),e}(a)),e.visit(e.ADD,(t=>{const e=a(t);let n=o.get(e);n?n.exit?(o.empty--,r.add.push(n)):r.mod.push(n):(n=i(t),o.set(e,n),r.add.push(n)),n.datum=t,n.exit=!1})),e.visit(e.MOD,(t=>{const e=a(t),n=o.get(e);n&&(n.datum=t,r.mod.push(n))})),e.visit(e.REM,(t=>{const e=a(t),n=o.get(e);t!==n.datum||n.exit||(r.rem.push(n),n.exit=!0,++o.empty)})),e.changed(e.ADD_MOD)&&r.modifies("datum"),(e.clean()||t.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),r}}),jn(fC,Ic,{transform(t,e){var n=e.fork(e.ADD_REM),r=t.mod||!1,i=t.encoders,a=e.encode;if(on(a)){if(!n.changed()&&!a.every((t=>i[t])))return e.StopPropagation;a=a[0],n.encode=null}var o="enter"===a,s=i.update||Qe,c=i.enter||Qe,u=i.exit||Qe,l=(a&&!o?i[a]:s)||Qe;if(e.changed(e.ADD)&&(e.visit(e.ADD,(e=>{c(e,t),s(e,t)})),n.modifies(c.output),n.modifies(s.output),l!==Qe&&l!==s&&(e.visit(e.ADD,(e=>{l(e,t)})),n.modifies(l.output))),e.changed(e.REM)&&u!==Qe&&(e.visit(e.REM,(e=>{u(e,t)})),n.modifies(u.output)),o||l!==Qe){const i=e.MOD|(t.modified()?e.REFLOW:0);o?(e.visit(i,(e=>{const i=c(e,t)||r;(l(e,t)||i)&&n.mod.push(e)})),n.mod.length&&n.modifies(c.output)):e.visit(i,(e=>{(l(e,t)||r)&&n.mod.push(e)})),n.mod.length&&n.modifies(l.output)}return n.changed()?n:e.StopPropagation}}),jn(pC,Ic,{transform(t,e){if(null!=this.value&&!t.modified())return e.StopPropagation;var n,r,i,a,o,s=e.dataflow.locale(),c=e.fork(e.NO_SOURCE|e.NO_FIELDS),u=this.value,l=t.type||Lv,h=t.scale,d=+t.limit,f=Vv(h,null==t.count?5:t.count,t.minstep),p=!!t.values||l===Lv,g=t.format||Qv(s,h,f,l,t.formatSpecifier,t.formatType,p),m=t.values||$v(h,f);return u&&(c.rem=u),l===Lv?(d&&m.length>d?(e.dataflow.warn("Symbol legend count exceeds limit, filtering items."),u=m.slice(0,d-1),o=!0):u=m,An(i=t.size)?(t.values||0!==h(u[0])||(u=u.slice(1)),a=u.reduce(((e,n)=>Math.max(e,i(n,t))),0)):i=In(a=i||8),u=u.map(((e,n)=>ec({index:n,label:g(e,n,u),value:e,offset:a,size:i(e,t)}))),o&&(o=m[u.length],u.push(ec({index:u.length,label:"\u2026".concat(m.length-u.length," entries"),value:o,offset:a,size:i(o,t)})))):"gradient"===l?(n=h.domain(),r=Iv(h,n[0],hn(n)),m.length<3&&!t.values&&n[0]!==hn(n)&&(m=[n[0],hn(n)]),u=m.map(((t,e)=>ec({index:e,label:g(t,e,m),value:t,perc:r(t)})))):(i=m.length-1,r=function(t){const e=t.domain(),n=e.length-1;let r=+e[0],i=+hn(e),a=i-r;if(t.type===iv){const t=n?a/n:.1;r-=t,i+=t,a=i-r}return t=>(t-r)/a}(h),u=m.map(((t,e)=>ec({index:e,label:g(t,e,m),value:t,perc:e?r(t):0,perc2:e===i?1:r(m[e+1])})))),c.source=u,c.add=u,this.value=u,c}});const gC=t=>t.source.x,mC=t=>t.source.y,yC=t=>t.target.x,vC=t=>t.target.y;function bC(t){Ic.call(this,{},t)}bC.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},jn(bC,Ic,{transform(t,e){var n=t.sourceX||gC,r=t.sourceY||mC,i=t.targetX||yC,a=t.targetY||vC,o=t.as||"path",s=t.orient||"vertical",c=t.shape||"line",u=_C.get(c+"-"+s)||_C.get(c);return u||qe("LinkPath unsupported type: "+t.shape+(t.orient?"-"+t.orient:"")),e.visit(e.SOURCE,(t=>{t[o]=u(n(t),r(t),i(t),a(t))})),e.reflow(t.modified()).modifies(o)}});const xC=(t,e,n,r)=>"M"+t+","+e+"L"+n+","+r,wC=(t,e,n,r)=>{var i=n-t,a=r-e,o=Math.sqrt(i*i+a*a)/2;return"M"+t+","+e+"A"+o+","+o+" "+180*Math.atan2(a,i)/Math.PI+" 0 1 "+n+","+r},kC=(t,e,n,r)=>{const i=n-t,a=r-e,o=.2*(i+a),s=.2*(a-i);return"M"+t+","+e+"C"+(t+o)+","+(e+s)+" "+(n+s)+","+(r-o)+" "+n+","+r},_C=Pn({line:xC,"line-radial":(t,e,n,r)=>xC(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),arc:wC,"arc-radial":(t,e,n,r)=>wC(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),curve:kC,"curve-radial":(t,e,n,r)=>kC(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),"orthogonal-horizontal":(t,e,n,r)=>"M"+t+","+e+"V"+r+"H"+n,"orthogonal-vertical":(t,e,n,r)=>"M"+t+","+e+"H"+n+"V"+r,"orthogonal-radial":(t,e,n,r)=>{const i=Math.cos(t),a=Math.sin(t),o=Math.cos(n),s=Math.sin(n);return"M"+e*i+","+e*a+"A"+e+","+e+" 0 0,"+((Math.abs(n-t)>Math.PI?n<=t:n>t)?1:0)+" "+e*o+","+e*s+"L"+r*o+","+r*s},"diagonal-horizontal":(t,e,n,r)=>{const i=(t+n)/2;return"M"+t+","+e+"C"+i+","+e+" "+i+","+r+" "+n+","+r},"diagonal-vertical":(t,e,n,r)=>{const i=(e+r)/2;return"M"+t+","+e+"C"+t+","+i+" "+n+","+i+" "+n+","+r},"diagonal-radial":(t,e,n,r)=>{const i=Math.cos(t),a=Math.sin(t),o=Math.cos(n),s=Math.sin(n),c=(e+r)/2;return"M"+e*i+","+e*a+"C"+c*i+","+c*a+" "+c*o+","+c*s+" "+r*o+","+r*s}});function SC(t){Ic.call(this,null,t)}SC.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},jn(SC,Ic,{transform(t,e){var n,r,i,a=t.as||["startAngle","endAngle"],o=a[0],s=a[1],c=t.field||$e,u=t.startAngle||0,l=null!=t.endAngle?t.endAngle:2*Math.PI,h=e.source,d=h.map(c),f=d.length,p=u,g=(l-u)/sA(d),m=zu(f);for(t.sort&&m.sort(((t,e)=>d[t]-d[e])),n=0;n<f;++n)i=d[m[n]],(r=h[m[n]])[o]=p,r[s]=p+=i*g;return this.value=d,e.reflow(t.modified()).modifies(a)}});const AC=5;function CC(t){return Sv(t)&&t!==tv}const EC=Jn(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function TC(t){Ic.call(this,null,t),this.modified(!0)}function NC(t,e,n){Ev(t)&&(Math.abs(e.reduce(((t,e)=>t+(e<0?-1:e>0?1:0)),0))!==e.length&&n.warn("Log scale domain includes zero: "+Xn(e)));return e}function DC(t,e,n){return An(t)&&(e||n)?function(t,e){const n=e[0],r=hn(e)-n;return function(e){return t(n+e*r)}}(t,FC(e||[0,1],n)):t}function FC(t,e){return e?t.slice().reverse():t}function IC(t){Ic.call(this,null,t)}jn(TC,Ic,{transform(t,e){var n=e.dataflow,r=this.value,i=function(t){var e,n=t.type,r="";if(n===tv)return tv+"-"+Yy;(function(t){const e=t.type;return Sv(e)&&e!==Qy&&e!==Jy&&(t.scheme||t.range&&t.range.length&&t.range.every(qn))})(t)&&(r=2===(e=t.rawDomain?t.rawDomain.length:t.domain?t.domain.length+ +(null!=t.domainMid):0)?tv+"-":3===e?ev+"-":"");return(r+n||Yy).toLowerCase()}(t);for(i in r&&i===r.type||(this.value=r=wv(i)()),t)if(!EC[i]){if("padding"===i&&CC(r.type))continue;An(r[i])?r[i](t[i]):n.warn("Unsupported scale property: "+i)}return function(t,e,n){var r=t.type,i=e.round||!1,a=e.range;if(null!=e.rangeStep)a=function(t,e,n){t!==sv&&t!==ov&&qe("Only band and point scales support rangeStep.");var r=(null!=e.paddingOuter?e.paddingOuter:e.padding)||0,i=t===ov?1:(null!=e.paddingInner?e.paddingInner:e.padding)||0;return[0,e.rangeStep*Hy(n,i,r)]}(r,e,n);else if(e.scheme&&(a=function(t,e,n){var r,i=e.schemeExtent;on(e.scheme)?r=Fv(e.scheme,e.interpolate,e.interpolateGamma):(r=Bv(e.scheme.toLowerCase()))||qe("Unrecognized scheme name: ".concat(e.scheme));return n=t===iv?n+1:t===cv?n-1:t===nv||t===rv?+e.schemeCount||AC:n,Tv(t)?DC(r,i,e.reverse):An(r)?function(t,e){const n=new Array(e),r=e+1;for(let i=0;i<e;)n[i]=t(++i/r);return n}(DC(r,i),n):t===av?r:r.slice(0,n)}(r,e,n),An(a))){if(t.interpolator)return t.interpolator(a);qe("Scale type ".concat(r," does not support interpolating color schemes."))}if(a&&Tv(r))return t.interpolator(Fv(FC(a,e.reverse),e.interpolate,e.interpolateGamma));a&&e.interpolate&&t.interpolate?t.interpolate(Mv(e.interpolate,e.interpolateGamma)):An(t.round)?t.round(i):An(t.rangeRound)&&t.interpolate(i?cA:uC);a&&t.range(FC(a,e.reverse))}(r,t,function(t,e,n){let r=e.bins;if(r&&!on(r)){const e=t.domain(),n=e[0],i=hn(e),a=r.step;let o=null==r.start?n:r.start,s=null==r.stop?i:r.stop;a||qe("Scale bins parameter missing step property."),o<n&&(o=a*Math.ceil(n/a)),s>i&&(s=a*Math.floor(i/a)),r=zu(o,s+a/2,a)}r?t.bins=r:t.bins&&delete t.bins;t.type===cv&&(r?e.domain||e.domainRaw||(t.domain(r),n=r.length):t.bins=t.domain());return n}(r,t,function(t,e,n){const r=function(t,e,n){return e?(t.domain(NC(t.type,e,n)),e.length):-1}(t,e.domainRaw,n);if(r>-1)return r;var i,a,o=e.domain,s=t.type,c=e.zero||void 0===e.zero&&function(t){const e=t.type;return!t.bins&&(e===Yy||e===Ky||e===$y)}(t);if(!o)return 0;CC(s)&&e.padding&&o[0]!==hn(o)&&(o=function(t,e,n,r,i,a){var o=Math.abs(hn(n)-n[0]),s=o/(o-2*r),c=t===Xy?wn(e,null,s):t===$y?kn(e,null,s,.5):t===Ky?kn(e,null,s,i||1):t===Zy?_n(e,null,s,a||1):xn(e,null,s);return e=e.slice(),e[0]=c[0],e[e.length-1]=c[1],e}(s,o,e.range,e.padding,e.exponent,e.constant));if((c||null!=e.domainMin||null!=e.domainMax||null!=e.domainMid)&&(i=(o=o.slice()).length-1||1,c&&(o[0]>0&&(o[0]=0),o[i]<0&&(o[i]=0)),null!=e.domainMin&&(o[0]=e.domainMin),null!=e.domainMax&&(o[i]=e.domainMax),null!=e.domainMid)){const t=(a=e.domainMid)>o[i]?i+1:a<o[0]?0:i;t!==i&&n.warn("Scale domainMid exceeds domain min or max.",a),o.splice(t,0,a)}t.domain(NC(s,o,n)),s===av&&t.unknown(e.domainImplicit?Pg:void 0);e.nice&&t.nice&&t.nice(!0!==e.nice&&Vv(t,e.nice)||null);return o.length}(r,t,n))),e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),jn(IC,Ic,{transform(t,e){const n=t.modified("sort")||e.changed(e.ADD)||e.modified(t.sort.fields)||e.modified("datum");return n&&e.source.sort(ac(t.sort)),this.modified(n),e}});const MC="zero",OC="center",RC="normalize",zC=["y0","y1"];function BC(t){Ic.call(this,null,t)}function LC(t,e,n,r,i){for(var a,o=(e-t.sum)/2,s=t.length,c=0;c<s;++c)(a=t[c])[r]=o,a[i]=o+=Math.abs(n(a))}function PC(t,e,n,r,i){for(var a,o=1/t.sum,s=0,c=t.length,u=0,l=0;u<c;++u)(a=t[u])[r]=s,a[i]=s=o*(l+=Math.abs(n(a)))}function jC(t,e,n,r,i){for(var a,o,s=0,c=0,u=t.length,l=0;l<u;++l)(a=+n(o=t[l]))<0?(o[r]=c,o[i]=c+=a):(o[r]=s,o[i]=s+=a)}BC.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:MC,values:[MC,OC,RC]},{name:"as",type:"string",array:!0,length:2,default:zC}]},jn(BC,Ic,{transform(t,e){var n,r,i,a,o=t.as||zC,s=o[0],c=o[1],u=ac(t.sort),l=t.field||$e,h=t.offset===OC?LC:t.offset===RC?PC:jC;for(n=function(t,e,n,r){var i,a,o,s,c,u,l,h,d,f=[],p=t=>t(c);if(null==e)f.push(t.slice());else for(i={},a=0,o=t.length;a<o;++a)c=t[a],(l=i[u=e.map(p)])||(i[u]=l=[],f.push(l)),l.push(c);for(u=0,d=0,s=f.length;u<s;++u){for(a=0,h=0,o=(l=f[u]).length;a<o;++a)h+=Math.abs(r(l[a]));l.sum=h,h>d&&(d=h),n&&l.sort(n)}return f.max=d,f}(e.source,t.groupby,u,l),r=0,i=n.length,a=n.max;r<i;++r)h(n[r],a,l,s,c);return e.reflow(t.modified()).modifies(o)}});var UC=Math.sqrt(50),WC=Math.sqrt(10),VC=Math.sqrt(2);function qC(t,e,n){var r,i,a,o,s=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(o=GC(t,e,n))||!isFinite(o))return[];if(o>0){let n=Math.round(t/o),r=Math.round(e/o);for(n*o<t&&++n,r*o>e&&--r,a=new Array(i=r-n+1);++s<i;)a[s]=(n+s)*o}else{o=-o;let n=Math.round(t*o),r=Math.round(e*o);for(n/o<t&&++n,r/o>e&&--r,a=new Array(i=r-n+1);++s<i;)a[s]=(n+s)/o}return r&&a.reverse(),a}function GC(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=UC?10:a>=WC?5:a>=VC?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=UC?10:a>=WC?5:a>=VC?2:1)}function HC(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=UC?i*=10:a>=WC?i*=5:a>=VC&&(i*=2),e<t?-i:i}const YC=t=>t;function XC(t,e){t&&$C.hasOwnProperty(t.type)&&$C[t.type](t,e)}var KC={Feature:function(t,e){XC(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)XC(n[r].geometry,e)}},$C={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){ZC(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)ZC(n[r],e,0)},Polygon:function(t,e){QC(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)QC(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)XC(n[r],e)}};function ZC(t,e,n){var r,i=-1,a=t.length-n;for(e.lineStart();++i<a;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function QC(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)ZC(t[n],e,1);e.polygonEnd()}function JC(t,e){t&&KC.hasOwnProperty(t.type)?KC[t.type](t,e):XC(t,e)}class tE{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=e[r],a=t+i,o=Math.abs(t)<Math.abs(i)?t-(a-i):i-(a-t);o&&(e[n++]=o),t=a}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,r,i=this._n,a=0;if(i>0){for(a=t[--i];i>0&&(e=a,n=t[--i],a=e+n,r=n-(a-e),!r););i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(n=2*r,e=a+n,n==e-a&&(a=e))}return a}}var eE=1e-6,nE=1e-12,rE=Math.PI,iE=rE/2,aE=rE/4,oE=2*rE,sE=180/rE,cE=rE/180,uE=Math.abs,lE=Math.atan,hE=Math.atan2,dE=Math.cos,fE=(Math.ceil,Math.exp),pE=(Math.floor,Math.hypot,Math.log),gE=Math.pow,mE=Math.sin,yE=Math.sign||function(t){return t>0?1:t<0?-1:0},vE=Math.sqrt,bE=Math.tan;function xE(t){return t>1?0:t<-1?rE:Math.acos(t)}function wE(t){return t>1?iE:t<-1?-iE:Math.asin(t)}function kE(){}var _E,SE,AE,CE,EE=new tE,TE=new tE,NE={point:kE,lineStart:kE,lineEnd:kE,polygonStart:function(){NE.lineStart=DE,NE.lineEnd=ME},polygonEnd:function(){NE.lineStart=NE.lineEnd=NE.point=kE,EE.add(uE(TE)),TE=new tE},result:function(){var t=EE/2;return EE=new tE,t}};function DE(){NE.point=FE}function FE(t,e){NE.point=IE,_E=AE=t,SE=CE=e}function IE(t,e){TE.add(CE*t-AE*e),AE=t,CE=e}function ME(){IE(_E,SE)}const OE=NE;var RE=1/0,zE=RE,BE=-RE,LE=BE,PE={point:function(t,e){t<RE&&(RE=t);t>BE&&(BE=t);e<zE&&(zE=e);e>LE&&(LE=e)},lineStart:kE,lineEnd:kE,polygonStart:kE,polygonEnd:kE,result:function(){var t=[[RE,zE],[BE,LE]];return BE=LE=-(zE=RE=1/0),t}};const jE=PE;var UE,WE,VE,qE,GE=0,HE=0,YE=0,XE=0,KE=0,$E=0,ZE=0,QE=0,JE=0,tT={point:eT,lineStart:nT,lineEnd:aT,polygonStart:function(){tT.lineStart=oT,tT.lineEnd=sT},polygonEnd:function(){tT.point=eT,tT.lineStart=nT,tT.lineEnd=aT},result:function(){var t=JE?[ZE/JE,QE/JE]:$E?[XE/$E,KE/$E]:YE?[GE/YE,HE/YE]:[NaN,NaN];return GE=HE=YE=XE=KE=$E=ZE=QE=JE=0,t}};function eT(t,e){GE+=t,HE+=e,++YE}function nT(){tT.point=rT}function rT(t,e){tT.point=iT,eT(VE=t,qE=e)}function iT(t,e){var n=t-VE,r=e-qE,i=vE(n*n+r*r);XE+=i*(VE+t)/2,KE+=i*(qE+e)/2,$E+=i,eT(VE=t,qE=e)}function aT(){tT.point=eT}function oT(){tT.point=cT}function sT(){uT(UE,WE)}function cT(t,e){tT.point=uT,eT(UE=VE=t,WE=qE=e)}function uT(t,e){var n=t-VE,r=e-qE,i=vE(n*n+r*r);XE+=i*(VE+t)/2,KE+=i*(qE+e)/2,$E+=i,ZE+=(i=qE*t-VE*e)*(VE+t),QE+=i*(qE+e),JE+=3*i,eT(VE=t,qE=e)}const lT=tT;function hT(t){this._context=t}hT.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,oE)}},result:kE};var dT,fT,pT,gT,mT,yT=new tE,vT={point:kE,lineStart:function(){vT.point=bT},lineEnd:function(){dT&&xT(fT,pT),vT.point=kE},polygonStart:function(){dT=!0},polygonEnd:function(){dT=null},result:function(){var t=+yT;return yT=new tE,t}};function bT(t,e){vT.point=xT,fT=gT=t,pT=mT=e}function xT(t,e){gT-=t,mT-=e,yT.add(vE(gT*gT+mT*mT)),gT=t,mT=e}const wT=vT;var kT,_T,ST,AT;let CT,ET,TT,NT;class DT{constructor(t){this._append=null==t?FT:function(t){const e=Math.floor(t);if(!(e>=0))throw new RangeError("invalid digits: ".concat(t));if(e>15)return FT;if(e!==CT){const t=10**e;CT=e,ET=function(e){let n=1;this._+=e[0];for(const r=e.length;n<r;++n)this._+=Math.round(arguments[n]*t)/t+e[n]}}return ET}(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){0===this._line&&(this._+="Z"),this._point=NaN}point(t,e){switch(this._point){case 0:this._append(kT||(kT=fd(["M",",",""])),t,e),this._point=1;break;case 1:this._append(_T||(_T=fd(["L",",",""])),t,e);break;default:if(this._append(ST||(ST=fd(["M",",",""])),t,e),this._radius!==TT||this._append!==ET){const t=this._radius,e=this._;this._="",this._append(AT||(AT=fd(["m0,","a",","," 0 1,1 0,","a",","," 0 1,1 0,","z"])),t,t,t,-2*t,t,t,2*t),TT=t,ET=this._append,NT=this._,this._=e}this._+=NT}}result(){const t=this._;return this._="",t.length?t:null}}function FT(t){let e=1;this._+=t[0];for(const n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function IT(t,e){let n,r,i=3,a=4.5;function o(t){return t&&("function"===typeof a&&r.pointRadius(+a.apply(this,arguments)),JC(t,n(r))),r.result()}return o.area=function(t){return JC(t,n(OE)),OE.result()},o.measure=function(t){return JC(t,n(wT)),wT.result()},o.bounds=function(t){return JC(t,n(jE)),jE.result()},o.centroid=function(t){return JC(t,n(lT)),lT.result()},o.projection=function(e){return arguments.length?(n=null==e?(t=null,YC):(t=e).stream,o):t},o.context=function(t){return arguments.length?(r=null==t?(e=null,new DT(i)):new hT(e=t),"function"!==typeof a&&r.pointRadius(a),o):e},o.pointRadius=function(t){return arguments.length?(a="function"===typeof t?t:(r.pointRadius(+t),+t),o):a},o.digits=function(t){if(!arguments.length)return i;if(null==t)i=null;else{const e=Math.floor(t);if(!(e>=0))throw new RangeError("invalid digits: ".concat(t));i=e}return null===e&&(r=new DT(i)),o},o.projection(t).digits(i).context(e)}function MT(){var t,e=[];return{point:function(e,n,r){t.push([e,n,r])},lineStart:function(){e.push(t=[])},lineEnd:kE,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function OT(t,e){return uE(t[0]-e[0])<eE&&uE(t[1]-e[1])<eE}function RT(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function zT(t,e,n,r,i){var a,o,s=[],c=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],o=t[e];if(OT(r,o)){if(!r[2]&&!o[2]){for(i.lineStart(),a=0;a<e;++a)i.point((r=t[a])[0],r[1]);return void i.lineEnd()}o[0]+=2*eE}s.push(n=new RT(r,t,null,!0)),c.push(n.o=new RT(r,null,n,!1)),s.push(n=new RT(o,t,null,!1)),c.push(n.o=new RT(o,null,n,!0))}})),s.length){for(c.sort(e),BT(s),BT(c),a=0,o=c.length;a<o;++a)c[a].e=n=!n;for(var u,l,h=s[0];;){for(var d=h,f=!0;d.v;)if((d=d.n)===h)return;u=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(f)for(a=0,o=u.length;a<o;++a)i.point((l=u[a])[0],l[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(f)for(u=d.p.z,a=u.length-1;a>=0;--a)i.point((l=u[a])[0],l[1]);else r(d.x,d.p.x,-1,i);d=d.p}u=(d=d.o).z,f=!f}while(!d.v);i.lineEnd()}}}function BT(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}function LT(t){return[hE(t[1],t[0]),wE(t[2])]}function PT(t){var e=t[0],n=t[1],r=dE(n);return[r*dE(e),r*mE(e),mE(n)]}function jT(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function UT(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function WT(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function VT(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function qT(t){var e=vE(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function GT(t){return uE(t[0])<=rE?t[0]:yE(t[0])*((uE(t[0])+rE)%oE-rE)}function HT(t){return Array.from(function*(t){for(const e of t)yield*e}(t))}function YT(t,e,n,r){return function(i){var a,o,s,c=e(i),u=MT(),l=e(u),h=!1,d={point:f,lineStart:g,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=b,o=[],a=[]},polygonEnd:function(){d.point=f,d.lineStart=g,d.lineEnd=m,o=HT(o);var t=function(t,e){var n=GT(e),r=e[1],i=mE(r),a=[mE(n),-dE(n),0],o=0,s=0,c=new tE;1===i?r=iE+eE:-1===i&&(r=-iE-eE);for(var u=0,l=t.length;u<l;++u)if(d=(h=t[u]).length)for(var h,d,f=h[d-1],p=GT(f),g=f[1]/2+aE,m=mE(g),y=dE(g),v=0;v<d;++v,p=x,m=k,y=_,f=b){var b=h[v],x=GT(b),w=b[1]/2+aE,k=mE(w),_=dE(w),S=x-p,A=S>=0?1:-1,C=A*S,E=C>rE,T=m*k;if(c.add(hE(T*A*mE(C),y*_+T*dE(C))),o+=E?S+A*oE:S,E^p>=n^x>=n){var N=UT(PT(f),PT(b));qT(N);var D=UT(a,N);qT(D);var F=(E^S>=0?-1:1)*wE(D[2]);(r>F||r===F&&(N[0]||N[1]))&&(s+=E^S>=0?1:-1)}}return(o<-eE||o<eE&&c<-nE)^1&s}(a,r);o.length?(h||(i.polygonStart(),h=!0),zT(o,KT,t,n,i)):t&&(h||(i.polygonStart(),h=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),o=a=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function f(e,n){t(e,n)&&i.point(e,n)}function p(t,e){c.point(t,e)}function g(){d.point=p,c.lineStart()}function m(){d.point=f,c.lineEnd()}function y(t,e){s.push([t,e]),l.point(t,e)}function v(){l.lineStart(),s=[]}function b(){y(s[0][0],s[0][1]),l.lineEnd();var t,e,n,r,c=l.clean(),d=u.result(),f=d.length;if(s.pop(),a.push(s),s=null,f)if(1&c){if((e=(n=d[0]).length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else f>1&&2&c&&d.push(d.pop().concat(d.shift())),o.push(d.filter(XT))}return d}}function XT(t){return t.length>1}function KT(t,e){return((t=t.x)[0]<0?t[1]-iE-eE:iE-t[1])-((e=e.x)[0]<0?e[1]-iE-eE:iE-e[1])}const $T=YT((function(){return!0}),(function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(a,o){var s=a>0?rE:-rE,c=uE(a-n);uE(c-rE)<eE?(t.point(n,r=(r+o)/2>0?iE:-iE),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(a,r),e=0):i!==s&&c>=rE&&(uE(n-i)<eE&&(n-=i*eE),uE(a-s)<eE&&(a-=s*eE),r=function(t,e,n,r){var i,a,o=mE(t-n);return uE(o)>eE?lE((mE(e)*(a=dE(r))*mE(n)-mE(r)*(i=dE(e))*mE(t))/(i*a*o)):(e+r)/2}(n,r,a,o),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=a,r=o),i=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var i;if(null==t)i=n*iE,r.point(-rE,i),r.point(0,i),r.point(rE,i),r.point(rE,0),r.point(rE,-i),r.point(0,-i),r.point(-rE,-i),r.point(-rE,0),r.point(-rE,i);else if(uE(t[0]-e[0])>eE){var a=t[0]<e[0]?rE:-rE;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(e[0],e[1])}),[-rE,-iE]);function ZT(t,e,n,r,i,a){if(n){var o=dE(e),s=mE(e),c=r*n;null==i?(i=e+r*oE,a=e-c/2):(i=QT(o,i),a=QT(o,a),(r>0?i<a:i>a)&&(i+=r*oE));for(var u,l=i;r>0?l>a:l<a;l-=c)u=LT([o,-s*dE(l),-s*mE(l)]),t.point(u[0],u[1])}}function QT(t,e){(e=PT(e))[0]-=t,qT(e);var n=xE(-e[1]);return((-e[2]<0?-n:n)+oE-eE)%oE}var JT=1e9,tN=-JT;function eN(t,e,n,r){function i(i,a){return t<=i&&i<=n&&e<=a&&a<=r}function a(i,a,s,u){var l=0,h=0;if(null==i||(l=o(i,s))!==(h=o(a,s))||c(i,a)<0^s>0)do{u.point(0===l||3===l?t:n,l>1?r:e)}while((l=(l+s+4)%4)!==h);else u.point(a[0],a[1])}function o(r,i){return uE(r[0]-t)<eE?i>0?0:3:uE(r[0]-n)<eE?i>0?2:1:uE(r[1]-e)<eE?i>0?1:0:i>0?3:2}function s(t,e){return c(t.x,e.x)}function c(t,e){var n=o(t,1),r=o(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(o){var c,u,l,h,d,f,p,g,m,y,v,b=o,x=MT(),w={point:k,lineStart:function(){w.point=_,u&&u.push(l=[]);y=!0,m=!1,p=g=NaN},lineEnd:function(){c&&(_(h,d),f&&m&&x.rejoin(),c.push(x.result()));w.point=k,m&&b.lineEnd()},polygonStart:function(){b=x,c=[],u=[],v=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=u.length;n<i;++n)for(var a,o,s=u[n],c=1,l=s.length,h=s[0],d=h[0],f=h[1];c<l;++c)a=d,o=f,d=(h=s[c])[0],f=h[1],o<=r?f>r&&(d-a)*(r-o)>(f-o)*(t-a)&&++e:f<=r&&(d-a)*(r-o)<(f-o)*(t-a)&&--e;return e}(),n=v&&e,i=(c=HT(c)).length;(n||i)&&(o.polygonStart(),n&&(o.lineStart(),a(null,null,1,o),o.lineEnd()),i&&zT(c,s,e,a,o),o.polygonEnd());b=o,c=u=l=null}};function k(t,e){i(t,e)&&b.point(t,e)}function _(a,o){var s=i(a,o);if(u&&l.push([a,o]),y)h=a,d=o,f=s,y=!1,s&&(b.lineStart(),b.point(a,o));else if(s&&m)b.point(a,o);else{var c=[p=Math.max(tN,Math.min(JT,p)),g=Math.max(tN,Math.min(JT,g))],x=[a=Math.max(tN,Math.min(JT,a)),o=Math.max(tN,Math.min(JT,o))];!function(t,e,n,r,i,a){var o,s=t[0],c=t[1],u=0,l=1,h=e[0]-s,d=e[1]-c;if(o=n-s,h||!(o>0)){if(o/=h,h<0){if(o<u)return;o<l&&(l=o)}else if(h>0){if(o>l)return;o>u&&(u=o)}if(o=i-s,h||!(o<0)){if(o/=h,h<0){if(o>l)return;o>u&&(u=o)}else if(h>0){if(o<u)return;o<l&&(l=o)}if(o=r-c,d||!(o>0)){if(o/=d,d<0){if(o<u)return;o<l&&(l=o)}else if(d>0){if(o>l)return;o>u&&(u=o)}if(o=a-c,d||!(o<0)){if(o/=d,d<0){if(o>l)return;o>u&&(u=o)}else if(d>0){if(o<u)return;o<l&&(l=o)}return u>0&&(t[0]=s+u*h,t[1]=c+u*d),l<1&&(e[0]=s+l*h,e[1]=c+l*d),!0}}}}}(c,x,t,e,n,r)?s&&(b.lineStart(),b.point(a,o),v=!1):(m||(b.lineStart(),b.point(c[0],c[1])),b.point(x[0],x[1]),s||b.lineEnd(),v=!1)}p=a,g=o,m=s}return w}}function nN(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n}function rN(t,e){return uE(t)>rE&&(t-=Math.round(t/oE)*oE),[t,e]}function iN(t,e,n){return(t%=oE)?e||n?nN(oN(t),sN(e,n)):oN(t):e||n?sN(e,n):rN}function aN(t){return function(e,n){return uE(e+=t)>rE&&(e-=Math.round(e/oE)*oE),[e,n]}}function oN(t){var e=aN(t);return e.invert=aN(-t),e}function sN(t,e){var n=dE(t),r=mE(t),i=dE(e),a=mE(e);function o(t,e){var o=dE(e),s=dE(t)*o,c=mE(t)*o,u=mE(e),l=u*n+s*r;return[hE(c*i-l*a,s*n-u*r),wE(l*i+c*a)]}return o.invert=function(t,e){var o=dE(e),s=dE(t)*o,c=mE(t)*o,u=mE(e),l=u*i-c*a;return[hE(c*i+u*a,s*n+l*r),wE(l*n-s*r)]},o}function cN(t){return function(e){var n=new uN;for(var r in t)n[r]=t[r];return n.stream=e,n}}function uN(){}function lN(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),JC(n,t.stream(jE)),e(jE.result()),null!=r&&t.clipExtent(r),t}function hN(t,e,n){return lN(t,(function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],a=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),o=+e[0][0]+(r-a*(n[1][0]+n[0][0]))/2,s=+e[0][1]+(i-a*(n[1][1]+n[0][1]))/2;t.scale(150*a).translate([o,s])}),n)}function dN(t,e,n){return hN(t,[[0,0],e],n)}function fN(t,e,n){return lN(t,(function(n){var r=+e,i=r/(n[1][0]-n[0][0]),a=(r-i*(n[1][0]+n[0][0]))/2,o=-i*n[0][1];t.scale(150*i).translate([a,o])}),n)}function pN(t,e,n){return lN(t,(function(n){var r=+e,i=r/(n[1][1]-n[0][1]),a=-i*n[0][0],o=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([a,o])}),n)}rN.invert=rN,uN.prototype={constructor:uN,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var gN=16,mN=dE(30*cE);function yN(t,e){return+e?function(t,e){function n(r,i,a,o,s,c,u,l,h,d,f,p,g,m){var y=u-r,v=l-i,b=y*y+v*v;if(b>4*e&&g--){var x=o+d,w=s+f,k=c+p,_=vE(x*x+w*w+k*k),S=wE(k/=_),A=uE(uE(k)-1)<eE||uE(a-h)<eE?(a+h)/2:hE(w,x),C=t(A,S),E=C[0],T=C[1],N=E-r,D=T-i,F=v*N-y*D;(F*F/b>e||uE((y*N+v*D)/b-.5)>.3||o*d+s*f+c*p<mN)&&(n(r,i,a,o,s,c,E,T,A,x/=_,w/=_,k,g,m),m.point(E,T),n(E,T,A,x,w,k,u,l,h,d,f,p,g,m))}}return function(e){var r,i,a,o,s,c,u,l,h,d,f,p,g={point:m,lineStart:y,lineEnd:b,polygonStart:function(){e.polygonStart(),g.lineStart=x},polygonEnd:function(){e.polygonEnd(),g.lineStart=y}};function m(n,r){n=t(n,r),e.point(n[0],n[1])}function y(){l=NaN,g.point=v,e.lineStart()}function v(r,i){var a=PT([r,i]),o=t(r,i);n(l,h,u,d,f,p,l=o[0],h=o[1],u=r,d=a[0],f=a[1],p=a[2],gN,e),e.point(l,h)}function b(){g.point=m,e.lineEnd()}function x(){y(),g.point=w,g.lineEnd=k}function w(t,e){v(r=t,e),i=l,a=h,o=d,s=f,c=p,g.point=v}function k(){n(l,h,u,d,f,p,i,a,r,o,s,c,gN,e),g.lineEnd=b,b()}return g}}(t,e):function(t){return cN({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var vN=cN({point:function(t,e){this.stream.point(t*cE,e*cE)}});function bN(t,e,n,r,i,a){if(!a)return function(t,e,n,r,i){function a(a,o){return[e+t*(a*=r),n-t*(o*=i)]}return a.invert=function(a,o){return[(a-e)/t*r,(n-o)/t*i]},a}(t,e,n,r,i);var o=dE(a),s=mE(a),c=o*t,u=s*t,l=o/t,h=s/t,d=(s*n-o*e)/t,f=(s*e+o*n)/t;function p(t,a){return[c*(t*=r)-u*(a*=i)+e,n-u*t-c*a]}return p.invert=function(t,e){return[r*(l*t-h*e+d),i*(f-h*t-l*e)]},p}function xN(t){return wN((function(){return t}))()}function wN(t){var e,n,r,i,a,o,s,c,u,l,h=150,d=480,f=250,p=0,g=0,m=0,y=0,v=0,b=0,x=1,w=1,k=null,_=$T,S=null,A=YC,C=.5;function E(t){return c(t[0]*cE,t[1]*cE)}function T(t){return(t=c.invert(t[0],t[1]))&&[t[0]*sE,t[1]*sE]}function N(){var t=bN(h,0,0,x,w,b).apply(null,e(p,g)),r=bN(h,d-t[0],f-t[1],x,w,b);return n=iN(m,y,v),s=nN(e,r),c=nN(n,s),o=yN(s,C),D()}function D(){return u=l=null,E}return E.stream=function(t){return u&&l===t?u:u=vN(function(t){return cN({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}(n)(_(o(A(l=t)))))},E.preclip=function(t){return arguments.length?(_=t,k=void 0,D()):_},E.postclip=function(t){return arguments.length?(A=t,S=r=i=a=null,D()):A},E.clipAngle=function(t){return arguments.length?(_=+t?function(t){var e=dE(t),n=6*cE,r=e>0,i=uE(e)>eE;function a(t,n){return dE(t)*dE(n)>e}function o(t,n,r){var i=[1,0,0],a=UT(PT(t),PT(n)),o=jT(a,a),s=a[0],c=o-s*s;if(!c)return!r&&t;var u=e*o/c,l=-e*s/c,h=UT(i,a),d=VT(i,u);WT(d,VT(a,l));var f=h,p=jT(d,f),g=jT(f,f),m=p*p-g*(jT(d,d)-1);if(!(m<0)){var y=vE(m),v=VT(f,(-p-y)/g);if(WT(v,d),v=LT(v),!r)return v;var b,x=t[0],w=n[0],k=t[1],_=n[1];w<x&&(b=x,x=w,w=b);var S=w-x,A=uE(S-rE)<eE;if(!A&&_<k&&(b=k,k=_,_=b),A||S<eE?A?k+_>0^v[1]<(uE(v[0]-x)<eE?k:_):k<=v[1]&&v[1]<=_:S>rE^(x<=v[0]&&v[0]<=w)){var C=VT(f,(-p+y)/g);return WT(C,d),[v,LT(C)]}}}function s(e,n){var i=r?t:rE-t,a=0;return e<-i?a|=1:e>i&&(a|=2),n<-i?a|=4:n>i&&(a|=8),a}return YT(a,(function(t){var e,n,c,u,l;return{lineStart:function(){u=c=!1,l=1},point:function(h,d){var f,p=[h,d],g=a(h,d),m=r?g?0:s(h,d):g?s(h+(h<0?rE:-rE),d):0;if(!e&&(u=c=g)&&t.lineStart(),g!==c&&(!(f=o(e,p))||OT(e,f)||OT(p,f))&&(p[2]=1),g!==c)l=0,g?(t.lineStart(),f=o(p,e),t.point(f[0],f[1])):(f=o(e,p),t.point(f[0],f[1],2),t.lineEnd()),e=f;else if(i&&e&&r^g){var y;m&n||!(y=o(p,e,!0))||(l=0,r?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1],3)))}!g||e&&OT(e,p)||t.point(p[0],p[1]),e=p,c=g,n=m},lineEnd:function(){c&&t.lineEnd(),e=null},clean:function(){return l|(u&&c)<<1}}}),(function(e,r,i,a){ZT(a,t,n,i,e,r)}),r?[0,-t]:[-rE,t-rE])}(k=t*cE):(k=null,$T),D()):k*sE},E.clipExtent=function(t){return arguments.length?(A=null==t?(S=r=i=a=null,YC):eN(S=+t[0][0],r=+t[0][1],i=+t[1][0],a=+t[1][1]),D()):null==S?null:[[S,r],[i,a]]},E.scale=function(t){return arguments.length?(h=+t,N()):h},E.translate=function(t){return arguments.length?(d=+t[0],f=+t[1],N()):[d,f]},E.center=function(t){return arguments.length?(p=t[0]%360*cE,g=t[1]%360*cE,N()):[p*sE,g*sE]},E.rotate=function(t){return arguments.length?(m=t[0]%360*cE,y=t[1]%360*cE,v=t.length>2?t[2]%360*cE:0,N()):[m*sE,y*sE,v*sE]},E.angle=function(t){return arguments.length?(b=t%360*cE,N()):b*sE},E.reflectX=function(t){return arguments.length?(x=t?-1:1,N()):x<0},E.reflectY=function(t){return arguments.length?(w=t?-1:1,N()):w<0},E.precision=function(t){return arguments.length?(o=yN(s,C=t*t),D()):vE(C)},E.fitExtent=function(t,e){return hN(E,t,e)},E.fitSize=function(t,e){return dN(E,t,e)},E.fitWidth=function(t,e){return fN(E,t,e)},E.fitHeight=function(t,e){return pN(E,t,e)},function(){return e=t.apply(this,arguments),E.invert=e.invert&&T,N()}}function kN(t){var e=0,n=rE/3,r=wN(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*cE,n=t[1]*cE):[e*sE,n*sE]},i}function _N(t,e){var n=mE(t),r=(n+mE(e))/2;if(uE(r)<eE)return function(t){var e=dE(t);function n(t,n){return[t*e,mE(n)/e]}return n.invert=function(t,n){return[t/e,wE(n*e)]},n}(t);var i=1+n*(2*r-n),a=vE(i)/r;function o(t,e){var n=vE(i-2*r*mE(e))/r;return[n*mE(t*=r),a-n*dE(t)]}return o.invert=function(t,e){var n=a-e,o=hE(t,uE(n))*yE(n);return n*r<0&&(o-=rE*yE(t)*yE(n)),[o/r,wE((i-(t*t+n*n)*r*r)/(2*r))]},o}function SN(){return kN(_N).scale(155.424).center([0,33.6442])}function AN(){return SN().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function CN(t){return function(e,n){var r=dE(e),i=dE(n),a=t(r*i);return a===1/0?[2,0]:[a*i*mE(e),a*mE(n)]}}function EN(t){return function(e,n){var r=vE(e*e+n*n),i=t(r),a=mE(i),o=dE(i);return[hE(e*a,r*o),wE(r&&n*a/r)]}}var TN=CN((function(t){return vE(2/(1+t))}));TN.invert=EN((function(t){return 2*wE(t/2)}));var NN=CN((function(t){return(t=xE(t))&&t/mE(t)}));function DN(t,e){return[t,pE(bE((iE+e)/2))]}function FN(t){var e,n,r,i=xN(t),a=i.center,o=i.scale,s=i.translate,c=i.clipExtent,u=null;function l(){var a=rE*o(),s=i(function(t){function e(e){return(e=t(e[0]*cE,e[1]*cE))[0]*=sE,e[1]*=sE,e}return t=iN(t[0]*cE,t[1]*cE,t.length>2?t[2]*cE:0),e.invert=function(e){return(e=t.invert(e[0]*cE,e[1]*cE))[0]*=sE,e[1]*=sE,e},e}(i.rotate()).invert([0,0]));return c(null==u?[[s[0]-a,s[1]-a],[s[0]+a,s[1]+a]]:t===DN?[[Math.max(s[0]-a,u),e],[Math.min(s[0]+a,n),r]]:[[u,Math.max(s[1]-a,e)],[n,Math.min(s[1]+a,r)]])}return i.scale=function(t){return arguments.length?(o(t),l()):o()},i.translate=function(t){return arguments.length?(s(t),l()):s()},i.center=function(t){return arguments.length?(a(t),l()):a()},i.clipExtent=function(t){return arguments.length?(null==t?u=e=n=r=null:(u=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),l()):null==u?null:[[u,e],[n,r]]},l()}function IN(t){return bE((iE+t)/2)}function MN(t,e){var n=dE(t),r=t===e?mE(t):pE(n/dE(e))/pE(IN(e)/IN(t)),i=n*gE(IN(t),r)/r;if(!r)return DN;function a(t,e){i>0?e<-iE+eE&&(e=-iE+eE):e>iE-eE&&(e=iE-eE);var n=i/gE(IN(e),r);return[n*mE(r*t),i-n*dE(r*t)]}return a.invert=function(t,e){var n=i-e,a=yE(r)*vE(t*t+n*n),o=hE(t,uE(n))*yE(n);return n*r<0&&(o-=rE*yE(t)*yE(n)),[o/r,2*lE(gE(i/a,1/r))-iE]},a}function ON(t,e){return[t,e]}function RN(t,e){var n=dE(t),r=t===e?mE(t):(n-dE(e))/(e-t),i=n/r+t;if(uE(r)<eE)return ON;function a(t,e){var n=i-e,a=r*t;return[n*mE(a),i-n*dE(a)]}return a.invert=function(t,e){var n=i-e,a=hE(t,uE(n))*yE(n);return n*r<0&&(a-=rE*yE(t)*yE(n)),[a/r,i-yE(r)*vE(t*t+n*n)]},a}NN.invert=EN((function(t){return t})),DN.invert=function(t,e){return[t,2*lE(fE(e))-iE]},ON.invert=ON;var zN=1.340264,BN=-.081106,LN=893e-6,PN=.003796,jN=vE(3)/2;function UN(t,e){var n=wE(jN*mE(e)),r=n*n,i=r*r*r;return[t*dE(n)/(jN*(zN+3*BN*r+i*(7*LN+9*PN*r))),n*(zN+BN*r+i*(LN+PN*r))]}function WN(t,e){var n=dE(e),r=dE(t)*n;return[n*mE(t)/r,mE(e)/r]}function VN(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function qN(t,e){return[dE(e)*mE(t),mE(e)]}function GN(t,e){var n=dE(e),r=1+dE(t)*n;return[n*mE(t)/r,mE(e)/r]}function HN(t,e){return[pE(bE((iE+e)/2)),-t]}function YN(){}function XN(){var t,e=[];return{point:function(e,n,r){t.push([e,n,r])},lineStart:function(){e.push(t=[])},lineEnd:YN,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}UN.invert=function(t,e){for(var n,r=e,i=r*r,a=i*i*i,o=0;o<12&&(a=(i=(r-=n=(r*(zN+BN*i+a*(LN+PN*i))-e)/(zN+3*BN*i+a*(7*LN+9*PN*i)))*r)*i*i,!(uE(n)<nE));++o);return[jN*t*(zN+3*BN*i+a*(7*LN+9*PN*i))/dE(r),wE(mE(r)/jN)]},WN.invert=EN(lE),VN.invert=function(t,e){var n,r=e,i=25;do{var a=r*r,o=a*a;r-=n=(r*(1.007226+a*(.015085+o*(.028874*a-.044475-.005916*o)))-e)/(1.007226+a*(.045255+o*(.259866*a-.311325-.005916*11*o)))}while(uE(n)>eE&&--i>0);return[t/(.8707+(a=r*r)*(a*(a*a*a*(.003971-.001529*a)-.013791)-.131979)),r]},qN.invert=EN(wE),GN.invert=EN((function(t){return 2*lE(t)})),HN.invert=function(t,e){return[-e,2*lE(fE(t))-iE]};var KN=1e-6,$N=1e-12,ZN=Math.PI,QN=ZN/2,JN=ZN/4,tD=2*ZN,eD=180/ZN,nD=ZN/180,rD=Math.abs,iD=Math.atan,aD=Math.atan2,oD=Math.cos,sD=(Math.ceil,Math.exp,Math.floor,Math.hypot,Math.log,Math.pow,Math.sin),cD=Math.sign||function(t){return t>0?1:t<0?-1:0},uD=Math.sqrt;Math.tan;function lD(t){return t>1?QN:t<-1?-QN:Math.asin(t)}function hD(t,e){return rD(t[0]-e[0])<KN&&rD(t[1]-e[1])<KN}function dD(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function fD(t,e,n,r,i){var a,o,s=[],c=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],o=t[e];if(hD(r,o)){if(!r[2]&&!o[2]){for(i.lineStart(),a=0;a<e;++a)i.point((r=t[a])[0],r[1]);return void i.lineEnd()}o[0]+=2*KN}s.push(n=new dD(r,t,null,!0)),c.push(n.o=new dD(r,null,n,!1)),s.push(n=new dD(o,t,null,!1)),c.push(n.o=new dD(o,null,n,!0))}})),s.length){for(c.sort(e),pD(s),pD(c),a=0,o=c.length;a<o;++a)c[a].e=n=!n;for(var u,l,h=s[0];;){for(var d=h,f=!0;d.v;)if((d=d.n)===h)return;u=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(f)for(a=0,o=u.length;a<o;++a)i.point((l=u[a])[0],l[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(f)for(u=d.p.z,a=u.length-1;a>=0;--a)i.point((l=u[a])[0],l[1]);else r(d.x,d.p.x,-1,i);d=d.p}u=(d=d.o).z,f=!f}while(!d.v);i.lineEnd()}}}function pD(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}class gD{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=e[r],a=t+i,o=Math.abs(t)<Math.abs(i)?t-(a-i):i-(a-t);o&&(e[n++]=o),t=a}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,r,i=this._n,a=0;if(i>0){for(a=t[--i];i>0&&(e=a,n=t[--i],a=e+n,r=n-(a-e),!r););i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(n=2*r,e=a+n,n==e-a&&(a=e))}return a}}function mD(t){return[aD(t[1],t[0]),lD(t[2])]}function yD(t){var e=t[0],n=t[1],r=oD(n);return[r*oD(e),r*sD(e),sD(n)]}function vD(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function bD(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function xD(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function wD(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function kD(t){var e=uD(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function _D(t){return rD(t[0])<=ZN?t[0]:cD(t[0])*((rD(t[0])+ZN)%tD-ZN)}function SD(t){return Array.from(function*(t){for(const e of t)yield*e}(t))}function AD(t,e,n,r){return function(i){var a,o,s,c=e(i),u=XN(),l=e(u),h=!1,d={point:f,lineStart:g,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=b,o=[],a=[]},polygonEnd:function(){d.point=f,d.lineStart=g,d.lineEnd=m,o=SD(o);var t=function(t,e){var n=_D(e),r=e[1],i=sD(r),a=[sD(n),-oD(n),0],o=0,s=0,c=new gD;1===i?r=QN+KN:-1===i&&(r=-QN-KN);for(var u=0,l=t.length;u<l;++u)if(d=(h=t[u]).length)for(var h,d,f=h[d-1],p=_D(f),g=f[1]/2+JN,m=sD(g),y=oD(g),v=0;v<d;++v,p=x,m=k,y=_,f=b){var b=h[v],x=_D(b),w=b[1]/2+JN,k=sD(w),_=oD(w),S=x-p,A=S>=0?1:-1,C=A*S,E=C>ZN,T=m*k;if(c.add(aD(T*A*sD(C),y*_+T*oD(C))),o+=E?S+A*tD:S,E^p>=n^x>=n){var N=bD(yD(f),yD(b));kD(N);var D=bD(a,N);kD(D);var F=(E^S>=0?-1:1)*lD(D[2]);(r>F||r===F&&(N[0]||N[1]))&&(s+=E^S>=0?1:-1)}}return(o<-KN||o<KN&&c<-$N)^1&s}(a,r);o.length?(h||(i.polygonStart(),h=!0),fD(o,ED,t,n,i)):t&&(h||(i.polygonStart(),h=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),o=a=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function f(e,n){t(e,n)&&i.point(e,n)}function p(t,e){c.point(t,e)}function g(){d.point=p,c.lineStart()}function m(){d.point=f,c.lineEnd()}function y(t,e){s.push([t,e]),l.point(t,e)}function v(){l.lineStart(),s=[]}function b(){y(s[0][0],s[0][1]),l.lineEnd();var t,e,n,r,c=l.clean(),d=u.result(),f=d.length;if(s.pop(),a.push(s),s=null,f)if(1&c){if((e=(n=d[0]).length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else f>1&&2&c&&d.push(d.pop().concat(d.shift())),o.push(d.filter(CD))}return d}}function CD(t){return t.length>1}function ED(t,e){return((t=t.x)[0]<0?t[1]-QN-KN:QN-t[1])-((e=e.x)[0]<0?e[1]-QN-KN:QN-e[1])}const TD=AD((function(){return!0}),(function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(a,o){var s=a>0?ZN:-ZN,c=rD(a-n);rD(c-ZN)<KN?(t.point(n,r=(r+o)/2>0?QN:-QN),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(a,r),e=0):i!==s&&c>=ZN&&(rD(n-i)<KN&&(n-=i*KN),rD(a-s)<KN&&(a-=s*KN),r=function(t,e,n,r){var i,a,o=sD(t-n);return rD(o)>KN?iD((sD(e)*(a=oD(r))*sD(n)-sD(r)*(i=oD(e))*sD(t))/(i*a*o)):(e+r)/2}(n,r,a,o),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=a,r=o),i=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var i;if(null==t)i=n*QN,r.point(-ZN,i),r.point(0,i),r.point(ZN,i),r.point(ZN,0),r.point(ZN,-i),r.point(0,-i),r.point(-ZN,-i),r.point(-ZN,0),r.point(-ZN,i);else if(rD(t[0]-e[0])>KN){var a=t[0]<e[0]?ZN:-ZN;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(e[0],e[1])}),[-ZN,-QN]);function ND(t,e,n,r,i,a){if(n){var o=oD(e),s=sD(e),c=r*n;null==i?(i=e+r*tD,a=e-c/2):(i=DD(o,i),a=DD(o,a),(r>0?i<a:i>a)&&(i+=r*tD));for(var u,l=i;r>0?l>a:l<a;l-=c)u=mD([o,-s*oD(l),-s*sD(l)]),t.point(u[0],u[1])}}function DD(t,e){(e=yD(e))[0]-=t,kD(e);var n=function(t){return t>1?0:t<-1?ZN:Math.acos(t)}(-e[1]);return((-e[2]<0?-n:n)+tD-KN)%tD}var FD=1e9,ID=-FD;function MD(t,e,n,r){function i(i,a){return t<=i&&i<=n&&e<=a&&a<=r}function a(i,a,s,u){var l=0,h=0;if(null==i||(l=o(i,s))!==(h=o(a,s))||c(i,a)<0^s>0)do{u.point(0===l||3===l?t:n,l>1?r:e)}while((l=(l+s+4)%4)!==h);else u.point(a[0],a[1])}function o(r,i){return rD(r[0]-t)<KN?i>0?0:3:rD(r[0]-n)<KN?i>0?2:1:rD(r[1]-e)<KN?i>0?1:0:i>0?3:2}function s(t,e){return c(t.x,e.x)}function c(t,e){var n=o(t,1),r=o(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(o){var c,u,l,h,d,f,p,g,m,y,v,b=o,x=XN(),w={point:k,lineStart:function(){w.point=_,u&&u.push(l=[]);y=!0,m=!1,p=g=NaN},lineEnd:function(){c&&(_(h,d),f&&m&&x.rejoin(),c.push(x.result()));w.point=k,m&&b.lineEnd()},polygonStart:function(){b=x,c=[],u=[],v=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=u.length;n<i;++n)for(var a,o,s=u[n],c=1,l=s.length,h=s[0],d=h[0],f=h[1];c<l;++c)a=d,o=f,d=(h=s[c])[0],f=h[1],o<=r?f>r&&(d-a)*(r-o)>(f-o)*(t-a)&&++e:f<=r&&(d-a)*(r-o)<(f-o)*(t-a)&&--e;return e}(),n=v&&e,i=(c=SD(c)).length;(n||i)&&(o.polygonStart(),n&&(o.lineStart(),a(null,null,1,o),o.lineEnd()),i&&fD(c,s,e,a,o),o.polygonEnd());b=o,c=u=l=null}};function k(t,e){i(t,e)&&b.point(t,e)}function _(a,o){var s=i(a,o);if(u&&l.push([a,o]),y)h=a,d=o,f=s,y=!1,s&&(b.lineStart(),b.point(a,o));else if(s&&m)b.point(a,o);else{var c=[p=Math.max(ID,Math.min(FD,p)),g=Math.max(ID,Math.min(FD,g))],x=[a=Math.max(ID,Math.min(FD,a)),o=Math.max(ID,Math.min(FD,o))];!function(t,e,n,r,i,a){var o,s=t[0],c=t[1],u=0,l=1,h=e[0]-s,d=e[1]-c;if(o=n-s,h||!(o>0)){if(o/=h,h<0){if(o<u)return;o<l&&(l=o)}else if(h>0){if(o>l)return;o>u&&(u=o)}if(o=i-s,h||!(o<0)){if(o/=h,h<0){if(o>l)return;o>u&&(u=o)}else if(h>0){if(o<u)return;o<l&&(l=o)}if(o=r-c,d||!(o>0)){if(o/=d,d<0){if(o<u)return;o<l&&(l=o)}else if(d>0){if(o>l)return;o>u&&(u=o)}if(o=a-c,d||!(o<0)){if(o/=d,d<0){if(o>l)return;o>u&&(u=o)}else if(d>0){if(o<u)return;o<l&&(l=o)}return u>0&&(t[0]=s+u*h,t[1]=c+u*d),l<1&&(e[0]=s+l*h,e[1]=c+l*d),!0}}}}}(c,x,t,e,n,r)?s&&(b.lineStart(),b.point(a,o),v=!1):(m||(b.lineStart(),b.point(c[0],c[1])),b.point(x[0],x[1]),s||b.lineEnd(),v=!1)}p=a,g=o,m=s}return w}}function OD(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n}const RD=t=>t;function zD(t,e){return rD(t)>ZN&&(t-=Math.round(t/tD)*tD),[t,e]}function BD(t,e,n){return(t%=tD)?e||n?OD(PD(t),jD(e,n)):PD(t):e||n?jD(e,n):zD}function LD(t){return function(e,n){return rD(e+=t)>ZN&&(e-=Math.round(e/tD)*tD),[e,n]}}function PD(t){var e=LD(t);return e.invert=LD(-t),e}function jD(t,e){var n=oD(t),r=sD(t),i=oD(e),a=sD(e);function o(t,e){var o=oD(e),s=oD(t)*o,c=sD(t)*o,u=sD(e),l=u*n+s*r;return[aD(c*i-l*a,s*n-u*r),lD(l*i+c*a)]}return o.invert=function(t,e){var o=oD(e),s=oD(t)*o,c=sD(t)*o,u=sD(e),l=u*i-c*a;return[aD(c*i+u*a,s*n+l*r),lD(l*n-s*r)]},o}function UD(t){return function(e){var n=new WD;for(var r in t)n[r]=t[r];return n.stream=e,n}}function WD(){}function VD(t,e){t&&GD.hasOwnProperty(t.type)&&GD[t.type](t,e)}zD.invert=zD,WD.prototype={constructor:WD,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var qD={Feature:function(t,e){VD(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)VD(n[r].geometry,e)}},GD={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){HD(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)HD(n[r],e,0)},Polygon:function(t,e){YD(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)YD(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)VD(n[r],e)}};function HD(t,e,n){var r,i=-1,a=t.length-n;for(e.lineStart();++i<a;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function YD(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)HD(t[n],e,1);e.polygonEnd()}var XD=1/0,KD=XD,$D=-XD,ZD=$D,QD={point:function(t,e){t<XD&&(XD=t);t>$D&&($D=t);e<KD&&(KD=e);e>ZD&&(ZD=e)},lineStart:YN,lineEnd:YN,polygonStart:YN,polygonEnd:YN,result:function(){var t=[[XD,KD],[$D,ZD]];return $D=ZD=-(KD=XD=1/0),t}};const JD=QD;function tF(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),function(t,e){t&&qD.hasOwnProperty(t.type)?qD[t.type](t,e):VD(t,e)}(n,t.stream(JD)),e(JD.result()),null!=r&&t.clipExtent(r),t}function eF(t,e,n){return tF(t,(function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],a=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),o=+e[0][0]+(r-a*(n[1][0]+n[0][0]))/2,s=+e[0][1]+(i-a*(n[1][1]+n[0][1]))/2;t.scale(150*a).translate([o,s])}),n)}var nF=16,rF=oD(30*nD);function iF(t,e){return+e?function(t,e){function n(r,i,a,o,s,c,u,l,h,d,f,p,g,m){var y=u-r,v=l-i,b=y*y+v*v;if(b>4*e&&g--){var x=o+d,w=s+f,k=c+p,_=uD(x*x+w*w+k*k),S=lD(k/=_),A=rD(rD(k)-1)<KN||rD(a-h)<KN?(a+h)/2:aD(w,x),C=t(A,S),E=C[0],T=C[1],N=E-r,D=T-i,F=v*N-y*D;(F*F/b>e||rD((y*N+v*D)/b-.5)>.3||o*d+s*f+c*p<rF)&&(n(r,i,a,o,s,c,E,T,A,x/=_,w/=_,k,g,m),m.point(E,T),n(E,T,A,x,w,k,u,l,h,d,f,p,g,m))}}return function(e){var r,i,a,o,s,c,u,l,h,d,f,p,g={point:m,lineStart:y,lineEnd:b,polygonStart:function(){e.polygonStart(),g.lineStart=x},polygonEnd:function(){e.polygonEnd(),g.lineStart=y}};function m(n,r){n=t(n,r),e.point(n[0],n[1])}function y(){l=NaN,g.point=v,e.lineStart()}function v(r,i){var a=yD([r,i]),o=t(r,i);n(l,h,u,d,f,p,l=o[0],h=o[1],u=r,d=a[0],f=a[1],p=a[2],nF,e),e.point(l,h)}function b(){g.point=m,e.lineEnd()}function x(){y(),g.point=w,g.lineEnd=k}function w(t,e){v(r=t,e),i=l,a=h,o=d,s=f,c=p,g.point=v}function k(){n(l,h,u,d,f,p,i,a,r,o,s,c,nF,e),g.lineEnd=b,b()}return g}}(t,e):function(t){return UD({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var aF=UD({point:function(t,e){this.stream.point(t*nD,e*nD)}});function oF(t,e,n,r,i,a){if(!a)return function(t,e,n,r,i){function a(a,o){return[e+t*(a*=r),n-t*(o*=i)]}return a.invert=function(a,o){return[(a-e)/t*r,(n-o)/t*i]},a}(t,e,n,r,i);var o=oD(a),s=sD(a),c=o*t,u=s*t,l=o/t,h=s/t,d=(s*n-o*e)/t,f=(s*e+o*n)/t;function p(t,a){return[c*(t*=r)-u*(a*=i)+e,n-u*t-c*a]}return p.invert=function(t,e){return[r*(l*t-h*e+d),i*(f-h*t-l*e)]},p}function sF(t){return function(t){var e,n,r,i,a,o,s,c,u,l,h=150,d=480,f=250,p=0,g=0,m=0,y=0,v=0,b=0,x=1,w=1,k=null,_=TD,S=null,A=RD,C=.5;function E(t){return c(t[0]*nD,t[1]*nD)}function T(t){return(t=c.invert(t[0],t[1]))&&[t[0]*eD,t[1]*eD]}function N(){var t=oF(h,0,0,x,w,b).apply(null,e(p,g)),r=oF(h,d-t[0],f-t[1],x,w,b);return n=BD(m,y,v),s=OD(e,r),c=OD(n,s),o=iF(s,C),D()}function D(){return u=l=null,E}return E.stream=function(t){return u&&l===t?u:u=aF(function(t){return UD({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}(n)(_(o(A(l=t)))))},E.preclip=function(t){return arguments.length?(_=t,k=void 0,D()):_},E.postclip=function(t){return arguments.length?(A=t,S=r=i=a=null,D()):A},E.clipAngle=function(t){return arguments.length?(_=+t?function(t){var e=oD(t),n=6*nD,r=e>0,i=rD(e)>KN;function a(t,n){return oD(t)*oD(n)>e}function o(t,n,r){var i=[1,0,0],a=bD(yD(t),yD(n)),o=vD(a,a),s=a[0],c=o-s*s;if(!c)return!r&&t;var u=e*o/c,l=-e*s/c,h=bD(i,a),d=wD(i,u);xD(d,wD(a,l));var f=h,p=vD(d,f),g=vD(f,f),m=p*p-g*(vD(d,d)-1);if(!(m<0)){var y=uD(m),v=wD(f,(-p-y)/g);if(xD(v,d),v=mD(v),!r)return v;var b,x=t[0],w=n[0],k=t[1],_=n[1];w<x&&(b=x,x=w,w=b);var S=w-x,A=rD(S-ZN)<KN;if(!A&&_<k&&(b=k,k=_,_=b),A||S<KN?A?k+_>0^v[1]<(rD(v[0]-x)<KN?k:_):k<=v[1]&&v[1]<=_:S>ZN^(x<=v[0]&&v[0]<=w)){var C=wD(f,(-p+y)/g);return xD(C,d),[v,mD(C)]}}}function s(e,n){var i=r?t:ZN-t,a=0;return e<-i?a|=1:e>i&&(a|=2),n<-i?a|=4:n>i&&(a|=8),a}return AD(a,(function(t){var e,n,c,u,l;return{lineStart:function(){u=c=!1,l=1},point:function(h,d){var f,p=[h,d],g=a(h,d),m=r?g?0:s(h,d):g?s(h+(h<0?ZN:-ZN),d):0;if(!e&&(u=c=g)&&t.lineStart(),g!==c&&(!(f=o(e,p))||hD(e,f)||hD(p,f))&&(p[2]=1),g!==c)l=0,g?(t.lineStart(),f=o(p,e),t.point(f[0],f[1])):(f=o(e,p),t.point(f[0],f[1],2),t.lineEnd()),e=f;else if(i&&e&&r^g){var y;m&n||!(y=o(p,e,!0))||(l=0,r?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1],3)))}!g||e&&hD(e,p)||t.point(p[0],p[1]),e=p,c=g,n=m},lineEnd:function(){c&&t.lineEnd(),e=null},clean:function(){return l|(u&&c)<<1}}}),(function(e,r,i,a){ND(a,t,n,i,e,r)}),r?[0,-t]:[-ZN,t-ZN])}(k=t*nD):(k=null,TD),D()):k*eD},E.clipExtent=function(t){return arguments.length?(A=null==t?(S=r=i=a=null,RD):MD(S=+t[0][0],r=+t[0][1],i=+t[1][0],a=+t[1][1]),D()):null==S?null:[[S,r],[i,a]]},E.scale=function(t){return arguments.length?(h=+t,N()):h},E.translate=function(t){return arguments.length?(d=+t[0],f=+t[1],N()):[d,f]},E.center=function(t){return arguments.length?(p=t[0]%360*nD,g=t[1]%360*nD,N()):[p*eD,g*eD]},E.rotate=function(t){return arguments.length?(m=t[0]%360*nD,y=t[1]%360*nD,v=t.length>2?t[2]%360*nD:0,N()):[m*eD,y*eD,v*eD]},E.angle=function(t){return arguments.length?(b=t%360*nD,N()):b*eD},E.reflectX=function(t){return arguments.length?(x=t?-1:1,N()):x<0},E.reflectY=function(t){return arguments.length?(w=t?-1:1,N()):w<0},E.precision=function(t){return arguments.length?(o=iF(s,C=t*t),D()):uD(C)},E.fitExtent=function(t,e){return eF(E,t,e)},E.fitSize=function(t,e){return function(t,e,n){return eF(t,[[0,0],e],n)}(E,t,e)},E.fitWidth=function(t,e){return function(t,e,n){return tF(t,(function(n){var r=+e,i=r/(n[1][0]-n[0][0]),a=(r-i*(n[1][0]+n[0][0]))/2,o=-i*n[0][1];t.scale(150*i).translate([a,o])}),n)}(E,t,e)},E.fitHeight=function(t,e){return function(t,e,n){return tF(t,(function(n){var r=+e,i=r/(n[1][1]-n[0][1]),a=-i*n[0][0],o=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([a,o])}),n)}(E,t,e)},function(){return e=t.apply(this,arguments),E.invert=e.invert&&T,N()}}((function(){return t}))()}var cF=Math.abs,uF=(Math.atan,Math.atan2,Math.ceil,Math.cos),lF=(Math.exp,Math.floor,Math.log,Math.max,Math.min,Math.pow,Math.round,Math.sign,Math.sin),hF=(Math.tan,1e-6),dF=Math.PI,fF=dF/2,pF=(Math.SQRT1_2,mF(2));mF(dF);function gF(t){return t>1?fF:t<-1?-fF:Math.asin(t)}function mF(t){return t>0?Math.sqrt(t):0}function yF(t,e){var n,r=t*lF(e),i=30;do{e-=n=(e+lF(e)-r)/(1+uF(e))}while(cF(n)>hF&&--i>0);return e/2}var vF=function(t,e,n){function r(r,i){return[t*r*uF(i=yF(n,i)),e*lF(i)]}return r.invert=function(r,i){return i=gF(i/e),[r/(t*uF(i)),gF((2*i+lF(2*i))/n)]},r}(pF/fF,pF,dF);const bF=IT(),xF=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function wF(t,e){if(!t||"string"!==typeof t)throw new Error("Projection type must be a name string.");return t=t.toLowerCase(),arguments.length>1?(_F[t]=function(t,e){return function n(){const r=e();return r.type=t,r.path=IT().projection(r),r.copy=r.copy||function(){const t=n();return xF.forEach((e=>{r[e]&&t[e](r[e]())})),t.path.pointRadius(r.path.pointRadius()),t},xv(r)}}(t,e),this):_F[t]||null}function kF(t){return t&&t.path||bF}const _F={albers:AN,albersusa:function(){var t,e,n,r,i,a,o=AN(),s=SN().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=SN().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(t,e){a=[t,e]}};function l(t){var e=t[0],o=t[1];return a=null,n.point(e,o),a||(r.point(e,o),a)||(i.point(e,o),a)}function h(){return t=e=null,l}return l.invert=function(t){var e=o.scale(),n=o.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?c:o).invert(t)},l.stream=function(n){return t&&e===n?t:t=function(t){var e=t.length;return{point:function(n,r){for(var i=-1;++i<e;)t[i].point(n,r)},sphere:function(){for(var n=-1;++n<e;)t[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)t[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)t[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)t[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)t[n].polygonEnd()}}}([o.stream(e=n),s.stream(n),c.stream(n)])},l.precision=function(t){return arguments.length?(o.precision(t),s.precision(t),c.precision(t),h()):o.precision()},l.scale=function(t){return arguments.length?(o.scale(t),s.scale(.35*t),c.scale(t),l.translate(o.translate())):o.scale()},l.translate=function(t){if(!arguments.length)return o.translate();var e=o.scale(),a=+t[0],l=+t[1];return n=o.translate(t).clipExtent([[a-.455*e,l-.238*e],[a+.455*e,l+.238*e]]).stream(u),r=s.translate([a-.307*e,l+.201*e]).clipExtent([[a-.425*e+eE,l+.12*e+eE],[a-.214*e-eE,l+.234*e-eE]]).stream(u),i=c.translate([a-.205*e,l+.212*e]).clipExtent([[a-.214*e+eE,l+.166*e+eE],[a-.115*e-eE,l+.234*e-eE]]).stream(u),h()},l.fitExtent=function(t,e){return hN(l,t,e)},l.fitSize=function(t,e){return dN(l,t,e)},l.fitWidth=function(t,e){return fN(l,t,e)},l.fitHeight=function(t,e){return pN(l,t,e)},l.scale(1070)},azimuthalequalarea:function(){return xN(TN).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return xN(NN).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return kN(MN).scale(109.5).parallels([30,30])},conicequalarea:SN,conicequidistant:function(){return kN(RN).scale(131.154).center([0,13.9389])},equalEarth:function(){return xN(UN).scale(177.158)},equirectangular:function(){return xN(ON).scale(152.63)},gnomonic:function(){return xN(WN).scale(144.049).clipAngle(60)},identity:function(){var t,e,n,r,i,a,o,s=1,c=0,u=0,l=1,h=1,d=0,f=null,p=1,g=1,m=cN({point:function(t,e){var n=b([t,e]);this.stream.point(n[0],n[1])}}),y=YC;function v(){return p=s*l,g=s*h,a=o=null,b}function b(n){var r=n[0]*p,i=n[1]*g;if(d){var a=i*t-r*e;r=r*t+i*e,i=a}return[r+c,i+u]}return b.invert=function(n){var r=n[0]-c,i=n[1]-u;if(d){var a=i*t+r*e;r=r*t-i*e,i=a}return[r/p,i/g]},b.stream=function(t){return a&&o===t?a:a=m(y(o=t))},b.postclip=function(t){return arguments.length?(y=t,f=n=r=i=null,v()):y},b.clipExtent=function(t){return arguments.length?(y=null==t?(f=n=r=i=null,YC):eN(f=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),v()):null==f?null:[[f,n],[r,i]]},b.scale=function(t){return arguments.length?(s=+t,v()):s},b.translate=function(t){return arguments.length?(c=+t[0],u=+t[1],v()):[c,u]},b.angle=function(n){return arguments.length?(e=mE(d=n%360*cE),t=dE(d),v()):d*sE},b.reflectX=function(t){return arguments.length?(l=t?-1:1,v()):l<0},b.reflectY=function(t){return arguments.length?(h=t?-1:1,v()):h<0},b.fitExtent=function(t,e){return hN(b,t,e)},b.fitSize=function(t,e){return dN(b,t,e)},b.fitWidth=function(t,e){return fN(b,t,e)},b.fitHeight=function(t,e){return pN(b,t,e)},b},mercator:function(){return FN(DN).scale(961/oE)},mollweide:function(){return sF(vF).scale(169.529)},naturalEarth1:function(){return xN(VN).scale(175.295)},orthographic:function(){return xN(qN).scale(249.5).clipAngle(90+eE)},stereographic:function(){return xN(GN).scale(250).clipAngle(142)},transversemercator:function(){var t=FN(HN),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)}};for(const Set in _F)wF(Set,_F[Set]);var SF=1e-6,AF=1e-12,CF=Math.PI,EF=CF/2,TF=CF/4,NF=2*CF,DF=180/CF,FF=CF/180,IF=Math.abs,MF=Math.atan,OF=Math.atan2,RF=Math.cos,zF=Math.ceil,BF=Math.exp,LF=(Math.floor,Math.hypot),PF=Math.log,jF=Math.pow,UF=Math.sin,WF=Math.sign||function(t){return t>0?1:t<0?-1:0},VF=Math.sqrt,qF=Math.tan;function GF(t){return t>1?0:t<-1?CF:Math.acos(t)}function HF(t){return t>1?EF:t<-1?-EF:Math.asin(t)}function YF(t,e,n){var r=zu(t,e-SF,n).concat(e);return function(t){return r.map((function(e){return[t,e]}))}}function XF(t,e,n){var r=zu(t,e-SF,n).concat(e);return function(t){return r.map((function(e){return[e,t]}))}}function KF(){var t,e,n,r,i,a,o,s,c,u,l,h,d=10,f=d,p=90,g=360,m=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return zu(zF(r/p)*p,n,p).map(l).concat(zu(zF(s/g)*g,o,g).map(h)).concat(zu(zF(e/d)*d,t,d).filter((function(t){return IF(t%p)>SF})).map(c)).concat(zu(zF(a/f)*f,i,f).filter((function(t){return IF(t%g)>SF})).map(u))}return y.lines=function(){return v().map((function(t){return{type:"LineString",coordinates:t}}))},y.outline=function(){return{type:"Polygon",coordinates:[l(r).concat(h(o).slice(1),l(n).reverse().slice(1),h(s).reverse().slice(1))]}},y.extent=function(t){return arguments.length?y.extentMajor(t).extentMinor(t):y.extentMinor()},y.extentMajor=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],s=+t[0][1],o=+t[1][1],r>n&&(t=r,r=n,n=t),s>o&&(t=s,s=o,o=t),y.precision(m)):[[r,s],[n,o]]},y.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],a=+n[0][1],i=+n[1][1],e>t&&(n=e,e=t,t=n),a>i&&(n=a,a=i,i=n),y.precision(m)):[[e,a],[t,i]]},y.step=function(t){return arguments.length?y.stepMajor(t).stepMinor(t):y.stepMinor()},y.stepMajor=function(t){return arguments.length?(p=+t[0],g=+t[1],y):[p,g]},y.stepMinor=function(t){return arguments.length?(d=+t[0],f=+t[1],y):[d,f]},y.precision=function(d){return arguments.length?(m=+d,c=YF(a,i,90),u=XF(e,t,m),l=YF(s,o,90),h=XF(r,n,m),y):m},y.extentMajor([[-180,-90+SF],[180,90-SF]]).extentMinor([[-180,-80-SF],[180,80+SF]])}function $F(){}const ZF=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function QF(){var t=1,e=1,n=o;function r(t,e){return e.map((e=>i(t,e)))}function i(r,i){var o=[],s=[];return function(n,r,i){var o,s,c,u,l,h,d=new Array,f=new Array;o=s=-1,u=n[0]>=r,ZF[u<<1].forEach(p);for(;++o<t-1;)c=u,u=n[o+1]>=r,ZF[c|u<<1].forEach(p);ZF[u<<0].forEach(p);for(;++s<e-1;){for(o=-1,u=n[s*t+t]>=r,l=n[s*t]>=r,ZF[u<<1|l<<2].forEach(p);++o<t-1;)c=u,u=n[s*t+t+o+1]>=r,h=l,l=n[s*t+o+1]>=r,ZF[c|u<<1|l<<2|h<<3].forEach(p);ZF[u|l<<3].forEach(p)}o=-1,l=n[s*t]>=r,ZF[l<<2].forEach(p);for(;++o<t-1;)h=l,l=n[s*t+o+1]>=r,ZF[l<<2|h<<3].forEach(p);function p(t){var e,n,r=[t[0][0]+o,t[0][1]+s],c=[t[1][0]+o,t[1][1]+s],u=a(r),l=a(c);(e=f[u])?(n=d[l])?(delete f[e.end],delete d[n.start],e===n?(e.ring.push(c),i(e.ring)):d[e.start]=f[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete f[e.end],e.ring.push(c),f[e.end=l]=e):(e=d[l])?(n=f[u])?(delete d[e.start],delete f[n.end],e===n?(e.ring.push(c),i(e.ring)):d[n.start]=f[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete d[e.start],e.ring.unshift(r),d[e.start=u]=e):d[u]=f[l]={start:u,end:l,ring:[r,c]}}ZF[l<<3].forEach(p)}(r,i,(t=>{n(t,r,i),function(t){var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];for(;++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}(t)>0?o.push([t]):s.push(t)})),s.forEach((t=>{for(var e,n=0,r=o.length;n<r;++n)if(-1!==JF((e=o[n])[0],t))return void e.push(t)})),{type:"MultiPolygon",value:i,coordinates:o}}function a(e){return 2*e[0]+e[1]*(t+1)*4}function o(n,r,i){n.forEach((n=>{var a,o=n[0],s=n[1],c=0|o,u=0|s,l=r[u*t+c];o>0&&o<t&&c===o&&(a=r[u*t+c-1],n[0]=o+(i-a)/(l-a)-.5),s>0&&s<e&&u===s&&(a=r[(u-1)*t+c],n[1]=s+(i-a)/(l-a)-.5)}))}return r.contour=i,r.size=function(n){if(!arguments.length)return[t,e];var i=Math.floor(n[0]),a=Math.floor(n[1]);return i>=0&&a>=0||qe("invalid size"),t=i,e=a,r},r.smooth=function(t){return arguments.length?(n=t?o:$F,r):n===o},r}function JF(t,e){for(var n,r=-1,i=e.length;++r<i;)if(n=tI(t,e[r]))return n;return 0}function tI(t,e){for(var n=e[0],r=e[1],i=-1,a=0,o=t.length,s=o-1;a<o;s=a++){var c=t[a],u=c[0],l=c[1],h=t[s],d=h[0],f=h[1];if(eI(c,h,e))return 0;l>r!==f>r&&n<(d-u)*(r-l)/(f-l)+u&&(i=-i)}return i}function eI(t,e,n){var r,i,a,o;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])===(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&(i=t[r=+(t[0]===e[0])],a=n[r],o=e[r],i<=a&&a<=o||o<=a&&a<=i)}function nI(t,e,n){return function(r){var i=Rn(r),a=n?Math.min(i[0],0):i[0],o=i[1],s=o-a,c=e?HC(a,o,t):s/(t+1);return zu(a+c,o,c)}}function rI(t){Ic.call(this,null,t)}function iI(t,e,n,r,i){const a=t.x1||0,o=t.y1||0,s=e*n<0;function c(t){t.forEach(u)}function u(t){s&&t.reverse(),t.forEach(l)}function l(t){t[0]=(t[0]-a)*e+r,t[1]=(t[1]-o)*n+i}return function(t){return t.coordinates.forEach(c),t}}function aI(t,e,n){const r=t>=0?t:Kc(e,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function oI(t){return An(t)?t:In(+t)}function sI(){var t=t=>t[0],e=t=>t[1],n=$e,r=[-1,-1],i=960,a=500,o=2;function s(s,c){const u=aI(r[0],s,t)>>o,l=aI(r[1],s,e)>>o,h=u?u+2:0,d=l?l+2:0,f=2*h+(i>>o),p=2*d+(a>>o),g=new Float32Array(f*p),m=new Float32Array(f*p);let y=g;s.forEach((r=>{const i=h+(+t(r)>>o),a=d+(+e(r)>>o);i>=0&&i<f&&a>=0&&a<p&&(g[i+a*f]+=+n(r))})),u>0&&l>0?(cI(f,p,g,m,u),uI(f,p,m,g,l),cI(f,p,g,m,u),uI(f,p,m,g,l),cI(f,p,g,m,u),uI(f,p,m,g,l)):u>0?(cI(f,p,g,m,u),cI(f,p,m,g,u),cI(f,p,g,m,u),y=m):l>0&&(uI(f,p,g,m,l),uI(f,p,m,g,l),uI(f,p,g,m,l),y=m);const v=c?Math.pow(2,-2*o):1/sA(y);for(let t=0,e=f*p;t<e;++t)y[t]*=v;return{values:y,scale:1<<o,width:f,height:p,x1:h,y1:d,x2:h+(i>>o),y2:d+(a>>o)}}return s.x=function(e){return arguments.length?(t=oI(e),s):t},s.y=function(t){return arguments.length?(e=oI(t),s):e},s.weight=function(t){return arguments.length?(n=oI(t),s):n},s.size=function(t){if(!arguments.length)return[i,a];var e=+t[0],n=+t[1];return e>=0&&n>=0||qe("invalid size"),i=e,a=n,s},s.cellSize=function(t){return arguments.length?((t=+t)>=1||qe("invalid cell size"),o=Math.floor(Math.log(t)/Math.LN2),s):1<<o},s.bandwidth=function(t){return arguments.length?(1===(t=Sn(t)).length&&(t=[+t[0],+t[0]]),2!==t.length&&qe("invalid bandwidth"),r=t,s):r},s}function cI(t,e,n,r,i){const a=1+(i<<1);for(let o=0;o<e;++o)for(let e=0,s=0;e<t+i;++e)e<t&&(s+=n[e+o*t]),e>=i&&(e>=a&&(s-=n[e-a+o*t]),r[e-i+o*t]=s/Math.min(e+1,t-1+a-e,a))}function uI(t,e,n,r,i){const a=1+(i<<1);for(let o=0;o<t;++o)for(let s=0,c=0;s<e+i;++s)s<e&&(c+=n[o+s*t]),s>=i&&(s>=a&&(c-=n[o+(s-a)*t]),r[o+(s-i)*t]=c/Math.min(s+1,e-1+a-s,a))}function lI(t){Ic.call(this,null,t)}rI.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},jn(rI,Ic,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=e.materialize(e.SOURCE).source,i=t.field||Xe,a=QF().smooth(!1!==t.smooth),o=t.thresholds||function(t,e,n){const r=nI(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?r:r(t.map((t=>Eu(e(t).values))))}(r,i,t),s=null===t.as?null:t.as||"contour",c=[];return r.forEach((e=>{const n=i(e),r=a.size([n.width,n.height])(n.values,on(o)?o:o(n.values));!function(t,e,n,r){let i=r.scale||e.scale,a=r.translate||e.translate;An(i)&&(i=i(n,r));An(a)&&(a=a(n,r));if((1===i||null==i)&&!a)return;const o=(Vn(i)?i:i[0])||1,s=(Vn(i)?i:i[1])||1,c=a&&a[0]||0,u=a&&a[1]||0;t.forEach(iI(e,o,s,c,u))}(r,n,e,t),r.forEach((t=>{c.push(rc(e,ec(null!=s?{[s]:t}:t)))}))})),this.value&&(n.rem=this.value),this.value=n.source=n.add=c,n}}),lI.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const hI=["x","y","weight","size","cellSize","bandwidth"];function dI(t,e){return hI.forEach((n=>null!=e[n]?t[n](e[n]):0)),t}function fI(t){Ic.call(this,null,t)}jn(lI,Ic,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=function(t,e){var n,r,i,a,o,s,c=[],u=t=>t(a);if(null==e)c.push(t);else for(n={},r=0,i=t.length;r<i;++r)a=t[r],(s=n[o=e.map(u)])||(n[o]=s=[],s.dims=o,c.push(s)),s.push(a);return c}(e.materialize(e.SOURCE).source,t.groupby),a=(t.groupby||[]).map(Pe),o=dI(sI(),t),s=t.as||"grid";return n=i.map((e=>ec(function(t,e){for(let n=0;n<a.length;++n)t[a[n]]=e[n];return t}({[s]:o(e,t.counts)},e.dims)))),this.value&&(r.rem=this.value),this.value=r.source=r.add=n,r}}),fI.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},jn(fI,Ic,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r,i=e.fork(e.NO_SOURCE|e.NO_FIELDS),a=QF().smooth(!1!==t.smooth),o=t.values,s=t.thresholds||nI(t.count||10,t.nice,!!o),c=t.size;return o||(o=e.materialize(e.SOURCE).source,r=iI(n=dI(sI(),t)(o,!0),n.scale||1,n.scale||1,0,0),c=[n.width,n.height],o=n.values),s=on(s)?s:s(o),o=a.size(c)(o,s),r&&o.forEach(r),this.value&&(i.rem=this.value),this.value=i.source=i.add=(o||[]).map(ec),i}});const pI="Feature",gI="FeatureCollection";function mI(t){Ic.call(this,null,t)}function yI(t){Ic.call(this,null,t)}function vI(t){Ic.call(this,null,t)}function bI(t){Ic.call(this,null,t)}function xI(t){Ic.call(this,[],t),this.generator=KF()}function wI(t){Ic.call(this,null,t)}function kI(t){if(!An(t))return!1;const e=Jn(je(t));return e.$x||e.$y||e.$value||e.$max}function _I(t){Ic.call(this,null,t),this.modified(!0)}function SI(t,e,n){An(t[e])&&t[e](n)}function AI(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,a,o,s,c,u,l,h,d,f=t._root,p={data:r},g=t._x0,m=t._y0,y=t._x1,v=t._y1;if(!f)return t._root=p,t;for(;f.length;)if((u=e>=(a=(g+y)/2))?g=a:y=a,(l=n>=(o=(m+v)/2))?m=o:v=o,i=f,!(f=f[h=l<<1|u]))return i[h]=p,t;if(s=+t._x.call(null,f.data),c=+t._y.call(null,f.data),e===s&&n===c)return p.next=f,i?i[h]=p:t._root=p,t;do{i=i?i[h]=new Array(4):t._root=new Array(4),(u=e>=(a=(g+y)/2))?g=a:y=a,(l=n>=(o=(m+v)/2))?m=o:v=o}while((h=l<<1|u)===(d=(c>=o)<<1|s>=a));return i[d]=f,i[h]=p,t}function CI(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function EI(t){return t[0]}function TI(t){return t[1]}function NI(t,e,n){var r=new DI(null==e?EI:e,null==n?TI:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function DI(t,e,n,r,i,a){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function FI(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}mI.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},jn(mI,Ic,{transform(t,e){var n,r=this._features,i=this._points,a=t.fields,o=a&&a[0],s=a&&a[1],c=t.geojson||!a&&Xe,u=e.ADD;n=t.modified()||e.changed(e.REM)||e.modified(je(c))||o&&e.modified(je(o))||s&&e.modified(je(s)),this.value&&!n||(u=e.SOURCE,this._features=r=[],this._points=i=[]),c&&e.visit(u,(t=>r.push(c(t)))),o&&s&&(e.visit(u,(t=>{var e=o(t),n=s(t);null!=e&&null!=n&&(e=+e)===e&&(n=+n)===n&&i.push([e,n])})),r=r.concat({type:pI,geometry:{type:"MultiPoint",coordinates:i}})),this.value={type:gI,features:r}}}),yI.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},jn(yI,Ic,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.field||Xe,a=t.as||"path",o=n.SOURCE;!r||t.modified()?(this.value=r=kF(t.projection),n.materialize().reflow()):o=i===Xe||e.modified(i.fields)?n.ADD_MOD:n.ADD;const s=function(t,e){const n=t.pointRadius();t.context(null),null!=e&&t.pointRadius(e);return n}(r,t.pointRadius);return n.visit(o,(t=>t[a]=r(i(t)))),r.pointRadius(s),n.modifies(a)}}),vI.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},jn(vI,Ic,{transform(t,e){var n,r=t.projection,i=t.fields[0],a=t.fields[1],o=t.as||["x","y"],s=o[0],c=o[1];function u(t){const e=r([i(t),a(t)]);e?(t[s]=e[0],t[c]=e[1]):(t[s]=void 0,t[c]=void 0)}return t.modified()?e=e.materialize().reflow(!0).visit(e.SOURCE,u):(n=e.modified(i.fields)||e.modified(a.fields),e.visit(n?e.ADD_MOD:e.ADD,u)),e.modifies(o)}}),bI.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},jn(bI,Ic,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.as||"shape",a=n.ADD;return r&&!t.modified()||(this.value=r=function(t,e,n){const r=null==n?n=>t(e(n)):r=>{var i=t.pointRadius(),a=t.pointRadius(n)(e(r));return t.pointRadius(i),a};return r.context=e=>(t.context(e),r),r}(kF(t.projection),t.field||He("datum"),t.pointRadius),n.materialize().reflow(),a=n.SOURCE),n.visit(a,(t=>t[i]=r)),n.modifies(i)}}),xI.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},jn(xI,Ic,{transform(t,e){var n,r=this.value,i=this.generator;if(!r.length||t.modified())for(const a in t)An(i[a])&&i[a](t[a]);return n=i(),r.length?e.mod.push(ic(r[0],n)):e.add.push(ec(n)),r[0]=n,e}}),wI.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},jn(wI,Ic,{transform(t,e){if(!e.changed()&&!t.modified())return e.StopPropagation;var n=e.materialize(e.SOURCE).source,r="shared"===t.resolve,i=t.field||Xe,a=function(t,e){let n;An(t)?(n=n=>t(n,e),n.dep=kI(t)):t?n=In(t):(n=t=>t.$value/t.$max||0,n.dep=!0);return n}(t.opacity,t),o=function(t,e){let n;An(t)?(n=n=>FA(t(n,e)),n.dep=kI(t)):n=In(FA(t||"#888"));return n}(t.color,t),s=t.as||"image",c={$x:0,$y:0,$value:0,$max:r?Eu(n.map((t=>Eu(i(t).values)))):0};return n.forEach((t=>{const e=i(t),n=On({},t,c);r||(n.$max=Eu(e.values||[])),t[s]=function(t,e,n,r){const i=t.width,a=t.height,o=t.x1||0,s=t.y1||0,c=t.x2||i,u=t.y2||a,l=t.values,h=l?t=>l[t]:Ke,d=Zd(c-o,u-s),f=d.getContext("2d"),p=f.getImageData(0,0,c-o,u-s),g=p.data;for(let m=s,y=0;m<u;++m){e.$y=m-s;for(let t=o,a=m*i;t<c;++t,y+=4){e.$x=t-o,e.$value=h(t+a);const i=n(e);g[y+0]=i.r,g[y+1]=i.g,g[y+2]=i.b,g[y+3]=~~(255*r(e))}}return f.putImageData(p,0,0),d}(e,n,o.dep?o:In(o(n)),a.dep?a:In(a(n)))})),e.reflow(!0).modifies(s)}}),jn(_I,Ic,{transform(t,e){let n=this.value;return!n||t.modified("type")?(this.value=n=function(t){const e=wF((t||"mercator").toLowerCase());e||qe("Unrecognized projection type: "+t);return e()}(t.type),xF.forEach((e=>{null!=t[e]&&SI(n,e,t[e])}))):xF.forEach((e=>{t.modified(e)&&SI(n,e,t[e])})),null!=t.pointRadius&&n.path.pointRadius(t.pointRadius),t.fit&&function(t,e){const n=function(t){return t=Sn(t),1===t.length?t[0]:{type:gI,features:t.reduce(((t,e)=>t.concat(function(t){return t.type===gI?t.features:Sn(t).filter((t=>null!=t)).map((t=>t.type===pI?t:{type:pI,geometry:t}))}(e))),[])}}(e.fit);e.extent?t.fitExtent(e.extent,n):e.size&&t.fitSize(e.size,n)}(n,t),e.fork(e.NO_SOURCE|e.NO_FIELDS)}});var II=NI.prototype=DI.prototype;function MI(t){return function(){return t}}function OI(t){return 1e-6*(t()-.5)}function RI(t){return t.x+t.vx}function zI(t){return t.y+t.vy}II.copy=function(){var t,e,n=new DI(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=FI(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=FI(e));return n},II.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return AI(this.cover(e,n),e,n,t)},II.addAll=function(t){var e,n,r,i,a=t.length,o=new Array(a),s=new Array(a),c=1/0,u=1/0,l=-1/0,h=-1/0;for(n=0;n<a;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(o[n]=r,s[n]=i,r<c&&(c=r),r>l&&(l=r),i<u&&(u=i),i>h&&(h=i));if(c>l||u>h)return this;for(this.cover(c,u).cover(l,h),n=0;n<a;++n)AI(this,o[n],s[n],t[n]);return this},II.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,a=(r=Math.floor(e))+1;else{for(var o,s,c=i-n||1,u=this._root;n>t||t>=i||r>e||e>=a;)switch(s=(e<r)<<1|t<n,(o=new Array(4))[s]=u,u=o,c*=2,s){case 0:i=n+c,a=r+c;break;case 1:n=i-c,a=r+c;break;case 2:i=n+c,r=a-c;break;case 3:n=i-c,r=a-c}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this},II.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},II.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},II.find=function(t,e,n){var r,i,a,o,s,c,u,l=this._x0,h=this._y0,d=this._x1,f=this._y1,p=[],g=this._root;for(g&&p.push(new CI(g,l,h,d,f)),null==n?n=1/0:(l=t-n,h=e-n,d=t+n,f=e+n,n*=n);c=p.pop();)if(!(!(g=c.node)||(i=c.x0)>d||(a=c.y0)>f||(o=c.x1)<l||(s=c.y1)<h))if(g.length){var m=(i+o)/2,y=(a+s)/2;p.push(new CI(g[3],m,y,o,s),new CI(g[2],i,y,m,s),new CI(g[1],m,a,o,y),new CI(g[0],i,a,m,y)),(u=(e>=y)<<1|t>=m)&&(c=p[p.length-1],p[p.length-1]=p[p.length-1-u],p[p.length-1-u]=c)}else{var v=t-+this._x.call(null,g.data),b=e-+this._y.call(null,g.data),x=v*v+b*b;if(x<n){var w=Math.sqrt(n=x);l=t-w,h=e-w,d=t+w,f=e+w,r=g.data}}return r},II.remove=function(t){if(isNaN(a=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,r,i,a,o,s,c,u,l,h,d,f=this._root,p=this._x0,g=this._y0,m=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((u=a>=(s=(p+m)/2))?p=s:m=s,(l=o>=(c=(g+y)/2))?g=c:y=c,e=f,!(f=f[h=l<<1|u]))return this;if(!f.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,d=h)}for(;f.data!==t;)if(r=f,!(f=f.next))return this;return(i=f.next)&&delete f.next,r?(i?r.next=i:delete r.next,this):e?(i?e[h]=i:delete e[h],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(n?n[d]=f:this._root=f),this):(this._root=i,this)},II.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},II.root=function(){return this._root},II.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},II.visit=function(t){var e,n,r,i,a,o,s=[],c=this._root;for(c&&s.push(new CI(c,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(c=e.node,r=e.x0,i=e.y0,a=e.x1,o=e.y1)&&c.length){var u=(r+a)/2,l=(i+o)/2;(n=c[3])&&s.push(new CI(n,u,l,a,o)),(n=c[2])&&s.push(new CI(n,r,l,u,o)),(n=c[1])&&s.push(new CI(n,u,i,a,l)),(n=c[0])&&s.push(new CI(n,r,i,u,l))}return this},II.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new CI(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var a,o=e.x0,s=e.y0,c=e.x1,u=e.y1,l=(o+c)/2,h=(s+u)/2;(a=i[0])&&n.push(new CI(a,o,s,l,h)),(a=i[1])&&n.push(new CI(a,l,s,c,h)),(a=i[2])&&n.push(new CI(a,o,h,l,u)),(a=i[3])&&n.push(new CI(a,l,h,c,u))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},II.x=function(t){return arguments.length?(this._x=t,this):this._x},II.y=function(t){return arguments.length?(this._y=t,this):this._y};var BI={value:()=>{}};function LI(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new PI(r)}function PI(t){this._=t}function jI(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function UI(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=BI,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}PI.prototype=LI.prototype={constructor:PI,on:function(t,e){var n,r=this._,i=function(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}(t+"",r),a=-1,o=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!==typeof e)throw new Error("invalid callback: "+e);for(;++a<o;)if(n=(t=i[a]).type)r[n]=UI(r[n],t.name,e);else if(null==e)for(n in r)r[n]=UI(r[n],t.name,null);return this}for(;++a<o;)if((n=(t=i[a]).type)&&(n=jI(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new PI(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(r=this._[t]).length;a<n;++a)r[a].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};const WI=LI;var VI,qI,GI=0,HI=0,YI=0,XI=1e3,KI=0,$I=0,ZI=0,QI="object"===typeof performance&&performance.now?performance:Date,JI="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function tM(){return $I||(JI(eM),$I=QI.now()+ZI)}function eM(){$I=0}function nM(){this._call=this._time=this._next=null}function rM(t,e,n){var r=new nM;return r.restart(t,e,n),r}function iM(){$I=(KI=QI.now())+ZI,GI=HI=0;try{!function(){tM(),++GI;for(var t,e=VI;e;)(t=$I-e._time)>=0&&e._call.call(null,t),e=e._next;--GI}()}finally{GI=0,function(){var t,e,n=VI,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:VI=e);qI=t,oM(r)}(),$I=0}}function aM(){var t=QI.now(),e=t-KI;e>XI&&(ZI-=e,KI=t)}function oM(t){GI||(HI&&(HI=clearTimeout(HI)),t-$I>24?(t<1/0&&(HI=setTimeout(iM,t-QI.now()-ZI)),YI&&(YI=clearInterval(YI))):(YI||(KI=QI.now(),YI=setInterval(aM,XI)),GI=1,JI(iM)))}nM.prototype=rM.prototype={constructor:nM,restart:function(t,e,n){if("function"!==typeof t)throw new TypeError("callback is not a function");n=(null==n?tM():+n)+(null==e?0:+e),this._next||qI===this||(qI?qI._next=this:VI=this,qI=this),this._call=t,this._time=n,oM()},stop:function(){this._call&&(this._call=null,this._time=1/0,oM())}};const sM=1664525,cM=1013904223,uM=4294967296;function lM(t){return t.x}function hM(t){return t.y}var dM=10,fM=Math.PI*(3-Math.sqrt(5));function pM(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,s=new Map,c=rM(h),u=WI("tick","end"),l=function(){let t=1;return()=>(t=(sM*t+cM)%uM)/uM}();function h(){d(),u.call("tick",e),n<r&&(c.stop(),u.call("end",e))}function d(r){var c,u,l=t.length;void 0===r&&(r=1);for(var h=0;h<r;++h)for(n+=(a-n)*i,s.forEach((function(t){t(n)})),c=0;c<l;++c)null==(u=t[c]).fx?u.x+=u.vx*=o:(u.x=u.fx,u.vx=0),null==u.fy?u.y+=u.vy*=o:(u.y=u.fy,u.vy=0);return e}function f(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=dM*Math.sqrt(.5+n),a=n*fM;e.x=i*Math.cos(a),e.y=i*Math.sin(a)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,l),e}return null==t&&(t=[]),f(),e={tick:d,restart:function(){return c.restart(h),e},stop:function(){return c.stop(),e},nodes:function(n){return arguments.length?(t=n,f(),s.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(a=+t,e):a},velocityDecay:function(t){return arguments.length?(o=1-t,e):1-o},randomSource:function(t){return arguments.length?(l=t,s.forEach(p),e):l},force:function(t,n){return arguments.length>1?(null==n?s.delete(t):s.set(t,p(n)),e):s.get(t)},find:function(e,n,r){var i,a,o,s,c,u=0,l=t.length;for(null==r?r=1/0:r*=r,u=0;u<l;++u)(o=(i=e-(s=t[u]).x)*i+(a=n-s.y)*a)<r&&(c=s,r=o);return c},on:function(t,n){return arguments.length>1?(u.on(t,n),e):u.on(t)}}}function gM(t){return t.index}function mM(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}const yM={center:function(t,e){var n,r=1;function i(){var i,a,o=n.length,s=0,c=0;for(i=0;i<o;++i)s+=(a=n[i]).x,c+=a.y;for(s=(s/o-t)*r,c=(c/o-e)*r,i=0;i<o;++i)(a=n[i]).x-=s,a.y-=c}return null==t&&(t=0),null==e&&(e=0),i.initialize=function(t){n=t},i.x=function(e){return arguments.length?(t=+e,i):t},i.y=function(t){return arguments.length?(e=+t,i):e},i.strength=function(t){return arguments.length?(r=+t,i):r},i},collide:function(t){var e,n,r,i=1,a=1;function o(){for(var t,o,c,u,l,h,d,f=e.length,p=0;p<a;++p)for(o=NI(e,RI,zI).visitAfter(s),t=0;t<f;++t)c=e[t],h=n[c.index],d=h*h,u=c.x+c.vx,l=c.y+c.vy,o.visit(g);function g(t,e,n,a,o){var s=t.data,f=t.r,p=h+f;if(!s)return e>u+p||a<u-p||n>l+p||o<l-p;if(s.index>c.index){var g=u-s.x-s.vx,m=l-s.y-s.vy,y=g*g+m*m;y<p*p&&(0===g&&(y+=(g=OI(r))*g),0===m&&(y+=(m=OI(r))*m),y=(p-(y=Math.sqrt(y)))/y*i,c.vx+=(g*=y)*(p=(f*=f)/(d+f)),c.vy+=(m*=y)*p,s.vx-=g*(p=1-p),s.vy-=m*p)}}}function s(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function c(){if(e){var r,i,a=e.length;for(n=new Array(a),r=0;r<a;++r)i=e[r],n[i.index]=+t(i,r,e)}}return"function"!==typeof t&&(t=MI(null==t?1:+t)),o.initialize=function(t,n){e=t,r=n,c()},o.iterations=function(t){return arguments.length?(a=+t,o):a},o.strength=function(t){return arguments.length?(i=+t,o):i},o.radius=function(e){return arguments.length?(t="function"===typeof e?e:MI(+e),c(),o):t},o},nbody:function(){var t,e,n,r,i,a=MI(-30),o=1,s=1/0,c=.81;function u(n){var i,a=t.length,o=NI(t,lM,hM).visitAfter(h);for(r=n,i=0;i<a;++i)e=t[i],o.visit(d)}function l(){if(t){var e,n,r=t.length;for(i=new Array(r),e=0;e<r;++e)n=t[e],i[n.index]=+a(n,e,t)}}function h(t){var e,n,r,a,o,s=0,c=0;if(t.length){for(r=a=o=0;o<4;++o)(e=t[o])&&(n=Math.abs(e.value))&&(s+=e.value,c+=n,r+=n*e.x,a+=n*e.y);t.x=r/c,t.y=a/c}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=i[e.data.index]}while(e=e.next)}t.value=s}function d(t,a,u,l){if(!t.value)return!0;var h=t.x-e.x,d=t.y-e.y,f=l-a,p=h*h+d*d;if(f*f/c<p)return p<s&&(0===h&&(p+=(h=OI(n))*h),0===d&&(p+=(d=OI(n))*d),p<o&&(p=Math.sqrt(o*p)),e.vx+=h*t.value*r/p,e.vy+=d*t.value*r/p),!0;if(!(t.length||p>=s)){(t.data!==e||t.next)&&(0===h&&(p+=(h=OI(n))*h),0===d&&(p+=(d=OI(n))*d),p<o&&(p=Math.sqrt(o*p)));do{t.data!==e&&(f=i[t.data.index]*r/p,e.vx+=h*f,e.vy+=d*f)}while(t=t.next)}}return u.initialize=function(e,r){t=e,n=r,l()},u.strength=function(t){return arguments.length?(a="function"===typeof t?t:MI(+t),l(),u):a},u.distanceMin=function(t){return arguments.length?(o=t*t,u):Math.sqrt(o)},u.distanceMax=function(t){return arguments.length?(s=t*t,u):Math.sqrt(s)},u.theta=function(t){return arguments.length?(c=t*t,u):Math.sqrt(c)},u},link:function(t){var e,n,r,i,a,o,s=gM,c=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},u=MI(30),l=1;function h(r){for(var i=0,s=t.length;i<l;++i)for(var c,u,h,d,f,p,g,m=0;m<s;++m)u=(c=t[m]).source,d=(h=c.target).x+h.vx-u.x-u.vx||OI(o),f=h.y+h.vy-u.y-u.vy||OI(o),d*=p=((p=Math.sqrt(d*d+f*f))-n[m])/p*r*e[m],f*=p,h.vx-=d*(g=a[m]),h.vy-=f*g,u.vx+=d*(g=1-g),u.vy+=f*g}function d(){if(r){var o,c,u=r.length,l=t.length,h=new Map(r.map(((t,e)=>[s(t,e,r),t])));for(o=0,i=new Array(u);o<l;++o)(c=t[o]).index=o,"object"!==typeof c.source&&(c.source=mM(h,c.source)),"object"!==typeof c.target&&(c.target=mM(h,c.target)),i[c.source.index]=(i[c.source.index]||0)+1,i[c.target.index]=(i[c.target.index]||0)+1;for(o=0,a=new Array(l);o<l;++o)c=t[o],a[o]=i[c.source.index]/(i[c.source.index]+i[c.target.index]);e=new Array(l),f(),n=new Array(l),p()}}function f(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+c(t[n],n,t)}function p(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+u(t[e],e,t)}return null==t&&(t=[]),h.initialize=function(t,e){r=t,o=e,d()},h.links=function(e){return arguments.length?(t=e,d(),h):t},h.id=function(t){return arguments.length?(s=t,h):s},h.iterations=function(t){return arguments.length?(l=+t,h):l},h.strength=function(t){return arguments.length?(c="function"===typeof t?t:MI(+t),f(),h):c},h.distance=function(t){return arguments.length?(u="function"===typeof t?t:MI(+t),p(),h):u},h},x:function(t){var e,n,r,i=MI(.1);function a(t){for(var i,a=0,o=e.length;a<o;++a)(i=e[a]).vx+=(r[a]-i.x)*n[a]*t}function o(){if(e){var a,o=e.length;for(n=new Array(o),r=new Array(o),a=0;a<o;++a)n[a]=isNaN(r[a]=+t(e[a],a,e))?0:+i(e[a],a,e)}}return"function"!==typeof t&&(t=MI(null==t?0:+t)),a.initialize=function(t){e=t,o()},a.strength=function(t){return arguments.length?(i="function"===typeof t?t:MI(+t),o(),a):i},a.x=function(e){return arguments.length?(t="function"===typeof e?e:MI(+e),o(),a):t},a},y:function(t){var e,n,r,i=MI(.1);function a(t){for(var i,a=0,o=e.length;a<o;++a)(i=e[a]).vy+=(r[a]-i.y)*n[a]*t}function o(){if(e){var a,o=e.length;for(n=new Array(o),r=new Array(o),a=0;a<o;++a)n[a]=isNaN(r[a]=+t(e[a],a,e))?0:+i(e[a],a,e)}}return"function"!==typeof t&&(t=MI(null==t?0:+t)),a.initialize=function(t){e=t,o()},a.strength=function(t){return arguments.length?(i="function"===typeof t?t:MI(+t),o(),a):i},a.y=function(e){return arguments.length?(t="function"===typeof e?e:MI(+e),o(),a):t},a}},vM="forces",bM=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],xM=["static","iterations"],wM=["x","y","vx","vy"];function kM(t){Ic.call(this,null,t)}function _M(t,e,n,r){var i,a,o,s,c=Sn(e.forces);for(i=0,a=bM.length;i<a;++i)(o=bM[i])!==vM&&e.modified(o)&&t[o](e[o]);for(i=0,a=c.length;i<a;++i)s=vM+i,(o=n||e.modified(vM,i)?AM(c[i]):r&&SM(c[i],r)?t.force(s):null)&&t.force(s,o);for(a=t.numForces||0;i<a;++i)t.force(vM+i,null);return t.numForces=c.length,t}function SM(t,e){var n,r;for(n in t)if(An(r=t[n])&&e.modified(je(r)))return 1;return 0}function AM(t){var e,n;for(n in Bn(yM,t.force)||qe("Unrecognized force: "+t.force),e=yM[t.force](),t)An(e[n])&&CM(e[n],t[n],t);return e}function CM(t,e,n){t(An(e)?t=>e(t,n):e)}function EM(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function TM(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=DM)):void 0===e&&(e=NM);for(var n,r,i,a,o,s=new MM(t),c=[s];n=c.pop();)if((i=e(n.data))&&(o=(i=Array.from(i)).length))for(n.children=i,a=o-1;a>=0;--a)c.push(r=i[a]=new MM(i[a])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(IM)}function NM(t){return t.children}function DM(t){return Array.isArray(t)?t[1]:null}function FM(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function IM(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function MM(t){this.data=t,this.depth=this.height=0,this.parent=null}function OM(t){for(var e,n,r=0,i=(t=function(t){for(var e,n,r=t.length;r;)n=Math.random()*r--|0,e=t[r],t[r]=t[n],t[n]=e;return t}(Array.from(t))).length,a=[];r<i;)e=t[r],n&&BM(n,e)?++r:(n=PM(a=RM(a,e)),r=0);return n}function RM(t,e){var n,r;if(LM(e,t))return[e];for(n=0;n<t.length;++n)if(zM(e,t[n])&&LM(jM(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(zM(jM(t[n],t[r]),e)&&zM(jM(t[n],e),t[r])&&zM(jM(t[r],e),t[n])&&LM(UM(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function zM(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function BM(t,e){var n=t.r-e.r+1e-9*Math.max(t.r,e.r,1),r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function LM(t,e){for(var n=0;n<e.length;++n)if(!BM(t,e[n]))return!1;return!0}function PM(t){switch(t.length){case 1:return function(t){return{x:t.x,y:t.y,r:t.r}}(t[0]);case 2:return jM(t[0],t[1]);case 3:return UM(t[0],t[1],t[2])}}function jM(t,e){var n=t.x,r=t.y,i=t.r,a=e.x,o=e.y,s=e.r,c=a-n,u=o-r,l=s-i,h=Math.sqrt(c*c+u*u);return{x:(n+a+c/h*l)/2,y:(r+o+u/h*l)/2,r:(h+i+s)/2}}function UM(t,e,n){var r=t.x,i=t.y,a=t.r,o=e.x,s=e.y,c=e.r,u=n.x,l=n.y,h=n.r,d=r-o,f=r-u,p=i-s,g=i-l,m=c-a,y=h-a,v=r*r+i*i-a*a,b=v-o*o-s*s+c*c,x=v-u*u-l*l+h*h,w=f*p-d*g,k=(p*x-g*b)/(2*w)-r,_=(g*m-p*y)/w,S=(f*b-d*x)/(2*w)-i,A=(d*y-f*m)/w,C=_*_+A*A-1,E=2*(a+k*_+S*A),T=k*k+S*S-a*a,N=-(C?(E+Math.sqrt(E*E-4*C*T))/(2*C):T/E);return{x:r+k+_*N,y:i+S+A*N,r:N}}function WM(t,e,n){var r,i,a,o,s=t.x-e.x,c=t.y-e.y,u=s*s+c*c;u?(i=e.r+n.r,i*=i,o=t.r+n.r,i>(o*=o)?(r=(u+o-i)/(2*u),a=Math.sqrt(Math.max(0,o/u-r*r)),n.x=t.x-r*s-a*c,n.y=t.y-r*c+a*s):(r=(u+i-o)/(2*u),a=Math.sqrt(Math.max(0,i/u-r*r)),n.x=e.x+r*s-a*c,n.y=e.y+r*c+a*s)):(n.x=e.x+n.r,n.y=e.y)}function VM(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function qM(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,a=(e.y*n.r+n.y*e.r)/r;return i*i+a*a}function GM(t){this._=t,this.next=null,this.previous=null}function HM(t){if(!(i=(t=function(t){return"object"===typeof t&&"length"in t?t:Array.from(t)}(t)).length))return 0;var e,n,r,i,a,o,s,c,u,l,h;if((e=t[0]).x=0,e.y=0,!(i>1))return e.r;if(n=t[1],e.x=-n.r,n.x=e.r,n.y=0,!(i>2))return e.r+n.r;WM(n,e,r=t[2]),e=new GM(e),n=new GM(n),r=new GM(r),e.next=r.previous=n,n.next=e.previous=r,r.next=n.previous=e;t:for(s=3;s<i;++s){WM(e._,n._,r=t[s]),r=new GM(r),c=n.next,u=e.previous,l=n._.r,h=e._.r;do{if(l<=h){if(VM(c._,r._)){n=c,e.next=n,n.previous=e,--s;continue t}l+=c._.r,c=c.next}else{if(VM(u._,r._)){(e=u).next=n,n.previous=e,--s;continue t}h+=u._.r,u=u.previous}}while(c!==u.next);for(r.previous=e,r.next=n,e.next=n.previous=n=r,a=qM(e);(r=r.next)!==n;)(o=qM(r))<a&&(e=r,a=o);n=e.next}for(e=[n._],r=n;(r=r.next)!==n;)e.push(r._);for(r=OM(e),s=0;s<i;++s)(e=t[s]).x-=r.x,e.y-=r.y;return r.r}function YM(t){if("function"!==typeof t)throw new Error;return t}function XM(){return 0}function KM(t){return function(){return t}}function $M(t){return Math.sqrt(t.value)}function ZM(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function QM(t,e){return function(n){if(r=n.children){var r,i,a,o=r.length,s=t(n)*e||0;if(s)for(i=0;i<o;++i)r[i].r+=s;if(a=HM(r),s)for(i=0;i<o;++i)r[i].r-=s;n.r=a+s}}}function JM(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function tO(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function eO(t,e,n,r,i){for(var a,o=t.children,s=-1,c=o.length,u=t.value&&(r-e)/t.value;++s<c;)(a=o[s]).y0=n,a.y1=i,a.x0=e,a.x1=e+=a.value*u}kM.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:wM}]},jn(kM,Ic,{transform(t,e){var n,r,i=this.value,a=e.changed(e.ADD_REM),o=t.modified(bM),s=t.iterations||300;if(i?(a&&(e.modifies("index"),i.nodes(e.source)),(o||e.changed(e.MOD))&&_M(i,t,0,e)):(this.value=i=function(t,e){const n=pM(t),r=n.stop,i=n.restart;let a=!1;return n.stopped=()=>a,n.restart=()=>(a=!1,i()),n.stop=()=>(a=!0,r()),_M(n,e,!0).on("end",(()=>a=!0))}(e.source,t),i.on("tick",(n=e.dataflow,r=this,()=>n.touch(r).run())),t.static||(a=!0,i.tick()),e.modifies("index")),o||a||t.modified(xM)||e.changed()&&t.restart)if(i.alpha(Math.max(i.alpha(),t.alpha||1)).alphaDecay(1-Math.pow(i.alphaMin(),1/s)),t.static)for(i.stop();--s>=0;)i.tick();else if(i.stopped()&&i.restart(),!a)return e.StopPropagation;return this.finish(t,e)},finish(t,e){const n=e.dataflow;for(let s,c=this._argops,u=0,l=c.length;u<l;++u)if(s=c[u],s.name===vM&&"link"===s.op._argval.force)for(var r,i=s.op._argops,a=0,o=i.length;a<o;++a)if("links"===i[a].name&&(r=i[a].op.source)){n.pulse(r,n.changeset().reflow());break}return e.reflow(t.modified()).modifies(wM)}}),MM.prototype=TM.prototype={constructor:MM,count:function(){return this.eachAfter(EM)},each:function(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this},eachAfter:function(t,e){for(var n,r,i,a=this,o=[a],s=[],c=-1;a=o.pop();)if(s.push(a),n=a.children)for(r=0,i=n.length;r<i;++r)o.push(n[r]);for(;a=s.pop();)t.call(e,a,++c,this);return this},eachBefore:function(t,e){for(var n,r,i=this,a=[i],o=-1;i=a.pop();)if(t.call(e,i,++o,this),n=i.children)for(r=n.length-1;r>=0;--r)a.push(n[r]);return this},find:function(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;t=n.pop(),e=r.pop();for(;t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return TM(this).eachBefore(FM)},[Symbol.iterator]:function*(){var t,e,n,r,i=this,a=[i];do{for(t=a.reverse(),a=[];i=t.pop();)if(yield i,e=i.children)for(n=0,r=e.length;n<r;++n)a.push(e[n])}while(a.length)}};var nO={depth:-1},rO={};function iO(t){return t.id}function aO(t){return t.parentId}function oO(){var t=iO,e=aO;function n(n){var r,i,a,o,s,c,u,l=Array.from(n),h=l.length,d=new Map;for(i=0;i<h;++i)r=l[i],s=l[i]=new MM(r),null!=(c=t(r,i,n))&&(c+="")&&(u=s.id=c,d.set(u,d.has(u)?rO:s)),null!=(c=e(r,i,n))&&(c+="")&&(s.parent=c);for(i=0;i<h;++i)if(c=(s=l[i]).parent){if(!(o=d.get(c)))throw new Error("missing: "+c);if(o===rO)throw new Error("ambiguous: "+c);o.children?o.children.push(s):o.children=[s],s.parent=o}else{if(a)throw new Error("multiple roots");a=s}if(!a)throw new Error("no root");if(a.parent=nO,a.eachBefore((function(t){t.depth=t.parent.depth+1,--h})).eachBefore(IM),a.parent=null,h>0)throw new Error("cycle");return a}return n.id=function(e){return arguments.length?(t=YM(e),n):t},n.parentId=function(t){return arguments.length?(e=YM(t),n):e},n}function sO(t,e){return t.parent===e.parent?1:2}function cO(t){var e=t.children;return e?e[0]:t.t}function uO(t){var e=t.children;return e?e[e.length-1]:t.t}function lO(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function hO(t,e,n){return t.a.parent===e.parent?t.a:n}function dO(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function fO(t,e){return t.parent===e.parent?1:2}function pO(t,e){return t+e.x}function gO(t,e){return Math.max(t,e.y)}function mO(t,e,n,r,i){for(var a,o=t.children,s=-1,c=o.length,u=t.value&&(i-n)/t.value;++s<c;)(a=o[s]).x0=e,a.x1=r,a.y0=n,a.y1=n+=a.value*u}dO.prototype=Object.create(MM.prototype);var yO=(1+Math.sqrt(5))/2;function vO(t,e,n,r,i,a){for(var o,s,c,u,l,h,d,f,p,g,m,y=[],v=e.children,b=0,x=0,w=v.length,k=e.value;b<w;){c=i-n,u=a-r;do{l=v[x++].value}while(!l&&x<w);for(h=d=l,m=l*l*(g=Math.max(u/c,c/u)/(k*t)),p=Math.max(d/m,m/h);x<w;++x){if(l+=s=v[x].value,s<h&&(h=s),s>d&&(d=s),m=l*l*g,(f=Math.max(d/m,m/h))>p){l-=s;break}p=f}y.push(o={value:l,dice:c<u,children:v.slice(b,x)}),o.dice?eO(o,n,r,i,k?r+=u*l/k:a):mO(o,n,r,k?n+=c*l/k:i,a),k-=l,b=x}return y}const bO=function t(e){function n(t,n,r,i,a){vO(e,t,n,r,i,a)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(yO),xO=function t(e){function n(t,n,r,i,a){if((o=t._squarify)&&o.ratio===e)for(var o,s,c,u,l,h=-1,d=o.length,f=t.value;++h<d;){for(c=(s=o[h]).children,u=s.value=0,l=c.length;u<l;++u)s.value+=c[u].value;s.dice?eO(s,n,r,i,f?r+=(a-r)*s.value/f:a):mO(s,n,r,f?n+=(i-n)*s.value/f:i,a),f-=s.value}else t._squarify=o=vO(e,t,n,r,i,a),o.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(yO);function wO(t,e,n){const r={};return t.each((t=>{const i=t.data;n(i)&&(r[e(i)]=t)})),t.lookup=r,t}function kO(t){Ic.call(this,null,t)}kO.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const _O=t=>t.values;function SO(){const t=[],e={entries:t=>r(n(t,0),0),key:n=>(t.push(n),e)};function n(e,r){if(r>=t.length)return e;const i=e.length,a=t[r++],o={},s={};let c,u,l,h=-1;for(;++h<i;)c=a(u=e[h])+"",(l=o[c])?l.push(u):o[c]=[u];for(c in o)s[c]=n(o[c],r);return s}function r(e,n){if(++n>t.length)return e;const i=[];for(const t in e)i.push({key:t,values:r(e[t],n)});return i}return e}function AO(t){Ic.call(this,null,t)}jn(kO,Ic,{transform(t,e){e.source||qe("Nest transform requires an upstream data source.");var n=t.generate,r=t.modified(),i=e.clone(),a=this.value;return(!a||r||e.changed())&&(a&&a.each((t=>{t.children&&Qs(t.data)&&i.rem.push(t.data)})),this.value=a=TM({values:Sn(t.keys).reduce(((t,e)=>(t.key(e),t)),SO()).entries(i.source)},_O),n&&a.each((t=>{t.children&&(t=ec(t.data),i.add.push(t),i.source.push(t))})),wO(a,Js,Js)),i.source.root=a,i}});const CO=(t,e)=>t.parent===e.parent?1:2;jn(AO,Ic,{transform(t,e){e.source&&e.source.root||qe(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(t.method),r=this.fields,i=e.source.root,a=t.as||r;t.field?i.sum(t.field):i.count(),t.sort&&i.sort(ac(t.sort,(t=>t.data))),function(t,e,n){for(let r,i=0,a=e.length;i<a;++i)r=e[i],r in n&&t[r](n[r])}(n,this.params,t),n.separation&&n.separation(!1!==t.separation?CO:$e);try{this.value=n(i)}catch(o){qe(o)}return i.each((t=>function(t,e,n){const r=t.data,i=e.length-1;for(let a=0;a<i;++a)r[n[a]]=t[e[a]];r[n[i]]=t.children?t.children.length:0}(t,r,a))),e.reflow(t.modified()).modifies(a).modifies("leaf")}});const EO=["x","y","r","depth","children"];function TO(t){AO.call(this,t)}TO.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:EO.length,default:EO}]},jn(TO,AO,{layout:function(){var t=null,e=1,n=1,r=XM;function i(i){return i.x=e/2,i.y=n/2,t?i.eachBefore(ZM(t)).eachAfter(QM(r,.5)).eachBefore(JM(1)):i.eachBefore(ZM($M)).eachAfter(QM(XM,1)).eachAfter(QM(r,i.r/Math.min(e,n))).eachBefore(JM(Math.min(e,n)/(2*i.r))),i}return i.radius=function(e){return arguments.length?(t=null==(n=e)?null:YM(n),i):t;var n},i.size=function(t){return arguments.length?(e=+t[0],n=+t[1],i):[e,n]},i.padding=function(t){return arguments.length?(r="function"===typeof t?t:KM(+t),i):r},i},params:["radius","size","padding"],fields:EO});const NO=["x0","y0","x1","y1","depth","children"];function DO(t){AO.call(this,t)}function FO(t){Ic.call(this,null,t)}DO.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:NO.length,default:NO}]},jn(DO,AO,{layout:function(){var t=1,e=1,n=0,r=!1;function i(i){var a=i.height+1;return i.x0=i.y0=n,i.x1=t,i.y1=e/a,i.eachBefore(function(t,e){return function(r){r.children&&eO(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var i=r.x0,a=r.y0,o=r.x1-n,s=r.y1-n;o<i&&(i=o=(i+o)/2),s<a&&(a=s=(a+s)/2),r.x0=i,r.y0=a,r.x1=o,r.y1=s}}(e,a)),r&&i.eachBefore(tO),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(n){return arguments.length?(t=+n[0],e=+n[1],i):[t,e]},i.padding=function(t){return arguments.length?(n=+t,i):n},i},params:["size","round","padding"],fields:NO}),FO.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},jn(FO,Ic,{transform(t,e){e.source||qe("Stratify transform requires an upstream data source.");let n=this.value;const r=t.modified(),i=e.fork(e.ALL).materialize(e.SOURCE),a=!n||r||e.changed(e.ADD_REM)||e.modified(t.key.fields)||e.modified(t.parentKey.fields);return i.source=i.source.slice(),a&&(n=i.source.length?wO(oO().id(t.key).parentId(t.parentKey)(i.source),t.key,Ze):wO(oO()([{}]),t.key,t.key)),i.source.root=this.value=n,i}});const IO={tidy:function(){var t=sO,e=1,n=1,r=null;function i(i){var c=function(t){for(var e,n,r,i,a,o=new dO(t,0),s=[o];e=s.pop();)if(r=e._.children)for(e.children=new Array(a=r.length),i=a-1;i>=0;--i)s.push(n=e.children[i]=new dO(r[i],i)),n.parent=e;return(o.parent=new dO(null,0)).children=[o],o}(i);if(c.eachAfter(a),c.parent.m=-c.z,c.eachBefore(o),r)i.eachBefore(s);else{var u=i,l=i,h=i;i.eachBefore((function(t){t.x<u.x&&(u=t),t.x>l.x&&(l=t),t.depth>h.depth&&(h=t)}));var d=u===l?1:t(u,l)/2,f=d-u.x,p=e/(l.x+d+f),g=n/(h.depth||1);i.eachBefore((function(t){t.x=(t.x+f)*p,t.y=t.depth*g}))}return i}function a(e){var n=e.children,r=e.parent.children,i=e.i?r[e.i-1]:null;if(n){!function(t){for(var e,n=0,r=0,i=t.children,a=i.length;--a>=0;)(e=i[a]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(e);var a=(n[0].z+n[n.length-1].z)/2;i?(e.z=i.z+t(e._,i._),e.m=e.z-a):e.z=a}else i&&(e.z=i.z+t(e._,i._));e.parent.A=function(e,n,r){if(n){for(var i,a=e,o=e,s=n,c=a.parent.children[0],u=a.m,l=o.m,h=s.m,d=c.m;s=uO(s),a=cO(a),s&&a;)c=cO(c),(o=uO(o)).a=e,(i=s.z+h-a.z-u+t(s._,a._))>0&&(lO(hO(s,e,r),e,i),u+=i,l+=i),h+=s.m,u+=a.m,d+=c.m,l+=o.m;s&&!uO(o)&&(o.t=s,o.m+=h-l),a&&!cO(c)&&(c.t=a,c.m+=u-d,r=e)}return r}(e,i,e.parent.A||r[0])}function o(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function s(t){t.x*=e,t.y=t.depth*n}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i},cluster:function(){var t=fO,e=1,n=1,r=!1;function i(i){var a,o=0;i.eachAfter((function(e){var n=e.children;n?(e.x=function(t){return t.reduce(pO,0)/t.length}(n),e.y=function(t){return 1+t.reduce(gO,0)}(n)):(e.x=a?o+=t(e,a):0,e.y=0,a=e)}));var s=function(t){for(var e;e=t.children;)t=e[0];return t}(i),c=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(i),u=s.x-t(s,c)/2,l=c.x+t(c,s)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*e,t.y=(i.y-t.y)*n}:function(t){t.x=(t.x-u)/(l-u)*e,t.y=(1-(i.y?t.y/i.y:1))*n})}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i}},MO=["x","y","depth","children"];function OO(t){AO.call(this,t)}function RO(t){Ic.call(this,[],t)}OO.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:MO.length,default:MO}]},jn(OO,AO,{layout(t){const e=t||"tidy";if(Bn(IO,e))return IO[e]();qe("Unrecognized Tree layout method: "+e)},params:["size","nodeSize"],fields:MO}),RO.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},jn(RO,Ic,{transform(t,e){const n=this.value,r=e.source&&e.source.root,i=e.fork(e.NO_SOURCE),a={};return r||qe("TreeLinks transform requires a tree data source."),e.changed(e.ADD_REM)?(i.rem=n,e.visit(e.SOURCE,(t=>a[Js(t)]=1)),r.each((t=>{const e=t.data,n=t.parent&&t.parent.data;n&&a[Js(e)]&&a[Js(n)]&&i.add.push(ec({source:n,target:e}))})),this.value=i.add):e.changed(e.MOD)&&(e.visit(e.MOD,(t=>a[Js(t)]=1)),n.forEach((t=>{(a[Js(t.source)]||a[Js(t.target)])&&i.mod.push(t)}))),i}});const zO={binary:function(t,e,n,r,i){var a,o,s=t.children,c=s.length,u=new Array(c+1);for(u[0]=o=a=0;a<c;++a)u[a+1]=o+=s[a].value;!function t(e,n,r,i,a,o,c){if(e>=n-1){var l=s[e];return l.x0=i,l.y0=a,l.x1=o,void(l.y1=c)}var h=u[e],d=r/2+h,f=e+1,p=n-1;for(;f<p;){var g=f+p>>>1;u[g]<d?f=g+1:p=g}d-u[f-1]<u[f]-d&&e+1<f&&--f;var m=u[f]-h,y=r-m;if(o-i>c-a){var v=r?(i*y+o*m)/r:o;t(e,f,m,i,a,v,c),t(f,n,y,v,a,o,c)}else{var b=r?(a*y+c*m)/r:c;t(e,f,m,i,a,o,b),t(f,n,y,i,b,o,c)}}(0,c,t.value,e,n,r,i)},dice:eO,slice:mO,slicedice:function(t,e,n,r,i){(1&t.depth?mO:eO)(t,e,n,r,i)},squarify:bO,resquarify:xO},BO=["x0","y0","x1","y1","depth","children"];function LO(t){AO.call(this,t)}LO.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:BO.length,default:BO}]},jn(LO,AO,{layout(){const t=function(){var t=bO,e=!1,n=1,r=1,i=[0],a=XM,o=XM,s=XM,c=XM,u=XM;function l(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(h),i=[0],e&&t.eachBefore(tO),t}function h(e){var n=i[e.depth],r=e.x0+n,l=e.y0+n,h=e.x1-n,d=e.y1-n;h<r&&(r=h=(r+h)/2),d<l&&(l=d=(l+d)/2),e.x0=r,e.y0=l,e.x1=h,e.y1=d,e.children&&(n=i[e.depth+1]=a(e)/2,r+=u(e)-n,l+=o(e)-n,(h-=s(e)-n)<r&&(r=h=(r+h)/2),(d-=c(e)-n)<l&&(l=d=(l+d)/2),t(e,r,l,h,d))}return l.round=function(t){return arguments.length?(e=!!t,l):e},l.size=function(t){return arguments.length?(n=+t[0],r=+t[1],l):[n,r]},l.tile=function(e){return arguments.length?(t=YM(e),l):t},l.padding=function(t){return arguments.length?l.paddingInner(t).paddingOuter(t):l.paddingInner()},l.paddingInner=function(t){return arguments.length?(a="function"===typeof t?t:KM(+t),l):a},l.paddingOuter=function(t){return arguments.length?l.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):l.paddingTop()},l.paddingTop=function(t){return arguments.length?(o="function"===typeof t?t:KM(+t),l):o},l.paddingRight=function(t){return arguments.length?(s="function"===typeof t?t:KM(+t),l):s},l.paddingBottom=function(t){return arguments.length?(c="function"===typeof t?t:KM(+t),l):c},l.paddingLeft=function(t){return arguments.length?(u="function"===typeof t?t:KM(+t),l):u},l}();return t.ratio=e=>{const n=t.tile();n.ratio&&t.tile(n.ratio(e))},t.method=e=>{Bn(zO,e)?t.tile(zO[e]):qe("Unrecognized Treemap layout method: "+e)},t},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:BO});const PO=4278190080,jO=268435456,UO=.0625;function WO(t,e,n,r){const i=t.width,a=t.height,o=n||r,s=Zd(i,a).getContext("2d");e.forEach((t=>VO(s,t,o)));const c=new Uint32Array(s.getImageData(0,0,i,a).data.buffer),u=t.bitmap(),l=o&&t.bitmap();let h,d,f,p,g;for(d=0;d<a;++d)for(h=0;h<i;++h)g=c[d*i+h]&PO,g&&(f=t(h),p=t(d),r||u.set(f,p),o&&g^jO&&l.set(f,p));return[u,l]}function VO(t,e,n){if(!e.length)return;const r=e[0].mark.marktype;"group"===r?e.forEach((e=>{e.items.forEach((e=>VO(t,e.items,n)))})):Jw[r].draw(t,{items:n?e.map(qO):e})}function qO(t){const e=rc(t,{});return e.stroke&&(e.strokeOpacity=1),e.fill&&(e.fillOpacity=UO,e.stroke="#000",e.strokeOpacity=1,e.strokeWidth=2),e}const GO=5,HO=31,YO=32,XO=new Uint32Array(YO+1),KO=new Uint32Array(YO+1);KO[0]=0,XO[0]=~KO[0];for(let Set=1;Set<=YO;++Set)KO[Set]=KO[Set-1]<<1|1,XO[Set]=~KO[Set];function $O(t,e,n){const r=Math.max(1,Math.sqrt(t*e/1e6)),i=~~((t+2*n+r)/r),a=~~((e+2*n+r)/r),o=t=>~~((t+n)/r);return o.invert=t=>t*r-n,o.bitmap=()=>function(t,e){const n=new Uint32Array(~~((t*e+YO)/YO));function r(t,e){n[t]|=e}function i(t,e){n[t]&=e}return{array:n,get:(e,r)=>{const i=r*t+e;return n[i>>>GO]&1<<(i&HO)},set:(e,n)=>{const i=n*t+e;r(i>>>GO,1<<(i&HO))},clear:(e,n)=>{const r=n*t+e;i(r>>>GO,~(1<<(r&HO)))},getRange:(e,r,i,a)=>{let o,s,c,u,l=a;for(;l>=r;--l)if(o=l*t+e,s=l*t+i,c=o>>>GO,u=s>>>GO,c===u){if(n[c]&XO[o&HO]&KO[1+(s&HO)])return!0}else{if(n[c]&XO[o&HO])return!0;if(n[u]&KO[1+(s&HO)])return!0;for(let t=c+1;t<u;++t)if(n[t])return!0}return!1},setRange:(e,n,i,a)=>{let o,s,c,u,l;for(;n<=a;++n)if(o=n*t+e,s=n*t+i,c=o>>>GO,u=s>>>GO,c===u)r(c,XO[o&HO]&KO[1+(s&HO)]);else for(r(c,XO[o&HO]),r(u,KO[1+(s&HO)]),l=c+1;l<u;++l)r(l,4294967295)},clearRange:(e,n,r,a)=>{let o,s,c,u,l;for(;n<=a;++n)if(o=n*t+e,s=n*t+r,c=o>>>GO,u=s>>>GO,c===u)i(c,KO[o&HO]|XO[1+(s&HO)]);else for(i(c,KO[o&HO]),i(u,XO[1+(s&HO)]),l=c+1;l<u;++l)i(l,0)},outOfBounds:(n,r,i,a)=>n<0||r<0||a>=e||i>=t}}(i,a),o.ratio=r,o.padding=n,o.width=t,o.height=e,o}function ZO(t,e,n,r,i,a){let o=n/2;return t-o<0||t+o>i||e-(o=r/2)<0||e+o>a}function QO(t,e,n,r,i,a,o,s){const c=i*a/(2*r),u=t(e-c),l=t(e+c),h=t(n-(a/=2)),d=t(n+a);return o.outOfBounds(u,h,l,d)||o.getRange(u,h,l,d)||s&&s.getRange(u,h,l,d)}const JO=[-1,-1,1,1],tR=[-1,1,-1,1];const eR=["right","center","left"],nR=["bottom","middle","top"];function rR(t,e,n,r,i,a,o,s,c,u,l,h){return!(i.outOfBounds(t,n,e,r)||(h&&a?a.getRange(t,n,e,r)||!function(t,e,n,r,i){return i[0]<=t&&n<=i[2]&&i[3]<=e&&r<=i[5]}(o,c,s,u,l):i.getRange(t,n,e,r)))}const iR={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},aR={naive:function(t,e,n,r){const i=t.width,a=t.height;return function(t){const e=t.datum.datum.items[r].items,n=e.length,o=t.datum.fontSize,s=Mw.width(t.datum,t.datum.text);let c,u,l,h,d,f,p,g=0;for(let r=0;r<n;++r)c=e[r].x,l=e[r].y,u=void 0===e[r].x2?c:e[r].x2,h=void 0===e[r].y2?l:e[r].y2,d=(c+u)/2,f=(l+h)/2,p=Math.abs(u-c+h-l),p>=g&&(g=p,t.x=d,t.y=f);return d=s/2,f=o/2,c=t.x-d,u=t.x+d,l=t.y-f,h=t.y+f,t.align="center",c<0&&u<=i?t.align="left":0<=c&&i<u&&(t.align="right"),t.baseline="middle",l<0&&h<=a?t.baseline="top":0<=l&&a<h&&(t.baseline="bottom"),!0}},"reduced-search":function(t,e,n,r){const i=t.width,a=t.height,o=e[0],s=e[1];function c(e,n,r,c,u){const l=t.invert(e),h=t.invert(n);let d,f=r,p=a;if(!ZO(l,h,c,u,i,a)&&!QO(t,l,h,u,c,f,o,s)&&!QO(t,l,h,u,c,u,o,null)){for(;p-f>=1;)d=(f+p)/2,QO(t,l,h,u,c,d,o,s)?p=d:f=d;if(f>r)return[l,h,f,!0]}}return function(e){const s=e.datum.datum.items[r].items,u=s.length,l=e.datum.fontSize,h=Mw.width(e.datum,e.datum.text);let d,f,p,g,m,y,v,b,x,w,k,_,S,A,C,E,T,N=n?l:0,D=!1,F=!1,I=0;for(let r=0;r<u;++r){for(d=s[r].x,p=s[r].y,f=void 0===s[r].x2?d:s[r].x2,g=void 0===s[r].y2?p:s[r].y2,d>f&&(T=d,d=f,f=T),p>g&&(T=p,p=g,g=T),x=t(d),k=t(f),w=~~((x+k)/2),_=t(p),A=t(g),S=~~((_+A)/2),v=w;v>=x;--v)for(b=S;b>=_;--b)E=c(v,b,N,h,l),E&&([e.x,e.y,N,D]=E);for(v=w;v<=k;++v)for(b=S;b<=A;++b)E=c(v,b,N,h,l),E&&([e.x,e.y,N,D]=E);D||n||(C=Math.abs(f-d+g-p),m=(d+f)/2,y=(p+g)/2,C>=I&&!ZO(m,y,h,l,i,a)&&!QO(t,m,y,l,h,l,o,null)&&(I=C,e.x=m,e.y=y,F=!0))}return!(!D&&!F)&&(m=h/2,y=l/2,o.setRange(t(e.x-m),t(e.y-y),t(e.x+m),t(e.y+y)),e.align="center",e.baseline="middle",!0)}},floodfill:function(t,e,n,r){const i=t.width,a=t.height,o=e[0],s=e[1],c=t.bitmap();return function(e){const u=e.datum.datum.items[r].items,l=u.length,h=e.datum.fontSize,d=Mw.width(e.datum,e.datum.text),f=[];let p,g,m,y,v,b,x,w,k,_,S,A,C=n?h:0,E=!1,T=!1,N=0;for(let r=0;r<l;++r){for(p=u[r].x,m=u[r].y,g=void 0===u[r].x2?p:u[r].x2,y=void 0===u[r].y2?m:u[r].y2,f.push([t((p+g)/2),t((m+y)/2)]);f.length;)if([x,w]=f.pop(),!(o.get(x,w)||s.get(x,w)||c.get(x,w))){c.set(x,w);for(let t=0;t<4;++t)v=x+JO[t],b=w+tR[t],c.outOfBounds(v,b,v,b)||f.push([v,b]);if(v=t.invert(x),b=t.invert(w),k=C,_=a,!ZO(v,b,d,h,i,a)&&!QO(t,v,b,h,d,k,o,s)&&!QO(t,v,b,h,d,h,o,null)){for(;_-k>=1;)S=(k+_)/2,QO(t,v,b,h,d,S,o,s)?_=S:k=S;k>C&&(e.x=v,e.y=b,C=k,E=!0)}}E||n||(A=Math.abs(g-p+y-m),v=(p+g)/2,b=(m+y)/2,A>=N&&!ZO(v,b,d,h,i,a)&&!QO(t,v,b,h,d,h,o,null)&&(N=A,e.x=v,e.y=b,T=!0))}return!(!E&&!T)&&(v=d/2,b=h/2,o.setRange(t(e.x-v),t(e.y-b),t(e.x+v),t(e.y+b)),e.align="center",e.baseline="middle",!0)}}};function oR(t,e,n,r,i,a,o,s,c,u,l){if(!t.length)return t;const h=Math.max(r.length,i.length),d=function(t,e){const n=new Float64Array(e),r=t.length;for(let i=0;i<r;++i)n[i]=t[i]||0;for(let i=r;i<e;++i)n[i]=n[r-1];return n}(r,h),f=function(t,e){const n=new Int8Array(e),r=t.length;for(let i=0;i<r;++i)n[i]|=iR[t[i]];for(let i=r;i<e;++i)n[i]=n[r-1];return n}(i,h),p=(x=t[0].datum)&&x.mark&&x.mark.marktype,g="group"===p&&t[0].datum.items[c].marktype,m="area"===g,y=function(t,e,n,r){const i=t=>[t.x,t.x,t.x,t.y,t.y,t.y];return t?"line"===t||"area"===t?t=>i(t.datum):"line"===e?t=>{const e=t.datum.items[r].items;return i(e.length?e["start"===n?0:e.length-1]:{x:NaN,y:NaN})}:t=>{const e=t.datum.bounds;return[e.x1,(e.x1+e.x2)/2,e.x2,e.y1,(e.y1+e.y2)/2,e.y2]}:i}(p,g,s,c),v=$O(e[0],e[1],u),b=m&&"naive"===l;var x;const w=t.map((t=>({datum:t,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(t)})));let k;if(!b){n&&w.sort(((t,e)=>n(t.datum,e.datum)));let e=!1;for(let t=0;t<f.length&&!e;++t)e=5===f[t]||d[t]<0;p&&(o||m)&&(a=[t.map((t=>t.datum))].concat(a)),k=a.length?WO(v,a,e,m):function(t,e){const n=t.bitmap();return(e||[]).forEach((e=>n.set(t(e.boundary[0]),t(e.boundary[3])))),[n,void 0]}(v,o&&w)}const _=m?aR[l](v,k,o,c):function(t,e,n,r){const i=t.width,a=t.height,o=e[0],s=e[1],c=r.length;return function(e){const u=e.boundary,l=e.datum.fontSize;if(u[2]<0||u[5]<0||u[0]>i||u[3]>a)return!1;let h,d,f,p,g,m,y,v,b,x,w,k,_,S,A,C=0;for(let i=0;i<c;++i){if(h=(3&n[i])-1,d=(n[i]>>>2&3)-1,f=0===h&&0===d||r[i]<0,p=h&&d?Math.SQRT1_2:1,g=r[i]<0?-1:1,m=u[1+h]+r[i]*h*p,w=u[4+d]+g*l*d/2+r[i]*d*p,v=w-l/2,b=w+l/2,k=t(m),S=t(v),A=t(b),!C){if(!rR(k,k,S,A,o,s,m,m,v,b,u,f))continue;C=Mw.width(e.datum,e.datum.text)}if(x=m+g*C*h/2,m=x-C/2,y=x+C/2,k=t(m),_=t(y),rR(k,_,S,A,o,s,m,y,v,b,u,f))return e.x=h?h*g<0?y:m:x,e.y=d?d*g<0?b:v:w,e.align=eR[h*g+1],e.baseline=nR[d*g+1],o.setRange(k,S,_,A),!0}return!1}}(v,k,f,d);return w.forEach((t=>t.opacity=+_(t))),w}const sR=["x","y","opacity","align","baseline"],cR=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function uR(t){Ic.call(this,null,t)}function lR(t,e){var n,r,i,a,o,s,c=[],u=function(t){return t(a)};if(null==e)c.push(t);else for(n={},r=0,i=t.length;r<i;++r)a=t[r],(s=n[o=e.map(u)])||(n[o]=s=[],s.dims=o,c.push(s)),s.push(a);return c}function hR(t){Ic.call(this,null,t)}uR.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:cR},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:sR.length,default:sR}]},jn(uR,Ic,{transform(t,e){const n=t.modified();if(!(n||e.changed(e.ADD_REM)||function(n){const r=t[n];return An(r)&&e.modified(r.fields)}("sort")))return;t.size&&2===t.size.length||qe("Size parameter should be specified as a [width, height] array.");const r=t.as||sR;return oR(e.materialize(e.SOURCE).source,t.size,t.sort,Sn(t.offset||1),Sn(t.anchor||cR),t.avoidMarks||[],!1!==t.avoidBaseMark,t.lineAnchor||"end",t.markIndex||0,t.padding||0,t.method||"naive").forEach((t=>{const e=t.datum;e[r[0]]=t.x,e[r[1]]=t.y,e[r[2]]=t.opacity,e[r[3]]=t.align,e[r[4]]=t.baseline})),e.reflow(n).modifies(r)}}),hR.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},jn(hR,Ic,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=lR(e.materialize(e.SOURCE).source,t.groupby),i=(t.groupby||[]).map(Pe),a=i.length,o=t.as||[Pe(t.x),Pe(t.y)],s=[];r.forEach((e=>{(function(t,e,n,r){const[i,a,o,s]=mu(t,e,n,!0),c=i.length,u=Math.max(2,~~(r*c)),l=new Float64Array(c),h=new Float64Array(c),d=new Float64Array(c).fill(1);for(let f=-1;++f<=2;){const t=[0,u-1];for(let n=0;n<c;++n){const e=i[n],r=t[0],o=t[1],s=e-i[r]>i[o]-e?r:o;let c=0,u=0,f=0,p=0,g=0;const m=1/Math.abs(i[s]-e||1);for(let t=r;t<=o;++t){const n=i[t],r=a[t],o=ku(Math.abs(e-n)*m)*d[t],s=n*o;c+=o,u+=s,f+=r*o,p+=r*s,g+=n*s}const[y,v]=gu(u/c,f/c,p/c,g/c);l[n]=y+v*e,h[n]=Math.abs(a[n]-l[n]),_u(i,n+1,t)}if(2===f)break;const e=Gc(h);if(Math.abs(e)<1e-12)break;for(let n,r,i=0;i<c;++i)n=h[i]/(6*e),d[i]=n>=1?1e-12:(r=1-n*n)*r}return function(t,e,n,r){const i=t.length,a=[];let o,s=0,c=0,u=[];for(;s<i;++s)o=t[s]+n,u[0]===o?u[1]+=(e[s]-u[1])/++c:(c=0,u[1]+=r,u=[o,e[s]],a.push(u));return u[1]+=r,a}(i,l,o,s)})(e,t.x,t.y,t.bandwidth||.3).forEach((t=>{const n={};for(let r=0;r<a;++r)n[i[r]]=e.dims[r];n[o[0]]=t[0],n[o[1]]=t[1],s.push(ec(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=s}return n}});const dR={linear:bu,log:function(t,e,n){let r=0,i=0,a=0,o=0,s=0;yu(t,e,n,((t,e)=>{++s,t=Math.log(t),r+=(t-r)/s,i+=(e-i)/s,a+=(t*e-a)/s,o+=(t*t-o)/s}));const c=gu(r,i,a,o),u=t=>c[0]+c[1]*Math.log(t);return{coef:c,predict:u,rSquared:vu(t,e,n,i,u)}},exp:function(t,e,n){const[r,i,a,o]=mu(t,e,n);let s,c,u,l=0,h=0,d=0,f=0,p=0;yu(t,e,n,((t,e)=>{s=r[p++],c=Math.log(e),u=s*e,l+=(e*c-l)/p,h+=(u-h)/p,d+=(u*c-d)/p,f+=(s*u-f)/p}));const[g,m]=gu(h/o,l/o,d/o,f/o),y=t=>Math.exp(g+m*(t-a));return{coef:[Math.exp(g-m*a),m],predict:y,rSquared:vu(t,e,n,o,y)}},pow:function(t,e,n){let r=0,i=0,a=0,o=0,s=0,c=0;yu(t,e,n,((t,e)=>{const n=Math.log(t),u=Math.log(e);++c,r+=(n-r)/c,i+=(u-i)/c,a+=(n*u-a)/c,o+=(n*n-o)/c,s+=(e-s)/c}));const u=gu(r,i,a,o),l=t=>u[0]*Math.pow(t,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:l,rSquared:vu(t,e,n,s,l)}},quad:xu,poly:function(t,e,n,r){if(0===r)return function(t,e,n){let r=0,i=0;for(const a of t){const t=n(a);null==e(a)||null==t||isNaN(t)||(r+=(t-r)/++i)}return{coef:[r],predict:()=>r,rSquared:0}}(t,e,n);if(1===r)return bu(t,e,n);if(2===r)return xu(t,e,n);const[i,a,o,s]=mu(t,e,n),c=i.length,u=[],l=[],h=r+1;let d,f,p,g,m;for(d=0;d<h;++d){for(p=0,g=0;p<c;++p)g+=Math.pow(i[p],d)*a[p];for(u.push(g),m=new Float64Array(h),f=0;f<h;++f){for(p=0,g=0;p<c;++p)g+=Math.pow(i[p],d+f);m[f]=g}l.push(m)}l.push(u);const y=function(t){const e=t.length-1,n=[];let r,i,a,o,s;for(r=0;r<e;++r){for(o=r,i=r+1;i<e;++i)Math.abs(t[r][i])>Math.abs(t[r][o])&&(o=i);for(a=r;a<e+1;++a)s=t[a][r],t[a][r]=t[a][o],t[a][o]=s;for(i=r+1;i<e;++i)for(a=e;a>=r;a--)t[a][i]-=t[a][r]*t[r][i]/t[r][r]}for(i=e-1;i>=0;--i){for(s=0,a=i+1;a<e;++a)s+=t[a][i]*n[a];n[i]=(t[e][i]-s)/t[i][i]}return n}(l),v=t=>{t-=o;let e=s+y[0]+y[1]*t+y[2]*t*t;for(d=3;d<h;++d)e+=y[d]*Math.pow(t,d);return e};return{coef:wu(h,y,-o,s),predict:v,rSquared:vu(t,e,n,s,v)}}};function fR(t){Ic.call(this,null,t)}fR.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(dR)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},jn(fR,Ic,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=lR(e.materialize(e.SOURCE).source,t.groupby),i=(t.groupby||[]).map(Pe),a=t.method||"linear",o=t.order||3,s=((t,e)=>"poly"===t?e:"quad"===t?2:1)(a,o),c=t.as||[Pe(t.x),Pe(t.y)],u=dR[a],l=[];let h=t.extent;Bn(dR,a)||qe("Invalid regression method: "+a),null!=h&&"log"===a&&h[0]<=0&&(e.dataflow.warn("Ignoring extent with values <= 0 for log regression."),h=null),r.forEach((n=>{if(n.length<=s)return void e.dataflow.warn("Skipping regression with more parameters than data points.");const r=u(n,t.x,t.y,o);if(t.params)return void l.push(ec({keys:n.dims,coef:r.coef,rSquared:r.rSquared}));const d=h||Rn(n,t.x),f=t=>{const e={};for(let r=0;r<i.length;++r)e[i[r]]=n.dims[r];e[c[0]]=t[0],e[c[1]]=t[1],l.push(ec(e))};"linear"===a?d.forEach((t=>f([t,r.predict(t)]))):Au(r.predict,d,25,200).forEach(f)})),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});const pR=Math.pow(2,-52),gR=new Uint32Array(512);class mR{static from(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:SR,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:AR;const r=t.length,i=new Float64Array(2*r);for(let a=0;a<r;a++){const r=t[a];i[2*a]=e(r),i[2*a+1]=n(r)}return new mR(i)}constructor(t){const e=t.length>>1;if(e>0&&"number"!==typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:n,_hullTri:r,_hullHash:i}=this,a=t.length>>1;let o=1/0,s=1/0,c=-1/0,u=-1/0;for(let A=0;A<a;A++){const e=t[2*A],n=t[2*A+1];e<o&&(o=e),n<s&&(s=n),e>c&&(c=e),n>u&&(u=n),this._ids[A]=A}const l=(o+c)/2,h=(s+u)/2;let d,f,p,g=1/0;for(let A=0;A<a;A++){const e=yR(l,h,t[2*A],t[2*A+1]);e<g&&(d=A,g=e)}const m=t[2*d],y=t[2*d+1];g=1/0;for(let A=0;A<a;A++){if(A===d)continue;const e=yR(m,y,t[2*A],t[2*A+1]);e<g&&e>0&&(f=A,g=e)}let v=t[2*f],b=t[2*f+1],x=1/0;for(let A=0;A<a;A++){if(A===d||A===f)continue;const e=wR(m,y,v,b,t[2*A],t[2*A+1]);e<x&&(p=A,x=e)}let w=t[2*p],k=t[2*p+1];if(x===1/0){for(let r=0;r<a;r++)this._dists[r]=t[2*r]-t[0]||t[2*r+1]-t[1];kR(this._ids,this._dists,0,a-1);const e=new Uint32Array(a);let n=0;for(let t=0,r=-1/0;t<a;t++){const i=this._ids[t];this._dists[i]>r&&(e[n++]=i,r=this._dists[i])}return this.hull=e.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(bR(m,y,v,b,w,k)){const t=f,e=v,n=b;f=p,v=w,b=k,p=t,w=e,k=n}const _=function(t,e,n,r,i,a){const o=n-t,s=r-e,c=i-t,u=a-e,l=o*o+s*s,h=c*c+u*u,d=.5/(o*u-s*c),f=t+(u*l-s*h)*d,p=e+(o*h-c*l)*d;return{x:f,y:p}}(m,y,v,b,w,k);this._cx=_.x,this._cy=_.y;for(let A=0;A<a;A++)this._dists[A]=yR(t[2*A],t[2*A+1],_.x,_.y);kR(this._ids,this._dists,0,a-1),this._hullStart=d;let S=3;n[d]=e[p]=f,n[f]=e[d]=p,n[p]=e[f]=d,r[d]=0,r[f]=1,r[p]=2,i.fill(-1),i[this._hashKey(m,y)]=d,i[this._hashKey(v,b)]=f,i[this._hashKey(w,k)]=p,this.trianglesLen=0,this._addTriangle(d,f,p,-1,-1,-1);for(let A,C,E=0;E<this._ids.length;E++){const a=this._ids[E],o=t[2*a],s=t[2*a+1];if(E>0&&Math.abs(o-A)<=pR&&Math.abs(s-C)<=pR)continue;if(A=o,C=s,a===d||a===f||a===p)continue;let c=0;for(let t=0,e=this._hashKey(o,s);t<this._hashSize&&(c=i[(e+t)%this._hashSize],-1===c||c===n[c]);t++);c=e[c];let u,l=c;for(;u=n[l],!bR(o,s,t[2*l],t[2*l+1],t[2*u],t[2*u+1]);)if(l=u,l===c){l=-1;break}if(-1===l)continue;let h=this._addTriangle(l,a,n[l],-1,-1,r[l]);r[a]=this._legalize(h+2),r[l]=h,S++;let g=n[l];for(;u=n[g],bR(o,s,t[2*g],t[2*g+1],t[2*u],t[2*u+1]);)h=this._addTriangle(g,a,u,r[a],-1,r[g]),r[a]=this._legalize(h+2),n[g]=g,S--,g=u;if(l===c)for(;u=e[l],bR(o,s,t[2*u],t[2*u+1],t[2*l],t[2*l+1]);)h=this._addTriangle(u,a,l,-1,r[l],r[u]),this._legalize(h+2),r[u]=h,n[l]=l,S--,l=u;this._hullStart=e[a]=l,n[l]=e[g]=a,n[a]=g,i[this._hashKey(o,s)]=a,i[this._hashKey(t[2*l],t[2*l+1])]=l}this.hull=new Uint32Array(S);for(let A=0,C=this._hullStart;A<S;A++)this.hull[A]=C,C=n[C];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(function(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:n,coords:r}=this;let i=0,a=0;for(;;){const o=n[t],s=t-t%3;if(a=s+(t+2)%3,-1===o){if(0===i)break;t=gR[--i];continue}const c=o-o%3,u=s+(t+1)%3,l=c+(o+2)%3,h=e[a],d=e[t],f=e[u],p=e[l];if(xR(r[2*h],r[2*h+1],r[2*d],r[2*d+1],r[2*f],r[2*f+1],r[2*p],r[2*p+1])){e[t]=p,e[o]=h;const r=n[l];if(-1===r){let e=this._hullStart;do{if(this._hullTri[e]===l){this._hullTri[e]=t;break}e=this._hullPrev[e]}while(e!==this._hullStart)}this._link(t,r),this._link(o,n[a]),this._link(a,l);const s=c+(o+1)%3;i<gR.length&&(gR[i++]=s)}else{if(0===i)break;t=gR[--i]}}return a}_link(t,e){this._halfedges[t]=e,-1!==e&&(this._halfedges[e]=t)}_addTriangle(t,e,n,r,i,a){const o=this.trianglesLen;return this._triangles[o]=t,this._triangles[o+1]=e,this._triangles[o+2]=n,this._link(o,r),this._link(o+1,i),this._link(o+2,a),this.trianglesLen+=3,o}}function yR(t,e,n,r){const i=t-n,a=e-r;return i*i+a*a}function vR(t,e,n,r,i,a){const o=(r-e)*(i-t),s=(n-t)*(a-e);return Math.abs(o-s)>=33306690738754716e-32*Math.abs(o+s)?o-s:0}function bR(t,e,n,r,i,a){return(vR(i,a,t,e,n,r)||vR(t,e,n,r,i,a)||vR(n,r,i,a,t,e))<0}function xR(t,e,n,r,i,a,o,s){const c=t-o,u=e-s,l=n-o,h=r-s,d=i-o,f=a-s,p=l*l+h*h,g=d*d+f*f;return c*(h*g-p*f)-u*(l*g-p*d)+(c*c+u*u)*(l*f-h*d)<0}function wR(t,e,n,r,i,a){const o=n-t,s=r-e,c=i-t,u=a-e,l=o*o+s*s,h=c*c+u*u,d=.5/(o*u-s*c),f=(u*l-s*h)*d,p=(o*h-c*l)*d;return f*f+p*p}function kR(t,e,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const r=t[i],a=e[r];let o=i-1;for(;o>=n&&e[t[o]]>a;)t[o+1]=t[o--];t[o+1]=r}else{let i=n+1,a=r;_R(t,n+r>>1,i),e[t[n]]>e[t[r]]&&_R(t,n,r),e[t[i]]>e[t[r]]&&_R(t,i,r),e[t[n]]>e[t[i]]&&_R(t,n,i);const o=t[i],s=e[o];for(;;){do{i++}while(e[t[i]]<s);do{a--}while(e[t[a]]>s);if(a<i)break;_R(t,i,a)}t[n+1]=t[a],t[a]=o,r-i+1>=a-n?(kR(t,e,i,r),kR(t,e,n,a-1)):(kR(t,e,n,a-1),kR(t,e,i,r))}}function _R(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function SR(t){return t[0]}function AR(t){return t[1]}const CR=1e-6;class ER{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,e){this._+="M".concat(this._x0=this._x1=+t,",").concat(this._y0=this._y1=+e)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,e){this._+="L".concat(this._x1=+t,",").concat(this._y1=+e)}arc(t,e,n){const r=(t=+t)+(n=+n),i=e=+e;if(n<0)throw new Error("negative radius");null===this._x1?this._+="M".concat(r,",").concat(i):(Math.abs(this._x1-r)>CR||Math.abs(this._y1-i)>CR)&&(this._+="L"+r+","+i),n&&(this._+="A".concat(n,",").concat(n,",0,1,1,").concat(t-n,",").concat(e,"A").concat(n,",").concat(n,",0,1,1,").concat(this._x1=r,",").concat(this._y1=i))}rect(t,e,n,r){this._+="M".concat(this._x0=this._x1=+t,",").concat(this._y0=this._y1=+e,"h").concat(+n,"v").concat(+r,"h").concat(-n,"Z")}value(){return this._||null}}class TR{constructor(){this._=[]}moveTo(t,e){this._.push([t,e])}closePath(){this._.push(this._[0].slice())}lineTo(t,e){this._.push([t,e])}value(){return this._.length?this._:null}}class NR{constructor(t){let[e,n,r,i]=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,960,500];if(!((r=+r)>=(e=+e))||!((i=+i)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=r,this.xmin=e,this.ymax=i,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:e,triangles:n},vectors:r}=this,i=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let d,f,p=0,g=0,m=n.length;p<m;p+=3,g+=2){const e=2*n[p],r=2*n[p+1],a=2*n[p+2],o=t[e],s=t[e+1],c=t[r],u=t[r+1],l=t[a],h=t[a+1],m=c-o,y=u-s,v=l-o,b=h-s,x=m*m+y*y,w=v*v+b*b,k=2*(m*b-y*v);if(k)if(Math.abs(k)<1e-8)d=(o+l)/2,f=(s+h)/2;else{const t=1/k;d=o+(b*x-y*w)*t,f=s+(m*w-v*x)*t}else d=(o+l)/2-1e8*b,f=(s+h)/2+1e8*v;i[g]=d,i[g+1]=f}let a,o,s,c=e[e.length-1],u=4*c,l=t[2*c],h=t[2*c+1];r.fill(0);for(let d=0;d<e.length;++d)c=e[d],a=u,o=l,s=h,u=4*c,l=t[2*c],h=t[2*c+1],r[a+2]=r[u]=s-h,r[a+3]=r[u+1]=l-o}render(t){const e=null==t?t=new ER:void 0,{delaunay:{halfedges:n,inedges:r,hull:i},circumcenters:a,vectors:o}=this;if(i.length<=1)return null;for(let u=0,l=n.length;u<l;++u){const e=n[u];if(e<u)continue;const r=2*Math.floor(u/3),i=2*Math.floor(e/3),o=a[r],s=a[r+1],c=a[i],l=a[i+1];this._renderSegment(o,s,c,l,t)}let s,c=i[i.length-1];for(let u=0;u<i.length;++u){s=c,c=i[u];const e=2*Math.floor(r[c]/3),n=a[e],l=a[e+1],h=4*s,d=this._project(n,l,o[h+2],o[h+3]);d&&this._renderSegment(n,l,d[0],d[1],t)}return e&&e.value()}renderBounds(t){const e=null==t?t=new ER:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),e&&e.value()}renderCell(t,e){const n=null==e?e=new ER:void 0,r=this._clip(t);if(null===r||!r.length)return;e.moveTo(r[0],r[1]);let i=r.length;for(;r[0]===r[i-2]&&r[1]===r[i-1]&&i>1;)i-=2;for(let a=2;a<i;a+=2)r[a]===r[a-2]&&r[a+1]===r[a-1]||e.lineTo(r[a],r[a+1]);return e.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let e=0,n=t.length/2;e<n;++e){const t=this.cellPolygon(e);t&&(t.index=e,yield t)}}cellPolygon(t){const e=new TR;return this.renderCell(t,e),e.value()}_renderSegment(t,e,n,r,i){let a;const o=this._regioncode(t,e),s=this._regioncode(n,r);0===o&&0===s?(i.moveTo(t,e),i.lineTo(n,r)):(a=this._clipSegment(t,e,n,r,o,s))&&(i.moveTo(a[0],a[1]),i.lineTo(a[2],a[3]))}contains(t,e,n){return(e=+e)===e&&(n=+n)===n&&this.delaunay._step(t,e,n)===t}*neighbors(t){const e=this._clip(t);if(e)for(const n of this.delaunay.neighbors(t)){const t=this._clip(n);if(t)t:for(let r=0,i=e.length;r<i;r+=2)for(let a=0,o=t.length;a<o;a+=2)if(e[r]==t[a]&&e[r+1]==t[a+1]&&e[(r+2)%i]==t[(a+o-2)%o]&&e[(r+3)%i]==t[(a+o-1)%o]){yield n;break t}}}_cell(t){const{circumcenters:e,delaunay:{inedges:n,halfedges:r,triangles:i}}=this,a=n[t];if(-1===a)return null;const o=[];let s=a;do{const n=Math.floor(s/3);if(o.push(e[2*n],e[2*n+1]),s=s%3===2?s-2:s+1,i[s]!==t)break;s=r[s]}while(s!==a&&-1!==s);return o}_clip(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const e=this._cell(t);if(null===e)return null;const{vectors:n}=this,r=4*t;return n[r]||n[r+1]?this._clipInfinite(t,e,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(t,e)}_clipFinite(t,e){const n=e.length;let r,i,a,o,s,c=null,u=e[n-2],l=e[n-1],h=this._regioncode(u,l);for(let d=0;d<n;d+=2)if(r=u,i=l,u=e[d],l=e[d+1],a=h,h=this._regioncode(u,l),0===a&&0===h)o=s,s=0,c?c.push(u,l):c=[u,l];else{let e,n,d,f,p;if(0===a){if(null===(e=this._clipSegment(r,i,u,l,a,h)))continue;[n,d,f,p]=e}else{if(null===(e=this._clipSegment(u,l,r,i,h,a)))continue;[f,p,n,d]=e,o=s,s=this._edgecode(n,d),o&&s&&this._edge(t,o,s,c,c.length),c?c.push(n,d):c=[n,d]}o=s,s=this._edgecode(f,p),o&&s&&this._edge(t,o,s,c,c.length),c?c.push(f,p):c=[f,p]}if(c)o=s,s=this._edgecode(c[0],c[1]),o&&s&&this._edge(t,o,s,c,c.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return c}_clipSegment(t,e,n,r,i,a){for(;;){if(0===i&&0===a)return[t,e,n,r];if(i&a)return null;let o,s,c=i||a;8&c?(o=t+(n-t)*(this.ymax-e)/(r-e),s=this.ymax):4&c?(o=t+(n-t)*(this.ymin-e)/(r-e),s=this.ymin):2&c?(s=e+(r-e)*(this.xmax-t)/(n-t),o=this.xmax):(s=e+(r-e)*(this.xmin-t)/(n-t),o=this.xmin),i?(t=o,e=s,i=this._regioncode(t,e)):(n=o,r=s,a=this._regioncode(n,r))}}_clipInfinite(t,e,n,r,i,a){let o,s=Array.from(e);if((o=this._project(s[0],s[1],n,r))&&s.unshift(o[0],o[1]),(o=this._project(s[s.length-2],s[s.length-1],i,a))&&s.push(o[0],o[1]),s=this._clipFinite(t,s))for(let c,u=0,l=s.length,h=this._edgecode(s[l-2],s[l-1]);u<l;u+=2)c=h,h=this._edgecode(s[u],s[u+1]),c&&h&&(u=this._edge(t,c,h,s,u),l=s.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(t,e,n,r,i){for(;e!==n;){let n,a;switch(e){case 5:e=4;continue;case 4:e=6,n=this.xmax,a=this.ymin;break;case 6:e=2;continue;case 2:e=10,n=this.xmax,a=this.ymax;break;case 10:e=8;continue;case 8:e=9,n=this.xmin,a=this.ymax;break;case 9:e=1;continue;case 1:e=5,n=this.xmin,a=this.ymin}r[i]===n&&r[i+1]===a||!this.contains(t,n,a)||(r.splice(i,0,n,a),i+=2)}if(r.length>4)for(let a=0;a<r.length;a+=2){const t=(a+2)%r.length,e=(a+4)%r.length;(r[a]===r[t]&&r[t]===r[e]||r[a+1]===r[t+1]&&r[t+1]===r[e+1])&&(r.splice(t,2),a-=2)}return i}_project(t,e,n,r){let i,a,o,s=1/0;if(r<0){if(e<=this.ymin)return null;(i=(this.ymin-e)/r)<s&&(o=this.ymin,a=t+(s=i)*n)}else if(r>0){if(e>=this.ymax)return null;(i=(this.ymax-e)/r)<s&&(o=this.ymax,a=t+(s=i)*n)}if(n>0){if(t>=this.xmax)return null;(i=(this.xmax-t)/n)<s&&(a=this.xmax,o=e+(s=i)*r)}else if(n<0){if(t<=this.xmin)return null;(i=(this.xmin-t)/n)<s&&(a=this.xmin,o=e+(s=i)*r)}return[a,o]}_edgecode(t,e){return(t===this.xmin?1:t===this.xmax?2:0)|(e===this.ymin?4:e===this.ymax?8:0)}_regioncode(t,e){return(t<this.xmin?1:t>this.xmax?2:0)|(e<this.ymin?4:e>this.ymax?8:0)}}const DR=2*Math.PI,FR=Math.pow;function IR(t){return t[0]}function MR(t){return t[1]}function OR(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class RR{static from(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:IR,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:MR,r=arguments.length>3?arguments[3]:void 0;return new RR("length"in t?function(t,e,n,r){const i=t.length,a=new Float64Array(2*i);for(let o=0;o<i;++o){const i=t[o];a[2*o]=e.call(r,i,o,t),a[2*o+1]=n.call(r,i,o,t)}return a}(t,e,n,r):Float64Array.from(function*(t,e,n,r){let i=0;for(const a of t)yield e.call(r,a,i,t),yield n.call(r,a,i,t),++i}(t,e,n,r)))}constructor(t){this._delaunator=new mR(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,e=this.points;if(t.hull&&t.hull.length>2&&function(t){const{triangles:e,coords:n}=t;for(let r=0;r<e.length;r+=3){const t=2*e[r],i=2*e[r+1],a=2*e[r+2];if((n[a]-n[t])*(n[i+1]-n[t+1])-(n[i]-n[t])*(n[a+1]-n[t+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:e.length/2},((t,e)=>e)).sort(((t,n)=>e[2*t]-e[2*n]||e[2*t+1]-e[2*n+1]));const t=this.collinear[0],n=this.collinear[this.collinear.length-1],r=[e[2*t],e[2*t+1],e[2*n],e[2*n+1]],i=1e-8*Math.hypot(r[3]-r[1],r[2]-r[0]);for(let a=0,o=e.length/2;a<o;++a){const t=OR(e[2*a],e[2*a+1],i);e[2*a]=t[0],e[2*a+1]=t[1]}this._delaunator=new mR(e)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,i=this.triangles=this._delaunator.triangles,a=this.inedges.fill(-1),o=this._hullIndex.fill(-1);for(let s=0,c=n.length;s<c;++s){const t=i[s%3===2?s-2:s+1];-1!==n[s]&&-1!==a[t]||(a[t]=s)}for(let s=0,c=r.length;s<c;++s)o[r[s]]=s;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],this.triangles[1]=r[1],this.triangles[2]=r[1],a[r[0]]=1,2===r.length&&(a[r[1]]=0))}voronoi(t){return new NR(this,t)}*neighbors(t){const{inedges:e,hull:n,_hullIndex:r,halfedges:i,triangles:a,collinear:o}=this;if(o){const e=o.indexOf(t);return e>0&&(yield o[e-1]),void(e<o.length-1&&(yield o[e+1]))}const s=e[t];if(-1===s)return;let c=s,u=-1;do{if(yield u=a[c],c=c%3===2?c-2:c+1,a[c]!==t)return;if(c=i[c],-1===c){const e=n[(r[t]+1)%n.length];return void(e!==u&&(yield e))}}while(c!==s)}find(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((t=+t)!==t||(e=+e)!==e)return-1;const r=n;let i;for(;(i=this._step(n,t,e))>=0&&i!==n&&i!==r;)n=i;return i}_step(t,e,n){const{inedges:r,hull:i,_hullIndex:a,halfedges:o,triangles:s,points:c}=this;if(-1===r[t]||!c.length)return(t+1)%(c.length>>1);let u=t,l=FR(e-c[2*t],2)+FR(n-c[2*t+1],2);const h=r[t];let d=h;do{let r=s[d];const h=FR(e-c[2*r],2)+FR(n-c[2*r+1],2);if(h<l&&(l=h,u=r),d=d%3===2?d-2:d+1,s[d]!==t)break;if(d=o[d],-1===d){if(d=i[(a[t]+1)%i.length],d!==r&&FR(e-c[2*d],2)+FR(n-c[2*d+1],2)<l)return d;break}}while(d!==h);return u}render(t){const e=null==t?t=new ER:void 0,{points:n,halfedges:r,triangles:i}=this;for(let a=0,o=r.length;a<o;++a){const e=r[a];if(e<a)continue;const o=2*i[a],s=2*i[e];t.moveTo(n[o],n[o+1]),t.lineTo(n[s],n[s+1])}return this.renderHull(t),e&&e.value()}renderPoints(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;const n=null==t?t=new ER:void 0,{points:r}=this;for(let i=0,a=r.length;i<a;i+=2){const n=r[i],a=r[i+1];t.moveTo(n+e,a),t.arc(n,a,e,0,DR)}return n&&n.value()}renderHull(t){const e=null==t?t=new ER:void 0,{hull:n,points:r}=this,i=2*n[0],a=n.length;t.moveTo(r[i],r[i+1]);for(let o=1;o<a;++o){const e=2*n[o];t.lineTo(r[e],r[e+1])}return t.closePath(),e&&e.value()}hullPolygon(){const t=new TR;return this.renderHull(t),t.value()}renderTriangle(t,e){const n=null==e?e=new ER:void 0,{points:r,triangles:i}=this,a=2*i[t*=3],o=2*i[t+1],s=2*i[t+2];return e.moveTo(r[a],r[a+1]),e.lineTo(r[o],r[o+1]),e.lineTo(r[s],r[s+1]),e.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:t}=this;for(let e=0,n=t.length/3;e<n;++e)yield this.trianglePolygon(e)}trianglePolygon(t){const e=new TR;return this.renderTriangle(t,e),e.value()}}function zR(t){Ic.call(this,null,t)}zR.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const BR=[-1e5,-1e5,1e5,1e5];function LR(t){const e=t[0][0],n=t[0][1];let r=t.length-1;for(;t[r][0]===e&&t[r][1]===n;--r);return"M"+t.slice(0,r+1).join("L")+"Z"}jn(zR,Ic,{transform(t,e){const n=t.as||"path",r=e.source;if(!r||!r.length)return e;let i=t.size;i=i?[0,0,i[0],i[1]]:(i=t.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:BR;const a=this.value=RR.from(r,t.x,t.y).voronoi(i);for(let o=0,s=r.length;o<s;++o){const t=a.cellPolygon(o);r[o][n]=t?LR(t):null}return e.reflow(t.modified()).modifies(n)}});var PR=Math.PI/180,jR=64,UR=2048;function WR(){var t,e,n,r,i,a,o,s=[256,256],c=YR,u=[],l=Math.random,h={};function d(t,e,n){for(var r,i,a,o=e.x,u=e.y,h=Math.sqrt(s[0]*s[0]+s[1]*s[1]),d=c(s),f=l()<.5?1:-1,p=-f;(r=d(p+=f))&&(i=~~r[0],a=~~r[1],!(Math.min(Math.abs(i),Math.abs(a))>=h));)if(e.x=o+i,e.y=u+a,!(e.x+e.x0<0||e.y+e.y0<0||e.x+e.x1>s[0]||e.y+e.y1>s[1])&&(!n||!qR(e,t,s[0]))&&(!n||HR(e,n))){for(var g,m=e.sprite,y=e.width>>5,v=s[0]>>5,b=e.x-(y<<4),x=127&b,w=32-x,k=e.y1-e.y0,_=(e.y+e.y0)*v+(b>>5),S=0;S<k;S++){g=0;for(var A=0;A<=y;A++)t[_+A]|=g<<w|(A<y?(g=m[S*y+A])>>>x:0);_+=v}return e.sprite=null,!0}return!1}return h.layout=function(){for(var c=function(t){t.width=t.height=1;var e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2);t.width=(jR<<5)/e,t.height=UR/e;var n=t.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:e}}(Zd()),h=function(t){var e=[],n=-1;for(;++n<t;)e[n]=0;return e}((s[0]>>5)*s[1]),f=null,p=u.length,g=-1,m=[],y=u.map((s=>({text:t(s),font:e(s),style:r(s),weight:i(s),rotate:a(s),size:~~(n(s)+1e-14),padding:o(s),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:s}))).sort(((t,e)=>e.size-t.size));++g<p;){var v=y[g];v.x=s[0]*(l()+.5)>>1,v.y=s[1]*(l()+.5)>>1,VR(c,v,y,g),v.hasText&&d(h,v,f)&&(m.push(v),f?GR(f,v):f=[{x:v.x+v.x0,y:v.y+v.y0},{x:v.x+v.x1,y:v.y+v.y1}],v.x-=s[0]>>1,v.y-=s[1]>>1)}return m},h.words=function(t){return arguments.length?(u=t,h):u},h.size=function(t){return arguments.length?(s=[+t[0],+t[1]],h):s},h.font=function(t){return arguments.length?(e=XR(t),h):e},h.fontStyle=function(t){return arguments.length?(r=XR(t),h):r},h.fontWeight=function(t){return arguments.length?(i=XR(t),h):i},h.rotate=function(t){return arguments.length?(a=XR(t),h):a},h.text=function(e){return arguments.length?(t=XR(e),h):t},h.spiral=function(t){return arguments.length?(c=KR[t]||t,h):c},h.fontSize=function(t){return arguments.length?(n=XR(t),h):n},h.padding=function(t){return arguments.length?(o=XR(t),h):o},h.random=function(t){return arguments.length?(l=t,h):l},h}function VR(t,e,n,r){if(!e.sprite){var i=t.context,a=t.ratio;i.clearRect(0,0,(jR<<5)/a,UR/a);var o,s,c,u,l,h=0,d=0,f=0,p=n.length;for(--r;++r<p;){if(e=n[r],i.save(),i.font=e.style+" "+e.weight+" "+~~((e.size+1)/a)+"px "+e.font,o=i.measureText(e.text+"m").width*a,c=e.size<<1,e.rotate){var g=Math.sin(e.rotate*PR),m=Math.cos(e.rotate*PR),y=o*m,v=o*g,b=c*m,x=c*g;o=Math.max(Math.abs(y+x),Math.abs(y-x))+31>>5<<5,c=~~Math.max(Math.abs(v+b),Math.abs(v-b))}else o=o+31>>5<<5;if(c>f&&(f=c),h+o>=jR<<5&&(h=0,d+=f,f=0),d+c>=UR)break;i.translate((h+(o>>1))/a,(d+(c>>1))/a),e.rotate&&i.rotate(e.rotate*PR),i.fillText(e.text,0,0),e.padding&&(i.lineWidth=2*e.padding,i.strokeText(e.text,0,0)),i.restore(),e.width=o,e.height=c,e.xoff=h,e.yoff=d,e.x1=o>>1,e.y1=c>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,h+=o}for(var w=i.getImageData(0,0,(jR<<5)/a,UR/a).data,k=[];--r>=0;)if((e=n[r]).hasText){for(s=(o=e.width)>>5,c=e.y1-e.y0,u=0;u<c*s;u++)k[u]=0;if(null==(h=e.xoff))return;d=e.yoff;var _=0,S=-1;for(l=0;l<c;l++){for(u=0;u<o;u++){var A=s*l+(u>>5),C=w[(d+l)*(jR<<5)+(h+u)<<2]?1<<31-u%32:0;k[A]|=C,_|=C}_?S=l:(e.y0++,c--,l--,d++)}e.y1=e.y0+S,e.sprite=k.slice(0,(e.y1-e.y0)*s)}}}function qR(t,e,n){n>>=5;for(var r,i=t.sprite,a=t.width>>5,o=t.x-(a<<4),s=127&o,c=32-s,u=t.y1-t.y0,l=(t.y+t.y0)*n+(o>>5),h=0;h<u;h++){r=0;for(var d=0;d<=a;d++)if((r<<c|(d<a?(r=i[h*a+d])>>>s:0))&e[l+d])return!0;l+=n}return!1}function GR(t,e){var n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function HR(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}function YR(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function XR(t){return"function"===typeof t?t:function(){return t}}var KR={archimedean:YR,rectangular:function(t){var e=4*t[0]/t[1],n=0,r=0;return function(t){var i=t<0?-1:1;switch(Math.sqrt(1+4*i*t)-i&3){case 0:n+=e;break;case 1:r+=4;break;case 2:n-=e;break;default:r-=4}return[n,r]}}};const $R=["x","y","font","fontSize","fontStyle","fontWeight","angle"],ZR=["text","font","rotate","fontSize","fontStyle","fontWeight"];function QR(t){Ic.call(this,WR(),t)}QR.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:$R}]},jn(QR,Ic,{transform(t,e){!t.size||t.size[0]&&t.size[1]||qe("Wordcloud size dimensions must be non-zero.");const n=t.modified();if(!(n||e.changed(e.ADD_REM)||ZR.some((function(n){const r=t[n];return An(r)&&e.modified(r.fields)}))))return;const r=e.materialize(e.SOURCE).source,i=this.value,a=t.as||$R;let o,s=t.fontSize||14;if(An(s)?o=t.fontSizeRange:s=In(s),o){const t=s,e=wv("sqrt")().domain(Rn(r,t)).range(o);s=n=>e(t(n))}r.forEach((t=>{t[a[0]]=NaN,t[a[1]]=NaN,t[a[3]]=0}));const c=i.words(r).text(t.text).size(t.size||[500,500]).padding(t.padding||1).spiral(t.spiral||"archimedean").rotate(t.rotate||0).font(t.font||"sans-serif").fontStyle(t.fontStyle||"normal").fontWeight(t.fontWeight||"normal").fontSize(s).random($c).layout(),u=i.size(),l=u[0]>>1,h=u[1]>>1,d=c.length;for(let f,p,g=0;g<d;++g)f=c[g],p=f.datum,p[a[0]]=f.x+l,p[a[1]]=f.y+h,p[a[2]]=f.font,p[a[3]]=f.size,p[a[4]]=f.style,p[a[5]]=f.weight,p[a[6]]=f.rotate;return e.reflow(n).modifies(a)}});const JR=Bu(Nu),tz=JR.right,ez=JR.left,nz=(Bu(Iu).center,tz);const rz=t=>new Uint8Array(t),iz=t=>new Uint16Array(t),az=t=>new Uint32Array(t);function oz(t,e,n){const r=(e<257?rz:e<65537?iz:az)(t);return n&&r.set(n),r}function sz(t,e,n){const r=1<<e;return{one:r,zero:~r,range:n.slice(),bisect:t.bisect,index:t.index,size:t.size,onAdd(t,e){const n=this,i=n.bisect(n.range,t.value),a=t.index,o=i[0],s=i[1],c=a.length;let u;for(u=0;u<o;++u)e[a[u]]|=r;for(u=s;u<c;++u)e[a[u]]|=r;return n}}}function cz(){let t=az(0),e=[],n=0;return{insert:function(r,i,a){if(!i.length)return[];const o=n,s=i.length,c=az(s);let u,l,h,d=Array(s);for(h=0;h<s;++h)d[h]=r(i[h]),c[h]=h;if(d=function(t,e){return t.sort.call(e,((e,n)=>{const r=t[e],i=t[n];return r<i?-1:r>i?1:0})),function(t,e){return Array.from(e,(e=>t[e]))}(t,e)}(d,c),o)u=e,l=t,e=Array(o+s),t=az(o+s),function(t,e,n,r,i,a,o,s,c){let u,l=0,h=0;for(u=0;l<r&&h<o;++u)e[l]<i[h]?(s[u]=e[l],c[u]=n[l++]):(s[u]=i[h],c[u]=a[h++]+t);for(;l<r;++l,++u)s[u]=e[l],c[u]=n[l];for(;h<o;++h,++u)s[u]=i[h],c[u]=a[h]+t}(a,u,l,o,d,c,s,e,t);else{if(a>0)for(h=0;h<s;++h)c[h]+=a;e=d,t=c}return n=o+s,{index:c,value:d}},remove:function(r,i){const a=n;let o,s,c;for(s=0;!i[t[s]]&&s<a;++s);for(c=s;s<a;++s)i[o=t[s]]||(t[c]=o,e[c]=e[s],++c);n=a-r},bisect:function(t,r){let i;return r?i=r.length:(r=e,i=n),[ez(r,t[0],0,i),tz(r,t[1],0,i)]},reindex:function(e){for(let r=0,i=n;r<i;++r)t[r]=e[t[r]]},index:()=>t,size:()=>n}}function uz(t){Ic.call(this,function(){let t=8,e=[],n=az(0),r=oz(0,t),i=oz(0,t);return{data:()=>e,seen:()=>n=function(t,e,n){return t.length>=e?t:((n=n||new t.constructor(e)).set(t),n)}(n,e.length),add(t){for(let n,r=0,i=e.length,a=t.length;r<a;++r)n=t[r],n._index=i++,e.push(n)},remove(t,n){const a=e.length,o=Array(a-t),s=e;let c,u,l;for(u=0;!n[u]&&u<a;++u)o[u]=e[u],s[u]=u;for(l=u;u<a;++u)c=e[u],n[u]?s[u]=-1:(s[u]=l,r[l]=r[u],i[l]=i[u],o[l]=c,c._index=l++),r[u]=0;return e=o,s},size:()=>e.length,curr:()=>r,prev:()=>i,reset:t=>i[t]=r[t],all:()=>t<257?255:t<65537?65535:4294967295,set(t,e){r[t]|=e},clear(t,e){r[t]&=~e},resize(e,n){(e>r.length||n>t)&&(t=Math.max(n,t),r=oz(e,t,r),i=oz(e,t))}}}(),t),this._indices=null,this._dims=null}function lz(t){Ic.call(this,null,t)}function*hz(t,e){if(null==e)for(let n of t)null!=n&&""!==n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)r=e(r,++n,t),null!=r&&""!==r&&(r=+r)>=r&&(yield r)}}function dz(t,e,n){const r=Float64Array.from(hz(t,n));return r.sort(Nu),e.map((t=>Ou(r,t)))}function fz(t,e){return dz(t,[.25,.5,.75],e)}function pz(t,e){const n=t.length,r=function(t,e){const n=function(t,e){let n,r=0,i=0,a=0;if(void 0===e)for(let o of t)null!=o&&(o=+o)>=o&&(n=o-i,i+=n/++r,a+=n*(o-i));else{let o=-1;for(let s of t)null!=(s=e(s,++o,t))&&(s=+s)>=s&&(n=s-i,i+=n/++r,a+=n*(s-i))}if(r>1)return a/(r-1)}(t,e);return n?Math.sqrt(n):n}(t,e),i=fz(t,e),a=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,a)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function gz(t){const e=t.maxbins||20,n=t.base||10,r=Math.log(n),i=t.divide||[5,2];let a,o,s,c,u,l,h=t.extent[0],d=t.extent[1];const f=t.span||d-h||Math.abs(h)||1;if(t.step)a=t.step;else if(t.steps){for(c=f/e,u=0,l=t.steps.length;u<l&&t.steps[u]<c;++u);a=t.steps[Math.max(0,u-1)]}else{for(o=Math.ceil(Math.log(e)/r),s=t.minstep||0,a=Math.max(s,Math.pow(n,Math.round(Math.log(f)/r)-o));Math.ceil(f/a)>e;)a*=n;for(u=0,l=i.length;u<l;++u)c=a/i[u],c>=s&&f/c<=e&&(a=c)}c=Math.log(a);const p=c>=0?0:1+~~(-c/r),g=Math.pow(n,-p-1);return(t.nice||void 0===t.nice)&&(c=Math.floor(h/a+g)*a,h=h<c?c-a:c,d=Math.ceil(d/a)*a),{start:h,stop:d===h?h+a:d,step:a}}uz.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},jn(uz,Ic,{transform(t,e){return this._dims?t.modified("fields")||t.fields.some((t=>e.modified(t.fields)))?this.reinit(t,e):this.eval(t,e):this.init(t,e)},init(t,e){const n=t.fields,r=t.query,i=this._indices={},a=this._dims=[],o=r.length;let s,c,u=0;for(;u<o;++u)s=n[u].fname,c=i[s]||(i[s]=cz()),a.push(sz(c,u,r[u]));return this.eval(t,e)},reinit(t,e){const n=e.materialize().fork(),r=t.fields,i=t.query,a=this._indices,o=this._dims,s=this.value,c=s.curr(),u=s.prev(),l=s.all(),h=n.rem=n.add,d=n.mod,f=i.length,p={};let g,m,y,v,b,x,w,k,_;if(u.set(c),e.rem.length&&(b=this.remove(t,e,n)),e.add.length&&s.add(e.add),e.mod.length)for(x={},v=e.mod,w=0,k=v.length;w<k;++w)x[v[w]._index]=1;for(w=0;w<f;++w)_=r[w],(!o[w]||t.modified("fields",w)||e.modified(_.fields))&&(y=_.fname,(g=p[y])||(a[y]=m=cz(),p[y]=g=m.insert(_,e.source,0)),o[w]=sz(m,w,i[w]).onAdd(g,c));for(w=0,k=s.data().length;w<k;++w)b[w]||(u[w]!==c[w]?h.push(w):x[w]&&c[w]!==l&&d.push(w));return s.mask=(1<<f)-1,n},eval(t,e){const n=e.materialize().fork(),r=this._dims.length;let i=0;return e.rem.length&&(this.remove(t,e,n),i|=(1<<r)-1),t.modified("query")&&!t.modified("fields")&&(i|=this.update(t,e,n)),e.add.length&&(this.insert(t,e,n),i|=(1<<r)-1),e.mod.length&&(this.modify(e,n),i|=(1<<r)-1),this.value.mask=i,n},insert(t,e,n){const r=e.add,i=this.value,a=this._dims,o=this._indices,s=t.fields,c={},u=n.add,l=i.size()+r.length,h=a.length;let d,f,p,g=i.size();i.resize(l,h),i.add(r);const m=i.curr(),y=i.prev(),v=i.all();for(d=0;d<h;++d)f=s[d].fname,p=c[f]||(c[f]=o[f].insert(s[d],r,g)),a[d].onAdd(p,m);for(;g<l;++g)y[g]=v,m[g]!==v&&u.push(g)},modify(t,e){const n=e.mod,r=this.value,i=r.curr(),a=r.all(),o=t.mod;let s,c,u;for(s=0,c=o.length;s<c;++s)u=o[s]._index,i[u]!==a&&n.push(u)},remove(t,e,n){const r=this._indices,i=this.value,a=i.curr(),o=i.prev(),s=i.all(),c={},u=n.rem,l=e.rem;let h,d,f,p;for(h=0,d=l.length;h<d;++h)f=l[h]._index,c[f]=1,o[f]=p=a[f],a[f]=s,p!==s&&u.push(f);for(f in r)r[f].remove(d,c);return this.reindex(e,d,c),c},reindex(t,e,n){const r=this._indices,i=this.value;t.runAfter((()=>{const t=i.remove(e,n);for(const e in r)r[e].reindex(t)}))},update(t,e,n){const r=this._dims,i=t.query,a=e.stamp,o=r.length;let s,c,u=0;for(n.filters=0,c=0;c<o;++c)t.modified("query",c)&&(s=c,++u);if(1===u)u=r[s].one,this.incrementOne(r[s],i[s],n.add,n.rem);else for(c=0,u=0;c<o;++c)t.modified("query",c)&&(u|=r[c].one,this.incrementAll(r[c],i[c],a,n.add),n.rem=n.add);return u},incrementAll(t,e,n,r){const i=this.value,a=i.seen(),o=i.curr(),s=i.prev(),c=t.index(),u=t.bisect(t.range),l=t.bisect(e),h=l[0],d=l[1],f=u[0],p=u[1],g=t.one;let m,y,v;if(h<f)for(m=h,y=Math.min(f,d);m<y;++m)v=c[m],a[v]!==n&&(s[v]=o[v],a[v]=n,r.push(v)),o[v]^=g;else if(h>f)for(m=f,y=Math.min(h,p);m<y;++m)v=c[m],a[v]!==n&&(s[v]=o[v],a[v]=n,r.push(v)),o[v]^=g;if(d>p)for(m=Math.max(h,p),y=d;m<y;++m)v=c[m],a[v]!==n&&(s[v]=o[v],a[v]=n,r.push(v)),o[v]^=g;else if(d<p)for(m=Math.max(f,d),y=p;m<y;++m)v=c[m],a[v]!==n&&(s[v]=o[v],a[v]=n,r.push(v)),o[v]^=g;t.range=e.slice()},incrementOne(t,e,n,r){const i=this.value.curr(),a=t.index(),o=t.bisect(t.range),s=t.bisect(e),c=s[0],u=s[1],l=o[0],h=o[1],d=t.one;let f,p,g;if(c<l)for(f=c,p=Math.min(l,u);f<p;++f)g=a[f],i[g]^=d,n.push(g);else if(c>l)for(f=l,p=Math.min(c,h);f<p;++f)g=a[f],i[g]^=d,r.push(g);if(u>h)for(f=Math.max(c,h),p=u;f<p;++f)g=a[f],i[g]^=d,n.push(g);else if(u<h)for(f=Math.max(l,u),p=h;f<p;++f)g=a[f],i[g]^=d,r.push(g);t.range=e.slice()}}),lz.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},jn(lz,Ic,{transform(t,e){const n=~(t.ignore||0),r=t.filter,i=r.mask;if(0===(i&n))return e.StopPropagation;const a=e.fork(e.ALL),o=r.data(),s=r.curr(),c=r.prev(),u=t=>s[t]&n?null:o[t];return a.filter(a.MOD,u),i&i-1?(a.filter(a.ADD,(t=>{const e=s[t]&n;return!e&&e^c[t]&n?o[t]:null})),a.filter(a.REM,(t=>{const e=s[t]&n;return e&&!(e^e^c[t]&n)?o[t]:null}))):(a.filter(a.ADD,u),a.filter(a.REM,(t=>(s[t]&n)===i?o[t]:null))),a.filter(a.SOURCE,(t=>u(t._index)))}});var mz=Math.random;function yz(t){mz=t}function vz(t,e,n,r){if(!t.length)return[void 0,void 0];const i=Float64Array.from(hz(t,r)),a=i.length,o=e;let s,c,u,l;for(u=0,l=Array(o);u<o;++u){for(s=0,c=0;c<a;++c)s+=i[~~(mz()*a)];l[u]=s/a}return l.sort(Nu),[Mu(l,n/2),Mu(l,1-n/2)]}function bz(t,e,n,r){r=r||(t=>t);const i=t.length,a=new Float64Array(i);let o,s=0,c=1,u=r(t[0]),l=u,h=u+e;for(;c<i;++c){if(o=r(t[c]),o>=h){for(l=(u+l)/2;s<c;++s)a[s]=l;h=o+e,u=o}l=o}for(l=(u+l)/2;s<c;++s)a[s]=l;return n?function(t,e){const n=t.length;let r,i,a=0,o=1;for(;t[a]===t[o];)++o;for(;o<n;){for(r=o+1;t[o]===t[r];)++r;if(t[o]-t[o-1]<e){for(i=o+(a+r-o-o>>1);i<o;)t[i++]=t[o];for(;i>o;)t[i--]=t[a]}a=o,o=r}return t}(a,e+e/4):a}function xz(t){return function(){return(t=(1103515245*t+12345)%2147483647)/2147483647}}function wz(t,e){let n,r,i;null==e&&(e=t,t=0);const a={min(t){return arguments.length?(n=t||0,i=r-n,a):n},max(t){return arguments.length?(r=t||0,i=r-n,a):r},sample:()=>n+Math.floor(i*mz()),pdf:t=>t===Math.floor(t)&&t>=n&&t<r?1/i:0,cdf(t){const e=Math.floor(t);return e<n?0:e>=r?1:(e-n+1)/i},icdf:t=>t>=0&&t<=1?n-1+Math.floor(t*i):NaN};return a.min(t).max(e)}const kz=Math.sqrt(2*Math.PI),_z=Math.SQRT2;let Sz=NaN;function Az(t,e){t=t||0,e=null==e?1:e;let n,r,i=0,a=0;if(Sz===Sz)i=Sz,Sz=NaN;else{do{i=2*mz()-1,a=2*mz()-1,n=i*i+a*a}while(0===n||n>1);r=Math.sqrt(-2*Math.log(n)/n),i*=r,Sz=a*r}return t+i*e}function Cz(t,e,n){const r=(t-(e||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*kz)}function Ez(t,e,n){const r=(t-(e=e||0))/(n=null==n?1:n),i=Math.abs(r);let a;if(i>37)a=0;else{const t=Math.exp(-i*i/2);let e;i<7.07106781186547?(e=.0352624965998911*i+.700383064443688,e=e*i+6.37396220353165,e=e*i+33.912866078383,e=e*i+112.079291497871,e=e*i+221.213596169931,e=e*i+220.206867912376,a=t*e,e=.0883883476483184*i+1.75566716318264,e=e*i+16.064177579207,e=e*i+86.7807322029461,e=e*i+296.564248779674,e=e*i+637.333633378831,e=e*i+793.826512519948,e=e*i+440.413735824752,a/=e):(e=i+.65,e=i+4/e,e=i+3/e,e=i+2/e,e=i+1/e,a=t/e/2.506628274631)}return r>0?1-a:a}function Tz(t,e,n){return t<0||t>1?NaN:(e||0)+(null==n?1:n)*_z*function(t){let e,n=-Math.log((1-t)*(1+t));n<6.25?(n-=3.125,e=-364441206401782e-35,e=e*n-16850591381820166e-35,e=128584807152564e-32+e*n,e=11157877678025181e-33+e*n,e=e*n-1333171662854621e-31,e=20972767875968562e-33+e*n,e=6637638134358324e-30+e*n,e=e*n-4054566272975207e-29,e=e*n-8151934197605472e-29,e=26335093153082323e-28+e*n,e=e*n-12975133253453532e-27,e=e*n-5415412054294628e-26,e=1.0512122733215323e-9+e*n,e=e*n-4.112633980346984e-9,e=e*n-2.9070369957882005e-8,e=4.2347877827932404e-7+e*n,e=e*n-13654692000834679e-22,e=e*n-13882523362786469e-21,e=.00018673420803405714+e*n,e=e*n-.000740702534166267,e=e*n-.006033670871430149,e=.24015818242558962+e*n,e=1.6536545626831027+e*n):n<16?(n=Math.sqrt(n)-3.25,e=2.2137376921775787e-9,e=9.075656193888539e-8+e*n,e=e*n-2.7517406297064545e-7,e=1.8239629214389228e-8+e*n,e=15027403968909828e-22+e*n,e=e*n-4013867526981546e-21,e=29234449089955446e-22+e*n,e=12475304481671779e-21+e*n,e=e*n-47318229009055734e-21,e=6828485145957318e-20+e*n,e=24031110387097894e-21+e*n,e=e*n-.0003550375203628475,e=.0009532893797373805+e*n,e=e*n-.0016882755560235047,e=.002491442096107851+e*n,e=e*n-.003751208507569241,e=.005370914553590064+e*n,e=1.0052589676941592+e*n,e=3.0838856104922208+e*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,e=-27109920616438573e-27,e=e*n-2.555641816996525e-10,e=1.5076572693500548e-9+e*n,e=e*n-3.789465440126737e-9,e=7.61570120807834e-9+e*n,e=e*n-1.496002662714924e-8,e=2.914795345090108e-8+e*n,e=e*n-6.771199775845234e-8,e=2.2900482228026655e-7+e*n,e=e*n-9.9298272942317e-7,e=4526062597223154e-21+e*n,e=e*n-1968177810553167e-20,e=7599527703001776e-20+e*n,e=e*n-.00021503011930044477,e=e*n-.00013871931833623122,e=1.0103004648645344+e*n,e=4.849906401408584+e*n):e=1/0;return e*t}(2*t-1)}function Nz(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>Az(n,r),pdf:t=>Cz(t,n,r),cdf:t=>Ez(t,n,r),icdf:t=>Tz(t,n,r)};return i.mean(t).stdev(e)}function Dz(t,e){const n=Nz();let r=0;const i={data(n){return arguments.length?(t=n,r=n?n.length:0,i.bandwidth(e)):t},bandwidth(n){return arguments.length?(!(e=n)&&t&&(e=pz(t)),i):e},sample:()=>t[~~(mz()*r)]+e*n.sample(),pdf(i){let a=0,o=0;for(;o<r;++o)a+=n.pdf((i-t[o])/e);return a/e/r},cdf(i){let a=0,o=0;for(;o<r;++o)a+=n.cdf((i-t[o])/e);return a/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(t)}function Fz(t,e){return t=t||0,e=null==e?1:e,Math.exp(t+Az()*e)}function Iz(t,e,n){if(t<=0)return 0;e=e||0,n=null==n?1:n;const r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*kz*t)}function Mz(t,e,n){return Ez(Math.log(t),e,n)}function Oz(t,e,n){return Math.exp(Tz(t,e,n))}function Rz(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>Fz(n,r),pdf:t=>Iz(t,n,r),cdf:t=>Mz(t,n,r),icdf:t=>Oz(t,n,r)};return i.mean(t).stdev(e)}function zz(t,e){let n,r=0;const i={weights(t){return arguments.length?(n=function(t){const e=[];let n,i=0;for(n=0;n<r;++n)i+=e[n]=null==t[n]?1:+t[n];for(n=0;n<r;++n)e[n]/=i;return e}(e=t||[]),i):e},distributions(n){return arguments.length?(n?(r=n.length,t=n):(r=0,t=[]),i.weights(e)):t},sample(){const e=mz();let i=t[r-1],a=n[0],o=0;for(;o<r-1;a+=n[++o])if(e<a){i=t[o];break}return i.sample()},pdf(e){let i=0,a=0;for(;a<r;++a)i+=n[a]*t[a].pdf(e);return i},cdf(e){let i=0,a=0;for(;a<r;++a)i+=n[a]*t[a].cdf(e);return i},icdf(){throw Error("Mixture icdf not supported.")}};return i.distributions(t).weights(e)}function Bz(t,e){return null==e&&(e=null==t?1:t,t=0),t+(e-t)*mz()}function Lz(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=e&&t<=n?1/(n-e):0}function Pz(t,e,n){return null==n&&(n=null==e?1:e,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function jz(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=0&&t<=1?e+t*(n-e):NaN}function Uz(t,e){let n,r;const i={min(t){return arguments.length?(n=t||0,i):n},max(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>Bz(n,r),pdf:t=>Lz(t,n,r),cdf:t=>Pz(t,n,r),icdf:t=>jz(t,n,r)};return null==e&&(e=null==t?1:t,t=0),i.min(t).max(e)}function Wz(t,e,n,r){const i=r-t*t,a=Math.abs(i)<1e-24?0:(n-t*e)/i;return[e-a*t,a]}function Vz(t,e,n,r){t=t.filter((t=>{let r=e(t),i=n(t);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i})),r&&t.sort(((t,n)=>e(t)-e(n)));const i=t.length,a=new Float64Array(i),o=new Float64Array(i);let s,c,u,l=0,h=0,d=0;for(u of t)a[l]=s=+e(u),o[l]=c=+n(u),++l,h+=(s-h)/l,d+=(c-d)/l;for(l=0;l<i;++l)a[l]-=h,o[l]-=d;return[a,o,h,d]}function qz(t,e,n,r){let i,a,o=-1;for(const s of t)i=e(s),a=n(s),null!=i&&(i=+i)>=i&&null!=a&&(a=+a)>=a&&r(i,a,++o)}function Gz(t,e,n,r,i){let a=0,o=0;return qz(t,e,n,((t,e)=>{const n=e-i(t),s=e-r;a+=n*n,o+=s*s})),1-a/o}function Hz(t,e,n){let r=0,i=0,a=0,o=0,s=0;qz(t,e,n,((t,e)=>{++s,r+=(t-r)/s,i+=(e-i)/s,a+=(t*e-a)/s,o+=(t*t-o)/s}));const c=Wz(r,i,a,o),u=t=>c[0]+c[1]*t;return{coef:c,predict:u,rSquared:Gz(t,e,n,i,u)}}function Yz(t,e,n){let r=0,i=0,a=0,o=0,s=0;qz(t,e,n,((t,e)=>{++s,t=Math.log(t),r+=(t-r)/s,i+=(e-i)/s,a+=(t*e-a)/s,o+=(t*t-o)/s}));const c=Wz(r,i,a,o),u=t=>c[0]+c[1]*Math.log(t);return{coef:c,predict:u,rSquared:Gz(t,e,n,i,u)}}function Xz(t,e,n){const[r,i,a,o]=Vz(t,e,n);let s,c,u,l=0,h=0,d=0,f=0,p=0;qz(t,e,n,((t,e)=>{s=r[p++],c=Math.log(e),u=s*e,l+=(e*c-l)/p,h+=(u-h)/p,d+=(u*c-d)/p,f+=(s*u-f)/p}));const[g,m]=Wz(h/o,l/o,d/o,f/o),y=t=>Math.exp(g+m*(t-a));return{coef:[Math.exp(g-m*a),m],predict:y,rSquared:Gz(t,e,n,o,y)}}function Kz(t,e,n){let r=0,i=0,a=0,o=0,s=0,c=0;qz(t,e,n,((t,e)=>{const n=Math.log(t),u=Math.log(e);++c,r+=(n-r)/c,i+=(u-i)/c,a+=(n*u-a)/c,o+=(n*n-o)/c,s+=(e-s)/c}));const u=Wz(r,i,a,o),l=t=>u[0]*Math.pow(t,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:l,rSquared:Gz(t,e,n,s,l)}}function $z(t,e,n){const[r,i,a,o]=Vz(t,e,n),s=r.length;let c,u,l,h,d=0,f=0,p=0,g=0,m=0;for(c=0;c<s;)u=r[c],l=i[c++],h=u*u,d+=(h-d)/c,f+=(h*u-f)/c,p+=(h*h-p)/c,g+=(u*l-g)/c,m+=(h*l-m)/c;const y=p-d*d,v=d*y-f*f,b=(m*d-g*f)/v,x=(g*y-m*f)/v,w=-b*d,k=t=>b*(t-=a)*t+x*t+w+o;return{coef:[w-x*a+b*a*a+o,x-2*b*a,b],predict:k,rSquared:Gz(t,e,n,o,k)}}function Zz(t,e,n,r){if(1===r)return Hz(t,e,n);if(2===r)return $z(t,e,n);const[i,a,o,s]=Vz(t,e,n),c=i.length,u=[],l=[],h=r+1;let d,f,p,g,m;for(d=0;d<h;++d){for(p=0,g=0;p<c;++p)g+=Math.pow(i[p],d)*a[p];for(u.push(g),m=new Float64Array(h),f=0;f<h;++f){for(p=0,g=0;p<c;++p)g+=Math.pow(i[p],d+f);m[f]=g}l.push(m)}l.push(u);const y=function(t){const e=t.length-1,n=[];let r,i,a,o,s;for(r=0;r<e;++r){for(o=r,i=r+1;i<e;++i)Math.abs(t[r][i])>Math.abs(t[r][o])&&(o=i);for(a=r;a<e+1;++a)s=t[a][r],t[a][r]=t[a][o],t[a][o]=s;for(i=r+1;i<e;++i)for(a=e;a>=r;a--)t[a][i]-=t[a][r]*t[r][i]/t[r][r]}for(i=e-1;i>=0;--i){for(s=0,a=i+1;a<e;++a)s+=t[a][i]*n[a];n[i]=(t[e][i]-s)/t[i][i]}return n}(l),v=t=>{t-=o;let e=s+y[0]+y[1]*t+y[2]*t*t;for(d=3;d<h;++d)e+=y[d]*Math.pow(t,d);return e};return{coef:Qz(h,y,-o,s),predict:v,rSquared:Gz(t,e,n,s,v)}}function Qz(t,e,n,r){const i=Array(t);let a,o,s,c;for(a=0;a<t;++a)i[a]=0;for(a=t-1;a>=0;--a)for(s=e[a],c=1,i[a]+=s,o=1;o<=a;++o)c*=(a+1-o)/o,i[a-o]+=s*Math.pow(n,o)*c;return i[0]+=r,i}const Jz=2,tB=1e-12;function eB(t,e,n,r){const[i,a,o,s]=Vz(t,e,n,!0),c=i.length,u=Math.max(2,~~(r*c)),l=new Float64Array(c),h=new Float64Array(c),d=new Float64Array(c).fill(1);for(let f=-1;++f<=Jz;){const t=[0,u-1];for(let n=0;n<c;++n){const e=i[n],r=t[0],o=t[1],s=e-i[r]>i[o]-e?r:o;let c=0,u=0,f=0,p=0,g=0;const m=1/Math.abs(i[s]-e||1);for(let t=r;t<=o;++t){const n=i[t],r=a[t],o=nB(Math.abs(e-n)*m)*d[t],s=n*o;c+=o,u+=s,f+=r*o,p+=r*s,g+=n*s}const[y,v]=Wz(u/c,f/c,p/c,g/c);l[n]=y+v*e,h[n]=Math.abs(a[n]-l[n]),rB(i,n+1,t)}if(f===Jz)break;const e=Ru(h);if(Math.abs(e)<tB)break;for(let n,r,i=0;i<c;++i)n=h[i]/(6*e),d[i]=n>=1?tB:(r=1-n*n)*r}return function(t,e,n,r){const i=t.length,a=[];let o,s=0,c=0,u=[];for(;s<i;++s)o=t[s]+n,u[0]===o?u[1]+=(e[s]-u[1])/++c:(c=0,u[1]+=r,u=[o,e[s]],a.push(u));return u[1]+=r,a}(i,l,o,s)}function nB(t){return(t=1-t*t*t)*t*t}function rB(t,e,n){const r=t[e];let i=n[0],a=n[1]+1;if(!(a>=t.length))for(;e>i&&t[a]-r<=r-t[i];)n[0]=++i,n[1]=a,++a}const iB=.5*Math.PI/180;function aB(t,e,n,r){n=n||25,r=Math.max(n,r||200);const i=e=>[e,t(e)],a=e[0],o=e[1],s=o-a,c=s/r,u=[i(a)],l=[];if(n===r){for(let t=1;t<r;++t)u.push(i(a+t/n*s));return u.push(i(o)),u}l.push(i(o));for(let g=n;--g>0;)l.push(i(a+g/n*s));let h=u[0],d=l[l.length-1];const f=1/s,p=function(t,e){let n=t,r=t;const i=e.length;for(let a=0;a<i;++a){const t=e[a][1];t<n&&(n=t),t>r&&(r=t)}return 1/(r-n)}(h[1],l);for(;d;){const t=i((h[0]+d[0])/2);t[0]-h[0]>=c&&oB(h,t,d,f,p)>iB?l.push(t):(h=d,u.push(d),l.pop()),d=l[l.length-1]}return u}function oB(t,e,n,r,i){const a=Math.atan2(i*(n[1]-t[1]),r*(n[0]-t[0])),o=Math.atan2(i*(e[1]-t[1]),r*(e[0]-t[0]));return Math.abs(a-o)}function sB(t,e,n){return t.fields=e||[],t.fname=n,t}function cB(t){return 1===t.length?uB(t[0]):lB(t)}const uB=t=>function(e){return e[t]},lB=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function hB(t){throw Error(t)}function dB(t){const e=[],n=t.length;let r,i,a,o=null,s=0,c="";function u(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)c+=t.substring(r,i++),r=i;else if(a===o)u(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&u(),s=r=i+1):"]"===a&&(s||hB("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&hB("Access path missing closing bracket: "+t),o&&hB("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function fB(t,e,n){const r=dB(t);return t=1===r.length?r[0]:t,sB((n&&n.get||cB)(r),[t],e||t)}fB("id"),sB((t=>t),[],"identity");const pB=sB((()=>0),[],"zero"),gB=sB((()=>1),[],"one");sB((()=>!0),[],"true"),sB((()=>!1),[],"false");var mB=Array.isArray;function yB(t){return t[t.length-1]}function vB(t){return null!=t?mB(t)?t:[t]:[]}function bB(t){return"function"===typeof t}function xB(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const wB=Object.prototype.hasOwnProperty;function kB(t,e){return wB.call(t,e)}var _B=new Date,SB=new Date;function AB(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,a){var o,s=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r)||!(a>0))return s;do{s.push(o=new Date(+n)),e(n,a),t(n)}while(o<n&&n<r);return s},i.filter=function(n){return AB((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return _B.setTime(+e),SB.setTime(+r),t(_B),t(SB),Math.floor(n(_B,SB))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t===0}:function(e){return i.count(0,e)%t===0}):i:null}),i}const CB=1e3,EB=6e4,TB=36e5,NB=864e5,DB=6048e5;var FB=AB((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*EB)/NB),(t=>t.getDate()-1));const IB=FB;FB.range;function MB(t){return AB((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*EB)/DB}))}var OB=MB(0),RB=MB(1),zB=MB(2),BB=MB(3),LB=MB(4),PB=MB(5),jB=MB(6),UB=(OB.range,RB.range,zB.range,BB.range,LB.range,PB.range,jB.range,AB((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/NB}),(function(t){return t.getUTCDate()-1})));const WB=UB;UB.range;function VB(t){return AB((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/DB}))}var qB=VB(0),GB=VB(1),HB=VB(2),YB=VB(3),XB=VB(4),KB=VB(5),$B=VB(6),ZB=(qB.range,GB.range,HB.range,YB.range,XB.range,KB.range,$B.range,AB((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()})));ZB.every=function(t){return isFinite(t=Math.floor(t))&&t>0?AB((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};const QB=ZB;ZB.range;var JB=AB((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()}));const tL=JB;JB.range;var eL=AB((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*CB-t.getMinutes()*EB)}),(function(t,e){t.setTime(+t+e*TB)}),(function(t,e){return(e-t)/TB}),(function(t){return t.getHours()}));const nL=eL;eL.range;var rL=AB((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*CB)}),(function(t,e){t.setTime(+t+e*EB)}),(function(t,e){return(e-t)/EB}),(function(t){return t.getMinutes()}));const iL=rL;rL.range;var aL=AB((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+e*CB)}),(function(t,e){return(e-t)/CB}),(function(t){return t.getUTCSeconds()}));const oL=aL;aL.range;var sL=AB((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t}));sL.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?AB((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):sL:null};const cL=sL;sL.range;var uL=AB((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));uL.every=function(t){return isFinite(t=Math.floor(t))&&t>0?AB((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};const lL=uL;uL.range;var hL=AB((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()}));const dL=hL;hL.range;var fL=AB((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+e*TB)}),(function(t,e){return(e-t)/TB}),(function(t){return t.getUTCHours()}));const pL=fL;fL.range;var gL=AB((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+e*EB)}),(function(t,e){return(e-t)/EB}),(function(t){return t.getUTCMinutes()}));const mL=gL;gL.range;const yL="year",vL="quarter",bL="month",xL="week",wL="date",kL="day",_L="dayofyear",SL="hours",AL="minutes",CL="seconds",EL="milliseconds",TL=[yL,vL,bL,xL,wL,kL,_L,SL,AL,CL,EL],NL=TL.reduce(((t,e,n)=>(t[e]=1+n,t)),{});function DL(t){const e=vB(t).slice(),n={};e.length||hB("Missing time unit."),e.forEach((t=>{kB(NL,t)?n[t]=1:hB("Invalid time unit: ".concat(t,"."))}));return(n[xL]||n[kL]?1:0)+(n[vL]||n[bL]||n[wL]?1:0)+(n[_L]?1:0)>1&&hB("Incompatible time units: ".concat(t)),e.sort(((t,e)=>NL[t]-NL[e])),e}const FL={[yL]:"%Y ",[vL]:"Q%q ",[bL]:"%b ",[wL]:"%d ",[xL]:"W%U ",[kL]:"%a ",[_L]:"%j ",[SL]:"%H:00",[AL]:"00:%M",[CL]:":%S",[EL]:".%L",["".concat(yL,"-").concat(bL)]:"%Y-%m ",["".concat(yL,"-").concat(bL,"-").concat(wL)]:"%Y-%m-%d ",["".concat(SL,"-").concat(AL)]:"%H:%M"};function IL(t,e){const n=xB({},FL,e),r=DL(t),i=r.length;let a,o,s="",c=0;for(c=0;c<i;)for(a=r.length;a>c;--a)if(o=r.slice(c,a).join("-"),null!=n[o]){s+=n[o],c=a;break}return s.trim()}const ML=new Date;function OL(t){return ML.setFullYear(t),ML.setMonth(0),ML.setDate(1),ML.setHours(0,0,0,0),ML}function RL(t){return BL(new Date(t))}function zL(t){return LL(new Date(t))}function BL(t){return IB.count(OL(t.getFullYear())-1,t)}function LL(t){return OB.count(OL(t.getFullYear())-1,t)}function PL(t){return OL(t).getDay()}function jL(t,e,n,r,i,a,o){if(0<=t&&t<100){const s=new Date(-1,e,n,r,i,a,o);return s.setFullYear(t),s}return new Date(t,e,n,r,i,a,o)}function UL(t){return VL(new Date(t))}function WL(t){return qL(new Date(t))}function VL(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return WB.count(e-1,t)}function qL(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return qB.count(e-1,t)}function GL(t){return ML.setTime(Date.UTC(t,0,1)),ML.getUTCDay()}function HL(t,e,n,r,i,a,o){if(0<=t&&t<100){const t=new Date(Date.UTC(-1,e,n,r,i,a,o));return t.setUTCFullYear(n.y),t}return new Date(Date.UTC(t,e,n,r,i,a,o))}function YL(t,e,n,r,i){const a=e||1,o=yB(t),s=(t,e,i)=>function(t,e,n,r){const i=n<=1?t:r?(e,i)=>r+n*Math.floor((t(e,i)-r)/n):(e,r)=>n*Math.floor(t(e,r)/n);return e?(t,n)=>e(i(t,n),n):i}(n[i=i||t],r[i],t===o&&a,e),c=new Date,u=function(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}(t),l=u[yL]?s(yL):function(t){return bB(t)?t:()=>t}(2012),h=u[bL]?s(bL):u[vL]?s(vL):pB,d=u[xL]&&u[kL]?s(kL,1,xL+kL):u[xL]?s(xL,1):u[kL]?s(kL,1):u[wL]?s(wL,1):u[_L]?s(_L,1):gB,f=u[SL]?s(SL):pB,p=u[AL]?s(AL):pB,g=u[CL]?s(CL):pB,m=u[EL]?s(EL):pB;return function(t){c.setTime(+t);const e=l(c);return i(e,h(c),d(c,e),f(c),p(c),g(c),m(c))}}function XL(t,e,n){return e+7*t-(n+6)%7}const KL={[yL]:t=>t.getFullYear(),[vL]:t=>Math.floor(t.getMonth()/3),[bL]:t=>t.getMonth(),[wL]:t=>t.getDate(),[SL]:t=>t.getHours(),[AL]:t=>t.getMinutes(),[CL]:t=>t.getSeconds(),[EL]:t=>t.getMilliseconds(),[_L]:t=>BL(t),[xL]:t=>LL(t),[xL+kL]:(t,e)=>XL(LL(t),t.getDay(),PL(e)),[kL]:(t,e)=>XL(1,t.getDay(),PL(e))},$L={[vL]:t=>3*t,[xL]:(t,e)=>XL(t,0,PL(e))};function ZL(t,e){return YL(t,e||1,KL,$L,jL)}const QL={[yL]:t=>t.getUTCFullYear(),[vL]:t=>Math.floor(t.getUTCMonth()/3),[bL]:t=>t.getUTCMonth(),[wL]:t=>t.getUTCDate(),[SL]:t=>t.getUTCHours(),[AL]:t=>t.getUTCMinutes(),[CL]:t=>t.getUTCSeconds(),[EL]:t=>t.getUTCMilliseconds(),[_L]:t=>VL(t),[xL]:t=>qL(t),[kL]:(t,e)=>XL(1,t.getUTCDay(),GL(e)),[xL+kL]:(t,e)=>XL(qL(t),t.getUTCDay(),GL(e))},JL={[vL]:t=>3*t,[xL]:(t,e)=>XL(t,0,GL(e))};function tP(t,e){return YL(t,e||1,QL,JL,HL)}const eP={[yL]:QB,[vL]:tL.every(3),[bL]:tL,[xL]:OB,[wL]:IB,[kL]:IB,[_L]:IB,[SL]:nL,[AL]:iL,[CL]:oL,[EL]:cL},nP={[yL]:lL,[vL]:dL.every(3),[bL]:dL,[xL]:qB,[wL]:WB,[kL]:WB,[_L]:WB,[SL]:pL,[AL]:mL,[CL]:oL,[EL]:cL};function rP(t){return eP[t]}function iP(t){return nP[t]}function aP(t,e,n){return t?t.offset(e,n):void 0}function oP(t,e,n){return aP(rP(t),e,n)}function sP(t,e,n){return aP(iP(t),e,n)}function cP(t,e,n,r){return t?t.range(e,n,r):void 0}function uP(t,e,n,r){return cP(rP(t),e,n,r)}function lP(t,e,n,r){return cP(iP(t),e,n,r)}const hP=1e3,dP=6e4,fP=36e5,pP=864e5,gP=2592e6,mP=31536e6,yP=[yL,bL,wL,SL,AL,CL,EL],vP=yP.slice(0,-1),bP=vP.slice(0,-1),xP=bP.slice(0,-1),wP=xP.slice(0,-1),kP=[yL,bL],_P=[yL],SP=[[vP,1,hP],[vP,5,5e3],[vP,15,15e3],[vP,30,3e4],[bP,1,dP],[bP,5,3e5],[bP,15,9e5],[bP,30,18e5],[xP,1,fP],[xP,3,108e5],[xP,6,216e5],[xP,12,432e5],[wP,1,pP],[[yL,xL],1,6048e5],[kP,1,gP],[kP,3,7776e6],[_P,1,mP]];function AP(t){const e=t.extent,n=t.maxbins||40,r=Math.abs(function(t){return t&&yB(t)-t[0]||0}(e))/n;let i,a,o=Bu((t=>t[2])).right(SP,r);return o===SP.length?(i=_P,a=HC(e[0]/mP,e[1]/mP,n)):o?(o=SP[r/SP[o-1][2]<SP[o][2]/r?o-1:o],i=o[0],a=o[1]):(i=yP,a=Math.max(HC(e[0],e[1],n),1)),{units:i,step:a}}function CP(t,e,n){return t.fields=e||[],t.fname=n,t}function EP(t){return 1===t.length?TP(t[0]):NP(t)}const TP=t=>function(e){return e[t]},NP=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function DP(t){throw Error(t)}function FP(t){const e=[],n=t.length;let r,i,a,o=null,s=0,c="";function u(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)c+=t.substring(r,i++),r=i;else if(a===o)u(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&u(),s=r=i+1):"]"===a&&(s||DP("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&DP("Access path missing closing bracket: "+t),o&&DP("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function IP(t,e,n){const r=FP(t);return t=1===r.length?r[0]:t,CP((n&&n.get||EP)(r),[t],e||t)}IP("id");const MP=CP((t=>t),[],"identity");CP((()=>0),[],"zero"),CP((()=>1),[],"one"),CP((()=>!0),[],"true"),CP((()=>!1),[],"false");var OP=Array.isArray;function RP(t){return t===Object(t)}function zP(t){return null==t||""===t?null:+t}function BP(t){return"function"===typeof t}function LP(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const PP=Object.prototype.hasOwnProperty;function jP(t,e){return PP.call(t,e)}function UP(t){return"string"===typeof t}function WP(t){return OP(t)?"["+t.map(WP)+"]":RP(t)||UP(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}const VP=t=>function(t){return"number"===typeof t}(t)||function(t){return"[object Date]"===Object.prototype.toString.call(t)}(t)?t:Date.parse(t);var qP={},GP={},HP=34,YP=10,XP=13;function KP(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function $P(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function ZP(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function QP(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":function(t){return t<0?"-"+ZP(-t,6):t>9999?"+"+ZP(t,6):ZP(t,4)}(t.getUTCFullYear())+"-"+ZP(t.getUTCMonth()+1,2)+"-"+ZP(t.getUTCDate(),2)+(i?"T"+ZP(e,2)+":"+ZP(n,2)+":"+ZP(r,2)+"."+ZP(i,3)+"Z":r?"T"+ZP(e,2)+":"+ZP(n,2)+":"+ZP(r,2)+"Z":n||e?"T"+ZP(e,2)+":"+ZP(n,2)+"Z":"")}function JP(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],a=t.length,o=0,s=0,c=a<=0,u=!1;function l(){if(c)return GP;if(u)return u=!1,qP;var e,r,i=o;if(t.charCodeAt(i)===HP){for(;o++<a&&t.charCodeAt(o)!==HP||t.charCodeAt(++o)===HP;);return(e=o)>=a?c=!0:(r=t.charCodeAt(o++))===YP?u=!0:r===XP&&(u=!0,t.charCodeAt(o)===YP&&++o),t.slice(i+1,e-1).replace(/""/g,'"')}for(;o<a;){if((r=t.charCodeAt(e=o++))===YP)u=!0;else if(r===XP)u=!0,t.charCodeAt(o)===YP&&++o;else if(r!==n)continue;return t.slice(i,e)}return c=!0,t.slice(i,a)}for(t.charCodeAt(a-1)===YP&&--a,t.charCodeAt(a-1)===XP&&--a;(r=l())!==GP;){for(var h=[];r!==qP&&r!==GP;)h.push(r),r=l();e&&null==(h=e(h,s++))||i.push(h)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return o(e[t])})).join(t)}))}function a(e){return e.map(o).join(t)}function o(t){return null==t?"":t instanceof Date?QP(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,a=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=KP(t);return function(r,i){return e(n(r),i,t)}}(t,e):KP(t)}));return a.columns=i||[],a},parseRows:r,format:function(e,n){return null==n&&(n=$P(e)),[n.map(o).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=$P(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(a).join("\n")},formatRow:a,formatValue:o}}const tj=Math.sqrt(50),ej=Math.sqrt(10),nj=Math.sqrt(2);function rj(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=tj?10:a>=ej?5:a>=nj?2:1;let s,c,u;return i<0?(u=Math.pow(10,-i)/o,s=Math.round(t*u),c=Math.round(e*u),s/u<t&&++s,c/u>e&&--c,u=-u):(u=Math.pow(10,i)*o,s=Math.round(t/u),c=Math.round(e/u),s*u<t&&++s,c*u>e&&--c),c<s&&.5<=n&&n<2?rj(t,e,2*n):[s,c,u]}function ij(t,e,n){return rj(t=+t,e=+e,n=+n)[2]}const aj="year",oj="quarter",sj="month",cj="week",uj="date",lj="day",hj="dayofyear",dj="hours",fj="minutes",pj="seconds",gj="milliseconds";[aj,oj,sj,cj,uj,lj,hj,dj,fj,pj,gj].reduce(((t,e,n)=>(t[e]=1+n,t)),{});"".concat(aj,"-").concat(sj),"".concat(aj,"-").concat(sj,"-").concat(uj),"".concat(dj,"-").concat(fj);new Date;const mj={[aj]:mi,[oj]:vi.every(3),[sj]:vi,[cj]:ei,[uj]:Zr,[lj]:Zr,[hj]:Zr,[dj]:xi,[fj]:ki,[pj]:Si,[gj]:Ai},yj={[aj]:yi,[oj]:bi.every(3),[sj]:bi,[cj]:ui,[uj]:Qr,[lj]:Qr,[hj]:Qr,[dj]:wi,[fj]:_i,[pj]:Si,[gj]:Ai};function vj(t){return mj[t]}function bj(t){return yj[t]}const xj=[aj,sj,uj,dj,fj,pj,gj],wj=xj.slice(0,-1),kj=wj.slice(0,-1),_j=kj.slice(0,-1);_j.slice(0,-1);function Sj(t){const e={};return n=>e[n]||(e[n]=t(n))}function Aj(t){const e=Sj(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(t){const n=Ar(t||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(t,e){return n=>{const r=t(n),i=r.indexOf(e);if(i<0)return r;let a=function(t,e){let n,r=t.lastIndexOf("e");if(r>0)return r;for(r=t.length;--r>e;)if(n=t.charCodeAt(r),n>=48&&n<=57)return r+1}(r,i);const o=a<r.length?r.slice(a):"";for(;--a>i;)if("0"!==r[a]){++a;break}return r.slice(0,a)+o}}(e(n),e(".1f")(1)[1])}return e(n)},formatSpan(t,r,i,a){a=Ar(null==a?",f":a);const o=function(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?ij(e,t,n):ij(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}(t,r,i),s=Math.max(Math.abs(t),Math.abs(r));let c;if(null==a.precision)switch(a.type){case"s":return isNaN(c=Nr(o,s))||(a.precision=c),n(a,s);case"":case"e":case"g":case"p":case"r":isNaN(c=Dr(o,s))||(a.precision=c-("e"===a.type));break;case"f":case"%":isNaN(c=Fr(o))||(a.precision=c-2*("%"===a.type))}return e(a)}}}let Cj,Ej;function Tj(){return Cj=Aj({format:zr,formatPrefix:Br})}function Nj(t,e,n){RP(n=n||{})||DP("Invalid time multi-format specifier: ".concat(n));const r=e(pj),i=e(fj),a=e(dj),o=e(uj),s=e(cj),c=e(sj),u=e(oj),l=e(aj),h=t(n[gj]||".%L"),d=t(n[pj]||":%S"),f=t(n[fj]||"%I:%M"),p=t(n[dj]||"%I %p"),g=t(n[uj]||n[lj]||"%a %d"),m=t(n[cj]||"%b %d"),y=t(n[sj]||"%B"),v=t(n[oj]||"%B"),b=t(n[aj]||"%Y");return t=>(r(t)<t?h:i(t)<t?d:a(t)<t?f:o(t)<t?p:c(t)<t?s(t)<t?g:m:l(t)<t?u(t)<t?y:v:b)(t)}function Dj(t){const e=Sj(t.format),n=Sj(t.utcFormat);return{timeFormat:t=>UP(t)?e(t):Nj(e,vj,t),utcFormat:t=>UP(t)?n(t):Nj(n,bj,t),timeParse:Sj(t.parse),utcParse:Sj(t.utcParse)}}function Fj(){return Ej=Dj({format:ja,parse:Ua,utcFormat:Wa,utcParse:Va})}function Ij(t){return Dj(La(t))}function Mj(t){return arguments.length?Ej=Ij(t):Ej}Tj(),Fj();const Oj=/^(data:|([A-Za-z]+:)?\/\/)/,Rj=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,zj=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Bj="file://";async function Lj(t,e){const n=await this.sanitize(t,e),r=n.href;return n.localFile?this.file(r):this.http(r,e)}async function Pj(t,e){e=LP({},this.options,e);const n=this.fileAccess,r={href:null};let i,a,o;const s=Rj.test(t.replace(zj,""));null!=t&&"string"===typeof t&&s||DP("Sanitize failure, invalid URI: "+WP(t));const c=Oj.test(t);return(o=e.baseURL)&&!c&&(t.startsWith("/")||o.endsWith("/")||(t="/"+t),t=o+t),a=(i=t.startsWith(Bj))||"file"===e.mode||"http"!==e.mode&&!c&&n,i?t=t.slice(Bj.length):t.startsWith("//")&&("file"===e.defaultProtocol?(t=t.slice(2),a=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(r,"localFile",{value:!!a}),r.href=t,e.target&&(r.target=e.target+""),e.rel&&(r.rel=e.rel+""),"image"===e.context&&e.crossOrigin&&(r.crossOrigin=e.crossOrigin+""),r}function jj(t){return t?e=>new Promise(((n,r)=>{t.readFile(e,((t,e)=>{t?r(t):n(e)}))})):Uj}async function Uj(){DP("No file system access.")}function Wj(t){return t?async function(e,n){const r=LP({},this.options.http,n),i=n&&n.response,a=await t(e,r);return a.ok?BP(a[i])?a[i]():a.text():DP(a.status+""+a.statusText)}:Vj}async function Vj(){DP("No HTTP fetch method available.")}const qj=t=>null!=t&&t===t,Gj=t=>!Number.isNaN(+t)&&!(t instanceof Date),Hj={boolean:function(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t},integer:zP,number:zP,date:function(t,e){return e=e||VP,null==t||""===t?null:e(t)},string:function(t){return null==t||""===t?null:t+""},unknown:MP},Yj=[t=>"true"===t||"false"===t||!0===t||!1===t,t=>Gj(t)&&Number.isInteger(+t),Gj,t=>!Number.isNaN(Date.parse(t))],Xj=["boolean","integer","number","date"];function Kj(t,e){if(!t||!t.length)return"unknown";const n=t.length,r=Yj.length,i=Yj.map(((t,e)=>e+1));for(let a,o,s=0,c=0;s<n;++s)for(o=e?t[s][e]:t[s],a=0;a<r;++a)if(i[a]&&qj(o)&&!Yj[a](o)&&(i[a]=0,++c,c===Yj.length))return"string";return Xj[i.reduce(((t,e)=>0===t?e:t),0)-1]}function $j(t,e){return e.reduce(((e,n)=>(e[n]=Kj(t,n),e)),{})}function Zj(t){const e=function(e,n){const r={delimiter:t};return Qj(e,n?LP(n,r):r)};return e.responseType="text",e}function Qj(t,e){return e.header&&(t=e.header.map(WP).join(e.delimiter)+"\n"+t),JP(e.delimiter).parse(t+"")}function Jj(t,e){const n=e&&e.property?IP(e.property):MP;return!RP(t)||(r=t,"function"===typeof Buffer&&BP(Buffer.isBuffer)&&Buffer.isBuffer(r))?n(JSON.parse(t)):function(t,e){!OP(t)&&function(t){return t&&BP(t[Symbol.iterator])}(t)&&(t=[...t]);return e&&e.copy?JSON.parse(JSON.stringify(t)):t}(n(t),e);var r}Qj.responseType="text",Jj.responseType="json";const tU={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function eU(t,e){let n,r,i,a;return t=Jj(t,e),e&&e.feature?(n=dr,i=e.feature):e&&e.mesh?(n=mr,i=e.mesh,a=tU[e.filter]):DP("Missing TopoJSON feature or mesh parameter."),r=(r=t.objects[i])?n(t,r,a):DP("Invalid TopoJSON object: "+i),r&&r.features||[r]}eU.responseType="json";const nU={dsv:Qj,csv:Zj(","),tsv:Zj("\t"),json:Jj,topojson:eU};function rU(t,e){return arguments.length>1?(nU[t]=e,this):jP(nU,t)?nU[t]:null}function iU(t){const e=rU(t);return e&&e.responseType||"text"}function aU(t,e,n,r){const i=rU((e=e||{}).type||"json");return i||DP("Unknown data format type: "+e.type),t=i(t,e),e.parse&&function(t,e,n,r){if(!t.length)return;const i=Mj();n=n||i.timeParse,r=r||i.utcParse;let a,o,s,c,u,l,h=t.columns||Object.keys(t[0]);"auto"===e&&(e=$j(t,h));h=Object.keys(e);const d=h.map((t=>{const i=e[t];let a,o;if(i&&(i.startsWith("date:")||i.startsWith("utc:"))){a=i.split(/:(.+)?/,2),o=a[1],("'"===o[0]&&"'"===o[o.length-1]||'"'===o[0]&&'"'===o[o.length-1])&&(o=o.slice(1,-1));return("utc"===a[0]?r:n)(o)}if(!Hj[i])throw Error("Illegal format pattern: "+t+":"+i);return Hj[i]}));for(s=0,u=t.length,l=h.length;s<u;++s)for(a=t[s],c=0;c<l;++c)o=h[c],a[o]=d[c](a[o])}(t,e.parse,n,r),jP(t,"columns")&&delete t.columns,t}const oU=function(t,e){return n=>({options:n||{},sanitize:Pj,load:Lj,fileAccess:!!e,file:jj(e),http:Wj(t)})}("undefined"!==typeof fetch&&fetch,null);function sU(t,e,n){return t.fields=e||[],t.fname=n,t}function cU(t){return 1===t.length?uU(t[0]):lU(t)}const uU=t=>function(e){return e[t]},lU=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function hU(t){throw Error(t)}function dU(t){const e=[],n=t.length;let r,i,a,o=null,s=0,c="";function u(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)c+=t.substring(r,i++),r=i;else if(a===o)u(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&u(),s=r=i+1):"]"===a&&(s||hU("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&hU("Access path missing closing bracket: "+t),o&&hU("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function fU(t,e,n){const r=dU(t);return t=1===r.length?r[0]:t,sU((n&&n.get||cU)(r),[t],e||t)}fU("id");const pU=sU((t=>t),[],"identity"),gU=(sU((()=>0),[],"zero"),sU((()=>1),[],"one"),sU((()=>!0),[],"true"));sU((()=>!1),[],"false");var mU=Array.isArray;function yU(t){return t===Object(t)}function vU(t){return t[t.length-1]}function bU(t){return null==t||""===t?null:+t}function xU(t){return null!=t?mU(t)?t:[t]:[]}function wU(t){return"function"===typeof t}function kU(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const _U=Object.prototype.hasOwnProperty;function SU(t,e){return _U.call(t,e)}function AU(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),kU(r,n)}function CU(t){return"number"===typeof t}function EU(t){return"string"===typeof t}function TU(t){return mU(t)?"["+t.map(TU)+"]":yU(t)||EU(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function NU(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function DU(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function FU(t){this._context=t}function IU(){}function MU(t){this._context=t}function OU(t){this._context=t}function RU(t,e){this._basis=new FU(t),this._beta=e}FU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:DU(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:DU(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},MU.prototype={areaStart:IU,areaEnd:IU,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:DU(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},OU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:DU(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},RU.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],a=e[0],o=t[n]-i,s=e[n]-a,c=-1;++c<=n;)r=c/n,this._basis.point(this._beta*t[c]+(1-this._beta)*(i+r*o),this._beta*e[c]+(1-this._beta)*(a+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};const zU=function t(e){function n(t){return 1===e?new FU(t):new RU(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function BU(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function LU(t,e){this._context=t,this._k=(1-e)/6}LU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:BU(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:BU(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const PU=function t(e){function n(t){return new LU(t,e)}return n.tension=function(e){return t(+e)},n}(0);function jU(t,e){this._context=t,this._k=(1-e)/6}jU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:BU(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const UU=function t(e){function n(t){return new jU(t,e)}return n.tension=function(e){return t(+e)},n}(0);function WU(t,e){this._context=t,this._k=(1-e)/6}WU.prototype={areaStart:IU,areaEnd:IU,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:BU(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const VU=function t(e){function n(t){return new WU(t,e)}return n.tension=function(e){return t(+e)},n}(0);var qU=Math.abs,GU=Math.atan2,HU=Math.cos,YU=Math.max,XU=Math.min,KU=Math.sin,$U=Math.sqrt,ZU=1e-12,QU=Math.PI,JU=QU/2,tW=2*QU;function eW(t){return t>=1?JU:t<=-1?-JU:Math.asin(t)}function nW(t,e,n){var r=t._x1,i=t._y1,a=t._x2,o=t._y2;if(t._l01_a>ZU){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>ZU){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,l=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*u+t._x1*t._l23_2a-e*t._l12_2a)/l,o=(o*u+t._y1*t._l23_2a-n*t._l12_2a)/l}t._context.bezierCurveTo(r,i,a,o,t._x2,t._y2)}function rW(t,e){this._context=t,this._alpha=e}rW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:nW(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const iW=function t(e){function n(t){return e?new rW(t,e):new LU(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function aW(t,e){this._context=t,this._alpha=e}aW.prototype={areaStart:IU,areaEnd:IU,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:nW(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const oW=function t(e){function n(t){return e?new aW(t,e):new WU(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function sW(t,e){this._context=t,this._alpha=e}sW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:nW(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const cW=function t(e){function n(t){return e?new sW(t,e):new jU(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function uW(t){this._context=t}function lW(t){return new uW(t)}function hW(t){this._context=t}function dW(t){return t<0?-1:1}function fW(t,e,n){var r=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(r||i<0&&-0),o=(n-t._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(dW(a)+dW(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function pW(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function gW(t,e,n){var r=t._x0,i=t._y0,a=t._x1,o=t._y1,s=(a-r)/3;t._context.bezierCurveTo(r+s,i+s*e,a-s,o-s*n,a,o)}function mW(t){this._context=t}function yW(t){this._context=new vW(t)}function vW(t){this._context=t}function bW(t){this._context=t}function xW(t){var e,n,r=t.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(i[r-1]=o[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(o[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function wW(t,e){this._context=t,this._t=e}uW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}},hW.prototype={areaStart:IU,areaEnd:IU,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},mW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:gW(this,this._t0,pW(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,gW(this,pW(this,n=fW(this,t,e)),n);break;default:gW(this,this._t0,n=fW(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(yW.prototype=Object.create(mW.prototype)).point=function(t,e){mW.prototype.point.call(this,e,t)},vW.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,a){this._context.bezierCurveTo(e,t,r,n,a,i)}},bW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=xW(t),i=xW(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},wW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};const kW=Math.PI,_W=2*kW,SW=1e-6,AW=_W-SW;function CW(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function EW(){return new CW}CW.prototype=EW.prototype={constructor:CW,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-t,c=r-e,u=a-t,l=o-e,h=u*u+l*l;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>SW)if(Math.abs(l*s-c*u)>SW&&i){var d=n-a,f=r-o,p=s*s+c*c,g=d*d+f*f,m=Math.sqrt(p),y=Math.sqrt(h),v=i*Math.tan((kW-Math.acos((p+h-g)/(2*m*y)))/2),b=v/y,x=v/m;Math.abs(b-1)>SW&&(this._+="L"+(t+b*u)+","+(e+b*l)),this._+="A"+i+","+i+",0,0,"+ +(l*d>u*f)+","+(this._x1=t+x*s)+","+(this._y1=e+x*c)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,a){t=+t,e=+e,a=!!a;var o=(n=+n)*Math.cos(r),s=n*Math.sin(r),c=t+o,u=e+s,l=1^a,h=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+c+","+u:(Math.abs(this._x1-c)>SW||Math.abs(this._y1-u)>SW)&&(this._+="L"+c+","+u),n&&(h<0&&(h=h%_W+_W),h>AW?this._+="A"+n+","+n+",0,1,"+l+","+(t-o)+","+(e-s)+"A"+n+","+n+",0,1,"+l+","+(this._x1=c)+","+(this._y1=u):h>SW&&(this._+="A"+n+","+n+",0,"+ +(h>=kW)+","+l+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};const TW=EW;function NW(t){return function(){return t}}function DW(t){return t.innerRadius}function FW(t){return t.outerRadius}function IW(t){return t.startAngle}function MW(t){return t.endAngle}function OW(t){return t&&t.padAngle}function RW(t,e,n,r,i,a,o){var s=t-n,c=e-r,u=(o?a:-a)/$U(s*s+c*c),l=u*c,h=-u*s,d=t+l,f=e+h,p=n+l,g=r+h,m=(d+p)/2,y=(f+g)/2,v=p-d,b=g-f,x=v*v+b*b,w=i-a,k=d*g-p*f,_=(b<0?-1:1)*$U(YU(0,w*w*x-k*k)),S=(k*b-v*_)/x,A=(-k*v-b*_)/x,C=(k*b+v*_)/x,E=(-k*v+b*_)/x,T=S-m,N=A-y,D=C-m,F=E-y;return T*T+N*N>D*D+F*F&&(S=C,A=E),{cx:S,cy:A,x01:-l,y01:-h,x11:S*(i/w-1),y11:A*(i/w-1)}}Array.prototype.slice;function zW(t){return"object"===typeof t&&"length"in t?t:Array.from(t)}function BW(t){return t[0]}function LW(t){return t[1]}function PW(t,e){var n=NW(!0),r=null,i=lW,a=null;function o(o){var s,c,u,l=(o=zW(o)).length,h=!1;for(null==r&&(a=i(u=TW())),s=0;s<=l;++s)!(s<l&&n(c=o[s],s,o))===h&&((h=!h)?a.lineStart():a.lineEnd()),h&&a.point(+t(c,s,o),+e(c,s,o));if(u)return a=null,u+""||null}return t="function"===typeof t?t:void 0===t?BW:NW(t),e="function"===typeof e?e:void 0===e?LW:NW(e),o.x=function(e){return arguments.length?(t="function"===typeof e?e:NW(+e),o):t},o.y=function(t){return arguments.length?(e="function"===typeof t?t:NW(+t),o):e},o.defined=function(t){return arguments.length?(n="function"===typeof t?t:NW(!!t),o):n},o.curve=function(t){return arguments.length?(i=t,null!=r&&(a=i(r)),o):i},o.context=function(t){return arguments.length?(null==t?r=a=null:a=i(r=t),o):r},o}function jW(t,e,n){var r=null,i=NW(!0),a=null,o=lW,s=null;function c(c){var u,l,h,d,f,p=(c=zW(c)).length,g=!1,m=new Array(p),y=new Array(p);for(null==a&&(s=o(f=TW())),u=0;u<=p;++u){if(!(u<p&&i(d=c[u],u,c))===g)if(g=!g)l=u,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=u-1;h>=l;--h)s.point(m[h],y[h]);s.lineEnd(),s.areaEnd()}g&&(m[u]=+t(d,u,c),y[u]=+e(d,u,c),s.point(r?+r(d,u,c):m[u],n?+n(d,u,c):y[u]))}if(f)return s=null,f+""||null}function u(){return PW().defined(i).curve(o).context(a)}return t="function"===typeof t?t:void 0===t?BW:NW(+t),e="function"===typeof e?e:NW(void 0===e?0:+e),n="function"===typeof n?n:void 0===n?LW:NW(+n),c.x=function(e){return arguments.length?(t="function"===typeof e?e:NW(+e),r=null,c):t},c.x0=function(e){return arguments.length?(t="function"===typeof e?e:NW(+e),c):t},c.x1=function(t){return arguments.length?(r=null==t?null:"function"===typeof t?t:NW(+t),c):r},c.y=function(t){return arguments.length?(e="function"===typeof t?t:NW(+t),n=null,c):e},c.y0=function(t){return arguments.length?(e="function"===typeof t?t:NW(+t),c):e},c.y1=function(t){return arguments.length?(n=null==t?null:"function"===typeof t?t:NW(+t),c):n},c.lineX0=c.lineY0=function(){return u().x(t).y(e)},c.lineY1=function(){return u().x(t).y(n)},c.lineX1=function(){return u().x(r).y(e)},c.defined=function(t){return arguments.length?(i="function"===typeof t?t:NW(!!t),c):i},c.curve=function(t){return arguments.length?(o=t,null!=a&&(s=o(a)),c):o},c.context=function(t){return arguments.length?(null==t?a=s=null:s=o(a=t),c):a},c}const UW={draw:function(t,e){var n=Math.sqrt(e/QU);t.moveTo(n,0),t.arc(0,0,n,0,tW)}};Math.sqrt(1/3);var WW=Math.sin(QU/10)/Math.sin(7*QU/10);Math.sin(tW/10),Math.cos(tW/10);Math.sqrt(3);Math.sqrt(3),Math.sqrt(12);const VW=Math.sqrt(50),qW=Math.sqrt(10),GW=Math.sqrt(2);function HW(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=VW?10:a>=qW?5:a>=GW?2:1;let s,c,u;return i<0?(u=Math.pow(10,-i)/o,s=Math.round(t*u),c=Math.round(e*u),s/u<t&&++s,c/u>e&&--c,u=-u):(u=Math.pow(10,i)*o,s=Math.round(t/u),c=Math.round(e/u),s*u<t&&++s,c*u>e&&--c),c<s&&.5<=n&&n<2?HW(t,e,2*n):[s,c,u]}function YW(t,e,n){return HW(t=+t,e=+e,n=+n)[2]}const XW="year",KW="quarter",$W="month",ZW="week",QW="date",JW="day",tV="dayofyear",eV="hours",nV="minutes",rV="seconds",iV="milliseconds";[XW,KW,$W,ZW,QW,JW,tV,eV,nV,rV,iV].reduce(((t,e,n)=>(t[e]=1+n,t)),{});"".concat(XW,"-").concat($W),"".concat(XW,"-").concat($W,"-").concat(QW),"".concat(eV,"-").concat(nV);new Date;const aV={[XW]:mi,[KW]:vi.every(3),[$W]:vi,[ZW]:ei,[QW]:Zr,[JW]:Zr,[tV]:Zr,[eV]:xi,[nV]:ki,[rV]:Si,[iV]:Ai},oV={[XW]:yi,[KW]:bi.every(3),[$W]:bi,[ZW]:ui,[QW]:Qr,[JW]:Qr,[tV]:Qr,[eV]:wi,[nV]:_i,[rV]:Si,[iV]:Ai};function sV(t){return aV[t]}function cV(t){return oV[t]}const uV=[XW,$W,QW,eV,nV,rV,iV],lV=uV.slice(0,-1),hV=lV.slice(0,-1),dV=hV.slice(0,-1);dV.slice(0,-1);function fV(t){const e={};return n=>e[n]||(e[n]=t(n))}function pV(t){const e=fV(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(t){const n=Ar(t||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(t,e){return n=>{const r=t(n),i=r.indexOf(e);if(i<0)return r;let a=function(t,e){let n,r=t.lastIndexOf("e");if(r>0)return r;for(r=t.length;--r>e;)if(n=t.charCodeAt(r),n>=48&&n<=57)return r+1}(r,i);const o=a<r.length?r.slice(a):"";for(;--a>i;)if("0"!==r[a]){++a;break}return r.slice(0,a)+o}}(e(n),e(".1f")(1)[1])}return e(n)},formatSpan(t,r,i,a){a=Ar(null==a?",f":a);const o=function(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?YW(e,t,n):YW(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}(t,r,i),s=Math.max(Math.abs(t),Math.abs(r));let c;if(null==a.precision)switch(a.type){case"s":return isNaN(c=Nr(o,s))||(a.precision=c),n(a,s);case"":case"e":case"g":case"p":case"r":isNaN(c=Dr(o,s))||(a.precision=c-("e"===a.type));break;case"f":case"%":isNaN(c=Fr(o))||(a.precision=c-2*("%"===a.type))}return e(a)}}}let gV,mV;function yV(){return gV=pV({format:zr,formatPrefix:Br})}function vV(t,e,n){yU(n=n||{})||hU("Invalid time multi-format specifier: ".concat(n));const r=e(rV),i=e(nV),a=e(eV),o=e(QW),s=e(ZW),c=e($W),u=e(KW),l=e(XW),h=t(n[iV]||".%L"),d=t(n[rV]||":%S"),f=t(n[nV]||"%I:%M"),p=t(n[eV]||"%I %p"),g=t(n[QW]||n[JW]||"%a %d"),m=t(n[ZW]||"%b %d"),y=t(n[$W]||"%B"),v=t(n[KW]||"%B"),b=t(n[XW]||"%Y");return t=>(r(t)<t?h:i(t)<t?d:a(t)<t?f:o(t)<t?p:c(t)<t?s(t)<t?g:m:l(t)<t?u(t)<t?y:v:b)(t)}function bV(t){const e=fV(t.format),n=fV(t.utcFormat);return{timeFormat:t=>EU(t)?e(t):vV(e,sV,t),utcFormat:t=>EU(t)?n(t):vV(n,cV,t),timeParse:fV(t.parse),utcParse:fV(t.utcParse)}}function xV(){return mV=bV({format:ja,parse:Ua,utcFormat:Wa,utcParse:Va})}yV(),xV();const wV=/^(data:|([A-Za-z]+:)?\/\/)/,kV=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,_V=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,SV="file://";async function AV(t,e){const n=await this.sanitize(t,e),r=n.href;return n.localFile?this.file(r):this.http(r,e)}async function CV(t,e){e=kU({},this.options,e);const n=this.fileAccess,r={href:null};let i,a,o;const s=kV.test(t.replace(_V,""));null!=t&&"string"===typeof t&&s||hU("Sanitize failure, invalid URI: "+TU(t));const c=wV.test(t);return(o=e.baseURL)&&!c&&(t.startsWith("/")||o.endsWith("/")||(t="/"+t),t=o+t),a=(i=t.startsWith(SV))||"file"===e.mode||"http"!==e.mode&&!c&&n,i?t=t.slice(SV.length):t.startsWith("//")&&("file"===e.defaultProtocol?(t=t.slice(2),a=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(r,"localFile",{value:!!a}),r.href=t,e.target&&(r.target=e.target+""),e.rel&&(r.rel=e.rel+""),"image"===e.context&&e.crossOrigin&&(r.crossOrigin=e.crossOrigin+""),r}function EV(t){return t?e=>new Promise(((n,r)=>{t.readFile(e,((t,e)=>{t?r(t):n(e)}))})):TV}async function TV(){hU("No file system access.")}function NV(t){return t?async function(e,n){const r=kU({},this.options.http,n),i=n&&n.response,a=await t(e,r);return a.ok?wU(a[i])?a[i]():a.text():hU(a.status+""+a.statusText)}:DV}async function DV(){hU("No HTTP fetch method available.")}function FV(t){const e=function(e,n){const r={delimiter:t};return IV(e,n?kU(n,r):r)};return e.responseType="text",e}function IV(t,e){return e.header&&(t=e.header.map(TU).join(e.delimiter)+"\n"+t),lr(e.delimiter).parse(t+"")}function MV(t,e){const n=e&&e.property?fU(e.property):pU;return!yU(t)||(r=t,"function"===typeof Buffer&&wU(Buffer.isBuffer)&&Buffer.isBuffer(r))?n(JSON.parse(t)):function(t,e){!mU(t)&&function(t){return t&&wU(t[Symbol.iterator])}(t)&&(t=[...t]);return e&&e.copy?JSON.parse(JSON.stringify(t)):t}(n(t),e);var r}IV.responseType="text",MV.responseType="json";const OV={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function RV(t,e){let n,r,i,a;return t=MV(t,e),e&&e.feature?(n=dr,i=e.feature):e&&e.mesh?(n=mr,i=e.mesh,a=OV[e.filter]):hU("Missing TopoJSON feature or mesh parameter."),r=(r=t.objects[i])?n(t,r,a):hU("Invalid TopoJSON object: "+i),r&&r.features||[r]}RV.responseType="json";FV(","),FV("\t");const zV=function(t,e){return n=>({options:n||{},sanitize:CV,load:AV,fileAccess:!!e,file:EV(e),http:NV(t)})}("undefined"!==typeof fetch&&fetch,null);function BV(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function LV(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function PV(t){let e,n,r;function i(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<0?i=e+1:a=e}while(i<a)}return i}return 2!==t.length?(e=BV,n=(e,n)=>BV(t(e),n),r=(e,n)=>t(e)-n):(e=t===BV||t===LV?t:jV,n=t,r=t),{left:i,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=i(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return a>n&&r(t[a-1],e)>-r(t[a],e)?a-1:a},right:function(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<=0?i=e+1:a=e}while(i<a)}return i}}}function jV(){return 0}const UV=PV(BV),WV=UV.right,VV=(UV.left,PV((function(t){return null===t?NaN:+t})).center,WV);function qV(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function GV(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function HV(){}var YV=.7,XV=1.4285714285714286,KV="\\s*([+-]?\\d+)\\s*",$V="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ZV="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",QV=/^#([0-9a-f]{3,8})$/,JV=new RegExp("^rgb\\(".concat(KV,",").concat(KV,",").concat(KV,"\\)$")),tq=new RegExp("^rgb\\(".concat(ZV,",").concat(ZV,",").concat(ZV,"\\)$")),eq=new RegExp("^rgba\\(".concat(KV,",").concat(KV,",").concat(KV,",").concat($V,"\\)$")),nq=new RegExp("^rgba\\(".concat(ZV,",").concat(ZV,",").concat(ZV,",").concat($V,"\\)$")),rq=new RegExp("^hsl\\(".concat($V,",").concat(ZV,",").concat(ZV,"\\)$")),iq=new RegExp("^hsla\\(".concat($V,",").concat(ZV,",").concat(ZV,",").concat($V,"\\)$")),aq={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function oq(){return this.rgb().formatHex()}function sq(){return this.rgb().formatRgb()}function cq(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=QV.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?uq(e):3===n?new fq(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?lq(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?lq(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=JV.exec(t))?new fq(e[1],e[2],e[3],1):(e=tq.exec(t))?new fq(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=eq.exec(t))?lq(e[1],e[2],e[3],e[4]):(e=nq.exec(t))?lq(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=rq.exec(t))?bq(e[1],e[2]/100,e[3]/100,1):(e=iq.exec(t))?bq(e[1],e[2]/100,e[3]/100,e[4]):aq.hasOwnProperty(t)?uq(aq[t]):"transparent"===t?new fq(NaN,NaN,NaN,0):null}function uq(t){return new fq(t>>16&255,t>>8&255,255&t,1)}function lq(t,e,n,r){return r<=0&&(t=e=n=NaN),new fq(t,e,n,r)}function hq(t){return t instanceof HV||(t=cq(t)),t?new fq((t=t.rgb()).r,t.g,t.b,t.opacity):new fq}function dq(t,e,n,r){return 1===arguments.length?hq(t):new fq(t,e,n,null==r?1:r)}function fq(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function pq(){return"#".concat(vq(this.r)).concat(vq(this.g)).concat(vq(this.b))}function gq(){const t=mq(this.opacity);return"".concat(1===t?"rgb(":"rgba(").concat(yq(this.r),", ").concat(yq(this.g),", ").concat(yq(this.b)).concat(1===t?")":", ".concat(t,")"))}function mq(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function yq(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function vq(t){return((t=yq(t))<16?"0":"")+t.toString(16)}function bq(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new kq(t,e,n,r)}function xq(t){if(t instanceof kq)return new kq(t.h,t.s,t.l,t.opacity);if(t instanceof HV||(t=cq(t)),!t)return new kq;if(t instanceof kq)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new kq(o,s,c,t.opacity)}function wq(t,e,n,r){return 1===arguments.length?xq(t):new kq(t,e,n,null==r?1:r)}function kq(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function _q(t){return(t=(t||0)%360)<0?t+360:t}function Sq(t){return Math.max(0,Math.min(1,t||0))}function Aq(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Cq(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}function Eq(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,s=r<e-1?t[r+2]:2*a-i;return Cq((n-r/e)*e,o,i,a,s)}}function Tq(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],s=t[(r+2)%e];return Cq((n-r/e)*e,i,a,o,s)}}qV(HV,cq,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:oq,formatHex:oq,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return xq(this).formatHsl()},formatRgb:sq,toString:sq}),qV(fq,dq,GV(HV,{brighter(t){return t=null==t?XV:Math.pow(XV,t),new fq(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?YV:Math.pow(YV,t),new fq(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new fq(yq(this.r),yq(this.g),yq(this.b),mq(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:pq,formatHex:pq,formatHex8:function(){return"#".concat(vq(this.r)).concat(vq(this.g)).concat(vq(this.b)).concat(vq(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:gq,toString:gq})),qV(kq,wq,GV(HV,{brighter(t){return t=null==t?XV:Math.pow(XV,t),new kq(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?YV:Math.pow(YV,t),new kq(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new fq(Aq(t>=240?t-240:t+120,i,r),Aq(t,i,r),Aq(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new kq(_q(this.h),Sq(this.s),Sq(this.l),mq(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=mq(this.opacity);return"".concat(1===t?"hsl(":"hsla(").concat(_q(this.h),", ").concat(100*Sq(this.s),"%, ").concat(100*Sq(this.l),"%").concat(1===t?")":", ".concat(t,")"))}}));const Nq=t=>()=>t;function Dq(t,e){return function(n){return t+n*e}}function Fq(t,e){var n=e-t;return n?Dq(t,n>180||n<-180?n-360*Math.round(n/360):n):Nq(isNaN(t)?e:t)}function Iq(t){return 1===(t=+t)?Mq:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Nq(isNaN(e)?n:e)}}function Mq(t,e){var n=e-t;return n?Dq(t,n):Nq(isNaN(t)?e:t)}const Oq=function t(e){var n=Iq(e);function r(t,e){var r=n((t=dq(t)).r,(e=dq(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=Mq(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function Rq(t){return function(e){var n,r,i=e.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=dq(e[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=t(a),o=t(o),s=t(s),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=s(t),r+""}}}var zq=Rq(Eq),Bq=Rq(Tq);function Lq(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(a){for(n=0;n<r;++n)i[n]=t[n]*(1-a)+e[n]*a;return i}}function Pq(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function jq(t,e){return(Pq(e)?Lq:Uq)(t,e)}function Uq(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=Xq(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}function Wq(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Vq(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function qq(t,e){var n,r={},i={};for(n in null!==t&&"object"===typeof t||(t={}),null!==e&&"object"===typeof e||(e={}),e)n in t?r[n]=Xq(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var Gq=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Hq=new RegExp(Gq.source,"g");function Yq(t,e){var n,r,i,a=Gq.lastIndex=Hq.lastIndex=0,o=-1,s=[],c=[];for(t+="",e+="";(n=Gq.exec(t))&&(r=Hq.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,c.push({i:o,x:Vq(n,r)})),a=Hq.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?c[0]?function(t){return function(e){return t(e)+""}}(c[0].x):function(t){return function(){return t}}(e):(e=c.length,function(t){for(var n,r=0;r<e;++r)s[(n=c[r]).i]=n.x(t);return s.join("")})}function Xq(t,e){var n,r=typeof e;return null==e||"boolean"===r?Nq(e):("number"===r?Vq:"string"===r?(n=cq(e))?(e=n,Oq):Yq:e instanceof cq?Oq:e instanceof Date?Wq:Pq(e)?Lq:Array.isArray(e)?Uq:"function"!==typeof e.valueOf&&"function"!==typeof e.toString||isNaN(e)?qq:Vq)(t,e)}function Kq(t,e){void 0===e&&(e=t,t=Xq);for(var n=0,r=e.length-1,i=e[0],a=new Array(r<0?0:r);n<r;)a[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return a[e](t-e)}}function $q(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function Zq(t,e){var n=Fq(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}}function Qq(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Jq,tG=180/Math.PI,eG={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function nG(t,e,n,r,i,a){var o,s,c;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),t*r<e*n&&(t=-t,e=-e,c=-c,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*tG,skewX:Math.atan(c)*tG,scaleX:o,scaleY:s}}function rG(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var s=[],c=[];return a=t(a),o=t(o),function(t,r,i,a,o,s){if(t!==i||r!==a){var c=o.push("translate(",null,e,null,n);s.push({i:c-4,x:Vq(t,i)},{i:c-2,x:Vq(r,a)})}else(i||a)&&o.push("translate("+i+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,c),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Vq(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(a.rotate,o.rotate,s,c),function(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Vq(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(a.skewX,o.skewX,s,c),function(t,e,n,r,a,o){if(t!==n||e!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:Vq(t,n)},{i:s-2,x:Vq(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,c),a=o=null,function(t){for(var e,n=-1,r=c.length;++n<r;)s[(e=c[n]).i]=e.x(t);return s.join("")}}}var iG=rG((function(t){const e=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?eG:nG(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),aG=rG((function(t){return null==t?eG:(Jq||(Jq=document.createElementNS("http://www.w3.org/2000/svg","g")),Jq.setAttribute("transform",t),(t=Jq.transform.baseVal.consolidate())?nG((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):eG)}),", ",")",")");function oG(t){return((t=Math.exp(t))+1/t)/2}const sG=function t(e,n,r){function i(t,i){var a,o,s=t[0],c=t[1],u=t[2],l=i[0],h=i[1],d=i[2],f=l-s,p=h-c,g=f*f+p*p;if(g<1e-12)o=Math.log(d/u)/e,a=function(t){return[s+t*f,c+t*p,u*Math.exp(e*t*o)]};else{var m=Math.sqrt(g),y=(d*d-u*u+r*g)/(2*u*n*m),v=(d*d-u*u-r*g)/(2*d*n*m),b=Math.log(Math.sqrt(y*y+1)-y),x=Math.log(Math.sqrt(v*v+1)-v);o=(x-b)/e,a=function(t){var r=t*o,i=oG(b),a=u/(n*m)*(i*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(e*r+b)-function(t){return((t=Math.exp(t))-1/t)/2}(b));return[s+a*f,c+a*p,u*i/oG(e*r+b)]}}return a.duration=1e3*o*e/Math.SQRT2,a}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i}(Math.SQRT2,2,4);function cG(t){return function(e,n){var r=t((e=wq(e)).h,(n=wq(n)).h),i=Mq(e.s,n.s),a=Mq(e.l,n.l),o=Mq(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=a(t),e.opacity=o(t),e+""}}}const uG=cG(Fq);var lG=cG(Mq);const hG=Math.PI/180,dG=180/Math.PI,fG=.96422,pG=1,gG=.82521,mG=4/29,yG=6/29,vG=.12841854934601665,bG=.008856451679035631;function xG(t){if(t instanceof kG)return new kG(t.l,t.a,t.b,t.opacity);if(t instanceof NG)return DG(t);t instanceof fq||(t=hq(t));var e,n,r=CG(t.r),i=CG(t.g),a=CG(t.b),o=_G((.2225045*r+.7168786*i+.0606169*a)/pG);return r===i&&i===a?e=n=o:(e=_G((.4360747*r+.3850649*i+.1430804*a)/fG),n=_G((.0139322*r+.0971045*i+.7141733*a)/gG)),new kG(116*o-16,500*(e-o),200*(o-n),t.opacity)}function wG(t,e,n,r){return 1===arguments.length?xG(t):new kG(t,e,n,null==r?1:r)}function kG(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function _G(t){return t>bG?Math.pow(t,1/3):t/vG+mG}function SG(t){return t>yG?t*t*t:vG*(t-mG)}function AG(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function CG(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function EG(t){if(t instanceof NG)return new NG(t.h,t.c,t.l,t.opacity);if(t instanceof kG||(t=xG(t)),0===t.a&&0===t.b)return new NG(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*dG;return new NG(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function TG(t,e,n,r){return 1===arguments.length?EG(t):new NG(t,e,n,null==r?1:r)}function NG(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function DG(t){if(isNaN(t.h))return new kG(t.l,0,0,t.opacity);var e=t.h*hG;return new kG(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function FG(t,e){var n=Mq((t=wG(t)).l,(e=wG(e)).l),r=Mq(t.a,e.a),i=Mq(t.b,e.b),a=Mq(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=a(e),t+""}}function IG(t){return function(e,n){var r=t((e=TG(e)).h,(n=TG(n)).h),i=Mq(e.c,n.c),a=Mq(e.l,n.l),o=Mq(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=a(t),e.opacity=o(t),e+""}}}qV(kG,wG,GV(HV,{brighter(t){return new kG(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker(t){return new kG(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new fq(AG(3.1338561*(e=fG*SG(e))-1.6168667*(t=pG*SG(t))-.4906146*(n=gG*SG(n))),AG(-.9787684*e+1.9161415*t+.033454*n),AG(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),qV(NG,TG,GV(HV,{brighter(t){return new NG(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker(t){return new NG(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb(){return DG(this).rgb()}}));const MG=IG(Fq);var OG=IG(Mq),RG=-.14861,zG=1.78277,BG=-.29227,LG=-.90649,PG=1.97294,jG=PG*LG,UG=PG*zG,WG=zG*BG-LG*RG;function VG(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof qG)return new qG(t.h,t.s,t.l,t.opacity);t instanceof fq||(t=hq(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(WG*r+jG*e-UG*n)/(WG+jG-UG),a=r-i,o=(PG*(n-i)-BG*a)/LG,s=Math.sqrt(o*o+a*a)/(PG*i*(1-i)),c=s?Math.atan2(o,a)*dG-120:NaN;return new qG(c<0?c+360:c,s,i,t.opacity)}(t):new qG(t,e,n,null==r?1:r)}function qG(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function GG(t){return function e(n){function r(e,r){var i=t((e=VG(e)).h,(r=VG(r)).h),a=Mq(e.s,r.s),o=Mq(e.l,r.l),s=Mq(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=a(t),e.l=o(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}qV(qG,VG,GV(HV,{brighter(t){return t=null==t?XV:Math.pow(XV,t),new qG(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?YV:Math.pow(YV,t),new qG(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*hG,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new fq(255*(e+n*(RG*r+zG*i)),255*(e+n*(BG*r+LG*i)),255*(e+n*(PG*r)),this.opacity)}}));const HG=GG(Fq);var YG=GG(Mq);function XG(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}const KG="linear",$G="log",ZG="pow",QG="sqrt",JG="symlog",tH="time",eH="utc",nH="sequential",rH="diverging",iH="quantile",aH="quantize",oH="threshold",sH="continuous",cH="discrete",uH="discretizing",lH="interpolating",hH="temporal";function dH(){const t=jg().unknown(void 0),e=t.domain,n=t.range;let r,i,a=[0,1],o=!1,s=0,c=0,u=.5;function l(){const t=e().length,l=a[1]<a[0],h=a[1-l],d=function(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0}(t,s,c);let f=a[l-0];r=(h-f)/(d||1),o&&(r=Math.floor(r)),f+=(h-f-r*(t-s))*u,i=r*(1-s),o&&(f=Math.round(f),i=Math.round(i));const p=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a}(t).map((t=>f+r*t));return n(l?p.reverse():p)}return delete t.unknown,t.domain=function(t){return arguments.length?(e(t),l()):e()},t.range=function(t){return arguments.length?(a=[+t[0],+t[1]],l()):a.slice()},t.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,l()},t.bandwidth=function(){return i},t.step=function(){return r},t.round=function(t){return arguments.length?(o=!!t,l()):o},t.padding=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),s=c,l()):s},t.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),l()):s},t.paddingOuter=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),l()):c},t.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),l()):u},t.invertRange=function(t){if(null==t[0]||null==t[1])return;const r=a[1]<a[0],o=r?n().reverse():n(),s=o.length-1;let c,u,l,h=+t[0],d=+t[1];return h!==h||d!==d||(d<h&&(l=h,h=d,d=l),d<o[0]||h>a[1-r])?void 0:(c=Math.max(0,WV(o,h)-1),u=h===d?c:WV(o,d)-1,h-o[c]>i+1e-10&&++c,r&&(l=c,c=s-u,u=s-l),c>u?void 0:e().slice(c,u+1))},t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return dH().domain(e()).range(a).round(o).paddingInner(s).paddingOuter(c).align(u)},l()}function fH(t){const e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return fH(e())},t}var pH=Array.prototype.map;const gH=Array.prototype.slice;const mH=new Map,yH=Symbol("vega_scale");function vH(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){let n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){const n=t.range();let r,i,a,o,s=e[0],c=e[1],u=-1;for(c<s&&(i=s,s=c,c=i),a=0,o=n.length;a<o;++a)n[a]>=s&&n[a]<=c&&(u<0&&(u=a),r=a);if(!(u<0))return s=t.invertExtent(n[u]),c=t.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===c[1]?c[0]:c[1]]}}(n):void 0),n.type=t,function(t){return t[yH]=!0,t}(n)};return r.metadata=NU(xU(n)),r}function bH(t,e,n){return arguments.length>1?(mH.set(t,vH(t,e,n)),this):function(t){return mH.has(t)}(t)?mH.get(t):void 0}function xH(t,e){const n=mH.get(t);return n&&n.metadata[e]}function wH(t){return xH(t,cH)}bH("identity",Ip),bH(KG,Fp,sH),bH($G,Up,[sH,$G]),bH(ZG,Hp,sH),bH(QG,Yp,sH),bH(JG,Zp,sH),bH(tH,gg,[sH,hH]),bH(eH,mg,[sH,hH]),bH(nH,bg,[sH,lH]),bH("".concat(nH,"-").concat(KG),bg,[sH,lH]),bH("".concat(nH,"-").concat($G),xg,[sH,lH,$G]),bH("".concat(nH,"-").concat(ZG),kg,[sH,lH]),bH("".concat(nH,"-").concat(QG),_g,[sH,lH]),bH("".concat(nH,"-").concat(JG),wg,[sH,lH]),bH("".concat(rH,"-").concat(KG),Ag,[sH,lH]),bH("".concat(rH,"-").concat($G),Cg,[sH,lH,$G]),bH("".concat(rH,"-").concat(ZG),Tg,[sH,lH]),bH("".concat(rH,"-").concat(QG),Ng,[sH,lH]),bH("".concat(rH,"-").concat(JG),Eg,[sH,lH]),bH(iH,Fg,[uH,iH]),bH(aH,Ig,uH),bH(oH,Mg,uH),bH("bin-ordinal",(function t(){let e=[],n=[];function r(t){return null==t||t!==t?void 0:n[(VV(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=function(t){return pH.call(t,bU)}(t),r):e.slice()},r.range=function(t){return arguments.length?(n=gH.call(t),r):n.slice()},r.tickFormat=function(t,n){return Np(e[0],vU(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}),[cH,uH]),bH("ordinal",jg,cH),bH("band",dH,cH),bH("point",(function(){return fH(dH().paddingInner(1))}),cH);function kH(t,e,n){return Kq(function(t,e){const n=y[function(t){return"interpolate"+t.toLowerCase().split("-").map((t=>t[0].toUpperCase()+t.slice(1))).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}(e||"rgb",n),t)}function _H(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function SH(t,e){for(const n in t)CH(n,e(t[n]))}const AH={};function CH(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(AH[t]=e,this):AH[t]}SH({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},_H),SH({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(t=>kH(_H(t))));const EH="symbol",TH="discrete",NH=t=>mU(t)?t.map((t=>String(t))):String(t),DH=(t,e)=>t[1]-e[1],FH=(t,e)=>e[1]-t[1];function IH(t,e){return t.bins?function(t,e,n){let r=t.range(),i=r[0],a=vU(r),o=DH;if(i>a&&(r=a,a=i,i=r,o=FH),i=Math.floor(i),a=Math.ceil(a),e=e.map((e=>[e,t(e)])).filter((t=>i<=t[1]&&t[1]<=a)).sort(o).map((t=>t[0])),n>0&&e.length>1){const t=[e[0],vU(e)];for(;e.length>n&&e.length>=3;)e=e.filter(((t,e)=>!(e%2)));e.length<3&&(e=t)}return e}(t,t.bins):t.ticks?t.ticks(e):t.domain()}function MH(t,e,n,r,i,a){const o=e.type;let s=NH;if(o===tH||i===tH)s=t.timeFormat(r);else if(o===eH||i===eH)s=t.utcFormat(r);else if(function(t){return xH(t,$G)}(o)){const i=t.formatFloat(r);if(a||e.bins)s=i;else{const t=OH(e,n,!1);s=e=>t(e)?i(e):""}}else if(e.tickFormat){const i=e.domain();s=t.formatSpan(i[0],i[i.length-1],n,r)}else r&&(s=t.format(r));return s}function OH(t,e,n){const r=IH(t,e),i=t.base(),a=Math.log(i),o=Math.max(1,i*e/r.length),s=t=>{let e=t/Math.pow(i,Math.round(Math.log(t)/a));return e*i<i-.5&&(e*=i),e<=o};return n?r.filter(s):s}const RH={[iH]:"quantiles",[aH]:"thresholds",[oH]:"domain"},zH={[iH]:"quantiles",[aH]:"domain"};function BH(t,e){return t.bins?function(t){const e=t.slice(0,-1);return e.max=vU(t),e}(t.bins):t.type===$G?OH(t,e,!0):RH[t.type]?function(t){const e=[-1/0].concat(t);return e.max=1/0,e}(t[RH[t.type]]()):IH(t,e)}const LH=t=>RH[t.type]||t.bins;function PH(t,e,n,r,i,a,o){const s=zH[e.type]&&a!==tH&&a!==eH?function(t,e,n){const r=e[zH[e.type]](),i=r.length;let a,o=i>1?r[1]-r[0]:r[0];for(a=1;a<i;++a)o=Math.min(o,r[a]-r[a-1]);return t.formatSpan(0,o,30,n)}(t,e,i):MH(t,e,n,i,a,o);return r===EH&&LH(e)?jH(s):r===TH?WH(s):VH(s)}const jH=t=>(e,n,r)=>{const i=UH(r[n+1],UH(r.max,1/0)),a=qH(e,t),o=qH(i,t);return a&&o?a+" \u2013 "+o:o?"< "+o:"\u2265 "+a},UH=(t,e)=>null!=t?t:e,WH=t=>(e,n)=>n?t(e):null,VH=t=>e=>t(e),qH=(t,e)=>Number.isFinite(t)?e(t):null;function GH(t,e,n,r){const i=r||e.type;return EU(n)&&function(t){return xH(t,hH)}(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||i!==tH?n||i!==eH?PH(t,e,5,null,n,r,!0):t.utcFormat("%A, %d %B %Y, %X UTC"):t.timeFormat("%A, %d %B %Y, %X")}function HH(t,e,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=GH(t,e,n.format,n.formatType);if(function(t){return xH(t,uH)}(e.type)){const t=BH(e).slice(1).map(i),n=t.length;return"".concat(n," boundar").concat(1===n?"y":"ies",": ").concat(t.join(", "))}if(wH(e.type)){const t=e.domain(),n=t.length,a=n>r?t.slice(0,r-2).map(i).join(", ")+", ending with "+t.slice(-1).map(i):t.map(i).join(", ");return"".concat(n," value").concat(1===n?"":"s",": ").concat(a)}{const t=e.domain();return"values from ".concat(i(t[0])," to ").concat(i(vU(t)))}}let YH=0;const XH="p_";function KH(t){return t&&t.gradient}function $H(t,e,n){const r=t.gradient;let i=t.id,a="radial"===r?XH:"";return i||(i=t.id="gradient_"+YH++,"radial"===r?(t.x1=ZH(t.x1,.5),t.y1=ZH(t.y1,.5),t.r1=ZH(t.r1,0),t.x2=ZH(t.x2,.5),t.y2=ZH(t.y2,.5),t.r2=ZH(t.r2,.5),a=XH):(t.x1=ZH(t.x1,0),t.y1=ZH(t.y1,0),t.x2=ZH(t.x2,1),t.y2=ZH(t.y2,0))),e[i]=t,"url("+(n||"")+"#"+a+i+")"}function ZH(t,e){return null!=t?t:e}function QH(t,e){var n,r=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:r,stop:function(t,e){return r.push({offset:t,color:e}),n}}}const JH={basis:{curve:function(t){return new FU(t)}},"basis-closed":{curve:function(t){return new MU(t)}},"basis-open":{curve:function(t){return new OU(t)}},bundle:{curve:zU,tension:"beta",value:.85},cardinal:{curve:PU,tension:"tension",value:0},"cardinal-open":{curve:UU,tension:"tension",value:0},"cardinal-closed":{curve:VU,tension:"tension",value:0},"catmull-rom":{curve:iW,tension:"alpha",value:.5},"catmull-rom-closed":{curve:oW,tension:"alpha",value:.5},"catmull-rom-open":{curve:cW,tension:"alpha",value:.5},linear:{curve:lW},"linear-closed":{curve:function(t){return new hW(t)}},monotone:{horizontal:function(t){return new yW(t)},vertical:function(t){return new mW(t)}},natural:{curve:function(t){return new bW(t)}},step:{curve:function(t){return new wW(t,.5)}},"step-after":{curve:function(t){return new wW(t,1)}},"step-before":{curve:function(t){return new wW(t,0)}}};function tY(t,e,n){var r=SU(JH,t)&&JH[t],i=null;return r&&(i=r.curve||r[e||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const eY={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},nY=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function rY(t){const e=[];let n,r,i,a,o,s,c,u,l,h;const d=t.slice().replace(nY[0],"###$1").split(nY[1]).slice(1);for(c=0,l=d.length;c<l;++c){for(n=d[c],r=n.slice(1).trim().replace(nY[2],"$1###$2").replace(nY[3],"$1###$2").split(nY[4]),o=n.charAt(0),i=[o],u=0,h=r.length;u<h;++u)(a=+r[u])===a&&i.push(a);if(s=eY[o.toLowerCase()],i.length-1>s){const t=i.length;for(u=1,e.push([o].concat(i.slice(u,u+=s))),o="M"===o?"L":"m"===o?"l":o;u<t;u+=s)e.push([o].concat(i.slice(u,u+s)))}else e.push(i)}return e}const iY=Math.PI/180,aY=Math.PI/2,oY=2*Math.PI,sY=Math.sqrt(3)/2;var cY={},uY={},lY=[].join;function hY(t){const e=lY.call(t);if(uY[e])return uY[e];var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],u=t[7];const l=u*o,h=-c*s,d=c*o,f=u*s,p=Math.cos(i),g=Math.sin(i),m=Math.cos(a),y=Math.sin(a),v=.5*(a-i),b=Math.sin(.5*v),x=8/3*b*b/Math.sin(v),w=n+p-x*g,k=r+g+x*p,_=n+m,S=r+y,A=_+x*y,C=S-x*m;return uY[e]=[l*w+h*k,d*w+f*k,l*A+h*C,d*A+f*C,l*_+h*S,d*_+f*S]}const dY=["l",0,0,0,0,0,0,0];function fY(t,e,n){const r=dY[0]=t[0];if("a"===r||"A"===r)dY[1]=e*t[1],dY[2]=n*t[2],dY[3]=t[3],dY[4]=t[4],dY[5]=t[5],dY[6]=e*t[6],dY[7]=n*t[7];else if("h"===r||"H"===r)dY[1]=e*t[1];else if("v"===r||"V"===r)dY[1]=n*t[1];else for(var i=1,a=t.length;i<a;++i)dY[i]=(i%2==1?e:n)*t[i];return dY}function pY(t,e,n,r,i,a){var o,s,c,u,l,h=null,d=0,f=0,p=0,g=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==a&&(a=i),t.beginPath&&t.beginPath();for(var m=0,y=e.length;m<y;++m){switch(o=e[m],1===i&&1===a||(o=fY(o,i,a)),o[0]){case"l":d+=o[1],f+=o[2],t.lineTo(d+n,f+r);break;case"L":d=o[1],f=o[2],t.lineTo(d+n,f+r);break;case"h":d+=o[1],t.lineTo(d+n,f+r);break;case"H":d=o[1],t.lineTo(d+n,f+r);break;case"v":f+=o[1],t.lineTo(d+n,f+r);break;case"V":f=o[1],t.lineTo(d+n,f+r);break;case"m":d+=o[1],f+=o[2],t.moveTo(d+n,f+r);break;case"M":d=o[1],f=o[2],t.moveTo(d+n,f+r);break;case"c":s=d+o[5],c=f+o[6],p=d+o[3],g=f+o[4],t.bezierCurveTo(d+o[1]+n,f+o[2]+r,p+n,g+r,s+n,c+r),d=s,f=c;break;case"C":d=o[5],f=o[6],p=o[3],g=o[4],t.bezierCurveTo(o[1]+n,o[2]+r,p+n,g+r,d+n,f+r);break;case"s":s=d+o[3],c=f+o[4],p=2*d-p,g=2*f-g,t.bezierCurveTo(p+n,g+r,d+o[1]+n,f+o[2]+r,s+n,c+r),p=d+o[1],g=f+o[2],d=s,f=c;break;case"S":s=o[3],c=o[4],p=2*d-p,g=2*f-g,t.bezierCurveTo(p+n,g+r,o[1]+n,o[2]+r,s+n,c+r),d=s,f=c,p=o[1],g=o[2];break;case"q":s=d+o[3],c=f+o[4],p=d+o[1],g=f+o[2],t.quadraticCurveTo(p+n,g+r,s+n,c+r),d=s,f=c;break;case"Q":s=o[3],c=o[4],t.quadraticCurveTo(o[1]+n,o[2]+r,s+n,c+r),d=s,f=c,p=o[1],g=o[2];break;case"t":s=d+o[1],c=f+o[2],null===h[0].match(/[QqTt]/)?(p=d,g=f):"t"===h[0]?(p=2*d-u,g=2*f-l):"q"===h[0]&&(p=2*d-p,g=2*f-g),u=p,l=g,t.quadraticCurveTo(p+n,g+r,s+n,c+r),f=c,p=(d=s)+o[1],g=f+o[2];break;case"T":s=o[1],c=o[2],p=2*d-p,g=2*f-g,t.quadraticCurveTo(p+n,g+r,s+n,c+r),d=s,f=c;break;case"a":gY(t,d+n,f+r,[o[1],o[2],o[3],o[4],o[5],o[6]+d+n,o[7]+f+r]),d+=o[6],f+=o[7];break;case"A":gY(t,d+n,f+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),d=o[6],f=o[7];break;case"z":case"Z":t.closePath()}h=o}}function gY(t,e,n,r){const i=function(t,e,n,r,i,a,o,s,c){const u=lY.call(arguments);if(cY[u])return cY[u];const l=o*iY,h=Math.sin(l),d=Math.cos(l),f=d*(s-t)*.5+h*(c-e)*.5,p=d*(c-e)*.5-h*(s-t)*.5;let g=f*f/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=d/n,y=h/n,v=-h/r,b=d/r,x=m*s+y*c,w=v*s+b*c,k=m*t+y*e,_=v*t+b*e;let S=1/((k-x)*(k-x)+(_-w)*(_-w))-.25;S<0&&(S=0);let A=Math.sqrt(S);a==i&&(A=-A);const C=.5*(x+k)-A*(_-w),E=.5*(w+_)+A*(k-x),T=Math.atan2(w-E,x-C);let N=Math.atan2(_-E,k-C)-T;N<0&&1===a?N+=oY:N>0&&0===a&&(N-=oY);const D=Math.ceil(Math.abs(N/(aY+.001))),F=[];for(let I=0;I<D;++I){const t=T+I*N/D,e=T+(I+1)*N/D;F[I]=[C,E,t,e,n,r,h,d]}return cY[u]=F}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n);for(let a=0;a<i.length;++a){const e=hY(i[a]);t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5])}}const mY=.5773502691896257,yY={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,oY)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,a=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-a),t.lineTo(i,-a),t.lineTo(0,-n),t.lineTo(-i,-a),t.lineTo(-r,-a),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=sY*n,i=r-n*mY,a=n/4;t.moveTo(0,-r-i),t.lineTo(-a,r-i),t.lineTo(a,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=sY*n,i=r-n*mY;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=sY*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=sY*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=sY*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=sY*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function vY(t){return SU(yY,t)?yY[t]:function(t){if(!SU(bY,t)){const e=rY(t);bY[t]={draw:function(t,n){pY(t,e,0,0,Math.sqrt(n)/2)}}}return bY[t]}(t)}var bY={};const xY=.448084975506;function wY(t){return t.x}function kY(t){return t.y}function _Y(t){return t.width}function SY(t){return t.height}function AY(t){return"function"===typeof t?t:()=>+t}function CY(t,e,n){return Math.max(e,Math.min(t,n))}function EY(){var t=wY,e=kY,n=_Y,r=SY,i=AY(0),a=i,o=i,s=i,c=null;function u(u,l,h){var d,f=null!=l?l:+t.call(this,u),p=null!=h?h:+e.call(this,u),g=+n.call(this,u),m=+r.call(this,u),y=Math.min(g,m)/2,v=CY(+i.call(this,u),0,y),b=CY(+a.call(this,u),0,y),x=CY(+o.call(this,u),0,y),w=CY(+s.call(this,u),0,y);if(c||(c=d=TW()),v<=0&&b<=0&&x<=0&&w<=0)c.rect(f,p,g,m);else{var k=f+g,_=p+m;c.moveTo(f+v,p),c.lineTo(k-b,p),c.bezierCurveTo(k-xY*b,p,k,p+xY*b,k,p+b),c.lineTo(k,_-w),c.bezierCurveTo(k,_-xY*w,k-xY*w,_,k-w,_),c.lineTo(f+x,_),c.bezierCurveTo(f+xY*x,_,f,_-xY*x,f,_-x),c.lineTo(f,p+v),c.bezierCurveTo(f,p+xY*v,f+xY*v,p,f+v,p),c.closePath()}if(d)return c=null,d+""||null}return u.x=function(e){return arguments.length?(t=AY(e),u):t},u.y=function(t){return arguments.length?(e=AY(t),u):e},u.width=function(t){return arguments.length?(n=AY(t),u):n},u.height=function(t){return arguments.length?(r=AY(t),u):r},u.cornerRadius=function(t,e,n,r){return arguments.length?(i=AY(t),a=null!=e?AY(e):i,s=null!=n?AY(n):i,o=null!=r?AY(r):a,u):i},u.context=function(t){return arguments.length?(c=null==t?null:t,u):c},u}function TY(){var t,e,n,r,i,a,o,s,c=null;function u(t,e,n){const r=n/2;if(i){var u=o-e,l=t-a;if(u||l){var h=Math.sqrt(u*u+l*l),d=(u/=h)*s,f=(l/=h)*s,p=Math.atan2(l,u);c.moveTo(a-d,o-f),c.lineTo(t-u*r,e-l*r),c.arc(t,e,r,p-Math.PI,p),c.lineTo(a+d,o+f),c.arc(a,o,s,p,p+Math.PI)}else c.arc(t,e,r,0,oY);c.closePath()}else i=1;a=t,o=e,s=r}function l(a){var o,s,l,h=a.length,d=!1;for(null==c&&(c=l=TW()),o=0;o<=h;++o)!(o<h&&r(s=a[o],o,a))===d&&(d=!d)&&(i=0),d&&u(+t(s,o,a),+e(s,o,a),+n(s,o,a));if(l)return c=null,l+""||null}return l.x=function(e){return arguments.length?(t=e,l):t},l.y=function(t){return arguments.length?(e=t,l):e},l.size=function(t){return arguments.length?(n=t,l):n},l.defined=function(t){return arguments.length?(r=t,l):r},l.context=function(t){return arguments.length?(c=null==t?null:t,l):c},l}function NY(t,e){return null!=t?t:e}const DY=t=>t.x||0,FY=t=>t.y||0,IY=t=>!(!1===t.defined),MY=function(){var t=DW,e=FW,n=NW(0),r=null,i=IW,a=MW,o=OW,s=null;function c(){var c,u,l=+t.apply(this,arguments),h=+e.apply(this,arguments),d=i.apply(this,arguments)-JU,f=a.apply(this,arguments)-JU,p=qU(f-d),g=f>d;if(s||(s=c=TW()),h<l&&(u=h,h=l,l=u),h>ZU)if(p>tW-ZU)s.moveTo(h*HU(d),h*KU(d)),s.arc(0,0,h,d,f,!g),l>ZU&&(s.moveTo(l*HU(f),l*KU(f)),s.arc(0,0,l,f,d,g));else{var m,y,v=d,b=f,x=d,w=f,k=p,_=p,S=o.apply(this,arguments)/2,A=S>ZU&&(r?+r.apply(this,arguments):$U(l*l+h*h)),C=XU(qU(h-l)/2,+n.apply(this,arguments)),E=C,T=C;if(A>ZU){var N=eW(A/l*KU(S)),D=eW(A/h*KU(S));(k-=2*N)>ZU?(x+=N*=g?1:-1,w-=N):(k=0,x=w=(d+f)/2),(_-=2*D)>ZU?(v+=D*=g?1:-1,b-=D):(_=0,v=b=(d+f)/2)}var F=h*HU(v),I=h*KU(v),M=l*HU(w),O=l*KU(w);if(C>ZU){var R,z=h*HU(b),B=h*KU(b),L=l*HU(x),P=l*KU(x);if(p<QU&&(R=function(t,e,n,r,i,a,o,s){var c=n-t,u=r-e,l=o-i,h=s-a,d=h*c-l*u;if(!(d*d<ZU))return[t+(d=(l*(e-a)-h*(t-i))/d)*c,e+d*u]}(F,I,L,P,z,B,M,O))){var j=F-R[0],U=I-R[1],W=z-R[0],V=B-R[1],q=1/KU(function(t){return t>1?0:t<-1?QU:Math.acos(t)}((j*W+U*V)/($U(j*j+U*U)*$U(W*W+V*V)))/2),G=$U(R[0]*R[0]+R[1]*R[1]);E=XU(C,(l-G)/(q-1)),T=XU(C,(h-G)/(q+1))}}_>ZU?T>ZU?(m=RW(L,P,F,I,h,T,g),y=RW(z,B,M,O,h,T,g),s.moveTo(m.cx+m.x01,m.cy+m.y01),T<C?s.arc(m.cx,m.cy,T,GU(m.y01,m.x01),GU(y.y01,y.x01),!g):(s.arc(m.cx,m.cy,T,GU(m.y01,m.x01),GU(m.y11,m.x11),!g),s.arc(0,0,h,GU(m.cy+m.y11,m.cx+m.x11),GU(y.cy+y.y11,y.cx+y.x11),!g),s.arc(y.cx,y.cy,T,GU(y.y11,y.x11),GU(y.y01,y.x01),!g))):(s.moveTo(F,I),s.arc(0,0,h,v,b,!g)):s.moveTo(F,I),l>ZU&&k>ZU?E>ZU?(m=RW(M,O,z,B,l,-E,g),y=RW(F,I,L,P,l,-E,g),s.lineTo(m.cx+m.x01,m.cy+m.y01),E<C?s.arc(m.cx,m.cy,E,GU(m.y01,m.x01),GU(y.y01,y.x01),!g):(s.arc(m.cx,m.cy,E,GU(m.y01,m.x01),GU(m.y11,m.x11),!g),s.arc(0,0,l,GU(m.cy+m.y11,m.cx+m.x11),GU(y.cy+y.y11,y.cx+y.x11),g),s.arc(y.cx,y.cy,E,GU(y.y11,y.x11),GU(y.y01,y.x01),!g))):s.arc(0,0,l,w,x,g):s.lineTo(M,O)}else s.moveTo(0,0);if(s.closePath(),c)return s=null,c+""||null}return c.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-QU/2;return[HU(r)*n,KU(r)*n]},c.innerRadius=function(e){return arguments.length?(t="function"===typeof e?e:NW(+e),c):t},c.outerRadius=function(t){return arguments.length?(e="function"===typeof t?t:NW(+t),c):e},c.cornerRadius=function(t){return arguments.length?(n="function"===typeof t?t:NW(+t),c):n},c.padRadius=function(t){return arguments.length?(r=null==t?null:"function"===typeof t?t:NW(+t),c):r},c.startAngle=function(t){return arguments.length?(i="function"===typeof t?t:NW(+t),c):i},c.endAngle=function(t){return arguments.length?(a="function"===typeof t?t:NW(+t),c):a},c.padAngle=function(t){return arguments.length?(o="function"===typeof t?t:NW(+t),c):o},c.context=function(t){return arguments.length?(s=null==t?null:t,c):s},c}().startAngle((t=>t.startAngle||0)).endAngle((t=>t.endAngle||0)).padAngle((t=>t.padAngle||0)).innerRadius((t=>t.innerRadius||0)).outerRadius((t=>t.outerRadius||0)).cornerRadius((t=>t.cornerRadius||0)),OY=jW().x(DY).y1(FY).y0((t=>(t.y||0)+(t.height||0))).defined(IY),RY=jW().y(FY).x1(DY).x0((t=>(t.x||0)+(t.width||0))).defined(IY),zY=PW().x(DY).y(FY).defined(IY),BY=EY().x(DY).y(FY).width((t=>t.width||0)).height((t=>t.height||0)).cornerRadius((t=>NY(t.cornerRadiusTopLeft,t.cornerRadius)||0),(t=>NY(t.cornerRadiusTopRight,t.cornerRadius)||0),(t=>NY(t.cornerRadiusBottomRight,t.cornerRadius)||0),(t=>NY(t.cornerRadiusBottomLeft,t.cornerRadius)||0)),LY=function(t,e){var n=null;function r(){var r;if(n||(n=r=TW()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),r)return n=null,r+""||null}return t="function"===typeof t?t:NW(t||UW),e="function"===typeof e?e:NW(void 0===e?64:+e),r.type=function(e){return arguments.length?(t="function"===typeof e?e:NW(e),r):t},r.size=function(t){return arguments.length?(e="function"===typeof t?t:NW(+t),r):e},r.context=function(t){return arguments.length?(n=null==t?null:t,r):n},r}().type((t=>vY(t.shape||"circle"))).size((t=>NY(t.size,64))),PY=TY().x(DY).y(FY).defined(IY).size((t=>t.size||1));function jY(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function UY(t,e,n,r){return BY.context(t)(e,n,r)}var WY=1;function VY(){WY=1}function qY(t,e,n){var r=e.clip,i=t._defs,a=e.clip_id||(e.clip_id="clip"+WY++),o=i.clipping[a]||(i.clipping[a]={id:a});return wU(r)?o.path=r(null):jY(n)?o.path=UY(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+a+")"}function GY(t){this.clear(),t&&this.union(t)}function HY(t){this.mark=t,this.bounds=this.bounds||new GY}function YY(t){HY.call(this,t),this.items=this.items||[]}function XY(t){this._pending=0,this._loader=t||zV()}function KY(t){t._pending+=1}function $Y(t){t._pending-=1}function ZY(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){const r=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(r+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}(e,r):0))}return t}GY.prototype={clone(){return new GY(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){const r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(t,e,n){var{x1:r,y1:i,x2:a,y2:o}=this,s=Math.cos(t),c=Math.sin(t),u=e-e*s+n*c,l=n-e*c-n*s;return[s*r-c*i+u,c*r+s*i+l,s*r-c*o+u,c*r+s*o+l,s*a-c*i+u,c*a+s*i+l,s*a-c*o+u,c*a+s*o+l]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},AU(YY,HY),XY.prototype={pending(){return this._pending},sanitizeURL(t){const e=this;return KY(e),e._loader.sanitize(t,{context:"href"}).then((t=>($Y(e),t))).catch((()=>($Y(e),null)))},loadImage(t){const e=this,n=Qd();return KY(e),e._loader.sanitize(t,{context:"image"}).then((t=>{const r=t.href;if(!r||!n)throw{url:r};const i=new n,a=SU(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=a&&(i.crossOrigin=a),i.onload=()=>$Y(e),i.onerror=()=>$Y(e),i.src=r,i})).catch((t=>($Y(e),{complete:!1,width:0,height:0,src:t&&t.url||""})))},ready(){const t=this;return new Promise((e=>{!function n(r){t.pending()?setTimeout((()=>{n(!0)}),10):e(r)}(!1)}))}};const QY=oY-1e-8;let JY,tX,eX,nX,rX,iX,aX,oX;const sX=(t,e)=>JY.add(t,e),cX=(t,e)=>sX(tX=t,eX=e),uX=t=>sX(t,JY.y1),lX=t=>sX(JY.x1,t),hX=(t,e)=>rX*t+aX*e,dX=(t,e)=>iX*t+oX*e,fX=(t,e)=>sX(hX(t,e),dX(t,e)),pX=(t,e)=>cX(hX(t,e),dX(t,e));function gX(t,e){return JY=t,e?(nX=e*iY,rX=oX=Math.cos(nX),iX=Math.sin(nX),aX=-iX):(rX=oX=1,nX=iX=aX=0),mX}const mX={beginPath(){},closePath(){},moveTo:pX,lineTo:pX,rect(t,e,n,r){nX?(fX(t+n,e),fX(t+n,e+r),fX(t,e+r),pX(t,e)):(sX(t+n,e+r),cX(t,e))},quadraticCurveTo(t,e,n,r){const i=hX(t,e),a=dX(t,e),o=hX(n,r),s=dX(n,r);yX(tX,i,o,uX),yX(eX,a,s,lX),cX(o,s)},bezierCurveTo(t,e,n,r,i,a){const o=hX(t,e),s=dX(t,e),c=hX(n,r),u=dX(n,r),l=hX(i,a),h=dX(i,a);vX(tX,o,c,l,uX),vX(eX,s,u,h,lX),cX(l,h)},arc(t,e,n,r,i,a){if(r+=nX,i+=nX,tX=n*Math.cos(i)+t,eX=n*Math.sin(i)+e,Math.abs(i-r)>QY)sX(t-n,e-n),sX(t+n,e+n);else{const o=r=>sX(n*Math.cos(r)+t,n*Math.sin(r)+e);let s,c;if(o(r),o(i),i!==r)if((r%=oY)<0&&(r+=oY),(i%=oY)<0&&(i+=oY),i<r&&(a=!a,s=r,r=i,i=s),a)for(i-=oY,s=r-r%aY,c=0;c<4&&s>i;++c,s-=aY)o(s);else for(s=r-r%aY+aY,c=0;c<4&&s<i;++c,s+=aY)o(s)}}};function yX(t,e,n,r){const i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function vX(t,e,n,r,i){const a=r-t+3*e-3*n,o=t+n-2*e,s=t-e;let c,u=0,l=0;Math.abs(a)>1e-14?(c=o*o+s*a,c>=0&&(c=Math.sqrt(c),u=(-o+c)/a,l=(-o-c)/a)):u=.5*s/o,0<u&&u<1&&i(bX(u,t,e,n,r)),0<l&&l<1&&i(bX(l,t,e,n,r))}function bX(t,e,n,r,i){const a=1-t,o=a*a,s=t*t;return o*a*e+3*o*t*n+3*a*s*r+s*t*i}var xX=(xX=Zd(1,1))?xX.getContext("2d"):null;const wX=new GY;function kX(t){return function(e,n){if(!xX)return!0;t(xX,e),wX.clear().union(e.bounds).intersect(n).round();const{x1:r,y1:i,x2:a,y2:o}=wX;for(let t=i;t<=o;++t)for(let e=r;e<=a;++e)if(xX.isPointInPath(e,t))return!0;return!1}}function _X(t,e){return e.contains(t.x||0,t.y||0)}function SX(t,e){const n=t.x||0,r=t.y||0,i=t.width||0,a=t.height||0;return e.intersects(wX.set(n,r,n+i,r+a))}function AX(t,e){const n=t.x||0,r=t.y||0;return CX(e,n,r,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r)}function CX(t,e,n,r,i){const{x1:a,y1:o,x2:s,y2:c}=t,u=r-e,l=i-n;let h,d,f,p,g=0,m=1;for(p=0;p<4;++p){if(0===p&&(h=-u,d=-(a-e)),1===p&&(h=u,d=s-e),2===p&&(h=-l,d=-(o-n)),3===p&&(h=l,d=c-n),Math.abs(h)<1e-10&&d<0)return!1;if(f=d/h,h<0){if(f>m)return!1;f>g&&(g=f)}else if(h>0){if(f<g)return!1;f<m&&(m=f)}}return!0}function EX(t,e){t.globalCompositeOperation=e.blend||"source-over"}function TX(t,e){return null==t?e:t}function NX(t,e){const n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}function DX(t,e,n){return KH(n)?function(t,e,n){const r=n.width(),i=n.height();let a;if("radial"===e.gradient)a=t.createRadialGradient(n.x1+TX(e.x1,.5)*r,n.y1+TX(e.y1,.5)*i,Math.max(r,i)*TX(e.r1,0),n.x1+TX(e.x2,.5)*r,n.y1+TX(e.y2,.5)*i,Math.max(r,i)*TX(e.r2,.5));else{const o=TX(e.x1,0),s=TX(e.y1,0),c=TX(e.x2,1),u=TX(e.y2,0);if(o!==c&&s!==u&&r!==i){const n=Zd(Math.ceil(r),Math.ceil(i)),a=n.getContext("2d");return a.scale(r,i),a.fillStyle=NX(a.createLinearGradient(o,s,c,u),e.stops),a.fillRect(0,0,r,i),t.createPattern(n,"no-repeat")}a=t.createLinearGradient(n.x1+o*r,n.y1+s*i,n.x1+c*r,n.y1+u*i)}return NX(a,e.stops)}(t,n,e.bounds):n}function FX(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=DX(t,e,e.fill),!0)}var IX=[];function MX(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&((n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=DX(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||IX),t.lineDashOffset=e.strokeDashOffset||0),!0))}function OX(t,e){return t.zindex-e.zindex||t.index-e.index}function RX(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,a=[];for(n=0,r=i.length;n<r;++n)(e=i[n]).index=n,e.zindex&&a.push(e);return t.zdirty=!1,t.zitems=a.sort(OX)}function zX(t,e){var n,r,i=t.items;if(!i||!i.length)return;const a=RX(t);if(a&&a.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=a}for(n=0,r=i.length;n<r;++n)e(i[n])}function BX(t,e){var n,r,i=t.items;if(!i||!i.length)return null;const a=RX(t);for(a&&a.length&&(i=a),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===a)for(r=(i=t.items).length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function LX(t){return function(e,n,r){zX(n,(n=>{r&&!r.intersects(n.bounds)||jX(t,e,n,n)}))}}function PX(t){return function(e,n,r){!n.items.length||r&&!r.intersects(n.bounds)||jX(t,e,n.items[0],n.items)}}function jX(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||(EX(e,n),n.fill&&FX(e,n,i)&&e.fill(),n.stroke&&MX(e,n,i)&&e.stroke()))}function UX(t){return t=t||gU,function(e,n,r,i,a,o){return r*=e.pixelRatio,i*=e.pixelRatio,BX(n,(n=>{const s=n.bounds;if((!s||s.contains(a,o))&&s)return t(e,n,r,i,a,o)?n:void 0}))}}function WX(t,e){return function(n,r,i,a){var o,s,c=Array.isArray(r)?r[0]:r,u=null==e?c.fill:e,l=c.stroke&&n.isPointInStroke;return l&&(o=c.strokeWidth,s=c.strokeCap,n.lineWidth=null!=o?o:1,n.lineCap=null!=s?s:"butt"),!t(n,r)&&(u&&n.isPointInPath(i,a)||l&&n.isPointInStroke(i,a))}}function VX(t){return UX(WX(t))}function qX(t,e){return"translate("+t+","+e+")"}function GX(t){return"rotate("+t+")"}function HX(t){return qX(t.x||0,t.y||0)}function YX(t,e,n){function r(t,n){var r=n.x||0,i=n.y||0,a=n.angle||0;t.translate(r,i),a&&t.rotate(a*=iY),t.beginPath(),e(t,n),a&&t.rotate(-a),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",function(t){return qX(t.x||0,t.y||0)+(t.angle?" "+GX(t.angle):"")}(n)),t("d",e(null,n))},bound:function(t,n){return e(gX(t,n.angle),n),ZY(t,n).translate(n.x||0,n.y||0)},draw:LX(r),pick:VX(r),isect:n||kX(r)}}var XX=YX("arc",(function(t,e){return MY.context(t)(e)}));function KX(t,e,n){function r(t,n){t.beginPath(),e(t,n)}const i=WX(r);return{type:t,tag:"path",nested:!0,attr:function(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))},bound:function(t,n){var r=n.items;return 0===r.length?t:(e(gX(t),r),ZY(t,r[0]))},draw:PX(r),pick:function(t,e,n,r,a,o){var s=e.items,c=e.bounds;return!s||!s.length||c&&!c.contains(a,o)?null:(n*=t.pixelRatio,r*=t.pixelRatio,i(t,s,n,r)?s[0]:null)},isect:_X,tip:n}}var $X=KX("area",(function(t,e){const n=e[0],r=n.interpolate||"linear";return("horizontal"===n.orient?RY:OY).curve(tY(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i="horizontal"===t[0].orient?e[1]:e[0],a="horizontal"===t[0].orient?"y":"x",o=t.length,s=1/0;--o>=0;)!1!==t[o].defined&&(r=Math.abs(t[o][a]-i))<s&&(s=r,n=t[o]);return n}));function ZX(t,e){t.beginPath(),jY(e)?UY(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function QX(t){const e=TX(t.strokeWidth,1);return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function JX(t,e){const n=QX(e);t("d",UY(null,e,n,n))}function tK(t,e,n,r){const i=QX(e);t.beginPath(),UY(t,e,(n||0)+i,(r||0)+i)}const eK=WX(tK),nK=WX(tK,!1),rK=WX(tK,!0);var iK={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",HX(e))},bound:function(t,e){if(!e.clip&&e.items){const n=e.items,r=n.length;for(let e=0;e<r;++e)t.union(n[e].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),ZY(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n){zX(e,(e=>{const r=e.x||0,i=e.y||0,a=e.strokeForeground,o=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&o&&(tK(t,e,r,i),EX(t,e),e.fill&&FX(t,e,o)&&t.fill(),e.stroke&&!a&&MX(t,e,o)&&t.stroke()),t.save(),t.translate(r,i),e.clip&&ZX(t,e),n&&n.translate(-r,-i),zX(e,(e=>{this.draw(t,e,n)})),n&&n.translate(r,i),t.restore(),a&&e.stroke&&o&&(tK(t,e,r,i),EX(t,e),MX(t,e,o)&&t.stroke())}))},pick:function(t,e,n,r,i,a){if(e.bounds&&!e.bounds.contains(i,a)||!e.items)return null;const o=n*t.pixelRatio,s=r*t.pixelRatio;return BX(e,(c=>{let u,l,h;const d=c.bounds;if(d&&!d.contains(i,a))return;l=c.x||0,h=c.y||0;const f=l+(c.width||0),p=h+(c.height||0),g=c.clip;if(g&&(i<l||i>f||a<h||a>p))return;if(t.save(),t.translate(l,h),l=i-l,h=a-h,g&&jY(c)&&!rK(t,c,o,s))return t.restore(),null;const m=c.strokeForeground,y=!1!==e.interactive;return y&&m&&c.stroke&&nK(t,c,o,s)?(t.restore(),c):(u=BX(c,(t=>function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}(t,l,h)?this.pick(t,n,r,l,h):null)),!u&&y&&(c.fill||!m&&c.stroke)&&eK(t,c,o,s)&&(u=c),t.restore(),u||null)}))},isect:SX,content:function(t,e,n){t("clip-path",e.clip?qY(n,e,e):null)},background:function(t,e){t("class","background"),t("aria-hidden",!0),JX(t,e)},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?JX(t,e):t("d","")}},aK={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function oK(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then((e=>{t.image=e,t.image.url=t.url}))),n}function sK(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function cK(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function uK(t,e){return"center"===t?e/2:"right"===t?e:0}function lK(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var hK={type:"image",tag:"image",nested:!1,attr:function(t,e,n){const r=oK(e,n),i=sK(e,r),a=cK(e,r),o=(e.x||0)-uK(e.align,i),s=(e.y||0)-lK(e.baseline,a);t("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",aK["xmlns:xlink"],"xlink:href"),t("transform",qX(o,s)),t("width",i),t("height",a),t("preserveAspectRatio",!1===e.aspect?"none":"xMidYMid")},bound:function(t,e){const n=e.image,r=sK(e,n),i=cK(e,n),a=(e.x||0)-uK(e.align,r),o=(e.y||0)-lK(e.baseline,i);return t.set(a,o,a+r,o+i)},draw:function(t,e,n){zX(e,(e=>{if(n&&!n.intersects(e.bounds))return;const r=oK(e,this);let i=sK(e,r),a=cK(e,r);if(0===i||0===a)return;let o,s,c,u,l=(e.x||0)-uK(e.align,i),h=(e.y||0)-lK(e.baseline,a);!1!==e.aspect&&(s=r.width/r.height,c=e.width/e.height,s===s&&c===c&&s!==c&&(c<s?(u=i/s,h+=(a-u)/2,a=u):(u=a*s,l+=(i-u)/2,i=u))),(r.complete||r.toDataURL)&&(EX(t,e),t.globalAlpha=null!=(o=e.opacity)?o:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(r,l,h,i,a))}))},pick:UX(),isect:gU,get:oK,xOffset:uK,yOffset:lK},dK=KX("line",(function(t,e){const n=e[0],r=n.interpolate||"linear";return zY.curve(tY(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i=Math.pow(t[0].strokeWidth||1,2),a=t.length;--a>=0;)if(!1!==t[a].defined&&(n=t[a].x-e[0])*n+(r=t[a].y-e[1])*r<i)return t[a];return null}));function fK(t,e){var n=e.path;if(null==n)return!0;var r=e.x||0,i=e.y||0,a=e.scaleX||1,o=e.scaleY||1,s=(e.angle||0)*iY,c=e.pathCache;c&&c.path===n||((e.pathCache=c=rY(n)).path=n),s&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(s),pY(t,c,0,0,a,o),t.rotate(-s),t.translate(-r,-i)):pY(t,c,r,i,a,o)}var pK={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,r=e.scaleY||1;1===n&&1===r||t("vector-effect","non-scaling-stroke"),t("transform",function(t){return qX(t.x||0,t.y||0)+(t.angle?" "+GX(t.angle):"")+(t.scaleX||t.scaleY?" "+function(t,e){return"scale("+t+","+e+")"}(t.scaleX||1,t.scaleY||1):"")}(e)),t("d",e.path)},bound:function(t,e){return fK(gX(t,e.angle),e)?t.set(0,0,0,0):ZY(t,e,!0)},draw:LX(fK),pick:VX(fK),isect:kX(fK)};function gK(t,e){t.beginPath(),UY(t,e)}var mK={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",UY(null,e))},bound:function(t,e){var n,r;return ZY(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:LX(gK),pick:VX(gK),isect:SX};function yK(t,e,n){var r,i,a,o;return!(!e.stroke||!MX(t,e,n))&&(r=e.x||0,i=e.y||0,a=null!=e.x2?e.x2:r,o=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(a,o),!0)}var vK={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",HX(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return ZY(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)},draw:function(t,e,n){zX(e,(e=>{if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&yK(t,e,r)&&(EX(t,e),t.stroke())}}))},pick:UX((function(t,e,n,r){return!!t.isPointInStroke&&(yK(t,e,1)&&t.isPointInStroke(n,r))})),isect:AX},bK=YX("shape",(function(t,e){return(e.mark.shape||e.shape).context(t)(e)})),xK=YX("symbol",(function(t,e){return LY.context(t)(e)}),_X);const wK=function(t){let e,n,r;t=+t||1e4;const i=()=>{e={},n={},r=0},a=(i,a)=>(++r>t&&(n=e,e={},r=1),e[i]=a);return i(),{clear:i,has:t=>SU(e,t)||SU(n,t),get:t=>SU(e,t)?e[t]:SU(n,t)?a(t,n[t]):void 0,set:(t,n)=>SU(e,t)?e[t]=n:a(t,n)}}();var kK={height:TK,measureWidth:CK,estimateWidth:SK,width:SK,canvas:_K};function _K(t){kK.width=t&&xX?CK:SK}function SK(t,e){return AK(IK(t,e),TK(t))}function AK(t,e){return~~(.8*t.length*e)}function CK(t,e){return TK(t)<=0||!(e=IK(t,e))?0:EK(e,OK(t))}function EK(t,e){const n="(".concat(e,") ").concat(t);let r=wK.get(n);return void 0===r&&(xX.font=e,r=xX.measureText(t).width,wK.set(n,r)),r}function TK(t){return null!=t.fontSize?+t.fontSize||0:11}function NK(t){return null!=t.lineHeight?t.lineHeight:TK(t)+2}function DK(t){return e=t.lineBreak&&t.text&&!mU(t.text)?t.text.split(t.lineBreak):t.text,mU(e)?e.length>1?e:e[0]:e;var e}function FK(t){const e=DK(t);return(mU(e)?e.length-1:0)*NK(t)}function IK(t,e){const n=null==e?"":(e+"").trim();return t.limit>0&&n.length?function(t,e){var n=+t.limit,r=function(t){if(kK.width===CK){const e=OK(t);return t=>EK(t,e)}{const e=TK(t);return t=>AK(t,e)}}(t);if(r(e)<n)return e;var i,a=t.ellipsis||"\u2026",o="rtl"===t.dir,s=0,c=e.length;if(n-=r(a),o){for(;s<c;)i=s+c>>>1,r(e.slice(i))>n?s=i+1:c=i;return a+e.slice(s)}for(;s<c;)i=1+(s+c>>>1),r(e.slice(0,i))<n?s=i:c=i-1;return e.slice(0,s)+a}(t,n):n}function MK(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function OK(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+TK(t)+"px "+MK(t,e)}function RK(t){var e=t.baseline,n=TK(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*NK(t):"line-bottom"===e?.29*n-.5*NK(t):0)}_K(!0);const zK={left:"start",center:"middle",right:"end"},BK=new GY;function LK(t){var e,n=t.x||0,r=t.y||0,i=t.radius||0;return i&&(e=(t.theta||0)-aY,n+=i*Math.cos(e),r+=i*Math.sin(e)),BK.x1=n,BK.y1=r,BK}function PK(t,e,n){var r,i=kK.height(e),a=e.align,o=LK(e),s=o.x1,c=o.y1,u=e.dx||0,l=(e.dy||0)+RK(e)-Math.round(.8*i),h=DK(e);if(mU(h)?(i+=NK(e)*(h.length-1),r=h.reduce(((t,n)=>Math.max(t,kK.width(e,n))),0)):r=kK.width(e,h),"center"===a?u-=r/2:"right"===a&&(u-=r),t.set(u+=s,l+=c,u+r,l+i),e.angle&&!n)t.rotate(e.angle*iY,s,c);else if(2===n)return t.rotatedPoints(e.angle*iY,s,c);return t}var jK={type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,i=(e.dy||0)+RK(e),a=LK(e),o=a.x1,s=a.y1,c=e.angle||0;t("text-anchor",zK[e.align]||"start"),c?(n=qX(o,s)+" "+GX(c),(r||i)&&(n+=" "+qX(r,i))):n=qX(o+r,s+i),t("transform",n)},bound:PK,draw:function(t,e,n){zX(e,(e=>{var r,i,a,o,s,c,u,l=null==e.opacity?1:e.opacity;if(!(n&&!n.intersects(e.bounds)||0===l||e.fontSize<=0||null==e.text||0===e.text.length)){if(t.font=OK(e),t.textAlign=e.align||"left",i=(r=LK(e)).x1,a=r.y1,e.angle&&(t.save(),t.translate(i,a),t.rotate(e.angle*iY),i=a=0),i+=e.dx||0,a+=(e.dy||0)+RK(e),c=DK(e),EX(t,e),mU(c))for(s=NK(e),o=0;o<c.length;++o)u=IK(e,c[o]),e.fill&&FX(t,e,l)&&t.fillText(u,i,a),e.stroke&&MX(t,e,l)&&t.strokeText(u,i,a),a+=s;else u=IK(e,c),e.fill&&FX(t,e,l)&&t.fillText(u,i,a),e.stroke&&MX(t,e,l)&&t.strokeText(u,i,a);e.angle&&t.restore()}}))},pick:UX((function(t,e,n,r,i,a){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var o=LK(e),s=o.x1,c=o.y1,u=PK(BK,e,1),l=-e.angle*iY,h=Math.cos(l),d=Math.sin(l),f=h*i-d*a+(s-h*s+d*c),p=d*i+h*a+(c-d*s-h*c);return u.contains(f,p)})),isect:function(t,e){const n=PK(BK,t,2);return CX(e,n[0],n[1],n[2],n[3])||CX(e,n[0],n[1],n[4],n[5])||CX(e,n[4],n[5],n[6],n[7])||CX(e,n[2],n[3],n[6],n[7])}},UK=KX("trail",(function(t,e){return PY.context(t)(e)}),(function(t,e){for(var n,r,i=t.length;--i>=0;)if(!1!==t[i].defined&&(n=t[i].x-e[0])*n+(r=t[i].y-e[1])*r<(n=t[i].size||1)*n)return t[i];return null})),WK={arc:XX,area:$X,group:iK,image:hK,line:dK,path:pK,rect:mK,rule:vK,shape:bK,symbol:xK,text:jK,trail:UK};function VK(t,e,n){var r=WK[t.mark.marktype],i=e||r.bound;return r.nested&&(t=t.mark),i(t.bounds||(t.bounds=new GY),t,n)}var qK={mark:null};function GK(t,e,n){var r,i,a,o,s=WK[t.marktype],c=s.bound,u=t.items,l=u&&u.length;if(s.nested)return l?a=u[0]:(qK.mark=t,a=qK),o=VK(a,c,n),e=e&&e.union(o)||o;if(e=e||t.bounds&&t.bounds.clear()||new GY,l)for(r=0,i=u.length;r<i;++r)e.union(VK(u[r],c,n));return t.bounds=e}const HK=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function YK(t,e){return JSON.stringify(t,HK,e)}function XK(t){return KK("string"===typeof t?JSON.parse(t):t)}function KK(t){var e,n,r,i=t.marktype,a=t.items;if(a)for(n=0,r=a.length;n<r;++n)e=i?"mark":"group",a[n][e]=t,a[n].zindex&&(a[n][e].zdirty=!0),"group"===(i||e)&&KK(a[n]);return i&&GK(t),t}function $K(t){arguments.length?this.root=XK(t):(this.root=ZK({marktype:"group",name:"root",role:"frame"}),this.root.items=[new YY(this.root)])}function ZK(t,e){const n={bounds:new GY,clip:!!t.clip,group:e,interactive:!1!==t.interactive,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0};return null!=t.aria&&(n.aria=t.aria),t.description&&(n.description=t.description),n}function QK(t,e,n){return!t&&"undefined"!==typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function JK(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function t$(t,e,n,r){var i,a=t.childNodes[e];return a&&a.tagName.toLowerCase()===n.toLowerCase()||(i=a||null,a=QK(t.ownerDocument,n,r),t.insertBefore(a,i)),a}function e$(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function n$(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function r$(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function i$(t,e){this._active=null,this._handlers={},this._loader=t||zV(),this._tooltip=e||a$}function a$(t,e,n,r){t.element().setAttribute("title",r||"")}function o$(t){this._el=null,this._bgcolor=null,this._loader=new XY(t)}$K.prototype={toJSON(t){return YK(this.root,t||0)},mark(t,e,n){const r=ZK(t,e=e||this.root.items[0]);return e.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}},i$.prototype={initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},scene(t){return arguments.length?(this._scene=t,this):this._scene},on(){},off(){},_handlerIndex(t,e,n){for(let r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},handlers(t){const e=this._handlers,n=[];if(t)n.push(...e[this.eventName(t)]);else for(const r in e)n.push(...e[r]);return n},eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then((e=>{const n=new MouseEvent(t.type,t),r=QK(null,"a");for(const t in e)r.setAttribute(t,e[t]);r.dispatchEvent(n)})).catch((()=>{}))},handleTooltip(t,e,n){if(e&&null!=e.tooltip){e=function(t,e,n,r){var i,a,o=t&&t.mark;if(o&&(i=WK[o.marktype]).tip){for((a=r$(e,n))[0]-=r[0],a[1]-=r[1];t=t.mark.group;)a[0]-=t.x||0,a[1]-=t.y||0;t=i.tip(o.items,a)}return t}(e,t,this.canvas(),this._origin);const r=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,r)}},getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,a=i.width(),o=i.height();let s=i.x1+r[0]+n.left,c=i.y1+r[1]+n.top;for(;t.mark&&(t=t.mark.group);)s+=t.x||0,c+=t.y||0;return{x:s,y:c,width:a,height:o,left:s,top:c,right:s+a,bottom:c+o}}},o$.prototype={initialize(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)},resize(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(t){const e=this;return e._call=function(){e._render(t)},e._call(),e._call=null,e},_render(){},renderAsync(t){const e=this.render(t);return this._ready?this._ready.then((()=>e)):Promise.resolve(e)},_load(t,e){var n=this,r=n._loader[t](e);if(!n._ready){const t=n._call;n._ready=n._loader.ready().then((e=>{e&&t(),n._ready=null}))}return r},sanitizeURL(t){return this._load("sanitizeURL",t)},loadImage(t){return this._load("loadImage",t)}};const s$="dragenter",c$="dragleave",u$="dragover",l$="mousedown",h$="mousemove",d$="mouseout",f$="mouseover",p$="click",g$="mousewheel",m$="touchstart",y$="touchmove",v$="touchend",b$=h$,x$=d$,w$=p$;function k$(t,e){i$.call(this,t,e),this._down=null,this._touch=null,this._first=!0,this._events={}}function _$(t,e){(t=>t===m$||t===y$||t===v$?[m$,y$,v$]:[t])(e).forEach((e=>function(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n)))}(t,e)))}function S$(t,e,n){return function(r){const i=this._active,a=this.pickEvent(r);a===i||(i&&i.exit||this.fire(n,r),this._active=a,this.fire(e,r)),this.fire(t,r)}}function A$(t){return function(e){this.fire(t,e),this._active=null}}AU(k$,i$,{initialize(t,e,n){return this._canvas=t&&JK(t,"canvas"),[p$,l$,h$,d$,c$].forEach((t=>_$(this,t))),i$.prototype.initialize.call(this,t,e,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",s$,c$,u$,l$,"mouseup",h$,d$,f$,p$,"dblclick","wheel",g$,m$,y$,v$],DOMMouseScroll(t){this.fire(g$,t)},mousemove:S$(h$,f$,d$),dragover:S$(u$,s$,c$),mouseout:A$(d$),dragleave:A$(c$),mousedown(t){this._down=this._active,this.fire(l$,t)},click(t){this._down===this._active&&(this.fire(p$,t),this._down=null)},touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(m$,t,!0)},touchmove(t){this.fire(y$,t,!0)},touchend(t){this.fire(v$,t,!0),this._touch=null},fire(t,e,n){const r=n?this._touch:this._active,i=this._handlers[t];if(e.vegaType=t,t===w$&&r&&r.href?this.handleHref(e,r,r.href):t!==b$&&t!==x$||this.handleTooltip(e,r,t!==x$),i)for(let a=0,o=i.length;a<o;++a)i[a].handler.call(this._obj,e,r)},on(t,e){const n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(_$(this,t),(r[n]||(r[n]=[])).push({type:t,handler:e})),this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this},pickEvent(t){const e=r$(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pick(t,e,n,r,i){const a=this.context();return WK[t.marktype].pick.call(this,a,t,e,n,r,i)}});var C$="undefined"!==typeof window&&window.devicePixelRatio||1;function E$(t){o$.call(this,t),this._options={},this._redraw=!1,this._dirty=new GY,this._tempb=new GY}const T$=o$.prototype;function N$(t,e){i$.call(this,t,e);const n=this;n._hrefHandler=D$(n,((t,e)=>{e&&e.href&&n.handleHref(t,e,e.href)})),n._tooltipHandler=D$(n,((t,e)=>{n.handleTooltip(t,e,t.type!==x$)}))}AU(E$,o$,{initialize(t,e,n,r,i,a){return this._options=a||{},this._canvas=this._options.externalContext?null:Zd(1,1,this._options.type),t&&this._canvas&&(e$(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),T$.initialize.call(this,t,e,n,r,i)},resize(t,e,n,r){if(T$.resize.call(this,t,e,n,r),this._canvas)!function(t,e,n,r,i,a){const o="undefined"!==typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,s=t.getContext("2d"),c=o?C$:i;t.width=e*c,t.height=n*c;for(const u in a)s[u]=a[u];o&&1!==c&&(t.style.width=e+"px",t.style.height=n+"px"),s.pixelRatio=c,s.setTransform(c,0,0,c,c*r[0],c*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const t=this._options.externalContext;t||hU("CanvasRenderer is missing a valid canvas or context"),t.scale(this._scale,this._scale),t.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)},_render(t){const e=this.context(),n=this._origin,r=this._width,i=this._height,a=this._dirty,o=((t,e,n)=>(new GY).set(0,0,e,n).translate(-t[0],-t[1]))(n,r,i);e.save();const s=this._redraw||a.empty()?(this._redraw=!1,o.expand(1)):function(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}(e,o.intersect(a),n);return this.clear(-n[0],-n[1],r,i),this.draw(e,t,s),e.restore(),a.clear(),this},draw(t,e,n){const r=WK[e.marktype];e.clip&&function(t,e){var n=e.clip;t.save(),wU(n)?(t.beginPath(),n(t),t.clip()):ZX(t,e.group)}(t,e),r.draw.call(this,t,e,n),e.clip&&t.restore()},clear(t,e,n,r){const i=this._options,a=this.context();"pdf"===i.type||i.externalContext||a.clearRect(t,e,n,r),null!=this._bgcolor&&(a.fillStyle=this._bgcolor,a.fillRect(t,e,n,r))}});const D$=(t,e)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,e.call(t._obj,n,r)};AU(N$,i$,{initialize(t,e,n){let r=this._svg;return r&&(r.removeEventListener(w$,this._hrefHandler),r.removeEventListener(b$,this._tooltipHandler),r.removeEventListener(x$,this._tooltipHandler)),this._svg=r=t&&JK(t,"svg"),r&&(r.addEventListener(w$,this._hrefHandler),r.addEventListener(b$,this._tooltipHandler),r.addEventListener(x$,this._tooltipHandler)),i$.prototype.initialize.call(this,t,e,n)},canvas(){return this._svg},on(t,e){const n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){const i={type:t,handler:e,listener:D$(this,e)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const F$="aria-hidden",I$="aria-label",M$="role",O$="aria-roledescription",R$="graphics-object",z$="graphics-symbol",B$=(t,e,n)=>({[M$]:t,[O$]:e,[I$]:n||void 0}),L$=NU(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),P$={axis:{desc:"axis",caption:function(t){const e=t.datum,n=t.orient,r=e.title?q$(t):null,i=t.context,a=i.scales[e.scale].value,o=i.dataflow.locale(),s=a.type,c="left"===n||"right"===n?"Y":"X";return"".concat(c,"-axis")+(r?" titled '".concat(r,"'"):"")+" for a ".concat(wH(s)?"discrete":s," scale")+" with ".concat(HH(o,a,t))}},legend:{desc:"legend",caption:function(t){const e=t.datum,n=e.title?q$(t):null,r="".concat(e.type||""," legend").trim(),i=e.scales,a=Object.keys(i),o=t.context,s=o.scales[i[a[0]]].value,c=o.dataflow.locale();return function(t){return t.length?t[0].toUpperCase()+t.slice(1):t}(r)+(n?" titled '".concat(n,"'"):"")+" for ".concat(function(t){return t=t.map((t=>t+("fill"===t||"stroke"===t?" color":""))),t.length<2?t[0]:t.slice(0,-1).join(", ")+" and "+vU(t)}(a))+" with ".concat(HH(c,s,t))}},"title-text":{desc:"title",caption:t=>"Title text '".concat(V$(t),"'")},"title-subtitle":{desc:"subtitle",caption:t=>"Subtitle text '".concat(V$(t),"'")}},j$={ariaRole:M$,ariaRoleDescription:O$,description:I$};function U$(t,e){const n=!1===e.aria;if(t(F$,n||void 0),n||null==e.description)for(const r in j$)t(j$[r],void 0);else{const n=e.mark.marktype;t(I$,e.description),t(M$,e.ariaRole||("group"===n?R$:z$)),t(O$,e.ariaRoleDescription||"".concat(n," mark"))}}function W$(t){return!1===t.aria?{[F$]:!0}:L$[t.role]?null:P$[t.role]?function(t,e){try{const n=t.items[0],r=e.caption||(()=>"");return B$(e.role||z$,e.desc,n.description||r(n))}catch(n){return null}}(t,P$[t.role]):function(t){const e=t.marktype,n="group"===e||"text"===e||t.items.some((t=>null!=t.description&&!1!==t.aria));return B$(n?R$:z$,"".concat(e," mark container"),t.description)}(t)}function V$(t){return xU(t.text).join(" ")}function q$(t){try{return xU(vU(t.items).items[0].text).join(" ")}catch(e){return null}}const G$=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),H$=t=>G$(t).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function Y$(){let t="",e="",n="";const r=[],i=()=>e=n="",a=(t,n)=>(null!=n&&(e+=" ".concat(t,'="').concat(H$(n),'"')),o),o={open(s){(a=>{e&&(t+="".concat(e,">").concat(n),i()),r.push(a)})(s),e="<"+s;for(var c=arguments.length,u=new Array(c>1?c-1:0),l=1;l<c;l++)u[l-1]=arguments[l];for(const t of u)for(const e in t)a(e,t[e]);return o},close(){const a=r.pop();return t+=e?e+(n?">".concat(n,"</").concat(a,">"):"/>"):"</".concat(a,">"),i(),o},attr:a,text:t=>(n+=G$(t),o),toString:()=>t};return o}const X$=t=>K$(Y$(),t)+"";function K$(t,e){if(t.open(e.tagName),e.hasAttributes()){const n=e.attributes,r=n.length;for(let e=0;e<r;++e)t.attr(n[e].name,n[e].value)}if(e.hasChildNodes()){const n=e.childNodes,r=n.length;for(let e=0;e<r;e++){const r=n[e];3===r.nodeType?t.text(r.nodeValue):K$(t,r)}}return t.close()}const $$={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},Z$={fill:"none","stroke-miterlimit":10},Q$="http://www.w3.org/2000/xmlns/",J$=aK.xmlns;function tZ(t){o$.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const eZ=o$.prototype;function nZ(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function rZ(t,e,n){let r,i,a;if("radial"===e.gradient){let r=t$(t,n++,"pattern",J$);hZ(r,{id:XH+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=t$(r,0,"rect",J$),hZ(r,{width:1,height:1,fill:"url(".concat(fZ(),"#").concat(e.id,")")}),hZ(t=t$(t,n++,"radialGradient",J$),{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else hZ(t=t$(t,n++,"linearGradient",J$),{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(r=0,i=e.stops.length;r<i;++r)a=t$(t,r,"stop",J$),a.setAttribute("offset",e.stops[r].offset),a.setAttribute("stop-color",e.stops[r].color);return e$(t,r),n}function iZ(t,e,n){let r;return(t=t$(t,n,"clipPath",J$)).setAttribute("id",e.id),e.path?(r=t$(t,0,"path",J$),r.setAttribute("d",e.path)):(r=t$(t,0,"rect",J$),hZ(r,{x:0,y:0,width:e.width,height:e.height})),e$(t,1),n+1}function aZ(t,e,n,r,i){let a,o=t._svg;if(!o&&(a=e.ownerDocument,o=QK(a,r,J$),t._svg=o,t.mark&&(o.__data__=t,o.__values__={fill:"default"},"g"===r))){const e=QK(a,"path",J$);o.appendChild(e),e.__data__=t;const n=QK(a,"g",J$);o.appendChild(n),n.__data__=t;const r=QK(a,"path",J$);o.appendChild(r),r.__data__=t,r.__values__={fill:"default"}}return(o.ownerSVGElement!==i||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}(o,n))&&e.insertBefore(o,n?n.nextSibling:e.firstChild),o}AU(tZ,o$,{initialize(t,e,n,r,i){return this._defs={},this._clearDefs(),t&&(this._svg=t$(t,0,"svg",J$),this._svg.setAttributeNS(Q$,"xmlns",J$),this._svg.setAttributeNS(Q$,"xmlns:xlink",aK["xmlns:xlink"]),this._svg.setAttribute("version",aK.version),this._svg.setAttribute("class","marks"),e$(t,1),this._root=t$(this._svg,0,"g",J$),hZ(this._root,Z$),e$(this._svg,1)),this.background(this._bgcolor),eZ.initialize.call(this,t,e,n,r,i)},background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),eZ.background.apply(this,arguments)},resize(t,e,n,r){return eZ.resize.call(this,t,e,n,r),this._svg&&(hZ(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas(){return this._svg},svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=t$(t,0,"rect",J$),hZ(n,{width:this._width,height:this._height,fill:e}));const r=X$(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),r},_render(t){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t),e$(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},isDirty(t){return this._dirtyAll||!t._svg||t.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const e=++this._dirtyID;let n,r,i,a,o,s,c;for(o=0,s=t.length;o<s;++o)n=t[o],r=n.mark,r.marktype!==i&&(i=r.marktype,a=WK[i]),r.zdirty&&r.dirty!==e&&(this._dirtyAll=!1,nZ(n,e),r.items.forEach((t=>{t.dirty=e}))),r.zdirty||(n.exit?(a.nested&&r.items.length?(c=r.items[0],c._svg&&this._update(a,c._svg,c)):n._svg&&(c=n._svg.parentNode,c&&c.removeChild(n._svg)),n._svg=null):(n=a.nested?r.items[0]:n,n._update!==e&&(n._svg&&n._svg.ownerSVGElement?this._update(a,n._svg,n):(this._dirtyAll=!1,nZ(n,e)),n._update=e)));return!this._dirtyAll},mark(t,e,n){if(!this.isDirty(e))return e._svg;const r=this._svg,i=WK[e.marktype],a=!1===e.interactive?"none":null,o="g"===i.tag;let s=null,c=0;const u=aZ(e,t,n,"g",r);u.setAttribute("class",n$(e));const l=W$(e);for(const d in l)dZ(u,d,l[d]);o||dZ(u,"pointer-events",a),dZ(u,"clip-path",e.clip?qY(this,e,e.group):null);const h=t=>{const e=this.isDirty(t),n=aZ(t,u,s,i.tag,r);e&&(this._update(i,n,t),o&&function(t,e,n){e=e.lastChild.previousSibling;let r,i=0;zX(n,(n=>{r=t.mark(e,n,r),++i})),e$(e,1+i)}(this,n,t)),s=n,++c};return i.nested?e.items.length&&h(e.items[0]):zX(e,h),e$(u,c),u},_update(t,e,n){oZ=e,sZ=e.__values__,U$(uZ,n),t.attr(uZ,n,this);const r=cZ[t.type];r&&r.call(this,t,e,n),oZ&&this.style(oZ,n)},style(t,e){if(null!=e)for(const n in $$){let r="font"===n?MK(e):e[n];if(r===sZ[n])continue;const i=$$[n];null==r?t.removeAttribute(i):(KH(r)&&(r=$H(r,this._defs.gradient,fZ())),t.setAttribute(i,r+"")),sZ[n]=r}},defs(){const t=this._svg,e=this._defs;let n=e.el,r=0;for(const i in e.gradient)n||(e.el=n=t$(t,1,"defs",J$)),r=rZ(n,e.gradient[i],r);for(const i in e.clipping)n||(e.el=n=t$(t,1,"defs",J$)),r=iZ(n,e.clipping[i],r);n&&(0===r?(t.removeChild(n),e.el=null):e$(n,r))},_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}});let oZ=null,sZ=null;const cZ={group(t,e,n){const r=oZ=e.childNodes[2];sZ=r.__values__,t.foreground(uZ,n,this),sZ=e.__values__,oZ=e.childNodes[1],t.content(uZ,n,this);const i=oZ=e.childNodes[0];t.background(uZ,n,this);const a=!1===n.mark.interactive?"none":null;if(a!==sZ.events&&(dZ(r,"pointer-events",a),dZ(i,"pointer-events",a),sZ.events=a),n.strokeForeground&&n.stroke){const t=n.fill;dZ(r,"display",null),this.style(i,n),dZ(i,"stroke",null),t&&(n.fill=null),sZ=r.__values__,this.style(r,n),t&&(n.fill=t),oZ=null}else dZ(r,"display","none")},image(t,e,n){!1===n.smooth?(lZ(e,"image-rendering","optimizeSpeed"),lZ(e,"image-rendering","pixelated")):lZ(e,"image-rendering",null)},text(t,e,n){const r=DK(n);let i,a,o,s;mU(r)?(a=r.map((t=>IK(n,t))),i=a.join("\n"),i!==sZ.text&&(e$(e,0),o=e.ownerDocument,s=NK(n),a.forEach(((t,r)=>{const i=QK(o,"tspan",J$);i.__data__=n,i.textContent=t,r&&(i.setAttribute("x",0),i.setAttribute("dy",s)),e.appendChild(i)})),sZ.text=i)):(a=IK(n,r),a!==sZ.text&&(e.textContent=a,sZ.text=a)),dZ(e,"font-family",MK(n)),dZ(e,"font-size",TK(n)+"px"),dZ(e,"font-style",n.fontStyle),dZ(e,"font-variant",n.fontVariant),dZ(e,"font-weight",n.fontWeight)}};function uZ(t,e,n){e!==sZ[t]&&(n?function(t,e,n,r){null!=n?t.setAttributeNS(r,e,n):t.removeAttributeNS(r,e)}(oZ,t,e,n):dZ(oZ,t,e),sZ[t]=e)}function lZ(t,e,n){n!==sZ[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),sZ[e]=n)}function hZ(t,e){for(const n in e)dZ(t,n,e[n])}function dZ(t,e,n){null!=n?t.setAttribute(e,n):t.removeAttribute(e)}function fZ(){let t;return"undefined"===typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function pZ(t){o$.call(this,t),this._text=null,this._defs={gradient:{},clipping:{}}}AU(pZ,o$,{svg(){return this._text},_render(t){const e=Y$();e.open("svg",kU({},aK,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",Z$,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this},mark(t,e){const n=WK[e.marktype],r=n.tag,i=[U$,n.attr];t.open("g",{class:n$(e),"clip-path":e.clip?qY(this,e,e.group):null},W$(e),{"pointer-events":"g"!==r&&!1===e.interactive?"none":null});const a=a=>{const o=this.href(a);if(o&&t.open("a",o),t.open(r,this.attr(e,a,i,"g"!==r?r:null)),"text"===r){const e=DK(a);if(mU(e)){const n={x:0,dy:NK(a)};for(let r=0;r<e.length;++r)t.open("tspan",r?n:null).text(IK(a,e[r])).close()}else t.text(IK(a,e))}else if("g"===r){const r=a.strokeForeground,i=a.fill,o=a.stroke;r&&o&&(a.stroke=null),t.open("path",this.attr(e,a,n.background,"bgrect")).close(),t.open("g",this.attr(e,a,n.content)),zX(a,(e=>this.mark(t,e))),t.close(),r&&o?(i&&(a.fill=null),a.stroke=o,t.open("path",this.attr(e,a,n.foreground,"bgrect")).close(),i&&(a.fill=i)):t.open("path",this.attr(e,a,n.foreground,"bgfore")).close()}t.close(),o&&t.close()};return n.nested?e.items&&e.items.length&&a(e.items[0]):zX(e,a),t.close()},href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then((t=>{t["xlink:href"]=t.href,t.href=null,(this._hrefs||(this._hrefs={}))[e]=t}))}return null},attr(t,e,n,r){const i={},a=(t,e,n,r)=>{i[r||t]=e};return Array.isArray(n)?n.forEach((t=>t(a,e,this))):n(a,e,this),r&&function(t,e,n,r,i){if(null==e)return t;"bgrect"===r&&!1===n.interactive&&(t["pointer-events"]="none");if("bgfore"===r&&(!1===n.interactive&&(t["pointer-events"]="none"),t.display="none",null!==e.fill))return t;"image"===r&&!1===e.smooth&&(t.style="image-rendering: optimizeSpeed; image-rendering: pixelated;");"text"===r&&(t["font-family"]=MK(e),t["font-size"]=TK(e)+"px",t["font-style"]=e.fontStyle,t["font-variant"]=e.fontVariant,t["font-weight"]=e.fontWeight);for(const a in $$){let n=e[a];const r=$$[a];("transparent"!==n||"fill"!==r&&"stroke"!==r)&&null!=n&&(KH(n)&&(n=$H(n,i.gradient,"")),t[r]=n)}}(i,e,t,r,this._defs),i},defs(t){const e=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(e).length+Object.keys(n).length){t.open("defs");for(const n in e){const r=e[n],i=r.stops;"radial"===r.gradient?(t.open("pattern",{id:XH+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),t.close(),t.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):t.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let e=0;e<i.length;++e)t.open("stop",{offset:i[e].offset,"stop-color":i[e].color}).close();t.close()}for(const e in n){const r=n[e];t.open("clipPath",{id:e}),r.path?t.open("path",{d:r.path}).close():t.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),t.close()}t.close()}}});const gZ="canvas",mZ="none",yZ={Canvas:gZ,PNG:"png",SVG:"svg",None:mZ},vZ={};function bZ(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(vZ[t]=e,this):vZ[t]}function xZ(t,e,n){const r=[],i=(new GY).union(e),a=t.marktype;return a?wZ(t,i,n,r):"group"===a?kZ(t,i,n,r):hU("Intersect scene must be mark node or group item.")}function wZ(t,e,n,r){if(function(t,e,n){return t.bounds&&e.intersects(t.bounds)&&("group"===t.marktype||!1!==t.interactive&&(!n||n(t)))}(t,e,n)){const i=t.items,a=t.marktype,o=i.length;let s=0;if("group"===a)for(;s<o;++s)kZ(i[s],e,n,r);else for(const t=WK[a].isect;s<o;++s){const n=i[s];_Z(n,e,t)&&r.push(n)}}return r}function kZ(t,e,n,r){n&&n(t.mark)&&_Z(t,e,WK.group.isect)&&r.push(t);const i=t.items,a=i&&i.length;if(a){const o=t.x||0,s=t.y||0;e.translate(-o,-s);for(let t=0;t<a;++t)wZ(i[t],e,n,r);e.translate(o,s)}return r}function _Z(t,e,n){const r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}vZ[gZ]=vZ.png={renderer:E$,headless:E$,handler:k$},vZ.svg={renderer:tZ,headless:pZ,handler:N$},vZ[mZ]={};const SZ=new GY;function AZ(t){const e=t.clip;if(wU(e))e(gX(SZ.clear()));else{if(!e)return;SZ.set(0,0,t.group.width,t.group.height)}t.bounds.intersect(SZ)}const CZ=1e-9;function EZ(t,e,n){return t===e||("path"===n?TZ(t,e):t instanceof Date&&e instanceof Date?+t===+e:CU(t)&&CU(e)?Math.abs(t-e)<=CZ:t&&e&&(yU(t)||yU(e))?function(t,e){var n,r,i=Object.keys(t),a=Object.keys(e);if(i.length!==a.length)return!1;for(i.sort(),a.sort(),r=i.length-1;r>=0;r--)if(i[r]!=a[r])return!1;for(r=i.length-1;r>=0;r--)if(!EZ(t[n=i[r]],e[n],n))return!1;return typeof t===typeof e}(t,e):t==e)}function TZ(t,e){return EZ(rY(t),rY(e))}function NZ(){VY(),YH=0}function DZ(t,e,n){return t.fields=e||[],t.fname=n,t}function FZ(t){return 1===t.length?IZ(t[0]):MZ(t)}const IZ=t=>function(e){return e[t]},MZ=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function OZ(t){throw Error(t)}function RZ(t){const e=[],n=t.length;let r,i,a,o=null,s=0,c="";function u(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)c+=t.substring(r,i++),r=i;else if(a===o)u(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&u(),s=r=i+1):"]"===a&&(s||OZ("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&OZ("Access path missing closing bracket: "+t),o&&OZ("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function zZ(t,e,n){const r=RZ(t);return t=1===r.length?r[0]:t,DZ((n&&n.get||FZ)(r),[t],e||t)}zZ("id"),DZ((t=>t),[],"identity"),DZ((()=>0),[],"zero"),DZ((()=>1),[],"one"),DZ((()=>!0),[],"true"),DZ((()=>!1),[],"false");var BZ=Array.isArray;function LZ(t){return t[t.length-1]}function PZ(t){return null==t||""===t?null:+t}function jZ(t){return null!=t?BZ(t)?t:[t]:[]}const UZ=Object.prototype.hasOwnProperty;function WZ(t,e){return UZ.call(t,e)}function VZ(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function qZ(t,e){switch(arguments.length){case 0:break;case 1:"function"===typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"===typeof e?this.interpolator(e):this.range(e)}return this}const GZ=Symbol("implicit");function HZ(){var t=new Map,e=[],n=[],r=GZ;function i(i){var a=i+"",o=t.get(a);if(!o){if(r!==GZ)return r;t.set(a,o=e.push(i))}return n[(o-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Map;for(const r of n){const n=r+"";t.has(n)||t.set(n,e.push(r))}return i},i.range=function(t){return arguments.length?(n=Array.from(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return HZ(e,n).unknown(r)},VZ.apply(i,arguments),i}var YZ,XZ=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function KZ(t){if(!(e=XZ.exec(t)))throw new Error("invalid format: "+t);var e;return new $Z({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function $Z(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function ZZ(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function QZ(t){return(t=ZZ(Math.abs(t)))?t[1]:NaN}function JZ(t,e){var n=ZZ(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}KZ.prototype=$Z.prototype,$Z.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const tQ={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>JZ(100*t,e),r:JZ,s:function(t,e){var n=ZZ(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(YZ=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+ZZ(t,Math.max(0,e+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function eQ(t){return t}var nQ,rQ,iQ,aQ=Array.prototype.map,oQ=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function sQ(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?eQ:(e=aQ.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,a=[],o=0,s=e[0],c=0;i>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),a.push(t.substring(i-=s,i+s)),!((c+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?eQ:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(aQ.call(t.numerals,String)),c=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"\u2212":t.minus+"",l=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=KZ(t)).fill,n=t.align,h=t.sign,d=t.symbol,f=t.zero,p=t.width,g=t.comma,m=t.precision,y=t.trim,v=t.type;"n"===v?(g=!0,v="g"):tQ[v]||(void 0===m&&(m=12),y=!0,v="g"),(f||"0"===e&&"="===n)&&(f=!0,e="0",n="=");var b="$"===d?i:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",x="$"===d?a:/[%p]/.test(v)?c:"",w=tQ[v],k=/[defgprs%]/.test(v);function _(t){var i,a,c,d=b,_=x;if("c"===v)_=w(t)+_,t="";else{var S=(t=+t)<0||1/t<0;if(t=isNaN(t)?l:w(Math.abs(t),m),y&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),S&&0===+t&&"+"!==h&&(S=!1),d=(S?"("===h?h:u:"-"===h||"("===h?"":h)+d,_=("s"===v?oQ[8+YZ/3]:"")+_+(S&&"("===h?")":""),k)for(i=-1,a=t.length;++i<a;)if(48>(c=t.charCodeAt(i))||c>57){_=(46===c?o+t.slice(i+1):t.slice(i))+_,t=t.slice(0,i);break}}g&&!f&&(t=r(t,1/0));var A=d.length+t.length+_.length,C=A<p?new Array(p-A+1).join(e):"";switch(g&&f&&(t=r(C+t,C.length?p-_.length:1/0),C=""),n){case"<":t=d+t+_+C;break;case"=":t=d+C+t+_;break;case"^":t=C.slice(0,A=C.length>>1)+d+t+_+C.slice(A);break;default:t=C+d+t+_}return s(t)}return m=void 0===m?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),_.toString=function(){return t+""},_}return{format:h,formatPrefix:function(t,e){var n=h(((t=KZ(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(QZ(e)/3))),i=Math.pow(10,-r),a=oQ[8+r/3];return function(t){return n(i*t)+a}}}}function cQ(t,e,n,r){var i,a=HC(t,e,n);switch((r=KZ(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(QZ(e)/3)))-QZ(Math.abs(t)))}(a,o))||(r.precision=i),iQ(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,QZ(e)-QZ(t))+1}(a,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-QZ(Math.abs(t)))}(a))||(r.precision=i-2*("%"===r.type))}return rQ(r)}function uQ(t){return+t}!function(t){nQ=sQ(t),rQ=nQ.format,iQ=nQ.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});var lQ=[0,1];function hQ(t){return t}function dQ(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function fQ(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=dQ(i,r),a=n(o,a)):(r=dQ(r,i),a=n(a,o)),function(t){return a(r(t))}}function pQ(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=dQ(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(e){var n=nz(t,e,1,r)-1;return a[n](i[n](e))}}function gQ(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function mQ(){var t,e,n,r,i,a,o=lQ,s=lQ,c=uC,u=hQ;function l(){var t=Math.min(o.length,s.length);return u!==hQ&&(u=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(o[0],o[t-1])),r=t>2?pQ:fQ,i=a=null,h}function h(e){return null==e||isNaN(e=+e)?n:(i||(i=r(o.map(t),s,c)))(t(u(e)))}return h.invert=function(n){return u(e((a||(a=r(s,o.map(t),iC)))(n)))},h.domain=function(t){return arguments.length?(o=Array.from(t,uQ),l()):o.slice()},h.range=function(t){return arguments.length?(s=Array.from(t),l()):s.slice()},h.rangeRound=function(t){return s=Array.from(t),c=cA,l()},h.clamp=function(t){return arguments.length?(u=!!t||hQ,l()):u!==hQ},h.interpolate=function(t){return arguments.length?(c=t,l()):c},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,l()}}function yQ(){return mQ()(hQ,hQ)}function vQ(t){var e=t.domain;return t.ticks=function(t){var n=e();return qC(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return cQ(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i,a=e(),o=0,s=a.length-1,c=a[o],u=a[s],l=10;for(u<c&&(i=c,c=u,u=i,i=o,o=s,s=i);l-- >0;){if((i=GC(c,u,n))===r)return a[o]=c,a[s]=u,e(a);if(i>0)c=Math.floor(c/i)*i,u=Math.ceil(u/i)*i;else{if(!(i<0))break;c=Math.ceil(c*i)/i,u=Math.floor(u*i)/i}r=i}return t},t}function bQ(t,e){var n,r=0,i=(t=t.slice()).length-1,a=t[r],o=t[i];return o<a&&(n=r,r=i,i=n,n=a,a=o,o=n),t[r]=e.floor(a),t[i]=e.ceil(o),t}function xQ(t){return Math.log(t)}function wQ(t){return Math.exp(t)}function kQ(t){return-Math.log(-t)}function _Q(t){return-Math.exp(-t)}function SQ(t){return isFinite(t)?+("1e"+t):t<0?0:t}function AQ(t){return function(e){return-t(-e)}}function CQ(t){var e,n,r=t(xQ,wQ),i=r.domain,a=10;function o(){return e=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}(a),n=function(t){return 10===t?SQ:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}(a),i()[0]<0?(e=AQ(e),n=AQ(n),t(kQ,_Q)):t(xQ,wQ),r}return r.base=function(t){return arguments.length?(a=+t,o()):a},r.domain=function(t){return arguments.length?(i(t),o()):i()},r.ticks=function(t){var r,o=i(),s=o[0],c=o[o.length-1];(r=c<s)&&(d=s,s=c,c=d);var u,l,h,d=e(s),f=e(c),p=null==t?10:+t,g=[];if(!(a%1)&&f-d<p){if(d=Math.floor(d),f=Math.ceil(f),s>0){for(;d<=f;++d)for(l=1,u=n(d);l<a;++l)if(!((h=u*l)<s)){if(h>c)break;g.push(h)}}else for(;d<=f;++d)for(l=a-1,u=n(d);l>=1;--l)if(!((h=u*l)<s)){if(h>c)break;g.push(h)}2*g.length<p&&(g=qC(s,c,p))}else g=qC(d,f,Math.min(f-d,p)).map(n);return r?g.reverse():g},r.tickFormat=function(t,i){if(null==i&&(i=10===a?".0e":","),"function"!==typeof i&&(i=rQ(i)),t===1/0)return i;null==t&&(t=10);var o=Math.max(1,a*t/r.ticks().length);return function(t){var r=t/n(Math.round(e(t)));return r*a<a-.5&&(r*=a),r<=o?i(t):""}},r.nice=function(){return i(bQ(i(),{floor:function(t){return n(Math.floor(e(t)))},ceil:function(t){return n(Math.ceil(e(t)))}}))},r}function EQ(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function TQ(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function NQ(t){return t<0?-t*t:t*t}function DQ(t){var e=t(hQ,hQ),n=1;return e.exponent=function(e){return arguments.length?1===(n=+e)?t(hQ,hQ):.5===n?t(TQ,NQ):t(EQ(n),EQ(1/n)):n},vQ(e)}function FQ(){var t=DQ(mQ());return t.copy=function(){return gQ(t,FQ()).exponent(t.exponent())},VZ.apply(t,arguments),t}function IQ(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function MQ(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function OQ(t){var e=1,n=t(IQ(e),MQ(e));return n.constant=function(n){return arguments.length?t(IQ(e=+n),MQ(e)):e},vQ(n)}const RQ=1e3,zQ=6e4,BQ=36e5,LQ=864e5,PQ=6048e5,jQ=2592e6,UQ=31536e6;var WQ=new Date,VQ=new Date;function qQ(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,a){var o,s=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r)||!(a>0))return s;do{s.push(o=new Date(+n)),e(n,a),t(n)}while(o<n&&n<r);return s},i.filter=function(n){return qQ((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return WQ.setTime(+e),VQ.setTime(+r),t(WQ),t(VQ),Math.floor(n(WQ,VQ))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t===0}:function(e){return i.count(0,e)%t===0}):i:null}),i}var GQ=qQ((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t}));GQ.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?qQ((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):GQ:null};const HQ=GQ;GQ.range;var YQ=qQ((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+e*RQ)}),(function(t,e){return(e-t)/RQ}),(function(t){return t.getUTCSeconds()}));const XQ=YQ;YQ.range;var KQ=qQ((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*RQ)}),(function(t,e){t.setTime(+t+e*zQ)}),(function(t,e){return(e-t)/zQ}),(function(t){return t.getMinutes()}));const $Q=KQ;KQ.range;var ZQ=qQ((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*RQ-t.getMinutes()*zQ)}),(function(t,e){t.setTime(+t+e*BQ)}),(function(t,e){return(e-t)/BQ}),(function(t){return t.getHours()}));const QQ=ZQ;ZQ.range;var JQ=qQ((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*zQ)/LQ),(t=>t.getDate()-1));const tJ=JQ;JQ.range;function eJ(t){return qQ((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*zQ)/PQ}))}var nJ=eJ(0),rJ=eJ(1),iJ=eJ(2),aJ=eJ(3),oJ=eJ(4),sJ=eJ(5),cJ=eJ(6),uJ=(nJ.range,rJ.range,iJ.range,aJ.range,oJ.range,sJ.range,cJ.range,qQ((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()})));const lJ=uJ;uJ.range;var hJ=qQ((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));hJ.every=function(t){return isFinite(t=Math.floor(t))&&t>0?qQ((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};const dJ=hJ;hJ.range;var fJ=qQ((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+e*zQ)}),(function(t,e){return(e-t)/zQ}),(function(t){return t.getUTCMinutes()}));const pJ=fJ;fJ.range;var gJ=qQ((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+e*BQ)}),(function(t,e){return(e-t)/BQ}),(function(t){return t.getUTCHours()}));const mJ=gJ;gJ.range;var yJ=qQ((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/LQ}),(function(t){return t.getUTCDate()-1}));const vJ=yJ;yJ.range;function bJ(t){return qQ((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/PQ}))}var xJ=bJ(0),wJ=bJ(1),kJ=bJ(2),_J=bJ(3),SJ=bJ(4),AJ=bJ(5),CJ=bJ(6),EJ=(xJ.range,wJ.range,kJ.range,_J.range,SJ.range,AJ.range,CJ.range,qQ((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})));const TJ=EJ;EJ.range;var NJ=qQ((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));NJ.every=function(t){return isFinite(t=Math.floor(t))&&t>0?qQ((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};const DJ=NJ;NJ.range;function FJ(t,e,n,r,i,a){const o=[[XQ,1,RQ],[XQ,5,5e3],[XQ,15,15e3],[XQ,30,3e4],[a,1,zQ],[a,5,3e5],[a,15,9e5],[a,30,18e5],[i,1,BQ],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,LQ],[r,2,1728e5],[n,1,PQ],[e,1,jQ],[e,3,7776e6],[t,1,UQ]];function s(e,n,r){const i=Math.abs(n-e)/r,a=Bu((t=>{let[,,e]=t;return e})).right(o,i);if(a===o.length)return t.every(HC(e/UQ,n/UQ,r));if(0===a)return HQ.every(Math.max(HC(e,n,r),1));const[s,c]=o[i/o[a-1][2]<o[a][2]/i?a-1:a];return s.every(c)}return[function(t,e,n){const r=e<t;r&&([t,e]=[e,t]);const i=n&&"function"===typeof n.range?n:s(t,e,n),a=i?i.range(t,+e+1):[];return r?a.reverse():a},s]}const[IJ,MJ]=FJ(DJ,TJ,xJ,vJ,mJ,pJ),[OJ,RJ]=FJ(dJ,lJ,nJ,tJ,QQ,$Q);var zJ=new Date,BJ=new Date;function LJ(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,a){var o,s=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r)||!(a>0))return s;do{s.push(o=new Date(+n)),e(n,a),t(n)}while(o<n&&n<r);return s},i.filter=function(n){return LJ((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return zJ.setTime(+e),BJ.setTime(+r),t(zJ),t(BJ),Math.floor(n(zJ,BJ))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t===0}:function(e){return i.count(0,e)%t===0}):i:null}),i}const PJ=6e4,jJ=864e5,UJ=6048e5;function WJ(t){return LJ((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/UJ}))}var VJ=WJ(0),qJ=WJ(1),GJ=WJ(2),HJ=WJ(3),YJ=WJ(4),XJ=WJ(5),KJ=WJ(6),$J=(VJ.range,qJ.range,GJ.range,HJ.range,YJ.range,XJ.range,KJ.range,LJ((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/jJ}),(function(t){return t.getUTCDate()-1})));const ZJ=$J;$J.range;function QJ(t){return LJ((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*PJ)/UJ}))}var JJ=QJ(0),t0=QJ(1),e0=QJ(2),n0=QJ(3),r0=QJ(4),i0=QJ(5),a0=QJ(6),o0=(JJ.range,t0.range,e0.range,n0.range,r0.range,i0.range,a0.range,LJ((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*PJ)/jJ),(t=>t.getDate()-1)));const s0=o0;o0.range;var c0=LJ((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));c0.every=function(t){return isFinite(t=Math.floor(t))&&t>0?LJ((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};const u0=c0;c0.range;var l0=LJ((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));l0.every=function(t){return isFinite(t=Math.floor(t))&&t>0?LJ((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};const h0=l0;l0.range;function d0(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function f0(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function p0(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}var g0,m0,y0,v0={"-":"",_:" ",0:"0"},b0=/^\s*\d+/,x0=/^%/,w0=/[\\^$*+?|[\]().{}]/g;function k0(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function _0(t){return t.replace(w0,"\\$&")}function S0(t){return new RegExp("^(?:"+t.map(_0).join("|")+")","i")}function A0(t){return new Map(t.map(((t,e)=>[t.toLowerCase(),e])))}function C0(t,e,n){var r=b0.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function E0(t,e,n){var r=b0.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function T0(t,e,n){var r=b0.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function N0(t,e,n){var r=b0.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function D0(t,e,n){var r=b0.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function F0(t,e,n){var r=b0.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function I0(t,e,n){var r=b0.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function M0(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function O0(t,e,n){var r=b0.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function R0(t,e,n){var r=b0.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function z0(t,e,n){var r=b0.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function B0(t,e,n){var r=b0.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function L0(t,e,n){var r=b0.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function P0(t,e,n){var r=b0.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function j0(t,e,n){var r=b0.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function U0(t,e,n){var r=b0.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function W0(t,e,n){var r=b0.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function V0(t,e,n){var r=x0.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function q0(t,e,n){var r=b0.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function G0(t,e,n){var r=b0.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function H0(t,e){return k0(t.getDate(),e,2)}function Y0(t,e){return k0(t.getHours(),e,2)}function X0(t,e){return k0(t.getHours()%12||12,e,2)}function K0(t,e){return k0(1+s0.count(u0(t),t),e,3)}function $0(t,e){return k0(t.getMilliseconds(),e,3)}function Z0(t,e){return $0(t,e)+"000"}function Q0(t,e){return k0(t.getMonth()+1,e,2)}function J0(t,e){return k0(t.getMinutes(),e,2)}function t1(t,e){return k0(t.getSeconds(),e,2)}function e1(t){var e=t.getDay();return 0===e?7:e}function n1(t,e){return k0(JJ.count(u0(t)-1,t),e,2)}function r1(t){var e=t.getDay();return e>=4||0===e?r0(t):r0.ceil(t)}function i1(t,e){return t=r1(t),k0(r0.count(u0(t),t)+(4===u0(t).getDay()),e,2)}function a1(t){return t.getDay()}function o1(t,e){return k0(t0.count(u0(t)-1,t),e,2)}function s1(t,e){return k0(t.getFullYear()%100,e,2)}function c1(t,e){return k0((t=r1(t)).getFullYear()%100,e,2)}function u1(t,e){return k0(t.getFullYear()%1e4,e,4)}function l1(t,e){var n=t.getDay();return k0((t=n>=4||0===n?r0(t):r0.ceil(t)).getFullYear()%1e4,e,4)}function h1(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+k0(e/60|0,"0",2)+k0(e%60,"0",2)}function d1(t,e){return k0(t.getUTCDate(),e,2)}function f1(t,e){return k0(t.getUTCHours(),e,2)}function p1(t,e){return k0(t.getUTCHours()%12||12,e,2)}function g1(t,e){return k0(1+ZJ.count(h0(t),t),e,3)}function m1(t,e){return k0(t.getUTCMilliseconds(),e,3)}function y1(t,e){return m1(t,e)+"000"}function v1(t,e){return k0(t.getUTCMonth()+1,e,2)}function b1(t,e){return k0(t.getUTCMinutes(),e,2)}function x1(t,e){return k0(t.getUTCSeconds(),e,2)}function w1(t){var e=t.getUTCDay();return 0===e?7:e}function k1(t,e){return k0(VJ.count(h0(t)-1,t),e,2)}function _1(t){var e=t.getUTCDay();return e>=4||0===e?YJ(t):YJ.ceil(t)}function S1(t,e){return t=_1(t),k0(YJ.count(h0(t),t)+(4===h0(t).getUTCDay()),e,2)}function A1(t){return t.getUTCDay()}function C1(t,e){return k0(qJ.count(h0(t)-1,t),e,2)}function E1(t,e){return k0(t.getUTCFullYear()%100,e,2)}function T1(t,e){return k0((t=_1(t)).getUTCFullYear()%100,e,2)}function N1(t,e){return k0(t.getUTCFullYear()%1e4,e,4)}function D1(t,e){var n=t.getUTCDay();return k0((t=n>=4||0===n?YJ(t):YJ.ceil(t)).getUTCFullYear()%1e4,e,4)}function F1(){return"+0000"}function I1(){return"%"}function M1(t){return+t}function O1(t){return Math.floor(+t/1e3)}function R1(t){return new Date(t)}function z1(t){return t instanceof Date?+t:+new Date(+t)}function B1(t,e,n,r,i,a,o,s,c,u){var l=yQ(),h=l.invert,d=l.domain,f=u(".%L"),p=u(":%S"),g=u("%I:%M"),m=u("%I %p"),y=u("%a %d"),v=u("%b %d"),b=u("%B"),x=u("%Y");function w(t){return(c(t)<t?f:s(t)<t?p:o(t)<t?g:a(t)<t?m:r(t)<t?i(t)<t?y:v:n(t)<t?b:x)(t)}return l.invert=function(t){return new Date(h(t))},l.domain=function(t){return arguments.length?d(Array.from(t,z1)):d().map(R1)},l.ticks=function(e){var n=d();return t(n[0],n[n.length-1],null==e?10:e)},l.tickFormat=function(t,e){return null==e?w:u(e)},l.nice=function(t){var n=d();return t&&"function"===typeof t.range||(t=e(n[0],n[n.length-1],null==t?10:t)),t?d(bQ(n,t)):l},l.copy=function(){return gQ(l,B1(t,e,n,r,i,a,o,s,c,u))},l}function L1(){var t,e,n,r,i,a=0,o=1,s=hQ,c=!1;function u(e){return null==e||isNaN(e=+e)?i:s(0===n?.5:(e=(r(e)-t)*n,c?Math.max(0,Math.min(1,e)):e))}function l(t){return function(e){var n,r;return arguments.length?([n,r]=e,s=t(n,r),u):[s(0),s(1)]}}return u.domain=function(i){return arguments.length?([a,o]=i,t=r(a=+a),e=r(o=+o),n=t===e?0:1/(e-t),u):[a,o]},u.clamp=function(t){return arguments.length?(c=!!t,u):c},u.interpolator=function(t){return arguments.length?(s=t,u):s},u.range=l(uC),u.rangeRound=l(cA),u.unknown=function(t){return arguments.length?(i=t,u):i},function(i){return r=i,t=i(a),e=i(o),n=t===e?0:1/(e-t),u}}function P1(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function j1(){var t=vQ(L1()(hQ));return t.copy=function(){return P1(t,j1())},qZ.apply(t,arguments)}function U1(){var t=DQ(L1());return t.copy=function(){return P1(t,U1()).exponent(t.exponent())},qZ.apply(t,arguments)}function W1(t,e){void 0===e&&(e=t,t=uC);for(var n=0,r=e.length-1,i=e[0],a=new Array(r<0?0:r);n<r;)a[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return a[e](t-e)}}function V1(){var t,e,n,r,i,a,o,s=0,c=.5,u=1,l=1,h=hQ,d=!1;function f(t){return isNaN(t=+t)?o:(t=.5+((t=+a(t))-e)*(l*t<l*e?r:i),h(d?Math.max(0,Math.min(1,t)):t))}function p(t){return function(e){var n,r,i;return arguments.length?([n,r,i]=e,h=W1(t,[n,r,i]),f):[h(0),h(.5),h(1)]}}return f.domain=function(o){return arguments.length?([s,c,u]=o,t=a(s=+s),e=a(c=+c),n=a(u=+u),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),l=e<t?-1:1,f):[s,c,u]},f.clamp=function(t){return arguments.length?(d=!!t,f):d},f.interpolator=function(t){return arguments.length?(h=t,f):h},f.range=p(uC),f.rangeRound=p(cA),f.unknown=function(t){return arguments.length?(o=t,f):o},function(o){return a=o,t=o(s),e=o(c),n=o(u),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),l=e<t?-1:1,f}}function q1(){var t=DQ(V1());return t.copy=function(){return P1(t,q1()).exponent(t.exponent())},qZ.apply(t,arguments)}function G1(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function H1(t,e){var n=HA(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}}!function(t){g0=function(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,a=t.days,o=t.shortDays,s=t.months,c=t.shortMonths,u=S0(i),l=A0(i),h=S0(a),d=A0(a),f=S0(o),p=A0(o),g=S0(s),m=A0(s),y=S0(c),v=A0(c),b={a:function(t){return o[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:H0,e:H0,f:Z0,g:c1,G:l1,H:Y0,I:X0,j:K0,L:$0,m:Q0,M:J0,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:M1,s:O1,S:t1,u:e1,U:n1,V:i1,w:a1,W:o1,x:null,X:null,y:s1,Y:u1,Z:h1,"%":I1},x={a:function(t){return o[t.getUTCDay()]},A:function(t){return a[t.getUTCDay()]},b:function(t){return c[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:d1,e:d1,f:y1,g:T1,G:D1,H:f1,I:p1,j:g1,L:m1,m:v1,M:b1,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:M1,s:O1,S:x1,u:w1,U:k1,V:S1,w:A1,W:C1,x:null,X:null,y:E1,Y:N1,Z:F1,"%":I1},w={a:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(t,e,n){var r=y.exec(e.slice(n));return r?(t.m=v.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(t,e,n){var r=g.exec(e.slice(n));return r?(t.m=m.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(t,n,r){return S(t,e,n,r)},d:z0,e:z0,f:W0,g:I0,G:F0,H:L0,I:L0,j:B0,L:U0,m:R0,M:P0,p:function(t,e,n){var r=u.exec(e.slice(n));return r?(t.p=l.get(r[0].toLowerCase()),n+r[0].length):-1},q:O0,Q:q0,s:G0,S:j0,u:E0,U:T0,V:N0,w:C0,W:D0,x:function(t,e,r){return S(t,n,e,r)},X:function(t,e,n){return S(t,r,e,n)},y:I0,Y:F0,Z:M0,"%":V0};function k(t,e){return function(n){var r,i,a,o=[],s=-1,c=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===t.charCodeAt(s)&&(o.push(t.slice(c,s)),null!=(i=v0[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(a=e[r])&&(r=a(n,i)),o.push(r),c=s+1);return o.push(t.slice(c,s)),o.join("")}}function _(t,e){return function(n){var r,i,a=p0(1900,void 0,1);if(S(a,t,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("s"in a)return new Date(1e3*a.s+("L"in a?a.L:0));if(e&&!("Z"in a)&&(a.Z=0),"p"in a&&(a.H=a.H%12+12*a.p),void 0===a.m&&(a.m="q"in a?a.q:0),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(i=(r=f0(p0(a.y,0,1))).getUTCDay(),r=i>4||0===i?qJ.ceil(r):qJ(r),r=ZJ.offset(r,7*(a.V-1)),a.y=r.getUTCFullYear(),a.m=r.getUTCMonth(),a.d=r.getUTCDate()+(a.w+6)%7):(i=(r=d0(p0(a.y,0,1))).getDay(),r=i>4||0===i?t0.ceil(r):t0(r),r=s0.offset(r,7*(a.V-1)),a.y=r.getFullYear(),a.m=r.getMonth(),a.d=r.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),i="Z"in a?f0(p0(a.y,0,1)).getUTCDay():d0(p0(a.y,0,1)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(i+5)%7:a.w+7*a.U-(i+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,f0(a)):d0(a)}}function S(t,e,n,r){for(var i,a,o=0,s=e.length,c=n.length;o<s;){if(r>=c)return-1;if(37===(i=e.charCodeAt(o++))){if(i=e.charAt(o++),!(a=w[i in v0?e.charAt(o++):i])||(r=a(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=k(n,b),b.X=k(r,b),b.c=k(e,b),x.x=k(n,x),x.X=k(r,x),x.c=k(e,x),{format:function(t){var e=k(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=_(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=k(t+="",x);return e.toString=function(){return t},e},utcParse:function(t){var e=_(t+="",!0);return e.toString=function(){return t},e}}}(t),m0=g0.format,g0.parse,y0=g0.utcFormat,g0.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Y1,X1=180/Math.PI,K1={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function $1(t,e,n,r,i,a){var o,s,c;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),t*r<e*n&&(t=-t,e=-e,c=-c,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*X1,skewX:Math.atan(c)*X1,scaleX:o,scaleY:s}}function Z1(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var s=[],c=[];return a=t(a),o=t(o),function(t,r,i,a,o,s){if(t!==i||r!==a){var c=o.push("translate(",null,e,null,n);s.push({i:c-4,x:iC(t,i)},{i:c-2,x:iC(r,a)})}else(i||a)&&o.push("translate("+i+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,c),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:iC(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(a.rotate,o.rotate,s,c),function(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:iC(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(a.skewX,o.skewX,s,c),function(t,e,n,r,a,o){if(t!==n||e!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:iC(t,n)},{i:s-2,x:iC(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,c),a=o=null,function(t){for(var e,n=-1,r=c.length;++n<r;)s[(e=c[n]).i]=e.x(t);return s.join("")}}}var Q1=Z1((function(t){const e=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?K1:$1(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),J1=Z1((function(t){return null==t?K1:(Y1||(Y1=document.createElementNS("http://www.w3.org/2000/svg","g")),Y1.setAttribute("transform",t),(t=Y1.transform.baseVal.consolidate())?$1((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):K1)}),", ",")",")");function t2(t){return((t=Math.exp(t))+1/t)/2}const e2=function t(e,n,r){function i(t,i){var a,o,s=t[0],c=t[1],u=t[2],l=i[0],h=i[1],d=i[2],f=l-s,p=h-c,g=f*f+p*p;if(g<1e-12)o=Math.log(d/u)/e,a=function(t){return[s+t*f,c+t*p,u*Math.exp(e*t*o)]};else{var m=Math.sqrt(g),y=(d*d-u*u+r*g)/(2*u*n*m),v=(d*d-u*u-r*g)/(2*d*n*m),b=Math.log(Math.sqrt(y*y+1)-y),x=Math.log(Math.sqrt(v*v+1)-v);o=(x-b)/e,a=function(t){var r=t*o,i=t2(b),a=u/(n*m)*(i*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(e*r+b)-function(t){return((t=Math.exp(t))-1/t)/2}(b));return[s+a*f,c+a*p,u*i/t2(e*r+b)]}}return a.duration=1e3*o*e/Math.SQRT2,a}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i}(Math.SQRT2,2,4);function n2(t){return function(e,n){var r=t((e=LA(e)).h,(n=LA(n)).h),i=XA(e.s,n.s),a=XA(e.l,n.l),o=XA(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=a(t),e.opacity=o(t),e+""}}}const r2=n2(HA);var i2=n2(XA);const a2=Math.PI/180,o2=180/Math.PI,s2=.96422,c2=1,u2=.82521,l2=4/29,h2=6/29,d2=.12841854934601665,f2=.008856451679035631;function p2(t){if(t instanceof m2)return new m2(t.l,t.a,t.b,t.opacity);if(t instanceof _2)return S2(t);t instanceof IA||(t=DA(t));var e,n,r=x2(t.r),i=x2(t.g),a=x2(t.b),o=y2((.2225045*r+.7168786*i+.0606169*a)/c2);return r===i&&i===a?e=n=o:(e=y2((.4360747*r+.3850649*i+.1430804*a)/s2),n=y2((.0139322*r+.0971045*i+.7141733*a)/u2)),new m2(116*o-16,500*(e-o),200*(o-n),t.opacity)}function g2(t,e,n,r){return 1===arguments.length?p2(t):new m2(t,e,n,null==r?1:r)}function m2(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function y2(t){return t>f2?Math.pow(t,1/3):t/d2+l2}function v2(t){return t>h2?t*t*t:d2*(t-l2)}function b2(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function x2(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function w2(t){if(t instanceof _2)return new _2(t.h,t.c,t.l,t.opacity);if(t instanceof m2||(t=p2(t)),0===t.a&&0===t.b)return new _2(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*o2;return new _2(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function k2(t,e,n,r){return 1===arguments.length?w2(t):new _2(t,e,n,null==r?1:r)}function _2(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function S2(t){if(isNaN(t.h))return new m2(t.l,0,0,t.opacity);var e=t.h*a2;return new m2(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function A2(t,e){var n=XA((t=g2(t)).l,(e=g2(e)).l),r=XA(t.a,e.a),i=XA(t.b,e.b),a=XA(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=a(e),t+""}}function C2(t){return function(e,n){var r=t((e=k2(e)).h,(n=k2(n)).h),i=XA(e.c,n.c),a=XA(e.l,n.l),o=XA(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=a(t),e.opacity=o(t),e+""}}}uA(m2,g2,lA(hA,{brighter:function(t){return new m2(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new m2(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new IA(b2(3.1338561*(e=s2*v2(e))-1.6168667*(t=c2*v2(t))-.4906146*(n=u2*v2(n))),b2(-.9787684*e+1.9161415*t+.033454*n),b2(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),uA(_2,k2,lA(hA,{brighter:function(t){return new _2(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new _2(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return S2(this).rgb()}}));const E2=C2(HA);var T2=C2(XA),N2=-.14861,D2=1.78277,F2=-.29227,I2=-.90649,M2=1.97294,O2=M2*I2,R2=M2*D2,z2=D2*F2-I2*N2;function B2(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof L2)return new L2(t.h,t.s,t.l,t.opacity);t instanceof IA||(t=DA(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(z2*r+O2*e-R2*n)/(z2+O2-R2),a=r-i,o=(M2*(n-i)-F2*a)/I2,s=Math.sqrt(o*o+a*a)/(M2*i*(1-i)),c=s?Math.atan2(o,a)*o2-120:NaN;return new L2(c<0?c+360:c,s,i,t.opacity)}(t):new L2(t,e,n,null==r?1:r)}function L2(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function P2(t){return function e(n){function r(e,r){var i=t((e=B2(e)).h,(r=B2(r)).h),a=XA(e.s,r.s),o=XA(e.l,r.l),s=XA(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=a(t),e.l=o(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}uA(L2,B2,lA(hA,{brighter:function(t){return t=null==t?fA:Math.pow(fA,t),new L2(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?dA:Math.pow(dA,t),new L2(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*a2,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new IA(255*(e+n*(N2*r+D2*i)),255*(e+n*(F2*r+I2*i)),255*(e+n*(M2*r)),this.opacity)}}));const j2=P2(HA);var U2=P2(XA);function W2(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}const V2="year",q2="quarter",G2="month",H2="week",Y2="date",X2="day",K2="dayofyear",$2="hours",Z2="minutes",Q2="seconds",J2="milliseconds";[V2,q2,G2,H2,Y2,X2,K2,$2,Z2,Q2,J2].reduce(((t,e,n)=>(t[e]=1+n,t)),{});"".concat(V2,"-").concat(G2),"".concat(V2,"-").concat(G2,"-").concat(Y2),"".concat($2,"-").concat(Z2);new Date;vi.every(3),bi.every(3);const t3=[V2,G2,Y2,$2,Z2,Q2,J2],e3=t3.slice(0,-1),n3=e3.slice(0,-1),r3=n3.slice(0,-1);r3.slice(0,-1);const i3="linear",a3="log",o3="pow",s3="sqrt",c3="symlog",u3="time",l3="utc",h3="sequential",d3="diverging",f3="quantile",p3="quantize",g3="threshold",m3="continuous",y3="discrete",v3="discretizing",b3="interpolating",x3="temporal";function w3(){const t=HZ().unknown(void 0),e=t.domain,n=t.range;let r,i,a=[0,1],o=!1,s=0,c=0,u=.5;function l(){const t=e().length,l=a[1]<a[0],h=a[1-l],d=function(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0}(t,s,c);let f=a[l-0];r=(h-f)/(d||1),o&&(r=Math.floor(r)),f+=(h-f-r*(t-s))*u,i=r*(1-s),o&&(f=Math.round(f),i=Math.round(i));const p=zu(t).map((t=>f+r*t));return n(l?p.reverse():p)}return delete t.unknown,t.domain=function(t){return arguments.length?(e(t),l()):e()},t.range=function(t){return arguments.length?(a=[+t[0],+t[1]],l()):a.slice()},t.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,l()},t.bandwidth=function(){return i},t.step=function(){return r},t.round=function(t){return arguments.length?(o=!!t,l()):o},t.padding=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),s=c,l()):s},t.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),l()):s},t.paddingOuter=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),l()):c},t.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),l()):u},t.invertRange=function(t){if(null==t[0]||null==t[1])return;const r=a[1]<a[0],o=r?n().reverse():n(),s=o.length-1;let c,u,l,h=+t[0],d=+t[1];return h!==h||d!==d||(d<h&&(l=h,h=d,d=l),d<o[0]||h>a[1-r])?void 0:(c=Math.max(0,tz(o,h)-1),u=h===d?c:tz(o,d)-1,h-o[c]>i+1e-10&&++c,r&&(l=c,c=s-u,u=s-l),c>u?void 0:e().slice(c,u+1))},t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return w3().domain(e()).range(a).round(o).paddingInner(s).paddingOuter(c).align(u)},l()}function k3(t){const e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return k3(e())},t}var _3=Array.prototype.map;const S3=Array.prototype.slice;const A3={};function C3(t,e,n){return arguments.length>1?(A3[t]=function(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){let n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){const n=t.range();let r,i,a,o,s=e[0],c=e[1],u=-1;for(c<s&&(i=s,s=c,c=i),a=0,o=n.length;a<o;++a)n[a]>=s&&n[a]<=c&&(u<0&&(u=a),r=a);if(!(u<0))return s=t.invertExtent(n[u]),c=t.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===c[1]?c[0]:c[1]]}}(n):void 0),n.type=t,n};return r.metadata=function(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}(jZ(n)),r}(t,e,n),this):function(t){return WZ(A3,t)}(t)?A3[t]:void 0}C3("identity",(function t(e){var n;function r(t){return null==t||isNaN(t=+t)?n:t}return r.invert=r,r.domain=r.range=function(t){return arguments.length?(e=Array.from(t,uQ),r):e.slice()},r.unknown=function(t){return arguments.length?(n=t,r):n},r.copy=function(){return t(e).unknown(n)},e=arguments.length?Array.from(e,uQ):[0,1],vQ(r)})),C3(i3,(function t(){var e=yQ();return e.copy=function(){return gQ(e,t())},VZ.apply(e,arguments),vQ(e)}),m3),C3(a3,(function t(){var e=CQ(mQ()).domain([1,10]);return e.copy=function(){return gQ(e,t()).base(e.base())},VZ.apply(e,arguments),e}),[m3,a3]),C3(o3,FQ,m3),C3(s3,(function(){return FQ.apply(null,arguments).exponent(.5)}),m3),C3(c3,(function t(){var e=OQ(mQ());return e.copy=function(){return gQ(e,t()).constant(e.constant())},VZ.apply(e,arguments)}),m3),C3(u3,(function(){return VZ.apply(B1(OJ,RJ,dJ,lJ,nJ,tJ,QQ,$Q,XQ,m0).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}),[m3,x3]),C3(l3,(function(){return VZ.apply(B1(IJ,MJ,DJ,TJ,xJ,vJ,mJ,pJ,XQ,y0).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}),[m3,x3]),C3(h3,j1,[m3,b3]),C3("".concat(h3,"-").concat(i3),j1,[m3,b3]),C3("".concat(h3,"-").concat(a3),(function t(){var e=CQ(L1()).domain([1,10]);return e.copy=function(){return P1(e,t()).base(e.base())},qZ.apply(e,arguments)}),[m3,b3,a3]),C3("".concat(h3,"-").concat(o3),U1,[m3,b3]),C3("".concat(h3,"-").concat(s3),(function(){return U1.apply(null,arguments).exponent(.5)}),[m3,b3]),C3("".concat(h3,"-").concat(c3),(function t(){var e=OQ(L1());return e.copy=function(){return P1(e,t()).constant(e.constant())},qZ.apply(e,arguments)}),[m3,b3]),C3("".concat(d3,"-").concat(i3),(function t(){var e=vQ(V1()(hQ));return e.copy=function(){return P1(e,t())},qZ.apply(e,arguments)}),[m3,b3]),C3("".concat(d3,"-").concat(a3),(function t(){var e=CQ(V1()).domain([.1,1,10]);return e.copy=function(){return P1(e,t()).base(e.base())},qZ.apply(e,arguments)}),[m3,b3,a3]),C3("".concat(d3,"-").concat(o3),q1,[m3,b3]),C3("".concat(d3,"-").concat(s3),(function(){return q1.apply(null,arguments).exponent(.5)}),[m3,b3]),C3("".concat(d3,"-").concat(c3),(function t(){var e=OQ(V1());return e.copy=function(){return P1(e,t()).constant(e.constant())},qZ.apply(e,arguments)}),[m3,b3]),C3(f3,(function t(){var e,n=[],r=[],i=[];function a(){var t=0,e=Math.max(1,r.length);for(i=new Array(e-1);++t<e;)i[t-1]=Ou(n,t/e);return o}function o(t){return null==t||isNaN(t=+t)?e:r[nz(i,t)]}return o.invertExtent=function(t){var e=r.indexOf(t);return e<0?[NaN,NaN]:[e>0?i[e-1]:n[0],e<i.length?i[e]:n[n.length-1]]},o.domain=function(t){if(!arguments.length)return n.slice();n=[];for(let e of t)null==e||isNaN(e=+e)||n.push(e);return n.sort(Nu),a()},o.range=function(t){return arguments.length?(r=Array.from(t),a()):r.slice()},o.unknown=function(t){return arguments.length?(e=t,o):e},o.quantiles=function(){return i.slice()},o.copy=function(){return t().domain(n).range(r).unknown(e)},VZ.apply(o,arguments)}),[v3,f3]),C3(p3,(function t(){var e,n=0,r=1,i=1,a=[.5],o=[0,1];function s(t){return null!=t&&t<=t?o[nz(a,t,0,i)]:e}function c(){var t=-1;for(a=new Array(i);++t<i;)a[t]=((t+1)*r-(t-i)*n)/(i+1);return s}return s.domain=function(t){return arguments.length?([n,r]=t,n=+n,r=+r,c()):[n,r]},s.range=function(t){return arguments.length?(i=(o=Array.from(t)).length-1,c()):o.slice()},s.invertExtent=function(t){var e=o.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,a[0]]:e>=i?[a[i-1],r]:[a[e-1],a[e]]},s.unknown=function(t){return arguments.length?(e=t,s):s},s.thresholds=function(){return a.slice()},s.copy=function(){return t().domain([n,r]).range(o).unknown(e)},VZ.apply(vQ(s),arguments)}),v3),C3(g3,(function t(){var e,n=[.5],r=[0,1],i=1;function a(t){return null!=t&&t<=t?r[nz(n,t,0,i)]:e}return a.domain=function(t){return arguments.length?(n=Array.from(t),i=Math.min(n.length,r.length-1),a):n.slice()},a.range=function(t){return arguments.length?(r=Array.from(t),i=Math.min(n.length,r.length-1),a):r.slice()},a.invertExtent=function(t){var e=r.indexOf(t);return[n[e-1],n[e]]},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return t().domain(n).range(r).unknown(e)},VZ.apply(a,arguments)}),v3),C3("bin-ordinal",(function t(){let e=[],n=[];function r(t){return null==t||t!==t?void 0:n[(nz(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=function(t){return _3.call(t,PZ)}(t),r):e.slice()},r.range=function(t){return arguments.length?(n=S3.call(t),r):n.slice()},r.tickFormat=function(t,n){return cQ(e[0],LZ(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}),[y3,v3]),C3("ordinal",HZ,y3),C3("band",w3,y3),C3("point",(function(){return k3(w3().paddingInner(1))}),y3);function E3(t,e){const n=e[0],r=LZ(e)-n;return function(e){return t(n+e*r)}}function T3(t,e,n){return W1(D3(e||"rgb",n),t)}function N3(t,e){const n=new Array(e),r=e+1;for(let i=0;i<e;)n[i]=t(++i/r);return n}function D3(t,e){const n=v[function(t){return"interpolate"+t.toLowerCase().split("-").map((t=>t[0].toUpperCase()+t.slice(1))).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}function F3(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function I3(t,e){for(const n in t)O3(n,e(t[n]))}const M3={};function O3(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(M3[t]=e,this):M3[t]}I3({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},F3),I3({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(t=>T3(F3(t))));const R3=t=>t;function z3(t,e){t&&L3.hasOwnProperty(t.type)&&L3[t.type](t,e)}var B3={Feature:function(t,e){z3(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)z3(n[r].geometry,e)}},L3={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){P3(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)P3(n[r],e,0)},Polygon:function(t,e){j3(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)j3(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)z3(n[r],e)}};function P3(t,e,n){var r,i=-1,a=t.length-n;for(e.lineStart();++i<a;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function j3(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)P3(t[n],e,1);e.polygonEnd()}function U3(t,e){t&&B3.hasOwnProperty(t.type)?B3[t.type](t,e):z3(t,e)}class W3{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=e[r],a=t+i,o=Math.abs(t)<Math.abs(i)?t-(a-i):i-(a-t);o&&(e[n++]=o),t=a}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,r,i=this._n,a=0;if(i>0){for(a=t[--i];i>0&&(e=a,n=t[--i],a=e+n,r=n-(a-e),!r););i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(n=2*r,e=a+n,n==e-a&&(a=e))}return a}}function V3(){}var q3,G3,H3,Y3,X3=new W3,K3=new W3,$3={point:V3,lineStart:V3,lineEnd:V3,polygonStart:function(){$3.lineStart=Z3,$3.lineEnd=t4},polygonEnd:function(){$3.lineStart=$3.lineEnd=$3.point=V3,X3.add(IF(K3)),K3=new W3},result:function(){var t=X3/2;return X3=new W3,t}};function Z3(){$3.point=Q3}function Q3(t,e){$3.point=J3,q3=H3=t,G3=Y3=e}function J3(t,e){K3.add(Y3*t-H3*e),H3=t,Y3=e}function t4(){J3(q3,G3)}const e4=$3;var n4=1/0,r4=n4,i4=-n4,a4=i4,o4={point:function(t,e){t<n4&&(n4=t);t>i4&&(i4=t);e<r4&&(r4=e);e>a4&&(a4=e)},lineStart:V3,lineEnd:V3,polygonStart:V3,polygonEnd:V3,result:function(){var t=[[n4,r4],[i4,a4]];return i4=a4=-(r4=n4=1/0),t}};const s4=o4;var c4,u4,l4,h4,d4=0,f4=0,p4=0,g4=0,m4=0,y4=0,v4=0,b4=0,x4=0,w4={point:k4,lineStart:_4,lineEnd:C4,polygonStart:function(){w4.lineStart=E4,w4.lineEnd=T4},polygonEnd:function(){w4.point=k4,w4.lineStart=_4,w4.lineEnd=C4},result:function(){var t=x4?[v4/x4,b4/x4]:y4?[g4/y4,m4/y4]:p4?[d4/p4,f4/p4]:[NaN,NaN];return d4=f4=p4=g4=m4=y4=v4=b4=x4=0,t}};function k4(t,e){d4+=t,f4+=e,++p4}function _4(){w4.point=S4}function S4(t,e){w4.point=A4,k4(l4=t,h4=e)}function A4(t,e){var n=t-l4,r=e-h4,i=VF(n*n+r*r);g4+=i*(l4+t)/2,m4+=i*(h4+e)/2,y4+=i,k4(l4=t,h4=e)}function C4(){w4.point=k4}function E4(){w4.point=N4}function T4(){D4(c4,u4)}function N4(t,e){w4.point=D4,k4(c4=l4=t,u4=h4=e)}function D4(t,e){var n=t-l4,r=e-h4,i=VF(n*n+r*r);g4+=i*(l4+t)/2,m4+=i*(h4+e)/2,y4+=i,v4+=(i=h4*t-l4*e)*(l4+t),b4+=i*(h4+e),x4+=3*i,k4(l4=t,h4=e)}const F4=w4;function I4(t){this._context=t}I4.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,NF)}},result:V3};var M4,O4,R4,z4,B4,L4=new W3,P4={point:V3,lineStart:function(){P4.point=j4},lineEnd:function(){M4&&U4(O4,R4),P4.point=V3},polygonStart:function(){M4=!0},polygonEnd:function(){M4=null},result:function(){var t=+L4;return L4=new W3,t}};function j4(t,e){P4.point=U4,O4=z4=t,R4=B4=e}function U4(t,e){z4-=t,B4-=e,L4.add(VF(z4*z4+B4*B4)),z4=t,B4=e}const W4=P4;function V4(){this._string=[]}function q4(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function G4(t,e){var n,r,i=4.5;function a(t){return t&&("function"===typeof i&&r.pointRadius(+i.apply(this,arguments)),U3(t,n(r))),r.result()}return a.area=function(t){return U3(t,n(e4)),e4.result()},a.measure=function(t){return U3(t,n(W4)),W4.result()},a.bounds=function(t){return U3(t,n(s4)),s4.result()},a.centroid=function(t){return U3(t,n(F4)),F4.result()},a.projection=function(e){return arguments.length?(n=null==e?(t=null,R3):(t=e).stream,a):t},a.context=function(t){return arguments.length?(r=null==t?(e=null,new V4):new I4(e=t),"function"!==typeof i&&r.pointRadius(i),a):e},a.pointRadius=function(t){return arguments.length?(i="function"===typeof t?t:(r.pointRadius(+t),+t),a):i},a.projection(t).context(e)}function H4(){var t,e=[];return{point:function(e,n,r){t.push([e,n,r])},lineStart:function(){e.push(t=[])},lineEnd:V3,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Y4(t,e){return IF(t[0]-e[0])<SF&&IF(t[1]-e[1])<SF}function X4(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function K4(t,e,n,r,i){var a,o,s=[],c=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],o=t[e];if(Y4(r,o)){if(!r[2]&&!o[2]){for(i.lineStart(),a=0;a<e;++a)i.point((r=t[a])[0],r[1]);return void i.lineEnd()}o[0]+=2*SF}s.push(n=new X4(r,t,null,!0)),c.push(n.o=new X4(r,null,n,!1)),s.push(n=new X4(o,t,null,!1)),c.push(n.o=new X4(o,null,n,!0))}})),s.length){for(c.sort(e),$4(s),$4(c),a=0,o=c.length;a<o;++a)c[a].e=n=!n;for(var u,l,h=s[0];;){for(var d=h,f=!0;d.v;)if((d=d.n)===h)return;u=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(f)for(a=0,o=u.length;a<o;++a)i.point((l=u[a])[0],l[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(f)for(u=d.p.z,a=u.length-1;a>=0;--a)i.point((l=u[a])[0],l[1]);else r(d.x,d.p.x,-1,i);d=d.p}u=(d=d.o).z,f=!f}while(!d.v);i.lineEnd()}}}function $4(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}function Z4(t){return[OF(t[1],t[0]),HF(t[2])]}function Q4(t){var e=t[0],n=t[1],r=RF(n);return[r*RF(e),r*UF(e),UF(n)]}function J4(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function t5(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function e5(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function n5(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function r5(t){var e=VF(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function i5(t){return IF(t[0])<=CF?t[0]:WF(t[0])*((IF(t[0])+CF)%NF-CF)}function a5(t){return Array.from(function*(t){for(const e of t)yield*e}(t))}function o5(t,e,n,r){return function(i){var a,o,s,c=e(i),u=H4(),l=e(u),h=!1,d={point:f,lineStart:g,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=b,o=[],a=[]},polygonEnd:function(){d.point=f,d.lineStart=g,d.lineEnd=m,o=a5(o);var t=function(t,e){var n=i5(e),r=e[1],i=UF(r),a=[UF(n),-RF(n),0],o=0,s=0,c=new W3;1===i?r=EF+SF:-1===i&&(r=-EF-SF);for(var u=0,l=t.length;u<l;++u)if(d=(h=t[u]).length)for(var h,d,f=h[d-1],p=i5(f),g=f[1]/2+TF,m=UF(g),y=RF(g),v=0;v<d;++v,p=x,m=k,y=_,f=b){var b=h[v],x=i5(b),w=b[1]/2+TF,k=UF(w),_=RF(w),S=x-p,A=S>=0?1:-1,C=A*S,E=C>CF,T=m*k;if(c.add(OF(T*A*UF(C),y*_+T*RF(C))),o+=E?S+A*NF:S,E^p>=n^x>=n){var N=t5(Q4(f),Q4(b));r5(N);var D=t5(a,N);r5(D);var F=(E^S>=0?-1:1)*HF(D[2]);(r>F||r===F&&(N[0]||N[1]))&&(s+=E^S>=0?1:-1)}}return(o<-SF||o<SF&&c<-AF)^1&s}(a,r);o.length?(h||(i.polygonStart(),h=!0),K4(o,c5,t,n,i)):t&&(h||(i.polygonStart(),h=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),o=a=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function f(e,n){t(e,n)&&i.point(e,n)}function p(t,e){c.point(t,e)}function g(){d.point=p,c.lineStart()}function m(){d.point=f,c.lineEnd()}function y(t,e){s.push([t,e]),l.point(t,e)}function v(){l.lineStart(),s=[]}function b(){y(s[0][0],s[0][1]),l.lineEnd();var t,e,n,r,c=l.clean(),d=u.result(),f=d.length;if(s.pop(),a.push(s),s=null,f)if(1&c){if((e=(n=d[0]).length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else f>1&&2&c&&d.push(d.pop().concat(d.shift())),o.push(d.filter(s5))}return d}}function s5(t){return t.length>1}function c5(t,e){return((t=t.x)[0]<0?t[1]-EF-SF:EF-t[1])-((e=e.x)[0]<0?e[1]-EF-SF:EF-e[1])}V4.prototype={_radius:4.5,_circle:q4(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=q4(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}};const u5=o5((function(){return!0}),(function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(a,o){var s=a>0?CF:-CF,c=IF(a-n);IF(c-CF)<SF?(t.point(n,r=(r+o)/2>0?EF:-EF),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(a,r),e=0):i!==s&&c>=CF&&(IF(n-i)<SF&&(n-=i*SF),IF(a-s)<SF&&(a-=s*SF),r=function(t,e,n,r){var i,a,o=UF(t-n);return IF(o)>SF?MF((UF(e)*(a=RF(r))*UF(n)-UF(r)*(i=RF(e))*UF(t))/(i*a*o)):(e+r)/2}(n,r,a,o),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=a,r=o),i=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var i;if(null==t)i=n*EF,r.point(-CF,i),r.point(0,i),r.point(CF,i),r.point(CF,0),r.point(CF,-i),r.point(0,-i),r.point(-CF,-i),r.point(-CF,0),r.point(-CF,i);else if(IF(t[0]-e[0])>SF){var a=t[0]<e[0]?CF:-CF;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(e[0],e[1])}),[-CF,-EF]);function l5(t,e,n,r,i,a){if(n){var o=RF(e),s=UF(e),c=r*n;null==i?(i=e+r*NF,a=e-c/2):(i=h5(o,i),a=h5(o,a),(r>0?i<a:i>a)&&(i+=r*NF));for(var u,l=i;r>0?l>a:l<a;l-=c)u=Z4([o,-s*RF(l),-s*UF(l)]),t.point(u[0],u[1])}}function h5(t,e){(e=Q4(e))[0]-=t,r5(e);var n=GF(-e[1]);return((-e[2]<0?-n:n)+NF-SF)%NF}var d5=1e9,f5=-d5;function p5(t,e,n,r){function i(i,a){return t<=i&&i<=n&&e<=a&&a<=r}function a(i,a,s,u){var l=0,h=0;if(null==i||(l=o(i,s))!==(h=o(a,s))||c(i,a)<0^s>0)do{u.point(0===l||3===l?t:n,l>1?r:e)}while((l=(l+s+4)%4)!==h);else u.point(a[0],a[1])}function o(r,i){return IF(r[0]-t)<SF?i>0?0:3:IF(r[0]-n)<SF?i>0?2:1:IF(r[1]-e)<SF?i>0?1:0:i>0?3:2}function s(t,e){return c(t.x,e.x)}function c(t,e){var n=o(t,1),r=o(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(o){var c,u,l,h,d,f,p,g,m,y,v,b=o,x=H4(),w={point:k,lineStart:function(){w.point=_,u&&u.push(l=[]);y=!0,m=!1,p=g=NaN},lineEnd:function(){c&&(_(h,d),f&&m&&x.rejoin(),c.push(x.result()));w.point=k,m&&b.lineEnd()},polygonStart:function(){b=x,c=[],u=[],v=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=u.length;n<i;++n)for(var a,o,s=u[n],c=1,l=s.length,h=s[0],d=h[0],f=h[1];c<l;++c)a=d,o=f,d=(h=s[c])[0],f=h[1],o<=r?f>r&&(d-a)*(r-o)>(f-o)*(t-a)&&++e:f<=r&&(d-a)*(r-o)<(f-o)*(t-a)&&--e;return e}(),n=v&&e,i=(c=a5(c)).length;(n||i)&&(o.polygonStart(),n&&(o.lineStart(),a(null,null,1,o),o.lineEnd()),i&&K4(c,s,e,a,o),o.polygonEnd());b=o,c=u=l=null}};function k(t,e){i(t,e)&&b.point(t,e)}function _(a,o){var s=i(a,o);if(u&&l.push([a,o]),y)h=a,d=o,f=s,y=!1,s&&(b.lineStart(),b.point(a,o));else if(s&&m)b.point(a,o);else{var c=[p=Math.max(f5,Math.min(d5,p)),g=Math.max(f5,Math.min(d5,g))],x=[a=Math.max(f5,Math.min(d5,a)),o=Math.max(f5,Math.min(d5,o))];!function(t,e,n,r,i,a){var o,s=t[0],c=t[1],u=0,l=1,h=e[0]-s,d=e[1]-c;if(o=n-s,h||!(o>0)){if(o/=h,h<0){if(o<u)return;o<l&&(l=o)}else if(h>0){if(o>l)return;o>u&&(u=o)}if(o=i-s,h||!(o<0)){if(o/=h,h<0){if(o>l)return;o>u&&(u=o)}else if(h>0){if(o<u)return;o<l&&(l=o)}if(o=r-c,d||!(o>0)){if(o/=d,d<0){if(o<u)return;o<l&&(l=o)}else if(d>0){if(o>l)return;o>u&&(u=o)}if(o=a-c,d||!(o<0)){if(o/=d,d<0){if(o>l)return;o>u&&(u=o)}else if(d>0){if(o<u)return;o<l&&(l=o)}return u>0&&(t[0]=s+u*h,t[1]=c+u*d),l<1&&(e[0]=s+l*h,e[1]=c+l*d),!0}}}}}(c,x,t,e,n,r)?s&&(b.lineStart(),b.point(a,o),v=!1):(m||(b.lineStart(),b.point(c[0],c[1])),b.point(x[0],x[1]),s||b.lineEnd(),v=!1)}p=a,g=o,m=s}return w}}function g5(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n}function m5(t,e){return[IF(t)>CF?t+Math.round(-t/NF)*NF:t,e]}function y5(t,e,n){return(t%=NF)?e||n?g5(b5(t),x5(e,n)):b5(t):e||n?x5(e,n):m5}function v5(t){return function(e,n){return[(e+=t)>CF?e-NF:e<-CF?e+NF:e,n]}}function b5(t){var e=v5(t);return e.invert=v5(-t),e}function x5(t,e){var n=RF(t),r=UF(t),i=RF(e),a=UF(e);function o(t,e){var o=RF(e),s=RF(t)*o,c=UF(t)*o,u=UF(e),l=u*n+s*r;return[OF(c*i-l*a,s*n-u*r),HF(l*i+c*a)]}return o.invert=function(t,e){var o=RF(e),s=RF(t)*o,c=UF(t)*o,u=UF(e),l=u*i-c*a;return[OF(c*i+u*a,s*n+l*r),HF(l*n-s*r)]},o}function w5(t){return function(e){var n=new k5;for(var r in t)n[r]=t[r];return n.stream=e,n}}function k5(){}function _5(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),U3(n,t.stream(s4)),e(s4.result()),null!=r&&t.clipExtent(r),t}function S5(t,e,n){return _5(t,(function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],a=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),o=+e[0][0]+(r-a*(n[1][0]+n[0][0]))/2,s=+e[0][1]+(i-a*(n[1][1]+n[0][1]))/2;t.scale(150*a).translate([o,s])}),n)}function A5(t,e,n){return S5(t,[[0,0],e],n)}function C5(t,e,n){return _5(t,(function(n){var r=+e,i=r/(n[1][0]-n[0][0]),a=(r-i*(n[1][0]+n[0][0]))/2,o=-i*n[0][1];t.scale(150*i).translate([a,o])}),n)}function E5(t,e,n){return _5(t,(function(n){var r=+e,i=r/(n[1][1]-n[0][1]),a=-i*n[0][0],o=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([a,o])}),n)}m5.invert=m5,k5.prototype={constructor:k5,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var T5=16,N5=RF(30*FF);function D5(t,e){return+e?function(t,e){function n(r,i,a,o,s,c,u,l,h,d,f,p,g,m){var y=u-r,v=l-i,b=y*y+v*v;if(b>4*e&&g--){var x=o+d,w=s+f,k=c+p,_=VF(x*x+w*w+k*k),S=HF(k/=_),A=IF(IF(k)-1)<SF||IF(a-h)<SF?(a+h)/2:OF(w,x),C=t(A,S),E=C[0],T=C[1],N=E-r,D=T-i,F=v*N-y*D;(F*F/b>e||IF((y*N+v*D)/b-.5)>.3||o*d+s*f+c*p<N5)&&(n(r,i,a,o,s,c,E,T,A,x/=_,w/=_,k,g,m),m.point(E,T),n(E,T,A,x,w,k,u,l,h,d,f,p,g,m))}}return function(e){var r,i,a,o,s,c,u,l,h,d,f,p,g={point:m,lineStart:y,lineEnd:b,polygonStart:function(){e.polygonStart(),g.lineStart=x},polygonEnd:function(){e.polygonEnd(),g.lineStart=y}};function m(n,r){n=t(n,r),e.point(n[0],n[1])}function y(){l=NaN,g.point=v,e.lineStart()}function v(r,i){var a=Q4([r,i]),o=t(r,i);n(l,h,u,d,f,p,l=o[0],h=o[1],u=r,d=a[0],f=a[1],p=a[2],T5,e),e.point(l,h)}function b(){g.point=m,e.lineEnd()}function x(){y(),g.point=w,g.lineEnd=k}function w(t,e){v(r=t,e),i=l,a=h,o=d,s=f,c=p,g.point=v}function k(){n(l,h,u,d,f,p,i,a,r,o,s,c,T5,e),g.lineEnd=b,b()}return g}}(t,e):function(t){return w5({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var F5=w5({point:function(t,e){this.stream.point(t*FF,e*FF)}});function I5(t,e,n,r,i,a){if(!a)return function(t,e,n,r,i){function a(a,o){return[e+t*(a*=r),n-t*(o*=i)]}return a.invert=function(a,o){return[(a-e)/t*r,(n-o)/t*i]},a}(t,e,n,r,i);var o=RF(a),s=UF(a),c=o*t,u=s*t,l=o/t,h=s/t,d=(s*n-o*e)/t,f=(s*e+o*n)/t;function p(t,a){return[c*(t*=r)-u*(a*=i)+e,n-u*t-c*a]}return p.invert=function(t,e){return[r*(l*t-h*e+d),i*(f-h*t-l*e)]},p}function M5(t){return O5((function(){return t}))()}function O5(t){var e,n,r,i,a,o,s,c,u,l,h=150,d=480,f=250,p=0,g=0,m=0,y=0,v=0,b=0,x=1,w=1,k=null,_=u5,S=null,A=R3,C=.5;function E(t){return c(t[0]*FF,t[1]*FF)}function T(t){return(t=c.invert(t[0],t[1]))&&[t[0]*DF,t[1]*DF]}function N(){var t=I5(h,0,0,x,w,b).apply(null,e(p,g)),r=I5(h,d-t[0],f-t[1],x,w,b);return n=y5(m,y,v),s=g5(e,r),c=g5(n,s),o=D5(s,C),D()}function D(){return u=l=null,E}return E.stream=function(t){return u&&l===t?u:u=F5(function(t){return w5({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}(n)(_(o(A(l=t)))))},E.preclip=function(t){return arguments.length?(_=t,k=void 0,D()):_},E.postclip=function(t){return arguments.length?(A=t,S=r=i=a=null,D()):A},E.clipAngle=function(t){return arguments.length?(_=+t?function(t){var e=RF(t),n=6*FF,r=e>0,i=IF(e)>SF;function a(t,n){return RF(t)*RF(n)>e}function o(t,n,r){var i=[1,0,0],a=t5(Q4(t),Q4(n)),o=J4(a,a),s=a[0],c=o-s*s;if(!c)return!r&&t;var u=e*o/c,l=-e*s/c,h=t5(i,a),d=n5(i,u);e5(d,n5(a,l));var f=h,p=J4(d,f),g=J4(f,f),m=p*p-g*(J4(d,d)-1);if(!(m<0)){var y=VF(m),v=n5(f,(-p-y)/g);if(e5(v,d),v=Z4(v),!r)return v;var b,x=t[0],w=n[0],k=t[1],_=n[1];w<x&&(b=x,x=w,w=b);var S=w-x,A=IF(S-CF)<SF;if(!A&&_<k&&(b=k,k=_,_=b),A||S<SF?A?k+_>0^v[1]<(IF(v[0]-x)<SF?k:_):k<=v[1]&&v[1]<=_:S>CF^(x<=v[0]&&v[0]<=w)){var C=n5(f,(-p+y)/g);return e5(C,d),[v,Z4(C)]}}}function s(e,n){var i=r?t:CF-t,a=0;return e<-i?a|=1:e>i&&(a|=2),n<-i?a|=4:n>i&&(a|=8),a}return o5(a,(function(t){var e,n,c,u,l;return{lineStart:function(){u=c=!1,l=1},point:function(h,d){var f,p=[h,d],g=a(h,d),m=r?g?0:s(h,d):g?s(h+(h<0?CF:-CF),d):0;if(!e&&(u=c=g)&&t.lineStart(),g!==c&&(!(f=o(e,p))||Y4(e,f)||Y4(p,f))&&(p[2]=1),g!==c)l=0,g?(t.lineStart(),f=o(p,e),t.point(f[0],f[1])):(f=o(e,p),t.point(f[0],f[1],2),t.lineEnd()),e=f;else if(i&&e&&r^g){var y;m&n||!(y=o(p,e,!0))||(l=0,r?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1],3)))}!g||e&&Y4(e,p)||t.point(p[0],p[1]),e=p,c=g,n=m},lineEnd:function(){c&&t.lineEnd(),e=null},clean:function(){return l|(u&&c)<<1}}}),(function(e,r,i,a){l5(a,t,n,i,e,r)}),r?[0,-t]:[-CF,t-CF])}(k=t*FF):(k=null,u5),D()):k*DF},E.clipExtent=function(t){return arguments.length?(A=null==t?(S=r=i=a=null,R3):p5(S=+t[0][0],r=+t[0][1],i=+t[1][0],a=+t[1][1]),D()):null==S?null:[[S,r],[i,a]]},E.scale=function(t){return arguments.length?(h=+t,N()):h},E.translate=function(t){return arguments.length?(d=+t[0],f=+t[1],N()):[d,f]},E.center=function(t){return arguments.length?(p=t[0]%360*FF,g=t[1]%360*FF,N()):[p*DF,g*DF]},E.rotate=function(t){return arguments.length?(m=t[0]%360*FF,y=t[1]%360*FF,v=t.length>2?t[2]%360*FF:0,N()):[m*DF,y*DF,v*DF]},E.angle=function(t){return arguments.length?(b=t%360*FF,N()):b*DF},E.reflectX=function(t){return arguments.length?(x=t?-1:1,N()):x<0},E.reflectY=function(t){return arguments.length?(w=t?-1:1,N()):w<0},E.precision=function(t){return arguments.length?(o=D5(s,C=t*t),D()):VF(C)},E.fitExtent=function(t,e){return S5(E,t,e)},E.fitSize=function(t,e){return A5(E,t,e)},E.fitWidth=function(t,e){return C5(E,t,e)},E.fitHeight=function(t,e){return E5(E,t,e)},function(){return e=t.apply(this,arguments),E.invert=e.invert&&T,N()}}function R5(t){var e=0,n=CF/3,r=O5(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*FF,n=t[1]*FF):[e*DF,n*DF]},i}function z5(t,e){var n=UF(t),r=(n+UF(e))/2;if(IF(r)<SF)return function(t){var e=RF(t);function n(t,n){return[t*e,UF(n)/e]}return n.invert=function(t,n){return[t/e,HF(n*e)]},n}(t);var i=1+n*(2*r-n),a=VF(i)/r;function o(t,e){var n=VF(i-2*r*UF(e))/r;return[n*UF(t*=r),a-n*RF(t)]}return o.invert=function(t,e){var n=a-e,o=OF(t,IF(n))*WF(n);return n*r<0&&(o-=CF*WF(t)*WF(n)),[o/r,HF((i-(t*t+n*n)*r*r)/(2*r))]},o}function B5(){return R5(z5).scale(155.424).center([0,33.6442])}function L5(){return B5().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function P5(t){return function(e,n){var r=RF(e),i=RF(n),a=t(r*i);return a===1/0?[2,0]:[a*i*UF(e),a*UF(n)]}}function j5(t){return function(e,n){var r=VF(e*e+n*n),i=t(r),a=UF(i),o=RF(i);return[OF(e*a,r*o),HF(r&&n*a/r)]}}var U5=P5((function(t){return VF(2/(1+t))}));U5.invert=j5((function(t){return 2*HF(t/2)}));var W5=P5((function(t){return(t=GF(t))&&t/UF(t)}));function V5(t,e){return[t,PF(qF((EF+e)/2))]}function q5(t){var e,n,r,i=M5(t),a=i.center,o=i.scale,s=i.translate,c=i.clipExtent,u=null;function l(){var a=CF*o(),s=i(function(t){function e(e){return(e=t(e[0]*FF,e[1]*FF))[0]*=DF,e[1]*=DF,e}return t=y5(t[0]*FF,t[1]*FF,t.length>2?t[2]*FF:0),e.invert=function(e){return(e=t.invert(e[0]*FF,e[1]*FF))[0]*=DF,e[1]*=DF,e},e}(i.rotate()).invert([0,0]));return c(null==u?[[s[0]-a,s[1]-a],[s[0]+a,s[1]+a]]:t===V5?[[Math.max(s[0]-a,u),e],[Math.min(s[0]+a,n),r]]:[[u,Math.max(s[1]-a,e)],[n,Math.min(s[1]+a,r)]])}return i.scale=function(t){return arguments.length?(o(t),l()):o()},i.translate=function(t){return arguments.length?(s(t),l()):s()},i.center=function(t){return arguments.length?(a(t),l()):a()},i.clipExtent=function(t){return arguments.length?(null==t?u=e=n=r=null:(u=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),l()):null==u?null:[[u,e],[n,r]]},l()}function G5(t){return qF((EF+t)/2)}function H5(t,e){var n=RF(t),r=t===e?UF(t):PF(n/RF(e))/PF(G5(e)/G5(t)),i=n*jF(G5(t),r)/r;if(!r)return V5;function a(t,e){i>0?e<-EF+SF&&(e=-EF+SF):e>EF-SF&&(e=EF-SF);var n=i/jF(G5(e),r);return[n*UF(r*t),i-n*RF(r*t)]}return a.invert=function(t,e){var n=i-e,a=WF(r)*VF(t*t+n*n),o=OF(t,IF(n))*WF(n);return n*r<0&&(o-=CF*WF(t)*WF(n)),[o/r,2*MF(jF(i/a,1/r))-EF]},a}function Y5(t,e){return[t,e]}function X5(t,e){var n=RF(t),r=t===e?UF(t):(n-RF(e))/(e-t),i=n/r+t;if(IF(r)<SF)return Y5;function a(t,e){var n=i-e,a=r*t;return[n*UF(a),i-n*RF(a)]}return a.invert=function(t,e){var n=i-e,a=OF(t,IF(n))*WF(n);return n*r<0&&(a-=CF*WF(t)*WF(n)),[a/r,i-WF(r)*VF(t*t+n*n)]},a}W5.invert=j5((function(t){return t})),V5.invert=function(t,e){return[t,2*MF(BF(e))-EF]},Y5.invert=Y5;var K5=1.340264,$5=-.081106,Z5=893e-6,Q5=.003796,J5=VF(3)/2;function t6(t,e){var n=HF(J5*UF(e)),r=n*n,i=r*r*r;return[t*RF(n)/(J5*(K5+3*$5*r+i*(7*Z5+9*Q5*r))),n*(K5+$5*r+i*(Z5+Q5*r))]}function e6(t,e){var n=RF(e),r=RF(t)*n;return[n*UF(t)/r,UF(e)/r]}function n6(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function r6(t,e){return[RF(e)*UF(t),UF(e)]}function i6(t,e){var n=RF(e),r=1+RF(t)*n;return[n*UF(t)/r,UF(e)/r]}function a6(t,e){return[PF(qF((EF+e)/2)),-t]}t6.invert=function(t,e){for(var n,r=e,i=r*r,a=i*i*i,o=0;o<12&&(a=(i=(r-=n=(r*(K5+$5*i+a*(Z5+Q5*i))-e)/(K5+3*$5*i+a*(7*Z5+9*Q5*i)))*r)*i*i,!(IF(n)<AF));++o);return[J5*t*(K5+3*$5*i+a*(7*Z5+9*Q5*i))/RF(r),HF(UF(r)/J5)]},e6.invert=j5(MF),n6.invert=function(t,e){var n,r=e,i=25;do{var a=r*r,o=a*a;r-=n=(r*(1.007226+a*(.015085+o*(.028874*a-.044475-.005916*o)))-e)/(1.007226+a*(.045255+o*(.259866*a-.311325-.005916*11*o)))}while(IF(n)>SF&&--i>0);return[t/(.8707+(a=r*r)*(a*(a*a*a*(.003971-.001529*a)-.013791)-.131979)),r]},r6.invert=j5(HF),i6.invert=j5((function(t){return 2*MF(t)})),a6.invert=function(t,e){return[-e,2*MF(BF(t))-EF]};var o6=Math.abs,s6=(Math.atan,Math.atan2,Math.ceil,Math.cos),c6=(Math.exp,Math.floor,Math.log,Math.max,Math.min,Math.pow,Math.round,Math.sign,Math.sin),u6=(Math.tan,1e-6),l6=Math.PI,h6=l6/2,d6=(Math.SQRT1_2,p6(2));p6(l6);function f6(t){return t>1?h6:t<-1?-h6:Math.asin(t)}function p6(t){return t>0?Math.sqrt(t):0}function g6(t,e){var n,r=t*c6(e),i=30;do{e-=n=(e+c6(e)-r)/(1+s6(e))}while(o6(n)>u6&&--i>0);return e/2}var m6=function(t,e,n){function r(r,i){return[t*r*s6(i=g6(n,i)),e*c6(i)]}return r.invert=function(r,i){return i=f6(i/e),[r/(t*s6(i)),f6((2*i+c6(2*i))/n)]},r}(d6/h6,d6,l6);G4();const y6=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function v6(t,e){if(!t||"string"!==typeof t)throw new Error("Projection type must be a name string.");return t=t.toLowerCase(),arguments.length>1?(b6[t]=function(t,e){return function n(){const r=e();return r.type=t,r.path=G4().projection(r),r.copy=r.copy||function(){const t=n();return y6.forEach((e=>{r[e]&&t[e](r[e]())})),t.path.pointRadius(r.path.pointRadius()),t},r}}(t,e),this):b6[t]||null}const b6={albers:L5,albersusa:function(){var t,e,n,r,i,a,o=L5(),s=B5().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=B5().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(t,e){a=[t,e]}};function l(t){var e=t[0],o=t[1];return a=null,n.point(e,o),a||(r.point(e,o),a)||(i.point(e,o),a)}function h(){return t=e=null,l}return l.invert=function(t){var e=o.scale(),n=o.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?c:o).invert(t)},l.stream=function(n){return t&&e===n?t:t=function(t){var e=t.length;return{point:function(n,r){for(var i=-1;++i<e;)t[i].point(n,r)},sphere:function(){for(var n=-1;++n<e;)t[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)t[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)t[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)t[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)t[n].polygonEnd()}}}([o.stream(e=n),s.stream(n),c.stream(n)])},l.precision=function(t){return arguments.length?(o.precision(t),s.precision(t),c.precision(t),h()):o.precision()},l.scale=function(t){return arguments.length?(o.scale(t),s.scale(.35*t),c.scale(t),l.translate(o.translate())):o.scale()},l.translate=function(t){if(!arguments.length)return o.translate();var e=o.scale(),a=+t[0],l=+t[1];return n=o.translate(t).clipExtent([[a-.455*e,l-.238*e],[a+.455*e,l+.238*e]]).stream(u),r=s.translate([a-.307*e,l+.201*e]).clipExtent([[a-.425*e+SF,l+.12*e+SF],[a-.214*e-SF,l+.234*e-SF]]).stream(u),i=c.translate([a-.205*e,l+.212*e]).clipExtent([[a-.214*e+SF,l+.166*e+SF],[a-.115*e-SF,l+.234*e-SF]]).stream(u),h()},l.fitExtent=function(t,e){return S5(l,t,e)},l.fitSize=function(t,e){return A5(l,t,e)},l.fitWidth=function(t,e){return C5(l,t,e)},l.fitHeight=function(t,e){return E5(l,t,e)},l.scale(1070)},azimuthalequalarea:function(){return M5(U5).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return M5(W5).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return R5(H5).scale(109.5).parallels([30,30])},conicequalarea:B5,conicequidistant:function(){return R5(X5).scale(131.154).center([0,13.9389])},equalEarth:function(){return M5(t6).scale(177.158)},equirectangular:function(){return M5(Y5).scale(152.63)},gnomonic:function(){return M5(e6).scale(144.049).clipAngle(60)},identity:function(){var t,e,n,r,i,a,o,s=1,c=0,u=0,l=1,h=1,d=0,f=null,p=1,g=1,m=w5({point:function(t,e){var n=b([t,e]);this.stream.point(n[0],n[1])}}),y=R3;function v(){return p=s*l,g=s*h,a=o=null,b}function b(n){var r=n[0]*p,i=n[1]*g;if(d){var a=i*t-r*e;r=r*t+i*e,i=a}return[r+c,i+u]}return b.invert=function(n){var r=n[0]-c,i=n[1]-u;if(d){var a=i*t+r*e;r=r*t-i*e,i=a}return[r/p,i/g]},b.stream=function(t){return a&&o===t?a:a=m(y(o=t))},b.postclip=function(t){return arguments.length?(y=t,f=n=r=i=null,v()):y},b.clipExtent=function(t){return arguments.length?(y=null==t?(f=n=r=i=null,R3):p5(f=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),v()):null==f?null:[[f,n],[r,i]]},b.scale=function(t){return arguments.length?(s=+t,v()):s},b.translate=function(t){return arguments.length?(c=+t[0],u=+t[1],v()):[c,u]},b.angle=function(n){return arguments.length?(e=UF(d=n%360*FF),t=RF(d),v()):d*DF},b.reflectX=function(t){return arguments.length?(l=t?-1:1,v()):l<0},b.reflectY=function(t){return arguments.length?(h=t?-1:1,v()):h<0},b.fitExtent=function(t,e){return S5(b,t,e)},b.fitSize=function(t,e){return A5(b,t,e)},b.fitWidth=function(t,e){return C5(b,t,e)},b.fitHeight=function(t,e){return E5(b,t,e)},b},mercator:function(){return q5(V5).scale(961/NF)},mollweide:function(){return M5(m6).scale(169.529)},naturalEarth1:function(){return M5(n6).scale(175.295)},orthographic:function(){return M5(r6).scale(249.5).clipAngle(90+SF)},stereographic:function(){return M5(i6).scale(250).clipAngle(142)},transversemercator:function(){var t=q5(a6),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)}};for(const Set in b6)v6(Set,b6[Set]);const x6="Literal",w6="Property",k6="ArrayExpression",_6="BinaryExpression",S6="CallExpression",A6="ConditionalExpression",C6="LogicalExpression",E6="MemberExpression",T6="ObjectExpression",N6="UnaryExpression";function D6(t){this.type=t}var F6,I6,M6,O6,R6;D6.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=function(t){switch(t.type){case k6:return t.elements;case _6:case C6:return[t.left,t.right];case S6:return[t.callee].concat(t.arguments);case A6:return[t.test,t.consequent,t.alternate];case E6:return[t.object,t.property];case T6:return t.properties;case w6:return[t.key,t.value];case N6:return[t.argument];default:return[]}}(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1};var z6=1,B6=2,L6=3,P6=4,j6=5,U6=6,W6=7,V6=8;(F6={})[z6]="Boolean",F6[B6]="<end>",F6[L6]="Identifier",F6[P6]="Keyword",F6[j6]="Null",F6[U6]="Numeric",F6[W6]="Punctuator",F6[V6]="String",F6[9]="RegularExpression";var q6="ArrayExpression",G6="BinaryExpression",H6="CallExpression",Y6="ConditionalExpression",X6="Identifier",K6="Literal",$6="LogicalExpression",Z6="MemberExpression",Q6="ObjectExpression",J6="Property",t8="UnaryExpression",e8="Unexpected token %0",n8="Unexpected number",r8="Unexpected string",i8="Unexpected identifier",a8="Unexpected reserved word",o8="Unexpected end of input",s8="Invalid regular expression",c8="Invalid regular expression: missing /",u8="Octal literals are not allowed in strict mode.",l8="Duplicate data property in object literal not allowed in strict mode",h8="ILLEGAL",d8="Disabled.",f8=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),p8=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function g8(t,e){if(!t)throw new Error("ASSERT: "+e)}function m8(t){return t>=48&&t<=57}function y8(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function v8(t){return"01234567".indexOf(t)>=0}function b8(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function x8(t){return 10===t||13===t||8232===t||8233===t}function w8(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||t>=128&&f8.test(String.fromCharCode(t))}function k8(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||t>=128&&p8.test(String.fromCharCode(t))}const _8={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function S8(){for(;M6<O6;){const t=I6.charCodeAt(M6);if(!b8(t)&&!x8(t))break;++M6}}function A8(t){var e,n,r,i=0;for(n="u"===t?4:2,e=0;e<n;++e)M6<O6&&y8(I6[M6])?(r=I6[M6++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):U8({},e8,h8);return String.fromCharCode(i)}function C8(){var t,e,n,r;for(e=0,"}"===(t=I6[M6])&&U8({},e8,h8);M6<O6&&y8(t=I6[M6++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||"}"!==t)&&U8({},e8,h8),e<=65535?String.fromCharCode(e):(n=55296+(e-65536>>10),r=56320+(e-65536&1023),String.fromCharCode(n,r))}function E8(){var t,e;for(t=I6.charCodeAt(M6++),e=String.fromCharCode(t),92===t&&(117!==I6.charCodeAt(M6)&&U8({},e8,h8),++M6,(t=A8("u"))&&"\\"!==t&&w8(t.charCodeAt(0))||U8({},e8,h8),e=t);M6<O6&&k8(t=I6.charCodeAt(M6));)++M6,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==I6.charCodeAt(M6)&&U8({},e8,h8),++M6,(t=A8("u"))&&"\\"!==t&&k8(t.charCodeAt(0))||U8({},e8,h8),e+=t);return e}function T8(){var t,e;return t=M6,e=92===I6.charCodeAt(M6)?E8():function(){var t,e;for(t=M6++;M6<O6;){if(92===(e=I6.charCodeAt(M6)))return M6=t,E8();if(!k8(e))break;++M6}return I6.slice(t,M6)}(),{type:1===e.length?L6:_8.hasOwnProperty(e)?P6:"null"===e?j6:"true"===e||"false"===e?z6:L6,value:e,start:t,end:M6}}function N8(){var t,e,n,r,i=M6,a=I6.charCodeAt(M6),o=I6[M6];switch(a){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++M6,{type:W6,value:String.fromCharCode(a),start:i,end:M6};default:if(61===(t=I6.charCodeAt(M6+1)))switch(a){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return M6+=2,{type:W6,value:String.fromCharCode(a)+String.fromCharCode(t),start:i,end:M6};case 33:case 61:return M6+=2,61===I6.charCodeAt(M6)&&++M6,{type:W6,value:I6.slice(i,M6),start:i,end:M6}}}return">>>="===(r=I6.substr(M6,4))?{type:W6,value:r,start:i,end:M6+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:W6,value:n,start:i,end:M6+=3}:o===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(o)>=0||"=>"===e?{type:W6,value:e,start:i,end:M6+=2}:("//"===e&&U8({},e8,h8),"<>=!+-*%&|^/".indexOf(o)>=0?(++M6,{type:W6,value:o,start:i,end:M6}):void U8({},e8,h8))}function D8(){var t,e,n;if(g8(m8((n=I6[M6]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),e=M6,t="","."!==n){if(t=I6[M6++],n=I6[M6],"0"===t){if("x"===n||"X"===n)return++M6,function(t){let e="";for(;M6<O6&&y8(I6[M6]);)e+=I6[M6++];return 0===e.length&&U8({},e8,h8),w8(I6.charCodeAt(M6))&&U8({},e8,h8),{type:U6,value:parseInt("0x"+e,16),start:t,end:M6}}(e);if(v8(n))return function(t){let e="0"+I6[M6++];for(;M6<O6&&v8(I6[M6]);)e+=I6[M6++];return(w8(I6.charCodeAt(M6))||m8(I6.charCodeAt(M6)))&&U8({},e8,h8),{type:U6,value:parseInt(e,8),octal:!0,start:t,end:M6}}(e);n&&m8(n.charCodeAt(0))&&U8({},e8,h8)}for(;m8(I6.charCodeAt(M6));)t+=I6[M6++];n=I6[M6]}if("."===n){for(t+=I6[M6++];m8(I6.charCodeAt(M6));)t+=I6[M6++];n=I6[M6]}if("e"===n||"E"===n)if(t+=I6[M6++],"+"!==(n=I6[M6])&&"-"!==n||(t+=I6[M6++]),m8(I6.charCodeAt(M6)))for(;m8(I6.charCodeAt(M6));)t+=I6[M6++];else U8({},e8,h8);return w8(I6.charCodeAt(M6))&&U8({},e8,h8),{type:U6,value:parseFloat(t),start:e,end:M6}}function F8(){var t,e,n,r;return R6=null,S8(),t=M6,e=function(){var t,e,n,r;for(g8("/"===(t=I6[M6]),"Regular expression literal must start with a slash"),e=I6[M6++],n=!1,r=!1;M6<O6;)if(e+=t=I6[M6++],"\\"===t)x8((t=I6[M6++]).charCodeAt(0))&&U8({},c8),e+=t;else if(x8(t.charCodeAt(0)))U8({},c8);else if(n)"]"===t&&(n=!1);else{if("/"===t){r=!0;break}"["===t&&(n=!0)}return r||U8({},c8),{value:e.substr(1,e.length-2),literal:e}}(),n=function(){var t,e,n;for(e="",n="";M6<O6&&k8((t=I6[M6]).charCodeAt(0));)++M6,"\\"===t&&M6<O6?U8({},e8,h8):(n+=t,e+=t);return n.search(/[^gimuy]/g)>=0&&U8({},s8,n),{value:n,literal:e}}(),r=function(t,e){let n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,((t,e)=>{if(parseInt(e,16)<=1114111)return"x";U8({},s8)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){U8({},s8)}try{return new RegExp(t,e)}catch(i){return null}}(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:M6}}function I8(){if(S8(),M6>=O6)return{type:B6,start:M6,end:M6};const t=I6.charCodeAt(M6);return w8(t)?T8():40===t||41===t||59===t?N8():39===t||34===t?function(){var t,e,n,r,i="",a=!1;for(g8("'"===(t=I6[M6])||'"'===t,"String literal must starts with a quote"),e=M6,++M6;M6<O6;){if((n=I6[M6++])===t){t="";break}if("\\"===n)if((n=I6[M6++])&&x8(n.charCodeAt(0)))"\r"===n&&"\n"===I6[M6]&&++M6;else switch(n){case"u":case"x":"{"===I6[M6]?(++M6,i+=C8()):i+=A8(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:v8(n)?(0!==(r="01234567".indexOf(n))&&(a=!0),M6<O6&&v8(I6[M6])&&(a=!0,r=8*r+"01234567".indexOf(I6[M6++]),"0123".indexOf(n)>=0&&M6<O6&&v8(I6[M6])&&(r=8*r+"01234567".indexOf(I6[M6++]))),i+=String.fromCharCode(r)):i+=n}else{if(x8(n.charCodeAt(0)))break;i+=n}}return""!==t&&U8({},e8,h8),{type:V6,value:i,octal:a,start:e,end:M6}}():46===t?m8(I6.charCodeAt(M6+1))?D8():N8():m8(t)?D8():N8()}function M8(){const t=R6;return M6=t.end,R6=I8(),M6=t.end,t}function O8(){const t=M6;R6=I8(),M6=t}function R8(t,e,n){const r=new D6("||"===t||"&&"===t?$6:G6);return r.operator=t,r.left=e,r.right=n,r}function z8(t,e){const n=new D6(H6);return n.callee=t,n.arguments=e,n}function B8(t){const e=new D6(X6);return e.name=t,e}function L8(t){const e=new D6(K6);return e.value=t.value,e.raw=I6.slice(t.start,t.end),t.regex&&("//"===e.raw&&(e.raw="/(?:)/"),e.regex=t.regex),e}function P8(t,e,n){const r=new D6(Z6);return r.computed="["===t,r.object=e,r.property=n,r.computed||(n.member=!0),r}function j8(t,e,n){const r=new D6(J6);return r.key=e,r.value=n,r.kind=t,r}function U8(t,e){var n,r=Array.prototype.slice.call(arguments,2),i=e.replace(/%(\d)/g,((t,e)=>(g8(e<r.length,"Message reference must be in range"),r[e])));throw(n=new Error(i)).index=M6,n.description=i,n}function W8(t){t.type===B6&&U8(t,o8),t.type===U6&&U8(t,n8),t.type===V6&&U8(t,r8),t.type===L6&&U8(t,i8),t.type===P6&&U8(t,a8),U8(t,e8,t.value)}function V8(t){const e=M8();e.type===W6&&e.value===t||W8(e)}function q8(t){return R6.type===W6&&R6.value===t}function G8(t){return R6.type===P6&&R6.value===t}function H8(){const t=[];for(M6=R6.start,V8("[");!q8("]");)q8(",")?(M8(),t.push(null)):(t.push(i7()),q8("]")||V8(","));return M8(),function(t){const e=new D6(q6);return e.elements=t,e}(t)}function Y8(){M6=R6.start;const t=M8();return t.type===V6||t.type===U6?(t.octal&&U8(t,u8),L8(t)):B8(t.value)}function X8(){var t,e,n;return M6=R6.start,(t=R6).type===L6?(n=Y8(),V8(":"),j8("init",n,i7())):t.type!==B6&&t.type!==W6?(e=Y8(),V8(":"),j8("init",e,i7())):void W8(t)}function K8(){var t,e,n=[],r={},i=String;for(M6=R6.start,V8("{");!q8("}");)e="$"+((t=X8()).key.type===X6?t.key.name:i(t.key.value)),Object.prototype.hasOwnProperty.call(r,e)?U8({},l8):r[e]=!0,n.push(t),q8("}")||V8(",");return V8("}"),function(t){const e=new D6(Q6);return e.properties=t,e}(n)}const $8={if:1};function Z8(){var t,e,n;if(q8("("))return function(){V8("(");const t=a7();return V8(")"),t}();if(q8("["))return H8();if(q8("{"))return K8();if(t=R6.type,M6=R6.start,t===L6||$8[R6.value])n=B8(M8().value);else if(t===V6||t===U6)R6.octal&&U8(R6,u8),n=L8(M8());else{if(t===P6)throw new Error(d8);t===z6?((e=M8()).value="true"===e.value,n=L8(e)):t===j6?((e=M8()).value=null,n=L8(e)):q8("/")||q8("/=")?(n=L8(F8()),O8()):W8(M8())}return n}function Q8(){const t=[];if(V8("("),!q8(")"))for(;M6<O6&&(t.push(i7()),!q8(")"));)V8(",");return V8(")"),t}function J8(){M6=R6.start;const t=M8();return function(t){return t.type===L6||t.type===P6||t.type===z6||t.type===j6}(t)||W8(t),B8(t.value)}function t7(){V8("[");const t=a7();return V8("]"),t}function e7(){const t=function(){var t;for(t=Z8();;)if(q8("."))V8("."),t=P8(".",t,J8());else if(q8("("))t=z8(t,Q8());else{if(!q8("["))break;t=P8("[",t,t7())}return t}();if(R6.type===W6&&(q8("++")||q8("--")))throw new Error(d8);return t}function n7(){var t,e;if(R6.type!==W6&&R6.type!==P6)e=e7();else{if(q8("++")||q8("--"))throw new Error(d8);if(q8("+")||q8("-")||q8("~")||q8("!"))t=M8(),e=n7(),e=function(t,e){const n=new D6(t8);return n.operator=t,n.argument=e,n.prefix=!0,n}(t.value,e);else{if(G8("delete")||G8("void")||G8("typeof"))throw new Error(d8);e=e7()}}return e}function r7(t){let e=0;if(t.type!==W6&&t.type!==P6)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function i7(){var t,e;return t=function(){var t,e,n,r,i,a,o,s,c,u;if(t=R6,c=n7(),0===(i=r7(r=R6)))return c;for(r.prec=i,M8(),e=[t,R6],a=[c,r,o=n7()];(i=r7(R6))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)o=a.pop(),s=a.pop().value,c=a.pop(),e.pop(),n=R8(s,c,o),a.push(n);(r=M8()).prec=i,a.push(r),e.push(R6),n=n7(),a.push(n)}for(n=a[u=a.length-1],e.pop();u>1;)e.pop(),n=R8(a[u-1].value,a[u-2],n),u-=2;return n}(),q8("?")&&(M8(),e=i7(),V8(":"),t=function(t,e,n){const r=new D6(Y6);return r.test=t,r.consequent=e,r.alternate=n,r}(t,e,i7())),t}function a7(){const t=i7();if(q8(","))throw new Error(d8);return t}var o7={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function s7(t){function e(e,n,r){return i=>function(e,n,r,i){let a=t(n[0]);return r&&(a=r+"("+a+")",0===r.lastIndexOf("new ",0)&&(a="("+a+")")),a+"."+e+(i<0?"":0===i?"()":"("+n.slice(1).map(t).join(",")+")")}(e,i,n,r)}const n="new Date",r="String",i="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(e){e.length<3&&qe("Missing arguments to clamp function."),e.length>3&&qe("Too many arguments to clamp function.");const n=e.map(t);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:e("getDate",n,0),day:e("getDay",n,0),year:e("getFullYear",n,0),month:e("getMonth",n,0),hours:e("getHours",n,0),minutes:e("getMinutes",n,0),seconds:e("getSeconds",n,0),milliseconds:e("getMilliseconds",n,0),time:e("getTime",n,0),timezoneoffset:e("getTimezoneOffset",n,0),utcdate:e("getUTCDate",n,0),utcday:e("getUTCDay",n,0),utcyear:e("getUTCFullYear",n,0),utcmonth:e("getUTCMonth",n,0),utchours:e("getUTCHours",n,0),utcminutes:e("getUTCMinutes",n,0),utcseconds:e("getUTCSeconds",n,0),utcmilliseconds:e("getUTCMilliseconds",n,0),length:e("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:e("toUpperCase",r,0),lower:e("toLowerCase",r,0),substring:e("substring",r),split:e("split",r),trim:e("trim",r,0),regexp:i,test:e("test",i),if:function(e){e.length<3&&qe("Missing arguments to if function."),e.length>3&&qe("Too many arguments to if function.");const n=e.map(t);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}class c7{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=e[r],a=t+i,o=Math.abs(t)<Math.abs(i)?t-(a-i):i-(a-t);o&&(e[n++]=o),t=a}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,r,i=this._n,a=0;if(i>0){for(a=t[--i];i>0&&(e=a,n=t[--i],a=e+n,r=n-(a-e),!r););i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(n=2*r,e=a+n,n==e-a&&(a=e))}return a}}var u7=1e-6,l7=Math.PI,h7=l7/2,d7=l7/4,f7=2*l7,p7=180/l7,g7=l7/180,m7=Math.abs,y7=(Math.atan,Math.atan2),v7=Math.cos,b7=(Math.ceil,Math.exp,Math.floor,Math.hypot),x7=(Math.log,Math.pow,Math.sin),w7=(Math.sign,Math.sqrt);Math.tan;function k7(t){return t>1?h7:t<-1?-h7:Math.asin(t)}function _7(){}function S7(t,e){t&&C7.hasOwnProperty(t.type)&&C7[t.type](t,e)}var A7={Feature:function(t,e){S7(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)S7(n[r].geometry,e)}},C7={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){E7(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)E7(n[r],e,0)},Polygon:function(t,e){T7(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)T7(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)S7(n[r],e)}};function E7(t,e,n){var r,i=-1,a=t.length-n;for(e.lineStart();++i<a;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function T7(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)E7(t[n],e,1);e.polygonEnd()}function N7(t,e){t&&A7.hasOwnProperty(t.type)?A7[t.type](t,e):S7(t,e)}var D7,F7,I7,M7,O7,R7,z7,B7,L7,P7,j7,U7,W7,V7,q7,G7,H7=new c7,Y7=new c7,X7={point:_7,lineStart:_7,lineEnd:_7,polygonStart:function(){H7=new c7,X7.lineStart=K7,X7.lineEnd=$7},polygonEnd:function(){var t=+H7;Y7.add(t<0?f7+t:t),this.lineStart=this.lineEnd=this.point=_7},sphere:function(){Y7.add(f7)}};function K7(){X7.point=Z7}function $7(){Q7(D7,F7)}function Z7(t,e){X7.point=Q7,D7=t,F7=e,I7=t*=g7,M7=v7(e=(e*=g7)/2+d7),O7=x7(e)}function Q7(t,e){var n=(t*=g7)-I7,r=n>=0?1:-1,i=r*n,a=v7(e=(e*=g7)/2+d7),o=x7(e),s=O7*o,c=M7*a+s*v7(i),u=s*r*x7(i);H7.add(y7(u,c)),I7=t,M7=a,O7=o}function J7(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}var t9,e9,n9,r9,i9,a9,o9,s9,c9,u9,l9,h9,d9,f9,p9,g9,m9={point:y9,lineStart:b9,lineEnd:x9,polygonStart:function(){m9.point=w9,m9.lineStart=k9,m9.lineEnd=_9,V7=new c7,X7.polygonStart()},polygonEnd:function(){X7.polygonEnd(),m9.point=y9,m9.lineStart=b9,m9.lineEnd=x9,H7<0?(R7=-(B7=180),z7=-(L7=90)):V7>u7?L7=90:V7<-1e-6&&(z7=-90),G7[0]=R7,G7[1]=B7},sphere:function(){R7=-(B7=180),z7=-(L7=90)}};function y9(t,e){q7.push(G7=[R7=t,B7=t]),e<z7&&(z7=e),e>L7&&(L7=e)}function v9(t,e){var n=function(t){var e=t[0],n=t[1],r=v7(n);return[r*v7(e),r*x7(e),x7(n)]}([t*g7,e*g7]);if(W7){var r=J7(W7,n),i=J7([r[1],-r[0],0],r);!function(t){var e=w7(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}(i),i=function(t){return[y7(t[1],t[0]),k7(t[2])]}(i);var a,o=t-P7,s=o>0?1:-1,c=i[0]*p7*s,u=m7(o)>180;u^(s*P7<c&&c<s*t)?(a=i[1]*p7)>L7&&(L7=a):u^(s*P7<(c=(c+360)%360-180)&&c<s*t)?(a=-i[1]*p7)<z7&&(z7=a):(e<z7&&(z7=e),e>L7&&(L7=e)),u?t<P7?S9(R7,t)>S9(R7,B7)&&(B7=t):S9(t,B7)>S9(R7,B7)&&(R7=t):B7>=R7?(t<R7&&(R7=t),t>B7&&(B7=t)):t>P7?S9(R7,t)>S9(R7,B7)&&(B7=t):S9(t,B7)>S9(R7,B7)&&(R7=t)}else q7.push(G7=[R7=t,B7=t]);e<z7&&(z7=e),e>L7&&(L7=e),W7=n,P7=t}function b9(){m9.point=v9}function x9(){G7[0]=R7,G7[1]=B7,m9.point=y9,W7=null}function w9(t,e){if(W7){var n=t-P7;V7.add(m7(n)>180?n+(n>0?360:-360):n)}else j7=t,U7=e;X7.point(t,e),v9(t,e)}function k9(){X7.lineStart()}function _9(){w9(j7,U7),X7.lineEnd(),m7(V7)>u7&&(R7=-(B7=180)),G7[0]=R7,G7[1]=B7,W7=null}function S9(t,e){return(e-=t)<0?e+360:e}function A9(t,e){return t[0]-e[0]}function C9(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var E9={sphere:_7,point:T9,lineStart:D9,lineEnd:M9,polygonStart:function(){E9.lineStart=O9,E9.lineEnd=R9},polygonEnd:function(){E9.lineStart=D9,E9.lineEnd=M9}};function T9(t,e){t*=g7;var n=v7(e*=g7);N9(n*v7(t),n*x7(t),x7(e))}function N9(t,e,n){++t9,n9+=(t-n9)/t9,r9+=(e-r9)/t9,i9+=(n-i9)/t9}function D9(){E9.point=F9}function F9(t,e){t*=g7;var n=v7(e*=g7);f9=n*v7(t),p9=n*x7(t),g9=x7(e),E9.point=I9,N9(f9,p9,g9)}function I9(t,e){t*=g7;var n=v7(e*=g7),r=n*v7(t),i=n*x7(t),a=x7(e),o=y7(w7((o=p9*a-g9*i)*o+(o=g9*r-f9*a)*o+(o=f9*i-p9*r)*o),f9*r+p9*i+g9*a);e9+=o,a9+=o*(f9+(f9=r)),o9+=o*(p9+(p9=i)),s9+=o*(g9+(g9=a)),N9(f9,p9,g9)}function M9(){E9.point=T9}function O9(){E9.point=z9}function R9(){B9(h9,d9),E9.point=T9}function z9(t,e){h9=t,d9=e,t*=g7,e*=g7,E9.point=B9;var n=v7(e);f9=n*v7(t),p9=n*x7(t),g9=x7(e),N9(f9,p9,g9)}function B9(t,e){t*=g7;var n=v7(e*=g7),r=n*v7(t),i=n*x7(t),a=x7(e),o=p9*a-g9*i,s=g9*r-f9*a,c=f9*i-p9*r,u=b7(o,s,c),l=k7(u),h=u&&-l/u;c9.add(h*o),u9.add(h*s),l9.add(h*c),e9+=l,a9+=l*(f9+(f9=r)),o9+=l*(p9+(p9=i)),s9+=l*(g9+(g9=a)),N9(f9,p9,g9)}function L9(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function P9(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function j9(){}var U9=.7,W9=1.4285714285714286,V9="\\s*([+-]?\\d+)\\s*",q9="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",G9="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",H9=/^#([0-9a-f]{3,8})$/,Y9=new RegExp("^rgb\\(".concat(V9,",").concat(V9,",").concat(V9,"\\)$")),X9=new RegExp("^rgb\\(".concat(G9,",").concat(G9,",").concat(G9,"\\)$")),K9=new RegExp("^rgba\\(".concat(V9,",").concat(V9,",").concat(V9,",").concat(q9,"\\)$")),$9=new RegExp("^rgba\\(".concat(G9,",").concat(G9,",").concat(G9,",").concat(q9,"\\)$")),Z9=new RegExp("^hsl\\(".concat(q9,",").concat(G9,",").concat(G9,"\\)$")),Q9=new RegExp("^hsla\\(".concat(q9,",").concat(G9,",").concat(G9,",").concat(q9,"\\)$")),J9={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ttt(){return this.rgb().formatHex()}function ett(){return this.rgb().formatRgb()}function ntt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=H9.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?rtt(e):3===n?new stt(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?itt(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?itt(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Y9.exec(t))?new stt(e[1],e[2],e[3],1):(e=X9.exec(t))?new stt(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=K9.exec(t))?itt(e[1],e[2],e[3],e[4]):(e=$9.exec(t))?itt(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Z9.exec(t))?ftt(e[1],e[2]/100,e[3]/100,1):(e=Q9.exec(t))?ftt(e[1],e[2]/100,e[3]/100,e[4]):J9.hasOwnProperty(t)?rtt(J9[t]):"transparent"===t?new stt(NaN,NaN,NaN,0):null}function rtt(t){return new stt(t>>16&255,t>>8&255,255&t,1)}function itt(t,e,n,r){return r<=0&&(t=e=n=NaN),new stt(t,e,n,r)}function att(t){return t instanceof j9||(t=ntt(t)),t?new stt((t=t.rgb()).r,t.g,t.b,t.opacity):new stt}function ott(t,e,n,r){return 1===arguments.length?att(t):new stt(t,e,n,null==r?1:r)}function stt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function ctt(){return"#".concat(dtt(this.r)).concat(dtt(this.g)).concat(dtt(this.b))}function utt(){const t=ltt(this.opacity);return"".concat(1===t?"rgb(":"rgba(").concat(htt(this.r),", ").concat(htt(this.g),", ").concat(htt(this.b)).concat(1===t?")":", ".concat(t,")"))}function ltt(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function htt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function dtt(t){return((t=htt(t))<16?"0":"")+t.toString(16)}function ftt(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new mtt(t,e,n,r)}function ptt(t){if(t instanceof mtt)return new mtt(t.h,t.s,t.l,t.opacity);if(t instanceof j9||(t=ntt(t)),!t)return new mtt;if(t instanceof mtt)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new mtt(o,s,c,t.opacity)}function gtt(t,e,n,r){return 1===arguments.length?ptt(t):new mtt(t,e,n,null==r?1:r)}function mtt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function ytt(t){return(t=(t||0)%360)<0?t+360:t}function vtt(t){return Math.max(0,Math.min(1,t||0))}function btt(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}L9(j9,ntt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:ttt,formatHex:ttt,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return ptt(this).formatHsl()},formatRgb:ett,toString:ett}),L9(stt,ott,P9(j9,{brighter(t){return t=null==t?W9:Math.pow(W9,t),new stt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?U9:Math.pow(U9,t),new stt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new stt(htt(this.r),htt(this.g),htt(this.b),ltt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ctt,formatHex:ctt,formatHex8:function(){return"#".concat(dtt(this.r)).concat(dtt(this.g)).concat(dtt(this.b)).concat(dtt(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:utt,toString:utt})),L9(mtt,gtt,P9(j9,{brighter(t){return t=null==t?W9:Math.pow(W9,t),new mtt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?U9:Math.pow(U9,t),new mtt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new stt(btt(t>=240?t-240:t+120,i,r),btt(t,i,r),btt(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new mtt(ytt(this.h),vtt(this.s),vtt(this.l),ltt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=ltt(this.opacity);return"".concat(1===t?"hsl(":"hsla(").concat(ytt(this.h),", ").concat(100*vtt(this.s),"%, ").concat(100*vtt(this.l),"%").concat(1===t?")":", ".concat(t,")"))}}));const xtt=Math.PI/180,wtt=180/Math.PI,ktt=.96422,_tt=1,Stt=.82521,Att=4/29,Ctt=6/29,Ett=.12841854934601665,Ttt=.008856451679035631;function Ntt(t){if(t instanceof Ftt)return new Ftt(t.l,t.a,t.b,t.opacity);if(t instanceof Ltt)return Ptt(t);t instanceof stt||(t=att(t));var e,n,r=Rtt(t.r),i=Rtt(t.g),a=Rtt(t.b),o=Itt((.2225045*r+.7168786*i+.0606169*a)/_tt);return r===i&&i===a?e=n=o:(e=Itt((.4360747*r+.3850649*i+.1430804*a)/ktt),n=Itt((.0139322*r+.0971045*i+.7141733*a)/Stt)),new Ftt(116*o-16,500*(e-o),200*(o-n),t.opacity)}function Dtt(t,e,n,r){return 1===arguments.length?Ntt(t):new Ftt(t,e,n,null==r?1:r)}function Ftt(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function Itt(t){return t>Ttt?Math.pow(t,1/3):t/Ett+Att}function Mtt(t){return t>Ctt?t*t*t:Ett*(t-Att)}function Ott(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Rtt(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function ztt(t){if(t instanceof Ltt)return new Ltt(t.h,t.c,t.l,t.opacity);if(t instanceof Ftt||(t=Ntt(t)),0===t.a&&0===t.b)return new Ltt(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*wtt;return new Ltt(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Btt(t,e,n,r){return 1===arguments.length?ztt(t):new Ltt(t,e,n,null==r?1:r)}function Ltt(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function Ptt(t){if(isNaN(t.h))return new Ftt(t.l,0,0,t.opacity);var e=t.h*xtt;return new Ftt(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function jtt(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Utt(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Wtt(){return 0}L9(Ftt,Dtt,P9(j9,{brighter(t){return new Ftt(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker(t){return new Ftt(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new stt(Ott(3.1338561*(e=ktt*Mtt(e))-1.6168667*(t=_tt*Mtt(t))-.4906146*(n=Stt*Mtt(n))),Ott(-.9787684*e+1.9161415*t+.033454*n),Ott(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),L9(Ltt,Btt,P9(j9,{brighter(t){return new Ltt(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker(t){return new Ltt(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb(){return Ptt(this).rgb()}}));Map;class Vtt extends Set{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ytt;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const n of t)this.add(n)}has(t){return super.has(qtt(this,t))}add(t){return super.add(Gtt(this,t))}delete(t){return super.delete(Htt(this,t))}}function qtt(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)?n.get(i):e}function Gtt(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)?n.get(i):(n.set(i,e),e)}function Htt(t,e){let{_intern:n,_key:r}=t;const i=r(e);return n.has(i)&&(e=n.get(i),n.delete(i)),e}function Ytt(t){return null!==t&&"object"===typeof t?t.valueOf():t}function Xtt(t){return t instanceof Vtt?t:new Vtt(t)}const Ktt=Symbol("vega_selection_getter");function $tt(t){return t.getter&&t.getter[Ktt]||(t.getter=He(t.field),t.getter[Ktt]=!0),t.getter}const Ztt="intersect",Qtt="union",Jtt="_vgsid_",tet=He(Jtt),eet="E",net="R",ret="R-E",iet="R-LE",aet="R-RE",oet="index:unit";function set(t,e){for(var n,r,i=e.fields,a=e.values,o=i.length,s=0;s<o;++s)if(Wn(n=$tt(r=i[s])(t))&&(n=dn(n)),Wn(a[s])&&(a[s]=dn(a[s])),on(a[s])&&Wn(a[s][0])&&(a[s]=a[s].map(dn)),r.type===eet){if(on(a[s])?a[s].indexOf(n)<0:n!==a[s])return!1}else if(r.type===net){if(!Un(n,a[s]))return!1}else if(r.type===aet){if(!Un(n,a[s],!0,!1))return!1}else if(r.type===ret){if(!Un(n,a[s],!1,!1))return!1}else if(r.type===iet&&!Un(n,a[s],!1,!0))return!1;return!0}function cet(t,e,n){for(var r,i,a,o,s,c=this.context.data[t],u=c?c.values.value:[],l=c?c[oet]&&c[oet].value:void 0,h=n===Ztt,d=u.length,f=0;f<d;++f)if(r=u[f],l&&h){if(-1===(a=(i=i||{})[o=r.unit]||0))continue;if(s=set(e,r),i[o]=s?-1:++a,s&&1===l.size)return!0;if(!s&&a===l.get(o).count)return!1}else if(h^(s=set(e,r)))return s;return d&&h}const uet=function(t){let e,n,r;function i(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<0?i=e+1:a=e}while(i<a)}return i}return 2!==t.length?(e=jtt,n=(e,n)=>jtt(t(e),n),r=(e,n)=>t(e)-n):(e=t===jtt||t===Utt?t:Wtt,n=t,r=t),{left:i,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=i(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return a>n&&r(t[a-1],e)>-r(t[a],e)?a-1:a},right:function(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<=0?i=e+1:a=e}while(i<a)}return i}}}(tet),het=uet.left,det=uet.right;function fet(t,e,n){const r=this.context.data[t],i=r?r.values.value:[],a=r?r[oet]&&r[oet].value:void 0,o=n===Ztt,s=tet(e),c=het(i,s);if(c===i.length)return!1;if(tet(i[c])!==s)return!1;if(a&&o){if(1===a.size)return!0;if(det(i,s)-c<a.size)return!1}return!0}function pet(t,e){return t.map((t=>On(e.fields?{values:e.fields.map((e=>$tt(e)(t.datum)))}:{[Jtt]:tet(t.datum)},e)))}function get(t,e,n,r){for(var i,a,o,s,c,u,l,h,d,f,p,g,m=this.context.data[t],y=m?m.values.value:[],v={},b={},x={},w=y.length,k=0;k<w;++k)if(s=(i=y[k]).unit,a=i.fields,o=i.values,a&&o){for(p=0,g=a.length;p<g;++p)c=a[p],h=(l=v[c.field]||(v[c.field]={}))[s]||(l[s]=[]),x[c.field]=d=c.type.charAt(0),f=met["".concat(d,"_union")],l[s]=f(h,Sn(o[p]));n&&(h=b[s]||(b[s]=[])).push(Sn(o).reduce(((t,e,n)=>(t[a[n].field]=e,t)),{}))}else c=Jtt,u=tet(i),(h=(l=v[c]||(v[c]={}))[s]||(l[s]=[])).push(u),n&&(h=b[s]||(b[s]=[])).push({[Jtt]:u});if(e=e||Qtt,v[Jtt]?v[Jtt]=met["".concat(Jtt,"_").concat(e)](...Object.values(v[Jtt])):Object.keys(v).forEach((t=>{v[t]=Object.keys(v[t]).map((e=>v[t][e])).reduce(((n,r)=>void 0===n?r:met["".concat(x[t],"_").concat(e)](n,r)))})),y=Object.keys(b),n&&y.length){v[r?"vlPoint":"vlMulti"]=e===Qtt?{or:y.reduce(((t,e)=>(t.push(...b[e]),t)),[])}:{and:y.map((t=>({or:b[t]})))}}return v}var met={["".concat(Jtt,"_union")]:function(){const t=new Vtt;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(const i of n)for(const e of i)t.add(e);return t},["".concat(Jtt,"_intersect")]:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];t=new Vtt(t),n=n.map(Xtt);t:for(const i of t)for(const e of n)if(!e.has(i)){t.delete(i);continue t}return t},E_union:function(t,e){if(!t.length)return e;for(var n=0,r=e.length;n<r;++n)t.indexOf(e[n])<0&&t.push(e[n]);return t},E_intersect:function(t,e){return t.length?t.filter((t=>e.indexOf(t)>=0)):e},R_union:function(t,e){var n=dn(e[0]),r=dn(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?(t[0]>n&&(t[0]=n),t[1]<r&&(t[1]=r),t):[n,r]},R_intersect:function(t,e){var n=dn(e[0]),r=dn(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?r<t[0]||t[1]<n?[]:(t[0]<n&&(t[0]=n),t[1]>r&&(t[1]=r),t):[n,r]}};function yet(t,e,n,r){e[0].type!==x6&&qe("First argument to selection functions must be a string literal.");const i=e[0].value,a="unit",o="@"+a,s=":"+i;(e.length>=2&&hn(e).value)!==Ztt||Bn(r,o)||(r[o]=n.getData(i).indataRef(n,a)),Bn(r,s)||(r[s]=n.getData(i).tuplesRef())}function vet(t){const e=this.context.data[t];return e?e.values.value:[]}const bet=t=>function(e,n){return this.context.dataflow.locale()[t](n)(e)},xet=bet("format"),wet=bet("timeFormat"),ket=bet("utcFormat"),_et=bet("timeParse"),Aet=bet("utcParse"),Cet=new Date(2e3,0,1);function Eet(t,e,n){return Number.isInteger(t)&&Number.isInteger(e)?(Cet.setYear(2e3),Cet.setMonth(t),Cet.setDate(e),wet.call(this,Cet,n)):""}const Tet="%",Net="$";function Det(t,e,n,r){e[0].type!==x6&&qe("First argument to data functions must be a string literal.");const i=e[0].value,a=":"+i;if(!Bn(a,r))try{r[a]=n.getData(i).tuplesRef()}catch(o){}}function Fet(t,e,n,r){if(e[0].type===x6)Iet(n,r,e[0].value);else for(t in n.scales)Iet(n,r,t)}function Iet(t,e,n){const r=Tet+n;if(!Bn(e,r))try{e[r]=t.scaleRef(n)}catch(i){}}function Met(t,e){if(An(t))return t;if(qn(t)){const n=e.scales[t];return n&&function(t){return t&&!0===t[bv]}(n.value)?n.value:void 0}}function Oet(t,e,n){e.__bandwidth=t=>t&&t.bandwidth?t.bandwidth():0,n._bandwidth=Fet,n._range=Fet,n._scale=Fet;const r=e=>"_["+(e.type===x6?Xn(Tet+e.value):Xn(Tet)+"+"+t(e))+"]";return{_bandwidth:t=>"this.__bandwidth(".concat(r(t[0]),")"),_range:t=>"".concat(r(t[0]),".range()"),_scale:e=>"".concat(r(e[0]),"(").concat(t(e[1]),")")}}function Ret(t,e){return function(n,r,i){if(n){const e=Met(n,(i||this).context);return e&&e.path[t](r)}return e(r)}}const zet=Ret("area",(function(t){return Y7=new c7,N7(t,X7),2*Y7})),Bet=Ret("bounds",(function(t){var e,n,r,i,a,o,s;if(L7=B7=-(R7=z7=1/0),q7=[],N7(t,m9),n=q7.length){for(q7.sort(A9),e=1,a=[r=q7[0]];e<n;++e)C9(r,(i=q7[e])[0])||C9(r,i[1])?(S9(r[0],i[1])>S9(r[0],r[1])&&(r[1]=i[1]),S9(i[0],r[1])>S9(r[0],r[1])&&(r[0]=i[0])):a.push(r=i);for(o=-1/0,e=0,r=a[n=a.length-1];e<=n;r=i,++e)i=a[e],(s=S9(r[1],i[0]))>o&&(o=s,R7=i[0],B7=r[1])}return q7=G7=null,R7===1/0||z7===1/0?[[NaN,NaN],[NaN,NaN]]:[[R7,z7],[B7,L7]]})),Let=Ret("centroid",(function(t){t9=e9=n9=r9=i9=a9=o9=s9=0,c9=new c7,u9=new c7,l9=new c7,N7(t,E9);var e=+c9,n=+u9,r=+l9,i=b7(e,n,r);return i<1e-12&&(e=a9,n=o9,r=s9,e9<u7&&(e=n9,n=r9,r=i9),(i=b7(e,n,r))<1e-12)?[NaN,NaN]:[y7(n,e)*p7,k7(r/i)*p7]}));function Pet(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(r){t.warn(r)}return n[n.length-1]}function jet(t){const e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Uet(t){const e=ott(t);return.2126*jet(e.r)+.7152*jet(e.g)+.0722*jet(e.b)}function Wet(t,e){return t===e||t!==t&&e!==e||(on(t)?!(!on(e)||t.length!==e.length)&&function(t,e){for(let n=0,r=t.length;n<r;++n)if(!Wet(t[n],e[n]))return!1;return!0}(t,e):!(!sn(t)||!sn(e))&&Vet(t,e))}function Vet(t,e){for(const n in t)if(!Wet(t[n],e[n]))return!1;return!0}function qet(t){return e=>Vet(t,e)}const Get={};function Het(t){return on(t)||ArrayBuffer.isView(t)?t:null}function Yet(t){return Het(t)||(qn(t)?t:null)}const Xet=t=>t.data;function Ket(t,e){const n=vet.call(e,t);return n.root&&n.root.lookup||{}}const $et=()=>"undefined"!==typeof window&&window||null;function Zet(t,e,n){if(!t)return[];const[r,i]=t,a=(new rx).set(r[0],r[1],i[0],i[1]);return function(t,e,n){const r=[],i=(new rx).union(e),a=t.marktype;return a?P_(t,i,n,r):"group"===a?j_(t,i,n,r):qe("Intersect scene must be mark node or group item.")}(n||this.context.dataflow.scenegraph().root,a,function(t){let e=null;if(t){const n=Sn(t.marktype),r=Sn(t.markname);e=t=>(!n.length||n.some((e=>t.marktype===e)))&&(!r.length||r.some((e=>t.name===e)))}return e}(e))}const Qet={random:()=>$c(),cumulativeNormal:ru,cumulativeLogNormal:uu,cumulativeUniform:fu,densityNormal:nu,densityLogNormal:cu,densityUniform:du,quantileNormal:iu,quantileLogNormal:lu,quantileUniform:pu,sampleNormal:eu,sampleLogNormal:su,sampleUniform:hu,isArray:on,isBoolean:function(t){return"boolean"===typeof t},isDate:Wn,isDefined:t=>void 0!==t,isNumber:Vn,isObject:sn,isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},isString:qn,isTuple:Qs,isValid:t=>null!=t&&t===t,toBoolean:Kn,toDate:t=>Zn(t),toNumber:dn,toString:Qn,indexof:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Yet(t).indexOf(...n)},join:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Het(t).join(...n)},lastindexof:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Yet(t).lastIndexOf(...n)},replace:function(t,e,n){return An(n)&&qe("Function argument passed to replace."),String(t).replace(e,n)},reverse:function(t){return Het(t).slice().reverse()},slice:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Yet(t).slice(...n)},flush:function(t,e,n,r,i,a){if(!n&&0!==n)return a;const o=+n;let s,c=t[0],u=hn(t);u<c&&(s=c,c=u,u=s),s=Math.abs(e-c);const l=Math.abs(u-e);return s<l&&s<=o?r:l<=o?i:a},lerp:function(t,e){const n=t[0],r=hn(t),i=+e;return i?1===i?r:n+i*(r-n):n},merge:function(){const t=[].slice.call(arguments);return t.unshift({}),On(...t)},pad:function(t,e,n,r){const i=n||" ",a=t+"",o=e-a.length;return o<=0?a:"left"===r?Hn(i,o)+a:"center"===r?Hn(i,~~(o/2))+a+Hn(i,Math.ceil(o/2)):a+Hn(i,o)},peek:hn,pluck:function(t,e){const n=Get[e]||(Get[e]=He(e));return on(t)?t.map(n):n(t)},span:Yn,inrange:Un,truncate:function(t,e,n,r){const i=null!=r?r:"\u2026",a=t+"",o=a.length,s=Math.max(0,e-i.length);return o<=e?a:"left"===n?i+a.slice(o-s):"center"===n?a.slice(0,Math.ceil(s/2))+i+a.slice(o-~~(s/2)):a.slice(0,s)+i},rgb:ott,lab:Dtt,hcl:Btt,hsl:gtt,luminance:Uet,contrast:function(t,e){const n=Uet(t),r=Uet(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a},format:xet,utcFormat:ket,utcParse:Aet,utcOffset:function(t,e,n){return va(ya(t),e,n)},utcSequence:function(t,e,n,r){return ba(ya(t),e,n,r)},timeFormat:wet,timeParse:_et,timeOffset:function(t,e,n){return va(ma(t),e,n)},timeSequence:function(t,e,n,r){return ba(ma(t),e,n,r)},timeUnitSpecifier:function(t,e){const n=On({},Ki,e),r=Xi(t),i=r.length;let a,o,s="",c=0;for(c=0;c<i;)for(a=r.length;a>c;--a)if(o=r.slice(c,a).join("-"),null!=n[o]){s+=n[o],c=a;break}return s.trim()},monthFormat:function(t){return Eet.call(this,t,1,"%B")},monthAbbrevFormat:function(t){return Eet.call(this,t,1,"%b")},dayFormat:function(t){return Eet.call(this,0,2+t,"%A")},dayAbbrevFormat:function(t){return Eet.call(this,0,2+t,"%a")},quarter:function(t){return 1+~~(new Date(t).getMonth()/3)},utcquarter:function(t){return 1+~~(new Date(t).getUTCMonth()/3)},week:function(t){return Ji(new Date(t))},utcweek:function(t){return ra(new Date(t))},dayofyear:function(t){return Qi(new Date(t))},utcdayofyear:function(t){return na(new Date(t))},warn:function(){return Pet(this.context.dataflow,"warn",arguments)},info:function(){return Pet(this.context.dataflow,"info",arguments)},debug:function(){return Pet(this.context.dataflow,"debug",arguments)},extent:t=>Rn(t),inScope:function(t){const e=this.context.group;let n=!1;if(e)for(;t;){if(t===e){n=!0;break}t=t.mark.group}return n},intersect:Zet,clampRange:function(t,e,n){let r,i=t[0],a=t[1];return a<i&&(r=a,a=i,i=r),r=a-i,r>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]},pinchDistance:function(t){const e=t.touches,n=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.hypot(n,r)},pinchAngle:function(t){const e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)},screen:function(){const t=$et();return t?t.screen:{}},containerSize:function(){const t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]},windowSize:function(){const t=$et();return t?[t.innerWidth,t.innerHeight]:[void 0,void 0]},bandspace:function(t,e,n){return Hy(t||0,e||0,n||0)},setdata:function(t,e){const n=this.context.dataflow,r=this.context.data[t].input;return n.pulse(r,n.changeset().remove(Ze).insert(e)),1},pathShape:function(t){let e=null;return function(n){return n?Nb(n,e=e||vb(t)):t}},panLinear:function(t,e){return vn(t,e,dn,Xe)},panLog:function(t,e){var n=Math.sign(t[0]);return vn(t,e,pn(n),fn(n))},panPow:function(t,e,n){return vn(t,e,yn(n),yn(1/n))},panSymlog:function(t,e,n){return vn(t,e,gn(n),mn(n))},zoomLinear:xn,zoomLog:wn,zoomPow:kn,zoomSymlog:_n,encode:function(t,e,n){if(t){const n=this.context.dataflow,r=t.mark.source;n.pulse(r,n.changeset().encode(t,e))}return void 0!==n?n:t},modify:function(t,e,n,r,i,a){const o=this.context.dataflow,s=this.context.data[t],c=s.input,u=o.stamp();let l,h,d=s.changes;if(!1===o._trigger||!(c.value.length||e||r))return 0;if((!d||d.stamp<u)&&(s.changes=d=o.changeset(),d.stamp=u,o.runAfter((()=>{s.modified=!0,o.pulse(c,d).run()}),!0,1)),n&&(l=!0===n?Ze:on(n)||Qs(n)?n:qet(n),d.remove(l)),e&&d.insert(e),r&&(l=qet(r),c.value.some(l)?d.remove(l):d.insert(r)),i)for(h in a)d.modify(i,h,a[h]);return 1},lassoAppend:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;const i=(t=Sn(t))[t.length-1];return void 0===i||Math.hypot(i[0]-e,i[1]-n)>r?[...t,[e,n]]:t},lassoPath:function(t){return Sn(t).reduce(((e,n,r)=>{let[i,a]=n;return e+(0==r?"M ".concat(i,",").concat(a," "):r===t.length-1?" Z":"L ".concat(i,",").concat(a," "))}),"")},intersectLasso:function(t,e,n){const{x:r,y:i,mark:a}=n,o=(new rx).set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[s,c]of e)s<o.x1&&(o.x1=s),s>o.x2&&(o.x2=s),c<o.y1&&(o.y1=c),c>o.y2&&(o.y2=c);return o.translate(r,i),Zet([[o.x1,o.y1],[o.x2,o.y2]],t,a).filter((t=>function(t,e,n){let r=0;for(let i=0,a=n.length-1;i<n.length;a=i++){const[o,s]=n[a],[c,u]=n[i];u>e!=s>e&&t<(o-c)*(e-u)/(s-u)+c&&r++}return 1&r}(t.x,t.y,e)))}},Jet=["view","item","group","xy","x","y"],tnt="this.",ent={},nnt={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:t=>"_[".concat(Xn(Net+t),"]"),functions:function(t){const e=s7(t);Jet.forEach((t=>e[t]="event.vega."+t));for(const n in Qet)e[n]=tnt+n;return On(e,Oet(t,Qet,ent)),e},constants:o7,visitors:ent},rnt=function(t){const e=(t=t||{}).allowed?Jn(t.allowed):{},n=t.forbidden?Jn(t.forbidden):{},r=t.constants||o7,i=(t.functions||s7)(h),a=t.globalvar,o=t.fieldvar,s=An(a)?a:t=>"".concat(a,'["').concat(t,'"]');let c={},u={},l=0;function h(t){if(qn(t))return t;const e=d[t.type];return null==e&&qe("Unsupported type: "+t.type),e(t)}const d={Literal:t=>t.raw,Identifier:t=>{const i=t.name;return l>0?i:Bn(n,i)?qe("Illegal identifier: "+i):Bn(r,i)?r[i]:Bn(e,i)?i:(c[i]=1,s(i))},MemberExpression:t=>{const e=!t.computed,n=h(t.object);e&&(l+=1);const r=h(t.property);return n===o&&(u[function(t){const e=t&&t.length-1;return e&&('"'===t[0]&&'"'===t[e]||"'"===t[0]&&"'"===t[e])?t.slice(1,-1):t}(r)]=1),e&&(l-=1),n+(e?"."+r:"["+r+"]")},CallExpression:t=>{"Identifier"!==t.callee.type&&qe("Illegal callee type: "+t.callee.type);const e=t.callee.name,n=t.arguments,r=Bn(i,e)&&i[e];return r||qe("Unrecognized function: "+e),An(r)?r(n):r+"("+n.map(h).join(",")+")"},ArrayExpression:t=>"["+t.elements.map(h).join(",")+"]",BinaryExpression:t=>"("+h(t.left)+" "+t.operator+" "+h(t.right)+")",UnaryExpression:t=>"("+t.operator+h(t.argument)+")",ConditionalExpression:t=>"("+h(t.test)+"?"+h(t.consequent)+":"+h(t.alternate)+")",LogicalExpression:t=>"("+h(t.left)+t.operator+h(t.right)+")",ObjectExpression:t=>"{"+t.properties.map(h).join(",")+"}",Property:t=>{l+=1;const e=h(t.key);return l-=1,e+":"+h(t.value)}};function f(t){const e={code:h(t),globals:Object.keys(c),fields:Object.keys(u)};return c={},u={},e}return f.functions=i,f.constants=r,f}(nnt);function int(t,e,n){return 1===arguments.length?Qet[t]:(Qet[t]=e,n&&(ent[t]=n),rnt&&(rnt.functions[t]=tnt+t),this)}function ant(t,e){const n={};let r;try{r=function(t){M6=0,O6=(I6=t).length,R6=null,O8();const e=a7();if(R6.type!==B6)throw new Error("Unexpect token after expression.");return e}(t=qn(t)?t:Xn(t)+"")}catch(a){qe("Expression parse error: "+t)}r.visit((t=>{if(t.type!==S6)return;const r=t.callee.name,i=nnt.visitors[r];i&&i(r,t.arguments,e,n)}));const i=rnt(r);return i.globals.forEach((t=>{const r=Net+t;!Bn(n,r)&&e.getSignal(t)&&(n[r]=e.signalRef(t))})),{$expr:On({code:i.code},e.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}int("bandwidth",(function(t,e){const n=Met(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0}),Fet),int("copy",(function(t,e){const n=Met(t,(e||this).context);return n?n.copy():void 0}),Fet),int("domain",(function(t,e){const n=Met(t,(e||this).context);return n?n.domain():[]}),Fet),int("range",(function(t,e){const n=Met(t,(e||this).context);return n&&n.range?n.range():[]}),Fet),int("invert",(function(t,e,n){const r=Met(t,(n||this).context);return r?on(e)?(r.invertRange||r.invert)(e):(r.invert||r.invertExtent)(e):void 0}),Fet),int("scale",(function(t,e,n){const r=Met(t,(n||this).context);return r?r(e):void 0}),Fet),int("gradient",(function(t,e,n,r,i){t=Met(t,(i||this).context);const a=function(t,e){var n,r=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:r,stop:function(t,e){return r.push({offset:t,color:e}),n}}}(e,n);let o=t.domain(),s=o[0],c=hn(o),u=Xe;return c-s?u=Iv(t,s,c):t=(t.interpolator?wv("sequential")().interpolator(t.interpolator()):wv("linear")().interpolate(t.interpolate()).range(t.range())).domain([s=0,c=1]),t.ticks&&(o=t.ticks(+r||15),s!==o[0]&&o.unshift(s),c!==hn(o)&&o.push(c)),o.forEach((e=>a.stop(u(e),t(e)))),a}),Fet),int("geoArea",zet,Fet),int("geoBounds",Bet,Fet),int("geoCentroid",Let,Fet),int("geoShape",(function(t,e,n){const r=Met(t,(n||this).context);return function(t){return r?r.path.context(t)(e):""}}),Fet),int("geoScale",(function(t,e){const n=Met(t,(e||this).context);return n&&n.scale()}),Fet),int("indata",(function(t,e,n){const r=this.context.data[t]["index:"+e],i=r?r.value.get(n):void 0;return i?i.count:i}),(function(t,e,n,r){e[0].type!==x6&&qe("First argument to indata must be a string literal."),e[1].type!==x6&&qe("Second argument to indata must be a string literal.");const i=e[0].value,a=e[1].value,o="@"+a;Bn(o,r)||(r[o]=n.getData(i).indataRef(n,a))})),int("data",vet,Det),int("treePath",(function(t,e,n){const r=Ket(t,this),i=r[e],a=r[n];return i&&a?i.path(a).map(Xet):void 0}),Det),int("treeAncestors",(function(t,e){const n=Ket(t,this)[e];return n?n.ancestors().map(Xet):void 0}),Det),int("vlSelectionTest",cet,yet),int("vlSelectionIdTest",fet,yet),int("vlSelectionResolve",get,yet),int("vlSelectionTuples",pet);const ont=Jn(["rule"]),snt=Jn(["group","image","rect"]);function cnt(t){return(t+"").toLowerCase()}function unt(t,e,n){n.endsWith(";")||(n="return("+n+");");const r=Function(...e.concat(n));return t&&t.functions?r.bind(t.functions):r}var lnt={operator:(t,e)=>unt(t,["_"],e.code),parameter:(t,e)=>unt(t,["datum","_"],e.code),event:(t,e)=>unt(t,["event"],e.code),handler:(t,e)=>unt(t,["_","event"],"var datum=event.item&&event.item.datum;return ".concat(e.code,";")),encode:(t,e)=>{const{marktype:n,channels:r}=e;let i="var o=item,datum=o.datum,m=0,$;";for(const a in r){const t="o["+Xn(a)+"]";i+="$=".concat(r[a].code,";if(").concat(t,"!==$)").concat(t,"=$,m=1;")}return i+=function(t,e){let n="";return ont[e]||(t.x2&&(t.x?(snt[e]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),t.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),t.y2&&(t.y?(snt[e]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),t.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(r,n),i+="return m;",unt(t,["item","_"],i)},codegen:{get(t){const e="[".concat(t.map(Xn).join("]["),"]"),n=Function("_","return _".concat(e,";"));return n.path=e,n},comparator(t,e){let n;const r=Function("a","b","var u, v; return "+t.map(((t,r)=>{const i=e[r];let a,o;return t.path?(a="a".concat(t.path),o="b".concat(t.path)):((n=n||{})["f"+r]=t,a="this.f".concat(r,"(a)"),o="this.f".concat(r,"(b)")),function(t,e,n,r){return"((u = ".concat(t,") < (v = ").concat(e,") || u == null) && v != null ? ").concat(n,"\n  : (u > v || v == null) && u != null ? ").concat(r,"\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ").concat(n,"\n  : v !== v && u === u ? ").concat(r," : ")}(a,o,-i,i)})).join("")+"0;");return n?r.bind(n):r}}};function hnt(t,e,n){if(!t||!sn(t))return t;for(let r,i=0,a=dnt.length;i<a;++i)if(r=dnt[i],Bn(t,r.key))return r.parse(t,e,n);return t}var dnt=[{key:"$ref",parse:function(t,e){return e.get(t.$ref)||qe("Operator not defined: "+t.$ref)}},{key:"$key",parse:function(t,e){const n="k:"+t.$key+"_"+!!t.$flat;return e.fn[n]||(e.fn[n]=Gn(t.$key,t.$flat,e.expr.codegen))}},{key:"$expr",parse:function(t,e,n){t.$params&&e.parseParameters(t.$params,n);const r="e:"+t.$expr.code;return e.fn[r]||(e.fn[r]=Le(e.parameterExpression(t.$expr),t.$fields))}},{key:"$field",parse:function(t,e){if(!t.$field)return null;const n="f:"+t.$field+"_"+t.$name;return e.fn[n]||(e.fn[n]=He(t.$field,t.$name,e.expr.codegen))}},{key:"$encode",parse:function(t,e){const n=t.$encode,r={};for(const i in n){const t=n[i];r[i]=Le(e.encodeExpression(t.$expr),t.$fields),r[i].output=t.$output}return r}},{key:"$compare",parse:function(t,e){const n="c:"+t.$compare+"_"+t.$order,r=Sn(t.$compare).map((t=>t&&t.$tupleid?Js:t));return e.fn[n]||(e.fn[n]=En(r,t.$order,e.expr.codegen))}},{key:"$context",parse:function(t,e){return e}},{key:"$subflow",parse:function(t,e){const n=t.$subflow;return function(t,r,i){const a=e.fork().parse(n),o=a.get(n.operators[0].id),s=a.signals.parent;return s&&s.set(i),o.detachSubflow=()=>e.detach(a),o}}},{key:"$tupleid",parse:function(){return Js}}];const fnt={skip:!0};function pnt(t,e,n,r){return new gnt(t,e,n,r)}function gnt(t,e,n,r){this.dataflow=t,this.transforms=e,this.events=t.events.bind(t),this.expr=r||lnt,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function mnt(t){this.dataflow=t.dataflow,this.transforms=t.transforms,this.events=t.events,this.expr=t.expr,this.signals=Object.create(t.signals),this.scales=Object.create(t.scales),this.nodes=Object.create(t.nodes),this.data=Object.create(t.data),this.fn=Object.create(t.fn),t.functions&&(this.functions=Object.create(t.functions),this.functions.context=this)}function ynt(t,e){t&&(null==e?t.removeAttribute("aria-label"):t.setAttribute("aria-label",e))}gnt.prototype=mnt.prototype={fork(){const t=new mnt(this);return(this.subcontext||(this.subcontext=[])).push(t),t},detach(t){this.subcontext=this.subcontext.filter((e=>e!==t));const e=Object.keys(t.nodes);for(const n of e)t.nodes[n]._targets=null;for(const n of e)t.nodes[n].detach();t.nodes=null},get(t){return this.nodes[t]},set(t,e){return this.nodes[t]=e},add(t,e){const n=this,r=n.dataflow,i=t.value;if(n.set(t.id,e),function(t){return"collect"===cnt(t)}(t.type)&&i&&(i.$ingest?r.ingest(e,i.$ingest,i.$format):i.$request?r.preload(e,i.$request,i.$format):r.pulse(e,r.changeset().insert(i))),t.root&&(n.root=e),t.parent){let i=n.get(t.parent.$ref);i?(r.connect(i,[e]),e.targets().add(i)):(n.unresolved=n.unresolved||[]).push((()=>{i=n.get(t.parent.$ref),r.connect(i,[e]),e.targets().add(i)}))}if(t.signal&&(n.signals[t.signal]=e),t.scale&&(n.scales[t.scale]=e),t.data)for(const a in t.data){const r=n.data[a]||(n.data[a]={});t.data[a].forEach((t=>r[t]=e))}},resolve(){return(this.unresolved||[]).forEach((t=>t())),delete this.unresolved,this},operator(t,e){this.add(t,this.dataflow.add(t.value,e))},transform(t,e){this.add(t,this.dataflow.add(this.transforms[cnt(e)]))},stream(t,e){this.set(t.id,e)},update(t,e,n,r,i){this.dataflow.on(e,n,r,i,t.options)},operatorExpression(t){return this.expr.operator(this,t)},parameterExpression(t){return this.expr.parameter(this,t)},eventExpression(t){return this.expr.event(this,t)},handlerExpression(t){return this.expr.handler(this,t)},encodeExpression(t){return this.expr.encode(this,t)},parse:function(t){const e=this,n=t.operators||[];return t.background&&(e.background=t.background),t.eventConfig&&(e.eventConfig=t.eventConfig),t.locale&&(e.locale=t.locale),n.forEach((t=>e.parseOperator(t))),n.forEach((t=>e.parseOperatorParameters(t))),(t.streams||[]).forEach((t=>e.parseStream(t))),(t.updates||[]).forEach((t=>e.parseUpdate(t))),e.resolve()},parseOperator:function(t){const e=this;!function(t){return"operator"===cnt(t)}(t.type)&&t.type?e.transform(t,t.type):e.operator(t,t.update?e.operatorExpression(t.update):null)},parseOperatorParameters:function(t){const e=this;if(t.params){const n=e.get(t.id);n||qe("Invalid operator id: "+t.id),e.dataflow.connect(n,n.parameters(e.parseParameters(t.params),t.react,t.initonly))}},parseParameters:function(t,e){e=e||{};const n=this;for(const r in t){const i=t[r];e[r]=on(i)?i.map((t=>hnt(t,n,e))):hnt(i,n,e)}return e},parseStream:function(t){var e,n=this,r=null!=t.filter?n.eventExpression(t.filter):void 0,i=null!=t.stream?n.get(t.stream):void 0;t.source?i=n.events(t.source,t.type,r):t.merge&&(i=(e=t.merge.map((t=>n.get(t))))[0].merge.apply(e[0],e.slice(1))),t.between&&(e=t.between.map((t=>n.get(t))),i=i.between(e[0],e[1])),t.filter&&(i=i.filter(r)),null!=t.throttle&&(i=i.throttle(+t.throttle)),null!=t.debounce&&(i=i.debounce(+t.debounce)),null==i&&qe("Invalid stream definition: "+JSON.stringify(t)),t.consume&&i.consume(!0),n.stream(t,i)},parseUpdate:function(t){var e,n=this,r=sn(r=t.source)?r.$ref:r,i=n.get(r),a=t.update,o=void 0;i||qe("Source not defined: "+t.source),e=t.target&&t.target.$expr?n.eventExpression(t.target.$expr):n.get(t.target),a&&a.$expr&&(a.$params&&(o=n.parseParameters(a.$params)),a=n.handlerExpression(a.$expr)),n.update(t,i,e,a,o)},getState:function(t){var e=this,n={};if(t.signals){var r=n.signals={};Object.keys(e.signals).forEach((n=>{const i=e.signals[n];t.signals(n,i)&&(r[n]=i.value)}))}if(t.data){var i=n.data={};Object.keys(e.data).forEach((n=>{const r=e.data[n];t.data(n,r)&&(i[n]=r.input.value)}))}return e.subcontext&&!1!==t.recurse&&(n.subcontext=e.subcontext.map((e=>e.getState(t)))),n},setState:function(t){var e=this,n=e.dataflow,r=t.data,i=t.signals;Object.keys(i||{}).forEach((t=>{n.update(e.signals[t],i[t],fnt)})),Object.keys(r||{}).forEach((t=>{n.pulse(e.data[t].input,n.changeset().remove(Ze).insert(r[t]))})),(t.subcontext||[]).forEach(((t,n)=>{const r=e.subcontext[n];r&&r.setState(t)}))}};const vnt="default";function bnt(t,e){const n=t.globalCursor()?"undefined"!==typeof document&&document.body:t.container();if(n)return null==e?n.style.removeProperty("cursor"):n.style.cursor=e}function xnt(t,e){var n=t._runtime.data;return Bn(n,e)||qe("Unrecognized data set: "+e),n[e]}function wnt(t,e){oc(e)||qe("Second argument to changes must be a changeset.");const n=xnt(this,t);return n.modified=!0,this.pulse(n.input,e)}function knt(t){var e=t.padding();return Math.max(0,t._viewWidth+e.left+e.right)}function _nt(t){var e=t.padding();return Math.max(0,t._viewHeight+e.top+e.bottom)}function Snt(t){var e=t.padding(),n=t._origin;return[e.left+n[0],e.top+n[1]]}function Ant(t,e,n){var r,i,a=t._renderer,o=a&&a.canvas();return o&&(i=Snt(t),(r=dk(e.changedTouches?e.changedTouches[0]:e,o))[0]-=i[0],r[1]-=i[1]),e.dataflow=t,e.item=n,e.vega=function(t,e,n){const r=e?"group"===e.mark.marktype?e:e.mark.group:null;function i(t){var n,i=r;if(t)for(n=e;n;n=n.mark.group)if(n.mark.name===t){i=n;break}return i&&i.mark&&i.mark.interactive?i:{}}function a(t){if(!t)return n;qn(t)&&(t=i(t));const e=n.slice();for(;t;)e[0]-=t.x||0,e[1]-=t.y||0,t=t.mark&&t.mark.group;return e}return{view:In(t),item:In(e||{}),group:i,xy:a,x:t=>a(t)[0],y:t=>a(t)[1]}}(t,n,r),e}const Cnt="view",Ent={trap:!1};function Tnt(t,e,n,r){t._eventListeners.push({type:n,sources:Sn(e),handler:r})}function Nnt(t,e,n){const r=t._eventConfig&&t._eventConfig[e];return!(!1===r||sn(r)&&!r[n])||(t.warn("Blocked ".concat(e," ").concat(n," event listener.")),!1)}function Dnt(t){return t.item}function Fnt(t){return t.item.mark.source}function Int(t){return function(e,n){return n.vega.view().changeset().encode(n.item,t)}}function Mnt(t,e,n){const r=document.createElement(t);for(const i in e)r.setAttribute(i,e[i]);return null!=n&&(r.textContent=n),r}const Ont="vega-bind",Rnt="vega-bind-name",znt="vega-bind-radio";function Bnt(t,e,n,r){const i=n.event||"input",a=()=>t.update(e.value);r.signal(n.signal,e.value),e.addEventListener(i,a),Tnt(r,e,i,a),t.set=t=>{e.value=t,e.dispatchEvent(function(t){return"undefined"!==typeof Event?new Event(t):{type:t}}(i))}}function Lnt(t,e,n,r){const i=r.signal(n.signal),a=Mnt("div",{class:Ont}),o="radio"===n.input?a:a.appendChild(Mnt("label"));o.appendChild(Mnt("span",{class:Rnt},n.name||n.signal)),e.appendChild(a);let s=Pnt;switch(n.input){case"checkbox":s=jnt;break;case"select":s=Unt;break;case"radio":s=Wnt;break;case"range":s=Vnt}s(t,o,n,i)}function Pnt(t,e,n,r){const i=Mnt("input");for(const a in n)"signal"!==a&&"element"!==a&&i.setAttribute("input"===a?"type":a,n[a]);i.setAttribute("name",n.signal),i.value=r,e.appendChild(i),i.addEventListener("input",(()=>t.update(i.value))),t.elements=[i],t.set=t=>i.value=t}function jnt(t,e,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const a=Mnt("input",i);e.appendChild(a),a.addEventListener("change",(()=>t.update(a.checked))),t.elements=[a],t.set=t=>a.checked=!!t||null}function Unt(t,e,n,r){const i=Mnt("select",{name:n.signal}),a=n.labels||[];n.options.forEach(((t,e)=>{const n={value:t};qnt(t,r)&&(n.selected=!0),i.appendChild(Mnt("option",n,(a[e]||t)+""))})),e.appendChild(i),i.addEventListener("change",(()=>{t.update(n.options[i.selectedIndex])})),t.elements=[i],t.set=t=>{for(let e=0,r=n.options.length;e<r;++e)if(qnt(n.options[e],t))return void(i.selectedIndex=e)}}function Wnt(t,e,n,r){const i=Mnt("span",{class:znt}),a=n.labels||[];e.appendChild(i),t.elements=n.options.map(((e,o)=>{const s={type:"radio",name:n.signal,value:e};qnt(e,r)&&(s.checked=!0);const c=Mnt("input",s);c.addEventListener("change",(()=>t.update(e)));const u=Mnt("label",{},(a[o]||e)+"");return u.prepend(c),i.appendChild(u),c})),t.set=e=>{const n=t.elements,r=n.length;for(let t=0;t<r;++t)qnt(n[t].value,e)&&(n[t].checked=!0)}}function Vnt(t,e,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;const i=null!=n.max?n.max:Math.max(100,+r)||100,a=n.min||Math.min(0,i,+r)||0,o=n.step||HC(a,i,100),s=Mnt("input",{type:"range",name:n.signal,min:a,max:i,step:o});s.value=r;const c=Mnt("span",{},+r);e.appendChild(s),e.appendChild(c);const u=()=>{c.textContent=s.value,t.update(+s.value)};s.addEventListener("input",u),s.addEventListener("change",u),t.elements=[s],t.set=t=>{s.value=t,c.textContent=t}}function qnt(t,e){return t===e||t+""===e+""}function Gnt(t,e,n,r,i,a){return(e=e||new r(t.loader())).initialize(n,knt(t),_nt(t),Snt(t),i,a).background(t.background())}function Hnt(t,e){return e?function(){try{e.apply(this,arguments)}catch(n){t.error(n)}}:null}function Ynt(t,e,n){if("string"===typeof e){if("undefined"===typeof document)return t.error("DOM document instance not found."),null;if(!(e=document.querySelector(e)))return t.error("Signal bind element not found: "+e),null}if(e&&n)try{e.innerHTML=""}catch(r){e=null,t.error(r)}return e}const Xnt=t=>+t||0;function Knt(t){return sn(t)?{top:Xnt(t.top),bottom:Xnt(t.bottom),left:Xnt(t.left),right:Xnt(t.right)}:(t=>({top:t,bottom:t,left:t,right:t}))(Xnt(t))}async function $nt(t,e,n,r){const i=L_(e),a=i&&i.headless;return a||qe("Unrecognized renderer type: "+e),await t.runAsync(),Gnt(t,null,null,a,n,r).renderAsync(t._scenegraph.root)}var Znt="width",Qnt="height",Jnt="padding",trt={skip:!0};function ert(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===Jnt?r.left+r.right:0)}function nrt(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===Jnt?r.top+r.bottom:0)}function rrt(t,e){return e.modified&&on(e.input.value)&&t.indexOf("_:vega:_")}function irt(t,e){return!("parent"===t||e instanceof Mc.proxy)}function art(t,e,n,r){const i=t.element();i&&i.setAttribute("title",function(t){return null==t?"":on(t)?ort(t):sn(t)&&!Wn(t)?(e=t,Object.keys(e).map((t=>{const n=e[t];return t+": "+(on(n)?ort(n):srt(n))})).join("\n")):t+"";var e}(r))}function ort(t){return"["+t.map(srt).join(", ")+"]"}function srt(t){return on(t)?"[\u2026]":sn(t)&&!Wn(t)?"{\u2026}":t}function crt(t,e){const n=this;if(e=e||{},Dc.call(n),e.loader&&n.loader(e.loader),e.logger&&n.logger(e.logger),null!=e.logLevel&&n.logLevel(e.logLevel),e.locale||t.locale){const r=On({},t.locale,e.locale);n.locale(function(t,e){const n=t?fs(t):ps(),r=e?vs(e):bs();return xs(n,r)}(r.number,r.time))}n._el=null,n._elBind=null,n._renderType=e.renderer||z_.Canvas,n._scenegraph=new ak;const r=n._scenegraph.root;n._renderer=null,n._tooltip=e.tooltip||art,n._redraw=!0,n._handler=(new Rk).scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function(t){const e=On({defaults:{}},t),n=(t,e)=>{e.forEach((e=>{on(t[e])&&(t[e]=Jn(t[e]))}))};return n(e.defaults,["prevent","allow"]),n(e,["view","window","selector"]),e}(t.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=function(t,e,n){return pnt(t,Mc,Qet,n).parse(e)}(n,t,e.expr);n._runtime=i,n._signals=i.signals,n._bind=(t.bindings||[]).map((t=>({state:null,param:On({},t)}))),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=ert(n,n._width),n._viewHeight=nrt(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(t){var e=t._signals,n=e[Znt],r=e[Qnt],i=e[Jnt];function a(){t._autosize=t._resize=1}t._resizeWidth=t.add(null,(e=>{t._width=e.size,t._viewWidth=ert(t,e.size),a()}),{size:n}),t._resizeHeight=t.add(null,(e=>{t._height=e.size,t._viewHeight=nrt(t,e.size),a()}),{size:r});const o=t.add(null,a,{pad:i});t._resizeWidth.rank=n.rank+1,t._resizeHeight.rank=r.rank+1,o.rank=i.rank+1}(n),function(t){t.add(null,(e=>(t._background=e.bg,t._resize=1,e.bg)),{bg:t._signals.background})}(n),function(t){const e=t._signals.cursor||(t._signals.cursor=t.add({user:vnt,item:null}));t.on(t.events("view","mousemove"),e,((t,n)=>{const r=e.value,i=r?qn(r)?r:r.user:vnt,a=n.item&&n.item.cursor||null;return r&&i===r.user&&a==r.item?r:{user:i,item:a}})),t.add(null,(function(e){let n=e.cursor,r=this.value;return qn(n)||(r=n.item,n=n.user),bnt(t,n&&n!==vnt?n:r||n),r}),{cursor:e})}(n),n.description(t.description),e.hover&&n.hover(),e.container&&n.initialize(e.container,e.bind)}function urt(t,e){return Bn(t._signals,e)?t._signals[e]:qe("Unrecognized signal name: "+Xn(e))}function lrt(t,e){const n=(t._targets||[]).filter((t=>t._update&&t._update.handler===e));return n.length?n[0]:null}function hrt(t,e,n,r){let i=lrt(n,r);return i||(i=Hnt(t,(()=>r(e,n.value))),i.handler=r,t.on(n,null,i)),t}function drt(t,e,n){const r=lrt(e,n);return r&&e._targets.remove(r),t}jn(crt,Dc,{async evaluate(t,e,n){if(await Dc.prototype.evaluate.call(this,t,e),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,function(t){var e=Snt(t),n=knt(t),r=_nt(t);t._renderer.background(t.background()),t._renderer.resize(n,r,e),t._handler.origin(e),t._resizeListeners.forEach((e=>{try{e(n,r)}catch(i){t.error(i)}}))}(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&Ks(this,n),this},dirty(t){this._redraw=!0,this._renderer&&this._renderer.dirty(t)},description(t){if(arguments.length){const e=null!=t?t+"":null;return e!==this._desc&&ynt(this._el,this._desc=e),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(t,e,n){const r=urt(this,t);return 1===arguments.length?r.value:this.update(r,e,n)},width(t){return arguments.length?this.signal("width",t):this.signal("width")},height(t){return arguments.length?this.signal("height",t):this.signal("height")},padding(t){return arguments.length?this.signal("padding",Knt(t)):Knt(this.signal("padding"))},autosize(t){return arguments.length?this.signal("autosize",t):this.signal("autosize")},background(t){return arguments.length?this.signal("background",t):this.signal("background")},renderer(t){return arguments.length?(L_(t)||qe("Unrecognized renderer type: "+t),t!==this._renderType&&(this._renderType=t,this._resetRenderer()),this):this._renderType},tooltip(t){return arguments.length?(t!==this._tooltip&&(this._tooltip=t,this._resetRenderer()),this):this._tooltip},loader(t){return arguments.length?(t!==this._loader&&(Dc.prototype.loader.call(this,t),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(urt(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function(t,e,n,r,i,a){this.runAfter((o=>{let s=0;o._autosize=0,o.width()!==n&&(s=1,o.signal(Znt,n,trt),o._resizeWidth.skip(!0)),o.height()!==r&&(s=1,o.signal(Qnt,r,trt),o._resizeHeight.skip(!0)),o._viewWidth!==t&&(o._resize=1,o._viewWidth=t),o._viewHeight!==e&&(o._resize=1,o._viewHeight=e),o._origin[0]===i[0]&&o._origin[1]===i[1]||(o._resize=1,o._origin=i),s&&o.run("enter"),a&&o.runAfter((t=>t.resize()))}),!1,1)},addEventListener(t,e,n){let r=e;return n&&!1===n.trap||(r=Hnt(this,e),r.raw=e),this._handler.on(t,r),this},removeEventListener(t,e){for(var n,r,i=this._handler.handlers(t),a=i.length;--a>=0;)if(r=i[a].type,n=i[a].handler,t===r&&(e===n||e===n.raw)){this._handler.off(r,n);break}return this},addResizeListener(t){const e=this._resizeListeners;return e.indexOf(t)<0&&e.push(t),this},removeResizeListener(t){var e=this._resizeListeners,n=e.indexOf(t);return n>=0&&e.splice(n,1),this},addSignalListener(t,e){return hrt(this,t,urt(this,t),e)},removeSignalListener(t,e){return drt(this,urt(this,t),e)},addDataListener(t,e){return hrt(this,t,xnt(this,t).values,e)},removeDataListener(t,e){return drt(this,xnt(this,t).values,e)},globalCursor(t){if(arguments.length){if(this._globalCursor!==!!t){const e=bnt(this,null);this._globalCursor=!!t,e&&bnt(this,e)}return this}return this._globalCursor},preventDefault(t){return arguments.length?(this._preventDefault=t,this):this._preventDefault},timer:function(t,e){this._timers.push(function(t,e,n){var r=new nM,i=e;return null==e?(r.restart(t,e,n),r):(r._restart=r.restart,r.restart=function(t,e,n){e=+e,n=null==n?tM():+n,r._restart((function a(o){o+=i,r._restart(a,i+=e,n),t(o)}),e,n)},r.restart(t,e,n),r)}((function(e){t({timestamp:Date.now(),elapsed:e})}),e))},events:function(t,e,n){var r,i=this,a=new gc(n),o=function(n,r){i.runAsync(null,(()=>{t===Cnt&&function(t,e){var n=t._eventConfig.defaults,r=n.prevent,i=n.allow;return!1!==r&&!0!==i&&(!0===r||!1===i||(r?r[e]:i?!i[e]:t.preventDefault()))}(i,e)&&n.preventDefault(),a.receive(Ant(i,n,r))}))};if("timer"===t)Nnt(i,"timer",e)&&i.timer(o,e);else if(t===Cnt)Nnt(i,"view",e)&&i.addEventListener(e,o,Ent);else if("window"===t?Nnt(i,"window",e)&&"undefined"!==typeof window&&(r=[window]):"undefined"!==typeof document&&Nnt(i,"selector",e)&&(r=document.querySelectorAll(t)),r){for(var s=0,c=r.length;s<c;++s)r[s].addEventListener(e,o);Tnt(i,r,e,o)}else i.warn("Can not resolve event source: "+t);return a},finalize:function(){var t,e,n,r=this._tooltip,i=this._timers,a=this._eventListeners;for(t=i.length;--t>=0;)i[t].stop();for(t=a.length;--t>=0;)for(e=(n=a[t]).sources.length;--e>=0;)n.sources[e].removeEventListener(n.type,n.handler);return r&&r.call(this,this._handler,null,null,null),this},hover:function(t,e){return e=[e||"update",(t=[t||"hover"])[0]],this.on(this.events("view","mouseover",Dnt),Fnt,Int(t)),this.on(this.events("view","mouseout",Dnt),Fnt,Int(e)),this},data:function(t,e){return arguments.length<2?xnt(this,t).values.value:wnt.call(this,t,sc().remove(Ze).insert(e))},change:wnt,insert:function(t,e){return wnt.call(this,t,sc().insert(e))},remove:function(t,e){return wnt.call(this,t,sc().remove(e))},scale:function(t){var e=this._runtime.scales;return Bn(e,t)||qe("Unrecognized scale or projection: "+t),e[t].value},initialize:function(t,e){const n=this,r=n._renderType,i=n._eventConfig.bind,a=L_(r);t=n._el=t?Ynt(n,t,!0):null,function(t){const e=t.container();e&&(e.setAttribute("role","graphics-document"),e.setAttribute("aria-roleDescription","visualization"),ynt(e,t.description()))}(n),a||n.error("Unrecognized renderer type: "+r);const o=a.handler||Rk,s=t?a.renderer:a.headless;return n._renderer=s?Gnt(n,n._renderer,t,s):null,n._handler=function(t,e,n,r){const i=new r(t.loader(),Hnt(t,t.tooltip())).scene(t.scenegraph().root).initialize(n,Snt(t),t);return e&&e.handlers().forEach((t=>{i.on(t.type,t.handler)})),i}(n,n._handler,t,o),n._redraw=!0,t&&"none"!==i&&(e=e?n._elBind=Ynt(n,e,!0):t.appendChild(Mnt("form",{class:"vega-bindings"})),n._bind.forEach((t=>{t.param.element&&"container"!==i&&(t.element=Ynt(n,t.param.element,!!t.param.input))})),n._bind.forEach((t=>{!function(t,e,n){if(!e)return;const r=n.param;let i=n.state;i||(i=n.state={elements:null,active:!1,set:null,update:e=>{e!=t.signal(r.signal)&&t.runAsync(null,(()=>{i.source=!0,t.signal(r.signal,e)}))}},r.debounce&&(i.update=Mn(r.debounce,i.update))),(null==r.input&&r.element?Bnt:Lnt)(i,e,r,t),i.active||(t.on(t._signals[r.signal],null,(()=>{i.source?i.source=!1:i.set(t.signal(r.signal))})),i.active=!0)}(n,t.element||e,t)}))),n},toImageURL:async function(t,e){t!==z_.Canvas&&t!==z_.SVG&&t!==z_.PNG&&qe("Unrecognized image type: "+t);const n=await $nt(this,t,e);return t===z_.SVG?function(t,e){const n=new Blob([t],{type:e});return window.URL.createObjectURL(n)}(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")},toCanvas:async function(t,e){return(await $nt(this,z_.Canvas,t,e)).canvas()},toSVG:async function(t){return(await $nt(this,z_.SVG,t)).svg()},getState:function(t){return this._runtime.getState(t||{data:rrt,signals:irt,recurse:!0})},setState:function(t){return this.runAsync(null,(e=>{e._trigger=!1,e._runtime.setState(t)}),(t=>{t._trigger=!0})),this}});var frt,prt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function grt(t){if(!(e=prt.exec(t)))throw new Error("invalid format: "+t);var e;return new mrt({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function mrt(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function yrt(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function vrt(t){return(t=yrt(Math.abs(t)))?t[1]:NaN}function brt(t,e){var n=yrt(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}grt.prototype=mrt.prototype,mrt.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const xrt={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>brt(100*t,e),r:brt,s:function(t,e){var n=yrt(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(frt=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+yrt(t,Math.max(0,e+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function wrt(t){return t}var krt,_rt,Srt,Art=Array.prototype.map,Crt=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Ert(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?wrt:(e=Art.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,a=[],o=0,s=e[0],c=0;i>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),a.push(t.substring(i-=s,i+s)),!((c+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?wrt:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(Art.call(t.numerals,String)),c=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"\u2212":t.minus+"",l=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=grt(t)).fill,n=t.align,h=t.sign,d=t.symbol,f=t.zero,p=t.width,g=t.comma,m=t.precision,y=t.trim,v=t.type;"n"===v?(g=!0,v="g"):xrt[v]||(void 0===m&&(m=12),y=!0,v="g"),(f||"0"===e&&"="===n)&&(f=!0,e="0",n="=");var b="$"===d?i:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",x="$"===d?a:/[%p]/.test(v)?c:"",w=xrt[v],k=/[defgprs%]/.test(v);function _(t){var i,a,c,d=b,_=x;if("c"===v)_=w(t)+_,t="";else{var S=(t=+t)<0||1/t<0;if(t=isNaN(t)?l:w(Math.abs(t),m),y&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),S&&0===+t&&"+"!==h&&(S=!1),d=(S?"("===h?h:u:"-"===h||"("===h?"":h)+d,_=("s"===v?Crt[8+frt/3]:"")+_+(S&&"("===h?")":""),k)for(i=-1,a=t.length;++i<a;)if(48>(c=t.charCodeAt(i))||c>57){_=(46===c?o+t.slice(i+1):t.slice(i))+_,t=t.slice(0,i);break}}g&&!f&&(t=r(t,1/0));var A=d.length+t.length+_.length,C=A<p?new Array(p-A+1).join(e):"";switch(g&&f&&(t=r(C+t,C.length?p-_.length:1/0),C=""),n){case"<":t=d+t+_+C;break;case"=":t=d+C+t+_;break;case"^":t=C.slice(0,A=C.length>>1)+d+t+_+C.slice(A);break;default:t=C+d+t+_}return s(t)}return m=void 0===m?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),_.toString=function(){return t+""},_}return{format:h,formatPrefix:function(t,e){var n=h(((t=grt(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(vrt(e)/3))),i=Math.pow(10,-r),a=Crt[8+r/3];return function(t){return n(i*t)+a}}}}function Trt(t,e,n){return t.fields=e||[],t.fname=n,t}function Nrt(t){return 1===t.length?Drt(t[0]):Frt(t)}!function(t){krt=Ert(t),_rt=krt.format,Srt=krt.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});const Drt=t=>function(e){return e[t]},Frt=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function Irt(t){throw Error(t)}function Mrt(t){const e=[],n=t.length;let r,i,a,o=null,s=0,c="";function u(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)c+=t.substring(r,i++),r=i;else if(a===o)u(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&u(),s=r=i+1):"]"===a&&(s||Irt("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&Irt("Access path missing closing bracket: "+t),o&&Irt("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function Ort(t,e,n){const r=Mrt(t);return t=1===r.length?r[0]:t,Trt((n&&n.get||Nrt)(r),[t],e||t)}Ort("id"),Trt((t=>t),[],"identity"),Trt((()=>0),[],"zero"),Trt((()=>1),[],"one"),Trt((()=>!0),[],"true"),Trt((()=>!1),[],"false");Array.isArray;function Rrt(t){return t===Object(t)}function zrt(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}Object.prototype.hasOwnProperty;function Brt(t){return"string"===typeof t}const Lrt="year",Prt="quarter",jrt="month",Urt="week",Wrt="date",Vrt="day",qrt="dayofyear",Grt="hours",Hrt="minutes",Yrt="seconds",Xrt="milliseconds";[Lrt,Prt,jrt,Urt,Wrt,Vrt,qrt,Grt,Hrt,Yrt,Xrt].reduce(((t,e,n)=>(t[e]=1+n,t)),{});"".concat(Lrt,"-").concat(jrt),"".concat(Lrt,"-").concat(jrt,"-").concat(Wrt),"".concat(Grt,"-").concat(Hrt);new Date;const Krt={[Lrt]:mi,[Prt]:vi.every(3),[jrt]:vi,[Urt]:ei,[Wrt]:Zr,[Vrt]:Zr,[qrt]:Zr,[Grt]:xi,[Hrt]:ki,[Yrt]:Si,[Xrt]:Ai},$rt={[Lrt]:yi,[Prt]:bi.every(3),[jrt]:bi,[Urt]:ui,[Wrt]:Qr,[Vrt]:Qr,[qrt]:Qr,[Grt]:wi,[Hrt]:_i,[Yrt]:Si,[Xrt]:Ai};function Zrt(t){return Krt[t]}function Qrt(t){return $rt[t]}const Jrt=[Lrt,jrt,Wrt,Grt,Hrt,Yrt,Xrt],tit=Jrt.slice(0,-1),eit=tit.slice(0,-1),nit=eit.slice(0,-1);nit.slice(0,-1);var rit=new Date,iit=new Date;function ait(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,a){var o,s=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r)||!(a>0))return s;do{s.push(o=new Date(+n)),e(n,a),t(n)}while(o<n&&n<r);return s},i.filter=function(n){return ait((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return rit.setTime(+e),iit.setTime(+r),t(rit),t(iit),Math.floor(n(rit,iit))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t===0}:function(e){return i.count(0,e)%t===0}):i:null}),i}const oit=6e4,sit=864e5,cit=6048e5;function uit(t){return ait((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/cit}))}var lit=uit(0),hit=uit(1),dit=uit(2),fit=uit(3),pit=uit(4),git=uit(5),mit=uit(6),yit=(lit.range,hit.range,dit.range,fit.range,pit.range,git.range,mit.range,ait((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/sit}),(function(t){return t.getUTCDate()-1})));const vit=yit;yit.range;function bit(t){return ait((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*oit)/cit}))}var xit=bit(0),wit=bit(1),kit=bit(2),_it=bit(3),Sit=bit(4),Ait=bit(5),Cit=bit(6),Eit=(xit.range,wit.range,kit.range,_it.range,Sit.range,Ait.range,Cit.range,ait((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*oit)/sit),(t=>t.getDate()-1)));const Tit=Eit;Eit.range;var Nit=ait((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));Nit.every=function(t){return isFinite(t=Math.floor(t))&&t>0?ait((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};const Dit=Nit;Nit.range;var Fit=ait((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));Fit.every=function(t){return isFinite(t=Math.floor(t))&&t>0?ait((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};const Iit=Fit;Fit.range;function Mit(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Oit(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Rit(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function zit(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,a=t.days,o=t.shortDays,s=t.months,c=t.shortMonths,u=Xit(i),l=Kit(i),h=Xit(a),d=Kit(a),f=Xit(o),p=Kit(o),g=Xit(s),m=Kit(s),y=Xit(c),v=Kit(c),b={a:function(t){return o[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:mat,e:mat,f:wat,g:Iat,G:Oat,H:yat,I:vat,j:bat,L:xat,m:kat,M:_at,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:rot,s:iot,S:Sat,u:Aat,U:Cat,V:Tat,w:Nat,W:Dat,x:null,X:null,y:Fat,Y:Mat,Z:Rat,"%":not},x={a:function(t){return o[t.getUTCDay()]},A:function(t){return a[t.getUTCDay()]},b:function(t){return c[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:zat,e:zat,f:Uat,g:Qat,G:tot,H:Bat,I:Lat,j:Pat,L:jat,m:Wat,M:Vat,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:rot,s:iot,S:qat,u:Gat,U:Hat,V:Xat,w:Kat,W:$at,x:null,X:null,y:Zat,Y:Jat,Z:eot,"%":not},w={a:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(t,e,n){var r=y.exec(e.slice(n));return r?(t.m=v.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(t,e,n){var r=g.exec(e.slice(n));return r?(t.m=m.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(t,n,r){return S(t,e,n,r)},d:oat,e:oat,f:dat,g:nat,G:eat,H:cat,I:cat,j:sat,L:hat,m:aat,M:uat,p:function(t,e,n){var r=u.exec(e.slice(n));return r?(t.p=l.get(r[0].toLowerCase()),n+r[0].length):-1},q:iat,Q:pat,s:gat,S:lat,u:Zit,U:Qit,V:Jit,w:$it,W:tat,x:function(t,e,r){return S(t,n,e,r)},X:function(t,e,n){return S(t,r,e,n)},y:nat,Y:eat,Z:rat,"%":fat};function k(t,e){return function(n){var r,i,a,o=[],s=-1,c=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++s<u;)37===t.charCodeAt(s)&&(o.push(t.slice(c,s)),null!=(i=Wit[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(a=e[r])&&(r=a(n,i)),o.push(r),c=s+1);return o.push(t.slice(c,s)),o.join("")}}function _(t,e){return function(n){var r,i,a=Rit(1900,void 0,1);if(S(a,t,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("s"in a)return new Date(1e3*a.s+("L"in a?a.L:0));if(e&&!("Z"in a)&&(a.Z=0),"p"in a&&(a.H=a.H%12+12*a.p),void 0===a.m&&(a.m="q"in a?a.q:0),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(i=(r=Oit(Rit(a.y,0,1))).getUTCDay(),r=i>4||0===i?hit.ceil(r):hit(r),r=vit.offset(r,7*(a.V-1)),a.y=r.getUTCFullYear(),a.m=r.getUTCMonth(),a.d=r.getUTCDate()+(a.w+6)%7):(i=(r=Mit(Rit(a.y,0,1))).getDay(),r=i>4||0===i?wit.ceil(r):wit(r),r=Tit.offset(r,7*(a.V-1)),a.y=r.getFullYear(),a.m=r.getMonth(),a.d=r.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),i="Z"in a?Oit(Rit(a.y,0,1)).getUTCDay():Mit(Rit(a.y,0,1)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(i+5)%7:a.w+7*a.U-(i+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,Oit(a)):Mit(a)}}function S(t,e,n,r){for(var i,a,o=0,s=e.length,c=n.length;o<s;){if(r>=c)return-1;if(37===(i=e.charCodeAt(o++))){if(i=e.charAt(o++),!(a=w[i in Wit?e.charAt(o++):i])||(r=a(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=k(n,b),b.X=k(r,b),b.c=k(e,b),x.x=k(n,x),x.X=k(r,x),x.c=k(e,x),{format:function(t){var e=k(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=_(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=k(t+="",x);return e.toString=function(){return t},e},utcParse:function(t){var e=_(t+="",!0);return e.toString=function(){return t},e}}}var Bit,Lit,Pit,jit,Uit,Wit={"-":"",_:" ",0:"0"},Vit=/^\s*\d+/,qit=/^%/,Git=/[\\^$*+?|[\]().{}]/g;function Hit(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function Yit(t){return t.replace(Git,"\\$&")}function Xit(t){return new RegExp("^(?:"+t.map(Yit).join("|")+")","i")}function Kit(t){return new Map(t.map(((t,e)=>[t.toLowerCase(),e])))}function $it(t,e,n){var r=Vit.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Zit(t,e,n){var r=Vit.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Qit(t,e,n){var r=Vit.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Jit(t,e,n){var r=Vit.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function tat(t,e,n){var r=Vit.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function eat(t,e,n){var r=Vit.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function nat(t,e,n){var r=Vit.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function rat(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function iat(t,e,n){var r=Vit.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function aat(t,e,n){var r=Vit.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function oat(t,e,n){var r=Vit.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function sat(t,e,n){var r=Vit.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function cat(t,e,n){var r=Vit.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function uat(t,e,n){var r=Vit.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function lat(t,e,n){var r=Vit.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function hat(t,e,n){var r=Vit.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function dat(t,e,n){var r=Vit.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function fat(t,e,n){var r=qit.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function pat(t,e,n){var r=Vit.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function gat(t,e,n){var r=Vit.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function mat(t,e){return Hit(t.getDate(),e,2)}function yat(t,e){return Hit(t.getHours(),e,2)}function vat(t,e){return Hit(t.getHours()%12||12,e,2)}function bat(t,e){return Hit(1+Tit.count(Dit(t),t),e,3)}function xat(t,e){return Hit(t.getMilliseconds(),e,3)}function wat(t,e){return xat(t,e)+"000"}function kat(t,e){return Hit(t.getMonth()+1,e,2)}function _at(t,e){return Hit(t.getMinutes(),e,2)}function Sat(t,e){return Hit(t.getSeconds(),e,2)}function Aat(t){var e=t.getDay();return 0===e?7:e}function Cat(t,e){return Hit(xit.count(Dit(t)-1,t),e,2)}function Eat(t){var e=t.getDay();return e>=4||0===e?Sit(t):Sit.ceil(t)}function Tat(t,e){return t=Eat(t),Hit(Sit.count(Dit(t),t)+(4===Dit(t).getDay()),e,2)}function Nat(t){return t.getDay()}function Dat(t,e){return Hit(wit.count(Dit(t)-1,t),e,2)}function Fat(t,e){return Hit(t.getFullYear()%100,e,2)}function Iat(t,e){return Hit((t=Eat(t)).getFullYear()%100,e,2)}function Mat(t,e){return Hit(t.getFullYear()%1e4,e,4)}function Oat(t,e){var n=t.getDay();return Hit((t=n>=4||0===n?Sit(t):Sit.ceil(t)).getFullYear()%1e4,e,4)}function Rat(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Hit(e/60|0,"0",2)+Hit(e%60,"0",2)}function zat(t,e){return Hit(t.getUTCDate(),e,2)}function Bat(t,e){return Hit(t.getUTCHours(),e,2)}function Lat(t,e){return Hit(t.getUTCHours()%12||12,e,2)}function Pat(t,e){return Hit(1+vit.count(Iit(t),t),e,3)}function jat(t,e){return Hit(t.getUTCMilliseconds(),e,3)}function Uat(t,e){return jat(t,e)+"000"}function Wat(t,e){return Hit(t.getUTCMonth()+1,e,2)}function Vat(t,e){return Hit(t.getUTCMinutes(),e,2)}function qat(t,e){return Hit(t.getUTCSeconds(),e,2)}function Gat(t){var e=t.getUTCDay();return 0===e?7:e}function Hat(t,e){return Hit(lit.count(Iit(t)-1,t),e,2)}function Yat(t){var e=t.getUTCDay();return e>=4||0===e?pit(t):pit.ceil(t)}function Xat(t,e){return t=Yat(t),Hit(pit.count(Iit(t),t)+(4===Iit(t).getUTCDay()),e,2)}function Kat(t){return t.getUTCDay()}function $at(t,e){return Hit(hit.count(Iit(t)-1,t),e,2)}function Zat(t,e){return Hit(t.getUTCFullYear()%100,e,2)}function Qat(t,e){return Hit((t=Yat(t)).getUTCFullYear()%100,e,2)}function Jat(t,e){return Hit(t.getUTCFullYear()%1e4,e,4)}function tot(t,e){var n=t.getUTCDay();return Hit((t=n>=4||0===n?pit(t):pit.ceil(t)).getUTCFullYear()%1e4,e,4)}function eot(){return"+0000"}function not(){return"%"}function rot(t){return+t}function iot(t){return Math.floor(+t/1e3)}function aot(t){const e={};return n=>e[n]||(e[n]=t(n))}function oot(t){const e=aot(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(t){const n=grt(t||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(t,e){return n=>{const r=t(n),i=r.indexOf(e);if(i<0)return r;let a=function(t,e){let n,r=t.lastIndexOf("e");if(r>0)return r;for(r=t.length;--r>e;)if(n=t.charCodeAt(r),n>=48&&n<=57)return r+1}(r,i);const o=a<r.length?r.slice(a):"";for(;--a>i;)if("0"!==r[a]){++a;break}return r.slice(0,a)+o}}(e(n),e(".1f")(1)[1])}return e(n)},formatSpan(t,r,i,a){a=grt(null==a?",f":a);const o=HC(t,r,i),s=Math.max(Math.abs(t),Math.abs(r));let c;if(null==a.precision)switch(a.type){case"s":return isNaN(c=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(vrt(e)/3)))-vrt(Math.abs(t)))}(o,s))||(a.precision=c),n(a,s);case"":case"e":case"g":case"p":case"r":isNaN(c=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,vrt(e)-vrt(t))+1}(o,s))||(a.precision=c-("e"===a.type));break;case"f":case"%":isNaN(c=function(t){return Math.max(0,-vrt(Math.abs(t)))}(o))||(a.precision=c-2*("%"===a.type))}return e(a)}}}let sot,cot;function uot(){return sot=oot({format:_rt,formatPrefix:Srt})}function lot(t){return oot(Ert(t))}function hot(t){return arguments.length?sot=lot(t):sot}function dot(t,e,n){Rrt(n=n||{})||Irt("Invalid time multi-format specifier: ".concat(n));const r=e(Yrt),i=e(Hrt),a=e(Grt),o=e(Wrt),s=e(Urt),c=e(jrt),u=e(Prt),l=e(Lrt),h=t(n[Xrt]||".%L"),d=t(n[Yrt]||":%S"),f=t(n[Hrt]||"%I:%M"),p=t(n[Grt]||"%I %p"),g=t(n[Wrt]||n[Vrt]||"%a %d"),m=t(n[Urt]||"%b %d"),y=t(n[jrt]||"%B"),v=t(n[Prt]||"%B"),b=t(n[Lrt]||"%Y");return t=>(r(t)<t?h:i(t)<t?d:a(t)<t?f:o(t)<t?p:c(t)<t?s(t)<t?g:m:l(t)<t?u(t)<t?y:v:b)(t)}function fot(t){const e=aot(t.format),n=aot(t.utcFormat);return{timeFormat:t=>Brt(t)?e(t):dot(e,Zrt,t),utcFormat:t=>Brt(t)?n(t):dot(n,Qrt,t),timeParse:aot(t.parse),utcParse:aot(t.utcParse)}}function pot(){return cot=fot({format:Lit,parse:Pit,utcFormat:jit,utcParse:Uit})}function got(t){return fot(zit(t))}function mot(t){return arguments.length?cot=got(t):cot}!function(t){Bit=zit(t),Lit=Bit.format,Pit=Bit.parse,jit=Bit.utcFormat,Uit=Bit.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),uot(),pot();const yot=(t,e)=>zrt({},t,e);function vot(t,e){const n=t?lot(t):hot(),r=e?got(e):mot();return yot(n,r)}function bot(t,e){const n=arguments.length;return n&&2!==n&&Irt("defaultLocale expects either zero or two arguments."),n?yot(hot(t),mot(e)):yot(hot(),mot())}function xot(){return uot(),pot(),bot()}function wot(t,e,n){return t.fields=e||[],t.fname=n,t}function kot(t){return 1===t.length?_ot(t[0]):Sot(t)}const _ot=t=>function(e){return e[t]},Sot=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function Aot(t){throw Error(t)}function Cot(t){const e=[],n=t.length;let r,i,a,o=null,s=0,c="";function u(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)c+=t.substring(r,i++),r=i;else if(a===o)u(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&u(),s=r=i+1):"]"===a&&(s||Aot("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&Aot("Access path missing closing bracket: "+t),o&&Aot("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function Eot(t,e,n){const r=Cot(t);return t=1===r.length?r[0]:t,wot((n&&n.get||kot)(r),[t],e||t)}Eot("id");const Tot=wot((t=>t),[],"identity"),Not=(wot((()=>0),[],"zero"),wot((()=>1),[],"one"),wot((()=>!0),[],"true"));wot((()=>!1),[],"false");var Dot=Array.isArray;function Fot(t){return t===Object(t)}function Iot(t){return t[t.length-1]}function Mot(t){return null==t||""===t?null:+t}const Oot=t=>e=>t*Math.exp(e),Rot=t=>e=>Math.log(t*e),zot=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),Bot=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,Lot=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function Pot(t,e,n,r){const i=n(t[0]),a=n(Iot(t)),o=(a-i)*e;return[r(i-o),r(a-o)]}function jot(t,e,n,r,i){const a=r(t[0]),o=r(Iot(t)),s=null!=e?r(e):(a+o)/2;return[i(s+(a-s)*n),i(s+(o-s)*n)]}function Uot(t){return null!=t?Dot(t)?t:[t]:[]}function Wot(t){return"function"===typeof t}function Vot(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}const qot=Object.prototype.hasOwnProperty;function Got(t,e){return qot.call(t,e)}function Hot(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),Vot(r,n)}function Yot(t){return"[object Date]"===Object.prototype.toString.call(t)}function Xot(t){return"number"===typeof t}function Kot(t){return"string"===typeof t}function $ot(t,e){let n="";for(;--e>=0;)n+=t;return n}function Zot(t){return Dot(t)?"["+t.map(Zot)+"]":Fot(t)||Kot(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function Qot(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t}const Jot=t=>Xot(t)||Yot(t)?t:Date.parse(t);function tst(t,e){return e=e||Jot,null==t||""===t?null:e(t)}function est(t){return null==t||""===t?null:t+""}function nst(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}const rst="Literal",ist="Property",ast="ArrayExpression",ost="BinaryExpression",sst="CallExpression",cst="ConditionalExpression",ust="LogicalExpression",lst="MemberExpression",hst="ObjectExpression",dst="UnaryExpression";function fst(t){this.type=t}var pst;fst.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=function(t){switch(t.type){case ast:return t.elements;case ost:case ust:return[t.left,t.right];case sst:return[t.callee].concat(t.arguments);case cst:return[t.test,t.consequent,t.alternate];case lst:return[t.object,t.property];case hst:return t.properties;case ist:return[t.key,t.value];case dst:return[t.argument];default:return[]}}(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1};var gst=1,mst=2,yst=3,vst=4,bst=5,xst=6,wst=7,kst=8;(pst={})[gst]="Boolean",pst[mst]="<end>",pst[yst]="Identifier",pst[vst]="Keyword",pst[bst]="Null",pst[xst]="Numeric",pst[wst]="Punctuator",pst[kst]="String",pst[9]="RegularExpression";var _st={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function Sst(t){function e(e,n,r){return i=>function(e,n,r,i){let a=t(n[0]);return r&&(a=r+"("+a+")",0===r.lastIndexOf("new ",0)&&(a="("+a+")")),a+"."+e+(i<0?"":0===i?"()":"("+n.slice(1).map(t).join(",")+")")}(e,i,n,r)}const n="new Date",r="String",i="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(e){e.length<3&&Aot("Missing arguments to clamp function."),e.length>3&&Aot("Too many arguments to clamp function.");const n=e.map(t);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:e("getDate",n,0),day:e("getDay",n,0),year:e("getFullYear",n,0),month:e("getMonth",n,0),hours:e("getHours",n,0),minutes:e("getMinutes",n,0),seconds:e("getSeconds",n,0),milliseconds:e("getMilliseconds",n,0),time:e("getTime",n,0),timezoneoffset:e("getTimezoneOffset",n,0),utcdate:e("getUTCDate",n,0),utcday:e("getUTCDay",n,0),utcyear:e("getUTCFullYear",n,0),utcmonth:e("getUTCMonth",n,0),utchours:e("getUTCHours",n,0),utcminutes:e("getUTCMinutes",n,0),utcseconds:e("getUTCSeconds",n,0),utcmilliseconds:e("getUTCMilliseconds",n,0),length:e("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:e("toUpperCase",r,0),lower:e("toLowerCase",r,0),substring:e("substring",r),split:e("split",r),trim:e("trim",r,0),regexp:i,test:e("test",i),if:function(e){e.length<3&&Aot("Missing arguments to if function."),e.length>3&&Aot("Too many arguments to if function.");const n=e.map(t);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}var Ast,Cst,Est,Tst,Nst,Dst,Fst,Ist,Mst,Ost,Rst,zst,Bst,Lst,Pst,jst,Ust=new W3,Wst=new W3,Vst={point:V3,lineStart:V3,lineEnd:V3,polygonStart:function(){Ust=new W3,Vst.lineStart=qst,Vst.lineEnd=Gst},polygonEnd:function(){var t=+Ust;Wst.add(t<0?NF+t:t),this.lineStart=this.lineEnd=this.point=V3},sphere:function(){Wst.add(NF)}};function qst(){Vst.point=Hst}function Gst(){Yst(Ast,Cst)}function Hst(t,e){Vst.point=Yst,Ast=t,Cst=e,Est=t*=FF,Tst=RF(e=(e*=FF)/2+TF),Nst=UF(e)}function Yst(t,e){var n=(t*=FF)-Est,r=n>=0?1:-1,i=r*n,a=RF(e=(e*=FF)/2+TF),o=UF(e),s=Nst*o,c=Tst*a+s*RF(i),u=s*r*UF(i);Ust.add(OF(u,c)),Est=t,Tst=a,Nst=o}var Xst,Kst,$st,Zst,Qst,Jst,tct,ect,nct,rct,ict,act,oct,sct,cct,uct,lct={point:hct,lineStart:fct,lineEnd:pct,polygonStart:function(){lct.point=gct,lct.lineStart=mct,lct.lineEnd=yct,Lst=new W3,Vst.polygonStart()},polygonEnd:function(){Vst.polygonEnd(),lct.point=hct,lct.lineStart=fct,lct.lineEnd=pct,Ust<0?(Dst=-(Ist=180),Fst=-(Mst=90)):Lst>SF?Mst=90:Lst<-SF&&(Fst=-90),jst[0]=Dst,jst[1]=Ist},sphere:function(){Dst=-(Ist=180),Fst=-(Mst=90)}};function hct(t,e){Pst.push(jst=[Dst=t,Ist=t]),e<Fst&&(Fst=e),e>Mst&&(Mst=e)}function dct(t,e){var n=Q4([t*FF,e*FF]);if(Bst){var r=t5(Bst,n),i=t5([r[1],-r[0],0],r);r5(i),i=Z4(i);var a,o=t-Ost,s=o>0?1:-1,c=i[0]*DF*s,u=IF(o)>180;u^(s*Ost<c&&c<s*t)?(a=i[1]*DF)>Mst&&(Mst=a):u^(s*Ost<(c=(c+360)%360-180)&&c<s*t)?(a=-i[1]*DF)<Fst&&(Fst=a):(e<Fst&&(Fst=e),e>Mst&&(Mst=e)),u?t<Ost?vct(Dst,t)>vct(Dst,Ist)&&(Ist=t):vct(t,Ist)>vct(Dst,Ist)&&(Dst=t):Ist>=Dst?(t<Dst&&(Dst=t),t>Ist&&(Ist=t)):t>Ost?vct(Dst,t)>vct(Dst,Ist)&&(Ist=t):vct(t,Ist)>vct(Dst,Ist)&&(Dst=t)}else Pst.push(jst=[Dst=t,Ist=t]);e<Fst&&(Fst=e),e>Mst&&(Mst=e),Bst=n,Ost=t}function fct(){lct.point=dct}function pct(){jst[0]=Dst,jst[1]=Ist,lct.point=hct,Bst=null}function gct(t,e){if(Bst){var n=t-Ost;Lst.add(IF(n)>180?n+(n>0?360:-360):n)}else Rst=t,zst=e;Vst.point(t,e),dct(t,e)}function mct(){Vst.lineStart()}function yct(){gct(Rst,zst),Vst.lineEnd(),IF(Lst)>SF&&(Dst=-(Ist=180)),jst[0]=Dst,jst[1]=Ist,Bst=null}function vct(t,e){return(e-=t)<0?e+360:e}function bct(t,e){return t[0]-e[0]}function xct(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var wct={sphere:V3,point:kct,lineStart:Sct,lineEnd:Ect,polygonStart:function(){wct.lineStart=Tct,wct.lineEnd=Nct},polygonEnd:function(){wct.lineStart=Sct,wct.lineEnd=Ect}};function kct(t,e){t*=FF;var n=RF(e*=FF);_ct(n*RF(t),n*UF(t),UF(e))}function _ct(t,e,n){++Xst,$st+=(t-$st)/Xst,Zst+=(e-Zst)/Xst,Qst+=(n-Qst)/Xst}function Sct(){wct.point=Act}function Act(t,e){t*=FF;var n=RF(e*=FF);sct=n*RF(t),cct=n*UF(t),uct=UF(e),wct.point=Cct,_ct(sct,cct,uct)}function Cct(t,e){t*=FF;var n=RF(e*=FF),r=n*RF(t),i=n*UF(t),a=UF(e),o=OF(VF((o=cct*a-uct*i)*o+(o=uct*r-sct*a)*o+(o=sct*i-cct*r)*o),sct*r+cct*i+uct*a);Kst+=o,Jst+=o*(sct+(sct=r)),tct+=o*(cct+(cct=i)),ect+=o*(uct+(uct=a)),_ct(sct,cct,uct)}function Ect(){wct.point=kct}function Tct(){wct.point=Dct}function Nct(){Fct(act,oct),wct.point=kct}function Dct(t,e){act=t,oct=e,t*=FF,e*=FF,wct.point=Fct;var n=RF(e);sct=n*RF(t),cct=n*UF(t),uct=UF(e),_ct(sct,cct,uct)}function Fct(t,e){t*=FF;var n=RF(e*=FF),r=n*RF(t),i=n*UF(t),a=UF(e),o=cct*a-uct*i,s=uct*r-sct*a,c=sct*i-cct*r,u=LF(o,s,c),l=HF(u),h=u&&-l/u;nct.add(h*o),rct.add(h*s),ict.add(h*c),Kst+=l,Jst+=l*(sct+(sct=r)),tct+=l*(cct+(cct=i)),ect+=l*(uct+(uct=a)),_ct(sct,cct,uct)}function Ict(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Mct(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Oct(t){let e,n,r;function i(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<0?i=e+1:a=e}while(i<a)}return i}return 2!==t.length?(e=Ict,n=(e,n)=>Ict(t(e),n),r=(e,n)=>t(e)-n):(e=t===Ict||t===Mct?t:Rct,n=t,r=t),{left:i,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=i(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return a>n&&r(t[a-1],e)>-r(t[a],e)?a-1:a},right:function(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(i<a){if(0!==e(r,r))return a;do{const e=i+a>>>1;n(t[e],r)<=0?i=e+1:a=e}while(i<a)}return i}}}function Rct(){return 0}const zct=Oct(Ict),Bct=zct.right,Lct=(zct.left,Oct((function(t){return null===t?NaN:+t})).center,Bct);function Pct(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function jct(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Uct(){}var Wct=.7,Vct=1.4285714285714286,qct="\\s*([+-]?\\d+)\\s*",Gct="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Hct="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Yct=/^#([0-9a-f]{3,8})$/,Xct=new RegExp("^rgb\\(".concat(qct,",").concat(qct,",").concat(qct,"\\)$")),Kct=new RegExp("^rgb\\(".concat(Hct,",").concat(Hct,",").concat(Hct,"\\)$")),$ct=new RegExp("^rgba\\(".concat(qct,",").concat(qct,",").concat(qct,",").concat(Gct,"\\)$")),Zct=new RegExp("^rgba\\(".concat(Hct,",").concat(Hct,",").concat(Hct,",").concat(Gct,"\\)$")),Qct=new RegExp("^hsl\\(".concat(Gct,",").concat(Hct,",").concat(Hct,"\\)$")),Jct=new RegExp("^hsla\\(".concat(Gct,",").concat(Hct,",").concat(Hct,",").concat(Gct,"\\)$")),tut={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function eut(){return this.rgb().formatHex()}function nut(){return this.rgb().formatRgb()}function rut(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Yct.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?iut(e):3===n?new cut(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?aut(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?aut(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Xct.exec(t))?new cut(e[1],e[2],e[3],1):(e=Kct.exec(t))?new cut(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=$ct.exec(t))?aut(e[1],e[2],e[3],e[4]):(e=Zct.exec(t))?aut(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Qct.exec(t))?put(e[1],e[2]/100,e[3]/100,1):(e=Jct.exec(t))?put(e[1],e[2]/100,e[3]/100,e[4]):tut.hasOwnProperty(t)?iut(tut[t]):"transparent"===t?new cut(NaN,NaN,NaN,0):null}function iut(t){return new cut(t>>16&255,t>>8&255,255&t,1)}function aut(t,e,n,r){return r<=0&&(t=e=n=NaN),new cut(t,e,n,r)}function out(t){return t instanceof Uct||(t=rut(t)),t?new cut((t=t.rgb()).r,t.g,t.b,t.opacity):new cut}function sut(t,e,n,r){return 1===arguments.length?out(t):new cut(t,e,n,null==r?1:r)}function cut(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function uut(){return"#".concat(fut(this.r)).concat(fut(this.g)).concat(fut(this.b))}function lut(){const t=hut(this.opacity);return"".concat(1===t?"rgb(":"rgba(").concat(dut(this.r),", ").concat(dut(this.g),", ").concat(dut(this.b)).concat(1===t?")":", ".concat(t,")"))}function hut(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function dut(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function fut(t){return((t=dut(t))<16?"0":"")+t.toString(16)}function put(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new yut(t,e,n,r)}function gut(t){if(t instanceof yut)return new yut(t.h,t.s,t.l,t.opacity);if(t instanceof Uct||(t=rut(t)),!t)return new yut;if(t instanceof yut)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new yut(o,s,c,t.opacity)}function mut(t,e,n,r){return 1===arguments.length?gut(t):new yut(t,e,n,null==r?1:r)}function yut(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function vut(t){return(t=(t||0)%360)<0?t+360:t}function but(t){return Math.max(0,Math.min(1,t||0))}function xut(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function wut(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}function kut(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,s=r<e-1?t[r+2]:2*a-i;return wut((n-r/e)*e,o,i,a,s)}}function _ut(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],s=t[(r+2)%e];return wut((n-r/e)*e,i,a,o,s)}}Pct(Uct,rut,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:eut,formatHex:eut,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return gut(this).formatHsl()},formatRgb:nut,toString:nut}),Pct(cut,sut,jct(Uct,{brighter(t){return t=null==t?Vct:Math.pow(Vct,t),new cut(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?Wct:Math.pow(Wct,t),new cut(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new cut(dut(this.r),dut(this.g),dut(this.b),hut(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:uut,formatHex:uut,formatHex8:function(){return"#".concat(fut(this.r)).concat(fut(this.g)).concat(fut(this.b)).concat(fut(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:lut,toString:lut})),Pct(yut,mut,jct(Uct,{brighter(t){return t=null==t?Vct:Math.pow(Vct,t),new yut(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Wct:Math.pow(Wct,t),new yut(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new cut(xut(t>=240?t-240:t+120,i,r),xut(t,i,r),xut(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new yut(vut(this.h),but(this.s),but(this.l),hut(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=hut(this.opacity);return"".concat(1===t?"hsl(":"hsla(").concat(vut(this.h),", ").concat(100*but(this.s),"%, ").concat(100*but(this.l),"%").concat(1===t?")":", ".concat(t,")"))}}));const Sut=t=>()=>t;function Aut(t,e){return function(n){return t+n*e}}function Cut(t,e){var n=e-t;return n?Aut(t,n>180||n<-180?n-360*Math.round(n/360):n):Sut(isNaN(t)?e:t)}function Eut(t){return 1===(t=+t)?Tut:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Sut(isNaN(e)?n:e)}}function Tut(t,e){var n=e-t;return n?Aut(t,n):Sut(isNaN(t)?e:t)}const Nut=function t(e){var n=Eut(e);function r(t,e){var r=n((t=sut(t)).r,(e=sut(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=Tut(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function Dut(t){return function(e){var n,r,i=e.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=sut(e[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=t(a),o=t(o),s=t(s),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=s(t),r+""}}}var Fut=Dut(kut),Iut=Dut(_ut);function Mut(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(a){for(n=0;n<r;++n)i[n]=t[n]*(1-a)+e[n]*a;return i}}function Out(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Rut(t,e){return(Out(e)?Mut:zut)(t,e)}function zut(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=Vut(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}function But(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Lut(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Put(t,e){var n,r={},i={};for(n in null!==t&&"object"===typeof t||(t={}),null!==e&&"object"===typeof e||(e={}),e)n in t?r[n]=Vut(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var jut=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Uut=new RegExp(jut.source,"g");function Wut(t,e){var n,r,i,a=jut.lastIndex=Uut.lastIndex=0,o=-1,s=[],c=[];for(t+="",e+="";(n=jut.exec(t))&&(r=Uut.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,c.push({i:o,x:Lut(n,r)})),a=Uut.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?c[0]?function(t){return function(e){return t(e)+""}}(c[0].x):function(t){return function(){return t}}(e):(e=c.length,function(t){for(var n,r=0;r<e;++r)s[(n=c[r]).i]=n.x(t);return s.join("")})}function Vut(t,e){var n,r=typeof e;return null==e||"boolean"===r?Sut(e):("number"===r?Lut:"string"===r?(n=rut(e))?(e=n,Nut):Wut:e instanceof rut?Nut:e instanceof Date?But:Out(e)?Mut:Array.isArray(e)?zut:"function"!==typeof e.valueOf&&"function"!==typeof e.toString||isNaN(e)?Put:Lut)(t,e)}function qut(t,e){void 0===e&&(e=t,t=Vut);for(var n=0,r=e.length-1,i=e[0],a=new Array(r<0?0:r);n<r;)a[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return a[e](t-e)}}function Gut(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function Hut(t,e){var n=Cut(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}}function Yut(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Xut,Kut=180/Math.PI,$ut={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Zut(t,e,n,r,i,a){var o,s,c;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),t*r<e*n&&(t=-t,e=-e,c=-c,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*Kut,skewX:Math.atan(c)*Kut,scaleX:o,scaleY:s}}function Qut(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var s=[],c=[];return a=t(a),o=t(o),function(t,r,i,a,o,s){if(t!==i||r!==a){var c=o.push("translate(",null,e,null,n);s.push({i:c-4,x:Lut(t,i)},{i:c-2,x:Lut(r,a)})}else(i||a)&&o.push("translate("+i+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,c),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Lut(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(a.rotate,o.rotate,s,c),function(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Lut(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(a.skewX,o.skewX,s,c),function(t,e,n,r,a,o){if(t!==n||e!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:Lut(t,n)},{i:s-2,x:Lut(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,c),a=o=null,function(t){for(var e,n=-1,r=c.length;++n<r;)s[(e=c[n]).i]=e.x(t);return s.join("")}}}var Jut=Qut((function(t){const e=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?$ut:Zut(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),tlt=Qut((function(t){return null==t?$ut:(Xut||(Xut=document.createElementNS("http://www.w3.org/2000/svg","g")),Xut.setAttribute("transform",t),(t=Xut.transform.baseVal.consolidate())?Zut((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):$ut)}),", ",")",")");function elt(t){return((t=Math.exp(t))+1/t)/2}const nlt=function t(e,n,r){function i(t,i){var a,o,s=t[0],c=t[1],u=t[2],l=i[0],h=i[1],d=i[2],f=l-s,p=h-c,g=f*f+p*p;if(g<1e-12)o=Math.log(d/u)/e,a=function(t){return[s+t*f,c+t*p,u*Math.exp(e*t*o)]};else{var m=Math.sqrt(g),y=(d*d-u*u+r*g)/(2*u*n*m),v=(d*d-u*u-r*g)/(2*d*n*m),b=Math.log(Math.sqrt(y*y+1)-y),x=Math.log(Math.sqrt(v*v+1)-v);o=(x-b)/e,a=function(t){var r=t*o,i=elt(b),a=u/(n*m)*(i*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(e*r+b)-function(t){return((t=Math.exp(t))-1/t)/2}(b));return[s+a*f,c+a*p,u*i/elt(e*r+b)]}}return a.duration=1e3*o*e/Math.SQRT2,a}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i}(Math.SQRT2,2,4);function rlt(t){return function(e,n){var r=t((e=mut(e)).h,(n=mut(n)).h),i=Tut(e.s,n.s),a=Tut(e.l,n.l),o=Tut(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=a(t),e.opacity=o(t),e+""}}}const ilt=rlt(Cut);var alt=rlt(Tut);const olt=Math.PI/180,slt=180/Math.PI,clt=.96422,ult=1,llt=.82521,hlt=4/29,dlt=6/29,flt=.12841854934601665,plt=.008856451679035631;function glt(t){if(t instanceof ylt)return new ylt(t.l,t.a,t.b,t.opacity);if(t instanceof Slt)return Alt(t);t instanceof cut||(t=out(t));var e,n,r=wlt(t.r),i=wlt(t.g),a=wlt(t.b),o=vlt((.2225045*r+.7168786*i+.0606169*a)/ult);return r===i&&i===a?e=n=o:(e=vlt((.4360747*r+.3850649*i+.1430804*a)/clt),n=vlt((.0139322*r+.0971045*i+.7141733*a)/llt)),new ylt(116*o-16,500*(e-o),200*(o-n),t.opacity)}function mlt(t,e,n,r){return 1===arguments.length?glt(t):new ylt(t,e,n,null==r?1:r)}function ylt(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function vlt(t){return t>plt?Math.pow(t,1/3):t/flt+hlt}function blt(t){return t>dlt?t*t*t:flt*(t-hlt)}function xlt(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function wlt(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function klt(t){if(t instanceof Slt)return new Slt(t.h,t.c,t.l,t.opacity);if(t instanceof ylt||(t=glt(t)),0===t.a&&0===t.b)return new Slt(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*slt;return new Slt(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function _lt(t,e,n,r){return 1===arguments.length?klt(t):new Slt(t,e,n,null==r?1:r)}function Slt(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function Alt(t){if(isNaN(t.h))return new ylt(t.l,0,0,t.opacity);var e=t.h*olt;return new ylt(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function Clt(t,e){var n=Tut((t=mlt(t)).l,(e=mlt(e)).l),r=Tut(t.a,e.a),i=Tut(t.b,e.b),a=Tut(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=a(e),t+""}}function Elt(t){return function(e,n){var r=t((e=_lt(e)).h,(n=_lt(n)).h),i=Tut(e.c,n.c),a=Tut(e.l,n.l),o=Tut(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=a(t),e.opacity=o(t),e+""}}}Pct(ylt,mlt,jct(Uct,{brighter(t){return new ylt(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker(t){return new ylt(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new cut(xlt(3.1338561*(e=clt*blt(e))-1.6168667*(t=ult*blt(t))-.4906146*(n=llt*blt(n))),xlt(-.9787684*e+1.9161415*t+.033454*n),xlt(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Pct(Slt,_lt,jct(Uct,{brighter(t){return new Slt(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker(t){return new Slt(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb(){return Alt(this).rgb()}}));const Tlt=Elt(Cut);var Nlt=Elt(Tut),Dlt=-.14861,Flt=1.78277,Ilt=-.29227,Mlt=-.90649,Olt=1.97294,Rlt=Olt*Mlt,zlt=Olt*Flt,Blt=Flt*Ilt-Mlt*Dlt;function Llt(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof Plt)return new Plt(t.h,t.s,t.l,t.opacity);t instanceof cut||(t=out(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(Blt*r+Rlt*e-zlt*n)/(Blt+Rlt-zlt),a=r-i,o=(Olt*(n-i)-Ilt*a)/Mlt,s=Math.sqrt(o*o+a*a)/(Olt*i*(1-i)),c=s?Math.atan2(o,a)*slt-120:NaN;return new Plt(c<0?c+360:c,s,i,t.opacity)}(t):new Plt(t,e,n,null==r?1:r)}function Plt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function jlt(t){return function e(n){function r(e,r){var i=t((e=Llt(e)).h,(r=Llt(r)).h),a=Tut(e.s,r.s),o=Tut(e.l,r.l),s=Tut(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=a(t),e.l=o(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}Pct(Plt,Llt,jct(Uct,{brighter(t){return t=null==t?Vct:Math.pow(Vct,t),new Plt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Wct:Math.pow(Wct,t),new Plt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*olt,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new cut(255*(e+n*(Dlt*r+Flt*i)),255*(e+n*(Ilt*r+Mlt*i)),255*(e+n*(Olt*r)),this.opacity)}}));const Ult=jlt(Cut);var Wlt=jlt(Tut);function Vlt(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}const qlt="year",Glt="quarter",Hlt="month",Ylt="week",Xlt="date",Klt="day",$lt="dayofyear",Zlt="hours",Qlt="minutes",Jlt="seconds",tht="milliseconds",eht=[qlt,Glt,Hlt,Ylt,Xlt,Klt,$lt,Zlt,Qlt,Jlt,tht].reduce(((t,e,n)=>(t[e]=1+n,t)),{});const nht={[qlt]:"%Y ",[Glt]:"Q%q ",[Hlt]:"%b ",[Xlt]:"%d ",[Ylt]:"W%U ",[Klt]:"%a ",[$lt]:"%j ",[Zlt]:"%H:00",[Qlt]:"00:%M",[Jlt]:":%S",[tht]:".%L",["".concat(qlt,"-").concat(Hlt)]:"%Y-%m ",["".concat(qlt,"-").concat(Hlt,"-").concat(Xlt)]:"%Y-%m-%d ",["".concat(Zlt,"-").concat(Qlt)]:"%H:%M"};const rht=new Date;function iht(t){return rht.setFullYear(t),rht.setMonth(0),rht.setDate(1),rht.setHours(0,0,0,0),rht}function aht(t){return Zr.count(iht(t.getFullYear())-1,t)}function oht(t){return ei.count(iht(t.getFullYear())-1,t)}function sht(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return Qr.count(e-1,t)}function cht(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return ui.count(e-1,t)}const uht={[qlt]:mi,[Glt]:vi.every(3),[Hlt]:vi,[Ylt]:ei,[Xlt]:Zr,[Klt]:Zr,[$lt]:Zr,[Zlt]:xi,[Qlt]:ki,[Jlt]:Si,[tht]:Ai},lht={[qlt]:yi,[Glt]:bi.every(3),[Hlt]:bi,[Ylt]:ui,[Xlt]:Qr,[Klt]:Qr,[$lt]:Qr,[Zlt]:wi,[Qlt]:_i,[Jlt]:Si,[tht]:Ai};function hht(t){return uht[t]}function dht(t){return lht[t]}function fht(t,e,n){return t?t.offset(e,n):void 0}function pht(t,e,n,r){return t?t.range(e,n,r):void 0}const ght=[qlt,Hlt,Xlt,Zlt,Qlt,Jlt,tht],mht=ght.slice(0,-1),yht=mht.slice(0,-1),vht=yht.slice(0,-1);vht.slice(0,-1);function bht(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0}const xht="linear",wht="log",kht="pow",_ht="sqrt",Sht="symlog",Aht="time",Cht="utc",Eht="sequential",Tht="diverging",Nht="quantile",Dht="quantize",Fht="threshold",Iht="continuous",Mht="discrete",Oht="discretizing",Rht="interpolating",zht="temporal";function Bht(){const t=jg().unknown(void 0),e=t.domain,n=t.range;let r,i,a=[0,1],o=!1,s=0,c=0,u=.5;function l(){const t=e().length,l=a[1]<a[0],h=a[1-l],d=bht(t,s,c);let f=a[l-0];r=(h-f)/(d||1),o&&(r=Math.floor(r)),f+=(h-f-r*(t-s))*u,i=r*(1-s),o&&(f=Math.round(f),i=Math.round(i));const p=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a}(t).map((t=>f+r*t));return n(l?p.reverse():p)}return delete t.unknown,t.domain=function(t){return arguments.length?(e(t),l()):e()},t.range=function(t){return arguments.length?(a=[+t[0],+t[1]],l()):a.slice()},t.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,l()},t.bandwidth=function(){return i},t.step=function(){return r},t.round=function(t){return arguments.length?(o=!!t,l()):o},t.padding=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),s=c,l()):s},t.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),l()):s},t.paddingOuter=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),l()):c},t.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),l()):u},t.invertRange=function(t){if(null==t[0]||null==t[1])return;const r=a[1]<a[0],o=r?n().reverse():n(),s=o.length-1;let c,u,l,h=+t[0],d=+t[1];return h!==h||d!==d||(d<h&&(l=h,h=d,d=l),d<o[0]||h>a[1-r])?void 0:(c=Math.max(0,Bct(o,h)-1),u=h===d?c:Bct(o,d)-1,h-o[c]>i+1e-10&&++c,r&&(l=c,c=s-u,u=s-l),c>u?void 0:e().slice(c,u+1))},t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return Bht().domain(e()).range(a).round(o).paddingInner(s).paddingOuter(c).align(u)},l()}function Lht(t){const e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return Lht(e())},t}var Pht=Array.prototype.map;const jht=Array.prototype.slice;const Uht=new Map,Wht=Symbol("vega_scale");function Vht(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){let n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){const n=t.range();let r,i,a,o,s=e[0],c=e[1],u=-1;for(c<s&&(i=s,s=c,c=i),a=0,o=n.length;a<o;++a)n[a]>=s&&n[a]<=c&&(u<0&&(u=a),r=a);if(!(u<0))return s=t.invertExtent(n[u]),c=t.invertExtent(n[r]),[void 0===s[0]?s[1]:s[0],void 0===c[1]?c[0]:c[1]]}}(n):void 0),n.type=t,function(t){return t[Wht]=!0,t}(n)};return r.metadata=nst(Uot(n)),r}function qht(t,e,n){return arguments.length>1?(Uht.set(t,Vht(t,e,n)),this):function(t){return Uht.has(t)}(t)?Uht.get(t):void 0}function Ght(t,e){const n=Uht.get(t);return n&&n.metadata[e]}function Hht(t){return Ght(t,Mht)}qht("identity",Ip),qht(xht,Fp,Iht),qht(wht,Up,[Iht,wht]),qht(kht,Hp,Iht),qht(_ht,Yp,Iht),qht(Sht,Zp,Iht),qht(Aht,gg,[Iht,zht]),qht(Cht,mg,[Iht,zht]),qht(Eht,bg,[Iht,Rht]),qht("".concat(Eht,"-").concat(xht),bg,[Iht,Rht]),qht("".concat(Eht,"-").concat(wht),xg,[Iht,Rht,wht]),qht("".concat(Eht,"-").concat(kht),kg,[Iht,Rht]),qht("".concat(Eht,"-").concat(_ht),_g,[Iht,Rht]),qht("".concat(Eht,"-").concat(Sht),wg,[Iht,Rht]),qht("".concat(Tht,"-").concat(xht),Ag,[Iht,Rht]),qht("".concat(Tht,"-").concat(wht),Cg,[Iht,Rht,wht]),qht("".concat(Tht,"-").concat(kht),Tg,[Iht,Rht]),qht("".concat(Tht,"-").concat(_ht),Ng,[Iht,Rht]),qht("".concat(Tht,"-").concat(Sht),Eg,[Iht,Rht]),qht(Nht,Fg,[Oht,Nht]),qht(Dht,Ig,Oht),qht(Fht,Mg,Oht),qht("bin-ordinal",(function t(){let e=[],n=[];function r(t){return null==t||t!==t?void 0:n[(Lct(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=function(t){return Pht.call(t,Mot)}(t),r):e.slice()},r.range=function(t){return arguments.length?(n=jht.call(t),r):n.slice()},r.tickFormat=function(t,n){return Np(e[0],Iot(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}),[Mht,Oht]),qht("ordinal",jg,Mht),qht("band",Bht,Mht),qht("point",(function(){return Lht(Bht().paddingInner(1))}),Mht);const Yht=["clamp","base","constant","exponent"];function Xht(t,e,n){return qut(function(t,e){const n=b[function(t){return"interpolate"+t.toLowerCase().split("-").map((t=>t[0].toUpperCase()+t.slice(1))).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}(e||"rgb",n),t)}function Kht(t,e,n){const r=n-e;let i,a,o;return r&&Number.isFinite(r)?(i=(a=t.type).indexOf("-"),a=i<0?a:a.slice(i+1),o=qht(a)().domain([e,n]).range([0,1]),Yht.forEach((e=>t[e]?o[e](t[e]()):0)),o):Wot(s=.5)?s:()=>s;var s}function $ht(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function Zht(t,e){for(const n in t)Jht(n,e(t[n]))}const Qht={};function Jht(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(Qht[t]=e,this):Qht[t]}Zht({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},$ht),Zht({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(t=>Xht($ht(t))));const tdt="symbol",edt="discrete",ndt=t=>Dot(t)?t.map((t=>String(t))):String(t),rdt=(t,e)=>t[1]-e[1],idt=(t,e)=>e[1]-t[1];function adt(t,e){return t.bins?function(t,e,n){let r=t.range(),i=r[0],a=Iot(r),o=rdt;if(i>a&&(r=a,a=i,i=r,o=idt),i=Math.floor(i),a=Math.ceil(a),e=e.map((e=>[e,t(e)])).filter((t=>i<=t[1]&&t[1]<=a)).sort(o).map((t=>t[0])),n>0&&e.length>1){const t=[e[0],Iot(e)];for(;e.length>n&&e.length>=3;)e=e.filter(((t,e)=>!(e%2)));e.length<3&&(e=t)}return e}(t,t.bins):t.ticks?t.ticks(e):t.domain()}function odt(t,e,n,r,i,a){const o=e.type;let s=ndt;if(o===Aht||i===Aht)s=t.timeFormat(r);else if(o===Cht||i===Cht)s=t.utcFormat(r);else if(function(t){return Ght(t,wht)}(o)){const i=t.formatFloat(r);if(a||e.bins)s=i;else{const t=sdt(e,n,!1);s=e=>t(e)?i(e):""}}else if(e.tickFormat){const i=e.domain();s=t.formatSpan(i[0],i[i.length-1],n,r)}else r&&(s=t.format(r));return s}function sdt(t,e,n){const r=adt(t,e),i=t.base(),a=Math.log(i),o=Math.max(1,i*e/r.length),s=t=>{let e=t/Math.pow(i,Math.round(Math.log(t)/a));return e*i<i-.5&&(e*=i),e<=o};return n?r.filter(s):s}const cdt={[Nht]:"quantiles",[Dht]:"thresholds",[Fht]:"domain"},udt={[Nht]:"quantiles",[Dht]:"domain"};function ldt(t,e){return t.bins?function(t){const e=t.slice(0,-1);return e.max=Iot(t),e}(t.bins):t.type===wht?sdt(t,e,!0):cdt[t.type]?function(t){const e=[-1/0].concat(t);return e.max=1/0,e}(t[cdt[t.type]]()):adt(t,e)}const hdt=t=>cdt[t.type]||t.bins;function ddt(t,e,n,r,i,a,o){const s=udt[e.type]&&a!==Aht&&a!==Cht?function(t,e,n){const r=e[udt[e.type]](),i=r.length;let a,o=i>1?r[1]-r[0]:r[0];for(a=1;a<i;++a)o=Math.min(o,r[a]-r[a-1]);return t.formatSpan(0,o,30,n)}(t,e,i):odt(t,e,n,i,a,o);return r===tdt&&hdt(e)?fdt(s):r===edt?gdt(s):mdt(s)}const fdt=t=>(e,n,r)=>{const i=pdt(r[n+1],pdt(r.max,1/0)),a=ydt(e,t),o=ydt(i,t);return a&&o?a+" \u2013 "+o:o?"< "+o:"\u2265 "+a},pdt=(t,e)=>null!=t?t:e,gdt=t=>(e,n)=>n?t(e):null,mdt=t=>e=>t(e),ydt=(t,e)=>Number.isFinite(t)?e(t):null;function vdt(t,e,n,r){const i=r||e.type;return Kot(n)&&function(t){return Ght(t,zht)}(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||i!==Aht?n||i!==Cht?ddt(t,e,5,null,n,r,!0):t.utcFormat("%A, %d %B %Y, %X UTC"):t.timeFormat("%A, %d %B %Y, %X")}function bdt(t,e,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=vdt(t,e,n.format,n.formatType);if(function(t){return Ght(t,Oht)}(e.type)){const t=ldt(e).slice(1).map(i),n=t.length;return"".concat(n," boundar").concat(1===n?"y":"ies",": ").concat(t.join(", "))}if(Hht(e.type)){const t=e.domain(),n=t.length,a=n>r?t.slice(0,r-2).map(i).join(", ")+", ending with "+t.slice(-1).map(i):t.map(i).join(", ");return"".concat(n," value").concat(1===n?"":"s",": ").concat(a)}{const t=e.domain();return"values from ".concat(i(t[0])," to ").concat(i(Iot(t)))}}const xdt=Math.sqrt(50),wdt=Math.sqrt(10),kdt=Math.sqrt(2);function _dt(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=xdt?10:a>=wdt?5:a>=kdt?2:1;let s,c,u;return i<0?(u=Math.pow(10,-i)/o,s=Math.round(t*u),c=Math.round(e*u),s/u<t&&++s,c/u>e&&--c,u=-u):(u=Math.pow(10,i)*o,s=Math.round(t/u),c=Math.round(e/u),s*u<t&&++s,c*u>e&&--c),c<s&&.5<=n&&n<2?_dt(t,e,2*n):[s,c,u]}function Sdt(t,e,n){return _dt(t=+t,e=+e,n=+n)[2]}function Adt(t){const e={};return n=>e[n]||(e[n]=t(n))}function Cdt(t){const e=Adt(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(t){const n=Ar(t||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(t,e){return n=>{const r=t(n),i=r.indexOf(e);if(i<0)return r;let a=function(t,e){let n,r=t.lastIndexOf("e");if(r>0)return r;for(r=t.length;--r>e;)if(n=t.charCodeAt(r),n>=48&&n<=57)return r+1}(r,i);const o=a<r.length?r.slice(a):"";for(;--a>i;)if("0"!==r[a]){++a;break}return r.slice(0,a)+o}}(e(n),e(".1f")(1)[1])}return e(n)},formatSpan(t,r,i,a){a=Ar(null==a?",f":a);const o=function(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?Sdt(e,t,n):Sdt(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}(t,r,i),s=Math.max(Math.abs(t),Math.abs(r));let c;if(null==a.precision)switch(a.type){case"s":return isNaN(c=Nr(o,s))||(a.precision=c),n(a,s);case"":case"e":case"g":case"p":case"r":isNaN(c=Dr(o,s))||(a.precision=c-("e"===a.type));break;case"f":case"%":isNaN(c=Fr(o))||(a.precision=c-2*("%"===a.type))}return e(a)}}}let Edt,Tdt;function Ndt(){return Edt=Cdt({format:zr,formatPrefix:Br})}function Ddt(t,e,n){Fot(n=n||{})||Aot("Invalid time multi-format specifier: ".concat(n));const r=e(Jlt),i=e(Qlt),a=e(Zlt),o=e(Xlt),s=e(Ylt),c=e(Hlt),u=e(Glt),l=e(qlt),h=t(n[tht]||".%L"),d=t(n[Jlt]||":%S"),f=t(n[Qlt]||"%I:%M"),p=t(n[Zlt]||"%I %p"),g=t(n[Xlt]||n[Klt]||"%a %d"),m=t(n[Ylt]||"%b %d"),y=t(n[Hlt]||"%B"),v=t(n[Glt]||"%B"),b=t(n[qlt]||"%Y");return t=>(r(t)<t?h:i(t)<t?d:a(t)<t?f:o(t)<t?p:c(t)<t?s(t)<t?g:m:l(t)<t?u(t)<t?y:v:b)(t)}function Fdt(t){const e=Adt(t.format),n=Adt(t.utcFormat);return{timeFormat:t=>Kot(t)?e(t):Ddt(e,hht,t),utcFormat:t=>Kot(t)?n(t):Ddt(n,dht,t),timeParse:Adt(t.parse),utcParse:Adt(t.utcParse)}}function Idt(){return Tdt=Fdt({format:ja,parse:Ua,utcFormat:Wa,utcParse:Va})}Ndt(),Idt();const Mdt=/^(data:|([A-Za-z]+:)?\/\/)/,Odt=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Rdt=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,zdt="file://";async function Bdt(t,e){const n=await this.sanitize(t,e),r=n.href;return n.localFile?this.file(r):this.http(r,e)}async function Ldt(t,e){e=Vot({},this.options,e);const n=this.fileAccess,r={href:null};let i,a,o;const s=Odt.test(t.replace(Rdt,""));null!=t&&"string"===typeof t&&s||Aot("Sanitize failure, invalid URI: "+Zot(t));const c=Mdt.test(t);return(o=e.baseURL)&&!c&&(t.startsWith("/")||o.endsWith("/")||(t="/"+t),t=o+t),a=(i=t.startsWith(zdt))||"file"===e.mode||"http"!==e.mode&&!c&&n,i?t=t.slice(zdt.length):t.startsWith("//")&&("file"===e.defaultProtocol?(t=t.slice(2),a=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(r,"localFile",{value:!!a}),r.href=t,e.target&&(r.target=e.target+""),e.rel&&(r.rel=e.rel+""),"image"===e.context&&e.crossOrigin&&(r.crossOrigin=e.crossOrigin+""),r}function Pdt(t){return t?e=>new Promise(((n,r)=>{t.readFile(e,((t,e)=>{t?r(t):n(e)}))})):jdt}async function jdt(){Aot("No file system access.")}function Udt(t){return t?async function(e,n){const r=Vot({},this.options.http,n),i=n&&n.response,a=await t(e,r);return a.ok?Wot(a[i])?a[i]():a.text():Aot(a.status+""+a.statusText)}:Wdt}async function Wdt(){Aot("No HTTP fetch method available.")}function Vdt(t){const e=function(e,n){const r={delimiter:t};return qdt(e,n?Vot(n,r):r)};return e.responseType="text",e}function qdt(t,e){return e.header&&(t=e.header.map(Zot).join(e.delimiter)+"\n"+t),lr(e.delimiter).parse(t+"")}function Gdt(t,e){const n=e&&e.property?Eot(e.property):Tot;return!Fot(t)||(r=t,"function"===typeof Buffer&&Wot(Buffer.isBuffer)&&Buffer.isBuffer(r))?n(JSON.parse(t)):function(t,e){!Dot(t)&&function(t){return t&&Wot(t[Symbol.iterator])}(t)&&(t=[...t]);return e&&e.copy?JSON.parse(JSON.stringify(t)):t}(n(t),e);var r}qdt.responseType="text",Gdt.responseType="json";const Hdt={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function Ydt(t,e){let n,r,i,a;return t=Gdt(t,e),e&&e.feature?(n=dr,i=e.feature):e&&e.mesh?(n=mr,i=e.mesh,a=Hdt[e.filter]):Aot("Missing TopoJSON feature or mesh parameter."),r=(r=t.objects[i])?n(t,r,a):Aot("Invalid TopoJSON object: "+i),r&&r.features||[r]}Ydt.responseType="json";Vdt(","),Vdt("\t");const Xdt=function(t,e){return n=>({options:n||{},sanitize:Ldt,load:Bdt,fileAccess:!!e,file:Pdt(e),http:Udt(t)})}("undefined"!==typeof fetch&&fetch,null);let Kdt=0;const $dt="p_";function Zdt(t){return t&&t.gradient}function Qdt(t,e,n){const r=t.gradient;let i=t.id,a="radial"===r?$dt:"";return i||(i=t.id="gradient_"+Kdt++,"radial"===r?(t.x1=Jdt(t.x1,.5),t.y1=Jdt(t.y1,.5),t.r1=Jdt(t.r1,0),t.x2=Jdt(t.x2,.5),t.y2=Jdt(t.y2,.5),t.r2=Jdt(t.r2,.5),a=$dt):(t.x1=Jdt(t.x1,0),t.y1=Jdt(t.y1,0),t.x2=Jdt(t.x2,1),t.y2=Jdt(t.y2,0))),e[i]=t,"url("+(n||"")+"#"+a+i+")"}function Jdt(t,e){return null!=t?t:e}const tft={basis:{curve:dh},"basis-closed":{curve:gh},"basis-open":{curve:yh},bundle:{curve:bh,tension:"beta",value:.85},cardinal:{curve:kh,tension:"tension",value:0},"cardinal-open":{curve:Sh,tension:"tension",value:0},"cardinal-closed":{curve:Ch,tension:"tension",value:0},"catmull-rom":{curve:Uh,tension:"alpha",value:.5},"catmull-rom-closed":{curve:Vh,tension:"alpha",value:.5},"catmull-rom-open":{curve:Gh,tension:"alpha",value:.5},linear:{curve:Yh},"linear-closed":{curve:Kh},monotone:{horizontal:id,vertical:rd},natural:{curve:sd},step:{curve:ud},"step-after":{curve:hd},"step-before":{curve:ld}};function eft(t,e,n){var r=Got(tft,t)&&tft[t],i=null;return r&&(i=r.curve||r[e||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const nft={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},rft=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,ift=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,aft=/^((\s+,?\s*)|(,\s*))/,oft=/^[01]/;function sft(t){const e=[];return(t.match(rft)||[]).forEach((t=>{let n=t[0];const r=n.toLowerCase(),i=nft[r],a=function(t,e,n){const r=[];for(let i=0;e&&i<n.length;)for(let a=0;a<e;++a){const e="a"!==t||3!==a&&4!==a?ift:oft,o=n.slice(i).match(e);if(null===o)throw Error("Invalid SVG path, incorrect parameter type");i+=o[0].length,r.push(+o[0]);const s=n.slice(i).match(aft);null!==s&&(i+=s[0].length)}return r}(r,i,t.slice(1).trim()),o=a.length;if(o<i||o&&o%i!==0)throw Error("Invalid SVG path, incorrect parameter count");if(e.push([n,...a.slice(0,i)]),o!==i){"m"===r&&(n="M"===n?"L":"l");for(let t=i;t<o;t+=i)e.push([n,...a.slice(t,t+i)])}})),e}const cft=Math.PI/180,uft=Math.PI/2,lft=2*Math.PI,hft=Math.sqrt(3)/2;var dft={},fft={},pft=[].join;function gft(t){const e=pft.call(t);if(fft[e])return fft[e];var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],u=t[7];const l=u*o,h=-c*s,d=c*o,f=u*s,p=Math.cos(i),g=Math.sin(i),m=Math.cos(a),y=Math.sin(a),v=.5*(a-i),b=Math.sin(.5*v),x=8/3*b*b/Math.sin(v),w=n+p-x*g,k=r+g+x*p,_=n+m,S=r+y,A=_+x*y,C=S-x*m;return fft[e]=[l*w+h*k,d*w+f*k,l*A+h*C,d*A+f*C,l*_+h*S,d*_+f*S]}const mft=["l",0,0,0,0,0,0,0];function yft(t,e,n){const r=mft[0]=t[0];if("a"===r||"A"===r)mft[1]=e*t[1],mft[2]=n*t[2],mft[3]=t[3],mft[4]=t[4],mft[5]=t[5],mft[6]=e*t[6],mft[7]=n*t[7];else if("h"===r||"H"===r)mft[1]=e*t[1];else if("v"===r||"V"===r)mft[1]=n*t[1];else for(var i=1,a=t.length;i<a;++i)mft[i]=(i%2==1?e:n)*t[i];return mft}function vft(t,e,n,r,i,a){var o,s,c,u,l,h=null,d=0,f=0,p=0,g=0,m=0,y=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==a&&(a=i),t.beginPath&&t.beginPath();for(var v=0,b=e.length;v<b;++v){switch(o=e[v],1===i&&1===a||(o=yft(o,i,a)),o[0]){case"l":d+=o[1],f+=o[2],t.lineTo(d+n,f+r);break;case"L":d=o[1],f=o[2],t.lineTo(d+n,f+r);break;case"h":d+=o[1],t.lineTo(d+n,f+r);break;case"H":d=o[1],t.lineTo(d+n,f+r);break;case"v":f+=o[1],t.lineTo(d+n,f+r);break;case"V":f=o[1],t.lineTo(d+n,f+r);break;case"m":m=d+=o[1],y=f+=o[2],t.moveTo(d+n,f+r);break;case"M":m=d=o[1],y=f=o[2],t.moveTo(d+n,f+r);break;case"c":s=d+o[5],c=f+o[6],p=d+o[3],g=f+o[4],t.bezierCurveTo(d+o[1]+n,f+o[2]+r,p+n,g+r,s+n,c+r),d=s,f=c;break;case"C":d=o[5],f=o[6],p=o[3],g=o[4],t.bezierCurveTo(o[1]+n,o[2]+r,p+n,g+r,d+n,f+r);break;case"s":s=d+o[3],c=f+o[4],p=2*d-p,g=2*f-g,t.bezierCurveTo(p+n,g+r,d+o[1]+n,f+o[2]+r,s+n,c+r),p=d+o[1],g=f+o[2],d=s,f=c;break;case"S":s=o[3],c=o[4],p=2*d-p,g=2*f-g,t.bezierCurveTo(p+n,g+r,o[1]+n,o[2]+r,s+n,c+r),d=s,f=c,p=o[1],g=o[2];break;case"q":s=d+o[3],c=f+o[4],p=d+o[1],g=f+o[2],t.quadraticCurveTo(p+n,g+r,s+n,c+r),d=s,f=c;break;case"Q":s=o[3],c=o[4],t.quadraticCurveTo(o[1]+n,o[2]+r,s+n,c+r),d=s,f=c,p=o[1],g=o[2];break;case"t":s=d+o[1],c=f+o[2],null===h[0].match(/[QqTt]/)?(p=d,g=f):"t"===h[0]?(p=2*d-u,g=2*f-l):"q"===h[0]&&(p=2*d-p,g=2*f-g),u=p,l=g,t.quadraticCurveTo(p+n,g+r,s+n,c+r),f=c,p=(d=s)+o[1],g=f+o[2];break;case"T":s=o[1],c=o[2],p=2*d-p,g=2*f-g,t.quadraticCurveTo(p+n,g+r,s+n,c+r),d=s,f=c;break;case"a":bft(t,d+n,f+r,[o[1],o[2],o[3],o[4],o[5],o[6]+d+n,o[7]+f+r]),d+=o[6],f+=o[7];break;case"A":bft(t,d+n,f+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),d=o[6],f=o[7];break;case"z":case"Z":d=m,f=y,t.closePath()}h=o}}function bft(t,e,n,r){const i=function(t,e,n,r,i,a,o,s,c){const u=pft.call(arguments);if(dft[u])return dft[u];const l=o*cft,h=Math.sin(l),d=Math.cos(l),f=d*(s-t)*.5+h*(c-e)*.5,p=d*(c-e)*.5-h*(s-t)*.5;let g=f*f/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=d/n,y=h/n,v=-h/r,b=d/r,x=m*s+y*c,w=v*s+b*c,k=m*t+y*e,_=v*t+b*e;let S=1/((k-x)*(k-x)+(_-w)*(_-w))-.25;S<0&&(S=0);let A=Math.sqrt(S);a==i&&(A=-A);const C=.5*(x+k)-A*(_-w),E=.5*(w+_)+A*(k-x),T=Math.atan2(w-E,x-C);let N=Math.atan2(_-E,k-C)-T;N<0&&1===a?N+=lft:N>0&&0===a&&(N-=lft);const D=Math.ceil(Math.abs(N/(uft+.001))),F=[];for(let I=0;I<D;++I){const t=T+I*N/D,e=T+(I+1)*N/D;F[I]=[C,E,t,e,n,r,h,d]}return dft[u]=F}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n);for(let a=0;a<i.length;++a){const e=gft(i[a]);t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5])}}const xft=.5773502691896257,wft={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,lft)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,a=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-a),t.lineTo(i,-a),t.lineTo(0,-n),t.lineTo(-i,-a),t.lineTo(-r,-a),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=hft*n,i=r-n*xft,a=n/4;t.moveTo(0,-r-i),t.lineTo(-a,r-i),t.lineTo(a,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=hft*n,i=r-n*xft;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=hft*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=hft*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=hft*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=hft*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function kft(t){return Got(wft,t)?wft[t]:function(t){if(!Got(_ft,t)){const e=sft(t);_ft[t]={draw:function(t,n){vft(t,e,0,0,Math.sqrt(n)/2)}}}return _ft[t]}(t)}var _ft={};const Sft=.448084975506;function Aft(t){return t.x}function Cft(t){return t.y}function Eft(t){return t.width}function Tft(t){return t.height}function Nft(t){return"function"===typeof t?t:()=>+t}function Dft(t,e,n){return Math.max(e,Math.min(t,n))}function Fft(t,e){return null!=t?t:e}const Ift=t=>t.x||0,Mft=t=>t.y||0,Oft=t=>!(!1===t.defined),Rft=Wd().startAngle((t=>t.startAngle||0)).endAngle((t=>t.endAngle||0)).padAngle((t=>t.padAngle||0)).innerRadius((t=>t.innerRadius||0)).outerRadius((t=>t.outerRadius||0)).cornerRadius((t=>t.cornerRadius||0)),zft=Yd().x(Ift).y1(Mft).y0((t=>(t.y||0)+(t.height||0))).defined(Oft),Bft=Yd().y(Mft).x1(Ift).x0((t=>(t.x||0)+(t.width||0))).defined(Oft),Lft=Hd().x(Ift).y(Mft).defined(Oft),Pft=function(){var t=Aft,e=Cft,n=Eft,r=Tft,i=Nft(0),a=i,o=i,s=i,c=null;function u(u,l,h){var d,f=null!=l?l:+t.call(this,u),p=null!=h?h:+e.call(this,u),g=+n.call(this,u),m=+r.call(this,u),y=Math.min(g,m)/2,v=Dft(+i.call(this,u),0,y),b=Dft(+a.call(this,u),0,y),x=Dft(+o.call(this,u),0,y),w=Dft(+s.call(this,u),0,y);if(c||(c=d=Od()),v<=0&&b<=0&&x<=0&&w<=0)c.rect(f,p,g,m);else{var k=f+g,_=p+m;c.moveTo(f+v,p),c.lineTo(k-b,p),c.bezierCurveTo(k-Sft*b,p,k,p+Sft*b,k,p+b),c.lineTo(k,_-w),c.bezierCurveTo(k,_-Sft*w,k-Sft*w,_,k-w,_),c.lineTo(f+x,_),c.bezierCurveTo(f+Sft*x,_,f,_-Sft*x,f,_-x),c.lineTo(f,p+v),c.bezierCurveTo(f,p+Sft*v,f+Sft*v,p,f+v,p),c.closePath()}if(d)return c=null,d+""||null}return u.x=function(e){return arguments.length?(t=Nft(e),u):t},u.y=function(t){return arguments.length?(e=Nft(t),u):e},u.width=function(t){return arguments.length?(n=Nft(t),u):n},u.height=function(t){return arguments.length?(r=Nft(t),u):r},u.cornerRadius=function(t,e,n,r){return arguments.length?(i=Nft(t),a=null!=e?Nft(e):i,s=null!=n?Nft(n):i,o=null!=r?Nft(r):a,u):i},u.context=function(t){return arguments.length?(c=null==t?null:t,u):c},u}().x(Ift).y(Mft).width((t=>t.width||0)).height((t=>t.height||0)).cornerRadius((t=>Fft(t.cornerRadiusTopLeft,t.cornerRadius)||0),(t=>Fft(t.cornerRadiusTopRight,t.cornerRadius)||0),(t=>Fft(t.cornerRadiusBottomRight,t.cornerRadius)||0),(t=>Fft(t.cornerRadiusBottomLeft,t.cornerRadius)||0)),jft=$d().type((t=>kft(t.shape||"circle"))).size((t=>Fft(t.size,64))),Uft=function(){var t,e,n,r,i,a,o,s,c=null;function u(t,e,n){const r=n/2;if(i){var u=o-e,l=t-a;if(u||l){var h=Math.hypot(u,l),d=(u/=h)*s,f=(l/=h)*s,p=Math.atan2(l,u);c.moveTo(a-d,o-f),c.lineTo(t-u*r,e-l*r),c.arc(t,e,r,p-Math.PI,p),c.lineTo(a+d,o+f),c.arc(a,o,s,p,p+Math.PI)}else c.arc(t,e,r,0,lft);c.closePath()}else i=1;a=t,o=e,s=r}function l(a){var o,s,l,h=a.length,d=!1;for(null==c&&(c=l=Od()),o=0;o<=h;++o)!(o<h&&r(s=a[o],o,a))===d&&(d=!d)&&(i=0),d&&u(+t(s,o,a),+e(s,o,a),+n(s,o,a));if(l)return c=null,l+""||null}return l.x=function(e){return arguments.length?(t=e,l):t},l.y=function(t){return arguments.length?(e=t,l):e},l.size=function(t){return arguments.length?(n=t,l):n},l.defined=function(t){return arguments.length?(r=t,l):r},l.context=function(t){return arguments.length?(c=null==t?null:t,l):c},l}().x(Ift).y(Mft).defined(Oft).size((t=>t.size||1));function Wft(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function Vft(t,e,n,r){return Pft.context(t)(e,n,r)}var qft=1;function Gft(t,e,n){var r=e.clip,i=t._defs,a=e.clip_id||(e.clip_id="clip"+qft++),o=i.clipping[a]||(i.clipping[a]={id:a});return Wot(r)?o.path=r(null):Wft(n)?o.path=Vft(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+a+")"}function Hft(t){this.clear(),t&&this.union(t)}function Yft(t){this.mark=t,this.bounds=this.bounds||new Hft}function Xft(t){Yft.call(this,t),this.items=this.items||[]}function Kft(t){this._pending=0,this._loader=t||Xdt()}function $ft(t){t._pending+=1}function Zft(t){t._pending-=1}function Qft(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){const r=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(r+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}(e,r):0))}return t}Hft.prototype={clone(){return new Hft(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){const r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(t,e,n){var{x1:r,y1:i,x2:a,y2:o}=this,s=Math.cos(t),c=Math.sin(t),u=e-e*s+n*c,l=n-e*c-n*s;return[s*r-c*i+u,c*r+s*i+l,s*r-c*o+u,c*r+s*o+l,s*a-c*i+u,c*a+s*i+l,s*a-c*o+u,c*a+s*o+l]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},Hot(Xft,Yft),Kft.prototype={pending(){return this._pending},sanitizeURL(t){const e=this;return $ft(e),e._loader.sanitize(t,{context:"href"}).then((t=>(Zft(e),t))).catch((()=>(Zft(e),null)))},loadImage(t){const e=this,n=Qd();return $ft(e),e._loader.sanitize(t,{context:"image"}).then((t=>{const r=t.href;if(!r||!n)throw{url:r};const i=new n,a=Got(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=a&&(i.crossOrigin=a),i.onload=()=>Zft(e),i.onerror=()=>Zft(e),i.src=r,i})).catch((t=>(Zft(e),{complete:!1,width:0,height:0,src:t&&t.url||""})))},ready(){const t=this;return new Promise((e=>{!function n(r){t.pending()?setTimeout((()=>{n(!0)}),10):e(r)}(!1)}))}};const Jft=lft-1e-8;let tpt,ept,npt,rpt,ipt,apt,opt,spt;const cpt=(t,e)=>tpt.add(t,e),upt=(t,e)=>cpt(ept=t,npt=e),lpt=t=>cpt(t,tpt.y1),hpt=t=>cpt(tpt.x1,t),dpt=(t,e)=>ipt*t+opt*e,fpt=(t,e)=>apt*t+spt*e,ppt=(t,e)=>cpt(dpt(t,e),fpt(t,e)),gpt=(t,e)=>upt(dpt(t,e),fpt(t,e));function mpt(t,e){return tpt=t,e?(rpt=e*cft,ipt=spt=Math.cos(rpt),apt=Math.sin(rpt),opt=-apt):(ipt=spt=1,rpt=apt=opt=0),ypt}const ypt={beginPath(){},closePath(){},moveTo:gpt,lineTo:gpt,rect(t,e,n,r){rpt?(ppt(t+n,e),ppt(t+n,e+r),ppt(t,e+r),gpt(t,e)):(cpt(t+n,e+r),upt(t,e))},quadraticCurveTo(t,e,n,r){const i=dpt(t,e),a=fpt(t,e),o=dpt(n,r),s=fpt(n,r);vpt(ept,i,o,lpt),vpt(npt,a,s,hpt),upt(o,s)},bezierCurveTo(t,e,n,r,i,a){const o=dpt(t,e),s=fpt(t,e),c=dpt(n,r),u=fpt(n,r),l=dpt(i,a),h=fpt(i,a);bpt(ept,o,c,l,lpt),bpt(npt,s,u,h,hpt),upt(l,h)},arc(t,e,n,r,i,a){if(r+=rpt,i+=rpt,ept=n*Math.cos(i)+t,npt=n*Math.sin(i)+e,Math.abs(i-r)>Jft)cpt(t-n,e-n),cpt(t+n,e+n);else{const o=r=>cpt(n*Math.cos(r)+t,n*Math.sin(r)+e);let s,c;if(o(r),o(i),i!==r)if((r%=lft)<0&&(r+=lft),(i%=lft)<0&&(i+=lft),i<r&&(a=!a,s=r,r=i,i=s),a)for(i-=lft,s=r-r%uft,c=0;c<4&&s>i;++c,s-=uft)o(s);else for(s=r-r%uft+uft,c=0;c<4&&s<i;++c,s+=uft)o(s)}}};function vpt(t,e,n,r){const i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function bpt(t,e,n,r,i){const a=r-t+3*e-3*n,o=t+n-2*e,s=t-e;let c,u=0,l=0;Math.abs(a)>1e-14?(c=o*o+s*a,c>=0&&(c=Math.sqrt(c),u=(-o+c)/a,l=(-o-c)/a)):u=.5*s/o,0<u&&u<1&&i(xpt(u,t,e,n,r)),0<l&&l<1&&i(xpt(l,t,e,n,r))}function xpt(t,e,n,r,i){const a=1-t,o=a*a,s=t*t;return o*a*e+3*o*t*n+3*a*s*r+s*t*i}var wpt=(wpt=Zd(1,1))?wpt.getContext("2d"):null;const kpt=new Hft;function _pt(t){return function(e,n){if(!wpt)return!0;t(wpt,e),kpt.clear().union(e.bounds).intersect(n).round();const{x1:r,y1:i,x2:a,y2:o}=kpt;for(let t=i;t<=o;++t)for(let e=r;e<=a;++e)if(wpt.isPointInPath(e,t))return!0;return!1}}function Spt(t,e){return e.contains(t.x||0,t.y||0)}function Apt(t,e){const n=t.x||0,r=t.y||0,i=t.width||0,a=t.height||0;return e.intersects(kpt.set(n,r,n+i,r+a))}function Cpt(t,e,n,r,i){const{x1:a,y1:o,x2:s,y2:c}=t,u=r-e,l=i-n;let h,d,f,p,g=0,m=1;for(p=0;p<4;++p){if(0===p&&(h=-u,d=-(a-e)),1===p&&(h=u,d=s-e),2===p&&(h=-l,d=-(o-n)),3===p&&(h=l,d=c-n),Math.abs(h)<1e-10&&d<0)return!1;if(f=d/h,h<0){if(f>m)return!1;f>g&&(g=f)}else if(h>0){if(f<g)return!1;f<m&&(m=f)}}return!0}function Ept(t,e){t.globalCompositeOperation=e.blend||"source-over"}function Tpt(t,e){return null==t?e:t}function Npt(t,e){const n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}function Dpt(t,e,n){return Zdt(n)?function(t,e,n){const r=n.width(),i=n.height();let a;if("radial"===e.gradient)a=t.createRadialGradient(n.x1+Tpt(e.x1,.5)*r,n.y1+Tpt(e.y1,.5)*i,Math.max(r,i)*Tpt(e.r1,0),n.x1+Tpt(e.x2,.5)*r,n.y1+Tpt(e.y2,.5)*i,Math.max(r,i)*Tpt(e.r2,.5));else{const o=Tpt(e.x1,0),s=Tpt(e.y1,0),c=Tpt(e.x2,1),u=Tpt(e.y2,0);if(o!==c&&s!==u&&r!==i){const n=Zd(Math.ceil(r),Math.ceil(i)),a=n.getContext("2d");return a.scale(r,i),a.fillStyle=Npt(a.createLinearGradient(o,s,c,u),e.stops),a.fillRect(0,0,r,i),t.createPattern(n,"no-repeat")}a=t.createLinearGradient(n.x1+o*r,n.y1+s*i,n.x1+c*r,n.y1+u*i)}return Npt(a,e.stops)}(t,n,e.bounds):n}function Fpt(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=Dpt(t,e,e.fill),!0)}var Ipt=[];function Mpt(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&((n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=Dpt(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||Ipt),t.lineDashOffset=e.strokeDashOffset||0),!0))}function Opt(t,e){return t.zindex-e.zindex||t.index-e.index}function Rpt(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,a=[];for(n=0,r=i.length;n<r;++n)(e=i[n]).index=n,e.zindex&&a.push(e);return t.zdirty=!1,t.zitems=a.sort(Opt)}function zpt(t,e){var n,r,i=t.items;if(!i||!i.length)return;const a=Rpt(t);if(a&&a.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=a}for(n=0,r=i.length;n<r;++n)e(i[n])}function Bpt(t,e){var n,r,i=t.items;if(!i||!i.length)return null;const a=Rpt(t);for(a&&a.length&&(i=a),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===a)for(r=(i=t.items).length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function Lpt(t){return function(e,n,r){zpt(n,(n=>{r&&!r.intersects(n.bounds)||jpt(t,e,n,n)}))}}function Ppt(t){return function(e,n,r){!n.items.length||r&&!r.intersects(n.bounds)||jpt(t,e,n.items[0],n.items)}}function jpt(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||(Ept(e,n),n.fill&&Fpt(e,n,i)&&e.fill(),n.stroke&&Mpt(e,n,i)&&e.stroke()))}function Upt(t){return t=t||Not,function(e,n,r,i,a,o){return r*=e.pixelRatio,i*=e.pixelRatio,Bpt(n,(n=>{const s=n.bounds;if((!s||s.contains(a,o))&&s)return t(e,n,r,i,a,o)?n:void 0}))}}function Wpt(t,e){return function(n,r,i,a){var o,s,c=Array.isArray(r)?r[0]:r,u=null==e?c.fill:e,l=c.stroke&&n.isPointInStroke;return l&&(o=c.strokeWidth,s=c.strokeCap,n.lineWidth=null!=o?o:1,n.lineCap=null!=s?s:"butt"),!t(n,r)&&(u&&n.isPointInPath(i,a)||l&&n.isPointInStroke(i,a))}}function Vpt(t){return Upt(Wpt(t))}function qpt(t,e){return"translate("+t+","+e+")"}function Gpt(t){return"rotate("+t+")"}function Hpt(t){return qpt(t.x||0,t.y||0)}function Ypt(t,e,n){function r(t,n){var r=n.x||0,i=n.y||0,a=n.angle||0;t.translate(r,i),a&&t.rotate(a*=cft),t.beginPath(),e(t,n),a&&t.rotate(-a),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",function(t){return qpt(t.x||0,t.y||0)+(t.angle?" "+Gpt(t.angle):"")}(n)),t("d",e(null,n))},bound:function(t,n){return e(mpt(t,n.angle),n),Qft(t,n).translate(n.x||0,n.y||0)},draw:Lpt(r),pick:Vpt(r),isect:n||_pt(r)}}var Xpt=Ypt("arc",(function(t,e){return Rft.context(t)(e)}));function Kpt(t,e,n){function r(t,n){t.beginPath(),e(t,n)}const i=Wpt(r);return{type:t,tag:"path",nested:!0,attr:function(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))},bound:function(t,n){var r=n.items;return 0===r.length?t:(e(mpt(t),r),Qft(t,r[0]))},draw:Ppt(r),pick:function(t,e,n,r,a,o){var s=e.items,c=e.bounds;return!s||!s.length||c&&!c.contains(a,o)?null:(n*=t.pixelRatio,r*=t.pixelRatio,i(t,s,n,r)?s[0]:null)},isect:Spt,tip:n}}var $pt=Kpt("area",(function(t,e){const n=e[0],r=n.interpolate||"linear";return("horizontal"===n.orient?Bft:zft).curve(eft(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i="horizontal"===t[0].orient?e[1]:e[0],a="horizontal"===t[0].orient?"y":"x",o=t.length,s=1/0;--o>=0;)!1!==t[o].defined&&(r=Math.abs(t[o][a]-i))<s&&(s=r,n=t[o]);return n}));function Zpt(t,e){t.beginPath(),Wft(e)?Vft(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function Qpt(t){const e=Tpt(t.strokeWidth,1);return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function Jpt(t,e){const n=Qpt(e);t("d",Vft(null,e,n,n))}function tgt(t,e,n,r){const i=Qpt(e);t.beginPath(),Vft(t,e,(n||0)+i,(r||0)+i)}const egt=Wpt(tgt),ngt=Wpt(tgt,!1),rgt=Wpt(tgt,!0);var igt={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",Hpt(e))},bound:function(t,e){if(!e.clip&&e.items){const n=e.items,r=n.length;for(let e=0;e<r;++e)t.union(n[e].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),Qft(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n,r){zpt(e,(e=>{const i=e.x||0,a=e.y||0,o=e.strokeForeground,s=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&s&&(tgt(t,e,i,a),Ept(t,e),e.fill&&Fpt(t,e,s)&&t.fill(),e.stroke&&!o&&Mpt(t,e,s)&&t.stroke()),t.save(),t.translate(i,a),e.clip&&Zpt(t,e),n&&n.translate(-i,-a),zpt(e,(e=>{("group"===e.marktype||null==r||r.includes(e.marktype))&&this.draw(t,e,n,r)})),n&&n.translate(i,a),t.restore(),o&&e.stroke&&s&&(tgt(t,e,i,a),Ept(t,e),Mpt(t,e,s)&&t.stroke())}))},pick:function(t,e,n,r,i,a){if(e.bounds&&!e.bounds.contains(i,a)||!e.items)return null;const o=n*t.pixelRatio,s=r*t.pixelRatio;return Bpt(e,(c=>{let u,l,h;const d=c.bounds;if(d&&!d.contains(i,a))return;l=c.x||0,h=c.y||0;const f=l+(c.width||0),p=h+(c.height||0),g=c.clip;if(g&&(i<l||i>f||a<h||a>p))return;if(t.save(),t.translate(l,h),l=i-l,h=a-h,g&&Wft(c)&&!rgt(t,c,o,s))return t.restore(),null;const m=c.strokeForeground,y=!1!==e.interactive;return y&&m&&c.stroke&&ngt(t,c,o,s)?(t.restore(),c):(u=Bpt(c,(t=>function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}(t,l,h)?this.pick(t,n,r,l,h):null)),!u&&y&&(c.fill||!m&&c.stroke)&&egt(t,c,o,s)&&(u=c),t.restore(),u||null)}))},isect:Apt,content:function(t,e,n){t("clip-path",e.clip?Gft(n,e,e):null)},background:function(t,e){t("class","background"),t("aria-hidden",!0),Jpt(t,e)},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?Jpt(t,e):t("d","")}},agt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function ogt(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then((e=>{t.image=e,t.image.url=t.url}))),n}function sgt(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function cgt(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function ugt(t,e){return"center"===t?e/2:"right"===t?e:0}function lgt(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var hgt={type:"image",tag:"image",nested:!1,attr:function(t,e,n){const r=ogt(e,n),i=sgt(e,r),a=cgt(e,r),o=(e.x||0)-ugt(e.align,i),s=(e.y||0)-lgt(e.baseline,a);t("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",agt["xmlns:xlink"],"xlink:href"),t("transform",qpt(o,s)),t("width",i),t("height",a),t("preserveAspectRatio",!1===e.aspect?"none":"xMidYMid")},bound:function(t,e){const n=e.image,r=sgt(e,n),i=cgt(e,n),a=(e.x||0)-ugt(e.align,r),o=(e.y||0)-lgt(e.baseline,i);return t.set(a,o,a+r,o+i)},draw:function(t,e,n){zpt(e,(e=>{if(n&&!n.intersects(e.bounds))return;const r=ogt(e,this);let i=sgt(e,r),a=cgt(e,r);if(0===i||0===a)return;let o,s,c,u,l=(e.x||0)-ugt(e.align,i),h=(e.y||0)-lgt(e.baseline,a);!1!==e.aspect&&(s=r.width/r.height,c=e.width/e.height,s===s&&c===c&&s!==c&&(c<s?(u=i/s,h+=(a-u)/2,a=u):(u=a*s,l+=(i-u)/2,i=u))),(r.complete||r.toDataURL)&&(Ept(t,e),t.globalAlpha=null!=(o=e.opacity)?o:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(r,l,h,i,a))}))},pick:Upt(),isect:Not,get:ogt,xOffset:ugt,yOffset:lgt},dgt=Kpt("line",(function(t,e){const n=e[0],r=n.interpolate||"linear";return Lft.curve(eft(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i=Math.pow(t[0].strokeWidth||1,2),a=t.length;--a>=0;)if(!1!==t[a].defined&&(n=t[a].x-e[0])*n+(r=t[a].y-e[1])*r<i)return t[a];return null}));function fgt(t,e){var n=e.path;if(null==n)return!0;var r=e.x||0,i=e.y||0,a=e.scaleX||1,o=e.scaleY||1,s=(e.angle||0)*cft,c=e.pathCache;c&&c.path===n||((e.pathCache=c=sft(n)).path=n),s&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(s),vft(t,c,0,0,a,o),t.rotate(-s),t.translate(-r,-i)):vft(t,c,r,i,a,o)}var pgt={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,r=e.scaleY||1;1===n&&1===r||t("vector-effect","non-scaling-stroke"),t("transform",function(t){return qpt(t.x||0,t.y||0)+(t.angle?" "+Gpt(t.angle):"")+(t.scaleX||t.scaleY?" "+function(t,e){return"scale("+t+","+e+")"}(t.scaleX||1,t.scaleY||1):"")}(e)),t("d",e.path)},bound:function(t,e){return fgt(mpt(t,e.angle),e)?t.set(0,0,0,0):Qft(t,e,!0)},draw:Lpt(fgt),pick:Vpt(fgt),isect:_pt(fgt)};function ggt(t,e){t.beginPath(),Vft(t,e)}var mgt={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",Vft(null,e))},bound:function(t,e){var n,r;return Qft(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:Lpt(ggt),pick:Vpt(ggt),isect:Apt};function ygt(t,e,n){var r,i,a,o;return!(!e.stroke||!Mpt(t,e,n))&&(r=e.x||0,i=e.y||0,a=null!=e.x2?e.x2:r,o=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(a,o),!0)}var vgt={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",Hpt(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return Qft(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)},draw:function(t,e,n){zpt(e,(e=>{if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&ygt(t,e,r)&&(Ept(t,e),t.stroke())}}))},pick:Upt((function(t,e,n,r){return!!t.isPointInStroke&&(ygt(t,e,1)&&t.isPointInStroke(n,r))})),isect:function(t,e){const n=t.x||0,r=t.y||0;return Cpt(e,n,r,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r)}},bgt=Ypt("shape",(function(t,e){return(e.mark.shape||e.shape).context(t)(e)})),xgt=Ypt("symbol",(function(t,e){return jft.context(t)(e)}),Spt);const wgt=function(t){let e,n,r;t=+t||1e4;const i=()=>{e={},n={},r=0},a=(i,a)=>(++r>t&&(n=e,e={},r=1),e[i]=a);return i(),{clear:i,has:t=>Got(e,t)||Got(n,t),get:t=>Got(e,t)?e[t]:Got(n,t)?a(t,n[t]):void 0,set:(t,n)=>Got(e,t)?e[t]=n:a(t,n)}}();var kgt={height:Tgt,measureWidth:Cgt,estimateWidth:Sgt,width:Sgt,canvas:_gt};function _gt(t){kgt.width=t&&wpt?Cgt:Sgt}function Sgt(t,e){return Agt(Fgt(t,e),Tgt(t))}function Agt(t,e){return~~(.8*t.length*e)}function Cgt(t,e){return Tgt(t)<=0||!(e=Fgt(t,e))?0:Egt(e,Mgt(t))}function Egt(t,e){const n="(".concat(e,") ").concat(t);let r=wgt.get(n);return void 0===r&&(wpt.font=e,r=wpt.measureText(t).width,wgt.set(n,r)),r}function Tgt(t){return null!=t.fontSize?+t.fontSize||0:11}function Ngt(t){return null!=t.lineHeight?t.lineHeight:Tgt(t)+2}function Dgt(t){return e=t.lineBreak&&t.text&&!Dot(t.text)?t.text.split(t.lineBreak):t.text,Dot(e)?e.length>1?e:e[0]:e;var e}function Fgt(t,e){const n=null==e?"":(e+"").trim();return t.limit>0&&n.length?function(t,e){var n=+t.limit,r=function(t){if(kgt.width===Cgt){const e=Mgt(t);return t=>Egt(t,e)}if(kgt.width===Sgt){const e=Tgt(t);return t=>Agt(t,e)}return e=>kgt.width(t,e)}(t);if(r(e)<n)return e;var i,a=t.ellipsis||"\u2026",o="rtl"===t.dir,s=0,c=e.length;if(n-=r(a),o){for(;s<c;)i=s+c>>>1,r(e.slice(i))>n?s=i+1:c=i;return a+e.slice(s)}for(;s<c;)i=1+(s+c>>>1),r(e.slice(0,i))<n?s=i:c=i-1;return e.slice(0,s)+a}(t,n):n}function Igt(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Mgt(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+Tgt(t)+"px "+Igt(t,e)}function Ogt(t){var e=t.baseline,n=Tgt(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*Ngt(t):"line-bottom"===e?.29*n-.5*Ngt(t):0)}_gt(!0);const Rgt={left:"start",center:"middle",right:"end"},zgt=new Hft;function Bgt(t){var e,n=t.x||0,r=t.y||0,i=t.radius||0;return i&&(e=(t.theta||0)-uft,n+=i*Math.cos(e),r+=i*Math.sin(e)),zgt.x1=n,zgt.y1=r,zgt}function Lgt(t,e,n){var r,i=kgt.height(e),a=e.align,o=Bgt(e),s=o.x1,c=o.y1,u=e.dx||0,l=(e.dy||0)+Ogt(e)-Math.round(.8*i),h=Dgt(e);if(Dot(h)?(i+=Ngt(e)*(h.length-1),r=h.reduce(((t,n)=>Math.max(t,kgt.width(e,n))),0)):r=kgt.width(e,h),"center"===a?u-=r/2:"right"===a&&(u-=r),t.set(u+=s,l+=c,u+r,l+i),e.angle&&!n)t.rotate(e.angle*cft,s,c);else if(2===n)return t.rotatedPoints(e.angle*cft,s,c);return t}var Pgt={type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,i=(e.dy||0)+Ogt(e),a=Bgt(e),o=a.x1,s=a.y1,c=e.angle||0;t("text-anchor",Rgt[e.align]||"start"),c?(n=qpt(o,s)+" "+Gpt(c),(r||i)&&(n+=" "+qpt(r,i))):n=qpt(o+r,s+i),t("transform",n)},bound:Lgt,draw:function(t,e,n){zpt(e,(e=>{var r,i,a,o,s,c,u,l=null==e.opacity?1:e.opacity;if(!(n&&!n.intersects(e.bounds)||0===l||e.fontSize<=0||null==e.text||0===e.text.length)){if(t.font=Mgt(e),t.textAlign=e.align||"left",i=(r=Bgt(e)).x1,a=r.y1,e.angle&&(t.save(),t.translate(i,a),t.rotate(e.angle*cft),i=a=0),i+=e.dx||0,a+=(e.dy||0)+Ogt(e),c=Dgt(e),Ept(t,e),Dot(c))for(s=Ngt(e),o=0;o<c.length;++o)u=Fgt(e,c[o]),e.fill&&Fpt(t,e,l)&&t.fillText(u,i,a),e.stroke&&Mpt(t,e,l)&&t.strokeText(u,i,a),a+=s;else u=Fgt(e,c),e.fill&&Fpt(t,e,l)&&t.fillText(u,i,a),e.stroke&&Mpt(t,e,l)&&t.strokeText(u,i,a);e.angle&&t.restore()}}))},pick:Upt((function(t,e,n,r,i,a){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var o=Bgt(e),s=o.x1,c=o.y1,u=Lgt(zgt,e,1),l=-e.angle*cft,h=Math.cos(l),d=Math.sin(l),f=h*i-d*a+(s-h*s+d*c),p=d*i+h*a+(c-d*s-h*c);return u.contains(f,p)})),isect:function(t,e){const n=Lgt(zgt,t,2);return Cpt(e,n[0],n[1],n[2],n[3])||Cpt(e,n[0],n[1],n[4],n[5])||Cpt(e,n[4],n[5],n[6],n[7])||Cpt(e,n[2],n[3],n[6],n[7])}},jgt=Kpt("trail",(function(t,e){return Uft.context(t)(e)}),(function(t,e){for(var n,r,i=t.length;--i>=0;)if(!1!==t[i].defined&&(n=t[i].x-e[0])*n+(r=t[i].y-e[1])*r<(n=t[i].size||1)*n)return t[i];return null})),Ugt={arc:Xpt,area:$pt,group:igt,image:hgt,line:dgt,path:pgt,rect:mgt,rule:vgt,shape:bgt,symbol:xgt,text:Pgt,trail:jgt};function Wgt(t,e,n){return!t&&"undefined"!==typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function Vgt(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function qgt(t,e,n,r){var i,a=t.childNodes[e];return a&&a.tagName.toLowerCase()===n.toLowerCase()||(i=a||null,a=Wgt(t.ownerDocument,n,r),t.insertBefore(a,i)),a}function Ggt(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function Hgt(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function Ygt(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function Xgt(t,e){this._active=null,this._handlers={},this._loader=t||Xdt(),this._tooltip=e||Kgt}function Kgt(t,e,n,r){t.element().setAttribute("title",r||"")}function $gt(t){this._el=null,this._bgcolor=null,this._loader=new Kft(t)}Xgt.prototype={initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},scene(t){return arguments.length?(this._scene=t,this):this._scene},on(){},off(){},_handlerIndex(t,e,n){for(let r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},handlers(t){const e=this._handlers,n=[];if(t)n.push(...e[this.eventName(t)]);else for(const r in e)n.push(...e[r]);return n},eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then((e=>{const n=new MouseEvent(t.type,t),r=Wgt(null,"a");for(const t in e)r.setAttribute(t,e[t]);r.dispatchEvent(n)})).catch((()=>{}))},handleTooltip(t,e,n){if(e&&null!=e.tooltip){e=function(t,e,n,r){var i,a,o=t&&t.mark;if(o&&(i=Ugt[o.marktype]).tip){for((a=Ygt(e,n))[0]-=r[0],a[1]-=r[1];t=t.mark.group;)a[0]-=t.x||0,a[1]-=t.y||0;t=i.tip(o.items,a)}return t}(e,t,this.canvas(),this._origin);const r=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,r)}},getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,a=i.width(),o=i.height();let s=i.x1+r[0]+n.left,c=i.y1+r[1]+n.top;for(;t.mark&&(t=t.mark.group);)s+=t.x||0,c+=t.y||0;return{x:s,y:c,width:a,height:o,left:s,top:c,right:s+a,bottom:c+o}}},$gt.prototype={initialize(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)},resize(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(t,e){const n=this;return n._call=function(){n._render(t,e)},n._call(),n._call=null,n},_render(){},renderAsync(t,e){const n=this.render(t,e);return this._ready?this._ready.then((()=>n)):Promise.resolve(n)},_load(t,e){var n=this,r=n._loader[t](e);if(!n._ready){const t=n._call;n._ready=n._loader.ready().then((e=>{e&&t(),n._ready=null}))}return r},sanitizeURL(t){return this._load("sanitizeURL",t)},loadImage(t){return this._load("loadImage",t)}};const Zgt="dragenter",Qgt="dragleave",Jgt="dragover",tmt="pointerdown",emt="pointermove",nmt="pointerout",rmt="pointerover",imt="mousedown",amt="mousemove",omt="mouseout",smt="mouseover",cmt="click",umt="mousewheel",lmt="touchstart",hmt="touchmove",dmt="touchend",fmt=emt,pmt=nmt,gmt=cmt;function mmt(t,e){Xgt.call(this,t,e),this._down=null,this._touch=null,this._first=!0,this._events={}}function ymt(t,e){(t=>t===lmt||t===hmt||t===dmt?[lmt,hmt,dmt]:[t])(e).forEach((e=>function(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n)))}(t,e)))}function vmt(t,e,n){e.forEach((e=>t.fire(e,n)))}function bmt(t,e,n){return function(r){const i=this._active,a=this.pickEvent(r);a===i||(i&&i.exit||vmt(this,n,r),this._active=a,vmt(this,e,r)),vmt(this,t,r)}}function xmt(t){return function(e){vmt(this,t,e),this._active=null}}function wmt(t,e,n,r,i,a){const o="undefined"!==typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,s=t.getContext("2d"),c=o?"undefined"!==typeof window&&window.devicePixelRatio||1:i;t.width=e*c,t.height=n*c;for(const u in a)s[u]=a[u];return o&&1!==c&&(t.style.width=e+"px",t.style.height=n+"px"),s.pixelRatio=c,s.setTransform(c,0,0,c,c*r[0],c*r[1]),t}function kmt(t){$gt.call(this,t),this._options={},this._redraw=!1,this._dirty=new Hft,this._tempb=new Hft}Hot(mmt,Xgt,{initialize(t,e,n){return this._canvas=t&&Vgt(t,"canvas"),[cmt,imt,tmt,emt,nmt,Qgt].forEach((t=>ymt(this,t))),Xgt.prototype.initialize.call(this,t,e,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",Zgt,Qgt,Jgt,tmt,"pointerup",emt,nmt,rmt,imt,"mouseup",amt,omt,smt,cmt,"dblclick","wheel",umt,lmt,hmt,dmt],DOMMouseScroll(t){this.fire(umt,t)},pointermove:bmt([emt,amt],[rmt,smt],[nmt,omt]),dragover:bmt([Jgt],[Zgt],[Qgt]),pointerout:xmt([nmt,omt]),dragleave:xmt([Qgt]),pointerdown(t){this._down=this._active,this.fire(tmt,t)},mousedown(t){this._down=this._active,this.fire(imt,t)},click(t){this._down===this._active&&(this.fire(cmt,t),this._down=null)},touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(lmt,t,!0)},touchmove(t){this.fire(hmt,t,!0)},touchend(t){this.fire(dmt,t,!0),this._touch=null},fire(t,e,n){const r=n?this._touch:this._active,i=this._handlers[t];if(e.vegaType=t,t===gmt&&r&&r.href?this.handleHref(e,r,r.href):t!==fmt&&t!==pmt||this.handleTooltip(e,r,t!==pmt),i)for(let a=0,o=i.length;a<o;++a)i[a].handler.call(this._obj,e,r)},on(t,e){const n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(ymt(this,t),(r[n]||(r[n]=[])).push({type:t,handler:e})),this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this},pickEvent(t){const e=Ygt(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pick(t,e,n,r,i){const a=this.context();return Ugt[t.marktype].pick.call(this,a,t,e,n,r,i)}});const _mt=$gt.prototype;function Smt(t,e){Xgt.call(this,t,e);const n=this;n._hrefHandler=Amt(n,((t,e)=>{e&&e.href&&n.handleHref(t,e,e.href)})),n._tooltipHandler=Amt(n,((t,e)=>{n.handleTooltip(t,e,t.type!==pmt)}))}Hot(kmt,$gt,{initialize(t,e,n,r,i,a){return this._options=a||{},this._canvas=this._options.externalContext?null:Zd(1,1,this._options.type),t&&this._canvas&&(Ggt(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),_mt.initialize.call(this,t,e,n,r,i)},resize(t,e,n,r){if(_mt.resize.call(this,t,e,n,r),this._canvas)wmt(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const t=this._options.externalContext;t||Aot("CanvasRenderer is missing a valid canvas or context"),t.scale(this._scale,this._scale),t.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)},_render(t,e){const n=this.context(),r=this._origin,i=this._width,a=this._height,o=this._dirty,s=((t,e,n)=>(new Hft).set(0,0,e,n).translate(-t[0],-t[1]))(r,i,a);n.save();const c=this._redraw||o.empty()?(this._redraw=!1,s.expand(1)):function(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}(n,s.intersect(o),r);return this.clear(-r[0],-r[1],i,a),this.draw(n,t,c,e),n.restore(),o.clear(),this},draw(t,e,n,r){if("group"!==e.marktype&&null!=r&&!r.includes(e.marktype))return;const i=Ugt[e.marktype];e.clip&&function(t,e){var n=e.clip;t.save(),Wot(n)?(t.beginPath(),n(t),t.clip()):Zpt(t,e.group)}(t,e),i.draw.call(this,t,e,n,r),e.clip&&t.restore()},clear(t,e,n,r){const i=this._options,a=this.context();"pdf"===i.type||i.externalContext||a.clearRect(t,e,n,r),null!=this._bgcolor&&(a.fillStyle=this._bgcolor,a.fillRect(t,e,n,r))}});const Amt=(t,e)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,e.call(t._obj,n,r)};Hot(Smt,Xgt,{initialize(t,e,n){let r=this._svg;return r&&(r.removeEventListener(gmt,this._hrefHandler),r.removeEventListener(fmt,this._tooltipHandler),r.removeEventListener(pmt,this._tooltipHandler)),this._svg=r=t&&Vgt(t,"svg"),r&&(r.addEventListener(gmt,this._hrefHandler),r.addEventListener(fmt,this._tooltipHandler),r.addEventListener(pmt,this._tooltipHandler)),Xgt.prototype.initialize.call(this,t,e,n)},canvas(){return this._svg},on(t,e){const n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){const i={type:t,handler:e,listener:Amt(this,e)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const Cmt="aria-hidden",Emt="aria-label",Tmt="role",Nmt="aria-roledescription",Dmt="graphics-object",Fmt="graphics-symbol",Imt=(t,e,n)=>({[Tmt]:t,[Nmt]:e,[Emt]:n||void 0}),Mmt=nst(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),Omt={axis:{desc:"axis",caption:function(t){const e=t.datum,n=t.orient,r=e.title?Pmt(t):null,i=t.context,a=i.scales[e.scale].value,o=i.dataflow.locale(),s=a.type,c="left"===n||"right"===n?"Y":"X";return"".concat(c,"-axis")+(r?" titled '".concat(r,"'"):"")+" for a ".concat(Hht(s)?"discrete":s," scale")+" with ".concat(bdt(o,a,t))}},legend:{desc:"legend",caption:function(t){const e=t.datum,n=e.title?Pmt(t):null,r="".concat(e.type||""," legend").trim(),i=e.scales,a=Object.keys(i),o=t.context,s=o.scales[i[a[0]]].value,c=o.dataflow.locale();return function(t){return t.length?t[0].toUpperCase()+t.slice(1):t}(r)+(n?" titled '".concat(n,"'"):"")+" for ".concat(function(t){return t=t.map((t=>t+("fill"===t||"stroke"===t?" color":""))),t.length<2?t[0]:t.slice(0,-1).join(", ")+" and "+Iot(t)}(a))+" with ".concat(bdt(c,s,t))}},"title-text":{desc:"title",caption:t=>"Title text '".concat(Lmt(t),"'")},"title-subtitle":{desc:"subtitle",caption:t=>"Subtitle text '".concat(Lmt(t),"'")}},Rmt={ariaRole:Tmt,ariaRoleDescription:Nmt,description:Emt};function zmt(t,e){const n=!1===e.aria;if(t(Cmt,n||void 0),n||null==e.description)for(const r in Rmt)t(Rmt[r],void 0);else{const n=e.mark.marktype;t(Emt,e.description),t(Tmt,e.ariaRole||("group"===n?Dmt:Fmt)),t(Nmt,e.ariaRoleDescription||"".concat(n," mark"))}}function Bmt(t){return!1===t.aria?{[Cmt]:!0}:Mmt[t.role]?null:Omt[t.role]?function(t,e){try{const n=t.items[0],r=e.caption||(()=>"");return Imt(e.role||Fmt,e.desc,n.description||r(n))}catch(n){return null}}(t,Omt[t.role]):function(t){const e=t.marktype,n="group"===e||"text"===e||t.items.some((t=>null!=t.description&&!1!==t.aria));return Imt(n?Dmt:Fmt,"".concat(e," mark container"),t.description)}(t)}function Lmt(t){return Uot(t.text).join(" ")}function Pmt(t){try{return Uot(Iot(t.items).items[0].text).join(" ")}catch(e){return null}}const jmt=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function Umt(){let t="",e="",n="";const r=[],i=()=>e=n="",a=(t,n)=>(null!=n&&(e+=" ".concat(t,'="').concat(jmt(n).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"),'"')),o),o={open(s){(a=>{e&&(t+="".concat(e,">").concat(n),i()),r.push(a)})(s),e="<"+s;for(var c=arguments.length,u=new Array(c>1?c-1:0),l=1;l<c;l++)u[l-1]=arguments[l];for(const t of u)for(const e in t)a(e,t[e]);return o},close(){const a=r.pop();return t+=e?e+(n?">".concat(n,"</").concat(a,">"):"/>"):"</".concat(a,">"),i(),o},attr:a,text:t=>(n+=jmt(t),o),toString:()=>t};return o}const Wmt=t=>Vmt(Umt(),t)+"";function Vmt(t,e){if(t.open(e.tagName),e.hasAttributes()){const n=e.attributes,r=n.length;for(let e=0;e<r;++e)t.attr(n[e].name,n[e].value)}if(e.hasChildNodes()){const n=e.childNodes;for(const e of n)3===e.nodeType?t.text(e.nodeValue):Vmt(t,e)}return t.close()}const qmt={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},Gmt={blend:"mix-blend-mode"},Hmt={fill:"none","stroke-miterlimit":10},Ymt="http://www.w3.org/2000/xmlns/",Xmt=agt.xmlns;function Kmt(t){$gt.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const $mt=$gt.prototype;function Zmt(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function Qmt(t,e,n){let r,i,a;if("radial"===e.gradient){let r=qgt(t,n++,"pattern",Xmt);oyt(r,{id:$dt+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=qgt(r,0,"rect",Xmt),oyt(r,{width:1,height:1,fill:"url(".concat(cyt(),"#").concat(e.id,")")}),oyt(t=qgt(t,n++,"radialGradient",Xmt),{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else oyt(t=qgt(t,n++,"linearGradient",Xmt),{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(r=0,i=e.stops.length;r<i;++r)a=qgt(t,r,"stop",Xmt),a.setAttribute("offset",e.stops[r].offset),a.setAttribute("stop-color",e.stops[r].color);return Ggt(t,r),n}function Jmt(t,e,n){let r;return(t=qgt(t,n,"clipPath",Xmt)).setAttribute("id",e.id),e.path?(r=qgt(t,0,"path",Xmt),r.setAttribute("d",e.path)):(r=qgt(t,0,"rect",Xmt),oyt(r,{x:0,y:0,width:e.width,height:e.height})),Ggt(t,1),n+1}function tyt(t,e,n,r,i){let a,o=t._svg;if(!o&&(a=e.ownerDocument,o=Wgt(a,r,Xmt),t._svg=o,t.mark&&(o.__data__=t,o.__values__={fill:"default"},"g"===r))){const e=Wgt(a,"path",Xmt);o.appendChild(e),e.__data__=t;const n=Wgt(a,"g",Xmt);o.appendChild(n),n.__data__=t;const r=Wgt(a,"path",Xmt);o.appendChild(r),r.__data__=t,r.__values__={fill:"default"}}return(o.ownerSVGElement!==i||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}(o,n))&&e.insertBefore(o,n?n.nextSibling:e.firstChild),o}Hot(Kmt,$gt,{initialize(t,e,n,r,i){return this._defs={},this._clearDefs(),t&&(this._svg=qgt(t,0,"svg",Xmt),this._svg.setAttributeNS(Ymt,"xmlns",Xmt),this._svg.setAttributeNS(Ymt,"xmlns:xlink",agt["xmlns:xlink"]),this._svg.setAttribute("version",agt.version),this._svg.setAttribute("class","marks"),Ggt(t,1),this._root=qgt(this._svg,0,"g",Xmt),oyt(this._root,Hmt),Ggt(this._svg,1)),this.background(this._bgcolor),$mt.initialize.call(this,t,e,n,r,i)},background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),$mt.background.apply(this,arguments)},resize(t,e,n,r){return $mt.resize.call(this,t,e,n,r),this._svg&&(oyt(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas(){return this._svg},svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=qgt(t,0,"rect",Xmt),oyt(n,{width:this._width,height:this._height,fill:e}));const r=Wmt(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),r},_render(t,e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t,void 0,e),Ggt(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const e=++this._dirtyID;let n,r,i,a,o,s,c;for(o=0,s=t.length;o<s;++o)n=t[o],r=n.mark,r.marktype!==i&&(i=r.marktype,a=Ugt[i]),r.zdirty&&r.dirty!==e&&(this._dirtyAll=!1,Zmt(n,e),r.items.forEach((t=>{t.dirty=e}))),r.zdirty||(n.exit?(a.nested&&r.items.length?(c=r.items[0],c._svg&&this._update(a,c._svg,c)):n._svg&&(c=n._svg.parentNode,c&&c.removeChild(n._svg)),n._svg=null):(n=a.nested?r.items[0]:n,n._update!==e&&(n._svg&&n._svg.ownerSVGElement?this._update(a,n._svg,n):(this._dirtyAll=!1,Zmt(n,e)),n._update=e)));return!this._dirtyAll},mark(t,e,n,r){if(!this.isDirty(e))return e._svg;const i=this._svg,a=e.marktype,o=Ugt[a],s=!1===e.interactive?"none":null,c="g"===o.tag,u=tyt(e,t,n,"g",i);if("group"!==a&&null!=r&&!r.includes(a))return Ggt(u,0),e._svg;u.setAttribute("class",Hgt(e));const l=Bmt(e);for(const p in l)syt(u,p,l[p]);c||syt(u,"pointer-events",s),syt(u,"clip-path",e.clip?Gft(this,e,e.group):null);let h=null,d=0;const f=t=>{const e=this.isDirty(t),n=tyt(t,u,h,o.tag,i);e&&(this._update(o,n,t),c&&function(t,e,n,r){e=e.lastChild.previousSibling;let i,a=0;zpt(n,(n=>{i=t.mark(e,n,i,r),++a})),Ggt(e,1+a)}(this,n,t,r)),h=n,++d};return o.nested?e.items.length&&f(e.items[0]):zpt(e,f),Ggt(u,d),u},_update(t,e,n){eyt=e,nyt=e.__values__,zmt(iyt,n),t.attr(iyt,n,this);const r=ryt[t.type];r&&r.call(this,t,e,n),eyt&&this.style(eyt,n)},style(t,e){if(null!=e){for(const n in qmt){let r="font"===n?Igt(e):e[n];if(r===nyt[n])continue;const i=qmt[n];null==r?t.removeAttribute(i):(Zdt(r)&&(r=Qdt(r,this._defs.gradient,cyt())),t.setAttribute(i,r+"")),nyt[n]=r}for(const n in Gmt)ayt(t,Gmt[n],e[n])}},defs(){const t=this._svg,e=this._defs;let n=e.el,r=0;for(const i in e.gradient)n||(e.el=n=qgt(t,1,"defs",Xmt)),r=Qmt(n,e.gradient[i],r);for(const i in e.clipping)n||(e.el=n=qgt(t,1,"defs",Xmt)),r=Jmt(n,e.clipping[i],r);n&&(0===r?(t.removeChild(n),e.el=null):Ggt(n,r))},_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}});let eyt=null,nyt=null;const ryt={group(t,e,n){const r=eyt=e.childNodes[2];nyt=r.__values__,t.foreground(iyt,n,this),nyt=e.__values__,eyt=e.childNodes[1],t.content(iyt,n,this);const i=eyt=e.childNodes[0];t.background(iyt,n,this);const a=!1===n.mark.interactive?"none":null;if(a!==nyt.events&&(syt(r,"pointer-events",a),syt(i,"pointer-events",a),nyt.events=a),n.strokeForeground&&n.stroke){const t=n.fill;syt(r,"display",null),this.style(i,n),syt(i,"stroke",null),t&&(n.fill=null),nyt=r.__values__,this.style(r,n),t&&(n.fill=t),eyt=null}else syt(r,"display","none")},image(t,e,n){!1===n.smooth?(ayt(e,"image-rendering","optimizeSpeed"),ayt(e,"image-rendering","pixelated")):ayt(e,"image-rendering",null)},text(t,e,n){const r=Dgt(n);let i,a,o,s;Dot(r)?(a=r.map((t=>Fgt(n,t))),i=a.join("\n"),i!==nyt.text&&(Ggt(e,0),o=e.ownerDocument,s=Ngt(n),a.forEach(((t,r)=>{const i=Wgt(o,"tspan",Xmt);i.__data__=n,i.textContent=t,r&&(i.setAttribute("x",0),i.setAttribute("dy",s)),e.appendChild(i)})),nyt.text=i)):(a=Fgt(n,r),a!==nyt.text&&(e.textContent=a,nyt.text=a)),syt(e,"font-family",Igt(n)),syt(e,"font-size",Tgt(n)+"px"),syt(e,"font-style",n.fontStyle),syt(e,"font-variant",n.fontVariant),syt(e,"font-weight",n.fontWeight)}};function iyt(t,e,n){e!==nyt[t]&&(n?function(t,e,n,r){null!=n?t.setAttributeNS(r,e,n):t.removeAttributeNS(r,e)}(eyt,t,e,n):syt(eyt,t,e),nyt[t]=e)}function ayt(t,e,n){n!==nyt[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),nyt[e]=n)}function oyt(t,e){for(const n in e)syt(t,n,e[n])}function syt(t,e,n){null!=n?t.setAttribute(e,n):t.removeAttribute(e)}function cyt(){let t;return"undefined"===typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function uyt(t){$gt.call(this,t),this._text=null,this._defs={gradient:{},clipping:{}}}Hot(uyt,$gt,{svg(){return this._text},_render(t){const e=Umt();e.open("svg",Vot({},agt,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",Hmt,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this},mark(t,e){const n=Ugt[e.marktype],r=n.tag,i=[zmt,n.attr];t.open("g",{class:Hgt(e),"clip-path":e.clip?Gft(this,e,e.group):null},Bmt(e),{"pointer-events":"g"!==r&&!1===e.interactive?"none":null});const a=a=>{const o=this.href(a);if(o&&t.open("a",o),t.open(r,this.attr(e,a,i,"g"!==r?r:null)),"text"===r){const e=Dgt(a);if(Dot(e)){const n={x:0,dy:Ngt(a)};for(let r=0;r<e.length;++r)t.open("tspan",r?n:null).text(Fgt(a,e[r])).close()}else t.text(Fgt(a,e))}else if("g"===r){const r=a.strokeForeground,i=a.fill,o=a.stroke;r&&o&&(a.stroke=null),t.open("path",this.attr(e,a,n.background,"bgrect")).close(),t.open("g",this.attr(e,a,n.content)),zpt(a,(e=>this.mark(t,e))),t.close(),r&&o?(i&&(a.fill=null),a.stroke=o,t.open("path",this.attr(e,a,n.foreground,"bgrect")).close(),i&&(a.fill=i)):t.open("path",this.attr(e,a,n.foreground,"bgfore")).close()}t.close(),o&&t.close()};return n.nested?e.items&&e.items.length&&a(e.items[0]):zpt(e,a),t.close()},href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then((t=>{t["xlink:href"]=t.href,t.href=null,(this._hrefs||(this._hrefs={}))[e]=t}))}return null},attr(t,e,n,r){const i={},a=(t,e,n,r)=>{i[r||t]=e};return Array.isArray(n)?n.forEach((t=>t(a,e,this))):n(a,e,this),r&&function(t,e,n,r,i){let a;if(null==e)return t;"bgrect"===r&&!1===n.interactive&&(t["pointer-events"]="none");if("bgfore"===r&&(!1===n.interactive&&(t["pointer-events"]="none"),t.display="none",null!==e.fill))return t;"image"===r&&!1===e.smooth&&(a=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]);"text"===r&&(t["font-family"]=Igt(e),t["font-size"]=Tgt(e)+"px",t["font-style"]=e.fontStyle,t["font-variant"]=e.fontVariant,t["font-weight"]=e.fontWeight);for(const o in qmt){let n=e[o];const r=qmt[o];("transparent"!==n||"fill"!==r&&"stroke"!==r)&&null!=n&&(Zdt(n)&&(n=Qdt(n,i.gradient,"")),t[r]=n)}for(const o in Gmt){const t=e[o];null!=t&&(a=a||[],a.push("".concat(Gmt[o],": ").concat(t,";")))}a&&(t.style=a.join(" "))}(i,e,t,r,this._defs),i},defs(t){const e=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(e).length+Object.keys(n).length){t.open("defs");for(const n in e){const r=e[n],i=r.stops;"radial"===r.gradient?(t.open("pattern",{id:$dt+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),t.close(),t.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):t.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let e=0;e<i.length;++e)t.open("stop",{offset:i[e].offset,"stop-color":i[e].color}).close();t.close()}for(const e in n){const r=n[e];t.open("clipPath",{id:e}),r.path?t.open("path",{d:r.path}).close():t.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),t.close()}t.close()}}});const lyt={svgMarkTypes:["text"],svgOnTop:!0,debug:!1};function hyt(t){$gt.call(this,t),this._svgRenderer=new Kmt(t),this._canvasRenderer=new kmt(t)}const dyt=$gt.prototype;function fyt(t,e){mmt.call(this,t,e)}Hot(hyt,$gt,{initialize(t,e,n,r,i){this._root_el=qgt(t,0,"div");const a=qgt(this._root_el,0,"div"),o=qgt(this._root_el,1,"div");return this._root_el.style.position="relative",lyt.debug||(a.style.height="100%",o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.height="100%",o.style.width="100%"),this._svgEl=lyt.svgOnTop?o:a,this._canvasEl=lyt.svgOnTop?a:o,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,e,n,r,i),this._svgRenderer.initialize(this._svgEl,e,n,r,i),dyt.initialize.call(this,t,e,n,r,i)},dirty(t){return lyt.svgMarkTypes.includes(t.mark.marktype)?this._svgRenderer.dirty(t):this._canvasRenderer.dirty(t),this},_render(t,e){const n=(null!==e&&void 0!==e?e:["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter((t=>!lyt.svgMarkTypes.includes(t)));this._svgRenderer.render(t,lyt.svgMarkTypes),this._canvasRenderer.render(t,n)},resize(t,e,n,r){return dyt.resize.call(this,t,e,n,r),this._svgRenderer.resize(t,e,n,r),this._canvasRenderer.resize(t,e,n,r),this},background(t){return lyt.svgOnTop?this._canvasRenderer.background(t):this._svgRenderer.background(t),this}}),Hot(fyt,mmt,{initialize(t,e,n){const r=qgt(qgt(t,0,"div"),lyt.svgOnTop?0:1,"div");return mmt.prototype.initialize.call(this,r,e,n)}});const pyt="canvas",gyt="hybrid",myt="none",yyt={};function vyt(t,e,n,r){if(function(t,e,n){return t.bounds&&e.intersects(t.bounds)&&("group"===t.marktype||!1!==t.interactive&&(!n||n(t)))}(t,e,n)){const i=t.items,a=t.marktype,o=i.length;let s=0;if("group"===a)for(;s<o;++s)byt(i[s],e,n,r);else for(const t=Ugt[a].isect;s<o;++s){const n=i[s];xyt(n,e,t)&&r.push(n)}}return r}function byt(t,e,n,r){n&&n(t.mark)&&xyt(t,e,Ugt.group.isect)&&r.push(t);const i=t.items,a=i&&i.length;if(a){const o=t.x||0,s=t.y||0;e.translate(-o,-s);for(let t=0;t<a;++t)vyt(i[t],e,n,r);e.translate(o,s)}return r}function xyt(t,e,n){const r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}yyt[pyt]=yyt.png={renderer:kmt,headless:kmt,handler:mmt},yyt.svg={renderer:Kmt,headless:uyt,handler:Smt},yyt[gyt]={renderer:hyt,headless:hyt,handler:fyt},yyt[myt]={};new Hft;var wyt=Math.random;const kyt=Math.sqrt(2*Math.PI),_yt=Math.SQRT2;let Syt=NaN;function Ayt(t,e){t=t||0,e=null==e?1:e;let n,r,i=0,a=0;if(Syt===Syt)i=Syt,Syt=NaN;else{do{i=2*wyt()-1,a=2*wyt()-1,n=i*i+a*a}while(0===n||n>1);r=Math.sqrt(-2*Math.log(n)/n),i*=r,Syt=a*r}return t+i*e}function Cyt(t,e,n){const r=(t-(e||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*kyt)}function Eyt(t,e,n){const r=(t-(e=e||0))/(n=null==n?1:n),i=Math.abs(r);let a;if(i>37)a=0;else{const t=Math.exp(-i*i/2);let e;i<7.07106781186547?(e=.0352624965998911*i+.700383064443688,e=e*i+6.37396220353165,e=e*i+33.912866078383,e=e*i+112.079291497871,e=e*i+221.213596169931,e=e*i+220.206867912376,a=t*e,e=.0883883476483184*i+1.75566716318264,e=e*i+16.064177579207,e=e*i+86.7807322029461,e=e*i+296.564248779674,e=e*i+637.333633378831,e=e*i+793.826512519948,e=e*i+440.413735824752,a/=e):(e=i+.65,e=i+4/e,e=i+3/e,e=i+2/e,e=i+1/e,a=t/e/2.506628274631)}return r>0?1-a:a}function Tyt(t,e,n){return t<0||t>1?NaN:(e||0)+(null==n?1:n)*_yt*function(t){let e,n=-Math.log((1-t)*(1+t));n<6.25?(n-=3.125,e=-364441206401782e-35,e=e*n-16850591381820166e-35,e=128584807152564e-32+e*n,e=11157877678025181e-33+e*n,e=e*n-1333171662854621e-31,e=20972767875968562e-33+e*n,e=6637638134358324e-30+e*n,e=e*n-4054566272975207e-29,e=e*n-8151934197605472e-29,e=26335093153082323e-28+e*n,e=e*n-12975133253453532e-27,e=e*n-5415412054294628e-26,e=1.0512122733215323e-9+e*n,e=e*n-4.112633980346984e-9,e=e*n-2.9070369957882005e-8,e=4.2347877827932404e-7+e*n,e=e*n-13654692000834679e-22,e=e*n-13882523362786469e-21,e=.00018673420803405714+e*n,e=e*n-.000740702534166267,e=e*n-.006033670871430149,e=.24015818242558962+e*n,e=1.6536545626831027+e*n):n<16?(n=Math.sqrt(n)-3.25,e=2.2137376921775787e-9,e=9.075656193888539e-8+e*n,e=e*n-2.7517406297064545e-7,e=1.8239629214389228e-8+e*n,e=15027403968909828e-22+e*n,e=e*n-4013867526981546e-21,e=29234449089955446e-22+e*n,e=12475304481671779e-21+e*n,e=e*n-47318229009055734e-21,e=6828485145957318e-20+e*n,e=24031110387097894e-21+e*n,e=e*n-.0003550375203628475,e=.0009532893797373805+e*n,e=e*n-.0016882755560235047,e=.002491442096107851+e*n,e=e*n-.003751208507569241,e=.005370914553590064+e*n,e=1.0052589676941592+e*n,e=3.0838856104922208+e*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,e=-27109920616438573e-27,e=e*n-2.555641816996525e-10,e=1.5076572693500548e-9+e*n,e=e*n-3.789465440126737e-9,e=7.61570120807834e-9+e*n,e=e*n-1.496002662714924e-8,e=2.914795345090108e-8+e*n,e=e*n-6.771199775845234e-8,e=2.2900482228026655e-7+e*n,e=e*n-9.9298272942317e-7,e=4526062597223154e-21+e*n,e=e*n-1968177810553167e-20,e=7599527703001776e-20+e*n,e=e*n-.00021503011930044477,e=e*n-.00013871931833623122,e=1.0103004648645344+e*n,e=4.849906401408584+e*n):e=1/0;return e*t}(2*t-1)}function Nyt(t,e){return t=t||0,e=null==e?1:e,Math.exp(t+Ayt()*e)}function Dyt(t,e,n){if(t<=0)return 0;e=e||0,n=null==n?1:n;const r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*kyt*t)}function Fyt(t,e,n){return Eyt(Math.log(t),e,n)}function Iyt(t,e,n){return Math.exp(Tyt(t,e,n))}function Myt(t,e){return null==e&&(e=null==t?1:t,t=0),t+(e-t)*wyt()}function Oyt(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=e&&t<=n?1/(n-e):0}function Ryt(t,e,n){return null==n&&(n=null==e?1:e,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function zyt(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=0&&t<=1?e+t*(n-e):NaN}Math.PI;function Byt(t){const e=this.context.data[t];return e?e.values.value:[]}const Lyt=t=>function(e,n){return this.context.dataflow.locale()[t](n)(e)},Pyt=Lyt("format"),jyt=Lyt("timeFormat"),Uyt=Lyt("utcFormat"),Wyt=Lyt("timeParse"),Vyt=Lyt("utcParse"),qyt=new Date(2e3,0,1);function Gyt(t,e,n){return Number.isInteger(t)&&Number.isInteger(e)?(qyt.setYear(2e3),qyt.setMonth(t),qyt.setDate(e),jyt.call(this,qyt,n)):""}const Hyt="%";function Yyt(t,e,n,r){e[0].type!==rst&&Aot("First argument to data functions must be a string literal.");const i=e[0].value,a=":"+i;if(!Got(a,r))try{r[a]=n.getData(i).tuplesRef()}catch(o){}}function Xyt(t,e,n,r){if(e[0].type===rst)Kyt(n,r,e[0].value);else for(t in n.scales)Kyt(n,r,t)}function Kyt(t,e,n){const r=Hyt+n;if(!Got(e,r))try{e[r]=t.scaleRef(n)}catch(i){}}function $yt(t,e){let n;return Wot(t)?t:Kot(t)?(n=e.scales[t])&&n.value:void 0}function Zyt(t,e,n){e.__bandwidth=t=>t&&t.bandwidth?t.bandwidth():0,n._bandwidth=Xyt,n._range=Xyt,n._scale=Xyt;const r=e=>"_["+(e.type===rst?Zot(Hyt+e.value):Zot(Hyt)+"+"+t(e))+"]";return{_bandwidth:t=>"this.__bandwidth(".concat(r(t[0]),")"),_range:t=>"".concat(r(t[0]),".range()"),_scale:e=>"".concat(r(e[0]),"(").concat(t(e[1]),")")}}function Qyt(t,e){return function(n,r,i){if(n){const e=$yt(n,(i||this).context);return e&&e.path[t](r)}return e(r)}}const Jyt=Qyt("area",(function(t){return Wst=new W3,U3(t,Vst),2*Wst})),tvt=Qyt("bounds",(function(t){var e,n,r,i,a,o,s;if(Mst=Ist=-(Dst=Fst=1/0),Pst=[],U3(t,lct),n=Pst.length){for(Pst.sort(bct),e=1,a=[r=Pst[0]];e<n;++e)xct(r,(i=Pst[e])[0])||xct(r,i[1])?(vct(r[0],i[1])>vct(r[0],r[1])&&(r[1]=i[1]),vct(i[0],r[1])>vct(r[0],r[1])&&(r[0]=i[0])):a.push(r=i);for(o=-1/0,e=0,r=a[n=a.length-1];e<=n;r=i,++e)i=a[e],(s=vct(r[1],i[0]))>o&&(o=s,Dst=i[0],Ist=r[1])}return Pst=jst=null,Dst===1/0||Fst===1/0?[[NaN,NaN],[NaN,NaN]]:[[Dst,Fst],[Ist,Mst]]})),evt=Qyt("centroid",(function(t){Xst=Kst=$st=Zst=Qst=Jst=tct=ect=0,nct=new W3,rct=new W3,ict=new W3,U3(t,wct);var e=+nct,n=+rct,r=+ict,i=LF(e,n,r);return i<AF&&(e=Jst,n=tct,r=ect,Kst<SF&&(e=$st,n=Zst,r=Qst),(i=LF(e,n,r))<AF)?[NaN,NaN]:[OF(n,e)*DF,HF(r/i)*DF]}));function nvt(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(r){t.warn(r)}return n[n.length-1]}function rvt(t){const e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function ivt(t){const e=FA(t);return.2126*rvt(e.r)+.7152*rvt(e.g)+.0722*rvt(e.b)}function avt(t,e){return t===e||t!==t&&e!==e||(Dot(t)?!(!Dot(e)||t.length!==e.length)&&function(t,e){for(let n=0,r=t.length;n<r;++n)if(!avt(t[n],e[n]))return!1;return!0}(t,e):!(!Fot(t)||!Fot(e))&&ovt(t,e))}function ovt(t,e){for(const n in t)if(!avt(t[n],e[n]))return!1;return!0}function svt(t){return e=>ovt(t,e)}const cvt={};function uvt(t){return Dot(t)||ArrayBuffer.isView(t)?t:null}function lvt(t){return uvt(t)||(Kot(t)?t:null)}const hvt=t=>t.data;function dvt(t,e){const n=Byt.call(e,t);return n.root&&n.root.lookup||{}}const fvt=()=>"undefined"!==typeof window&&window||null;const pvt={random:()=>wyt(),cumulativeNormal:Eyt,cumulativeLogNormal:Fyt,cumulativeUniform:Ryt,densityNormal:Cyt,densityLogNormal:Dyt,densityUniform:Oyt,quantileNormal:Tyt,quantileLogNormal:Iyt,quantileUniform:zyt,sampleNormal:Ayt,sampleLogNormal:Nyt,sampleUniform:Myt,isArray:Dot,isBoolean:function(t){return"boolean"===typeof t},isDate:Yot,isDefined:t=>void 0!==t,isNumber:Xot,isObject:Fot,isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},isString:Kot,isTuple:Qs,isValid:t=>null!=t&&t===t,toBoolean:Qot,toDate:tst,toNumber:Mot,toString:est,indexof:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return lvt(t).indexOf(...n)},join:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return uvt(t).join(...n)},lastindexof:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return lvt(t).lastIndexOf(...n)},replace:function(t,e,n){return Wot(n)&&Aot("Function argument passed to replace."),String(t).replace(e,n)},reverse:function(t){return uvt(t).slice().reverse()},slice:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return lvt(t).slice(...n)},flush:function(t,e,n,r,i,a){if(!n&&0!==n)return a;const o=+n;let s,c=t[0],u=Iot(t);u<c&&(s=c,c=u,u=s),s=Math.abs(e-c);const l=Math.abs(u-e);return s<l&&s<=o?r:l<=o?i:a},lerp:function(t,e){const n=t[0],r=Iot(t),i=+e;return i?1===i?r:n+i*(r-n):n},merge:function(){const t=[].slice.call(arguments);return t.unshift({}),Vot(...t)},pad:function(t,e,n,r){const i=n||" ",a=t+"",o=e-a.length;return o<=0?a:"left"===r?$ot(i,o)+a:"center"===r?$ot(i,~~(o/2))+a+$ot(i,Math.ceil(o/2)):a+$ot(i,o)},peek:Iot,pluck:function(t,e){const n=cvt[e]||(cvt[e]=Eot(e));return Dot(t)?t.map(n):n(t)},span:function(t){return t&&Iot(t)-t[0]||0},inrange:function(t,e,n,r){let i,a=e[0],o=e[e.length-1];return a>o&&(i=a,a=o,o=i),r=void 0===r||r,((n=void 0===n||n)?a<=t:a<t)&&(r?t<=o:t<o)},truncate:function(t,e,n,r){const i=null!=r?r:"\u2026",a=t+"",o=a.length,s=Math.max(0,e-i.length);return o<=e?a:"left"===n?i+a.slice(o-s):"center"===n?a.slice(0,Math.ceil(s/2))+i+a.slice(o-~~(s/2)):a.slice(0,s)+i},rgb:FA,lab:g2,hcl:k2,hsl:LA,luminance:ivt,contrast:function(t,e){const n=ivt(t),r=ivt(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:zu,format:Pyt,utcFormat:Uyt,utcParse:Vyt,utcOffset:function(t,e,n){return fht(dht(t),e,n)},utcSequence:function(t,e,n,r){return pht(dht(t),e,n,r)},timeFormat:jyt,timeParse:Wyt,timeOffset:function(t,e,n){return fht(hht(t),e,n)},timeSequence:function(t,e,n,r){return pht(hht(t),e,n,r)},timeUnitSpecifier:function(t,e){const n=Vot({},nht,e),r=function(t){const e=Uot(t).slice(),n={};return e.length||Aot("Missing time unit."),e.forEach((t=>{Got(eht,t)?n[t]=1:Aot("Invalid time unit: ".concat(t,"."))})),(n[Ylt]||n[Klt]?1:0)+(n[Glt]||n[Hlt]||n[Xlt]?1:0)+(n[$lt]?1:0)>1&&Aot("Incompatible time units: ".concat(t)),e.sort(((t,e)=>eht[t]-eht[e])),e}(t),i=r.length;let a,o,s="",c=0;for(c=0;c<i;)for(a=r.length;a>c;--a)if(o=r.slice(c,a).join("-"),null!=n[o]){s+=n[o],c=a;break}return s.trim()},monthFormat:function(t){return Gyt.call(this,t,1,"%B")},monthAbbrevFormat:function(t){return Gyt.call(this,t,1,"%b")},dayFormat:function(t){return Gyt.call(this,0,2+t,"%A")},dayAbbrevFormat:function(t){return Gyt.call(this,0,2+t,"%a")},quarter:function(t){return 1+~~(new Date(t).getMonth()/3)},utcquarter:function(t){return 1+~~(new Date(t).getUTCMonth()/3)},week:function(t){return oht(new Date(t))},utcweek:function(t){return cht(new Date(t))},dayofyear:function(t){return aht(new Date(t))},utcdayofyear:function(t){return sht(new Date(t))},warn:function(){return nvt(this.context.dataflow,"warn",arguments)},info:function(){return nvt(this.context.dataflow,"info",arguments)},debug:function(){return nvt(this.context.dataflow,"debug",arguments)},extent:function(t,e){let n,r,i,a,o=0;if(t&&(n=t.length))if(null==e){for(r=t[o];o<n&&(null==r||r!==r);r=t[++o]);for(i=a=r;o<n;++o)r=t[o],null!=r&&(r<i&&(i=r),r>a&&(a=r))}else{for(r=e(t[o]);o<n&&(null==r||r!==r);r=e(t[++o]));for(i=a=r;o<n;++o)r=e(t[o]),null!=r&&(r<i&&(i=r),r>a&&(a=r))}return[i,a]},inScope:function(t){const e=this.context.group;let n=!1;if(e)for(;t;){if(t===e){n=!0;break}t=t.mark.group}return n},intersect:function(t,e,n){if(!t)return[];const[r,i]=t,a=(new Hft).set(r[0],r[1],i[0],i[1]);return function(t,e,n){const r=[],i=(new Hft).union(e),a=t.marktype;return a?vyt(t,i,n,r):"group"===a?byt(t,i,n,r):Aot("Intersect scene must be mark node or group item.")}(n||this.context.dataflow.scenegraph().root,a,function(t){let e=null;if(t){const n=Uot(t.marktype),r=Uot(t.markname);e=t=>(!n.length||n.some((e=>t.marktype===e)))&&(!r.length||r.some((e=>t.name===e)))}return e}(e))},clampRange:function(t,e,n){let r,i=t[0],a=t[1];return a<i&&(r=a,a=i,i=r),r=a-i,r>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]},pinchDistance:function(t){const e=t.touches,n=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(n*n+r*r)},pinchAngle:function(t){const e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)},screen:function(){const t=fvt();return t?t.screen:{}},containerSize:function(){const t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]},windowSize:function(){const t=fvt();return t?[t.innerWidth,t.innerHeight]:[void 0,void 0]},bandspace:function(t,e,n){return bht(t||0,e||0,n||0)},setdata:function(t,e){const n=this.context.dataflow,r=this.context.data[t].input;return n.pulse(r,n.changeset().remove(Not).insert(e)),1},pathShape:function(t){let e=null;return function(n){return n?vft(n,e=e||sft(t)):t}},panLinear:function(t,e){return Pot(t,e,Mot,Tot)},panLog:function(t,e){var n=Math.sign(t[0]);return Pot(t,e,Rot(n),Oot(n))},panPow:function(t,e,n){return Pot(t,e,Lot(n),Lot(1/n))},panSymlog:function(t,e,n){return Pot(t,e,zot(n),Bot(n))},zoomLinear:function(t,e,n){return jot(t,e,n,Mot,Tot)},zoomLog:function(t,e,n){const r=Math.sign(t[0]);return jot(t,e,n,Rot(r),Oot(r))},zoomPow:function(t,e,n,r){return jot(t,e,n,Lot(r),Lot(1/r))},zoomSymlog:function(t,e,n,r){return jot(t,e,n,zot(r),Bot(r))},encode:function(t,e,n){if(t){const n=this.context.dataflow,r=t.mark.source;n.pulse(r,n.changeset().encode(t,e))}return void 0!==n?n:t},modify:function(t,e,n,r,i,a){const o=this.context.dataflow,s=this.context.data[t],c=s.input,u=o.stamp();let l,h,d=s.changes;if(!1===o._trigger||!(c.value.length||e||r))return 0;if((!d||d.stamp<u)&&(s.changes=d=o.changeset(),d.stamp=u,o.runAfter((()=>{s.modified=!0,o.pulse(c,d).run()}),!0,1)),n&&(l=!0===n?Not:Dot(n)||Qs(n)?n:svt(n),d.remove(l)),e&&d.insert(e),r&&(l=svt(r),c.value.some(l)?d.remove(l):d.insert(r)),i)for(h in a)d.modify(i,h,a[h]);return 1}},gvt=["view","item","group","xy","x","y"],mvt="this.",yvt={},vvt={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:t=>"_[".concat(Zot("$"+t),"]"),functions:function(t){const e=Sst(t);gvt.forEach((t=>e[t]="event.vega."+t));for(const n in pvt)e[n]=mvt+n;return Vot(e,Zyt(t,pvt,yvt)),e},constants:_st,visitors:yvt},bvt=function(t){const e=(t=t||{}).allowed?nst(t.allowed):{},n=t.forbidden?nst(t.forbidden):{},r=t.constants||_st,i=(t.functions||Sst)(h),a=t.globalvar,o=t.fieldvar,s=Wot(a)?a:t=>"".concat(a,'["').concat(t,'"]');let c={},u={},l=0;function h(t){if(Kot(t))return t;const e=d[t.type];return null==e&&Aot("Unsupported type: "+t.type),e(t)}const d={Literal:t=>t.raw,Identifier:t=>{const i=t.name;return l>0?i:Got(n,i)?Aot("Illegal identifier: "+i):Got(r,i)?r[i]:Got(e,i)?i:(c[i]=1,s(i))},MemberExpression:t=>{const e=!t.computed,n=h(t.object);e&&(l+=1);const r=h(t.property);return n===o&&(u[function(t){const e=t&&t.length-1;return e&&('"'===t[0]&&'"'===t[e]||"'"===t[0]&&"'"===t[e])?t.slice(1,-1):t}(r)]=1),e&&(l-=1),n+(e?"."+r:"["+r+"]")},CallExpression:t=>{"Identifier"!==t.callee.type&&Aot("Illegal callee type: "+t.callee.type);const e=t.callee.name,n=t.arguments,r=Got(i,e)&&i[e];return r||Aot("Unrecognized function: "+e),Wot(r)?r(n):r+"("+n.map(h).join(",")+")"},ArrayExpression:t=>"["+t.elements.map(h).join(",")+"]",BinaryExpression:t=>"("+h(t.left)+" "+t.operator+" "+h(t.right)+")",UnaryExpression:t=>"("+t.operator+h(t.argument)+")",ConditionalExpression:t=>"("+h(t.test)+"?"+h(t.consequent)+":"+h(t.alternate)+")",LogicalExpression:t=>"("+h(t.left)+t.operator+h(t.right)+")",ObjectExpression:t=>"{"+t.properties.map(h).join(",")+"}",Property:t=>{l+=1;const e=h(t.key);return l-=1,e+":"+h(t.value)}};function f(t){const e={code:h(t),globals:Object.keys(c),fields:Object.keys(u)};return c={},u={},e}return f.functions=i,f.constants=r,f}(vvt);function xvt(t,e,n){return 1===arguments.length?pvt[t]:(pvt[t]=e,n&&(yvt[t]=n),bvt&&(bvt.functions[t]=mvt+t),this)}xvt("bandwidth",(function(t,e){const n=$yt(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0}),Xyt),xvt("copy",(function(t,e){const n=$yt(t,(e||this).context);return n?n.copy():void 0}),Xyt),xvt("domain",(function(t,e){const n=$yt(t,(e||this).context);return n?n.domain():[]}),Xyt),xvt("range",(function(t,e){const n=$yt(t,(e||this).context);return n&&n.range?n.range():[]}),Xyt),xvt("invert",(function(t,e,n){const r=$yt(t,(n||this).context);return r?Dot(e)?(r.invertRange||r.invert)(e):(r.invert||r.invertExtent)(e):void 0}),Xyt),xvt("scale",(function(t,e,n){const r=$yt(t,(n||this).context);return r?r(e):void 0}),Xyt),xvt("gradient",(function(t,e,n,r,i){t=$yt(t,(i||this).context);const a=function(t,e){var n,r=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:r,stop:function(t,e){return r.push({offset:t,color:e}),n}}}(e,n);let o=t.domain(),s=o[0],c=Iot(o),u=Tot;return c-s?u=Kht(t,s,c):t=(t.interpolator?qht("sequential")().interpolator(t.interpolator()):qht("linear")().interpolate(t.interpolate()).range(t.range())).domain([s=0,c=1]),t.ticks&&(o=t.ticks(+r||15),s!==o[0]&&o.unshift(s),c!==Iot(o)&&o.push(c)),o.forEach((e=>a.stop(u(e),t(e)))),a}),Xyt),xvt("geoArea",Jyt,Xyt),xvt("geoBounds",tvt,Xyt),xvt("geoCentroid",evt,Xyt),xvt("geoShape",(function(t,e,n){const r=$yt(t,(n||this).context);return function(t){return r?r.path.context(t)(e):""}}),Xyt),xvt("indata",(function(t,e,n){const r=this.context.data[t]["index:"+e],i=r?r.value.get(n):void 0;return i?i.count:i}),(function(t,e,n,r){e[0].type!==rst&&Aot("First argument to indata must be a string literal."),e[1].type!==rst&&Aot("Second argument to indata must be a string literal.");const i=e[0].value,a=e[1].value,o="@"+a;Got(o,r)||(r[o]=n.getData(i).indataRef(n,a))})),xvt("data",Byt,Yyt),xvt("treePath",(function(t,e,n){const r=dvt(t,this),i=r[e],a=r[n];return i&&a?i.path(a).map(hvt):void 0}),Yyt),xvt("treeAncestors",(function(t,e){const n=dvt(t,this)[e];return n?n.ancestors().map(hvt):void 0}),Yyt),xvt("vlSelectionTest",cet,yet),xvt("vlSelectionIdTest",fet,yet),xvt("vlSelectionResolve",get,yet),xvt("vlSelectionTuples",pet);const wvt="view",kvt="[",_vt="]",Svt="{",Avt="}",Cvt=":",Evt=",",Tvt="@",Nvt=">",Dvt=/[[\]{}]/,Fvt={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let Ivt,Mvt;function Ovt(t,e,n,r,i){const a=t.length;let o,s=0;for(;e<a;++e){if(o=t[e],!s&&o===n)return e;i&&i.indexOf(o)>=0?--s:r&&r.indexOf(o)>=0&&++s}return e}function Rvt(t){const e=[],n=t.length;let r=0,i=0;for(;i<n;)i=Ovt(t,i,Evt,kvt+Svt,_vt+Avt),e.push(t.substring(r,i).trim()),r=++i;if(0===e.length)throw"Empty event selector: "+t;return e}function zvt(t){return"["===t[0]?function(t){const e=t.length;let n,r=1;if(r=Ovt(t,r,_vt,kvt,_vt),r===e)throw"Empty between selector: "+t;if(n=Rvt(t.substring(1,r)),2!==n.length)throw"Between selector must have two elements: "+t;if(t=t.slice(r+1).trim(),t[0]!==Nvt)throw"Expected '>' after between selector: "+t;n=n.map(zvt);const i=zvt(t.slice(1).trim());if(i.between)return{between:n,stream:i};i.between=n;return i}(t):function(t){const e={source:Ivt},n=[];let r,i,a=[0,0],o=0,s=0,c=t.length,u=0;if(t[c-1]===Avt){if(u=t.lastIndexOf(Svt),!(u>=0))throw"Unmatched right brace: "+t;try{a=function(t){const e=t.split(Evt);if(!t.length||e.length>2)throw t;return e.map((e=>{const n=+e;if(n!==n)throw t;return n}))}(t.substring(u+1,c-1))}catch(l){throw"Invalid throttle specification: "+t}c=(t=t.slice(0,u).trim()).length,u=0}if(!c)throw t;t[0]===Tvt&&(o=++u);r=Ovt(t,u,Cvt),r<c&&(n.push(t.substring(s,r).trim()),s=u=++r);if(u=Ovt(t,u,kvt),u===c)n.push(t.substring(s,c).trim());else if(n.push(t.substring(s,u).trim()),i=[],s=++u,s===c)throw"Unmatched left bracket: "+t;for(;u<c;){if(u=Ovt(t,u,_vt),u===c)throw"Unmatched left bracket: "+t;if(i.push(t.substring(s,u).trim()),u<c-1&&t[++u]!==kvt)throw"Expected left bracket: "+t;s=++u}if(!(c=n.length)||Dvt.test(n[c-1]))throw"Invalid event selector: "+t;c>1?(e.type=n[1],o?e.markname=n[0].slice(1):!function(t){return Mvt[t]}(n[0])?e.source=n[0]:e.marktype=n[0]):e.type=n[0];"!"===e.type.slice(-1)&&(e.consume=!0,e.type=e.type.slice(0,-1));null!=i&&(e.filter=i);a[0]&&(e.throttle=a[0]);a[1]&&(e.debounce=a[1]);return e}(t)}function Bvt(t){return sn(t)?t:{type:t||"pad"}}const Lvt=t=>+t||0,Pvt=t=>({top:t,bottom:t,left:t,right:t});function jvt(t){return sn(t)?t.signal?t:{top:Lvt(t.top),bottom:Lvt(t.bottom),left:Lvt(t.left),right:Lvt(t.right)}:Pvt(Lvt(t))}const Uvt=t=>sn(t)&&!on(t)?On({},t):{value:t};function Wvt(t,e,n,r){if(null!=n){return sn(n)&&!on(n)||on(n)&&n.length&&sn(n[0])?t.update[e]=n:t[r||"enter"][e]={value:n},1}return 0}function Vvt(t,e,n){for(const r in e)Wvt(t,r,e[r]);for(const r in n)Wvt(t,r,n[r],"update")}function qvt(t,e,n){for(const r in e)n&&Bn(n,r)||(t[r]=On(t[r]||{},e[r]));return t}function Gvt(t,e){return e&&(e.enter&&e.enter[t]||e.update&&e.update[t])}const Hvt="mark",Yvt="frame",Xvt="scope",Kvt="axis",$vt="axis-domain",Zvt="axis-grid",Qvt="axis-label",Jvt="axis-tick",tbt="axis-title",ebt="legend",nbt="legend-band",rbt="legend-entry",ibt="legend-gradient",abt="legend-label",obt="legend-symbol",sbt="legend-title",cbt="title",ubt="title-text",lbt="title-subtitle";function hbt(t,e,n){t[e]=n&&n.signal?{signal:n.signal}:{value:n}}const dbt=t=>qn(t)?Xn(t):t.signal?"(".concat(t.signal,")"):mbt(t);function fbt(t){if(null!=t.gradient)return function(t){const e=[t.start,t.stop,t.count].map((t=>null==t?null:Xn(t)));for(;e.length&&null==hn(e);)e.pop();return e.unshift(dbt(t.gradient)),"gradient(".concat(e.join(","),")")}(t);let e=t.signal?"(".concat(t.signal,")"):t.color?function(t){return t.c?pbt("hcl",t.h,t.c,t.l):t.h||t.s?pbt("hsl",t.h,t.s,t.l):t.l||t.a?pbt("lab",t.l,t.a,t.b):t.r||t.g||t.b?pbt("rgb",t.r,t.g,t.b):null}(t.color):null!=t.field?mbt(t.field):void 0!==t.value?Xn(t.value):void 0;return null!=t.scale&&(e=function(t,e){const n=dbt(t.scale);null!=t.range?e="lerp(_range(".concat(n,"), ").concat(+t.range,")"):(void 0!==e&&(e="_scale(".concat(n,", ").concat(e,")")),t.band&&(e=(e?e+"+":"")+"_bandwidth(".concat(n,")")+(1===+t.band?"":"*"+gbt(t.band)),t.extra&&(e="(datum.extra ? _scale(".concat(n,", datum.extra.value) : ").concat(e,")"))),null==e&&(e="0"));return e}(t,e)),void 0===e&&(e=null),null!=t.exponent&&(e="pow(".concat(e,",").concat(gbt(t.exponent),")")),null!=t.mult&&(e+="*".concat(gbt(t.mult))),null!=t.offset&&(e+="+".concat(gbt(t.offset))),t.round&&(e="round(".concat(e,")")),e}const pbt=(t,e,n,r)=>"(".concat(t,"(").concat([e,n,r].map(fbt).join(","),")+'')");function gbt(t){return sn(t)?"("+fbt(t)+")":t}function mbt(t){return ybt(sn(t)?t:{datum:t})}function ybt(t){let e,n,r;if(t.signal)e="datum",r=t.signal;else if(t.group||t.parent){for(n=Math.max(1,t.level||1),e="item";n-- >0;)e+=".mark.group";t.parent?(r=t.parent,e+=".datum"):r=t.group}else t.datum?(e="datum",r=t.datum):qe("Invalid field reference: "+Xn(t));return t.signal||(r=qn(r)?Ge(r).map(Xn).join("]["):ybt(r)),e+"["+r+"]"}function vbt(t,e,n,r,i,a){const o={};(a=a||{}).encoders={$encode:o},t=function(t,e,n,r,i){const a={},o={};let s,c,u,l;for(c in c="lineBreak","text"!==e||null==i[c]||Gvt(c,t)||hbt(a,c,i[c]),("legend"==n||String(n).startsWith("axis"))&&(n=null),l=n===Yvt?i.group:n===Hvt?On({},i.mark,i[e]):null,l)u=Gvt(c,t)||("fill"===c||"stroke"===c)&&(Gvt("fill",t)||Gvt("stroke",t)),u||hbt(a,c,l[c]);for(c in Sn(r).forEach((e=>{const n=i.style&&i.style[e];for(const r in n)Gvt(r,t)||hbt(a,r,n[r])})),t=On({},t),a)l=a[c],l.signal?(s=s||{})[c]=l:o[c]=l;return t.enter=On(o,t.enter),s&&(t.update=On(s,t.update)),t}(t,e,n,r,i.config);for(const s in t)o[s]=bbt(t[s],e,a,i);return a}function bbt(t,e,n,r){const i={},a={};for(const s in t)null!=t[s]&&(i[s]=xbt((o=t[s],on(o)?function(t){let e="";return t.forEach((t=>{const n=fbt(t);e+=t.test?"(".concat(t.test,")?").concat(n,":"):n})),":"===hn(e)&&(e+="null"),e}(o):fbt(o)),r,n,a));var o;return{$expr:{marktype:e,channels:i},$fields:Object.keys(a),$output:Object.keys(t)}}function xbt(t,e,n,r){const i=ant(t,e);return i.$fields.forEach((t=>r[t]=1)),On(n,i.$params),i.$expr}const wbt="outer",kbt=["value","update","init","react","bind"];function _bt(t,e){qe(t+' for "outer" push: '+Xn(e))}function Sbt(t,e){const n=t.name;if(t.push===wbt)e.signals[n]||_bt("No prior signal definition",n),kbt.forEach((e=>{void 0!==t[e]&&_bt("Invalid property ",e)}));else{const r=e.addSignal(n,t.value);!1===t.react&&(r.react=!1),t.bind&&e.addBinding(n,t.bind)}}function Abt(t,e,n,r){this.id=-1,this.type=t,this.value=e,this.params=n,r&&(this.parent=r)}function Cbt(t,e,n,r){return new Abt(t,e,n,r)}function Ebt(t,e){return Cbt("operator",t,e)}function Tbt(t){const e={$ref:t.id};return t.id<0&&(t.refs=t.refs||[]).push(e),e}function Nbt(t,e){return e?{$field:t,$name:e}:{$field:t}}const Dbt=Nbt("key");function Fbt(t,e){return{$compare:t,$order:e}}const Ibt="descending";function Mbt(t,e){return(t&&t.signal?"$"+t.signal:t||"")+(t&&e?"_":"")+(e&&e.signal?"$"+e.signal:e||"")}const Obt="scope",Rbt="view";function zbt(t){return t&&t.signal}function Bbt(t){if(zbt(t))return!0;if(sn(t))for(const e in t)if(Bbt(t[e]))return!0;return!1}function Lbt(t,e){return null!=t?t:e}function Pbt(t){return t&&t.signal||t}const jbt="timer";function Ubt(t,e){return(t.merge?Wbt:t.stream?Vbt:t.type?qbt:qe("Invalid stream specification: "+Xn(t)))(t,e)}function Wbt(t,e){const n=t.merge.map((t=>Ubt(t,e))),r=Gbt({merge:n},t,e);return e.addStream(r).id}function Vbt(t,e){const n=Gbt({stream:Ubt(t.stream,e)},t,e);return e.addStream(n).id}function qbt(t,e){let n;t.type===jbt?(n=e.event(jbt,t.throttle),t={between:t.between,filter:t.filter}):n=e.event(function(t){return t===Obt?Rbt:t||Rbt}(t.source),t.type);const r=Gbt({stream:n},t,e);return 1===Object.keys(r).length?n:e.addStream(r).id}function Gbt(t,e,n){let r=e.between;return r&&(2!==r.length&&qe('Stream "between" parameter must have 2 entries: '+Xn(e)),t.between=[Ubt(r[0],n),Ubt(r[1],n)]),r=e.filter?[].concat(e.filter):[],(e.marktype||e.markname||e.markrole)&&r.push(function(t,e,n){const r="event.item";return r+(t&&"*"!==t?"&&"+r+".mark.marktype==='"+t+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(e?"&&"+r+".mark.name==='"+e+"'":"")}(e.marktype,e.markname,e.markrole)),e.source===Obt&&r.push("inScope(event.item)"),r.length&&(t.filter=ant("("+r.join(")&&(")+")",n).$expr),null!=(r=e.throttle)&&(t.throttle=+r),null!=(r=e.debounce)&&(t.debounce=+r),e.consume&&(t.consume=!0),t}const Hbt={code:"_.$value",ast:{type:"Identifier",value:"value"}};function Ybt(t,e,n){const r=t.encode,i={target:n};let a=t.events,o=t.update,s=[];a||qe("Signal update missing events specification."),qn(a)&&(a=function(t,e,n){return Ivt=e||wvt,Mvt=n||Fvt,Rvt(t.trim()).map(zvt)}(a,e.isSubscope()?Obt:Rbt)),a=Sn(a).filter((t=>t.signal||t.scale?(s.push(t),0):1)),s.length>1&&(s=[Xbt(s)]),a.length&&s.push(a.length>1?{merge:a}:a[0]),null!=r&&(o&&qe("Signal encode and update are mutually exclusive."),o="encode(item(),"+Xn(r)+")"),i.update=qn(o)?ant(o,e):null!=o.expr?ant(o.expr,e):null!=o.value?o.value:null!=o.signal?{$expr:Hbt,$params:{$value:e.signalRef(o.signal)}}:qe("Invalid signal update specification."),t.force&&(i.options={force:!0}),s.forEach((t=>e.addUpdate(On(function(t,e){return{source:t.signal?e.signalRef(t.signal):t.scale?e.scaleRef(t.scale):Ubt(t,e)}}(t,e),i))))}function Xbt(t){return{signal:"["+t.map((t=>t.scale?'scale("'+t.scale+'")':t.signal))+"]"}}const Kbt=t=>(e,n,r)=>Cbt(t,n,e||void 0,r),$bt=Kbt("aggregate"),Zbt=Kbt("axisticks"),Qbt=Kbt("bound"),Jbt=Kbt("collect"),txt=Kbt("compare"),ext=Kbt("datajoin"),nxt=Kbt("encode"),rxt=Kbt("expression"),ixt=Kbt("facet"),axt=Kbt("field"),oxt=Kbt("key"),sxt=Kbt("legendentries"),cxt=Kbt("load"),uxt=Kbt("mark"),lxt=Kbt("multiextent"),hxt=Kbt("multivalues"),dxt=Kbt("overlap"),fxt=Kbt("params"),pxt=Kbt("prefacet"),gxt=Kbt("projection"),mxt=Kbt("proxy"),yxt=Kbt("relay"),vxt=Kbt("render"),bxt=Kbt("scale"),xxt=Kbt("sieve"),wxt=Kbt("sortitems"),kxt=Kbt("viewlayout"),_xt=Kbt("values");let Sxt=0;const Axt={min:"min",max:"max",count:"sum"};function Cxt(t,e){const n=e.getScale(t.name).params;let r;for(r in n.domain=Dxt(t.domain,t,e),null!=t.range&&(n.range=Lxt(t,e,n)),null!=t.interpolate&&function(t,e){e.interpolate=Ext(t.type||t),null!=t.gamma&&(e.interpolateGamma=Ext(t.gamma))}(t.interpolate,n),null!=t.nice&&(n.nice=function(t){return sn(t)?{interval:Ext(t.interval),step:Ext(t.step)}:Ext(t)}(t.nice)),null!=t.bins&&(n.bins=function(t,e){return t.signal||on(t)?Txt(t,e):e.objectProperty(t)}(t.bins,e)),t)Bn(n,r)||"name"===r||(n[r]=Ext(t[r],e))}function Ext(t,e){return sn(t)?t.signal?e.signalRef(t.signal):qe("Unsupported object: "+Xn(t)):t}function Txt(t,e){return t.signal?e.signalRef(t.signal):t.map((t=>Ext(t,e)))}function Nxt(t){qe("Can not find data set: "+Xn(t))}function Dxt(t,e,n){if(t)return t.signal?n.signalRef(t.signal):(on(t)?Fxt:t.fields?Mxt:Ixt)(t,e,n);null==e.domainMin&&null==e.domainMax||qe("No scale domain defined for domainMin/domainMax to override.")}function Fxt(t,e,n){return t.map((t=>Ext(t,n)))}function Ixt(t,e,n){const r=n.getData(t.data);return r||Nxt(t.data),Av(e.type)?r.valuesRef(n,t.field,Rxt(t.sort,!1)):Nv(e.type)?r.domainRef(n,t.field):r.extentRef(n,t.field)}function Mxt(t,e,n){const r=t.data,i=t.fields.reduce(((t,e)=>(e=qn(e)?{data:r,field:e}:on(e)||e.signal?function(t,e){const n="_:vega:_"+Sxt++,r=Jbt({});if(on(t))r.value={$ingest:t};else if(t.signal){const i="setdata("+Xn(n)+","+t.signal+")";r.params.input=e.signalRef(i)}return e.addDataPipeline(n,[r,xxt({})]),{data:n,field:"data"}}(e,n):e,t.push(e),t)),[]);return(Av(e.type)?Oxt:Nv(e.type)?zxt:Bxt)(t,n,i)}function Oxt(t,e,n){const r=Rxt(t.sort,!0);let i,a;const o=n.map((t=>{const n=e.getData(t.data);return n||Nxt(t.data),n.countsRef(e,t.field,r)})),s={groupby:Dbt,pulse:o};r&&(i=r.op||"count",a=r.field?Mbt(i,r.field):"count",s.ops=[Axt[i]],s.fields=[e.fieldRef(a)],s.as=[a]),i=e.add($bt(s));const c=e.add(Jbt({pulse:Tbt(i)}));return a=e.add(_xt({field:Dbt,sort:e.sortRef(r),pulse:Tbt(c)})),Tbt(a)}function Rxt(t,e){return t&&(t.field||t.op?t.field||"count"===t.op?e&&t.field&&t.op&&!Axt[t.op]&&qe("Multiple domain scales can not be sorted using "+t.op):qe("No field provided for sort aggregate op: "+t.op):sn(t)?t.field="key":t={field:"key"}),t}function zxt(t,e,n){const r=n.map((t=>{const n=e.getData(t.data);return n||Nxt(t.data),n.domainRef(e,t.field)}));return Tbt(e.add(hxt({values:r})))}function Bxt(t,e,n){const r=n.map((t=>{const n=e.getData(t.data);return n||Nxt(t.data),n.extentRef(e,t.field)}));return Tbt(e.add(lxt({extents:r})))}function Lxt(t,e,n){const r=e.config.range;let i=t.range;if(i.signal)return e.signalRef(i.signal);if(qn(i)){if(r&&Bn(r,i))return Lxt(t=On({},t,{range:r[i]}),e,n);"width"===i?i=[0,{signal:"width"}]:"height"===i?i=Av(t.type)?[0,{signal:"height"}]:[{signal:"height"},0]:qe("Unrecognized scale range value: "+Xn(i))}else{if(i.scheme)return n.scheme=on(i.scheme)?Txt(i.scheme,e):Ext(i.scheme,e),i.extent&&(n.schemeExtent=Txt(i.extent,e)),void(i.count&&(n.schemeCount=Ext(i.count,e)));if(i.step)return void(n.rangeStep=Ext(i.step,e));if(Av(t.type)&&!on(i))return Dxt(i,t,e);on(i)||qe("Unsupported range type: "+Xn(i))}return i.map((t=>(on(t)?Txt:Ext)(t,e)))}function Pxt(t,e,n){return on(t)?t.map((t=>Pxt(t,e,n))):sn(t)?t.signal?n.signalRef(t.signal):"fit"===e?t:qe("Unsupported parameter object: "+Xn(t)):t}const jxt="top",Uxt="left",Wxt="right",Vxt="bottom",qxt="center",Gxt="vertical",Hxt="start",Yxt="end",Xxt="index",Kxt="label",$xt="offset",Zxt="perc",Qxt="perc2",Jxt="value",twt="guide-label",ewt="guide-title",nwt="group-title",rwt="group-subtitle",iwt="symbol",awt="gradient",owt="discrete",swt="size",cwt=[swt,"shape","fill","stroke","strokeWidth","strokeDash","opacity"],uwt={name:1,style:1,interactive:1},lwt={value:0},hwt={value:1},dwt="group",fwt="rect",pwt="rule",gwt="symbol",mwt="text";function ywt(t){return t.type=dwt,t.interactive=t.interactive||!1,t}function vwt(t,e){const n=(n,r)=>Lbt(t[n],Lbt(e[n],r));return n.isVertical=n=>Gxt===Lbt(t.direction,e.direction||(n?e.symbolDirection:e.gradientDirection)),n.gradientLength=()=>Lbt(t.gradientLength,e.gradientLength||e.gradientWidth),n.gradientThickness=()=>Lbt(t.gradientThickness,e.gradientThickness||e.gradientHeight),n.entryColumns=()=>Lbt(t.columns,Lbt(e.columns,+n.isVertical(!0))),n}function bwt(t,e){const n=e&&(e.update&&e.update[t]||e.enter&&e.enter[t]);return n&&n.signal?n:n?n.value:null}function xwt(t,e,n){return"item.anchor === '".concat(Hxt,"' ? ").concat(t," : item.anchor === '").concat(Yxt,"' ? ").concat(e," : ").concat(n)}const wwt=xwt(Xn(Uxt),Xn(Wxt),Xn(qxt));function kwt(t,e){return e?t?sn(t)?Object.assign({},t,{offset:kwt(t.offset,e)}):{value:t,offset:e}:e:t}function _wt(t,e){return e?(t.name=e.name,t.style=e.style||t.style,t.interactive=!!e.interactive,t.encode=qvt(t.encode,e,uwt)):t.interactive=!1,t}function Swt(t,e,n,r){const i=vwt(t,n),a=i.isVertical(),o=i.gradientThickness(),s=i.gradientLength();let c,u,l,h,d;a?(u=[0,1],l=[0,0],h=o,d=s):(u=[0,0],l=[1,0],h=s,d=o);const f={enter:c={opacity:lwt,x:lwt,y:lwt,width:Uvt(h),height:Uvt(d)},update:On({},c,{opacity:hwt,fill:{gradient:e,start:u,stop:l}}),exit:{opacity:lwt}};return Vvt(f,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),_wt({type:fwt,role:ibt,encode:f},r)}function Awt(t,e,n,r,i){const a=vwt(t,n),o=a.isVertical(),s=a.gradientThickness(),c=a.gradientLength();let u,l,h,d,f="";o?(u="y",h="y2",l="x",d="width",f="1-"):(u="x",h="x2",l="y",d="height");const p={opacity:lwt,fill:{scale:e,field:Jxt}};p[u]={signal:f+"datum."+Zxt,mult:c},p[l]=lwt,p[h]={signal:f+"datum."+Qxt,mult:c},p[d]=Uvt(s);const g={enter:p,update:On({},p,{opacity:hwt}),exit:{opacity:lwt}};return Vvt(g,{stroke:a("gradientStrokeColor"),strokeWidth:a("gradientStrokeWidth")},{opacity:a("gradientOpacity")}),_wt({type:fwt,role:nbt,key:Jxt,from:i,encode:g},r)}const Cwt="datum.".concat(Zxt,'<=0?"').concat(Uxt,'":datum.').concat(Zxt,'>=1?"').concat(Wxt,'":"').concat(qxt,'"'),Ewt="datum.".concat(Zxt,'<=0?"').concat(Vxt,'":datum.').concat(Zxt,'>=1?"').concat(jxt,'":"').concat("middle",'"');function Twt(t,e,n,r){const i=vwt(t,e),a=i.isVertical(),o=Uvt(i.gradientThickness()),s=i.gradientLength();let c,u,l,h,d=i("labelOverlap"),f="";const p={enter:c={opacity:lwt},update:u={opacity:hwt,text:{field:Kxt}},exit:{opacity:lwt}};return Vvt(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:Lbt(t.labelLimit,e.gradientLabelLimit)}),a?(c.align={value:"left"},c.baseline=u.baseline={signal:Ewt},l="y",h="x",f="1-"):(c.align=u.align={signal:Cwt},c.baseline={value:"top"},l="x",h="y"),c[l]=u[l]={signal:f+"datum."+Zxt,mult:s},c[h]=u[h]=o,o.offset=Lbt(t.labelOffset,e.gradientLabelOffset)||0,d=d?{separation:i("labelSeparation"),method:d,order:"datum."+Xxt}:void 0,_wt({type:mwt,role:abt,style:twt,key:Jxt,from:r,encode:p,overlap:d},n)}function Nwt(t,e,n,r,i){const a=vwt(t,e),o=n.entries,s=!(!o||!o.interactive),c=o?o.name:void 0,u=a("clipHeight"),l=a("symbolOffset"),h={data:"value"},d="(".concat(i,") ? datum.").concat($xt," : datum.").concat(swt),f=u?Uvt(u):{field:swt},p="datum.".concat(Xxt),g="max(1, ".concat(i,")");let m,y,v,b,x;f.mult=.5,m={enter:y={opacity:lwt,x:{signal:d,mult:.5,offset:l},y:f},update:v={opacity:hwt,x:y.x,y:y.y},exit:{opacity:lwt}};let w=null,k=null;t.fill||(w=e.symbolBaseFillColor,k=e.symbolBaseStrokeColor),Vvt(m,{fill:a("symbolFillColor",w),shape:a("symbolType"),size:a("symbolSize"),stroke:a("symbolStrokeColor",k),strokeDash:a("symbolDash"),strokeDashOffset:a("symbolDashOffset"),strokeWidth:a("symbolStrokeWidth")},{opacity:a("symbolOpacity")}),cwt.forEach((e=>{t[e]&&(v[e]=y[e]={scale:t[e],field:Jxt})}));const _=_wt({type:gwt,role:obt,key:Jxt,from:h,clip:!!u||void 0,encode:m},n.symbols),S=Uvt(l);S.offset=a("labelOffset"),m={enter:y={opacity:lwt,x:{signal:d,offset:S},y:f},update:v={opacity:hwt,text:{field:Kxt},x:y.x,y:y.y},exit:{opacity:lwt}},Vvt(m,{align:a("labelAlign"),baseline:a("labelBaseline"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontStyle:a("labelFontStyle"),fontWeight:a("labelFontWeight"),limit:a("labelLimit")});const A=_wt({type:mwt,role:abt,style:twt,key:Jxt,from:h,encode:m},n.labels);return m={enter:{noBound:{value:!u},width:lwt,height:u?Uvt(u):lwt,opacity:lwt},exit:{opacity:lwt},update:v={opacity:hwt,row:{signal:null},column:{signal:null}}},a.isVertical(!0)?(b="ceil(item.mark.items.length / ".concat(g,")"),v.row.signal="".concat(p,"%").concat(b),v.column.signal="floor(".concat(p," / ").concat(b,")"),x={field:["row",p]}):(v.row.signal="floor(".concat(p," / ").concat(g,")"),v.column.signal="".concat(p," % ").concat(g),x={field:p}),v.column.signal="(".concat(i,")?").concat(v.column.signal,":").concat(p),ywt({role:Xvt,from:r={facet:{data:r,name:"value",groupby:Xxt}},encode:qvt(m,o,uwt),marks:[_,A],name:c,interactive:s,sort:x})}const Dwt='item.orient === "left"',Fwt='item.orient === "right"',Iwt="(".concat(Dwt," || ").concat(Fwt,")"),Mwt="datum.vgrad && ".concat(Iwt),Owt=xwt('"top"','"bottom"','"middle"'),Rwt=xwt('"right"','"left"','"center"'),zwt="datum.vgrad && ".concat(Fwt," ? (").concat(Rwt,") : (").concat(Iwt," && !(datum.vgrad && ").concat(Dwt,')) ? "left" : ').concat(wwt),Bwt="item._anchor || (".concat(Iwt,' ? "middle" : "start")'),Lwt="".concat(Mwt," ? (").concat(Dwt," ? -90 : 90) : 0"),Pwt="".concat(Iwt," ? (datum.vgrad ? (").concat(Fwt,' ? "bottom" : "top") : ').concat(Owt,') : "top"');function jwt(t,e){let n;return sn(t)&&(t.signal?n=t.signal:t.path?n="pathShape("+Uwt(t.path)+")":t.sphere&&(n="geoShape("+Uwt(t.sphere)+', {type: "Sphere"})')),n?e.signalRef(n):!!t}function Uwt(t){return sn(t)&&t.signal?t.signal:Xn(t)}function Wwt(t){const e=t.role||"";return e.indexOf("axis")&&e.indexOf("legend")&&e.indexOf("title")?t.type===dwt?Xvt:e||Hvt:e}function Vwt(t){return{marktype:t.type,name:t.name||void 0,role:t.role||Wwt(t),zindex:+t.zindex||void 0,aria:t.aria,description:t.description}}function qwt(t,e){return t&&t.signal?e.signalRef(t.signal):!1!==t}function Gwt(t,e){const n=Oc(t.type);n||qe("Unrecognized transform type: "+Xn(t.type));const r=Cbt(n.type.toLowerCase(),null,Hwt(n,t,e));return t.signal&&e.addSignal(t.signal,e.proxy(r)),r.metadata=n.metadata||{},r}function Hwt(t,e,n){const r={},i=t.params.length;for(let a=0;a<i;++a){const i=t.params[a];r[i.name]=Ywt(i,e,n)}return r}function Ywt(t,e,n){const r=t.type,i=e[t.name];return"index"===r?function(t,e,n){qn(e.from)||qe('Lookup "from" parameter must be a string literal.');return n.getData(e.from).lookupRef(n,e.key)}(0,e,n):void 0!==i?"param"===r?function(t,e,n){const r=e[t.name];return t.array?(on(r)||qe("Expected an array of sub-parameters. Instead: "+Xn(r)),r.map((e=>Kwt(t,e,n)))):Kwt(t,r,n)}(t,e,n):"projection"===r?n.projectionRef(e[t.name]):t.array&&!zbt(i)?i.map((e=>Xwt(t,e,n))):Xwt(t,i,n):void(t.required&&qe("Missing required "+Xn(e.type)+" parameter: "+Xn(t.name)))}function Xwt(t,e,n){const r=t.type;if(zbt(e))return Jwt(r)?qe("Expression references can not be signals."):tkt(r)?n.fieldRef(e):ekt(r)?n.compareRef(e):n.signalRef(e.signal);{const i=t.expr||tkt(r);return i&&$wt(e)?n.exprRef(e.expr,e.as):i&&Zwt(e)?Nbt(e.field,e.as):Jwt(r)?ant(e,n):Qwt(r)?Tbt(n.getData(e).values):tkt(r)?Nbt(e):ekt(r)?n.compareRef(e):e}}function Kwt(t,e,n){const r=t.params.length;let i;for(let o=0;o<r;++o){i=t.params[o];for(const t in i.key)if(i.key[t]!==e[t]){i=null;break}if(i)break}i||qe("Unsupported parameter: "+Xn(e));const a=On(Hwt(i,e,n),i.key);return Tbt(n.add(fxt(a)))}const $wt=t=>t&&t.expr,Zwt=t=>t&&t.field,Qwt=t=>"data"===t,Jwt=t=>"expr"===t,tkt=t=>"field"===t,ekt=t=>"compare"===t;function nkt(t,e){return t.$ref?t:t.data&&t.data.$ref?t.data:Tbt(e.getData(t.data).output)}function rkt(t,e,n,r,i){this.scope=t,this.input=e,this.output=n,this.values=r,this.aggregate=i,this.index={}}function ikt(t){return qn(t)?t:null}function akt(t,e,n){const r=Mbt(n.op,n.field);let i;if(e.ops){for(let a=0,o=e.as.length;a<o;++a)if(e.as[a]===r)return}else e.ops=["count"],e.fields=[null],e.as=["count"];n.op&&(e.ops.push((i=n.op.signal)?t.signalRef(i):n.op),e.fields.push(t.fieldRef(n.field)),e.as.push(r))}function okt(t,e,n,r,i,a,o){const s=e[n]||(e[n]={}),c=function(t){return sn(t)?(t.order===Ibt?"-":"+")+Mbt(t.op,t.field):""}(a);let u,l,h=ikt(i);if(null!=h&&(t=e.scope,h+=c?"|"+c:"",u=s[h]),!u){const n=a?{field:Dbt,pulse:e.countsRef(t,i,a)}:{field:t.fieldRef(i),pulse:Tbt(e.output)};c&&(n.sort=t.sortRef(a)),l=t.add(Cbt(r,void 0,n)),o&&(e.index[i]=l),u=Tbt(l),null!=h&&(s[h]=u)}return u}function skt(t,e,n){const r=t.remove,i=t.insert,a=t.toggle,o=t.modify,s=t.values,c=e.add(Ebt()),u=ant("if("+t.trigger+',modify("'+n+'",'+[i,r,a,o,s].map((t=>null==t?"null":t)).join(",")+"),0)",e);c.update=u.$expr,c.params=u.$params}function ckt(t,e){const n=Wwt(t),r=t.type===dwt,i=t.from&&t.from.facet,a=t.overlap;let o,s,c,u,l,h,d,f=t.layout||n===Xvt||n===Yvt;const p=n===Hvt||f||i,g=function(t,e,n){let r,i,a,o,s;return t?(r=t.facet)&&(e||qe("Only group marks can be faceted."),null!=r.field?o=s=nkt(r,n):(t.data?s=Tbt(n.getData(t.data).aggregate):(a=Gwt(On({type:"aggregate",groupby:Sn(r.groupby)},r.aggregate),n),a.params.key=n.keyRef(r.groupby),a.params.pulse=nkt(r,n),o=s=Tbt(n.add(a))),i=n.keyRef(r.groupby,!0))):o=Tbt(n.add(Jbt(null,[{}]))),o||(o=nkt(t,n)),{key:i,pulse:o,parent:s}}(t.from,r,e);s=e.add(ext({key:g.key||(t.key?Nbt(t.key):void 0),pulse:g.pulse,clean:!r}));const m=Tbt(s);s=c=e.add(Jbt({pulse:m})),s=e.add(uxt({markdef:Vwt(t),interactive:qwt(t.interactive,e),clip:jwt(t.clip,e),context:{$context:!0},groups:e.lookup(),parent:e.signals.parent?e.signalRef("parent"):null,index:e.markpath(),pulse:Tbt(s)}));const y=Tbt(s);s=u=e.add(nxt(vbt(t.encode,t.type,n,t.style,e,{mod:!1,pulse:y}))),s.params.parent=e.encode(),t.transform&&t.transform.forEach((t=>{const n=Gwt(t,e),r=n.metadata;(r.generates||r.changes)&&qe("Mark transforms should not generate new data."),r.nomod||(u.params.mod=!0),n.params.pulse=Tbt(s),e.add(s=n)})),t.sort&&(s=e.add(wxt({sort:e.compareRef(t.sort),pulse:Tbt(s)})));const v=Tbt(s);(i||f)&&(f=e.add(kxt({layout:e.objectProperty(t.layout),legends:e.legends,mark:y,pulse:v})),h=Tbt(f));const b=e.add(Qbt({mark:y,pulse:h||v}));d=Tbt(b),r&&(p&&(o=e.operators,o.pop(),f&&o.pop()),e.pushState(v,h||d,m),i?function(t,e,n){const r=t.from.facet,i=r.name,a=nkt(r,e);let o;r.name||qe("Facet must have a name: "+Xn(r)),r.data||qe("Facet must reference a data set: "+Xn(r)),r.field?o=e.add(pxt({field:e.fieldRef(r.field),pulse:a})):r.groupby?o=e.add(ixt({key:e.keyRef(r.groupby),group:Tbt(e.proxy(n.parent)),pulse:a})):qe("Facet must specify groupby or field: "+Xn(r));const s=e.fork(),c=s.add(Jbt()),u=s.add(xxt({pulse:Tbt(c)}));s.addData(i,new rkt(s,c,c,u)),s.addSignal("parent",null),o.params.subflow={$subflow:s.parse(t).toRuntime()}}(t,e,g):p?function(t,e,n){const r=e.add(pxt({pulse:n.pulse})),i=e.fork();i.add(xxt()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(t).toRuntime()}}(t,e,g):e.parse(t),e.popState(),p&&(f&&o.push(f),o.push(b))),a&&(d=function(t,e,n){const r=t.method,i=t.bound,a=t.separation,o={separation:zbt(a)?n.signalRef(a.signal):a,method:zbt(r)?n.signalRef(r.signal):r,pulse:e};t.order&&(o.sort=n.compareRef({field:t.order}));if(i){const t=i.tolerance;o.boundTolerance=zbt(t)?n.signalRef(t.signal):+t,o.boundScale=n.scaleRef(i.scale),o.boundOrient=i.orient}return Tbt(n.add(dxt(o)))}(a,d,e));const x=e.add(vxt({pulse:d})),w=e.add(xxt({pulse:Tbt(x)},void 0,e.parent()));null!=t.name&&(l=t.name,e.addData(l,new rkt(e,c,x,w)),t.on&&t.on.forEach((t=>{(t.insert||t.remove||t.toggle)&&qe("Marks only support modify triggers."),skt(t,e,l)})))}function ukt(t,e){const n=e.config.legend,r=t.encode||{},i=vwt(t,n),a=r.legend||{},o=a.name||void 0,s=a.interactive,c=a.style,u={};let l,h,d,f=0;cwt.forEach((e=>t[e]?(u[e]=t[e],f=f||t[e]):0)),f||qe("Missing valid scale for legend.");const p=function(t,e){let n=t.type||iwt;t.type||1!==function(t){return cwt.reduce(((e,n)=>e+(t[n]?1:0)),0)}(t)||!t.fill&&!t.stroke||(n=Sv(e)?awt:Cv(e)?owt:iwt);return n!==awt?n:Cv(e)?owt:awt}(t,e.scaleType(f)),g={title:null!=t.title,scales:u,type:p,vgrad:"symbol"!==p&&i.isVertical()},m=Tbt(e.add(Jbt(null,[g]))),y=Tbt(e.add(sxt(h={type:p,scale:e.scaleRef(f),count:e.objectProperty(i("tickCount")),limit:e.property(i("symbolLimit")),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)})));return p===awt?(d=[Swt(t,f,n,r.gradient),Twt(t,n,r.labels,y)],h.count=h.count||e.signalRef("max(2,2*floor((".concat(Pbt(i.gradientLength()),")/100))"))):p===owt?d=[Awt(t,f,n,r.gradient,y),Twt(t,n,r.labels,y)]:(l=function(t,e){const n=vwt(t,e);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(t,n),d=[Nwt(t,n,r,y,Pbt(l.columns))],h.size=function(t,e,n){const r=Pbt(hkt("size",t,n)),i=Pbt(hkt("strokeWidth",t,n)),a=Pbt(function(t,e,n){return bwt("fontSize",t)||function(t,e,n){const r=e.config.style[n];return r&&r[t]}("fontSize",e,n)}(n[1].encode,e,twt));return ant("max(ceil(sqrt(".concat(r,")+").concat(i,"),").concat(a,")"),e)}(t,e,d[0].marks)),d=[ywt({role:rbt,from:m,encode:{enter:{x:{value:0},y:{value:0}}},marks:d,layout:l,interactive:s})],g.title&&d.push(function(t,e,n,r){const i=vwt(t,e),a={enter:{opacity:lwt},update:{opacity:hwt,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:lwt}};return Vvt(a,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:Bwt},angle:{signal:Lwt},align:{signal:zwt},baseline:{signal:Pwt},text:t.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),_wt({type:mwt,role:sbt,style:ewt,from:r,encode:a},n)}(t,n,r.title,m)),ckt(ywt({role:ebt,from:m,encode:qvt(lkt(i,t,n),a,uwt),marks:d,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:o,interactive:s,style:c}),e)}function lkt(t,e,n){const r={enter:{},update:{}};return Vvt(r,{orient:t("orient"),offset:t("offset"),padding:t("padding"),titlePadding:t("titlePadding"),cornerRadius:t("cornerRadius"),fill:t("fillColor"),stroke:t("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:t("legendX"),y:t("legendY"),format:e.format,formatType:e.formatType}),r}function hkt(t,e,n){return e[t]?'scale("'.concat(e[t],'",datum)'):bwt(t,n[0].encode)}rkt.fromEntries=function(t,e){const n=e.length,r=e[n-1],i=e[n-2];let a=e[0],o=null,s=1;for(a&&"load"===a.type&&(a=e[1]),t.add(e[0]);s<n;++s)e[s].params.pulse=Tbt(e[s-1]),t.add(e[s]),"aggregate"===e[s].type&&(o=e[s]);return new rkt(t,a,i,r,o)},rkt.prototype={countsRef(t,e,n){const r=this,i=r.counts||(r.counts={}),a=ikt(e);let o,s,c;return null!=a&&(t=r.scope,o=i[a]),o?n&&n.field&&akt(t,o.agg.params,n):(c={groupby:t.fieldRef(e,"key"),pulse:Tbt(r.output)},n&&n.field&&akt(t,c,n),s=t.add($bt(c)),o=t.add(Jbt({pulse:Tbt(s)})),o={agg:s,ref:Tbt(o)},null!=a&&(i[a]=o)),o.ref},tuplesRef(){return Tbt(this.values)},extentRef(t,e){return okt(t,this,"extent","extent",e,!1)},domainRef(t,e){return okt(t,this,"domain","values",e,!1)},valuesRef(t,e,n){return okt(t,this,"vals","values",e,n||!0)},lookupRef(t,e){return okt(t,this,"lookup","tupleindex",e,!1)},indataRef(t,e){return okt(t,this,"indata","tupleindex",e,!0,!0)}};const dkt='item.orient==="'.concat(Uxt,'"?-90:item.orient==="').concat(Wxt,'"?90:0');function fkt(t,e){const n=vwt(t=qn(t)?{text:t}:t,e.config.title),r=t.encode||{},i=r.group||{},a=i.name||void 0,o=i.interactive,s=i.style,c=[],u=Tbt(e.add(Jbt(null,[{}])));return c.push(function(t,e,n,r){const i={value:0},a=t.text,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Vvt(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("color"),font:e("font"),fontSize:e("fontSize"),fontStyle:e("fontStyle"),fontWeight:e("fontWeight"),lineHeight:e("lineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),_wt({type:mwt,role:ubt,style:nwt,from:r,encode:o},n)}(t,n,function(t){const e=t.encode;return e&&e.title||On({name:t.name,interactive:t.interactive,style:t.style},e)}(t),u)),t.subtitle&&c.push(function(t,e,n,r){const i={value:0},a=t.subtitle,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Vvt(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("subtitleColor"),font:e("subtitleFont"),fontSize:e("subtitleFontSize"),fontStyle:e("subtitleFontStyle"),fontWeight:e("subtitleFontWeight"),lineHeight:e("subtitleLineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),_wt({type:mwt,role:lbt,style:rwt,from:r,encode:o},n)}(t,n,r.subtitle,u)),ckt(ywt({role:cbt,from:u,encode:pkt(n,i),marks:c,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:a,interactive:o,style:s}),e)}function pkt(t,e){const n={enter:{},update:{}};return Vvt(n,{orient:t("orient"),anchor:t("anchor"),align:{signal:wwt},angle:{signal:dkt},limit:t("limit"),frame:t("frame"),offset:t("offset")||0,padding:t("subtitlePadding")}),qvt(n,e,uwt)}function gkt(t,e){const n=[];t.transform&&t.transform.forEach((t=>{n.push(Gwt(t,e))})),t.on&&t.on.forEach((n=>{skt(n,e,t.name)})),e.addDataPipeline(t.name,function(t,e,n){const r=[];let i,a,o,s,c,u=null,l=!1,h=!1;t.values?zbt(t.values)||Bbt(t.format)?(r.push(ykt(e,t)),r.push(u=mkt())):r.push(u=mkt({$ingest:t.values,$format:t.format})):t.url?Bbt(t.url)||Bbt(t.format)?(r.push(ykt(e,t)),r.push(u=mkt())):r.push(u=mkt({$request:t.url,$format:t.format})):t.source&&(u=i=Sn(t.source).map((t=>Tbt(e.getData(t).output))),r.push(null));for(a=0,o=n.length;a<o;++a)s=n[a],c=s.metadata,u||c.source||r.push(u=mkt()),r.push(s),c.generates&&(h=!0),c.modifies&&!h&&(l=!0),c.source?u=s:c.changes&&(u=null);i&&(o=i.length-1,r[0]=yxt({derive:l,pulse:o?i:i[0]}),(l||o)&&r.splice(1,0,mkt()));u||r.push(mkt());return r.push(xxt({})),r}(t,e,n))}function mkt(t){const e=Jbt({},t);return e.metadata={source:!0},e}function ykt(t,e){return cxt({url:e.url?t.property(e.url):void 0,async:e.async?t.property(e.async):void 0,values:e.values?t.property(e.values):void 0,format:t.objectProperty(e.format)})}const vkt=t=>t===Vxt||t===jxt,bkt=(t,e,n)=>zbt(t)?Ckt(t.signal,e,n):t===Uxt||t===jxt?e:n,xkt=(t,e,n)=>zbt(t)?Skt(t.signal,e,n):vkt(t)?e:n,wkt=(t,e,n)=>zbt(t)?Akt(t.signal,e,n):vkt(t)?n:e,kkt=(t,e,n)=>zbt(t)?Ekt(t.signal,e,n):t===jxt?{value:e}:{value:n},_kt=(t,e,n)=>zbt(t)?Tkt(t.signal,e,n):t===Wxt?{value:e}:{value:n},Skt=(t,e,n)=>Nkt("".concat(t," === '").concat(jxt,"' || ").concat(t," === '").concat(Vxt,"'"),e,n),Akt=(t,e,n)=>Nkt("".concat(t," !== '").concat(jxt,"' && ").concat(t," !== '").concat(Vxt,"'"),e,n),Ckt=(t,e,n)=>Fkt("".concat(t," === '").concat(Uxt,"' || ").concat(t," === '").concat(jxt,"'"),e,n),Ekt=(t,e,n)=>Fkt("".concat(t," === '").concat(jxt,"'"),e,n),Tkt=(t,e,n)=>Fkt("".concat(t," === '").concat(Wxt,"'"),e,n),Nkt=(t,e,n)=>(e=null!=e?Uvt(e):e,n=null!=n?Uvt(n):n,Dkt(e)&&Dkt(n)?(e=e?e.signal||Xn(e.value):null,n=n?n.signal||Xn(n.value):null,{signal:"".concat(t," ? (").concat(e,") : (").concat(n,")")}):[On({test:t},e)].concat(n||[])),Dkt=t=>null==t||1===Object.keys(t).length,Fkt=(t,e,n)=>({signal:"".concat(t," ? (").concat(Mkt(e),") : (").concat(Mkt(n),")")}),Ikt=(t,e,n,r,i)=>({signal:(null!=r?"".concat(t," === '").concat(Uxt,"' ? (").concat(Mkt(r),") : "):"")+(null!=n?"".concat(t," === '").concat(Vxt,"' ? (").concat(Mkt(n),") : "):"")+(null!=i?"".concat(t," === '").concat(Wxt,"' ? (").concat(Mkt(i),") : "):"")+(null!=e?"".concat(t," === '").concat(jxt,"' ? (").concat(Mkt(e),") : "):"")+"(null)"}),Mkt=t=>zbt(t)?t.signal:null==t?null:Xn(t),Okt=(t,e)=>0===e?0:zbt(t)?{signal:"(".concat(t.signal,") * ").concat(e)}:{value:t*e},Rkt=(t,e)=>{const n=t.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+e.signal}:t};function zkt(t,e,n,r){let i;if(e&&Bn(e,t))return e[t];if(Bn(n,t))return n[t];if(t.startsWith("title")){switch(t){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=t[5].toLowerCase()+t.slice(6)}return r[ewt][i]}if(t.startsWith("label")){switch(t){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=t[5].toLowerCase()+t.slice(6)}return r[twt][i]}return null}function Bkt(t){const e={};for(const n of t)if(n)for(const t in n)e[t]=1;return Object.keys(e)}function Lkt(t,e){return{scale:t.scale,range:e}}function Pkt(t,e,n,r,i){const a=vwt(t,e),o=t.orient,s=t.gridScale,c=bkt(o,1,-1),u=function(t,e){if(1===e);else if(sn(t)){let n=t=On({},t);for(;null!=n.mult;){if(!sn(n.mult))return n.mult=zbt(e)?{signal:"(".concat(n.mult,") * (").concat(e.signal,")")}:n.mult*e,t;n=n.mult=On({},n.mult)}n.mult=e}else t=zbt(e)?{signal:"(".concat(e.signal,") * (").concat(t||0,")")}:e*(t||0);return t}(t.offset,c);let l,h,d;const f={enter:l={opacity:lwt},update:d={opacity:hwt},exit:h={opacity:lwt}};Vvt(f,{stroke:a("gridColor"),strokeCap:a("gridCap"),strokeDash:a("gridDash"),strokeDashOffset:a("gridDashOffset"),strokeOpacity:a("gridOpacity"),strokeWidth:a("gridWidth")});const p={scale:t.scale,field:Jxt,band:i.band,extra:i.extra,offset:i.offset,round:a("tickRound")},g=xkt(o,{signal:"height"},{signal:"width"}),m=s?{scale:s,range:0,mult:c,offset:u}:{value:0,offset:u},y=s?{scale:s,range:1,mult:c,offset:u}:On(g,{mult:c,offset:u});return l.x=d.x=xkt(o,p,m),l.y=d.y=wkt(o,p,m),l.x2=d.x2=wkt(o,y),l.y2=d.y2=xkt(o,y),h.x=xkt(o,p),h.y=wkt(o,p),_wt({type:pwt,role:Zvt,key:Jxt,from:r,encode:f},n)}function jkt(t,e,n,r,i){return{signal:'flush(range("'+t+'"), scale("'+t+'", datum.value), '+e+","+n+","+r+","+i+")"}}function Ukt(t,e,n,r){const i=vwt(t,e),a=t.orient,o=bkt(a,-1,1);let s,c;const u={enter:s={opacity:lwt,anchor:Uvt(i("titleAnchor",null)),align:{signal:wwt}},update:c=On({},s,{opacity:hwt,text:Uvt(t.title)}),exit:{opacity:lwt}},l={signal:'lerp(range("'.concat(t.scale,'"), ').concat(xwt(0,1,.5),")")};return c.x=xkt(a,l),c.y=wkt(a,l),s.angle=xkt(a,lwt,Okt(o,90)),s.baseline=xkt(a,kkt(a,Vxt,jxt),{value:Vxt}),c.angle=s.angle,c.baseline=s.baseline,Vvt(u,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),function(t,e,n,r){const i=(t,e)=>null!=t?(n.update[e]=Rkt(Uvt(t),n.update[e]),!1):!Gvt(e,r),a=i(t("titleX"),"x"),o=i(t("titleY"),"y");n.enter.auto=o===a?Uvt(o):xkt(e,Uvt(o),Uvt(a))}(i,a,u,n),u.update.align=Rkt(u.update.align,s.align),u.update.angle=Rkt(u.update.angle,s.angle),u.update.baseline=Rkt(u.update.baseline,s.baseline),_wt({type:mwt,role:tbt,style:ewt,from:r,encode:u},n)}function Wkt(t,e){const n=function(t,e){var n,r,i,a=e.config,o=a.style,s=a.axis,c="band"===e.scaleType(t.scale)&&a.axisBand,u=t.orient;if(zbt(u)){const t=Bkt([a.axisX,a.axisY]),e=Bkt([a.axisTop,a.axisBottom,a.axisLeft,a.axisRight]);for(i of(n={},t))n[i]=xkt(u,zkt(i,a.axisX,s,o),zkt(i,a.axisY,s,o));for(i of(r={},e))r[i]=Ikt(u.signal,zkt(i,a.axisTop,s,o),zkt(i,a.axisBottom,s,o),zkt(i,a.axisLeft,s,o),zkt(i,a.axisRight,s,o))}else n=u===jxt||u===Vxt?a.axisX:a.axisY,r=a["axis"+u[0].toUpperCase()+u.slice(1)];return n||r||c?On({},s,n,r,c):s}(t,e),r=t.encode||{},i=r.axis||{},a=i.name||void 0,o=i.interactive,s=i.style,c=vwt(t,n),u=function(t){const e=t("tickBand");let n,r,i=t("tickOffset");return e?e.signal?(n={signal:"(".concat(e.signal,") === 'extent' ? 1 : 0.5")},r={signal:"(".concat(e.signal,") === 'extent'")},sn(i)||(i={signal:"(".concat(e.signal,") === 'extent' ? 0 : ").concat(i)})):"extent"===e?(n=1,r=!0,i=0):(n=.5,r=!1):(n=t("bandPosition"),r=t("tickExtra")),{extra:r,band:n,offset:i}}(c),l={scale:t.scale,ticks:!!c("ticks"),labels:!!c("labels"),grid:!!c("grid"),domain:!!c("domain"),title:null!=t.title},h=Tbt(e.add(Jbt({},[l]))),d=Tbt(e.add(Zbt({scale:e.scaleRef(t.scale),extra:e.property(u.extra),count:e.objectProperty(t.tickCount),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)}))),f=[];let p;return l.grid&&f.push(Pkt(t,n,r.grid,d,u)),l.ticks&&(p=c("tickSize"),f.push(function(t,e,n,r,i,a){const o=vwt(t,e),s=t.orient,c=bkt(s,-1,1);let u,l,h;const d={enter:u={opacity:lwt},update:h={opacity:hwt},exit:l={opacity:lwt}};Vvt(d,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});const f=Uvt(i);f.mult=c;const p={scale:t.scale,field:Jxt,band:a.band,extra:a.extra,offset:a.offset,round:o("tickRound")};return h.y=u.y=xkt(s,lwt,p),h.y2=u.y2=xkt(s,f),l.x=xkt(s,p),h.x=u.x=wkt(s,lwt,p),h.x2=u.x2=wkt(s,f),l.y=wkt(s,p),_wt({type:pwt,role:Jvt,key:Jxt,from:r,encode:d},n)}(t,n,r.ticks,d,p,u))),l.labels&&(p=l.ticks?p:0,f.push(function(t,e,n,r,i,a){const o=vwt(t,e),s=t.orient,c=t.scale,u=bkt(s,-1,1),l=Pbt(o("labelFlush")),h=Pbt(o("labelFlushOffset")),d=o("labelAlign"),f=o("labelBaseline");let p,g=0===l||!!l;const m=Uvt(i);m.mult=u,m.offset=Uvt(o("labelPadding")||0),m.offset.mult=u;const y={scale:c,field:Jxt,band:.5,offset:kwt(a.offset,o("labelOffset"))},v=xkt(s,g?jkt(c,l,'"left"','"right"','"center"'):{value:"center"},_kt(s,"left","right")),b=xkt(s,kkt(s,"bottom","top"),g?jkt(c,l,'"top"','"bottom"','"middle"'):{value:"middle"}),x=jkt(c,l,"-(".concat(h,")"),h,0);g=g&&h;const w={opacity:lwt,x:xkt(s,y,m),y:wkt(s,y,m)},k={enter:w,update:p={opacity:hwt,text:{field:Kxt},x:w.x,y:w.y,align:v,baseline:b},exit:{opacity:lwt,x:w.x,y:w.y}};Vvt(k,{dx:!d&&g?xkt(s,x):null,dy:!f&&g?wkt(s,x):null}),Vvt(k,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:d,baseline:f});const _=o("labelBound");let S=o("labelOverlap");return S=S||_?{separation:o("labelSeparation"),method:S,order:"datum.index",bound:_?{scale:c,orient:s,tolerance:_}:null}:void 0,p.align!==v&&(p.align=Rkt(p.align,v)),p.baseline!==b&&(p.baseline=Rkt(p.baseline,b)),_wt({type:mwt,role:Qvt,style:twt,key:Jxt,from:r,encode:k,overlap:S},n)}(t,n,r.labels,d,p,u))),l.domain&&f.push(function(t,e,n,r){const i=vwt(t,e),a=t.orient;let o,s;const c={enter:o={opacity:lwt},update:s={opacity:hwt},exit:{opacity:lwt}};Vvt(c,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const u=Lkt(t,0),l=Lkt(t,1);return o.x=s.x=xkt(a,u,lwt),o.x2=s.x2=xkt(a,l),o.y=s.y=wkt(a,u,lwt),o.y2=s.y2=wkt(a,l),_wt({type:pwt,role:$vt,from:r,encode:c},n)}(t,n,r.domain,h)),l.title&&f.push(Ukt(t,n,r.title,h)),ckt(ywt({role:Kvt,from:h,encode:qvt(Vkt(c,t),i,uwt),marks:f,aria:c("aria"),description:c("description"),zindex:c("zindex"),name:a,interactive:o,style:s}),e)}function Vkt(t,e){const n={enter:{},update:{}};return Vvt(n,{orient:t("orient"),offset:t("offset")||0,position:Lbt(e.position,0),titlePadding:t("titlePadding"),minExtent:t("minExtent"),maxExtent:t("maxExtent"),range:{signal:'abs(span(range("'.concat(e.scale,'")))')},translate:t("translate"),format:e.format,formatType:e.formatType}),n}function qkt(t,e,n){const r=Sn(t.signals),i=Sn(t.scales);return n||r.forEach((t=>Sbt(t,e))),Sn(t.projections).forEach((t=>function(t,e){const n=e.config.projection||{},r={};for(const i in t)"name"!==i&&(r[i]=Pxt(t[i],i,e));for(const i in n)null==r[i]&&(r[i]=Pxt(n[i],i,e));e.addProjection(t.name,r)}(t,e))),i.forEach((t=>function(t,e){const n=t.type||"linear";kv(n)||qe("Unrecognized scale type: "+Xn(n)),e.addScale(t.name,{type:n,domain:void 0})}(t,e))),Sn(t.data).forEach((t=>gkt(t,e))),i.forEach((t=>Cxt(t,e))),(n||r).forEach((t=>function(t,e){const n=e.getSignal(t.name);let r=t.update;t.init&&(r?qe("Signals can not include both init and update expressions."):(r=t.init,n.initonly=!0)),r&&(r=ant(r,e),n.update=r.$expr,n.params=r.$params),t.on&&t.on.forEach((t=>Ybt(t,e,n.id)))}(t,e))),Sn(t.axes).forEach((t=>Wkt(t,e))),Sn(t.marks).forEach((t=>ckt(t,e))),Sn(t.legends).forEach((t=>ukt(t,e))),t.title&&fkt(t.title,e),e.parseLambdas(),e}const Gkt=t=>qvt({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},t);function Hkt(t,e){const n=e.config,r=Tbt(e.root=e.add(Ebt())),i=function(t,e){const n=n=>Lbt(t[n],e[n]),r=[Ykt("background",n("background")),Ykt("autosize",Bvt(n("autosize"))),Ykt("padding",jvt(n("padding"))),Ykt("width",n("width")||0),Ykt("height",n("height")||0)],i=r.reduce(((t,e)=>(t[e.name]=e,t)),{}),a={};return Sn(t.signals).forEach((t=>{Bn(i,t.name)?t=On(i[t.name],t):r.push(t),a[t.name]=t})),Sn(e.signals).forEach((t=>{Bn(a,t.name)||Bn(i,t.name)||r.push(t)})),r}(t,n);i.forEach((t=>Sbt(t,e))),e.description=t.description||n.description,e.eventConfig=n.events,e.legends=e.objectProperty(n.legend&&n.legend.layout),e.locale=n.locale;const a=e.add(Jbt()),o=e.add(nxt(vbt(Gkt(t.encode),dwt,Yvt,t.style,e,{pulse:Tbt(a)}))),s=e.add(kxt({layout:e.objectProperty(t.layout),legends:e.legends,autosize:e.signalRef("autosize"),mark:r,pulse:Tbt(o)}));e.operators.pop(),e.pushState(Tbt(o),Tbt(s),null),qkt(t,e,i),e.operators.push(s);let c=e.add(Qbt({mark:r,pulse:Tbt(s)}));return c=e.add(vxt({pulse:Tbt(c)})),c=e.add(xxt({pulse:Tbt(c)})),e.addData("root",new rkt(e,a,a,c)),e}function Ykt(t,e){return e&&e.signal?{name:t,update:e.signal}:{name:t,value:e}}function Xkt(t,e){this.config=t||{},this.options=e||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function Kkt(t){this.config=t.config,this.options=t.options,this.legends=t.legends,this.field=Object.create(t.field),this.signals=Object.create(t.signals),this.lambdas=Object.create(t.lambdas),this.scales=Object.create(t.scales),this.events=Object.create(t.events),this.data=Object.create(t.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++t._nextsub[0],this._nextsub=t._nextsub,this._parent=t._parent.slice(),this._encode=t._encode.slice(),this._lookup=t._lookup.slice(),this._markpath=t._markpath}function $kt(t){return(on(t)?Zkt:Qkt)(t)}function Zkt(t){const e=t.length;let n="[";for(let r=0;r<e;++r){const e=t[r];n+=(r>0?",":"")+(sn(e)?e.signal||$kt(e):Xn(e))}return n+"]"}function Qkt(t){let e,n,r="{",i=0;for(e in t)n=t[e],r+=(++i>1?",":"")+Xn(e)+":"+(sn(n)?n.signal||$kt(n):Xn(n));return r+"}"}function Jkt(t,e,n){return sn(t)||qe("Input Vega specification must be an object."),e=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(((t,e)=>{for(const n in e)if("signals"===n)t.signals=ln(t.signals,e.signals);else{const r="legend"===n?{layout:1}:"style"===n||null;un(t,n,e[n],r)}return t}),{})}(function(){const t="sans-serif",e="#4c78a8",n="#000",r="#888",i="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:e},area:{fill:e},image:null,line:{stroke:e,strokeWidth:2},path:{stroke:e},rect:{fill:e},rule:{stroke:n},shape:{stroke:e},symbol:{fill:e,size:64},text:{fill:n,font:t,fontSize:11},trail:{fill:e,size:2},style:{"guide-label":{fill:n,font:t,fontSize:10},"guide-title":{fill:n,font:t,fontSize:11,fontWeight:"bold"},"group-title":{fill:n,font:t,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:n,font:t,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:i}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:r,grid:!1,gridWidth:1,gridColor:i,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:r,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:i,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:r,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}(),e,t.config),Hkt(t,new Xkt(e,n)).toRuntime()}function t_t(t,e,n){return t.fields=e||[],t.fname=n,t}function e_t(t){return 1===t.length?n_t(t[0]):r_t(t)}Xkt.prototype=Kkt.prototype={parse(t){return qkt(t,this)},fork(){return new Kkt(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(t){return this.operators.push(t),t.id=this.id(),t.refs&&(t.refs.forEach((e=>{e.$ref=t.id})),t.refs=null),t},proxy(t){const e=t instanceof Abt?Tbt(t):t;return this.add(mxt({value:e}))},addStream(t){return this.streams.push(t),t.id=this.id(),t},addUpdate(t){return this.updates.push(t),t},finish(){let t,e;for(t in this.root&&(this.root.root=!0),this.signals)this.signals[t].signal=t;for(t in this.scales)this.scales[t].scale=t;function n(t,e,n){let r,i;t&&(r=t.data||(t.data={}),i=r[e]||(r[e]=[]),i.push(n))}for(t in this.data){e=this.data[t],n(e.input,t,"input"),n(e.output,t,"output"),n(e.values,t,"values");for(const r in e.index)n(e.index[r],t,"index:"+r)}return this},pushState(t,e,n){this._encode.push(Tbt(this.add(xxt({pulse:t})))),this._parent.push(e),this._lookup.push(n?Tbt(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return hn(this._parent)},encode(){return hn(this._encode)},lookup(){return hn(this._lookup)},markpath(){const t=this._markpath;return++t[t.length-1]},fieldRef(t,e){if(qn(t))return Nbt(t,e);t.signal||qe("Unsupported field reference: "+Xn(t));const n=t.signal;let r=this.field[n];if(!r){const t={name:this.signalRef(n)};e&&(t.as=e),this.field[n]=r=Tbt(this.add(axt(t)))}return r},compareRef(t){let e=!1;const n=t=>zbt(t)?(e=!0,this.signalRef(t.signal)):function(t){return t&&t.expr}(t)?(e=!0,this.exprRef(t.expr)):t,r=Sn(t.field).map(n),i=Sn(t.order).map(n);return e?Tbt(this.add(txt({fields:r,orders:i}))):Fbt(r,i)},keyRef(t,e){let n=!1;const r=this.signals;return t=Sn(t).map((t=>zbt(t)?(n=!0,Tbt(r[t.signal])):t)),n?Tbt(this.add(oxt({fields:t,flat:e}))):function(t,e){const n={$key:t};return e&&(n.$flat=!0),n}(t,e)},sortRef(t){if(!t)return t;const e=Mbt(t.op,t.field),n=t.order||"ascending";return n.signal?Tbt(this.add(txt({fields:e,orders:this.signalRef(n.signal)}))):Fbt(e,n)},event(t,e){const n=t+":"+e;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:t,type:e}),this.events[n]=r}return this.events[n]},hasOwnSignal(t){return Bn(this.signals,t)},addSignal(t,e){this.hasOwnSignal(t)&&qe("Duplicate signal name: "+Xn(t));const n=e instanceof Abt?e:this.add(Ebt(e));return this.signals[t]=n},getSignal(t){return this.signals[t]||qe("Unrecognized signal name: "+Xn(t)),this.signals[t]},signalRef(t){return this.signals[t]?Tbt(this.signals[t]):(Bn(this.lambdas,t)||(this.lambdas[t]=this.add(Ebt(null))),Tbt(this.lambdas[t]))},parseLambdas(){const t=Object.keys(this.lambdas);for(let e=0,n=t.length;e<n;++e){const n=t[e],r=ant(n,this),i=this.lambdas[n];i.params=r.$params,i.update=r.$expr}},property(t){return t&&t.signal?this.signalRef(t.signal):t},objectProperty(t){return t&&sn(t)?this.signalRef(t.signal||$kt(t)):t},exprRef(t,e){const n={expr:ant(t,this)};return e&&(n.expr.$name=e),Tbt(this.add(rxt(n)))},addBinding(t,e){this.bindings||qe("Nested signals do not support binding: "+Xn(t)),this.bindings.push(On({signal:t},e))},addScaleProj(t,e){Bn(this.scales,t)&&qe("Duplicate scale or projection name: "+Xn(t)),this.scales[t]=this.add(e)},addScale(t,e){this.addScaleProj(t,bxt(e))},addProjection(t,e){this.addScaleProj(t,gxt(e))},getScale(t){return this.scales[t]||qe("Unrecognized scale name: "+Xn(t)),this.scales[t]},scaleRef(t){return Tbt(this.getScale(t))},scaleType(t){return this.getScale(t).params.type},projectionRef(t){return this.scaleRef(t)},projectionType(t){return this.scaleType(t)},addData(t,e){return Bn(this.data,t)&&qe("Duplicate data set name: "+Xn(t)),this.data[t]=e},getData(t){return this.data[t]||qe("Undefined data set name: "+Xn(t)),this.data[t]},addDataPipeline(t,e){return Bn(this.data,t)&&qe("Duplicate data set name: "+Xn(t)),this.addData(t,rkt.fromEntries(this,e))}};const n_t=t=>function(e){return e[t]},r_t=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function i_t(t){throw Error(t)}function a_t(t){const e=[],n=t.length;let r,i,a,o=null,s=0,c="";function u(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)c+=t.substring(r,i++),r=i;else if(a===o)u(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&u(),s=r=i+1):"]"===a&&(s||i_t("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&i_t("Access path missing closing bracket: "+t),o&&i_t("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function o_t(t,e,n){const r=a_t(t);return t=1===r.length?r[0]:t,t_t((n&&n.get||e_t)(r),[t],e||t)}o_t("id"),t_t((t=>t),[],"identity"),t_t((()=>0),[],"zero"),t_t((()=>1),[],"one"),t_t((()=>!0),[],"true"),t_t((()=>!1),[],"false");Array.isArray;function s_t(t){return"function"===typeof t}const c_t=Object.prototype.hasOwnProperty;function u_t(t,e){return c_t.call(t,e)}function l_t(t){return"string"===typeof t}function h_t(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}const d_t="Property",f_t="ArrayExpression",p_t="BinaryExpression",g_t="CallExpression",m_t="ConditionalExpression",y_t="LogicalExpression",v_t="MemberExpression",b_t="ObjectExpression",x_t="UnaryExpression";function w_t(t){this.type=t}var k_t,__t,S_t,A_t,C_t;w_t.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=function(t){switch(t.type){case f_t:return t.elements;case p_t:case y_t:return[t.left,t.right];case g_t:return[t.callee].concat(t.arguments);case m_t:return[t.test,t.consequent,t.alternate];case v_t:return[t.object,t.property];case b_t:return t.properties;case d_t:return[t.key,t.value];case x_t:return[t.argument];default:return[]}}(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1};var E_t=1,T_t=2,N_t=3,D_t=4,F_t=5,I_t=6,M_t=7,O_t=8;(k_t={})[E_t]="Boolean",k_t[T_t]="<end>",k_t[N_t]="Identifier",k_t[D_t]="Keyword",k_t[F_t]="Null",k_t[I_t]="Numeric",k_t[M_t]="Punctuator",k_t[O_t]="String",k_t[9]="RegularExpression";var R_t="ArrayExpression",z_t="BinaryExpression",B_t="CallExpression",L_t="ConditionalExpression",P_t="Identifier",j_t="Literal",U_t="LogicalExpression",W_t="MemberExpression",V_t="ObjectExpression",q_t="Property",G_t="UnaryExpression",H_t="Unexpected token %0",Y_t="Unexpected number",X_t="Unexpected string",K_t="Unexpected identifier",$_t="Unexpected reserved word",Z_t="Unexpected end of input",Q_t="Invalid regular expression",J_t="Invalid regular expression: missing /",tSt="Octal literals are not allowed in strict mode.",eSt="Duplicate data property in object literal not allowed in strict mode",nSt="ILLEGAL",rSt="Disabled.",iSt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),aSt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function oSt(t,e){if(!t)throw new Error("ASSERT: "+e)}function sSt(t){return t>=48&&t<=57}function cSt(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function uSt(t){return"01234567".indexOf(t)>=0}function lSt(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function hSt(t){return 10===t||13===t||8232===t||8233===t}function dSt(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||t>=128&&iSt.test(String.fromCharCode(t))}function fSt(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||t>=128&&aSt.test(String.fromCharCode(t))}const pSt={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function gSt(){for(;S_t<A_t;){const t=__t.charCodeAt(S_t);if(!lSt(t)&&!hSt(t))break;++S_t}}function mSt(t){var e,n,r,i=0;for(n="u"===t?4:2,e=0;e<n;++e)S_t<A_t&&cSt(__t[S_t])?(r=__t[S_t++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):ISt({},H_t,nSt);return String.fromCharCode(i)}function ySt(){var t,e,n,r;for(e=0,"}"===(t=__t[S_t])&&ISt({},H_t,nSt);S_t<A_t&&cSt(t=__t[S_t++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||"}"!==t)&&ISt({},H_t,nSt),e<=65535?String.fromCharCode(e):(n=55296+(e-65536>>10),r=56320+(e-65536&1023),String.fromCharCode(n,r))}function vSt(){var t,e;for(t=__t.charCodeAt(S_t++),e=String.fromCharCode(t),92===t&&(117!==__t.charCodeAt(S_t)&&ISt({},H_t,nSt),++S_t,(t=mSt("u"))&&"\\"!==t&&dSt(t.charCodeAt(0))||ISt({},H_t,nSt),e=t);S_t<A_t&&fSt(t=__t.charCodeAt(S_t));)++S_t,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==__t.charCodeAt(S_t)&&ISt({},H_t,nSt),++S_t,(t=mSt("u"))&&"\\"!==t&&fSt(t.charCodeAt(0))||ISt({},H_t,nSt),e+=t);return e}function bSt(){var t,e;return t=S_t,e=92===__t.charCodeAt(S_t)?vSt():function(){var t,e;for(t=S_t++;S_t<A_t;){if(92===(e=__t.charCodeAt(S_t)))return S_t=t,vSt();if(!fSt(e))break;++S_t}return __t.slice(t,S_t)}(),{type:1===e.length?N_t:pSt.hasOwnProperty(e)?D_t:"null"===e?F_t:"true"===e||"false"===e?E_t:N_t,value:e,start:t,end:S_t}}function xSt(){var t,e,n,r,i=S_t,a=__t.charCodeAt(S_t),o=__t[S_t];switch(a){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++S_t,{type:M_t,value:String.fromCharCode(a),start:i,end:S_t};default:if(61===(t=__t.charCodeAt(S_t+1)))switch(a){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return S_t+=2,{type:M_t,value:String.fromCharCode(a)+String.fromCharCode(t),start:i,end:S_t};case 33:case 61:return S_t+=2,61===__t.charCodeAt(S_t)&&++S_t,{type:M_t,value:__t.slice(i,S_t),start:i,end:S_t}}}return">>>="===(r=__t.substr(S_t,4))?{type:M_t,value:r,start:i,end:S_t+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:M_t,value:n,start:i,end:S_t+=3}:o===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(o)>=0||"=>"===e?{type:M_t,value:e,start:i,end:S_t+=2}:("//"===e&&ISt({},H_t,nSt),"<>=!+-*%&|^/".indexOf(o)>=0?(++S_t,{type:M_t,value:o,start:i,end:S_t}):void ISt({},H_t,nSt))}function wSt(){var t,e,n;if(oSt(sSt((n=__t[S_t]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),e=S_t,t="","."!==n){if(t=__t[S_t++],n=__t[S_t],"0"===t){if("x"===n||"X"===n)return++S_t,function(t){let e="";for(;S_t<A_t&&cSt(__t[S_t]);)e+=__t[S_t++];return 0===e.length&&ISt({},H_t,nSt),dSt(__t.charCodeAt(S_t))&&ISt({},H_t,nSt),{type:I_t,value:parseInt("0x"+e,16),start:t,end:S_t}}(e);if(uSt(n))return function(t){let e="0"+__t[S_t++];for(;S_t<A_t&&uSt(__t[S_t]);)e+=__t[S_t++];return(dSt(__t.charCodeAt(S_t))||sSt(__t.charCodeAt(S_t)))&&ISt({},H_t,nSt),{type:I_t,value:parseInt(e,8),octal:!0,start:t,end:S_t}}(e);n&&sSt(n.charCodeAt(0))&&ISt({},H_t,nSt)}for(;sSt(__t.charCodeAt(S_t));)t+=__t[S_t++];n=__t[S_t]}if("."===n){for(t+=__t[S_t++];sSt(__t.charCodeAt(S_t));)t+=__t[S_t++];n=__t[S_t]}if("e"===n||"E"===n)if(t+=__t[S_t++],"+"!==(n=__t[S_t])&&"-"!==n||(t+=__t[S_t++]),sSt(__t.charCodeAt(S_t)))for(;sSt(__t.charCodeAt(S_t));)t+=__t[S_t++];else ISt({},H_t,nSt);return dSt(__t.charCodeAt(S_t))&&ISt({},H_t,nSt),{type:I_t,value:parseFloat(t),start:e,end:S_t}}function kSt(){var t,e,n,r;return C_t=null,gSt(),t=S_t,e=function(){var t,e,n,r;for(oSt("/"===(t=__t[S_t]),"Regular expression literal must start with a slash"),e=__t[S_t++],n=!1,r=!1;S_t<A_t;)if(e+=t=__t[S_t++],"\\"===t)hSt((t=__t[S_t++]).charCodeAt(0))&&ISt({},J_t),e+=t;else if(hSt(t.charCodeAt(0)))ISt({},J_t);else if(n)"]"===t&&(n=!1);else{if("/"===t){r=!0;break}"["===t&&(n=!0)}return r||ISt({},J_t),{value:e.substr(1,e.length-2),literal:e}}(),n=function(){var t,e,n;for(e="",n="";S_t<A_t&&fSt((t=__t[S_t]).charCodeAt(0));)++S_t,"\\"===t&&S_t<A_t?ISt({},H_t,nSt):(n+=t,e+=t);return n.search(/[^gimuy]/g)>=0&&ISt({},Q_t,n),{value:n,literal:e}}(),r=function(t,e){let n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,((t,e)=>{if(parseInt(e,16)<=1114111)return"x";ISt({},Q_t)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){ISt({},Q_t)}try{return new RegExp(t,e)}catch(i){return null}}(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:S_t}}function _St(){if(gSt(),S_t>=A_t)return{type:T_t,start:S_t,end:S_t};const t=__t.charCodeAt(S_t);return dSt(t)?bSt():40===t||41===t||59===t?xSt():39===t||34===t?function(){var t,e,n,r,i="",a=!1;for(oSt("'"===(t=__t[S_t])||'"'===t,"String literal must starts with a quote"),e=S_t,++S_t;S_t<A_t;){if((n=__t[S_t++])===t){t="";break}if("\\"===n)if((n=__t[S_t++])&&hSt(n.charCodeAt(0)))"\r"===n&&"\n"===__t[S_t]&&++S_t;else switch(n){case"u":case"x":"{"===__t[S_t]?(++S_t,i+=ySt()):i+=mSt(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:uSt(n)?(0!==(r="01234567".indexOf(n))&&(a=!0),S_t<A_t&&uSt(__t[S_t])&&(a=!0,r=8*r+"01234567".indexOf(__t[S_t++]),"0123".indexOf(n)>=0&&S_t<A_t&&uSt(__t[S_t])&&(r=8*r+"01234567".indexOf(__t[S_t++]))),i+=String.fromCharCode(r)):i+=n}else{if(hSt(n.charCodeAt(0)))break;i+=n}}return""!==t&&ISt({},H_t,nSt),{type:O_t,value:i,octal:a,start:e,end:S_t}}():46===t?sSt(__t.charCodeAt(S_t+1))?wSt():xSt():sSt(t)?wSt():xSt()}function SSt(){const t=C_t;return S_t=t.end,C_t=_St(),S_t=t.end,t}function ASt(){const t=S_t;C_t=_St(),S_t=t}function CSt(t,e,n){const r=new w_t("||"===t||"&&"===t?U_t:z_t);return r.operator=t,r.left=e,r.right=n,r}function ESt(t,e){const n=new w_t(B_t);return n.callee=t,n.arguments=e,n}function TSt(t){const e=new w_t(P_t);return e.name=t,e}function NSt(t){const e=new w_t(j_t);return e.value=t.value,e.raw=__t.slice(t.start,t.end),t.regex&&("//"===e.raw&&(e.raw="/(?:)/"),e.regex=t.regex),e}function DSt(t,e,n){const r=new w_t(W_t);return r.computed="["===t,r.object=e,r.property=n,r.computed||(n.member=!0),r}function FSt(t,e,n){const r=new w_t(q_t);return r.key=e,r.value=n,r.kind=t,r}function ISt(t,e){var n,r=Array.prototype.slice.call(arguments,2),i=e.replace(/%(\d)/g,((t,e)=>(oSt(e<r.length,"Message reference must be in range"),r[e])));throw(n=new Error(i)).index=S_t,n.description=i,n}function MSt(t){t.type===T_t&&ISt(t,Z_t),t.type===I_t&&ISt(t,Y_t),t.type===O_t&&ISt(t,X_t),t.type===N_t&&ISt(t,K_t),t.type===D_t&&ISt(t,$_t),ISt(t,H_t,t.value)}function OSt(t){const e=SSt();e.type===M_t&&e.value===t||MSt(e)}function RSt(t){return C_t.type===M_t&&C_t.value===t}function zSt(t){return C_t.type===D_t&&C_t.value===t}function BSt(){const t=[];for(S_t=C_t.start,OSt("[");!RSt("]");)RSt(",")?(SSt(),t.push(null)):(t.push(KSt()),RSt("]")||OSt(","));return SSt(),function(t){const e=new w_t(R_t);return e.elements=t,e}(t)}function LSt(){S_t=C_t.start;const t=SSt();return t.type===O_t||t.type===I_t?(t.octal&&ISt(t,tSt),NSt(t)):TSt(t.value)}function PSt(){var t,e,n;return S_t=C_t.start,(t=C_t).type===N_t?(n=LSt(),OSt(":"),FSt("init",n,KSt())):t.type!==T_t&&t.type!==M_t?(e=LSt(),OSt(":"),FSt("init",e,KSt())):void MSt(t)}function jSt(){var t,e,n=[],r={},i=String;for(S_t=C_t.start,OSt("{");!RSt("}");)e="$"+((t=PSt()).key.type===P_t?t.key.name:i(t.key.value)),Object.prototype.hasOwnProperty.call(r,e)?ISt({},eSt):r[e]=!0,n.push(t),RSt("}")||OSt(",");return OSt("}"),function(t){const e=new w_t(V_t);return e.properties=t,e}(n)}const USt={if:1};function WSt(){var t,e,n;if(RSt("("))return function(){OSt("(");const t=$St();return OSt(")"),t}();if(RSt("["))return BSt();if(RSt("{"))return jSt();if(t=C_t.type,S_t=C_t.start,t===N_t||USt[C_t.value])n=TSt(SSt().value);else if(t===O_t||t===I_t)C_t.octal&&ISt(C_t,tSt),n=NSt(SSt());else{if(t===D_t)throw new Error(rSt);t===E_t?((e=SSt()).value="true"===e.value,n=NSt(e)):t===F_t?((e=SSt()).value=null,n=NSt(e)):RSt("/")||RSt("/=")?(n=NSt(kSt()),ASt()):MSt(SSt())}return n}function VSt(){const t=[];if(OSt("("),!RSt(")"))for(;S_t<A_t&&(t.push(KSt()),!RSt(")"));)OSt(",");return OSt(")"),t}function qSt(){S_t=C_t.start;const t=SSt();return function(t){return t.type===N_t||t.type===D_t||t.type===E_t||t.type===F_t}(t)||MSt(t),TSt(t.value)}function GSt(){OSt("[");const t=$St();return OSt("]"),t}function HSt(){const t=function(){var t;for(t=WSt();;)if(RSt("."))OSt("."),t=DSt(".",t,qSt());else if(RSt("("))t=ESt(t,VSt());else{if(!RSt("["))break;t=DSt("[",t,GSt())}return t}();if(C_t.type===M_t&&(RSt("++")||RSt("--")))throw new Error(rSt);return t}function YSt(){var t,e;if(C_t.type!==M_t&&C_t.type!==D_t)e=HSt();else{if(RSt("++")||RSt("--"))throw new Error(rSt);if(RSt("+")||RSt("-")||RSt("~")||RSt("!"))t=SSt(),e=YSt(),e=function(t,e){const n=new w_t(G_t);return n.operator=t,n.argument=e,n.prefix=!0,n}(t.value,e);else{if(zSt("delete")||zSt("void")||zSt("typeof"))throw new Error(rSt);e=HSt()}}return e}function XSt(t){let e=0;if(t.type!==M_t&&t.type!==D_t)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function KSt(){var t,e;return t=function(){var t,e,n,r,i,a,o,s,c,u;if(t=C_t,c=YSt(),0===(i=XSt(r=C_t)))return c;for(r.prec=i,SSt(),e=[t,C_t],a=[c,r,o=YSt()];(i=XSt(C_t))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)o=a.pop(),s=a.pop().value,c=a.pop(),e.pop(),n=CSt(s,c,o),a.push(n);(r=SSt()).prec=i,a.push(r),e.push(C_t),n=YSt(),a.push(n)}for(n=a[u=a.length-1],e.pop();u>1;)e.pop(),n=CSt(a[u-1].value,a[u-2],n),u-=2;return n}(),RSt("?")&&(SSt(),e=KSt(),OSt(":"),t=function(t,e,n){const r=new w_t(L_t);return r.test=t,r.consequent=e,r.alternate=n,r}(t,e,KSt())),t}function $St(){const t=KSt();if(RSt(","))throw new Error(rSt);return t}function ZSt(t){S_t=0,A_t=(__t=t).length,C_t=null,ASt();const e=$St();if(C_t.type!==T_t)throw new Error("Unexpect token after expression.");return e}var QSt={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function JSt(t){function e(e,n,r){return i=>function(e,n,r,i){let a=t(n[0]);return r&&(a=r+"("+a+")",0===r.lastIndexOf("new ",0)&&(a="("+a+")")),a+"."+e+(i<0?"":0===i?"()":"("+n.slice(1).map(t).join(",")+")")}(e,i,n,r)}const n="new Date",r="String",i="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(e){e.length<3&&i_t("Missing arguments to clamp function."),e.length>3&&i_t("Too many arguments to clamp function.");const n=e.map(t);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:e("getDate",n,0),day:e("getDay",n,0),year:e("getFullYear",n,0),month:e("getMonth",n,0),hours:e("getHours",n,0),minutes:e("getMinutes",n,0),seconds:e("getSeconds",n,0),milliseconds:e("getMilliseconds",n,0),time:e("getTime",n,0),timezoneoffset:e("getTimezoneOffset",n,0),utcdate:e("getUTCDate",n,0),utcday:e("getUTCDay",n,0),utcyear:e("getUTCFullYear",n,0),utcmonth:e("getUTCMonth",n,0),utchours:e("getUTCHours",n,0),utcminutes:e("getUTCMinutes",n,0),utcseconds:e("getUTCSeconds",n,0),utcmilliseconds:e("getUTCMilliseconds",n,0),length:e("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:e("toUpperCase",r,0),lower:e("toLowerCase",r,0),substring:e("substring",r),split:e("split",r),trim:e("trim",r,0),regexp:i,test:e("test",i),if:function(e){e.length<3&&i_t("Missing arguments to if function."),e.length>3&&i_t("Too many arguments to if function.");const n=e.map(t);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}function tAt(t){const e=(t=t||{}).allowed?h_t(t.allowed):{},n=t.forbidden?h_t(t.forbidden):{},r=t.constants||QSt,i=(t.functions||JSt)(h),a=t.globalvar,o=t.fieldvar,s=s_t(a)?a:t=>"".concat(a,'["').concat(t,'"]');let c={},u={},l=0;function h(t){if(l_t(t))return t;const e=d[t.type];return null==e&&i_t("Unsupported type: "+t.type),e(t)}const d={Literal:t=>t.raw,Identifier:t=>{const i=t.name;return l>0?i:u_t(n,i)?i_t("Illegal identifier: "+i):u_t(r,i)?r[i]:u_t(e,i)?i:(c[i]=1,s(i))},MemberExpression:t=>{const e=!t.computed,n=h(t.object);e&&(l+=1);const r=h(t.property);return n===o&&(u[function(t){const e=t&&t.length-1;return e&&('"'===t[0]&&'"'===t[e]||"'"===t[0]&&"'"===t[e])?t.slice(1,-1):t}(r)]=1),e&&(l-=1),n+(e?"."+r:"["+r+"]")},CallExpression:t=>{"Identifier"!==t.callee.type&&i_t("Illegal callee type: "+t.callee.type);const e=t.callee.name,n=t.arguments,r=u_t(i,e)&&i[e];return r||i_t("Unrecognized function: "+e),s_t(r)?r(n):r+"("+n.map(h).join(",")+")"},ArrayExpression:t=>"["+t.elements.map(h).join(",")+"]",BinaryExpression:t=>"("+h(t.left)+" "+t.operator+" "+h(t.right)+")",UnaryExpression:t=>"("+t.operator+h(t.argument)+")",ConditionalExpression:t=>"("+h(t.test)+"?"+h(t.consequent)+":"+h(t.alternate)+")",LogicalExpression:t=>"("+h(t.left)+t.operator+h(t.right)+")",ObjectExpression:t=>"{"+t.properties.map(h).join(",")+"}",Property:t=>{l+=1;const e=h(t.key);return l-=1,e+":"+h(t.value)}};function f(t){const e={code:h(t),globals:Object.keys(c),fields:Object.keys(u)};return c={},u={},e}return f.functions=i,f.constants=r,f}const eAt="view",nAt="[",rAt="]",iAt="{",aAt="}",oAt=":",sAt=",",cAt="@",uAt=">",lAt=/[[\]{}]/,hAt={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let dAt,fAt;function pAt(t,e,n){return dAt=e||eAt,fAt=n||hAt,mAt(t.trim()).map(yAt)}function gAt(t,e,n,r,i){const a=t.length;let o,s=0;for(;e<a;++e){if(o=t[e],!s&&o===n)return e;i&&i.indexOf(o)>=0?--s:r&&r.indexOf(o)>=0&&++s}return e}function mAt(t){const e=[],n=t.length;let r=0,i=0;for(;i<n;)i=gAt(t,i,sAt,nAt+iAt,rAt+aAt),e.push(t.substring(r,i).trim()),r=++i;if(0===e.length)throw"Empty event selector: "+t;return e}function yAt(t){return"["===t[0]?function(t){const e=t.length;let n,r=1;if(r=gAt(t,r,rAt,nAt,rAt),r===e)throw"Empty between selector: "+t;if(n=mAt(t.substring(1,r)),2!==n.length)throw"Between selector must have two elements: "+t;if(t=t.slice(r+1).trim(),t[0]!==uAt)throw"Expected '>' after between selector: "+t;n=n.map(yAt);const i=yAt(t.slice(1).trim());if(i.between)return{between:n,stream:i};i.between=n;return i}(t):function(t){const e={source:dAt},n=[];let r,i,a=[0,0],o=0,s=0,c=t.length,u=0;if(t[c-1]===aAt){if(u=t.lastIndexOf(iAt),!(u>=0))throw"Unmatched right brace: "+t;try{a=function(t){const e=t.split(sAt);if(!t.length||e.length>2)throw t;return e.map((e=>{const n=+e;if(n!==n)throw t;return n}))}(t.substring(u+1,c-1))}catch(l){throw"Invalid throttle specification: "+t}c=(t=t.slice(0,u).trim()).length,u=0}if(!c)throw t;t[0]===cAt&&(o=++u);r=gAt(t,u,oAt),r<c&&(n.push(t.substring(s,r).trim()),s=u=++r);if(u=gAt(t,u,nAt),u===c)n.push(t.substring(s,c).trim());else if(n.push(t.substring(s,u).trim()),i=[],s=++u,s===c)throw"Unmatched left bracket: "+t;for(;u<c;){if(u=gAt(t,u,rAt),u===c)throw"Unmatched left bracket: "+t;if(i.push(t.substring(s,u).trim()),u<c-1&&t[++u]!==nAt)throw"Expected left bracket: "+t;s=++u}if(!(c=n.length)||lAt.test(n[c-1]))throw"Invalid event selector: "+t;c>1?(e.type=n[1],o?e.markname=n[0].slice(1):!function(t){return fAt[t]}(n[0])?e.source=n[0]:e.marktype=n[0]):e.type=n[0];"!"===e.type.slice(-1)&&(e.consume=!0,e.type=e.type.slice(0,-1));null!=i&&(e.filter=i);a[0]&&(e.throttle=a[0]);a[1]&&(e.debounce=a[1]);return e}(t)}var vAt="5.20.0";oe(Mc,a,s,c,u,l,d,h,f,p,g,m);const bAt=vAt;function xAt(t,e,n){return t.fields=e||[],t.fname=n,t}function wAt(t){return 1===t.length?kAt(t[0]):_At(t)}const kAt=t=>function(e){return e[t]},_At=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function SAt(t){throw Error(t)}function AAt(t){var e,n,r,i=[],a=null,o=0,s=t.length,c="";function u(){i.push(c+t.substring(e,n)),c="",e=n+1}for(t+="",e=n=0;n<s;++n)if("\\"===(r=t[n]))c+=t.substring(e,n),c+=t.substring(++n,++n),e=n;else if(r===a)u(),a=null,o=-1;else{if(a)continue;e===o&&'"'===r||e===o&&"'"===r?(e=n+1,a=r):"."!==r||o?"["===r?(n>e&&u(),o=e=n+1):"]"===r&&(o||SAt("Access path missing open bracket: "+t),o>0&&u(),o=0,e=n+1):n>e?u():e=n+1}return o&&SAt("Access path missing closing bracket: "+t),a&&SAt("Access path missing closing quote: "+t),n>e&&(n++,u()),i}var CAt=[],EAt=(function(t,e,n){const r=AAt(t);t=1===r.length?r[0]:t,xAt((n&&n.get||wAt)(r),[t],e||t)}("id"),xAt((function(t){return t}),CAt,"identity"));xAt((function(){return 0}),CAt,"zero"),xAt((function(){return 1}),CAt,"one"),xAt((function(){return!0}),CAt,"true"),xAt((function(){return!1}),CAt,"false");function TAt(t,e,n){var r=[e].concat([].slice.call(n));console[t].apply(console,r)}const NAt=Array.isArray;function DAt(t){return t===Object(t)}const FAt=t=>"__proto__"!==t;function IAt(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(((t,e)=>{for(var n in e)if("signals"===n)t.signals=OAt(t.signals,e.signals);else{var r="legend"===n?{layout:1}:"style"===n||null;MAt(t,n,e[n],r)}return t}),{})}function MAt(t,e,n,r){var i,a;if(FAt(e))if(DAt(n)&&!NAt(n))for(i in a=DAt(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?MAt(a,i,n[i]):FAt(i)&&(a[i]=n[i]);else t[e]=n}function OAt(t,e){if(null==t)return e;const n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}function RAt(t){return null!=t?NAt(t)?t:[t]:[]}const zAt=Object.prototype.hasOwnProperty;function BAt(t,e){return zAt.call(t,e)}function LAt(t){return"boolean"===typeof t}function PAt(t){return"number"===typeof t}function jAt(t){return"string"===typeof t}function UAt(t){return NAt(t)?"["+t.map(UAt)+"]":DAt(t)||jAt(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function WAt(t){for(var e={},n=0,r=t.length;n<r;++n)e[t[n]]=!0;return e}function VAt(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}Object.create;Object.create;Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function t(){var e=isNaN(arguments[0])?1:Number(arguments[0]);return e?Array.prototype.reduce.call(this,(function(n,r){return Array.isArray(r)?n.push.apply(n,t.call(r,e-1)):n.push(r),n}),[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(t){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var qAt=n(32129),GAt=n.n(qAt),HAt=n(45355),YAt=n.n(HAt),XAt=n(14110),KAt=n.n(XAt);function $At(t){return!!t.or}function ZAt(t){return!!t.and}function QAt(t){return!!t.not}function JAt(t,e){if(QAt(t))JAt(t.not,e);else if(ZAt(t))for(const n of t.and)JAt(n,e);else if($At(t))for(const n of t.or)JAt(n,e);else e(t)}function tCt(t,e){return QAt(t)?{not:tCt(t.not,e)}:ZAt(t)?{and:t.and.map((t=>tCt(t,e)))}:$At(t)?{or:t.or.map((t=>tCt(t,e)))}:e(t)}const eCt=YAt(),nCt=GAt();function rCt(t,e){const n={};for(const r of e)BAt(t,r)&&(n[r]=t[r]);return n}function iCt(t,e){const n=Object.assign({},t);for(const r of e)delete n[r];return n}Set.prototype.toJSON=function(){return"Set(".concat([...this].map((t=>KAt()(t))).join(","),")")};const aCt=KAt();function oCt(t){if(PAt(t))return t;const e=jAt(t)?t:KAt()(t);if(e.length<250)return e;let n=0;for(let r=0;r<e.length;r++){n=(n<<5)-n+e.charCodeAt(r),n&=n}return n}function sCt(t){return!1===t||null===t}function cCt(t,e){return t.indexOf(e)>-1}function uCt(t,e){let n=0;for(const[r,i]of t.entries())if(e(i,r,n++))return!0;return!1}function lCt(t,e){let n=0;for(const[r,i]of t.entries())if(!e(i,r,n++))return!1;return!0}function hCt(t,e){for(const n of yCt(e))MAt(t,n,e[n],!0)}function dCt(t,e){const n=[],r={};let i;for(const a of t)i=e(a),i in r||(r[i]=1,n.push(a));return n}function fCt(t,e){for(const n of t)if(e.has(n))return!0;return!1}function pCt(t){const e=new Set;for(const n of t){const t=AAt(n).map(((t,e)=>0===e?t:"[".concat(t,"]"))),r=t.map(((e,n)=>t.slice(0,n+1).join("")));for(const n of r)e.add(n)}return e}function gCt(t,e){return void 0===t||void 0===e||fCt(pCt(t),pCt(e))}function mCt(t){return 0===yCt(t).length}const yCt=Object.keys,vCt=Object.values;function bCt(t){const e=[];for(const n in t)BAt(t,n)&&e.push({key:n,value:t[n]});return e}function xCt(t){return!0===t||!1===t}function wCt(t){const e=t.replace(/\W/g,"_");return(t.match(/^\d+/)?"_":"")+e}function kCt(t,e){return QAt(t)?"!("+kCt(t.not,e)+")":ZAt(t)?"("+t.and.map((t=>kCt(t,e))).join(") && (")+")":$At(t)?"("+t.or.map((t=>kCt(t,e))).join(") || (")+")":e(t)}function _Ct(t,e){if(0===e.length)return!0;const n=e.shift();return n in t&&_Ct(t[n],e)&&delete t[n],mCt(t)}function SCt(t){return t.charAt(0).toUpperCase()+t.substr(1)}function ACt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datum";const n=AAt(t),r=[];for(let i=1;i<=n.length;i++){const t="[".concat(n.slice(0,i).map(UAt).join("]["),"]");r.push("".concat(e).concat(t))}return r.join(" && ")}function CCt(t){return t.replace(/(\[|\]|\.|'|")/g,"\\$1")}function ECt(t){return"".concat(AAt(t).map(CCt).join("\\."))}function TCt(t,e,n){return t.replace(new RegExp(e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function NCt(t){return"".concat(AAt(t).join("."))}function DCt(t){return t?AAt(t).length:0}function FCt(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(const r of e)if(void 0!==r)return r}let ICt=42;function MCt(t){if(void 0!==t)return(t%360+360)%360}function OCt(t){return!!PAt(t)||!isNaN(t)&&!isNaN(parseFloat(t))}const RCt={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function zCt(t){return t&&t.condition}const BCt=["domain","grid","labels","ticks","title"],LCt={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},PCt={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},jCt=Object.assign(Object.assign({},PCt),{style:1,labelExpr:1,encoding:1});function UCt(t){return!!jCt[t]}yCt(jCt);const WCt={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},VCt=WCt.arc,qCt=WCt.area,GCt=WCt.bar,HCt=WCt.image,YCt=WCt.line,XCt=WCt.point,KCt=WCt.rect,$Ct=WCt.rule,ZCt=WCt.text,QCt=WCt.tick,JCt=WCt.trail,tEt=WCt.circle,eEt=WCt.square,nEt=WCt.geoshape;function rEt(t){return cCt(["line","area","trail"],t)}function iEt(t){return cCt(["rect","bar","image","arc"],t)}const aEt=yCt(WCt);function oEt(t){return t.type}WAt(aEt);const sEt=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit","fill","fillOpacity"],cEt=yCt({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1}),uEt={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},lEt={binSpacing:1,continuousBandSize:5,timeUnitBandPosition:.5},hEt={binSpacing:0,continuousBandSize:5,timeUnitBandPosition:.5};function dEt(t){return"mark"in t}class fEt{constructor(t,e){this.name=t,this.run=e}hasMatchingType(t){return!!dEt(t)&&function(t){return oEt(t)?t.type:t}(t.mark)===this.name}}const pEt={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},gEt={count:1,min:1,max:1};function mEt(t){return!!t&&!!t.argmin}function yEt(t){return!!t&&!!t.argmax}yCt(pEt);function vEt(t){return jAt(t)&&!!pEt[t]}const bEt=["count","valid","missing","distinct"];function xEt(t){return jAt(t)&&cCt(bEt,t)}const wEt=["count","sum","distinct","valid","missing"],kEt=WAt(["mean","average","median","q1","q3","min","max"]),_Et="row",SEt="column",AEt="facet",CEt="x",EEt="y",TEt="x2",NEt="y2",DEt="radius",FEt="radius2",IEt="theta",MEt="theta2",OEt="latitude",REt="longitude",zEt="latitude2",BEt="longitude2",LEt="color",PEt="fill",jEt="stroke",UEt="shape",WEt="size",VEt="angle",qEt="opacity",GEt="fillOpacity",HEt="strokeOpacity",YEt="strokeWidth",XEt="strokeDash",KEt="text",$Et="order",ZEt="detail",QEt="key",JEt="tooltip",tTt="href",eTt="url",nTt="description",rTt={theta:1,theta2:1,radius:1,radius2:1};function iTt(t){return t in rTt}const aTt={longitude:1,longitude2:1,latitude:1,latitude2:1};const oTt=yCt(aTt),sTt=Object.assign(Object.assign(Object.assign(Object.assign({},{x:1,y:1,x2:1,y2:1}),rTt),aTt),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function cTt(t){return t===LEt||t===PEt||t===jEt}const uTt={row:1,column:1,facet:1},lTt=yCt(uTt),hTt=Object.assign(Object.assign({},sTt),uTt),dTt=yCt(hTt),{order:fTt,detail:pTt,tooltip:gTt}=hTt,mTt=VAt(hTt,["order","detail","tooltip"]),{row:yTt,column:vTt,facet:bTt}=mTt,xTt=VAt(mTt,["row","column","facet"]);yCt(mTt),yCt(xTt);function wTt(t){return!!hTt[t]}const kTt=[TEt,NEt,zEt,BEt,MEt,FEt];function _Tt(t){return STt(t)!==t}function STt(t){switch(t){case TEt:return CEt;case NEt:return EEt;case zEt:return OEt;case BEt:return REt;case MEt:return IEt;case FEt:return DEt}return t}function ATt(t){if(iTt(t))switch(t){case IEt:return"startAngle";case MEt:return"endAngle";case DEt:return"outerRadius";case FEt:return"innerRadius"}return t}function CTt(t){switch(t){case CEt:return TEt;case EEt:return NEt;case OEt:return zEt;case REt:return BEt;case IEt:return MEt;case DEt:return FEt}}function ETt(t){switch(t){case CEt:case TEt:return"width";case EEt:case NEt:return"height"}}yCt(sTt);const{x:TTt,y:NTt,x2:DTt,y2:FTt,latitude:ITt,longitude:MTt,latitude2:OTt,longitude2:RTt,theta:zTt,theta2:BTt,radius:LTt,radius2:PTt}=sTt,jTt=VAt(sTt,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),UTt=yCt(jTt),WTt={x:1,y:1},VTt=yCt(WTt);function qTt(t){return t in WTt}const GTt={theta:1,radius:1},HTt=yCt(GTt);function YTt(t){return"width"===t?CEt:EEt}const{text:XTt,tooltip:KTt,href:$Tt,url:ZTt,description:QTt,detail:JTt,key:tNt,order:eNt}=jTt,nNt=VAt(jTt,["text","tooltip","href","url","description","detail","key","order"]),rNt=yCt(nNt);const iNt=Object.assign(Object.assign(Object.assign({},WTt),GTt),nNt),aNt=yCt(iNt);function oNt(t){return!!iNt[t]}function sNt(t,e){return function(t){switch(t){case LEt:case PEt:case jEt:case nTt:case ZEt:case QEt:case JEt:case tTt:case $Et:case qEt:case GEt:case HEt:case YEt:case AEt:case _Et:case SEt:return cNt;case CEt:case EEt:case OEt:case REt:return lNt;case TEt:case NEt:case zEt:case BEt:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case WEt:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case XEt:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case UEt:return{point:"always",geoshape:"always"};case KEt:return{text:"always"};case VEt:return{point:"always",square:"always",text:"always"};case eTt:return{image:"always"};case IEt:case DEt:return{text:"always",arc:"always"};case MEt:case FEt:return{arc:"always"}}}(t)[e]}const cNt={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:uNt}=cNt,lNt=VAt(cNt,["geoshape"]);function hNt(t){switch(t){case CEt:case EEt:case IEt:case DEt:case WEt:case VEt:case YEt:case qEt:case GEt:case HEt:case TEt:case NEt:case MEt:case FEt:return;case AEt:case _Et:case SEt:case UEt:case XEt:case KEt:case JEt:case tTt:case eTt:case nTt:return"discrete";case LEt:case PEt:case jEt:return"flexible";case OEt:case REt:case zEt:case BEt:case ZEt:case QEt:case $Et:return}}function dNt(t){return LAt(t)&&(t=xIt(t,void 0)),"bin"+yCt(t).map((e=>mNt(t[e])?wCt("_".concat(e,"_").concat(Object.entries(t[e]))):wCt("_".concat(e,"_").concat(t[e])))).join("")}function fNt(t){return!0===t||gNt(t)&&!t.binned}function pNt(t){return"binned"===t||gNt(t)&&!0===t.binned}function gNt(t){return DAt(t)}function mNt(t){return null===t||void 0===t?void 0:t.selection}function yNt(t){switch(t){case _Et:case SEt:case WEt:case LEt:case PEt:case jEt:case YEt:case qEt:case GEt:case HEt:case UEt:return 6;case XEt:return 4;default:return 10}}function vNt(t){return"Invalid specification ".concat(JSON.stringify(t),'. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".')}const bNt='Autosize "fit" only works for single views and layered views.';function xNt(t){return"".concat("width"==t?"Width":"Height",' "container" only works for single views and layered views.')}function wNt(t){const e="width"==t?"x":"y";return"".concat("width"==t?"Width":"Height",' "container" only works well with autosize "fit" or "fit-').concat(e,'".')}function kNt(t){return t?'Dropping "fit-'.concat(t,'" because spec has discrete ').concat(ETt(t),"."):'Dropping "fit" because spec has discrete size.'}function _Nt(t){return'Cannot project a selection on encoding channel "'.concat(t,'", which has no field.')}function SNt(t,e){return'Cannot project a selection on encoding channel "'.concat(t,'" as it uses an aggregate function ("').concat(e,'").')}function ANt(t){return"Selection not supported for ".concat(t," yet.")}function CNt(t){return'The "columns" property cannot be used when "'.concat(t,'" has nested row/column.')}function ENt(t,e,n){return'An ancestor parsed field "'.concat(t,'" as ').concat(n," but a child wants to parse the field as ").concat(e,".")}function TNt(t){return"Ignoring an invalid transform: ".concat(aCt(t),".")}function NNt(t){return"Config.customFormatTypes is not true, thus custom format type and format for channel ".concat(t," are dropped.")}function DNt(t){return'Invalid field type "'.concat(t,'".')}function FNt(t,e){const{fill:n,stroke:r}=e;return"Dropping color ".concat(t," as the plot also has ").concat(n&&r?"fill and stroke":n?"fill":"stroke",".")}function INt(t,e){return"Dropping ".concat(aCt(t),' from channel "').concat(e,'" since it does not contain any data field, datum, value, or signal.')}function MNt(t,e,n){return"".concat(t,' dropped as it is incompatible with "').concat(e,'"').concat(n?" when ".concat(n):"",".")}function ONt(t){return"".concat(t," encoding should be discrete (ordinal / nominal / binned).")}function RNt(t,e){return'Using discrete channel "'.concat(t,'" to encode "').concat(e,'" field can be misleading as it does not encode ').concat("ordinal"===e?"order":"magnitude",".")}function zNt(t){return"Using unaggregated domain with raw field has no effect (".concat(aCt(t),").")}function BNt(t){return'Unaggregated domain not applicable for "'.concat(t,'" since it produces values outside the origin domain of the source data.')}function LNt(t){return"Unaggregated domain is currently unsupported for log scale (".concat(aCt(t),").")}function PNt(t,e,n){return"".concat(n,"-scale's \"").concat(e,'" is dropped as it does not work with ').concat(t," scale.")}function jNt(t){return'The step for "'.concat(t,'" is dropped because the ').concat("width"===t?"x":"y"," is continuous.")}const UNt="Domains that should be unioned has conflicting sort properties. Sort will be set to true.";function WNt(t,e){return"Invalid ".concat(t,": ").concat(aCt(e),".")}function VNt(t){return"1D error band does not support ".concat(t,".")}function qNt(t){return"Channel ".concat(t,' is required for "binned" bin.')}const GNt=function(t,e){var n=t||0;return{level:function(t){return arguments.length?(n=+t,this):n},error:function(){return n>=1&&TAt(e||"error","ERROR",arguments),this},warn:function(){return n>=2&&TAt(e||"warn","WARN",arguments),this},info:function(){return n>=3&&TAt(e||"log","INFO",arguments),this},debug:function(){return n>=4&&TAt(e||"log","DEBUG",arguments),this}}}(2);let HNt=GNt;function YNt(){return HNt=GNt,HNt}function XNt(){HNt.warn(...arguments)}function KNt(t){if(t&&DAt(t))for(const e of rDt)if(e in t)return!0;return!1}const $Nt=["january","february","march","april","may","june","july","august","september","october","november","december"],ZNt=$Nt.map((t=>t.substr(0,3))),QNt=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],JNt=QNt.map((t=>t.substr(0,3)));function tDt(t,e){const n=[];if(e&&void 0!==t.day&&yCt(t).length>1&&(XNt(function(t){return"Dropping day from datetime ".concat(aCt(t)," as day cannot be combined with other units.")}(t)),delete(t=nCt(t)).day),void 0!==t.year?n.push(t.year):n.push(2012),void 0!==t.month){const r=e?function(t){if(OCt(t)&&(t=+t),PAt(t))return t-1;{const e=t.toLowerCase(),n=$Nt.indexOf(e);if(-1!==n)return n;const r=e.substr(0,3),i=ZNt.indexOf(r);if(-1!==i)return i;throw new Error(WNt("month",t))}}(t.month):t.month;n.push(r)}else if(void 0!==t.quarter){const r=e?function(t){if(OCt(t)&&(t=+t),PAt(t))return t>4&&XNt(WNt("quarter",t)),t-1;throw new Error(WNt("quarter",t))}(t.quarter):t.quarter;n.push(PAt(r)?3*r:r+"*3")}else n.push(0);if(void 0!==t.date)n.push(t.date);else if(void 0!==t.day){const r=e?function(t){if(OCt(t)&&(t=+t),PAt(t))return t%7;{const e=t.toLowerCase(),n=QNt.indexOf(e);if(-1!==n)return n;const r=e.substr(0,3),i=JNt.indexOf(r);if(-1!==i)return i;throw new Error(WNt("day",t))}}(t.day):t.day;n.push(PAt(r)?r+1:r+"+1")}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const e=t[r];n.push("undefined"===typeof e?0:e)}return n}function eDt(t){const e=tDt(t,!0).join(", ");return t.utc?"utc(".concat(e,")"):"datetime(".concat(e,")")}const nDt={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},rDt=yCt(nDt);function iDt(t){return t.startsWith("utc")}const aDt={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function oDt(t){const e=[];for(const n of rDt)sDt(t,n)&&e.push(n);return e}function sDt(t,e){const n=t.indexOf(e);return!(n<0)&&(!(n>0&&"seconds"===e&&"i"===t.charAt(n-1))&&(!(t.length>n+3&&"day"===e&&"o"===t.charAt(n+3))&&!(n>0&&"year"===e&&"f"===t.charAt(n-1))))}function cDt(t,e){let{end:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{end:!1};const r=ACt(e),i=iDt(t)?"utc":"";let a;const o={};for(const c of rDt)sDt(t,c)&&(o[c]="quarter"===(s=c)?"(".concat(i,"quarter(").concat(r,")-1)"):"".concat(i).concat(s,"(").concat(r,")"),a=c);var s;return n&&(o[a]+="+1"),function(t){const e=tDt(t,!1).join(", ");return t.utc?"utc(".concat(e,")"):"datetime(".concat(e,")")}(o)}function uDt(t){if(!t)return;const e=oDt(t);return"timeUnitSpecifier(".concat(KAt()(e),", ").concat(KAt()(aDt),")")}function lDt(t){if(!t)return;let e;return jAt(t)?e={unit:t}:DAt(t)&&(e=Object.assign(Object.assign({},t),t.unit?{unit:t.unit}:{})),iDt(e.unit)&&(e.utc=!0,e.unit=e.unit.substr(3)),e}function hDt(t){return t&&!!t.signal}function dDt(t){return!!t.step}function fDt(t){return!NAt(t)&&("field"in t&&"data"in t)}const pDt=yCt({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1}),gDt={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},mDt=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function yDt(t){return t&&!!t.field&&void 0!==t.equal}function vDt(t){return t&&!!t.field&&void 0!==t.lt}function bDt(t){return t&&!!t.field&&void 0!==t.lte}function xDt(t){return t&&!!t.field&&void 0!==t.gt}function wDt(t){return t&&!!t.field&&void 0!==t.gte}function kDt(t){if(t&&t.field){if(NAt(t.range)&&2===t.range.length)return!0;if(hDt(t.range))return!0}return!1}function _Dt(t){return t&&!!t.field&&(NAt(t.oneOf)||NAt(t.in))}function SDt(t){return _Dt(t)||yDt(t)||kDt(t)||vDt(t)||xDt(t)||bDt(t)||wDt(t)}function ADt(t,e){return _It(t,{timeUnit:e,wrapTime:!0})}function CDt(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var n;const{field:r}=t,i=null===(n=lDt(t.timeUnit))||void 0===n?void 0:n.unit,a=i?"time("+cDt(i,r)+")":aIt(t,{expr:"datum"});if(yDt(t))return a+"==="+ADt(t.equal,i);if(vDt(t)){const e=t.lt;return"".concat(a,"<").concat(ADt(e,i))}if(xDt(t)){const e=t.gt;return"".concat(a,">").concat(ADt(e,i))}if(bDt(t)){const e=t.lte;return"".concat(a,"<=").concat(ADt(e,i))}if(wDt(t)){const e=t.gte;return"".concat(a,">=").concat(ADt(e,i))}if(_Dt(t))return"indexof([".concat(function(t,e){return t.map((t=>ADt(t,e)))}(t.oneOf,i).join(","),"], ").concat(a,") !== -1");if(function(t){return t&&!!t.field&&void 0!==t.valid}(t))return EDt(a,t.valid);if(kDt(t)){const{range:n}=t,r=hDt(n)?{signal:"".concat(n.signal,"[0]")}:n[0],o=hDt(n)?{signal:"".concat(n.signal,"[1]")}:n[1];if(null!==r&&null!==o&&e)return"inrange("+a+", ["+ADt(r,i)+", "+ADt(o,i)+"])";const s=[];return null!==r&&s.push("".concat(a," >= ").concat(ADt(r,i))),null!==o&&s.push("".concat(a," <= ").concat(ADt(o,i))),s.length>0?s.join(" && "):"true"}throw new Error("Invalid field predicate: ".concat(JSON.stringify(t)))}function EDt(t){return!(arguments.length>1&&void 0!==arguments[1])||arguments[1]?"isValid(".concat(t,") && isFinite(+").concat(t,")"):"!isValid(".concat(t,") || !isFinite(+").concat(t,")")}function TDt(t){var e;return SDt(t)&&t.timeUnit?Object.assign(Object.assign({},t),{timeUnit:null===(e=lDt(t.timeUnit))||void 0===e?void 0:e.unit}):t}const NDt={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};const DDt=NDt.quantitative,FDt=NDt.ordinal,IDt=NDt.temporal,MDt=NDt.nominal,ODt=NDt.geojson,RDt=yCt(NDt);const zDt={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},BDt={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},LDt=yCt(BDt);function PDt(t,e){const n=BDt[t],r=BDt[e];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n}const jDt={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function UDt(t){return jDt[t]}const WDt=["linear","log","pow","sqrt","symlog","time","utc"],VDt=WAt(WDt),qDt=WAt(["linear","log","pow","sqrt","symlog"]);const GDt=WAt(["quantile","quantize","threshold"]),HDt=WAt(WDt.concat(["quantile","quantize","threshold","sequential","identity"])),YDt=WAt(["ordinal","bin-ordinal","point","band"]);function XDt(t){return t in YDt}function KDt(t){return t in HDt}function $Dt(t){return t in VDt}function ZDt(t){return t in GDt}function QDt(t){return null===t||void 0===t?void 0:t.selection}const JDt={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:tFt,domain:eFt,range:nFt,scheme:rFt}=(yCt(JDt),JDt),iFt=VAt(JDt,["type","domain","range","scheme"]),aFt=yCt(iFt);!function(){var t;const e={};for(const n of dTt)for(const r of RDt)for(const i of LDt){const a=lFt(n,r);uFt(n,i)&&cFt(i,r)&&(e[a]=null!==(t=e[a])&&void 0!==t?t:[],e[a].push(i))}}();function oFt(t,e){switch(e){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!cCt(["point","band","identity"],t);case"bins":return!cCt(["point","band","identity","ordinal"],t);case"round":return $Dt(t)||"band"===t||"point"===t;case"padding":return $Dt(t)||cCt(["point","band"],t);case"paddingOuter":case"align":return cCt(["point","band"],t);case"paddingInner":return"band"===t;case"domainMid":case"clamp":return $Dt(t);case"nice":return $Dt(t)||"quantize"===t||"threshold"===t;case"exponent":return"pow"===t;case"base":return"log"===t;case"constant":return"symlog"===t;case"zero":return KDt(t)&&!cCt(["log","time","utc","threshold","quantile"],t)}}function sFt(t,e){switch(e){case"interpolate":case"scheme":case"domainMid":return cTt(t)?void 0:'Cannot use the scale property "'.concat(t,'" with non-color channel.');case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function cFt(t,e){return cCt([FDt,MDt],e)?void 0===t||XDt(t):e===IDt?cCt([zDt.TIME,zDt.UTC,void 0],t):e!==DDt||cCt([zDt.LOG,zDt.POW,zDt.SQRT,zDt.SYMLOG,zDt.QUANTILE,zDt.QUANTIZE,zDt.THRESHOLD,zDt.LINEAR,void 0],t)}function uFt(t,e){if(!oNt(t))return!1;switch(t){case CEt:case EEt:case IEt:case DEt:return $Dt(e)||cCt(["band","point"],e);case WEt:case YEt:case qEt:case GEt:case HEt:case VEt:return $Dt(e)||ZDt(e)||cCt(["band","point","ordinal"],e);case LEt:case PEt:case jEt:return"band"!==e;case XEt:return"ordinal"===e||ZDt(e);case UEt:return"ordinal"===e}}function lFt(t,e){return t+"_"+e}function hFt(t){const{channel:e,channelDef:n,markDef:r,scale:i,config:a}=t,o=yFt(t);return YFt(n)&&!xEt(n.aggregate)&&i&&$Dt(i.get("type"))&&!1===i.get("zero")?dFt({fieldDef:n,channel:e,markDef:r,ref:o,config:a}):o}function dFt(t){let{fieldDef:e,channel:n,markDef:r,ref:i,config:a}=t;if(rEt(r.type))return i;return null===IIt("invalid",r,a)?i:[fFt(e,n),i]}function fFt(t,e){const n=pFt(t,!0),r="y"===STt(e)?{field:{group:"height"}}:{value:0};return Object.assign({test:n},r)}function pFt(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return EDt(jAt(t)?t:aIt(t,{expr:"datum"}),!e)}function gFt(t,e,n,r){const i={};if(e&&(i.scale=e),KFt(t)){const{datum:e}=t;KNt(e)?i.signal=eDt(e):hDt(e)?i.signal=e.signal:i.value=e}else i.field=aIt(t,n);if(r){const{offset:t,band:e}=r;t&&(i.offset=t),e&&(i.band=e)}return i}function mFt(t){let{scaleName:e,fieldOrDatumDef:n,fieldOrDatumDef2:r,offset:i,startSuffix:a,band:o=.5}=t;const s=0<o&&o<1?"datum":void 0,c=aIt(n,{expr:s,suffix:a}),u=void 0!==r?aIt(r,{expr:s}):aIt(n,{suffix:"end",expr:s}),l={};if(0===o||1===o){l.scale=e;const t=0===o?c:u;l.field=t}else{const t="".concat(o," * ").concat(c," + ").concat(1-o," * ").concat(u);l.signal='scale("'.concat(e,'", ').concat(t,")")}return i&&(l.offset=i),l}function yFt(t){let{channel:e,channelDef:n,channel2Def:r,markDef:i,config:a,scaleName:o,scale:s,stack:c,offset:u,defaultRef:l,band:h}=t;var d;if(n){if(QFt(n)){if(JFt(n)){h=null!==h&&void 0!==h?h:WFt({channel:e,fieldDef:n,fieldDef2:r,markDef:i,stack:c,config:a,isMidPoint:!0});const{bin:t,timeUnit:s,type:l}=n;if(fNt(t)||h&&s&&l===IDt)return c&&c.impute?gFt(n,o,{binSuffix:"mid"},{offset:u}):h?mFt({scaleName:o,fieldOrDatumDef:n,band:h,offset:u}):gFt(n,o,AIt(n,e)?{binSuffix:"range"}:{},{offset:u});if(pNt(t)){if(YFt(r))return mFt({scaleName:o,fieldOrDatumDef:n,fieldOrDatumDef2:r,band:h,offset:u});XNt(qNt(e===CEt?TEt:NEt))}}const t=null===s||void 0===s?void 0:s.get("type");return gFt(n,o,XDt(t)?{binSuffix:"range"}:{},{offset:u,band:"band"===t?null!==(d=null!==h&&void 0!==h?h:n.band)&&void 0!==d?d:.5:void 0})}if(tIt(n)){const t=n.value,r=u?{offset:u}:{};return Object.assign(Object.assign({},vFt(e,t)),r)}}return"function"===typeof l&&(l=l()),l?Object.assign(Object.assign({},l),u?{offset:u}:{}):l}function vFt(t,e){return cCt(["x","x2"],t)&&"width"===e?{field:{group:"width"}}:cCt(["y","y2"],t)&&"height"===e?{field:{group:"height"}}:TIt(e)}function bFt(t){return t&&"number"!==t&&"time"!==t}function xFt(t,e,n){return"".concat(t,"(").concat(e).concat(n?", ".concat(JSON.stringify(n)):"",")")}const wFt=" \u2013 ";function kFt(t){let{fieldOrDatumDef:e,format:n,formatType:r,expr:i,normalizeStack:a,config:o}=t;var s,c;if(bFt(r))return SFt({fieldOrDatumDef:e,format:n,formatType:r,expr:i,config:o});const u=_Ft(e,i,a);if(kIt(e)){const t=function(t,e,n,r,i){return!e||n?(n=jAt(n)?n:r,"".concat(i?"utc":"time","Format(").concat(t,", '").concat(n,"')")):function(t,e,n){if(!t)return;const r=uDt(t),i=n||iDt(t);return"".concat(i?"utc":"time","Format(").concat(e,", ").concat(r,")")}(e,t,i)}(u,YFt(e)?null===(s=lDt(e.timeUnit))||void 0===s?void 0:s.unit:void 0,n,o.timeFormat,eIt(e)&&(null===(c=e.scale)||void 0===c?void 0:c.type)===zDt.UTC);return t?{signal:t}:void 0}if(n=EFt(XFt(e),n,o),YFt(e)&&fNt(e.bin)){return{signal:DFt(u,aIt(e,{expr:i,binSuffix:"end"}),n,r,o)}}return n||"quantitative"===XFt(e)?{signal:"".concat(TFt(u,n))}:{signal:"isValid(".concat(u,") ? ").concat(u,' : ""+').concat(u)}}function _Ft(t,e,n){return YFt(t)?n?"".concat(aIt(t,{expr:e,suffix:"end"}),"-").concat(aIt(t,{expr:e,suffix:"start"})):aIt(t,{expr:e}):function(t){const{datum:e}=t;return KNt(e)?eDt(e):"".concat(JSON.stringify(e))}(t)}function SFt(t){let{fieldOrDatumDef:e,format:n,formatType:r,expr:i,normalizeStack:a,config:o,field:s}=t;if(s=null!==s&&void 0!==s?s:_Ft(e,i,a),YFt(e)&&fNt(e.bin)){return{signal:DFt(s,aIt(e,{expr:i,binSuffix:"end"}),n,r,o)}}return{signal:xFt(r,s,n)}}function AFt(t,e,n,r,i,a){var o;if(!bFt(r)){if(kIt(t)){return function(t,e,n,r){if(t)return t;if(e)return{signal:uDt(e)};return r?void 0:n.timeFormat}(n,YFt(t)?null===(o=lDt(t.timeUnit))||void 0===o?void 0:o.unit:void 0,i,a)}return EFt(e,n,i)}}function CFt(t,e,n){return t&&(hDt(t)||"number"===t||"time"===t)?t:kIt(e)&&"time"!==n&&"utc"!==n?"time":void 0}function EFt(t,e,n){return jAt(e)?e:t===DDt?n.numberFormat:void 0}function TFt(t,e){return"format(".concat(t,', "').concat(e||"",'")')}function NFt(t,e,n,r){var i;return bFt(n)?xFt(n,t,e):TFt(t,null!==(i=jAt(e)?e:void 0)&&void 0!==i?i:r.numberFormat)}function DFt(t,e,n,r,i){const a=NFt(t,n,r,i),o=NFt(e,n,r,i);return"".concat(EDt(t,!1),' ? "null" : ').concat(a,' + "').concat(wFt,'" + ').concat(o)}const FFt="min",IFt={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function MFt(t){return t in IFt}function OFt(t){return!!t&&!!t.encoding}function RFt(t){return!!t&&("count"===t.op||!!t.field)}function zFt(t){return!!t&&NAt(t)}function BFt(t){return"row"in t||"column"in t}function LFt(t){return!!t&&"header"in t}function PFt(t){return"facet"in t}function jFt(t){const{field:e,timeUnit:n,bin:r,aggregate:i}=t;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:e})}function UFt(t){return JFt(t)&&"sort"in t}function WFt(t){let{channel:e,fieldDef:n,fieldDef2:r,markDef:i,stack:a,config:o,isMidPoint:s}=t;if(QFt(n)&&void 0!==n.band)return n.band;if(YFt(n)){const{timeUnit:t,bin:e}=n;if(t&&!r)return s?MIt("timeUnitBandPosition",i,o):iEt(i.type)?MIt("timeUnitBand",i,o):0;if(fNt(e))return iEt(i.type)&&!s?1:.5}return(null===a||void 0===a?void 0:a.fieldChannel)===e&&s?.5:void 0}function VFt(t,e,n,r,i,a){return!!(fNt(e.bin)||e.timeUnit&&JFt(e)&&"temporal"===e.type)&&!!WFt({channel:t,fieldDef:e,fieldDef2:n,stack:r,markDef:i,config:a})}function qFt(t){return!!t&&"condition"in t}function GFt(t){const e=t&&t.condition;return!!e&&!NAt(e)&&YFt(e)}function HFt(t){const e=t&&t.condition;return!!e&&!NAt(e)&&QFt(e)}function YFt(t){return!!t&&(!!t.field||"count"===t.aggregate)}function XFt(t){return t&&t.type}function KFt(t){return!!t&&"datum"in t}function $Ft(t){return JFt(t)&&sIt(t)||ZFt(t)}function ZFt(t){return KFt(t)&&PAt(t.datum)}function QFt(t){return YFt(t)||KFt(t)}function JFt(t){return!!t&&("field"in t&&"type"in t||"count"===t.aggregate)}function tIt(t){return t&&"value"in t&&"value"in t}function eIt(t){return!!t&&("scale"in t||"sort"in t)}function nIt(t){return t&&("axis"in t||"stack"in t||"impute"in t)}function rIt(t){return!!t&&"legend"in t}function iIt(t){return!!t&&("format"in t||"formatType"in t)}function aIt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,r,i;let a=t.field;const o=e.prefix;let s=e.suffix,c="";if(function(t){return"count"===t.aggregate}(t))a=function(t){return 0===t.indexOf("__")}(u="count")?u:"__".concat(u);else{let o;if(!e.nofn)if(function(t){return"op"in t}(t))o=t.op;else{const{bin:u,aggregate:l,timeUnit:h}=t;fNt(u)?(o=dNt(u),s=(null!==(n=e.binSuffix)&&void 0!==n?n:"")+(null!==(r=e.suffix)&&void 0!==r?r:"")):l?yEt(l)?(c='["'.concat(a,'"]'),a="argmax_".concat(l.argmax)):mEt(l)?(c='["'.concat(a,'"]'),a="argmin_".concat(l.argmin)):o=String(l):h&&(o=function(t){const e=lDt(t),{utc:n}=e,r=VAt(e,["utc"]);return r.unit?(n?"utc":"")+yCt(r).map((t=>wCt("".concat("unit"===t?"":"_".concat(t,"_")).concat(r[t])))).join(""):(n?"utc":"")+"timeunit"+yCt(r).map((t=>wCt("_".concat(t,"_").concat(r[t])))).join("")}(h),s=(!cCt(["range","mid"],e.binSuffix)&&e.binSuffix||"")+(null!==(i=e.suffix)&&void 0!==i?i:""))}o&&(a=a?"".concat(o,"_").concat(a):o)}var u;return s&&(a="".concat(a,"_").concat(s)),o&&(a="".concat(o,"_").concat(a)),e.forAs?NCt(a):e.expr?function(t){return"".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datum","[").concat(UAt(AAt(t).join(".")),"]")}(a,e.expr)+c:ECt(a)+c}function oIt(t){switch(t.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return YFt(t)&&!!t.bin;case"temporal":return!1}throw new Error(DNt(t.type))}function sIt(t){return!oIt(t)}const cIt=(t,e)=>{switch(e.fieldTitle){case"plain":return t.field;case"functional":return function(t){const{aggregate:e,bin:n,timeUnit:r,field:i}=t;if(yEt(e))return"".concat(i," for argmax(").concat(e.argmax,")");if(mEt(e))return"".concat(i," for argmin(").concat(e.argmin,")");const a=lDt(r),o=e||(null===a||void 0===a?void 0:a.unit)||(null===a||void 0===a?void 0:a.maxbins)&&"timeunit"||fNt(n)&&"bin";return o?o.toUpperCase()+"("+i+")":i}(t);default:return function(t,e){var n;const{field:r,bin:i,timeUnit:a,aggregate:o}=t;if("count"===o)return e.countTitle;if(fNt(i))return"".concat(r," (binned)");if(a){const t=null===(n=lDt(a))||void 0===n?void 0:n.unit;if(t)return"".concat(r," (").concat(oDt(t).join("-"),")")}else if(o)return yEt(o)?"".concat(r," for max ").concat(o.argmax):mEt(o)?"".concat(r," for min ").concat(o.argmin):"".concat(SCt(o)," of ").concat(r);return r}(t,e)}};let uIt=cIt;function lIt(t){uIt=t}function hIt(t,e,n){let{allowDisabling:r,includeDefault:i=!0}=n;var a,o;const s=(null!==(a=dIt(t))&&void 0!==a?a:{}).title;if(!YFt(t))return s;const c=t,u=i?fIt(c,e):void 0;return r?FCt(s,c.title,u):null!==(o=null!==s&&void 0!==s?s:c.title)&&void 0!==o?o:u}function dIt(t){return nIt(t)&&t.axis?t.axis:rIt(t)&&t.legend?t.legend:LFt(t)&&t.header?t.header:void 0}function fIt(t,e){return uIt(t,e)}function pIt(t){var e;if(iIt(t)){const{format:e,formatType:n}=t;return{format:e,formatType:n}}{const n=null!==(e=dIt(t))&&void 0!==e?e:{},{format:r,formatType:i}=n;return{format:r,formatType:i}}}function gIt(t){return YFt(t)?t:GFt(t)?t.condition:void 0}function mIt(t){return QFt(t)?t:HFt(t)?t.condition:void 0}function yIt(t,e,n){if(jAt(t)||PAt(t)||LAt(t)){return XNt(function(t,e,n){return"Channel ".concat(t," is a ").concat(e,". Converted to {value: ").concat(aCt(n),"}.")}(e,jAt(t)?"string":PAt(t)?"number":"boolean",t)),{value:t}}return QFt(t)?vIt(t,e,n):HFt(t)?Object.assign(Object.assign({},t),{condition:vIt(t.condition,e,n)}):t}function vIt(t,e,n){if(iIt(t)){const{format:r,formatType:i}=t,a=VAt(t,["format","formatType"]);if(bFt(i)&&!n.customFormatTypes)return XNt(NNt(e)),vIt(a,e,n)}else{const r=nIt(t)?"axis":rIt(t)?"legend":LFt(t)?"header":null;if(r&&t[r]){const i=t[r],{format:a,formatType:o}=i,s=VAt(i,["format","formatType"]);if(bFt(o)&&!n.customFormatTypes)return XNt(NNt(e)),vIt(Object.assign(Object.assign({},t),{[r]:s}),e,n)}}return YFt(t)?bIt(t,e):function(t){let e=t.type;if(e)return t;const{datum:n}=t;return e=PAt(n)?"quantitative":jAt(n)?"nominal":KNt(n)?"temporal":void 0,Object.assign(Object.assign({},t),{type:e})}(t)}function bIt(t,e){const{aggregate:n,timeUnit:r,bin:i,field:a}=t,o=Object.assign({},t);if(!n||vEt(n)||yEt(n)||mEt(n)||(XNt(function(t){return'Invalid aggregation operator "'.concat(t,'".')}(n)),delete o.aggregate),r&&(o.timeUnit=lDt(r)),a&&(o.field="".concat(a)),fNt(i)&&(o.bin=xIt(i,e)),pNt(i)&&!qTt(e)&&XNt("Channel ".concat(e,' should not be used with "binned" bin.')),JFt(o)){const{type:t}=o,e=function(t){if(t)switch(t=t.toLowerCase()){case"q":case DDt:return"quantitative";case"t":case IDt:return"temporal";case"o":case FDt:return"ordinal";case"n":case MDt:return"nominal";case ODt:return"geojson"}}(t);t!==e&&(o.type=e),"quantitative"!==t&&xEt(n)&&(XNt(function(t,e){return'Invalid field type "'.concat(t,'" for aggregate: "').concat(e,'", using "quantitative" instead.')}(t,n)),o.type="quantitative")}else if(!_Tt(e)){const t=function(t,e){if(t.timeUnit)return"temporal";if(fNt(t.bin))return"quantitative";switch(hNt(e)){case"continuous":default:return"quantitative";case"discrete":case"flexible":return"nominal"}}(o,e);XNt(function(t,e){return'Missing type for channel "'.concat(t,'", using "').concat(e,'" instead.')}(e,t)),o.type=t}if(JFt(o)){const{compatible:t,warning:n}=function(t,e){const n=t.type;if("geojson"===n&&"shape"!==e)return{compatible:!1,warning:"Channel ".concat(e," should not be used with a geojson data.")};switch(e){case _Et:case SEt:case AEt:return sIt(t)?{compatible:!1,warning:ONt(e)}:wIt;case CEt:case EEt:case LEt:case PEt:case jEt:case KEt:case ZEt:case QEt:case JEt:case tTt:case eTt:case VEt:case IEt:case DEt:case nTt:return wIt;case REt:case BEt:case OEt:case zEt:return n!==DDt?{compatible:!1,warning:"Channel ".concat(e," should be used with a quantitative field only, not ").concat(t.type," field.")}:wIt;case qEt:case GEt:case HEt:case YEt:case WEt:case MEt:case FEt:case TEt:case NEt:return"nominal"!==n||t.sort?wIt:{compatible:!1,warning:"Channel ".concat(e," should not be used with an unsorted discrete field.")};case XEt:return cCt(["ordinal","nominal"],t.type)?wIt:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case UEt:return cCt(["ordinal","nominal","geojson"],t.type)?wIt:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case $Et:return"nominal"!==t.type||"sort"in t?wIt:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(o,e);t||XNt(n)}if(UFt(o)&&jAt(o.sort)){const{sort:t}=o;if(MFt(t))return Object.assign(Object.assign({},o),{sort:{encoding:t}});const e=t.substr(1);if("-"===t.charAt(0)&&MFt(e))return Object.assign(Object.assign({},o),{sort:{encoding:e,order:"descending"}})}if(LFt(o)){const{header:t}=o,{orient:e}=t,n=VAt(t,["orient"]);if(e)return Object.assign(Object.assign({},o),{header:Object.assign(Object.assign({},n),{labelOrient:t.labelOrient||e,titleOrient:t.titleOrient||e})})}return o}function xIt(t,e){return LAt(t)?{maxbins:yNt(e)}:"binned"===t?{binned:!0}:t.maxbins||t.step?t:Object.assign(Object.assign({},t),{maxbins:yNt(e)})}const wIt={compatible:!0};function kIt(t){const{formatType:e}=pIt(t);return"time"===e||!e&&function(t){return t&&("temporal"===t.type||YFt(t)&&!!t.timeUnit)}(t)}function _It(t,e){let{timeUnit:n,type:r,wrapTime:i,undefinedIfExprNotRequired:a}=e;var o;const s=n&&(null===(o=lDt(n))||void 0===o?void 0:o.unit);let c,u=s||"temporal"===r;return hDt(t)?c=t.signal:KNt(t)?(u=!0,c=eDt(t)):(jAt(t)||PAt(t))&&u&&(c="datetime(".concat(JSON.stringify(t),")"),function(t){return!!nDt[t]}(s)&&(PAt(t)&&t<1e4||jAt(t)&&isNaN(Date.parse(t)))&&(c=eDt({[s]:t}))),c?i&&u?"time(".concat(c,")"):c:a?void 0:JSON.stringify(t)}function SIt(t,e){const{type:n}=t;return e.map((e=>{const r=_It(e,{timeUnit:YFt(t)?t.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==r?{signal:r}:e}))}function AIt(t,e){return fNt(t.bin)?oNt(e)&&cCt(["ordinal","nominal"],t.type):(console.warn("Only call this method for binned field defs."),!1)}function CIt(t){const{anchor:e,frame:n,offset:r,orient:i,color:a,subtitleColor:o,subtitleFont:s,subtitleFontSize:c,subtitleFontStyle:u,subtitleFontWeight:l,subtitleLineHeight:h,subtitlePadding:d}=t,f=VAt(t,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),p=Object.assign(Object.assign({},f),a?{fill:a}:{}),g=Object.assign(Object.assign(Object.assign(Object.assign({},e?{anchor:e}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{}),m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},o?{subtitleColor:o}:{}),s?{subtitleFont:s}:{}),c?{subtitleFontSize:c}:{}),u?{subtitleFontStyle:u}:{}),l?{subtitleFontWeight:l}:{}),h?{subtitleLineHeight:h}:{}),d?{subtitlePadding:d}:{});return{titleMarkConfig:p,subtitleMarkConfig:rCt(p,["align","baseline","dx","dy","limit"]),nonMark:g,subtitle:m}}function EIt(t){return jAt(t)||NAt(t)&&jAt(t[0])}function TIt(t){return hDt(t)?t:void 0!==t?{value:t}:void 0}function NIt(t){return hDt(t)?t.signal:UAt(t.value)}function DIt(t){return hDt(t)?t.signal:null==t?null:UAt(t)}function FIt(t){var e;return[].concat(t.type,null!==(e=t.style)&&void 0!==e?e:[])}function IIt(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const{vgChannel:i,ignoreVgConfig:a}=r;return i&&void 0!==e[i]?e[i]:void 0!==e[t]?e[t]:!a||i&&i!==t?MIt(t,e,n,r):void 0}function MIt(t,e,n){let{vgChannel:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return FCt(r?OIt(t,e,n.style):void 0,OIt(t,e,n.style),r?n[e.type][r]:void 0,n[e.type][t],r?n.mark[r]:n.mark[t])}function OIt(t,e,n){return RIt(t,FIt(e),n)}function RIt(t,e,n){let r;e=RAt(e);for(const i of e){const e=n[i];e&&void 0!==e[t]&&(r=e[t])}return r}function zIt(t,e){return RAt(t).reduce(((t,n)=>{var r;return t.field.push(aIt(n,e)),t.order.push(null!==(r=n.sort)&&void 0!==r?r:"ascending"),t}),{field:[],order:[]})}function BIt(t,e){const n=[...t];return e.forEach((t=>{for(const e of n)if(eCt(e,t))return;n.push(t)})),n}function LIt(t,e){return eCt(t,e)||!e?t:t?[...RAt(t),...RAt(e)].join(", "):e}function PIt(t,e){const n=t.value,r=e.value;if(null==n||null===r)return{explicit:t.explicit,value:null};if((EIt(n)||hDt(n))&&(EIt(r)||hDt(r)))return{explicit:t.explicit,value:LIt(n,r)};if(EIt(n)||hDt(n))return{explicit:t.explicit,value:n};if(EIt(r)||hDt(r))return{explicit:t.explicit,value:r};if(!EIt(n)&&!hDt(n)&&!EIt(r)&&!hDt(r))return{explicit:t.explicit,value:BIt(n,r)};throw new Error("It should never reach here")}function jIt(t,e){const n=t&&t[e];return!!n&&(NAt(n)?uCt(n,(t=>!!t.field)):YFt(n)||GFt(n))}function UIt(t){return uCt(dTt,(e=>{if(jIt(t,e)){const n=t[e];if(NAt(n))return uCt(n,(t=>!!t.aggregate));{const t=gIt(n);return t&&!!t.aggregate}}return!1}))}function WIt(t,e){const n=[],r=[],i=[],a=[],o={};return GIt(t,((s,c)=>{if(YFt(s)){const{field:u,aggregate:l,bin:h,timeUnit:d}=s,f=VAt(s,["field","aggregate","bin","timeUnit"]);if(l||d||h){const t=dIt(s),p=t&&t.title;let g=aIt(s,{forAs:!0});const m=Object.assign(Object.assign(Object.assign({},p?[]:{title:hIt(s,e,{allowDisabling:!0})}),f),{field:g});if(l){let t;if(yEt(l)?(t="argmax",g=aIt({op:"argmax",field:l.argmax},{forAs:!0}),m.field="".concat(g,".").concat(u)):mEt(l)?(t="argmin",g=aIt({op:"argmin",field:l.argmin},{forAs:!0}),m.field="".concat(g,".").concat(u)):"boxplot"!==l&&"errorbar"!==l&&"errorband"!==l&&(t=l),t){const e={op:t,as:g};u&&(e.field=u),a.push(e)}}else if(n.push(g),JFt(s)&&fNt(h)){if(r.push({bin:h,field:u,as:g}),n.push(aIt(s,{binSuffix:"end"})),AIt(s,c)&&n.push(aIt(s,{binSuffix:"range"})),qTt(c)){const t={field:g+"_end"};o[c+"2"]=t}m.bin="binned",_Tt(c)||(m.type=DDt)}else if(d){i.push({timeUnit:d,field:u,as:g});const t=JFt(s)&&s.type!==IDt&&"time";t&&(c===KEt||c===JEt?m.formatType=t:!function(t){return!!jTt[t]}(c)?qTt(c)&&(m.axis=Object.assign({formatType:t},m.axis)):m.legend=Object.assign({formatType:t},m.legend))}o[c]=m}else n.push(u),o[c]=t[c]}else o[c]=t[c]})),{bins:r,timeUnits:i,aggregate:a,groupby:n,encoding:o}}function VIt(t,e,n){const r=e.type;return yCt(t).reduce(((i,a)=>{if(!wTt(a))return XNt(function(t){return"".concat(t,"-encoding is dropped as ").concat(t," is not a valid encoding channel.")}(a)),i;const o=t[a];if("angle"!==a||"arc"!==r||t.theta||(XNt("Arc marks uses theta channel rather than angle, replacing angle with theta."),a=IEt),!function(t,e,n){const r=sNt(e,n);if(!r)return!1;if("binned"===r){const n=t[e===TEt?CEt:EEt];return!!(YFt(n)&&YFt(t[e])&&pNt(n.bin))}return!0}(t,a,r))return XNt(MNt(a,r)),i;if(a===WEt&&"line"===r){const e=gIt(t[a]);if(null===e||void 0===e?void 0:e.aggregate)return XNt("Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead."),i}if(a===LEt&&(e.filled?"fill"in t:"stroke"in t))return XNt(FNt("encoding",{fill:"fill"in t,stroke:"stroke"in t})),i;if(a===ZEt||a===$Et&&!NAt(o)&&!tIt(o)||a===JEt&&NAt(o))o&&(i[a]=RAt(o).reduce(((t,e)=>(YFt(e)?t.push(bIt(e,a)):XNt(INt(e,a)),t)),[]));else{if(a===JEt&&null===o)i[a]=null;else if(!YFt(o)&&!KFt(o)&&!tIt(o)&&!qFt(o)&&!hDt(o))return XNt(INt(o,a)),i;i[a]=yIt(o,a,n)}return i}),{})}function qIt(t){const e=[];for(const n of yCt(t))if(jIt(t,n)){const r=RAt(t[n]);for(const t of r)YFt(t)?e.push(t):GFt(t)&&e.push(t.condition)}return e}function GIt(t,e,n){if(t)for(const r of yCt(t)){const i=t[r];if(NAt(i))for(const t of i)e.call(n,t,r);else e.call(n,i,r)}}function HIt(t,e,n,r){return t?yCt(t).reduce(((n,i)=>{const a=t[i];return NAt(a)?a.reduce(((t,n)=>e.call(r,t,n,i)),n):e.call(r,n,a,i)}),n):n}function YIt(t,e){return yCt(e).reduce(((n,r)=>{switch(r){case CEt:case EEt:case tTt:case nTt:case eTt:case TEt:case NEt:case IEt:case MEt:case DEt:case FEt:case OEt:case REt:case zEt:case BEt:case KEt:case UEt:case VEt:case JEt:return n;case $Et:if("line"===t||"trail"===t)return n;case ZEt:case QEt:{const t=e[r];if(NAt(t)||YFt(t))for(const e of RAt(t))e.aggregate||n.push(aIt(e,{}));return n}case WEt:if("trail"===t)return n;case LEt:case PEt:case jEt:case qEt:case GEt:case HEt:case XEt:case YEt:{const t=gIt(e[r]);return t&&!t.aggregate&&n.push(aIt(t,{})),n}}}),[])}function XIt(t,e,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if("tooltip"in n)return{tooltip:n.tooltip};return{tooltip:[...t.map((t=>{let{fieldPrefix:n,titlePrefix:i}=t;const a=r?" of ".concat(e.field):"";return{field:n+e.field,type:e.type,title:hDt(i)?{signal:i+'"'.concat(escape(a),'"')}:i+a}})),...qIt(n)]}}function KIt(t){const{axis:e,title:n,field:r}=t;return e&&void 0!==e.title?void 0:FCt(n,r)}function $It(t,e,n,r,i){const{scale:a,axis:o}=n;return s=>{let{partName:c,mark:u,positionPrefix:l,endPositionPrefix:h,aria:d,extraEncoding:f={}}=s;const p=KIt(n);return ZIt(t,c,i,d,{mark:u,encoding:Object.assign(Object.assign(Object.assign({[e]:Object.assign(Object.assign(Object.assign({field:l+"_"+n.field,type:n.type},void 0!==p?{title:p}:{}),void 0!==a?{scale:a}:{}),void 0!==o?{axis:o}:{})},jAt(h)?{[e+"2"]:{field:h+"_"+n.field}}:{}),r),f)})}}function ZIt(t,e,n,r,i){const{clip:a,color:o,opacity:s}=t,c=t.type;return t[e]||void 0===t[e]&&n[e]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[e]),a?{clip:a}:{}),o?{color:o}:{}),s?{opacity:s}:{}),oEt(i.mark)?i.mark:{type:i.mark}),{style:"".concat(c,"-").concat(e)}),LAt(t[e])?{}:t[e]),!1===r?{aria:r}:{})})]:[]}function QIt(t,e,n){const{encoding:r}=t,i="vertical"===e?"y":"x",a=r[i],o=r[i+"2"],s=r[i+"Error"],c=r[i+"Error2"];return{continuousAxisChannelDef:JIt(a,n),continuousAxisChannelDef2:JIt(o,n),continuousAxisChannelDefError:JIt(s,n),continuousAxisChannelDefError2:JIt(c,n),continuousAxis:i}}function JIt(t,e){if(t&&t.aggregate){const{aggregate:n}=t,r=VAt(t,["aggregate"]);return n!==e&&XNt(function(t,e){return"Continuous axis should not have customized aggregation function ".concat(t,"; ").concat(e," already agregates the axis.")}(n,e)),r}return t}function tMt(t,e){const{mark:n,encoding:r}=t,{x:i,y:a}=r;if($Ft(i)){if($Ft(a)){const t=YFt(i)&&i.aggregate,r=YFt(a)&&a.aggregate;if(t||r!==e){if(r||t!==e){if(t===e&&r===e)throw new Error("Both x and y cannot have aggregate");return oEt(n)&&n.orient?n.orient:"vertical"}return"horizontal"}return"vertical"}return"horizontal"}if($Ft(a))return"vertical";throw new Error("Need a valid continuous axis for "+e+"s")}const eMt="boxplot",nMt=new fEt(eMt,iMt);function rMt(t){return PAt(t)?"tukey":t}function iMt(t,e){let{config:n}=e;var r,i;const{mark:a,encoding:o,selection:s,projection:c}=t,u=VAt(t,["mark","encoding","selection","projection"]),l=oEt(a)?a:{type:a};s&&XNt(ANt("boxplot"));const h=null!==(r=l.extent)&&void 0!==r?r:n.boxplot.extent,d=IIt("size",l,n),f=rMt(h),{transform:p,continuousAxisChannelDef:g,continuousAxis:m,groupby:y,aggregate:v,encodingWithoutContinuousAxis:b,ticksOrient:x,boxOrient:w,customTooltipWithoutAggregatedField:k}=function(t,e,n){const r=tMt(t,eMt),{continuousAxisChannelDef:i,continuousAxis:a}=QIt(t,r,eMt),o=i.field,s=rMt(e),c=[...aMt(o),{op:"median",field:o,as:"mid_box_"+o},{op:"min",field:o,as:("min-max"===s?"lower_whisker_":"min_")+o},{op:"max",field:o,as:("min-max"===s?"upper_whisker_":"max_")+o}],u="min-max"===s||"tukey"===s?[]:[{calculate:'datum["upper_box_'.concat(o,'"] - datum["lower_box_').concat(o,'"]'),as:"iqr_"+o},{calculate:'min(datum["upper_box_'.concat(o,'"] + datum["iqr_').concat(o,'"] * ').concat(e,', datum["max_').concat(o,'"])'),as:"upper_whisker_"+o},{calculate:'max(datum["lower_box_'.concat(o,'"] - datum["iqr_').concat(o,'"] * ').concat(e,', datum["min_').concat(o,'"])'),as:"lower_whisker_"+o}],l=t.encoding,h=a,d=(l[h],VAt(l,["symbol"===typeof h?h:h+""])),{customTooltipWithoutAggregatedField:f,filteredEncoding:p}=function(t){const{tooltip:e}=t,n=VAt(t,["tooltip"]);if(!e)return{filteredEncoding:t};let r,i;if(NAt(e)){for(const t of e)t.aggregate?(r||(r=[]),r.push(t)):(i||(i=[]),i.push(t));r&&(n.tooltip=r)}else e.aggregate?n.tooltip=e:i=e;return NAt(i)&&1===i.length&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}(d),{bins:g,timeUnits:m,aggregate:y,groupby:v,encoding:b}=WIt(p,n),x="vertical"===r?"horizontal":"vertical",w=r,k=[...g,...m,{aggregate:[...y,...c],groupby:v},...u];return{transform:k,groupby:v,aggregate:y,continuousAxisChannelDef:i,continuousAxis:a,encodingWithoutContinuousAxis:b,ticksOrient:x,boxOrient:w,customTooltipWithoutAggregatedField:f}}(t,h,n),{color:_,size:S}=b,A=VAt(b,["color","size"]),C=t=>$It(l,m,g,t,n.boxplot),E=C(A),T=C(b),N=C(Object.assign(Object.assign({},A),S?{size:S}:{})),D=XIt([{fieldPrefix:"min-max"===f?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===f?"lower_whisker_":"min_",titlePrefix:"Min"}],g,b),F={type:"tick",color:"black",opacity:1,orient:x,invalid:null},I="min-max"===f?D:XIt([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],g,b),M=[...E({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",aria:!1,extraEncoding:I}),...E({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",aria:!1,extraEncoding:I}),...E({partName:"ticks",mark:F,positionPrefix:"lower_whisker",aria:!1,extraEncoding:I}),...E({partName:"ticks",mark:F,positionPrefix:"upper_whisker",aria:!1,extraEncoding:I})],O=[..."tukey"!==f?M:[],...T({partName:"box",mark:Object.assign(Object.assign({type:"bar"},d?{size:d}:{}),{orient:w,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",aria:!1,extraEncoding:D}),...N({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},DAt(n.boxplot.median)&&n.boxplot.median.color?{color:n.boxplot.median.color}:{}),d?{size:d}:{}),{orient:x,ariaRoleDescription:"box"}),positionPrefix:"mid_box",extraEncoding:D})];let R;if("min-max"!==f){const t='datum["lower_box_'.concat(g.field,'"]'),e='datum["upper_box_'.concat(g.field,'"]'),r="(".concat(e," - ").concat(t,")"),i="".concat(t," - ").concat(h," * ").concat(r),a="".concat(e," + ").concat(h," * ").concat(r),o='datum["'.concat(g.field,'"]'),s={joinaggregate:aMt(g.field),groupby:y};let c;"tukey"===f&&(c={transform:[{filter:"(".concat(i," <= ").concat(o,") && (").concat(o," <= ").concat(a,")")},{aggregate:[{op:"min",field:g.field,as:"lower_whisker_"+g.field},{op:"max",field:g.field,as:"upper_whisker_"+g.field},{op:"min",field:"lower_box_"+g.field,as:"lower_box_"+g.field},{op:"max",field:"upper_box_"+g.field,as:"upper_box_"+g.field},...v],groupby:y}],layer:M});const{tooltip:u}=A,d=VAt(A,["tooltip"]),{scale:p,axis:b}=g,x=KIt(g),w=ZIt(l,"outliers",n.boxplot,!0,{transform:[{filter:"(".concat(o," < ").concat(i,") || (").concat(o," > ").concat(a,")")}],mark:"point",encoding:Object.assign(Object.assign({[m]:Object.assign(Object.assign(Object.assign({field:g.field,type:g.type},void 0!==x?{title:x}:{}),void 0!==p?{scale:p}:{}),void 0!==b?{axis:b}:{})},d),k?{tooltip:k}:{})})[0];w&&c?R={transform:[s],layer:[w,c]}:w?(R=w,R.transform.unshift(s)):c&&(R=c,R.transform.unshift(s))}return R?Object.assign(Object.assign({},u),{layer:[R,{transform:p,layer:O}]}):Object.assign(Object.assign({},u),{transform:(null!==(i=u.transform)&&void 0!==i?i:[]).concat(p),layer:O})}function aMt(t){return[{op:"q1",field:t,as:"lower_box_"+t},{op:"q3",field:t,as:"upper_box_"+t}]}const oMt="errorbar",sMt=new fEt(oMt,cMt);function cMt(t,e){let{config:n}=e;const{transform:r,continuousAxisChannelDef:i,continuousAxis:a,encodingWithoutContinuousAxis:o,ticksOrient:s,markDef:c,outerSpec:u,tooltipEncoding:l}=lMt(t,oMt,n),h=$It(c,a,i,o,n.errorbar),d={type:"tick",orient:s},f=[...h({partName:"ticks",mark:d,positionPrefix:"lower",aria:!1,extraEncoding:l}),...h({partName:"ticks",mark:d,positionPrefix:"upper",aria:!1,extraEncoding:l}),...h({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar"},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return Object.assign(Object.assign(Object.assign({},u),{transform:r}),f.length>1?{layer:f}:Object.assign({},f[0]))}function uMt(t,e){const{encoding:n}=t;if(function(t){return(QFt(t.x)||QFt(t.y))&&!QFt(t.x2)&&!QFt(t.y2)&&!QFt(t.xError)&&!QFt(t.xError2)&&!QFt(t.yError)&&!QFt(t.yError2)}(n))return{orient:tMt(t,e),inputType:"raw"};const r=function(t){return QFt(t.x2)||QFt(t.y2)}(n),i=function(t){return QFt(t.xError)||QFt(t.xError2)||QFt(t.yError)||QFt(t.yError2)}(n),a=n.x,o=n.y;if(r){if(i)throw new Error("".concat(e," cannot be both type aggregated-upper-lower and aggregated-error"));const t=n.x2,r=n.y2;if(QFt(t)&&QFt(r))throw new Error("".concat(e," cannot have both x2 and y2"));if(QFt(t)){if($Ft(a))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error("Both x and x2 have to be quantitative in ".concat(e))}if(QFt(r)){if($Ft(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error("Both y and y2 have to be quantitative in ".concat(e))}throw new Error("No ranged axis")}{const t=n.xError,r=n.xError2,i=n.yError,s=n.yError2;if(QFt(r)&&!QFt(t))throw new Error("".concat(e," cannot have xError2 without xError"));if(QFt(s)&&!QFt(i))throw new Error("".concat(e," cannot have yError2 without yError"));if(QFt(t)&&QFt(i))throw new Error("".concat(e," cannot have both xError and yError with both are quantiative"));if(QFt(t)){if($Ft(a))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(QFt(i)){if($Ft(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function lMt(t,e,n){var r;const{mark:i,encoding:a,selection:o,projection:s}=t,c=VAt(t,["mark","encoding","selection","projection"]),u=oEt(i)?i:{type:i};o&&XNt(ANt(e));const{orient:l,inputType:h}=uMt(t,e),{continuousAxisChannelDef:d,continuousAxisChannelDef2:f,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:g,continuousAxis:m}=QIt(t,l,e),{errorBarSpecificAggregate:y,postAggregateCalculates:v,tooltipSummary:b,tooltipTitleWithFieldName:x}=function(t,e,n,r,i,a,o,s){let c=[],u=[];const l=e.field;let h,d=!1;if("raw"===a){const e=t.center?t.center:t.extent?"iqr"===t.extent?"median":"mean":s.errorbar.center,n=t.extent?t.extent:"mean"===e?"stderr":"iqr";if("median"===e!==("iqr"===n)&&XNt(function(t,e,n){return"".concat(t," is not usually used with ").concat(e," for ").concat(n,".")}(e,n,o)),"stderr"===n||"stdev"===n)c=[{op:n,field:l,as:"extent_"+l},{op:e,field:l,as:"center_"+l}],u=[{calculate:'datum["center_'.concat(l,'"] + datum["extent_').concat(l,'"]'),as:"upper_"+l},{calculate:'datum["center_'.concat(l,'"] - datum["extent_').concat(l,'"]'),as:"lower_"+l}],h=[{fieldPrefix:"center_",titlePrefix:SCt(e)},{fieldPrefix:"upper_",titlePrefix:hMt(e,n,"+")},{fieldPrefix:"lower_",titlePrefix:hMt(e,n,"-")}],d=!0;else{let e,r,i;t.center&&t.extent&&XNt(function(t,e){return"Center is not needed to be specified in ".concat(e," when extent is ").concat(t,".")}(t.extent,o)),"ci"===n?(e="mean",r="ci0",i="ci1"):(e="median",r="q1",i="q3"),c=[{op:r,field:l,as:"lower_"+l},{op:i,field:l,as:"upper_"+l},{op:e,field:l,as:"center_"+l}],h=[{fieldPrefix:"upper_",titlePrefix:hIt({field:l,aggregate:i,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:hIt({field:l,aggregate:r,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:hIt({field:l,aggregate:e,type:"quantitative"},s,{allowDisabling:!1})}]}}else{(t.center||t.extent)&&XNt(function(t,e){return"".concat(e?"extent ":"").concat(e&&t?"and ":"").concat(t?"center ":"").concat(e&&t?"are ":"is ","not needed when data are aggregated.")}(t.center,t.extent)),"aggregated-upper-lower"===a?(h=[],u=[{calculate:'datum["'.concat(n.field,'"]'),as:"upper_"+l},{calculate:'datum["'.concat(l,'"]'),as:"lower_"+l}]):"aggregated-error"===a&&(h=[{fieldPrefix:"",titlePrefix:l}],u=[{calculate:'datum["'.concat(l,'"] + datum["').concat(r.field,'"]'),as:"upper_"+l}],i?u.push({calculate:'datum["'.concat(l,'"] + datum["').concat(i.field,'"]'),as:"lower_"+l}):u.push({calculate:'datum["'.concat(l,'"] - datum["').concat(r.field,'"]'),as:"lower_"+l}));for(const t of u)h.push({fieldPrefix:t.as.substring(0,6),titlePrefix:TCt(TCt(t.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:u,errorBarSpecificAggregate:c,tooltipSummary:h,tooltipTitleWithFieldName:d}}(u,d,f,p,g,h,e,n),w=a,k=m,_=(w[k],"x"===m?"x2":"y2"),S=(w[_],"x"===m?"xError":"yError"),A=(w[S],"x"===m?"xError2":"yError2"),C=(w[A],VAt(w,["symbol"===typeof k?k:k+"","symbol"===typeof _?_:_+"","symbol"===typeof S?S:S+"","symbol"===typeof A?A:A+""])),{bins:E,timeUnits:T,aggregate:N,groupby:D,encoding:F}=WIt(C,n),I=[...N,...y],M="raw"!==h?[]:D,O=XIt(b,d,F,x);return{transform:[...null!==(r=c.transform)&&void 0!==r?r:[],...E,...T,...0===I.length?[]:[{aggregate:I,groupby:M}],...v],groupby:M,continuousAxisChannelDef:d,continuousAxis:m,encodingWithoutContinuousAxis:F,ticksOrient:"vertical"===l?"horizontal":"vertical",markDef:u,outerSpec:c,tooltipEncoding:O}}function hMt(t,e,n){return SCt(t)+" "+n+" "+e}const dMt="errorband",fMt=new fEt(dMt,pMt);function pMt(t,e){let{config:n}=e;const{transform:r,continuousAxisChannelDef:i,continuousAxis:a,encodingWithoutContinuousAxis:o,markDef:s,outerSpec:c,tooltipEncoding:u}=lMt(t,dMt,n),l=s,h=$It(l,a,i,o,n.errorband),d=void 0!==t.encoding.x&&void 0!==t.encoding.y;let f={type:d?"area":"rect"},p={type:d?"line":"rule"};const g=Object.assign(Object.assign({},l.interpolate?{interpolate:l.interpolate}:{}),l.tension&&l.interpolate?{tension:l.tension}:{});return d?(f=Object.assign(Object.assign(Object.assign({},f),g),{ariaRoleDescription:"errorband"}),p=Object.assign(Object.assign({},p),g)):l.interpolate?XNt(VNt("interpolate")):l.tension&&XNt(VNt("tension")),Object.assign(Object.assign({},c),{transform:r,layer:[...h({partName:"band",mark:f,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...h({partName:"borders",mark:p,positionPrefix:"lower",aria:!1,extraEncoding:u}),...h({partName:"borders",mark:p,positionPrefix:"upper",aria:!1,extraEncoding:u})]})}const gMt={};function mMt(t,e,n){const r=new fEt(t,e);gMt[t]={normalizer:r,parts:n}}mMt(eMt,iMt,["box","median","outliers","rule","ticks"]),mMt(oMt,cMt,["ticks","rule"]),mMt(dMt,pMt,["band","borders"]);const yMt=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],vMt=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],bMt={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},xMt={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},wMt=(yCt(xMt),"_vgsid_"),kMt={single:{on:"click",fields:[wMt],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[wMt],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function _Mt(t){return!!t&&("legend"===t||!!t.legend)}function SMt(t){return _Mt(t)&&DAt(t)}function AMt(t){return"concat"in t}function CMt(t){return"vconcat"in t}function EMt(t){return"hconcat"in t}function TMt(t){return DAt(t)&&void 0!==t.step}function NMt(t){return t.view||t.width||t.height}const DMt=yCt({align:1,bounds:1,center:1,columns:1,spacing:1});function FMt(t,e){var n;return null!==(n=t[e])&&void 0!==n?n:t["width"===e?"continuousWidth":"continuousHeight"]}function IMt(t,e){const n=MMt(t,e);return TMt(n)?n.step:OMt}function MMt(t,e){var n;return FCt(null!==(n=t[e])&&void 0!==n?n:t["width"===e?"discreteWidth":"discreteHeight"],{step:t.step})}const OMt=20;const RMt={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:OMt},mark:{color:"#4c78a8",invalid:"filter",timeUnitBand:1},arc:{},area:{},bar:lEt,circle:{},geoshape:{},image:{},line:{},point:{},rect:hEt,rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:kMt,style:{},title:{},facet:{spacing:20},concat:{spacing:20}},zMt=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],BMt={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},LMt={blue:zMt[0],orange:zMt[1],red:zMt[2],teal:zMt[3],green:zMt[4],yellow:zMt[5],purple:zMt[6],pink:zMt[7],brown:zMt[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function PMt(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:e,font:n,fontSize:r}=t,i=VAt(t,["color","font","fontSize"]);return IAt({},RMt,n?function(t){return{text:{font:t},style:{"guide-label":{font:t},"guide-title":{font:t},"group-title":{font:t},"group-subtitle":{font:t}}}}(n):{},e?function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{signals:[{name:"color",value:DAt(t)?Object.assign(Object.assign({},LMt),t):LMt}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}(e):{},r?function(t){return{signals:[{name:"fontSize",value:DAt(t)?Object.assign(Object.assign({},BMt),t):BMt}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}(r):{},i||{})}const jMt=["view",...aEt],UMt=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],WMt=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},{area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]});function VMt(t){t=nCt(t);for(const e of UMt)delete t[e];if(t.axis)for(const e in t.axis)zCt(t.axis[e])&&delete t.axis[e];if(t.legend)for(const e of yMt)delete t.legend[e];if(t.mark){for(const e of cEt)delete t.mark[e];t.mark.tooltip&&DAt(t.mark.tooltip)&&delete t.mark.tooltip}for(const e of jMt){for(const r of cEt)delete t[e][r];const n=WMt[e];if(n)for(const r of n)delete t[e][r];qMt(t,e)}for(const e of yCt(gMt))delete t[e];!function(t){const{titleMarkConfig:e,subtitleMarkConfig:n,subtitle:r}=CIt(t.title);mCt(e)||(t.style["group-title"]=Object.assign(Object.assign({},t.style["group-title"]),e));mCt(n)||(t.style["group-subtitle"]=Object.assign(Object.assign({},t.style["group-subtitle"]),n));mCt(r)?delete t.title:t.title=r}(t);for(const e in t)DAt(t[e])&&mCt(t[e])&&delete t[e];return mCt(t)?void 0:t}function qMt(t,e,n,r){const i=r?t[e][r]:t[e];"view"===e&&(n="cell");const a=Object.assign(Object.assign({},i),t.style[null!==n&&void 0!==n?n:e]);mCt(a)||(t.style[null!==n&&void 0!==n?n:e]=a),r||delete t[e]}function GMt(t){return"layer"in t}class HMt{map(t,e){return PFt(t)?this.mapFacet(t,e):function(t){return"repeat"in t}(t)?this.mapRepeat(t,e):EMt(t)?this.mapHConcat(t,e):CMt(t)?this.mapVConcat(t,e):AMt(t)?this.mapConcat(t,e):this.mapLayerOrUnit(t,e)}mapLayerOrUnit(t,e){if(GMt(t))return this.mapLayer(t,e);if(dEt(t))return this.mapUnit(t,e);throw new Error(vNt(t))}mapLayer(t,e){return Object.assign(Object.assign({},t),{layer:t.layer.map((t=>this.mapLayerOrUnit(t,e)))})}mapHConcat(t,e){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map((t=>this.map(t,e)))})}mapVConcat(t,e){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map((t=>this.map(t,e)))})}mapConcat(t,e){const{concat:n}=t,r=VAt(t,["concat"]);return Object.assign(Object.assign({},r),{concat:n.map((t=>this.map(t,e)))})}mapFacet(t,e){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,e)})}mapRepeat(t,e){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,e)})}}const YMt={zero:1,center:1,normalize:1};const XMt=new Set([VCt,GCt,qCt,$Ct,XCt,tEt,eEt,YCt,ZCt,QCt]),KMt=new Set([GCt,qCt,VCt]);function $Mt(t,e){var n,r;const i="x"===e?"y":"radius",a=t[e],o=t[i];if(YFt(a)&&YFt(o))if("quantitative"===XFt(a)&&"quantitative"===XFt(o)){if(a.stack)return e;if(o.stack)return i;const t=YFt(a)&&!!a.aggregate;if(t!==(YFt(o)&&!!o.aggregate))return t?e:i;{const t=null===(n=a.scale)||void 0===n?void 0:n.type,s=null===(r=o.scale)||void 0===r?void 0:r.type;if(t&&"linear"!==t)return i;if(s&&"linear"!==s)return e}}else{if("quantitative"===XFt(a))return e;if("quantitative"===XFt(o))return i}else{if("quantitative"===XFt(a))return e;if("quantitative"===XFt(o))return i}}function ZMt(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=oEt(t)?t.type:t;if(!XMt.has(r))return null;const i=$Mt(e,"x")||$Mt(e,"theta");if(!i)return null;const a=e[i],o=YFt(a)?aIt(a,{}):void 0;let s=function(t){switch(t){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}(i),c=e[s],u=YFt(c)?aIt(c,{}):void 0;u===o&&(u=void 0,c=void 0,s=void 0);const l=UTt.reduce(((t,n)=>{if("tooltip"!==n&&jIt(e,n)){const r=e[n];for(const e of RAt(r)){const r=gIt(e);if(r.aggregate)continue;const i=aIt(r,{});i&&i===u||t.push({channel:n,fieldDef:r})}}return t}),[]);let h;if(void 0!==a.stack?h=LAt(a.stack)?a.stack?"zero":null:a.stack:l.length>0&&KMt.has(r)&&(h="zero"),!h||!function(t){return t in YMt}(h))return null;if(UIt(e)&&0===l.length)return null;if(a.scale&&a.scale.type&&a.scale.type!==zDt.LINEAR){if(n.disallowNonLinearStack)return null;XNt(function(t){return"Cannot stack non-linear scale (".concat(t,").")}(a.scale.type))}return QFt(e[CTt(i)])?(void 0!==a.stack&&XNt('Cannot stack "'.concat(d=i,'" if there is already "').concat(d,'2".')),null):(YFt(a)&&a.aggregate&&!cCt(wEt,a.aggregate)&&XNt((f=a.aggregate,'Stacking is applied even though the aggregate function is non-summative ("'.concat(f,'").'))),{groupbyChannel:c?s:void 0,groupbyField:u,fieldChannel:i,impute:null!==a.impute&&rEt(r),stackBy:l,offset:h});var d,f}function QMt(t){const{point:e,line:n}=t,r=VAt(t,["point","line"]);return yCt(r).length>1?r:r.type}function JMt(t){for(const e of["line","area","rule","trail"])t[e]&&(t=Object.assign(Object.assign({},t),{[e]:iCt(t[e],["point","line"])}));return t}function tOt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return"transparent"===t.point?{opacity:0}:t.point?DAt(t.point)?t.point:{}:void 0!==t.point?null:e.point||n.shape?DAt(e.point)?e.point:{}:void 0}function eOt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.line?!0===t.line?{}:t.line:void 0!==t.line?null:e.line?!0===e.line?{}:e.line:void 0}class nOt{constructor(){this.name="path-overlay"}hasMatchingType(t,e){if(dEt(t)){const{mark:n,encoding:r}=t,i=oEt(n)?n:{type:n};switch(i.type){case"line":case"rule":case"trail":return!!tOt(i,e[i.type],r);case"area":return!!tOt(i,e[i.type],r)||!!eOt(i,e[i.type])}}return!1}run(t,e,n){const{config:r}=e,{selection:i,projection:a,encoding:o,mark:s}=t,c=VAt(t,["selection","projection","encoding","mark"]),u=oEt(s)?s:{type:s},l=tOt(u,r[u.type],o),h="area"===u.type&&eOt(u,r[u.type]),d=[Object.assign(Object.assign({},i?{selection:i}:{}),{mark:QMt(Object.assign(Object.assign({},"area"===u.type&&void 0===u.opacity&&void 0===u.fillOpacity?{opacity:.7}:{}),u)),encoding:iCt(o,["shape"])})],f=ZMt(u,o);let p=o;if(f){const{fieldChannel:t,offset:e}=f;p=Object.assign(Object.assign({},o),{[t]:Object.assign(Object.assign({},o[t]),e?{stack:e}:{})})}return h&&d.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"line"},rCt(u,["clip","interpolate","tension","tooltip"])),h),encoding:p})),l&&d.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},rCt(u,["clip","tooltip"])),l),encoding:p})),n(Object.assign(Object.assign({},c),{layer:d}),Object.assign(Object.assign({},e),{config:JMt(r)}))}}class rOt{constructor(){this.name="RangeStep"}hasMatchingType(t){var e;if(dEt(t)&&t.encoding)for(const n of VTt){const r=t.encoding[n];if(r&&QFt(r)&&(null===(e=null===r||void 0===r?void 0:r.scale)||void 0===e?void 0:e.rangeStep))return!0}return!1}run(t){var e;const n={};let r=Object.assign({},t.encoding);for(const i of VTt){const t=ETt(i),a=r[i];if(a&&QFt(a)&&(null===(e=null===a||void 0===a?void 0:a.scale)||void 0===e?void 0:e.rangeStep)){const{scale:e}=a,o=VAt(a,["scale"]),s=e,{rangeStep:c}=s,u=VAt(s,["rangeStep"]);n[t]={step:e.rangeStep},XNt('Scale\'s "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.'),r=Object.assign(Object.assign({},r),{[i]:Object.assign(Object.assign({},o),mCt(u)?{}:{scale:u})})}}return Object.assign(Object.assign(Object.assign({},n),t),{encoding:r})}}function iOt(t,e){return e?BFt(t)?lOt(t,e):sOt(t,e):t}function aOt(t,e){return e?lOt(t,e):t}function oOt(t,e,n){const r=e[t];return function(t){return t&&!jAt(t)&&"repeat"in t}(r)?r.repeat in n?Object.assign(Object.assign({},e),{[t]:n[r.repeat]}):void XNt(function(t){return'Unknown repeated value "'.concat(t,'".')}(r.repeat)):e}function sOt(t,e){if(void 0!==(t=oOt("field",t,e))){if(null===t)return null;if(UFt(t)&&RFt(t.sort)){const n=oOt("field",t.sort,e);t=Object.assign(Object.assign({},t),n?{sort:n}:{})}return t}}function cOt(t,e){if(YFt(t))return sOt(t,e);{const n=oOt("datum",t,e);return n===t||n.type||(n.type="nominal"),n}}function uOt(t,e){if(!QFt(t)){if(HFt(t)){const n=cOt(t.condition,e);if(n)return Object.assign(Object.assign({},t),{condition:n});{const{condition:e}=t;return VAt(t,["condition"])}}return t}{const n=cOt(t,e);if(n)return n;if(qFt(t))return{condition:t.condition}}}function lOt(t,e){const n={};for(const r in t)if(BAt(t,r)){const i=t[r];if(NAt(i))n[r]=i.map((t=>uOt(t,e))).filter((t=>t));else{const t=uOt(i,e);void 0!==t&&(n[r]=t)}}return n}class hOt{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(dEt(t)){const{encoding:e,mark:n}=t;if("line"===n)for(const t of kTt){const n=e[STt(t)];if(e[t]&&(YFt(n)&&!pNt(n.bin)||KFt(n)))return!0}}return!1}run(t,e,n){const{encoding:r}=t;var i,a;return XNt((i=!!r.x2,a=!!r.y2,"Line mark is for continuous lines and thus cannot be used with ".concat(i&&a?"x2 and y2":i?"x2":"y2",". We will use the rule mark (line segments) instead."))),n(Object.assign(Object.assign({},t),{mark:"rule"}),e)}}function dOt(t){const{parentEncoding:e,encoding:n}=t;if(e&&n){const t=yCt(e).reduce(((t,e)=>(n[e]&&t.push(e),t)),[]);t.length>0&&XNt("Layer's shared ".concat((r=t).join(",")," channel ").concat(1===r.length?"is":"are"," overriden."))}var r;const i=Object.assign(Object.assign({},null!==e&&void 0!==e?e:{}),null!==n&&void 0!==n?n:{});return mCt(i)?void 0:i}function fOt(t){const{parentProjection:e,projection:n}=t;return e&&n&&XNt(function(t){const{parentProjection:e,projection:n}=t;return"Layer's shared projection ".concat(aCt(e)," is overridden by a child projection ").concat(aCt(n),".")}({parentProjection:e,projection:n})),null!==n&&void 0!==n?n:e}function pOt(t,e){void 0===e&&(e=PMt(t.config));const n=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return gOt.map(t,{config:e})}(t,e),{width:r,height:i}=t,a=function(t,e,n){let{width:r,height:i}=e;const a=dEt(t)||GMt(t),o={};a?"container"==r&&"container"==i?(o.type="fit",o.contains="padding"):"container"==r?(o.type="fit-x",o.contains="padding"):"container"==i&&(o.type="fit-y",o.contains="padding"):("container"==r&&(XNt(xNt("width")),r=void 0),"container"==i&&(XNt(xNt("height")),i=void 0));const s=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?mOt(n.autosize):{}),mOt(t.autosize));"fit"!==s.type||a||(XNt(bNt),s.type="pad");"container"==r&&"fit"!=s.type&&"fit-x"!=s.type&&XNt(wNt("width"));"container"==i&&"fit"!=s.type&&"fit-y"!=s.type&&XNt(wNt("height"));if(eCt(s,{type:"pad"}))return;return s}(n,{width:r,height:i,autosize:t.autosize},e);return Object.assign(Object.assign({},n),a?{autosize:a}:{})}const gOt=new class extends HMt{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[nMt,sMt,fMt,new nOt,new hOt,new rOt]}map(t,e){if(dEt(t)){const n=jIt(t.encoding,_Et),r=jIt(t.encoding,SEt),i=jIt(t.encoding,AEt);if(n||r||i)return this.mapFacetedUnit(t,e)}return super.map(t,e)}mapUnit(t,e){const{parentEncoding:n,parentProjection:r}=e,i=Object.assign(Object.assign({},t),{encoding:aOt(t.encoding,e.repeater)});if(n||r)return this.mapUnitWithParentEncodingOrProjection(i,e);const a=this.mapLayerOrUnit.bind(this);for(const o of this.nonFacetUnitNormalizers)if(o.hasMatchingType(i,e.config))return o.run(i,e,a);return i}mapRepeat(t,e){return function(t){return!NAt(t.repeat)&&t.repeat.layer}(t)?this.mapLayerRepeat(t,e):this.mapNonLayerRepeat(t,e)}mapLayerRepeat(t,e){const{repeat:n,spec:r}=t,i=VAt(t,["repeat","spec"]),{row:a,column:o,layer:s}=n,{repeater:c={},repeaterPrefix:u=""}=e;return a||o?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},a?{row:a}:{}),o?{column:o}:{}),spec:{repeat:{layer:s},spec:r}}),e):Object.assign(Object.assign({},i),{layer:s.map((t=>{const n=Object.assign(Object.assign({},c),{layer:t}),i=(r.name||"")+u+"child__layer_".concat(wCt(t)),a=this.mapLayerOrUnit(r,Object.assign(Object.assign({},e),{repeater:n,repeaterPrefix:i}));return a.name=i,a}))})}mapNonLayerRepeat(t,e){var n;const{repeat:r,spec:i,data:a}=t,o=VAt(t,["repeat","spec","data"]);!NAt(r)&&t.columns&&(t=iCt(t,["columns"]),XNt(CNt("repeat")));const s=[],{repeater:c={},repeaterPrefix:u=""}=e,l=!NAt(r)&&r.row||[c?c.row:null],h=!NAt(r)&&r.column||[c?c.column:null],d=NAt(r)&&r||[c?c.repeat:null];for(const p of d)for(const t of l)for(const n of h){const a={repeat:p,row:t,column:n,layer:c.layer},o=(i.name||"")+u+"child__"+(NAt(r)?"".concat(wCt(p)):(r.row?"row_".concat(wCt(t)):"")+(r.column?"column_".concat(wCt(n)):"")),l=this.map(i,Object.assign(Object.assign({},e),{repeater:a,repeaterPrefix:o}));l.name=o,s.push(iCt(l,["data"]))}const f=NAt(r)?t.columns:r.column?r.column.length:1;return Object.assign(Object.assign({data:null!==(n=i.data)&&void 0!==n?n:a,align:"all"},o),{columns:f,concat:s})}mapFacet(t,e){const{facet:n}=t;return BFt(n)&&t.columns&&(t=iCt(t,["columns"]),XNt(CNt("facet"))),super.mapFacet(t,e)}mapUnitWithParentEncodingOrProjection(t,e){const{encoding:n,projection:r}=t,{parentEncoding:i,parentProjection:a,config:o}=e,s=fOt({parentProjection:a,projection:r}),c=dOt({parentEncoding:i,encoding:aOt(n,e.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),s?{projection:s}:{}),c?{encoding:c}:{}),{config:o})}mapFacetedUnit(t,e){const n=t.encoding,{row:r,column:i,facet:a}=n,o=VAt(n,["row","column","facet"]),{mark:s,width:c,projection:u,height:l,view:h,selection:d,encoding:f}=t,p=VAt(t,["mark","width","projection","height","view","selection","encoding"]),{facetMapping:g,layout:m}=this.getFacetMappingAndLayout({row:r,column:i,facet:a},e),y=aOt(o,e.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},p),m),{facet:g,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},c?{width:c}:{}),l?{height:l}:{}),h?{view:h}:{}),u?{projection:u}:{}),{mark:s,encoding:y}),d?{selection:d}:{})}),e)}getFacetMappingAndLayout(t,e){var n;const{row:r,column:i,facet:a}=t;if(r||i){a&&XNt((o=[...r?[_Et]:[],...i?[SEt]:[]],"Facet encoding dropped as ".concat(o.join(" and ")," ").concat(o.length>1?"are":"is"," also specified.")));const e={},s={};for(const r of[_Et,SEt]){const i=t[r];if(i){const{align:t,center:a,spacing:o,columns:c}=i,u=VAt(i,["align","center","spacing","columns"]);e[r]=u;for(const e of["align","center","spacing"])void 0!==i[e]&&(s[e]=null!==(n=s[e])&&void 0!==n?n:{},s[e][r]=i[e])}}return{facetMapping:e,layout:s}}{const{align:t,center:n,spacing:r,columns:i}=a;return{facetMapping:iOt(VAt(a,["align","center","spacing","columns"]),e.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},t?{align:t}:{}),n?{center:n}:{}),r?{spacing:r}:{}),i?{columns:i}:{})}}var o}mapLayer(t,e){var{parentEncoding:n,parentProjection:r}=e,i=VAt(e,["parentEncoding","parentProjection"]);const{encoding:a,projection:o}=t,s=VAt(t,["encoding","projection"]),c=Object.assign(Object.assign({},i),{parentEncoding:dOt({parentEncoding:n,encoding:a}),parentProjection:fOt({parentProjection:r,projection:o})});return super.mapLayer(s,c)}};function mOt(t){return jAt(t)?{type:t}:null!==t&&void 0!==t?t:{}}const yOt=["background","padding"];function vOt(t){return yOt.reduce(((e,n)=>(t&&void 0!==t[n]&&(e[n]=t[n]),e)),{})}class bOt{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.explicit=t,this.implicit=e}clone(){return new bOt(nCt(this.explicit),nCt(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return FCt(this.explicit[t],this.implicit[t])}getWithExplicit(t){return void 0!==this.explicit[t]?{explicit:!0,value:this.explicit[t]}:void 0!==this.implicit[t]?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,e){void 0!==e.value&&this.set(t,e.value,e.explicit)}set(t,e,n){return delete this[n?"implicit":"explicit"][t],this[n?"explicit":"implicit"][t]=e,this}copyKeyFromSplit(t,e){void 0!==e.explicit[t]?this.set(t,e.explicit[t],!0):void 0!==e.implicit[t]&&this.set(t,e.implicit[t],!1)}copyKeyFromObject(t,e){void 0!==e[t]&&this.set(t,e[t],!0)}copyAll(t){for(const e of yCt(t.combine())){const n=t.getWithExplicit(e);this.setWithExplicit(e,n)}}}function xOt(t){return{explicit:!0,value:t}}function wOt(t){return{explicit:!1,value:t}}function kOt(t){return(e,n,r,i)=>{const a=t(e.value,n.value);return a>0?e:a<0?n:_Ot(e,n,r,i)}}function _Ot(t,e,n,r){return t.explicit&&e.explicit&&XNt(function(t,e,n,r){return"Conflicting ".concat(e.toString(),' property "').concat(t.toString(),'" (').concat(aCt(n)," and ").concat(aCt(r),"). Using ").concat(aCt(n),".")}(n,r,t.value,e.value)),t}function SOt(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:_Ot;return void 0===t||void 0===t.value?e:t.explicit&&!e.explicit?t:e.explicit&&!t.explicit?e:eCt(t.value,e.value)?t:i(t,e,n,r)}class AOt extends bOt{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(t,e),this.explicit=t,this.implicit=e,this.parseNothing=n}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function COt(t){return"url"in t}function EOt(t){return"values"in t}function TOt(t){return"name"in t&&!COt(t)&&!EOt(t)&&!NOt(t)}function NOt(t){return t&&(DOt(t)||FOt(t)||IOt(t))}function DOt(t){return"sequence"in t}function FOt(t){return"sphere"in t}function IOt(t){return"graticule"in t}const MOt="main",OOt="raw";function ROt(t){return"filter"in t}function zOt(t){return"lookup"in t}function BOt(t){return"pivot"in t}function LOt(t){return"density"in t}function POt(t){return"quantile"in t}function jOt(t){return"regression"in t}function UOt(t){return"loess"in t}function WOt(t){return"sample"in t}function VOt(t){return"window"in t}function qOt(t){return"joinaggregate"in t}function GOt(t){return"flatten"in t}function HOt(t){return"calculate"in t}function YOt(t){return"bin"in t}function XOt(t){return"impute"in t}function KOt(t){return"timeUnit"in t}function $Ot(t){return"aggregate"in t}function ZOt(t){return"stack"in t}function QOt(t){return"fold"in t}function JOt(t,e,n,r){const i=qFt(e)&&e.condition,a=r(e);if(i){const e=RAt(i).map((e=>{const n=r(e),i=function(t){return t.selection}(e)?gLt(t,e.selection):yLt(t,e.test);return Object.assign({test:i},n)}));return{[n]:[...e,...void 0!==a?[a]:[]]}}return void 0!==a?{[n]:a}:{}}function tRt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";const n=t.encoding[e];return JOt(t,n,e,(e=>eRt(e,t.config)))}function eRt(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"datum";if(t){if(tIt(t))return TIt(t.value);if(QFt(t)){const{format:r,formatType:i}=pIt(t);return kFt({fieldOrDatumDef:t,format:r,formatType:i,expr:n,config:e})}}}function nRt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{encoding:n,markDef:r,config:i,stack:a}=t,o=n.tooltip;if(NAt(o))return{tooltip:iRt({tooltip:o},a,i,e)};{const s=e.reactiveGeom?"datum.datum":"datum";return JOt(t,o,"tooltip",(t=>{const o=eRt(t,i,s);if(o)return o;if(null===t)return;let c=IIt("tooltip",r,i);return!0===c&&(c={content:"encoding"}),jAt(c)?{value:c}:DAt(c)?"encoding"===c.content?iRt(n,a,i,e):{signal:s}:void 0}))}}function rRt(t,e,n){let{reactiveGeom:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i={},a=r?"datum.datum":"datum",o=[];function s(r,s){const c=STt(s),u=JFt(r)?r:Object.assign(Object.assign({},r),{type:t[c].type}),l=RAt(hIt(u,n,{allowDisabling:!1})).join(", ");let h;if(qTt(s)){const r="x"===s?"x2":"y2",o=gIt(t[r]);if(pNt(u.bin)&&o){const t=aIt(u,{expr:a}),e=aIt(o,{expr:a}),{format:s,formatType:c}=pIt(u);h=DFt(t,e,s,c,n),i[r]=!0}else if(e&&e.fieldChannel===s&&"normalize"===e.offset){const{format:t,formatType:e}=pIt(u);h=kFt({fieldOrDatumDef:u,format:t,formatType:e,expr:a,config:n,normalizeStack:!0}).signal}}h=null!==h&&void 0!==h?h:eRt(u,n,a).signal,o.push({channel:s,key:l,value:h})}GIt(t,((t,e)=>{YFt(t)?s(t,e):GFt(t)&&s(t.condition,e)}));const c={};for(const{channel:u,key:l,value:h}of o)i[u]||c[l]||(c[UAt(l)]=h);return c}function iRt(t,e,n){let{reactiveGeom:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=bCt(rRt(t,e,n,{reactiveGeom:r})).map((t=>{let{key:e,value:n}=t;return"".concat(e,": ").concat(n)}));return i.length>0?{signal:"{".concat(i.join(", "),"}")}:void 0}function aRt(t){const{markDef:e,config:n}=t,r=IIt("aria",e,n);return!1===r?{}:Object.assign(Object.assign(Object.assign({},r?{aria:r}:{}),function(t){const{mark:e,markDef:n,config:r}=t;if(!1===r.aria)return{};const i=IIt("ariaRoleDescription",n,r);if(null!=i)return{ariaRoleDescription:{value:i}};return e in gDt?{}:{ariaRoleDescription:{value:e}}}(t)),function(t){const{encoding:e,markDef:n,config:r,stack:i}=t,a=e.description;if(a)return JOt(t,a,"description",(e=>eRt(e,t.config)));const o=IIt("description",n,r);if(null!=o)return{description:TIt(o)};if(!1===r.aria)return{};const s=rRt(e,i,r);if(mCt(s))return;return{description:{signal:bCt(s).map((t=>{let{key:e,value:n}=t;return"".concat(e,' + ": " + (').concat(n,")")})).join(' + "; " + ')}}}(t))}function oRt(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{markDef:r,encoding:i,config:a}=e,{vgChannel:o}=n;let{defaultRef:s,defaultValue:c}=n;void 0===s&&(c=null!==c&&void 0!==c?c:IIt(t,r,a,{vgChannel:o,ignoreVgConfig:!0}),void 0!==c&&(s=TIt(c)));const u=i[t];return JOt(e,u,null!==o&&void 0!==o?o:t,(n=>yFt({channel:t,channelDef:n,markDef:r,config:a,scaleName:e.scaleName(t),scale:e.getScaleComponent(t),stack:null,defaultRef:s})))}function sRt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{filled:void 0};var n,r,i,a;const{markDef:o,encoding:s,config:c}=t,{type:u}=o,l=null!==(n=e.filled)&&void 0!==n?n:IIt("filled",o,c),h=cCt(["bar","point","circle","square","geoshape"],u)?"transparent":void 0,d=null!==(i=null!==(r=IIt(!0===l?"color":void 0,o,c,{vgChannel:"fill"}))&&void 0!==r?r:c.mark[!0===l&&"color"])&&void 0!==i?i:h,f=null!==(a=IIt(!1===l?"color":void 0,o,c,{vgChannel:"stroke"}))&&void 0!==a?a:c.mark[!1===l&&"color"],p=l?"fill":"stroke",g=Object.assign(Object.assign({},d?{fill:TIt(d)}:{}),f?{stroke:TIt(f)}:{});return o.color&&(l?o.fill:o.stroke)&&XNt(FNt("property",{fill:"fill"in o,stroke:"stroke"in o})),Object.assign(Object.assign(Object.assign(Object.assign({},g),oRt("color",t,{vgChannel:p,defaultValue:l?d:f})),oRt("fill",t,{defaultValue:s.fill?d:void 0})),oRt("stroke",t,{defaultValue:s.stroke?f:void 0}))}function cRt(t,e){const n=function(t){switch(t){case CEt:return"xOffset";case EEt:return"yOffset";case TEt:return"x2Offset";case NEt:return"y2Offset";case IEt:return"thetaOffset";case DEt:return"radiusOffset";case MEt:return"theta2Offset";case FEt:return"radius2Offset"}}(t),r=e[n];if(r)return r}function uRt(t,e,n){let{defaultPos:r,vgChannel:i,isMidPoint:a}=n;const{encoding:o,markDef:s,config:c,stack:u}=e,l=o[t],h=o[CTt(t)],d=e.scaleName(t),f=e.getScaleComponent(t),p=cRt(t,s),g=lRt({model:e,defaultPos:r,channel:t,scaleName:d,scale:f}),m=!l&&qTt(t)&&(o.latitude||o.longitude)?{field:e.getName(t)}:function(t){const{channel:e,channelDef:n,isMidPoint:r,scaleName:i,stack:a,offset:o,markDef:s,config:c}=t;if(QFt(n)&&a&&e===a.fieldChannel){if(YFt(n)){const t=WFt({channel:e,fieldDef:n,isMidPoint:r,markDef:s,stack:a,config:c});if(void 0!==t)return mFt({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",band:t,offset:o})}return gFt(n,i,{suffix:"end"},{offset:o})}return hFt(t)}({channel:t,channelDef:l,channel2Def:h,markDef:s,config:c,isMidPoint:a,scaleName:d,scale:f,stack:u,offset:p,defaultRef:g});return m?{[i||t]:m}:void 0}function lRt(t){let{model:e,defaultPos:n,channel:r,scaleName:i,scale:a}=t;const{markDef:o,config:s}=e;return()=>{const t=STt(r),c=ATt(r),u=IIt(r,o,s,{vgChannel:c});if(void 0!==u)return vFt(r,u);switch(n){case"zeroOrMin":case"zeroOrMax":if(i){const t=a.get("type");if(cCt([zDt.LOG,zDt.TIME,zDt.UTC],t));else if(a.domainDefinitelyIncludesZero())return{scale:i,value:0}}if("zeroOrMin"===n)return"y"===t?{field:{group:"height"}}:{value:0};switch(t){case"radius":return{signal:"min(".concat(e.width.signal,",").concat(e.height.signal,")/2")};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const t=e[ETt(r)];return Object.assign(Object.assign({},t),{mult:.5})}}}}const hRt={left:"x",center:"xc",right:"x2"},dRt={top:"y",middle:"yc",bottom:"y2"};function fRt(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"middle";if("radius"===t||"theta"===t)return ATt(t);const i=IIt("x"===t?"align":"baseline",e,n);return"x"===t?hRt[i||("top"===r?"left":"center")]:dRt[i||r]}function pRt(t,e,n){let{defaultPos:r,defaultPos2:i,range:a}=n;return a?gRt(t,e,{defaultPos:r,defaultPos2:i}):uRt(t,e,{defaultPos:r})}function gRt(t,e,n){let{defaultPos:r,defaultPos2:i}=n;const{markDef:a,config:o}=e,s=CTt(t),c=ETt(t),u=function(t,e,n){const{encoding:r,mark:i,markDef:a,stack:o,config:s}=t,c=STt(n),u=ETt(n),l=ATt(n),h=r[c],d=t.scaleName(c),f=t.getScaleComponent(c),p=cRt(n in r||n in a?n:c,t.markDef);if(!h&&("x2"===n||"y2"===n)&&(r.latitude||r.longitude))return{[l]:{field:t.getName(n)}};const g=function(t){let{channel:e,channelDef:n,channel2Def:r,markDef:i,config:a,scaleName:o,scale:s,stack:c,offset:u,defaultRef:l}=t;if(QFt(n)&&c&&e.charAt(0)===c.fieldChannel.charAt(0))return gFt(n,o,{suffix:"start"},{offset:u});return hFt({channel:e,channelDef:r,scaleName:o,scale:s,stack:c,markDef:i,config:a,offset:u,defaultRef:l})}({channel:n,channelDef:h,channel2Def:r[n],markDef:a,config:s,scaleName:d,scale:f,stack:o,offset:p,defaultRef:void 0});if(void 0!==g)return{[l]:g};return mRt(n,a)||mRt(n,{[n]:OIt(n,a,s.style),[u]:OIt(u,a,s.style)})||mRt(n,s[i])||mRt(n,s.mark)||{[l]:lRt({model:t,defaultPos:e,channel:n,scaleName:d,scale:f})()}}(e,i,s),l=u[c]?fRt(t,a,o):ATt(t);return Object.assign(Object.assign({},uRt(t,e,{defaultPos:r,vgChannel:l})),u)}function mRt(t,e){const n=ETt(t),r=ATt(t);return void 0!==e[r]?{[r]:vFt(t,e[r])}:void 0!==e[t]?{[r]:vFt(t,e[t])}:e[n]?{[n]:vFt(t,e[n])}:void 0}function yRt(t,e,n){var r,i,a,o;const{config:s,encoding:c,markDef:u,stack:l}=t,h=CTt(e),d=ETt(e),f=c[e],p=c[h],g=t.getScaleComponent(e),m=g?g.get("type"):void 0,y=t.scaleName(e),v=u.orient,b=null!==(i=null!==(r=c[d])&&void 0!==r?r:c.size)&&void 0!==i?i:IIt("size",u,s,{vgChannel:d}),x="bar"===n&&("x"===e?"vertical"===v:"horizontal"===v);if(YFt(f)&&(fNt(f.bin)||pNt(f.bin)||f.timeUnit&&!p)&&!b&&!XDt(m)){const n=WFt({channel:e,fieldDef:f,stack:l,markDef:u,config:s}),r=null===(a=t.component.axes[e])||void 0===a?void 0:a[0];return function(t){let{fieldDef:e,fieldDef2:n,channel:r,band:i,scaleName:a,markDef:o,spacing:s=0,axisTranslate:c,reverse:u,config:l}=t;const h=CTt(r),d=ATt(r),f=ATt(h),p=cRt(r,o);if(fNt(e.bin)||e.timeUnit)return{[f]:xRt({channel:r,fieldDef:e,scaleName:a,markDef:o,band:(1-i)/2,offset:bRt(h,s,u,c,p),config:l}),[d]:xRt({channel:r,fieldDef:e,scaleName:a,markDef:o,band:1-(1-i)/2,offset:bRt(r,s,u,c,p),config:l})};if(pNt(e.bin)){const t=gFt(e,a,{},{offset:bRt(h,s,u,c,p)});if(YFt(n))return{[f]:t,[d]:gFt(n,a,{},{offset:bRt(r,s,u,c,p)})};if(gNt(e.bin)&&e.bin.step)return{[f]:t,[d]:{signal:'scale("'.concat(a,'", ').concat(aIt(e,{expr:"datum"})," + ").concat(e.bin.step,")"),offset:bRt(r,s,u,c,p)}}}return void XNt(qNt(h))}({fieldDef:f,fieldDef2:p,channel:e,markDef:u,scaleName:y,band:n,axisTranslate:null!==(o=null===r||void 0===r?void 0:r.get("translate"))&&void 0!==o?o:.5,spacing:qTt(e)?IIt("binSpacing",u,s):void 0,reverse:g.get("reverse"),config:s})}return(QFt(f)&&XDt(m)||x)&&!p?function(t,e,n,r){var i;const{markDef:a,encoding:o,config:s,stack:c}=r,u=a.orient,l=r.scaleName(n),h=r.getScaleComponent(n),d=ETt(n),f=CTt(n),p="horizontal"===u&&"y"===n||"vertical"===u&&"x"===n,g=IIt(p?"size":d,a,s,{vgChannel:d});let m;(o.size||void 0!==g)&&(p?m=oRt("size",r,{vgChannel:d,defaultValue:g}):XNt(function(t){return'Cannot apply size to non-oriented mark "'.concat(t,'".')}(a.type)));const y=null!==(i=QFt(e)?WFt({channel:n,fieldDef:e,markDef:a,stack:c,config:s}):void 0)&&void 0!==i?i:1;m=m||{[d]:vRt(t,d,l,h,s,y)};const v="band"!==(null===h||void 0===h?void 0:h.get("type"))||!("band"in m[d]),b=fRt(n,a,s,v?"middle":"top"),x=cRt(n,a),w=hFt({channel:n,channelDef:e,markDef:a,config:s,scaleName:l,scale:h,stack:c,offset:x,defaultRef:lRt({model:r,defaultPos:"mid",channel:n,scaleName:l,scale:h}),band:v?.5:(1-y)/2});if(d)return Object.assign({[b]:w},m);{const t=ATt(f),e=m[d],n=x?Object.assign(Object.assign({},e),{offset:x}):e;return{[b]:w,[t]:NAt(w)?[w[0],Object.assign(Object.assign({},w[1]),{offset:n})]:Object.assign(Object.assign({},w),{offset:n})}}}(n,f,e,t):gRt(e,t,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function vRt(t,e,n,r,i,a){if(r){const e=r.get("type");if("point"===e||"band"===e){if(void 0!==i[t].discreteBandSize)return{value:i[t].discreteBandSize};if(e===zDt.POINT){const t=r.get("range");return dDt(t)&&PAt(t.step)?{value:t.step-2}:{value:OMt-2}}return{scale:n,band:a}}return{value:i[t].continuousBandSize}}const o=IMt(i.view,e),s=FCt(i[t].discreteBandSize,o-2);return void 0!==s?{value:s}:void 0}function bRt(t,e,n,r,i){if(iTt(t))return 0;const a="x"===t||"y2"===t?-e/2:e/2;if(hDt(n)){const t=DIt(i);return{signal:"".concat(n.signal," ? ").concat(r-a).concat(t?"-"+t:""," : ").concat(r+a).concat(t?"+"+t:"")}}if(hDt(i)){const t=r+(n?-a:a);return{signal:"".concat(t||"").concat(n?" - ":t?" + ":"").concat(i.signal)}}return i=i||0,r+(n?-i-a:+i+a)}function xRt(t){let{channel:e,fieldDef:n,scaleName:r,markDef:i,band:a,offset:o,config:s}=t;return dFt({fieldDef:n,channel:e,markDef:i,ref:mFt({scaleName:r,fieldOrDatumDef:n,band:a,offset:o}),config:s})}const wRt=new Set(["aria"]);function kRt(t,e){const{fill:n,stroke:r}="include"===e.color?sRt(t):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},function(t,e){return pDt.reduce(((n,r)=>(wRt.has(r)||void 0===t[r]||"ignore"===e[r]||(n[r]=TIt(t[r])),n)),{})}(t.markDef,e)),_Rt(t,"fill",n)),_Rt(t,"stroke",r)),oRt("opacity",t)),oRt("fillOpacity",t)),oRt("strokeOpacity",t)),oRt("strokeWidth",t)),oRt("strokeDash",t)),nRt(t)),tRt(t,"href")),aRt(t))}function _Rt(t,e,n){const{config:r,mark:i,markDef:a}=t;if("hide"===IIt("invalid",a,r)&&n&&!rEt(i)){const r=function(t,e){let{invalid:n=!1,channels:r}=e;const i=r.reduce(((e,n)=>{const r=t.getScaleComponent(n);if(r){const i=r.get("type"),a=t.vgField(n,{expr:"datum"});a&&KDt(i)&&(e[a]=!0)}return e}),{}),a=yCt(i);if(a.length>0){const t=n?"||":"&&";return a.map((t=>pFt(t,n))).join(" ".concat(t," "))}return}(t,{invalid:!0,channels:aNt});if(r)return{[e]:[{test:r,value:null},...RAt(n)]}}return n?{[e]:n}:{}}function SRt(t){const{config:e,markDef:n}=t;if(IIt("invalid",n,e)){const e=function(t,e){let{invalid:n=!1,channels:r}=e;const i=r.reduce(((e,n)=>{const r=t.getScaleComponent(n);if(r){const i=r.get("type"),a=t.vgField(n,{expr:"datum"});a&&KDt(i)&&(e[a]=!0)}return e}),{}),a=yCt(i);if(a.length>0){const t=n?"||":"&&";return a.map((t=>pFt(t,n))).join(" ".concat(t," "))}return}(t,{channels:VTt});if(e)return{defined:{signal:e}}}return{}}function ARt(t,e){if(void 0!==e)return{[t]:TIt(e)}}const CRt="voronoi",ERt={has:t=>"interval"!==t.type&&t.nearest,parse:(t,e)=>{if(e.events)for(const n of e.events)n.markname=t.getName(CRt)},marks:(t,e,n)=>{const{x:r,y:i}=e.project.hasChannel,a=t.mark;if(rEt(a))return XNt('The "nearest" transform is not supported for '.concat(a," marks.")),n;const o={name:t.getName(CRt),type:"path",interactive:!0,from:{data:t.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},nRt(t,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[t.getSizeSignalRef("width"),t.getSizeSignalRef("height")]}]};let s=0,c=!1;return n.forEach(((e,n)=>{var r;const i=null!==(r=e.name)&&void 0!==r?r:"";i===t.component.mark[0].name?s=n:i.indexOf(CRt)>=0&&(c=!0)})),c||n.splice(s+1,0,o),n}},TRt=ERt;class NRt{constructor(t,e){this.debugName=e,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,e){this._children.indexOf(t)>-1?console.warn("Attempt to add the same child twice."):void 0!==e?this._children.splice(e,0,t):this._children.push(t)}removeChild(t){const e=this._children.indexOf(t);return this._children.splice(e,1),e}remove(){let t=this._parent.removeChild(this);for(const e of this._children)e._parent=this._parent,this._parent.addChild(e,t++)}insertAsParentOf(t){const e=t.parent;e.removeChild(this),this.parent=e,t.parent=this}swapWithParent(){const t=this._parent,e=t.parent;for(const n of this._children)n.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=e,t.parent=this}}class DRt extends NRt{constructor(t,e,n,r){super(t,e),this.type=n,this.refCounts=r,this._source=this._name=e,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName="clone_"+this.debugName,t._source=this._source,t._name="clone_"+this._name,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return void 0===this._hash&&(this._hash="Output ".concat(function(t){const e=++ICt;return t?String(t)+e:e}())),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}class FRt extends NRt{constructor(t,e){super(t),this.formula=e}clone(){return new FRt(null,nCt(this.formula))}static makeFromEncoding(t,e){const n=e.reduceFieldDef(((t,n,r)=>{const{field:i,timeUnit:a}=n,o=Xjt(e)?e.encoding[CTt(r)]:void 0,s=Xjt(e)&&VFt(r,n,o,e.stack,e.markDef,e.config);if(a){const e=aIt(n,{forAs:!0});t[oCt({as:e,field:i,timeUnit:a})]=Object.assign({as:e,field:i,timeUnit:a},s?{band:!0}:{})}return t}),{});return mCt(n)?null:new FRt(t,n)}static makeFromTransform(t,e){const n=Object.assign({},e),{timeUnit:r}=n,i=VAt(n,["timeUnit"]),a=lDt(r),o=Object.assign(Object.assign({},i),{timeUnit:a});return new FRt(t,{[oCt(o)]:o})}merge(t){this.formula=Object.assign({},this.formula);for(const e in t.formula)this.formula[e]&&!t.formula[e].band||(this.formula[e]=t.formula[e]);for(const e of t.children)t.removeChild(e),e.parent=this;t.remove()}producedFields(){return new Set(vCt(this.formula).map((t=>t.as)))}dependentFields(){return new Set(vCt(this.formula).map((t=>t.field)))}hash(){return"TimeUnit ".concat(oCt(this.formula))}assemble(){const t=[];for(const e of vCt(this.formula)){const{field:n,as:r,timeUnit:i}=e,a=lDt(i),{unit:o,utc:s}=a,c=VAt(a,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:ECt(n),type:"timeunit"},o?{units:oDt(o)}:{}),s?{timezone:"utc"}:{}),c),{as:[r,"".concat(r,"_end")]}))}return t}}const IRt="_tuple_fields";class MRt{constructor(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.items=e,this.hasChannel={},this.hasField={}}}const ORt={has:()=>!0,parse:(t,e,n)=>{var r,i,a;const o=e.name,s=null!==(r=e.project)&&void 0!==r?r:e.project=new MRt,c={},u={},l=new Set,h=(t,e)=>{const n="visual"===e?t.channel:t.field;let r=wCt("".concat(o,"_").concat(n));for(let i=1;l.has(r);i++)r=wCt("".concat(o,"_").concat(n,"_").concat(i));return l.add(r),{[e]:r}};if(!n.fields&&!n.encodings){const e=t.config.selection[n.type];if(n.init)for(const t of RAt(n.init))for(const r of yCt(t))xTt[r]?(n.encodings||(n.encodings=[])).push(r):"interval"===n.type?(XNt('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=e.encodings):(n.fields||(n.fields=[])).push(r);else n.encodings=e.encodings,n.fields=e.fields}for(const d of null!==(i=n.fields)&&void 0!==i?i:[]){const t={type:"E",field:d};t.signals=Object.assign({},h(t,"data")),s.items.push(t),s.hasField[d]=t}for(const d of null!==(a=n.encodings)&&void 0!==a?a:[]){const n=t.fieldDef(d);if(n){let r=n.field;if(n.aggregate){XNt(SNt(d,n.aggregate));continue}if(!r){XNt(_Nt(d));continue}if(n.timeUnit){r=t.vgField(d);const e={timeUnit:n.timeUnit,as:r,field:n.field};u[oCt(e)]=e}if(!c[r]){let i="E";if("interval"===e.type){KDt(t.getScaleComponent(d).get("type"))&&(i="R")}else n.bin&&(i="R-RE");const a={field:r,channel:d,type:i};a.signals=Object.assign(Object.assign({},h(a,"data")),h(a,"visual")),s.items.push(c[r]=a),s.hasField[r]=s.hasChannel[d]=c[r]}}else XNt(_Nt(d))}if(n.init){const t=t=>s.items.map((e=>void 0!==t[e.channel]?t[e.channel]:t[e.field]));if("interval"===n.type)e.init=t(n.init);else{const r=RAt(n.init);e.init=r.map(t)}}mCt(u)||(s.timeUnit=new FRt(null,u))},signals:(t,e,n)=>{const r=e.name+IRt,i=n.filter((t=>t.name===r));return i.length>0?n:n.concat({name:r,value:e.project.items.map((t=>{const{signals:e,hasLegend:n}=t,r=VAt(t,["signals","hasLegend"]);return r.field=ECt(r.field),r}))})}},RRt={has:t=>"single"===t.type&&"global"===t.resolve&&t.bind&&"scales"!==t.bind&&!_Mt(t.bind),parse:(t,e,n,r)=>{r.on||delete e.events,r.clear||delete e.clear},topLevelSignals:(t,e,n)=>{const r=e.name,i=e.project,a=e.bind,o=e.init&&e.init[0],s=TRt.has(e)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach(((t,i)=>{var c,u;const l=wCt("".concat(r,"_").concat(t.field)),h=n.filter((t=>t.name===l));h.length||n.unshift(Object.assign(Object.assign({name:l},o?{init:ezt(o[i])}:{value:null}),{on:e.events?[{events:e.events,update:"datum && item().mark.marktype !== 'group' ? ".concat(s,"[").concat(UAt(t.field),"] : null")}]:[],bind:null!==(u=null!==(c=a[t.field])&&void 0!==c?c:a[t.channel])&&void 0!==u?u:a}))})),n},signals:(t,e,n)=>{const r=e.name,i=e.project,a=n.filter((t=>t.name===r+dzt))[0],o=r+IRt,s=i.items.map((t=>wCt("".concat(r,"_").concat(t.field)))),c=s.map((t=>"".concat(t," !== null"))).join(" && ");return s.length&&(a.update="".concat(c," ? {fields: ").concat(o,", values: [").concat(s.join(", "),"]} : null")),delete a.value,delete a.on,n}},zRt=RRt,BRt="_toggle",LRt={has:t=>"multi"===t.type&&!!t.toggle,signals:(t,e,n)=>n.concat({name:e.name+BRt,value:!1,on:[{events:e.events,update:e.toggle}]}),modifyExpr:(t,e)=>{const n=e.name+dzt,r=e.name+BRt;return"".concat(r," ? null : ").concat(n,", ")+("global"===e.resolve?"".concat(r," ? null : true, "):"".concat(r," ? null : {unit: ").concat(yzt(t),"}, "))+"".concat(r," ? ").concat(n," : null")}},PRt={has:t=>void 0!==t.clear&&!1!==t.clear,parse:(t,e,n)=>{n.clear&&(e.clear=jAt(n.clear)?pAt(n.clear,"scope"):n.clear)},topLevelSignals:(t,e,n)=>{if(zRt.has(e))for(const r of e.project.items){const t=n.findIndex((t=>t.name===wCt("".concat(e.name,"_").concat(r.field))));-1!==t&&n[t].on.push({events:e.clear,update:"null"})}return n},signals:(t,e,n)=>{function r(t,r){-1!==t&&n[t].on&&n[t].on.push({events:e.clear,update:r})}if("interval"===e.type)for(const i of e.project.items){const t=n.findIndex((t=>t.name===i.signals.visual));if(r(t,"[0, 0]"),-1===t){r(n.findIndex((t=>t.name===i.signals.data)),"null")}}else{let t=n.findIndex((t=>t.name===e.name+dzt));r(t,"null"),LRt.has(e)&&(t=n.findIndex((t=>t.name===e.name+BRt)),r(t,"false"))}return n}},jRt={has:t=>"interval"===t.type&&"global"===t.resolve&&t.bind&&"scales"===t.bind,parse:(t,e)=>{const n=e.scales=[];for(const r of e.project.items){const i=r.channel;if(!oNt(i))continue;const a=t.getScaleComponent(i),o=a?a.get("type"):void 0;if(!a||!KDt(o)){XNt("Scale bindings are currently only supported for scales with unbinned, continuous domains.");continue}const s={selection:e.name,field:r.field};a.set("selectionExtent",s,!0),n.push(r)}},topLevelSignals:(t,e,n)=>{const r=e.scales.filter((t=>0===n.filter((e=>e.name===t.signals.data)).length));if(!t.parent||VRt(t)||0===r.length)return n;const i=n.filter((t=>t.name===e.name))[0];let a=i.update;if(a.indexOf(pzt)>=0)i.update="{".concat(r.map((t=>"".concat(UAt(t.field),": ").concat(t.signals.data))).join(", "),"}");else{for(const t of r){const e="".concat(UAt(t.field),": ").concat(t.signals.data);a.indexOf(e)<0&&(a="".concat(a.substring(0,a.length-1),", ").concat(e,"}"))}i.update=a}return n.concat(r.map((t=>({name:t.signals.data}))))},signals:(t,e,n)=>{if(t.parent&&!VRt(t))for(const r of e.scales){const t=n.filter((t=>t.name===r.signals.data))[0];t.push="outer",delete t.value,delete t.update}return n}},URt=jRt;function WRt(t,e){const n=UAt(t.scaleName(e));return"domain(".concat(n,")")}function VRt(t){var e;return t.parent&&Zjt(t.parent)&&(null!==(e=!t.parent.parent)&&void 0!==e?e:VRt(t.parent.parent))}const qRt={has:t=>{const e="global"===t.resolve&&t.bind&&_Mt(t.bind),n=1===t.project.items.length&&t.project.items[0].field!==wMt;return e&&!n&&XNt("Legend bindings are only supported for selections over an individual field or encoding channel."),e&&n},parse:(t,e,n,r)=>{var i;if(r.on||delete e.events,r.clear||delete e.clear,r.on||r.clear){const t='event.item && indexof(event.item.mark.role, "legend") < 0';for(const n of e.events)n.filter=RAt(null!==(i=n.filter)&&void 0!==i?i:[]),n.filter.indexOf(t)<0&&n.filter.push(t)}const a=SMt(e.bind)?e.bind.legend:"click",o=jAt(a)?pAt(a,"view"):RAt(a);e.bind={legend:{merge:o}}},topLevelSignals:(t,e,n)=>{const r=e.name,i=SMt(e.bind)&&e.bind.legend,a=t=>e=>{const n=nCt(e);return n.markname=t,n};for(const o of e.project.items){if(!o.hasLegend)continue;const t="".concat(wCt(o.field),"_legend"),s="".concat(r,"_").concat(t),c=n.filter((t=>t.name===s));if(0===c.length){const r=i.merge.map(a("".concat(t,"_symbols"))).concat(i.merge.map(a("".concat(t,"_labels")))).concat(i.merge.map(a("".concat(t,"_entries"))));n.unshift(Object.assign(Object.assign({name:s},e.init?{}:{value:null}),{on:[{events:r,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:"!event.item || !datum ? null : ".concat(s),force:!0}]}))}}return n},signals:(t,e,n)=>{const r=e.name,i=e.project,a=n.find((t=>t.name===r+dzt)),o=r+IRt,s=i.items.filter((t=>t.hasLegend)).map((t=>wCt("".concat(r,"_").concat(wCt(t.field),"_legend")))),c=s.map((t=>"".concat(t," !== null"))).join(" && "),u="".concat(c," ? {fields: ").concat(o,", values: [").concat(s.join(", "),"]} : null");e.events&&s.length>0?a.on.push({events:s.map((t=>({signal:t}))),update:u}):s.length>0&&(a.update=u,delete a.value,delete a.on);const l=n.find((t=>t.name===r+BRt)),h=SMt(e.bind)&&e.bind.legend;return l&&(e.events?l.on.push(Object.assign(Object.assign({},l.on[0]),{events:h})):l.on[0].events=h),n}};const GRt="_translate_anchor",HRt="_translate_delta",YRt={has:t=>"interval"===t.type&&t.translate,signals:(t,e,n)=>{const r=e.name,i=URt.has(e),a=r+GRt,{x:o,y:s}=e.project.hasChannel;let c=pAt(e.translate,"scope");return i||(c=c.map((t=>(t.between[0].markname=r+izt,t)))),n.push({name:a,value:{},on:[{events:c.map((t=>t.between[0])),update:"{x: x(unit), y: y(unit)"+(void 0!==o?", extent_x: "+(i?WRt(t,CEt):"slice(".concat(o.signals.visual,")")):"")+(void 0!==s?", extent_y: "+(i?WRt(t,EEt):"slice(".concat(s.signals.visual,")")):"")+"}"}]},{name:r+HRt,value:{},on:[{events:c,update:"{x: ".concat(a,".x - x(unit), y: ").concat(a,".y - y(unit)}")}]}),void 0!==o&&XRt(t,e,o,"width",n),void 0!==s&&XRt(t,e,s,"height",n),n}};function XRt(t,e,n,r,i){var a;const o=e.name,s=o+GRt,c=o+HRt,u=n.channel,l=URt.has(e),h=i.filter((t=>t.name===n.signals[l?"data":"visual"]))[0],d=t.getSizeSignalRef(r).signal,f=t.getScaleComponent(u),p=f.get("type"),g=l&&u===CEt?"-":"",m="".concat(s,".extent_").concat(u),y="".concat(g).concat(c,".").concat(u," / ")+(l?"".concat(d):"span(".concat(m,")")),v="".concat(l?"log"===p?"panLog":"pow"===p?"panPow":"panLinear":"panLinear","(").concat(m,", ").concat(y)+(l&&"pow"===p?", ".concat(null!==(a=f.get("exponent"))&&void 0!==a?a:1):"")+")";h.on.push({events:{signal:c},update:l?v:"clampRange(".concat(v,", 0, ").concat(d,")")})}const KRt="_zoom_anchor",$Rt="_zoom_delta",ZRt={has:t=>"interval"===t.type&&t.zoom,signals:(t,e,n)=>{const r=e.name,i=URt.has(e),a=r+$Rt,{x:o,y:s}=e.project.hasChannel,c=UAt(t.scaleName(CEt)),u=UAt(t.scaleName(EEt));let l=pAt(e.zoom,"scope");return i||(l=l.map((t=>(t.markname=r+izt,t)))),n.push({name:r+KRt,on:[{events:l,update:i?"{"+[c?"x: invert(".concat(c,", x(unit))"):"",u?"y: invert(".concat(u,", y(unit))"):""].filter((t=>!!t)).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:a,on:[{events:l,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==o&&QRt(t,e,o,"width",n),void 0!==s&&QRt(t,e,s,"height",n),n}};function QRt(t,e,n,r,i){var a;const o=e.name,s=n.channel,c=URt.has(e),u=i.filter((t=>t.name===n.signals[c?"data":"visual"]))[0],l=t.getSizeSignalRef(r).signal,h=t.getScaleComponent(s),d=h.get("type"),f=c?WRt(t,s):u.name,p=o+$Rt,g="".concat(o).concat(KRt,".").concat(s),m="".concat(c?"log"===d?"zoomLog":"pow"===d?"zoomPow":"zoomLinear":"zoomLinear","(").concat(f,", ").concat(g,", ").concat(p)+(c&&"pow"===d?", ".concat(null!==(a=h.get("exponent"))&&void 0!==a?a:1):"")+")";u.on.push({events:{signal:p},update:c?m:"clampRange(".concat(m,", 0, ").concat(l,")")})}const JRt=[ORt,LRt,URt,qRt,YRt,ZRt,zRt,TRt,PRt];function tzt(t,e){for(const n of JRt)n.has(t)&&e(n)}function ezt(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:EAt;if(NAt(t)){const r=t.map((t=>ezt(t,e,n)));return e?"[".concat(r.join(", "),"]"):r}return KNt(t)?n(e?eDt(t):function(t){const e=tDt(t,!0);return t.utc?+new Date(Date.UTC(...e)):+new Date(...e)}(t)):e?n(JSON.stringify(t)):t}function nzt(t,e){return mzt(t,((n,r)=>{e=r.marks?r.marks(t,n,e):e,tzt(n,(r=>{r.marks&&(e=r.marks(t,n,e))}))})),e}function rzt(t){return t.map((t=>(t.on&&!t.on.length&&delete t.on,t)))}const izt="_brush",azt="_scale_trigger",ozt={signals:(t,e)=>{const n=e.name,r=n+IRt,i=URt.has(e),a=[],o=[],s=[];if(e.translate&&!i){const t="!event.item || event.item.mark.name !== ".concat(UAt(n+izt));szt(e,((e,n)=>{var r;const i=RAt(null!==(r=n.between[0].filter)&&void 0!==r?r:n.between[0].filter=[]);return i.indexOf(t)<0&&i.push(t),e}))}e.project.items.forEach(((n,r)=>{const i=n.channel;if(i!==CEt&&i!==EEt)return void XNt("Interval selections only support x and y encoding channels.");const c=e.init?e.init[r]:null,u=function(t,e,n,r){const i=n.channel,a=n.signals.visual,o=n.signals.data,s=URt.has(e),c=UAt(t.scaleName(i)),u=t.getScaleComponent(i),l=u?u.get("type"):void 0,h=t=>"scale(".concat(c,", ").concat(t,")"),d=t.getSizeSignalRef(i===CEt?"width":"height").signal,f="".concat(i,"(unit)"),p=szt(e,((t,e)=>[...t,{events:e.between[0],update:"[".concat(f,", ").concat(f,"]")},{events:e,update:"[".concat(a,"[0], clamp(").concat(f,", 0, ").concat(d,")]")}]));return p.push({events:{signal:e.name+azt},update:KDt(l)?"[".concat(h("".concat(o,"[0]")),", ").concat(h("".concat(o,"[1]")),"]"):"[0, 0]"}),s?[{name:o,on:[]}]:[Object.assign(Object.assign({name:a},r?{init:ezt(r,!0,h)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:o},r?{init:ezt(r)}:{}),{on:[{events:{signal:a},update:"".concat(a,"[0] === ").concat(a,"[1] ? null : invert(").concat(c,", ").concat(a,")")}]})]}(t,e,n,c),l=n.signals.data,h=n.signals.visual,d=UAt(t.scaleName(i)),f=KDt(t.getScaleComponent(i).get("type"))?"+":"";a.push(...u),o.push(l),s.push({scaleName:t.scaleName(i),expr:"(!isArray(".concat(l,") || ")+"(".concat(f,"invert(").concat(d,", ").concat(h,")[0] === ").concat(f).concat(l,"[0] && ")+"".concat(f,"invert(").concat(d,", ").concat(h,")[1] === ").concat(f).concat(l,"[1]))")})})),i||a.push({name:n+azt,value:{},on:[{events:s.map((t=>({scale:t.scaleName}))),update:s.map((t=>t.expr)).join(" && ")+" ? ".concat(n+azt," : {}")}]});const c=e.init,u="unit: ".concat(yzt(t),", fields: ").concat(r,", values");return a.concat(Object.assign(Object.assign({name:n+dzt},c?{init:"{".concat(u,": ").concat(ezt(c),"}")}:{}),{on:[{events:[{signal:o.join(" || ")}],update:o.join(" && ")+" ? {".concat(u,": [").concat(o,"]} : null")}]}))},modifyExpr:(t,e)=>e.name+dzt+", "+("global"===e.resolve?"true":"{unit: ".concat(yzt(t),"}")),marks:(t,e,n)=>{const r=e.name,{x:i,y:a}=e.project.hasChannel,o=i&&i.signals.visual,s=a&&a.signals.visual,c="data(".concat(UAt(e.name+hzt),")");if(URt.has(e))return n;const u={x:void 0!==i?{signal:"".concat(o,"[0]")}:{value:0},y:void 0!==a?{signal:"".concat(s,"[0]")}:{value:0},x2:void 0!==i?{signal:"".concat(o,"[1]")}:{field:{group:"width"}},y2:void 0!==a?{signal:"".concat(s,"[1]")}:{field:{group:"height"}}};if("global"===e.resolve)for(const m of yCt(u))u[m]=[Object.assign({test:"".concat(c,".length && ").concat(c,"[0].unit === ").concat(yzt(t))},u[m]),{value:0}];const l=e.mark,{fill:h,fillOpacity:d,cursor:f}=l,p=VAt(l,["fill","fillOpacity","cursor"]),g=yCt(p).reduce(((t,e)=>(t[e]=[{test:[void 0!==i&&"".concat(o,"[0] !== ").concat(o,"[1]"),void 0!==a&&"".concat(s,"[0] !== ").concat(s,"[1]")].filter((t=>t)).join(" && "),value:p[e]},{value:null}],t)),{});return[{name:r+izt+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:h},fillOpacity:{value:d}},update:u}},...n,{name:r+izt,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},f?{cursor:{value:f}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},u),g)}}]}};function szt(t,e){return t.events.reduce(((t,n)=>n.between?e(t,n):(XNt("".concat(n," is not an ordered event stream for interval selections.")),t)),[])}function czt(t,e){const n=e.name,r=n+IRt,i=e.project,a="(item().isVoronoi ? datum.datum : datum)",o=i.items.map((e=>{const n=t.fieldDef(e.channel);return n&&n.bin?"[".concat(a,"[").concat(UAt(t.vgField(e.channel,{})),"], ")+"".concat(a,"[").concat(UAt(t.vgField(e.channel,{binSuffix:"end"})),"]]"):"".concat(a,"[").concat(UAt(e.field),"]")})).join(", "),s="unit: ".concat(yzt(t),", fields: ").concat(r,", values"),c=e.events;return[{name:n+dzt,on:c?[{events:c,update:"datum && item().mark.marktype !== 'group' ? {".concat(s,": [").concat(o,"]} : null"),force:!0}]:[]}]}const uzt={signals:czt,modifyExpr:(t,e)=>e.name+dzt+", "+("global"===e.resolve?"null":"{unit: ".concat(yzt(t),"}"))},lzt={signals:czt,modifyExpr:(t,e)=>e.name+dzt+", "+("global"===e.resolve?"true":"{unit: ".concat(yzt(t),"}"))},hzt="_store",dzt="_tuple",fzt="_modify",pzt="vlSelectionResolve",gzt={single:lzt,multi:uzt,interval:ozt};function mzt(t,e){const n=t.component.selection;if(n)for(const r of vCt(n)){if(!0===e(r,gzt[r.type]))break}}function yzt(t){let{escape:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{escape:!0},n=e?UAt(t.name):t.name;const r=function(t){let e=t.parent;for(;e&&!Kjt(e);)e=e.parent;return e}(t);if(r){const{facet:t}=r;for(const e of lTt)t[e]&&(n+=" + '__facet_".concat(e,"_' + (facet[").concat(UAt(r.vgField(e)),"])"))}return n}function vzt(t){let e=!1;return mzt(t,(t=>{e=e||t.project.items.some((t=>t.field===wMt))})),e}const bzt="Property",xzt="ArrayExpression",wzt="BinaryExpression",kzt="CallExpression",_zt="ConditionalExpression",Szt="LogicalExpression",Azt="MemberExpression",Czt="ObjectExpression",Ezt="UnaryExpression";function Tzt(t){this.type=t}var Nzt,Dzt,Fzt,Izt,Mzt;Tzt.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=function(t){switch(t.type){case xzt:return t.elements;case wzt:case Szt:return[t.left,t.right];case kzt:return[t.callee].concat(t.arguments);case _zt:return[t.test,t.consequent,t.alternate];case Azt:return[t.object,t.property];case Czt:return t.properties;case bzt:return[t.key,t.value];case Ezt:return[t.argument];default:return[]}}(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1};var Ozt=1,Rzt=2,zzt=3,Bzt=4,Lzt=5,Pzt=6,jzt=7,Uzt=8;(Nzt={})[Ozt]="Boolean",Nzt[Rzt]="<end>",Nzt[zzt]="Identifier",Nzt[Bzt]="Keyword",Nzt[Lzt]="Null",Nzt[Pzt]="Numeric",Nzt[jzt]="Punctuator",Nzt[Uzt]="String",Nzt[9]="RegularExpression";var Wzt="ArrayExpression",Vzt="BinaryExpression",qzt="CallExpression",Gzt="ConditionalExpression",Hzt="Identifier",Yzt="Literal",Xzt="LogicalExpression",Kzt="MemberExpression",$zt="ObjectExpression",Zzt="Property",Qzt="UnaryExpression",Jzt="Unexpected token %0",tBt="Unexpected number",eBt="Unexpected string",nBt="Unexpected identifier",rBt="Unexpected reserved word",iBt="Unexpected end of input",aBt="Invalid regular expression",oBt="Invalid regular expression: missing /",sBt="Octal literals are not allowed in strict mode.",cBt="Duplicate data property in object literal not allowed in strict mode",uBt="ILLEGAL",lBt="Disabled.",hBt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),dBt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function fBt(t,e){if(!t)throw new Error("ASSERT: "+e)}function pBt(t){return t>=48&&t<=57}function gBt(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function mBt(t){return"01234567".indexOf(t)>=0}function yBt(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function vBt(t){return 10===t||13===t||8232===t||8233===t}function bBt(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||t>=128&&hBt.test(String.fromCharCode(t))}function xBt(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||t>=128&&dBt.test(String.fromCharCode(t))}var wBt={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function kBt(){for(var t;Fzt<Izt&&(yBt(t=Dzt.charCodeAt(Fzt))||vBt(t));)++Fzt}function _Bt(t){var e,n,r,i=0;for(n="u"===t?4:2,e=0;e<n;++e)Fzt<Izt&&gBt(Dzt[Fzt])?(r=Dzt[Fzt++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):PBt({},Jzt,uBt);return String.fromCharCode(i)}function SBt(){var t,e,n,r;for(e=0,"}"===(t=Dzt[Fzt])&&PBt({},Jzt,uBt);Fzt<Izt&&gBt(t=Dzt[Fzt++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||"}"!==t)&&PBt({},Jzt,uBt),e<=65535?String.fromCharCode(e):(n=55296+(e-65536>>10),r=56320+(e-65536&1023),String.fromCharCode(n,r))}function ABt(){var t,e;for(t=Dzt.charCodeAt(Fzt++),e=String.fromCharCode(t),92===t&&(117!==Dzt.charCodeAt(Fzt)&&PBt({},Jzt,uBt),++Fzt,(t=_Bt("u"))&&"\\"!==t&&bBt(t.charCodeAt(0))||PBt({},Jzt,uBt),e=t);Fzt<Izt&&xBt(t=Dzt.charCodeAt(Fzt));)++Fzt,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==Dzt.charCodeAt(Fzt)&&PBt({},Jzt,uBt),++Fzt,(t=_Bt("u"))&&"\\"!==t&&xBt(t.charCodeAt(0))||PBt({},Jzt,uBt),e+=t);return e}function CBt(){var t,e;return t=Fzt,e=92===Dzt.charCodeAt(Fzt)?ABt():function(){var t,e;for(t=Fzt++;Fzt<Izt;){if(92===(e=Dzt.charCodeAt(Fzt)))return Fzt=t,ABt();if(!xBt(e))break;++Fzt}return Dzt.slice(t,Fzt)}(),{type:1===e.length?zzt:wBt.hasOwnProperty(e)?Bzt:"null"===e?Lzt:"true"===e||"false"===e?Ozt:zzt,value:e,start:t,end:Fzt}}function EBt(){var t,e,n,r,i=Fzt,a=Dzt.charCodeAt(Fzt),o=Dzt[Fzt];switch(a){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++Fzt,{type:jzt,value:String.fromCharCode(a),start:i,end:Fzt};default:if(61===(t=Dzt.charCodeAt(Fzt+1)))switch(a){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return Fzt+=2,{type:jzt,value:String.fromCharCode(a)+String.fromCharCode(t),start:i,end:Fzt};case 33:case 61:return Fzt+=2,61===Dzt.charCodeAt(Fzt)&&++Fzt,{type:jzt,value:Dzt.slice(i,Fzt),start:i,end:Fzt}}}return">>>="===(r=Dzt.substr(Fzt,4))?{type:jzt,value:r,start:i,end:Fzt+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:jzt,value:n,start:i,end:Fzt+=3}:o===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(o)>=0||"=>"===e?{type:jzt,value:e,start:i,end:Fzt+=2}:"<>=!+-*%&|^/".indexOf(o)>=0?(++Fzt,{type:jzt,value:o,start:i,end:Fzt}):void PBt({},Jzt,uBt)}function TBt(){var t,e,n;if(fBt(pBt((n=Dzt[Fzt]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),e=Fzt,t="","."!==n){if(t=Dzt[Fzt++],n=Dzt[Fzt],"0"===t){if("x"===n||"X"===n)return++Fzt,function(t){for(var e="";Fzt<Izt&&gBt(Dzt[Fzt]);)e+=Dzt[Fzt++];return 0===e.length&&PBt({},Jzt,uBt),bBt(Dzt.charCodeAt(Fzt))&&PBt({},Jzt,uBt),{type:Pzt,value:parseInt("0x"+e,16),start:t,end:Fzt}}(e);if(mBt(n))return function(t){for(var e="0"+Dzt[Fzt++];Fzt<Izt&&mBt(Dzt[Fzt]);)e+=Dzt[Fzt++];return(bBt(Dzt.charCodeAt(Fzt))||pBt(Dzt.charCodeAt(Fzt)))&&PBt({},Jzt,uBt),{type:Pzt,value:parseInt(e,8),octal:!0,start:t,end:Fzt}}(e);n&&pBt(n.charCodeAt(0))&&PBt({},Jzt,uBt)}for(;pBt(Dzt.charCodeAt(Fzt));)t+=Dzt[Fzt++];n=Dzt[Fzt]}if("."===n){for(t+=Dzt[Fzt++];pBt(Dzt.charCodeAt(Fzt));)t+=Dzt[Fzt++];n=Dzt[Fzt]}if("e"===n||"E"===n)if(t+=Dzt[Fzt++],"+"!==(n=Dzt[Fzt])&&"-"!==n||(t+=Dzt[Fzt++]),pBt(Dzt.charCodeAt(Fzt)))for(;pBt(Dzt.charCodeAt(Fzt));)t+=Dzt[Fzt++];else PBt({},Jzt,uBt);return bBt(Dzt.charCodeAt(Fzt))&&PBt({},Jzt,uBt),{type:Pzt,value:parseFloat(t),start:e,end:Fzt}}function NBt(){var t,e,n,r;return Mzt=null,kBt(),t=Fzt,e=function(){var t,e,n,r;for(fBt("/"===(t=Dzt[Fzt]),"Regular expression literal must start with a slash"),e=Dzt[Fzt++],n=!1,r=!1;Fzt<Izt;)if(e+=t=Dzt[Fzt++],"\\"===t)vBt((t=Dzt[Fzt++]).charCodeAt(0))&&PBt({},oBt),e+=t;else if(vBt(t.charCodeAt(0)))PBt({},oBt);else if(n)"]"===t&&(n=!1);else{if("/"===t){r=!0;break}"["===t&&(n=!0)}return r||PBt({},oBt),{value:e.substr(1,e.length-2),literal:e}}(),n=function(){var t,e,n;for(e="",n="";Fzt<Izt&&xBt((t=Dzt[Fzt]).charCodeAt(0));)++Fzt,"\\"===t&&Fzt<Izt?PBt({},Jzt,uBt):(n+=t,e+=t);return n.search(/[^gimuy]/g)>=0&&PBt({},aBt,n),{value:n,literal:e}}(),r=function(t,e){var n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(t,e){if(parseInt(e,16)<=1114111)return"x";PBt({},aBt)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){PBt({},aBt)}try{return new RegExp(t,e)}catch(i){return null}}(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:Fzt}}function DBt(){var t;return kBt(),Fzt>=Izt?{type:Rzt,start:Fzt,end:Fzt}:bBt(t=Dzt.charCodeAt(Fzt))?CBt():40===t||41===t||59===t?EBt():39===t||34===t?function(){var t,e,n,r,i="",a=!1;for(fBt("'"===(t=Dzt[Fzt])||'"'===t,"String literal must starts with a quote"),e=Fzt,++Fzt;Fzt<Izt;){if((n=Dzt[Fzt++])===t){t="";break}if("\\"===n)if((n=Dzt[Fzt++])&&vBt(n.charCodeAt(0)))"\r"===n&&"\n"===Dzt[Fzt]&&++Fzt;else switch(n){case"u":case"x":"{"===Dzt[Fzt]?(++Fzt,i+=SBt()):i+=_Bt(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:mBt(n)?(0!==(r="01234567".indexOf(n))&&(a=!0),Fzt<Izt&&mBt(Dzt[Fzt])&&(a=!0,r=8*r+"01234567".indexOf(Dzt[Fzt++]),"0123".indexOf(n)>=0&&Fzt<Izt&&mBt(Dzt[Fzt])&&(r=8*r+"01234567".indexOf(Dzt[Fzt++]))),i+=String.fromCharCode(r)):i+=n}else{if(vBt(n.charCodeAt(0)))break;i+=n}}return""!==t&&PBt({},Jzt,uBt),{type:Uzt,value:i,octal:a,start:e,end:Fzt}}():46===t?pBt(Dzt.charCodeAt(Fzt+1))?TBt():EBt():pBt(t)?TBt():EBt()}function FBt(){var t;return Fzt=(t=Mzt).end,Mzt=DBt(),Fzt=t.end,t}function IBt(){var t;t=Fzt,Mzt=DBt(),Fzt=t}function MBt(t,e,n){var r=new Tzt("||"===t||"&&"===t?Xzt:Vzt);return r.operator=t,r.left=e,r.right=n,r}function OBt(t,e){var n=new Tzt(qzt);return n.callee=t,n.arguments=e,n}function RBt(t){var e=new Tzt(Hzt);return e.name=t,e}function zBt(t){var e=new Tzt(Yzt);return e.value=t.value,e.raw=Dzt.slice(t.start,t.end),t.regex&&("//"===e.raw&&(e.raw="/(?:)/"),e.regex=t.regex),e}function BBt(t,e,n){var r=new Tzt(Kzt);return r.computed="["===t,r.object=e,r.property=n,r.computed||(n.member=!0),r}function LBt(t,e,n){var r=new Tzt(Zzt);return r.key=e,r.value=n,r.kind=t,r}function PBt(t,e){var n,r=Array.prototype.slice.call(arguments,2),i=e.replace(/%(\d)/g,(function(t,e){return fBt(e<r.length,"Message reference must be in range"),r[e]}));throw(n=new Error(i)).index=Fzt,n.description=i,n}function jBt(t){t.type===Rzt&&PBt(t,iBt),t.type===Pzt&&PBt(t,tBt),t.type===Uzt&&PBt(t,eBt),t.type===zzt&&PBt(t,nBt),t.type===Bzt&&PBt(t,rBt),PBt(t,Jzt,t.value)}function UBt(t){var e=FBt();e.type===jzt&&e.value===t||jBt(e)}function WBt(t){return Mzt.type===jzt&&Mzt.value===t}function VBt(t){return Mzt.type===Bzt&&Mzt.value===t}function qBt(){var t=[];for(Fzt=Mzt.start,UBt("[");!WBt("]");)WBt(",")?(FBt(),t.push(null)):(t.push(nLt()),WBt("]")||UBt(","));return FBt(),function(t){var e=new Tzt(Wzt);return e.elements=t,e}(t)}function GBt(){var t;return Fzt=Mzt.start,(t=FBt()).type===Uzt||t.type===Pzt?(t.octal&&PBt(t,sBt),zBt(t)):RBt(t.value)}function HBt(){var t,e,n;return Fzt=Mzt.start,(t=Mzt).type===zzt?(n=GBt(),UBt(":"),LBt("init",n,nLt())):t.type!==Rzt&&t.type!==jzt?(e=GBt(),UBt(":"),LBt("init",e,nLt())):void jBt(t)}function YBt(){var t,e,n=[],r={},i=String;for(Fzt=Mzt.start,UBt("{");!WBt("}");)e="$"+((t=HBt()).key.type===Hzt?t.key.name:i(t.key.value)),Object.prototype.hasOwnProperty.call(r,e)?PBt({},cBt):r[e]=!0,n.push(t),WBt("}")||UBt(",");return UBt("}"),function(t){var e=new Tzt($zt);return e.properties=t,e}(n)}var XBt={if:1};function KBt(){var t,e,n;if(WBt("("))return function(){var t;return UBt("("),t=rLt(),UBt(")"),t}();if(WBt("["))return qBt();if(WBt("{"))return YBt();if(t=Mzt.type,Fzt=Mzt.start,t===zzt||XBt[Mzt.value])n=RBt(FBt().value);else if(t===Uzt||t===Pzt)Mzt.octal&&PBt(Mzt,sBt),n=zBt(FBt());else{if(t===Bzt)throw new Error(lBt);t===Ozt?((e=FBt()).value="true"===e.value,n=zBt(e)):t===Lzt?((e=FBt()).value=null,n=zBt(e)):WBt("/")||WBt("/=")?(n=zBt(NBt()),IBt()):jBt(FBt())}return n}function $Bt(){var t=[];if(UBt("("),!WBt(")"))for(;Fzt<Izt&&(t.push(nLt()),!WBt(")"));)UBt(",");return UBt(")"),t}function ZBt(){var t;return Fzt=Mzt.start,function(t){return t.type===zzt||t.type===Bzt||t.type===Ozt||t.type===Lzt}(t=FBt())||jBt(t),RBt(t.value)}function QBt(){var t;return UBt("["),t=rLt(),UBt("]"),t}function JBt(){var t=function(){var t;for(t=KBt();;)if(WBt("."))UBt("."),t=BBt(".",t,ZBt());else if(WBt("("))t=OBt(t,$Bt());else{if(!WBt("["))break;t=BBt("[",t,QBt())}return t}();if(Mzt.type===jzt&&(WBt("++")||WBt("--")))throw new Error(lBt);return t}function tLt(){var t,e;if(Mzt.type!==jzt&&Mzt.type!==Bzt)e=JBt();else{if(WBt("++")||WBt("--"))throw new Error(lBt);if(WBt("+")||WBt("-")||WBt("~")||WBt("!"))t=FBt(),e=tLt(),e=function(t,e){var n=new Tzt(Qzt);return n.operator=t,n.argument=e,n.prefix=!0,n}(t.value,e);else{if(VBt("delete")||VBt("void")||VBt("typeof"))throw new Error(lBt);e=JBt()}}return e}function eLt(t){var e=0;if(t.type!==jzt&&t.type!==Bzt)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function nLt(){var t,e;return t=function(){var t,e,n,r,i,a,o,s,c,u;if(t=Mzt,c=tLt(),0===(i=eLt(r=Mzt)))return c;for(r.prec=i,FBt(),e=[t,Mzt],a=[c,r,o=tLt()];(i=eLt(Mzt))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)o=a.pop(),s=a.pop().value,c=a.pop(),e.pop(),n=MBt(s,c,o),a.push(n);(r=FBt()).prec=i,a.push(r),e.push(Mzt),n=tLt(),a.push(n)}for(n=a[u=a.length-1],e.pop();u>1;)e.pop(),n=MBt(a[u-1].value,a[u-2],n),u-=2;return n}(),WBt("?")&&(FBt(),e=nLt(),UBt(":"),t=function(t,e,n){var r=new Tzt(Gzt);return r.test=t,r.consequent=e,r.alternate=n,r}(t,e,nLt())),t}function rLt(){var t=nLt();if(WBt(","))throw new Error(lBt);return t}function iLt(t,e,n){return t.fields=e||[],t.fname=n,t}function aLt(t){return 1===t.length?oLt(t[0]):sLt(t)}const oLt=t=>function(e){return e[t]},sLt=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function cLt(t){throw Error(t)}function uLt(t){const e=[],n=t.length;let r,i,a,o=null,s=0,c="";function u(){e.push(c+t.substring(r,i)),c="",r=i+1}for(t+="",r=i=0;i<n;++i)if(a=t[i],"\\"===a)c+=t.substring(r,i++),r=i;else if(a===o)u(),o=null,s=-1;else{if(o)continue;r===s&&'"'===a||r===s&&"'"===a?(r=i+1,o=a):"."!==a||s?"["===a?(i>r&&u(),s=r=i+1):"]"===a&&(s||cLt("Access path missing open bracket: "+t),s>0&&u(),s=0,r=i+1):i>r?u():r=i+1}return s&&cLt("Access path missing closing bracket: "+t),o&&cLt("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function lLt(t,e,n){const r=uLt(t);return t=1===r.length?r[0]:t,iLt((n&&n.get||aLt)(r),[t],e||t)}lLt("id"),iLt((t=>t),[],"identity"),iLt((()=>0),[],"zero"),iLt((()=>1),[],"one"),iLt((()=>!0),[],"true"),iLt((()=>!1),[],"false");Array.isArray;Object.prototype.hasOwnProperty;function hLt(t){const e=[];return"Identifier"===t.type?[t.name]:"Literal"===t.type?[t.value]:("MemberExpression"===t.type&&(e.push(...hLt(t.object)),e.push(...hLt(t.property))),e)}function dLt(t){return"MemberExpression"===t.object.type?dLt(t.object):"datum"===t.object.name}function fLt(t){const e=function(t){Fzt=0,Izt=(Dzt=t).length,Mzt=null,IBt();var e=rLt();if(Mzt.type!==Rzt)throw new Error("Unexpect token after expression.");return e}(t),n=new Set;return e.visit((t=>{"MemberExpression"===t.type&&dLt(t)&&n.add(hLt(t).slice(1).join("."))})),n}class pLt extends NRt{constructor(t,e,n){super(t),this.model=e,this.filter=n,this.expr=yLt(this.model,this.filter,this),this._dependentFields=fLt(this.expr)}clone(){return new pLt(null,this.model,nCt(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return"Filter ".concat(this.expr)}}function gLt(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"datum";const i=[];const a=kCt(e,(function(e){const a=wCt(e),o=t.getSelectionComponent(a,e),s=UAt(a+hzt);if(o.project.timeUnit){const e=null!==n&&void 0!==n?n:t.component.data.raw,r=o.project.timeUnit.clone();e.parent?r.insertAsParentOf(e):e.parent=r}return"none"!==o.empty&&i.push(s),"vlSelectionTest(".concat(s,", ").concat(r)+("global"===o.resolve?")":", ".concat(UAt(o.resolve),")"))}));return(i.length?"!("+i.map((t=>"length(data(".concat(t,"))"))).join(" || ")+") || ":"")+"(".concat(a,")")}function mLt(t,e){const n=e.encoding;let r=e.field;if(n||r){if(n&&!r){const i=t.project.items.filter((t=>t.channel===n));!i.length||i.length>1?(r=t.project.items[0].field,XNt((i.length?"Multiple ":"No ")+"matching ".concat(UAt(n)," encoding found for selection ").concat(UAt(e.selection),". ")+'Using "field": '.concat(UAt(r),"."))):r=i[0].field}}else r=t.project.items[0].field,t.project.items.length>1&&XNt('A "field" or "encoding" must be specified when using a selection as a scale domain. '+'Using "field": '.concat(UAt(r),"."));return"".concat(t.name,"[").concat(UAt(r),"]")}function yLt(t,e,n){return kCt(e,(e=>jAt(e)?e:function(t){return null===t||void 0===t?void 0:t.selection}(e)?gLt(t,e.selection,n):CDt(e)))}function vLt(t,e,n,r){var i,a,o;t.encode=null!==(i=t.encode)&&void 0!==i?i:{},t.encode[e]=null!==(a=t.encode[e])&&void 0!==a?a:{},t.encode[e].update=null!==(o=t.encode[e].update)&&void 0!==o?o:{},t.encode[e].update[n]=r}function bLt(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{header:!1};var i,a;const o=t.combine(),{disable:s,orient:c,scale:u,labelExpr:l,title:h,zindex:d}=o,f=VAt(o,["disable","orient","scale","labelExpr","title","zindex"]);if(!s){for(const t in f){const n=LCt[t],r=f[t];if(n&&n!==e&&"both"!==n)delete f[t];else if(zCt(r)){const{condition:e}=r,n=VAt(r,["condition"]),i=RAt(e),a=RCt[t];if(a){const{vgProp:e,part:r}=a,o=[...i.map((t=>{const{test:e}=t,n=VAt(t,["test"]);return Object.assign({test:yLt(null,e)},n)})),n];vLt(f,r,e,o),delete f[t]}else if(null===a){const e={signal:i.map((t=>{const{test:e}=t,n=VAt(t,["test"]);return"".concat(yLt(null,e)," ? ").concat(NIt(n)," : ")})).join("")+NIt(n)};f[t]=e}}else if(hDt(r)){const e=RCt[t];if(e){const{vgProp:n,part:i}=e;vLt(f,i,n,r),delete f[t]}}}if("grid"===e){if(!f.grid)return;if(f.encode){const{grid:t}=f.encode;f.encode=Object.assign({},t?{grid:t}:{}),mCt(f.encode)&&delete f.encode}return Object.assign(Object.assign({scale:u,orient:c},f),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:FCt(d,0)})}{if(!r.header&&t.mainExtracted)return;if(void 0!==l){let t=l;(null===(a=null===(i=f.encode)||void 0===i?void 0:i.labels)||void 0===a?void 0:a.update)&&hDt(f.encode.labels.update.text)&&(t=TCt(l,"datum.label",f.encode.labels.update.text.signal)),vLt(f,"labels","text",{signal:t})}if(null===f.labelAlign&&delete f.labelAlign,f.encode){for(const e of BCt)t.hasAxisPart(e)||delete f.encode[e];mCt(f.encode)&&delete f.encode}const e=function(t,e){if(t)return NAt(t)&&!EIt(t)?t.map((t=>fIt(t,e))).join(", "):t}(h,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:u,orient:c,grid:!1},e?{title:e}:{}),f),!1===n.aria?{aria:!1}:{}),{zindex:FCt(d,0)})}}}function xLt(t){const{axes:e}=t.component,n=[];for(const r of VTt)if(e[r])for(const i of e[r])if(!i.get("disable")&&!i.get("gridScale")){const e="x"===r?"height":"width",i=t.getSizeSignalRef(e).signal;e!==i&&n.push({name:e,update:i})}return n}const wLt={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},kLt={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},_Lt=yCt(wLt),SLt=yCt(kLt);function ALt(t,e,n,r){return Object.assign.apply(null,[{},...t.map((t=>{if("axisOrient"===t){const t="x"===n?"bottom":"left",i=e["x"===n?"axisBottom":"axisLeft"]||{},a=e["x"===n?"axisTop":"axisRight"]||{},o=new Set([...yCt(i),...yCt(a)]),s={};for(const e of o.values())s[e]={signal:"".concat(r.signal,' === "').concat(t,'" ? ').concat(DIt(i[e])," : ").concat(DIt(a[e]))};return s}return e[t]}))])}function CLt(t,e,n,r){const i="band"===e?["axisDiscrete","axisBand"]:"point"===e?["axisDiscrete","axisPoint"]:function(t){return t in qDt}(e)?["axisQuantitative"]:"time"===e||"utc"===e?["axisTemporal"]:[],a="x"===t?"axisX":"axisY",o=hDt(n)?"axisOrient":"axis"+SCt(n),s=[...i,...i.map((t=>a+t.substr(4)))],c=["axis",o,a];return{vlOnlyAxisConfig:ALt(s,r,t,n),vgAxisConfig:ALt(c,r,t,n),axisConfigStyle:ELt([...c,...s],r)}}function ELt(t,e){var n;const r=[{}];for(const i of t){let t=null===(n=e[i])||void 0===n?void 0:n.style;if(t){t=RAt(t);for(const n of t)r.push(e.style[n])}}return Object.assign.apply(null,r)}function TLt(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const a=RIt(t,n,e.style);if(void 0!==a)return{configFrom:"style",configValue:a};for(const o of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(void 0!==(null===(i=r[o])||void 0===i?void 0:i[t]))return{configFrom:o,configValue:r[o][t]};return{}}const NLt={scale:t=>{let{model:e,channel:n}=t;return e.scaleName(n)},format:t=>{let{fieldOrDatumDef:e,config:n,axis:r}=t;const{format:i,formatType:a}=r;return AFt(e,e.type,i,a,n,!0)},formatType:t=>{let{axis:e,fieldOrDatumDef:n,scaleType:r}=t;const{formatType:i}=e;return CFt(i,n,r)},grid:t=>{let{fieldOrDatumDef:e,axis:n,scaleType:r}=t;var i;return(!YFt(e)||!pNt(e.bin))&&(null!==(i=n.grid)&&void 0!==i?i:function(t,e){return!XDt(t)&&YFt(e)&&!fNt(null===e||void 0===e?void 0:e.bin)}(r,e))},gridScale:t=>{let{model:e,channel:n}=t;return function(t,e){const n="x"===e?"y":"x";if(t.getScaleComponent(n))return t.scaleName(n);return}(e,n)},labelAlign:t=>{let{axis:e,labelAngle:n,orient:r,channel:i}=t;return e.labelAlign||ILt(n,r,i)},labelAngle:t=>{let{labelAngle:e}=t;return e},labelBaseline:t=>{let{axis:e,labelAngle:n,orient:r,channel:i}=t;return e.labelBaseline||FLt(n,r,i)},labelFlush:t=>{let{axis:e,fieldOrDatumDef:n,channel:r}=t;var i;return null!==(i=e.labelFlush)&&void 0!==i?i:function(t,e){if("x"===e&&cCt(["quantitative","temporal"],t))return!0;return}(n.type,r)},labelOverlap:t=>{let{axis:e,fieldOrDatumDef:n,scaleType:r}=t;var i;return null!==(i=e.labelOverlap)&&void 0!==i?i:function(t,e){if("nominal"!==t)return"log"!==e||"greedy";return}(n.type,r)},orient:t=>{let{orient:e}=t;return e},tickCount:t=>{let{channel:e,model:n,axis:r,fieldOrDatumDef:i,scaleType:a}=t;var o;const s="x"===e?"width":"y"===e?"height":void 0,c=s?n.getSizeSignalRef(s):void 0;return null!==(o=r.tickCount)&&void 0!==o?o:function(t){let{fieldOrDatumDef:e,scaleType:n,size:r,values:i}=t;var a;if(!i&&!XDt(n)&&"log"!==n){if(YFt(e)){if(fNt(e.bin))return{signal:"ceil(".concat(r.signal,"/10)")};if(e.timeUnit&&cCt(["month","hours","day","quarter"],null===(a=lDt(e.timeUnit))||void 0===a?void 0:a.unit))return}return{signal:"ceil(".concat(r.signal,"/40)")}}return}({fieldOrDatumDef:i,scaleType:a,size:c,values:r.values})},title:t=>{let{axis:e,model:n,channel:r}=t;if(void 0!==e.title)return e.title;const i=MLt(n,r);if(void 0!==i)return i;const a=n.typedFieldDef(r),o="x"===r?"x2":"y2",s=n.fieldDef(o);return BIt(a?[jFt(a)]:[],YFt(s)?[jFt(s)]:[])},values:t=>{let{axis:e,fieldOrDatumDef:n}=t;return function(t,e){const n=t.values;if(NAt(n))return SIt(e,n);if(hDt(n))return n;return}(e,n)},zindex:t=>{let{axis:e,fieldOrDatumDef:n,mark:r}=t;var i;return null!==(i=e.zindex)&&void 0!==i?i:function(t,e){if("rect"===t&&oIt(e))return 1;return 0}(r,n)}};function DLt(t){return"(((".concat(t.signal," % 360) + 360) % 360)")}function FLt(t,e,n,r){if(void 0!==t){if("x"===n){if(hDt(t)){const n=DLt(t),r=hDt(e)?"(".concat(e.signal,' === "top")'):"top"===e;return{signal:"(45 < ".concat(n," && ").concat(n," < 135) || (225 < ").concat(n," && ").concat(n,' < 315) ? "middle" :')+"(".concat(n," <= 45 || 315 <= ").concat(n,") === ").concat(r,' ? "bottom" : "top"')}}if(45<t&&t<135||225<t&&t<315)return"middle";if(hDt(e)){const n=t<=45||315<=t?"===":"!==";return{signal:"".concat(e.signal," ").concat(n,' "top" ? "bottom" : "top"')}}return(t<=45||315<=t)===("top"===e)?"bottom":"top"}if(hDt(t)){const n=DLt(t),i=hDt(e)?"(".concat(e.signal,' === "left")'):"left"===e,a=r?'"middle"':"null";return{signal:"".concat(n," <= 45 || 315 <= ").concat(n," || (135 <= ").concat(n," && ").concat(n," <= 225) ? ").concat(a," : (45 <= ").concat(n," && ").concat(n," <= 135) === ").concat(i,' ? "top" : "bottom"')}}if(t<=45||315<=t||135<=t&&t<=225)return r?"middle":null;if(hDt(e)){const n=45<=t&&t<=135?"===":"!==";return{signal:"".concat(e.signal," ").concat(n,' "left" ? "top" : "bottom"')}}return(45<=t&&t<=135)===("left"===e)?"top":"bottom"}}function ILt(t,e,n){if(void 0===t)return;const r="x"===n,i=r?0:90,a=r?"bottom":"left";if(hDt(t)){const n=DLt(t),o=hDt(e)?"(".concat(e.signal,' === "').concat(a,'")'):e===a;return{signal:"(".concat(i?"("+n+" + 90)":n," % 180 === 0) ? ").concat(r?null:'"center"'," :")+"(".concat(i," < ").concat(n," && ").concat(n," < ").concat(180+i,") === ").concat(o,' ? "left" : "right"')}}if((t+i)%180===0)return r?null:"center";if(hDt(e)){const n=i<t&&t<180+i?"===":"!==",r="".concat(e.signal," ").concat(n,' "').concat(a,'"');return{signal:"".concat(r,' ? "left" : "right"')}}return(i<t&&t<180+i)===(e===a)?"left":"right"}function MLt(t,e){const n="x"===e?"x2":"y2",r=t.fieldDef(e),i=t.fieldDef(n),a=r?r.title:void 0,o=i?i.title:void 0;return a&&o?LIt(a,o):a||(o||(void 0!==a?a:void 0!==o?o:void 0))}class OLt extends NRt{constructor(t,e){super(t),this.transform=e,this._dependentFields=fLt(this.transform.calculate)}clone(){return new OLt(null,nCt(this.transform))}static parseAllForSortIndex(t,e){return e.forEachFieldDef(((e,n)=>{if(eIt(e)&&zFt(e.sort)){const{field:r,timeUnit:i}=e,a=e.sort,o=a.map(((t,e)=>"".concat(CDt({field:r,timeUnit:i,equal:t})," ? ").concat(e," : "))).join("")+a.length;t=new OLt(t,{calculate:o,as:RLt(e,n,{forAs:!0})})}})),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return"Calculate ".concat(oCt(this.transform))}}function RLt(t,e,n){return aIt(t,Object.assign({prefix:e,suffix:"sort_index"},null!==n&&void 0!==n?n:{}))}function zLt(t,e){return cCt(["top","bottom"],e)?"column":cCt(["left","right"],e)||"row"===t?"row":"column"}function BLt(t,e,n,r){const i="row"===r?n.headerRow:"column"===r?n.headerColumn:n.headerFacet;return FCt(((null===e||void 0===e?void 0:e.header)||{})[t],i[t],n.header[t])}function LLt(t,e,n,r){const i={};for(const a of t){const t=BLt(a,e,n,r);void 0!==t&&(i[a]=t)}return i}const PLt=["row","column"],jLt=["header","footer"];function ULt(t,e){const n=t.component.layoutHeaders[e].title,r=t.config?t.config:void 0,i=t.component.layoutHeaders[e].facetFieldDef?t.component.layoutHeaders[e].facetFieldDef:void 0,{titleAnchor:a,titleAngle:o,titleOrient:s}=LLt(["titleAnchor","titleAngle","titleOrient"],i,r,e),c=zLt(e,s),u=MCt(o);return{name:"".concat(e,"-title"),type:"group",role:"".concat(c,"-title"),title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},"row"===e?{orient:"left"}:{}),{style:"guide-title"}),VLt(u,c)),WLt(c,u,a)),$Lt(r,i,e,_Lt,wLt))}}function WLt(t,e){switch(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"middle"){case"start":return{align:"left"};case"end":return{align:"right"}}const n=ILt(e,"row"===t?"left":"top","row"===t?"y":"x");return n?{align:n}:{}}function VLt(t,e){const n=FLt(t,"row"===e?"left":"top","row"===e?"y":"x",!0);return n?{baseline:n}:{}}function qLt(t,e){const n=t.component.layoutHeaders[e],r=[];for(const i of jLt)if(n[i])for(const a of n[i]){const o=YLt(t,e,i,n,a);null!=o&&r.push(o)}return r}function GLt(t,e){var n;const{sort:r}=t;return RFt(r)?{field:aIt(r,{expr:"datum"}),order:null!==(n=r.order)&&void 0!==n?n:"ascending"}:NAt(r)?{field:RLt(t,e,{expr:"datum"}),order:"ascending"}:{field:aIt(t,{expr:"datum"}),order:null!==r&&void 0!==r?r:"ascending"}}function HLt(t,e,n){const{format:r,formatType:i,labelAngle:a,labelAnchor:o,labelOrient:s,labelExpr:c}=LLt(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],t,n,e),u=kFt({fieldOrDatumDef:t,format:r,formatType:i,expr:"parent",config:n}).signal,l=zLt(e,s);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:c?TCt(TCt(c,"datum.label",u),"datum.value",aIt(t,{expr:"parent"})):u}},"row"===e?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),VLt(a,l)),WLt(l,a,o)),$Lt(n,t,e,SLt,kLt))}function YLt(t,e,n,r,i){if(i){let a=null;const{facetFieldDef:o}=r,s=t.config?t.config:void 0;if(o&&i.labels){const{labelOrient:t}=LLt(["labelOrient"],o,s,e);("row"===e&&!cCt(["top","bottom"],t)||"column"===e&&!cCt(["left","right"],t))&&(a=HLt(o,e,s))}const c=Kjt(t)&&!BFt(t.facet),u=i.axes,l=(null===u||void 0===u?void 0:u.length)>0;if(a||l){const s="row"===e?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:t.getName("".concat(e,"_").concat(n)),type:"group",role:"".concat(e,"-").concat(n)},r.facetFieldDef?{from:{data:t.getName(e+"_domain")},sort:GLt(o,e)}:{}),l&&c?{from:{data:t.getName("facet_domain_".concat(e))}}:{}),a?{title:a}:{}),i.sizeSignal?{encode:{update:{[s]:i.sizeSignal}}}:{}),l?{axes:u}:{})}}return null}const XLt={column:{start:0,end:1},row:{start:1,end:0}};function KLt(t,e){return XLt[e][t]}function $Lt(t,e,n,r,i){const a={};for(const o of r){if(!i[o])continue;const r=BLt(o,e,t,n);void 0!==r&&(a[i[o]]=r)}return a}function ZLt(t){return[...QLt(t,"width"),...QLt(t,"height"),...QLt(t,"childWidth"),...QLt(t,"childHeight")]}function QLt(t,e){const n="width"===e?"x":"y",r=t.component.layoutSize.get(e);if(!r||"merged"===r)return[];const i=t.getSizeSignalRef(e).signal;if("step"===r){const e=t.getScaleComponent(n);if(e){const r=e.get("type"),a=e.get("range");if(XDt(r)&&dDt(a)){const r=t.scaleName(n);if(Kjt(t.parent)){if("independent"===t.parent.component.resolve.scale[n])return[JLt(r,a)]}return[JLt(r,a),{name:i,update:tPt(r,e,"domain('".concat(r,"').length"))}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==r){const e=i.endsWith("width"),n=e?"containerSize()[0]":"containerSize()[1]",r=FMt(t.config.view,e?"width":"height"),a="isFinite(".concat(n,") ? ").concat(n," : ").concat(r);return[{name:i,init:a,on:[{update:a,events:"window:resize"}]}]}return[{name:i,value:r}]}function JLt(t,e){return{name:t+"_step",value:e.step}}function tPt(t,e,n){const r=e.get("type"),i=e.get("padding"),a=FCt(e.get("paddingOuter"),i);let o=e.get("paddingInner");return o="band"===r?void 0!==o?o:i:1,"bandspace(".concat(n,", ").concat(o,", ").concat(a,") * ").concat(t,"_step")}function ePt(t){return"childWidth"===t?"width":"childHeight"===t?"height":t}function nPt(t,e){return yCt(t).reduce(((n,r)=>{const i=t[r];return Object.assign(Object.assign({},n),JOt(e,i,r,(t=>hDt(t)?t:{value:t.value})))}),{})}function rPt(t,e){if(Zjt(e)||Kjt(e))return"shared";if($jt(e))return qTt(t)?"independent":"shared";throw new Error("invalid model type for resolve")}function iPt(t,e){const n=t.scale[e],r=qTt(e)?"axis":"legend";return"independent"===n?("shared"===t[r][e]&&XNt(function(t){return'Setting the scale to be independent for "'.concat(t,'" means we also have to set the guide (axis or legend) to be independent.')}(e)),"independent"):t[r][e]||"shared"}const aPt=Object.assign(Object.assign({},xMt),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),oPt=yCt(aPt);class sPt extends bOt{}const cPt={symbols:function(t,e){let{fieldOrDatumDef:n,model:r,channel:i,legendCmpt:a,legendType:o}=e;var s,c,u,l,h;if("symbol"!==o)return;const{markDef:d,encoding:f,config:p,mark:g}=r,m=d.filled&&"trail"!==g;let y=Object.assign(Object.assign({},function(t,e,n){for(const r of n){const n=MIt(r,e.markDef,e.config);void 0!==n&&(t[r]=TIt(n))}return t}({},r,sEt)),sRt(r,{filled:m}));const v=null!==(s=uPt(f.opacity))&&void 0!==s?s:d.opacity;if(y.fill)if("fill"===i||m&&i===LEt)delete y.fill;else if(y.fill.field)a.get("symbolFillColor")?delete y.fill:(y.fill=TIt(null!==(c=p.legend.symbolBaseFillColor)&&void 0!==c?c:"black"),y.fillOpacity=TIt(null!==v&&void 0!==v?v:1));else if(NAt(y.fill)){const t=null!==(h=null!==(l=lPt(null!==(u=f.fill)&&void 0!==u?u:f.color))&&void 0!==l?l:d.fill)&&void 0!==h?h:m&&d.color;t&&(y.fill=TIt(t))}if(y.stroke)if("stroke"===i||!m&&i===LEt)delete y.stroke;else if(y.stroke.field)delete y.stroke;else if(NAt(y.stroke)){const t=FCt(lPt(f.stroke||f.color),d.stroke,m?d.color:void 0);t&&(y.stroke={value:t})}if(i!==qEt){const t=YFt(n)&&dPt(r,a,n);t?y.opacity=[Object.assign({test:t},TIt(null!==v&&void 0!==v?v:1)),TIt(p.legend.unselectedOpacity)]:v&&(y.opacity=TIt(v))}return y=Object.assign(Object.assign({},y),t),mCt(y)?void 0:y},gradient:function(t,e){let{model:n,legendType:r}=e;if("gradient"!==r)return;let i={};const a=uPt(n.encoding.opacity)||n.markDef.opacity;a&&(i.opacity=TIt(a));return i=Object.assign(Object.assign({},i),t),mCt(i)?void 0:i},labels:function(t,e){let{fieldOrDatumDef:n,model:r,channel:i,legendCmpt:a}=e;const o=r.legend(i)||{},s=r.config,c=YFt(n)?dPt(r,a,n):void 0,u=c?[{test:c,value:1},{value:s.legend.unselectedOpacity}]:void 0,{format:l,formatType:h}=o,d=bFt(h)?SFt({fieldOrDatumDef:n,field:"datum.value",format:l,formatType:h,config:s}):void 0,f=Object.assign(Object.assign(Object.assign({},u?{opacity:u}:{}),d?{text:d}:{}),t);return mCt(f)?void 0:f},entries:function(t,e){let{legendCmpt:n}=e;const r=n.get("selections");return(null===r||void 0===r?void 0:r.length)?Object.assign(Object.assign({},t),{fill:{value:"transparent"}}):t}};function uPt(t){return hPt(t,((t,e)=>Math.max(t,e.value)))}function lPt(t){return hPt(t,((t,e)=>FCt(t,e.value)))}function hPt(t,e){return function(t){const e=t&&t.condition;return!!e&&(NAt(e)||tIt(e))}(t)?RAt(t.condition).reduce(e,t.value):tIt(t)?t.value:void 0}function dPt(t,e,n){const r=e.get("selections");if(!(null===r||void 0===r?void 0:r.length))return;const i=UAt(n.field);return r.map((t=>{const e=UAt(wCt(t)+hzt);return"(!length(data(".concat(e,")) || (").concat(t,"[").concat(i,"] && indexof(").concat(t,"[").concat(i,"], datum.value) >= 0))")})).join(" || ")}const fPt={direction:t=>{let{direction:e}=t;return e},format:t=>{let{fieldOrDatumDef:e,legend:n,config:r}=t;const{format:i,formatType:a}=n;return AFt(e,e.type,i,a,r,!1)},formatType:t=>{let{legend:e,fieldOrDatumDef:n,scaleType:r}=t;const{formatType:i}=e;return CFt(i,n,r)},gradientLength:t=>{var e,n;const{legend:r,legendConfig:i}=t;return null!==(n=null!==(e=r.gradientLength)&&void 0!==e?e:i.gradientLength)&&void 0!==n?n:function(t){let{legendConfig:e,model:n,direction:r,orient:i,scaleType:a}=t;const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:s,gradientVerticalMaxLength:c,gradientVerticalMinLength:u}=e;if($Dt(a))return"horizontal"===r?"top"===i||"bottom"===i?mPt(n,"width",s,o):s:mPt(n,"height",u,c);return}(t)},labelOverlap:t=>{let{legend:e,legendConfig:n,scaleType:r}=t;var i,a;return null!==(a=null!==(i=e.labelOverlap)&&void 0!==i?i:n.labelOverlap)&&void 0!==a?a:function(t){if(cCt(["quantile","threshold","log"],t))return"greedy";return}(r)},symbolType:t=>{let{legend:e,markDef:n,channel:r,encoding:i}=t;var a;return null!==(a=e.symbolType)&&void 0!==a?a:function(t,e,n,r){var i;if("shape"!==e){const t=null!==(i=lPt(n))&&void 0!==i?i:r;if(t)return t}switch(t){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(n.type,r,i.shape,n.shape)},title:t=>{let{fieldOrDatumDef:e,config:n}=t;return hIt(e,n,{allowDisabling:!0})},type:t=>{let{legendType:e,scaleType:n,channel:r}=t;if(cTt(r)&&$Dt(n)){if("gradient"===e)return}else if("symbol"===e)return;return e},values:t=>{let{fieldOrDatumDef:e,legend:n}=t;return function(t,e){const n=t.values;if(NAt(n))return SIt(e,n);if(hDt(n))return n;return}(n,e)}};function pPt(t){const{legend:e}=t;return FCt(e.type,function(t){let{channel:e,timeUnit:n,scaleType:r}=t;if(cTt(e)){if(cCt(["quarter","month","day"],n))return"symbol";if($Dt(r))return"gradient"}return"symbol"}(t))}function gPt(t){let{legendConfig:e,legendType:n,orient:r,legend:i}=t;var a,o;return null!==(o=null!==(a=i.direction)&&void 0!==a?a:e[n?"gradientDirection":"symbolDirection"])&&void 0!==o?o:function(t,e){switch(t){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===e?"horizontal":void 0}}(r,n)}function mPt(t,e,n,r){const i=t.getSizeSignalRef(e).signal;return{signal:"clamp(".concat(i,", ").concat(n,", ").concat(r,")")}}function yPt(t){const e=Xjt(t)?function(t){const{encoding:e}=t,n={};for(const r of[LEt,...vMt]){const i=mIt(e[r]);i&&t.getScaleComponent(r)&&(r===UEt&&YFt(i)&&i.type===ODt||(n[r]=bPt(t,r)))}return n}(t):function(t){const{legends:e,resolve:n}=t.component;for(const r of t.children){yPt(r);for(const i of yCt(r.component.legends))n.legend[i]=iPt(t.component.resolve,i),"shared"===n.legend[i]&&(e[i]=xPt(e[i],r.component.legends[i]),e[i]||(n.legend[i]="independent",delete e[i]))}for(const r of yCt(e))for(const e of t.children)e.component.legends[r]&&"shared"===n.legend[r]&&delete e.component.legends[r];return e}(t);return t.component.legends=e,e}function vPt(t,e,n,r){switch(e){case"disable":return void 0!==n;case"values":return!!(null===n||void 0===n?void 0:n.values);case"title":if("title"===e&&t===(null===r||void 0===r?void 0:r.title))return!0}return t===(n||{})[e]}function bPt(t,e){var n,r,i;let a=t.legend(e);const{markDef:o,encoding:s,config:c}=t,u=c.legend,l=new sPt({},function(t,e){const n=t.scaleName(e);if("trail"===t.mark){if("color"===e)return{stroke:n};if("size"===e)return{strokeWidth:n}}return"color"===e?t.markDef.filled?{fill:n}:{stroke:n}:{[e]:n}}(t,e));!function(t,e,n){var r;const i=null===(r=t.fieldDef(e))||void 0===r?void 0:r.field;mzt(t,(t=>{var r,a;const o=null!==(r=t.project.hasField[i])&&void 0!==r?r:t.project.hasChannel[e];if(o&&qRt.has(t)){const e=null!==(a=n.get("selections"))&&void 0!==a?a:[];e.push(t.name),n.set("selections",e,!1),o.hasLegend=!0}}))}(t,e,l);const h=void 0!==a?!a:u.disable;if(l.set("disable",h,void 0!==a),h)return l;a=a||{};const d=t.getScaleComponent(e).get("type"),f=mIt(s[e]),p=YFt(f)?null===(n=lDt(f.timeUnit))||void 0===n?void 0:n.unit:void 0,g=a.orient||c.legend.orient||"right",m=pPt({legend:a,channel:e,timeUnit:p,scaleType:d}),y={legend:a,channel:e,model:t,markDef:o,encoding:s,fieldOrDatumDef:f,legendConfig:u,config:c,scaleType:d,orient:g,legendType:m,direction:gPt({legend:a,legendType:m,orient:g,legendConfig:u})};for(const k of oPt){const n=k in fPt?fPt[k](y):a[k];if(void 0!==n){const r=vPt(n,k,a,t.fieldDef(e));(r||void 0===c.legend[k])&&l.set(k,n,r)}}const v=null!==(r=null===a||void 0===a?void 0:a.encoding)&&void 0!==r?r:{},b=l.get("selections"),x={},w={fieldOrDatumDef:f,model:t,channel:e,legendCmpt:l,legendType:m};for(const k of["labels","legend","title","symbols","gradient","entries"]){const e=nPt(null!==(i=v[k])&&void 0!==i?i:{},t),n=k in cPt?cPt[k](e,w):e;void 0===n||mCt(n)||(x[k]=Object.assign(Object.assign(Object.assign({},(null===b||void 0===b?void 0:b.length)&&YFt(f)?{name:"".concat(wCt(f.field),"_legend_").concat(k)}:{}),(null===b||void 0===b?void 0:b.length)?{interactive:!!b}:{}),{update:n}))}return mCt(x)||l.set("encode",x,!!(null===a||void 0===a?void 0:a.encoding)),l}function xPt(t,e){var n,r,i,a;if(!t)return e.clone();const o=t.getWithExplicit("orient"),s=e.getWithExplicit("orient");if(o.explicit&&s.explicit&&o.value!==s.value)return;let c=!1;for(const u of oPt){const n=SOt(t.getWithExplicit(u),e.getWithExplicit(u),u,"legend",((t,e)=>{switch(u){case"symbolType":return wPt(t,e);case"title":return PIt(t,e);case"type":return c=!0,wOt("symbol")}return _Ot(t,e,u,"legend")}));t.setWithExplicit(u,n)}return c&&((null===(r=null===(n=t.implicit)||void 0===n?void 0:n.encode)||void 0===r?void 0:r.gradient)&&_Ct(t.implicit,["encode","gradient"]),(null===(a=null===(i=t.explicit)||void 0===i?void 0:i.encode)||void 0===a?void 0:a.gradient)&&_Ct(t.explicit,["encode","gradient"])),t}function wPt(t,e){return"circle"===e.value?e:t}function kPt(t,e,n,r){var i,a,o;t.encode=null!==(i=t.encode)&&void 0!==i?i:{},t.encode[e]=null!==(a=t.encode[e])&&void 0!==a?a:{},t.encode[e].update=null!==(o=t.encode[e].update)&&void 0!==o?o:{},t.encode[e].update[n]=r}function _Pt(t){const e=t.component.legends,n={};for(const i of yCt(e)){const r=t.getScaleComponent(i),a=aCt(r.get("domains"));if(n[a])for(const t of n[a]){xPt(t,e[i])||n[a].push(e[i])}else n[a]=[e[i].clone()]}const r=vCt(n).flat().map((e=>function(t,e){var n,r,i;const a=t.combine(),{disable:o,labelExpr:s,selections:c}=a,u=VAt(a,["disable","labelExpr","selections"]);if(o)return;!1===e.aria&&void 0==u.aria&&(u.aria=!1);if(null===(n=u.encode)||void 0===n?void 0:n.symbols){const t=u.encode.symbols.update;!t.fill||"transparent"===t.fill.value||t.stroke||u.stroke||(t.stroke={value:"transparent"});for(const e of vMt)u[e]&&delete t[e]}u.title||delete u.title;if(void 0!==s){let t=s;(null===(i=null===(r=u.encode)||void 0===r?void 0:r.labels)||void 0===i?void 0:i.update)&&hDt(u.encode.labels.update.text)&&(t=TCt(s,"datum.label",u.encode.labels.update.text.signal)),kPt(u,"labels","text",{signal:t})}for(const l in u){const t=u[l];if(hDt(t)){const e=bMt[l];if(e){const{vgProp:n,part:r}=e;kPt(u,r,n,t),delete u[l]}}}return u}(e,t.config))).filter((t=>void 0!==t));return r}function SPt(t){return Zjt(t)||$jt(t)?function(t){return t.children.reduce(((t,e)=>t.concat(e.assembleProjections())),APt(t))}(t):APt(t)}function APt(t){const e=t.component.projection;if(!e||e.merged)return[];const n=e.combine(),{name:r}=n;if(e.data){const i={signal:"[".concat(e.size.map((t=>t.signal)).join(", "),"]")},a=e.data.reduce(((e,n)=>{const r=hDt(n)?n.signal:"data('".concat(t.lookupDataSource(n),"')");return cCt(e,r)||e.push(r),e}),[]);if(a.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:i,fit:{signal:a.length>1?"[".concat(a.join(", "),"]"):a[0]}},n)]}return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const CPt=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class EPt extends bOt{constructor(t,e,n,r){super(Object.assign({},e),{name:t}),this.specifiedProjection=e,this.size=n,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function TPt(t){t.component.projection=Xjt(t)?function(t){var e;if(t.hasProjection){const n=t.specifiedProjection,r=!(n&&(null!=n.scale||null!=n.translate)),i=r?[t.getSizeSignalRef("width"),t.getSizeSignalRef("height")]:void 0,a=r?function(t){const e=[],{encoding:n}=t;for(const r of[[REt,OEt],[BEt,zEt]])(mIt(n[r[0]])||mIt(n[r[1]]))&&e.push({signal:t.getName("geojson_".concat(e.length))});t.channelHasField(UEt)&&t.typedFieldDef(UEt).type===ODt&&e.push({signal:t.getName("geojson_".concat(e.length))});0===e.length&&e.push(t.requestDataName(MOt));return e}(t):void 0;return new EPt(t.projectionName(!0),Object.assign(Object.assign({},null!==(e=t.config.projection)&&void 0!==e?e:{}),null!==n&&void 0!==n?n:{}),i,a)}return}(t):function(t){if(0===t.children.length)return;let e;for(const r of t.children)TPt(r);const n=lCt(t.children,(t=>{const n=t.component.projection;if(n){if(e){const t=function(t,e){const n=lCt(CPt,(n=>!BAt(t.explicit,n)&&!BAt(e.explicit,n)||!(!BAt(t.explicit,n)||!BAt(e.explicit,n)||aCt(t.get(n))!==aCt(e.get(n))))),r=aCt(t.size)===aCt(e.size);if(r){if(n)return t;if(aCt(t.explicit)===aCt({}))return e;if(aCt(e.explicit)===aCt({}))return t}return null}(e,n);return t&&(e=t),!!t}return e=n,!0}return!0}));if(e&&n){const n=t.projectionName(!0),r=new EPt(n,e.specifiedProjection,e.size,nCt(e.data));for(const e of t.children){const t=e.component.projection;t&&(t.isFit&&r.data.push(...e.component.projection.data),e.renameProjection(t.get("name"),n),t.merged=!0)}return r}return}(t)}function NPt(t,e){return"".concat(dNt(t),"_").concat(e)}function DPt(t,e,n){var r;const i=NPt(null!==(r=xIt(n,void 0))&&void 0!==r?r:{},e);return t.getName("".concat(i,"_bins"))}function FPt(t,e,n){let r,i;r=function(t){return"as"in t}(t)?jAt(t.as)?[t.as,"".concat(t.as,"_end")]:[t.as[0],t.as[1]]:[aIt(t,{forAs:!0}),aIt(t,{binSuffix:"end",forAs:!0})];const a=Object.assign({},xIt(e,void 0)),o=NPt(a,t.field),{signal:s,extentSignal:c}=function(t,e){return{signal:t.getName("".concat(e,"_bins")),extentSignal:t.getName("".concat(e,"_extent"))}}(n,o);if(mNt(a.extent)){const t=a.extent,e=t.selection;i=mLt(n.getSelectionComponent(wCt(e),e),t),delete a.extent}return{key:o,binComponent:Object.assign(Object.assign(Object.assign({bin:a,field:t.field,as:[r]},s?{signal:s}:{}),c?{extentSignal:c}:{}),i?{span:i}:{})}}class IPt extends NRt{constructor(t,e){super(t),this.bins=e}clone(){return new IPt(null,nCt(this.bins))}static makeFromEncoding(t,e){const n=e.reduceFieldDef(((t,n,r)=>{if(JFt(n)&&fNt(n.bin)){const{key:i,binComponent:a}=FPt(n,n.bin,e);t[i]=Object.assign(Object.assign(Object.assign({},a),t[i]),function(t,e,n,r){var i,a;if(AIt(e,n)){const o=Xjt(t)&&null!==(a=null!==(i=t.axis(n))&&void 0!==i?i:t.legend(n))&&void 0!==a?a:{},s=aIt(e,{expr:"datum"}),c=aIt(e,{expr:"datum",binSuffix:"end"});return{formulaAs:aIt(e,{binSuffix:"range",forAs:!0}),formula:DFt(s,c,o.format,o.formatType,r)}}return{}}(e,n,r,e.config))}return t}),{});return mCt(n)?null:new IPt(t,n)}static makeFromTransform(t,e,n){const{key:r,binComponent:i}=FPt(e,e.bin,n);return new IPt(t,{[r]:i})}merge(t,e){for(const n of yCt(t.bins))n in this.bins?(e(t.bins[n].signal,this.bins[n].signal),this.bins[n].as=dCt([...this.bins[n].as,...t.bins[n].as],oCt)):this.bins[n]=t.bins[n];for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}producedFields(){return new Set(vCt(this.bins).map((t=>t.as)).flat(2))}dependentFields(){return new Set(vCt(this.bins).map((t=>t.field)))}hash(){return"Bin ".concat(oCt(this.bins))}assemble(){return vCt(this.bins).flatMap((t=>{const e=[],[n,...r]=t.as,i=t.bin,{extent:a}=i,o=VAt(i,["extent"]),s=Object.assign(Object.assign(Object.assign({type:"bin",field:ECt(t.field),as:n,signal:t.signal},mNt(a)?{extent:null}:{extent:a}),t.span?{span:{signal:"span(".concat(t.span,")")}}:{}),o);!a&&t.extentSignal&&(e.push({type:"extent",field:ECt(t.field),signal:t.extentSignal}),s.extent={signal:t.extentSignal}),e.push(s);for(const c of r)for(let t=0;t<2;t++)e.push({type:"formula",expr:aIt({field:n[t]},{expr:"datum"}),as:c[t]});return t.formula&&e.push({type:"formula",expr:t.formula,as:t.formulaAs}),e}))}}class MPt extends NRt{constructor(t){let e;if(super(null),NOt(t=null!==t&&void 0!==t?t:{name:"source"})||(e=t.format?Object.assign({},iCt(t.format,["parse"])):{}),EOt(t))this._data={values:t.values};else if(COt(t)){if(this._data={url:t.url},!e.type){let n=/(?:\.([^.]+))?$/.exec(t.url)[1];cCt(["json","csv","tsv","dsv","topojson"],n)||(n="json"),e.type=n}}else FOt(t)?this._data={values:[{type:"Sphere"}]}:(TOt(t)||NOt(t))&&(this._data={});this._generator=NOt(t),t.name&&(this._name=t.name),e&&!mCt(e)&&(this._data.format=e)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}function OPt(t){for(const e of t){for(const t of e.children)if(t.parent!==e)return console.error("Dataflow graph is inconsistent.",e,t),!1;if(!OPt(e.children))return!1}return!0}class RPt extends NRt{constructor(t,e){super(t),this.params=e}clone(){return new RPt(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return"Graticule ".concat(oCt(this.params))}assemble(){return Object.assign({type:"graticule"},!0===this.params?{}:this.params)}}class zPt extends NRt{constructor(t,e){super(t),this.params=e}clone(){return new zPt(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([null!==(t=this.params.as)&&void 0!==t?t:"data"])}hash(){return"Hash ".concat(oCt(this.params))}assemble(){return Object.assign({type:"sequence"},this.params)}}function BPt(t){return t instanceof MPt||t instanceof RPt||t instanceof zPt}class LPt{constructor(){this._mutated=!1}setMutated(){this._mutated=!0}get mutatedFlag(){return this._mutated}}class PPt extends LPt{constructor(){super(),this._continue=!1}setContinue(){this._continue=!0}get continueFlag(){return this._continue}get flags(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}}set flags(t){let{continueFlag:e,mutatedFlag:n}=t;e&&this.setContinue(),n&&this.setMutated()}reset(){}optimizeNextFromLeaves(t){if(BPt(t))return!1;const e=t.parent,{continueFlag:n}=this.run(t);return n&&this.optimizeNextFromLeaves(e),this.mutatedFlag}}class jPt extends LPt{}function UPt(t,e,n,r){const i=Xjt(r)?r.encoding[CTt(e)]:void 0;if(JFt(n)&&Xjt(r)&&VFt(e,n,i,r.stack,r.markDef,r.config))t.add(aIt(n,{})),t.add(aIt(n,{suffix:"end"})),n.bin&&AIt(n,e)&&t.add(aIt(n,{binSuffix:"range"}));else if(function(t){return t in aTt}(e)){const n=function(t){switch(t){case OEt:return"y";case zEt:return"y2";case REt:return"x";case BEt:return"x2"}}(e);t.add(r.getName(n))}else t.add(aIt(n));return t}class WPt extends NRt{constructor(t,e,n){super(t),this.dimensions=e,this.measures=n}clone(){return new WPt(null,new Set(this.dimensions),nCt(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,e){let n=!1;e.forEachFieldDef((t=>{t.aggregate&&(n=!0)}));const r={},i=new Set;return n?(e.forEachFieldDef(((t,n)=>{var a,o,s,c;const{aggregate:u,field:l}=t;if(u)if("count"===u)r["*"]=null!==(a=r["*"])&&void 0!==a?a:{},r["*"].count=new Set([aIt(t,{forAs:!0})]);else{if(mEt(u)||yEt(u)){const t=mEt(u)?"argmin":"argmax",e=u[t];r[e]=null!==(o=r[e])&&void 0!==o?o:{},r[e][t]=new Set([aIt({op:t,field:e},{forAs:!0})])}else r[l]=null!==(s=r[l])&&void 0!==s?s:{},r[l][u]=new Set([aIt(t,{forAs:!0})]);oNt(n)&&"unaggregated"===e.scaleDomain(n)&&(r[l]=null!==(c=r[l])&&void 0!==c?c:{},r[l].min=new Set([aIt({field:l,aggregate:"min"},{forAs:!0})]),r[l].max=new Set([aIt({field:l,aggregate:"max"},{forAs:!0})]))}else UPt(i,n,t,e)})),i.size+yCt(r).length===0?null:new WPt(t,i,r)):null}static makeFromTransform(t,e){var n,r,i;const a=new Set,o={};for(const s of e.aggregate){const{op:t,field:e,as:i}=s;t&&("count"===t?(o["*"]=null!==(n=o["*"])&&void 0!==n?n:{},o["*"].count=new Set([i||aIt(s,{forAs:!0})])):(o[e]=null!==(r=o[e])&&void 0!==r?r:{},o[e][t]=new Set([i||aIt(s,{forAs:!0})])))}for(const s of null!==(i=e.groupby)&&void 0!==i?i:[])a.add(s);return a.size+yCt(o).length===0?null:new WPt(t,a,o)}merge(t){return function(t,e){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}(this.dimensions,t.dimensions)?(function(t,e){var n;for(const r of yCt(e)){const i=e[r];for(const e of yCt(i))r in t?t[r][e]=new Set([...null!==(n=t[r][e])&&void 0!==n?n:[],...i[e]]):t[r]={[e]:i[e]}}}(this.measures,t.measures),!0):(function(){HNt.debug(...arguments)}("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...yCt(this.measures)])}producedFields(){const t=new Set;for(const e of yCt(this.measures))for(const n of yCt(this.measures[e])){const r=this.measures[e][n];0===r.size?t.add("".concat(n,"_").concat(e)):r.forEach(t.add,t)}return t}hash(){return"Aggregate ".concat(oCt({dimensions:this.dimensions,measures:this.measures}))}assemble(){const t=[],e=[],n=[];for(const r of yCt(this.measures))for(const i of yCt(this.measures[r]))for(const a of this.measures[r][i])n.push(a),t.push(i),e.push("*"===r?null:ECt(r));return{type:"aggregate",groupby:[...this.dimensions].map(ECt),ops:t,fields:e,as:n}}}class VPt extends NRt{constructor(t,e,n,r){super(t),this.model=e,this.name=n,this.data=r;for(const i of lTt){const t=e.facet[i];if(t){const{bin:n,sort:r}=t;this[i]=Object.assign({name:e.getName("".concat(i,"_domain")),fields:[aIt(t),...fNt(n)?[aIt(t,{binSuffix:"end"})]:[]]},RFt(r)?{sortField:r}:NAt(r)?{sortIndexField:RLt(t,i)}:{})}}this.childModel=e.child}hash(){let t="Facet";for(const e of lTt)this[e]&&(t+=" ".concat(e.charAt(0),":").concat(oCt(this[e])));return t}get fields(){var t;const e=[];for(const n of lTt)(null===(t=this[n])||void 0===t?void 0:t.fields)&&e.push(...this[n].fields);return e}dependentFields(){const t=new Set(this.fields);for(const e of lTt)this[e]&&(this[e].sortField&&t.add(this[e].sortField.field),this[e].sortIndexField&&t.add(this[e].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const e of VTt){const n=this.childModel.component.scales[e];if(n&&!n.merged){const r=n.get("type"),i=n.get("range");if(XDt(r)&&dDt(i)){const n=Ejt(Tjt(this.childModel,e));n?t[e]=n:XNt("Unknown field for ".concat(e,". Cannot calculate view size."))}}}return t}assembleRowColumnHeaderData(t,e,n){const r={row:"y",column:"x"}[t],i=[],a=[],o=[];n&&n[r]&&(e?(i.push("distinct_".concat(n[r])),a.push("max")):(i.push(n[r]),a.push("distinct")),o.push("distinct_".concat(n[r])));const{sortField:s,sortIndexField:c}=this[t];if(s){const{op:t=FFt,field:e}=s;i.push(e),a.push(t),o.push(aIt(s,{forAs:!0}))}else c&&(i.push(c),a.push("max"),o.push(c));return{name:this[t].name,source:null!==e&&void 0!==e?e:this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},i.length?{fields:i,ops:a,as:o}:{})]}}assembleFacetHeaderData(t){var e,n;const{columns:r}=this.model.layout,{layoutHeaders:i}=this.model.component,a=[],o={};for(const u of PLt){for(const t of jLt){const r=null!==(e=i[u]&&i[u][t])&&void 0!==e?e:[];for(const t of r)if((null===(n=t.axes)||void 0===n?void 0:n.length)>0){o[u]=!0;break}}if(o[u]){const t='length(data("'.concat(this.facet.name,'"))'),e="row"===u?r?{signal:"ceil(".concat(t," / ").concat(r,")")}:1:r?{signal:"min(".concat(t,", ").concat(r,")")}:{signal:t};a.push({name:"".concat(this.facet.name,"_").concat(u),transform:[{type:"sequence",start:0,stop:e}]})}}const{row:s,column:c}=o;return(s||c)&&a.unshift(this.assembleRowColumnHeaderData("facet",null,t)),a}assemble(){var t,e;const n=[];let r=null;const i=this.getChildIndependentFieldsWithStep(),{column:a,row:o,facet:s}=this;if(a&&o&&(i.x||i.y)){r="cross_".concat(this.column.name,"_").concat(this.row.name);const a=[].concat(null!==(t=i.x)&&void 0!==t?t:[],null!==(e=i.y)&&void 0!==e?e:[]),o=a.map((()=>"distinct"));n.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:a,ops:o}]})}for(const c of[SEt,_Et])this[c]&&n.push(this.assembleRowColumnHeaderData(c,r,i));if(s){const t=this.assembleFacetHeaderData(i);t&&n.push(...t)}return n}}function qPt(t){return"'"===t[0]&&"'"===t[t.length-1]||'"'===t[0]&&'"'===t[t.length-1]?t.slice(1,-1):t}function GPt(t){const e={};return JAt(t.filter,(t=>{var n;if(SDt(t)){let r=null;yDt(t)?r=t.equal:kDt(t)?r=t.range[0]:_Dt(t)&&(r=(null!==(n=t.oneOf)&&void 0!==n?n:t.in)[0]),r&&(KNt(r)?e[t.field]="date":PAt(r)?e[t.field]="number":jAt(r)&&(e[t.field]="string")),t.timeUnit&&(e[t.field]="date")}})),e}function HPt(t){const e={};function n(t){var n;kIt(t)?e[t.field]="date":"quantitative"===t.type&&(jAt(n=t.aggregate)&&cCt(["min","max"],n))?e[t.field]="number":DCt(t.field)>1?t.field in e||(e[t.field]="flatten"):eIt(t)&&RFt(t.sort)&&DCt(t.sort.field)>1&&(t.sort.field in e||(e[t.sort.field]="flatten"))}if((Xjt(t)||Kjt(t))&&t.forEachFieldDef(((e,r)=>{if(JFt(e))n(e);else{const i=STt(r),a=t.fieldDef(i);n(Object.assign(Object.assign({},e),{type:a.type}))}})),Xjt(t)){const{mark:n,markDef:r,encoding:i}=t;if(rEt(n)&&!t.encoding.order){const t=i["horizontal"===r.orient?"y":"x"];YFt(t)&&"quantitative"===t.type&&!(t.field in e)&&(e[t.field]="number")}}return e}class YPt extends NRt{constructor(t,e){super(t),this._parse=e}clone(){return new YPt(null,nCt(this._parse))}hash(){return"Parse ".concat(oCt(this._parse))}static makeExplicit(t,e,n){let r={};const i=e.data;return!NOt(i)&&i&&i.format&&i.format.parse&&(r=i.format.parse),this.makeWithAncestors(t,r,{},n)}static makeWithAncestors(t,e,n,r){for(const o of yCt(n)){const t=r.getWithExplicit(o);void 0!==t.value&&(t.explicit||t.value===n[o]||"derived"===t.value||"flatten"===n[o]?delete n[o]:XNt(ENt(o,n[o],t.value)))}for(const o of yCt(e)){const t=r.get(o);void 0!==t&&(t===e[o]?delete e[o]:XNt(ENt(o,e[o],t)))}const i=new bOt(e,n);r.copyAll(i);const a={};for(const o of yCt(i.combine())){const t=i.get(o);null!==t&&(a[o]=t)}return 0===yCt(a).length||r.parseNothing?null:new YPt(t,a)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const e of yCt(this._parse)){const n=this._parse[e];1===DCt(e)&&(t[e]=n)}return t}producedFields(){return new Set(yCt(this._parse))}dependentFields(){return new Set(yCt(this._parse))}assembleTransforms(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return yCt(this._parse).filter((e=>!t||DCt(e)>1)).map((t=>{const e=function(t,e){const n=ACt(t);if("number"===e)return"toNumber(".concat(n,")");if("boolean"===e)return"toBoolean(".concat(n,")");if("string"===e)return"toString(".concat(n,")");if("date"===e)return"toDate(".concat(n,")");if("flatten"===e)return n;if(0===e.indexOf("date:")){const t=qPt(e.slice(5,e.length));return"timeParse(".concat(n,",'").concat(t,"')")}if(0===e.indexOf("utc:")){const t=qPt(e.slice(4,e.length));return"utcParse(".concat(n,",'").concat(t,"')")}return XNt('Unrecognized parse "'.concat(e,'".')),null}(t,this._parse[t]);if(!e)return null;return{type:"formula",expr:e,as:NCt(t)}})).filter((t=>null!==t))}}class XPt extends NRt{clone(){return new XPt(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([wMt])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:wMt}}}class KPt extends NRt{constructor(t,e){super(t),this.transform=e}clone(){return new KPt(null,nCt(this.transform))}addDimensions(t){this.transform.groupby=dCt(this.transform.groupby.concat(t),(t=>t))}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map((t=>t.field)).filter((t=>void 0!==t)).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var e;return null!==(e=t.as)&&void 0!==e?e:aIt(t)}hash(){return"JoinAggregateTransform ".concat(oCt(this.transform))}assemble(){const t=[],e=[],n=[];for(const i of this.transform.joinaggregate)e.push(i.op),n.push(this.getDefaultName(i)),t.push(void 0===i.field?null:i.field);const r=this.transform.groupby;return Object.assign({type:"joinaggregate",as:n,ops:e,fields:t},void 0!==r?{groupby:r}:{})}}class $Pt extends NRt{constructor(t,e){super(t),this._stack=e}clone(){return new $Pt(null,nCt(this._stack))}static makeFromTransform(t,e){const{stack:n,groupby:r,as:i,offset:a="zero"}=e,o=[],s=[];if(void 0!==e.sort)for(const l of e.sort)o.push(l.field),s.push(FCt(l.order,"ascending"));const c={field:o,order:s};let u;return u=function(t){return NAt(t)&&t.every((t=>jAt(t)))&&t.length>1}(i)?i:jAt(i)?[i,i+"_end"]:[e.stack+"_start",e.stack+"_end"],new $Pt(t,{stackField:n,groupby:r,offset:a,sort:c,facetby:[],as:u})}static makeFromEncoding(t,e){const n=e.stack,{encoding:r}=e;if(!n)return null;const{groupbyChannel:i,fieldChannel:a,offset:o,impute:s}=n;let c;if(i){c=gIt(r[i])}const u=function(t){return t.stack.stackBy.reduce(((t,e)=>{const n=aIt(e.fieldDef);return n&&t.push(n),t}),[])}(e),l=e.encoding.order;let h;return h=NAt(l)||YFt(l)?zIt(l):u.reduce(((t,e)=>(t.field.push(e),t.order.push("y"===a?"descending":"ascending"),t)),{field:[],order:[]}),new $Pt(t,{dimensionFieldDef:c,stackField:e.vgField(a),facetby:[],stackby:u,sort:h,offset:o,impute:s,as:[e.vgField(a,{suffix:"start",forAs:!0}),e.vgField(a,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return"Stack ".concat(oCt(this._stack))}getGroupbyFields(){const{dimensionFieldDef:t,impute:e,groupby:n}=this._stack;return t?t.bin?e?[aIt(t,{binSuffix:"mid"})]:[aIt(t,{}),aIt(t,{binSuffix:"end"})]:[aIt(t)]:null!==n&&void 0!==n?n:[]}assemble(){const t=[],{facetby:e,dimensionFieldDef:n,stackField:r,stackby:i,sort:a,offset:o,impute:s,as:c}=this._stack;if(s&&n){const{band:a=.5,bin:o}=n;o&&t.push({type:"formula",expr:"".concat(a,"*")+aIt(n,{expr:"datum"})+"+".concat(1-a,"*")+aIt(n,{expr:"datum",binSuffix:"end"}),as:aIt(n,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:r,groupby:[...i,...e],key:aIt(n,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...e],field:r,sort:a,as:c,offset:o}),t}}class ZPt extends NRt{constructor(t,e){super(t),this.transform=e}clone(){return new ZPt(null,nCt(this.transform))}addDimensions(t){this.transform.groupby=dCt(this.transform.groupby.concat(t),(t=>t))}dependentFields(){var t,e;const n=new Set;return(null!==(t=this.transform.groupby)&&void 0!==t?t:[]).forEach(n.add,n),(null!==(e=this.transform.sort)&&void 0!==e?e:[]).forEach((t=>n.add(t.field))),this.transform.window.map((t=>t.field)).filter((t=>void 0!==t)).forEach(n.add,n),n}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var e;return null!==(e=t.as)&&void 0!==e?e:aIt(t)}hash(){return"WindowTransform ".concat(oCt(this.transform))}assemble(){var t;const e=[],n=[],r=[],i=[];for(const h of this.transform.window)n.push(h.op),r.push(this.getDefaultName(h)),i.push(void 0===h.param?null:h.param),e.push(void 0===h.field?null:h.field);const a=this.transform.frame,o=this.transform.groupby;if(a&&null===a[0]&&null===a[1]&&n.every((t=>vEt(t))))return Object.assign({type:"joinaggregate",as:r,ops:n,fields:e},void 0!==o?{groupby:o}:{});const s=[],c=[];if(void 0!==this.transform.sort)for(const h of this.transform.sort)s.push(h.field),c.push(null!==(t=h.order)&&void 0!==t?t:"ascending");const u={field:s,order:c},l=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:i,as:r,ops:n,fields:e,sort:u},void 0!==l?{ignorePeers:l}:{}),void 0!==o?{groupby:o}:{}),void 0!==a?{frame:a}:{})}}class QPt extends PPt{run(t){const e=t.parent;if(t instanceof YPt){if(BPt(e))return this.flags;if(e.numChildren()>1)return this.setContinue(),this.flags;if(e instanceof YPt)this.setMutated(),e.merge(t);else{if(gCt(e.producedFields(),t.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),t.swapWithParent()}}return this.setContinue(),this.flags}}class JPt extends jPt{mergeNodes(t,e){const n=e.shift();for(const r of e)t.removeChild(r),r.parent=n,r.remove()}run(t){const e=t.children.map((t=>t.hash())),n={};for(let r=0;r<e.length;r++)void 0===n[e[r]]?n[e[r]]=[t.children[r]]:n[e[r]].push(t.children[r]);for(const r of yCt(n))n[r].length>1&&(this.setMutated(),this.mergeNodes(t,n[r]));for(const r of t.children)this.run(r);return this.mutatedFlag}}class tjt extends PPt{run(t){return t instanceof DRt||t.numChildren()>0||t instanceof VPt||(this.setMutated(),t.remove()),this.flags}}class ejt extends PPt{constructor(){super(...arguments),this.fields=new Set,this.prev=null}run(t){if(this.setContinue(),t instanceof FRt){const e=t.producedFields();fCt(e,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([...this.fields,...e]),this.prev=t}return this.flags}reset(){this.fields.clear()}}class njt extends PPt{run(t){this.setContinue();const e=t.parent.children.filter((t=>t instanceof FRt)),n=e.pop();for(const r of e)this.setMutated(),n.merge(r);return this.flags}}function rjt(t){if(t instanceof VPt)if(1!==t.numChildren()||t.children[0]instanceof DRt){const n=t.model.component.data.main;ijt(n);const r=(e=t,function t(n){if(!(n instanceof VPt)){const r=n.clone();if(r instanceof DRt){const t=hjt+r.getSource();r.setSource(t),e.model.component.data.outputNodes[t]=r}else(r instanceof WPt||r instanceof $Pt||r instanceof ZPt||r instanceof KPt)&&r.addDimensions(e.fields);for(const e of n.children.flatMap(t))e.parent=r;return[r]}return n.children.flatMap(t)}),i=t.children.map(r).flat();for(const t of i)t.parent=n}else{const e=t.children[0];(e instanceof WPt||e instanceof $Pt||e instanceof ZPt||e instanceof KPt)&&e.addDimensions(t.fields),e.swapWithParent(),rjt(t)}else t.children.map(rjt);var e}function ijt(t){if(t instanceof DRt&&t.type===MOt&&1===t.numChildren()){const e=t.children[0];e instanceof VPt||(e.swapWithParent(),ijt(t))}}class ajt extends jPt{constructor(){super()}run(t){t instanceof DRt&&!t.isRequired()&&(this.setMutated(),t.remove());for(const e of t.children)this.run(e);return this.mutatedFlag}}class ojt extends jPt{constructor(t){super(),this.requiresSelectionId=t&&vzt(t)}run(t){t instanceof XPt&&(this.requiresSelectionId&&(BPt(t.parent)||t.parent instanceof WPt||t.parent instanceof YPt)||(this.setMutated(),t.remove()));for(const e of t.children)this.run(e);return this.mutatedFlag}}class sjt extends PPt{run(t){const e=t.parent,n=[...e.children],r=e.children.filter((t=>t instanceof YPt));if(e.numChildren()>1&&r.length>=1){const t={},i=new Set;for(const e of r){const n=e.parse;for(const e of yCt(n))e in t?t[e]!==n[e]&&i.add(e):t[e]=n[e]}for(const e of i)delete t[e];if(!mCt(t)){this.setMutated();const r=new YPt(e,t);for(const i of n){if(i instanceof YPt)for(const e of yCt(t))delete i.parse[e];e.removeChild(i),i.parent=r,i instanceof YPt&&0===yCt(i.parse).length&&i.remove()}}}return this.setContinue(),this.flags}}class cjt extends PPt{run(t){const e=t.parent,n=e.children.filter((t=>t instanceof WPt)),r={};for(const i of n){const t=oCt(i.groupBy);t in r||(r[t]=[]),r[t].push(i)}for(const i of yCt(r)){const t=r[i];if(t.length>1){const n=t.pop();for(const r of t)n.merge(r)&&(e.removeChild(r),r.parent=n,r.remove(),this.setMutated())}}return this.setContinue(),this.flags}}class ujt extends PPt{constructor(t){super(),this.model=t}run(t){const e=t.parent,n=!(BPt(e)||e instanceof pLt||e instanceof YPt||e instanceof XPt),r=[],i=[];for(const a of e.children)a instanceof IPt&&(n&&!gCt(e.producedFields(),a.dependentFields())?r.push(a):i.push(a));if(r.length>0){const t=r.pop();for(const e of r)t.merge(e,this.model.renameSignal.bind(this.model));this.setMutated(),e instanceof IPt?e.merge(t,this.model.renameSignal.bind(this.model)):t.swapWithParent()}if(i.length>1){const t=i.pop();for(const e of i)t.merge(e,this.model.renameSignal.bind(this.model));this.setMutated()}return this.setContinue(),this.flags}}class ljt extends PPt{run(t){const e=t.parent,n=[...e.children];if(!uCt(n,(t=>t instanceof DRt))||e.numChildren()<=1)return this.setContinue(),this.flags;const r=[];let i;for(const a of n)if(a instanceof DRt){let t=a;for(;1===t.numChildren();){const e=t.children[0];if(!(e instanceof DRt))break;t=e}r.push(...t.children),i?(e.removeChild(a),a.parent=i.parent,i.parent.removeChild(i),i.parent=t,this.setMutated()):i=t}else r.push(a);if(r.length){this.setMutated();for(const t of r)t.parent.removeChild(t),t.parent=i}return this.setContinue(),this.flags}}const hjt="scale_",djt=5;function fjt(t){const e=[];function n(t){if(0===t.numChildren())e.push(t);else for(const e of t.children)n(e)}for(const r of t)n(r);return e}function pjt(t){return t}function gjt(t,e){return e.map((e=>{if(t instanceof PPt){const n=t.optimizeNextFromLeaves(e);return t.reset(),n}return t.run(e)})).some(pjt)}function mjt(t,e){let n=t.sources;const r=new Set;return r.add(gjt(new ajt,n)),r.add(gjt(new ojt(e),n)),n=n.filter((t=>t.numChildren()>0)),r.add(gjt(new tjt,fjt(n))),n=n.filter((t=>t.numChildren()>0)),r.add(gjt(new QPt,fjt(n))),r.add(gjt(new ujt(e),fjt(n))),r.add(gjt(new ejt,fjt(n))),r.add(gjt(new sjt,fjt(n))),r.add(gjt(new cjt,fjt(n))),r.add(gjt(new njt,fjt(n))),r.add(gjt(new JPt,n)),r.add(gjt(new ljt,fjt(n))),t.sources=n,r.has(!0)}class yjt{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,e){return new yjt((()=>t(e)))}}function vjt(t){Xjt(t)?function(t){const e=t.component.scales;for(const n of yCt(e)){const r=bjt(t,n);if(e[n].setWithExplicit("domains",r),_jt(t,n),t.component.data.isFaceted){let e=t;for(;!Kjt(e)&&e.parent;)e=e.parent;if("shared"===e.component.resolve.scale[n])for(const t of r.value)fDt(t)&&(t.data=hjt+t.data.replace(hjt,""))}}}(t):function(t){for(const n of t.children)vjt(n);const e=t.component.scales;for(const n of yCt(e)){let r,i=null;for(const e of t.children){const t=e.component.scales[n];if(t){r=void 0===r?t.getWithExplicit("domains"):SOt(r,t.getWithExplicit("domains"),"domains","scale",Ajt);const e=t.get("selectionExtent");i&&e&&i.selection!==e.selection&&XNt("The same selection must be used to override scale domains in a layered view."),i=e}}e[n].setWithExplicit("domains",r),i&&e[n].set("selectionExtent",i,!0)}}(t)}function bjt(t,e){const n=t.getScaleComponent(e).get("type"),{encoding:r}=t,i=function(t,e,n,r){if("unaggregated"===t){const{valid:t,reason:r}=Sjt(e,n);if(!t)return void XNt(r)}else if(void 0===t&&r.useUnaggregatedDomain){const{valid:t}=Sjt(e,n);if(t)return"unaggregated"}return t}(t.scaleDomain(e),t.typedFieldDef(e),n,t.config.scale);return i!==t.scaleDomain(e)&&(t.specifiedScales[e]=Object.assign(Object.assign({},t.specifiedScales[e]),{domain:i})),"x"===e&&mIt(r.x2)?mIt(r.x)?SOt(wjt(n,i,t,"x"),wjt(n,i,t,"x2"),"domain","scale",Ajt):wjt(n,i,t,"x2"):"y"===e&&mIt(r.y2)?mIt(r.y)?SOt(wjt(n,i,t,"y"),wjt(n,i,t,"y2"),"domain","scale",Ajt):wjt(n,i,t,"y2"):wjt(n,i,t,e)}function xjt(t,e,n){var r;const i=null===(r=lDt(n))||void 0===r?void 0:r.unit;return"temporal"===e||i?function(t,e,n){return t.map((t=>{const r=_It(t,{timeUnit:n,type:e});return{signal:"{data: ".concat(r,"}")}}))}(t,e,i):[t]}function wjt(t,e,n,r){const{encoding:i}=n,a=mIt(i[r]),{type:o}=a,s=a.timeUnit;if(function(t){return t&&t.unionWith}(e)){const i=wjt(t,void 0,n,r),a=xjt(e.unionWith,o,s);return xOt([...i.value,...a])}if(hDt(e))return xOt([e]);if(e&&"unaggregated"!==e&&!QDt(e))return xOt(xjt(e,o,s));const c=n.stack;if(c&&r===c.fieldChannel){if("normalize"===c.offset)return wOt([[0,1]]);const t=n.requestDataName(MOt);return wOt([{data:t,field:n.vgField(r,{suffix:"start"})},{data:t,field:n.vgField(r,{suffix:"end"})}])}const u=oNt(r)&&YFt(a)?function(t,e,n){if(!XDt(n))return;const r=t.fieldDef(e),i=r.sort;if(zFt(i))return{op:"min",field:RLt(r,e),order:"ascending"};const{stack:a}=t,o=a?[...a.groupbyField?[a.groupbyField]:[],...a.stackBy.map((t=>t.fieldDef.field))]:void 0;if(RFt(i)){return kjt(i,a&&!cCt(o,i.field))}if(OFt(i)){const{encoding:e,order:n}=i,r=t.fieldDef(e),{aggregate:s,field:c}=r,u=a&&!cCt(o,c);if(mEt(s)||yEt(s))return kjt({field:aIt(r),order:n},u);if(vEt(s)||!s)return kjt({op:s,field:c,order:n},u)}else{if("descending"===i)return{op:"min",field:t.vgField(e),order:"descending"};if(cCt(["ascending",void 0],i))return!0}return}(n,r,t):void 0;if(KFt(a)){return wOt(xjt([a.datum],o,s))}const l=a;if("unaggregated"===e){const t=n.requestDataName(MOt),{field:e}=a;return wOt([{data:t,field:aIt({field:e,aggregate:"min"})},{data:t,field:aIt({field:e,aggregate:"max"})}])}if(fNt(l.bin)){if(XDt(t))return wOt("bin-ordinal"===t?[]:[{data:xCt(u)?n.requestDataName(MOt):n.requestDataName(OOt),field:n.vgField(r,AIt(l,r)?{binSuffix:"range"}:{}),sort:!0!==u&&DAt(u)?u:{field:n.vgField(r,{}),op:"min"}}]);{const{bin:t}=l;if(fNt(t)){const e=DPt(n,l.field,t);return wOt([new yjt((()=>{const t=n.getSignalName(e);return"[".concat(t,".start, ").concat(t,".stop]")}))])}return wOt([{data:n.requestDataName(MOt),field:n.vgField(r,{})}])}}if(l.timeUnit&&cCt(["time","utc"],t)&&VFt(r,l,Xjt(n)?n.encoding[CTt(r)]:void 0,n.stack,n.markDef,n.config)){const t=n.requestDataName(MOt);return wOt([{data:t,field:n.vgField(r)},{data:t,field:n.vgField(r,{suffix:"end"})}])}return wOt(u?[{data:xCt(u)?n.requestDataName(MOt):n.requestDataName(OOt),field:n.vgField(r),sort:u}]:[{data:n.requestDataName(MOt),field:n.vgField(r)}])}function kjt(t,e){const{op:n,field:r,order:i}=t;return Object.assign(Object.assign({op:null!==n&&void 0!==n?n:e?"sum":FFt},r?{field:ECt(r)}:{}),i?{order:i}:{})}function _jt(t,e){var n;const r=t.component.scales[e],i=t.specifiedScales[e].domain,a=null===(n=t.fieldDef(e))||void 0===n?void 0:n.bin,o=QDt(i)&&i,s=gNt(a)&&mNt(a.extent)&&a.extent;(o||s)&&r.set("selectionExtent",null!==o&&void 0!==o?o:s,!0)}function Sjt(t,e){const{aggregate:n,type:r}=t;return n?jAt(n)&&!kEt[n]?{valid:!1,reason:BNt(n)}:"quantitative"===r&&"log"===e?{valid:!1,reason:LNt(t)}:{valid:!0}:{valid:!1,reason:zNt(t)}}function Ajt(t,e,n,r){return t.explicit&&e.explicit&&XNt(function(t,e,n,r){return"Conflicting ".concat(e.toString(),' property "').concat(t.toString(),'" (').concat(aCt(n)," and ").concat(aCt(r),"). Using the union of the two domains.")}(n,r,t.value,e.value)),{explicit:t.explicit,value:[...t.value,...e.value]}}function Cjt(t){const e=dCt(t.map((t=>{if(fDt(t)){const{sort:e}=t;return VAt(t,["sort"])}return t})),oCt),n=dCt(t.map((t=>{if(fDt(t)){const e=t.sort;return void 0===e||xCt(e)||("op"in e&&"count"===e.op&&delete e.field,"ascending"===e.order&&delete e.order),e}})).filter((t=>void 0!==t)),oCt);if(0===e.length)return;if(1===e.length){const e=t[0];if(fDt(e)&&n.length>0){let t=n[0];if(n.length>1)XNt(UNt),t=!0;else if(DAt(t)&&"field"in t){const n=t.field;e.field===n&&(t=!t.order||{order:t.order})}return Object.assign(Object.assign({},e),{sort:t})}return e}const r=dCt(n.map((t=>xCt(t)||!("op"in t)||t.op in gEt?t:(XNt(function(t){return"Dropping sort property ".concat(aCt(t),' as unioned domains only support boolean or op "count", "min", and "max".')}(t)),!0))),oCt);let i;1===r.length?i=r[0]:r.length>1&&(XNt(UNt),i=!0);const a=dCt(t.map((t=>fDt(t)?t.data:null)),(t=>t));if(1===a.length&&null!==a[0]){return Object.assign({data:a[0],fields:e.map((t=>t.field))},i?{sort:i}:{})}return Object.assign({fields:e},i?{sort:i}:{})}function Ejt(t){if(fDt(t)&&jAt(t.field))return t.field;if(function(t){return!NAt(t)&&"fields"in t&&!("data"in t)}(t)){let e;for(const n of t.fields)if(fDt(n)&&jAt(n.field))if(e){if(e!==n.field)return XNt("Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect."),e}else e=n.field;return XNt("Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect."),e}if(function(t){return!NAt(t)&&"fields"in t&&"data"in t}(t)){XNt("Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.");const e=t.fields[0];return jAt(e)?e:void 0}}function Tjt(t,e){const n=t.component.scales[e].get("domains").map((e=>(fDt(e)&&(e.data=t.lookupDataSource(e.data)),e)));return Cjt(n)}function Njt(t){return Zjt(t)||$jt(t)?t.children.reduce(((t,e)=>t.concat(Njt(e))),Djt(t)):Djt(t)}function Djt(t){return yCt(t.component.scales).reduce(((e,n)=>{const r=t.component.scales[n];if(r.merged)return e;const i=r.combine(),{name:a,type:o,selectionExtent:s,domains:c,range:u,reverse:l}=i,h=VAt(i,["name","type","selectionExtent","domains","range","reverse"]),d=function(t,e,n){if(qTt(n)&&dDt(t))return{step:{signal:e+"_step"}};return t}(i.range,a,n);let f;s&&(f=function(t,e){const n=e.selection;return{signal:mLt(t.getSelectionComponent(n,wCt(n)),e)}}(t,s));const p=Tjt(t,n);return e.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:a,type:o},p?{domain:p}:{}),f?{domainRaw:f}:{}),{range:d}),void 0!==l?{reverse:l}:{}),h)),e}),[])}class Fjt extends bOt{constructor(t,e){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",e)}domainDefinitelyIncludesZero(){return!1!==this.get("zero")||uCt(this.get("domains"),(t=>NAt(t)&&2===t.length&&t[0]<=0&&t[1]>=0))}}const Ijt=["range","scheme"];function Mjt(t){return"x"===t?"width":"y"===t?"height":void 0}function Ojt(t,e){const n=t.fieldDef(e);if(n&&n.bin&&fNt(n.bin)){const r=DPt(t,n.field,n.bin),i=Mjt(e),a=t.getName(i);return new yjt((()=>{const e=t.getSignalName(r),n="(".concat(e,".stop - ").concat(e,".start) / ").concat(e,".step");return"".concat(t.getSignalName(a)," / (").concat(n,")")}))}}function Rjt(t,e){const n=e.specifiedScales[t],{size:r}=e,i=e.getScaleComponent(t).get("type");for(const a of Ijt)if(void 0!==n[a]){const r=oFt(i,a),o=sFt(t,a);if(r)if(o)XNt(o);else switch(a){case"range":return NAt(n.range)&&qTt(t)?xOt(n.range.map((t=>{if("width"===t||"height"===t){const n=e.getName(t),r=e.getSignalName.bind(e);return yjt.fromName(r,n)}return t}))):xOt(n.range);case"scheme":return xOt(zjt(n[a]))}else XNt(PNt(i,a,t))}if(t===CEt||t===EEt){const e=t===CEt?"width":"height",n=r[e];if(TMt(n)){if(XDt(i))return xOt({step:n.step});XNt(jNt(e))}}return wOt(function(t,e){const{size:n,config:r,mark:i,encoding:a}=e,o=e.getSignalName.bind(e),{type:s}=mIt(a[t]),c=e.getScaleComponent(t),u=c.get("type"),{domain:l,domainMid:h}=e.specifiedScales[t];switch(t){case CEt:case EEt:{if(cCt(["point","band"],u))if(t!==CEt||n.width){if(t===EEt&&!n.height){const t=MMt(r.view,"height");if(TMt(t))return t}}else{const t=MMt(r.view,"width");if(TMt(t))return t}const i=Mjt(t),a=e.getName(i);return t===EEt&&KDt(u)?[yjt.fromName(o,a),0]:[0,yjt.fromName(o,a)]}case WEt:{const a=Bjt(i,e.component.scales[t].get("zero"),r),o=function(t,e,n,r){const i={x:Ojt(n,"x"),y:Ojt(n,"y")};switch(t){case"bar":case"tick":{if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;const t=Pjt(e,i,r.view);return PAt(t)?t-1:new yjt((()=>"".concat(t.signal," - 1")))}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const t=Pjt(e,i,r.view);return PAt(t)?Math.pow(Ljt*t,2):new yjt((()=>"pow(".concat(Ljt," * ").concat(t.signal,", 2)")))}}throw new Error(MNt("size",t))}(i,n,e,r);return ZDt(u)?function(t,e,n){const r=()=>{const r=DIt(e),i=DIt(t),a="(".concat(r," - ").concat(i,") / (").concat(n," - 1)");return"sequence(".concat(i,", ").concat(r," + ").concat(a,", ").concat(a,")")};return hDt(e)?new yjt(r):{signal:r()}}(a,o,function(t,e,n,r){switch(t){case"quantile":return e.scale.quantileCount;case"quantize":return e.scale.quantizeCount;case"threshold":return void 0!==n&&NAt(n)?n.length+1:(XNt(function(t){return"Domain for ".concat(t," is required for threshold scale.")}(r)),3)}}(u,r,l,t)):[a,o]}case IEt:return[0,2*Math.PI];case VEt:return[0,360];case DEt:return[0,new yjt((()=>{const t=e.getSignalName("width"),n=e.getSignalName("height");return"min(".concat(t,",").concat(n,")/2")}))];case YEt:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case XEt:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case UEt:return"symbol";case LEt:case PEt:case jEt:return"ordinal"===u?"nominal"===s?"category":"ordinal":void 0!==h?"diverging":"rect"===i||"geoshape"===i?"heatmap":"ramp";case qEt:case GEt:case HEt:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error("Scale range undefined for channel ".concat(t))}(t,e))}function zjt(t){return function(t){return!jAt(t)&&!!t.name}(t)?Object.assign({scheme:t.name},iCt(t,["name"])):{scheme:t}}function Bjt(t,e,n){if(e)return hDt(e)?{signal:"".concat(e.signal," ? 0 : ").concat(Bjt(t,!1,n))}:0;switch(t){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(MNt("size",t))}const Ljt=.95;function Pjt(t,e,n){const r=TMt(t.width)?t.width.step:IMt(n,"width"),i=TMt(t.height)?t.height.step:IMt(n,"height");return e.x||e.y?new yjt((()=>{const t=[e.x?e.x.signal:r,e.y?e.y.signal:i];return"min(".concat(t.join(", "),")")})):Math.min(r,i)}function jjt(t,e){Xjt(t)?function(t,e){const n=t.component.scales,{config:r,encoding:i,markDef:a,specifiedScales:o}=t;for(const s of yCt(n)){const c=o[s],u=n[s],l=t.getScaleComponent(s),h=mIt(i[s]),d=c[e],f=l.get("type"),p=l.get("padding"),g=l.get("paddingInner"),m=oFt(f,e),y=sFt(s,e);if(void 0!==d&&(m?y&&XNt(y):XNt(PNt(f,e,s))),m&&void 0===y)if(void 0!==d)u.copyKeyFromObject(e,c);else{const n=e in Ujt?Ujt[e]({model:t,channel:s,fieldOrDatumDef:h,scaleType:f,scalePadding:p,scalePaddingInner:g,domain:c.domain,markDef:a,config:r}):r.scale[e];void 0!==n&&u.set(e,n,!1)}}}(t,e):Vjt(t,e)}const Ujt={bins:t=>{let{model:e,fieldOrDatumDef:n}=t;return YFt(n)?function(t,e){const n=e.bin;if(fNt(n)){const r=DPt(t,e.field,n);return new yjt((()=>t.getSignalName(r)))}if(pNt(n)&&gNt(n)&&void 0!==n.step)return{step:n.step};return}(e,n):void 0},interpolate:t=>{let{channel:e,fieldOrDatumDef:n}=t;return function(t,e){if(cCt([LEt,PEt,jEt],t)&&"nominal"!==e)return"hcl";return}(e,n.type)},nice:t=>{let{scaleType:e,channel:n,fieldOrDatumDef:r}=t;return function(t,e,n){var r;if((null===(r=gIt(n))||void 0===r?void 0:r.bin)||cCt([zDt.TIME,zDt.UTC],t))return;return e in WTt||void 0}(e,n,r)},padding:t=>{let{channel:e,scaleType:n,fieldOrDatumDef:r,markDef:i,config:a}=t;return function(t,e,n,r,i,a){if(t in WTt){if($Dt(e)){if(void 0!==n.continuousPadding)return n.continuousPadding;const{type:e,orient:o}=i;if("bar"===e&&(!YFt(r)||!r.bin&&!r.timeUnit)&&("vertical"===o&&"x"===t||"horizontal"===o&&"y"===t))return a.continuousBandSize}if(e===zDt.POINT)return n.pointPadding}return}(e,n,a.scale,r,i,a.bar)},paddingInner:t=>{let{scalePadding:e,channel:n,markDef:r,config:i}=t;return function(t,e,n,r){if(void 0!==t)return;if(e in WTt){const{bandPaddingInner:t,barBandPaddingInner:e,rectBandPaddingInner:i}=r;return FCt(t,"bar"===n?e:i)}return}(e,n,r.type,i.scale)},paddingOuter:t=>{let{scalePadding:e,channel:n,scaleType:r,markDef:i,scalePaddingInner:a,config:o}=t;return function(t,e,n,r,i,a){if(void 0!==t)return;if(e in WTt&&n===zDt.BAND){const{bandPaddingOuter:t}=a;return FCt(t,hDt(i)?{signal:"".concat(i.signal,"/2")}:i/2)}return}(e,n,r,i.type,a,o.scale)},reverse:t=>{let{fieldOrDatumDef:e,scaleType:n,channel:r,config:i}=t;return function(t,e,n,r){if("x"===n&&void 0!==r.xReverse)return KDt(t)&&"descending"===e?hDt(r.xReverse)?{signal:"!".concat(r.xReverse.signal)}:!r.xReverse:r.xReverse;if(KDt(t)&&"descending"===e)return!0;return}(n,YFt(e)?e.sort:void 0,r,i.scale)},zero:t=>{let{channel:e,fieldOrDatumDef:n,domain:r,markDef:i,scaleType:a}=t;return function(t,e,n,r,i){if(n&&"unaggregated"!==n&&KDt(i)){if(NAt(n)){const t=n[0],e=n[n.length-1];if(t<=0&&e>=0)return!0}return!1}if("size"===t&&"quantitative"===e.type&&!ZDt(i))return!0;if((!YFt(e)||!e.bin)&&cCt([...VTt,...HTt],t)){const{orient:e,type:n}=r;return!cCt(["bar","area","line","trail"],n)||!("horizontal"===e&&"y"===t||"vertical"===e&&"x"===t)}return!1}(e,n,r,i,a)}};function Wjt(t){Xjt(t)?function(t){const e=t.component.scales;for(const n of aNt){const r=e[n];if(!r)continue;const i=Rjt(n,t);r.setWithExplicit("range",i)}}(t):Vjt(t,"range")}function Vjt(t,e){const n=t.component.scales;for(const r of t.children)"range"===e?Wjt(r):jjt(r,e);for(const r of yCt(n)){let i;for(const n of t.children){const t=n.component.scales[r];if(t){i=SOt(i,t.getWithExplicit(e),e,"scale",kOt(((t,n)=>"range"===e&&t.step&&n.step?t.step-n.step:0)))}}n[r].setWithExplicit(e,i)}}function qjt(t,e,n,r){const i=function(t,e,n){var r;switch(e.type){case"nominal":case"ordinal":if(cTt(t)||"discrete"===hNt(t))return"shape"===t&&"ordinal"===e.type&&XNt(RNt(t,"ordinal")),"ordinal";if(t in WTt){if(cCt(["rect","bar","image","rule"],n))return"band"}else if("arc"===n&&t in GTt)return"band";return void 0!==e.band||nIt(e)&&(null===(r=e.axis)||void 0===r?void 0:r.tickBand)?"band":"point";case"temporal":return cTt(t)?"time":"discrete"===hNt(t)?(XNt(RNt(t,"temporal")),"ordinal"):YFt(e)&&e.timeUnit&&lDt(e.timeUnit).utc?"utc":"time";case"quantitative":return cTt(t)?YFt(e)&&fNt(e.bin)?"bin-ordinal":"linear":"discrete"===hNt(t)?(XNt(RNt(t,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(DNt(e.type))}(e,n,r),{type:a}=t;return oNt(e)?void 0!==a?uFt(e,a)?YFt(n)&&!cFt(a,n.type)?(XNt(function(t,e){return'FieldDef does not work with "'.concat(t,'" scale. We are using "').concat(e,'" scale instead.')}(a,i)),i):a:(XNt(function(t,e,n){return'Channel "'.concat(t,'" does not work with "').concat(e,'" scale. We are using "').concat(n,'" scale instead.')}(e,a,i)),i):i:null}function Gjt(t){Xjt(t)?t.component.scales=function(t){const{encoding:e,mark:n}=t;return aNt.reduce(((r,i)=>{const a=mIt(e[i]);if(a&&n===nEt&&i===UEt&&a.type===ODt)return r;let o=a&&a.scale;if(a&&null!==o&&!1!==o){o=null!==o&&void 0!==o?o:{};const e=qjt(o,i,a,n);r[i]=new Fjt(t.scaleName(i+"",!0),{value:e,explicit:o.type===e})}return r}),{})}(t):t.component.scales=function(t){var e;const n=t.component.scales={},r={},i=t.component.resolve;for(const a of t.children){Gjt(a);for(const n of yCt(a.component.scales))if(i.scale[n]=null!==(e=i.scale[n])&&void 0!==e?e:rPt(n,t),"shared"===i.scale[n]){const t=r[n],e=a.component.scales[n].getWithExplicit("type");t?PDt(t.value,e.value)?r[n]=SOt(t,e,"type","scale",Hjt):(i.scale[n]="independent",delete r[n]):r[n]=e}}for(const a of yCt(r)){const e=t.scaleName(a,!0),i=r[a];n[a]=new Fjt(e,i);for(const n of t.children){const t=n.component.scales[a];t&&(n.renameScale(t.get("name"),e),t.merged=!0)}}return n}(t)}const Hjt=kOt(((t,e)=>UDt(t)-UDt(e)));class Yjt{constructor(){this.nameMap={}}rename(t,e){this.nameMap[t]=e}has(t){return void 0!==this.nameMap[t]}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function Xjt(t){return"unit"===(null===t||void 0===t?void 0:t.type)}function Kjt(t){return"facet"===(null===t||void 0===t?void 0:t.type)}function $jt(t){return"concat"===(null===t||void 0===t?void 0:t.type)}function Zjt(t){return"layer"===(null===t||void 0===t?void 0:t.type)}class Qjt{constructor(t,e,n,r,i,a,o){var s,c;this.type=e,this.parent=n,this.config=i,this.view=o,this.children=[],this.correctDataNames=t=>(t.from&&t.from.data&&(t.from.data=this.lookupDataSource(t.from.data)),t.from&&t.from.facet&&t.from.facet.data&&(t.from.facet.data=this.lookupDataSource(t.from.facet.data)),t),this.parent=n,this.config=i,this.name=null!==(s=t.name)&&void 0!==s?s:r,this.title=EIt(t.title)?{text:t.title}:t.title,this.scaleNameMap=n?n.scaleNameMap:new Yjt,this.projectionNameMap=n?n.projectionNameMap:new Yjt,this.signalNameMap=n?n.signalNameMap:new Yjt,this.data=t.data,this.description=t.description,this.transforms=function(t){return t.map((t=>ROt(t)?{filter:tCt(t.filter,TDt)}:t))}(null!==(c=t.transform)&&void 0!==c?c:[]),this.layout="layer"===e||"unit"===e?{}:function(t,e,n){var r,i;const a=n[e],o={},{spacing:s,columns:c}=a;void 0!==s&&(o.spacing=s),void 0!==c&&(PFt(t)&&!BFt(t.facet)||AMt(t))&&(o.columns=c),CMt(t)&&(o.columns=1);for(const u of DMt)if(void 0!==t[u])if("spacing"===u){const e=t[u];o[u]=PAt(e)?e:{row:null!==(r=e.row)&&void 0!==r?r:s,column:null!==(i=e.column)&&void 0!==i?i:s}}else o[u]=t[u];return o}(t,e,i),this.component={data:{sources:n?n.component.data.sources:[],outputNodes:n?n.component.data.outputNodes:{},outputNodeRefCounts:n?n.component.data.outputNodeRefCounts:{},isFaceted:PFt(t)||n&&n.component.data.isFaceted&&void 0===t.data},layoutSize:new bOt,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},a?nCt(a):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){!function(t){let{ignoreRange:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Gjt(t),vjt(t);for(const n of aFt)jjt(t,n);e||Wjt(t)}(this)}parseProjection(){TPt(this)}renameTopLevelLayoutSizeSignal(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}parseLegends(){yPt(this)}assembleGroupStyle(){var t,e;if("unit"===this.type||"layer"===this.type)return null!==(e=null===(t=this.view)||void 0===t?void 0:t.style)&&void 0!==e?e:"cell"}assembleEncodeFromView(t){const{style:e}=t,n=VAt(t,["style"]),r={};for(const i of yCt(n)){const t=n[i];void 0!==t&&(r[i]=TIt(t))}return r}assembleGroupEncodeEntry(t){let e={};return this.view&&(e=this.assembleEncodeFromView(this.view)),t||(this.description&&(e.description=TIt(this.description)),"unit"!==this.type&&"layer"!==this.type)?mCt(e)?void 0:e:Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},null!==e&&void 0!==e?e:{})}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:e}=t,n=VAt(t,["spacing"]),{component:r,config:i}=this,a=function(t,e){const n={};for(const r of lTt){const i=t[r];if(null===i||void 0===i?void 0:i.facetFieldDef){const{titleAnchor:t,titleOrient:a}=LLt(["titleAnchor","titleOrient"],i.facetFieldDef,e,r),o=zLt(r,a),s=KLt(t,o);void 0!==s&&(n[o]=s)}}return mCt(n)?void 0:n}(r.layoutHeaders,i);return Object.assign(Object.assign(Object.assign({padding:e},this.assembleDefaultLayout()),n),a?{titleBand:a}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let e=[];for(const n of lTt)t[n].title&&e.push(ULt(this,n));for(const n of PLt)e=e.concat(qLt(this,n));return e}assembleAxes(){return function(t,e){const{x:n=[],y:r=[]}=t;return[...n.map((t=>bLt(t,"grid",e))),...r.map((t=>bLt(t,"grid",e))),...n.map((t=>bLt(t,"main",e))),...r.map((t=>bLt(t,"main",e)))].filter((t=>t))}(this.component.axes,this.config)}assembleLegends(){return _Pt(this)}assembleProjections(){return SPt(this)}assembleTitle(){var t,e,n;const r=null!==(t=this.title)&&void 0!==t?t:{},{encoding:i}=r,a=VAt(r,["encoding"]),o=Object.assign(Object.assign(Object.assign({},CIt(this.config.title).nonMark),a),i?{encode:{update:i}}:{});if(o.text)return cCt(["unit","layer"],this.type)?cCt(["middle",void 0],o.anchor)&&(o.frame=null!==(e=o.frame)&&void 0!==e?e:"group"):o.anchor=null!==(n=o.anchor)&&void 0!==n?n:"start",mCt(o)?void 0:o}assembleGroup(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e={};t=t.concat(this.assembleSignals()),t.length>0&&(e.signals=t);const n=this.assembleLayout();n&&(e.layout=n),e.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||Kjt(this.parent)?Njt(this):[];r.length>0&&(e.scales=r);const i=this.assembleAxes();i.length>0&&(e.axes=i);const a=this.assembleLegends();return a.length>0&&(e.legends=a),e}getName(t){return wCt((this.name?this.name+"_":"")+t)}requestDataName(t){var e;const n=this.getName(t),r=this.component.data.outputNodeRefCounts;return r[n]=(null!==(e=r[n])&&void 0!==e?e:0)+1,n}getSizeSignalRef(t){if(Kjt(this.parent)){const e=YTt(ePt(t)),n=this.component.scales[e];if(n&&!n.merged){const t=n.get("type"),r=n.get("range");if(XDt(t)&&dDt(r)){const t=n.get("name"),r=Ejt(Tjt(this,e));if(r){return{signal:tPt(t,n,aIt({aggregate:"distinct",field:r},{expr:"datum"}))}}return XNt("Unknown field for ".concat(e,". Cannot calculate view size.")),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const e=this.component.data.outputNodes[t];return e?e.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,e){this.signalNameMap.rename(t,e)}renameScale(t,e){this.scaleNameMap.rename(t,e)}renameProjection(t,e){this.projectionNameMap.rename(t,e)}scaleName(t,e){return e?this.getName(t):wTt(t)&&oNt(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t))?this.scaleNameMap.get(this.getName(t)):void 0}projectionName(t){return t?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const e=this.component.scales[t];return e&&!e.merged?e:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,e){let n=this.component.selection[t];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(t,e)),!n)throw new Error('Cannot find a selection named "'.concat(e,'".'));return n}hasAxisOrientSignalRef(){var t,e;return(null===(t=this.component.axes.x)||void 0===t?void 0:t.some((t=>t.hasOrientSignalRef())))||(null===(e=this.component.axes.y)||void 0===e?void 0:e.some((t=>t.hasOrientSignalRef())))}}class Jjt extends Qjt{vgField(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.fieldDef(t);if(n)return aIt(n,e)}reduceFieldDef(t,e){return HIt(this.getMapping(),((e,n,r)=>{const i=gIt(n);return i?t(e,i,r):e}),e)}forEachFieldDef(t,e){GIt(this.getMapping(),((e,n)=>{const r=gIt(e);r&&t(r,n)}),e)}}class tUt extends NRt{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=nCt(e);const a=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=a[0])&&void 0!==r?r:"value",null!==(i=a[1])&&void 0!==i?i:"density"]}clone(){return new tUt(null,nCt(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"DensityTransform ".concat(oCt(this.transform))}assemble(){const t=this.transform,{density:e}=t,n=VAt(t,["density"]);return Object.assign({type:"kde",field:e},n)}}class eUt extends NRt{constructor(t,e){super(t),this.filter=e}clone(){return new eUt(null,Object.assign({},this.filter))}static make(t,e){const{config:n,mark:r,markDef:i}=e;if("filter"!==IIt("invalid",i,n))return null;const a=e.reduceFieldDef(((t,n,i)=>{const a=oNt(i)&&e.getScaleComponent(i);if(a){KDt(a.get("type"))&&"count"!==n.aggregate&&!rEt(r)&&(t[n.field]=n)}return t}),{});return yCt(a).length?new eUt(t,a):null}dependentFields(){return new Set(yCt(this.filter))}producedFields(){return new Set}hash(){return"FilterInvalid ".concat(oCt(this.filter))}assemble(){const t=yCt(this.filter).reduce(((t,e)=>{const n=this.filter[e],r=aIt(n,{expr:"datum"});return null!==n&&("temporal"===n.type?t.push("(isDate(".concat(r,") || (isValid(").concat(r,") && isFinite(+").concat(r,")))")):"quantitative"===n.type&&(t.push("isValid(".concat(r,")")),t.push("isFinite(+".concat(r,")")))),t}),[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class nUt extends NRt{constructor(t,e){super(t),this.transform=e,this.transform=nCt(e);const{flatten:n,as:r=[]}=this.transform;this.transform.as=n.map(((t,e)=>{var n;return null!==(n=r[e])&&void 0!==n?n:t}))}clone(){return new nUt(this.parent,nCt(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return"FlattenTransform ".concat(oCt(this.transform))}assemble(){const{flatten:t,as:e}=this.transform;return{type:"flatten",fields:t,as:e}}}class rUt extends NRt{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=nCt(e);const a=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=a[0])&&void 0!==r?r:"key",null!==(i=a[1])&&void 0!==i?i:"value"]}clone(){return new rUt(null,nCt(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return"FoldTransform ".concat(oCt(this.transform))}assemble(){const{fold:t,as:e}=this.transform;return{type:"fold",fields:t,as:e}}}class iUt extends NRt{constructor(t,e,n,r){super(t),this.fields=e,this.geojson=n,this.signal=r}clone(){return new iUt(null,nCt(this.fields),this.geojson,this.signal)}static parseAll(t,e){if(e.component.projection&&!e.component.projection.isFit)return t;let n=0;for(const r of[[REt,OEt],[BEt,zEt]]){const i=r.map((t=>{const n=mIt(e.encoding[t]);return YFt(n)?n.field:KFt(n)?{expr:"".concat(n.datum)}:tIt(n)?{expr:"".concat(n.value)}:void 0}));(i[0]||i[1])&&(t=new iUt(t,i,null,e.getName("geojson_".concat(n++))))}if(e.channelHasField(UEt)){const r=e.typedFieldDef(UEt);r.type===ODt&&(t=new iUt(t,null,r.field,e.getName("geojson_".concat(n++))))}return t}dependentFields(){var t;const e=(null!==(t=this.fields)&&void 0!==t?t:[]).filter(jAt);return new Set([...this.geojson?[this.geojson]:[],...e])}producedFields(){return new Set}hash(){return"GeoJSON ".concat(this.geojson," ").concat(this.signal," ").concat(oCt(this.fields))}assemble(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}class aUt extends NRt{constructor(t,e,n,r){super(t),this.projection=e,this.fields=n,this.as=r}clone(){return new aUt(null,this.projection,nCt(this.fields),nCt(this.as))}static parseAll(t,e){if(!e.projectionName())return t;for(const n of[[REt,OEt],[BEt,zEt]]){const r=n.map((t=>{const n=mIt(e.encoding[t]);return YFt(n)?n.field:KFt(n)?{expr:"".concat(n.datum)}:tIt(n)?{expr:"".concat(n.value)}:void 0})),i=n[0]===BEt?"2":"";(r[0]||r[1])&&(t=new aUt(t,e.projectionName(),r,[e.getName("x"+i),e.getName("y"+i)]))}return t}dependentFields(){return new Set(this.fields.filter(jAt))}producedFields(){return new Set(this.as)}hash(){return"Geopoint ".concat(this.projection," ").concat(oCt(this.fields)," ").concat(oCt(this.as))}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class oUt extends NRt{constructor(t,e){super(t),this.transform=e}clone(){return new oUt(null,nCt(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:e=0,stop:n,step:r}=t,i=[e,n,...r?[r]:[]].join(",");return{signal:"sequence(".concat(i,")")}}static makeFromTransform(t,e){return new oUt(t,e)}static makeFromEncoding(t,e){const n=e.encoding,r=n.x,i=n.y;if(YFt(r)&&YFt(i)){const a=r.impute?r:i.impute?i:void 0;if(void 0===a)return;const o=r.impute?i:i.impute?r:void 0,{method:s,value:c,frame:u,keyvals:l}=a.impute,h=YIt(e.mark,n);return new oUt(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:a.field,key:o.field},s?{method:s}:{}),void 0!==c?{value:c}:{}),u?{frame:u}:{}),void 0!==l?{keyvals:l}:{}),h.length?{groupby:h}:{}))}return null}hash(){return"Impute ".concat(oCt(this.transform))}assemble(){const{impute:t,key:e,keyvals:n,method:r,groupby:i,value:a,frame:o=[null,null]}=this.transform,s=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:e},n?{keyvals:(c=n,void 0!==(null===c||void 0===c?void 0:c.stop)?this.processSequence(n):n)}:{}),{method:"value"}),i?{groupby:i}:{}),{value:r&&"value"!==r?null:a});var c;if(r&&"value"!==r){return[s,Object.assign({type:"window",as:["imputed_".concat(t,"_value")],ops:[r],fields:[t],frame:o,ignorePeers:!1},i?{groupby:i}:{}),{type:"formula",expr:"datum.".concat(t," === null ? datum.imputed_").concat(t,"_value : datum.").concat(t),as:t}]}return[s]}}class sUt extends NRt{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=nCt(e);const a=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=a[0])&&void 0!==r?r:e.on,null!==(i=a[1])&&void 0!==i?i:e.loess]}clone(){return new sUt(null,nCt(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"LoessTransform ".concat(oCt(this.transform))}assemble(){const t=this.transform,{loess:e,on:n}=t,r=VAt(t,["loess","on"]);return Object.assign({type:"loess",x:n,y:e},r)}}class cUt extends NRt{constructor(t,e,n){super(t),this.transform=e,this.secondary=n}clone(){return new cUt(null,nCt(this.transform),this.secondary)}static make(t,e,n,r){const i=e.component.data.sources,{from:a}=n;let o=null;if(function(t){return"data"in t}(a)){let t=SUt(a.data,i);t||(t=new MPt(a.data),i.push(t));const n=e.getName("lookup_".concat(r));o=new DRt(t,n,"lookup",e.component.data.outputNodeRefCounts),e.component.data.outputNodes[n]=o}else if(function(t){return"selection"in t}(a)){const t=a.selection;if(n=Object.assign({as:t},n),o=e.getSelectionComponent(wCt(t),t).materialized,!o)throw new Error('Cannot define and lookup the "'.concat(t,'" selection in the same view. ')+"Try moving the lookup into a second, layered view?")}return new cUt(t,n,o.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?RAt(this.transform.as):this.transform.from.fields)}hash(){return"Lookup ".concat(oCt({transform:this.transform,secondary:this.secondary}))}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:RAt(this.transform.as)}:{});else{let e=this.transform.as;jAt(e)||(XNt('If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.'),e="_lookup"),t={as:[e]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}class uUt extends NRt{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=nCt(e);const a=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=a[0])&&void 0!==r?r:"prob",null!==(i=a[1])&&void 0!==i?i:"value"]}clone(){return new uUt(null,nCt(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"QuantileTransform ".concat(oCt(this.transform))}assemble(){const t=this.transform,{quantile:e}=t,n=VAt(t,["quantile"]);return Object.assign({type:"quantile",field:e},n)}}class lUt extends NRt{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=nCt(e);const a=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=a[0])&&void 0!==r?r:e.on,null!==(i=a[1])&&void 0!==i?i:e.regression]}clone(){return new lUt(null,nCt(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"RegressionTransform ".concat(oCt(this.transform))}assemble(){const t=this.transform,{regression:e,on:n}=t,r=VAt(t,["regression","on"]);return Object.assign({type:"regression",x:n,y:e},r)}}class hUt extends NRt{constructor(t,e){super(t),this.transform=e}clone(){return new hUt(null,nCt(this.transform))}addDimensions(t){var e;this.transform.groupby=dCt((null!==(e=this.transform.groupby)&&void 0!==e?e:[]).concat(t),(t=>t))}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}hash(){return"PivotTransform ".concat(oCt(this.transform))}assemble(){const{pivot:t,value:e,groupby:n,limit:r,op:i}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:e},void 0!==r?{limit:r}:{}),void 0!==i?{op:i}:{}),void 0!==n?{groupby:n}:{})}}class dUt extends NRt{constructor(t,e){super(t),this.transform=e}clone(){return new dUt(null,nCt(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return"SampleTransform ".concat(oCt(this.transform))}assemble(){return{type:"sample",size:this.transform.sample}}}function fUt(t){let e=0;return function n(r,i){var a;if(r instanceof MPt&&!r.isGenerator&&!COt(r.data)){t.push(i);i={name:null,source:i.name,transform:[]}}if(r instanceof YPt&&(r.parent instanceof MPt&&!i.source?(i.format=Object.assign(Object.assign({},null!==(a=i.format)&&void 0!==a?a:{}),{parse:r.assembleFormatParse()}),i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof VPt){i.name||(i.name="data_".concat(e++)),!i.source||i.transform.length>0?(t.push(i),r.data=i.name):r.data=i.source;for(const e of r.assemble())t.push(e)}else{if((r instanceof RPt||r instanceof zPt||r instanceof eUt||r instanceof pLt||r instanceof OLt||r instanceof aUt||r instanceof iUt||r instanceof WPt||r instanceof cUt||r instanceof ZPt||r instanceof KPt||r instanceof rUt||r instanceof nUt||r instanceof tUt||r instanceof sUt||r instanceof uUt||r instanceof lUt||r instanceof XPt||r instanceof dUt||r instanceof hUt)&&i.transform.push(r.assemble()),(r instanceof IPt||r instanceof FRt||r instanceof oUt||r instanceof $Pt)&&i.transform.push(...r.assemble()),r instanceof DRt)if(i.source&&0===i.transform.length)r.setSource(i.source);else if(r.parent instanceof DRt)r.setSource(i.name);else if(i.name||(i.name="data_".concat(e++)),r.setSource(i.name),1===r.numChildren()){t.push(i);i={name:null,source:i.name,transform:[]}}switch(r.numChildren()){case 0:r instanceof DRt&&(!i.source||i.transform.length>0)&&t.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name="data_".concat(e++));let a=i.name;!i.source||i.transform.length>0?t.push(i):a=i.source;for(const t of r.children){n(t,{name:null,source:a,transform:[]})}break}}}}}function pUt(t){return"top"===t||"left"===t||hDt(t)?"header":"footer"}function gUt(t,e){var n;const{facet:r,config:i,child:a,component:o}=t;if(t.channelHasField(e)){const s=r[e],c=BLt("title",null,i,e);let u=hIt(s,i,{allowDisabling:!0,includeDefault:void 0===c||!!c});a.component.layoutHeaders[e].title&&(u=NAt(u)?u.join(", "):u,u+=" / "+a.component.layoutHeaders[e].title,a.component.layoutHeaders[e].title=null);const l=BLt("labelOrient",s,i,e),h=FCt((null!==(n=s.header)&&void 0!==n?n:{}).labels,i.header.labels,!0),d=cCt(["bottom","right"],l)?"footer":"header";o.layoutHeaders[e]={title:u,facetFieldDef:s,[d]:"facet"===e?[]:[mUt(t,e,h)]}}}function mUt(t,e,n){const r="row"===e?"height":"width";return{labels:n,sizeSignal:t.child.component.layoutSize.get(r)?t.child.getSizeSignalRef(r):void 0,axes:[]}}function yUt(t,e){var n;const{child:r}=t;if(r.component.axes[e]){const{layoutHeaders:i,resolve:a}=t.component;if(a.axis[e]=iPt(a,e),"shared"===a.axis[e]){const a="x"===e?"column":"row",o=i[a];for(const i of r.component.axes[e]){const e=pUt(i.get("orient"));o[e]=null!==(n=o[e])&&void 0!==n?n:[mUt(t,a,!1)];const r=bLt(i,"main",t.config,{header:!0});r&&o[e][0].axes.push(r),i.mainExtracted=!0}}}}function vUt(t){bUt(t);const e=1===t.layout.columns?"width":"childWidth",n=void 0===t.layout.columns?"height":"childHeight";xUt(t,e),xUt(t,n)}function bUt(t){for(const e of t.children)e.parseLayoutSize()}function xUt(t,e){const n=ePt(e),r=YTt(n),i=t.component.resolve,a=t.component.layoutSize;let o;for(const s of t.children){const t=s.component.layoutSize.getWithExplicit(n),e=i.scale[r];if("independent"===e&&"step"===t.value){o=void 0;break}if(o){if("independent"===e&&o.value!==t.value){o=void 0;break}o=SOt(o,t,n,"")}else o=t}if(o){for(const r of t.children)t.renameSignal(r.getName(n),t.getName(e)),r.component.layoutSize.set(n,"merged",!1);a.setWithExplicit(e,o)}else a.setWithExplicit(e,{explicit:!1,value:void 0})}function wUt(t,e){const n="width"===e?"x":"y",r=t.config,i=t.getScaleComponent(n);if(i){const t=i.get("type"),n=i.get("range");if(XDt(t)){const t=MMt(r.view,e);return dDt(n)||TMt(t)?"step":t}return FMt(r.view,e)}if(t.hasProjection||"arc"===t.mark)return FMt(r.view,e);{const t=MMt(r.view,e);return TMt(t)?t.step:t}}function kUt(t,e,n){return aIt(e,Object.assign({suffix:"by_".concat(aIt(t))},null!==n&&void 0!==n?n:{}))}class _Ut extends Jjt{constructor(t,e,n,r){super(t,"facet",e,n,r,t.resolve),this.child=$Ut(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet,r)}initFacet(t,e){return BFt(t)?HIt(t,((t,n,r)=>cCt([_Et,SEt],r)?void 0===n.field?(XNt(INt(n,r)),t):(t[r]=yIt(n,r,e),t):(XNt(MNt(r,"facet")),t)),{}):{facet:yIt(t,"facet",e)}}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=CUt(this),this.child.parseData()}parseLayoutSize(){bUt(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),function(t){for(const e of lTt)gUt(t,e);yUt(t,"x"),yUt(t,"y")}(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,e,n;const r={};for(const i of lTt)for(const a of jLt){const o=this.component.layoutHeaders[i],s=o[a],{facetFieldDef:c}=o;if(c){const e=BLt("titleOrient",c,this.config,i);if(cCt(["right","bottom"],e)){const n=zLt(i,e);r.titleAnchor=null!==(t=r.titleAnchor)&&void 0!==t?t:{},r.titleAnchor[n]="end"}}if(null===s||void 0===s?void 0:s[0]){const t="row"===i?"height":"width",s="header"===a?"headerBand":"footerBand";"facet"===i||this.child.component.layoutSize.get(t)||(r[s]=null!==(e=r[s])&&void 0!==e?e:{},r[s][i]=.5),o.title&&(r.offset=null!==(n=r.offset)&&void 0!==n?n:{},r.offset["row"===i?"rowTitle":"columnTitle"]=10)}}return r}assembleDefaultLayout(){const{column:t,row:e}=this.facet,n=t?this.columnDistinctSignal():e?1:void 0;let r="all";return(e||"independent"!==this.component.resolve.scale.x)&&(t||"independent"!==this.component.resolve.scale.y)||(r="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),n?{columns:n}:{}),{bounds:"full",align:r})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof _Ut)){const t=this.getName("column_domain");return{signal:"length(data('".concat(t,"'))")}}}assembleGroup(t){return this.parent&&this.parent instanceof _Ut?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:aIt(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],e=[],n=[];if(this.child instanceof _Ut){if(this.child.channelHasField("column")){const r=aIt(this.child.facet.column);t.push(r),e.push("distinct"),n.push("distinct_".concat(r))}}else for(const r of VTt){const i=this.child.component.scales[r];if(i&&!i.merged){const a=i.get("type"),o=i.get("range");if(XDt(a)&&dDt(o)){const i=Ejt(Tjt(this.child,r));i?(t.push(i),e.push("distinct"),n.push("distinct_".concat(i))):XNt("Unknown field for ".concat(r,". Cannot calculate view size."))}}}return{fields:t,ops:e,as:n}}assembleFacet(){const{name:t,data:e}=this.component.data.facetRoot,{row:n,column:r}=this.facet,{fields:i,ops:a,as:o}=this.getCardinalityAggregateForChild(),s=[];for(const u of lTt){const t=this.facet[u];if(t){s.push(aIt(t));const{bin:e,sort:c}=t;if(fNt(e)&&s.push(aIt(t,{binSuffix:"end"})),RFt(c)){const{field:e,op:s=FFt}=c,u=kUt(t,c);n&&r?(i.push(u),a.push("max"),o.push(u)):(i.push(e),a.push(s),o.push(u))}else if(NAt(c)){const e=RLt(t,u);i.push(e),a.push("max"),o.push(e)}}}const c=!!n&&!!r;return Object.assign({name:t,data:e,groupby:s},c||i.length>0?{aggregate:Object.assign(Object.assign({},c?{cross:c}:{}),i.length?{fields:i,ops:a,as:o}:{})}:{})}facetSortFields(t){const{facet:e}=this,n=e[t];return n?RFt(n.sort)?[kUt(n,n.sort,{expr:"datum"})]:NAt(n.sort)?[RLt(n,t,{expr:"datum"})]:[aIt(n,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:e}=this,n=e[t];if(n){const{sort:t}=n;return[(RFt(t)?t.order:!NAt(t)&&t)||"ascending"]}return[]}assembleLabelTitle(){const{facet:t,config:e}=this;if(t.facet)return HLt(t.facet,"facet",e);const n={row:["top","bottom"],column:["left","right"]};for(const r of PLt)if(t[r]){const i=BLt("labelOrient",t[r],e,r);if(cCt(n[r],i))return HLt(t[r],r,e)}}assembleMarks(){const{child:t}=this,e=function(t){const e=[],n=fUt(e);for(const r of t.children)n(r,{source:t.name,name:null,transform:[]});return e}(this.component.data.facetRoot),n=t.assembleGroupEncodeEntry(!1),r=this.assembleLabelTitle()||t.assembleTitle(),i=t.assembleGroupStyle(),a=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},r?{title:r}:{}),i?{style:i}:{}),{from:{facet:this.assembleFacet()},sort:{field:lTt.map((t=>this.facetSortFields(t))).flat(),order:lTt.map((t=>this.facetSortOrder(t))).flat()}}),e.length>0?{data:e}:{}),n?{encode:{update:n}}:{}),t.assembleGroup(function(t,e){if(t.component.selection&&yCt(t.component.selection).length){const n=UAt(t.getName("cell"));e.unshift({name:"facet",value:{},on:[{events:pAt("mousemove","scope"),update:"isTuple(facet) ? facet : group(".concat(n,").datum")}]})}return rzt(e)}(this,[])));return[a]}getMapping(){return this.facet}}function SUt(t,e){var n,r,i,a,o,s,c,u,l,h;for(const d of e){const e=d.data;if((!t.name||!d.hasName()||t.name===d.dataName)&&((!(null===(n=t.format)||void 0===n?void 0:n.mesh)||!(null===(r=e.format)||void 0===r?void 0:r.feature))&&(!(null===(i=t.format)||void 0===i?void 0:i.feature)&&!(null===(a=e.format)||void 0===a?void 0:a.feature)||(null===(o=t.format)||void 0===o?void 0:o.feature)===(null===(s=e.format)||void 0===s?void 0:s.feature))&&(!(null===(c=t.format)||void 0===c?void 0:c.mesh)&&!(null===(u=e.format)||void 0===u?void 0:u.mesh)||(null===(l=t.format)||void 0===l?void 0:l.mesh)===(null===(h=e.format)||void 0===h?void 0:h.mesh))))if(EOt(t)&&EOt(e)){if(eCt(t.values,e.values))return d}else if(COt(t)&&COt(e)){if(t.url===e.url)return d}else if(TOt(t)&&t.name===d.dataName)return d}return null}function AUt(t,e){if(t.data||!t.parent){if(null===t.data){const t=new MPt({values:[]});return e.push(t),t}const n=SUt(t.data,e);if(n)return NOt(t.data)||(n.data.format=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(const i of n)hCt(t,null!==i&&void 0!==i?i:{});return t}({},t.data.format,n.data.format)),!n.hasName()&&t.data.name&&(n.dataName=t.data.name),n;{const n=new MPt(t.data);return e.push(n),n}}return t.parent.component.data.facetRoot?t.parent.component.data.facetRoot:t.parent.component.data.main}function CUt(t){var e,n,r,i,a,o,s,c,u,l;let h=AUt(t,t.component.data.sources);const{outputNodes:d,outputNodeRefCounts:f}=t.component.data,p=t.parent?t.parent.component.data.ancestorParse.clone():new AOt,g=t.data;NOt(g)?(DOt(g)?h=new zPt(h,g.sequence):IOt(g)&&(h=new RPt(h,g.graticule)),p.parseNothing=!0):null===(null===(e=null===g||void 0===g?void 0:g.format)||void 0===e?void 0:e.parse)&&(p.parseNothing=!0),h=null!==(n=YPt.makeExplicit(h,t,p))&&void 0!==n?n:h,h=new XPt(h);const m=t.parent&&Zjt(t.parent);(Xjt(t)||Kjt(t))&&m&&(h=null!==(r=IPt.makeFromEncoding(h,t))&&void 0!==r?r:h),t.transforms.length>0&&(h=function(t,e,n){var r,i;let a=0;for(const o of e.transforms){let s,c;if(HOt(o))c=t=new OLt(t,o),s="derived";else if(ROt(o)){const i=GPt(o);c=t=null!==(r=YPt.makeWithAncestors(t,{},i,n))&&void 0!==r?r:t,t=new pLt(t,e,o.filter)}else if(YOt(o))c=t=IPt.makeFromTransform(t,o,e),s="number";else if(KOt(o))s="date",void 0===n.getWithExplicit(o.field).value&&(t=new YPt(t,{[o.field]:s}),n.set(o.field,s,!1)),c=t=FRt.makeFromTransform(t,o);else if($Ot(o))c=t=WPt.makeFromTransform(t,o),s="number",vzt(e)&&(t=new XPt(t));else if(zOt(o))c=t=cUt.make(t,e,o,a++),s="derived";else if(VOt(o))c=t=new ZPt(t,o),s="number";else if(qOt(o))c=t=new KPt(t,o),s="number";else if(ZOt(o))c=t=$Pt.makeFromTransform(t,o),s="derived";else if(QOt(o))c=t=new rUt(t,o),s="derived";else if(GOt(o))c=t=new nUt(t,o),s="derived";else if(BOt(o))c=t=new hUt(t,o),s="derived";else if(WOt(o))t=new dUt(t,o);else if(XOt(o))c=t=oUt.makeFromTransform(t,o),s="derived";else if(LOt(o))c=t=new tUt(t,o),s="derived";else if(POt(o))c=t=new uUt(t,o),s="derived";else if(jOt(o))c=t=new lUt(t,o),s="derived";else{if(!UOt(o)){XNt(TNt(o));continue}c=t=new sUt(t,o),s="derived"}if(c&&void 0!==s)for(const t of null!==(i=c.producedFields())&&void 0!==i?i:[])n.set(t,s,!1)}return t}(h,t,p));const y=function(t){const e={};if(Xjt(t)&&t.component.selection)for(const n of yCt(t.component.selection)){const r=t.component.selection[n];for(const t of r.project.items)!t.channel&&DCt(t.field)>1&&(e[t.field]="flatten")}return e}(t),v=HPt(t);h=null!==(i=YPt.makeWithAncestors(h,{},Object.assign(Object.assign({},y),v),p))&&void 0!==i?i:h,Xjt(t)&&(h=iUt.parseAll(h,t),h=aUt.parseAll(h,t)),(Xjt(t)||Kjt(t))&&(m||(h=null!==(a=IPt.makeFromEncoding(h,t))&&void 0!==a?a:h),h=null!==(o=FRt.makeFromEncoding(h,t))&&void 0!==o?o:h,h=OLt.parseAllForSortIndex(h,t));const b=t.getName(OOt),x=new DRt(h,b,OOt,f);if(d[b]=x,h=x,Xjt(t)){const e=WPt.makeFromEncoding(h,t);e&&(h=e,vzt(t)&&(h=new XPt(h))),h=null!==(s=oUt.makeFromEncoding(h,t))&&void 0!==s?s:h,h=null!==(c=$Pt.makeFromEncoding(h,t))&&void 0!==c?c:h}Xjt(t)&&(h=null!==(u=eUt.make(h,t))&&void 0!==u?u:h);const w=t.getName(MOt),k=new DRt(h,w,MOt,f);d[w]=k,h=k,Xjt(t)&&function(t,e){mzt(t,(n=>{const r=n.name,i=t.getName("lookup_".concat(r));t.component.data.outputNodes[i]=n.materialized=new DRt(new pLt(e,t,{selection:r}),i,"lookup",t.component.data.outputNodeRefCounts)}))}(t,k);let _=null;if(Kjt(t)){const e=t.getName("facet");h=null!==(l=function(t,e){const{row:n,column:r}=e;if(n&&r){let e=null;for(const i of[n,r])if(RFt(i.sort)){const{field:n,op:r=FFt}=i.sort;t=e=new KPt(t,{joinaggregate:[{op:r,field:n,as:kUt(i,i.sort,{forAs:!0})}],groupby:[aIt(i)]})}return e}return null}(h,t.facet))&&void 0!==l?l:h,_=new VPt(h,t,e,k.getSource()),d[e]=_}return Object.assign(Object.assign({},t.component.data),{outputNodes:d,outputNodeRefCounts:f,raw:x,main:k,facetRoot:_,ancestorParse:p})}class EUt extends Qjt{constructor(t,e,n,r){var i,a,o,s;super(t,"concat",e,n,r,t.resolve),"shared"!==(null===(a=null===(i=t.resolve)||void 0===i?void 0:i.axis)||void 0===a?void 0:a.x)&&"shared"!==(null===(s=null===(o=t.resolve)||void 0===o?void 0:o.axis)||void 0===s?void 0:s.y)||XNt("Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415)."),this.children=this.getChildren(t).map(((t,e)=>$Ut(t,this,this.getName("concat_"+e),void 0,r)))}parseData(){this.component.data=CUt(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const e of yCt(t.component.selection))this.component.selection[e]=t.component.selection[e]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return CMt(t)?t.vconcat:EMt(t)?t.hconcat:t.concat}parseLayoutSize(){vUt(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce(((t,e)=>e.assembleSelectionTopLevelSignals(t)),t)}assembleSignals(){return this.children.forEach((t=>t.assembleSignals())),[]}assembleLayoutSignals(){const t=ZLt(this);for(const e of this.children)t.push(...e.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce(((t,e)=>e.assembleSelectionData(t)),t)}assembleMarks(){return this.children.map((t=>{const e=t.assembleTitle(),n=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},e?{title:e}:{}),n?{style:n}:{}),r?{encode:{update:r}}:{}),t.assembleGroup())}))}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},null!=t?{columns:t}:{}),{bounds:"full",align:"each"})}}const TUt=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},PCt),{labelExpr:1,encode:1}),NUt=yCt(TUt);class DUt extends bOt{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(),this.explicit=t,this.implicit=e,this.mainExtracted=n}clone(){return new DUt(nCt(this.explicit),nCt(this.implicit),this.mainExtracted)}hasAxisPart(t){return"axis"===t||("grid"===t||"title"===t?!!this.get(t):!(!1===(e=this.get(t))||null===e));var e}hasOrientSignalRef(){return hDt(this.explicit.orient)}}const FUt={bottom:"top",top:"bottom",left:"right",right:"left"};function IUt(t,e){if(!t)return e.map((t=>t.clone()));{if(t.length!==e.length)return;const n=t.length;for(let r=0;r<n;r++){const n=t[r],i=e[r];if(!!n!==!!i)return;if(n&&i){const e=n.getWithExplicit("orient"),a=i.getWithExplicit("orient");if(e.explicit&&a.explicit&&e.value!==a.value)return;t[r]=MUt(n,i)}}}return t}function MUt(t,e){for(const n of NUt){const r=SOt(t.getWithExplicit(n),e.getWithExplicit(n),n,"axis",((t,e)=>{switch(n){case"title":return PIt(t,e);case"gridScale":return{explicit:t.explicit,value:FCt(t.value,e.value)}}return _Ot(t,e,n,"axis")}));t.setWithExplicit(n,r)}return t}function OUt(t,e,n,r,i){if("disable"===e)return void 0!==n;switch(n=n||{},e){case"titleAngle":case"labelAngle":return t===(hDt(n.labelAngle)?n.labelAngle:MCt(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(t===MLt(r,i))return!0}return t===n[e]}const RUt=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function zUt(t,e){var n,r,i;let a=e.axis(t);const o=new DUt,s=mIt(e.encoding[t]),{mark:c,config:u}=e,l=(null===a||void 0===a?void 0:a.orient)||(null===(n=u["x"===t?"axisX":"axisY"])||void 0===n?void 0:n.orient)||(null===(r=u.axis)||void 0===r?void 0:r.orient)||function(t){return"x"===t?"bottom":"left"}(t),h=e.getScaleComponent(t).get("type"),d=CLt(t,h,l,e.config),f=void 0!==a?!a:TLt("disable",u,null===a||void 0===a?void 0:a.style,d).configValue;if(o.set("disable",f,void 0!==a),f)return o;a=a||{};const p=function(t,e,n,r,i){const a=null===e||void 0===e?void 0:e.labelAngle;if(void 0!==a)return hDt(a)?a:MCt(a);{const{configValue:a}=TLt("labelAngle",t.config,null===e||void 0===e?void 0:e.style,i);return void 0!==a?MCt(a):n===CEt&&cCt([MDt,FDt],r.type)?270:void 0}}(e,a,t,s,d),g={fieldOrDatumDef:s,axis:a,channel:t,model:e,scaleType:h,orient:l,labelAngle:p,mark:c,config:u};for(const v of NUt){const n=v in NLt?NLt[v](g):UCt(v)?a[v]:void 0,r=void 0!==n,i=OUt(n,v,a,e,t);if(r&&i)o.set(v,n,i);else{const{configValue:t,configFrom:s}=UCt(v)&&"values"!==v?TLt(v,e.config,a.style,d):{},c=void 0!==t;r&&!c?o.set(v,n,i):("vgAxisConfig"!==s||RUt.has(v)&&c||zCt(t)||hDt(t))&&o.set(v,t,!1)}}const m=null!==(i=a.encoding)&&void 0!==i?i:{},y=BCt.reduce(((n,r)=>{var i;if(!o.hasAxisPart(r))return n;const a=nPt(null!==(i=m[r])&&void 0!==i?i:{},e),s="labels"===r?function(t,e,n){var r;const{encoding:i,config:a}=t,o=null!==(r=mIt(i[e]))&&void 0!==r?r:mIt(i[CTt(e)]),s=t.axis(e)||{},{format:c,formatType:u}=s;return bFt(u)?Object.assign({text:SFt({fieldOrDatumDef:o,field:"datum.value",format:c,formatType:u,config:a})},n):n}(e,t,a):a;return void 0===s||mCt(s)||(n[r]={update:s}),n}),{});return mCt(y)||o.set("encode",y,!!a.encoding||void 0!==a.labelAngle),o}function BUt(t,e,n,r){let{graticule:i}=r;const a=oEt(t)?Object.assign({},t):{type:t},o=IIt("orient",a,n);var s,c;if(a.orient=function(t,e,n){switch(t){case XCt:case tEt:case eEt:case ZCt:case KCt:case HCt:return}const{x:r,y:i,x2:a,y2:o}=e;switch(t){case GCt:if(YFt(r)&&(pNt(r.bin)||YFt(i)&&i.aggregate&&!r.aggregate))return"vertical";if(YFt(i)&&(pNt(i.bin)||YFt(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(o||a){if(n)return n;if(!a&&(YFt(r)&&r.type===DDt&&!fNt(r.bin)||ZFt(r)))return"horizontal";if(!o&&(YFt(i)&&i.type===DDt&&!fNt(i.bin)||ZFt(i)))return"vertical"}case $Ct:if(a&&(!YFt(r)||!pNt(r.bin))&&o&&(!YFt(i)||!pNt(i.bin)))return;case qCt:if(o)return YFt(i)&&pNt(i.bin)?"horizontal":"vertical";if(a)return YFt(r)&&pNt(r.bin)?"vertical":"horizontal";if(t===$Ct){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case YCt:case QCt:{const e=$Ft(r),a=$Ft(i);if(e&&!a)return"tick"!==t?"horizontal":"vertical";if(!e&&a)return"tick"!==t?"vertical":"horizontal";if(e&&a){const e=r,a=i,o=e.type===IDt,s=a.type===IDt;return o&&!s?"tick"!==t?"vertical":"horizontal":!o&&s?"tick"!==t?"horizontal":"vertical":!e.aggregate&&a.aggregate?"tick"!==t?"vertical":"horizontal":e.aggregate&&!a.aggregate?"tick"!==t?"horizontal":"vertical":n||"vertical"}return n||void 0}}return"vertical"}(a.type,e,o),void 0!==o&&o!==a.orient&&XNt((s=a.orient,c=o,'Specified orient "'.concat(s,'" overridden with "').concat(c,'".'))),"bar"===a.type&&a.orient){const t=IIt("cornerRadiusEnd",a,n);if(void 0!==t){const n="horizontal"===a.orient&&e.x2||"vertical"===a.orient&&e.y2?["cornerRadius"]:uEt[a.orient];for(const e of n)a[e]=t;void 0!==a.cornerRadiusEnd&&delete a.cornerRadiusEnd}}void 0===IIt("opacity",a,n)&&(a.opacity=function(t,e){if(cCt([XCt,QCt,tEt,eEt],t)&&!UIt(e))return.7;return}(a.type,e));void 0===a.filled&&(a.filled=!i&&function(t,e){const n=MIt("filled",t,e),r=t.type;return FCt(n,r!==XCt&&r!==YCt&&r!==$Ct)}(a,n));return void 0===IIt("cursor",a,n)&&(a.cursor=function(t,e,n){if(e.href||t.href||IIt("href",t,n))return"pointer";return t.cursor}(a,e,n)),a}function LUt(t,e){const{config:n}=t;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},kRt(t,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),uRt("x",t,{defaultPos:"mid"})),uRt("y",t,{defaultPos:"mid"})),oRt("size",t)),oRt("angle",t)),function(t,e,n){if(n)return{shape:{value:n}};return oRt("shape",t)}(t,0,e))}const PUt={vgMark:"rule",encodeEntry:t=>{const{markDef:e}=t,n=e.orient;return t.encoding.x||t.encoding.y||t.encoding.latitude||t.encoding.longitude?Object.assign(Object.assign(Object.assign(Object.assign({},kRt(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),pRt("x",t,{defaultPos:"horizontal"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==n})),pRt("y",t,{defaultPos:"vertical"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==n})),oRt("size",t,{vgChannel:"strokeWidth"})):{}}},jUt={vgMark:"text",encodeEntry:t=>{const{config:e,encoding:n}=t;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},kRt(t,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),uRt("x",t,{defaultPos:"mid"})),uRt("y",t,{defaultPos:"mid"})),tRt(t)),oRt("size",t,{vgChannel:"fontSize"})),oRt("angle",t)),ARt("align",function(t,e,n){const r=IIt("align",t,n);if(void 0===r)return"center";return}(t.markDef,0,e))),ARt("baseline",function(t,e,n){const r=IIt("baseline",t,n);if(void 0===r)return"middle";return}(t.markDef,0,e))),uRt("radius",t,{defaultPos:null,isMidPoint:!0})),uRt("theta",t,{defaultPos:null,isMidPoint:!0}))}};const UUt={vgMark:"rect",encodeEntry:t=>{const{config:e,markDef:n}=t,r=n.orient,i="horizontal"===r?"width":"height",a="horizontal"===r?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},kRt(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),uRt("x",t,{defaultPos:"mid",vgChannel:"xc"})),uRt("y",t,{defaultPos:"mid",vgChannel:"yc"})),oRt("size",t,{defaultValue:WUt(t),vgChannel:i})),{[a]:TIt(IIt("thickness",n,e))})}};function WUt(t){var e;const{config:n,markDef:r}=t,{orient:i}=r,a="horizontal"===i?"width":"height",o=t.getScaleComponent("horizontal"===i?"x":"y"),s=null!==(e=IIt("size",r,n,{vgChannel:a}))&&void 0!==e?e:n.tick.bandSize;if(void 0!==s)return s;{const t=o?o.get("range"):void 0;if(t&&dDt(t)&&PAt(t.step))return 3*t.step/4;return 3*IMt(n.view,a)/4}}const VUt={arc:{vgMark:"arc",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},kRt(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),uRt("x",t,{defaultPos:"mid"})),uRt("y",t,{defaultPos:"mid"})),yRt(t,"radius","arc")),yRt(t,"theta","arc"))},area:{vgMark:"area",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign({},kRt(t,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),pRt("x",t,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===t.markDef.orient})),pRt("y",t,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===t.markDef.orient})),SRt(t))},bar:{vgMark:"rect",encodeEntry:t=>Object.assign(Object.assign(Object.assign({},kRt(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),yRt(t,"x","bar")),yRt(t,"y","bar"))},circle:{vgMark:"symbol",encodeEntry:t=>LUt(t,"circle")},geoshape:{vgMark:"shape",encodeEntry:t=>Object.assign({},kRt(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:t=>{const{encoding:e}=t,n=e.shape;return[Object.assign({type:"geoshape",projection:t.projectionName()},n&&YFt(n)&&n.type===ODt?{field:aIt(n,{expr:"datum"})}:{})]}},image:{vgMark:"image",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign({},kRt(t,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),yRt(t,"x","image")),yRt(t,"y","image")),tRt(t,"url"))},line:{vgMark:"line",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},kRt(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),uRt("x",t,{defaultPos:"mid"})),uRt("y",t,{defaultPos:"mid"})),oRt("size",t,{vgChannel:"strokeWidth"})),SRt(t))},point:{vgMark:"symbol",encodeEntry:t=>LUt(t)},rect:{vgMark:"rect",encodeEntry:t=>Object.assign(Object.assign(Object.assign({},kRt(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),yRt(t,"x","rect")),yRt(t,"y","rect"))},rule:PUt,square:{vgMark:"symbol",encodeEntry:t=>LUt(t,"square")},text:jUt,tick:UUt,trail:{vgMark:"trail",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},kRt(t,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),uRt("x",t,{defaultPos:"mid"})),uRt("y",t,{defaultPos:"mid"})),oRt("size",t)),SRt(t))}};function qUt(t){return cCt([YCt,qCt,JCt],t.mark)?function(t){const e=YIt(t.mark,t.encoding),n=YUt(t,{fromPrefix:e.length>0?GUt:""});return e.length>0?[{name:t.getName("pathgroup"),type:"group",from:{facet:{name:GUt+t.requestDataName(MOt),data:t.requestDataName(MOt),groupby:e}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}(t):cCt([GCt],t.mark)?function(t){const e=mDt.some((e=>IIt(e,t.markDef,t.config)));if(t.stack&&!t.fieldDef("size")&&e){const[e]=YUt(t,{fromPrefix:HUt}),n=t.scaleName(t.stack.fieldChannel),r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.vgField(t.stack.fieldChannel,e)},i=(t,e)=>{const i=[r({prefix:"min",suffix:"start",expr:e}),r({prefix:"max",suffix:"start",expr:e}),r({prefix:"min",suffix:"end",expr:e}),r({prefix:"max",suffix:"end",expr:e})];return"".concat(t,"(").concat(i.map((t=>"scale('".concat(n,"',").concat(t,")"))).join(","),")")};let a,o;"x"===t.stack.fieldChannel?(a=Object.assign(Object.assign({},rCt(e.encode.update,["y","yc","y2","height",...mDt])),{x:{signal:i("min","datum")},x2:{signal:i("max","datum")},clip:{value:!0}}),o={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},e.encode.update=Object.assign(Object.assign({},iCt(e.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(a=Object.assign(Object.assign({},rCt(e.encode.update,["x","xc","x2","width"])),{y:{signal:i("min","datum")},y2:{signal:i("max","datum")},clip:{value:!0}}),o={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},e.encode.update=Object.assign(Object.assign({},iCt(e.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const u of mDt){const n=MIt(u,t.markDef,t.config);e.encode.update[u]?(a[u]=e.encode.update[u],delete e.encode.update[u]):n&&(a[u]=TIt(n)),n&&(e.encode.update[u]={value:0})}const s=t.fieldDef(t.stack.groupbyChannel),c=aIt(s)?[aIt(s)]:[];((null===s||void 0===s?void 0:s.bin)||(null===s||void 0===s?void 0:s.timeUnit))&&c.push(aIt(s,{binSuffix:"end"}));return a=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce(((n,r)=>{if(e.encode.update[r])return Object.assign(Object.assign({},n),{[r]:e.encode.update[r]});{const e=MIt(r,t.markDef,t.config);return void 0!==e?Object.assign(Object.assign({},n),{[r]:TIt(e)}):n}}),a),a.stroke&&(a.strokeForeground={value:!0},a.strokeOffset={value:0}),[{type:"group",from:{facet:{data:t.requestDataName(MOt),name:HUt+t.requestDataName(MOt),groupby:c,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:a},marks:[{type:"group",encode:{update:o},marks:[e]}]}]}return YUt(t)}(t):YUt(t)}const GUt="faceted_path_";const HUt="stack_group_";function YUt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fromPrefix:""};const{mark:n,markDef:r,config:i}=t,a=FCt(r.clip,function(t){const e=t.getScaleComponent("x"),n=t.getScaleComponent("y");return!!(e&&e.get("selectionExtent")||n&&n.get("selectionExtent"))||void 0}(t),function(t){const e=t.component.projection;return!(!e||e.isFit)||void 0}(t)),o=FIt(r),s=t.encoding.key,c=function(t){const{encoding:e,stack:n,mark:r,markDef:i,config:a}=t,o=e.order;if(!(!NAt(o)&&tIt(o)&&sCt(o.value)||!o&&sCt(IIt("order",i,a)))){if((NAt(o)||YFt(o))&&!n)return zIt(o,{expr:"datum"});if(rEt(r)){const n="horizontal"===i.orient?"y":"x",r=e[n];if(YFt(r)){const e=r.sort;return NAt(e)?{field:aIt(r,{prefix:n,suffix:"sort_index",expr:"datum"})}:RFt(e)?{field:aIt({aggregate:UIt(t.encoding)?e.op:void 0,field:e.field},{expr:"datum"})}:OFt(e)?{field:aIt(t.fieldDef(e.encoding),{expr:"datum"}),order:e.order}:null===e?void 0:{field:aIt(r,{binSuffix:t.stack&&t.stack.impute?"mid":void 0,expr:"datum"})}}}}}(t),u=function(t){if(!t.component.selection)return null;const e=yCt(t.component.selection).length;let n=e,r=t.parent;for(;r&&0===n;)n=yCt(r.component.selection).length,r=r.parent;return n?{interactive:e>0}:null}(t),l=IIt("aria",r,i),h=VUt[n].postEncodingTransform?VUt[n].postEncodingTransform(t):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:t.getName("marks"),type:VUt[n].vgMark},a?{clip:!0}:{}),o?{style:o}:{}),s?{key:s.field}:{}),c?{sort:c}:{}),u||{}),!1===l?{aria:l}:{}),{from:{data:e.fromPrefix+t.requestDataName(MOt)},encode:{update:VUt[n].encodeEntry(t)}}),h?{transform:h}:{})]}class XUt extends Jjt{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4?arguments[4]:void 0;var a,o;super(t,"unit",e,n,i,void 0,NMt(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection={},this.children=[];const s=oEt(t.mark)?t.mark.type:t.mark;this.markDef=BUt(t.mark,null!==(a=t.encoding)&&void 0!==a?a:{},i,{graticule:t.data&&IOt(t.data)});const c=this.encoding=VIt(null!==(o=t.encoding)&&void 0!==o?o:{},this.markDef,i);this.size=function(t){let{encoding:e,size:n}=t;for(const r of VTt){const t=ETt(r);TMt(n[t])&&$Ft(e[r])&&(delete n[t],XNt(jNt(t)))}return n}({encoding:c,size:NMt(t)?Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):r}),this.stack=ZMt(s,c),this.specifiedScales=this.initScales(s,c),this.specifiedAxes=this.initAxes(c),this.specifiedLegends=this.initLegend(c),this.specifiedProjection=t.projection,this.selection=t.selection}get hasProjection(){const{encoding:t}=this,e=this.mark===nEt,n=t&&oTt.some((e=>QFt(t[e])));return e||n}scaleDomain(t){const e=this.specifiedScales[t];return e?e.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,e){return aNt.reduce(((t,n)=>{var r;const i=mIt(e[n]);return i&&(t[n]=null!==(r=i.scale)&&void 0!==r?r:{}),t}),{})}initAxes(t){return VTt.reduce(((e,n)=>{const r=t[n];if(QFt(r)||n===CEt&&QFt(t.x2)||n===EEt&&QFt(t.y2)){const t=QFt(r)?r.axis:void 0;e[n]=t?Object.assign({},t):t}return e}),{})}initLegend(t){return rNt.reduce(((e,n)=>{const r=mIt(t[n]);if(r&&function(t){switch(t){case LEt:case PEt:case jEt:case WEt:case UEt:case qEt:case YEt:case XEt:return!0;case GEt:case HEt:case VEt:return!1}}(n)){const t=r.legend;e[n]=t?Object.assign({},t):t}return e}),{})}parseData(){this.component.data=CUt(this)}parseLayoutSize(){!function(t){const{size:e,component:n}=t;for(const r of VTt){const i=ETt(r);if(e[i]){const t=e[i];n.layoutSize.set(i,TMt(t)?"step":t,!0)}else{const e=wUt(t,i);n.layoutSize.set(i,e,!1)}}}(this)}parseSelections(){this.component.selection=function(t,e){var n;const r={},i=t.config.selection;for(const a of yCt(null!==e&&void 0!==e?e:{})){const o=nCt(e[a]),s=i[o.type],{fields:c,encodings:u}=s,l=VAt(s,["fields","encodings"]);for(const t in l)"encodings"===t&&o.fields||"fields"===t&&o.encodings||("mark"===t&&(o[t]=Object.assign(Object.assign({},l[t]),o[t])),void 0!==o[t]&&!0!==o[t]||(o[t]=null!==(n=l[t])&&void 0!==n?n:o[t]));const h=wCt(a),d=r[h]=Object.assign(Object.assign({},o),{name:h,events:jAt(o.on)?pAt(o.on,"scope"):nCt(o.on)});tzt(d,(n=>{n.has(d)&&n.parse&&n.parse(t,d,o,e[a])}))}return r}(this,this.selection)}parseMarkGroup(){this.component.mark=qUt(this)}parseAxesAndHeaders(){var t;this.component.axes=(t=this,VTt.reduce(((e,n)=>(t.component.scales[n]&&(e[n]=[zUt(n,t)]),e)),{}))}assembleSelectionTopLevelSignals(t){return function(t,e){let n=!1;if(mzt(t,((r,i)=>{const a=r.name,o=UAt(a+hzt),s=e.filter((t=>t.name===a));if(0===s.length){const t="global"===r.resolve?"union":r.resolve,n="multi"===r.type?", true)":")";e.push({name:r.name,update:"".concat(pzt,"(").concat(o,", ").concat(UAt(t)).concat(n)})}n=!0,i.topLevelSignals&&(e=i.topLevelSignals(t,r,e)),tzt(r,(n=>{n.topLevelSignals&&(e=n.topLevelSignals(t,r,e))}))})),n){const t=e.filter((t=>"unit"===t.name));0===t.length&&e.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]})}return rzt(e)}(this,t)}assembleSignals(){return[...xLt(this),...(t=this,e=[],mzt(t,((n,r)=>{const i=n.name;let a=r.modifyExpr(t,n);e.push(...r.signals(t,n)),tzt(n,(r=>{r.signals&&(e=r.signals(t,n,e)),r.modifyExpr&&(a=r.modifyExpr(t,n,a))})),e.push({name:i+fzt,on:[{events:{signal:n.name+dzt},update:"modify(".concat(UAt(n.name+hzt),", ").concat(a,")")}]})})),rzt(e))];var t,e}assembleSelectionData(t){return function(t,e){const n=[...e];return mzt(t,(e=>{const r={name:e.name+hzt};if(e.init){const n=e.project.items.map((t=>{const{signals:e}=t;return VAt(t,["signals"])})),i=e.init.map((t=>ezt(t,!1)));r.values="interval"===e.type?[{unit:yzt(t,{escape:!1}),fields:n,values:i}]:i.map((e=>({unit:yzt(t,{escape:!1}),fields:n,values:e})))}n.filter((t=>t.name===e.name+hzt)).length||n.push(r)})),n}(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return ZLt(this)}assembleMarks(){var t;let e=null!==(t=this.component.mark)&&void 0!==t?t:[];return this.parent&&Zjt(this.parent)||(e=nzt(this,e)),e.map(this.correctDataNames)}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return jIt(this.encoding,t)}fieldDef(t){return gIt(this.encoding[t])}typedFieldDef(t){const e=this.fieldDef(t);return JFt(e)?e:null}}class KUt extends Qjt{constructor(t,e,n,r,i){super(t,"layer",e,n,i,t.resolve,t.view);const a=Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map(((t,e)=>{if(GMt(t))return new KUt(t,this,this.getName("layer_"+e),a,i);if(dEt(t))return new XUt(t,this,this.getName("layer_"+e),a,i);throw new Error(vNt(t))}))}parseData(){this.component.data=CUt(this);for(const t of this.children)t.parseData()}parseLayoutSize(){var t;bUt(t=this),xUt(t,"width"),xUt(t,"height")}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const e of yCt(t.component.selection))this.component.selection[e]=t.component.selection[e]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){!function(t){var e;const{axes:n,resolve:r}=t.component,i={top:0,bottom:0,right:0,left:0};for(const a of t.children){a.parseAxesAndHeaders();for(const e of yCt(a.component.axes))r.axis[e]=iPt(t.component.resolve,e),"shared"===r.axis[e]&&(n[e]=IUt(n[e],a.component.axes[e]),n[e]||(r.axis[e]="independent",delete n[e]))}for(const a of VTt){for(const o of t.children)if(o.component.axes[a]){if("independent"===r.axis[a]){n[a]=(null!==(e=n[a])&&void 0!==e?e:[]).concat(o.component.axes[a]);for(const t of o.component.axes[a]){const{value:e,explicit:n}=t.getWithExplicit("orient");if(!hDt(e)){if(i[e]>0&&!n){const n=FUt[e];i[e]>i[n]&&t.set("orient",n,!1)}i[e]++}}}delete o.component.axes[a]}if("independent"===r.axis[a]&&n[a]&&n[a].length>1)for(const t of n[a])t.get("grid")&&!t.explicit.grid&&(t.implicit.grid=!1)}}(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce(((t,e)=>e.assembleSelectionTopLevelSignals(t)),t)}assembleSignals(){return this.children.reduce(((t,e)=>t.concat(e.assembleSignals())),xLt(this))}assembleLayoutSignals(){return this.children.reduce(((t,e)=>t.concat(e.assembleLayoutSignals())),ZLt(this))}assembleSelectionData(t){return this.children.reduce(((t,e)=>e.assembleSelectionData(t)),t)}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const e of this.children)if(t=e.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return function(t,e){for(const n of t.children)Xjt(n)&&(e=nzt(n,e));return e}(this,this.children.flatMap((t=>t.assembleMarks())))}assembleLegends(){return this.children.reduce(((t,e)=>t.concat(e.assembleLegends())),_Pt(this))}}function $Ut(t,e,n,r,i){if(PFt(t))return new _Ut(t,e,n,i);if(GMt(t))return new KUt(t,e,n,r,i);if(dEt(t))return new XUt(t,e,n,r,i);if(function(t){return CMt(t)||EMt(t)||AMt(t)}(t))return new EUt(t,e,n,i);throw new Error(vNt(t))}function ZUt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;e.logger&&(n=e.logger,HNt=n),e.fieldTitle&&lIt(e.fieldTitle);try{const n=PMt(IAt(e.config,t.config)),r=pOt(t,n),i=$Ut(r,null,"",void 0,n);i.parse(),function(t,e){OPt(t.sources);let n=0,r=0;for(let i=0;i<djt&&mjt(t,e);i++)n++;t.sources.map(rjt);for(let i=0;i<djt&&mjt(t,e);i++)r++;OPt(t.sources),Math.max(n,r)===djt&&XNt("Maximum optimization runs(".concat(djt,") reached."))}(i.component.data,i);const a=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;const i=t.config?VMt(t.config):void 0,a=[].concat(t.assembleSelectionData([]),function(t,e){var n,r;const i=[],a=fUt(i);let o=0;for(const c of t.sources){c.hasName()||(c.dataName="source_".concat(o++));const t=c.assemble();a(c,t)}for(const c of i)0===c.transform.length&&delete c.transform;let s=0;for(const[c,u]of i.entries())0!==(null!==(n=u.transform)&&void 0!==n?n:[]).length||u.source||i.splice(s++,0,i.splice(c,1)[0]);for(const c of i)for(const e of null!==(r=c.transform)&&void 0!==r?r:[])"lookup"===e.type&&(e.from=t.outputNodes[e.from].getSource());for(const c of i)c.name in e&&(c.values=e[c.name]);return i}(t.component.data,n)),o=t.assembleProjections(),s=t.assembleTitle(),c=t.assembleGroupStyle(),u=t.assembleGroupEncodeEntry(!0);let l=t.assembleLayoutSignals();return l=l.filter((t=>"width"!==t.name&&"height"!==t.name||void 0===t.value||(e[t.name]=+t.value,!1))),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},t.description?{description:t.description}:{}),e),s?{title:s}:{}),c?{style:c}:{}),u?{encode:{update:u}}:{}),{data:a}),o.length>0?{projections:o}:{}),t.assembleGroup([...l,...t.assembleSelectionTopLevelSignals([])])),i?{config:i}:{}),r?{usermeta:r}:{})}(i,function(t,e,n,r){const i=r.component.layoutSize.get("width"),a=r.component.layoutSize.get("height");void 0===e?(e={type:"pad"},r.hasAxisOrientSignalRef()&&(e.resize=!0)):jAt(e)&&(e={type:e});if(i&&a&&(o=e.type,"fit"===o||"fit-x"===o||"fit-y"===o))if("step"===i&&"step"===a)XNt(kNt()),e.type="pad";else if("step"===i||"step"===a){const t="step"===i?"width":"height";XNt(kNt(YTt(t)));const n="width"===t?"height":"width";e.type=function(t){return t?"fit-".concat(YTt(t)):"fit"}(n)}var o;return Object.assign(Object.assign(Object.assign({},1===yCt(e).length&&e.type?"pad"===e.type?{}:{autosize:e.type}:{autosize:e}),vOt(n)),vOt(t))}(t,r.autosize,n,i),t.datasets,t.usermeta);return{spec:a,normalized:r}}finally{e.logger&&YNt(),e.fieldTitle&&lIt(cIt)}}const QUt=new class extends HMt{mapUnit(t,e){let{config:n}=e;if(t.encoding){const{encoding:e,transform:r}=t,{bins:i,timeUnits:a,aggregate:o,groupby:s,encoding:c}=WIt(e,n),u=[...r||[],...i,...a,...0===o.length?[]:[{aggregate:o,groupby:s}]];return Object.assign(Object.assign(Object.assign({},t),u.length>0?{transform:u}:{}),{encoding:c})}return t}};function JUt(t,e){return QUt.map(t,{config:e})}const tWt="4.13.1";const eWt=function(t){const[e,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(t).slice(1,3);return{library:e,version:n}};var nWt="2.14.0";const rWt="#fff",iWt="#888",aWt={background:"#333",view:{stroke:iWt},title:{color:rWt,subtitleColor:rWt},style:{"guide-label":{fill:rWt},"guide-title":{fill:rWt}},axis:{domainColor:rWt,gridColor:iWt,tickColor:rWt}},oWt="#4572a7",sWt={background:"#fff",arc:{fill:oWt},area:{fill:oWt},line:{stroke:oWt,strokeWidth:2},path:{stroke:oWt},rect:{fill:oWt},shape:{stroke:oWt},symbol:{fill:oWt,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},cWt="#30a2da",uWt="#cbcbcb",lWt="#f0f0f0",hWt="#333",dWt={arc:{fill:cWt},area:{fill:cWt},axis:{domainColor:uWt,grid:!0,gridColor:uWt,gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:uWt,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:lWt,group:{fill:lWt},legend:{labelColor:hWt,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:hWt,titleFontSize:14,titlePadding:10},line:{stroke:cWt,strokeWidth:2},path:{stroke:cWt,strokeWidth:.5},rect:{fill:cWt},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:cWt},bar:{binSpacing:2,fill:cWt,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},fWt="#000",pWt={group:{fill:"#e5e5e5"},arc:{fill:fWt},area:{fill:fWt},line:{stroke:fWt},path:{stroke:fWt},rect:{fill:fWt},shape:{stroke:fWt},symbol:{fill:fWt,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},gWt="Benton Gothic, sans-serif",mWt="#82c6df",yWt="Benton Gothic Bold, sans-serif",vWt="normal",bWt={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},xWt={background:"#ffffff",title:{anchor:"start",color:"#000000",font:yWt,fontSize:22,fontWeight:"normal"},arc:{fill:mWt},area:{fill:mWt},line:{stroke:mWt,strokeWidth:2},path:{stroke:mWt},rect:{fill:mWt},shape:{stroke:mWt},symbol:{fill:mWt,size:30},axis:{labelFont:gWt,labelFontSize:11.5,labelFontWeight:"normal",titleFont:yWt,titleFontSize:13,titleFontWeight:vWt},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:gWt,labelFontSize:11.5,symbolType:"square",titleFont:yWt,titleFontSize:13,titleFontWeight:vWt},range:{category:bWt["category-6"],diverging:bWt["fireandice-6"],heatmap:bWt["fire-7"],ordinal:bWt["fire-7"],ramp:bWt["fire-7"]}},wWt="#ab5787",kWt="#979797",_Wt={background:"#f9f9f9",arc:{fill:wWt},area:{fill:wWt},line:{stroke:wWt},path:{stroke:wWt},rect:{fill:wWt},shape:{stroke:wWt},symbol:{fill:wWt,size:30},axis:{domainColor:kWt,domainWidth:.5,gridWidth:.2,labelColor:kWt,tickColor:kWt,tickWidth:.2,titleColor:kWt},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},SWt="#3e5c69",AWt={background:"#fff",arc:{fill:SWt},area:{fill:SWt},line:{stroke:SWt},path:{stroke:SWt},rect:{fill:SWt},shape:{stroke:SWt},symbol:{fill:SWt},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},CWt="#1696d2",EWt="#000000",TWt="Lato",NWt="Lato",DWt={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},FWt={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:TWt},axisX:{domain:!0,domainColor:EWt,domainWidth:1,grid:!1,labelFontSize:12,labelFont:NWt,labelAngle:0,tickColor:EWt,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:TWt},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:NWt,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:TWt,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:NWt,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:TWt,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:DWt["six-groups-cat-1"],diverging:DWt["diverging-colors"],heatmap:DWt["diverging-colors"],ordinal:DWt["six-groups-seq"],ramp:DWt["shades-blue"]},area:{fill:CWt},rect:{fill:CWt},line:{color:CWt,stroke:CWt,strokeWidth:5},trail:{color:CWt,stroke:CWt,strokeWidth:0,size:1},path:{stroke:CWt,strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:CWt,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:CWt,stroke:null}},arc:{fill:CWt},shape:{stroke:CWt},symbol:{fill:CWt,size:30}},IWt="#3366CC",MWt="#ccc",OWt="Arial, sans-serif",RWt={arc:{fill:IWt},area:{fill:IWt},path:{stroke:IWt},rect:{fill:IWt},shape:{stroke:IWt},symbol:{stroke:IWt},circle:{fill:IWt},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:OWt,fontSize:12},"guide-title":{font:OWt,fontSize:12},"group-title":{font:OWt,fontSize:12}},title:{font:OWt,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:MWt,tickColor:MWt,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},zWt=t=>t*(1/3+1),BWt=zWt(9),LWt=zWt(10),PWt=zWt(12),jWt="Segoe UI",UWt="wf_standard-font, helvetica, arial, sans-serif",WWt="#252423",VWt="#605E5C",qWt="transparent",GWt="#118DFF",HWt="#DEEFFF",YWt=[HWt,GWt],XWt={view:{stroke:qWt},background:qWt,font:jWt,header:{titleFont:UWt,titleFontSize:PWt,titleColor:WWt,labelFont:jWt,labelFontSize:LWt,labelColor:VWt},axis:{ticks:!1,grid:!1,domain:!1,labelColor:VWt,labelFontSize:BWt,titleFont:UWt,titleColor:WWt,titleFontSize:PWt,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:"#C8C6C4",gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:GWt},line:{stroke:GWt,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:jWt,fontSize:BWt,fill:VWt},arc:{fill:GWt},area:{fill:GWt,line:!0,opacity:.6},path:{stroke:GWt},rect:{fill:GWt},point:{fill:GWt,filled:!0,size:75},shape:{stroke:GWt},symbol:{fill:GWt,strokeWidth:1.5,size:50},legend:{titleFont:jWt,titleFontWeight:"bold",titleColor:VWt,labelFont:jWt,labelFontSize:LWt,labelColor:VWt,symbolType:"circle",symbolSize:75},range:{category:[GWt,"#12239E","#E66C37","#6B007B","#E044A7","#744EC2","#D9B300","#D64550"],diverging:YWt,heatmap:YWt,ordinal:[HWt,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",GWt]}},KWt='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',$Wt=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],ZWt=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function QWt(t){let{type:e,background:n}=t;const r="dark"===e?"#161616":"#ffffff",i="dark"===e?"#f4f4f4":"#161616",a="dark"===e?"#d4bbff":"#6929c4";return{background:n,arc:{fill:a},area:{fill:a},path:{stroke:a},rect:{fill:a},shape:{stroke:a},symbol:{stroke:a},circle:{fill:a},view:{fill:r,stroke:r},group:{fill:r},title:{color:i,anchor:"start",dy:-15,fontSize:16,font:KWt,fontWeight:600},axis:{labelColor:i,labelFontSize:12,grid:!0,gridColor:"#525252",titleColor:i,labelAngle:0},style:{"guide-label":{font:KWt,fill:i,fontWeight:400},"guide-title":{font:KWt,fill:i,fontWeight:400}},range:{category:"dark"===e?$Wt:ZWt,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}const JWt=QWt({type:"light",background:"#ffffff"}),tVt=QWt({type:"light",background:"#f4f4f4"}),eVt=QWt({type:"dark",background:"#262626"}),nVt=QWt({type:"dark",background:"#161616"}),rVt=nWt;const iVt="vg-tooltip-element",aVt={offsetX:10,offsetY:10,id:iVt,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2};function oVt(t,e,n){if(on(t))return"[".concat(t.map((t=>e(qn(t)?t:sVt(t,n)))).join(", "),"]");if(sn(t)){let r="";const i=t,{title:a,image:o}=i,s=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(i,["title","image"]);a&&(r+="<h2>".concat(e(a),"</h2>")),o&&(r+='<img src="'.concat(e(o),'">'));const c=Object.keys(s);if(c.length>0){r+="<table>";for(const t of c){let i=s[t];void 0!==i&&(sn(i)&&(i=sVt(i,n)),r+='<tr><td class="key">'.concat(e(t),':</td><td class="value">').concat(e(i),"</td></tr>"))}r+="</table>"}return r||"{}"}return e(t)}function sVt(t,e){return JSON.stringify(t,function(t){const e=[];return function(n,r){if("object"!==typeof r||null===r)return r;const i=e.indexOf(this)+1;return e.length=i,e.length>t?"[Object]":e.indexOf(r)>=0?"[Circular]":(e.push(r),r)}}(e))}class cVt{constructor(t){this.options=Object.assign(Object.assign({},aVt),t);const e=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const t=document.createElement("style");t.setAttribute("id",this.options.styleId),t.innerHTML=function(t){if(!/^[A-Za-z]+[-:.\w]*$/.test(t))throw new Error("Invalid HTML ID");return"#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black; }\n  #vg-tooltip-element.visible {\n    visibility: visible; }\n  #vg-tooltip-element h2 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 13px; }\n  #vg-tooltip-element img {\n    max-width: 200px;\n    max-height: 200px; }\n  #vg-tooltip-element table {\n    border-spacing: 0; }\n    #vg-tooltip-element table tr {\n      border: none; }\n      #vg-tooltip-element table tr td {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        padding-top: 2px;\n        padding-bottom: 2px; }\n        #vg-tooltip-element table tr td.key {\n          color: #808080;\n          max-width: 150px;\n          text-align: right;\n          padding-right: 4px; }\n        #vg-tooltip-element table tr td.value {\n          display: block;\n          max-width: 300px;\n          max-height: 7em;\n          text-align: left; }\n  #vg-tooltip-element.dark-theme {\n    background-color: rgba(32, 32, 32, 0.9);\n    border: 1px solid #f5f5f5;\n    color: white; }\n    #vg-tooltip-element.dark-theme td.key {\n      color: #bfbfbf; }\n".toString().replace(iVt,t)}(e);const n=document.head;n.childNodes.length>0?n.insertBefore(t,n.childNodes[0]):n.appendChild(t)}}tooltipHandler(t,e,n,r){this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el));if((null!=document.fullscreenElement?document.fullscreenElement:document.body).appendChild(this.el),null==r||""===r)return void this.el.classList.remove("visible","".concat(this.options.theme,"-theme"));this.el.innerHTML=oVt(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible","".concat(this.options.theme,"-theme"));const{x:i,y:a}=function(t,e,n,r){let i=t.clientX+n;i+e.width>window.innerWidth&&(i=+t.clientX-n-e.width);let a=t.clientY+r;return a+e.height>window.innerHeight&&(a=+t.clientY-r-e.height),{x:i,y:a}}(e,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style","top: ".concat(a,"px; left: ").concat(i,"px"))}}function uVt(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){t.done?i(t.value):function(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(o,s)}c((r=r.apply(t,e||[])).next())}))}var lVt,hVt='.vega-embed {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box; }\n  .vega-embed.has-actions {\n    padding-right: 38px; }\n  .vega-embed details:not([open]) > :not(summary) {\n    display: none !important; }\n  .vega-embed summary {\n    list-style: none;\n    position: absolute;\n    top: 0;\n    right: 0;\n    padding: 6px;\n    z-index: 1000;\n    background: white;\n    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n    color: #1b1e23;\n    border: 1px solid #aaa;\n    border-radius: 999px;\n    opacity: 0.2;\n    transition: opacity 0.4s ease-in;\n    outline: none;\n    cursor: pointer;\n    line-height: 0px; }\n    .vega-embed summary::-webkit-details-marker {\n      display: none; }\n    .vega-embed summary:active {\n      box-shadow: #aaa 0px 0px 0px 1px inset; }\n    .vega-embed summary svg {\n      width: 14px;\n      height: 14px; }\n  .vega-embed details[open] summary {\n    opacity: 0.7; }\n  .vega-embed:hover summary,\n  .vega-embed:focus summary {\n    opacity: 1 !important;\n    transition: opacity 0.2s ease; }\n  .vega-embed .vega-actions {\n    position: absolute;\n    z-index: 1001;\n    top: 35px;\n    right: -9px;\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 8px;\n    padding-top: 8px;\n    border-radius: 4px;\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n    border: 1px solid #d9d9d9;\n    background: white;\n    animation-duration: 0.15s;\n    animation-name: scale-in;\n    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n    text-align: left; }\n    .vega-embed .vega-actions a {\n      padding: 8px 16px;\n      font-family: sans-serif;\n      font-size: 14px;\n      font-weight: 600;\n      white-space: nowrap;\n      color: #434a56;\n      text-decoration: none; }\n      .vega-embed .vega-actions a:hover {\n        background-color: #f7f7f9;\n        color: black; }\n    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n      content: "";\n      display: inline-block;\n      position: absolute; }\n    .vega-embed .vega-actions::before {\n      left: auto;\n      right: 14px;\n      top: -16px;\n      border: 8px solid #0000;\n      border-bottom-color: #d9d9d9; }\n    .vega-embed .vega-actions::after {\n      left: auto;\n      right: 15px;\n      top: -14px;\n      border: 7px solid #0000;\n      border-bottom-color: #fff; }\n  .vega-embed .chart-wrapper {\n    width: 100%;\n    height: 100%; }\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: auto;\n  padding-right: 14px; }\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6); }\n  to {\n    opacity: 1;\n    transform: scale(1); } }\n';function dVt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(const i of n)fVt(t,i);return t}function fVt(t,e){for(const n of Object.keys(e))Tt(t,n,e[n],!0)}String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(!e||e<0?0:+e,t.length)===t});const pVt=x;let gVt=w;const mVt="undefined"!==typeof window?window:void 0;void 0===gVt&&(null===(lVt=null===mVt||void 0===mVt?void 0:mVt.vl)||void 0===lVt?void 0:lVt.compile)&&(gVt=mVt.vl);const yVt={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},vVt={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},bVt={vega:"Vega","vega-lite":"Vega-Lite"},xVt={vega:pVt.version,"vega-lite":gVt?gVt.version:"not available"},wVt={vega:t=>t,"vega-lite":(t,e)=>gVt.compile(t,{config:e}).spec},kVt='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>',_Vt="chart-wrapper";function SVt(t,e,n,r){const i="<html><head>".concat(e,'</head><body><pre><code class="json">'),a="</code></pre>".concat(n,"</body></html>"),o=window.open("");o.document.write(i+t+a),o.document.title="".concat(bVt[r]," JSON Source")}function AVt(t,e){var n;if(t.$schema){const r=eWt(t.$schema);e&&e!==r.library&&console.warn("The given visualization spec is written in ".concat(bVt[r.library],", but mode argument sets ").concat(null!==(n=bVt[e])&&void 0!==n?n:e,"."));const i=r.library;return(0,et.satisfies)(xVt[i],"^".concat(r.version.slice(1)))||console.warn("The input spec uses ".concat(bVt[i]," ").concat(r.version,", but the current version of ").concat(bVt[i]," is v").concat(xVt[i],".")),i}return"mark"in t||"encoding"in t||"layer"in t||"hconcat"in t||"vconcat"in t||"facet"in t||"repeat"in t?"vega-lite":"marks"in t||"signals"in t||"scales"in t||"axes"in t?"vega":null!==e&&void 0!==e?e:"vega"}function CVt(t){return(e=t)&&"load"in e?t:pVt.loader(t);var e}function EVt(t){var e;return null!==(e=t.usermeta&&t.usermeta.embedOptions)&&void 0!==e?e:{}}function TVt(t,e){var n;return uVt(this,void 0,void 0,(function*(){const r=we(t.config)?JSON.parse(yield e.load(t.config)):null!==(n=t.config)&&void 0!==n?n:{},i=we(t.patch)?JSON.parse(yield e.load(t.patch)):t.patch;return Object.assign(Object.assign(Object.assign({},t),i?{patch:i}:{}),r?{config:r}:{})}))}const NVt=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var r,i,a;return uVt(this,void 0,void 0,(function*(){let o,s;we(e)?(s=CVt(n.loader),o=JSON.parse(yield s.load(e))):o=e;const c=EVt(o).loader;s&&!c||(s=CVt(null!==(r=n.loader)&&void 0!==r?r:c));const u=yield TVt(EVt(o),s),l=yield TVt(n,s),h=Object.assign(Object.assign({},dVt(l,u)),{config:Et(null!==(i=l.config)&&void 0!==i?i:{},null!==(a=u.config)&&void 0!==a?a:{})});return yield function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;var i,a,o,s,c,u;return uVt(this,void 0,void 0,(function*(){const l=n.theme?Et(k[n.theme],null!==(i=n.config)&&void 0!==i?i:{}):n.config,h=me(n.actions)?n.actions:dVt({},yVt,null!==(a=n.actions)&&void 0!==a?a:{}),d=Object.assign(Object.assign({},vVt),n.i18n),f=null!==(o=n.renderer)&&void 0!==o?o:"canvas",p=null!==(s=n.logLevel)&&void 0!==s?s:pVt.Warn,g=null!==(c=n.downloadFileName)&&void 0!==c?c:"visualization",m="string"===typeof t?document.querySelector(t):t;if(!m)throw new Error("".concat(t," does not exist"));if(!1!==n.defaultStyle){const t="vega-embed-style",{root:e,rootContainer:r}=function(t){var e;const n=t.getRootNode?t.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:null!==(e=document.head)&&void 0!==e?e:document.body}}(m);if(!e.getElementById(t)){const e=document.createElement("style");e.id=t,e.innerText=void 0===n.defaultStyle||!0===n.defaultStyle?hVt.toString():n.defaultStyle,r.appendChild(e)}}const y=AVt(e,n.mode);let v=wVt[y](e,l);if("vega-lite"===y&&v.$schema){const t=eWt(v.$schema);(0,et.satisfies)(xVt.vega,"^".concat(t.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat(t.version,", but current version is v").concat(xVt.vega,"."))}m.classList.add("vega-embed"),h&&m.classList.add("has-actions"),m.innerHTML="";let b=m;if(h){const t=document.createElement("div");t.classList.add(_Vt),m.appendChild(t),b=t}const x=n.patch;x&&(v=x instanceof Function?x(v):j(v,x,!0,!1).newDocument),n.formatLocale&&pVt.formatLocale(n.formatLocale),n.timeFormatLocale&&pVt.timeFormatLocale(n.timeFormatLocale);const{ast:w}=n,_=pVt.parse(v,"vega-lite"===y?{}:l,{ast:w}),S=new(n.viewClass||pVt.View)(_,Object.assign({loader:r,logLevel:p,renderer:f},w?{expr:pVt.expressionInterpreter}:{}));if(!1!==n.tooltip){let t;t=function(t){return"function"===typeof t}(n.tooltip)?n.tooltip:new cVt(!0===n.tooltip?{}:n.tooltip).call,S.tooltip(t)}let A,{hover:C}=n;if(void 0===C&&(C="vega"===y),C){const{hoverSet:t,updateSet:e}="boolean"===typeof C?{}:C;S.hover(t,e)}if(n&&(null!=n.width&&S.width(n.width),null!=n.height&&S.height(n.height),null!=n.padding&&S.padding(n.padding)),yield S.initialize(b,n.bind).runAsync(),!1!==h){let t=m;if(!1!==n.defaultStyle){const e=document.createElement("details");e.title=d.CLICK_TO_VIEW_ACTIONS,m.append(e),t=e;const n=document.createElement("summary");n.innerHTML=kVt,e.append(n),A=t=>{e.contains(t.target)||e.removeAttribute("open")},document.addEventListener("click",A)}const r=document.createElement("div");if(t.append(r),r.classList.add("vega-actions"),!0===h||!1!==h.export)for(const e of["svg","png"])if(!0===h||!0===h.export||h.export[e]){const t=d["".concat(e.toUpperCase(),"_ACTION")],i=document.createElement("a");i.text=t,i.href="#",i.target="_blank",i.download="".concat(g,".").concat(e),i.addEventListener("mousedown",(function(t){return uVt(this,void 0,void 0,(function*(){t.preventDefault();const r=yield S.toImageURL(e,n.scaleFactor);this.href=r}))})),r.append(i)}if(!0===h||!1!==h.source){const t=document.createElement("a");t.text=d.SOURCE_ACTION,t.href="#",t.addEventListener("click",(function(t){var r,i;SVt(tt()(e),null!==(r=n.sourceHeader)&&void 0!==r?r:"",null!==(i=n.sourceFooter)&&void 0!==i?i:"",y),t.preventDefault()})),r.append(t)}if("vega-lite"===y&&(!0===h||!1!==h.compiled)){const t=document.createElement("a");t.text=d.COMPILED_ACTION,t.href="#",t.addEventListener("click",(function(t){var e,r;SVt(tt()(v),null!==(e=n.sourceHeader)&&void 0!==e?e:"",null!==(r=n.sourceFooter)&&void 0!==r?r:"","vega"),t.preventDefault()})),r.append(t)}if(!0===h||!1!==h.editor){const t=null!==(u=n.editorUrl)&&void 0!==u?u:"https://vega.github.io/editor/",i=document.createElement("a");i.text=d.EDITOR_ACTION,i.href="#",i.addEventListener("click",(function(n){!function(t,e,n){const r=t.open(e),{origin:i}=new URL(e);let a=40;t.addEventListener("message",(function e(n){n.source===r&&(a=0,t.removeEventListener("message",e,!1))}),!1),setTimeout((function t(){a<=0||(r.postMessage(n,i),setTimeout(t,250),a-=1)}),250)}(window,t,{config:l,mode:y,renderer:f,spec:tt()(e)}),n.preventDefault()})),r.append(i)}}function E(){A&&document.removeEventListener("click",A),S.finalize()}return{view:S,spec:e,vgSpec:v,finalize:E}}))}(t,o,h,s)}))}},25189:(t,e,n)=>{const r=Symbol("SemVer ANY");class i{static get ANY(){return r}constructor(t,e){if(e=a(e),t instanceof i){if(t.loose===!!e.loose)return t;t=t.value}t=t.trim().split(/\s+/).join(" "),u("comparator",t,e),this.options=e,this.loose=!!e.loose,this.parse(t),this.semver===r?this.value="":this.value=this.operator+this.semver.version,u("comp",this)}parse(t){const e=this.options.loose?o[s.COMPARATORLOOSE]:o[s.COMPARATOR],n=t.match(e);if(!n)throw new TypeError("Invalid comparator: ".concat(t));this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new l(n[2],this.options.loose):this.semver=r}toString(){return this.value}test(t){if(u("Comparator.test",t,this.options.loose),this.semver===r||t===r)return!0;if("string"===typeof t)try{t=new l(t,this.options)}catch(e){return!1}return c(t,this.operator,this.semver,this.options)}intersects(t,e){if(!(t instanceof i))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new h(t.value,e).test(this.value):""===t.operator?""===t.value||new h(this.value,e).test(t.semver):(!(e=a(e)).includePrerelease||"<0.0.0-0"!==this.value&&"<0.0.0-0"!==t.value)&&(!(!e.includePrerelease&&(this.value.startsWith("<0.0.0")||t.value.startsWith("<0.0.0")))&&(!(!this.operator.startsWith(">")||!t.operator.startsWith(">"))||(!(!this.operator.startsWith("<")||!t.operator.startsWith("<"))||(!(this.semver.version!==t.semver.version||!this.operator.includes("=")||!t.operator.includes("="))||(!!(c(this.semver,"<",t.semver,e)&&this.operator.startsWith(">")&&t.operator.startsWith("<"))||!!(c(this.semver,">",t.semver,e)&&this.operator.startsWith("<")&&t.operator.startsWith(">")))))))}}t.exports=i;const a=n(1102),{safeRe:o,t:s}=n(83153),c=n(44620),u=n(80073),l=n(3485),h=n(77356)},77356:(t,e,n)=>{class r{constructor(t,e){if(e=a(e),t instanceof r)return t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease?t:new r(t.raw,e);if(t instanceof o)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=t.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map((t=>this.parseRange(t.trim()))).filter((t=>t.length)),!this.set.length)throw new TypeError("Invalid SemVer Range: ".concat(this.raw));if(this.set.length>1){const t=this.set[0];if(this.set=this.set.filter((t=>!m(t[0]))),0===this.set.length)this.set=[t];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&y(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((t=>t.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(t){const e=((this.options.includePrerelease&&p)|(this.options.loose&&g))+":"+t,n=i.get(e);if(n)return n;const r=this.options.loose,a=r?u[l.HYPHENRANGELOOSE]:u[l.HYPHENRANGE];t=t.replace(a,N(this.options.includePrerelease)),s("hyphen replace",t),t=t.replace(u[l.COMPARATORTRIM],h),s("comparator trim",t),t=t.replace(u[l.TILDETRIM],d),s("tilde trim",t),t=t.replace(u[l.CARETTRIM],f),s("caret trim",t);let c=t.split(" ").map((t=>b(t,this.options))).join(" ").split(/\s+/).map((t=>T(t,this.options)));r&&(c=c.filter((t=>(s("loose invalid filter",t,this.options),!!t.match(u[l.COMPARATORLOOSE]))))),s("range list",c);const y=new Map,v=c.map((t=>new o(t,this.options)));for(const i of v){if(m(i))return[i];y.set(i.value,i)}y.size>1&&y.has("")&&y.delete("");const x=[...y.values()];return i.set(e,x),x}intersects(t,e){if(!(t instanceof r))throw new TypeError("a Range is required");return this.set.some((n=>v(n,e)&&t.set.some((t=>v(t,e)&&n.every((n=>t.every((t=>n.intersects(t,e)))))))))}test(t){if(!t)return!1;if("string"===typeof t)try{t=new c(t,this.options)}catch(e){return!1}for(let n=0;n<this.set.length;n++)if(D(this.set[n],t,this.options))return!0;return!1}}t.exports=r;const i=new(n(88027))({max:1e3}),a=n(1102),o=n(25189),s=n(80073),c=n(3485),{safeRe:u,t:l,comparatorTrimReplace:h,tildeTrimReplace:d,caretTrimReplace:f}=n(83153),{FLAG_INCLUDE_PRERELEASE:p,FLAG_LOOSE:g}=n(84447),m=t=>"<0.0.0-0"===t.value,y=t=>""===t.value,v=(t,e)=>{let n=!0;const r=t.slice();let i=r.pop();for(;n&&r.length;)n=r.every((t=>i.intersects(t,e))),i=r.pop();return n},b=(t,e)=>(s("comp",t,e),t=_(t,e),s("caret",t),t=w(t,e),s("tildes",t),t=A(t,e),s("xrange",t),t=E(t,e),s("stars",t),t),x=t=>!t||"x"===t.toLowerCase()||"*"===t,w=(t,e)=>t.trim().split(/\s+/).map((t=>k(t,e))).join(" "),k=(t,e)=>{const n=e.loose?u[l.TILDELOOSE]:u[l.TILDE];return t.replace(n,((e,n,r,i,a)=>{let o;return s("tilde",t,e,n,r,i,a),x(n)?o="":x(r)?o=">=".concat(n,".0.0 <").concat(+n+1,".0.0-0"):x(i)?o=">=".concat(n,".").concat(r,".0 <").concat(n,".").concat(+r+1,".0-0"):a?(s("replaceTilde pr",a),o=">=".concat(n,".").concat(r,".").concat(i,"-").concat(a," <").concat(n,".").concat(+r+1,".0-0")):o=">=".concat(n,".").concat(r,".").concat(i," <").concat(n,".").concat(+r+1,".0-0"),s("tilde return",o),o}))},_=(t,e)=>t.trim().split(/\s+/).map((t=>S(t,e))).join(" "),S=(t,e)=>{s("caret",t,e);const n=e.loose?u[l.CARETLOOSE]:u[l.CARET],r=e.includePrerelease?"-0":"";return t.replace(n,((e,n,i,a,o)=>{let c;return s("caret",t,e,n,i,a,o),x(n)?c="":x(i)?c=">=".concat(n,".0.0").concat(r," <").concat(+n+1,".0.0-0"):x(a)?c="0"===n?">=".concat(n,".").concat(i,".0").concat(r," <").concat(n,".").concat(+i+1,".0-0"):">=".concat(n,".").concat(i,".0").concat(r," <").concat(+n+1,".0.0-0"):o?(s("replaceCaret pr",o),c="0"===n?"0"===i?">=".concat(n,".").concat(i,".").concat(a,"-").concat(o," <").concat(n,".").concat(i,".").concat(+a+1,"-0"):">=".concat(n,".").concat(i,".").concat(a,"-").concat(o," <").concat(n,".").concat(+i+1,".0-0"):">=".concat(n,".").concat(i,".").concat(a,"-").concat(o," <").concat(+n+1,".0.0-0")):(s("no pr"),c="0"===n?"0"===i?">=".concat(n,".").concat(i,".").concat(a).concat(r," <").concat(n,".").concat(i,".").concat(+a+1,"-0"):">=".concat(n,".").concat(i,".").concat(a).concat(r," <").concat(n,".").concat(+i+1,".0-0"):">=".concat(n,".").concat(i,".").concat(a," <").concat(+n+1,".0.0-0")),s("caret return",c),c}))},A=(t,e)=>(s("replaceXRanges",t,e),t.split(/\s+/).map((t=>C(t,e))).join(" ")),C=(t,e)=>{t=t.trim();const n=e.loose?u[l.XRANGELOOSE]:u[l.XRANGE];return t.replace(n,((n,r,i,a,o,c)=>{s("xRange",t,n,r,i,a,o,c);const u=x(i),l=u||x(a),h=l||x(o),d=h;return"="===r&&d&&(r=""),c=e.includePrerelease?"-0":"",u?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&d?(l&&(a=0),o=0,">"===r?(r=">=",l?(i=+i+1,a=0,o=0):(a=+a+1,o=0)):"<="===r&&(r="<",l?i=+i+1:a=+a+1),"<"===r&&(c="-0"),n="".concat(r+i,".").concat(a,".").concat(o).concat(c)):l?n=">=".concat(i,".0.0").concat(c," <").concat(+i+1,".0.0-0"):h&&(n=">=".concat(i,".").concat(a,".0").concat(c," <").concat(i,".").concat(+a+1,".0-0")),s("xRange return",n),n}))},E=(t,e)=>(s("replaceStars",t,e),t.trim().replace(u[l.STAR],"")),T=(t,e)=>(s("replaceGTE0",t,e),t.trim().replace(u[e.includePrerelease?l.GTE0PRE:l.GTE0],"")),N=t=>(e,n,r,i,a,o,s,c,u,l,h,d,f)=>(n=x(r)?"":x(i)?">=".concat(r,".0.0").concat(t?"-0":""):x(a)?">=".concat(r,".").concat(i,".0").concat(t?"-0":""):o?">=".concat(n):">=".concat(n).concat(t?"-0":""),c=x(u)?"":x(l)?"<".concat(+u+1,".0.0-0"):x(h)?"<".concat(u,".").concat(+l+1,".0-0"):d?"<=".concat(u,".").concat(l,".").concat(h,"-").concat(d):t?"<".concat(u,".").concat(l,".").concat(+h+1,"-0"):"<=".concat(c),"".concat(n," ").concat(c).trim()),D=(t,e,n)=>{for(let r=0;r<t.length;r++)if(!t[r].test(e))return!1;if(e.prerelease.length&&!n.includePrerelease){for(let n=0;n<t.length;n++)if(s(t[n].semver),t[n].semver!==o.ANY&&t[n].semver.prerelease.length>0){const r=t[n].semver;if(r.major===e.major&&r.minor===e.minor&&r.patch===e.patch)return!0}return!1}return!0}},3485:(t,e,n)=>{const r=n(80073),{MAX_LENGTH:i,MAX_SAFE_INTEGER:a}=n(84447),{safeRe:o,t:s}=n(83153),c=n(1102),{compareIdentifiers:u}=n(94470);class l{constructor(t,e){if(e=c(e),t instanceof l){if(t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease)return t;t=t.version}else if("string"!==typeof t)throw new TypeError('Invalid version. Must be a string. Got type "'.concat(typeof t,'".'));if(t.length>i)throw new TypeError("version is longer than ".concat(i," characters"));r("SemVer",t,e),this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease;const n=t.trim().match(e.loose?o[s.LOOSE]:o[s.FULL]);if(!n)throw new TypeError("Invalid Version: ".concat(t));if(this.raw=t,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>a||this.major<0)throw new TypeError("Invalid major version");if(this.minor>a||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>a||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((t=>{if(/^[0-9]+$/.test(t)){const e=+t;if(e>=0&&e<a)return e}return t})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}toString(){return this.version}compare(t){if(r("SemVer.compare",this.version,this.options,t),!(t instanceof l)){if("string"===typeof t&&t===this.version)return 0;t=new l(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof l||(t=new l(t,this.options)),u(this.major,t.major)||u(this.minor,t.minor)||u(this.patch,t.patch)}comparePre(t){if(t instanceof l||(t=new l(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let e=0;do{const n=this.prerelease[e],i=t.prerelease[e];if(r("prerelease compare",e,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++e)}compareBuild(t){t instanceof l||(t=new l(t,this.options));let e=0;do{const n=this.build[e],i=t.build[e];if(r("prerelease compare",e,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++e)}inc(t,e,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e,n),this.inc("pre",e,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",e,n),this.inc("pre",e,n);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const t=Number(n)?1:0;if(!e&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[t];else{let r=this.prerelease.length;for(;--r>=0;)"number"===typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);if(-1===r){if(e===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(t)}}if(e){let r=[e,t];!1===n&&(r=[e]),0===u(this.prerelease[0],e)?isNaN(this.prerelease[1])&&(this.prerelease=r):this.prerelease=r}break}default:throw new Error("invalid increment argument: ".concat(t))}return this.raw=this.format(),this.build.length&&(this.raw+="+".concat(this.build.join("."))),this}}t.exports=l},50881:(t,e,n)=>{const r=n(95371);t.exports=(t,e)=>{const n=r(t.trim().replace(/^[=v]+/,""),e);return n?n.version:null}},44620:(t,e,n)=>{const r=n(52776),i=n(96052),a=n(90265),o=n(90186),s=n(62886),c=n(88063);t.exports=(t,e,n,u)=>{switch(e){case"===":return"object"===typeof t&&(t=t.version),"object"===typeof n&&(n=n.version),t===n;case"!==":return"object"===typeof t&&(t=t.version),"object"===typeof n&&(n=n.version),t!==n;case"":case"=":case"==":return r(t,n,u);case"!=":return i(t,n,u);case">":return a(t,n,u);case">=":return o(t,n,u);case"<":return s(t,n,u);case"<=":return c(t,n,u);default:throw new TypeError("Invalid operator: ".concat(e))}}},26743:(t,e,n)=>{const r=n(3485),i=n(95371),{safeRe:a,t:o}=n(83153);t.exports=(t,e)=>{if(t instanceof r)return t;if("number"===typeof t&&(t=String(t)),"string"!==typeof t)return null;let n=null;if((e=e||{}).rtl){const r=e.includePrerelease?a[o.COERCERTLFULL]:a[o.COERCERTL];let i;for(;(i=r.exec(t))&&(!n||n.index+n[0].length!==t.length);)n&&i.index+i[0].length===n.index+n[0].length||(n=i),r.lastIndex=i.index+i[1].length+i[2].length;r.lastIndex=-1}else n=t.match(e.includePrerelease?a[o.COERCEFULL]:a[o.COERCE]);if(null===n)return null;const s=n[2],c=n[3]||"0",u=n[4]||"0",l=e.includePrerelease&&n[5]?"-".concat(n[5]):"",h=e.includePrerelease&&n[6]?"+".concat(n[6]):"";return i("".concat(s,".").concat(c,".").concat(u).concat(l).concat(h),e)}},47154:(t,e,n)=>{const r=n(3485);t.exports=(t,e,n)=>{const i=new r(t,n),a=new r(e,n);return i.compare(a)||i.compareBuild(a)}},89260:(t,e,n)=>{const r=n(6803);t.exports=(t,e)=>r(t,e,!0)},6803:(t,e,n)=>{const r=n(3485);t.exports=(t,e,n)=>new r(t,n).compare(new r(e,n))},36829:(t,e,n)=>{const r=n(95371);t.exports=(t,e)=>{const n=r(t,null,!0),i=r(e,null,!0),a=n.compare(i);if(0===a)return null;const o=a>0,s=o?n:i,c=o?i:n,u=!!s.prerelease.length;if(!!c.prerelease.length&&!u)return c.patch||c.minor?s.patch?"patch":s.minor?"minor":"major":"major";const l=u?"pre":"";return n.major!==i.major?l+"major":n.minor!==i.minor?l+"minor":n.patch!==i.patch?l+"patch":"prerelease"}},52776:(t,e,n)=>{const r=n(6803);t.exports=(t,e,n)=>0===r(t,e,n)},90265:(t,e,n)=>{const r=n(6803);t.exports=(t,e,n)=>r(t,e,n)>0},90186:(t,e,n)=>{const r=n(6803);t.exports=(t,e,n)=>r(t,e,n)>=0},49596:(t,e,n)=>{const r=n(3485);t.exports=(t,e,n,i,a)=>{"string"===typeof n&&(a=i,i=n,n=void 0);try{return new r(t instanceof r?t.version:t,n).inc(e,i,a).version}catch(o){return null}}},62886:(t,e,n)=>{const r=n(6803);t.exports=(t,e,n)=>r(t,e,n)<0},88063:(t,e,n)=>{const r=n(6803);t.exports=(t,e,n)=>r(t,e,n)<=0},5317:(t,e,n)=>{const r=n(3485);t.exports=(t,e)=>new r(t,e).major},31361:(t,e,n)=>{const r=n(3485);t.exports=(t,e)=>new r(t,e).minor},96052:(t,e,n)=>{const r=n(6803);t.exports=(t,e,n)=>0!==r(t,e,n)},95371:(t,e,n)=>{const r=n(3485);t.exports=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t instanceof r)return t;try{return new r(t,e)}catch(i){if(!n)return null;throw i}}},7082:(t,e,n)=>{const r=n(3485);t.exports=(t,e)=>new r(t,e).patch},32700:(t,e,n)=>{const r=n(95371);t.exports=(t,e)=>{const n=r(t,e);return n&&n.prerelease.length?n.prerelease:null}},3803:(t,e,n)=>{const r=n(6803);t.exports=(t,e,n)=>r(e,t,n)},64778:(t,e,n)=>{const r=n(47154);t.exports=(t,e)=>t.sort(((t,n)=>r(n,t,e)))},49157:(t,e,n)=>{const r=n(77356);t.exports=(t,e,n)=>{try{e=new r(e,n)}catch(i){return!1}return e.test(t)}},61058:(t,e,n)=>{const r=n(47154);t.exports=(t,e)=>t.sort(((t,n)=>r(t,n,e)))},28162:(t,e,n)=>{const r=n(95371);t.exports=(t,e)=>{const n=r(t,e);return n?n.version:null}},28394:(t,e,n)=>{const r=n(83153),i=n(84447),a=n(3485),o=n(94470),s=n(95371),c=n(28162),u=n(50881),l=n(49596),h=n(36829),d=n(5317),f=n(31361),p=n(7082),g=n(32700),m=n(6803),y=n(3803),v=n(89260),b=n(47154),x=n(61058),w=n(64778),k=n(90265),_=n(62886),S=n(52776),A=n(96052),C=n(90186),E=n(88063),T=n(44620),N=n(26743),D=n(25189),F=n(77356),I=n(49157),M=n(56324),O=n(39751),R=n(21589),z=n(96616),B=n(56131),L=n(90542),P=n(85378),j=n(81271),U=n(2903),W=n(10062),V=n(33151);t.exports={parse:s,valid:c,clean:u,inc:l,diff:h,major:d,minor:f,patch:p,prerelease:g,compare:m,rcompare:y,compareLoose:v,compareBuild:b,sort:x,rsort:w,gt:k,lt:_,eq:S,neq:A,gte:C,lte:E,cmp:T,coerce:N,Comparator:D,Range:F,satisfies:I,toComparators:M,maxSatisfying:O,minSatisfying:R,minVersion:z,validRange:B,outside:L,gtr:P,ltr:j,intersects:U,simplifyRange:W,subset:V,SemVer:a,re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:i.SEMVER_SPEC_VERSION,RELEASE_TYPES:i.RELEASE_TYPES,compareIdentifiers:o.compareIdentifiers,rcompareIdentifiers:o.rcompareIdentifiers}},84447:t=>{const e=Number.MAX_SAFE_INTEGER||9007199254740991;t.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:e,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},80073:t=>{const e="object"===typeof process&&{NODE_ENV:"production",PUBLIC_URL:"/rl",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.NODE_DEBUG&&/\bsemver\b/i.test({NODE_ENV:"production",PUBLIC_URL:"/rl",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.NODE_DEBUG)?function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return console.error("SEMVER",...e)}:()=>{};t.exports=e},94470:t=>{const e=/^[0-9]+$/,n=(t,n)=>{const r=e.test(t),i=e.test(n);return r&&i&&(t=+t,n=+n),t===n?0:r&&!i?-1:i&&!r?1:t<n?-1:1};t.exports={compareIdentifiers:n,rcompareIdentifiers:(t,e)=>n(e,t)}},1102:t=>{const e=Object.freeze({loose:!0}),n=Object.freeze({});t.exports=t=>t?"object"!==typeof t?e:t:n},83153:(t,e,n)=>{const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:a}=n(84447),o=n(80073),s=(e=t.exports={}).re=[],c=e.safeRe=[],u=e.src=[],l=e.t={};let h=0;const d="[a-zA-Z0-9-]",f=[["\\s",1],["\\d",a],[d,i]],p=(t,e,n)=>{const r=(t=>{for(const[e,n]of f)t=t.split("".concat(e,"*")).join("".concat(e,"{0,").concat(n,"}")).split("".concat(e,"+")).join("".concat(e,"{1,").concat(n,"}"));return t})(e),i=h++;o(t,i,e),l[t]=i,u[i]=e,s[i]=new RegExp(e,n?"g":void 0),c[i]=new RegExp(r,n?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-]".concat(d,"*")),p("MAINVERSION","(".concat(u[l.NUMERICIDENTIFIER],")\\.")+"(".concat(u[l.NUMERICIDENTIFIER],")\\.")+"(".concat(u[l.NUMERICIDENTIFIER],")")),p("MAINVERSIONLOOSE","(".concat(u[l.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(u[l.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(u[l.NUMERICIDENTIFIERLOOSE],")")),p("PRERELEASEIDENTIFIER","(?:".concat(u[l.NUMERICIDENTIFIER],"|").concat(u[l.NONNUMERICIDENTIFIER],")")),p("PRERELEASEIDENTIFIERLOOSE","(?:".concat(u[l.NUMERICIDENTIFIERLOOSE],"|").concat(u[l.NONNUMERICIDENTIFIER],")")),p("PRERELEASE","(?:-(".concat(u[l.PRERELEASEIDENTIFIER],"(?:\\.").concat(u[l.PRERELEASEIDENTIFIER],")*))")),p("PRERELEASELOOSE","(?:-?(".concat(u[l.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(u[l.PRERELEASEIDENTIFIERLOOSE],")*))")),p("BUILDIDENTIFIER","".concat(d,"+")),p("BUILD","(?:\\+(".concat(u[l.BUILDIDENTIFIER],"(?:\\.").concat(u[l.BUILDIDENTIFIER],")*))")),p("FULLPLAIN","v?".concat(u[l.MAINVERSION]).concat(u[l.PRERELEASE],"?").concat(u[l.BUILD],"?")),p("FULL","^".concat(u[l.FULLPLAIN],"$")),p("LOOSEPLAIN","[v=\\s]*".concat(u[l.MAINVERSIONLOOSE]).concat(u[l.PRERELEASELOOSE],"?").concat(u[l.BUILD],"?")),p("LOOSE","^".concat(u[l.LOOSEPLAIN],"$")),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE","".concat(u[l.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),p("XRANGEIDENTIFIER","".concat(u[l.NUMERICIDENTIFIER],"|x|X|\\*")),p("XRANGEPLAIN","[v=\\s]*(".concat(u[l.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(u[l.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(u[l.XRANGEIDENTIFIER],")")+"(?:".concat(u[l.PRERELEASE],")?").concat(u[l.BUILD],"?")+")?)?"),p("XRANGEPLAINLOOSE","[v=\\s]*(".concat(u[l.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(u[l.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(u[l.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(u[l.PRERELEASELOOSE],")?").concat(u[l.BUILD],"?")+")?)?"),p("XRANGE","^".concat(u[l.GTLT],"\\s*").concat(u[l.XRANGEPLAIN],"$")),p("XRANGELOOSE","^".concat(u[l.GTLT],"\\s*").concat(u[l.XRANGEPLAINLOOSE],"$")),p("COERCEPLAIN","".concat("(^|[^\\d])(\\d{1,").concat(r,"})")+"(?:\\.(\\d{1,".concat(r,"}))?")+"(?:\\.(\\d{1,".concat(r,"}))?")),p("COERCE","".concat(u[l.COERCEPLAIN],"(?:$|[^\\d])")),p("COERCEFULL",u[l.COERCEPLAIN]+"(?:".concat(u[l.PRERELEASE],")?")+"(?:".concat(u[l.BUILD],")?")+"(?:$|[^\\d])"),p("COERCERTL",u[l.COERCE],!0),p("COERCERTLFULL",u[l.COERCEFULL],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM","(\\s*)".concat(u[l.LONETILDE],"\\s+"),!0),e.tildeTrimReplace="$1~",p("TILDE","^".concat(u[l.LONETILDE]).concat(u[l.XRANGEPLAIN],"$")),p("TILDELOOSE","^".concat(u[l.LONETILDE]).concat(u[l.XRANGEPLAINLOOSE],"$")),p("LONECARET","(?:\\^)"),p("CARETTRIM","(\\s*)".concat(u[l.LONECARET],"\\s+"),!0),e.caretTrimReplace="$1^",p("CARET","^".concat(u[l.LONECARET]).concat(u[l.XRANGEPLAIN],"$")),p("CARETLOOSE","^".concat(u[l.LONECARET]).concat(u[l.XRANGEPLAINLOOSE],"$")),p("COMPARATORLOOSE","^".concat(u[l.GTLT],"\\s*(").concat(u[l.LOOSEPLAIN],")$|^$")),p("COMPARATOR","^".concat(u[l.GTLT],"\\s*(").concat(u[l.FULLPLAIN],")$|^$")),p("COMPARATORTRIM","(\\s*)".concat(u[l.GTLT],"\\s*(").concat(u[l.LOOSEPLAIN],"|").concat(u[l.XRANGEPLAIN],")"),!0),e.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE","^\\s*(".concat(u[l.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(u[l.XRANGEPLAIN],")")+"\\s*$"),p("HYPHENRANGELOOSE","^\\s*(".concat(u[l.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(u[l.XRANGEPLAINLOOSE],")")+"\\s*$"),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},85378:(t,e,n)=>{const r=n(90542);t.exports=(t,e,n)=>r(t,e,">",n)},2903:(t,e,n)=>{const r=n(77356);t.exports=(t,e,n)=>(t=new r(t,n),e=new r(e,n),t.intersects(e,n))},81271:(t,e,n)=>{const r=n(90542);t.exports=(t,e,n)=>r(t,e,"<",n)},39751:(t,e,n)=>{const r=n(3485),i=n(77356);t.exports=(t,e,n)=>{let a=null,o=null,s=null;try{s=new i(e,n)}catch(c){return null}return t.forEach((t=>{s.test(t)&&(a&&-1!==o.compare(t)||(a=t,o=new r(a,n)))})),a}},21589:(t,e,n)=>{const r=n(3485),i=n(77356);t.exports=(t,e,n)=>{let a=null,o=null,s=null;try{s=new i(e,n)}catch(c){return null}return t.forEach((t=>{s.test(t)&&(a&&1!==o.compare(t)||(a=t,o=new r(a,n)))})),a}},96616:(t,e,n)=>{const r=n(3485),i=n(77356),a=n(90265);t.exports=(t,e)=>{t=new i(t,e);let n=new r("0.0.0");if(t.test(n))return n;if(n=new r("0.0.0-0"),t.test(n))return n;n=null;for(let i=0;i<t.set.length;++i){const e=t.set[i];let o=null;e.forEach((t=>{const e=new r(t.semver.version);switch(t.operator){case">":0===e.prerelease.length?e.patch++:e.prerelease.push(0),e.raw=e.format();case"":case">=":o&&!a(e,o)||(o=e);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: ".concat(t.operator))}})),!o||n&&!a(n,o)||(n=o)}return n&&t.test(n)?n:null}},90542:(t,e,n)=>{const r=n(3485),i=n(25189),{ANY:a}=i,o=n(77356),s=n(49157),c=n(90265),u=n(62886),l=n(88063),h=n(90186);t.exports=(t,e,n,d)=>{let f,p,g,m,y;switch(t=new r(t,d),e=new o(e,d),n){case">":f=c,p=l,g=u,m=">",y=">=";break;case"<":f=u,p=h,g=c,m="<",y="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(t,e,d))return!1;for(let r=0;r<e.set.length;++r){const n=e.set[r];let o=null,s=null;if(n.forEach((t=>{t.semver===a&&(t=new i(">=0.0.0")),o=o||t,s=s||t,f(t.semver,o.semver,d)?o=t:g(t.semver,s.semver,d)&&(s=t)})),o.operator===m||o.operator===y)return!1;if((!s.operator||s.operator===m)&&p(t,s.semver))return!1;if(s.operator===y&&g(t,s.semver))return!1}return!0}},10062:(t,e,n)=>{const r=n(49157),i=n(6803);t.exports=(t,e,n)=>{const a=[];let o=null,s=null;const c=t.sort(((t,e)=>i(t,e,n)));for(const i of c){r(i,e,n)?(s=i,o||(o=i)):(s&&a.push([o,s]),s=null,o=null)}o&&a.push([o,null]);const u=[];for(const[r,i]of a)r===i?u.push(r):i||r!==c[0]?i?r===c[0]?u.push("<=".concat(i)):u.push("".concat(r," - ").concat(i)):u.push(">=".concat(r)):u.push("*");const l=u.join(" || "),h="string"===typeof e.raw?e.raw:String(e);return l.length<h.length?l:e}},33151:(t,e,n)=>{const r=n(77356),i=n(25189),{ANY:a}=i,o=n(49157),s=n(6803),c=[new i(">=0.0.0-0")],u=[new i(">=0.0.0")],l=(t,e,n)=>{if(t===e)return!0;if(1===t.length&&t[0].semver===a){if(1===e.length&&e[0].semver===a)return!0;t=n.includePrerelease?c:u}if(1===e.length&&e[0].semver===a){if(n.includePrerelease)return!0;e=u}const r=new Set;let i,l,f,p,g,m,y;for(const a of t)">"===a.operator||">="===a.operator?i=h(i,a,n):"<"===a.operator||"<="===a.operator?l=d(l,a,n):r.add(a.semver);if(r.size>1)return null;if(i&&l){if(f=s(i.semver,l.semver,n),f>0)return null;if(0===f&&(">="!==i.operator||"<="!==l.operator))return null}for(const a of r){if(i&&!o(a,String(i),n))return null;if(l&&!o(a,String(l),n))return null;for(const t of e)if(!o(a,String(t),n))return!1;return!0}let v=!(!l||n.includePrerelease||!l.semver.prerelease.length)&&l.semver,b=!(!i||n.includePrerelease||!i.semver.prerelease.length)&&i.semver;v&&1===v.prerelease.length&&"<"===l.operator&&0===v.prerelease[0]&&(v=!1);for(const a of e){if(y=y||">"===a.operator||">="===a.operator,m=m||"<"===a.operator||"<="===a.operator,i)if(b&&a.semver.prerelease&&a.semver.prerelease.length&&a.semver.major===b.major&&a.semver.minor===b.minor&&a.semver.patch===b.patch&&(b=!1),">"===a.operator||">="===a.operator){if(p=h(i,a,n),p===a&&p!==i)return!1}else if(">="===i.operator&&!o(i.semver,String(a),n))return!1;if(l)if(v&&a.semver.prerelease&&a.semver.prerelease.length&&a.semver.major===v.major&&a.semver.minor===v.minor&&a.semver.patch===v.patch&&(v=!1),"<"===a.operator||"<="===a.operator){if(g=d(l,a,n),g===a&&g!==l)return!1}else if("<="===l.operator&&!o(l.semver,String(a),n))return!1;if(!a.operator&&(l||i)&&0!==f)return!1}return!(i&&m&&!l&&0!==f)&&(!(l&&y&&!i&&0!==f)&&(!b&&!v))},h=(t,e,n)=>{if(!t)return e;const r=s(t.semver,e.semver,n);return r>0?t:r<0||">"===e.operator&&">="===t.operator?e:t},d=(t,e,n)=>{if(!t)return e;const r=s(t.semver,e.semver,n);return r<0?t:r>0||"<"===e.operator&&"<="===t.operator?e:t};t.exports=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t===e)return!0;t=new r(t,n),e=new r(e,n);let i=!1;t:for(const r of t.set){for(const t of e.set){const e=l(r,t,n);if(i=i||null!==e,e)continue t}if(i)return!1}return!0}},56324:(t,e,n)=>{const r=n(77356);t.exports=(t,e)=>new r(t,e).set.map((t=>t.map((t=>t.value)).join(" ").trim().split(" ")))},56131:(t,e,n)=>{const r=n(77356);t.exports=(t,e)=>{try{return new r(t,e).range||"*"}catch(n){return null}}},17725:t=>{"use strict";t.exports=function(t){t.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}},72453:(t,e,n)=>{"use strict";function r(t){var e=this;if(e instanceof r||(e=new r),e.tail=null,e.head=null,e.length=0,t&&"function"===typeof t.forEach)t.forEach((function(t){e.push(t)}));else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)e.push(arguments[n]);return e}function i(t,e,n){var r=e===t.head?new s(n,null,e,t):new s(n,e,e.next,t);return null===r.next&&(t.tail=r),null===r.prev&&(t.head=r),t.length++,r}function a(t,e){t.tail=new s(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function o(t,e){t.head=new s(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function s(t,e,n,r){if(!(this instanceof s))return new s(t,e,n,r);this.list=r,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}t.exports=r,r.Node=s,r.create=r,r.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,n=t.prev;return e&&(e.prev=n),n&&(n.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=n),t.list.length--,t.next=null,t.prev=null,t.list=null,e},r.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},r.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}},r.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)a(this,arguments[t]);return this.length},r.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)o(this,arguments[t]);return this.length},r.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},r.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},r.prototype.forEach=function(t,e){e=e||this;for(var n=this.head,r=0;null!==n;r++)t.call(e,n.value,r,this),n=n.next},r.prototype.forEachReverse=function(t,e){e=e||this;for(var n=this.tail,r=this.length-1;null!==n;r--)t.call(e,n.value,r,this),n=n.prev},r.prototype.get=function(t){for(var e=0,n=this.head;null!==n&&e<t;e++)n=n.next;if(e===t&&null!==n)return n.value},r.prototype.getReverse=function(t){for(var e=0,n=this.tail;null!==n&&e<t;e++)n=n.prev;if(e===t&&null!==n)return n.value},r.prototype.map=function(t,e){e=e||this;for(var n=new r,i=this.head;null!==i;)n.push(t.call(e,i.value,this)),i=i.next;return n},r.prototype.mapReverse=function(t,e){e=e||this;for(var n=new r,i=this.tail;null!==i;)n.push(t.call(e,i.value,this)),i=i.prev;return n},r.prototype.reduce=function(t,e){var n,r=this.head;if(arguments.length>1)n=e;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=t(n,r.value,i),r=r.next;return n},r.prototype.reduceReverse=function(t,e){var n,r=this.tail;if(arguments.length>1)n=e;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=t(n,r.value,i),r=r.prev;return n},r.prototype.toArray=function(){for(var t=new Array(this.length),e=0,n=this.head;null!==n;e++)t[e]=n.value,n=n.next;return t},r.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,n=this.tail;null!==n;e++)t[e]=n.value,n=n.prev;return t},r.prototype.slice=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var n=new r;if(e<t||e<0)return n;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=0,a=this.head;null!==a&&i<t;i++)a=a.next;for(;null!==a&&i<e;i++,a=a.next)n.push(a.value);return n},r.prototype.sliceReverse=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var n=new r;if(e<t||e<0)return n;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=this.length,a=this.tail;null!==a&&i>e;i--)a=a.prev;for(;null!==a&&i>t;i--,a=a.prev)n.push(a.value);return n},r.prototype.splice=function(t,e){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var n=0,r=this.head;null!==r&&n<t;n++)r=r.next;var a=[];for(n=0;r&&n<e;n++)a.push(r.value),r=this.removeNode(r);null===r&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev);for(n=0;n<(arguments.length<=2?0:arguments.length-2);n++)r=i(this,r,n+2<2||arguments.length<=n+2?void 0:arguments[n+2]);return a},r.prototype.reverse=function(){for(var t=this.head,e=this.tail,n=t;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=e,this.tail=t,this};try{n(17725)(r)}catch(c){}},85817:()=>{},18590:()=>{},4530:()=>{},8108:()=>{},80551:()=>{},41234:()=>{},1403:t=>{"use strict";var e=/("(?:[^\\"]|\\.)*")|[:,]/g;t.exports=function(t,n){var r,i,a;return n=n||{},r=JSON.stringify([1],void 0,void 0===n.indent?2:n.indent).slice(2,-3),i=""===r?1/0:void 0===n.maxLength?80:n.maxLength,a=n.replacer,function t(n,o,s){var c,u,l,h,d,f,p,g,m,y,v,b;if(n&&"function"===typeof n.toJSON&&(n=n.toJSON()),void 0===(v=JSON.stringify(n,a)))return v;if(p=i-o.length-s,v.length<=p&&(m=v.replace(e,(function(t,e){return e||t+" "}))).length<=p)return m;if(null!=a&&(n=JSON.parse(v),a=void 0),"object"===typeof n&&null!==n){if(g=o+r,l=[],u=0,Array.isArray(n))for(y="[",c="]",p=n.length;u<p;u++)l.push(t(n[u],g,u===p-1?0:1)||"null");else for(y="{",c="}",p=(f=Object.keys(n)).length;u<p;u++)h=f[u],d=JSON.stringify(h)+": ",void 0!==(b=t(n[h],g,d.length+(u===p-1?0:1)))&&l.push(d+b);if(l.length>0)return[y,r+l.join(",\n"+g),c].join("\n"+o)}return v}(t,"",0)}}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var a=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=t,n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.f={},n.e=t=>Promise.all(Object.keys(n.f).reduce(((e,r)=>(n.f[r](t,e),e)),[])),n.u=t=>"static/js/"+t+"."+{206:"401e238c",468:"188edeb8"}[t]+".chunk.js",n.miniCssF=t=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={},e="tfjs-rl:";n.l=(r,i,a,o)=>{if(t[r])t[r].push(i);else{var s,c;if(void 0!==a)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var h=u[l];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==e+a){s=h;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",e+a),s.src=r),t[r]=[i];var d=(e,n)=>{s.onerror=s.onload=null,clearTimeout(f);var i=t[r];if(delete t[r],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((t=>t(n))),e)return e(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=d.bind(null,s.onerror),s.onload=d.bind(null,s.onload),c&&document.head.appendChild(s)}}})(),n.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),n.p="/rl/",(()=>{n.b=document.baseURI||self.location.href;var t={792:0};n.f.j=(e,r)=>{var i=n.o(t,e)?t[e]:void 0;if(0!==i)if(i)r.push(i[2]);else{var a=new Promise(((n,r)=>i=t[e]=[n,r]));r.push(i[2]=a);var o=n.p+n.u(e),s=new Error;n.l(o,(r=>{if(n.o(t,e)&&(0!==(i=t[e])&&(t[e]=void 0),i)){var a=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;s.message="Loading chunk "+e+" failed.\n("+a+": "+o+")",s.name="ChunkLoadError",s.type=a,s.request=o,i[1](s)}}),"chunk-"+e,e)}};var e=(e,r)=>{var i,a,o=r[0],s=r[1],c=r[2],u=0;if(o.some((e=>0!==t[e]))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(c)c(n)}for(e&&e(r);u<o.length;u++)a=o[u],n.o(t,a)&&t[a]&&t[a][0](),t[a]=0},r=self.webpackChunktfjs_rl=self.webpackChunktfjs_rl||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})(),(()=>{"use strict";var t={};n.r(t),n.d(t,{addImpl:()=>Mu,bincountImpl:()=>Al,bincountReduceImpl:()=>Cl,bitwiseAndImpl:()=>Tl,castImpl:()=>Tu,ceilImpl:()=>Il,concatImpl:()=>Ll,equalImpl:()=>kh,expImpl:()=>Mh,expm1Impl:()=>Lh,floorImpl:()=>ed,gatherNdImpl:()=>ud,gatherV2Impl:()=>hd,greaterEqualImpl:()=>md,greaterImpl:()=>fd,lessEqualImpl:()=>Nd,lessImpl:()=>Cd,linSpaceImpl:()=>Id,logImpl:()=>Od,maxImpl:()=>Kd,maximumImpl:()=>Qd,minimumImpl:()=>uf,multiplyImpl:()=>ph,negImpl:()=>bf,notEqualImpl:()=>Ef,prodImpl:()=>jf,raggedGatherImpl:()=>Gf,raggedRangeImpl:()=>Xf,raggedTensorToTensorImpl:()=>tp,rangeImpl:()=>np,rsqrtImpl:()=>pp,scatterImpl:()=>yp,sigmoidImpl:()=>bu,simpleAbsImpl:()=>Wu,sliceImpl:()=>wl,sparseFillEmptyRowsImpl:()=>Bp,sparseReshapeImpl:()=>Pp,sparseSegmentReductionImpl:()=>Up,sqrtImpl:()=>Hp,staticRegexReplaceImpl:()=>Jp,stridedSliceImpl:()=>ig,stringNGramsImpl:()=>sg,stringSplitImpl:()=>lg,stringToHashBucketFastImpl:()=>dg,subImpl:()=>qh,tileImpl:()=>bg,topKImpl:()=>_g,transposeImpl:()=>Ku,uniqueImpl:()=>Dg});var e={};n.r(e),n.d(e,{Game:()=>CA});var r=n(1352);const i=t=>{t&&t instanceof Function&&n.e(206).then(n.bind(n,88206)).then((e=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:a,getTTFB:o}=e;n(t),r(t),i(t),a(t),o(t)}))};var a=n(9950),o=n(37837),s=n(87311),c=n(69779),u=n(86272),l=n(52946);const h={kernelName:s.ljI,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,u.l)(t,(0,l.P)((0,c.w)(n,"float32"),-1))}}};var d=n(64113),f=n(5008),p=n(90844),g=n(45766),m=n(95195),y=n(77820);const v={kernelName:s.Vvy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=(0,m.E)((0,c.w)(n,"float32")),r=(0,g.R)((0,y.j)((0,p.d)(1),e));return(0,f.H)((0,d.y)(t,r))}}}},b={kernelName:s.PH8,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=(0,g.R)((0,y.j)((0,m.E)((0,c.w)(n,"float32")),1));return(0,d.y)(t,e)}}}};var x=n(84824),w=n(89068),k=n(17937);const _={kernelName:s.OMN,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=x.assertAndGetBroadcastShape(n.shape,r.shape);return{a:()=>{let e=t;const r=x.getReductionAxes(n.shape,i);return r.length>0&&(e=(0,k.c)(e,r)),(0,w.t)(e,n.shape)},b:()=>{let e=t;const n=x.getReductionAxes(r.shape,i);return n.length>0&&(e=(0,k.c)(e,n)),(0,w.t)(e,r.shape)}}}},S={kernelName:s.EkD,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach(((e,r)=>{n[r]=()=>t.clone()})),n}};var A=n(90043);const C={kernelName:s.Jp_,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,A.P)(n)}}},E={kernelName:s.p_m,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,A.P)(n)}}},T={kernelName:s.QKF,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,d.y)(t,(0,g.R)((0,y.j)((0,p.d)(1),(0,m.E)((0,c.w)(n,"float32")))))}}};var N=n(67281);const D={kernelName:s.epO,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=(0,g.R)((0,N.W)((0,p.d)(1),(0,m.E)((0,c.w)(n,"float32"))));return(0,d.y)(t,e)}}}},F={kernelName:s.lxb,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=(0,x.assertAndGetBroadcastShape)(n.shape,r.shape);return{a:()=>{const e=(0,N.W)((0,m.E)(n),(0,m.E)(r));let a=(0,u.l)(t,(0,d.y)(r,e));const o=(0,x.getReductionAxes)(n.shape,i);return o.length>0&&(a=(0,k.c)(a,o)),(0,w.t)(a,n.shape)},b:()=>{const e=(0,N.W)((0,m.E)(n),(0,m.E)(r));let a=(0,f.H)((0,u.l)(t,(0,d.y)(n,e)));const o=(0,x.getReductionAxes)(r.shape,i);return o.length>0&&(a=(0,k.c)(a,o)),(0,w.t)(a,r.shape)}}}},I={kernelName:s.TyE,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,d.y)(t,(0,N.W)((0,m.E)((0,c.w)(n,"float32")),1))}}},M={kernelName:s.zP9,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,d.y)(t,(0,y.j)((0,p.d)(1),(0,m.E)((0,c.w)(n,"float32"))))}}};var O=n(37484),R=n(52863),z=n(23869),B=n(157),L=n(26039);const P=(0,L.op)({avgPool3dGrad_:function(t,e,n,r,i,a){const o=(0,R.YT)(t,"dy","avgPool3dGrad"),c=(0,R.YT)(e,"input","avgPool3dGrad");let u=o,l=c,h=!1;4===c.rank&&(h=!0,u=(0,w.t)(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),l=(0,w.t)(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),z.vA(5===u.rank,(()=>"Error in avgPool3dGrad: dy must be rank 5 but got rank "+"".concat(u.rank,"."))),z.vA(5===l.rank,(()=>"Error in avgPool3dGrad: input must be rank 5 but got rank "+"".concat(l.rank,"."))),(0,B.s_)("avgPool3dGrad",i,a);const d={dy:u,input:l},f={filterSize:n,strides:r,pad:i,dimRoundingMode:a},p=O.T2.runKernel(s.wwC,d,f);return h?(0,w.t)(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),j={kernelName:s.cS,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:i,strides:a,pad:o,dimRoundingMode:s}=n;return{x:()=>P(t,r,i,a,o,s)}}};const U=(0,L.op)({avgPoolGrad_:function(t,e,n,r,i){const a=(0,R.YT)(t,"dy","avgPoolGrad"),o=(0,R.YT)(e,"input","avgPoolGrad");z.vA(o.rank===a.rank,(()=>"Rank of input (".concat(o.rank,") does not match rank of dy (").concat(a.rank,")")));let c=o,u=a,l=!1;3===o.rank&&(l=!0,c=(0,w.t)(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=(0,w.t)(a,[1,a.shape[0],a.shape[1],a.shape[2]])),z.vA(4===u.rank,(()=>"Error in avgPoolGrad: dy must be rank 4 but got rank "+"".concat(u.rank,"."))),z.vA(4===c.rank,(()=>"Error in avgPoolGrad: input must be rank 4 but got rank "+"".concat(c.rank,".")));const h={dy:u,input:c},d={filterSize:n,strides:r,pad:i},f=O.T2.runKernel(s.VCH,h,d);return l?(0,w.t)(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),W={kernelName:s.ho8,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:i,strides:a,pad:o}=n;return{x:()=>U(t,r,i,a,o)}}};var V=n(65849);const q={kernelName:s.jAQ,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[r,i]=e,{transposeA:a,transposeB:o}=n;return a||o?!a&&o?{a:()=>(0,V.N)(t,i,!1,!1),b:()=>(0,V.N)(t,r,!0,!1)}:a&&!o?{a:()=>(0,V.N)(i,t,!1,!0),b:()=>(0,V.N)(r,t,!1,!1)}:{a:()=>(0,V.N)(i,t,!0,!0),b:()=>(0,V.N)(t,r,!0,!0)}:{a:()=>(0,V.N)(t,i,!1,!0),b:()=>(0,V.N)(r,t,!0,!1)}}};var G=n(90602);const H={kernelName:s.Ik2,gradFunc:(t,e,n)=>{const{blockShape:r,crops:i}=n;return{x:()=>(0,G.e)(t,r,i)}}},Y={kernelName:s.LB5,gradFunc:(t,e,n)=>{const r=n,i=r.inputShape,a=r.shape,o=Array.from(a);for(let c=i.length-1;c>=0;c--)if(i[c]===a[c])o[c]=1;else if(1!==i[c])throw new Error("broadcastTo(): [".concat(i,"] cannot be broadcast to [").concat(a,"]."));const s=[];for(let c=0;c<o.length;c++)o[c]>1&&s.push(c);return{x:()=>(0,k.c)(t,s,!0)}}},X={kernelName:s.KXH,gradFunc:t=>({x:()=>t.clone()})},K={kernelName:s.QDP,gradFunc:t=>({x:()=>(0,A.P)(t)})};var $=n(39103),Z=n(64210),Q=n(21183),J=n(52117);const tt={kernelName:s.vaV,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{clipValueMin:i,clipValueMax:a}=n;return{x:()=>(0,J._)((0,Q.n)((0,$.D)(r,i),(0,Z.I)(r,a)),t,(0,A.P)(t))}}},et={kernelName:s.$zE,inputsToSave:["x"],gradFunc:h.gradFunc};var nt=n(77554);const rt={kernelName:s.$dB,saveAllInputs:!0,gradFunc:(t,e,n)=>{const r=e.map((t=>t.shape)),{axis:i}=n,a=(0,z.Y6)(i,e[0].shape)[0],o=r.map((t=>t[a]));return(0,nt.l)(t,o,a).map((t=>()=>t))}};var it=n(23458),at=n(51294);const ot={kernelName:s.p2J,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,i]=e,{dilations:a,strides:o,pad:s,dataFormat:c}=n;return z.vA(B.Dh(a),(()=>"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(a,"'"))),{x:()=>(0,at.v)(r.shape,t,i,o,s,c),filter:()=>(0,it.H)(r,t,i.shape,o,s,c)}}};var st=n(31880);const ct={kernelName:s.jfg,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[r,i]=e,{strides:a,pad:o,dataFormat:s,dimRoundingMode:c}=n;return{dy:()=>(0,st.X)(t,i,a,o,s,1,c),filter:()=>(0,it.H)(t,r,i.shape,a,o,s,c)}}};const ut=(0,L.op)({conv3DBackpropFilter_:function(t,e,n,r,i){let a=t;4===t.rank&&(a=(0,w.t)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;4===o.rank&&(o=(0,w.t)(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),z.vA(5===a.rank,(()=>"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(a.shape,"."))),z.vA(5===o.rank,(()=>"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(o.shape,"."))),z.vA(5===n.length,(()=>"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,"."))),z.vA(a.shape[4]===n[3],(()=>"Error in conv3dDerFilter: depth of input ".concat(a.shape[4],") must ")+"match input depth in filter (".concat(n[3],"."))),z.vA(o.shape[4]===n[4],(()=>"Error in conv3dDerFilter: depth of dy (".concat(o.shape[4],") must ")+"match output depth for filter (".concat(n[4],").")));const c={x:a,dy:o},u={strides:r,pad:i,filterShape:n};return O.T2.runKernel(s.iGz,c,u)}});var lt=n(20289);const ht={kernelName:s.A1h,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:i,pad:a}=n;z.vA((0,B.Dh)(r),(()=>"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(r,"'")));const[o,s]=e;return{x:()=>(0,lt.c)(o.shape,t,s,i,a),filter:()=>ut(o,t,s.shape,i,a)}}};var dt=n(85956);const ft={kernelName:s.Mn0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,u.l)((0,f.H)((0,dt.F)((0,c.w)(n,"float32"))),t)}}};var pt=n(15990);const gt={kernelName:s.MnK,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,u.l)((0,pt.L)((0,c.w)(n,"float32")),t)}}};var mt=n(58724),yt=n(91482),vt=n(15977);const bt={kernelName:s.nY8,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:i,exclusive:a,reverse:o}=n;return{x:()=>{const e=(0,mt.Em)([i],r.rank);let n=(0,yt.r)(t,i,a,!o);return null!=e&&(n=(0,vt.m)(n,e)),n}}}};var xt=n(85408),wt=n(59068);const kt={kernelName:s.tGH,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:i,pad:a,dimRoundingMode:o}=n,s=null==r?[1,1]:r;z.vA(B.Dh(s),(()=>"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(s,"'")));const[c,u]=e;return z.vA(4===c.rank,(()=>"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(c.rank,"."))),z.vA(4===u.rank,(()=>"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(u.rank,"."))),z.vA(c.shape[3]===u.shape[2],(()=>"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(c.shape[3],") must match the inChannels dimension ")+"in filter ".concat(u.shape[2],"."))),z.vA(B.G0(i,s),(()=>"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(i," and dilations ")+"'".concat(s,"'."))),B.s_("depthwiseConv2d",a,o),{x:()=>(0,wt.l)(c.shape,t,u,i,a,s,o),filter:()=>(0,xt.x)(c,t,u.shape,i,a,s,o)}}},_t={kernelName:s.jxD,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,i]=e,a={x:r,filter:i,dy:t},o={x:r,filter:i,dy:t};return{x:()=>O.T2.runKernel(s.bP9,a,n),filter:()=>O.T2.runKernel(s.pk0,o,n)}}},St={kernelName:s.Pah,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,r={dy:t,y:n};return{x:()=>O.T2.runKernel(s.rsH,r)}}};var At=n(48389);const Ct={kernelName:s._s9,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=(0,u.l)((0,At.o)((0,f.H)((0,m.E)(n))),2/Math.sqrt(Math.PI));return{x:()=>(0,u.l)(t,r)}}},Et={kernelName:s.ox3,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,u.l)(t,n)}}},Tt={kernelName:s.ybN,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>(0,w.t)(t,n.shape)}}},Nt={kernelName:s.ybj,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,u.l)(t,(0,At.o)(n))}}},Dt={kernelName:s.ZgB,gradFunc:t=>({x:()=>(0,A.P)(t)})},Ft={kernelName:s.ElG,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=(0,x.assertAndGetBroadcastShape)(n.shape,r.shape);return{a:()=>{const e=(0,d.y)(t,(0,c.w)(r,"float32")),a=(0,x.getReductionAxes)(n.shape,i);return a.length>0?(0,w.t)((0,k.c)(e,a),n.shape):e},b:()=>{let e=(0,u.l)(t,(0,c.w)(n,"float32"));const a=(0,x.getReductionAxes)(r.shape,i);a.length>0&&(e=(0,w.t)((0,k.c)(e,a),r.shape));const o=(0,m.E)(r);return(0,f.H)((0,d.y)(e,(0,c.w)(o,"float32")))}}}};var It=n(30414),Mt=n(35716);const Ot={kernelName:s.i5R,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:r}=n,[i,a,o,s]=e,c=null==s?(0,p.d)(1):s,l=(0,x.getReductionAxes)(a.shape,i.shape),h=[];if(1===a.rank){for(let t=0;t<i.shape.length-1;++t)h.push(i.shape[t]);h.push(1)}const d=(0,y.j)(i,a),f=(0,u.l)(t,c),g=(0,It.Z)((0,N.W)(o,(0,p.d)(r))),m=(0,u.l)((0,u.l)((0,u.l)(g,g),g),(0,p.d)(-.5));return{x:()=>1===a.rank?(0,w.t)((0,u.l)((0,u.l)(t,(0,Mt.V)((0,w.t)(g,[1,1,1,a.shape[0]]),h)),c),i.shape):(0,w.t)((0,u.l)((0,u.l)(t,g),c),i.shape),mean:()=>{let t=(0,u.l)((0,u.l)(g,(0,p.d)(-1)),f);return 1===a.rank&&(t=(0,k.c)(t,l)),(0,w.t)(t,a.shape)},variance:()=>{let t=(0,u.l)((0,u.l)(m,d),f);return 1===a.rank&&(t=(0,k.c)(t,l)),(0,w.t)(t,a.shape)},scale:()=>{const e=(0,u.l)(d,g);let n=(0,u.l)(t,e);return 1===a.rank&&(n=(0,k.c)(n,l)),(0,w.t)(n,a.shape)},offset:()=>{let e=t;return 1===a.rank&&(e=(0,k.c)(e,l)),(0,w.t)(e,a.shape)}}}};var Rt=n(22190),zt=n(66788);const Bt={kernelName:s.mxL,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[r,i]=e,{axis:a,batchDims:o}=n,s=(0,z.Y6)(a,r.shape)[0],c=(t,e,n)=>()=>{const r=t.shape,i=e.size,o=r.slice(0,s),c=o.length,u=r.slice(a,r.length).slice(1),l=u.length,h=Lt(0,c),d=Lt(c+1,c+1+l),f=Pt([o,[i],u]),p=(0,w.t)(n,f),g=(0,w.t)(e,[i]),m=Pt([[c],h,d]),y=(0,vt.m)(p,m);let v=(0,zt.z)(y,g,t.shape[s]);const b=(0,mt.gx)(m);return v=(0,vt.m)(v,b),v};if(1===o){const e=r.shape[0],n=r.split(e,0);return{x:()=>{const e=(0,Rt.t)(n.map(((e,n)=>c(e,i.slice(n,1),t.slice(n,1))())));return e.reshape(r.shape)},indices:()=>i}}return{x:c(r,i,t),indices:()=>i}}};function Lt(t,e){const n=[];for(let r=t;r<e;++r)n.push(r);return n}function Pt(t){const e=[];for(let n=0;n<t.length;++n)for(let r=0;r<t[n].length;++r)e.push(t[n][r]);return e}const jt={kernelName:s.lLS,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>(0,A.P)(n),b:()=>(0,A.P)(r)}}},Ut={kernelName:s.lzr,gradFunc:t=>({x:()=>(0,c.w)(t,"float32")})},Wt={kernelName:s.gIW,gradFunc:t=>({x:()=>(0,A.P)(t)})},Vt={kernelName:s.E3$,gradFunc:t=>({x:()=>(0,A.P)(t)})},qt={kernelName:s.iPs,gradFunc:t=>({x:()=>(0,A.P)(t)})};var Gt=n(60228);const Ht={kernelName:s.X0$,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{alpha:i}=n,a=(0,Gt.r)(r,0);return{x:()=>(0,J._)(a,t,(0,u.l)(t,i))}}},Yt={kernelName:s.Cg$,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,d.y)(t,(0,N.W)(n,1))}}},Xt={kernelName:s.tG8,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,d.y)(t,(0,c.w)(n,"float32"))}}},Kt={kernelName:s.zfU,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{axis:i}=n;return{logits:()=>{const e=(0,At.o)(r);return(0,y.j)(t,(0,u.l)((0,k.c)(t,i,!0),e))}}}};const $t=(0,L.op)({localResponseNormalizationBackprop_:function(t,e,n){const r={x:t,y:e,dy:n},i={depthRadius:arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,bias:arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,alpha:arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,beta:arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5};return O.T2.runKernel(s.ToN,r,i)}}),Zt={kernelName:s.jM4,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,i]=e,{depthRadius:a,bias:o,alpha:s,beta:c}=n;return{x:()=>$t(r,i,t,a,o,s,c)}}};var Qt=n(92138);function Jt(t,e,n,r){return e.rank<n.rank&&(e=(0,w.t)(e,mt.SM(e.shape,r))),t.rank<n.rank&&(t=(0,w.t)(t,mt.SM(t.shape,r))),{x:()=>(0,u.l)(t,(0,c.w)((0,Qt.L)(n,e),t.dtype))}}const te={kernelName:s.VAI,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{reductionIndices:i}=r,a=e[0],o=Jt(t,e[1],a,z.Y6(i,a.shape));return{x:()=>o.x()}}};var ee=n(72969);const ne={kernelName:s.LDN,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>(0,u.l)(t,(0,c.w)((0,$.D)(n,r),"float32")),b:()=>(0,u.l)(t,(0,c.w)((0,ee.M)(n,r),"float32"))}}};const re=(0,L.op)({maxPool3dGrad_:function(t,e,n,r,i,a,o){const c=(0,R.YT)(t,"dy","maxPool3dGrad"),u=(0,R.YT)(e,"input","maxPool3dGrad"),l=(0,R.YT)(n,"output","maxPool3dGrad");let h=c,d=u,f=l,p=!1;4===u.rank&&(p=!0,h=(0,w.t)(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]]),d=(0,w.t)(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),f=(0,w.t)(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),z.vA(5===h.rank,(()=>"Error in maxPool3dGrad: dy must be rank 5 but got rank "+"".concat(h.rank,"."))),z.vA(5===d.rank,(()=>"Error in maxPool3dGrad: input must be rank 5 but got rank "+"".concat(d.rank,"."))),z.vA(5===f.rank,(()=>"Error in maxPool3dGrad: output must be rank 5 but got rank "+"".concat(f.rank,"."))),(0,B.s_)("maxPool3dGrad",a,o);const g={dy:h,input:d,output:f},m={filterSize:r,strides:i,pad:a,dimRoundingMode:o},y=O.T2.runKernel(s.cHb,g,m);return p?(0,w.t)(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}}),ie={kernelName:s.ySp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,i]=e,{filterSize:a,strides:o,pad:s,dimRoundingMode:c}=n;return{x:()=>re(t,r,i,a,o,s,c)}}};const ae=(0,L.op)({maxPoolGrad_:function(t,e,n,r,i,a,o){const c=(0,R.YT)(t,"dy","maxPoolGrad"),u=(0,R.YT)(e,"input","maxPoolGrad"),l=(0,R.YT)(n,"output","maxPoolGrad");z.vA(u.rank===c.rank,(()=>"Rank of input (".concat(u.rank,") does not match rank of dy ")+"(".concat(c.rank,")"))),z.vA(4===c.rank,(()=>"Error in maxPoolGrad: dy must be rank 4 but got rank "+"".concat(c.rank,"."))),z.vA(4===u.rank,(()=>"Error in maxPoolGrad: input must be rank 4 but got rank "+"".concat(u.rank,"."))),B.s_("maxPoolGrad",a,o);const h={dy:c,input:u,output:l},d={filterSize:r,strides:i,pad:a,dimRoundingMode:o};return O.T2.runKernel(s.RXX,h,d)}}),oe={kernelName:s.t3d,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,i]=e,{filterSize:a,strides:o,pad:s}=n;return{x:()=>ae(t,r,i,a,o,s)}}};var se=n(88865);const ce={kernelName:s.g5A,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:i}=n,a=z.Y6(i,r.shape),o=(0,mt.lb)(r.shape,a)[1],s=z.Ze(o);return{x:()=>{const e=r.shape.slice();a.forEach((t=>{e[t]=1}));const n=(0,w.t)(t,e);return(0,d.y)((0,u.l)(n,(0,se.S)(r.shape,"float32")),s)}}}},ue={kernelName:s.lNG,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{axis:i}=r,[a,o]=e,s=Jt(t,o,a,z.Y6(i,a.shape));return{x:()=>s.x()}}},le={kernelName:s.LG0,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>(0,u.l)(t,(0,c.w)((0,Z.I)(n,r),"float32")),b:()=>(0,u.l)(t,(0,c.w)((0,Gt.r)(n,r),"float32"))}}};var he=n(8016);const de={kernelName:s.x7F,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:i}=n,a=i.map((t=>t[0]));return{x:()=>(0,he.d)(t,a,r.shape)}}};var fe=n(96812);const pe={kernelName:s.BLA,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=(0,x.assertAndGetBroadcastShape)(n.shape,r.shape);return{a:()=>{const e=(0,x.getReductionAxes)(n.shape,i);return e.length>0?(0,w.t)((0,k.c)(t,e),n.shape):t},b:()=>{const e=(0,u.l)(t,(0,f.H)((0,fe.R)((0,d.y)(n,r)))),a=(0,x.getReductionAxes)(r.shape,i);return a.length>0?(0,w.t)((0,k.c)(e,a),r.shape):e}}}},ge={kernelName:s.xu7,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=(0,x.assertAndGetBroadcastShape)(n.shape,r.shape);return{a:()=>{const e=(0,u.l)(t,(0,c.w)(r,"float32")),a=(0,x.getReductionAxes)(n.shape,i);return a.length>0?(0,w.t)((0,k.c)(e,a),n.shape):e},b:()=>{const e=(0,u.l)(t,(0,c.w)(n,"float32")),a=(0,x.getReductionAxes)(r.shape,i);return a.length>0?(0,w.t)((0,k.c)(e,a),r.shape):e}}}},me={kernelName:s.l0G,gradFunc:t=>({x:()=>(0,f.H)(t)})};var ye=n(38197);const ve={kernelName:s.urI,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>(0,ye.U)(n.shape,"float32")}}},be={kernelName:s.LWX,gradFunc:t=>({x:()=>(0,A.P)(t)})};var xe=n(84491);const we={kernelName:s.mM$,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:r}=n;return(0,xe.K)(t,r).map((t=>()=>t))}},ke={kernelName:s.ODT,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:i}=n,a=i.map((t=>t[0]));return{x:()=>(0,he.d)(t,a,r.shape)}}};var _e=n(18688),Se=n(78188);const Ae={kernelName:s.pyJ,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,r,i]=e,a=n,o=r,s=x.assertAndGetBroadcastShape(a.shape,o.shape);return{a:()=>{const e=(0,c.w)(o,"float32");let n=(0,u.l)(t,(0,u.l)(e,(0,Se.n)(a,(0,y.j)(e,(0,p.d)(1)))));const r=x.getReductionAxes(a.shape,s);return r.length>0&&(n=(0,k.c)(n,r)),(0,w.t)(n,a.shape)},b:()=>{const e=(0,Gt.r)(a,0),n=(0,J._)(e,(0,_e.R)(a),(0,A.P)(a));let r=(0,u.l)(t,(0,u.l)(i,n));const c=x.getReductionAxes(o.shape,s);return c.length>0&&(r=(0,k.c)(r,c)),(0,w.t)(r,o.shape)}}}},Ce={kernelName:s.Ncv,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,r]=e,i=(0,Gt.r)(n,0);return{x:()=>(0,J._)(i,t,(0,u.l)(t,r)),alpha:()=>{let e=(0,J._)(i,(0,A.P)(t),(0,u.l)(t,n));const a=(0,x.getReductionAxes)(r.shape,t.shape);return a.length>0&&(e=(0,k.c)(e,a)),(0,w.t)(e,r.shape)}}}};var Ee=n(79808);function Te(t,e,n){const r=t.shape.length,i=r-n.length,a=mt.Em(n,r);let o=t;null!=a&&(o=(0,vt.m)(t,a));const s=o.shape.slice(),c=s.splice(r-n.length,n.length).reduce(((t,e)=>t*e),1);s.push(c);let l=function(t,e,n){const r=t.shape.slice();r[n]=1;const i=(0,w.t)(e,r),a=(0,Ee.L)(t,n,!0,!1),o=(0,Ee.L)(t,n,!0,!0),s=(0,u.l)(a,o);return(0,u.l)(i,s)}(o.reshape(s),e,i);if(l=l.reshape(o.shape),null!=a){const t=mt.gx(a);l=(0,vt.m)(l,t)}return l}const Ne={kernelName:s.kdj,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:i}=n;let a=[];return a=void 0===i||null===i?r.shape.map(((t,e)=>e)):"number"===typeof i?[i]:i,{x:()=>Te(r,t,a)}}},De={kernelName:s.sDr,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=x.assertAndGetBroadcastShape(n.shape,r.shape);return{a:()=>{const e=(0,d.y)(t,(0,c.w)(r,"float32")),a=x.getReductionAxes(n.shape,i);return a.length>0?(0,w.t)((0,k.c)(e,a),n.shape):e},b:()=>{let e=(0,u.l)(t,(0,c.w)(n,"float32"));const a=x.getReductionAxes(r.shape,i);a.length>0&&(e=(0,w.t)((0,k.c)(e,a),r.shape));const o=(0,m.E)(r);return(0,f.H)((0,d.y)(e,(0,c.w)(o,"float32")))}}}},Fe={kernelName:s.huO,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,d.y)(t,(0,f.H)((0,m.E)(n)))}}},Ie={kernelName:s.P_L,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=(0,u.l)((0,Z.I)(n,6),(0,l.P)(n));return{x:()=>(0,u.l)(t,(0,c.w)(r,"float32"))}}},Me={kernelName:s.fUj,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,u.l)(t,(0,c.w)((0,l.P)(n),"float32"))}}},Oe={kernelName:s.R23,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,w.t)(t,n.shape)}}},Re={kernelName:s.hgw,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,i={dy:t,images:r};return{images:()=>O.T2.runKernel(s.FCQ,i,n)}}},ze={kernelName:s.jOE,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,i={dy:t,images:r};return{images:()=>O.T2.runKernel(s.XQy,i,n)}}};var Be=n(23540);const Le={kernelName:s.D7i,gradFunc:(t,e,n)=>{const{dims:r}=n,i=(0,z.Y6)(r,t.shape);return{x:()=>(0,Be.B)(t,i)}}},Pe={kernelName:s.hVg,gradFunc:t=>({x:()=>(0,A.P)(t)})},je={kernelName:s.TOR,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,f.H)((0,d.y)(t,(0,u.l)((0,Se.n)(n,1.5),2)))}}};var Ue=n(87375);const We={kernelName:s.l6P,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>(0,c.w)((0,A.P)(n),"float32"),t:()=>(0,u.l)(t,(0,c.w)(n,t.dtype)),e:()=>(0,u.l)(t,(0,c.w)((0,Ue.N)(n),t.dtype))}}};var Ve=n(84102);const qe={kernelName:s.u$b,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=(0,Gt.r)(n,(0,p.d)(0)),r=(0,p.d)(Ve.j),i=(0,p.d)(Ve.X),a=(0,u.l)(t,i),o=(0,u.l)((0,u.l)(t,r),(0,At.o)((0,c.w)(n,"float32")));return(0,J._)(e,a,o)}}}},Ge={kernelName:s.vI1,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,u.l)(t,(0,u.l)(n,(0,y.j)((0,p.d)(1),n)))}}},He={kernelName:s.YVe,gradFunc:t=>({x:()=>(0,A.P)(t)})};var Ye=n(48133);const Xe={kernelName:s.hql,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,u.l)((0,Ye.g)((0,c.w)(n,"float32")),t)}}};var Ke=n(84033);const $e={kernelName:s.J3C,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,u.l)((0,Ke.y)((0,c.w)(n,"float32")),t)}}};var Ze=n(67507),Qe=n(48791);const Je={kernelName:s.JiE,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{begin:i,size:a}=n,o=r.shape,[s,c]=(0,Qe.parseSliceParams)(r,i,a),u=[];for(let l=0;l<t.rank;l++)u.push([s[l],o[l]-s[l]-c[l]]);return{x:()=>(0,Ze.e)(t,u)}}},tn={kernelName:s.rFG,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{dim:i}=n,a=(0,u.l)(t,r);return{logits:()=>(0,y.j)(a,(0,u.l)((0,k.c)(a,[i],true),r))}}};var en=n(1242);const nn={kernelName:s.Fin,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,u.l)(t,(0,en.r)(n))}}};var rn=n(81406);const an={kernelName:s.A8B,gradFunc:(t,e,n)=>{const{blockShape:r,paddings:i}=n;return{x:()=>(0,rn.G)(t,r,i)}}};var on=n(89360);const sn={kernelName:s.Blb,gradFunc:(t,e,n)=>{const{axis:r}=n;return{x:()=>(0,on.x)(t,r)}}},cn={kernelName:s.dFH,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,d.y)(t,(0,u.l)((0,g.R)((0,c.w)(n,"float32")),2))}}},un={kernelName:s.M6A,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,u.l)(t,(0,u.l)((0,c.w)(n,"float32"),2))}}},ln={kernelName:s.Ddj,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=(0,p.d)(2);return{a:()=>(0,u.l)(t,(0,u.l)(i,(0,y.j)(n,r))),b:()=>(0,u.l)(t,(0,u.l)(i,(0,y.j)(r,n)))}}},hn={kernelName:s.pnw,gradFunc:t=>({x:()=>(0,A.P)(t)})},dn={kernelName:s.PbM,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=x.assertAndGetBroadcastShape(n.shape,r.shape);return{a:()=>{let e=t;const r=x.getReductionAxes(n.shape,i);return r.length>0&&(e=(0,k.c)(e,r)),(0,w.t)(e,n.shape)},b:()=>{let e=t;const n=x.getReductionAxes(r.shape,i);return n.length>0&&(e=(0,k.c)(e,n)),(0,w.t)((0,f.H)(e),r.shape)}}}},fn={kernelName:s.WuN,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,i=r.shape.slice(),{axis:a}=n;(0,z.Y6)(a,r.shape).forEach((t=>{i[t]=1}));const o=(0,w.t)(t,i),s=(0,u.l)(o,(0,se.S)(r.shape,"float32"));return{x:()=>s}}},pn={kernelName:s.oFs,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,d.y)(t,(0,m.E)((0,Ye.g)(n)))}}},gn={kernelName:s.iuW,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,u.l)((0,y.j)((0,p.d)(1),(0,m.E)(n)),t)}}},mn={kernelName:s.FAs,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{reps:i}=n;return{x:()=>{let e=(0,A.P)(r);if(1===r.rank)for(let n=0;n<i[0];++n)e=(0,N.W)(e,(0,he.d)(t,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(let n=0;n<i[0];++n)for(let a=0;a<i[1];++a)e=(0,N.W)(e,(0,he.d)(t,[n*r.shape[0],a*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(let n=0;n<i[0];++n)for(let a=0;a<i[1];++a)for(let o=0;o<i[2];++o)e=(0,N.W)(e,(0,he.d)(t,[n*r.shape[0],a*r.shape[1],o*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(r.rank," tensors yet."));for(let n=0;n<i[0];++n)for(let a=0;a<i[1];++a)for(let o=0;o<i[2];++o)for(let s=0;s<i[3];++s)e=(0,N.W)(e,(0,he.d)(t,[n*r.shape[0],a*r.shape[1],o*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return e}}}},yn={kernelName:s.wx0,gradFunc:(t,e,n)=>{const r=n,{perm:i}=r,a=mt.gx(i);return{x:()=>(0,vt.m)(t,a)}}},vn={kernelName:s.dXR,gradFunc:(t,e,n)=>{const r=n,{axis:i}=r;return{value:()=>(0,Rt.t)(t,i)}}};var bn=n(70816),xn=n(50511),wn=n(98104);const kn={kernelName:s.pPe,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>function(t,e){const n=(0,wn.P)(e,(0,A.P)(e)),r=(0,xn.k)(t,n);let i=(0,$.D)(e,(0,p.d)(0,"int32"));const a=r.rank-i.rank;for(let s=0;s<a;++s)i=(0,bn.U)(i,s+1);i=(0,Q.n)(i,(0,se.S)(r.shape,"bool"));const o=(0,A.P)(r);return(0,J._)(i,r,o)}(t,n)}}};const _n={kernelName:s.xJ3,gradFunc:t=>({x:()=>(0,A.P)(t)})};var Sn=n(46780);const An=[h,v,b,_,S,C,E,T,D,F,I,M,j,W,q,H,Y,X,K,tt,et,rt,ct,ot,ht,ft,gt,bt,kt,_t,De,St,Ct,Et,Tt,Nt,Ft,Dt,Ot,Bt,jt,Ut,Wt,Vt,qt,Ht,Yt,Xt,Kt,Zt,te,te,ne,ie,oe,ce,ue,le,de,pe,ge,me,ve,be,we,ke,ke,Ae,Ce,Ne,Fe,Ie,Me,Oe,Re,ze,Le,Pe,je,We,qe,Ge,He,Xe,$e,Je,tn,nn,an,an,sn,sn,cn,ln,un,hn,dn,fn,pn,gn,mn,yn,vn,kn,_n];for(const n of An)(0,Sn.kr)(n);n(58914);class Cn extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Cn.prototype)}}class En extends Error{constructor(t){super(t),Object.setPrototypeOf(this,En.prototype)}}class Tn extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Tn.prototype)}}class Nn extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Nn.prototype)}}class Dn extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Dn.prototype)}}Error;class Fn{constructor(t){this.maxEntries=t||100,this.cache=new Map}get(t){let e;return this.cache.has(t)&&(e=this.cache.get(t),this.cache.delete(t),this.cache.set(t,e)),e}put(t,e){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxEntries){const t=this.cache.keys().next().value;this.cache.delete(t)}this.cache.set(t,e)}getMaxEntries(){return this.maxEntries}setMaxEntries(t){if(t<0)throw new Error("The maxEntries of LRU caches must be at least 0, but got ".concat(t,"."));if(this.maxEntries>t)for(let e=0;e<this.maxEntries-t;e++){const t=this.cache.keys().next().value;this.cache.delete(t)}this.maxEntries=t}}function In(t,e){if(Array.isArray(t)){let n=[];for(let r=0;r<e;r++)n=n.concat(t);return n}{const n=new Array(e);return n.fill(t),n}}function Mn(t,e){if(!t)throw new Dn(e)}function On(t,e){let n=0;for(const r of t)r===e&&n++;return n}function Rn(t){return 1===t.length?t[0]:t}function zn(t){return Array.isArray(t)?t:[t]}function Bn(t){const e=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==e[0]?e:"private"+e}function Ln(t){return t.length<=1||-1===t.indexOf("_")?t:t.replace(/[_]+(\w|$)/g,((t,e)=>e.toUpperCase()))}let Pn={};function jn(t){if(null===t||void 0===t)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function Un(t){if(null!=t&&"object"===typeof t)if(Array.isArray(t))t.forEach((t=>Un(t)));else{const e=Object.keys(t);for(const n of e){const e=t[n];null!=e&&"object"===typeof e&&(Array.isArray(e)||"ndarray"!==e.type||"number"!==typeof e.value?Un(e):t[n]=e.value)}}}function Wn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"===typeof t){const i=t;let a;if(i in n)a=n[i];else if(i in Pn)a=Pn[i];else if(a=e[i],null==a)throw new Tn("Unknown ".concat(r,": ").concat(t,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return a}{const a=t;if(null==a.className||null==a.config)throw new Tn("".concat(r,": Improper config format: ")+"".concat(JSON.stringify(a),".\n")+"'className' and 'config' must set.");const o=a.className;let s,c;if(o in n?[s,c]=n[o]:o in Pn?[s,c]=Pn.className:o in e&&([s,c]=e[o]),null==s)throw new Tn("Unknown ".concat(r,": ").concat(o,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(null!=c){const t={};for(const n of Object.keys(Pn))t[n]=Pn[n];for(const i of Object.keys(n))t[i]=n[i];a.config.customObjects=t;const e=Object.assign({},Pn);for(const i of Object.keys(n))Pn[i]=n[i];Un(a.config);const r=c(s,a.config,n,i);return Pn=Object.assign({},e),r}{const t=Object.assign({},Pn);for(const r of Object.keys(n))Pn[r]=n[r];const e=new s(a.config);return Pn=Object.assign({},t),e}}}function Vn(t,e){return-1*function(t,e){return t<e?-1:t>e?1:0}(t,e)}function qn(t){if(null==t)return t;const e=[];for(const n of t)-1===e.indexOf(n)&&e.push(n);return e}function Gn(t){if(null==t)throw new Tn("Invalid value in obj: ".concat(JSON.stringify(t)));for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function Hn(t,e,n){if(null!=n&&t.indexOf(n)<0)throw new Tn("".concat(n," is not a valid ").concat(e,".  Valid values are ").concat(t," or null/undefined."))}function Yn(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return Mn(n>=0),Mn(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every((t=>typeof t===e))}function Xn(t,e){Array.isArray(t)?(o.util.assert(t.length>0,(()=>"".concat(e," is unexpectedly an empty array."))),t.forEach(((t,n)=>Xn(t,"element ".concat(n+1," of ").concat(e))))):o.util.assert(Number.isInteger(t)&&t>0,(()=>"Expected ".concat(e," to be a positive integer, but got ")+"".concat(Kn(t),".")))}function Kn(t){return null===t?"null":Array.isArray(t)?"["+t.map((t=>Kn(t))).join(",")+"]":"string"===typeof t?'"'.concat(t,'"'):"".concat(t)}function $n(t){return"relu"===t?"relu":"linear"===t?"linear":"elu"===t?"elu":null}let Zn=0;function Qn(){return Zn++}const Jn={};function tr(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t in Jn||(Jn[t]=0),Jn[t]+=1,t+Jn[t].toString()}const er=["channelsFirst","channelsLast"],nr=["nearest","bilinear"],rr=["valid","same","causal"],ir=["max","avg"],ar=["sum","mul","concat","ave"],or=new Map;function sr(t){Hn(er,"DataFormat",t)}function cr(t){Hn(rr,"PaddingMode",t)}function ur(t){Hn(ir,"PoolMode",t)}const lr=[],hr="/";function dr(t,e){lr.push(t);try{const t=e();return lr.pop(),t}catch(n){throw lr.pop(),n}}function fr(t){if(!mr(t))throw new Error("Not a valid tensor name: '"+t+"'");return(0===lr.length?"":lr.join(hr)+hr)+t}function pr(t){if(!mr(t))throw new Error("Not a valid tensor name: '"+t+"'");or.has(t)||or.set(t,0);const e=or.get(t);if(or.set(t,or.get(t)+1),e>0){const n="".concat(t,"_").concat(e);return or.set(n,1),n}return t}const gr=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function mr(t){return!!t.match(gr)}function yr(t,e,n){null==e&&(e=0),null==n&&(n=t.length);let r=1;for(let i=e;i<n;++i)r*=t[i];return r}function vr(t){if(0===t.length)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r<e&&(e=r)}return e}function br(t){if(0===t.length)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r>e&&(e=r)}return e}function xr(t,e){if(e<t)throw new Tn("end (".concat(e,") < begin (").concat(t,") is forbidden."));const n=[];for(let r=t;r<e;++r)n.push(r);return n}let wr;function kr(){return null==wr&&(wr=(0,o.backend)().epsilon()),wr}function _r(t,e){return o.cast(t,e)}function Sr(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),o.reshape(t,n)}function Ar(t,e,n){return(0,o.tidy)((()=>{switch(t.rank){case 1:return o.slice1d(t,e,n);case 2:return o.slice2d(t,[e,0],[n,t.shape[1]]);case 3:return o.slice3d(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return o.slice4d(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return o.slice(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return o.slice(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new Tn("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(t.rank))}}))}function Cr(t,e,n){return(0,o.tidy)((()=>{switch(t.rank){case 1:return o.slice1d(t,e,n);case 2:return o.slice2d(t,[0,e],[t.shape[0],n]);case 3:return o.slice3d(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return o.slice4d(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new Tn("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(t.rank))}}))}function Er(t,e,n,r){return(0,o.tidy)((()=>{switch(t.rank){case 1:return o.slice1d(t,e,n);case 2:switch(r){case 1:return Ar(t,e,n);case 2:return Cr(t,e,n);default:throw new Tn("The axis is not within the rank of the tensor "+"".concat(r))}case 3:switch(r){case 1:return Ar(t,e,n);case 2:return o.slice3d(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return Cr(t,e,n);default:throw new Tn("The axis is not within the rank of the tensor "+"".concat(r))}case 4:switch(r){case 1:return Ar(t,e,n);case 2:return o.slice4d(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return o.slice4d(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return Cr(t,e,n);default:throw new Tn("The axis is not within the rank of the tensor "+"".concat(r))}default:throw new Tn("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(t.rank))}}))}function Tr(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(e=t[0].rank,n=0!==e?e:0),n===t[0].rank&&(n=-1),o.concat(t,n)}function Nr(t,e){switch(t.rank){case 1:return o.concat1d([t,e]);case 2:return o.concat2d([t,e],0);case 3:return o.concat3d([t,e],0);case 4:return o.concat4d([t,e],0);default:throw new Tn("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(t.rank))}}function Dr(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new Tn("The length of input n (".concat(e.length,") does not match ")+"the number of dimensions in input x (".concat(t.rank,")"));return o.tile(t,e)}function Fr(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;return o.randomNormal(t,e,n,r,i)}function Ir(t,e,n,r){if(t.rank<2||e.rank<2)throw new Nn("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(t.shape," and y shape = ").concat(e.shape));if(e.rank>=3){if(t.shape.slice(-1)[0]!==e.shape.slice(-2)[0])throw new Nn("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(t.shape," and ")+" y shape = ".concat(e.shape))}if(2===t.rank&&2===e.rank){const i=!1,a=!1;return o.fused.matMul({a:t,b:e,transposeA:i,transposeB:a,bias:r?Rr(t.rank,r,"channelsLast"):null,activation:n})}{const i=t.shape.slice(),a=i.pop();t=o.reshape(t,[-1,a]);const s=e.shape.slice(),c=s.pop(),u=s.pop(),l=[...s,c],h=Array.from({length:e.rank},((t,n)=>0===n?e.rank-2:n<=e.rank-2?n-1:n));e=o.reshape(o.transpose(e,h),[u,-1]);const d=[...i,...l],f=!1,p=!1;return o.reshape(o.fused.matMul({a:t,b:e,transposeA:f,transposeB:p,bias:r?Rr(t.rank,r,"channelsLast"):null,activation:n}),d)}}function Mr(t,e,n){return(0,o.tidy)((()=>(e=Array.isArray(e)?(0,o.tensor1d)(e,"int32"):o.cast(e,"int32"),o.gather(t,e,n))))}function Or(t){return o.mul(t,t)}function Rr(t,e,n){const r=e.shape;if(1!==e.rank&&e.rank!==t)throw new Tn("Unexpected bias dimensions: ".concat(e.rank)+"; expected it to be 1 or ".concat(t));if(5===t){if("channelsFirst"===n)return 1===r.length?o.reshape(e,[1,r[0],1,1,1]):o.reshape(e,[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?o.reshape(e,[1,1,1,1,r[0]]):o.reshape(e,[1].concat(r))}else if(4===t){if("channelsFirst"===n)return 1===r.length?o.reshape(e,[1,r[0],1,1]):o.reshape(e,[1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?o.reshape(e,[1,1,1,r[0]]):o.reshape(e,[1].concat(r))}else if(3===t){if("channelsFirst"===n)return 1===r.length?o.reshape(e,[1,r[0],1]):o.reshape(e,[1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?o.reshape(e,[1,1,r[0]]):o.reshape(e,[1].concat(r))}else if(t<3)return e;throw new Tn("Unsupported input rank by biasAdd: ".concat(e.rank))}function zr(t,e,n){return(0,o.tidy)((()=>(null==n&&(n="channelsLast"),sr(n),o.add(t,Rr(t.rank,e,n)))))}function Br(t,e,n,r){return(0,o.tidy)((()=>o.dropout(t,e,n,r)))}function Lr(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?t():e()}const Pr=["fanIn","fanOut","fanAvg"],jr=["normal","uniform","truncatedNormal"];class Ur extends o.serialization.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class Wr extends Ur{apply(t,e){return(0,o.zeros)(t,e)}}Wr.className="Zeros",o.serialization.registerClass(Wr);class Vr extends Ur{apply(t,e){return(0,o.ones)(t,e)}}Vr.className="Ones",o.serialization.registerClass(Vr);class qr extends Ur{constructor(t){if(super(),"object"!==typeof t)throw new Tn("Expected argument of type ConstantConfig but got ".concat(t));if(void 0===t.value)throw new Tn("config must have value set but got ".concat(t));this.value=t.value}apply(t,e){return(0,o.tidy)((()=>(0,o.mul)((0,o.scalar)(this.value),(0,o.ones)(t,e))))}getConfig(){return{value:this.value}}}qr.className="Constant",o.serialization.registerClass(qr);class Gr extends Ur{constructor(t){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,e){return(0,o.randomUniform)(t,this.minval,this.maxval,e,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}Gr.className="RandomUniform",o.serialization.registerClass(Gr);class Hr extends Ur{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new Nn("randomNormal does not support dType ".concat(e,"."));return Fr(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}Hr.className="RandomNormal",o.serialization.registerClass(Hr);class Yr extends Ur{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new Nn("truncatedNormal does not support dType ".concat(e,"."));return(0,o.truncatedNormal)(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}Yr.className="TruncatedNormal",o.serialization.registerClass(Yr);class Xr extends Ur{constructor(t){super(),this.gain=null!=t.gain?t.gain:1}apply(t,e){return(0,o.tidy)((()=>{if(2!==t.length||t[0]!==t[1])throw new Tn("Identity matrix initializer can only be used for 2D square matrices.");return(0,o.mul)(this.gain,(0,o.eye)(t[0]))}))}getConfig(){return{gain:this.gain}}}Xr.className="Identity",o.serialization.registerClass(Xr);class Kr extends Ur{constructor(t){if(super(),t.scale<0)throw new Tn("scale must be a positive float. Got: ".concat(t.scale));var e;this.scale=null==t.scale?1:t.scale,this.mode=null==t.mode?"fanIn":t.mode,e=this.mode,Hn(Pr,"FanMode",e),this.distribution=null==t.distribution?"normal":t.distribution,function(t){Hn(jr,"Distribution",t)}(this.distribution),this.seed=t.seed}apply(t,e){const n=function(t){let e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(sr(r),2===t.length)e=t[0],n=t[1];else if(-1!==[3,4,5].indexOf(t.length)){if("channelsFirst"===r){const r=yr(t,2);e=t[1]*r,n=t[0]*r}else if("channelsLast"===r){const r=yr(t,0,t.length-2);e=t[t.length-2]*r,n=t[t.length-1]*r}}else{const r=yr(t);e=Math.sqrt(r),n=Math.sqrt(r)}return[e,n]}(t),r=n[0],i=n[1];let a=this.scale;if("fanIn"===this.mode?a/=Math.max(1,r):"fanOut"===this.mode?a/=Math.max(1,i):a/=Math.max(1,(r+i)/2),"normal"===this.distribution){const n=Math.sqrt(a);if("float32"!==(e=e||"float32")&&"int32"!==e)throw new Nn("".concat(this.getClassName()," does not support dType ").concat(e,"."));return(0,o.truncatedNormal)(t,0,n,e,this.seed)}{const n=Math.sqrt(3*a);return(0,o.randomUniform)(t,-n,n,e,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Kr.className="VarianceScaling",o.serialization.registerClass(Kr);class $r extends Kr{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return Kr.className}}$r.className="GlorotUniform",o.serialization.registerClass($r);class Zr extends Kr{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return Kr.className}}Zr.className="GlorotNormal",o.serialization.registerClass(Zr);class Qr extends Kr{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return Kr.className}}Qr.className="HeNormal",o.serialization.registerClass(Qr);class Jr extends Kr{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return Kr.className}}Jr.className="HeUniform",o.serialization.registerClass(Jr);class ti extends Kr{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return Kr.className}}ti.className="LeCunNormal",o.serialization.registerClass(ti);class ei extends Kr{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return Kr.className}}ei.className="LeCunUniform",o.serialization.registerClass(ei);class ni extends Ur{constructor(t){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=null==t.gain?this.DEFAULT_GAIN:t.gain,this.seed=t.seed}apply(t,e){return(0,o.tidy)((()=>{if(t.length<2)throw new Nn("Shape must be at least 2D.");if("int32"!==e&&"float32"!==e&&void 0!==e)throw new TypeError("Unsupported data type ".concat(e,"."));const n=o.util.sizeFromShape(t.slice(0,-1)),r=t[t.length-1],i=n*r;i>this.ELEMENTS_WARN_SLOW&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than ".concat(this.ELEMENTS_WARN_SLOW," (").concat(i,") elements: ")+"Slowness may result.");const a=Fr([Math.max(r,n),Math.min(r,n)],0,1,e,this.seed),s=o.linalg.qr(a,!1);let c=s[0];const u=s[1].flatten().stridedSlice([0],[Math.min(r,n)*Math.min(r,n)],[Math.min(r,n)+1]);return c=(0,o.mul)(c,u.sign()),n<r&&(c=c.transpose()),(0,o.mul)((0,o.scalar)(this.gain),c.reshape(t))}))}getConfig(){return{gain:this.gain,seed:this.seed}}}ni.className="Orthogonal",o.serialization.registerClass(ni);const ri={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function ii(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Wn(t,o.serialization.SerializationMap.getMap().classNameMap,e,"initializer")}function ai(t){return jn(t)}function oi(t){if("string"===typeof t){const e=t in ri?ri[t]:t;if("GlorotNormal"===e)return new Zr;if("GlorotUniform"===e)return new $r;if("HeNormal"===e)return new Qr;if("HeUniform"===e)return new Jr;if("LeCunNormal"===e)return new ti;if("LeCunUniform"===e)return new ei;{const t={};return t.className=e,t.config={},ii(t)}}return t instanceof Ur?t:ii(t)}function si(t){return Array.isArray(t)&&Array.isArray(t[0])}function ci(t){return 0===t.length?[]:Array.isArray(t[0])?t:[t]}function ui(t){let e;if(Array.isArray(t)){if(1!==t.length)throw new Tn("Expected Tensor length to be 1; got ".concat(t.length));e=t[0]}else e=t;return e}function li(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(1===t.length)return t[0];throw new Tn("Expected exactly 1 Shape; got ".concat(t.length))}return t}function hi(t){let e=0;for(const n of t)0===n.shape.length?e+=1:e+=n.shape.reduce(((t,e)=>t*e));return e}const di="Variable";class fi{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:di,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.dtype=null==e?"float32":e,this.shape=t.shape,this.id=Qn(),n=null==n?di:n,this.originalName=fr(n),this.name=pr(this.originalName),this.trainable_=r,this.constraint=i,this.val=o.variable(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),function(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}(this.val,t),this.val.id!==t.id&&(this.val.assign(t),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function pi(t){return t.map((t=>t.read()))}function gi(t){t.forEach((t=>{t[0].write(t[1])}))}class mi{constructor(t){this.dtype=t.dtype,this.shape=t.shape,null!=t.shape?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class yi{constructor(t,e,n,r,i,a,o){this.dtype=t,this.shape=e,this.sourceLayer=n,this.inputs=r,this.callArgs=i,this.outputTensorIndex=o,this.id=Qn(),null!=a&&(this.originalName=fr(a),this.name=pr(this.originalName)),this.rank=e.length}}let vi=0;class bi{constructor(t,e){this.callArgs=e,this.id=vi++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const n of t.inboundLayers)null!=n&&n.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const e of this.inboundLayers)null!=e?t.push(e.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let xi=0;class wi extends o.serialization.Serializable{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=xi++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let e=t.name;if(!e){const t=this.getClassName();e=Bn(t)+"_"+tr(t)}if(this.name=e,this.trainable_=null==t.trainable||t.trainable,null!=t.inputShape||null!=t.batchInputShape){let e;if(null!=t.batchInputShape)e=t.batchInputShape;else if(null!=t.inputShape){let n=null;null!=t.batchSize&&(n=t.batchSize),e=[n].concat(t.inputShape)}this.batchInputShape=e;let n=t.dtype;null==n&&(n=t.inputDType),null==n&&(n="float32"),this.dtype=n}null!=t.weights?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,e){return t.name+"_ib-"+e.toString()}getNodeAtIndex(t,e){if(0===this.inboundNodes.length)throw new En("The layer has never been called "+"and thus has no defined ".concat(e,"."));if(this.inboundNodes.length<=t)throw new Tn("Asked to get ".concat(e," at node ").concat(t,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[t]}getInputAt(t){return Rn(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return Rn(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Cn("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new Cn("Layer ".concat(this.name)+" is not connected, no input to return.");return Rn(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new Cn("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new Cn("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return Rn(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map((t=>t()))}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach((e=>e.trainable=t)),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter((t=>t.trainable)):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter((t=>!t.trainable)).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){const e=zn(t);if(null==this.inputSpec||0===this.inputSpec.length)return;const n=zn(this.inputSpec);if(e.length!==n.length)throw new Tn("Layer ".concat(this.name," expects ").concat(n.length," inputs, ")+"but it received ".concat(e.length," input tensors. ")+"Input received: ".concat(t));for(let r=0;r<e.length;r++){const t=e[r],i=n[r];if(null==i)continue;const a=t.rank;if(null!=i.ndim&&a!==i.ndim)throw new Tn("Input ".concat(r," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(i.ndim,", found ndim=").concat(a));if(null!=i.maxNDim&&a>i.maxNDim)throw new Tn("Input ".concat(r," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(i.maxNDim,", found ndim=").concat(a));if(null!=i.minNDim&&a<i.minNDim)throw new Tn("Input ".concat(r," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(i.minNDim,", found ndim=").concat(a,"."));if(null!=i.dtype&&t.dtype!==i.dtype)throw new Tn("Input ".concat(r," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(i.dtype,", found dtype=").concat(t.dtype,"."));if(i.axes){const e=t.shape;for(const t in i.axes){const n=Number(t),a=i.axes[t],o=n>=0?e[n]:e[e.length+n];if(null!=a&&-1===[a,null].indexOf(o))throw new Tn("Input ".concat(r," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(n," of input shape to ")+"have value ".concat(a," but got shape ").concat(e,"."))}}if(null!=i.shape)for(let e=0;e<i.shape.length;++e){const n=i.shape[e],a=t.shape[e];if(null!=n&&null!=a&&n!==a)throw new Tn("Input ".concat(r," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(i.shape,", ")+"found shape=".concat(t.shape,"."))}}}call(t,e){return t}invokeCallHook(t,e){null!=this._callHook&&this._callHook(t,e)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,e){e=e||{},this.assertNotDisposed();const n=zn(t),r=function(t){let e=!0;for(const n of zn(t))if(!(n instanceof yi)){e=!1;break}return e}(t),i=function(t){let e=!0;for(const n of zn(t))if(n instanceof yi){e=!1;break}return e}(t);if(r===i)throw new Tn("Arguments to apply() must be all SymbolicTensors or all Tensors");return dr(this.name,(()=>{if(!this.built){this.assertInputCompatibility(t);const e=[];for(const n of zn(t))e.push(n.shape);this.build(Rn(e)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&i&&(this._refCount=1)}if(this.assertInputCompatibility(t),i){let r=this.call(t,e);this.supportsMasking&&this.setMaskMetadata(t,r);const i=zn(r),a=[];for(let t of i)-1!==n.indexOf(t)&&(t=t.clone()),a.push(t);if(r=Rn(a),null!=this.activityRegularizer)throw new Nn("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return r}{const n=function(t){t=zn(t);const e=[];for(const n of t)e.push(n.shape);return Rn(e)}(t),r=this.computeOutputShape(n);let i;const a="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(t)?n[0]:n),i=null!=r&&r.length>0&&Array.isArray(r[0])?r.map(((n,r)=>new yi(a,n,this,zn(t),e,this.name,r))):new yi(a,r,this,zn(t),e,this.name),this.addInboundNode(t,i,null,null,n,r,e),this._refCount++,null!=this.activityRegularizer)throw new Nn("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}}))}warnOnIncompatibleInputShape(t){if(null!=this.batchInputShape)if(t.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(t),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{let e=!1;this.batchInputShape.forEach(((n,r)=>{null!=n&&null!=t[r]&&t[r]!==n&&(e=!0)})),e&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(t),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new Cn("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");const t=[];for(const e of this.inboundNodes){const n=JSON.stringify(e.outputShapes);-1===t.indexOf(n)&&t.push(n)}if(1===t.length){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&1===t.length?t[0]:t}throw new Cn("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "output shape" is ill-defined for the layer.')}countParams(){if(!this.built)throw new En("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return hi(this.weights)}build(t){this.built=!0}getWeights(){return pi(arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.trainableWeights:this.weights)}setWeights(t){(0,o.tidy)((()=>{const e=this.weights;if(e.length!==t.length)throw new Tn('You called setWeights(weights) on layer "'.concat(this.name,'" ')+"with a weight list of length ".concat(t.length,", ")+"but the layer was expecting ".concat(e.length," weights. ")+"Provided weights: ".concat(t,"..."));if(0===e.length)return;const n=[],r=pi(e);for(let i=0;i<r.length;++i){const a=r[i],s=e[i],c=t[i];if(!o.util.arraysEqual(a.shape,c.shape))throw new Tn("Layer weight shape ".concat(a.shape," ")+"not compatible with provided weight shape ".concat(c.shape));n.push([s,c])}gi(n)}))}addWeight(t,e,n,r,i,a,o,s){if(-1!==this._addedWeightNames.indexOf(t))throw new Tn("Duplicate weight name ".concat(t," for layer ").concat(this.name));this._addedWeightNames.push(t),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=null!=s?s():oi("zeros"));const c=r.apply(e,n),u=new fi(c,n,t,a,o);return c.dispose(),null!=i&&this.addLoss((()=>i.apply(u.read()))),null==a&&(a=!0),a?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){null==t||Array.isArray(t)&&0===t.length||(t=zn(t),void 0!==this._losses&&null!==this._losses&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,e){if(!this.supportsMasking){if(null!=e){if(!Array.isArray(e))throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");e.forEach((t=>{if(null!=t)throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.")}))}return null}return e}setMaskMetadata(t,e,n){if(!this.supportsMasking)return;const r=this.computeMask(t,n),i=zn(e),a=zn(r);if(i.length!==a.length)throw new Error("".concat(this.name," outputs ").concat(i.length," tensors ")+"but ".concat(i.length," masks for those tensors"));for(let o=0;o<i.length;o++)i[o].kerasMask=a[o]}addInboundNode(t,e,n,r,i,a){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;const s=zn(t);e=zn(e),n=zn(n),r=zn(r),i=ci(i),a=ci(a);const c=[],u=[],l=[];for(const h of s)c.push(h.sourceLayer),u.push(h.nodeIndex),l.push(h.tensorIndex);new bi({outboundLayer:this,inboundLayers:c,nodeIndices:u,tensorIndices:l,inputTensors:s,outputTensors:e,inputMasks:n,outputMasks:r,inputShapes:i,outputShapes:a},o);for(let h=0;h<e.length;h++)e[h].sourceLayer=this,e[h].nodeIndex=this.inboundNodes.length-1,e[h].tensorIndex=h}getConfig(){const t={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(t.batchInputShape=this.batchInputShape),null!=this.dtype&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach((t=>t.dispose())),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}dispose(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();let t=0;return 0===--this._refCount&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function ki(t,e,n){if((null==e||null!=n&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),0===e.inboundNodes.length)return[t];{const t=e.inboundNodes[n];if(0===t.inboundLayers.length)return t.inputTensors;{const e=[];for(let n=0;n<t.inboundLayers.length;n++){const r=ki(t.inputTensors[n],t.inboundLayers[n],t.nodeIndices[n]);for(const t of r)-1===e.indexOf(t)&&e.push(t)}return e}}}class _i extends wi{constructor(t){if(super({dtype:t.dtype,name:null!=t.name?t.name:tr("input").toString()}),null==t.batchSize&&(t.batchSize=null),null==t.sparse&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,null!=t.inputShape&&null!=t.batchInputShape)throw new Tn("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let e=t.batchInputShape;if(null==e){if(null==t.inputShape)throw new Tn("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");e=[t.batchSize].concat(t.inputShape)}else if(null!=t.batchSize)throw new Tn("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const n=t.dtype||"float32";this.batchInputShape=e,this.dtype=n,this.inputSpec=[{shape:e}];const r=new yi(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new bi({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[e],outputShapes:[e]})}apply(t,e){throw new Tn("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}function Si(t){if(null==t.batchShape&&null==t.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=t.batchShape&&null!=t.shape)throw new Tn("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;null!=t.shape&&null==e&&(e=[null].concat(t.shape));let n=t.dtype;null==n&&(n="float32");return new _i({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}_i.className="InputLayer",o.serialization.registerClass(_i);class Ai{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof Ai)for(const e in t.id2Value)this.id2Value[e]=t.id2Value[e],e in t.id2Mask&&(this.id2Mask[e]=t.id2Mask[e]);else{if(null==t)return;for(const e of t)this.add(e.key,e.value)}}add(t,e,n){if(null!=this.id2Value[t.id])throw new Tn("Duplicate key: name=".concat(t.name,", id=").concat(t.id));return this.id2Value[t.id]=function(t,e){if(null==t.dtype||t.dtype===e.dtype)return e;try{return(0,o.cast)(e,t.dtype)}catch(n){throw new Tn("The dtype of the feed (".concat(e.dtype,") can not be cast to the dtype ")+"of the key '".concat(t.name,"' (").concat(t.dtype,")."))}}(t,e),this.name2Id[t.name]=t.id,null!=n&&(this.id2Mask[t.id]=n),this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return null!=this.id2Value[t.id]}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof yi){if(null==this.id2Value[t.id])throw new Tn("Nonexistent key: ".concat(t.name));return this.id2Value[t.id]}{const e=this.name2Id[t];if(null==e)throw new Tn("Feed dict has no SymbolicTensor name: ".concat(t));return this.id2Value[e]}}getMask(t){if(t instanceof yi){if(null==this.id2Value[t.id])throw new Tn("Nonexistent key: ".concat(t.name));return this.id2Mask[t.id]}{const e=this.name2Id[t];if(null==e)throw new Tn("Feed dict has no SymbolicTensor name: ".concat(t));return this.id2Mask[e]}}disposeMasks(){null!=this.id2Mask&&(0,o.dispose)(this.id2Mask)}}const Ci=new Fn,Ei=new Fn;function Ti(t,e,n,r){const i=null!=n&&n.training,a=Array.isArray(t),s=a?t:[t],c=s.map((t=>t.name)),u=[],l=e.names();for(const o of c)-1!==l.indexOf(o)?u.push(e.getValue(o)):u.push(null);null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);const h=c.join(",")+"|"+e.names().sort().join(",");let d,f=Ci.get(h);if(null==f){const t=function(t,e){o.util.assert(null!=t&&t.length>0,(()=>"Expected at least one fetch, got none"));let n=[],r={};if(1===t.length){const i=Di(t[0],e);n=i.sorted,r=i.recipientMap}else{const i=new Set;for(const a of t){const{sorted:t,recipientMap:o}=Di(a,e);for(const e of t)i.has(e.name)||(n.push(e),i.add(e.name));for(const e in o)null==r[e]&&(r[e]=new Set),o[e].forEach((t=>r[e].add(t)))}}return{sorted:n,recipientCounts:Ni(r)}}(s,e);f=t.sorted,d=t.recipientCounts,Ci.put(h,f),Ei.put(h,d)}d={},i||Object.assign(d,Ei.get(h));const p=new Ai(e);for(let g=0;g<f.length;++g){if(null!=r){const t=(0,o.memory)().numTensors;t>r.maxNumTensors&&(r.maxNumTensors=t),t<r.minNumTensors&&(r.minNumTensors=t)}const t=f[g],a=t.sourceLayer;if(a instanceof _i)continue;const s=[],l=[],h=[];let m=!1;for(const n of t.inputs){const t=p.getValue(n),r=p.getMask(n);s.push(t),l.push(r),null!=r&&(m=!0),i||(d[n.name]--,0!==d[n.name]||e.hasKey(n)||-1!==c.indexOf(n.name)||t.isDisposed||!0===n.sourceLayer.stateful||h.push(t))}m&&((n=n||{}).mask=l[0]);const y=zn(a.apply(s,n));let v=null;a.supportsMasking&&(v=a.computeMask(s,l));const b=Fi(t),x=Array.isArray(b)?b:[b];for(let e=0;e<x.length;++e){p.hasKey(x[e])||p.add(x[e],y[e],Array.isArray(v)?v[0]:v);const t=c.indexOf(x[e].name);-1!==t&&(u[t]=y[e])}i||(0,o.dispose)(h)}return p.disposeMasks(),a?u:u[0]}function Ni(t){const e={};for(const n in t)e[n]=t[n].size;return e}function Di(t,e){const n=new Set,r=[],i={};for(const s of e.names())n.add(s);const a=[],o=[];for(a.push(t);a.length>0;){const t=a[a.length-1];if(n.has(t.name)){a.pop();continue}const e=o[o.length-1]===a.length-1;if(0===t.inputs.length||e)a.pop(),r.push(t),n.add(t.name),e&&o.pop();else{o.push(a.length-1);for(const e of t.inputs)null==i[e.name]&&(i[e.name]=new Set),i[e.name].add(t.name),n.has(e.name)||a.push(e)}}return{sorted:r,recipientMap:i}}function Fi(t){let e;if(1===t.sourceLayer.inboundNodes.length)e=t.sourceLayer.output;else{let n=null;for(let e=0;e<t.sourceLayer.inboundNodes.length;++e)for(const r of t.sourceLayer.inboundNodes[e].outputTensors)if(r.id===t.id){n=e;break}e=t.sourceLayer.getOutputAt(n)}return e}function Ii(t,e){return(0,o.tidy)((()=>o.sqrt(o.sum(o.mul(t,t),e,!0))))}(0,o.env)().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",(()=>100),(function(t){null!=Ci&&Ci.setMaxEntries(t),null!=Ei&&Ei.setMaxEntries(t)}));class Mi extends o.serialization.Serializable{getConfig(){return{}}}class Oi extends Mi{constructor(t){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return(0,o.tidy)((()=>{const e=Ii(t,this.axis),n=o.clipByValue(e,0,this.maxValue);return o.mul(t,o.div(n,o.add(kr(),e)))}))}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}Oi.className="MaxNorm",o.serialization.registerClass(Oi);class Ri extends Mi{constructor(t){super(),this.defaultAxis=0,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return(0,o.tidy)((()=>o.div(t,o.add(kr(),Ii(t,this.axis)))))}getConfig(){return{axis:this.axis}}}Ri.className="UnitNorm",o.serialization.registerClass(Ri);class zi extends Mi{apply(t){return o.relu(t)}}zi.className="NonNeg",o.serialization.registerClass(zi);class Bi extends Mi{constructor(t){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=t.minValue?t.minValue:this.defaultMinValue,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.rate=null!=t.rate?t.rate:this.defaultRate,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return(0,o.tidy)((()=>{const e=Ii(t,this.axis),n=o.add(o.mul(this.rate,o.clipByValue(e,this.minValue,this.maxValue)),o.mul(1-this.rate,e));return o.mul(t,o.div(n,o.add(kr(),e)))}))}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}Bi.className="MinMaxNorm",o.serialization.registerClass(Bi);const Li={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Pi(t){return jn(t)}function ji(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Wn(t,o.serialization.SerializationMap.getMap().classNameMap,e,"constraint")}function Ui(t){if(null==t)return null;if("string"===typeof t){return ji({className:t in Li?Li[t]:t,config:{}})}return t instanceof Mi?t:ji(t)}async function Wi(t){if(null==t)return;const e=[],n=[],r=[];for(const i in t){const a=t[i];if("number"!==typeof a){const t=a;e.push(t.data()),n.push(i),r.push(t)}}if(e.length>0){const i=await Promise.all(e);for(let e=0;e<i.length;++e)t[n[e]]=i[e][0];(0,o.dispose)(r)}}function Vi(t){if(null!=t)for(const e in t){const n=t[e];"number"!==typeof n&&n.dispose()}}var qi;!function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"}(qi||(qi={}));class Gi{constructor(){this.validationData=null}setParams(t){this.params=t}async onEpochBegin(t,e){}async onEpochEnd(t,e){}async onBatchBegin(t,e){}async onBatchEnd(t,e){}async onTrainBegin(t){}async onTrainEnd(t){}setModel(t){}}class Hi{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;null==t&&(t=[]),this.callbacks=t,this.queueLength=e}append(t){this.callbacks.push(t)}setParams(t){for(const e of this.callbacks)e.setParams(t)}setModel(t){for(const e of this.callbacks)e.setModel(t)}async onEpochBegin(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onEpochBegin(t,e)}async onEpochEnd(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onEpochEnd(t,e)}async onBatchBegin(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onBatchBegin(t,e)}async onBatchEnd(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onBatchEnd(t,e)}async onTrainBegin(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainBegin(t)}async onTrainEnd(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainEnd(t)}}class Yi extends Gi{constructor(){super()}async onEpochBegin(t){this.seen=0,this.totals={}}async onBatchEnd(t,e){null==e&&(e={});const n=null==e.size?0:e.size;this.seen+=n;for(const r in e){const t=e[r];if("number"===typeof t)this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+t*n;else{let e;r in this.totals?e=this.totals[r]:this.totals[r]=0;const i=(0,o.tidy)((()=>(0,o.add)(this.totals[r],(0,o.mul)(t,n))));this.totals[r]=i,null!=e&&e.dispose()}}}async onEpochEnd(t,e){if(null!=e)for(const n of this.params.metrics)null!=this.totals[n]&&("number"===typeof this.totals[n]?e[n]=this.totals[n]/this.seen:(0,o.tidy)((()=>{const t=(0,o.mul)((0,o.div)(1,this.seen),this.totals[n]);e[n]=t,this.totals[n].dispose(),(0,o.keep)(e[n])})))}}class Xi extends Gi{async onTrainBegin(t){this.epoch=[],this.history={}}async onEpochEnd(t,e){null==e&&(e={}),this.epoch.push(t);for(const n in e)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(e[n])}async syncData(){const t=[],e=[],n=[];for(const i in this.history){const r=this.history[i];for(let a=0;a<r.length;++a)if("number"!==typeof r[a]){const o=r[a];t.push(o.data()),e.push(i),n.push(a)}}const r=await Promise.all(t);for(let i=0;i<r.length;++i){this.history[e[i]][n[i]].dispose(),this.history[e[i]][n[i]]=r[i][0]}}}class Ki extends Gi{constructor(t,e){if(super(),this.currentEpoch=0,this.nowFunc=t.nowFunc,this.nextFrameFunc=t.nextFrameFunc||o.nextFrame,this.yieldEvery=e||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=t.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");o.util.isNumber(this.yieldEvery)&&(this.maybeWait=function(t,e,n){let r,i=null!=n?n():o.util.now();return function(){const a=null!=n?n():o.util.now();return a-i<e||(i=a,r=t(...arguments)),r}}(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}async maybeWait(t,e,n){const r=[];null!=this.yield&&(await Wi(n),r.push(this.yield(t,e,n))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(t,e){this.currentEpoch=t,null!=this.epochBegin&&(await Wi(e),await this.epochBegin(t,e))}async onEpochEnd(t,e){const n=[];null!=this.epochEnd&&(await Wi(e),n.push(this.epochEnd(t,e))),"epoch"===this.yieldEvery&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(t,e){null!=this.batchBegin&&(await Wi(e),await this.batchBegin(t,e))}async onBatchEnd(t,e){const n=[];null!=this.batchEnd&&(await Wi(e),n.push(this.batchEnd(t,e))),"batch"===this.yieldEvery?n.push(this.nextFrameFunc()):o.util.isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,t,e)),await Promise.all(n)}async onTrainBegin(t){null!=this.trainBegin&&(await Wi(t),await this.trainBegin(t))}async onTrainEnd(t){null!=this.trainEnd&&(await Wi(t),await this.trainEnd(t))}}function $i(t,e){if(null==t&&(t={}),t instanceof Gi)return[t];if(Array.isArray(t)&&t[0]instanceof Gi)return t;return zn(t).map((t=>new Ki(t,e)))}class Zi{constructor(){}static registerCallbackConstructor(t,e){o.util.assert(t>=0&&Number.isInteger(t),(()=>"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(t))),Zi.checkForDuplicate(e),null==Zi.constructors[t]&&(Zi.constructors[t]=[]),Zi.constructors[t].push(e)}static checkForDuplicate(t){for(const e in Zi.constructors){Zi.constructors[+e].forEach((e=>{if(e===t)throw new Tn("Duplicate callback constructor.")}))}}static clear(){Zi.constructors={}}static createCallbacks(t){const e=[];for(const n in Zi.constructors){const r=+n;t>=r&&e.push(...Zi.constructors[r])}return e.map((t=>new t))}}function Qi(t,e,n,r,i,a,o,s,c){const u=new Xi,l=[new Yi,...Zi.createCallbacks(e)];null!=t&&l.push(...t),l.push(u);const h=new Hi(l);return h.setParams({epochs:n,initialEpoch:r,samples:i,steps:a,batchSize:o,verbose:e,doValidation:s,metrics:c}),{callbackList:h,history:u}}function Ji(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Wn(t,o.serialization.SerializationMap.getMap().classNameMap,e,"layer",n)}function ta(t,e){return(0,o.tidy)((()=>{"float32"!==t.dtype&&(t=o.cast(t,"float32"));const n=o.sum(Or(t),e,!0),r=o.fill(n.shape,kr()),i=o.sqrt(o.maximum(n,r));return o.div(t,i)}))}function ea(t,e){return(0,o.tidy)((()=>o.mean(Or(o.sub(e,t)),-1)))}function na(t,e){return(0,o.tidy)((()=>o.mean(o.abs(o.sub(e,t)),-1)))}function ra(t,e){return(0,o.tidy)((()=>{const n=o.sub(t,e),r=o.clipByValue(o.abs(t),kr(),Number.MAX_VALUE),i=o.abs(o.div(n,r));return o.mul(100,o.mean(i,-1))}))}function ia(t,e){return(0,o.tidy)((()=>{const n=o.clipByValue(e,kr(),Number.MAX_VALUE),r=o.log(o.add(1,n)),i=o.clipByValue(t,kr(),Number.MAX_VALUE),a=o.log(o.add(1,i));return o.mean(Or(o.sub(r,a)),-1)}))}function aa(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,o.tidy)((()=>{if(n)e=o.softmax(e);else{const t=o.sum(e,e.shape.length-1,!0);e=o.div(e,t)}return e=o.clipByValue(e,kr(),1-kr()),o.neg(o.sum(o.mul(o.cast(t,"float32"),o.log(e)),e.shape.length-1))}))}function oa(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,o.tidy)((()=>{const r=o.cast(o.floor(function(t){const e=[yr(t.shape)];return o.reshape(t,e)}(t)),"int32"),i=(e=o.clipByValue(e,kr(),1-kr())).shape;return aa(o.reshape(o.oneHot(r,i[i.length-1]),i),e,n)}))}function sa(t,e){return(0,o.tidy)((()=>{let n;return n=o.clipByValue(e,kr(),1-kr()),n=o.log(o.div(n,o.sub(1,n))),o.mean(function(t,e){if(!o.util.arraysEqual(t.shape,e.shape))throw new Tn("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(t.shape)," and ").concat(JSON.stringify(e.shape)));return(0,o.tidy)((()=>{const n=o.relu(e),r=o.neg(o.abs(e));return o.add(o.sub(n,o.mul(e,t)),o.log1p(o.exp(r)))}))}(t,n),-1)}))}function ca(t,e){return(0,o.tidy)((()=>{const n=o.clipByValue(t,kr(),1),r=o.clipByValue(e,kr(),1);return o.sum(o.mul(t,o.log(o.div(n,r))),-1)}))}function ua(t,e){return(0,o.tidy)((()=>{const n=ta(t,-1),r=ta(e,-1),i=o.mul(n,r);return o.neg(o.sum(i,-1))}))}Zi.constructors={};const la={meanSquaredError:ea,meanAbsoluteError:na,meanAbsolutePercentageError:ra,meanSquaredLogarithmicError:ia,squaredHinge:function(t,e){return(0,o.tidy)((()=>{const n=o.maximum(0,o.sub(1,o.mul(t,e)));return o.mean(Or(n),-1)}))},hinge:function(t,e){return(0,o.tidy)((()=>{const n=o.maximum(0,o.sub(1,o.mul(t,e)));return o.mean(n,-1)}))},categoricalHinge:function(t,e){return(0,o.tidy)((()=>{const n=o.sum(o.mul(t,e),-1),r=o.max(o.mul(o.sub(1,t),e),-1);return o.maximum(0,o.add(1,o.sub(r,n)))}))},logcosh:function(t,e){return(0,o.tidy)((()=>{const n=Math.log(2),r=o.sub(e,t),i=o.sub(o.add(r,o.softplus(o.mul(-2,r))),n);return o.mean(i,-1)}))},categoricalCrossentropy:aa,sparseCategoricalCrossentropy:oa,binaryCrossentropy:sa,kullbackLeiblerDivergence:ca,poisson:function(t,e){return(0,o.tidy)((()=>{const n=o.log(o.add(kr(),e));return o.mean(o.sub(e,o.mul(t,n)),-1)}))},cosineProximity:ua};function ha(t){if("string"===typeof t){if(t in la)return la[t];let e="Unknown loss ".concat(t);throw t.toLowerCase().includes("softmaxcrossentropy")&&(e="Unknown loss ".concat(t,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new Tn(e)}return t}function da(t,e){return(0,o.tidy)((()=>{const n=o.mul(.5,o.onesLike(e)),r=_r(o.greater(e,n),t.dtype);return o.mean(o.equal(t,r),-1)}))}function fa(t,e){return(0,o.tidy)((()=>_r(o.equal(o.argMax(t,-1),o.argMax(e,-1)),"float32")))}function pa(t,e){return(0,o.tidy)((()=>o.cast(o.sum(o.logicalAnd(o.equal(t,1),o.equal(e,1))),"float32")))}function ga(t,e){return sa(t,e)}function ma(t,e){return t.rank===e.rank&&(t=o.squeeze(t,[t.rank-1])),(e=o.argMax(e,-1)).dtype!==t.dtype&&(e=o.cast(e,t.dtype)),o.cast(o.equal(t,e),"float32")}const ya=aa,va=oa,ba={binaryAccuracy:da,categoricalAccuracy:fa,precision:function(t,e){return(0,o.tidy)((()=>{const n=pa(t,e),r=function(t,e){return(0,o.tidy)((()=>o.cast(o.sum(o.logicalAnd(o.equal(t,0),o.equal(e,1))),"float32")))}(t,e),i=o.add(n,r);return o.cast(o.where(o.greater(i,0),o.div(n,i),0),"float32")}))},categoricalCrossentropy:ya,sparseCategoricalCrossentropy:va,mse:ea,MSE:ea,mae:na,MAE:na,mape:ra,MAPE:ra,cosine:ua};function xa(t){if("string"===typeof t&&t in ba)return ba[t];if("string"!==typeof t&&null!=t)return t;throw new Tn("Unknown metric ".concat(t))}function wa(t){if(Mn(null!==t,"Unknown LossOrMetricFn ".concat(t)),"string"===typeof t)return t;{let e;for(const n of Object.keys(la))if(la[n]===t){e=n;break}if(void 0!==e)return e;for(const n of Object.keys(ba))if(ba[n]===t){e=n;break}return void 0!==e?e:t.name}}const ka=1048576;function _a(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t||"object"!==typeof t||Object.getPrototypeOf(t)!==Object.prototype||!Sa(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const n=JSON.stringify(t);n.length>ka&&console.warn('User-defined metadata of model "'.concat(e,'" is too large in ')+"size (length=".concat(n.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"".concat(ka,"."))}}function Sa(t){if(null===t)return!0;if("object"===typeof t){if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e){if("string"!==typeof n)return!1;if(!Sa(t[n]))return!1}return!0}if(Array.isArray(t)){for(const e of t)if(!Sa(e))return!1;return!0}return!1}{const e=typeof t;return"string"===e||"number"===e||"boolean"===e}}function Aa(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log;const i=function(t){let e=!0;const n=[],r=[];for(const i in t.nodesByDepth)n.push(t.nodesByDepth[i]);for(const i of n){if(i.length>1||1===i.length&&i[0].inboundLayers.length>1){e=!1;break}r.push(...i)}if(e)for(const i of t.layers){let t=!1;for(const n of i.inboundNodes)if(-1!==r.indexOf(n)){if(t){e=!1;break}t=!0}if(!e)break}return e}(t),a=["Layer (type)","Input Shape","Output shape","Param #"];let o;if(i?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map((t=>Math.floor(e*t)))),!i){a.push("Receives inputs"),o=[];for(const e in t.nodesByDepth)o.push(...t.nodesByDepth[e])}r("_".repeat(e)),Ca(a,n,r),r("=".repeat(e));const s=t.layers;for(let l=0;l<s.length;++l)i?Ea(s[l],n,r):Ta(s[l],n,o,r),r((l===s.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const c=function(t){let e;e=null!=t.collectedTrainableWeights?hi(t.collectedTrainableWeights):hi(t.trainableWeights);return e}(t),u=hi(t.nonTrainableWeights);r("Total params: ".concat(c+u)),r("Trainable params: ".concat(c)),r("Non-trainable params: ".concat(u)),r("_".repeat(e))}function Ca(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,r="";for(let i=0;i<t.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r+=t[i],r=r.slice(0,e[i]),r+=" ".repeat(e[i]-r.length);n(r)}function Ea(t,e,n){let r,i;try{i=t.inboundNodes.map((t=>JSON.stringify(t.inputShapes))).join(",")}catch(s){i="multiple"}try{r=JSON.stringify(t.outputShape)}catch(s){r="multiple"}const a=t.name,o=t.getClassName();Ca(["".concat(a," (").concat(o,")"),i,r,t.countParams().toString()],e,n)}function Ta(t,e,n,r){let i,a;try{a=t.inboundNodes.map((t=>JSON.stringify(t.inputShapes))).join(",")}catch(l){a="multiple"}try{i=JSON.stringify(t.outputShape)}catch(l){i="multiple"}const o=[];for(const h of t.inboundNodes)if(!(null!=n&&n.length>0&&-1===n.indexOf(h)))for(let t=0;t<h.inboundLayers.length;++t){const e=h.inboundLayers[t].name,n=h.nodeIndices[t],r=h.tensorIndices[t];o.push("".concat(e,"[").concat(n,"][").concat(r,"]"))}const s=t.name,c=t.getClassName(),u=0===o.length?"":o[0];Ca(["".concat(s," (").concat(c,")"),a,i,t.countParams().toString(),u],e,r);for(let h=1;h<o.length;++h)Ca(["","","","",o[h]],e,r)}function Na(t,e,n){return("inboundNodes"===t||"outputLayers"===t||"inputLayers"===t)&&0===e&&"string"===typeof n}function Da(t,e){if(null===t)return null;if("string"===typeof t)return Ln(t);if("number"===typeof t||"boolean"===typeof t)return t;if(t instanceof Array){const n=[],r=t.length;for(let i=0;i<r;++i){const r=t[i];Na(e,i,r)?n.push(r):n.push(Da(r,e))}return n}{const e={};for(const n of Object.keys(t)){const r=t[n];if("name"===n&&"string"===typeof r)e[n]=r;else{const t=Ln(n);e[t]=Da(r,t)}}return e}}function Fa(t,e){if(null===t||void 0===t)return null;if("string"===typeof t)return Bn(t);if("number"===typeof t||"boolean"===typeof t)return t;if(t instanceof Array){const n=[],r=t.length;for(let i=0;i<r;++i){const r=t[i];Na(e,i,r)?n.push(r):n.push(Fa(r,e))}return n}{const e={};for(const n of Object.keys(t)){const r=t[n],i=Bn(n);e[i]="name"!==n&&"className"!==n||"string"!==typeof r?Fa(r,n):r}return e}}const Ia="4.17.0";class Ma extends wi{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,null==this.name){const t=this.getClassName().toLowerCase();this.name=tr(t)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],qn(this.inputs).length!==this.inputs.length)throw new Tn("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(this.inputs.map((t=>t.name))));qn(this.outputs).length!==this.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(this.outputs.map((t=>t.name)))),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const y of this.outputs){const t=y.sourceLayer,e=y.nodeIndex,n=y.tensorIndex;this.outputLayers.push(t),this.outputLayersNodeIndices.push(e),this.outputLayersTensorIndices.push(n)}for(const y of this.inputs){const t=y.sourceLayer,e=y.nodeIndex,n=y.tensorIndex;Mn(0===e,"input layer has >1 nodes"),Mn(0===n,"input layer has >1 tensors"),this.inputLayers.push(t),this.inputLayersNodeIndices.push(e),this.inputLayersTensorIndices.push(n)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let y=0;y<this.inputLayers.length;y++){const e=this.inputLayers[y];if(!(e instanceof _i))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(t.inputs,". ")+"Input ".concat(y," (0-based) originates ")+"from layer type ".concat(e.getClassName(),"."));this.inputNames.push(e.name),this.feedInputShapes.push(e.batchInputShape),this.feedInputNames.push(e.name)}for(const y of this.outputLayers)this.outputNames.push(y.name);this.internalInputShapes=this.inputs.map((t=>t.shape)),this.internalOutputShapes=this.outputs.map((t=>t.shape));const e={},n={},r={},i={},a={},o=[],s=(t,e,n,r,i,c)=>{null!=r&&null!=i&&null!=c||(r=t.sourceLayer,i=t.nodeIndex,c=t.tensorIndex);const u=r.inboundNodes[i];if(-1!==n.indexOf(u))throw new En("The tensor ".concat(t.name,' at layer "').concat(r.name,'" ')+"is part of a cycle.");if(-1!==e.indexOf(u))return;this.containerNodes.add(Ma.nodeKey(r,i)),r.id in a||(a[r.id]=Object.keys(a).length),-1===n.indexOf(u)&&n.push(u);const l=u.inboundLayers.length;for(let a=0;a<l;a++){const t=u.inputTensors[a],r=u.inboundLayers[a],i=u.nodeIndices[a],o=u.tensorIndices[a];s(t,e,n,r,i,o)}for(e.push(u);n.indexOf(u)>=0;)n.splice(n.indexOf(u),1);o.push(u)},c=[],u=[];for(const y of this.outputs)s(y,c,u);const l=o.slice().reverse();for(const y of l){n[y.id]=y,y.id in e||(e[y.id]=0);let t=e[y.id];const a=null==r[y.outboundLayer.id]?0:r[y.outboundLayer.id];t=Math.max(t,a),r[y.outboundLayer.id]=t,i[y.outboundLayer.id]=y.outboundLayer,e[y.id]=t;for(let r=0;r<y.inboundLayers.length;r++){const i=y.inboundLayers[r],a=y.nodeIndices[r],o=i.inboundNodes[a],s=null==e[o.id]?0:e[o.id];e[o.id]=Math.max(t+1,s),n[o.id]=o}}const h={};for(const y in e){const t=e[y];t in h||(h[t]=[]),h[t].push(n[y])}const d={};for(const y in r){const t=r[y];t in d||(d[t]=[]),d[t].push(i[y])}let f=Object.keys(d).map((t=>parseInt(t,10))).sort(Vn);this.layers=[];for(const y of f){const t=d[y];t.sort(((t,e)=>{const n=a[t.id],r=a[e.id];return n<r?-1:n>r?1:0}));for(const e of t)e instanceof Ma&&this.internalContainerRefs.push(e),this.layers.push(e)}this.layersByDepth=d,f=Object.keys(h).map((t=>parseInt(t,10))).sort(Vn);const p=this.inputs.slice(),g=[];for(const y of f)for(const t of h[y]){const e=t.outboundLayer;if(null!=e){for(const n of t.inputTensors)if(-1===p.indexOf(n))throw new En("Graph disconnected: cannot obtain value for tensor ".concat(n)+' at layer "'.concat(e.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(g));for(const e of t.outputTensors)p.push(e);g.push(e.name)}}this.nodesByDepth=h;const m=this.layers.map((t=>t.name));for(const y of m){const t=m.filter((t=>t===y)).length;if(1!==t)throw new En('The name "'.concat(y,'" is used ').concat(t," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(m))}this.outboundNodes=[],this.inboundNodes=[],new bi({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map((t=>null)),outputMasks:this.outputs.map((t=>null)),inputShapes:this.inputs.map((t=>t.shape)),outputShapes:this.outputs.map((t=>t.shape))}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){for(const e of this.layers)t.numDisposedVariables+=e.dispose().numDisposedVariables;for(const e of this.internalContainerRefs)t.numDisposedVariables+=e.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach((e=>{e._trainableWeights.forEach((e=>e.trainable=t))})),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new Tn("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const e of this.layers)t=t.concat(e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.layers)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.layers)e.push(...t.trainableWeights);return e.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n={};let r=0;const i=(t=>{const e=Object.keys(t);if(0===e.length)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))})(t);i&&this.parseWeights(t);for(const o of this.layers)for(const[t,e]of o.weights.entries()){const a=i?"".concat(e.name.split("/").slice(0,-1).join("/")+"/").concat(t):e.originalName;if(null!=n[a])throw new Tn("Duplicate weight name: ".concat(a));n[a]=e,r++}const a=[];for(const o in t){let r=o;if(null==n[o]){const t=o.split("/");r=t.slice(0,-2).concat([t[t.length-1]]).join("/")}if(null!=n[r])a.push([n[r],t[o]]);else if(e)throw new Tn("Provided weight data has no target variable: ".concat(o));delete n[r]}if(e){const t=[];for(const e in n)t.push(e);if(t.length>0)throw new Tn("".concat(t.length," of ").concat(r," weights are not set: ")+"".concat(t))}gi(a)}parseWeights(t){for(const e in Object.keys(t)){const n=e.split("/"),r=["vars","layer_checkpoint_dependencies"],i=n.map((t=>t.startsWith("_")?t.slice(1):t)).filter((t=>!r.includes(t))).join("/");i!==e&&(t[i]=t[e],delete t[e])}}updatedConfig(){const t=this.getConfig(),e={};return e.className=this.getClassName(),e.config=t,e.kerasVersion="tfjs-layers ".concat(Ia),e.backend="TensorFlow.js",e}toJSON(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=Fa(this.updatedConfig());return e?JSON.stringify(n):n}call(t,e){return(0,o.tidy)((()=>{t=zn(t);const n=new Ai;for(let e=0;e<this.inputs.length;++e)n.add(this.inputs[e],t[e]);return Ti(this.outputs,n,e)}))}computeMask(t,e){return(0,o.tidy)((()=>{let n;return t=zn(t),n=null==e?In(null,t.length):zn(e),this.runInternalGraph(t,n)[1]}))}computeOutputShape(t){const e=ci(t);if(e.length!==this.inputLayers.length)throw new Tn("Invalid inputShape argument ".concat(t,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));const n={};for(let o=0;o<e.length;o++){const t=this.inputLayers[o],r=e[o];n[t.name+"_0_0"]=r}const r=Object.keys(this.nodesByDepth).map((t=>parseInt(t,10))).sort(Vn);if(r.length>1)for(const o of r){const t=this.nodesByDepth[o];for(const e of t){const t=e.outboundLayer;if(-1!==this.inputLayers.map((t=>t.id)).indexOf(t.id))continue;const r=[];for(let o=0;o<e.inboundLayers.length;o++){const t=e.inboundLayers[o],i=e.nodeIndices[o],a=e.tensorIndices[o],s=n["".concat(t.name,"_").concat(i,"_").concat(a)];r.push(s)}const i=ci(t.computeOutputShape(Rn(r))),a=t.inboundNodes.indexOf(e);for(let e=0;e<i.length;e++){n["".concat(t.name,"_").concat(a,"_").concat(e)]=i[e]}}}const i=[],a=[];for(let o=0;o<this.outputLayers.length;o++){const t=this.outputLayers[o],e=this.outputLayersNodeIndices[o],n=this.outputLayersTensorIndices[o],r="".concat(t.name,"_").concat(e,"_").concat(n);a.push(r)}for(let o=0;o<a.length;o++){const t=a[o];Mn(t in n),i.push(n[t])}return Rn(i)}runInternalGraph(t,e){null==e&&(e=In(null,t.length));const n={};for(let s=0;s<this.inputs.length;++s){const r=this.inputs[s],i=t[s],a=e[s];n[r.id]=[i,a]}const r=Object.keys(this.nodesByDepth).map((t=>parseInt(t,10))).sort(Vn);for(const s of r){const t=this.nodesByDepth[s];for(const e of t){const t=e.outboundLayer,r=e.inputTensors,i=e.outputTensors,a=new Array;for(const e of r)e.id in n&&a.push(n[e.id]);if(a.length===r.length){let r,o,s,c,u={};if(null!=e.callArgs&&(u=e.callArgs),1===a.length){const[e,n]=a[0];null==u.mask&&(u.mask=n),s=zn(t.call(e,u)),c=zn(t.computeMask(e,n)),r=[e],o=[n]}else r=a.map((t=>t[0])),o=a.map((t=>t[1])),null==u.mask&&(u.mask=o),s=zn(t.call(r,u)),c=zn(t.computeMask(r,o));if(t.activityRegularizer)throw new Nn("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let t=0;t<i.length;++t){const e=i[t],r=s[t],a=c[t];n[e.id]=[r,a]}}}}const i=[],a=[],o=[];for(const s of this.outputs){Mn(s.id in n,"Could not compute output ".concat(s.name," : ").concat(s.id));const[t,e]=n[s.id];o.push(t.shape),i.push(t),a.push(e)}return[i,a,o]}buildNodeConversionMap(t){const e={};let n;for(const r of this.layers){n=r instanceof Ma?1:0;for(let t=0;t<r.inboundNodes.length;t++){const i=Ma.nodeKey(r,t);this.containerNodes.has(i)&&(e[i]=n,n+=1)}}return e}getLayer(t,e){if(null!=e)return this.findLayer(e);if(null==t)throw new Tn("Provide either a layer name or layer index");if("number"===typeof t)return this.findLayer(t);for(const n of this.layers)if(n.name===t)return n;throw new Tn("No such layer: ".concat(t))}findLayer(t){if(this.layers.length<=t)throw new Tn("Was asked to retrieve layer at index ".concat(t,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[t]}calculateLosses(){return(0,o.tidy)((()=>{const t=[];for(const e of this.layers)for(let n=0;n<e.inboundNodes.length;++n){const r=Ma.nodeKey(e,n);this.containerNodes.has(r)&&t.push(...e.calculateLosses())}return t}))}getConfig(){const t={name:this.name},e=this.buildNodeConversionMap(this.layers),n=[];for(const o of this.layers){const t=o.getClassName(),r=o.getConfig(),i=[];for(let n=0;n<o.inboundNodes.length;n++){const t=o.inboundNodes[n],r=Ma.nodeKey(o,n);let s={};if(this.containerNodes.has(r)){if(t.callArgs)try{JSON.stringify(t.callArgs),s=t.callArgs}catch(a){console.warn("Layer ".concat(o.name," was passed ")+"non-serializable keyword arguments: "+"".concat(t.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),s={}}if(t.inboundLayers.length>0){const n=[];for(let r=0;r<t.inboundLayers.length;r++){const i=t.inboundLayers[r],a=t.nodeIndices[r],o=t.tensorIndices[r];let c=e[Ma.nodeKey(i,a)];null==c&&(c=0),n.push([i.name,c,o,s])}i.push(n)}}}const s={};s.name=o.name,s.className=t,s.config=r,s.inboundNodes=i,n.push(s)}t.layers=n;const r=[];for(let o=0;o<this.inputLayers.length;o++){const t=this.inputLayers[o],n=this.inputLayersNodeIndices[o],i=Ma.nodeKey(t,n);if(!this.containerNodes.has(i))continue;let a=e[i];null!==a&&void 0!==a||(a=0);const s=this.inputLayersTensorIndices[o];r.push([t.name,a,s])}t.inputLayers=r;const i=[];for(let o=0;o<this.outputLayers.length;o++){const t=this.outputLayers[o],n=this.outputLayersNodeIndices[o],r=Ma.nodeKey(t,n);if(!this.containerNodes.has(r))continue;let a=e[r];null!==a&&void 0!==a||(a=0);const s=this.outputLayersTensorIndices[o];i.push([t.name,a,s])}return t.outputLayers=i,t}static fromConfig(t,e){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r={},i={};function a(t,e){t.name in i?i[t.name].push(e):i[t.name]=[e]}function o(t,e){const n=[];let i;for(const o of e){const s=o[0],c=o[1],u=o[2];if(i=null==o[3]?{}:o[3],!(s in r))return void a(t,e);const l=r[s];if(l.inboundNodes.length<=c)return void a(t,e);const h=l.inboundNodes[c];n.push(h.outputTensors[u])}n.length>0&&t.apply(Rn(n),i)}function s(t){const i=t.name,o=Ji(t,null!=e.customObjects?e.customObjects:{});o.setFastWeightInitDuringBuild(n),r[i]=o;t.inboundNodes.forEach((t=>{if(!(t instanceof Array))throw new Tn("Corrupted configuration, expected array for nodeData: ".concat(t));a(o,t)}))}const c=e.name,u=e.layers;for(const p of u)s(p);for(;!Gn(i);)for(const t of u){const e=r[t.name];if(e.name in i){const t=i[e.name];delete i[e.name];for(const n of t)o(e,n)}}const l=[],h=[],d=e.inputLayers;for(const p of d){const t=p[0],e=p[1],n=p[2];Mn(t in r);const i=r[t].inboundNodes[e].outputTensors;l.push(i[n])}const f=e.outputLayers;for(const p of f){const t=p[0],e=p[1],n=p[2];Mn(t in r);const i=r[t].inboundNodes[e].outputTensors;h.push(i[n])}return new t({inputs:l,outputs:h,name:c})}get stateful(){if(this._stateful)throw new Tn("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){(0,o.tidy)((()=>{this.layers.forEach((t=>{t.stateful&&t.resetStates()}))}))}}function Oa(t,e,n){const r=e.length;if(null==t||Array.isArray(t)&&0===t.length)return e.map((t=>null));if(1===r)return Array.isArray(t)&&1===t.length?t:"object"===typeof t&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error("Provided ".concat(n," is an array of ").concat(t.length," ")+"element(s), but the model has ".concat(r," outputs. ")+"Make sure a set of weights is provided for each model output.");return t}if("object"===typeof t&&Object.keys(t).length>0&&"object"===typeof t[Object.keys(t)[0]]){const n=[];return e.forEach((e=>{e in t?n.push(t[e]):n.push(null)})),n}throw new Error("The model has multiple (".concat(r,") outputs, ")+"so ".concat(n," must be either an array with ")+"".concat(r," elements or an object with ").concat(e," keys. ")+"Provided ".concat(n," not understood: ").concat(JSON.stringify(t)))}function Ra(t,e){return Oa(t,e,"classWeight")}async function za(t,e,n,r){if(null!=e||null!=r)throw new Error("Support sampleWeight is not implemented yet");if(null!=n){const e=(0,o.tidy)((()=>{if(1===t.shape.length)return(0,o.clone)(t);if(2===t.shape.length){if(t.shape[1]>1){const e=1;return(0,o.argMax)(t,e)}if(1===t.shape[1])return(0,o.reshape)(t,[t.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(t.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor (".concat(t.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")})),r=Array.from(await e.data());(0,o.dispose)(e);const i=[];return r.forEach((t=>{if(null==n[t])throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(t," exists in the data but not in ")+"classWeight");i.push(n[t])})),(0,o.tensor1d)(i,"float32")}return null}function Ba(t,e){return(0,o.mul)(t,e)}function La(t,e){let n,r;const i=e;n=i.xs,r=i.ys,o.util.assert(null!=n&&null!=r,(()=>"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(e)));const a=Pa("input",t.inputNames,n),s=Pa("output",t.outputNames,r),c=a[0].shape[0];o.util.assert(a.length===t.inputs.length,(()=>"LayersModel has ".concat(t.inputs.length," inputs, but the dataset ")+"provides ".concat(a.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(t.inputNames),")"))),o.util.assert(s.length===t.outputs.length,(()=>"LayersModel has ".concat(t.outputs.length," outputs, but the dataset ")+"provides ".concat(s.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(t.outputNames),")")));for(let u=0;u<a.length;u++)o.util.assert(a[u].shape[0]===c,(()=>"Batch size mismatch: input "+"".concat(t.inputNames[u]," has ").concat(a[u].shape[0],"; ")+"expected  ".concat(c," based on input ").concat(t.inputNames[0],".")));for(let u=0;u<s.length;u++)o.util.assert(s[u].shape[0]===c,(()=>"Batch size mismatch: output "+"".concat(t.outputNames[u]," has ").concat(s[u].shape[0],"; ")+"expected  ".concat(c," based on input ").concat(t.inputNames[0],".")));return{xs:a,ys:s}}function Pa(t,e,n){if(n instanceof o.Tensor)return[n];if(Array.isArray(n))return o.util.assert(n.length===e.length,(()=>"Received an array of ".concat(n.length," Tensors, but expected ").concat(e.length," to match the ").concat(t," keys ").concat(e,"."))),n;{const r=[];for(const i of e){if(null==n[i])throw new Tn("The feature data generated by the dataset lacks the required "+"".concat(t," key '").concat(i,"'."));r.push(n[i])}return r}}async function ja(t,e,n){const r=null!=n.batchesPerEpoch;if(o.util.assert(null!=t.optimizer,(()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig).")),o.util.assert(null!=n,(()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call.")),o.util.assert(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),(()=>"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(n.epochs))),o.util.assert(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),(()=>"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(n.batchesPerEpoch))),o.util.assert(null==n.validationSplit,(()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead.")),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const i=null!=n.validationData;let a,s;if(i)if(Ua(n.validationData))o.util.assert(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),(()=>"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(n.validationBatches)));else{const t=function(t){if(3===t.length)throw new Nn("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}(n.validationData);a=t.xs,s=t.ys}const c=t.makeTrainFunction(),u=t.getDedupedMetricsNames();let l;l=i?u.slice().concat(u.map((t=>"val_"+t))):u.slice();const h=$i(n.callbacks,n.yieldEvery),d=null==n.verbose?1:n.verbose,{callbackList:f,history:p}=Qi(h,d,n.epochs,null,null,function(t,e){let n=null;null!=e.batchesPerEpoch?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size);return n}(e,n),null,i,l);f.setModel(t),t.history=p,await f.onTrainBegin(),t.stopTraining_=!1;let g=null==n.initialEpoch?0:n.initialEpoch,m=await e.iterator();for(;g<n.epochs;){const l={};await f.onEpochBegin(g);let h=0,d=0;for(r||(m=await e.iterator());!r||h<n.batchesPerEpoch;){const e=await m.next();if(r&&e.done){console.warn("You provided `batchesPerEpoch` as "+"".concat(n.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(h," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(n.batchesPerEpoch*n.epochs," batches). ")+"You may need to use the repeat() function when building your dataset.");break}if(null!=e.value){const{xs:r,ys:i}=La(t,e.value),a={};a.batch=d,a.size=r[0].shape[0],await f.onBatchBegin(d,a);const s=[];if(null!=n.classWeight){const e=Ra(n.classWeight,t.outputNames);for(let t=0;t<e.length;++t)s.push(await za(i[t],null,e[t]))}const l=r.concat(i).concat(s),p=c(l);o.dispose(l);for(let t=0;t<u.length;++t){const e=u[t],n=p[t];a[e]=n,o.keep(n)}await f.onBatchEnd(d,a),Vi(a),d++,h++}if(r?h>=n.batchesPerEpoch:e.done){if(i){let e;e=Ua(n.validationData)?zn(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):zn(t.evaluate(a,s,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0}));for(let n=0;n<t.metricsNames.length;++n)l["val_".concat(t.metricsNames[n])]=e[n]}break}if(t.stopTraining_)break}if(await f.onEpochEnd(g,l),g++,t.stopTraining_)break}return await f.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function Ua(t){return"function"===typeof t.iterator}function Wa(t){o.util.assert(t>0&&Number.isInteger(t),(()=>"batchSize is required to be a positive integer, but got ".concat(t)))}function Va(t,e,n){return null==t?[null]:Array.isArray(t)?t.map((t=>Ar(t,e,n-e))):Ar(t,e,n-e)}function qa(t,e){return o.tidy((()=>null==t?null:Array.isArray(t)?t.map((t=>qa(t,e))):Mr(t,"int32"===e.dtype?e:o.cast(e,"int32"))))}function Ga(t,e){const n=[];let r=0,i=null;for(;r<t;)i=r+e,i>=t&&(i=t),n.push([r,i]),r=i;return n}function Ha(t){const e=[];t instanceof o.Tensor&&(t=[t]);for(let n=0;n<t.length;++n){const r=t[n];if(1===r.rank)e.push(Sr(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function Ya(t,e){if(null==t)return;const n=[];if(e instanceof o.Tensor)n.push(e.id);else if(Array.isArray(e))e.forEach((t=>n.push(t.id)));else if(null!=e)for(const i in e){const t=e[i];n.push(t.id)}const r=[];if(t instanceof o.Tensor)-1===n.indexOf(t.id)&&r.push(t);else if(Array.isArray(t))t.forEach((t=>{-1===n.indexOf(t.id)&&r.push(t)}));else if(null!=t)for(const i in t){const e=t[i];-1===n.indexOf(e.id)&&r.push(e)}r.forEach((t=>{t.isDisposed||t.dispose()}))}function Xa(t){return Array.isArray(t)}function Ka(t){return!function(t){return t instanceof o.Tensor}(t)&&!Xa(t)}function $a(t,e,n){let r,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==e||0===e.length){if(null!=t){let e=!1;if(Xa(t)&&t.length>0)e=!0;else if(Ka(t)){for(const n in t)if(t.hasOwnProperty(n)){e=!0;break}}else e=!0;if(e)throw new Tn("Error when checking model ".concat(a," expected no data, ")+"but got ".concat(t))}return[]}if(null==t)return e.map((t=>null));if(Ka(t)){r=[];for(const n of e){if(null==t[n])throw new Tn('No data provided for "'.concat(n,'". Need data for each key in: ')+"".concat(e));r.push(t[n])}}else if(Xa(t)){if(t.length!==e.length)throw new Tn("Error when checking model ".concat(a,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(e.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(t));r=t}else{if(e.length>1)throw new Tn("The model ".concat(a," expects ").concat(e.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(t.shape));r=[t]}if(r=Ha(r),null!=n)for(let o=0;o<e.length;++o){if(null==n[o])continue;const t=r[o];if(t.shape.length!==n[o].length)throw new Tn("Error when checking ".concat(a,": expected ").concat(e[o]," ")+"to have ".concat(n[o].length," dimension(s). but got array with ")+"shape ".concat(t.shape));for(let e=0;e<n[o].length;++e){if(0===e&&!i)continue;const r=t.shape[e],s=n[o][e];if(null!=s&&s>=0&&r!==s)throw new Tn("".concat(a," expected a batch of elements where each ")+"example has shape [".concat(n[o].slice(1,n[o].length),"] ")+"(i.e.,tensor shape [*,".concat(n[o].slice(1,n[o].length),"])")+" but the ".concat(a," received an input with ").concat(t.shape[0])+" examples, each with shape [".concat(t.shape.slice(1,t.shape.length),"]")+" (tensor shape [".concat(t.shape,"])"))}}return r}function Za(t,e,n){let r,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(t)){if(t.length!==e.length)throw new Tn("Error when checking model ".concat(a,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(e.length," Tensor(s),")+" but instead got ".concat(t.length," Tensors(s)."));r=t}else{if(e.length>1)throw new Tn("The model expects ".concat(e.length," ").concat(a," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(t.shape),"."));r=[t]}if(null!=n)for(let o=0;o<e.length;++o){if(null==n[o])continue;const t=r[o];if(t.shape.length!==n[o].length)throw new Tn("Error when checking ".concat(a,": expected ").concat(e[o]," ")+"to have ".concat(n[o].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(t.shape)));for(let r=0;r<n[o].length;++r){if(0===r&&!i)continue;const s=t.shape[r],c=n[o][r];if(null!=c&&c!==s)throw new Tn("Error when checking ".concat(a,": expected ")+"".concat(e[o]," to have shape ").concat(JSON.stringify(n[o])," but ")+"got array with shape ".concat(JSON.stringify(t.shape),"."))}}}class Qa extends Ma{constructor(t){super(t),this.isTraining=!1}summary(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new Tn("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Aa(this,t,e,n)}compile(t){if(null==t.loss&&(t.loss=[]),this.loss=t.loss,"string"===typeof t.optimizer)this.optimizer_=function(t){const e={Adagrad:()=>o.train.adagrad(.01),Adadelta:()=>o.train.adadelta(1,.95,kr()),Adam:()=>o.train.adam(.001,.9,.999,kr()),Adamax:()=>o.train.adamax(.002,.9,.999,kr(),0),RMSProp:()=>o.train.rmsprop(.001,.9,0,kr()),SGD:()=>o.train.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new Tn("Unknown Optimizer ".concat(t))}(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof o.Optimizer))throw new Tn("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let e=[];if(Array.isArray(t.loss)||"string"===typeof t.loss||"function"===typeof t.loss)if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new Tn("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(t.loss,"."));const n=t.loss;e=n.map((t=>ha(t)))}else{const n=ha(t.loss);this.outputs.forEach((t=>{e.push(n)}))}else{t.loss=t.loss;for(const e in t.loss)if(-1===this.outputNames.indexOf(e))throw new Tn('Unknown entry in loss dictionary: "'.concat(e,'". ')+"Only expected the following keys: ".concat(this.outputNames));for(const n of this.outputNames)null==t.loss[n]&&console.warn('Output "'.concat(n,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(n," during training")),e.push(ha(t.loss[n]))}this.lossFunctions=e,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let a=0;a<this.outputs.length;++a){const t=this.internalOutputShapes[a],e=this.outputNames[a];this.feedOutputNames.push(e),this.feedOutputShapes.push(t),this.feedLossFns.push(this.lossFunctions[a])}const n=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],dr("loss",(()=>{for(let t=0;t<this.outputs.length;++t){if(-1!==n.indexOf(t))continue;const e=this.lossFunctions[t];this.outputs.length>1&&(this.metricsTensors.push([e,t]),this.metricsNames.push(this.outputNames[t]+"_loss"))}}));const r=function(t,e){if(null==t||Array.isArray(t)&&0===t.length)return e.map((t=>[]));let n;if("string"===typeof t||"function"===typeof t)n=[t];else{if(!Array.isArray(t)&&"object"!==typeof t)throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(t));n=t}if(Array.isArray(n))return e.map((t=>n));{const t=[];for(const r of e){let e=n.hasOwnProperty(r)?n[r]:[];Array.isArray(e)||(e=[e]),t.push(e)}return t}}(t.metrics,this.outputNames),i=(t,e,n)=>{this.outputNames.length>1&&(e=this.outputNames[t]+"_"+e),this.metricsNames.push(e),this.metricsTensors.push([n,t])};dr("metric",(()=>{for(let t=0;t<this.outputs.length;++t){if(-1!==n.indexOf(t))continue;(e=>{let n,r,a;for(const o of e){if("string"===typeof o&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(o)){const e=this.internalOutputShapes[t];let i;1===e[e.length-1]||this.lossFunctions[t]===sa?-1!==["accuracy","acc"].indexOf(o)?r=da:-1!==["crossentropy","ce"].indexOf(o)&&(r=ga):this.lossFunctions[t]===oa?-1!==["accuracy","acc"].indexOf(o)?r=ma:-1!==["crossentropy","ce"].indexOf(o)&&(r=va):-1!==["accuracy","acc"].indexOf(o)?r=fa:-1!==["crossentropy","ce"].indexOf(o)&&(r=ya),-1!==["accuracy","acc"].indexOf(o)?i="acc":-1!==["crossentropy","ce"].indexOf(o)&&(i="ce"),a=r,n=""+i}else{const t=xa(o);a=t,n=""+wa(o)}let e;dr(n,(()=>{e=a})),i(t,n,e)}})(r[t])}})),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=null==n.batchSize?32:n.batchSize;Wa(r);const i=this.standardizeUserDataXY(t,e,!0,r);try{const t=i[0].concat(i[1]);this.makeTestFunction();const e=this.testFunction;return Rn(this.testLoop(e,t,r,n.verbose,n.steps))}finally{Ya(i[0],t),Ya(i[1],e)}}async evaluateDataset(t,e){return this.makeTestFunction(),async function(t,e,n){const r=null!=(n=n||{}).batches,i=t.testFunction;let a=[];if(n.verbose>0)throw new Nn("Verbose mode is not implemented yet.");o.util.assert(!r||n.batches>0&&Number.isInteger(n.batches),(()=>"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(n.batches))));const s="function"===typeof e.next?e:await e.iterator();let c=0,u=0;for(;!r||u<n.batches;){const e=await s.next();if(a=o.tidy((()=>{if(e.value){const{xs:n,ys:r}=La(t,e.value),s=n.concat(r),l=o.tidy((()=>i(s)));if(o.dispose(s),0===u)for(let t=0;t<l.length;++t)a.push((0,o.scalar)(0));const h=s[0].shape[0];for(let t=0;t<l.length;++t){const e=l[t],n=a[t];a[t]=o.tidy((()=>o.add(a[t],o.mul(h,e)))),u>0&&o.dispose(n)}o.dispose(l),c+=h,++u}return a})),e.done){r&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(n.batches," batches). ")+"You may need to use the repeat() function when building your dataset.");break}}for(let l=0;l<a.length;++l){const t=a[l];a[l]=o.div(a[l],c),o.dispose(t)}return Rn(a)}(this,t,e)}checkNumSamples(t,e,n){let r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(r=null,null!=e)throw new Tn("If ".concat(i," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(e))}else{if(null==t)throw new Tn("Either the input data should have a defined shape, or "+"".concat(i," shoud be specified."));r=Array.isArray(t)?t[0].shape[0]:t.shape[0]}return r}execute(t,e){if(Array.isArray(e)&&0===e.length)throw new Tn("`outputs` is an empty Array, which is not allowed.");const n=Array.isArray(e),r=n?e:[e],i=this.retrieveSymbolicTensors(r),a=new Ai;if(t instanceof o.Tensor&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new Tn("The number of inputs provided (".concat(t.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(let e=0;e<this.inputs.length;++e)a.add(this.inputs[e],t[e])}else for(const o of this.inputs){const e=t[o.name];if(null==e)throw new Tn("No value is provided for the model's input ".concat(o.name));a.add(o,e)}const s=Ti(i,a);return n?s:s[0]}retrieveSymbolicTensors(t){const e=In(null,t.length);let n=t.length;for(const r of this.layers){const i=Array.isArray(r.output)?r.output:[r.output],a=i.map((t=>t.name));for(let r=0;r<t.length;++r){const o=a.indexOf(t[r]);if(-1!==o&&(e[r]=i[o],n--),0===n)break}if(0===n)break}if(n>0){const n=[];throw e.forEach(((e,r)=>{null==e&&n.push(t[r])})),new Tn("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(n)))}return e}predictLoop(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return o.tidy((()=>{const r=this.checkNumSamples(t);if(n)throw new Nn("Verbose predictLoop() is not implemented yet.");const i=Ga(r,e),a=this.outputs.map((t=>[]));for(let e=0;e<i.length;++e){o.tidy((()=>{const n=i[e][0],r=i[e][1],a=Va(t,n,r),o=[];if(Array.isArray(a))for(let t=0;t<a.length;++t)o.push({key:this.inputs[t],value:a[t]});else o.push({key:this.inputs[0],value:a});const s=new Ai(o);return Ti(this.outputs,s)})).forEach(((t,e)=>a[e].push(t)))}return Rn(a.map((t=>o.concat(t,0))))}))}predict(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Ha(t);Za(n,this.inputNames,this.feedInputShapes,!1);try{const t=null==e.batchSize?32:e.batchSize;return Wa(t),this.predictLoop(n,t)}finally{Ya(n,t)}}predictOnBatch(t){Za(t,this.inputNames,this.feedInputShapes,!0);const e=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,e)}standardizeUserDataXY(t,e){let n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new En("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const r=[];for(let i=0;i<this.feedOutputShapes.length;++i){const t=this.feedOutputShapes[i];this.feedLossFns[i]===oa?r.push(t.slice(0,t.length-1).concat([1])):r.push(t)}if(function(t,e,n){const r=qn(t.map((t=>t.shape[0])));r.sort();const i=qn(e.map((t=>t.shape[0])));if(i.sort(),r.length>1)throw new Tn("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(t.map((t=>t.shape)))));if(i.length>1)throw new Tn("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map((t=>t.shape)))));if(r.length>0&&i.length>0&&!o.util.arraysEqual(r,i))throw new Tn("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(r[0]," input sample(s) and ").concat(i[0]," target ")+"sample(s).")}(t=$a(t,this.feedInputNames,this.feedInputShapes,!1,"input"),e=$a(e,this.feedOutputNames,r,!1,"target")),function(t,e,n){const r=[ea,sa,aa];for(let i=0;i<t.length;++i){const a=t[i],o=e[i],s=n[i];if(null!=o){if(o===aa&&1===a.shape[a.shape.length-1])throw new Tn("You are passing a target array of shape ".concat(a.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(o)){const t=a.shape.slice(1),e=s.slice(1);for(let n=0;n<t.length;++n){const r=t[n],i=e[n];if(null!=i&&r!==i)throw new Tn("A target Tensor with shape ".concat(a.shape," was passed for an ")+"output of shape ".concat(s,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}}(e,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&t[0].shape[0]%n!==0)throw new Tn("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(n,". Found: ").concat(t[0].shape[0]," sample(s)."));return[t,e]}async standardizeUserData(t,e,n,r){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5?arguments[5]:void 0;const[o,s]=this.standardizeUserDataXY(t,e,i,a);if(null!=n)throw new Error("sample weight is not supported yet.");let c=null;if(null!=r){const t=Ra(r,this.outputNames);c=[];for(let e=0;e<t.length;++e)c.push(await za(s[e],null,t[e]))}return[o,s,c]}testLoop(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4?arguments[4]:void 0;return o.tidy((()=>{const a=this.checkNumSamples(e,n,i,"steps"),s=[];if(r>0)throw new Nn("Verbose mode is not implemented yet.");if(null!=i)throw new Nn("steps mode in testLoop() is not implemented yet");{const r=Ga(a,n),i=(0,o.tensor1d)(xr(0,a));for(let n=0;n<r.length;++n){const a=r[n][0],c=r[n][1],u=Ar(i,a,c-a),l=qa(e,u),h=t(l);if(0===n)for(let t=0;t<h.length;++t)s.push((0,o.scalar)(0));for(let t=0;t<h.length;++t){const e=h[t];s[t]=o.add(s[t],o.mul(c-a,e))}}for(let t=0;t<s.length;++t)s[t]=o.div(s[t],a)}return s}))}getDedupedMetricsNames(){const t=this.metricsNames,e=[];for(let n=0;n<t.length;++n){const r=t[n];let i=r;if(On(t,r)>1){const e=On(t.slice(0,n),r);i+="_".concat(e)}e.push(i)}return e}makeTrainFunction(){return t=>{const e=[],n=t.slice(0,this.inputs.length),r=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),a=[],s=this.collectedTrainableWeights.map((t=>t.read()));return[this.optimizer_.minimize((()=>{const t=[];for(let e=0;e<this.inputs.length;++e)t.push({key:this.inputs[e],value:n[e]});const s=new Ai(t),c=Ti(this.outputs,s,{training:!0});let u;for(let n=0;n<this.lossFunctions.length;++n){let t=(0,this.lossFunctions[n])(r[n],c[n]);null!=i[n]&&(t=Ba(t,i[n]));const a=o.mean(t);e.push(a),u=0===n?t:o.add(u,t)}for(let n=0;n<this.metricsTensors.length;++n){let t;if(this.outputs.length>1&&n<this.outputs.length)t=e[n];else{const e=this.metricsTensors[n][0],i=this.metricsTensors[n][1];t=o.mean(e(r[i],c[i]))}o.keep(t),a.push(t)}return u=o.mean(u),this.calculateLosses().forEach((t=>{u=o.add(u,t)})),u}),!0,s)].concat(a)}}makeTestFunction(){this.testFunction=t=>o.tidy((()=>{const e=[];let n;const r=t.slice(0,this.inputs.length),i=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=[];for(let t=0;t<this.inputs.length;++t)a.push({key:this.inputs[t],value:r[t]});const s=new Ai(a),c=Ti(this.outputs,s);for(let t=0;t<this.lossFunctions.length;++t){const r=this.lossFunctions[t],a=o.mean(r(i[t],c[t]));n=0===t?a:o.add(n,a),e.push(n)}for(let t=0;t<this.metricsTensors.length;++t){const n=this.metricsTensors[t][0],r=this.metricsTensors[t][1],a=o.mean(n(i[r],c[r]));e.push(a)}return e}))}async fit(t,e){let n,r,i,a,s,c,u,l,h,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;try{const o=null==d.batchSize?32:d.batchSize;Wa(o);const f=!1,p=await this.standardizeUserData(t,e,d.sampleWeight,d.classWeight,f,o);n=p[0],r=p[1],h=p[2];let g,m=!1;if(null!=d.validationData&&d.validationData.length>0){if(m=!0,2!==d.validationData.length)throw 3===d.validationData.length?new Nn("validationData including sample weights is not supported yet."):new Tn("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(d.validationData," is invalid."));s=d.validationData[0],c=d.validationData[1];const t=!0,e=await this.standardizeUserData(s,c,null,null,t,o);u=e[0],l=e[1],g=u.concat(l)}else if(null!=d.validationSplit&&d.validationSplit>0&&d.validationSplit<1){m=!0;const t=Math.floor(n[0].shape[0]*(1-d.validationSplit)),e=n[0].shape[0];u=Va(n,t,e),i=n,n=Va(n,0,t),l=Va(r,t,e),a=r,r=Va(r,0,t),g=u.concat(l)}else null!=d.validationSteps&&(m=!0);const y=n.concat(r).concat(h);this.checkTrainableWeightsConsistency();const v=this.makeTrainFunction(),b=this.getDedupedMetricsNames();let x,w;m?(this.makeTestFunction(),x=this.testFunction,w=b.slice().concat(b.map((t=>"val_"+t)))):(x=null,g=[],w=b.slice());const k=$i(d.callbacks,d.yieldEvery);return await this.fitLoop(v,y,b,o,d.epochs,d.verbose,k,x,g,d.shuffle,w,d.initialEpoch,null,null)}finally{this.isTraining=!1,Ya(n,t),Ya(r,e),Ya(i,t),Ya(a,e),Ya(u,s),Ya(l,c),null!=h&&o.dispose(h)}}async fitLoop(t,e,n,r,i,a,s,c,u,l,h,d,f,p){null==r&&(r=32),null==i&&(i=1),null==l&&(l=!0),null==d&&(d=0);let g=!1;if(null!=c&&null!=u&&(g=!0),null!=p&&(g=!0,null==f))throw new Tn("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const m=this.checkNumSamples(e,r,f,"steps_per_epoch");let y;null!=m&&(y=xr(0,m)),null==a&&(a=1);const{callbackList:v,history:b}=Qi(s,a,i,d,m,f,r,g,h);v.setModel(this),this.history=b,await v.onTrainBegin(),this.stopTraining_=!1;for(let x=d;x<i;++x){await v.onEpochBegin(x);const i={};if(null!=f)throw new Nn("stepsPerEpoch mode is not implemented yet.");{if("batch"===l)throw new Nn("batch shuffling is not implemneted yet");l&&o.util.shuffle(y);const a=(0,o.tensor1d)(y),s=Ga(m,r);for(let l=0;l<s.length;++l){const h={};if(await v.onBatchBegin(l,h),o.tidy((()=>{const d=s[l][0],f=s[l][1],p=Ar(a,d,f-d);h.batch=l,h.size=f-d;const m=qa(e,p),y=t(m);for(let t=0;t<n.length;++t){const e=n[t],r=y[t];h[e]=r,o.keep(r)}if(l===s.length-1&&g){const t=this.testLoop(c,u,r);for(let e=0;e<n.length;++e){const r=n[e],a=t[e];o.keep(a),i["val_"+r]=a}}})),await v.onBatchEnd(l,h),Vi(h),this.stopTraining_)break}a.dispose()}if(await v.onEpochEnd(x,i),this.stopTraining_)break}return await v.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(t,e){return ja(this,t,e)}async trainOnBatch(t,e){const n=await this.standardizeUserData(t,e),r=n[0],i=n[1],a=this.makeTrainFunction()(r.concat(i)),s=[];for(const o of a){const t=await o.data();s.push(t[0])}return o.dispose(a),Ya(n[0],t),Ya(n[1],e),Rn(s)}getNamedWeights(t){const e=[],n=null!=t&&t.trainableOnly,r=n?this.trainableWeights:this.weights,i=this.getWeights(n);for(let a=0;a<r.length;++a)n&&!r[a].trainable||e.push({name:r[a].originalName,tensor:i[a]});return e}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(0===t.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){const e=o.memory().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=e-o.memory().numTensors}return t}getLossIdentifiers(){let t;if("string"===typeof this.loss)t=Bn(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if("string"!==typeof t)throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map((t=>Bn(t)))}else{const e=Object.keys(this.loss);t={};const n=this.loss;for(const r of e){if("string"!==typeof n[r])throw new Error("Serialization of non-string loss is not supported.");t[r]=Bn(n[r])}}return t}getMetricIdentifiers(){if("string"===typeof this.metrics||"function"===typeof this.metrics)return[Bn(wa(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((t=>Bn(wa(t))));{const t={};for(const e in this.metrics)t[e]=Bn(wa(this.metrics[e]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(null!=t.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=t.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=t.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");const e=Ji(Da(t.optimizer_config));let n,r;if("string"===typeof t.loss)n=Ln(t.loss);else if(Array.isArray(t.loss))n=t.loss.map((t=>Ln(t)));else if(null!=t.loss){n={};for(const e in t.loss)n[e]=Ln(t.loss[e])}if(Array.isArray(t.metrics))r=t.metrics.map((t=>Ln(t)));else if(null!=t.metrics){r={};for(const e in t.metrics)r[e]=Ln(t.metrics[e])}this.compile({loss:n,metrics:r,optimizer:e})}async save(t,e){if("string"===typeof t){const e=o.io.getSaveHandlers(t);if(0===e.length)throw new Tn("Cannot find any save handlers for URL '".concat(t,"'"));if(e.length>1)throw new Tn("Found more than one (".concat(e.length,") save handlers for ")+"URL '".concat(t,"'"));t=e[0]}if(null==t.save)throw new Tn("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const n=await o.io.encodeWeights(this.getNamedWeights(e)),r={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v".concat(Ia),convertedBy:null};if(null!=e&&e.includeOptimizer&&null!=this.optimizer){r.trainingConfig=this.getTrainingConfig();const t="optimizer",{data:e,specs:i}=await o.io.encodeWeights(await this.optimizer.getWeights(),t);n.specs.push(...i),n.data=o.io.concatenateArrayBuffers([n.data,e])}if(null!=this.userDefinedMetadata){const t=!0;_a(this.userDefinedMetadata,this.name,t),r.userDefinedMetadata=this.userDefinedMetadata}return r.weightData=n.data,r.weightSpecs=n.specs,t.save(r)}setUserDefinedMetadata(t){_a(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}Qa.className="Model",o.serialization.registerClass(Qa);class Ja extends Qa{}Ja.className="Functional",o.serialization.registerClass(Ja);class to extends Qa{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=null!=t.name?t.name:tr("sequential_"),null!=t.layers)for(const e of t.layers)this.add(e)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some((t=>t<0)))throw new Tn("Negative dimension size caused by adding layer "+"".concat(t.name," with input shape [")+"".concat(t.inboundNodes[0].inputTensors[0].shape,"]"))}add(t){const e=t instanceof to||t instanceof Qa;let n;if(e){if(n=t,1!==n.outputs.length)throw new Tn("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new Tn("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===t.inboundNodes.length){if(null==t.batchInputShape)throw new Tn("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const e=Si({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(e)}if(e)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==t.inboundNodes.length)throw new Tn("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(t.name," ")+"which has ".concat(t.inboundNodes.length," pre-existing inbound ")+"connections.");if(1!==t.inboundNodes[0].outputTensors.length)throw new Tn("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=ki(this.outputs[0])}this.inboundNodes=[],new bi({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:In(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((t=>t.shape)),outputShapes:this.outputs[0].shape})}else{const e=t.apply(this.outputs[0]);if(Array.isArray(e))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[e],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,e){return null==this.model&&this.build(),this.model.call(t,e)}build(t){if(li(t),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Qa({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),super.summary(t,e,n)}setWeights(t){null==this.model&&this.build(),this.model.setWeights(t)}evaluate(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new En("The model needs to be compiled before being used.");return this.model.evaluate(t,e,n)}async evaluateDataset(t,e){if(!this.built)throw new En("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,e)}predict(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(t,e)}predictOnBatch(t){return null==this.model&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new En("The model needs to be compiled before being used.");return this.model.fit(t,e,n)}async fitDataset(t,e){if(!this.built)throw new En("The model needs to be compiled before being used.");return this.model.fitDataset(t,e)}async trainOnBatch(t,e){return this.model.trainOnBatch(t,e)}static fromConfig(t,e){let n,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i={};if(e instanceof Array){if(null==e[0].className||"Merge"===e[0].className)throw new Tn("Legacy serialization format not supported yet.");n=e}else o.util.assert(null!=e.layers,(()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field.")),n=e.layers,delete e.layers,i=e;const a=new t(i);if(!(a instanceof to))throw new Nn("Sequential.fromConfig called on non-Sequential input: ".concat(a));for(const o of n){const t=Ji(o,void 0,r);r&&t.setFastWeightInitDuringBuild(!0),a.add(t)}return a}set stopTraining(t){if(null==this.model)throw new Tn("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(null==this.model)throw new Tn("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const e of this.layers){const n={};n.className=e.getClassName(),n.config=e.getConfig(),t.push(n)}return{name:this.name,layers:t}}}to.className="Sequential",o.serialization.registerClass(to);class eo extends o.serialization.Serializable{getConfig(){return{}}}class no extends eo{apply(t){return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==e)throw new Nn("Support for alpha values other than 1 (".concat(e,") is not implemented ")+"yet.");return o.elu(t)}(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}}no.className="elu",o.serialization.registerClass(no);class ro extends eo{apply(t){return o.selu(t)}}ro.className="selu",o.serialization.registerClass(ro);class io extends eo{apply(t){return o.relu(t)}}io.className="relu",o.serialization.registerClass(io);class ao extends eo{apply(t){return(0,o.tidy)((()=>o.minimum(6,o.relu(t))))}}ao.className="relu6",o.serialization.registerClass(ao);class oo extends eo{apply(t){return t}}oo.className="linear",o.serialization.registerClass(oo);class so extends eo{apply(t){return o.sigmoid(t)}}so.className="sigmoid",o.serialization.registerClass(so);class co extends eo{apply(t){return function(t){return(0,o.tidy)((()=>{const e=o.add(.5,o.mul(.2,t));return o.clipByValue(e,0,1)}))}(t)}}co.className="hardSigmoid",o.serialization.registerClass(co);class uo extends eo{apply(t){return o.softplus(t)}}uo.className="softplus",o.serialization.registerClass(uo);class lo extends eo{apply(t){return function(t){return(0,o.tidy)((()=>o.div(t,o.add(o.abs(t),1))))}(t)}}lo.className="softsign",o.serialization.registerClass(lo);class ho extends eo{apply(t){return o.tanh(t)}}ho.className="tanh",o.serialization.registerClass(ho);class fo extends eo{apply(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return o.softmax(t,e)}}fo.className="softmax",o.serialization.registerClass(fo);class po extends eo{apply(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return o.logSoftmax(t,e)}}po.className="logSoftmax",o.serialization.registerClass(po);class go extends eo{apply(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,o.tidy)((()=>o.mul(o.sigmoid(o.mul(t,e)),t)))}}go.className="swish",o.serialization.registerClass(go);class mo extends eo{apply(t){return(0,o.tidy)((()=>o.mul(t,o.tanh(o.softplus(t)))))}}function yo(t){return t.getClassName()}function vo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Wn(t,o.serialization.SerializationMap.getMap().classNameMap,e,"activation")}function bo(t){if(null==t){const t={className:"linear",config:{}};return vo(t)}if("string"===typeof t){const e={};return e.className=t,e.config={},vo(e)}return t instanceof eo?t:vo(t)}function xo(t){if(null!=t&&"object"!==typeof t)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(t))}mo.className="mish",o.serialization.registerClass(mo);class wo extends o.serialization.Serializable{}class ko extends wo{constructor(t){super(),xo(t),this.l1=null==t||null==t.l1?.01:t.l1,this.l2=null==t||null==t.l2?.01:t.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(t){return(0,o.tidy)((()=>{let e=(0,o.zeros)([1]);return this.hasL1&&(e=(0,o.add)(e,(0,o.sum)(o.mul(this.l1,(0,o.abs)(t))))),this.hasL2&&(e=(0,o.add)(e,(0,o.sum)(o.mul(this.l2,Or(t))))),o.reshape(e,[])}))}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,e){return new t({l1:e.l1,l2:e.l2})}}ko.className="L1L2",o.serialization.registerClass(ko);const _o={l1l2:"L1L2"};function So(t){return jn(t)}function Ao(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Wn(t,o.serialization.SerializationMap.getMap().classNameMap,e,"regularizer")}function Co(t){if(null==t)return null;if("string"===typeof t){return Ao({className:t in _o?_o[t]:t,config:{}})}return t instanceof wo?t:Ao(t)}class Eo extends wi{constructor(t){super(null==t?{}:t),this.supportsMasking=!0,null!=t&&(this.maxValue=t.maxValue)}call(t,e){t=ui(t);let n=(0,o.relu)(t);return null!=this.maxValue&&(n=(0,o.clipByValue)(n,0,this.maxValue)),n}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},e=super.getConfig();return Object.assign(t,e),t}}Eo.className="ReLU",o.serialization.registerClass(Eo);class To extends wi{constructor(t){super(null==t?{}:t),this.DEFAULT_ALPHA=.3,null==t&&(t={}),this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const n=ui(t);return(0,o.leakyRelu)(n,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}To.className="LeakyReLU",o.serialization.registerClass(To);class No extends wi{constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==t&&(t={}),this.supportsMasking=!0,this.alphaInitializer=oi(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Co(t.alphaRegularizer),this.alphaConstraint=Ui(t.alphaConstraint),null==t.sharedAxes)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else{if("number"!==typeof t.sharedAxes)throw new Tn("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(t.sharedAxes));this.sharedAxes=[t.sharedAxes]}}build(t){const e=(t=li(t)).slice(1);if(null!=this.sharedAxes)for(const r of this.sharedAxes)e[r-1]=1;this.alpha=this.addWeight("alpha",e,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const n={};if(null!=this.sharedAxes)for(let r=1;r<t.length;++r)n[r]=t[r];this.inputSpec=[new mi({ndim:t.length,axes:n})],this.built=!0}call(t,e){return t=ui(t),(0,o.prelu)(t,this.alpha.read())}getConfig(){const t={alphaInitializer:ai(this.alphaInitializer),alphaRegularizer:So(this.alphaRegularizer),alphaConstraint:Pi(this.alphaConstraint),sharedAxes:this.sharedAxes},e=super.getConfig();return Object.assign(t,e),t}}No.className="PReLU",o.serialization.registerClass(No);class Do extends wi{constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA=1,null==t&&(t={}),null!=t.alpha&&t.alpha!==this.DEFAULT_ALPHA)throw new Nn("Non-default alpha value (".concat(t.alpha,") is not supported by the ")+"ELU layer yet.");this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const n=ui(t);return(0,o.elu)(n)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}Do.className="ELU",o.serialization.registerClass(Do);class Fo extends wi{constructor(t){super(null==t?{}:t),this.DEFAULT_THETA=1,null==t&&(t={}),this.theta=null==t.theta?this.DEFAULT_THETA:t.theta}call(t,e){const n=ui(t);return(0,o.mul)(n,(0,o.cast)((0,o.greater)(n,this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},e=super.getConfig();return Object.assign(t,e),t}}Fo.className="ThresholdedReLU",o.serialization.registerClass(Fo);class Io extends wi{constructor(t){super(null==t?{}:t),this.DEFAULT_AXIS=1,null==t&&(t={}),this.softmax=(new fo).apply,this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis}call(t,e){return(0,o.tidy)((()=>{let n=ui(t);const r=e.mask;if(null!=r){const t=(0,o.mul)((0,o.sub)((0,o.ones)(n.shape),(0,o.cast)(r,n.dtype)),(0,o.scalar)(-1e9));n=(0,o.add)(n,t)}return this.axis instanceof Array?this.axis.length>1?(0,o.exp)((0,o.sub)(n,(0,o.logSumExp)(n,this.axis,!0))):this.softmax(n,this.axis[0]):this.softmax(n,this.axis)}))}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}function Mo(t,e,n){if("number"===typeof t)return In(t,e);if(t.length!==e)throw new Tn("The ".concat(n," argument must be an integer or tuple of ").concat(e," integers.")+" Received: ".concat(t.length," elements."));for(let i=0;i<e;++i){const a=t[i];if((r=a)!==parseInt(r.toString(),10))throw new Tn("The ".concat(n," argument must be an integer or tuple of ").concat(e)+" integers. Received: ".concat(JSON.stringify(t)," including a")+" non-integer number ".concat(a))}return t;var r}function Oo(t,e,n,r){if(null==t)return t;let i;return i="same"===n?t:t-(e+(e-1)*((arguments.length>4&&void 0!==arguments[4]?arguments[4]:1)-1))+1,Math.floor((i+r-1)/r)}function Ro(t,e,n,r){if(null==t)return null;if("valid"===r)t=t*e+br([n-e,0]);else{if("same"!==r)throw new Tn("Unsupport padding mode: ".concat(r,"."));t*=e}return t}function zo(t,e){return(0,o.tidy)((()=>(sr(e),"channelsFirst"===e?o.transpose(t,[0,2,3,1]):t)))}function Bo(t,e){return(0,o.tidy)((()=>(sr(e),"channelsFirst"===e?o.transpose(t,[0,2,3,4,1]):t)))}function Lo(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",a=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return(0,o.tidy)((()=>{if(null==a&&(a="channelsLast"),sr(a),3!==t.shape.length)throw new Tn("The input of a conv1dWithBias operation should be 3, but is "+"".concat(t.shape.length," instead."));if(3!==e.shape.length)throw new Tn("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new Tn("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(e.shape.length," instead"));if("channelsFirst"===a&&(t=o.transpose(t,[0,2,1])),"causal"===i)throw new Nn("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let c=o.conv1d(t,e,r,"same"===i?"same":"valid","NWC",s);return null!=n&&(c=zr(c,n)),c}))}function Po(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",a=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return(0,o.tidy)((()=>{if(null==a&&(a="channelsLast"),sr(a),3!==t.rank&&4!==t.rank)throw new Tn("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(t.rank,"."));if(3!==e.rank&&4!==e.rank)throw new Tn("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(t.rank,"."));let u=zo(t,a);if("causal"===i)throw new Nn("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=o.fused.conv2d({x:u,filter:e,strides:r,pad:"same"===i?"same":"valid",dilations:s,dataFormat:"NHWC",bias:n,activation:c}),"channelsFirst"===a&&(u=o.transpose(u,[0,3,1,2])),u}))}function jo(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",a=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0;return(0,o.tidy)((()=>{if(null==a&&(a="channelsLast"),sr(a),4!==t.rank&&5!==t.rank)throw new Tn("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(t.rank,"."));if(4!==e.rank&&5!==e.rank)throw new Tn("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(t.rank,"."));let c=Bo(t,a);if("causal"===i)throw new Nn("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return c=o.conv3d(c,e,r,"same"===i?"same":"valid","NDHWC",s),null!=n&&(c=zr(c,n)),"channelsFirst"===a&&(c=o.transpose(c,[0,4,1,2,3])),c}))}Io.className="Softmax",o.serialization.registerClass(Io);class Uo extends wi{constructor(t,e){if(super(e),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Uo.verifyArgs(e),this.rank=t,Xn(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new Nn("Convolution layer for rank other than 1, 2, or 3 (".concat(this.rank,") is ")+"not implemented yet.");if(this.kernelSize=Mo(e.kernelSize,t,"kernelSize"),this.strides=Mo(null==e.strides?1:e.strides,t,"strides"),this.padding=null==e.padding?"valid":e.padding,cr(this.padding),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,sr(this.dataFormat),this.activation=bo(e.activation),this.useBias=null==e.useBias||e.useBias,this.biasInitializer=oi(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Ui(e.biasConstraint),this.biasRegularizer=Co(e.biasRegularizer),this.activityRegularizer=Co(e.activityRegularizer),this.dilationRate=Mo(null==e.dilationRate?1:e.dilationRate,t,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new Tn("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(this.dilationRate)));if(2===this.rank){if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new Tn("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(this.dilationRate)))}else if(3===this.rank)if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new Tn("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(this.dilationRate)))}static verifyArgs(t){if(Mn("kernelSize"in t,"required key 'kernelSize' not in config"),"number"!==typeof t.kernelSize&&!Yn(t.kernelSize,"number",1,3))throw new Tn("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(t.kernelSize),"."))}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:yo(this.activation),useBias:this.useBias,biasInitializer:ai(this.biasInitializer),biasRegularizer:So(this.biasRegularizer),activityRegularizer:So(this.activityRegularizer),biasConstraint:Pi(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}class Wo extends Uo{constructor(t,e){super(t,e),this.kernel=null,Wo.verifyArgs(e),this.filters=e.filters,Xn(this.filters,"filters"),this.kernelInitializer=oi(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Ui(e.kernelConstraint),this.kernelRegularizer=Co(e.kernelRegularizer)}build(t){t=li(t);const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new Tn("The channel dimension of the input should be defined. "+"Found ".concat(t[e]));const n=t[e],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[e]:n}}],this.built=!0}call(t,e){return(0,o.tidy)((()=>{let e;t=ui(t);const n=null==this.bias?null:this.bias.read(),r=$n(this.activation.getClassName());if(null!=r&&2===this.rank)e=Po(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(1===this.rank)e=Lo(t,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)e=Po(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new Nn("convolutions greater than 3D are not implemented yet.");e=jo(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(e=this.activation.apply(e))}return e}))}computeOutputShape(t){t=li(t);const e=[],n="channelsLast"===this.dataFormat?t.slice(1,t.length-1):t.slice(2);for(let i=0;i<n.length;++i){const t=Oo(n[i],this.kernelSize[i],this.padding,this.strides[i],"number"===typeof this.dilationRate?this.dilationRate:this.dilationRate[i]);e.push(t)}let r=[t[0]];return"channelsLast"===this.dataFormat?(r=r.concat(e),r.push(this.filters)):(r.push(this.filters),r=r.concat(e)),r}getConfig(){const t={filters:this.filters,kernelInitializer:ai(this.kernelInitializer),kernelRegularizer:So(this.kernelRegularizer),kernelConstraint:Pi(this.kernelConstraint)},e=super.getConfig();return Object.assign(t,e),t}static verifyArgs(t){if(!("filters"in t)||"number"!==typeof t.filters||t.filters<1)throw new Tn("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(t.filters)))}}class Vo extends Wo{constructor(t){super(2,t),Vo.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if("number"!==typeof t.kernelSize&&!Yn(t.kernelSize,"number",1,2))throw new Tn("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(t.kernelSize),"."))}}Vo.className="Conv2D",o.serialization.registerClass(Vo);class qo extends Wo{constructor(t){super(3,t),qo.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if("number"!==typeof t.kernelSize&&(!Array.isArray(t.kernelSize)||1!==t.kernelSize.length&&3!==t.kernelSize.length))throw new Tn("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(t.kernelSize),"."))}}qo.className="Conv3D",o.serialization.registerClass(qo);class Go extends Vo{constructor(t){if(super(t),this.inputSpec=[new mi({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new Tn("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(this.padding))}build(t){if(4!==(t=li(t)).length)throw new Tn("Input should have rank 4; Received input shape: "+JSON.stringify(t));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new Tn("The channel dimension of the inputs should be defined. Found `None`.");const n=t[e],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new mi({ndim:4,axes:{[e]:n}})],this.built=!0}call(t,e){return o.tidy((()=>{let e=ui(t);if(4!==e.shape.length)throw new Tn("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(e.shape.length));const n=e.shape,r=n[0];let i,a;"channelsFirst"===this.dataFormat?(i=2,a=3):(i=1,a=2);const s=n[i],c=n[a],u=this.kernelSize[0],l=this.kernelSize[1],h=this.strides[0],d=this.strides[1],f=[r,Ro(s,h,u,this.padding),Ro(c,d,l,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(e=o.transpose(e,[0,2,3,1]));let p=o.conv2dTranspose(e,this.kernel.read(),f,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(p=o.transpose(p,[0,3,1,2])),null!=this.bias&&(p=zr(p,this.bias.read(),this.dataFormat)),null!=this.activation&&(p=this.activation.apply(p)),p}))}computeOutputShape(t){const e=(t=li(t)).slice();let n,r,i;"channelsFirst"===this.dataFormat?(n=1,r=2,i=3):(n=3,r=1,i=2);const a=this.kernelSize[0],o=this.kernelSize[1],s=this.strides[0],c=this.strides[1];return e[n]=this.filters,e[r]=Ro(e[r],s,a,this.padding),e[i]=Ro(e[i],c,o,this.padding),e}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}Go.className="Conv2DTranspose",o.serialization.registerClass(Go);class Ho extends qo{constructor(t){if(super(t),this.inputSpec=[new mi({ndim:5})],"same"!==this.padding&&"valid"!==this.padding)throw new Tn("Conv3DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(this.padding))}build(t){if(5!==(t=li(t)).length)throw new Tn("Input should have rank 5; Received input shape: "+JSON.stringify(t));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new Tn("The channel dimension of the inputs should be defined. Found `None`.");const n=t[e],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new mi({ndim:5,axes:{[e]:n}})],this.built=!0}call(t,e){return o.tidy((()=>{let e=ui(t);if(5!==e.shape.length)throw new Tn("Conv3DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(e.shape.length));const n=e.shape,r=n[0];let i,a,s;"channelsFirst"===this.dataFormat?(s=2,i=3,a=4):(s=1,i=2,a=3);const c=n[s],u=n[i],l=n[a],h=this.kernelSize[0],d=this.kernelSize[1],f=this.kernelSize[2],p=this.strides[0],g=this.strides[1],m=this.strides[2],y=[r,Ro(c,p,h,this.padding),Ro(u,g,d,this.padding),Ro(l,m,f,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(e=o.transpose(e,[0,2,3,4,1]));let v=o.conv3dTranspose(e,this.kernel.read(),y,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(v=o.transpose(v,[0,4,1,2,3])),null!==this.bias&&(v=zr(v,this.bias.read(),this.dataFormat)),null!==this.activation&&(v=this.activation.apply(v)),v}))}computeOutputShape(t){const e=(t=li(t)).slice();let n,r,i,a;"channelsFirst"===this.dataFormat?(n=1,r=2,i=3,a=4):(n=4,r=1,i=2,a=3);const o=this.kernelSize[0],s=this.kernelSize[1],c=this.kernelSize[2],u=this.strides[0],l=this.strides[1],h=this.strides[2];return e[n]=this.filters,e[r]=Ro(e[r],u,o,this.padding),e[i]=Ro(e[i],l,s,this.padding),e[a]=Ro(e[a],h,c,this.padding),e}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}Ho.className="Conv3DTranspose",o.serialization.registerClass(Ho);class Yo extends Wo{constructor(t,e){if(super(t,e),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==e.filters)throw new Tn("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=e.kernelInitializer||null!=e.kernelRegularizer||null!=e.kernelConstraint)throw new Tn("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=e.padding&&"same"!==e.padding&&"valid"!==e.padding)throw new Tn("SeparableConv".concat(this.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(e.padding)));this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=oi(e.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Co(e.depthwiseRegularizer),this.depthwiseConstraint=Ui(e.depthwiseConstraint),this.pointwiseInitializer=oi(e.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Co(e.pointwiseRegularizer),this.pointwiseConstraint=Ui(e.pointwiseConstraint)}build(t){if((t=li(t)).length<this.rank+2)throw new Tn("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(t)));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e]||t[e]<0)throw new Tn("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(t[e])));const n=t[e],r=this.kernelSize.concat([n,this.depthMultiplier]),i=[];for(let o=0;o<this.rank;++o)i.push(1);i.push(n*this.depthMultiplier,this.filters);const a=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,a,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,a,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,a,this.biasConstraint):this.bias=null,this.inputSpec=[new mi({ndim:this.rank+2,axes:{[e]:n}})],this.built=!0}call(t,e){return(0,o.tidy)((()=>{let e;if(t=ui(t),1===this.rank)throw new Nn("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(t=o.transpose(t,[0,2,3,1])),e=o.separableConv2d(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(e=zr(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),"channelsFirst"===this.dataFormat&&(e=o.transpose(e,[0,3,1,2])),e}))}getConfig(){const t=super.getConfig();return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=ai(this.depthwiseInitializer),t.pointwiseInitializer=ai(this.pointwiseInitializer),t.depthwiseRegularizer=So(this.depthwiseRegularizer),t.pointwiseRegularizer=So(this.pointwiseRegularizer),t.depthwiseConstraint=Pi(this.depthwiseConstraint),t.pointwiseConstraint=Pi(this.pointwiseConstraint),t}}Yo.className="SeparableConv";class Xo extends Yo{constructor(t){super(2,t)}}Xo.className="SeparableConv2D",o.serialization.registerClass(Xo);class Ko extends Wo{constructor(t){super(1,t),Ko.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if("number"!==typeof t.kernelSize&&!Yn(t.kernelSize,"number",1,1))throw new Tn("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(t.kernelSize),"."))}}Ko.className="Conv1D",o.serialization.registerClass(Ko);class $o extends wi{constructor(t){super(t),"number"===typeof t.cropping?this.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:"number"===typeof t.cropping[0]?this.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:this.cropping=t.cropping,this.dataFormat=void 0===t.dataFormat?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return"channelsFirst"===this.dataFormat?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,e){return(0,o.tidy)((()=>{if(t=ui(t),"channelsLast"===this.dataFormat){const e=Er(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Er(e,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{const e=Er(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Er(e,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}}))}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}$o.className="Cropping2D",o.serialization.registerClass($o);class Zo extends wi{constructor(t){var e;super(t),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==t.size?this.DEFAULT_SIZE:t.size,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,sr(this.dataFormat),this.interpolation=null==t.interpolation?"nearest":t.interpolation,e=this.interpolation,Hn(nr,"InterpolationFormat",e)}computeOutputShape(t){if("channelsFirst"===this.dataFormat){const e=null==t[2]?null:this.size[0]*t[2],n=null==t[3]?null:this.size[1]*t[3];return[t[0],t[1],e,n]}{const e=null==t[1]?null:this.size[0]*t[1],n=null==t[2]?null:this.size[1]*t[2];return[t[0],e,n,t[3]]}}call(t,e){return o.tidy((()=>{let e=ui(t);const n=e.shape;if("channelsFirst"===this.dataFormat){e=o.transpose(e,[0,2,3,1]);const t=this.size[0]*n[2],r=this.size[1]*n[3],i="nearest"===this.interpolation?o.image.resizeNearestNeighbor(e,[t,r]):o.image.resizeBilinear(e,[t,r]);return o.transpose(i,[0,3,1,2])}{const t=this.size[0]*n[1],r=this.size[1]*n[2];return"nearest"===this.interpolation?o.image.resizeNearestNeighbor(e,[t,r]):o.image.resizeBilinear(e,[t,r])}}))}getConfig(){const t={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},e=super.getConfig();return Object.assign(t,e),t}}Zo.className="UpSampling2D",o.serialization.registerClass(Zo);class Qo extends Uo{constructor(t){super(2,t),this.depthwiseKernel=null,this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=oi(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Ui(t.depthwiseConstraint),this.depthwiseRegularizer=Co(t.depthwiseRegularizer)}build(t){if((t=li(t)).length<4)throw new Tn("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(t),"."));const e="channelsFirst"===this.dataFormat?1:3;if(null==t[e]||t[e]<0)throw new Tn("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(t[e],")."));const n=t[e],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return(0,o.tidy)((()=>{let e=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;return(0,o.tidy)((()=>{null==i&&(i="channelsLast"),sr(i);let s=zo(t,i);if(4!==t.rank)throw new Tn("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(t.rank,"-D"));if(4!==e.rank)throw new Tn("depthwiseKernel is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));return s=o.depthwiseConv2d(s,e,n,"same"===r?"same":"valid","NHWC",a),"channelsFirst"===i&&(s=o.transpose(s,[0,3,1,2])),s}))}(t=ui(t),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(e=zr(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),e}))}computeOutputShape(t){t=li(t);const e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,i=Oo(e,this.kernelSize[0],this.padding,this.strides[0]),a=Oo(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[t[0],r,i,a]:[t[0],i,a,r]}getConfig(){const t=super.getConfig();return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=ai(this.depthwiseInitializer),t.depthwiseRegularizer=So(this.depthwiseRegularizer),t.depthwiseConstraint=Pi(this.depthwiseRegularizer),t}}function Jo(t,e,n,r){if(Array.isArray(t)){if(null!=e||null!=n)throw new Tn("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function i(t){return null==t||Array.isArray(t)?t:[t]}return{inputs:t,initialState:e=i(e),constants:n=i(n)}}function ts(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return o.tidy((()=>{const u=e.shape.length;if(u<3)throw new Tn("Input should be at least 3D, but is ".concat(u,"D."));const l=[1,0].concat(xr(2,u));if(e=o.transpose(e,l),null!=a)throw new Nn("The rnn() functoin of the deeplearn.js backend does not support constants yet.");s&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=i&&(i=o.cast(o.cast(i,"bool"),"float32"),i.rank===u-1&&(i=o.expandDims(i,-1)),i=o.transpose(i,l)),r&&(e=o.reverse(e,0),null!=i&&(i=o.reverse(i,0)));const h=[];let d,f=n;const p=e.shape[0],g=o.unstack(e);let m,y;null!=i&&(m=o.unstack(i));for(let e=0;e<p;++e){const n=g[e],r=o.tidy((()=>t(n,f)));if(null==i)d=r[0],f=r[1];else{const t=o.tidy((()=>{const t=m[e],n=o.sub(o.onesLike(t),t);return{output:o.add(o.mul(r[0],t),o.mul(f[0],n)),newStates:f.map(((e,i)=>o.add(o.mul(r[1][i],t),o.mul(e,n))))}}));d=t.output,f=t.newStates}c&&h.push(d)}if(c){const t=1;y=o.stack(h,t)}return[d,y,f]}))}Qo.className="DepthwiseConv2D",o.serialization.registerClass(Qo);class es extends wi{constructor(t){let e;if(super(t),null==t.cell)throw new Tn("cell property is missing for the constructor of RNN.");if(e=Array.isArray(t.cell)?new us({cells:t.cell}):t.cell,null==e.stateSize)throw new Tn("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=e,this.returnSequences=null!=t.returnSequences&&t.returnSequences,this.returnState=null!=t.returnState&&t.returnState,this.goBackwards=null!=t.goBackwards&&t.goBackwards,this._stateful=null!=t.stateful&&t.stateful,this.unroll=null!=t.unroll&&t.unroll,this.supportsMasking=!0,this.inputSpec=[new mi({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(null==this.states_){return xr(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((t=>null))}return this.states_}setStates(t){this.states_=t}computeOutputShape(t){si(t)&&(t=t[0]);let e=this.cell.stateSize;Array.isArray(e)||(e=[e]);const n=e[0];let r;if(r=this.returnSequences?[t[0],t[1],n]:[t[0],n],this.returnState){const n=[];for(const r of e)n.push([t[0],r]);return[r].concat(n)}return r}computeMask(t,e){return o.tidy((()=>{Array.isArray(e)&&(e=e[0]);const t=this.returnSequences?e:null;if(this.returnState){const e=this.states.map((t=>null));return[t].concat(e)}return t}))}get states(){if(null==this.states_){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,e=[];for(let n=0;n<t;++n)e.push(null);return e}return this.states_}set states(t){this.states_=t}build(t){if(null!=this.numConstants)throw new Nn("Constants support is not implemented in RNN yet.");si(t)&&(t=t[0]);const e=this.stateful?t[0]:null,n=t.slice(2);this.inputSpec[0]=new mi({shape:[e,null,...n]});const r=[t[0]].concat(t.slice(2));let i;if(this.cell.build(r),i=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!o.util.arraysEqual(this.stateSpec.map((t=>t.shape[t.shape.length-1])),i))throw new Tn("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=i.map((t=>new mi({shape:[null,t]})));this.stateful&&this.resetStates()}resetStates(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,o.tidy)((()=>{if(!this.stateful)throw new Cn("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape[0];if(null==n)throw new Tn("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((t=>o.zeros([n,t]))):this.states_=[o.zeros([n,this.cell.stateSize])];else if(null==t)o.dispose(this.states_),null!=this.keptStates&&(o.dispose(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((t=>o.zeros([n,t]))):this.states_[0]=o.zeros([n,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new Tn("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), ")+"but it received ".concat(t.length," state value(s). Input ")+"received: ".concat(t));!0===e?this.keptStates.push(this.states_.slice()):o.dispose(this.states_);for(let e=0;e<this.states_.length;++e){const r=t[e],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[e]:this.cell.stateSize,a=[n,i];if(!o.util.arraysEqual(r.shape,a))throw new Tn("State ".concat(e," is incompatible with layer ").concat(this.name,": ")+"expected shape=".concat(a,", received shape=").concat(r.shape));this.states_[e]=r}}this.states_=this.states_.map((t=>o.keep(t.clone())))}))}apply(t,e){let n=null==e?null:e.initialState,r=null==e?null:e.constants;null==e&&(e={});const i=Jo(t,n,r,this.numConstants);t=i.inputs,n=i.initialState,r=i.constants;let a=[],o=[];if(null!=n){e.initialState=n,a=a.concat(n),this.stateSpec=[];for(const t of n)this.stateSpec.push(new mi({shape:t.shape}));o=o.concat(this.stateSpec)}null!=r&&(e.constants=r,a=a.concat(r),this.numConstants=r.length);if(a[0]instanceof yi){const n=[t].concat(a),r=this.inputSpec.concat(o),i=this.inputSpec;this.inputSpec=r;const s=super.apply(n,e);return this.inputSpec=i,s}return super.apply(t,e)}call(t,e){return(0,o.tidy)((()=>{const n=null==e?null:e.mask,r=null==e?null:e.training;let i=null==e?null:e.initialState;t=ui(t),null==i&&(i=this.stateful?this.states_:this.getInitialState(t));const a=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==a)throw new Tn("RNN Layer has ".concat(a," state(s) but was passed ")+"".concat(i.length," initial state(s)."));this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:r},s=ts(((t,e)=>{const n=this.cell.call([t].concat(e),o);return[n[0],n.slice(1)]}),t,i,this.goBackwards,n,null,this.unroll,this.returnSequences),c=s[0],u=s[1],l=s[2];this.stateful&&this.resetStates(l,r);const h=this.returnSequences?u:c;return this.returnState?[h].concat(l):h}))}getInitialState(t){return(0,o.tidy)((()=>{let e=o.zeros(t.shape);return e=o.sum(e,[1,2]),e=Sr(e),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map((t=>t>1?Dr(e,[1,t]):e)):this.cell.stateSize>1?[Dr(e,[1,this.cell.stateSize])]:[e]}))}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t=super.getConfig(),e={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(e.numConstants=this.numConstants);const n=this.cell.getConfig();return this.getClassName()===es.className&&(e.cell={className:this.cell.getClassName(),config:n}),Object.assign(Object.assign(Object.assign({},n),t),e)}static fromConfig(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=Ji(e.cell,n);return new t(Object.assign(e,{cell:r}))}}es.className="RNN",o.serialization.registerClass(es);class ns extends wi{}class rs extends ns{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,Xn(this.units,"units"),this.activation=bo(null==t.activation?this.DEFAULT_ACTIVATION:t.activation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=oi(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=oi(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=oi(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Co(t.kernelRegularizer),this.recurrentRegularizer=Co(t.recurrentRegularizer),this.biasRegularizer=Co(t.biasRegularizer),this.kernelConstraint=Ui(t.kernelConstraint),this.recurrentConstraint=Ui(t.recurrentConstraint),this.biasConstraint=Ui(t.biasConstraint),this.dropout=vr([1,br([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=vr([1,br([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=li(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return(0,o.tidy)((()=>{if(2!==t.length)throw new Tn("SimpleRNNCell expects 2 input Tensors, got ".concat(t.length,"."));let n=t[1];t=t[0];const r=null!=e.training&&e.training;let i;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=ls({ones:()=>o.onesLike(t),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=ls({ones:()=>o.onesLike(n),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,s=this.recurrentDropoutMask;i=Ir(null!=a?o.mul(t,a):t,this.kernel.read()),null!=this.bias&&(i=zr(i,this.bias.read())),null!=s&&(n=o.mul(n,s));let c=o.add(i,Ir(n,this.recurrentKernel.read()));return null!=this.activation&&(c=this.activation.apply(c)),[c,c]}))}getConfig(){const t=super.getConfig(),e={units:this.units,activation:yo(this.activation),useBias:this.useBias,kernelInitializer:ai(this.kernelInitializer),recurrentInitializer:ai(this.recurrentInitializer),biasInitializer:ai(this.biasInitializer),kernelRegularizer:So(this.kernelRegularizer),recurrentRegularizer:So(this.recurrentRegularizer),biasRegularizer:So(this.biasRegularizer),activityRegularizer:So(this.activityRegularizer),kernelConstraint:Pi(this.kernelConstraint),recurrentConstraint:Pi(this.recurrentConstraint),biasConstraint:Pi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},t),e)}}rs.className="SimpleRNNCell",o.serialization.registerClass(rs);class is extends es{constructor(t){t.cell=new rs(t),super(t)}call(t,e){return(0,o.tidy)((()=>{null!=this.cell.dropoutMask&&(o.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(o.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e.mask,r=null==e?null:e.training,i=null==e?null:e.initialState;return super.call(t,{mask:n,training:r,initialState:i})}))}static fromConfig(t,e){return new t(e)}}is.className="SimpleRNN",o.serialization.registerClass(is);class as extends ns{constructor(t){if(super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new Tn("GRUCell does not support reset_after parameter set to true.");this.units=t.units,Xn(this.units,"units"),this.activation=bo(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=bo(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=oi(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=oi(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=oi(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Co(t.kernelRegularizer),this.recurrentRegularizer=Co(t.recurrentRegularizer),this.biasRegularizer=Co(t.biasRegularizer),this.kernelConstraint=Ui(t.kernelConstraint),this.recurrentConstraint=Ui(t.recurrentConstraint),this.biasConstraint=Ui(t.biasConstraint),this.dropout=vr([1,br([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=vr([1,br([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){const e=(t=li(t))[t.length-1];this.kernel=this.addWeight("kernel",[e,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return(0,o.tidy)((()=>{if(2!==t.length)throw new Tn("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(t.length,"."));const n=null!=e.training&&e.training;let r=t[1];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=ls({ones:()=>o.onesLike(t),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=ls({ones:()=>o.onesLike(r),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,a=this.recurrentDropoutMask;let s,c,u;0<this.dropout&&this.dropout<1&&(t=o.mul(t,i[0]));let l=Ir(t,this.kernel.read());this.useBias&&(l=zr(l,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=o.mul(r,a[0]));const h=this.recurrentKernel.read(),[d,f]=o.split(h,[2*this.units,this.units],h.rank-1),p=Ir(r,d),[g,m,y]=o.split(l,3,l.rank-1),[v,b]=o.split(p,2,p.rank-1);s=this.recurrentActivation.apply(o.add(g,v)),c=this.recurrentActivation.apply(o.add(m,b));const x=Ir(o.mul(c,r),f);u=this.activation.apply(o.add(y,x));const w=o.add(o.mul(s,r),o.mul(o.add(1,o.neg(s)),u));return[w,w]}))}getConfig(){const t=super.getConfig(),e={units:this.units,activation:yo(this.activation),recurrentActivation:yo(this.recurrentActivation),useBias:this.useBias,kernelInitializer:ai(this.kernelInitializer),recurrentInitializer:ai(this.recurrentInitializer),biasInitializer:ai(this.biasInitializer),kernelRegularizer:So(this.kernelRegularizer),recurrentRegularizer:So(this.recurrentRegularizer),biasRegularizer:So(this.biasRegularizer),activityRegularizer:So(this.activityRegularizer),kernelConstraint:Pi(this.kernelConstraint),recurrentConstraint:Pi(this.recurrentConstraint),biasConstraint:Pi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},t),e)}}as.className="GRUCell",o.serialization.registerClass(as);class os extends es{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new as(t),super(t)}call(t,e){return(0,o.tidy)((()=>{null!=this.cell.dropoutMask&&(o.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(o.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e.mask,r=null==e?null:e.training,i=null==e?null:e.initialState;return super.call(t,{mask:n,training:r,initialState:i})}))}static fromConfig(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)}}os.className="GRU",o.serialization.registerClass(os);class ss extends ns{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,Xn(this.units,"units"),this.activation=bo(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=bo(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=oi(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=oi(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=oi(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=Co(t.kernelRegularizer),this.recurrentRegularizer=Co(t.recurrentRegularizer),this.biasRegularizer=Co(t.biasRegularizer),this.kernelConstraint=Ui(t.kernelConstraint),this.recurrentConstraint=Ui(t.recurrentConstraint),this.biasConstraint=Ui(t.biasConstraint),this.dropout=vr([1,br([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=vr([1,br([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var e;const n=(t=li(t))[t.length-1];let r;if(this.kernel=this.addWeight("kernel",[n,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){const t=this.biasInitializer,n=this.units;r=new((e=class extends Ur{apply(e,r){const i=t.apply([n]),a=(new Vr).apply([n]),o=t.apply([2*n]);return Nr(Nr(i,a),o)}}).className="CustomInit",e)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,e){return(0,o.tidy)((()=>{const n=null!=e.training&&e.training;if(3!==t.length)throw new Tn("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(t.length,"."));let r=t[1];const i=t[2];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=ls({ones:()=>o.onesLike(t),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=ls({ones:()=>o.onesLike(r),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,s=this.recurrentDropoutMask;let c,u,l,h;0<this.dropout&&this.dropout<1&&(t=o.mul(t,a[0]));let d=Ir(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=o.mul(r,s[0])),d=o.add(d,Ir(r,this.recurrentKernel.read())),this.useBias&&(d=zr(d,this.bias.read()));const[f,p,g,m]=o.split(d,4,d.rank-1);c=this.recurrentActivation.apply(f),u=this.recurrentActivation.apply(p),l=o.add(o.mul(u,i),o.mul(c,this.activation.apply(g))),h=this.recurrentActivation.apply(m);const y=o.mul(h,this.activation.apply(l));return[y,y,l]}))}getConfig(){const t=super.getConfig(),e={units:this.units,activation:yo(this.activation),recurrentActivation:yo(this.recurrentActivation),useBias:this.useBias,kernelInitializer:ai(this.kernelInitializer),recurrentInitializer:ai(this.recurrentInitializer),biasInitializer:ai(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:So(this.kernelRegularizer),recurrentRegularizer:So(this.recurrentRegularizer),biasRegularizer:So(this.biasRegularizer),activityRegularizer:So(this.activityRegularizer),kernelConstraint:Pi(this.kernelConstraint),recurrentConstraint:Pi(this.recurrentConstraint),biasConstraint:Pi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},t),e)}}ss.className="LSTMCell",o.serialization.registerClass(ss);class cs extends es{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new ss(t),super(t)}call(t,e){return(0,o.tidy)((()=>{null!=this.cell.dropoutMask&&(o.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(o.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e.mask,r=null==e?null:e.training,i=null==e?null:e.initialState;return super.call(t,{mask:n,training:r,initialState:i})}))}static fromConfig(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)}}cs.className="LSTM",o.serialization.registerClass(cs);class us extends ns{constructor(t){super(t),this.cells=t.cells}get stateSize(){const t=[];for(const e of this.cells.slice().reverse())Array.isArray(e.stateSize)?t.push(...e.stateSize):t.push(e.stateSize);return t}call(t,e){return(0,o.tidy)((()=>{let n=t.slice(1);const r=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?r.push(n.splice(0,t.stateSize.length)):r.push(n.splice(0,1));r.reverse();const i=[];let a;for(let o=0;o<this.cells.length;++o){const s=this.cells[o];n=r[o],a=0===o?[t[0]].concat(n):[a[0]].concat(n),a=s.call(a,e),i.push(a.slice(1))}n=[];for(const t of i.slice().reverse())n.push(...t);return[a[0]].concat(n)}))}build(t){let e;si(t)&&(t=t[0]),this.cells.forEach(((n,r)=>{dr("RNNCell_".concat(r),(()=>{n.build(t),e=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,t=[t[0],e]}))})),this.built=!0}getConfig(){const t=super.getConfig(),e={cells:this.cells.map((t=>({className:t.getClassName(),config:t.getConfig()})))};return Object.assign(Object.assign({},t),e)}static fromConfig(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=[];for(const i of e.cells)r.push(Ji(i,n));return new t({cells:r})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const e of this.cells)t.push(...e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.cells)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e.concat(t)}return t}getWeights(){const t=[];for(const e of this.cells)t.push(...e.weights);return pi(t)}setWeights(t){const e=[];for(const n of this.cells){const r=n.weights.length,i=t.splice(r);for(let t=0;t<n.weights.length;++t)e.push([n.weights[t],i[t]])}gi(e)}}function ls(t){const{ones:e,rate:n,training:r=!1,count:i=1,dropoutFunc:a}=t,s=()=>null!=a?a(e(),n):Br(e(),n),c=()=>Lr(s,e,r);if(!i||i<=1)return o.keep(c().clone());return Array(i).fill(void 0).map(c).map((t=>o.keep(t.clone())))}us.className="StackedRNNCells",o.serialization.registerClass(us);var hs=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class ds extends es{constructor(t){if(t.unroll)throw new Nn("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(t.cell))throw new Nn("It is not possible at the moment to stack convolutional cells.");super(t),this.inputSpec=[new mi({ndim:5})]}call(t,e){return o.tidy((()=>{if(null!=this.cell.dropoutMask&&(o.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(o.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),e&&e.constants)throw new Tn("ConvRNN2D cell does not support constants");const n=null==e?null:e.mask,r=null==e?null:e.training,i=null==e?null:e.initialState;return super.call(t,{mask:n,training:r,initialState:i})}))}computeOutputShape(t){let e=this.computeSingleOutputShape(t);return this.returnSequences||(e=[e[0],...e.slice(2)]),this.returnState&&(e=[e,...Array(2).fill([t[0],...e.slice(-3)])]),e}getInitialState(t){return o.tidy((()=>{const{stateSize:e}=this.cell,n=t.shape,r=this.computeSingleOutputShape(n),i=[r[0],...r.slice(2)],a=o.zeros(i);return Array.isArray(e)?Array(e.length).fill(a):[a]}))}resetStates(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];o.tidy((()=>{if(!this.stateful)throw new Cn("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape,r=this.computeSingleOutputShape(n),i=[r[0],...r.slice(2)];if(null==n[0])throw new Tn("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((()=>o.zeros(i))):this.states_=[o.zeros(i)];else if(null==t)o.dispose(this.states_),null!=this.keptStates&&(o.dispose(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((()=>o.zeros(i))):this.states_[0]=o.zeros(i);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new Tn("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), ")+"but it received ".concat(t.length," state value(s). Input ")+"received: ".concat(t));e?this.keptStates.push(this.states_.slice()):o.dispose(this.states_);for(let e=0;e<this.states_.length;++e){const n=t[e],r=i;if(!o.util.arraysEqual(n.shape,r))throw new Tn("State ".concat(e," is incompatible with layer ").concat(this.name,": ")+"expected shape=".concat(r,", received shape=").concat(n.shape));this.states_[e]=n}}this.states_=this.states_.map((t=>o.keep(t.clone())))}))}computeSingleOutputShape(t){const{dataFormat:e,filters:n,kernelSize:r,padding:i,strides:a,dilationRate:o}=this.cell,s="channelsFirst"===e,c=t[s?3:2],u=t[s?4:3],l=Oo(c,r[0],i,a[0],o[0]),h=Oo(u,r[1],i,a[1],o[1]);return[...t.slice(0,2),...s?[n,l,h]:[l,h,n]]}}ds.className="ConvRNN2D";class fs extends ss{constructor(t){const{filters:e,kernelSize:n,strides:r,padding:i,dataFormat:a,dilationRate:o}=t;super(Object.assign(Object.assign({},t),{units:e})),this.filters=e,Xn(this.filters,"filters"),this.kernelSize=Mo(n,2,"kernelSize"),this.kernelSize.forEach((t=>Xn(t,"kernelSize"))),this.strides=Mo(r||1,2,"strides"),this.strides.forEach((t=>Xn(t,"strides"))),this.padding=i||"valid",cr(this.padding),this.dataFormat=a||"channelsLast",sr(this.dataFormat),this.dilationRate=Mo(o||1,2,"dilationRate"),this.dilationRate.forEach((t=>Xn(t,"dilationRate")))}build(t){var e;t=li(t);const n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n])throw new Tn("The channel dimension of the input should be defined. "+"Found ".concat(t[n]));const r=t[n],i=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let t;if(this.unitForgetBias){const n=this.biasInitializer,r=this.filters;t=new((e=class extends Ur{apply(t,e){return Tr([n.apply([r]),o.ones([r]),n.apply([2*r])])}}).className="CustomInit",e)}else t=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,t,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(t,e){return o.tidy((()=>{if(3!==t.length)throw new Tn("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+"".concat(t.length,"."));const n=e.training||!1,r=t[0],i=t[1],a=t[2];0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=ls({ones:()=>o.onesLike(r),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const s=this.dropoutMask,c=(t,e,n)=>e&&e[n]?o.mul(e[n],t):t;let u=c(r,s,0),l=c(r,s,1),h=c(r,s,2),d=c(r,s,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=ls({ones:()=>o.onesLike(i),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const f=this.recurrentDropoutMask;let p=c(i,f,0),g=c(i,f,1),m=c(i,f,2),y=c(i,f,3);const[v,b,x,w]=o.split(this.kernel.read(),4,3),[k,_,S,A]=this.useBias?o.split(this.bias.read(),4):[null,null,null,null];u=this.inputConv(u,v,k,this.padding),l=this.inputConv(l,b,_,this.padding),h=this.inputConv(h,x,S,this.padding),d=this.inputConv(d,w,A,this.padding);const[C,E,T,N]=o.split(this.recurrentKernel.read(),4,3);p=this.recurrentConv(p,C),g=this.recurrentConv(g,E),m=this.recurrentConv(m,T),y=this.recurrentConv(y,N);const D=this.recurrentActivation.apply(o.add(u,p)),F=this.recurrentActivation.apply(o.add(l,g)),I=o.add(o.mul(F,a),o.mul(D,this.activation.apply(o.add(h,m)))),M=o.mul(this.recurrentActivation.apply(o.add(d,y)),this.activation.apply(I));return[M,M,I]}))}getConfig(){const t=super.getConfig(),{units:e}=t,n=hs(t,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),r)}inputConv(t,e,n,r){const i=o.conv2d(t,e,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?zr(i,n,this.dataFormat):i}recurrentConv(t,e){return o.conv2d(t,e,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}fs.className="ConvLSTM2DCell",o.serialization.registerClass(fs);class ps extends ds{constructor(t){const e=new fs(t);super(Object.assign(Object.assign({},t),{cell:e}))}static fromConfig(t,e){return new t(e)}}ps.className="ConvLSTM2D",o.serialization.registerClass(ps);class gs extends wi{constructor(t){super(t),this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(null==this.noiseShape)return this.noiseShape;const e=t.shape,n=[];for(let r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?e[r]:this.noiseShape[r]);return n}call(t,e){return(0,o.tidy)((()=>{this.invokeCallHook(t,e);const n=ui(t);if(0<this.rate&&this.rate<1){const t=null!=e.training&&e.training,r=this.getNoiseShape(n);return Lr((()=>Br(n,this.rate,r,this.seed)),(()=>n),t)}return t}))}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},e=super.getConfig();return Object.assign(t,e),t}dispose(){return super.dispose()}}gs.className="Dropout",o.serialization.registerClass(gs);class ms extends gs{constructor(t){super(t),this.inputSpec=[{ndim:3}]}getNoiseShape(t){const e=t.shape;return[e[0],1,e[2]]}}ms.className="SpatialDropout1D",o.serialization.registerClass(ms);class ys extends wi{constructor(t){if(super(t),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==t.batchInputShape&&null==t.inputShape&&null!=t.inputDim){let e=null;null!=t.batchSize&&(e=t.batchSize),this.batchInputShape=[e,t.inputDim]}this.units=t.units,Xn(this.units,"units"),this.activation=bo(t.activation),null!=t.useBias&&(this.useBias=t.useBias),this.kernelInitializer=oi(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=oi(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Ui(t.kernelConstraint),this.biasConstraint=Ui(t.biasConstraint),this.kernelRegularizer=Co(t.kernelRegularizer),this.biasRegularizer=Co(t.biasRegularizer),this.activityRegularizer=Co(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){const e=(t=li(t))[t.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[e,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:e}}],this.built=!0}computeOutputShape(t){const e=(t=li(t)).slice();return e[e.length-1]=this.units,e}call(t,e){return(0,o.tidy)((()=>{this.invokeCallHook(t,e);const n=ui(t),r=$n(this.activation.getClassName());let i;return null!=r?i=Ir(n,this.kernel.read(),r,this.bias?this.bias.read():null):(i=Ir(n,this.kernel.read()),null!=this.bias&&(i=zr(i,this.bias.read())),null!=this.activation&&(i=this.activation.apply(i))),i}))}getConfig(){const t={units:this.units,activation:yo(this.activation),useBias:this.useBias,kernelInitializer:ai(this.kernelInitializer),biasInitializer:ai(this.biasInitializer),kernelRegularizer:So(this.kernelRegularizer),biasRegularizer:So(this.biasRegularizer),activityRegularizer:So(this.activityRegularizer),kernelConstraint:Pi(this.kernelConstraint),biasConstraint:Pi(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}ys.className="Dense",o.serialization.registerClass(ys);class vs extends wi{constructor(t){super(t=t||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=li(t);for(const e of t.slice(1))if(null==e)throw new Tn('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(t.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.');return[t[0],yr(t,1)]}call(t,e){return(0,o.tidy)((()=>{this.invokeCallHook(t,e);let n=ui(t);if("channelsFirst"===this.dataFormat&&n.rank>1){const t=[0];for(let e=2;e<n.rank;++e)t.push(e);t.push(1),n=(0,o.transpose)(n,t)}return function(t){if(t.rank<=1)throw new Tn("batchFlatten requires a minimum rank of 2. Got rank: ".concat(t.rank,"."));const e=[t.shape[0],yr(t.shape,1)];return o.reshape(t,e)}(n)}))}getConfig(){const t={};null!=this.dataFormat&&(t.dataFormat=this.dataFormat);const e=super.getConfig();return Object.assign(t,e),t}}vs.className="Flatten",o.serialization.registerClass(vs);class bs extends wi{constructor(t){super(t),this.supportsMasking=!0,this.activation=bo(t.activation)}call(t,e){return(0,o.tidy)((()=>{this.invokeCallHook(t,e);const n=ui(t);return this.activation.apply(n)}))}getConfig(){const t={activation:yo(this.activation)},e=super.getConfig();return Object.assign(t,e),t}}bs.className="Activation",o.serialization.registerClass(bs);class xs extends wi{constructor(t){super(t),this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,e){return(0,o.tidy)((()=>{return t=ui(t),e=t,n=this.n,(0,o.tidy)((()=>{if(2!==e.shape.length)throw new Tn("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(e.shape.length," tensor."));return Dr(Sr(e,1),[1,n,1])}));var e,n}))}getConfig(){const t={n:this.n},e=super.getConfig();return Object.assign(t,e),t}}xs.className="RepeatVector",o.serialization.registerClass(xs);class ws extends wi{constructor(t){super(t),this.targetShape=t.targetShape;for(let e=0;e<this.targetShape.length;++e)this.isUnknown(this.targetShape[e])&&(this.targetShape[e]=null)}isUnknown(t){return t<0||null==t}fixUnknownDimension(t,e){const n="Total size of new array must be unchanged.",r=e.slice();let i=1,a=null;for(let s=0;s<r.length;++s){const t=r[s];if(this.isUnknown(t)){if(null!==a)throw new Tn("Can only specifiy one unknown dimension.");a=s}else i*=t}const o=yr(t);if(null!==a){if(0===i||o%i!==0)throw new Tn(n);r[a]=o/i}else if(o!==i)throw new Tn(n);return r}computeOutputShape(t){let e=!1;for(let n=0;n<t.length;++n)if(this.isUnknown(t[n])){e=!0;break}return e?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,e){return(0,o.tidy)((()=>{this.invokeCallHook(t,e);const n=ui(t),r=n.shape,i=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return(0,o.reshape)(n,i)}))}getConfig(){const t={targetShape:this.targetShape},e=super.getConfig();return Object.assign(t,e),t}}ws.className="Reshape",o.serialization.registerClass(ws);class ks extends wi{constructor(t){if(super(t),null==t.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(t.dims," instead."));const e=xr(1,t.dims.length+1);if(!o.util.arraysEqual(t.dims.slice().sort(),e))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new mi({ndim:this.dims.length+1})]}computeOutputShape(t){const e=(t=li(t)).slice();return this.dims.forEach(((n,r)=>{e[r+1]=t[n]})),e}call(t,e){return(0,o.transpose)(ui(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},e=super.getConfig();return Object.assign(t,e),t}}ks.className="Permute",o.serialization.registerClass(ks);class _s extends wi{constructor(t){super(null==t?{}:t),this.supportsMasking=!0,this.maskValue=null!=t?null==t.maskValue?0:t.maskValue:0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={maskValue:this.maskValue};return Object.assign(e,t),e}computeMask(t,e){const n=ui(t);return(0,o.any)((0,o.notEqual)(n,this.maskValue),-1)}call(t,e){return(0,o.tidy)((()=>{this.invokeCallHook(t,e);const n=ui(t),r=(0,o.any)((0,o.notEqual)(n,this.maskValue),-1,!0);return(0,o.mul)(n,(0,o.cast)(r,n.dtype))}))}}_s.className="Masking",o.serialization.registerClass(_s);class Ss extends wi{constructor(t){if(super(t),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==t.batchInputShape&&null==t.inputShape){let e=null;null!=t.batchSize&&(e=t.batchSize),null==t.inputLength?this.batchInputShape=[e,null]:this.batchInputShape=[e].concat(zn(t.inputLength))}this.inputDim=t.inputDim,Xn(this.inputDim,"inputDim"),this.outputDim=t.outputDim,Xn(this.outputDim,"outputDim"),this.embeddingsInitializer=oi(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Co(t.embeddingsRegularizer),this.activityRegularizer=Co(t.activityRegularizer),this.embeddingsConstraint=Ui(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,e){return(0,o.tidy)((()=>this.maskZero?(t=ui(t),(0,o.notEqual)(t,(0,o.zerosLike)(t))):null))}computeOutputShape(t){if(t=li(t),null==this.inputLength)return[...t,this.outputDim];const e=zn(this.inputLength);if(e.length!==t.length-1)throw new Tn('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(t));{let n=0;for(let r=0;r<e.length;++r){const i=e[r],a=t[r+1];if(null!=i&&null!=a&&i!==a)throw new Tn('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(t));null==i&&(e[n]=a),n++}}return[t[0],...e,this.outputDim]}call(t,e){return(0,o.tidy)((()=>{this.invokeCallHook(t,e);let n=ui(t);"int32"!==n.dtype&&(n=_r(n,"int32"));const r=Mr(this.embeddings.read(),(0,o.reshape)(n,[n.size]));return(0,o.reshape)(r,li(this.computeOutputShape(n.shape)))}))}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:ai(this.embeddingsInitializer),embeddingsRegularizer:So(this.embeddingsRegularizer),activityRegularizer:So(this.activityRegularizer),embeddingsConstraint:Pi(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},e=super.getConfig();return Object.assign(t,e),t}}Ss.className="Embedding",o.serialization.registerClass(Ss);class As extends wi{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new Nn}computeElementwiseOpOutputShape(t,e){if(null==t||null==e)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(0===e.length)return t;const n=t.slice(0,t.length-e.length);for(let r=0;r<e.length;++r){const i=t[t.length-e.length+r],a=e[r];if(null==i||null==a||i<0||a<0)n.push(null);else if(1===i)n.push(a);else if(1===a)n.push(i);else{if(i!==a)throw new Tn("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));n.push(i)}}return n}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[li(t)]),t.length<2)throw new Tn("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(t.length," input(s)."));let e=[];for(const i of t)null!=i&&null!==i[0]&&e.push(i[0]);if(e=qn(e),e.length>1)throw new Tn("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(t),"."));let n=null==t[0]?null:t[0].slice(1);for(let i=1;i<t.length;++i){const e=null==t[i]?null:t[i].slice(1);n=this.computeElementwiseOpOutputShape(n,e)}const r=t.map((t=>t.length));-1===t.indexOf(null)&&1===qn(r).length?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,e){return(0,o.tidy)((()=>{if(this.reshapeRequired){const e=[],n=t.map((t=>t.rank));if(-1===n.indexOf(null)){const r=br(n);for(let n of t){const t=n.rank;for(let e=0;e<r-t;++e)n=Sr(n,1);e.push(n)}return this.mergeFunction(e)}{let n=!1;for(const a of t){const t=a.rank;if(null==t){const t=a.shape,r=t[0],i=t.slice(1).concat([r]);let s=o.reshape(a,[r].concat(yr(t.slice(1))));s=o.transpose(s,[1,0]),s=o.reshape(s,i),e.push(s),n=!0}else if(t>1){const r=xr(1,t).concat([0]);e.push(o.transpose(a,r)),n=!0}else e.push(a)}let r=this.mergeFunction(e);const i=r.rank;if(n)if(null==i){const t=r.shape,e=t[t.length-1],n=[e].concat(t.slice(0,t.length-1));r=o.reshape(o.transpose(o.reshape(r,[-1,e]),[1,0]),n)}else if(i>1){const t=[i-1].concat(xr(0,i-1));r=o.transpose(r,t)}return r}}return this.mergeFunction(t)}))}computeOutputShape(t){let e;e=null==t[0]?null:t[0].slice(1);for(let r=1;r<t.length;++r){const n=null==t[r]?null:t[r].slice(1);e=this.computeElementwiseOpOutputShape(e,n)}let n=[];for(const r of t)null!=r&&null!==r[0]&&n.push(r[0]);return n=qn(n),e=1===n.length?n.concat(e):[null].concat(e),e}computeMask(t,e){return o.tidy((()=>{if(null==e)return null;if(!Array.isArray(e))throw new Tn("`mask` should be an Array");if(!Array.isArray(t))throw new Tn("`inputs` should be an Array");if(e.length!==t.length)throw new Tn("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(t.length," vs ").concat(e.length,")"));if(e.every((t=>null==t)))return null;let n=(e=e.map((t=>null==t?t:o.expandDims(t,0))))[0];for(let t=1;t<e.length-1;++t)n=o.logicalAnd(n,e[t]);return n}))}}class Cs extends As{constructor(t){super(t)}mergeFunction(t){return(0,o.tidy)((()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=o.add(e,t[n]);return e}))}}Cs.className="Add",o.serialization.registerClass(Cs);class Es extends As{constructor(t){super(t)}mergeFunction(t){return(0,o.tidy)((()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=o.mul(e,t[n]);return e}))}}Es.className="Multiply",o.serialization.registerClass(Es);class Ts extends As{constructor(t){super(t)}mergeFunction(t){return(0,o.tidy)((()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=o.add(e,t[n]);return o.mul(1/t.length,e)}))}}Ts.className="Average",o.serialization.registerClass(Ts);class Ns extends As{constructor(t){super(t)}mergeFunction(t){return(0,o.tidy)((()=>{let e=t[0];for(let n=1;n<t.length;++n)e=o.maximum(e,t[n]);return e}))}}Ns.className="Maximum",o.serialization.registerClass(Ns);class Ds extends As{constructor(t){super(t)}mergeFunction(t){return(0,o.tidy)((()=>{let e=t[0];for(let n=1;n<t.length;++n)e=o.minimum(e,t[n]);return e}))}}Ds.className="Minimum",o.serialization.registerClass(Ds);class Fs extends As{constructor(t){super(t),this.DEFAULT_AXIS=-1,null==t&&(t={}),this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!Array.isArray(t)||!Array.isArray(t[0])||1===t.length)throw new Tn("A `Concatenate` layer should be called on a list of at least 2 inputs");let e=!0;for(const r of t)if(null!=r){e=!1;break}if(e)return;const n=[];for(let r=0;r<t.length;++r){const e=t[r].slice();e.splice(this.axis,1);let i=!1;for(const t of n)if(o.util.arraysEqual(t,e)){i=!0;break}i||n.push(e)}if(n.length>1)throw new Tn("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return(0,o.tidy)((()=>Tr(t,this.axis)))}computeOutputShape(t){if(!Array.isArray(t)||!Array.isArray(t[0]))throw new Tn("A `Concatenate` layer should be called on a list of inputs.");const e=t,n=e[0].slice(),r=this.axis<0?n.length+this.axis:this.axis;for(const i of e.slice(1)){if(null==n[r]||null==i[r]){n[r]=null;break}n[r]+=i[r]}return n}computeMask(t,e){if(null==e)return null;if(!Array.isArray(e))throw new Tn("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new Tn("`inputs` should be an array for Concatenate");if(e.length!==t.length)throw new Tn("Mismatch in the length of mask (".concat(e.length,") ")+"and the legnth of inputs (".concat(t.length,")"));return o.tidy((()=>{let n=!0;if(e.forEach((t=>{null==t||(n=!1)})),n)return null;const r=[];for(let a=0;a<t.length;++a)null==e[a]?r.push(o.cast(o.onesLike(t[a]),"bool")):e[a].rank<t[a].rank?r.push(o.expandDims(e[a],-1)):r.push(e[a]);const i=o.concat(r,this.axis);return o.all(i,-1,!1)}))}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}function Is(t,e){for(;t<0;)t+=e;return t}Fs.className="Concatenate",o.serialization.registerClass(Fs);class Ms extends As{constructor(t){super(t),this.axes=t.axes,this.normalize=null!=t.normalize&&t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){o.util.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),(()=>"A `Dot` layer should be called on a list of exactly 2 inputs."));const e=t[0],n=t[1];if(e.length>3||n.length>3)throw new Nn("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(e,n);if(e[r[0]]!==n[r[1]])throw new Tn("Dimension incompatibility: "+"".concat(e[r[0]]," !== ").concat(n[r[1]]))}mergeFunction(t){if(2!==t.length)throw new Tn("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(t.length," input(s)."));let e,n=t[0],r=t[1];return e=Array.isArray(this.axes)?this.axes.map(((e,n)=>Is(e,t[n].shape.length))):[Is(this.axes,n.shape.length),Is(this.axes,r.shape.length)],this.normalize&&(n=ta(n,e[0]),r=ta(r,e[1])),function(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Nn("batchDot is not implemented for tensors of 4D or higher rank yet");if(o.util.assert(t.shape.length>=2,(()=>"batchDot requires the rank of x to be >= 2, "+"but got ".concat(t.shape.length))),o.util.assert(t.shape.length>=2,(()=>"batchDot requires the rank of y to be >= 2, "+"but got ".concat(e.shape.length))),"number"===typeof n&&(n=[n,n]),"complex64"===t.dtype||"complex64"===e.dtype)throw new Nn("batchDot is not implemented for complex64-type Tensors yet.");const r=t.shape.length,i=e.shape.length;null==n&&(n=[r-1,i-2]);const a=n;return o.tidy((()=>{let n,s;if(r>i){n=r-i;const t=[];for(let e=0;e<n;++e)t.push(1);e=o.reshape(e,e.shape.concat(t))}else if(i>r){n=i-r;const e=[];for(let t=0;t<n;++t)e.push(1);t=o.reshape(t,t.shape.concat(e))}else n=0;if(2===t.shape.length&&2===e.shape.length)s=a[0]===a[1]?o.sum(o.mul(t,e),a[0]):o.sum(o.mul(o.transpose(t,[1,0]),e),a[1]);else{const n=a[0]!==t.shape.length-1,r=a[1]===e.shape.length-1;s=o.matMul(t,e,n,r)}if(n>0){let t;t=r>i?r+i-3:r-1;const e=[];for(let r=t;r<t+n;++r)e.push(r);s=o.squeeze(s,e)}return 1===s.shape.length&&(s=o.expandDims(s,1)),s}))}(n,r,e)}interpretAxes(t,e){let n;return n=Array.isArray(this.axes)?this.axes:[Is(this.axes,t.length),Is(this.axes,e.length)],n}computeOutputShape(t){o.util.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),(()=>"A `Dot` layer should be called on a list of exactly 2 inputs."));const e=t[0].slice(),n=t[1].slice();if(e.length>3||n.length>3)throw new Nn("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(e,n);e.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);const i=e.concat(n);return 1===i.length&&i.push(1),i}computeMask(t,e){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},e=super.getConfig();return Object.assign(t,e),t}}Ms.className="Dot",o.serialization.registerClass(Ms);class Os extends wi{constructor(t){super(t),this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={stddev:this.stddev};return Object.assign(e,t),e}call(t,e){return(0,o.tidy)((()=>{this.invokeCallHook(t,e);const n=ui(t);return Lr((()=>(0,o.add)(Fr(n.shape,0,this.stddev),n)),(()=>n),e.training||!1)}))}}Os.className="GaussianNoise",o.serialization.registerClass(Os);class Rs extends wi{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return(0,o.tidy)((()=>{this.invokeCallHook(t,e);const n=ui(t);if(this.rate>0&&this.rate<1){return Lr((()=>{const t=Math.sqrt(this.rate/(1-this.rate));return(0,o.mul)(n,Fr(n.shape,1,t))}),(()=>n),e.training||!1)}return n}))}}Rs.className="GaussianDropout",o.serialization.registerClass(Rs);class zs extends wi{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||ui(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return(0,o.tidy)((()=>{if(this.rate<1&&this.rate>0){const n=this._getNoiseShape(t),r=()=>{const e=ui(t),r=-1.7580993408473766;let i=(0,o.greaterEqual)((0,o.randomUniform)(n),this.rate);i=_r(i,"float32");const a=((1-this.rate)*(1+this.rate*r**2))**-.5,s=-a*r*this.rate,c=(0,o.add)((0,o.mul)(e,i),(0,o.mul)((0,o.add)(i,-1),r));return(0,o.add)((0,o.mul)(c,a),s)};return Lr(r,(()=>ui(t)),e.training||!1)}return t}))}}function Bs(t,e,n,r,i){let a,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===t.rank)a=o.batchNorm2d(t,e,n,r,i,s);else if(3===t.rank)a=o.batchNorm3d(t,e,n,r,i,s);else{if(4!==t.rank)throw new Nn("batchNormalization is not implemented for array of rank ".concat(t.rank," ")+"yet");a=o.batchNorm4d(t,e,n,r,i,s)}return a}function Ls(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return o.util.arraysEqual(r.slice().sort(),xr(0,t.rank-1))?function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return(0,o.tidy)((()=>{const a=o.moments(t,r),s=a.mean,c=a.variance;return[Bs(t,s,c,n,e,i),s,c]}))}(t,e,n,r,i):function(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return(0,o.tidy)((()=>{const a=o.moments(t,r),s=a.mean,c=a.variance,u=[];for(const e of xr(0,t.rank))-1!==r.indexOf(e)?u.push(1):u.push(t.shape[e]);const l=(0,o.reshape)(s,u),h=(0,o.reshape)(c,u),d=null==e?null:(0,o.reshape)(e,u),f=null==n?null:(0,o.reshape)(n,u);return[Bs(t,l,h,f,d,i),s,c]}))}(t,e,n,r,i)}zs.className="AlphaDropout",o.serialization.registerClass(zs);class Ps extends wi{constructor(t){null==t&&(t={}),super(t),this.supportsMasking=!0,this.axis=null==t.axis?-1:t.axis,this.momentum=null==t.momentum?.99:t.momentum,this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=oi(t.betaInitializer||"zeros"),this.gammaInitializer=oi(t.gammaInitializer||"ones"),this.movingMeanInitializer=oi(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=oi(t.movingVarianceInitializer||"ones"),this.betaConstraint=Ui(t.betaConstraint),this.gammaConstraint=Ui(t.gammaConstraint),this.betaRegularizer=Co(t.betaRegularizer),this.gammaRegularizer=Co(t.gammaRegularizer)}build(t){t=li(t);const e=this.axis>=0?this.axis:this.axis+t.length,n=t[e];if(null==n)throw new Tn("Axis ".concat(e," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(t),"."));this.inputSpec=[new mi({ndim:t.length,axes:{[e]:n}})];const r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,e){return(0,o.tidy)((()=>{const n=null!=e.training&&e.training,r=ui(t),i=r.shape,a=i.length,s=xr(0,a),c=this.axis>=0?this.axis:this.axis+a;s.splice(c,1);const u=In(1,a);u[c]=i[c];const l=s.slice();l.sort();const h=!o.util.arraysEqual(l,xr(0,a).slice(0,a-1));if(!n)return(()=>{if(h){const t=(0,o.reshape)(this.movingMean.read(),u),e=(0,o.reshape)(this.movingVariance.read(),u),n=this.center?(0,o.reshape)(this.beta.read(),u):null,i=this.scale?(0,o.reshape)(this.gamma.read(),u):null;return Bs(r,t,e,n,i,this.epsilon)}return Bs(r,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();const[d,f,p]=Ls(r,this.gamma.read(),this.beta.read(),s,this.epsilon),g=(t,e,n)=>{o.tidy((()=>{const r=1-n,i=t.read(),a=o.mul(o.sub(i,e),r);t.write(o.sub(i,a))}))};return(()=>{g(this.movingMean,f,this.momentum),g(this.movingVariance,p,this.momentum)})(),d}))}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:ai(this.betaInitializer),gammaInitializer:ai(this.gammaInitializer),movingMeanInitializer:ai(this.movingMeanInitializer),movingVarianceInitializer:ai(this.movingVarianceInitializer),betaRegularizer:So(this.betaRegularizer),gammaRegularizer:So(this.gammaRegularizer),betaConstraint:Pi(this.betaConstraint),gammaConstraint:Pi(this.gammaConstraint)},e=super.getConfig();return Object.assign(t,e),t}}Ps.className="BatchNormalization",o.serialization.registerClass(Ps);class js extends wi{constructor(t){if(null==t&&(t={}),super(t),this.axis=null==t.axis?-1:t.axis,"number"===typeof this.axis){if(!Number.isInteger(this.axis))throw new Error("Expected axis to be an integer, but received ".concat(this.axis))}else{if(!Array.isArray(this.axis))throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(this.axis)));for(const t of this.axis)if(!Number.isInteger(t))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(this.axis)))}this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=oi(t.betaInitializer||"zeros"),this.gammaInitializer=oi(t.gammaInitializer||"ones"),this.betaRegularizer=Co(t.betaRegularizer),this.gammaRegularizer=Co(t.gammaRegularizer),this.supportsMasking=!0}build(t){const e=(t=li(t)).length;"number"===typeof this.axis&&(this.axis=[this.axis]);for(let r=0;r<this.axis.length;++r)this.axis[r]<0&&(this.axis[r]+=e);for(const r of this.axis)if(r<0||r>=e)throw new Error("Invalid axis: ".concat(r));if(this.axis.length!==qn(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));const n=this.axis.map((e=>t[e]));this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,true):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,true):this.beta=null,this.built=!0}call(t,e){const n=ui(t),r=n.shape,i=r.length;return(0,o.tidy)((()=>{let{mean:t,variance:e}=(0,o.moments)(n,this.axis,!0);const a=In(1,i);for(const n of this.axis)a[n]=r[n];const s=t=>null!=t&&t.shape.length!==i?o.reshape(t,a):t;let c=this.scale?s(this.gamma.read()):null,u=this.center?s(this.beta.read()):null;const l=[],h=[];for(let n=0;n<i;++n)-1!==this.axis.indexOf(n)?(l.push(r[n]),h.push(1)):(l.push(1),h.push(r[n]));return t=o.tile(t,l),e=o.tile(e,l),null!=c&&(c=o.tile(c,h)),null!=u&&(u=o.tile(u,h)),Bs(n,t,e,u,c,this.epsilon)}))}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:ai(this.betaInitializer),gammaInitializer:ai(this.gammaInitializer),betaRegularizer:So(this.betaRegularizer),gammaRegularizer:So(this.gammaRegularizer)},e=super.getConfig();return Object.assign(t,e),t}}js.className="LayerNormalization",o.serialization.registerClass(js);class Us extends wi{constructor(t){if(null==t&&(t={}),super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,null==t.padding)this.padding=[[1,1],[1,1]];else if("number"===typeof t.padding)this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,2!==t.padding.length)throw new Tn("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(t.padding.length," array."));let e,n;if("number"===typeof t.padding[0])e=[t.padding[0],t.padding[0]],n=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,2!==t.padding[0].length)throw new Tn("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(t.padding[0].length," array."));if(e=t.padding[0],2!==t.padding[1].length)throw new Tn("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(t.padding[1].length," array."));n=t.padding[1]}this.padding=[e,n]}this.inputSpec=[new mi({ndim:4})]}computeOutputShape(t){let e,n;return t=li(t),"channelsFirst"===this.dataFormat?(e=null!=t[2]&&t[2]>=0?t[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[3]&&t[3]>=0?t[3]+this.padding[1][0]+this.padding[1][1]:null,[t[0],t[1],e,n]):(e=null!=t[1]&&t[1]>=0?t[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[2]&&t[2]>=0?t[2]+this.padding[1][0]+this.padding[1][1]:null,[t[0],e,n,t[3]])}call(t,e){return(0,o.tidy)((()=>{return e=ui(t),n=this.padding,r=this.dataFormat,(0,o.tidy)((()=>{if(4!==e.rank)throw new Tn("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(e.rank,"-D tensor."));if(null==n&&(n=[[1,1],[1,1]]),2!==n.length||2!==n[0].length||2!==n[1].length)throw new Tn("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==r&&(r="channelsLast"),"channelsLast"!==r&&"channelsFirst"!==r)throw new Tn("Unknown data format: ".concat(r,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");let t;return t="channelsFirst"===r?[[0,0],[0,0],n[0],n[1]]:[[0,0],n[0],n[1],[0,0]],o.pad(e,t)}));var e,n,r}))}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}function Ws(t,e,n,r,i,a){return(0,o.tidy)((()=>{let s;sr(i),ur(a),cr(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==a&&(a="max"),t=zo(t,i);const c="same"===r?"same":"valid";return s="max"===a?o.maxPool(t,e,n,c):o.avgPool(t,e,n,c),"channelsFirst"===i&&(s=o.transpose(s,[0,3,1,2])),s}))}function Vs(t,e,n,r,i,a){return(0,o.tidy)((()=>{let s;sr(i),ur(a),cr(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==a&&(a="max"),t=Bo(t,i);const c="same"===r?"same":"valid";return s="max"===a?o.maxPool3d(t,e,n,c):o.avgPool3d(t,e,n,c),"channelsFirst"===i&&(s=o.transpose(s,[0,4,1,2,3])),s}))}Us.className="ZeroPadding2D",o.serialization.registerClass(Us);class qs extends wi{constructor(t){if(null==t.poolSize&&(t.poolSize=2),super(t),"number"===typeof t.poolSize)this.poolSize=[t.poolSize];else{if(!Array.isArray(t.poolSize)||1!==t.poolSize.length||"number"!==typeof t.poolSize[0])throw new Tn("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(t.poolSize)));this.poolSize=t.poolSize}if(Xn(this.poolSize,"poolSize"),null==t.strides)this.strides=this.poolSize;else if("number"===typeof t.strides)this.strides=[t.strides];else{if(!Array.isArray(t.strides)||1!==t.strides.length||"number"!==typeof t.strides[0])throw new Tn("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(t.strides)));this.strides=t.strides}Xn(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,cr(this.padding),this.inputSpec=[new mi({ndim:3})]}computeOutputShape(t){const e=Oo((t=li(t))[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]}call(t,e){return(0,o.tidy)((()=>{this.invokeCallHook(t,e),t=Sr(ui(t),2);const n=this.poolingFunction(ui(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return o.squeeze(n,[2])}))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},e=super.getConfig();return Object.assign(t,e),t}}class Gs extends qs{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return sr(i),cr(r),Ws(t,e,n,r,i,"max")}}Gs.className="MaxPooling1D",o.serialization.registerClass(Gs);class Hs extends qs{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return sr(i),cr(r),Ws(t,e,n,r,i,"avg")}}Hs.className="AveragePooling1D",o.serialization.registerClass(Hs);class Ys extends wi{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(2!==t.strides.length)throw new Tn("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(t.strides.length,"."));this.strides=t.strides}else this.strides=[t.strides,t.strides];Xn(this.poolSize,"poolSize"),Xn(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,sr(this.dataFormat),cr(this.padding),this.inputSpec=[new mi({ndim:4})]}computeOutputShape(t){t=li(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2];return e=Oo(e,this.poolSize[0],this.padding,this.strides[0]),n=Oo(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n]:[t[0],e,n,t[3]]}call(t,e){return(0,o.tidy)((()=>(this.invokeCallHook(t,e),this.poolingFunction(ui(t),this.poolSize,this.strides,this.padding,this.dataFormat))))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class Xs extends Ys{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return sr(i),cr(r),Ws(t,e,n,r,i,"max")}}Xs.className="MaxPooling2D",o.serialization.registerClass(Xs);class Ks extends Ys{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return sr(i),cr(r),Ws(t,e,n,r,i,"avg")}}Ks.className="AveragePooling2D",o.serialization.registerClass(Ks);class $s extends wi{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(3!==t.strides.length)throw new Tn("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(t.strides.length,"."));this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];Xn(this.poolSize,"poolSize"),Xn(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,sr(this.dataFormat),cr(this.padding),this.inputSpec=[new mi({ndim:5})]}computeOutputShape(t){t=li(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[4]:t[3];return e=Oo(e,this.poolSize[0],this.padding,this.strides[0]),n=Oo(n,this.poolSize[1],this.padding,this.strides[1]),r=Oo(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n,r]:[t[0],e,n,r,t[4]]}call(t,e){return(0,o.tidy)((()=>(this.invokeCallHook(t,e),this.poolingFunction(ui(t),this.poolSize,this.strides,this.padding,this.dataFormat))))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class Zs extends $s{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return sr(i),cr(r),Vs(t,e,n,r,i,"max")}}Zs.className="MaxPooling3D",o.serialization.registerClass(Zs);class Qs extends $s{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return sr(i),cr(r),Vs(t,e,n,r,i,"avg")}}Qs.className="AveragePooling3D",o.serialization.registerClass(Qs);class Js extends wi{constructor(t){super(t),this.inputSpec=[new mi({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,e){throw new Nn}}class tc extends Js{constructor(t){super(t||{})}call(t,e){return(0,o.tidy)((()=>{const e=ui(t);return o.mean(e,1)}))}}tc.className="GlobalAveragePooling1D",o.serialization.registerClass(tc);class ec extends Js{constructor(t){super(t||{})}call(t,e){return(0,o.tidy)((()=>{const e=ui(t);return o.max(e,1)}))}}ec.className="GlobalMaxPooling1D",o.serialization.registerClass(ec);class nc extends wi{constructor(t){super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,sr(this.dataFormat),this.inputSpec=[new mi({ndim:4})]}computeOutputShape(t){return"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]}call(t,e){throw new Nn}getConfig(){const t={dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class rc extends nc{call(t,e){return(0,o.tidy)((()=>{const e=ui(t);return"channelsLast"===this.dataFormat?o.mean(e,[1,2]):o.mean(e,[2,3])}))}}rc.className="GlobalAveragePooling2D",o.serialization.registerClass(rc);class ic extends nc{call(t,e){return(0,o.tidy)((()=>{const e=ui(t);return"channelsLast"===this.dataFormat?o.max(e,[1,2]):o.max(e,[2,3])}))}}ic.className="GlobalMaxPooling2D",o.serialization.registerClass(ic);class ac extends wi{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(t){null!=this.layer&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},e=super.getConfig();return Object.assign(t,e),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=Ji(e.layer,n);delete e.layer;const i={layer:r};return Object.assign(i,e),new t(i)}}class oc extends ac{constructor(t){super(t),this.supportsMasking=!0}build(t){if((t=li(t)).length<3)throw new Tn("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(t)));this.inputSpec=[{shape:t}];const e=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(e),this.layer.built=!0),super.build(t)}computeOutputShape(t){const e=[(t=li(t))[0]].concat(t.slice(2)),n=this.layer.computeOutputShape(e),r=t[1];return[n[0],r].concat(n.slice(1))}call(t,e){return(0,o.tidy)((()=>ts(((t,n)=>[ui(this.layer.call(t,e)),[]]),t=ui(t),[],!1,null,null,!1,!0)[1]))}}oc.className="TimeDistributed",o.serialization.registerClass(oc);class sc extends ac{constructor(t){super(t);const e=t.layer.getConfig(),n={};n.className=t.layer.getClassName(),n.config=e,this.forwardLayer=Ji(n),e.goBackwards=!0!==e.goBackwards;const r={};var i;if(r.className=t.layer.getClassName(),r.config=e,this.backwardLayer=Ji(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===t.mergeMode?"concat":t.mergeMode,i=this.mergeMode,Hn(ar,"BidirectionalMergeMode",i),t.weights)throw new Nn("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,null!=this.forwardLayer&&(this.forwardLayer.trainable=t),null!=this.backwardLayer&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const e=t.length,n=Math.floor(e/2);this.forwardLayer.setWeights(t.slice(0,n)),this.backwardLayer.setWeights(t.slice(n))}computeOutputShape(t){let e,n,r,i=this.forwardLayer.computeOutputShape(t);return Array.isArray(i)&&Array.isArray(i[0])||(i=[i]),this.returnState?(r=i.slice(1),e=i[0]):e=i[0],"concat"===this.mergeMode?(e[e.length-1]*=2,n=[e]):n=null==this.mergeMode?[e,e.slice()]:[e],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[e].concat(r).concat(r.slice()):Rn(n)}apply(t,e){let n=null==e?null:e.initialState,r=null==e?null:e.constants;null==e&&(e={});const i=Jo(t,n,r,this.numConstants);if(t=i.inputs,n=i.initialState,r=i.constants,Array.isArray(t)&&(n=t.slice(1),t=t[0]),(null==n||0===n.length)&&null==r)return super.apply(t,e);const a=[],o=[];if(null!=n){const t=n.length;if(t%2>0)throw new Tn("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");e.initialState=n,a.push(...n);const r=n.map((t=>new mi({shape:t.shape})));this.forwardLayer.stateSpec=r.slice(0,t/2),this.backwardLayer.stateSpec=r.slice(t/2),o.push(...r)}if(null!=r)throw new Nn("Support for constants in Bidirectional layers is not implemented yet.");const s=a[0]instanceof yi;for(const c of a)if(c instanceof yi!==s)throw new Tn("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(s){const n=[t].concat(a),r=this.inputSpec.concat(o),i=this.inputSpec;this.inputSpec=r;const s=super.apply(n,e);return this.inputSpec=i,s}return super.apply(t,e)}call(t,e){return(0,o.tidy)((()=>{const n=e.initialState;let r,i,a,s;if(null==n)r=this.forwardLayer.call(t,e),i=this.backwardLayer.call(t,e);else{const a=n.slice(0,n.length/2),o=n.slice(n.length/2);r=this.forwardLayer.call(t,Object.assign(e,{initialState:a})),i=this.backwardLayer.call(t,Object.assign(e,{initialState:o}))}return this.returnState&&(Array.isArray(r)&&(a=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),this.returnSequences&&(i=o.reverse(i,1)),"concat"===this.mergeMode?s=Tr([r,i]):"sum"===this.mergeMode?s=o.add(r,i):"ave"===this.mergeMode?s=o.mul(.5,o.add(r,i)):"mul"===this.mergeMode?s=o.mul(r,i):null==this.mergeMode&&(s=[r,i]),this.returnState?null==this.mergeMode?s.concat(a):[s].concat(a):s}))}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){dr(this.forwardLayer.name,(()=>{this.forwardLayer.build(t)})),dr(this.backwardLayer.name,(()=>{this.backwardLayer.build(t)})),this.built=!0}computeMask(t,e){let n;if(Array.isArray(e)&&(e=e[0]),n=this.returnSequences?null==this.mergeMode?[e,e]:e:null==this.mergeMode?[null,null]:null,this.returnState){const t=this.forwardLayer.states.map((t=>null));return Array.isArray(n)?n.concat(t).concat(t):[n].concat(t).concat(t)}return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(t),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},e=super.getConfig();return Object.assign(t,e),t}static fromConfig(t,e){const n=Ji(e.layer);if(delete e.layer,null!=e.numConstants)throw new Nn("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=e;return r.layer=n,new t(r)}}sc.className="Bidirectional",o.serialization.registerClass(sc);class cc extends wi{constructor(t){super(t),this.scale=t.scale,t.offset?this.offset=t.offset:this.offset=0}getConfig(){const t={scale:this.scale,offset:this.offset},e=super.getConfig();return Object.assign(t,e),t}call(t,e){return(0,o.tidy)((()=>("float32"!==(t=ui(t)).dtype&&(t=_r(t,"float32")),(0,o.add)((0,o.mul)(t,this.scale),this.offset))))}}cc.className="Rescaling",o.serialization.registerClass(cc);const{resizeBilinear:uc,cropAndResize:lc}=o.image;class hc extends wi{constructor(t){super(t),this.height=t.height,this.width=t.width}centerCrop(t,e,n,r,i,a,s,c){return(0,o.tidy)((()=>{let u,l=!1;const h=[e/a,n/s,(r+e)/a,(i+n)/s],d=[];3===t.rank?(l=!0,u=(0,o.stack)([t])):u=t;for(let t=0;t<u.shape[0];t++)d.push(h);const f=(0,o.tensor)(d,[d.length,4]),p=(0,o.range)(0,d.length,1,"int32"),g=lc(u,f,p,[r,i],"nearest");return _r(l?ui((0,o.unstack)(g)):g,c)}))}upsize(t,e,n,r){return(0,o.tidy)((()=>_r(uc(t,[e,n]),r)))}call(t,e){return(0,o.tidy)((()=>{const e=ui(t),n=e.dtype,r=e.shape,i=r[r.length-3],a=r[r.length-2];let o=0;i!==this.height&&(o=Math.floor((i-this.height)/2));let s=0;return a!==this.width&&(s=Math.floor((a-this.width)/2),0===s&&(s=1)),o>=0&&s>=0?this.centerCrop(e,o,s,this.height,this.width,i,a,n):this.upsize(t,this.height,this.width,n)}))}getConfig(){const t={height:this.height,width:this.width},e=super.getConfig();return Object.assign(t,e),t}computeOutputShape(t){const e=(t=li(t)).length-3,n=t.length-2;return t[e]=this.height,t[n]=this.width,t}}hc.className="CenterCrop",o.serialization.registerClass(hc);class dc extends wi{constructor(t){super(t),this.numTokens=t.numTokens,t.outputMode?this.outputMode=t.outputMode:this.outputMode="multiHot"}getConfig(){const t={numTokens:this.numTokens,outputMode:this.outputMode},e=super.getConfig();return Object.assign(t,e),t}computeOutputShape(t){return null==(t=li(t))?[this.numTokens]:"oneHot"===this.outputMode&&1!==t[t.length-1]?(t.push(this.numTokens),t):(t[t.length-1]=this.numTokens,t)}call(t,e){return(0,o.tidy)((()=>{let n;if("int32"!==(t=ui(t)).dtype&&(t=_r(t,"int32")),"undefined"!==typeof e.countWeights){if("count"!==this.outputMode)throw new Tn("countWeights is not used when outputMode !== count.\n              Received countWeights=".concat(e.countWeights));n=ui(e.countWeights)}const r=(0,o.max)(t),i=(0,o.min)(t),a=(0,o.greater)(this.numTokens,r).bufferSync().get(0),s=(0,o.greaterEqual)(i,0).bufferSync().get(0);if(!a||!s)throw new Tn("Input values must be between 0 < values <="+" numTokens with numTokens=".concat(this.numTokens));return function(t,e,n,r){let i=ui(t);if("int32"!==i.dtype&&(i=_r(i,"int32")),"int"===e)return i;const a=i.shape;if(0===i.rank&&(i=(0,o.expandDims)(i,-1)),"oneHot"===e&&1!==i.shape[i.shape.length-1]&&(i=(0,o.expandDims)(i,-1)),i.rank>2)throw new Tn("When outputMode is not int, maximum output rank is 2"+" Received outputMode ".concat(e," and input shape ").concat(a)+" which would result in output rank ".concat(i.rank,"."));const s=["multiHot","oneHot"].includes(e),c=i;let u;if(u="undefined"!==typeof r&&"count"===e?(0,o.denseBincount)(c,r,n,s):(0,o.denseBincount)(c,[],n,s),"tfIdf"!==e)return u;if(r)return(0,o.mul)(u,r);throw new Tn("When outputMode is 'tfIdf', weights must be provided.")}(t,this.outputMode,this.numTokens,n)}))}}dc.className="CategoryEncoding",o.serialization.registerClass(dc);const fc=new Set(["bilinear","nearest"]);class pc extends wi{constructor(t){if(super(t),this.height=t.height,this.width=t.width,t.interpolation){if(!fc.has(t.interpolation))throw new Tn("Invalid interpolation parameter: ".concat(t.interpolation," is not implemented"));this.interpolation=t.interpolation}else this.interpolation="bilinear";this.cropToAspectRatio=Boolean(t.cropToAspectRatio)}computeOutputShape(t){const e=(t=li(t))[2];return[this.height,this.width,e]}getConfig(){const t={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},e=super.getConfig();return Object.assign(t,e),t}call(t,e){return(0,o.tidy)((()=>{const e=[this.height,this.width];if("bilinear"===this.interpolation)return o.image.resizeBilinear(t,e,!this.cropToAspectRatio);if("nearest"===this.interpolation)return o.image.resizeNearestNeighbor(t,e,!this.cropToAspectRatio);throw new Error("Interpolation is ".concat(this.interpolation," but only ").concat([...fc]," are supported"))}))}}pc.className="Resizing",o.serialization.registerClass(pc);class gc{constructor(t){this.seed=t}next(){if(void 0!==this.seed)return this.seed++}}gc.className="RandomSeed";class mc extends wi{constructor(t){super(t),this.randomGenerator=new gc(t.seed)}getConfig(){const t={seed:this.randomGenerator.seed},e=super.getConfig();return Object.assign(t,e),t}}mc.className="BaseRandomLayer";const yc=new Set(["bilinear","nearest"]);class vc extends mc{constructor(t){super(t);const{factor:e,interpolation:n="bilinear"}=t;if(this.factor=e,Array.isArray(this.factor)&&2===this.factor.length)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else{if(Array.isArray(this.factor)||!(this.factor>0))throw new Tn("Invalid factor: ".concat(this.factor,". Must be positive number or tuple of 2 numbers"));this.widthLower=-this.factor,this.widthUpper=this.factor}if(this.widthLower<-1||this.widthUpper<-1)throw new Tn("factor must have values larger than -1. Got: ".concat(this.factor));if(this.widthUpper<this.widthLower)throw new Tn("factor cannot have upper bound less than lower bound.\n        Got upper bound: ".concat(this.widthUpper,".\n        Got lower bound: ").concat(this.widthLower,"\n      "));if(n){if(!yc.has(n))throw new Tn("Invalid interpolation parameter: ".concat(n," is not implemented"));this.interpolation=n}}getConfig(){const t={factor:this.factor,interpolation:this.interpolation},e=super.getConfig();return Object.assign(t,e),t}computeOutputShape(t){const e=(t=li(t))[2];return[this.imgHeight,-1,e]}call(t,e){return(0,o.tidy)((()=>{const e=ui(t);this.imgHeight=e.shape[e.shape.length-3];const n=e.shape[e.shape.length-2];this.widthFactor=(0,o.randomUniform)([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let r=this.widthFactor.dataSync()[0]*n;r=Math.round(r);const i=[this.imgHeight,r];switch(this.interpolation){case"bilinear":return o.image.resizeBilinear(t,i);case"nearest":return o.image.resizeNearestNeighbor(t,i);default:throw new Error("Interpolation is ".concat(this.interpolation,"\n          but only ").concat([...yc]," are supported"))}}))}}vc.className="RandomWidth",o.serialization.registerClass(vc);var bc,xc;(0,o.env)().registerFlag("KEEP_INTERMEDIATE_TENSORS",(()=>!1),(t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")})),function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"}(bc||(bc={})),function(t){let e;!function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"}(e=t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))}(xc||(xc={}));Error;new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);n(92834);var wc,kc=n(11053);function _c(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==t)return null;if("function"===typeof Blob&&t instanceof Blob)return t.slice();if(r.has(t))throw new Error("Circular references are not supported.");if(n.has(t))return n.get(t);const i=e(t);if(i.recurse&&null!==i.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(Ec(t)){const i=Array.isArray(t)?[]:{};r.add(t);for(const a in t){const o=_c(t[a],e,n,r);i[a]=o}return r.delete(t),t.__proto__&&(i.__proto__=t.__proto__),i}throw new Error("Can't recurse into non-iterable type: ".concat(t))}return n.set(t,i.value),i.value}function Sc(t){return Ac(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:Cc)}function Ac(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;const r=t[0];if(n.has(r))throw new Error("Circular references are not supported.");const i=e(t);if(i.recurse&&null!==i.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(i.recurse){if(Ec(r)){const i=Array.isArray(r)?[]:{};n.add(r);for(const a in r){const r=Ac(t.map((t=>t[a])),e,n);i[a]=r}return n.delete(r),i}throw new Error("Can't recurse into non-iterable type: ".concat(r))}return i.value}function Cc(t){return null===t?null:Ec(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}function Ec(t){let e=!1;if(o.env().get("IS_BROWSER"))e=t instanceof TextDecoder;else{const{StringDecoder:r}=n(80551);e=t instanceof r}return null!=t&&!ArrayBuffer.isView(t)&&(Array.isArray(t)||"object"===typeof t&&!(t instanceof o.Tensor)&&!(t instanceof Promise)&&!e)}function Tc(t){return function(t,e){return _c(t,e)}(t,Nc)}function Nc(t){return t instanceof o.Tensor?{value:t.clone(),recurse:!1}:Ec(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}class Dc{constructor(t){if(this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}wrap(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity}get(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]}set(t,e){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e}length(){let t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)}pushAll(t){for(const e of t)this.push(e)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const t=this.get(this.end);return this.set(this.end,void 0),t}unshift(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t}shuffleExcise(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.wrap(this.begin+t),n=this.get(e);return this.set(e,this.pop()),n}}class Fc extends Dc{constructor(){super(Fc.INITIAL_CAPACITY)}isFull(){return!1}push(t){super.isFull()&&this.expand(),super.push(t)}unshift(t){super.isFull()&&this.expand(),super.unshift(t)}expand(){const t=2*this.capacity,e=new Array(t),n=this.length();for(let r=0;r<n;r++)e[r]=this.get(this.wrap(this.begin+r));this.data=e,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}function Ic(t){return new zc(t)}function Mc(t,e){return new Yc(t,e)}Fc.INITIAL_CAPACITY=32;class Oc{async toArray(){const t=[];let e=await this.next();for(;!e.done;)t.push(e.value),e=await this.next();return t}async toArrayForTest(){const t=this.prefetch(100),e=[];let n=await t.next();for(;!n.done;)e.push(n.value),n=await t.next();return e}async resolveFully(){let t=await this.next();for(;!t.done;)t=await this.next()}async resolveWhile(t){let e=await this.next(),n=t(e.value);for(;!e.done&&n;)e=await this.next(),n=t(e.value)}handleErrors(t){return new Vc(this,t)}filter(t){return new Uc(this,t)}map(t){return new Wc(this,t)}mapAsync(t){return new qc(this,t)}serialMapAsync(t){return new qc(this,t).serial()}flatmap(t){return new Hc(this,t)}async forEachAsync(t){return this.map(t).resolveFully()}async serialForEach(t){return this.serialMapAsync(t).resolveWhile((t=>!0===t))}rowMajorBatch(t){return new jc(this,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}columnMajorBatch(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Cc;return this.rowMajorBatch(t,e).map((t=>Sc(t,n)))}concatenate(t,e){return new Yc(new Rc([this,t]),e)}take(t){return t<0||null==t?this:new Pc(this,t)}skip(t){return t<0||null==t?this:new Lc(this,t)}prefetch(t){return new Xc(this,t)}shuffle(t,e){return new Kc(this,t,e)}serial(){return new Bc(this)}}class Rc extends Oc{constructor(t){super(),this.items=t,this.trav=0}summary(){return"Array of ".concat(this.items.length," items")}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const t=this.items[this.trav];return this.trav++,{value:Tc(t),done:!1}}}class zc extends Oc{constructor(t){super(),this.nextFn=t}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(t){throw t.message="Error thrown while iterating through a dataset: ".concat(t.message),t}}}class Bc extends Oc{constructor(t){super(),this.upstream=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Serial")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){return this.upstream.next()}}class Lc extends Oc{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Skip")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const t=await this.upstream.next();if(t.done)return t;o.dispose(t.value)}return this.upstream.next()}}class Pc extends Oc{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0}summary(){return"".concat(this.upstream.summary()," -> Take")}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class jc extends Oc{constructor(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(),this.upstream=t,this.batchSize=e,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){const t=[];for(;t.length<this.batchSize;){const e=await this.upstream.next();if(e.done)return this.enableSmallLastBatch&&t.length>0?{value:t,done:!1}:{value:null,done:!0};t.push(e.value)}return{value:t,done:!1}}}class Uc extends Oc{constructor(t,e){super(),this.upstream=t,this.predicate=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Filter")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;;){const t=await this.upstream.next();if(t.done||this.predicate(t.value))return t;o.dispose(t.value)}}}class Wc extends Oc{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return"".concat(this.upstream.summary()," -> Map")}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const e=o.tensor_util.getTensorsInContainer(t.value),n=this.transform(t.value),r=o.tensor_util.getTensorsInContainer(n);for(const i of e)o.tensor_util.isTensorInList(i,r)||i.dispose();return{value:n,done:!1}}}class Vc extends Oc{constructor(t,e){super(),this.upstream=t,this.handler=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> handleErrors")}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(t){if(!this.handler(t))return{value:null,done:!0}}}}class qc extends Oc{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return"".concat(this.upstream.summary()," -> AsyncMap")}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const e=o.tensor_util.getTensorsInContainer(t.value),n=await this.transform(t.value),r=o.tensor_util.getTensorsInContainer(n);for(const i of e)o.tensor_util.isTensorInList(i,r)||i.dispose();return{value:n,done:!1}}}class Gc extends Oc{constructor(){super(),this.outputQueue=new Fc,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}async serialNext(){for(;0===this.outputQueue.length();)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class Hc extends Gc{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return"".concat(this.upstream.summary()," -> Flatmap")}async pump(){const t=await this.upstream.next();if(t.done)return!1;const e=o.tensor_util.getTensorsInContainer(t.value),n=this.transform(t.value),r=o.tensor_util.getTensorsInContainer(n);this.outputQueue.pushAll(n);for(const i of e)o.tensor_util.isTensorInList(i,r)||i.dispose();return!0}}class Yc extends Oc{constructor(t,e){super(),this.baseErrorHandler=e,this.lastRead=null,this.iterator=null,this.moreIterators=t}summary(){return"".concat("TODO: fill in upstream of chained summaries"," -> Chained")}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(t){if(await t,null==this.iterator){const t=await this.moreIterators.next();if(t.done)return{value:null,done:!0};this.iterator=t.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const e=await this.iterator.next();return e.done?(this.iterator=null,this.readFromChain(t)):e}}!function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"}(wc||(wc={}));class Xc extends Oc{constructor(t,e){super(),this.upstream=t,this.bufferSize=e,this.buffer=new Dc(e)}summary(){return"".concat(this.upstream.summary()," -> Prefetch")}refill(){for(;!this.buffer.isFull();){const t=this.upstream.next();this.buffer.push(t)}}next(){return this.refill(),this.buffer.shift()}}class Kc extends Xc{constructor(t,e,n){super(t,e),this.upstream=t,this.windowSize=e,this.upstreamExhausted=!1,this.random=kc.alea(n||o.util.now().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then((()=>this.serialNext())),this.lastRead}randomInt(t){return Math.floor(this.random()*t)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const t=this.chooseIndex(),e=await this.buffer.shuffleExcise(t);if(!e.done)return this.refill(),e;this.upstreamExhausted=!0}return{value:null,done:!0}}}class $c{constructor(){this.size=null}batch(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this;let r;return o.util.assert(t>0,(()=>"batchSize needs to be positive, but it is\n      ".concat(t))),r=this.size===1/0||null==this.size?this.size:e?Math.ceil(this.size/t):Math.floor(this.size/t),Zc((async()=>(await n.iterator()).columnMajorBatch(t,e,Qc)),r)}concatenate(t){const e=this;let n;return n=this.size===1/0||t.size===1/0?1/0:null!=this.size&&null!=t.size?this.size+t.size:null,Zc((async()=>(await e.iterator()).concatenate(await t.iterator())),n)}filter(t){const e=this;let n;return n=this.size===1/0?1/0:null,Zc((async()=>(await e.iterator()).filter((e=>o.tidy((()=>t(e)))))),n)}async forEachAsync(t){return(await this.iterator()).forEachAsync(t)}map(t){const e=this;return Zc((async()=>(await e.iterator()).map((e=>o.tidy((()=>t(e)))))),this.size)}mapAsync(t){const e=this;return Zc((async()=>(await e.iterator()).mapAsync(t)),this.size)}prefetch(t){if(null==t)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const e=this;return Zc((async()=>(await e.iterator()).prefetch(t)),this.size)}repeat(t){const e=this;let n;return n=null!=this.size&&t>0?this.size*t:0===t?0:null!=this.size&&(void 0===t||t<0)?1/0:null,Zc((async()=>Mc(Ic((async()=>({value:await e.iterator(),done:!1}))).take(t))),n)}skip(t){const e=this;let n;return n=null!=this.size&&t>=0&&this.size>=t?this.size-t:null!=this.size&&(this.size<t||void 0===t||t<0)?0:null,Zc((async()=>(await e.iterator()).skip(t)),n)}shuffle(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==t||t<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+"bufferSize to the dataset size (".concat(this.size," elements)"));const r=this,i=kc.alea(e||o.util.now().toString());return Zc((async()=>{let e=i.int32();return n&&(e+=i.int32()),(await r.iterator()).shuffle(t,e.toString())}),this.size)}take(t){const e=this;let n;return n=null!=this.size&&this.size>t?t:null!=this.size&&this.size<=t?this.size:null,Zc((async()=>(await e.iterator()).take(t)),n)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}function Zc(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new class extends $c{constructor(){super(...arguments),this.size=e}async iterator(){return t()}}}function Qc(t){if(null===t)return null;if(function(t){return null==t||null===(e=t)||"object"!==typeof e&&"function"!==typeof e||Array.isArray(t)||"object"===typeof t&&t instanceof o.Tensor||o.util.isTypedArray(t);var e}(t[0])){return{value:function(t){if(0===t.length)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof o.Tensor?o.stack(t):o.tensor(t)}(t),recurse:!1}}return{value:null,recurse:!0}}$c.MAX_BUFFER_SIZE=1e4;Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");function Jc(t,e){Array.isArray(t)||(t=[t]),t.forEach((t=>{null!=t&&o.util.assert("complex64"!==t.dtype,(()=>"".concat(e," does not support complex64 tensors in the CPU backend.")))}))}const tu=o.kernel_impls.whereImpl;class eu extends o.KernelBackend{nextDataId(){return eu.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new o.DataStorage(this,(0,o.engine)())}write(t,e,n){this.firstUse&&(this.firstUse=!1,(0,o.env)().get("IS_NODE")&&o.backend_util.warn("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));const r={id:this.nextDataId()};return this.data.set(r,{values:t,dtype:n,refCount:1}),r}makeTensorInfo(t,e,n){let r;if("string"===e&&null!=n&&n.length>0&&o.util.isString(n[0])){const i=n.map((t=>o.util.encodeString(t)));r=this.write(i,t,e)}else r=this.write(n,t,e);return{dataId:r,shape:t,dtype:e}}refCount(t){if(this.data.has(t)){return this.data.get(t).refCount}return 0}incRef(t){this.data.get(t).refCount++}decRef(t){if(this.data.has(t)){this.data.get(t).refCount--}}move(t,e,n,r,i){this.data.set(t,{values:e,dtype:r,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:e,complexTensorInfos:n}=this.data.get(t);if("complex64"===e){const t=this.readSync(n.real.dataId),e=this.readSync(n.imag.dataId);return o.backend_util.mergeRealAndImagArrays(t,e)}return o.util.convertBackendValuesAndArrayBuffer(this.data.get(t).values,e)}bufferSync(t){const e=this.readSync(t.dataId);if("string"===t.dtype)try{const n=e.map((t=>o.util.decodeString(t)));return(0,o.buffer)(t.shape,t.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return(0,o.buffer)(t.shape,t.dtype,e)}makeOutput(t,e,n){return(0,o.engine)().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,t),this)}disposeData(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.data.has(t)){if(this.data.get(t).refCount--,!e&&this.data.get(t).refCount>0)return!1;const{complexTensorInfos:n}=this.data.get(t);null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}async time(t){const e=o.util.now();t();return{kernelMs:o.util.now()-e}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){Jc([t],"where");const e=this.readSync(t.dataId);return tu(t.shape,e)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}eu.nextDataId=0;function nu(t){return(e,n,r)=>{const i=o.util.getArrayFromDType(n,e.length);for(let a=0;a<e.length;++a)i[a]=t(e[a],r);return i}}function ru(t,e,n){return iu(t,nu(e),n)}function iu(t,e,n){return r=>{let{inputs:i,attrs:a,backend:s}=r;const{x:c}=i;Jc(c,t);const u=s,l=u.data.get(c.dataId).values;let h;if("string"===c.dtype){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");h=o.backend_util.fromUint8ToStringArray(l)}else h=l;const d=n||c.dtype,f=e(h,d,a);return u.makeTensorInfo(c.shape,d,f)}}(0,o.registerBackend)("cpu",(()=>new eu),1);const au=ru(o.Elu,(t=>t>=0?t:Math.exp(t)-1)),ou={kernelName:o.Elu,backendName:"cpu",kernelFunc:au};function su(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const cu={kernelName:o.Identity,backendName:"cpu",kernelFunc:su};function uu(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{alpha:a}=r;Jc([i],"leakyRelu");const s=o.util.sizeFromShape(i.shape),c=n.data.get(i.dataId).values,u=o.util.getTypedArrayFromDType("float32",s);for(let o=0;o<c.length;o++)u[o]=c[o]<0?a*c[o]:c[o];return n.makeTensorInfo(i.shape,"float32",u)}const lu={kernelName:o.LeakyRelu,backendName:"cpu",kernelFunc:uu};function hu(t){return(e,n,r,i,a)=>{const s=o.backend_util.assertAndGetBroadcastShape(e,n),c=s.length,u=o.util.computeStrides(s),l=o.util.sizeFromShape(s),h=o.util.getTypedArrayFromDType(a,l),d=e.length,f=n.length,p=o.util.computeStrides(e),g=o.util.computeStrides(n),m=o.backend_util.getBroadcastDims(e,s),y=o.backend_util.getBroadcastDims(n,s);if(m.length+y.length===0)for(let o=0;o<h.length;++o)h[o]=t(r[o%r.length],i[o%i.length]);else for(let v=0;v<h.length;++v){const e=o.util.indexToLoc(v,c,u),n=e.slice(-d);m.forEach((t=>n[t]=0));const a=o.util.locToIndex(n,d,p),s=e.slice(-f);y.forEach((t=>s[t]=0));const l=o.util.locToIndex(s,f,g);h[v]=t(r[a],i[l])}return[h,s]}}const du=hu(((t,e)=>t<0?e*t:t));function fu(t){const{inputs:e,backend:n}=t,{x:r,alpha:i}=e;Jc([r,i],"prelu");const a=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,[s,c]=du(r.shape,i.shape,a,o,"float32");return n.makeTensorInfo(c,"float32",s)}const pu={kernelName:o.Prelu,backendName:"cpu",kernelFunc:fu},gu=ru(o.Relu,(t=>Math.max(0,t))),mu={kernelName:o.Relu,backendName:"cpu",kernelFunc:gu},yu=ru(o.Relu6,(t=>Math.min(Math.max(0,t),6))),vu={kernelName:o.Relu6,backendName:"cpu",kernelFunc:yu},bu=nu((t=>1/(1+Math.exp(-t)))),xu=ru(o.Sigmoid,(t=>1/(1+Math.exp(-t)))),wu={kernelName:o.Sigmoid,backendName:"cpu",kernelFunc:xu};function ku(t,e,n,r,i){if("linear"===n)return su({inputs:{x:e},backend:t});if("relu"===n)return gu({inputs:{x:e},backend:t});if("elu"===n)return au({inputs:{x:e},backend:t});if("relu6"===n)return yu({inputs:{x:e},backend:t});if("prelu"===n)return fu({inputs:{x:e,alpha:r},backend:t});if("leakyrelu"===n)return uu({inputs:{x:e},backend:t,attrs:{alpha:i}});if("sigmoid"===n)return xu({inputs:{x:e},backend:t});throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}function _u(t){const{inputs:e,backend:n}=t,{real:r,imag:i}=e,a=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,s=n.makeTensorInfo(r.shape,"complex64");return n.data.get(s.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",a),imag:n.makeTensorInfo(i.shape,"float32",o)},s}const Su={kernelName:o.Complex,backendName:"cpu",kernelFunc:_u};function Au(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n){return _u({inputs:{real:Au(t,e,"float32"),imag:Au(t,e,"float32")},backend:t})}const r=o.util.makeZerosTypedArray(o.util.sizeFromShape(e),n);return t.makeTensorInfo(e,n,r)}function Cu(t){const{inputs:e,backend:n}=t,{input:r}=e,i=n.data.get(r.dataId).complexTensorInfos.real,a=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,a)}const Eu={kernelName:o.Real,backendName:"cpu",kernelFunc:Cu};function Tu(t,e,n,r){if("int32"===r){return[e,"int32",Int32Array.from(t)]}if("bool"===r){const r=o.util.toTypedArray([0],n),[i,a]=hu(((t,e)=>t!==e?1:0))(e,[],t,r,"bool");return[a,"bool",i]}throw new Error("Error in Cast: failed to cast ".concat(n," to ").concat(r))}function Nu(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{dtype:a}=r;if("complex64"===a){if("complex64"===i.dtype)return su({inputs:{x:i},backend:n});const t=Au(n,i.shape,i.dtype),e=Nu({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),r=_u({inputs:{real:e,imag:t},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),r}if("complex64"===i.dtype){const t=Cu({inputs:{input:i},backend:n}),e=Nu({inputs:{x:t},backend:n,attrs:{dtype:a}});return n.disposeIntermediateTensorInfo(t),e}if(!o.util.hasEncodingLoss(i.dtype,a)){const t=su({inputs:{x:i},backend:n});return{dataId:t.dataId,shape:t.shape,dtype:a}}const s=n.data.get(i.dataId).values,[c,u,l]=Tu(s,i.shape,i.dtype,a);return n.makeTensorInfo(c,u,l)}const Du={kernelName:o.Cast,backendName:"cpu",kernelFunc:Nu};function Fu(t,e,n,r){return null==n?n=>{let{inputs:i,backend:a}=n;const{a:s,b:c}=i,u=a;Jc([s,c],t);const l=u.data.get(s.dataId).values,h=u.data.get(c.dataId).values,d="string"===s.dtype?o.backend_util.fromUint8ToStringArray(l):l,f="string"===s.dtype?o.backend_util.fromUint8ToStringArray(h):h,p=r||s.dtype,[g,m]=e(s.shape,c.shape,d,f,p);return u.makeTensorInfo(m,p,g)}:t=>{let{inputs:i,backend:a}=t;const{a:o,b:s}=i,c=a;if("complex64"===o.dtype||"complex64"===s.dtype){const t=Nu({inputs:{x:o},backend:c,attrs:{dtype:"complex64"}}),e=c.data.get(t.dataId),r=e.complexTensorInfos.real,i=e.complexTensorInfos.imag,a=c.data.get(r.dataId).values,u=c.data.get(i.dataId).values,l=Nu({inputs:{x:s},backend:c,attrs:{dtype:"complex64"}}),h=c.data.get(l.dataId),d=h.complexTensorInfos.real,f=h.complexTensorInfos.imag,p=c.data.get(d.dataId).values,g=c.data.get(f.dataId).values,[m,y,v]=n(o.shape,s.shape,a,u,p,g),b=c.makeTensorInfo(v,"float32",m),x=c.makeTensorInfo(v,"float32",y),w=_u({inputs:{real:b,imag:x},backend:c});return c.disposeIntermediateTensorInfo(t),c.disposeIntermediateTensorInfo(l),c.disposeIntermediateTensorInfo(b),c.disposeIntermediateTensorInfo(x),w}{const t=c.data.get(o.dataId).values,n=c.data.get(s.dataId).values,i=r||o.dtype,[a,u]=e(o.shape,s.shape,t,n,i);return c.makeTensorInfo(u,i,a)}}}function Iu(t){return(e,n,r,i,a,s)=>{const c=o.backend_util.assertAndGetBroadcastShape(e,n),u=o.util.sizeFromShape(c),l=c.length,h=o.util.computeStrides(c),d=o.util.getTypedArrayFromDType("float32",u),f=o.util.getTypedArrayFromDType("float32",u),p=o.backend_util.getBroadcastDims(e,c),g=o.backend_util.getBroadcastDims(n,c),m=o.backend_util.mergeRealAndImagArrays(r,i),y=o.backend_util.mergeRealAndImagArrays(a,s),v=e.length,b=o.util.computeStrides(e),x=n.length,w=o.util.computeStrides(n);if(p.length+g.length===0)for(let o=0;o<d.length;o++){const e=o%m.length,n=o%y.length,r=t(m[2*e],m[2*e+1],y[2*n],y[2*n+1]);d[o]=r.real,f[o]=r.imag}else for(let k=0;k<d.length;k++){const e=o.util.indexToLoc(k,l,h),n=e.slice(-v);p.forEach((t=>n[t]=0));const r=o.util.locToIndex(n,v,b),i=e.slice(-x);g.forEach((t=>i[t]=0));const a=o.util.locToIndex(i,x,w),s=t(m[2*r],m[2*r+1],y[2*a],y[2*a+1]);d[k]=s.real,f[k]=s.imag}return[d,f,c]}}const Mu=hu(((t,e)=>t+e)),Ou=Iu(((t,e,n,r)=>({real:t+n,imag:e+r}))),Ru=Fu(o.Add,Mu,Ou),zu={kernelName:o.Add,backendName:"cpu",kernelFunc:Ru};function Bu(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{shape:a}=r,s=o.util.sizeFromShape(i.shape),c=o.util.inferFromImplicitShape(a,s),u=o.util.sizeFromShape(c);o.util.assert(s===u,(()=>"The new shape (".concat(c,") has ").concat(u," elements and the old ")+"shape (".concat(i.shape,") has ").concat(s," elements. The new shape and old ")+"shape must have the same number of elements.")),n.incRef(i.dataId);const l=n.data.get(i.dataId);if(null!=l.complexTensorInfos){const t=l.complexTensorInfos.real,e=l.complexTensorInfos.imag;t.shape=c,e.shape=c}return{dataId:i.dataId,shape:c,dtype:i.dtype}}const Lu={kernelName:o.Reshape,backendName:"cpu",kernelFunc:Bu};function Pu(t){const{inputs:e,backend:n,attrs:r}=t,{a:i,b:a}=e,{transposeA:s,transposeB:c}=r;Jc([i,a],"matMul");const u=i.shape.length,l=a.shape.length,h=s?i.shape[u-2]:i.shape[u-1],d=c?a.shape[l-1]:a.shape[l-2],f=s?i.shape[u-1]:i.shape[u-2],p=c?a.shape[l-2]:a.shape[l-1],g=i.shape.slice(0,-2),m=a.shape.slice(0,-2),y=o.util.sizeFromShape(g),v=o.util.sizeFromShape(m),b=o.broadcast_util.assertAndGetBroadcastShape(i.shape.slice(0,-2),a.shape.slice(0,-2)).concat([f,p]);o.util.assert(h===d,(()=>"Error in matMul: inner shapes (".concat(h,") and (")+"".concat(d,") of Tensors with shapes ").concat(i.shape," and ")+"".concat(a.shape," and transposeA=").concat(s)+" and transposeB=".concat(c," must match.")));const x=c?[v,p,d]:[v,d,p],w=Bu({inputs:{x:i},backend:n,attrs:{shape:s?[y,h,f]:[y,f,h]}}),k=Bu({inputs:{x:a},backend:n,attrs:{shape:x}}),_=s?w.shape[1]:w.shape[2],S=s?w.shape[2]:w.shape[1],A=c?k.shape[1]:k.shape[2],C=Math.max(y,v),E=n.data.get(w.dataId).values,T=n.data.get(k.dataId).values,N=o.util.computeStrides(w.shape),D=o.util.computeStrides(k.shape),[F,I,M]=s?[N[0],1,N[1]]:[N[0],N[1],1],[O,R,z]=c?[1,D[1],D[0]]:[D[1],1,D[0]],B=S*A,L=(0,o.buffer)([C,S,A],w.dtype),P=L.values,j=n.blockSize;for(let o=0;o<C;o++){const t=o%y,e=o%v;for(let n=0;n<S;n+=j){const r=Math.min(n+j,S);for(let i=0;i<A;i+=j){const a=Math.min(i+j,A);for(let s=0;s<_;s+=j){const c=Math.min(s+j,_);for(let u=n;u<r;u++)for(let n=i;n<a;n++){let r=0;for(let i=s;i<c;i++){r+=E[t*F+u*I+i*M]*T[i*O+n*R+e*z]}P[o*B+(u*A+n)]+=r}}}}}return n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(k),n.makeTensorInfo(b,L.dtype,L.values)}const ju={kernelName:o.BatchMatMul,backendName:"cpu",kernelFunc:Pu};const Uu={kernelName:o._FusedMatMul,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{a:i,b:a,bias:o,preluActivationWeights:s}=e,{transposeA:c,transposeB:u,activation:l,leakyreluAlpha:h}=r;let d,f,p;const g=[];d=Pu({inputs:{a:i,b:a},attrs:{transposeA:c,transposeB:u},backend:n}),o&&(f=Ru({inputs:{a:d,b:o},backend:n}),g.push(d),d=f),l&&(p=ku(n,d,l,s,h),g.push(d),d=p);for(const m of g)n.disposeIntermediateTensorInfo(m);return d}};function Wu(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const Vu={kernelName:o.Abs,backendName:"cpu",kernelFunc:t=>{const{x:e}=t.inputs,n=t.backend;Jc(e,"abs");let r=new Float32Array(o.util.sizeFromShape(e.shape));return r=Wu(n.data.get(e.dataId).values),n.makeOutput(r,e.shape,e.dtype)}},qu=ru(o.Acos,(t=>Math.acos(t))),Gu={kernelName:o.Acos,backendName:"cpu",kernelFunc:qu},Hu=ru(o.Acosh,(t=>Math.acosh(t))),Yu={kernelName:o.Acosh,backendName:"cpu",kernelFunc:Hu};const Xu={kernelName:o.AddN,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,r=e;Jc(e,"addN");const i=r.map((t=>n.data.get(t.dataId).values)),a=(0,o.buffer)(r[0].shape,r[0].dtype),s=a.values;for(let o=0;o<r.length;o++){const t=i[o];for(let e=0;e<s.length;e++)s[e]+=t[e]}return n.makeTensorInfo(a.shape,a.dtype,a.values)}};function Ku(t,e,n,r,i){const a=e.length,s=o.util.sizeFromShape(e),c=o.util.computeStrides(e),u=o.util.computeStrides(i),l=o.util.getTypedArrayFromDType(n,o.util.sizeFromShape(i));for(let h=0;h<s;++h){const e=o.util.indexToLoc(h,a,c),n=new Array(e.length);for(let t=0;t<n.length;t++)n[t]=e[r[t]];l[o.util.locToIndex(n,a,u)]=t[h]}return l}function $u(t){const{inputs:e,attrs:n,backend:r}=t,{x:i}=e,{perm:a}=n;Jc(i,"transpose");const o=i.shape.length,s=new Array(o);for(let u=0;u<s.length;u++)s[u]=i.shape[a[u]];const c=Ku(r.data.get(i.dataId).values,i.shape,i.dtype,a,s);return{dataId:r.write(c,s,i.dtype),shape:s,dtype:i.dtype}}const Zu={kernelName:o.Transpose,backendName:"cpu",kernelFunc:$u};const Qu={kernelName:o.All,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,keepDims:s}=r;Jc(i,"all");const c=o.util.parseAxisParam(a,i.shape);let u=c;const l=o.backend_util.getAxesPermutation(u,i.shape.length);let h=i;null!=l&&(h=$u({inputs:{x:i},backend:n,attrs:{perm:l}}),u=o.backend_util.getInnerMostAxes(u.length,i.shape.length)),o.backend_util.assertAxesAreInnerMostDims("all",u,h.shape.length);const[d,f]=o.backend_util.computeOutAndReduceShapes(h.shape,u),p=o.util.sizeFromShape(f),g=o.util.makeZerosTypedArray(o.util.sizeFromShape(d),h.dtype),m=n.data.get(h.dataId).values;for(let o=0;o<g.length;++o){const t=o*p;let e=m[t];for(let n=0;n<p;++n){const r=m[t+n];e=e&&r}g[o]=e}null!=l&&n.disposeIntermediateTensorInfo(h);const y=n.makeTensorInfo(d,h.dtype,g);if(s){const t=Bu({inputs:{x:y},backend:n,attrs:{shape:o.backend_util.expandShapeToKeepDim(d,c)}});return n.disposeIntermediateTensorInfo(y),t}return y}};const Ju={kernelName:o.Any,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,keepDims:s}=r;Jc(i,"any");const c=o.util.parseAxisParam(a,i.shape);let u=c;const l=o.backend_util.getAxesPermutation(u,i.shape.length);let h=i;null!=l&&(h=$u({inputs:{x:i},backend:n,attrs:{perm:l}}),u=o.backend_util.getInnerMostAxes(u.length,i.shape.length)),o.backend_util.assertAxesAreInnerMostDims("any",u,h.shape.length);const[d,f]=o.backend_util.computeOutAndReduceShapes(h.shape,u),p=o.util.sizeFromShape(f),g=o.util.makeZerosTypedArray(o.util.sizeFromShape(d),h.dtype),m=n.data.get(h.dataId).values;for(let o=0;o<g.length;++o){const t=o*p;let e=m[t];for(let n=0;n<p;++n){const r=m[t+n];e=e||r}g[o]=e}null!=l&&n.disposeIntermediateTensorInfo(h);const y=n.makeTensorInfo(d,h.dtype,g);if(s){const t=Bu({inputs:{x:y},backend:n,attrs:{shape:o.backend_util.expandShapeToKeepDim(d,c)}});return n.disposeIntermediateTensorInfo(y),t}return y}};const tl={kernelName:o.ArgMax,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a}=r;Jc(i,"argMax");let s=o.util.parseAxisParam(a,i.shape);const c=o.backend_util.getAxesPermutation(s,i.shape.length);let u=i;const l=[];null!=c&&(u=$u({inputs:{x:i},backend:n,attrs:{perm:c}}),l.push(u),s=o.backend_util.getInnerMostAxes(s.length,u.shape.length)),s=[s[0]],o.backend_util.assertAxesAreInnerMostDims("argMax",s,u.shape.length);const[h,d]=o.backend_util.computeOutAndReduceShapes(u.shape,s),f=o.util.sizeFromShape(h),p=o.util.makeZerosTypedArray(f,"int32"),g=o.util.sizeFromShape(d),m=n.data.get(u.dataId).values;for(let o=0;o<p.length;++o){const t=o*g;let e=m[t],n=0;for(let r=0;r<g;++r){const i=m[t+r];i>e&&(e=i,n=r)}p[o]=n}return l.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.makeTensorInfo(h,"int32",p)}};const el={kernelName:o.ArgMin,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a}=r;Jc(i,"argMin");let s=o.util.parseAxisParam(a,i.shape);const c=o.backend_util.getAxesPermutation(s,i.shape.length);let u=i;const l=[];null!=c&&(u=$u({inputs:{x:i},backend:n,attrs:{perm:c}}),l.push(u),s=o.backend_util.getInnerMostAxes(s.length,u.shape.length)),s=[s[0]],o.backend_util.assertAxesAreInnerMostDims("argMin",s,u.shape.length);const[h,d]=o.backend_util.computeOutAndReduceShapes(u.shape,s),f=o.util.sizeFromShape(h),p=o.util.makeZerosTypedArray(f,"int32"),g=o.util.sizeFromShape(d),m=n.data.get(u.dataId).values;for(let o=0;o<p.length;++o){const t=o*g;let e=m[t],n=0;for(let r=0;r<g;++r){const i=m[t+r];i<e&&(e=i,n=r)}p[o]=n}return l.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.makeTensorInfo(h,"int32",p)}},nl=ru(o.Asin,(t=>Math.asin(t))),rl={kernelName:o.Asin,backendName:"cpu",kernelFunc:nl},il=ru(o.Asinh,(t=>Math.asinh(t))),al={kernelName:o.Asinh,backendName:"cpu",kernelFunc:il},ol=ru(o.Atan,(t=>Math.atan(t))),sl={kernelName:o.Atan,backendName:"cpu",kernelFunc:ol},cl=hu(((t,e)=>Math.atan2(t,e))),ul=Fu(o.Atan2,cl),ll={kernelName:o.Atan2,backendName:"cpu",kernelFunc:ul},hl=ru(o.Atanh,(t=>Math.atanh(t))),dl={kernelName:o.Atanh,backendName:"cpu",kernelFunc:hl};function fl(t,e,n,r,i,a){const s=i.strideHeight,c=i.strideWidth,u=i.dilationHeight,l=i.dilationWidth,h=i.effectiveFilterHeight,d=i.effectiveFilterWidth,f=i.padInfo.top,p=i.padInfo.left,g="max"===a?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=(0,o.buffer)(i.outShape,n),y=m.values,v=i.outShape[1]*i.outShape[2]*i.outShape[3],b=i.outShape[2]*i.outShape[3],x=i.outShape[3];for(let o=0;o<i.batchSize;++o){const e=o*v,n=o*r[0];for(let o=0;o<i.inChannels;++o)for(let m=0;m<i.outHeight;++m){const v=m*s-f,w=Math.max(0,v),k=Math.min(i.inHeight,h+v),_=e+m*b;for(let e=0;e<i.outWidth;++e){const s=e*c-p,h=Math.max(0,s),f=Math.min(i.inWidth,d+s);let m=g,v=0,b=0;for(let e=w;e<k;e+=u){const i=n+e*r[1];for(let e=h;e<f;e+=l){const n=t[i+e*r[2]+o];"max"===a&&n>m?m=n:"avg"===a&&(v+=n,b++)}if(isNaN(m))break}y[_+e*x+o]="avg"===a?v/b:m}}}return m}function pl(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const s=(0,o.buffer)(r.outShape,"int32"),c=r.strideHeight,u=r.strideWidth,l=r.dilationHeight,h=r.dilationWidth,d=r.effectiveFilterHeight,f=r.effectiveFilterWidth,p=r.padInfo.top,g=r.padInfo.left,m=(0,o.buffer)(e,n,t);for(let o=0;o<r.batchSize;++o)for(let t=0;t<r.inChannels;++t)for(let e=0;e<r.outHeight;++e){const n=e*c-p;let y=n;for(;y<0;)y+=l;const v=Math.min(r.inHeight,d+n);for(let c=0;c<r.outWidth;++c){const d=c*u-g;let p=d;for(;p<0;)p+=h;const b=Math.min(r.inWidth,f+d);let x=Number.NEGATIVE_INFINITY,w=-1;for(let e=y;e<v;e+=l){const s=e-n;for(let n=p;n<b;n+=h){const c=n-d,u=m.get(o,e,n,t);u>x&&(x=u,w=i?a?((o*r.inHeight+e)*r.inWidth+n)*r.inChannels+t:(e*r.inWidth+n)*r.inChannels+t:s*f+c)}}s.set(w,o,e,c,t)}}return s}function gl(t,e,n,r,i,a){const s=i.strideDepth,c=i.strideHeight,u=i.strideWidth,l=i.dilationDepth,h=i.dilationHeight,d=i.dilationWidth,f=i.effectiveFilterDepth,p=i.effectiveFilterHeight,g=i.effectiveFilterWidth,m=i.padInfo.front,y=i.padInfo.top,v=i.padInfo.left,b="max"===a?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=(0,o.buffer)(i.outShape,n),w=x.values,k=i.outShape[1]*i.outShape[2]*i.outShape[3]*i.outShape[4],_=i.outShape[2]*i.outShape[3]*i.outShape[4],S=i.outShape[3]*i.outShape[4],A=i.outShape[4];for(let o=0;o<i.batchSize;++o){const e=o*k,n=o*r[0];for(let o=0;o<i.inChannels;++o)for(let x=0;x<i.outDepth;++x){const k=x*s-m;let C=k;for(;C<0;)C+=l;const E=Math.min(i.inDepth,f+k),T=e+x*_;for(let e=0;e<i.outHeight;++e){const s=e*c-y;let f=s;for(;f<0;)f+=h;const m=Math.min(i.inHeight,p+s),x=T+e*S;for(let e=0;e<i.outWidth;++e){const s=e*u-v;let c=s;for(;c<0;)c+=d;const p=Math.min(i.inWidth,g+s),y=x+e*A;let k=b,_=0,S=0;for(let e=C;e<E;e+=l){const i=n+e*r[1];for(let e=f;e<m;e+=h){const n=i+e*r[2];for(let e=c;e<p;e+=d){const i=t[n+e*r[3]+o];if("max"===a&&i>k?k=i:"avg"===a&&(_+=i,S++),isNaN(k))break}if(isNaN(k))break}if(isNaN(k))break}w[y+o]="avg"===a?_/Math.max(S,1):k}}}}return x}const ml={kernelName:o.AvgPool,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e;Jc(i,"avgPool");const{filterSize:a,strides:s,pad:c,dimRoundingMode:u}=r;o.util.assert(o.backend_util.eitherStridesOrDilationsAreOne(s,1),(()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(1,"'")));const l=o.backend_util.computePool2DInfo(i.shape,a,s,1,c,u);let h;if(1===l.filterWidth&&1===l.filterHeight&&o.util.arraysEqual(l.inShape,l.outShape))h=su({inputs:{x:i},backend:n});else{const t=n.data.get(i.dataId).values,e=o.util.computeStrides(i.shape),r=fl(t,i.shape,i.dtype,e,l,"avg");h=n.makeTensorInfo(l.outShape,i.dtype,r.values)}return h}};const yl={kernelName:o.AvgPool3D,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{filterSize:a,strides:s,pad:c,dimRoundingMode:u,dataFormat:l}=r;Jc(i,"avgPool3d");const h=o.backend_util.computePool3DInfo(i.shape,a,s,1,c,u,l),d=gl(n.data.get(i.dataId).values,i.shape,i.dtype,o.util.computeStrides(i.shape),h,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}};const vl={kernelName:o.AvgPool3DGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:a}=e,{filterSize:s,strides:c,pad:u,dimRoundingMode:l}=r;Jc([i,a],"avgPool3DGrad");const h=o.backend_util.computePool3DInfo(a.shape,s,c,1,u,l),d=h.strideDepth,f=h.strideHeight,p=h.strideWidth,g=h.filterDepth,m=h.filterHeight,y=h.filterWidth,v=h.dilationDepth,b=h.dilationHeight,x=h.dilationWidth,w=h.effectiveFilterDepth,k=h.effectiveFilterHeight,_=h.effectiveFilterWidth,S=w-1-h.padInfo.front,A=_-1-h.padInfo.left,C=k-1-h.padInfo.top,E=(0,o.buffer)(a.shape,"float32"),T=1/(g*m*y),N=n.bufferSync(i);for(let o=0;o<h.batchSize;++o)for(let t=0;t<h.inChannels;++t)for(let e=0;e<h.inDepth;++e)for(let n=0;n<h.inHeight;++n)for(let r=0;r<h.inWidth;++r){const i=e-S,a=n-C,s=r-A;let c=0;for(let e=0;e<w;e+=v){const n=(i+e)/d;if(!(n<0||n>=h.outDepth||Math.floor(n)!==n))for(let e=0;e<k;e+=b){const r=(a+e)/f;if(!(r<0||r>=h.outHeight||Math.floor(r)!==r))for(let e=0;e<_;e+=x){const i=(s+e)/p;if(i<0||i>=h.outWidth||Math.floor(i)!==i)continue;c+=N.get(o,n,r,i,t)}}}E.set(c*T,o,e,n,r,t)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}};const bl={kernelName:o.AvgPoolGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:a}=e,s=a;Jc([i,a],"avgPoolGrad");const{filterSize:c,strides:u,pad:l}=r,h=o.backend_util.computePool2DInfo(s.shape,c,u,1,l),d=h.strideHeight,f=h.strideWidth,p=h.filterHeight,g=h.filterWidth,m=h.dilationHeight,y=h.dilationWidth,v=h.effectiveFilterHeight,b=h.effectiveFilterWidth,x=b-1-h.padInfo.left,w=v-1-h.padInfo.top,k=(0,o.buffer)(s.shape,"float32"),_=1/(p*g),S=n.data.get(i.dataId).values,A=(0,o.buffer)(i.shape,"float32",S);for(let o=0;o<h.batchSize;++o)for(let t=0;t<h.inChannels;++t)for(let e=0;e<h.inHeight;++e)for(let n=0;n<h.inWidth;++n){const r=e-w,i=n-x;let a=0;for(let e=0;e<v;e+=m){const n=(r+e)/d;if(!(n<0||n>=h.outHeight||Math.floor(n)!==n))for(let e=0;e<b;e+=y){const r=(i+e)/f;if(r<0||r>=h.outWidth||Math.floor(r)!==r)continue;a+=A.get(o,n,r,t)}}k.set(a*_,o,e,n,t)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}};const xl={kernelName:o.FusedBatchNorm,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,scale:a,offset:s,mean:c,variance:u}=e;o.util.assert(c.shape.length===u.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),o.util.assert(null==s||c.shape.length===s.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),o.util.assert(null==a||c.shape.length===a.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks.")),Jc([i,c,u,a,s],"batchNorm");let{varianceEpsilon:l}=r;null==l&&(l=.001);const h=n.data.get(i.dataId).values,d=n.data.get(c.dataId).values,f=n.data.get(u.dataId).values,p=a?n.data.get(a.dataId).values:new Float32Array([1]),g=s?n.data.get(s.dataId).values:new Float32Array([0]),m=new Float32Array(h.length),y=g.length,v=p.length,b=f.length,x=d.length;let w=0,k=0,_=0,S=0;for(let o=0;o<h.length;++o)m[o]=g[w++]+(h[o]-d[k++])*p[_++]/Math.sqrt(f[S++]+l),w>=y&&(w=0),k>=x&&(k=0),_>=v&&(_=0),S>=b&&(S=0);return n.makeTensorInfo(i.shape,i.dtype,m)}};function wl(t,e,n,r,i){const a=o.slice_util.isSliceContinous(r,e,n),s=o.util.sizeFromShape(n),c=o.util.computeStrides(r);if(a){const n=o.slice_util.computeFlatOffset(e,c);return"string"===i?t.slice(n,n+s):t.subarray(n,n+s)}const u="string"===i?o.backend_util.fromUint8ToStringArray(t):t,l=(0,o.buffer)(r,i,u),h=(0,o.buffer)(n,i);for(let o=0;o<h.size;++o){const t=h.indexToLoc(o),n=t.map(((t,n)=>t+e[n]));h.set(l.get(...n),...t)}return"string"===i?o.backend_util.fromStringArrayToUint8(h.values):h.values}function kl(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{begin:a,size:s}=r;Jc(i,"slice");const[c,u]=o.slice_util.parseSliceParams(i,a,s);o.slice_util.assertParamsValid(i,c,u);const l=wl(n.data.get(i.dataId).values,c,u,i.shape,i.dtype);return n.makeTensorInfo(u,i.dtype,l)}const _l={kernelName:o.Slice,backendName:"cpu",kernelFunc:kl};const Sl={kernelName:o.BatchToSpaceND,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockShape:a,crops:s}=r;Jc([i],"batchToSpaceND");const c=a.reduce(((t,e)=>t*e)),u=o.backend_util.getReshaped(i.shape,a,c),l=o.backend_util.getPermuted(u.length,a.length),h=o.backend_util.getReshapedPermuted(i.shape,a,c),d=o.backend_util.getSliceBeginCoords(s,a.length),f=o.backend_util.getSliceSize(h,s,a.length),p=Bu({inputs:{x:i},backend:n,attrs:{shape:u}}),g=$u({inputs:{x:p},backend:n,attrs:{perm:l}}),m=Bu({inputs:{x:g},backend:n,attrs:{shape:h}}),y=kl({inputs:{x:m},backend:n,attrs:{begin:d,size:f}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),y}};function Al(t,e,n,r,i){const a=o.util.sizeFromShape(r),s=o.util.makeZerosTypedArray(i,n);for(let o=0;o<t.length;o++){const n=t[o];if(n<0)throw new Error("Input x must be non-negative!");n>=i||(s[n]+=a>0?e[o]:1)}return s}function Cl(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=t.shape[0],a=t.shape[1],s=(0,o.buffer)([i,n],e.dtype);for(let o=0;o<i;o++)for(let i=0;i<a;i++){const a=t.get(o,i);if(a<0)throw new Error("Input x must be non-negative!");a>=n||(r?s.set(1,o,a):e.size>0?s.set(s.get(o,a)+e.get(o,i),o,a):s.set(s.get(o,a)+1,o,a))}return s}const El={kernelName:o.Bincount,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,weights:a}=e,{size:o}=r,s=Al(n.data.get(i.dataId).values,n.data.get(a.dataId).values,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,s)}},Tl=hu(((t,e)=>t&e)),Nl=Fu(o.BitwiseAnd,Tl),Dl={kernelName:o.BitwiseAnd,backendName:"cpu",kernelFunc:Nl};const Fl={kernelName:o.BroadcastArgs,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{s0:r,s1:i}=e,a=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,c=o.backend_util.assertAndGetBroadcastShape(Array.from(a),Array.from(s));return n.makeTensorInfo([c.length],"int32",Int32Array.from(c))}},Il=nu((t=>Math.ceil(t))),Ml=iu(o.Ceil,Il),Ol={kernelName:o.Ceil,backendName:"cpu",kernelFunc:Ml},Rl=ru(o.ClipByValue,((t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t})),zl={kernelName:o.ClipByValue,backendName:"cpu",kernelFunc:Rl},Bl={kernelName:o.ComplexAbs,backendName:"cpu",kernelFunc:t=>{const{x:e}=t.inputs,n=t.backend,r=new Float32Array(o.util.sizeFromShape(e.shape)),i=n.data.get(e.dataId),a=i.complexTensorInfos.real,s=i.complexTensorInfos.imag,c=n.data.get(a.dataId).values,u=n.data.get(s.dataId).values;for(let o=0;o<c.length;o++){const t=c[o],e=u[o];r[o]=Math.hypot(t,e)}return n.makeOutput(r,e.shape,"float32")}};function Ll(t,e,n,r){const i=o.util.getArrayFromDType(n,o.util.sizeFromShape(e));if(r&&"string"!==n){let e=0;t.forEach((t=>{const n=o.util.sizeFromShape(t.shape);i.set(t.vals,e),e+=n}))}else{let r=0;t.forEach((t=>{const a="string"===n?o.backend_util.fromUint8ToStringArray(t.vals):t.vals;let s=0;for(let n=0;n<t.shape[0];++n){const o=n*e[1]+r;for(let e=0;e<t.shape[1];++e)i[o+e]=a[s++]}r+=t.shape[1]}))}return i}function Pl(t){const{inputs:e,backend:n}=t,{input:r}=e,i=n.data.get(r.dataId).complexTensorInfos.imag,a=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,a)}const jl={kernelName:o.Imag,backendName:"cpu",kernelFunc:Pl};function Ul(t){const{inputs:e,backend:n,attrs:r}=t,{axis:i}=r,a=o.util.parseAxisParam(i,e[0].shape)[0],s=e.map((t=>t.shape));o.backend_util.assertParamsConsistent(s,a);let c=o.backend_util.computeOutShape(e.map((t=>t.shape)),a);if(0===o.util.sizeFromShape(c))return n.makeTensorInfo(c,e[0].dtype,[]);const u=e.filter((t=>o.util.sizeFromShape(t.shape)>0));if(1===u.length)return su({inputs:{x:u[0]},backend:n});if("complex64"===u[0].dtype){const t=u.map((t=>Cu({inputs:{input:t},backend:n}))),e=u.map((t=>Pl({inputs:{input:t},backend:n}))),r=Ul({inputs:t,backend:n,attrs:{axis:a}}),i=Ul({inputs:e,backend:n,attrs:{axis:a}}),o=_u({inputs:{real:r,imag:i},backend:n});return t.forEach((t=>n.disposeIntermediateTensorInfo(t))),e.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),o}const l=u.map((t=>{const e=o.util.sizeFromShape(t.shape.slice(a));return Bu({inputs:{x:t},backend:n,attrs:{shape:[-1,e]}})})),h=l.map((t=>({vals:n.data.get(t.dataId).values,shape:t.shape})));c=o.backend_util.computeOutShape(l.map((t=>t.shape)),1);const d=1===l[0].shape[0],f=Ll(h,c,e[0].dtype,d),p=o.backend_util.computeOutShape(u.map((t=>t.shape)),a),g=n.makeTensorInfo(p,e[0].dtype,f);return l.forEach((t=>n.disposeIntermediateTensorInfo(t))),g}const Wl={kernelName:o.Concat,backendName:"cpu",kernelFunc:Ul};function Vl(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a}=e,{strides:s,pad:c,dataFormat:u,dilations:l,dimRoundingMode:h}=r;Jc([i,a],"conv2d");const d=o.backend_util.convertConv2DDataFormat(u),f=o.backend_util.computeConv2DInfo(i.shape,a.shape,s,l,c,h,!1,d),p=f.filterHeight,g=f.filterWidth,m=f.dilationHeight,y=f.dilationWidth,v=f.padInfo.left,b=f.padInfo.top,x="channelsLast"===f.dataFormat,w=new o.TensorBuffer(f.outShape,i.dtype),k=o.util.computeStrides(i.shape),_=o.util.computeStrides(a.shape),S=k[0],A=x?k[1]:k[2],C=x?k[2]:1,E=x?1:k[1],T=w.strides[0],N=x?w.strides[1]:w.strides[2],D=x?w.strides[2]:1,F=x?1:w.strides[1],I=n.data.get(i.dataId).values,M=n.data.get(a.dataId).values,O=w.values;for(let o=0;o<f.batchSize;++o){const t=o*S,e=o*T;for(let n=0;n<f.outHeight;++n){const r=e+n*N,i=n*f.strideHeight-b;for(let e=0;e<p;++e){const n=i+e*m;if(n<0||n>=f.inHeight)continue;const a=e*_[0],o=t+n*A;for(let t=0;t<f.outWidth;++t){const e=r+t*D,n=t*f.strideWidth-v;for(let t=0;t<g;++t){const r=n+t*y;if(r<0||r>=f.inWidth)continue;const i=o+r*C;let s=a+t*_[1];for(let t=0;t<f.inChannels;++t){const n=I[i+t*E];for(let t=0;t<f.outChannels;++t)O[e+t*F]+=n*M[s+t];s+=f.outChannels}}}}}}return n.makeTensorInfo(w.shape,w.dtype,O)}const ql={kernelName:o.Conv2D,backendName:"cpu",kernelFunc:Vl};const Gl={kernelName:o.Conv2DBackpropFilter,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:a}=e,{strides:s,pad:c,dataFormat:u,dimRoundingMode:l,filterShape:h}=r;Jc([i,a],"conv2dBackpropFilter");const d=o.backend_util.convertConv2DDataFormat(u),f=o.backend_util.computeConv2DInfo(i.shape,h,s,1,c,l,!1,d),{strideHeight:p,strideWidth:g,filterHeight:m,filterWidth:y}=f,v="channelsLast"===f.dataFormat,b=new o.TensorBuffer(f.filterShape,"float32"),x=f.padInfo.left,w=f.padInfo.top,k=n.data.get(i.dataId).values,_=n.data.get(a.dataId).values,S=new o.TensorBuffer(i.shape,i.dtype,k),A=new o.TensorBuffer(a.shape,a.dtype,_);for(let o=0;o<m;++o){const t=Math.max(0,Math.ceil((w-o)/p)),e=Math.min(f.outHeight,(f.inHeight+w-o)/p);for(let n=0;n<y;++n){const r=Math.max(0,Math.ceil((x-n)/g)),i=Math.min(f.outWidth,(f.inWidth+x-n)/g);for(let a=0;a<f.inChannels;++a)for(let s=0;s<f.outChannels;++s){let c=0;for(let u=0;u<f.batchSize;++u)for(let l=t;l<e;++l){const t=o+l*p-w;for(let e=r;e<i;++e){const r=n+e*g-x;c+=v?S.get(u,t,r,a)*A.get(u,l,e,s):S.get(u,a,t,r)*A.get(u,s,l,e)}}b.set(c,o,n,a,s)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}};const Hl={kernelName:o.Conv2DBackpropInput,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:a}=e,{inputShape:s,strides:c,pad:u,dataFormat:l,dimRoundingMode:h}=r;Jc([i,a],"conv2dBackpropInput");const d=o.util.computeStrides(a.shape),f=o.util.computeStrides(i.shape);let p=o.backend_util.convertConv2DDataFormat(l);const g=o.backend_util.computeConv2DInfo(s,a.shape,c,1,u,h,!1,p),m=new o.TensorBuffer(g.inShape,"float32"),y=m.values,v=n.data.get(i.dataId).values,b=n.data.get(a.dataId).values,[x,w,k]=d,{batchSize:_,filterHeight:S,filterWidth:A,inChannels:C,inHeight:E,inWidth:T,outChannels:N,outHeight:D,outWidth:F,strideHeight:I,strideWidth:M}=g;p=g.dataFormat;const O=S-1-g.padInfo.top,R=A-1-g.padInfo.left,z="channelsLast"===p,B=m.strides[0],L=z?m.strides[1]:m.strides[2],P=z?m.strides[2]:1,j=z?1:m.strides[1],U=f[0],W=z?f[1]:f[2],V=z?f[2]:1,q=z?1:f[1];for(let o=0;o<_;++o)for(let t=0;t<C;++t)for(let e=0;e<E;++e){const n=e-O,r=Math.max(0,Math.ceil(n/I)),i=Math.min(D,(S+n)/I);for(let a=0;a<T;++a){const s=a-R,c=Math.max(0,Math.ceil(s/M)),u=Math.min(F,(A+s)/M);let l=0;for(let e=r;e<i;++e){const r=e*I-n;for(let n=c;n<u;++n){const i=U*o+W*e+V*n,a=x*(S-1-r)+w*(A-1-(n*M-s))+k*t;for(let t=0;t<N;++t){l+=v[i+q*t]*b[a+t]}}}y[B*o+L*e+P*a+j*t]=l}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}};const Yl={kernelName:o.Conv3D,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a}=e,{strides:s,pad:c,dilations:u}=r;Jc([i,a],"conv3d");const l=o.backend_util.computeConv3DInfo(i.shape,a.shape,s,u,c),{filterDepth:h,filterHeight:d,filterWidth:f,dilationDepth:p,dilationHeight:g,dilationWidth:m,padInfo:y}=l,v=y.front,b=y.left,x=y.top,w=new o.TensorBuffer(l.outShape,i.dtype),k=n.data.get(i.dataId).values,_=n.data.get(a.dataId).values,S=w.values,A=o.util.computeStrides(i.shape),C=o.util.computeStrides(a.shape);for(let o=0;o<l.batchSize;++o){const t=o*A[0],e=o*w.strides[0];for(let n=0;n<l.outDepth;++n){const r=e+n*w.strides[1],i=n*l.strideDepth-v;for(let e=0;e<h;++e){const n=i+e*p;if(n<0||n>=l.inDepth)continue;const a=e*C[0],o=t+n*A[1];for(let t=0;t<l.outHeight;++t){const e=r+t*w.strides[2],n=t*l.strideHeight-x;for(let t=0;t<d;++t){const r=n+t*g;if(r<0||r>=l.inHeight)continue;const i=a+t*C[1],s=o+r*A[2];for(let t=0;t<l.outWidth;++t){const n=e+t*l.outChannels,r=t*l.strideWidth-b;for(let t=0;t<f;++t){const e=r+t*m;if(e<0||e>=l.inWidth)continue;const a=i+t*C[2],o=s+e*l.inChannels;let c=a;for(let t=0;t<l.inChannels;++t){const e=k[o+t];for(let t=0;t<l.outChannels;++t)S[n+t]+=e*_[c+t];c+=l.outChannels}}}}}}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}};const Xl={kernelName:o.Conv3DBackpropFilterV2,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:a}=e,{strides:s,pad:c,filterShape:u}=r;Jc([i,a],"conv3dBackpropFilterV2");const l=o.util.computeStrides(i.shape),h=o.util.computeStrides(a.shape),d=o.backend_util.computeConv3DInfo(i.shape,u,s,1,c),f=d.strideDepth,p=d.strideHeight,g=d.strideWidth,m=d.filterDepth,y=d.filterHeight,v=d.filterWidth,b=new o.TensorBuffer(d.filterShape,"float32"),x=b.values,[w,k,_,S]=b.strides,A=n.data.get(a.dataId).values,[C,E,T,N]=h,D=n.data.get(i.dataId).values,[F,I,M,O]=l,R=d.padInfo.front,z=d.padInfo.left,B=d.padInfo.top;for(let o=0;o<m;++o){const t=Math.max(0,Math.ceil((R-o)/f)),e=Math.min(d.outDepth,(d.inDepth+R-o)/f),n=o*w;for(let r=0;r<y;++r){const i=Math.max(0,Math.ceil((B-r)/p)),a=Math.min(d.outHeight,(d.inHeight+B-r)/p),s=r*k+n;for(let n=0;n<v;++n){const c=Math.max(0,Math.ceil((z-n)/g)),u=Math.min(d.outWidth,(d.inWidth+z-n)/g),l=n*_+s;for(let s=0;s<d.inChannels;++s){const h=s*S+l;for(let l=0;l<d.outChannels;++l){let m=0;for(let h=0;h<d.batchSize;++h){const d=h*F,y=h*C;for(let h=t;h<e;++h){const t=(o+h*f-R)*I+d,e=h*E+y;for(let o=i;o<a;++o){const i=(r+o*p-B)*M+t,a=o*T+e;for(let t=c;t<u;++t){const e=t*N+a;m+=D[(n+t*g-z)*O+i+s]*A[e+l]}}}}x[h+l]=m}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}};const Kl={kernelName:o.Conv3DBackpropInputV2,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:a}=e,{pad:s,strides:c,inputShape:u}=r;Jc([i],"conv3dBackpropInputV2");const l=o.util.computeStrides(i.shape),h=o.util.computeStrides(a.shape),d=o.backend_util.computeConv3DInfo(u,a.shape,c,1,s),f=new o.TensorBuffer(d.inShape,"float32"),p=f.values,[g,m,y,v]=f.strides,b=n.data.get(i.dataId).values,[x,w,k,_]=l,S=n.data.get(a.dataId).values,[A,C,E,T]=h,{batchSize:N,filterDepth:D,filterHeight:F,filterWidth:I,inChannels:M,inDepth:O,inHeight:R,inWidth:z,outChannels:B,outDepth:L,outHeight:P,outWidth:j,strideDepth:U,strideHeight:W,strideWidth:V}=d,q=D-1-d.padInfo.front,G=F-1-d.padInfo.top,H=I-1-d.padInfo.left;for(let o=0;o<N;++o)for(let t=0;t<M;++t)for(let e=0;e<O;++e){const n=e-q,r=Math.max(0,Math.ceil(n/U)),i=Math.min(L,(D+n)/U);for(let a=0;a<R;++a){const s=a-G,c=Math.max(0,Math.ceil(s/W)),u=Math.min(P,(F+s)/W);for(let l=0;l<z;++l){const h=l-H,d=Math.max(0,Math.ceil(h/V)),f=Math.min(j,(I+h)/V);let N=0;for(let e=r;e<i;++e){const r=e*U-n;for(let n=c;n<u;++n){const i=n*W-s;for(let a=d;a<f;++a){const s=x*o+w*e+k*n+_*a,c=A*(D-1-r)+C*(F-1-i)+E*(I-1-(a*V-h))+T*t;for(let t=0;t<B;++t){N+=b[s+t]*S[c+t]}}}}p[g*o+m*e+y*a+v*l+t]=N}}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}},$l=ru(o.Cos,(t=>Math.cos(t))),Zl={kernelName:o.Cos,backendName:"cpu",kernelFunc:$l},Ql=ru(o.Cosh,(t=>Math.cosh(t))),Jl={kernelName:o.Cosh,backendName:"cpu",kernelFunc:Ql};const th={kernelName:o.CropAndResize,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{image:i,boxes:a,boxInd:s}=e,{cropSize:c,method:u,extrapolationValue:l}=r,[h,d,f,p]=i.shape,g=a.shape[0],[m,y]=c,v=(0,o.buffer)([g,m,y,p],"float32"),b=n.data.get(a.dataId).values,x=n.data.get(s.dataId).values,w=n.data.get(i.dataId).values,k=o.util.computeStrides(i.shape),_=o.util.computeStrides(v.shape);for(let o=0;o<g;o++){const t=4*o,e=b[t],n=b[t+1],r=b[t+2],i=b[t+3],a=x[o];if(a>=h)continue;const s=m>1?(r-e)*(d-1)/(m-1):0,c=y>1?(i-n)*(f-1)/(y-1):0;for(let h=0;h<m;h++){const t=m>1?e*(d-1)+h*s:.5*(e+r)*(d-1);if(t<0||t>d-1)for(let e=0;e<y;e++)for(let t=0;t<p;t++){const n=t+e*_[2]+h*_[1]+o*_[0];v.values[n]=l}else if("bilinear"===u){const e=Math.floor(t),r=Math.ceil(t),s=t-e;for(let t=0;t<y;t++){const u=y>1?n*(f-1)+t*c:.5*(n+i)*(f-1);if(u<0||u>f-1){for(let e=0;e<p;e++){const n=e+t*_[2]+h*_[1]+o*_[0];v.values[n]=l}continue}const d=Math.floor(u),g=Math.ceil(u),m=u-d;for(let n=0;n<p;n++){let i=n+d*k[2]+e*k[1]+a*k[0];const c=w[i];i=n+g*k[2]+e*k[1]+a*k[0];const u=w[i];i=n+d*k[2]+r*k[1]+a*k[0];const l=w[i];i=n+g*k[2]+r*k[1]+a*k[0];const f=c+(u-c)*m,p=l+(w[i]-l)*m;i=n+t*_[2]+h*_[1]+o*_[0],v.values[i]=f+(p-f)*s}}}else for(let e=0;e<y;++e){const r=y>1?n*(f-1)+e*c:.5*(n+i)*(f-1);if(r<0||r>f-1){for(let t=0;t<p;t++){const n=t+e*_[2]+h*_[1]+o*_[0];v.values[n]=l}continue}const s=Math.round(r),u=Math.round(t);for(let t=0;t<p;t++){const n=t+s*k[2]+u*k[1]+a*k[0],r=t+e*_[2]+h*_[1]+o*_[0];v.values[r]=w[n]}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}};const eh={kernelName:o.Cumprod,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,exclusive:s,reverse:c}=r;Jc(i,"cumprod");const u=o.backend_util.getAxesPermutation([a],i.shape.length);let l=i;null!=u&&(l=$u({inputs:{x:i},backend:n,attrs:{perm:u}}));const h=o.backend_util.getInnerMostAxes(1,i.shape.length)[0];if(h!==l.shape.length-1)throw new Error("backend.cumprod in CPU expects an inner-most "+"axis=".concat(l.shape.length-1," but got axis=").concat(h));const d=(0,o.upcastType)(l.dtype,"int32"),f=o.util.makeOnesTypedArray(o.util.sizeFromShape(l.shape),d),p=n.data.get(l.dataId).values,g=l.shape[l.shape.length-1],m=c?(t,e)=>t+g-e-1:(t,e)=>t+e;for(let o=0;o<p.length;o+=g)for(let t=0;t<g;t++){const e=m(o,t);if(0===t)f[e]=s?1:p[e];else{const n=m(o,t-1);f[e]=s?p[n]*f[n]:p[e]*f[n]}}const y=n.makeTensorInfo(l.shape,d,f);if(null!=u){const t=$u({inputs:{x:y},backend:n,attrs:{perm:o.backend_util.getUndoAxesPermutation(u)}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(l),t}return y}};const nh={kernelName:o.Cumsum,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,exclusive:s,reverse:c}=r;Jc(i,"cumsum");const u=o.backend_util.getAxesPermutation([a],i.shape.length);let l=i;null!=u&&(l=$u({inputs:{x:i},backend:n,attrs:{perm:u}}));const h=o.backend_util.getInnerMostAxes(1,i.shape.length)[0];if(h!==l.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most "+"axis=".concat(l.shape.length-1," but got axis=").concat(h));const d=(0,o.upcastType)(l.dtype,"int32"),f=o.util.makeZerosTypedArray(o.util.sizeFromShape(l.shape),d),p=n.data.get(l.dataId).values,g=l.shape[l.shape.length-1],m=c?(t,e)=>t+g-e-1:(t,e)=>t+e;for(let o=0;o<p.length;o+=g)for(let t=0;t<g;t++){const e=m(o,t);if(0===t)f[e]=s?0:p[e];else{const n=m(o,t-1);f[e]=s?p[n]+f[n]:p[e]+f[n]}}const y=n.makeTensorInfo(l.shape,d,f);if(null!=u){const t=$u({inputs:{x:y},backend:n,attrs:{perm:o.backend_util.getUndoAxesPermutation(u)}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(l),t}return y}};const rh={kernelName:o.DenseBincount,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,weights:a}=e,{size:o,binaryOutput:s}=r;if(1===i.shape.length){const t=Al(n.data.get(i.dataId).values,n.data.get(a.dataId).values,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,t)}if(2===i.shape.length){const t=Cl(n.bufferSync(i),n.bufferSync(a),o,s);return n.makeTensorInfo(t.shape,a.dtype,t.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(i.shape.length,"."))}};const ih={kernelName:o.DepthToSpace,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockSize:a,dataFormat:s}=r;o.util.assert("NHWC"===s,(()=>"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(s)));const c=i.shape[0],u=i.shape[1],l=i.shape[2],h=i.shape[3],d=u*a,f=l*a,p=h/(a*a),g=n.data.get(i.dataId).values,m=new Float32Array(c*d*f*p);let y=0;for(let o=0;o<c;++o)for(let t=0;t<d;++t){const e=Math.floor(t/a),n=t%a;for(let t=0;t<f;++t){const r=Math.floor(t/a),i=(n*a+t%a)*p;for(let t=0;t<p;++t){const n=t+i+h*(r+l*(e+u*o));m[y++]=g[n]}}}return n.makeTensorInfo([c,d,f,p],i.dtype,m)}};function ah(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a}=e,{strides:s,pad:c,dilations:u,dimRoundingMode:l}=r;Jc([i,a],"depthwiseConv2DNative");const h=o.util.computeStrides(i.shape),d=o.util.computeStrides(a.shape);let f=u;null==f&&(f=[1,1]),o.util.assert(o.backend_util.eitherStridesOrDilationsAreOne(s,f),(()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(s," and dilations '").concat(f,"'")));const p=o.backend_util.computeConv2DInfo(i.shape,a.shape,s,f,c,l,!0),{filterHeight:g,filterWidth:m,dilationHeight:y,dilationWidth:v,padInfo:b}=p,x=b.left,w=b.top,k=p.outChannels/p.inChannels,_=new o.TensorBuffer(p.outShape,i.dtype),S=n.data.get(i.dataId).values,A=n.data.get(a.dataId).values,C=_.values;for(let o=0;o<p.batchSize;++o){const t=o*h[0],e=o*_.strides[0];for(let n=0;n<p.outHeight;++n){const r=e+n*_.strides[1],i=n*p.strideHeight-w;for(let e=0;e<g;++e){const n=i+e*y;if(n<0||n>=p.inHeight)continue;const a=e*d[0],o=t+n*h[1];for(let t=0;t<p.outWidth;++t){const e=r+t*_.strides[2],n=t*p.strideWidth-x;for(let t=0;t<m;++t){const r=n+t*v;if(r<0||r>=p.inWidth)continue;const i=a+t*d[1],s=o+r*p.inChannels;let c=e,u=i;for(let t=0;t<p.inChannels;++t){const e=S[s+t];for(let t=0;t<k;++t)C[c+t]+=e*A[u+t];c+=k,u+=k}}}}}}return n.makeTensorInfo(_.shape,_.dtype,_.values)}const oh={kernelName:o.DepthwiseConv2dNative,backendName:"cpu",kernelFunc:ah};const sh={kernelName:o.DepthwiseConv2dNativeBackpropFilter,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:a}=e,{strides:s,dilations:c,pad:u,dimRoundingMode:l,filterShape:h}=r;Jc([i,a],"depthwiseConv2dNativeBackpropFilter");const d=o.backend_util.computeConv2DInfo(i.shape,h,s,c,u,l,!0),{strideHeight:f,strideWidth:p,filterHeight:g,filterWidth:m}=d,y=new o.TensorBuffer(d.filterShape,"float32"),v=d.padInfo.left,b=d.padInfo.top,x=d.outChannels/d.inChannels,w=n.data.get(i.dataId).values,k=new o.TensorBuffer(i.shape,i.dtype,w),_=n.data.get(a.dataId).values,S=new o.TensorBuffer(a.shape,a.dtype,_);for(let o=0;o<g;++o){const t=Math.max(0,Math.ceil((b-o)/f)),e=Math.min(d.outHeight,(d.inHeight+b-o)/f);for(let n=0;n<m;++n){const r=Math.max(0,Math.ceil((v-n)/p)),i=Math.min(d.outWidth,(d.inWidth+v-n)/p);for(let a=0;a<d.outChannels;++a){const s=Math.trunc(a/x),c=a%x;let u=0;for(let l=0;l<d.batchSize;++l)for(let c=t;c<e;++c){const t=o+c*f-b;for(let e=r;e<i;++e){const r=n+e*p-v;u+=k.get(l,t,r,s)*S.get(l,c,e,a)}}y.set(u,o,n,s,c)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};const ch={kernelName:o.DepthwiseConv2dNativeBackpropInput,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:a}=e,{strides:s,dilations:c,pad:u,dimRoundingMode:l,inputShape:h}=r;Jc([i,a],"depthwiseConv2DNativeBackpropInput");const d=o.util.computeStrides(i.shape),f=o.util.computeStrides(a.shape),p=o.backend_util.computeConv2DInfo(h,a.shape,s,c,u,l,!0),g=new o.TensorBuffer(p.inShape,"float32"),m=g.values,[y,v,b]=g.strides,x=n.data.get(i.dataId).values,[w,k,_]=d,S=n.data.get(a.dataId).values,[A,C,E]=f,{batchSize:T,filterHeight:N,filterWidth:D,inChannels:F,inHeight:I,inWidth:M,outChannels:O,outHeight:R,outWidth:z,strideHeight:B,strideWidth:L}=p,P=N-1-p.padInfo.top,j=D-1-p.padInfo.left,U=O/F;for(let o=0;o<T;++o)for(let t=0;t<F;++t)for(let e=0;e<I;++e){const n=e-P,r=Math.max(0,Math.ceil(n/B)),i=Math.min(R,(N+n)/B);for(let a=0;a<M;++a){const s=a-j,c=Math.max(0,Math.ceil(s/L)),u=Math.min(z,(D+s)/L);let l=0;for(let e=r;e<i;++e){const r=e*B-n;for(let n=c;n<u;++n){const i=w*o+k*e+_*n,a=A*(N-1-r)+C*(D-1-(n*L-s))+E*t;for(let e=0;e<U;++e){l+=x[i+(t*U+e)]*S[a+e]}}}m[y*o+v*e+b*a+t]=l}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}};const uh={kernelName:o.Diag,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e,i=o.util.sizeFromShape(r.shape),a=n.data.get(r.dataId).values,s=(0,o.buffer)([i,i],r.dtype),c=s.values;for(let o=0;o<a.length;o++)c[o*i+o]=a[o];const u=[...r.shape,...r.shape];return n.makeTensorInfo(u,s.dtype,s.values)}},lh={kernelName:o.Dilation2D,backendName:"cpu",kernelFunc:t=>{let{inputs:e,backend:n,attrs:r}=t;const{x:i,filter:a}=e,{strides:s,pad:c,dilations:u}=r,l=n,h=l.data.get(i.dataId).values,d=i.shape.length,f=l.data.get(a.dataId).values,p=a.shape.length,{batchSize:g,inHeight:m,inWidth:y,inChannels:v,outHeight:b,outWidth:x,padInfo:w,strideHeight:k,strideWidth:_,filterHeight:S,filterWidth:A,dilationHeight:C,dilationWidth:E,outShape:T}=o.backend_util.computeDilation2DInfo(i.shape,a.shape,s,c,"NHWC",u),N=o.util.sizeFromShape(T),D=T.length,F=o.util.getArrayFromDType(i.dtype,N);for(let I=0;I<g;++I)for(let t=0;t<b;++t){const e=t*k-w.top;for(let n=0;n<x;++n){const r=n*_-w.left;for(let s=0;s<v;++s){let c=Number.MIN_SAFE_INTEGER;for(let t=0;t<S;++t){const n=e+t*C;if(n>=0&&n<m)for(let e=0;e<A;++e){const u=r+e*E;if(u>=0&&u<y){const r=o.util.locToIndex([I,n,u,s],d,o.util.computeStrides(i.shape)),l=o.util.locToIndex([t,e,s],p,o.util.computeStrides(a.shape)),g=h[r]+f[l];g>c&&(c=g)}}}F[o.util.locToIndex([I,t,n,s],D,o.util.computeStrides(T))]=c}}}return{dataId:l.write(o.util.toTypedArray(F,i.dtype),T,i.dtype),shape:T,dtype:i.dtype}}},hh={kernelName:o.Dilation2DBackpropFilter,backendName:"cpu",kernelFunc:t=>{let{inputs:e,backend:n,attrs:r}=t;const{x:i,filter:a,dy:s}=e,{strides:c,pad:u,dilations:l}=r,h=n,d=o.util.toNestedArray(i.shape,h.data.get(i.dataId).values),f=o.util.toNestedArray(a.shape,h.data.get(a.dataId).values),{batchSize:p,inHeight:g,inWidth:m,inChannels:y,outHeight:v,outWidth:b,padInfo:x,strideHeight:w,strideWidth:k,filterHeight:_,filterWidth:S,dilationHeight:A,dilationWidth:C,outShape:E}=o.backend_util.computeDilation2DInfo(i.shape,a.shape,c,u,"NHWC",l);o.util.assert(s.rank===E.length,(()=>"Error in ".concat(o.Dilation2DBackpropFilter,", dy ")+"must have the same rank as output ".concat(E.length,", but got ")+"".concat(s.rank)));const T=o.util.toNestedArray(E,h.data.get(s.dataId).values),N=o.util.makeZerosNestedTypedArray(a.shape,a.dtype);for(let o=0;o<p;++o)for(let t=0;t<v;++t){const e=t*w-x.top;for(let n=0;n<b;++n){const r=n*k-x.left;for(let i=0;i<y;++i){let a=Number.MIN_SAFE_INTEGER,s=0,c=0;for(let t=0;t<_;++t){const n=e+t*A;if(n>=0&&n<g)for(let e=0;e<S;++e){const u=r+e*C;if(u>=0&&u<m){const r=d[o][n][u][i]+f[t][e][i];r>a&&(a=r,s=t,c=e)}}}N[s][c][i]+=T[o][t][n][i]}}}return{dataId:h.write(o.util.toTypedArray(N,i.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},dh={kernelName:o.Dilation2DBackpropInput,backendName:"cpu",kernelFunc:t=>{let{inputs:e,backend:n,attrs:r}=t;const{x:i,filter:a,dy:s}=e,{strides:c,pad:u,dilations:l}=r,h=n,d=o.util.toNestedArray(i.shape,h.data.get(i.dataId).values),f=o.util.toNestedArray(a.shape,h.data.get(a.dataId).values),{batchSize:p,inHeight:g,inWidth:m,inChannels:y,outHeight:v,outWidth:b,padInfo:x,strideHeight:w,strideWidth:k,filterHeight:_,filterWidth:S,dilationHeight:A,dilationWidth:C,outShape:E}=o.backend_util.computeDilation2DInfo(i.shape,a.shape,c,u,"NHWC",l);o.util.assert(s.rank===E.length,(()=>"Error in ".concat(o.Dilation2DBackpropInput,", dy ")+"must have the same rank as output ".concat(E.length,", but got ")+"".concat(s.rank)));const T=o.util.toNestedArray(E,h.data.get(s.dataId).values),N=o.util.makeZerosNestedTypedArray(i.shape,i.dtype);for(let o=0;o<p;++o)for(let t=0;t<v;++t){const e=t*w-x.top;for(let n=0;n<b;++n){const r=n*k-x.left;for(let i=0;i<y;++i){let a=Number.MIN_SAFE_INTEGER,s=e<0?0:e,c=r<0?0:r;for(let t=0;t<_;++t){const n=e+t*A;if(n>=0&&n<g)for(let e=0;e<S;++e){const u=r+e*C;if(u>=0&&u<m){const r=d[o][n][u][i]+f[t][e][i];r>a&&(a=r,s=n,c=u)}}}N[o][s][c][i]+=T[o][t][n][i]}}}return{dataId:h.write(o.util.toTypedArray(N,i.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}};const fh={kernelName:o.Draw,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{image:i}=e,{canvas:a,options:o}=r,{contextOptions:s,imageOptions:c}=o||{},u=(null===c||void 0===c?void 0:c.alpha)||1,l=(null===s||void 0===s?void 0:s.contextType)||"2d";if("2d"!==l)throw new Error("Context type ".concat(s.contextType," is not supported by the CPU backend."));const h=a.getContext(l,(null===s||void 0===s?void 0:s.contextAttributes)||{});if(null==h)throw new Error("Could not get the context with ".concat(l," type."));const[d,f]=i.shape.slice(0,2),p=2===i.shape.length?1:i.shape[2],g=n.data.get(i.dataId).values,m="float32"===i.dtype?255:1,y=new Uint8ClampedArray(f*d*4);for(let b=0;b<d*f;++b){const t=[0,0,0,255*u];for(let n=0;n<p;n++){const e=g[b*p+n];if("float32"===i.dtype){if(e<0||e>1)throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(e,"."))}else if("int32"===i.dtype&&(e<0||e>255))throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(e,"."));1===p?(t[0]=e*m,t[1]=e*m,t[2]=e*m):t[n]=e*m}const e=4*b;y[e+0]=Math.round(t[0]),y[e+1]=Math.round(t[1]),y[e+2]=Math.round(t[2]),y[e+3]=Math.round(t[3])}a.width=f,a.height=d;const v=new ImageData(y,f,d);return h.putImageData(v,0,0),i}},ph=hu(((t,e)=>t*e)),gh=Iu(((t,e,n,r)=>({real:t*n-e*r,imag:t*r+e*n}))),mh=Fu(o.Multiply,ph,gh),yh={kernelName:o.Multiply,backendName:"cpu",kernelFunc:mh};function vh(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,keepDims:s}=r;let c;Jc(i,"sum"),c="bool"===i.dtype?Nu({inputs:{x:i},backend:n,attrs:{dtype:"int32"}}):su({inputs:{x:i},backend:n});const u=c.shape.length,l=o.util.parseAxisParam(a,c.shape),h=o.backend_util.getAxesPermutation(l,u);let d=l,f=c;null!=h&&(f=$u({inputs:{x:c},backend:n,attrs:{perm:h}}),d=o.backend_util.getInnerMostAxes(d.length,u)),o.backend_util.assertAxesAreInnerMostDims("sum",d,f.shape.length);const[p,g]=o.backend_util.computeOutAndReduceShapes(f.shape,d);let m=Au(n,p,o.backend_util.upcastType(f.dtype,"int32"));const y=o.util.sizeFromShape(g),v=n.data.get(m.dataId).values,b=n.data.get(f.dataId).values;for(let o=0;o<v.length;++o){const t=o*y;let e=0;for(let n=0;n<y;++n)e+=b[t+n];v[o]=e}if(s){const t=m;m=Bu({inputs:{x:m},backend:n,attrs:{shape:o.backend_util.expandShapeToKeepDim(m.shape,l)}}),n.disposeIntermediateTensorInfo(t)}return n.disposeIntermediateTensorInfo(c),null!=h&&n.disposeIntermediateTensorInfo(f),m}const bh={kernelName:o.Sum,backendName:"cpu",kernelFunc:vh};const xh={kernelName:o.Einsum,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{equation:i}=r,a=e,{allDims:s,summedDims:c,idDims:u}=o.backend_util.decodeEinsumEquation(i,a.length);o.backend_util.checkEinsumDimSizes(s.length,u,a);const{path:l,steps:h}=o.backend_util.getEinsumComputePath(c,u),d=h.length;let f=null,p=s.length;const g=[];for(let m=0;m<d;++m){for(const t of h[m]){const{permutationIndices:e,expandDims:r}=o.backend_util.getEinsumPermutation(p,u[t]);let i;o.backend_util.isIdentityPermutation(e)?i=a[t]:(i=$u({inputs:{x:a[t]},backend:n,attrs:{perm:e}}),g.push(i));const s=i.shape.slice();for(let t=0;t<r.length;++t)s.splice(r[t],0,1);o.util.arraysEqual(i.shape,s)||(i=Bu({inputs:{x:i},backend:n,attrs:{shape:s}}),g.push(i)),null===f?f=i:(f=mh({inputs:{a:i,b:f},backend:n}),g.push(f))}m<d-1&&(l[m]>=0&&(f=vh({inputs:{x:f},backend:n,attrs:{axis:l[m]-(s.length-p),keepDims:!1}}),g.push(f)),p--)}for(const o of g)o!==f&&n.disposeIntermediateTensorInfo(o);return f}};const wh={kernelName:o.EluGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{dy:r,y:i}=e;Jc([r,i],"eluGrad");const a=new Float32Array(o.util.sizeFromShape(i.shape)),s=n.data.get(i.dataId).values,c=n.data.get(r.dataId).values;for(let o=0;o<s.length;++o){const t=s[o];a[o]=t>=0?c[o]:c[o]*(t+1)}return n.makeTensorInfo(i.shape,"float32",a)}},kh=hu(((t,e)=>t===e?1:0)),_h=Fu(o.Equal,kh,null,"bool"),Sh={kernelName:o.Equal,backendName:"cpu",kernelFunc:_h},Ah=o.backend_util.ERF_P,Ch=o.backend_util.ERF_A1,Eh=o.backend_util.ERF_A2,Th=o.backend_util.ERF_A3,Nh=o.backend_util.ERF_A4,Dh=o.backend_util.ERF_A5,Fh=ru(o.Erf,(t=>{const e=Math.sign(t),n=Math.abs(t),r=1/(1+Ah*n);return e*(1-((((Dh*r+Nh)*r+Th)*r+Eh)*r+Ch)*r*Math.exp(-n*n))})),Ih={kernelName:o.Erf,backendName:"cpu",kernelFunc:Fh},Mh=nu((t=>Math.exp(t))),Oh=iu(o.Exp,Mh,"float32"),Rh={kernelName:o.Exp,backendName:"cpu",kernelFunc:Oh};function zh(t){const{inputs:e,backend:n,attrs:r}=t,{input:i}=e,{dim:a}=r,s=i.shape.length,c=i.shape.slice();let u=a;return a<0&&(o.util.assert(-(s+1)<=a,(()=>"Axis must be in the interval [".concat(-(s+1),", ").concat(s,"]"))),u=s+a+1),c.splice(u,0,1),Bu({inputs:{x:i},backend:n,attrs:{shape:c}})}const Bh={kernelName:o.ExpandDims,backendName:"cpu",kernelFunc:zh},Lh=nu((t=>Math.expm1(t))),Ph=iu(o.Expm1,Lh),jh={kernelName:o.Expm1,backendName:"cpu",kernelFunc:Ph},Uh=hu(((t,e)=>t/e)),Wh=Fu(o.RealDiv,Uh),Vh={kernelName:o.RealDiv,backendName:"cpu",kernelFunc:Wh},qh=hu(((t,e)=>t-e)),Gh=Iu(((t,e,n,r)=>({real:t-n,imag:e-r}))),Hh=Fu(o.Sub,qh,Gh),Yh={kernelName:o.Sub,backendName:"cpu",kernelFunc:Hh};function Xh(t,e,n){const r=t.shape,i=r[0],a=r[1],s=n.data.get(t.dataId),c=s.complexTensorInfos.real,u=s.complexTensorInfos.imag,l=[i,a],h=o.util.sizeFromShape(l),d=o.util.getTypedArrayFromDType("float32",h),f=o.util.getTypedArrayFromDType("float32",h);for(let y=0;y<i;y++){const t=kl({inputs:{x:c},backend:n,attrs:{begin:[y,0],size:[1,a]}}),r=kl({inputs:{x:u},backend:n,attrs:{begin:[y,0],size:[1,a]}}),i=_u({inputs:{real:t,imag:r},backend:n}),{real:s,imag:l}=Kh(i,e,n),h=o.backend_util.mergeRealAndImagArrays(s,l);for(let e=0;e<a;e++){const t=o.backend_util.getComplexWithIndex(h,e);d[y*a+e]=t.real,f[y*a+e]=t.imag}n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i)}const p=n.makeTensorInfo(l,"float32",d),g=n.makeTensorInfo(l,"float32",f),m=_u({inputs:{real:p,imag:g},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),m}function Kh(t,e,n){const r=o.util.sizeFromShape(t.shape),i=n.data.get(t.dataId),a=n.data.get(i.complexTensorInfos.real.dataId).values,s=n.data.get(i.complexTensorInfos.imag.dataId).values;if(0===((c=r)&c-1)){const i=$h(a,s,r,e,n),c=[t.shape[0],t.shape[1]];if(e){const t=n.makeTensorInfo(c,"float32",i.real),e=n.makeTensorInfo(c,"float32",i.imag),a=n.makeTensorInfo([],"float32",o.util.createScalarValue(r,"float32")),s=su({inputs:{x:a},backend:n}),u=Vh.kernelFunc({inputs:{a:t,b:a},backend:n}),l=Vh.kernelFunc({inputs:{a:e,b:s},backend:n}),h=n.data.get(u.dataId).values,d=n.data.get(l.dataId).values;return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(l),{real:h,imag:d}}return i}{const t=function(t,e,n){const r=new Float32Array(2*e);for(let i=0;i<e;i++){let a=0,s=0;for(let r=0;r<e;r++){const c=o.backend_util.exponent(i*r,e,n),u=o.backend_util.getComplexWithIndex(t,r);a+=u.real*c.real-u.imag*c.imag,s+=u.real*c.imag+u.imag*c.real}n&&(a/=e,s/=e),o.backend_util.assignToTypedArray(r,a,s,i)}return r}(o.backend_util.mergeRealAndImagArrays(a,s),r,e);return o.backend_util.splitRealAndImagArrays(t)}var c}function $h(t,e,n,r,i){if(1===n)return{real:t,imag:e};const a=o.backend_util.mergeRealAndImagArrays(t,e),s=n/2,c=o.backend_util.complexWithEvenIndex(a),u=c.real,l=c.imag,h=[u.length],d=i.makeTensorInfo(h,"float32",u),f=i.makeTensorInfo(h,"float32",l),p=_u({inputs:{real:d,imag:f},backend:i}),g=o.backend_util.complexWithOddIndex(a),m=g.real,y=g.imag,v=[m.length],b=i.makeTensorInfo(v,"float32",m),x=i.makeTensorInfo(v,"float32",y),w=_u({inputs:{real:b,imag:x},backend:i}),k=$h(u,l,s,r,i),_=k.real,S=k.imag,A=[_.length],C=i.makeTensorInfo(A,"float32",_),E=i.makeTensorInfo(A,"float32",S),T=_u({inputs:{real:C,imag:E},backend:i}),N=$h(m,y,s,r,i),D=N.real,F=N.imag,I=[D.length],M=i.makeTensorInfo(I,"float32",D),O=i.makeTensorInfo(I,"float32",F),R=_u({inputs:{real:M,imag:O},backend:i}),z=o.backend_util.exponents(n,r),B=[z.real.length],L=i.makeTensorInfo(B,"float32",z.real),P=i.makeTensorInfo(B,"float32",z.imag),j=_u({inputs:{real:L,imag:P},backend:i}),U=mh({inputs:{a:j,b:R},backend:i}),W=Ru({inputs:{a:T,b:U},backend:i}),V=Hh({inputs:{a:T,b:U},backend:i}),q=Cu({inputs:{input:W},backend:i}),G=Cu({inputs:{input:V},backend:i}),H=Pl({inputs:{input:W},backend:i}),Y=Pl({inputs:{input:V},backend:i}),X=Ul({inputs:[q,G],backend:i,attrs:{axis:0}}),K=Ul({inputs:[H,Y],backend:i,attrs:{axis:0}}),$=i.data.get(X.dataId).values,Z=i.data.get(K.dataId).values;return i.disposeIntermediateTensorInfo(d),i.disposeIntermediateTensorInfo(f),i.disposeIntermediateTensorInfo(p),i.disposeIntermediateTensorInfo(b),i.disposeIntermediateTensorInfo(x),i.disposeIntermediateTensorInfo(w),i.disposeIntermediateTensorInfo(C),i.disposeIntermediateTensorInfo(E),i.disposeIntermediateTensorInfo(T),i.disposeIntermediateTensorInfo(M),i.disposeIntermediateTensorInfo(O),i.disposeIntermediateTensorInfo(R),i.disposeIntermediateTensorInfo(L),i.disposeIntermediateTensorInfo(P),i.disposeIntermediateTensorInfo(j),i.disposeIntermediateTensorInfo(U),i.disposeIntermediateTensorInfo(W),i.disposeIntermediateTensorInfo(V),i.disposeIntermediateTensorInfo(q),i.disposeIntermediateTensorInfo(H),i.disposeIntermediateTensorInfo(G),i.disposeIntermediateTensorInfo(Y),i.disposeIntermediateTensorInfo(X),i.disposeIntermediateTensorInfo(K),{real:$,imag:Z}}const Zh={kernelName:o.FFT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:r}=e,i=o.util.sizeFromShape(r.shape),a=r.shape[r.shape.length-1],s=Bu({inputs:{x:r},backend:n,attrs:{shape:[i/a,a]}}),c=Xh(s,!1,n),u=Bu({inputs:{x:c},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(c),u}};function Qh(t){const{backend:e,attrs:n}=t,{shape:r,value:i,dtype:a}=n,s=a||o.util.inferDtype(i),c=o.util.getArrayFromDType(s,o.util.sizeFromShape(r));return function(t,e,n){t.fill(e)}(c,i),e.makeTensorInfo(r,s,c)}const Jh={kernelName:o.Fill,backendName:"cpu",kernelFunc:Qh};const td={kernelName:o.FlipLeftRight,backendName:"cpu",kernelFunc:t=>{let{inputs:e,attrs:n,backend:r}=t;const{image:i}=e,a=r,s=o.util.getTypedArrayFromDType(i.dtype,o.util.sizeFromShape(i.shape)),[c,u,l,h]=i.shape,d=a.data.get(i.dataId).values;for(let o=0;o<c;o++){const t=o*l*u*h;for(let e=0;e<u;e++){const n=e*(l*h);for(let e=0;e<l;e++){const r=e*h;for(let i=0;i<h;i++){const a=Math.round(l-e-1),o=t+n+r+i;let c=d[o];if(a>=0&&a<l){c=d[t+n+a*h+i]}s[o]=c}}}}return{dataId:a.write(s,i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},ed=nu((t=>Math.floor(t))),nd=iu(o.Floor,ed),rd={kernelName:o.Floor,backendName:"cpu",kernelFunc:nd},id=hu(((t,e)=>Math.floor(t/e))),ad=Fu(o.FloorDiv,id,null,"int32"),od={kernelName:o.FloorDiv,backendName:"cpu",kernelFunc:ad};const sd={kernelName:o.FusedConv2D,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a,bias:o,preluActivationWeights:s}=e,{strides:c,pad:u,dataFormat:l,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=r;let g=Vl({inputs:{x:i,filter:a},backend:n,attrs:{strides:c,pad:u,dataFormat:l,dilations:h,dimRoundingMode:d}});if(o){const t=g;if("NCHW"===l&&1===o.shape.length&&1!==o.shape[0]){const t=Bu({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});g=Ru({inputs:{a:g,b:t},backend:n}),n.disposeIntermediateTensorInfo(t)}else g=Ru({inputs:{a:g,b:o},backend:n});n.disposeIntermediateTensorInfo(t)}if(f){const t=g;if("NCHW"===l&&"prelu"===f&&1===s.shape.length&&1!==s.shape[0]){const t=Bu({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});g=ku(n,g,f,t,p),n.disposeIntermediateTensorInfo(t)}else g=ku(n,g,f,s,p);n.disposeIntermediateTensorInfo(t)}return g}};const cd={kernelName:o.FusedDepthwiseConv2D,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a,bias:o,preluActivationWeights:s}=e,{strides:c,pad:u,dataFormat:l,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=r;let g=ah({inputs:{x:i,filter:a},backend:n,attrs:{strides:c,pad:u,dataFormat:l,dilations:h,dimRoundingMode:d}});if(o){const t=g;g=Ru({inputs:{a:g,b:o},backend:n}),n.disposeIntermediateTensorInfo(t)}if(f){const t=g;g=ku(n,g,f,s,p),n.disposeIntermediateTensorInfo(t)}return g}};function ud(t,e,n,r,i,a,s,c,u){const l=(0,o.buffer)([r,a],n);for(let o=0;o<r;o++){const n=[];let r=0;for(let e=0;e<i;e++){const a=t[o*i+e];r+=a*s[e],n.push(a)}if(r<0||r>=u/a)throw new Error("Invalid indices: ".concat(n," does not index into ").concat(c));for(let t=0;t<a;t++)l.values[o*a+t]=e.get(...e.indexToLoc(r*a+t))}return l}const ld={kernelName:o.GatherNd,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{params:r,indices:i}=e,a=o.util.sizeFromShape(r.shape),s=i.shape,c=s[s.length-1],[u,l,h,d]=o.backend_util.prepareAndValidate(r,i);if(0===l)return n.makeTensorInfo(u,r.dtype,[]);const f=ud(n.data.get(i.dataId).values,n.bufferSync(r),r.dtype,l,c,h,d,r.shape,a);return n.makeTensorInfo(u,r.dtype,f.values)}};function hd(t,e,n){const r=(0,o.buffer)(n,t.dtype);for(let i=0;i<r.size;++i){const n=r.indexToLoc(i).slice(),a=n[0],o=n[2],s=e.locToIndex([a,o]);n[2]=e.values[s];const c=t.locToIndex(n);0<=c&&c<t.values.length&&(r.values[i]=t.values[c])}return r}const dd={kernelName:o.GatherV2,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,indices:a}=e,{axis:s,batchDims:c}=r;Jc([i,a],"gatherV2");const u=o.util.parseAxisParam(s,i.shape)[0],l=n.data.get(a.dataId).values,h=i.shape[u];for(let x=0;x<l.length;++x){const t=l[x];o.util.assert(t<=h-1&&t>=0,(()=>"GatherV2: the index value ".concat(t," is not in [0, ").concat(h-1,"]")))}let d=c;null==c&&(d=0);const f=o.util.sizeFromShape(a.shape),p=o.backend_util.segment_util.collectGatherOpShapeInfo(i,a,u,d),g=Bu({inputs:{x:i},backend:n,attrs:{shape:[p.batchSize,p.outerSize,p.dimSize,p.sliceSize]}}),m=Bu({inputs:{x:a},backend:n,attrs:{shape:[p.batchSize,f/p.batchSize]}}),y=[p.batchSize,p.outerSize,f/p.batchSize,p.sliceSize],v=n.bufferSync(m),b=hd(n.bufferSync(g),v,y);return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(p.outputShape,b.dtype,b.values)}},fd=hu(((t,e)=>t>e?1:0)),pd=Fu(o.Greater,fd,null,"bool"),gd={kernelName:o.Greater,backendName:"cpu",kernelFunc:pd},md=hu(((t,e)=>t>=e?1:0)),yd=Fu(o.GreaterEqual,md,null,"bool"),vd={kernelName:o.GreaterEqual,backendName:"cpu",kernelFunc:yd};const bd={kernelName:o.IFFT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:r}=e,i=o.util.sizeFromShape(r.shape),a=r.shape[r.shape.length-1],s=Bu({inputs:{x:r},backend:n,attrs:{shape:[i/a,a]}}),c=Xh(s,!0,n),u=Bu({inputs:{x:c},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(c),u}},xd=ru(o.IsFinite,(t=>Number.isFinite(t)?1:0),"bool"),wd={kernelName:o.IsFinite,backendName:"cpu",kernelFunc:xd},kd=ru(o.IsInf,(t=>Math.abs(t)===1/0?1:0),"bool"),_d={kernelName:o.IsInf,backendName:"cpu",kernelFunc:kd},Sd=ru(o.IsNan,(t=>Number.isNaN(t)?1:0),"bool"),Ad={kernelName:o.IsNan,backendName:"cpu",kernelFunc:Sd},Cd=hu(((t,e)=>t<e?1:0)),Ed=Fu(o.Less,Cd,null,"bool"),Td={kernelName:o.Less,backendName:"cpu",kernelFunc:Ed},Nd=hu(((t,e)=>t<=e?1:0)),Dd=Fu(o.LessEqual,Nd,null,"bool"),Fd={kernelName:o.LessEqual,backendName:"cpu",kernelFunc:Dd};function Id(t,e,n){const r=(e-t)/(n-1),i=o.util.makeZerosTypedArray(n,"float32");i[0]=t;for(let a=1;a<i.length;a++)i[a]=i[a-1]+r;return i}const Md={kernelName:o.LinSpace,backendName:"cpu",kernelFunc:function(t){const{backend:e,attrs:n}=t,{start:r,stop:i,num:a}=n,o=Id(r,i,a);return e.makeTensorInfo([o.length],"float32",o)}},Od=nu((t=>Math.log(t))),Rd=iu(o.Log,Od),zd={kernelName:o.Log,backendName:"cpu",kernelFunc:Rd},Bd=ru(o.Log1p,(t=>Math.log1p(t))),Ld={kernelName:o.Log1p,backendName:"cpu",kernelFunc:Bd},Pd=hu(((t,e)=>t&&e)),jd=Fu(o.LogicalAnd,Pd,null,"bool"),Ud={kernelName:o.LogicalAnd,backendName:"cpu",kernelFunc:jd},Wd=ru(o.LogicalNot,(t=>t?0:1),"bool"),Vd={kernelName:o.LogicalNot,backendName:"cpu",kernelFunc:Wd},qd=hu(((t,e)=>t||e)),Gd=Fu(o.LogicalOr,qd,null,"bool"),Hd={kernelName:o.LogicalOr,backendName:"cpu",kernelFunc:Gd};const Yd={kernelName:o.LRN,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{depthRadius:a,bias:s,alpha:c,beta:u}=r;Jc(i,"LRN");const l=i.shape[3],h=l-1,d=n.data.get(i.dataId).values,f=o.util.sizeFromShape(i.shape),p=new Float32Array(f);function g(t){const e=t%l;let n=t-e+Math.max(0,e-a);const r=t-e+Math.min(e+a,h);let i=0;for(;n<=r;n++){const t=d[n];i+=t*t}return i}for(let o=0;o<f;o++){const t=g(o),e=d[o]*Math.pow(s+c*t,-u);p[o]=e}return n.makeTensorInfo(i.shape,i.dtype,p)}};const Xd={kernelName:o.LRNGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,y:a,dy:s}=e,{depthRadius:c,bias:u,alpha:l,beta:h}=r;Jc(s,"LRNGrad");const d=o.util.sizeFromShape(s.shape),f=s.shape[3],p=n.data.get(s.dataId).values,g=n.data.get(i.dataId).values,m=n.data.get(a.dataId).values,y=new Float32Array(d),v=d;for(let o=0;o<v;o++){const t=o%f,e=o-t+Math.max(0,t-c),n=o-t+Math.min(f,t+c+1);let r=0;for(let i=e;i<n;i++)r+=Math.pow(g[i],2);r=l*r+u;for(let i=e;i<n;i++){let t=-2*l*h*g[i]*m[o]/r;o===i&&(t+=Math.pow(r,-h)),t*=p[o],y[i]+=t}}return n.makeTensorInfo(s.shape,i.dtype,y)}};function Kd(t,e,n,r){const i=o.util.getTypedArrayFromDType(r,o.util.sizeFromShape(n));for(let a=0;a<i.length;++a){const n=a*e;let r=t[n];for(let i=0;i<e;++i){const e=t[n+i];(Number.isNaN(e)||e>r)&&(r=e)}i[a]=r}return i}function $d(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{reductionIndices:a,keepDims:s}=r,c=n;let u=i.shape;const l=u.length,h=o.util.parseAxisParam(a,u);let d=h;const f=o.backend_util.getAxesPermutation(d,l);let p=c.data.get(i.dataId).values;if(null!=f){const t=new Array(l);for(let e=0;e<t.length;e++)t[e]=u[f[e]];p=Ku(p,u,i.dtype,f,t),d=o.backend_util.getInnerMostAxes(d.length,l),u=t}Jc(i,"max"),o.backend_util.assertAxesAreInnerMostDims("max",d,l);const[g,m]=o.backend_util.computeOutAndReduceShapes(u,d),y=Kd(p,o.util.sizeFromShape(m),g,i.dtype),v=c.write(y,g,i.dtype);let b=g;if(s){b=o.backend_util.expandShapeToKeepDim(g,h)}return{dataId:v,shape:b,dtype:i.dtype}}const Zd={kernelName:o.Max,backendName:"cpu",kernelFunc:$d},Qd=hu(((t,e)=>Math.max(t,e))),Jd=Fu(o.Maximum,Qd),tf={kernelName:o.Maximum,backendName:"cpu",kernelFunc:Jd};const ef={kernelName:o.MaxPool,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e;Jc(i,"maxPool");const{filterSize:a,strides:s,pad:c,dimRoundingMode:u}=r;o.util.assert(o.backend_util.eitherStridesOrDilationsAreOne(s,1),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(1,"'")));const l=o.backend_util.computePool2DInfo(i.shape,a,s,1,c,u);let h;if(1===l.filterWidth&&1===l.filterHeight&&o.util.arraysEqual(l.inShape,l.outShape))h=su({inputs:{x:i},backend:n});else{const t=n.data.get(i.dataId).values,e=o.util.computeStrides(i.shape),r=fl(t,i.shape,i.dtype,e,l,"max");h=n.makeTensorInfo(l.outShape,i.dtype,r.values)}return h}};const nf={kernelName:o.MaxPool3D,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{filterSize:a,strides:s,pad:c,dimRoundingMode:u,dataFormat:l}=r;Jc(i,"maxPool3d");const h=o.backend_util.computePool3DInfo(i.shape,a,s,1,c,u,l),d=gl(n.data.get(i.dataId).values,i.shape,i.dtype,o.util.computeStrides(i.shape),h,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}};const rf={kernelName:o.MaxPool3DGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:a}=e,{filterSize:s,strides:c,pad:u,dimRoundingMode:l}=r;Jc([i,a],"maxPool3DGrad");const h=o.backend_util.computePool3DInfo(a.shape,s,c,1,u,l),d=function(t,e){const n=(0,o.buffer)(e.outShape,"int32"),r=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,l=e.effectiveFilterDepth,h=e.effectiveFilterHeight,d=e.effectiveFilterWidth,f=e.padInfo.front,p=e.padInfo.top,g=e.padInfo.left;for(let o=0;o<e.batchSize;++o)for(let m=0;m<e.inChannels;++m)for(let y=0;y<e.outDepth;++y){const v=y*r-f;let b=v;for(;b<0;)b+=s;const x=Math.min(e.inDepth,l+v);for(let r=0;r<e.outHeight;++r){const l=r*i-p;let f=l;for(;f<0;)f+=c;const w=Math.min(e.inHeight,h+l);for(let i=0;i<e.outWidth;++i){const p=i*a-g;let k=p;for(;k<0;)k+=u;const _=Math.min(e.inWidth,d+p);let S=Number.NEGATIVE_INFINITY,A=-1;for(let e=b;e<x;e+=s){const n=e-v;for(let r=f;r<w;r+=c){const i=r-l;for(let a=k;a<_;a+=u){const s=a-p,c=t.get(o,e,r,a,m);c>=S&&(S=c,A=n*h*d+i*h+s)}}}n.set(A,o,y,r,i,m)}}}return n}(n.bufferSync(a),h),f=h.strideDepth,p=h.strideHeight,g=h.strideWidth,m=h.dilationDepth,y=h.dilationHeight,v=h.dilationWidth,b=h.effectiveFilterDepth,x=h.effectiveFilterHeight,w=h.effectiveFilterWidth,k=b-1-h.padInfo.front,_=w-1-h.padInfo.left,S=x-1-h.padInfo.top,A=(0,o.buffer)(a.shape,"float32"),C=n.bufferSync(i);for(let o=0;o<h.batchSize;++o)for(let t=0;t<h.inChannels;++t)for(let e=0;e<h.inDepth;++e)for(let n=0;n<h.inHeight;++n)for(let r=0;r<h.inWidth;++r){const i=e-k,a=n-S,s=r-_;let c=0;for(let e=0;e<b;e+=m){const n=(i+e)/f;if(!(n<0||n>=h.outDepth||Math.floor(n)!==n))for(let r=0;r<x;r+=y){const i=(a+r)/p;if(!(i<0||i>=h.outHeight||Math.floor(i)!==i))for(let a=0;a<w;a+=v){const u=(s+a)/g;if(u<0||u>=h.outWidth||Math.floor(u)!==u)continue;const l=b*x*w-1-d.get(o,n,i,u,t)===e*x*w+r*w+a?1:0;if(0===l)continue;c+=C.get(o,n,i,u,t)*l}}}A.set(c,o,e,n,r,t)}return n.makeTensorInfo(A.shape,A.dtype,A.values)}};const af={kernelName:o.MaxPoolGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:a,output:s}=e,c=a;Jc([a,s],"maxPoolGrad");const{filterSize:u,strides:l,pad:h,dimRoundingMode:d}=r,f=o.backend_util.computePool2DInfo(c.shape,u,l,1,h,d),p=n.data.get(c.dataId).values,g=(0,o.buffer)(f.outShape,c.dtype,pl(p,c.shape,c.dtype,f).values),m=f.strideHeight,y=f.strideWidth,v=f.dilationHeight,b=f.dilationWidth,x=f.effectiveFilterHeight,w=f.effectiveFilterWidth,k=w-1-f.padInfo.left,_=x-1-f.padInfo.top,S=(0,o.buffer)(c.shape,"float32"),A=n.data.get(i.dataId).values,C=(0,o.buffer)(i.shape,"float32",A);for(let o=0;o<f.batchSize;++o)for(let t=0;t<f.inChannels;++t)for(let e=0;e<f.inHeight;++e)for(let n=0;n<f.inWidth;++n){const r=e-_,i=n-k;let a=0;for(let e=0;e<x;e+=v){const n=(r+e)/m;if(!(n<0||n>=f.outHeight||Math.floor(n)!==n))for(let r=0;r<w;r+=b){const s=(i+r)/y;if(s<0||s>=f.outWidth||Math.floor(s)!==s)continue;const c=x*w-1-g.get(o,n,s,t)===e*w+r?1:0;if(0===c)continue;a+=C.get(o,n,s,t)*c}}S.set(a,o,e,n,t)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}};const of={kernelName:o.MaxPoolWithArgmax,backendName:"cpu",kernelFunc:t=>{let{inputs:e,attrs:n,backend:r}=t;const{x:i}=e,{filterSize:a,strides:s,pad:c,includeBatchInIndex:u}=n,l=r;Jc(i,"MaxPoolWithArgmax");const h=l.data.get(i.dataId).values,d=o.backend_util.computePool2DInfo(i.shape,a,s,[1,1],c),[f,p]=function(t,e,n,r,i){const a=fl(t,0,n,o.util.computeStrides(e),i,"max"),s=pl(t,e,n,i,!0,r);return[a.values,s.values]}(h,i.shape,i.dtype,u,d),g=l.write(f,d.outShape,i.dtype),m=l.write(p,d.outShape,i.dtype);return[{dataId:g,shape:d.outShape,dtype:i.dtype},{dataId:m,shape:d.outShape,dtype:"int32"}]}};const sf={kernelName:o.Mean,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,keepDims:s}=r,c=o.util.parseAxisParam(a,i.shape),u=o.backend_util.computeOutAndReduceShapes(i.shape,c)[1],l=o.util.sizeFromShape(u),h=[],d=n.makeTensorInfo([],"float32",new Float32Array([l]));h.push(d);const f=Nu({inputs:{x:i},backend:n,attrs:{dtype:"float32"}});h.push(f);const p=Wh({inputs:{a:f,b:d},backend:n});h.push(p);const g=vh({inputs:{x:p},backend:n,attrs:{axis:a,keepDims:s}});return h.forEach((t=>n.disposeIntermediateTensorInfo(t))),g}};const cf={kernelName:o.Min,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,keepDims:s}=r;Jc(i,"min");const c=o.util.parseAxisParam(a,i.shape);let u=c;const l=o.backend_util.getAxesPermutation(u,i.shape.length);let h=i;null!=l&&(h=$u({inputs:{x:i},backend:n,attrs:{perm:l}}),u=o.backend_util.getInnerMostAxes(u.length,i.shape.length)),o.backend_util.assertAxesAreInnerMostDims("min",u,h.shape.length);const[d,f]=o.backend_util.computeOutAndReduceShapes(h.shape,u),p=o.util.sizeFromShape(f),g=o.util.makeZerosTypedArray(o.util.sizeFromShape(d),h.dtype),m=n.data.get(h.dataId).values;for(let o=0;o<g.length;++o){const t=o*p;let e=m[t];for(let n=0;n<p;++n){const r=m[t+n];(Number.isNaN(r)||r<e)&&(e=r)}g[o]=e}null!=l&&n.disposeIntermediateTensorInfo(h);const y=n.makeTensorInfo(d,h.dtype,g);if(s){const t=Bu({inputs:{x:y},backend:n,attrs:{shape:o.backend_util.expandShapeToKeepDim(d,c)}});return n.disposeIntermediateTensorInfo(y),t}return y}},uf=hu(((t,e)=>Math.min(t,e))),lf=Fu(o.Minimum,uf),hf={kernelName:o.Minimum,backendName:"cpu",kernelFunc:lf};const df={kernelName:o.MirrorPad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{paddings:a,mode:s}=r;Jc(i,"mirrorPad");const c=a.map(((t,e)=>t[0]+i.shape[e]+t[1])),u=a.map((t=>t[0])),l=a.map(((t,e)=>t[0]+i.shape[e])),h="reflect"===s?0:1,d=n.data.get(i.dataId).values,f=i.shape.length,p=o.util.computeStrides(i.shape),g=o.util.sizeFromShape(c),m=c.length,y=o.util.computeStrides(c),v=o.util.getTypedArrayFromDType(i.dtype,g);for(let b=0;b<g;b++){let t=o.util.indexToLoc(b,m,y);for(let n=0;n<m;n++)t[n]<u[n]?t[n]=2*u[n]-t[n]-h:t[n]>=l[n]&&(t[n]=2*(l[n]-1)-t[n]+h);t=t.map(((t,e)=>t-u[e]));const e=o.util.locToIndex(t,f,p);v[b]=d[e]}return{dataId:n.write(v,c,i.dtype),shape:c,dtype:i.dtype}}},ff=hu(((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e})),pf=Fu(o.Mod,ff),gf={kernelName:o.Mod,backendName:"cpu",kernelFunc:pf};function mf(t){const{inputs:e,backend:n,attrs:r}=t,{logits:i}=e,{dim:a}=r,s=i.shape.length;let c=a;if(-1===c&&(c=s-1),c!==s-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(s," and dim was ").concat(c));const u=o.util.parseAxisParam([c],i.shape),l=$d({inputs:{x:i},backend:n,attrs:{reductionIndices:u,keepDims:!1}}),h=o.backend_util.expandShapeToKeepDim(l.shape,u),d=Bu({inputs:{x:l},backend:n,attrs:{shape:h}}),f=Hh({inputs:{a:i,b:d},backend:n}),p=Oh({inputs:{x:f},backend:n}),g=vh({inputs:{x:p},backend:n,attrs:{axis:u,keepDims:!1}}),m=Bu({inputs:{x:g},backend:n,attrs:{shape:h}}),y=Wh({inputs:{a:p,b:m},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),y}const yf={kernelName:o.Softmax,backendName:"cpu",kernelFunc:mf};const vf={kernelName:o.Multinomial,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{logits:i}=e,{numSamples:a,seed:s,normalized:c}=r;Jc(i,"multinomial");const u=c?i:mf({inputs:{logits:i},backend:n,attrs:{dim:-1}}),l=u.shape[0],h=u.shape[1],d=n.data.get(u.dataId).values,f=[l,a],p=o.util.makeZerosTypedArray(o.util.sizeFromShape(f),"int32");for(let o=0;o<l;++o){const t=o*h,e=new Float32Array(h-1);e[0]=d[t];for(let i=1;i<e.length;++i)e[i]=e[i-1]+d[t+i];const n=kc.alea(s.toString()),r=o*a;for(let i=0;i<a;++i){const t=n();p[r+i]=e.length;for(let n=0;n<e.length;n++)if(t<e[n]){p[r+i]=n;break}}}return c||n.disposeIntermediateTensorInfo(u),n.makeTensorInfo(f,"int32",p)}};function bf(t,e,n){const r=o.util.createScalarValue(-1,n);return ph([],e,r,t,n)}const xf={kernelName:o.Neg,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e;Jc(r,"neg");const i=n.data.get(r.dataId).values,[a,o]=bf(i,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,a)}},wf=o.kernel_impls.nonMaxSuppressionV3Impl;const kf={kernelName:o.NonMaxSuppressionV3,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:a}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:c}=r;Jc(i,"NonMaxSuppression");const u=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,{selectedIndices:h}=wf(u,l,o,s,c);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}},_f=o.kernel_impls.nonMaxSuppressionV4Impl;const Sf={kernelName:o.NonMaxSuppressionV4,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:a}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:c,padToMaxOutputSize:u}=r;Jc(i,"NonMaxSuppressionPadded");const l=n.data.get(i.dataId).values,h=n.data.get(a.dataId).values,{selectedIndices:d,validOutputs:f}=_f(l,h,o,s,c,u);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}},Af=o.kernel_impls.nonMaxSuppressionV5Impl;const Cf={kernelName:o.NonMaxSuppressionV5,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:a}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:c,softNmsSigma:u}=r;Jc(i,"NonMaxSuppressionWithScore");const l=n.data.get(i.dataId).values,h=n.data.get(a.dataId).values,d=o,f=s,p=c,g=u,{selectedIndices:m,selectedScores:y}=Af(l,h,d,f,p,g);return[n.makeTensorInfo([m.length],"int32",new Int32Array(m)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}},Ef=hu(((t,e)=>t!==e?1:0)),Tf=Fu(o.NotEqual,Ef,null,"bool"),Nf={kernelName:o.NotEqual,backendName:"cpu",kernelFunc:Tf};const Df={kernelName:o.OneHot,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{indices:i}=e,{dtype:a,depth:s,onValue:c,offValue:u}=r;Jc(i,"oneHot");const l=o.util.sizeFromShape(i.shape),h=new Float32Array(l*s);h.fill(u);const d=n.data.get(i.dataId).values;for(let o=0;o<l;++o)d[o]>=0&&d[o]<s&&(h[o*s+d[o]]=c);return n.makeTensorInfo([...i.shape,s],a,h)}};function Ff(t){const{inputs:e,backend:n}=t,{x:r}=e;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){const t=Cu({inputs:{input:r},backend:n}),e=Ff({inputs:{x:t},backend:n}),i=Pl({inputs:{input:r},backend:n}),a=Ff({inputs:{x:i},backend:n}),o=_u({inputs:{real:e,imag:a},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),o}return Qh({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const If={kernelName:o.ZerosLike,backendName:"cpu",kernelFunc:Ff};const Mf={kernelName:o.OnesLike,backendName:"cpu",kernelFunc:function t(e){const{inputs:n,backend:r}=e,{x:i}=n;if("string"===i.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===i.dtype){const e=Cu({inputs:{input:i},backend:r}),n=t({inputs:{x:e},backend:r}),a=Pl({inputs:{input:i},backend:r}),o=Ff({inputs:{x:a},backend:r}),s=_u({inputs:{real:n,imag:o},backend:r});return r.disposeIntermediateTensorInfo(e),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(o),s}return Qh({backend:r,attrs:{shape:i.shape,value:1,dtype:i.dtype}})}};function Of(t){const{inputs:e,backend:n,attrs:r}=t,{axis:i}=r;if(1===e.length)return zh({inputs:{input:e[0]},backend:n,attrs:{dim:i}});const a=e[0].shape,s=e[0].dtype;e.forEach((t=>{o.util.assertShapesMatch(a,t.shape,"All tensors passed to stack must have matching shapes"),o.util.assert(s===t.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const c=[],u=Ul({inputs:e.map((t=>{const e=zh({inputs:{input:t},backend:n,attrs:{dim:i}});return c.push(e),e})),backend:n,attrs:{axis:i}});return c.forEach((t=>n.disposeIntermediateTensorInfo(t))),u}const Rf={kernelName:o.Pack,backendName:"cpu",kernelFunc:Of};const zf={kernelName:o.PadV2,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{paddings:a,constantValue:s}=r;Jc(i,"pad");const c=a.map(((t,e)=>t[0]+i.shape[e]+t[1])),u=a.map((t=>t[0])),l=n.data.get(i.dataId).values,h=o.util.sizeFromShape(i.shape),d=i.shape.length,f=o.util.computeStrides(i.shape),p=o.util.sizeFromShape(c),g=c.length,m=o.util.computeStrides(c),y=o.util.getTypedArrayFromDType(i.dtype,p);0!==s&&y.fill(s);for(let v=0;v<h;v++){const t=o.util.indexToLoc(v,d,f).map(((t,e)=>t+u[e]));y[o.util.locToIndex(t,g,m)]=l[v]}return{dataId:n.write(y,c,i.dtype),shape:c,dtype:i.dtype}}},Bf=hu(((t,e)=>Math.pow(t,e))),Lf=Fu(o.Pow,Bf),Pf={kernelName:o.Pow,backendName:"cpu",kernelFunc:Lf};function jf(t,e,n,r){const[i,a]=o.backend_util.computeOutAndReduceShapes(t,r),s=(0,o.upcastType)(e,"int32"),c=o.util.makeZerosTypedArray(o.util.sizeFromShape(i),s),u=o.util.sizeFromShape(a);for(let o=0;o<c.length;++o){const t=o*u;let e=1;for(let r=0;r<u;++r)e*=n[t+r];c[o]=e}return{outVals:c,outShape:i,outDtype:s}}const Uf={kernelName:o.Prod,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,keepDims:s}=r;Jc(i,"prod");const c=i.shape.length,u=o.util.parseAxisParam(a,i.shape),l=o.backend_util.getAxesPermutation(u,c);let h=u,d=i;const f=[];null!=l&&(d=$u({inputs:{x:i},backend:n,attrs:{perm:l}}),f.push(d),h=o.backend_util.getInnerMostAxes(h.length,c));const p=n.data.get(d.dataId).values,{outVals:g,outShape:m,outDtype:y}=jf(d.shape,d.dtype,p,h);let v=m;return s&&(v=o.backend_util.expandShapeToKeepDim(m,u)),f.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.makeTensorInfo(v,y,g)}};function Wf(t,e,n,r){const i=[];let a=0;const o=e.length-1+n.length,s=new Array(o).fill(null).map((()=>[0]));!function(t,e){for(let n=0;n<t.length;++n){const r=t[n],i=n===t.length-1?e:t[n+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>i)throw new Error("Ragged splits must not point past values");for(let t=1;t<r.length;++t)if(r[t-1]>r[t])throw new Error("Ragged splits must be sorted in ascending order")}}(n,r);let c=1;for(let u=0;u<e.length-1;++u){c*=e[u];const t=e[u+1];for(let e=1;e<c+1;++e)s[u].push(e*t)}for(let u=0;u<t.length;++u){let r=t[u],o=t[u]+1;for(let t=0;t<n.length;++t){const i=n[t],a=t+e.length-1;if(a>=0){const t=s[a],e=t[t.length-1]-i[r];for(let n=r;n<o;++n)s[a].push(i[n+1]+e)}r=i[r],o=i[o]}o!==r&&(i.push([r,o]),a+=o-r)}return{outSplits:s,valueSlices:i,numValues:a}}function Vf(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function qf(t,e,n,r,i){const a=e.slice();a[0]=i;const s=o.util.getArrayFromDType(n,o.util.sizeFromShape(a)),c=t.length;return function(t,e,n,r,i,a){const o=Vf(e,2)[1],s=Vf(a,2)[1];let c=0;for(const u of n)for(let e=u[0];e<u[1];++e){for(let n=0;n<r;++n)i[c*s+n]=t[e*o+n];++c}}(t,e,r,0===c?0:c/e[0],s,a),[s,a]}function Gf(t,e,n,r,i,a,s,c){if(0===t.length)throw new Error("paramsNestedSplits must be non empty");if(0===e[0].length)throw new Error("Split tensors must not be scalars");if(function(t,e,n){t.forEach(((t,r)=>{if(t<0||t>=n){const i=o.util.indexToLoc(r,e.length,o.util.computeStrides(e)).join(",");throw new Error("indices[".concat(i,"] = ").concat(t," is not in [0, ").concat(n,")"))}}))}(a,s,e[0][0]-1),0===r.length)throw new Error("params.rank must be nonzero");const u=r[0],{outSplits:l,valueSlices:h,numValues:d}=Wf(a,s,t,u),f=function(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n].length,i=o.util.getArrayFromDType("int32",r);e.push(i),t[n].forEach(((t,e)=>i[e]=t))}return e}(l),p=qf(n,r,i,h,d);return[f,p[0],p[1]]}const Hf={kernelName:o.RaggedGather,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:i,paramsDenseValues:a,indices:o}=e,{outputRaggedRank:s}=r,c=i.map((t=>n.data.get(t.dataId).values)),u=i.map((t=>t.shape)),l=n.data.get(a.dataId).values,h=n.data.get(o.dataId).values,[d,f,p]=Gf(c,u,l,a.shape,a.dtype,h,o.shape),g=d.map((t=>n.makeTensorInfo([t.length],"int32",t))),m=n.makeTensorInfo(p,a.dtype,f);return g.concat([m])}},Yf=2147483647;function Xf(t,e,n,r,i,a,s){if(e.length>1)throw new Error("starts must be a scalar or vector");if(i.length>1)throw new Error("limits must be a scalar or vector");if(s.length>1)throw new Error("deltas must be a scalar or vector");const c=0===e.length,u=0===i.length,l=0===s.length,h=[];c||h.push(e[0]),u||h.push(i[0]),l||h.push(s[0]);for(let o=1;o<h.length;++o)if(h[o]!==h[o-1])throw new Error("starts, limits, and deltas must have the same shape");const d=0===h.length?1:h[0],f=o.util.getArrayFromDType("int32",d+1);f[0]=0;for(let o=0;o<d;++o){const e=c?t[0]:t[o],n=u?r[0]:r[o],i=l?a[0]:a[o];if(0===i)throw new Error("Requires delta != 0");let s;if(i>0&&n<e||i<0&&n>e)s=0;else if(s=Math.ceil(Math.abs((n-e)/i)),s>Yf)throw new Error("Requires ((limit - start) / delta) <= ".concat(Yf));f[o+1]=f[o]+s}const p=f[d],g=o.util.getArrayFromDType(n,p);let m=0;for(let o=0;o<d;++o){const e=f[o+1]-f[o];let n=c?t[0]:t[o];const r=l?a[0]:a[o];for(let t=0;t<e;++t)g[m++]=n,n+=r}return[f,g]}const Kf={kernelName:o.RaggedRange,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{starts:r,limits:i,deltas:a}=e,o=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,c=n.data.get(a.dataId).values,[u,l]=Xf(o,r.shape,r.dtype,s,i.shape,c,a.shape);return[n.makeTensorInfo([u.length],"int32",u),n.makeTensorInfo([l.length],r.dtype,l)]}};var $f=o.backend_util.RowPartitionType;class Zf{constructor(t,e,n,r,i,a,s,c,u,l){this.shape=t,this.shapeShape=e,this.values=n,this.valuesShape=r,this.valuesDType=i,this.defaultValue=a,this.defaultValueShape=s,this.rowPartitionValues=c,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=o.backend_util.getRowPartitionTypesHelper(l),this.raggedRank=o.backend_util.getRaggedRank(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===$f.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===$f.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){const e=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case $f.VALUE_ROWIDS:return Zf.getMaxWidthValueRowID(e);case $f.ROW_SPLITS:return Zf.getMaxWidthRowSplit(e);default:throw new Error("Cannot handle partition type ".concat($f[this.getRowPartitionTypeByDimension(t-1)]))}}static getMaxWidthRowSplit(t){const e=t.length;if(0===e||1===e)return 0;let n=0;for(let r=0;r<e-1;++r){const e=t[r+1]-t[r];e>n&&(n=e)}return n}static getMaxWidthValueRowID(t){const e=t.length;if(0===e)return 0;let n=0,r=t[0],i=0;for(let a=1;a<e;++a){const e=t[a];e!==r&&(r=e,i=Math.max(a-n,i),n=a)}return Math.max(e-n,i)}tensorShapeFromTensor(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===e.length){if(-1===t[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return Jf(t,n)}calculateOutputSize(t){const e=this.valuesShape,n=this.defaultValueShape;o.backend_util.validateDefaultValueShape(n,e);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=o.backend_util.combineRaggedTensorToTensorShapes(this.raggedRank,r,e);i[0]<0&&(i[0]=t);for(let a=1;a<=this.raggedRank;++a)i[a]<0&&(i[a]=this.getMaxWidth(a));return i}calculateFirstParentOutputIndex(t,e,n){const r=Math.min(t,n),i=[];let a=0;for(let o=0;o<r;++o,a+=e)i.push(a);for(let o=r;o<t;++o)i.push(-1);return o.util.assert(i.length===t,(()=>"Final length of result must be equal to firstDimension.")),i}calculateOutputIndexRowSplit(t,e,n,r){const i=t.length,a=[];for(let o=0;o<i-1;++o){const i=t[o+1]-t[o];let s=Math.min(r,i),c=e[o];-1===c&&(s=0);for(let t=0;t<s;++t)a.push(c),c+=n;for(let t=0;t<i-s;++t)a.push(-1)}if(i>0&&a.length!==t[i-1])throw new Error("Invalid row split size.");return a}calculateOutputIndexValueRowID(t,e,n,r){const i=t.length,a=[];if(0===i)return[];let o=0,s=t[0];if(s>=e.length)throw new Error("Got currentValueRowId=".concat(s,", which is not less than ").concat(e.length));let c=e[s];a.push(c);for(let u=1;u<i;++u){const i=t[u];if(i===s)c>=0&&(++o,o<r?c+=n:c=-1);else{if(o=0,s=i,i>=e.length)throw new Error("Got nextValueRowId=".concat(i," which is not less than ").concat(e.length));c=e[i]}a.push(c)}if(a.length!==t.length)throw new Error("Invalid row ids.");return a}calculateOutputIndex(t,e,n,r){const i=this.getRowPartitionTensor(t),a=this.getRowPartitionTypeByDimension(t);switch(a){case $f.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,e,n,r);case $f.ROW_SPLITS:if(i.length-1>e.length)throw new Error("Row partition size is greater than output size: ".concat(i.length-1," > ").concat(e.length));return this.calculateOutputIndexRowSplit(i,e,n,r);default:throw new Error("Unsupported partition type: ".concat($f[a]))}}getFirstDimensionSize(){const t=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");const e=this.rowPartitionTypes[0];switch(e){case $f.FIRST_DIM_SIZE:return t[0];case $f.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case $f.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type ".concat($f[e]))}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),e=this.calculateOutputSize(t),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(let a=n.length-2;a>=0;--a)n[a]=n[a+1]*e[a+1];const r=Jf(e,!1),i=o.util.getArrayFromDType(this.valuesDType,o.util.sizeFromShape(r));if(n[0]*e[0]>0){let a=this.calculateFirstParentOutputIndex(t,n[0],e[0]);for(let t=1;t<=this.raggedRank;++t){a=this.calculateOutputIndex(t-1,a,n[t],e[t])}this.setOutput(this.raggedRank,a,i,r)}return[r,i]}setOutput(t,e,n,r){if(0===n.length)return;const i=this.values,a=n;let s=r.slice();s=s.slice(t+1);const c=o.util.sizeFromShape(s),u=e.length;let l=this.defaultValue;if(l.length!==c&&1!==l.length){const t=this.defaultValueShape;(0,o.tidy)((()=>{const e=(0,o.reshape)(l,t),n=(0,o.broadcastTo)(e,s);l=n.dataSync()}))}let h=0,d=0,f=0;for(let o=0;o<=u;++o){let t=o<u?e[o]:-1;if(t!==f){if(d<f){const t=i.subarray(h*c);Qf(a.subarray(d*c),t,(f-d)*c)}if(o>=u){const e=n.length;t=Math.floor(e/c)}if(t>f)if(1===this.defaultValue.length)a.subarray(f*c,t*c).fill(this.defaultValue[0]),f=t;else for(;t>f;){Qf(a.slice(f*c),l,c),++f}t<0?(h=o+1,d=f):(h=o,d=f,f=d+1)}else++f}}}function Qf(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function Jf(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error("Dimension ".concat(r," must be >= 0"));if(r<-1)throw new Error("Dimension ".concat(r," must be >= -1"));r=-1}n.push(r)}return n}function tp(t,e,n,r,i,a,o,s,c,u){return new Zf(t,e,n,r,i,a,o,s,c,u).compute()}const ep={kernelName:o.RaggedTensorToTensor,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{shape:i,values:a,defaultValue:o,rowPartitionTensors:s}=e,{rowPartitionTypes:c}=r,u=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,h=n.data.get(o.dataId).values,d=s.map((t=>n.data.get(t.dataId).values)),f=s.map((t=>t.shape)),[p,g]=tp(u,i.shape,l,a.shape,a.dtype,h,o.shape,d,f,c);return n.makeTensorInfo(p,a.dtype,g)}};function np(t,e,n,r){if(t===e||t<e&&n<0||e<t&&n>1)return o.util.makeZerosTypedArray(0,r);const i=Math.abs(Math.ceil((e-t)/n)),a=o.util.makeZerosTypedArray(i,r);e<t&&1===n&&(n=-1),a[0]=t;for(let o=1;o<a.length;o++)a[o]=a[o-1]+n;return a}const rp={kernelName:o.Range,backendName:"cpu",kernelFunc:function(t){const{backend:e,attrs:n}=t,{start:r,stop:i,dtype:a,step:o}=n,s=np(r,i,o,a);return e.makeTensorInfo([s.length],a,s)}},ip=ru(o.Reciprocal,(t=>1/t)),ap={kernelName:o.Reciprocal,backendName:"cpu",kernelFunc:ip};const op={kernelName:o.ResizeBilinear,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:i}=e,{alignCorners:a,halfPixelCenters:s,size:c}=r;Jc(i,"resizeBilinear");const u=o.util.computeStrides(i.shape),[l,h]=c,[d,f,p,g]=i.shape,m=n.data.get(i.dataId).values,y=new Float32Array(o.util.sizeFromShape([d,l,h,g])),v=[a&&l>1?f-1:f,a&&h>1?p-1:p],b=[a&&l>1?l-1:l,a&&h>1?h-1:h];let x=0;const w=v[0]/b[0],k=v[1]/b[1];for(let o=0;o<d;o++)for(let t=0;t<l;t++){let e;e=s?w*(t+.5)-.5:w*t;const n=Math.max(0,Math.floor(e)),r=e-n,i=Math.min(f-1,Math.ceil(e)),a=o*u[0]+n*u[1],c=o*u[0]+i*u[1];for(let t=0;t<h;t++){let e;e=s?k*(t+.5)-.5:k*t;const n=Math.max(0,Math.floor(e)),i=e-n,o=Math.min(p-1,Math.ceil(e)),l=a+n*u[2],h=c+n*u[2],d=a+o*u[2],f=c+o*u[2];for(let t=0;t<g;t++){const e=m[l+t],n=m[h+t],a=e+(m[d+t]-e)*i,o=a+(n+(m[f+t]-n)*i-a)*r;y[x++]=o}}}return n.makeTensorInfo([d,l,h,g],"float32",y)}};const sp={kernelName:o.ResizeBilinearGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:i,dy:a}=e,{alignCorners:s}=r;Jc([a,i],"resizeBilinearGrad");const c=o.util.computeStrides(i.shape),[u,l,h,d]=i.shape,[,f,p]=a.shape,g=new Float32Array(u*l*h*d),m=[s&&f>1?l-1:l,s&&p>1?h-1:h],y=[s&&f>1?f-1:f,s&&p>1?p-1:p],v=m[0]/y[0],b=m[1]/y[1],x=n.data.get(a.dataId).values;let w=0;for(let o=0;o<u;o++){const t=o*c[0];for(let e=0;e<f;e++){const n=e*v,r=Math.floor(n),i=Math.min(Math.ceil(n),l-1),a=t+r*c[1],o=t+i*c[1],s=n-r,u=1-s;for(let t=0;t<p;t++){const e=t*b,n=Math.floor(e),r=Math.min(Math.ceil(e),h-1),i=e-n,l=1-i,f=a+n*c[2],p=a+r*c[2],m=o+n*c[2],y=o+r*c[2],v=u*l,k=u*i,_=s*l,S=s*i;for(let t=0;t<d;t++){const e=x[w++];g[f+t]+=e*v,g[p+t]+=e*k,g[m+t]+=e*_,g[y+t]+=e*S}}}}return n.makeTensorInfo([u,h,l,d],"float32",g)}};const cp={kernelName:o.ResizeNearestNeighbor,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:i}=e,{alignCorners:a,halfPixelCenters:s,size:c}=r;Jc(i,"resizeNearestNeighbor");const u=o.util.computeStrides(i.shape),[l,h]=c,[d,f,p,g]=i.shape,m=n.data.get(i.dataId).values,y=new Float32Array(d*l*h*g),v=[a&&l>1?f-1:f,a&&h>1?p-1:p],b=[a&&l>1?l-1:l,a&&h>1?h-1:h],x=v[0]/b[0],w=v[1]/b[1];let k=0;for(let o=0;o<d;o++){const t=o*u[0];for(let e=0;e<l;e++){const n=s?x*(e+.5):x*e;let r=Math.min(f-1,a?Math.round(n):Math.floor(n));s&&(r=Math.max(0,r));const i=t+r*u[1];for(let t=0;t<h;t++){const e=s?w*(t+.5):w*t;let n=Math.min(p-1,a?Math.round(e):Math.floor(e));s&&(n=Math.max(0,n));const r=i+n*u[2];for(let t=0;t<g;t++){const e=m[r+t];y[k++]=e}}}}return n.makeTensorInfo([d,l,h,g],i.dtype,y)}};const up={kernelName:o.ResizeNearestNeighborGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:i,dy:a}=e,{alignCorners:s}=r;Jc([a,i],"resizeNearestNeighborGrad");const c=o.util.computeStrides(i.shape),u=o.util.computeStrides(a.shape),[l,h,d,f]=i.shape,[,p,g]=a.shape,m=new Float32Array(l*h*d*f),y=n.data.get(a.dataId).values,v=[s&&p>1?h-1:h,s&&g>1?d-1:d],b=[s&&p>1?p-1:p,s&&g>1?g-1:g],x=v[0]/b[0],w=v[1]/b[1],k=1/x,_=1/w,S=2*Math.ceil(k)+2,A=2*Math.ceil(_)+2;for(let o=0;o<l;o++){const t=o*c[0];for(let e=0;e<h;e++){const n=t+e*c[1],r=Math.floor(e*k),i=Math.floor(r-S/2);for(let a=0;a<d;a++){const r=n+a*c[2],o=Math.floor(a*_),l=Math.floor(o-A/2);for(let n=0;n<f;n++){let o=0;for(let r=0;r<S;r++){const c=r+i;if(c<0||c>=p)continue;const f=t+c*u[1],m=c*x;if(e===Math.min(h-1,s?Math.round(m):Math.floor(m)))for(let t=0;t<A;t++){const e=t+l;if(e<0||e>=g)continue;const r=f+e*u[2],i=e*w;a===Math.min(d-1,s?Math.round(i):Math.floor(i))&&(o+=y[r+n])}}m[r+n]=o}}}}return n.makeTensorInfo(i.shape,i.dtype,m)}};const lp={kernelName:o.Reverse,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{dims:a}=r;Jc(i,"reverse");const s=i.shape.length,c=o.util.parseAxisParam(a,i.shape);if(0===s)return su({inputs:{x:i},backend:n});const u=new o.TensorBuffer(i.shape,i.dtype),l=n.bufferSync(i);for(let o=0;o<u.size;o++){const t=u.indexToLoc(o),e=t.slice();c.forEach((t=>e[t]=i.shape[t]-1-e[t])),u.set(l.get(...e),...t)}return n.makeTensorInfo(u.shape,u.dtype,u.values)}},hp={kernelName:o.RotateWithOffset,backendName:"cpu",kernelFunc:t=>{let{inputs:e,attrs:n,backend:r}=t;const{image:i}=e,{radians:a,fillValue:s,center:c}=n,u=r,l=o.util.getTypedArrayFromDType(i.dtype,o.util.sizeFromShape(i.shape)),[h,d,f,p]=i.shape,[g,m]=o.backend_util.getImageCenter(c,d,f),y=Math.sin(a),v=Math.cos(a),b=u.data.get(i.dataId).values;for(let o=0;o<h;o++){const t=o*f*d*p;for(let e=0;e<d;e++){const n=e*(f*p);for(let r=0;r<f;r++){const i=r*p;for(let a=0;a<p;a++){const o=[h,e,r,a],c=o[2],u=o[1];let x=(c-g)*v-(u-m)*y,w=(c-g)*y+(u-m)*v;x=Math.round(x+g),w=Math.round(w+m);let k=s;if("number"!==typeof s&&(k=3===a?255:s[a]),x>=0&&x<f&&w>=0&&w<d){k=b[t+w*(f*p)+x*p+a]}l[t+n+i+a]=k}}}}return{dataId:u.write(l,i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},dp=ru(o.Round,(t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1})),fp={kernelName:o.Round,backendName:"cpu",kernelFunc:dp},pp=nu((t=>1/Math.sqrt(t))),gp=iu(o.Rsqrt,pp),mp={kernelName:o.Rsqrt,backendName:"cpu",kernelFunc:gp};function yp(t,e,n,r,i,a,s,c,u,l){const h=[r/i,i],d=t.values,f=e.values;if(0===r)return(0,o.buffer)(n,e.dtype);const p=u instanceof o.TensorBuffer?u:(0,o.buffer)(h,e.dtype);"string"===typeof u||"number"===typeof u?p.values.fill(u):"boolean"===typeof u&&p.values.fill(+u);for(let o=0;o<a;o++){const t=[];let a=0;for(let e=0;e<s;e++){const n=d[o*s+e];t.push(n),a+=n*c[e]}if(a<0||a>=r/i)throw new Error("Invalid indices: ".concat(t," does not index into ").concat(n));for(let n=0;n<i;n++)l?p.values[a*i+n]+=f[o*i+n]:p.values[a*i+n]=0===e.rank?f[0]:f[o*i+n]}return p}const vp={kernelName:o.ScatterNd,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{indices:i,updates:a}=e,{shape:s}=r,{sliceRank:c,numUpdates:u,sliceSize:l,strides:h,outputSize:d}=o.backend_util.calculateShapes(a,i,s),f=yp(n.bufferSync(i),n.bufferSync(a),s,d,l,u,c,h,0,!0);return n.makeTensorInfo(s,f.dtype,f.values)}};function bp(t,e){let n=0,r=t.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),t[i]<e?n=i+1:r=i;return r}function xp(t,e){let n=0,r=t.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),t[i]<=e?n=i+1:r=i;return r}const wp={kernelName:o.SearchSorted,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:i,values:a}=e,{side:s}=r,c=function(t,e,n,r,i,a){const s=o.util.getArrayFromDType("int32",n*i);for(let o=0;o<n;++o){const n=t.slice(o*r,(o+1)*r),c=o*i;for(let t=0;t<i;++t)s[c+t]="left"===a?bp(n,e[t+c]):xp(n,e[t+c])}return s}(n.data.get(i.dataId).values,n.data.get(a.dataId).values,i.shape[0],i.shape[1],a.shape[1],s);return n.makeTensorInfo(a.shape,"int32",c)}};const kp={kernelName:o.Select,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{condition:r,t:i,e:a}=e;Jc([r,i,a],"select");const s=r.shape.length,c=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,h=(0,o.upcastType)(i.dtype,a.dtype),d=o.util.makeZerosTypedArray(o.util.sizeFromShape(i.shape),h);let f=0;const p=0===s||s>1||1===i.shape.length?1:o.util.sizeFromShape(i.shape.slice(1));for(let o=0;o<c.length;o++)for(let t=0;t<p;t++)1===c[o]?d[f++]=u[o]:d[f++]=l[o];return n.makeTensorInfo(i.shape,h,d)}},_p=o.backend_util.SELU_SCALEALPHA,Sp=o.backend_util.SELU_SCALE,Ap=ru(o.Selu,(t=>t>=0?Sp*t:_p*(Math.exp(t)-1))),Cp={kernelName:o.Selu,backendName:"cpu",kernelFunc:Ap},Ep=ru(o.Sign,(t=>t<0?-1:t>0?1:0)),Tp={kernelName:o.Sign,backendName:"cpu",kernelFunc:Ep},Np=ru(o.Sin,(t=>Math.sin(t))),Dp={kernelName:o.Sin,backendName:"cpu",kernelFunc:Np},Fp=ru(o.Sinh,(t=>Math.sinh(t))),Ip={kernelName:o.Sinh,backendName:"cpu",kernelFunc:Fp},Mp=Math.log(1.1920928955078125e-7)+2,Op=ru(o.Softplus,(t=>{const e=t>-Mp,n=t<Mp,r=Math.exp(t);let i;return i=n?r:e?t:Math.log(1+r),i})),Rp={kernelName:o.Softplus,backendName:"cpu",kernelFunc:Op};const zp={kernelName:o.SpaceToBatchND,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockShape:a,paddings:s}=r;Jc([i],"spaceToBatchND");const c=o.util.sizeFromShape(a),u=[[0,0]];u.push(...s);for(let o=1+a.length;o<i.shape.length;++o)u.push([0,0]);const l=zf.kernelFunc({inputs:{x:i},backend:n,attrs:{paddings:u,constantValue:0}}),h=o.backend_util.getReshaped(l.shape,a,c,!1),d=o.backend_util.getPermuted(h.length,a.length,!1),f=o.backend_util.getReshapedPermuted(l.shape,a,c,!1),p=Bu({inputs:{x:l},backend:n,attrs:{shape:h}}),g=$u({inputs:{x:p},backend:n,attrs:{perm:d}}),m=Bu({inputs:{x:g},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),m}};function Bp(t,e,n,r,i,a,s){const c=e[0],u=a[0],l=new Array(u),h=new Array(c),d=e[1];if(0===u){if(0!==c)throw new Error(o.backend_util.getSparseFillEmptyRowsIndicesDenseShapeMismatch(c));return[o.util.getArrayFromDType(n,0),[0,d],o.util.getArrayFromDType(i,0),l,h]}let f=!0,p=0;const g=new Array(u).fill(0);for(let y=0;y<c;++y){const e=t[y*d];if(e<0)throw new Error(o.backend_util.getSparseFillEmptyRowsNegativeIndexErrorMessage(y,e));if(e>=u)throw new Error(o.backend_util.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(y,e,u));++g[e],f=f&&e>=p,p=e}let m=!0;for(let o=0;o<u;++o){const t=0===g[o];l[o]=t,m=m&&!t,g[o]=Math.max(g[o],1),o>0&&(g[o]+=g[o-1])}if(m&&f){const e=t,n=r;for(let t=0;t<c;++t)h[t]=t;return[e,[c,d],n,l,h]}{const e=g[u-1],a=o.util.getArrayFromDType(n,e*d),f=o.util.getArrayFromDType(i,e),p=new Array(u).fill(0);for(let n=0;n<c;++n){const e=t[n*d],i=p[e],o=(0===e?0:g[e-1])+i;p[e]++;for(let r=0;r<d;++r)a[o*d+r]=t[n*d+r];f[o]=r[n],h[n]=o}for(let t=0;t<u;++t){if(0===p[t]){const e=0===t?0:g[t-1];a[e*d+0]=t;for(let t=1;t<d;++t)a[e*d+t]=0;f[e]=s}}return[a,[e,d],f,l,h]}}const Lp={kernelName:o.SparseFillEmptyRows,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{indices:r,values:i,denseShape:a,defaultValue:o}=e;if(1!==a.shape.length)throw new Error("Dense shape must be a vector, saw:\n        ".concat(a.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n        ".concat(r.shape));if(1!==i.shape.length)throw new Error("Values must be a vector, saw:\n        ".concat(i.shape));if(0!==o.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(o.shape));const s=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=n.data.get(a.dataId).values,l=n.data.get(o.dataId).values[0],[h,d,f,p,g]=Bp(s,r.shape,r.dtype,c,i.dtype,u,l);return[n.makeTensorInfo(d,r.dtype,h),n.makeTensorInfo([d[0]],i.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map((t=>Number(t))))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}};function Pp(t,e,n,r,i){const a=o.util.sizeFromShape(r),s=e[0],c=i.length,u=[];let l=1,h=-1;for(let m=0;m<c;++m){const t=i[m];if(-1===t){if(-1!==h)throw new Error(o.backend_util.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(h,m));h=m,u.push(1)}else{if(t<0)throw new Error(o.backend_util.getSparseReshapeNegativeOutputDimErrorMessage(m,t));l*=t,u.push(t)}}if(-1!==h){if(l<=0)throw new Error(o.backend_util.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());const t=Math.trunc(a/l);if(l*t!==a)throw new Error(o.backend_util.getSparseReshapeInputOutputMultipleErrorMessage(r,u));u[h]=t}if(o.util.sizeFromShape(u)!==a)throw new Error(o.backend_util.getSparseReshapeInputOutputMismatchErrorMessage(r,u));const d=r.length,f=[];if(d>0){f[d-1]=1;for(let t=d-2;t>=0;--t)f[t]=f[t+1]*r[t+1]}const p=[];if(c>0){p[c-1]=1;for(let t=c-2;t>=0;--t)p[t]=p[t+1]*u[t+1]}const g=o.util.getArrayFromDType(n,s*c);for(let o=0;o<s;++o){let e=0;for(let n=0;n<d;++n)e+=t[o*d+n]*f[n];for(let t=0;t<c;++t)g[o*c+t]=Math.trunc(e/p[t]),e%=p[t]}return[g,[s,c],u]}const jp={kernelName:o.SparseReshape,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:i,newShape:a}=e;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape\n        ".concat(r.shape));if(1!==i.shape.length)throw new Error("Input shape should be a vector but received shape\n        ".concat(i.shape));if(1!==a.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(a.shape));const o=Array.from(n.data.get(i.dataId).values),s=n.data.get(r.dataId).values,c=Array.from(n.data.get(a.dataId).values),[u,l,h]=Pp(s,r.shape,r.dtype,o,c);return[n.makeTensorInfo(l,r.dtype,u),n.makeTensorInfo([h.length],a.dtype,new Int32Array(h))]}};function Up(t,e,n,r,i){let a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;const c=r.length,u=[e[0],t.length/e[0]],l=u[1],h=c>0?i[c-1]+1:0;if(h<0)throw new Error(o.backend_util.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());const d=e.slice();d[0]=h;const f=d.reduce(((t,e)=>t*e),1),p=o.util.getArrayFromDType(n,f);if(0===c)return h>0&&p.fill(s),[p,d];if(h<=0)throw new Error(o.backend_util.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let g=0,m=1,y=0,v=i[g];for(;;){let e=0;if(m<c){if(e=i[m],v===e){++m;continue}if(v>=e)throw new Error(o.backend_util.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(v<0||v>=h)throw new Error(o.backend_util.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(v,h));v>y&&p.fill(s,y*l,v*l);for(let n=g;n<m;++n){const e=r[n];if(e<0||e>=u[0])throw new Error(o.backend_util.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(n,r[n],u[0]));for(let n=0;n<l;n++)p[v*l+n]+=t[e*l+n]}if(a)for(let t=0;t<l;t++)p[v*l+t]/=m-g;if(g=m,++m,y=v+1,v=e,m>c)break}return y<h&&p.fill(s,y*l,h*l),[p,d]}const Wp={kernelName:o.SparseSegmentMean,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{data:r,indices:i,segmentIds:a}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error("Indices should be a vector but received shape\n          ".concat(i.shape));if(1!==a.shape.length)throw new Error("Segment ids should be a vector but received shape\n          ".concat(a.shape));if(i.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,c=n.data.get(a.dataId).values,[u,l]=Up(o,r.shape,r.dtype,s,c,!0);return n.makeTensorInfo(l,r.dtype,u)}};const Vp={kernelName:o.SparseSegmentSum,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{data:r,indices:i,segmentIds:a}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error("Indices should be a vector but received shape\n         ".concat(i.shape));if(1!==a.shape.length)throw new Error("Segment ids should be a vector but received shape\n         ".concat(a.shape));if(i.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,c=n.data.get(a.dataId).values,[u,l]=Up(o,r.shape,r.dtype,s,c);return n.makeTensorInfo(l,r.dtype,u)}};const qp={kernelName:o.SparseToDense,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:i,sparseValues:a,defaultValue:s}=e,{outputShape:c}=r,{sliceRank:u,numUpdates:l,sliceSize:h,strides:d,outputSize:f}=o.backend_util.calculateShapes(a,i,c),p=!1,g=n.bufferSync(i);let m;switch(a.dtype){case"bool":m=yp(g,n.bufferSync(a),c,f,h,l,u,d,Boolean(n.data.get(s.dataId).values[0]),p);break;case"float32":m=yp(g,n.bufferSync(a),c,f,h,l,u,d,n.data.get(s.dataId).values[0],p);break;case"int32":m=yp(g,n.bufferSync(a),c,f,h,l,u,d,n.data.get(s.dataId).values[0],p);break;case"string":m=yp(g,n.bufferSync(a),c,f,h,l,u,d,o.util.decodeString(n.data.get(s.dataId).values[0]),p);break;default:throw new Error("Unsupported type ".concat(a.dtype))}return n.makeTensorInfo(c,m.dtype,m.values)}};const Gp={kernelName:o.SplitV,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{numOrSizeSplits:a,axis:s}=r,c=o.util.parseAxisParam(s,i.shape)[0],u=o.backend_util.prepareSplitSize(i,a,c),l=new Array(i.shape.length).fill(0),h=i.shape.slice();return u.map((t=>{const e=[...h];e[c]=t;const r=kl({inputs:{x:i},backend:n,attrs:{begin:l,size:e}});return l[c]+=t,r}))}},Hp=nu((t=>Math.sqrt(t))),Yp=ru(o.Sqrt,(t=>Math.sqrt(t))),Xp={kernelName:o.Sqrt,backendName:"cpu",kernelFunc:Yp},Kp={kernelName:o.Square,backendName:"cpu",kernelFunc:t=>{let{inputs:e,backend:n}=t;const{x:r}=e,i=n;Jc(r,"square");const a=i.data.get(r.dataId).values,o=new Float32Array(a.length);for(let s=0;s<a.length;++s){const t=a[s];o[s]=t*t}return{dataId:i.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},$p=hu(((t,e)=>{const n=t-e;return n*n})),Zp=Fu(o.SquaredDifference,$p),Qp={kernelName:o.SquaredDifference,backendName:"cpu",kernelFunc:Zp},Jp=nu(((t,e)=>{const{pattern:n,replaceGlobal:r,rewrite:i}=e;return t.replace(new RegExp(n,r?"g":""),i)})),tg=iu(o.StaticRegexReplace,Jp),eg={kernelName:o.StaticRegexReplace,backendName:"cpu",kernelFunc:tg},ng=ru(o.Step,((t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha})),rg={kernelName:o.Step,backendName:"cpu",kernelFunc:ng};function ig(t,e,n,r){const i=(0,o.buffer)(t,e.dtype);for(let a=0;a<i.size;a++){const t=i.indexToLoc(a),o=new Array(t.length);for(let e=0;e<o.length;e++)o[e]=t[e]*n[e]+r[e];i.set(e.get(...o),...t)}return i}const ag={kernelName:o.StridedSlice,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{begin:a,end:s,strides:c,beginMask:u,endMask:l,ellipsisMask:h,newAxisMask:d,shrinkAxisMask:f}=r;Jc(i,"stridedSlice");const{finalShapeSparse:p,finalShape:g,isIdentity:m,sliceDim0:y,isSimpleSlice:v,begin:b,end:x,strides:w}=o.slice_util.sliceInfo(i.shape,a,s,c,u,l,h,d,f);let k;if(m)k=Bu({inputs:{x:i},backend:n,attrs:{shape:g}});else if(y||v){o.util.assert(i.shape.length>=1,(()=>"Input must have rank at least 1, got: ".concat(i.shape.length)));const t=o.slice_util.computeOutShape(b,x,w),e=kl({inputs:{x:i},backend:n,attrs:{begin:b,size:t}});k=Bu({inputs:{x:e},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(e)}else{const t=ig(p,n.bufferSync(i),w,b);k=n.makeTensorInfo(g,t.dtype,t.values)}return k}};class og{constructor(t,e,n,r,i,a){this.separator=o.util.encodeString(t),this.nGramWidths=e,this.leftPad=o.util.encodeString(n),this.rightPad=o.util.encodeString(r),this.padWidth=i,this.preserveShort=a}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,e){const n=this.getPadWidth(e);return Math.max(0,t+2*n-e+1)}createNGrams(t,e,n,r,i,a){for(let o=0;o<i;++o){const s=this.getPadWidth(a),c=Math.max(0,s-o),u=Math.max(0,s-(i-(o+1))),l=a-(c+u),h=e+(c>0?0:o-s);let d=0;d+=c*this.leftPad.length;for(let e=0;e<l;++e)d+=t[h+e].length;d+=u*this.rightPad.length;d+=(c+u+l-1)*this.separator.length,n[r+o]=new Uint8Array(d);const f=n[r+o];let p=0;const g=t=>t.forEach((t=>f[p++]=t));for(let t=0;t<c;++t)g(this.leftPad),g(this.separator);for(let e=0;e<l-1;++e)g(t[h+e]),g(this.separator);if(l>0){g(t[h+l-1]);for(let t=0;t<u;++t)g(this.separator),g(this.rightPad)}else{for(let t=0;t<u-1;++t)g(this.rightPad),g(this.separator);g(this.rightPad)}}}compute(t,e){const n=t.length,r=e.length;if(r>0){let t=e[0];if(0!==t)throw new Error("First split value must be 0, got ".concat(t));for(let i=1;i<r;++i){let r=e[i]>=t;if(r=r&&e[i]<=n,!r)throw new Error("Invalid split value ".concat(e[i],", must be in [").concat(t,", ").concat(n,"]"));t=e[i]}if(t!==n)throw new Error("Last split value must be data size. Expected ".concat(n,", got ").concat(t))}const i=r-1,a=o.util.getArrayFromDType("int32",r);if(0===n||0===r){const t=new Array(n);for(let e=0;e<=i;++e)a[e]=0;return[t,a]}a[0]=0;for(let o=1;o<=i;++o){const t=e[o]-e[o-1];let n=0;this.nGramWidths.forEach((e=>{n+=this.getNumNGrams(t,e)})),this.preserveShort&&t>0&&0===n&&(n=1),a[o]=a[o-1]+n}const s=new Array(a[i]);for(let o=0;o<i;++o){const n=e[o];let r=a[o];if(this.nGramWidths.forEach((i=>{const a=e[o+1]-e[o],c=this.getNumNGrams(a,i);this.createNGrams(t,n,s,r,c,i),r+=c})),this.preserveShort&&r===a[o]){const i=e[o+1]-e[o];if(0===i)continue;const a=i+2*this.padWidth,c=1;this.createNGrams(t,n,s,r,c,a)}}return[s,a]}}function sg(t,e,n,r,i,a,o,s){return new og(n,r,i,a,o,s).compute(t,e)}const cg={kernelName:o.StringNGrams,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{separator:i,nGramWidths:a,leftPad:o,rightPad:s,padWidth:c,preserveShortSequences:u}=r,{data:l,dataSplits:h}=e,d=n.data.get(l.dataId).values,f=n.data.get(h.dataId).values,[p,g]=sg(d,f,i,a,o,s,c,u);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(h.shape,"int32",g)]}};function ug(t,e,n,r){if(!t.length)return;if(0===e.length){for(let e=0;e<t.length;++e)r.push(t.subarray(e,e+1));return}if(1===e.length){const i=e[0];let a=t.indexOf(i);for(;-1!==a;){const e=t.subarray(0,a);n&&0===e.length||r.push(e),a=(t=t.subarray(a+1)).indexOf(i)}return void(n&&0===t.length||r.push(t))}let i=0;for(let a=0;a<t.length+1;a++)if(a===t.length||-1!==e.indexOf(t[a])){const e=t.subarray(i,a);n&&0===e.length||r.push(e),i=a+1}}function lg(t,e,n){const r=t.length,i=[];let a=0,s=0;const c=new Array(r);for(let o=0;o<r;++o){const r=i.length;ug(t[o],e,n,i);const u=i.length-r;c[o]=u,a+=u,s=Math.max(s,u)}const u=o.util.getArrayFromDType("int32",2*a),l=new Array(a),h=[r,s];let d=0;for(let o=0;o<r;++o)for(let t=0;t<c[o];++t)u[2*d]=o,u[2*d+1]=t,l[d]=i[d],++d;return[u,l,h]}const hg={kernelName:o.StringSplit,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:i}=r,{input:a,delimiter:o}=e;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(1!==a.shape.length)throw new Error("Input must be a vector, got shape: ".concat(a.shape));if(0!==o.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(o.shape));const s=n.data.get(a.dataId).values,c=n.data.get(o.dataId).values[0],[u,l,h]=lg(s,c,i),d=l.length;return[n.makeTensorInfo([d,2],"int32",u),n.makeTensorInfo([d],"string",l),n.makeTensorInfo([2],"int32",new Int32Array(h))]}};function dg(t,e){const n=o.util.getArrayFromDType("int32",t.length);for(let r=0;r<t.length;++r)n[r]=o.util.fingerPrint64(t[r]).modulo(e).getLowBitsUnsigned();return n}const fg={kernelName:o.StringToHashBucketFast,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:i}=r,{input:a}=e;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const o=dg(n.data.get(a.dataId).values,i);return n.makeTensorInfo(a.shape,"int32",o)}},pg=ru(o.Tan,(t=>Math.tan(t))),gg={kernelName:o.Tan,backendName:"cpu",kernelFunc:pg},mg=ru(o.Tanh,(t=>Math.tanh(t))),yg={kernelName:o.Tanh,backendName:"cpu",kernelFunc:mg};const vg={kernelName:o.TensorScatterUpdate,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{tensor:r,indices:i,updates:a}=e,{sliceRank:s,numUpdates:c,sliceSize:u,strides:l,outputSize:h}=o.backend_util.calculateShapes(a,i,r.shape),d=n.bufferSync(i),f=n.bufferSync(a),p=n.bufferSync(r),g=yp(d,f,r.shape,h,u,c,s,l,p,!1);return n.makeTensorInfo(r.shape,g.dtype,g.values)}};function bg(t,e){const n=new Array(t.rank);for(let i=0;i<n.length;i++)n[i]=t.shape[i]*e[i];const r=(0,o.buffer)(n,t.dtype);for(let i=0;i<r.values.length;++i){const e=r.indexToLoc(i),n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=e[r]%t.shape[r];const a=t.locToIndex(n);r.values[i]=t.values[a]}return r}const xg={kernelName:o.Tile,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{reps:a}=r;Jc(i,"tile");const o=bg(n.bufferSync(i),a);return n.makeTensorInfo(o.shape,o.dtype,o.values)}},wg=(t,e)=>{const n=e.value-t.value;return 0===n?t.index-e.index:n};function kg(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length-1;for(;r>n;){if(r-n>600){const i=r-n+1,a=e-n+1,o=Math.log(i),s=.5*Math.exp(2*o/3),c=.5*Math.sqrt(o*s*(i-s)/i)*Math.sign(a-i/2);kg(t,e,Math.max(n,Math.floor(e-a*s/i+c)),Math.min(r,Math.floor(e+(i-a)*s/i+c)))}const i=t[e];let a=n,s=r;for(o.util.swap(t,n,e),wg(t[r],i)>0&&o.util.swap(t,n,r);a<s;){for(o.util.swap(t,a,s),a++,s--;wg(t[a],i)<0;)a+=1;for(;wg(t[s],i)>0;)s-=1}0===wg(t[n],i)?o.util.swap(t,n,s):(s+=1,o.util.swap(t,s,r)),s<=e&&(n=s+1),e<=s&&(r=s-1)}}function _g(t,e,n,r,i){const a=e[e.length-1],[s,c]=[t.length/a,a],u=o.util.getTypedArrayFromDType(n,s*r),l=o.util.getTypedArrayFromDType("int32",s*r);for(let o=0;o<s;o++){const e=o*c,n=t.subarray(e,e+c);let a=new Array(n.length);n.forEach(((t,e)=>a[e]={value:t,index:e})),r<a.length&&(kg(a,r),a=a.slice(0,r)),i&&a.sort(wg);const s=o*r,h=u.subarray(s,s+r),d=l.subarray(s,s+r);for(let t=0;t<r;t++)h[t]=a[t].value,d[t]=a[t].index}const h=e.slice();return h[h.length-1]=r,[(0,o.buffer)(h,n,u),(0,o.buffer)(h,"int32",l)]}const Sg={kernelName:o.TopK,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{k:a,sorted:o}=r;Jc(i,"topk");const s=n.data.get(i.dataId).values,[c,u]=_g(s,i.shape,i.dtype,a,o);return[n.makeTensorInfo(c.shape,c.dtype,c.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}};const Ag={kernelName:o.Transform,backendName:"cpu",kernelFunc:function(t){const{inputs:e,attrs:n,backend:r}=t,{image:i,transforms:a}=e,{interpolation:s,fillMode:c,fillValue:u,outputShape:l}=n,[h,d,f,p]=i.shape,[g,m]=null!=l?l:[d,f],y=[h,g,m,p],v=o.util.computeStrides(i.shape),b=v[0],x=v[1],w=v[2],k=o.util.computeStrides(y),_=k[0],S=k[1],A=k[2],C=o.util.getTypedArrayFromDType(i.dtype,o.util.sizeFromShape(y));C.fill(u);const E=r.data.get(i.dataId).values,T=r.data.get(a.dataId).values;for(let o=0;o<h;++o){const t=1===a.shape[0]?T:T.subarray(8*o,8*o+8);for(let e=0;e<g;++e)for(let n=0;n<m;++n)for(let r=0;r<p;++r){let i;const a=t[6]*n+t[7]*e+1;if(0===a)continue;const l=(t[0]*n+t[1]*e+t[2])/a,h=(t[3]*n+t[4]*e+t[5])/a,p=Cg(l,f,c),g=Cg(h,d,c);switch(s){case"nearest":i=Tg(E,d,f,b,x,w,o,g,p,r,u);break;case"bilinear":i=Ng(E,d,f,b,x,w,o,g,p,r,u);break;default:throw new Error("Error in Transform: Expect 'nearest' or "+"'bilinear', but got ".concat(s))}C[o*_+e*S+n*A+r]=i}return r.makeTensorInfo(y,i.dtype,C)}return{dataId:r.write(C,y,i.dtype),shape:i.shape,dtype:i.dtype}}};function Cg(t,e,n){switch(n){case"reflect":return function(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const t=2*e;n<t&&(n=t*Math.trunc(-n/t)+n),n=n<-e?n+t:-n-1}else if(n>e-1)if(e<=1)n=0;else{const t=2*e;n-=t*Math.trunc(n/t),n>=e&&(n=t-n-1)}return o.util.clamp(0,n,e-1)}(t,e);case"wrap":return function(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const t=e-1;n+=e*(Math.trunc(-n/t)+1)}else if(n>e-1)if(e<=1)n=0;else{const t=e-1;n-=e*Math.trunc(n/t)}return o.util.clamp(0,n,e-1)}(t,e);case"nearest":return function(t,e){return o.util.clamp(0,t,e-1)}(t,e);default:return function(t,e){return t}(t)}}function Eg(t,e,n,r,i,a,o,s,c,u,l){return 0<=s&&s<e&&0<=c&&c<n?t[o*r+s*i+c*a+u]:l}function Tg(t,e,n,r,i,a,o,s,c,u,l){return Eg(t,e,n,r,i,a,o,Math.round(s),Math.round(c),u,l)}function Ng(t,e,n,r,i,a,o,s,c,u,l){const h=Math.floor(s),d=Math.floor(c),f=h+1,p=d+1;return(f-s)*((p-c)*Eg(t,e,n,r,i,a,o,h,d,u,l)+(c-d)*Eg(t,e,n,r,i,a,o,h,p,u,l))+(s-h)*((p-c)*Eg(t,e,n,r,i,a,o,f,d,u,l)+(c-d)*Eg(t,e,n,r,i,a,o,f,p,u,l))}function Dg(t,e,n,r){const i=o.util.parseAxisParam(e,n)[0],a=[1,n[0],1];for(let o=0;o<i;o++)a[0]*=n[o];a[1]=n[i];for(let o=i+1;o<n.length;o++)a[2]*=n[o];const s=new Map,c=new Int32Array(n[i]),u=new o.TensorBuffer(a,r,t),l=[],h=1===a[0]&&1===a[2];for(let o=0;o<n[i];o++){let e;if(h)e=t[o].toString();else{const t=[];for(let e=0;e<a[0];e++)for(let n=0;n<a[2];n++)t.push(u.get(e,o,n));e=t.join(",")}const n=s.get(e);if(null!=n)c[o]=n;else{const t=s.size;s.set(e,t),c[o]=t,l.push(o)}}const d=a.slice();d[1]=s.size;const f=new o.TensorBuffer(d,r);l.forEach(((t,e)=>{for(let n=0;n<a[0];n++)for(let r=0;r<a[2];r++)f.set(u.get(n,t,r),n,e,r)}));const p=n.slice();return p[i]=d[1],{outputValues:f.values,outputShape:p,indices:c}}const Fg={kernelName:o.Unique,backendName:"cpu",kernelFunc:function(t){const{inputs:e,attrs:n,backend:r}=t,{axis:i}=n,{x:a}=e;Jc(a,"unique");const o=r.data.get(a.dataId).values,{outputValues:s,outputShape:c,indices:u}=Dg(o,i,a.shape,a.dtype);return[r.makeTensorInfo(c,a.dtype,s),r.makeTensorInfo([u.length],"int32",u)]}};const Ig={kernelName:o.Unpack,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{value:i}=e;let{axis:a}=r;a<0&&(a+=i.shape.length);const o=i.shape.length,s=i.shape[a],c=new Array(o-1);let u=0;for(let f=0;f<o;f++)f!==a&&(c[u++]=i.shape[f]);const l=new Array(o).fill(0),h=i.shape.slice();h[a]=1;const d=new Array(s);for(let f=0;f<d.length;f++){l[a]=f;const t=kl({inputs:{x:i},backend:n,attrs:{begin:l,size:h}});d[f]=Bu({inputs:{x:t},backend:n,attrs:{shape:c}}),n.disposeIntermediateTensorInfo(t)}return d}};const Mg={kernelName:o.UnsortedSegmentSum,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,segmentIds:a}=e,{numSegments:s}=r;Jc(i,"unsortedSegmentSum");const c=[],u=[],l=i.shape.length-a.shape.length;let h=a;for(let o=0;o<l;++o){const t=zh({inputs:{input:h},backend:n,attrs:{dim:o+1}});h=t,u.push(t)}for(let f=0;f<s;++f){const t=o.util.createScalarValue(f,"int32"),e=n.makeTensorInfo([],"int32",t),r=_h({inputs:{a:e,b:h},backend:n}),a=Nu({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),s=mh({inputs:{a:a,b:i},backend:n}),l=vh({inputs:{x:s},backend:n,attrs:{axis:0,keepDims:!1}});c.push(l),u.push(e),u.push(r),u.push(a),u.push(s),u.push(l)}const d=Of({inputs:c,backend:n,attrs:{axis:0}});return u.forEach((t=>n.disposeIntermediateTensorInfo(t))),d}},Og=[Uu,Vu,Gu,Yu,zu,Xu,Qu,Ju,tl,el,rl,al,sl,ll,dl,ml,yl,vl,bl,ju,xl,Sl,El,Dl,Fl,Du,Ol,zl,Su,Bl,Wl,ql,Gl,Hl,Yl,Xl,Kl,Zl,Jl,th,eh,nh,rh,ih,oh,sh,ch,uh,lh,hh,dh,fh,xh,ou,wh,Sh,Ih,Rh,Bh,jh,Zh,Jh,td,rd,od,sd,cd,ld,dd,gd,vd,cu,bd,jl,wd,_d,Ad,lu,Td,Fd,Md,zd,Ld,Ud,Vd,Hd,Yd,Xd,Zd,tf,ef,nf,rf,af,of,sf,cf,hf,df,gf,vf,yh,xf,kf,Sf,Cf,Nf,Df,Mf,Rf,zf,Pf,pu,Uf,Hf,Kf,ep,rp,Eu,Vh,ap,mu,vu,Lu,op,sp,cp,up,lp,hp,fp,mp,vp,wp,kp,Cp,wu,Tp,Dp,Ip,_l,yf,Rp,zp,Lp,jp,Wp,Vp,qp,Gp,Xp,Kp,Qp,eg,rg,ag,cg,hg,fg,Yh,bh,gg,yg,vg,xg,Sg,Ag,Zu,Fg,Ig,Mg,If];for(const n of Og)(0,o.registerKernel)(n);const Rg={},zg={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Bg(t,e){if(!(t in Rg)||null!=e){const n=function(t,e){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=null==e?function(t){if((0,o.env)().getBool("IS_SAFARI")||"undefined"===typeof OffscreenCanvas||2!==t){if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}return new OffscreenCanvas(300,150)}(t):e;n.addEventListener("webglcontextlost",(e=>{e.preventDefault(),delete Rg[t]}),!1),(0,o.env)().getBool("SOFTWARE_WEBGL_ENABLED")&&(zg.failIfMajorPerformanceCaveat=!1);if(1===t)return n.getContext("webgl",zg)||n.getContext("experimental-webgl",zg);return n.getContext("webgl2",zg)}(t,e);if(null===n)return console.log("Could not get context for WebGL version",t),null;Rg[t]=n}const n=Rg[t];return null==n||n.isContextLost()?(delete Rg[t],Bg(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Rg[t])}var Lg,Pg,jg;function Ug(t,e){return[e,t]}function Wg(t){const e=o.util.sizeFromShape(t),n=Math.ceil(e/4);return o.util.sizeToSquarishShape(n)}function Vg(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function qg(t,e){const n=t;let r,i,a,s,c,u,l,h,d,f;return 2===(0,o.env)().getNumber("WEBGL_VERSION")?(r=n.R32F,i=n.R16F,a=n.RGBA16F,s=n.RGBA32F,c=n.RED,l=4,h=1,d=n.HALF_FLOAT,f=n.FLOAT,u=n.RGBA8):(r=t.RGBA,i=t.RGBA,a=t.RGBA,s=n.RGBA,c=t.RGBA,l=4,h=4,d=null!=e?e.HALF_FLOAT_OES:null,f=t.FLOAT,u=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:s,textureFormatFloat:c,downloadTextureFormat:u,downloadUnpackNumChannels:l,defaultNumChannels:h,textureTypeHalfFloat:d,textureTypeFloat:f}}function Gg(t,e){const n=e();return(0,o.env)().getBool("DEBUG")&&function(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+function(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(e)}}(t,e))}(t),n}!function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"}(Lg||(Lg={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(Pg||(Pg={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(jg||(jg={}));function Hg(t){return!!((0,o.env)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||5.96e-8<Math.abs(t)&&Math.abs(t)<65504)}function Yg(t,e){return nm(t,(()=>t.getExtension(e)),'Extension "'+e+'" not supported on this browser.')}const Xg=/ERROR: [0-9]+:([0-9]+):/g;function Kg(t,e){const n=Xg.exec(e);if(null==n)return console.log("Couldn't parse line number in error: ".concat(e)),void console.log(t);const r=+n[1],i=t.split("\n"),a=i.length.toString().length+2,s=i.map(((t,e)=>o.util.rightPad((e+1).toString(),a)+t));let c=0;for(let o=0;o<s.length;o++)c=Math.max(s[o].length,c);const u=s.slice(0,r-1),l=s.slice(r-1,r),h=s.slice(r);console.log(u.join("\n")),console.log(e.split("\n")[0]),console.log("%c ".concat(o.util.rightPad(l[0],c)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}function $g(t,e){if(Gg(t,(()=>t.validateProgram(e))),!1===t.getProgramParameter(e,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function Zg(t,e,n,r,i,a,o){const s=t.getAttribLocation(e,n);return-1!==s&&(Gg(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,r))),Gg(t,(()=>t.vertexAttribPointer(s,i,t.FLOAT,!1,a,o))),Gg(t,(()=>t.enableVertexAttribArray(s))),!0)}function Qg(t,e,n,r){Gg(t,(()=>function(t,e,n){rm(t,n),Gg(t,(()=>t.activeTexture(t.TEXTURE0+n))),Gg(t,(()=>t.bindTexture(t.TEXTURE_2D,e)))}(t,e,r))),Gg(t,(()=>t.uniform1i(n,r)))}function Jg(t,e,n){Gg(t,(()=>t.bindFramebuffer(t.FRAMEBUFFER,n))),Gg(t,(()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)))}function tm(t,e){Gg(t,(()=>t.bindFramebuffer(t.FRAMEBUFFER,e))),Gg(t,(()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)))}function em(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(e)}}(t,e))}function nm(t,e,n){const r=Gg(t,(()=>e()));if(null==r)throw new Error(n);return r}function rm(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const t="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(t,"."))}}function im(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return o.util.sizeFromShape(t.slice(0,t.length-e))}function am(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function om(t){let e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[im(t),...am(t)]),e}function sm(t){return t%2===0}function cm(t,e){if(t=t.slice(-2),e=e.slice(-2),o.util.arraysEqual(t,e))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){const n=t[t.length-1],r=e[e.length-1];if(n===r)return!0;if(sm(n)&&sm(r)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&sm(t[0])&&sm(e[0])}let um,lm;function hm(t,e){return null!=t.getExtension(e)}function dm(t){try{if(null!=Bg(t))return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function fm(t){if(0===t)return!1;const e=Bg(t);if(1!==t){if(hm(e,"EXT_color_buffer_float"))return pm(e);const t="EXT_color_buffer_half_float";if(hm(e,t)){const n=e.getExtension(t);return function(t,e){const n=qg(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const i=1,a=1;t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,i,a,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const s=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(o),s}(e,n)}return!1}if(!hm(e,"OES_texture_float"))return!1;if(!hm(e,"WEBGL_color_buffer_float"))return!1;return pm(e)}function pm(t){const e=qg(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),i}function gm(t,e){Array.isArray(t)||(t=[t]),t.forEach((t=>{null!=t&&o.util.assert("complex64"!==t.dtype,(()=>"".concat(e," does not support complex64 tensors ")+"in the WebGL backend."))}))}const mm=(0,o.env)();function ym(){let t,e,n,r,i,a,s,c,u,l;return 2===(0,o.env)().getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",r="in",i="texture",a="outputColor",s="out vec4 outputColor;",c=(0,o.env)().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",u="",l="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",r="varying",i="texture2D",a="gl_FragColor",s="",c="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",l="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:i,output:a,defineOutput:s,defineSpecialNaN:c,defineSpecialInf:u,defineRound:l}}function vm(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=o.util.computeStrides(e);return r.map(((e,i)=>{const a="int ".concat(t[i]," = ").concat(n," / ").concat(e),o=i===r.length-1?"int ".concat(t[i+1]," = ").concat(n," - ").concat(t[i]," * ").concat(e):"index -= ".concat(t[i]," * ").concat(e);return"".concat(a,"; ").concat(o,";")})).join("")}function bm(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=o.util.computeStrides(e);return r.map(((e,i)=>{const a="int ".concat(t[i]," = ").concat(n," / outShapeStrides[").concat(i,"]"),o=i===r.length-1?"int ".concat(t[i+1]," = ").concat(n," - ").concat(t[i]," * outShapeStrides[").concat(i,"]"):"index -= ".concat(t[i]," * outShapeStrides[").concat(i,"]");return"".concat(a,"; ").concat(o,";")})).join("")}function xm(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=function(t,e){const n=t.length,r=t.map((t=>"".concat(e,"[").concat(t,"]"))),i=new Array(n-1);i[n-2]=r[n-1];for(let a=n-3;a>=0;--a)i[a]="(".concat(i[a+1]," * ").concat(r[a+1],")");return i}(t.map(((t,e)=>e)),e);return r.map(((e,i)=>{const a="int ".concat(t[i]," = ").concat(n," / ").concat(r[i]),o=i===r.length-1?"int ".concat(t[i+1]," = ").concat(n," - ").concat(t[i]," * ").concat(r[i]):"index -= ".concat(t[i]," * ").concat(r[i]);return"".concat(a,"; ").concat(o,";")})).join("")}function wm(t){const e=o.util.computeStrides(t).map((t=>t.toString()));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(e[0]," + coords.y * ").concat(e[1]," + coords.z;\n  }\n")}mm.registerFlag("HAS_WEBGL",(()=>mm.getNumber("WEBGL_VERSION")>0)),mm.registerFlag("WEBGL_VERSION",(()=>dm(2)?2:dm(1)?1:0)),mm.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(()=>!1)),mm.registerFlag("WEBGL_BUFFER_SUPPORTED",(()=>2===mm.get("WEBGL_VERSION"))),mm.registerFlag("WEBGL_CPU_FORWARD",(()=>!0)),mm.registerFlag("WEBGL_FORCE_F16_TEXTURES",(()=>!1)),mm.registerFlag("WEBGL_PACK",(()=>mm.getBool("HAS_WEBGL"))),mm.registerFlag("WEBGL_PACK_NORMALIZATION",(()=>mm.getBool("WEBGL_PACK"))),mm.registerFlag("WEBGL_PACK_CLIP",(()=>mm.getBool("WEBGL_PACK"))),mm.registerFlag("WEBGL_PACK_DEPTHWISECONV",(()=>mm.getBool("WEBGL_PACK"))),mm.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(()=>mm.getBool("WEBGL_PACK"))),mm.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(()=>mm.getBool("WEBGL_PACK"))),mm.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(()=>mm.getBool("WEBGL_PACK"))),mm.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(()=>mm.getBool("WEBGL_PACK"))),mm.registerFlag("WEBGL_PACK_REDUCE",(()=>mm.getBool("WEBGL_PACK"))),mm.registerFlag("WEBGL_LAZILY_UNPACK",(()=>mm.getBool("WEBGL_PACK"))),mm.registerFlag("WEBGL_CONV_IM2COL",(()=>mm.getBool("WEBGL_PACK"))),mm.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",(()=>mm.getBool("WEBGL_PACK"))),mm.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(()=>function(t){if(null==um){const e=Bg(t);um=e.getParameter(e.MAX_TEXTURE_SIZE)}return um}(mm.getNumber("WEBGL_VERSION")))),mm.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(()=>function(t){if(null==lm){const e=Bg(t);lm=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,lm)}(mm.getNumber("WEBGL_VERSION")))),mm.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(()=>{const t=mm.getNumber("WEBGL_VERSION");return 0===t?0:function(t){if(0===t)return 0;let e;const n=Bg(t);return e=hm(n,"EXT_disjoint_timer_query_webgl2")&&2===t?2:hm(n,"EXT_disjoint_timer_query")?1:0,e}(t)})),mm.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(()=>mm.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!o.device_util.isMobile())),mm.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(()=>function(t){if(0===t)return!1;const e=Bg(t);if(1===t){if(!hm(e,"OES_texture_float"))return!1}else if(!hm(e,"EXT_color_buffer_float"))return!1;return pm(e)}(mm.getNumber("WEBGL_VERSION")))),mm.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(()=>!mm.getBool("WEBGL_FORCE_F16_TEXTURES")&&mm.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))),mm.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(()=>fm(mm.getNumber("WEBGL_VERSION")))),mm.registerFlag("WEBGL_FENCE_API_ENABLED",(()=>{return 2===(t=mm.getNumber("WEBGL_VERSION"))&&null!=Bg(t).fenceSync;var t})),mm.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(()=>mm.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0)),mm.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(()=>-1),(t=>{if("number"!==typeof t)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but "+"got ".concat(t,"."));if(t<0&&-1!==t)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(t,"."))})),mm.registerFlag("WEBGL_FLUSH_THRESHOLD",(()=>o.device_util.isMobile()?1:-1),(t=>{if("number"!==typeof t)throw new Error("WEBGL_FLUSH_THRESHOLD must be a number but got "+"".concat(t,"."));if(t<0&&-1!==t)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(t,"."))})),mm.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",(()=>128)),mm.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",(()=>!1)),mm.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",(()=>1e5)),mm.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",(()=>128)),mm.registerFlag("WEBGL_EXP_CONV",(()=>!1)),mm.registerFlag("SOFTWARE_WEBGL_ENABLED",(()=>mm.getBool("IS_TEST"))),mm.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",(()=>1/0)),mm.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",(()=>!1)),mm.registerFlag("WEBGL2_ISNAN_CUSTOM",(()=>!1)),mm.registerFlag("ENGINE_COMPILE_ONLY",(()=>!1));const km="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:_m}=o.backend_util;function Sm(t,e,n){const r=[];if(t.forEach((t=>{const e=o.util.sizeFromShape(t.shapeInfo.logicalShape);if(t.shapeInfo.isUniform?r.push("uniform float ".concat(t.name).concat(e>1?"[".concat(e,"]"):"",";")):(r.push("uniform sampler2D ".concat(t.name,";")),r.push("uniform int offset".concat(t.name,";"))),n.enableShapeUniforms){const{uniformShape:e}=Om(n.packedInputs,t.shapeInfo.logicalShape,t.shapeInfo.texShape);switch(e.length){case 1:r.push("uniform int ".concat(t.name,"Shape;"));break;case 2:r.push("uniform ivec2 ".concat(t.name,"Shape;"));break;case 3:r.push("uniform ivec3 ".concat(t.name,"Shape;"));break;case 4:r.push("uniform ivec4 ".concat(t.name,"Shape;"))}r.push("uniform ivec2 ".concat(t.name,"TexShape;"))}})),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;")}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach((t=>{r.push("uniform ".concat(t.type," ").concat(t.name).concat(t.arrayIndex?"[".concat(t.arrayIndex,"]"):"",";"))}));const i=r.join("\n"),a=t.map((t=>function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,i="";i+=n?Cm(t,r):Am(t,r);const a=t.shapeInfo.logicalShape,s=e.logicalShape;a.length<=s.length&&(i+=n?function(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",a=t.shapeInfo.logicalShape.length,s=e.logicalShape.length,c=_m(t.shapeInfo.logicalShape,e.logicalShape),u=Mm(s),l=s-a;let h;const d=["x","y","z","w","u","v"];h=0===a?"":s<2&&c.length>=1?"coords = 0;":c.map((t=>"coords.".concat(d[t+l]," = 0;"))).join("\n");let f="";f=s<2&&a>0?"coords":t.shapeInfo.logicalShape.map(((t,e)=>"coords.".concat(d[e+l]))).join(", ");let p="return outputValue;";const g=1===o.util.sizeFromShape(t.shapeInfo.logicalShape),m=o.util.sizeFromShape(e.logicalShape),y=1===m;if(1!==a||g||y){if(g&&!y)p=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(c.length){const t=a-2,e=a-1;c.indexOf(t)>-1&&c.indexOf(e)>-1?p="return vec4(outputValue.x);":c.indexOf(t)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":c.indexOf(e)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(i,"() {\n      ").concat(u," coords = getOutputCoords();\n      ").concat(h,"\n      vec4 outputValue = get").concat(r,"(").concat(f,");\n      ").concat(p,"\n    }\n  ")}(t,e):function(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",a=e.texShape,s=t.shapeInfo.texShape,c=t.shapeInfo.logicalShape.length,u=e.logicalShape.length;if(!t.shapeInfo.isUniform&&c===u&&null==t.shapeInfo.flatOffset&&o.util.arraysEqual(s,a))return"\n      float ".concat(i,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");const l=Mm(u),h=_m(t.shapeInfo.logicalShape,e.logicalShape),d=u-c;let f;const p=["x","y","z","w","u","v"];f=0===c?"":u<2&&h.length>=1?"coords = 0;":h.map((t=>"coords.".concat(p[t+d]," = 0;"))).join("\n");let g="";g=u<2&&c>0?"coords":t.shapeInfo.logicalShape.map(((t,e)=>"coords.".concat(p[e+d]))).join(", ");return"\n    float ".concat(i,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(f,"\n      return get").concat(r,"(").concat(g,");\n    }\n  ")}(t,e));return i}(t,e,n.packedInputs,n.enableShapeUniforms))).join("\n"),s=e.texShape,c=ym(),u=function(t){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(t.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(c);let l,h,d=function(t){const e="".concat(t.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(t.varyingFs," vec2 resultUV;\n    ").concat(t.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(t.defineSpecialNaN,"\n    ").concat(t.defineSpecialInf,"\n    ").concat(t.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(Em,"\n    ").concat(Tm,"\n    ").concat(Nm,"\n  ");return e}(c);e.isPacked?(l=function(t,e,n){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(1===r[0])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(r[1],".0);\n      }\n    ");if(1===r[1])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(r[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      return 2 * (resTexRC.x * ").concat(r[1]," + resTexRC.y);\n    }\n  ")}(0,e,n);case 2:return function(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(o.util.arraysEqual(t,e))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(r[0],", ").concat(r[1],"));\n      }\n    ");const i=Math.ceil(t[1]/2);if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(i,");\n      int c = imod(index, ").concat(i,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(t,e,n);case 3:return function(t,e,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(t[2]/2),a=i*Math.ceil(t[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(i,");\n      int c = imod(index, ").concat(i,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(t,e,n);default:return function(t,e,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(t[t.length-1]/2),a=i*Math.ceil(t[t.length-2]/2);let o=a,s="",c="b, r, c";for(let u=2;u<t.length-1;u++)o*=t[t.length-u-1],s="\n      int b".concat(u," = index / ").concat(o,";\n      index -= b").concat(u," * ").concat(o,";\n    ")+s,c="b".concat(u,", ")+c;return"\n    ivec".concat(t.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      ").concat(s,"\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(i,");\n      int c = imod(index, ").concat(i,") * 2;\n\n      return ivec").concat(t.length,"(").concat(c,");\n    }\n  ")}(t,e,n)}}(e.logicalShape,s,n.enableShapeUniforms),h=function(t){return"\n    void setOutput(vec4 val) {\n      ".concat(t.output," = val;\n    }\n  ")}(c)):(l=function(t,e,n){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e,n){if(1===e[0])return n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(e[1],".0);\n      }\n    ");if(1===e[1])return n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(e[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      return resTexRC.x * ").concat(e[1]," + resTexRC.y;\n    }\n  ")}(0,e,n);case 2:return function(t,e,n){if(o.util.arraysEqual(t,e))return n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(e[0],", ").concat(e[1],"));\n      }\n    ");if(1===t[1])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(e[0],", ").concat(e[1],"));\n        int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===t[0])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(e[0],", ").concat(e[1],"));\n        int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      int r = index / ").concat(t[1],";\n      int c = index - r * ").concat(t[1],";\n      return ivec2(r, c);\n    }\n  ")}(t,e,n);case 3:return function(t,e,n){if(n){const e=bm(["r","c","d"],t);return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(e,"\n    return ivec3(r, c, d);\n  }\n")}const r=vm(["r","c","d"],t);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      ").concat(r,"\n      return ivec3(r, c, d);\n    }\n  ")}(t,e,n);case 4:return function(t,e,n){if(n){const e=bm(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(e,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}const r=vm(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      ").concat(r,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(t,e,n);case 5:return function(t,e){const n=vm(["r","c","d","d2","d3"],t);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(e[0],",\n                             ").concat(e[1],"));\n\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(t,e);case 6:return function(t,e){const n=vm(["r","c","d","d2","d3","d4"],t);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(t,e);default:throw new Error("".concat(t.length,"-D output sampling is not yet supported"))}}(e.logicalShape,s,n.enableShapeUniforms),h=function(t){return"\n    void setOutput(float val) {\n      ".concat(t.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(c)),n.packedInputs&&(d+=Dm);return[d,u,h,i,l,a,n.userCode].join("\n")}function Am(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return function(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return"float ".concat(r,"() {return ").concat(n,";}");const[i,a]=t.shapeInfo.texShape;if(1===i&&1===a)return"\n      float ".concat(r,"() {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");const o=Fm(n);if(e)return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], ").concat(o,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");const[s,c]=t.shapeInfo.texShape;return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(s,", ").concat(c,", ").concat(o,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t,e);case 1:return function(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return"\n      float ".concat(r,"(int index) {\n        ").concat(Im(t),"\n      }\n    ");const i=t.shapeInfo.texShape,a=i[0],o=i[1];if(1===o&&1===a)return"\n      float ".concat(r,"(int index) {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");const s=Fm(n);if(1===o)return e?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / ").concat(a,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(1===a)return e?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / ").concat(o,".0, 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(e)return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(a,", ").concat(o,", index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t,e);case 2:return function(t,e){const n=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=t.shapeInfo.texShape;if(null!=a&&o.util.arraysEqual(n,a)){if(e)return"\n      float ".concat(i,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");const t=a[0],n=a[1];return"\n    float ".concat(i,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(n,".0, ").concat(t,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}const{newShape:s,keptDims:c}=o.util.squeezeShape(n),u=s;if(u.length<n.length){const n=Rm(t,u),r=["row","col"];return"\n      ".concat(Am(n,e),"\n      float ").concat(i,"(int row, int col) {\n        return ").concat(i,"(").concat(zm(r,c),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(Im(t),"\n      }\n    ");const l=a[0],h=a[1],d=Fm(r);if(1===h)return e?"\n      float ".concat(i,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(r,"TexShape[0]));\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(i,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(l,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");if(1===l)return e?"\n      float ".concat(i,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(r,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(i,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(h,".0, 0.5);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");if(e)return"\n      float ".concat(i,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(r,"Shape[1] + col + ").concat(d,";\n        vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");return"\n  float ".concat(i,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(d,";\n    vec2 uv = uvFromFlat(").concat(l,", ").concat(h,", index);\n    return sampleTexture(").concat(r,", uv);\n  }\n")}(t,e);case 3:return function(t,e){const n=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=n[1]*n[2],s=n[2],{newShape:c,keptDims:u}=o.util.squeezeShape(n),l=c;if(l.length<n.length){const n=Rm(t,l),r=["row","col","depth"];return"\n        ".concat(Am(n,e),"\n        float ").concat(i,"(int row, int col, int depth) {\n          return ").concat(i,"(").concat(zm(r,u),");\n        }\n      ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(a,", ").concat(s,", 1)));\n        ").concat(Im(t),"\n      }\n    ");const h=t.shapeInfo.texShape,d=h[0],f=h[1],p=t.shapeInfo.flatOffset;if(f===a&&null==p)return e?"\n      float ".concat(i,"(int row, int col, int depth) {\n        int stride1 = ").concat(r,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n        float ".concat(i,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(s,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(f,".0, ").concat(d,".0);\n          return sampleTexture(").concat(r,", uv);\n        }\n      ");if(f===s&&null==p)return e?"\n      float ".concat(i,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(r,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(i,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(f,".0, ").concat(d,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");const g=Fm(r);if(e)return"\n    float ".concat(i,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(r,"Shape[1] * ").concat(r,"Shape[2];\n      int stride1 = ").concat(r,"Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ").concat(g,";\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n      return sampleTexture(").concat(r,", uv);\n    }\n    ");return"\n      float ".concat(i,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(a," + col * ").concat(s," + depth + ").concat(g,";\n        vec2 uv = uvFromFlat(").concat(d,", ").concat(f,", index);\n        return sampleTexture(").concat(r,", uv);\n      }\n  ")}(t,e);case 4:return function(t,e){const n=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=n[3],s=n[2]*a,c=n[1]*s,{newShape:u,keptDims:l}=o.util.squeezeShape(n);if(u.length<n.length){const n=Rm(t,u),r=["row","col","depth","depth2"];return"\n      ".concat(Am(n,e),"\n      float ").concat(i,"(int row, int col, int depth, int depth2) {\n        return ").concat(i,"(").concat(zm(r,l),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(c,", ").concat(s,", ").concat(a,", 1)));\n        ").concat(Im(t),"\n      }\n    ");const h=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],p=d[1],g="int stride2 = ".concat(r,"Shape[3];"),m="int stride1 = ".concat(r,"Shape[2] * stride2;"),y="int stride0 = ".concat(r,"Shape[1] * stride1;");if(p===c&&null==h)return e?"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        ").concat(g,"\n        ").concat(m,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(s,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(p,".0, ").concat(f,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");if(p===a&&null==h)return e?"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(r,"Shape[1] * ").concat(r,"Shape[2], ").concat(r,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(p,".0, ").concat(f,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");const v=Fm(r);if(e)return"\n    float ".concat(i,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(g,"\n      ").concat(m,"\n      ").concat(y,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index + ").concat(v,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");return"\n    float ".concat(i,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(c," + col * ").concat(s," +\n          depth * ").concat(a," + depth2;\n      vec2 uv = uvFromFlat(").concat(f,", ").concat(p,", index + ").concat(v,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}(t,e);case 5:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e[4],a=e[3]*i,s=e[2]*a,c=e[1]*s,{newShape:u,keptDims:l}=o.util.squeezeShape(e);if(u.length<e.length){const e=Rm(t,u),n=["row","col","depth","depth2","depth3"];return"\n      ".concat(Am(e),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(zm(n,l),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(c,", ").concat(s,", ").concat(a,", ").concat(i,")) +\n          depth3;\n        ").concat(Im(t),"\n      }\n    ");const h=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],p=d[1];if(p===c&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(s,", ").concat(a,", ").concat(i,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(p,".0, ").concat(f,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(p===i&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(e[1]*e[2]*e[3],",\n               ").concat(e[2]*e[3],", ").concat(e[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(p,".0, ").concat(f,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const g=Fm(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(c," + col * ").concat(s," + depth * ").concat(a," +\n          depth2 * ").concat(i," + depth3 + ").concat(g,";\n      vec2 uv = uvFromFlat(").concat(f,", ").concat(p,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t);case 6:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:i,keptDims:a}=o.util.squeezeShape(e);if(i.length<e.length){const e=Rm(t,i),n=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(Am(e),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(zm(n,a),");\n      }\n    ")}const s=e[5],c=e[4]*s,u=e[3]*c,l=e[2]*u,h=e[1]*l;if(t.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(h,", ").concat(l,", ").concat(u,", ").concat(c,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(s,", 1)));\n        ").concat(Im(t),"\n      }\n    ");const d=t.shapeInfo.flatOffset,f=t.shapeInfo.texShape,p=f[0],g=f[1];if(g===h&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(l,", ").concat(u,", ").concat(c,", ").concat(s,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(g,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(g===s&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(e[1]*e[2]*e[3]*e[4],",\n               ").concat(e[2]*e[3]*e[4],",\n               ").concat(e[3]*e[4],",\n               ").concat(e[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(g,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const m=Fm(n);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(h," + col * ").concat(l," + depth * ").concat(u," +\n          depth2 * ").concat(c," + depth3 * ").concat(s," + depth4 + ").concat(m,";\n      vec2 uv = uvFromFlat(").concat(p,", ").concat(g,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t);default:throw new Error("".concat(n.length,"-D input sampling")+" is not yet supported")}}function Cm(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=ym();return"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(e,", halfCR);\n    }\n  ")}(t);case 1:return function(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t.shapeInfo.texShape,a=ym();if(e)return"\n    vec4 ".concat(r,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ");const o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return"\n    vec4 ".concat(r,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(o[0],", ").concat(o[1],", index);\n      return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ")}(t,e);case 2:return function(t,e){const n=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=t.shapeInfo.texShape,s=a[0],c=a[1],u=ym();if(null!=a&&o.util.arraysEqual(n,a))return e?"\n      vec4 ".concat(i,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n\n        return ").concat(u.texture2D,"(").concat(r,", uv);\n      }\n    "):"\n      vec4 ".concat(i,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(c,".0, ").concat(s,".0);\n\n        return ").concat(u.texture2D,"(").concat(r,", uv);\n      }\n    ");if(e)return"\n    vec4 ".concat(i,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(u.texture2D,"(").concat(r,", uv);\n    }\n  ");const l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],h=Math.ceil(n[1]/2);return"\n    vec4 ".concat(i,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(h,", ").concat(l[0],", ").concat(l[1],", row, col);\n      return ").concat(u.texture2D,"(").concat(r,", uv);\n    }\n  ")}(t,e);case 3:return function(t,e){const n=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=t.shapeInfo.texShape,o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(1===n[0]){const r=[1,2],a=Rm(t,n.slice(1)),o=["b","row","col"];return"\n        ".concat(Cm(a,e),"\n        vec4 ").concat(i,"(int b, int row, int col) {\n          return ").concat(i,"(").concat(zm(o,r),");\n        }\n      ")}const s=ym();if(e)return"\n    vec4 ".concat(i,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(s.texture2D,"(").concat(r,", uv);\n    }\n  ");const c=o[0],u=o[1],l=Math.ceil(n[2]/2),h=l*Math.ceil(n[1]/2);return"\n    vec4 ".concat(i,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(c,", ").concat(u,", ").concat(h,", ").concat(l,", b, row, col);\n      return ").concat(s.texture2D,"(").concat(r,", uv);\n    }\n  ")}(t,e);default:return function(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=ym();if(e)return"\n    vec4 ".concat(r,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(n,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ");const a=t.shapeInfo.logicalShape,o=a.length,s=t.shapeInfo.texShape,c=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],u=c[0],l=c[1],h=Math.ceil(a[o-1]/2);let d=h*Math.ceil(a[o-2]/2),f="int b, int row, int col",p="b * ".concat(d," + (row / 2) * ").concat(h," + (col / 2)");for(let g=2;g<o-1;g++)f="int b".concat(g,", ")+f,d*=a[o-g-1],p="b".concat(g," * ").concat(d," + ")+p;return"\n    vec4 ".concat(r,"(").concat(f,") {\n      int index = ").concat(p,";\n      int texR = index / ").concat(l,";\n      int texC = index - texR * ").concat(l,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(l,", ").concat(u,");\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ")}(t,e)}}const Em="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Tm="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Nm="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Dm="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function Fm(t){return"offset".concat(t)}function Im(t){const e=t.name,n=o.util.sizeFromShape(t.shapeInfo.logicalShape);return n<2?"return ".concat(e,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(e,"[i];\n      }\n    }\n  ")}function Mm(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error("GPU for rank ".concat(t," is not yet supported"))}function Om(t,e,n){const{newShape:r,keptDims:i}=o.util.squeezeShape(e),a=e.length,s=t&&3===a&&1===e[0],c=s?e.slice(1):r,u=!t&&a>1&&!o.util.arraysEqual(e,n)&&r.length<a||s;return{useSqueezeShape:u,uniformShape:u?c:e,keptDims:i}}function Rm(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function zm(t,e){return e.map((e=>t[e])).join(", ")}function Bm(t,e,n,r){const i=n.map(((t,n)=>{const r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}})),a=i.map((t=>t.shapeInfo)),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},c=Sm(i,s,e),u=function(t,e){const n=nm(t,(()=>t.createShader(t.FRAGMENT_SHADER)),"Unable to create fragment WebGLShader.");if(Gg(t,(()=>t.shaderSource(n,e))),Gg(t,(()=>t.compileShader(n))),(0,o.env)().get("ENGINE_COMPILE_ONLY"))return n;if(!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw Kg(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}(t.gl,c),l=t.createProgram(u);return(0,o.env)().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:u,source:c,webGLProgram:l,inShapeInfos:a,outShapeInfo:s,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(l),Object.assign({program:e,fragmentShader:u,source:c,webGLProgram:l,inShapeInfos:a,outShapeInfo:s},Lm(t,e,l)))}function Lm(t,e,n){const r=[],i=[];let a,s,c,u=null,l=null;l=t.getUniformLocation(n,"NAN",!1),1===(0,o.env)().getNumber("WEBGL_VERSION")&&(u=t.getUniformLocation(n,"INFINITY",!1));const h=!1;for(const o of e.variableNames){const i={name:o,uniform:t.getUniformLocation(n,o,h),offset:t.getUniformLocation(n,"offset".concat(o),h)};e.enableShapeUniforms&&(i.shape=t.getUniformLocation(n,"".concat(o,"Shape"),h),i.texShape=t.getUniformLocation(n,"".concat(o,"TexShape"),h)),r.push(i)}if(e.enableShapeUniforms&&(a=t.getUniformLocation(n,"outShape",h),c=t.getUniformLocation(n,"outShapeStrides",h),s=t.getUniformLocation(n,"outTexShape",h)),e.customUniforms)for(const o of e.customUniforms)i.push(t.getUniformLocation(n,o.name,h));return{variablesLocations:r,customUniformLocations:i,infLoc:u,nanLoc:l,outShapeLocation:a,outShapeStridesLocation:c,outTexShapeLocation:s}}function Pm(t,e){if(t.length!==e.length)throw Error("Binary was compiled with ".concat(t.length," inputs, but ")+"was executed with ".concat(e.length," inputs"));t.forEach(((t,n)=>{const r=t.logicalShape,i=e[n],a=i.shape;if(!o.util.arraysEqual(r,a))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(r," and ").concat(a," must match"));if(t.isUniform&&i.isUniform)return;const s=t.texShape,c=i.isUniform?null:i.texData.texShape;if(!o.util.arraysEqual(s,c))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(s," and ").concat(c," must match"))}))}function jm(t){return(0,o.env)().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}class Um{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Lg.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const e=ym();this.outputShape=t,this.enableShapeUniforms=jm(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?bm(["r","c","d"],t):vm(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(e.output," = result;\n      }\n    ")}}class Wm{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Lg.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const e=ym();this.outputShape=t,this.enableShapeUniforms=jm(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?bm(["r","c","d"],t):vm(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(e.output," = result;\n      }\n    ")}}class Vm{constructor(t){this.variableNames=["A"],this.outTexUsage=Pg.DOWNLOAD;const e=ym();this.outputShape=t,this.userCode="\n      ".concat(km,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(e.output," = encode_float(x);\n      }\n    ")}}class qm{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Pg.DOWNLOAD;const e=ym();this.outputShape=t,this.userCode="\n      ".concat(km,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(e.output," = encode_float(x);\n      }\n    ")}}const Gm={R:0,G:1,B:2,A:3};class Hm{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"RGBA";this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=ym();this.outputShape=t,this.enableShapeUniforms=jm(this.outputShape.length);let i="result";e&&(i="floor(result * 255. + 0.5)");let a="";for(let o=0;o<n.length;o++){const t=n[o];a+="\n          if(offset == ".concat(o,") {\n            result = values[").concat(Gm[t],"];\n          }")}this.userCode="\n      ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":wm(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ").concat(n.length,");\n\n        flatIndex = idiv(flatIndex, ").concat(n.length,", 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ").concat(r.texture2D,"(A, uv);\n          ").concat(a,"\n        }\n        ").concat(r.output," = vec4(").concat(i,", 0., 0., 0.);\n      }\n    ")}}class Ym{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ym();this.outputShape=t,this.enableShapeUniforms=jm(this.outputShape.length);let r="",i="result";e&&(i="floor(result * 255. + 0.5)");for(let a=0;a<=1;a++)for(let e=0;e<=1;e++){const i=2*a+e;r+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(e," < ").concat(this.enableShapeUniforms?"outShape[2]":"".concat(t[2]),") {\n          localCoords[2] += ").concat(e,";\n          if (localCoords[1] + ").concat(a," < ").concat(this.enableShapeUniforms?"outShape[1]":"".concat(t[1]),") {\n            localCoords[1] += ").concat(a,";\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ").concat(n.texture2D,"(A, uv);\n\n            if (offset == 0) {\n              result[").concat(i,"] = values[0];\n            } else if (offset == 1) {\n              result[").concat(i,"] = values[1];\n            } else if (offset == 2) {\n              result[").concat(i,"] = values[2];\n            } else {\n              result[").concat(i,"] = values[3];\n            }\n          }\n        }\n        ")}this.userCode="\n        ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":wm(t),"\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ").concat(r,"\n\n          ").concat(n.output," = ").concat(i,";\n        }\n    ")}}function Xm(t){const e=ym();return function(t,e){const n=nm(t,(()=>t.createShader(t.VERTEX_SHADER)),"Unable to create vertex WebGLShader.");if(Gg(t,(()=>t.shaderSource(n,e))),Gg(t,(()=>t.compileShader(n))),!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(t,"".concat(e.version,"\n    precision highp float;\n    ").concat(e.attribute," vec3 clipSpacePos;\n    ").concat(e.attribute," vec2 uv;\n    ").concat(e.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function Km(t){return function(t,e){const n=nm(t,(()=>t.createBuffer()),"Unable to create WebGLBuffer");return Gg(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,n))),Gg(t,(()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW))),n}(t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function $m(t){return function(t,e){const n=nm(t,(()=>t.createBuffer()),"Unable to create WebGLBuffer");return Gg(t,(()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n))),Gg(t,(()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW))),n}(t,new Uint16Array([0,1,2,2,1,3]))}function Zm(t,e,n,r,i,a){!function(t,e){const n=(0,o.env)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const n="[".concat(t,"x").concat(e,"]");throw new Error("Requested texture size "+n+" is invalid.")}if(t>n||e>n){const r="[".concat(t,"x").concat(e,"]"),i="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+i+".")}}(e,n);const s=function(t){return nm(t,(()=>t.createTexture()),"Unable to create WebGLTexture.")}(t),c=t.TEXTURE_2D;return Gg(t,(()=>t.bindTexture(c,s))),Gg(t,(()=>t.texParameteri(c,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE))),Gg(t,(()=>t.texParameteri(c,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE))),Gg(t,(()=>t.texParameteri(c,t.TEXTURE_MIN_FILTER,t.NEAREST))),Gg(t,(()=>t.texParameteri(c,t.TEXTURE_MAG_FILTER,t.NEAREST))),1===(0,o.env)().getNumber("WEBGL_VERSION")?Gg(t,(()=>t.texImage2D(c,0,r,e,n,0,i,a,null))):Gg(t,(()=>t.texStorage2D(c,1,r,e,n))),Gg(t,(()=>t.bindTexture(t.TEXTURE_2D,null))),{texture:s,texShape:[n,e]}}function Qm(t){return t.internalFormatFloat}function Jm(t){return t.internalFormatHalfFloat}function ty(t){return t.downloadTextureFormat}function ey(t){return t.internalFormatPackedFloat}function ny(t){return t.internalFormatPackedHalfFloat}function ry(t,e,n,r,i,a,o,s){const c=t,u=new Float32Array(function(t,e){const[n,r]=Vg(t,e);return n*r*4}(a,o));return c.bindBuffer(c.PIXEL_PACK_BUFFER,e),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,u),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),u}class iy{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const e=(0,o.env)().getNumber("WEBGL_VERSION");if(null!=t?(this.gl=t,function(t,e){Rg[t]=e}(e,t)):this.gl=Bg(e),t=this.gl,2===(0,o.env)().getNumber("WEBGL_VERSION")){const e=t;this.createVertexArray=()=>Gg(e,(()=>e.createVertexArray())),this.bindVertexArray=t=>Gg(e,(()=>e.bindVertexArray(t))),this.deleteVertexArray=t=>Gg(e,(()=>e.deleteVertexArray(t))),this.getVertexArray=()=>Gg(e,(()=>e.getParameter(e.VERTEX_ARRAY_BINDING)))}else if(null!=t){const e=t.getExtension("OES_vertex_array_object");if(null==e)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Gg(t,(()=>e.createVertexArrayOES())),this.bindVertexArray=n=>Gg(t,(()=>e.bindVertexArrayOES(n))),this.deleteVertexArray=n=>Gg(t,(()=>e.deleteVertexArrayOES(n))),this.getVertexArray=()=>Gg(t,(()=>t.getParameter(e.VERTEX_ARRAY_BINDING_OES)))}let n="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===(0,o.env)().getNumber("WEBGL_VERSION")){const t="OES_texture_float",e="OES_texture_half_float";if(this.textureFloatExtension=Yg(this.gl,t),hm(this.gl,e))this.textureHalfFloatExtension=Yg(this.gl,e);else if((0,o.env)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),hm(this.gl,r))this.colorBufferHalfFloatExtension=Yg(this.gl,r);else if((0,o.env)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",hm(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!hm(this.gl,r))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(r)}this.vertexBuffer=Km(this.gl),this.indexBuffer=$m(this.gl),this.framebuffer=function(t){return nm(t,(()=>t.createFramebuffer()),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=qg(this.gl,this.textureHalfFloatExtension)}get debug(){return(0,o.env)().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;Gg(t,(()=>t.finish())),Gg(t,(()=>t.bindFramebuffer(t.FRAMEBUFFER,null))),Gg(t,(()=>t.deleteFramebuffer(this.framebuffer))),Gg(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,null))),Gg(t,(()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null))),Gg(t,(()=>t.deleteBuffer(this.indexBuffer))),this.disposed=!0}createFloat32MatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[i,a]=Ug(e,n);return Zm(t,i,a,Qm(r),r.textureFormatFloat,t.FLOAT)}(this.gl,t,e,this.textureConfig)}createFloat16MatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[i,a]=Ug(e,n);return Zm(t,i,a,Jm(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,t,e,this.textureConfig)}createUnsignedBytesMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[i,a]=Ug(e,n);return Zm(t,i,a,ty(r),t.RGBA,t.UNSIGNED_BYTE)}(this.gl,t,e,this.textureConfig)}uploadPixelDataToTexture(t,e){this.throwIfDisposed(),function(t,e,n){Gg(t,(()=>t.bindTexture(t.TEXTURE_2D,e))),n.data instanceof Uint8Array?2===(0,o.env)().getNumber("WEBGL_VERSION")?Gg(t,(()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data))):Gg(t,(()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data))):2===(0,o.env)().getNumber("WEBGL_VERSION")?Gg(t,(()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n))):Gg(t,(()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n))),Gg(t,(()=>t.bindTexture(t.TEXTURE_2D,null)))}(this.gl,t,e)}uploadDenseMatrixToTexture(t,e,n,r){this.throwIfDisposed(),function(t,e,n,r,i,a){let s,c,u;Gg(t,(()=>t.bindTexture(t.TEXTURE_2D,e))),i instanceof Uint8Array?(s=new Uint8Array(n*r*4),c=t.UNSIGNED_BYTE,u=t.RGBA):(s=new Float32Array(n*r*4),c=t.FLOAT,u=a.internalFormatPackedFloat),s.set(i),2===(0,o.env)().getNumber("WEBGL_VERSION")?Gg(t,(()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,c,s))):Gg(t,(()=>t.texImage2D(t.TEXTURE_2D,0,u,n,r,0,t.RGBA,c,s))),Gg(t,(()=>t.bindTexture(t.TEXTURE_2D,null)))}(this.gl,t,e,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[i,a]=Vg(e,n);return Zm(t,i,a,ny(r),t.RGBA,r.textureTypeHalfFloat)}(this.gl,t,e,this.textureConfig)}createPackedMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[i,a]=Vg(e,n);return Zm(t,i,a,ey(r),t.RGBA,t.FLOAT)}(this.gl,t,e,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(tm(this.gl,this.framebuffer),this.outputTexture=null),Gg(this.gl,(()=>this.gl.deleteTexture(t)))}downloadByteEncodedFloatMatrixFromOutputTexture(t,e,n){return this.downloadMatrixDriver(t,(()=>function(t,e,n,r){const[i,a]=Ug(e,n),o=new Uint8Array(e*n*4);return Gg(t,(()=>t.readPixels(0,0,i,a,r.downloadTextureFormat,t.UNSIGNED_BYTE,o))),new Float32Array(o.buffer)}(this.gl,e,n,this.textureConfig)))}downloadPackedMatrixFromBuffer(t,e,n,r,i,a){return ry(this.gl,t,0,0,0,i,a,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,e){return function(t,e,n){const r=t,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}(this.gl,t,e)}createBufferFromTexture(t,e,n){this.bindTextureToFrameBuffer(t);const r=function(t,e,n,r){const i=t.createBuffer();Gg(t,(()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,i)));const a=16*e*n;return Gg(t,(()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ))),Gg(t,(()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0))),Gg(t,(()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null))),i}(this.gl,e,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let e,n;if((0,o.env)().getBool("WEBGL_FENCE_API_ENABLED")){const r=t,i=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=()=>{const t=r.clientWaitSync(i,0,0);return t===r.ALREADY_SIGNALED||t===r.CONDITION_SATISFIED},e=i}else(0,o.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(e,(0,o.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:e,isFencePassed:n}}downloadMatrixFromPackedTexture(t,e,n){return this.downloadMatrixDriver(t,(()=>function(t,e,n){const r=new Float32Array(e*n*4);return Gg(t,(()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r))),r}(this.gl,e,n)))}createProgram(t){this.throwIfDisposed();const e=this.gl;null==this.vertexShader&&(this.vertexShader=Xm(e));const n=function(t){return nm(t,(()=>t.createProgram()),"Unable to create WebGLProgram.")}(e);Gg(e,(()=>e.attachShader(n,this.vertexShader))),Gg(e,(()=>e.attachShader(n,t))),function(t,e){if(Gg(t,(()=>t.linkProgram(e))),!(0,o.env)().get("ENGINE_COMPILE_ONLY")&&!1===t.getProgramParameter(e,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}(e,n);const r=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&$g(e,r),r}buildVao(t){this.setProgram(t),this.bindVertexArray(t.vao);const e=this.gl;Gg(e,(()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer))),function(t,e,n){Gg(t,(()=>t.bindBuffer(t.ARRAY_BUFFER,n))),Zg(t,e,"clipSpacePos",n,3,20,0)&&Zg(t,e,"uv",n,2,20,12)}(e,t,this.vertexBuffer)}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&(Gg(this.gl,(()=>this.gl.deleteProgram(t))),this.deleteVertexArray(t.vao))}setProgram(t){this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&$g(this.gl,this.program),Gg(this.gl,(()=>this.gl.useProgram(t)))}getUniformLocation(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?function(t,e,n){return nm(t,(()=>t.getUniformLocation(e,n)),'uniform "'+n+'" not present in program.')}(this.gl,t,e):function(t,e,n){return t.getUniformLocation(e,n)}(this.gl,t,e)}getAttributeLocation(t,e){return this.throwIfDisposed(),Gg(this.gl,(()=>this.gl.getAttribLocation(t,e)))}getUniformLocationNoThrow(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)}setInputMatrixTexture(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),Qg(this.gl,t,e,n)}setOutputMatrixTexture(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)}setOutputPackedMatrixTexture(t,e,n){this.throwIfDisposed();const[r,i]=Vg(e,n);this.setOutputMatrixTextureDriver(t,r,i)}setOutputMatrixWriteRegion(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)}setOutputPackedMatrixWriteRegion(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&$g(this.gl,this.program),em(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;if(this.debug){const t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Gg(t,(()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Gg(this.gl,(()=>this.gl.finish()))}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=Yg(this.gl,2===(0,o.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===(0,o.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}const t=this.getQueryTimerExtensionWebGL1(),e=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,e),e}endQuery(){if(2===(0,o.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2();return void t.endQuery(e.TIME_ELAPSED_EXT)}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await o.util.repeatedTry((()=>this.disposed||this.isQueryAvailable(t,(0,o.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")))),this.getQueryTime(t,(0,o.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,e){if(0===e)return null;if(2===e){const e=this.gl;return e.getQueryParameter(t,e.QUERY_RESULT)/1e6}{const e=this.getQueryTimerExtensionWebGL1();return e.getQueryObjectEXT(t,e.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,e){if(0===e)return!0;if(2===e){const e=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=e.getQueryParameter(t,e.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}{const e=this.getQueryTimerExtensionWebGL1(),n=e.getQueryObjectEXT(t,e.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(e.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(t){return new Promise((e=>{this.addItemToPoll((()=>t.isFencePassed()),(()=>e()))}))}pollItems(){const t=function(t){let e=0;for(;e<t.length;++e){if(!t[e]())break}return e-1}(this.itemsToPoll.map((t=>t.isDoneFn)));for(let e=0;e<=t;++e){const{resolveFn:t}=this.itemsToPoll[e];t()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,e){if(this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in(0,o.env)().platform&&(n=(0,o.env)().platform.setTimeoutCustom.bind((0,o.env)().platform)),o.util.repeatedTry((()=>(this.pollItems(),0===this.itemsToPoll.length)),(()=>0),null,n)}bindTextureToFrameBuffer(t){this.throwIfDisposed(),Jg(this.gl,t,this.framebuffer),this.debug&&em(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(Jg(this.gl,this.outputTexture,this.framebuffer),this.debug&&em(this.gl)):tm(this.gl,this.framebuffer)}downloadMatrixDriver(t,e){this.bindTextureToFrameBuffer(t);const n=e();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(t,e,n){this.throwIfDisposed();const r=this.gl;Jg(r,t,this.framebuffer),this.debug&&em(r),this.outputTexture=t,Gg(r,(()=>r.viewport(0,0,e,n))),Gg(r,(()=>r.scissor(0,0,e,n)))}setOutputMatrixWriteRegionDriver(t,e,n,r){this.throwIfDisposed(),Gg(this.gl,(()=>this.gl.scissor(t,e,n,r)))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}const{addImpl:ay,bincountImpl:oy,bincountReduceImpl:sy,bitwiseAndImpl:cy,castImpl:uy,ceilImpl:ly,concatImpl:hy,equalImpl:dy,expImpl:fy,expm1Impl:py,floorImpl:gy,gatherNdImpl:my,gatherV2Impl:yy,greaterImpl:vy,greaterEqualImpl:by,lessImpl:xy,lessEqualImpl:wy,linSpaceImpl:ky,logImpl:_y,maxImpl:Sy,maximumImpl:Ay,minimumImpl:Cy,multiplyImpl:Ey,negImpl:Ty,notEqualImpl:Ny,prodImpl:Dy,raggedGatherImpl:Fy,raggedRangeImpl:Iy,raggedTensorToTensorImpl:My,rangeImpl:Oy,rsqrtImpl:Ry,scatterImpl:zy,sigmoidImpl:By,simpleAbsImpl:Ly,sliceImpl:Py,sparseFillEmptyRowsImpl:jy,sparseReshapeImpl:Uy,sparseSegmentReductionImpl:Wy,sqrtImpl:Vy,staticRegexReplaceImpl:qy,stridedSliceImpl:Gy,stringNGramsImpl:Hy,stringSplitImpl:Yy,stringToHashBucketFastImpl:Xy,subImpl:Ky,tileImpl:$y,topKImpl:Zy,transposeImpl:Qy,uniqueImpl:Jy}=t;function tv(t,e){return["x","y","z","w","u","v"].slice(0,e).map((e=>"".concat(t,".").concat(e)))}function ev(t,e){return 1===e?[t]:tv(t,e)}class nv{constructor(t){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=jm(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const t=ev("rc",this.rank),e=Mm(this.rank),n=this.getOutOfBoundsCondition(t),r=this.getSetup(t),i=this.getOutput(t);this.userCode="\n        void main() {\n          ".concat(e," rc = getOutputCoords();\n\n          if(").concat(n,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(r,"\n\n            setOutput(vec4(").concat(i,"));\n          }\n        }\n      ")}}getSourceCoordsArr(t){const e=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let i="".concat(0===n?"r":"rp1",", ").concat(0===r?"c":"cp1");for(let e=2;e<this.rank;e++)i="".concat(t[t.length-1-e],",")+i;e.push(i)}return e}getOutOfBoundsCondition(t){if(1===this.rank)return"rc > ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]);let e="";for(let n=this.rank-2;n<this.rank;n++)e+="".concat(t[n]," >= ").concat(this.enableShapeUniforms?"outShape[".concat(n,"]"):this.outputShape[n]),n<this.rank-1&&(e+="||");return e}getSetup(t){if(1===this.rank)return"";const e=t.slice(-2),n=this.enableShapeUniforms?"outShape[".concat(this.rank," - 1]"):this.outputShape[this.rank-1],r=this.enableShapeUniforms?"outShape[".concat(this.rank," - 2]"):this.outputShape[this.rank-2];return"\n      int r = ".concat(e[0],";\n      int c = ").concat(e[1],";\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ").concat(n,";\n      bool rEdge = rp1 >= ").concat(r,";\n    ")}getOutput(t){const e=this.getSourceCoordsArr(t);if(1===this.rank){const t=this.enableShapeUniforms?"outShape":this.outputShape[0];return"getA(rc), (rc + 1 >= ".concat(t," ? 0. : getA(rc + 1)), 0, 0")}return"getA(".concat(e[0],"),\n            cEdge ? 0. : getA(").concat(e[1],"),\n            rEdge ? 0. : getA(").concat(e[2],"),\n            rEdge || cEdge ? 0. : getA(").concat(e[3],")")}}class rv{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=jm(this.outputShape.length);let n="";for(let r=0;r<4;r++){let t="thisRC = rc;";r%2===1&&(t+="thisRC.z += 1;"),r>1&&(t+="thisRC.y += 1;"),n+="\n        ".concat(t,"\n        ").concat(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(r,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(r>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(t,e){const n=e?xm(["r","c","d"],"inputShape"):vm(["r","c","d"],t);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,this.enableShapeUniforms),"\n      ").concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":wm(t),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(this.enableShapeUniforms?"outShape[1]":t[1],";\n        int cols = ").concat(this.enableShapeUniforms?"outShape[2]":t[2],";\n\n        ").concat(n,"\n\n        setOutput(result);\n      }\n    ")}}class iv{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(t,e,n){const r=ov(e,n),i=sv(t,r,n);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const a=av(t,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=a,this.log();const t=this.freeTextures[i].pop();return this.usedTextures[i].push(t),t}let o;return r===jg.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):r===jg.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):r===jg.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):r===jg.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):r===jg.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[i].push(o),this.numUsedTextures++,this._numBytesAllocated+=a,this.log(),o}releaseTexture(t,e,n,r){if(null==this.freeTextures)return;const i=ov(n,r),a=sv(e,i,r);a in this.freeTextures||(this.freeTextures[a]=[]);const s=av(e,i,this.gpgpu.gl,this.gpgpu.textureConfig,r),c=(0,o.env)().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==c&&this._numBytesAllocated>c?(this.gpgpu.deleteMatrixTexture(t.texture),this._numBytesAllocated-=s):(this.freeTextures[a].push(t),this.numFreeTextures++,this._numBytesFree+=s),this.numUsedTextures--;const u=this.usedTextures[a],l=u&&u.indexOf(t);if(null==l||l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[l]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(t,")"));const e=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*e),"%)"))}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const t in this.freeTextures)this.freeTextures[t].forEach((t=>{this.gpgpu.deleteMatrixTexture(t.texture)}));for(const t in this.usedTextures)this.usedTextures[t].forEach((t=>{this.gpgpu.deleteMatrixTexture(t.texture)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function av(t,e,n,r,i){const a=function(t,e){switch(t){case jg.PACKED_2X2_FLOAT32:return ey(e);case jg.PACKED_2X2_FLOAT16:return ny(e);case jg.UNPACKED_FLOAT32:return Qm(e);case jg.UNPACKED_FLOAT16:return Jm(e);case jg.PACKED_4X1_UNSIGNED_BYTE:return ty(e);default:throw new Error("Unknown physical texture type ".concat(t))}}(e,r);let o;if(i){const[e,n]=Vg(t[0],t[1]);o=e*n}else{const[e,n]=Ug(t[0],t[1]);o=e*n}const s=function(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error("Unknown internal format ".concat(e))}(n,a);return o*s}function ov(t,e){if(t===Pg.UPLOAD)return jg.PACKED_2X2_FLOAT32;if(t===Pg.RENDER||null==t)return function(t){return(0,o.env)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?jg.PACKED_2X2_FLOAT32:jg.UNPACKED_FLOAT32:t?jg.PACKED_2X2_FLOAT16:jg.UNPACKED_FLOAT16}(e);if(t===Pg.DOWNLOAD||t===Pg.PIXELS)return jg.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(t))}function sv(t,e,n){return"".concat(t[0],"_").concat(t[1],"_").concat(e,"_").concat(n)}class cv{constructor(t,e){this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=jm(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}const uv="if (isnan(x)) return x;",lv="return x;",hv="return abs(x);";const dv="return (x >= 0.0) ? x : (exp(x) - 1.0);",fv=uv+"\n  return (x < 0.0) ? 0.0 : x;\n",pv=uv+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",gv="return x;",mv="return 1.0 / (1.0 + exp(-1.0 * x));",yv="return x;",vv="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",bv="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",xv="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",wv="return 1.0 / (1.0 + exp(-1.0 * x));";class kv{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=jm(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(e,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}class _v{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=jm(this.outputShape.length);const e=t.length,n=ev("rc",e),r=Mm(e),i=function(t,e){if(1===t)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}(e,n),a=n.slice(-2),o=e<=1?"rc":"vec2(".concat(a.join(","),")");this.userCode="\n      void main() {\n        ".concat(r," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(i,");\n\n        setOutput(getChannel(packedInput, ").concat(o,"));\n      }\n    ")}}const Sv=o.kernel_impls.whereImpl,Av={};const Cv=(0,o.env)().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");class Ev extends o.KernelBackend{nextDataId(){return Ev.nextDataId++}constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!(0,o.env)().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let e;if(null!=t){if(t instanceof iy)e=t;else{const n=Bg((0,o.env)().getNumber("WEBGL_VERSION"),t);e=new iy(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const t=Bg((0,o.env)().getNumber("WEBGL_VERSION"));e=new iy(t),this.binaryCache=((n=(0,o.env)().getNumber("WEBGL_VERSION"))in Av||(Av[n]={}),Av[n]),this.gpgpuCreatedLocally=!0}var n;this.gpgpu=e,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new iv(this.gpgpu),this.numMBBeforeWarning=null==(0,o.env)().global.screen?1024:(0,o.env)().global.screen.height*(0,o.env)().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new o.DataStorage(this,(0,o.engine)())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(t,e,n,r,i,a){const o=this.makeTensorInfo(e,n),s=this.texData.get(o.dataId);s.isPacked=!1,s.texture={texture:t,texShape:[r,i]},s.texShape=[r,i];const c=om(e),u=new Hm(c,!1,a),l=this.runWebGLProgram(u,[o],n,[[r,i]]);return l.shape=e,s.texture=null,this.disposeIntermediateTensorInfo(o),l.dataId}write(t,e,n){if(((0,o.env)().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||(0,o.env)().getBool("DEBUG"))&&this.checkNumericalProblems(t),"complex64"===n&&null!=t)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:e,dtype:n,values:t,usage:Pg.UPLOAD,refCount:1}),r}refCount(t){if(this.texData.has(t)){return this.texData.get(t).refCount}return 0}incRef(t){this.texData.get(t).refCount++}decRef(t){if(this.texData.has(t)){this.texData.get(t).refCount--}}move(t,e,n,r,i){if((0,o.env)().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:n,dtype:r,values:e,usage:Pg.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}readSync(t){const e=this.texData.get(t),{values:n,dtype:r,complexTensorInfos:i,slice:a,shape:s,isPacked:c}=e;if(null!=a){let e;e=c?new kv(s,gv):new cv(s,gv);const n=this.runWebGLProgram(e,[{dataId:t,shape:s,dtype:r}],r),i=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),i}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===r)return n;const u=null!=this.activeTimers;let l,h;if(u&&(l=o.util.now()),"complex64"===r){const t=this.readSync(i.real.dataId),e=this.readSync(i.imag.dataId);h=o.backend_util.mergeRealAndImagArrays(t,e)}else h=this.getValuesFromTexture(t);return u&&(this.downloadWaitMs+=o.util.now()-l),this.convertAndCacheOnCPU(t,h)}async read(t){if(this.pendingRead.has(t)){const e=this.pendingRead.get(t);return new Promise((t=>e.push(t)))}const e=this.texData.get(t),{values:n,shape:r,slice:i,dtype:a,complexTensorInfos:s,isPacked:c}=e;if(null!=i){let e;e=c?new kv(r,gv):new cv(r,gv);const n=this.runWebGLProgram(e,[{dataId:t,shape:r,dtype:a}],a),i=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),i}if(null!=n)return this.convertAndCacheOnCPU(t);if((0,o.env)().getBool("DEBUG")&&!(0,o.env)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===(0,o.env)().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u,l,h=null;if("complex64"!==a&&(0,o.env)().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(t);const e=this.texData.get(u.dataId);h=this.gpgpu.createBufferFromTexture(e.texture.texture,...Wg(r))}if(this.pendingRead.set(t,[]),"complex64"!==a&&await this.gpgpu.createAndWaitForFence(),"complex64"===a){const t=await Promise.all([this.read(s.real.dataId),this.read(s.imag.dataId)]),e=t[0],n=t[1];l=o.backend_util.mergeRealAndImagArrays(e,n)}else if(null==h)l=this.getValuesFromTexture(t);else{const t=o.util.sizeFromShape(r);l=this.gpgpu.downloadFloat32MatrixFromBuffer(h,t)}if(null!=u&&this.disposeIntermediateTensorInfo(u),null!=h){const t=this.gpgpu.gl;Gg(t,(()=>t.deleteBuffer(h)))}const d=this.convertAndCacheOnCPU(t,l),f=this.pendingRead.get(t);return this.pendingRead.delete(t),f.forEach((t=>t(d))),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&(0,o.engine)().removeDataId(t,this),this.pendingDeletes--),d}readToGPU(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.texData.get(t),{values:r,shape:i,slice:a,dtype:s,isPacked:c,texture:u}=n;if("complex64"===s)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=a){let n;n=c?new kv(i,gv):new cv(i,gv);const r=this.runWebGLProgram(n,[{dataId:t,shape:i,dtype:s}],s),a=this.readToGPU(r,e);return this.disposeIntermediateTensorInfo(r),a}if(null==u)throw null!=r?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const l=this.decode(t,e.customTexShape),h=(0,o.engine)().makeTensorFromTensorInfo(l),d=this.texData.get(l.dataId);return Object.assign({tensorRef:h},d.texture)}bufferSync(t){const e=this.readSync(t.dataId);if("string"===t.dtype)try{const n=e.map((t=>o.util.decodeString(t)));return(0,o.buffer)(t.shape,t.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return(0,o.buffer)(t.shape,t.dtype,e)}checkNumericalProblems(t){if(null!=t)for(let e=0;e<t.length;e++){const n=t[e];if(!Hg(n)){if((0,o.env)().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}getValuesFromTexture(t){const{shape:e,dtype:n,isPacked:r}=this.texData.get(t),i=o.util.sizeFromShape(e);if((0,o.env)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const n=this.decode(t),r=this.texData.get(n.dataId),a=this.gpgpu.downloadMatrixFromPackedTexture(r.texture.texture,...Wg(e)).subarray(0,i);return this.disposeIntermediateTensorInfo(n),a}const a=(0,o.env)().getBool("WEBGL_PACK")&&!0===r,s=a?om(e):e,c=a?new qm(s):new Vm(s),u=this.runWebGLProgram(c,[{shape:s,dtype:n,dataId:t}],"float32"),l=this.texData.get(u.dataId),h=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(l.texture.texture,l.texShape[0],l.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(u),h}timerAvailable(){return(0,o.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(t){const e=this.activeTimers,n=[];let r=!1;null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,t();const i=o.util.flatten(this.activeTimers.map((t=>t.query))).filter((t=>null!=t)),a=o.util.flatten(this.activeTimers.map((t=>t.name))).filter((t=>null!=t));this.activeTimers=e,r&&(this.programTimersStack=null);const s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if((0,o.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const t=await Promise.all(i);s.kernelMs=o.util.sum(t),s.getExtraProfileInfo=()=>t.map(((t,e)=>({name:a[e],ms:t}))).map((t=>"".concat(t.name,": ").concat(t.ms))).join(", ")}else s.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,s})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return(0,o.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:o.util.now(),endMs:null}}endTimer(t){return(0,o.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=o.util.now(),t)}async getQueryTime(t){if((0,o.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);const e=t;return e.endMs-e.startMs}disposeData(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(t))return!1;if(!this.texData.has(t))return!0;if(e?this.texData.get(t).refCount=0:this.texData.get(t).refCount--,!e&&this.texData.get(t).refCount>0)return!1;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),this.pendingDeletes++,!1;this.releaseGPUData(t);const{complexTensorInfos:n}=this.texData.get(t);return null!=n&&(this.disposeData(n.real.dataId,e),this.disposeData(n.imag.dataId,e)),this.texData.delete(t),!0}releaseGPUData(t){const{texture:e,dtype:n,texShape:r,usage:i,isPacked:a,slice:o}=this.texData.get(t),s=o&&o.origDataId||t,c=this.dataRefCount.get(s);c>1?this.dataRefCount.set(s,c-1):(this.dataRefCount.delete(s),null!=e&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(e,r,i,a)));const u=this.texData.get(t);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture.texture}getDataInfo(t){return this.texData.get(t)}shouldExecuteOnCPU(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Cv;return(0,o.env)().getBool("WEBGL_CPU_FORWARD")&&t.every((t=>null==this.texData.get(t.dataId).texture&&o.util.sizeFromShape(t.shape)<e))}getGPGPUContext(){return this.gpgpu}where(t){o.backend_util.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const e=t.dataSync();return Sv(t.shape,e)}packedUnaryOp(t,e,n){const r=new kv(t.shape,e),i=this.compileAndRun(r,[t],n);return(0,o.engine)().makeTensorFromTensorInfo(i)}abs(t){if(this.shouldExecuteOnCPU([t])&&"complex64"!==t.dtype){const e=Ly(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,e)}if((0,o.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,hv,t.dtype);const e=new cv(t.shape,hv),n=this.compileAndRun(e,[t]);return(0,o.engine)().makeTensorFromTensorInfo(n)}makeTensorInfo(t,e,n){let r;if("string"===e&&null!=n&&n.length>0&&o.util.isString(n[0])){const i=n.map((t=>o.util.encodeString(t)));r=this.write(i,t,e)}else r=this.write(n,t,e);return this.texData.get(r).usage=null,{dataId:r,shape:t,dtype:e}}makeOutput(t,e,n){return(0,o.engine)().makeTensorFromTensorInfo(this.makeTensorInfo(t,e,n),this)}unpackTensor(t){const e=new _v(t.shape);return this.runWebGLProgram(e,[t],t.dtype)}packTensor(t){const e=new nv(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)}packedReshape(t,e){const n=[im(t.shape),...am(t.shape)],r={dtype:t.dtype,shape:n,dataId:t.dataId},i=[im(e),...am(e)],a=new rv(i,n),o=[n],s=this.runWebGLProgram(a,[r],t.dtype,o,!0);return{dataId:s.dataId,shape:e,dtype:s.dtype}}decode(t,e){const n=this.texData.get(t),{isPacked:r,shape:i,dtype:a}=n;if(null!=e){const t=o.util.sizeFromShape(i),n=e[0]*e[1]*4;o.util.assert(t<=n,(()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data."))}const s=om(i);let c;c=r?new Wm(s):new Um(s);const u=[null!=e?e:Wg(s)];return{dtype:a,shape:i,dataId:this.runWebGLProgram(c,[{shape:s,dtype:a,dataId:t}],a,u,!0,e).dataId}}runWebGLProgram(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5?arguments[5]:void 0;const s=this.makeTensorInfo(t.outputShape,n),c=this.texData.get(s.dataId);if(t.packedOutput&&(c.isPacked=!0),t.outPackingScheme===Lg.DENSE){const e=null!=a?a:Wg(t.outputShape);c.texShape=e.map((t=>2*t))}if(null!=t.outTexUsage&&(c.usage=t.outTexUsage),0===o.util.sizeFromShape(s.shape))return c.values=o.util.getTypedArrayFromDType(s.dtype,0),s;const u=[],l=e.map((e=>{if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(e.dataId);if(null==n.texture){if(!t.packedInputs&&o.util.sizeFromShape(e.shape)<=(0,o.env)().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.packedInputs&&(n.isPacked=!0,n.shape=e.shape)}if(this.uploadToGPU(e.dataId),!!n.isPacked!==!!t.packedInputs)e=n.isPacked?this.unpackTensor(e):this.packTensor(e),u.push(e),n=this.texData.get(e.dataId);else if(n.isPacked&&!cm(n.shape,e.shape)){const t=e,r=e.shape;e.shape=n.shape,e=this.packedReshape(e,r),u.push(e),n=this.texData.get(e.dataId),t.shape=r}return{shape:e.shape,texData:n,isUniform:!1}}));this.uploadToGPU(s.dataId);const h={shape:s.shape,texData:c,isUniform:!1},d=function(t,e,n){let r="";e.concat(n).forEach((e=>{const i=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!e.isUniform){const a=e.texData.texShape,{useSqueezeShape:s,uniformShape:c,keptDims:u}=Om(t.packedInputs,e.shape,a);let l="",h="",d="";if(1===c.length&&t.packedInputs){const t=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];l="".concat(t[0]>1,"_").concat(t[1]>1)}else if(2!==c.length||t.packedInputs){if(c.length>2&&!t.packedInputs){const t=o.util.computeStrides(c);d="".concat(t[0]===a[1],"_").concat(t[t.length-1]===a[1])}}else h="".concat(c[0]>1,"_").concat(c[1]>1);const f=e.shape.length,p=2===c.length&&o.util.arraysEqual(e.shape,a),g=1===o.util.sizeFromShape(e.shape),m=o.backend_util.getBroadcastDims(e.shape,n.shape),y=!t.packedInputs&&f===n.shape.length&&o.util.arraysEqual(a,n.texData.texShape),v=t.packedInputs||c.length>2?"":"".concat(a[0]>1,"_").concat(a[1]>1);r+="".concat(f,"_").concat(y,"_").concat(s?u:"","_").concat(c.length,"_").concat(g,"_").concat(m,"_").concat(p,"_").concat(l,"_").concat(h,"_").concat(d,"_").concat(v,"_").concat(i)}else{const t=e.isUniform?"uniform":e.texData.texShape;r+="".concat(e.shape,"_").concat(t,"_").concat(i)}}));const i=t.userCode;let a=t.constructor.name;return a+="_"+r+"_"+i+"".concat((0,o.env)().getNumber("WEBGL_VERSION")),a}(t,l,h),f=this.getAndSaveBinary(d,(()=>Bm(this.gpgpu,t,l,h))),p=null!=this.activeTimers;let g;p&&(g=this.startTimer()),(0,o.env)().get("ENGINE_COMPILE_ONLY")||function(t,e,n,r,i){e.program.enableShapeUniforms||(Pm(e.inShapeInfos,n),Pm([e.outShapeInfo],[r]));const a=r.texData.texture,s=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(a.texture,s[0],s[1]):t.setOutputMatrixTexture(a.texture,s[0],s[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),1===(0,o.env)().getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN);for(let u=0;u<n.length;++u){const r=n[u],{uniform:i,offset:a,shape:s,texShape:c}=e.variablesLocations[u];if(s){const{uniformShape:n}=Om(e.program.packedInputs,r.shape,r.texData.texShape);switch(n.length){case 1:t.gl.uniform1iv(s,new Int32Array(n));break;case 2:t.gl.uniform2iv(s,new Int32Array(n));break;case 3:t.gl.uniform3iv(s,new Int32Array(n));break;case 4:t.gl.uniform4iv(s,new Int32Array(n))}}if(c&&t.gl.uniform2i(c,r.texData.texShape[0],r.texData.texShape[1]),null!=i)if(r.isUniform)if(o.util.sizeFromShape(r.shape)<2)t.gl.uniform1f(i,r.uniformValues[0]);else{let e=r.uniformValues;e instanceof Float32Array||(e=new Float32Array(e)),t.gl.uniform1fv(i,e)}else null!=r.texData.slice&&null!=a&&t.gl.uniform1i(a,r.texData.slice.flatOffset),t.setInputMatrixTexture(r.texData.texture.texture,i,u)}const c=e.outShapeLocation;if(c)switch(r.shape.length){case 1:t.gl.uniform1iv(c,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(c,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(c,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(c,new Int32Array(r.shape))}if(e.outShapeStridesLocation){const n=o.util.computeStrides(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(n));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(n));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(n))}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&i)for(let o=0;o<e.program.customUniforms.length;++o){const n=e.program.customUniforms[o],r=e.customUniformLocations[o],a=i[o];if("float"===n.type)t.gl.uniform1fv(r,a);else if("vec2"===n.type)t.gl.uniform2fv(r,a);else if("vec3"===n.type)t.gl.uniform3fv(r,a);else if("vec4"===n.type)t.gl.uniform4fv(r,a);else if("int"===n.type)t.gl.uniform1iv(r,a);else if("ivec2"===n.type)t.gl.uniform2iv(r,a);else if("ivec3"===n.type)t.gl.uniform3iv(r,a);else{if("ivec4"!==n.type)throw Error("uniform type ".concat(n.type," is not supported yet."));t.gl.uniform4iv(r,a)}}t.executeProgram()}(this.gpgpu,f,l,h,r),u.forEach((t=>this.disposeIntermediateTensorInfo(t))),p&&(g=this.endTimer(g),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(g)}));const m=(0,o.env)().getNumber("WEBGL_FLUSH_THRESHOLD");if(m>0){const t=o.util.now();t-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=t)}if(!(0,o.env)().getBool("WEBGL_LAZILY_UNPACK")&&c.isPacked&&!1===i){const t=this.unpackTensor(s);return this.disposeIntermediateTensorInfo(s),t}return s}compileAndRun(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||e[0].dtype;return this.runWebGLProgram(t,e,n,r,i)}getAndSaveBinary(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){if(!this.disposed){if(!(0,o.env)().getBool("IS_TEST")){Object.keys(this.binaryCache).forEach((t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}))}this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=(0,o.tidy)((()=>{if(!(0,o.env)().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=(0,o.env)().getBool("DEBUG");(0,o.env)().set("DEBUG",!1);const e=this.abs((0,o.scalar)(1e-8)).dataSync()[0];if((0,o.env)().set("DEBUG",t),e>0)return 32}return 16}))),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(t){const e=this.texData.get(t),{shape:n,dtype:r,values:i,texture:a,usage:s,isPacked:c}=e;if(null!=a)return;const u=null!=this.activeTimers;let l;u&&(l=o.util.now());let h=e.texShape;if(null==h&&(h=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(0,o.env)().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=(0,o.env)().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(r===1/0&&(0,o.env)().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n*=2,r*=2,1===(t=t.map(((e,n)=>n>=t.length-2?o.util.nearestLargerEven(t[n]):t[n]))).length&&(t=[2,t[0]])),2!==t.length){const e=o.util.squeezeShape(t);t=e.newShape}let i=o.util.sizeFromShape(t),a=null;t.length<=1&&i<=n?a=[1,i]:2===t.length&&t[0]<=n&&t[1]<=n?a=t:3===t.length&&t[0]*t[1]<=n&&t[2]<=n?a=[t[0]*t[1],t[2]]:3===t.length&&t[0]<=n&&t[1]*t[2]<=n?a=[t[0],t[1]*t[2]]:4===t.length&&t[0]*t[1]*t[2]<=n&&t[3]<=n?a=[t[0]*t[1]*t[2],t[3]]:4===t.length&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(a=[t[0],t[1]*t[2]*t[3]]);const s=null!=a&&Math.max(...a)>r&&Math.min(...a)<=(e?2:1)&&Math.min(...a)>0;if(null==a||s)if(e){const e=im(t);let n=2,r=2;t.length&&([n,r]=am(t)),i=e*(n/2)*(r/2),a=o.util.sizeToSquarishShape(i).map((t=>2*t))}else a=o.util.sizeToSquarishShape(i);return a}(n,c),e.texShape=h),null!=i){const t=om(n);let a,s=h[1],d=h[0];const f=i instanceof Uint8Array||i instanceof Uint8ClampedArray;!c&&f||([s,d]=Vg(h[0],h[1])),a=c?new Ym(t,f):new Hm(t,f);const p=f?[d,s]:h,g=this.makeTensorInfo(p,r),m=this.texData.get(g.dataId);m.usage=f?Pg.PIXELS:Pg.UPLOAD,m.texShape=p,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),s,d,i);const y=[[d,s]],v=!0,b=this.runWebGLProgram(a,[g],r,y,v),x=this.texData.get(b.dataId);e.texShape=x.texShape,e.isPacked=x.isPacked,e.usage=x.usage,(0,o.env)().get("ENGINE_COMPILE_ONLY")?this.disposeData(b.dataId):(e.texture=x.texture,e.values=null,this.texData.delete(b.dataId)),this.disposeIntermediateTensorInfo(g),u&&(this.uploadWaitMs+=o.util.now()-l)}else{const t=this.acquireTexture(h,s,r,c);e.texture=t}}convertAndCacheOnCPU(t,e){const n=this.texData.get(t),{dtype:r}=n;return null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){const n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length);for(let e=0;e<n.length;++e)n[e]=Math.round(t[e]);return n}throw new Error("Unknown dtype ".concat(e))}(e,r)),n.values}acquireTexture(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const t=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(t," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(t,e,r)}computeBytes(t,e){return t[0]*t[1]*o.util.bytesPerElement(e)}checkCompileCompletion(){for(const[,t]of Object.entries(this.binaryCache))this.checkCompletion_(t)}async checkCompileCompletionAsync(){const t=[];if(this.gpgpu.parallelCompilationExtension){for(const[,e]of Object.entries(this.binaryCache))t.push(this.checkCompletionAsync_(e));return Promise.all(t)}for(const[,e]of Object.entries(this.binaryCache)){const n=new Promise((t=>{try{this.checkCompletion_(e),t(!0)}catch(n){throw n}}));t.push(n)}return Promise.all(t)}async checkCompletionAsync_(t){return this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(t):(await(0,o.nextFrame)(),this.checkCompletionAsync_(t))}checkCompletion_(t){if(!1===this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(t.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(t.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw Kg(t.source,this.gpgpu.gl.getShaderInfoLog(t.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0}getUniformLocations(){for(const t of Object.values(this.binaryCache)){this.gpgpu.buildVao(t.webGLProgram);const{variablesLocations:e,customUniformLocations:n,infLoc:r,nanLoc:i,outShapeLocation:a,outShapeStridesLocation:o,outTexShapeLocation:s}=Lm(this.gpgpu,t.program,t.webGLProgram);t.variablesLocations=e,t.customUniformLocations=n,t.infLoc=r,t.nanLoc=i,t.outShapeLocation=a,t.outShapeStridesLocation=o,t.outTexShapeLocation=s}}createTensorFromGPUData(t,e,n){t.channels=t.channels||"RGBA";const{texture:r,height:i,width:a,channels:s}=t,c=(0,o.engine)().backend;if(!c.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=c.writeTexture(r,e,n,i,a,s);return(0,o.engine)().makeTensorFromDataId(u,e,n,c)}}Ev.nextDataId=0;o.device_util.isBrowser()&&(0,o.registerBackend)("webgl",(()=>new Ev),2);const Tv="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n";class Nv{constructor(t,e,n){this.variableNames=["A","B"],this.outputShape=o.backend_util.assertAndGetBroadcastShape(e,n),this.enableShapeUniforms=jm(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")}}const Dv="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n";class Fv{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o.backend_util.assertAndGetBroadcastShape(e,n);const i=this.outputShape.length;this.enableShapeUniforms=jm(i);let a="";if(r)if(0===i||1===o.util.sizeFromShape(this.outputShape))a="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{const t=Mm(i);if(a="\n          ".concat(t," coords = getOutputCoords();\n        "),1===i)this.enableShapeUniforms?a+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":a+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{const t=ev("coords",i);this.enableShapeUniforms?a+="\n            bool nextRowOutOfBounds =\n              (".concat(t[i-2]," + 1) >= outShape[").concat(i," - 2];\n            bool nextColOutOfBounds =\n              (").concat(t[i-1]," + 1) >= outShape[").concat(i," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):a+="\n            bool nextRowOutOfBounds =\n              (".concat(t[i-2]," + 1) >= ").concat(this.outputShape[i-2],";\n            bool nextColOutOfBounds =\n              (").concat(t[i-1]," + 1) >= ").concat(this.outputShape[i-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(a,"\n\n        setOutput(result);\n      }\n    ")}}function Iv(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Mv={kernelName:o.Identity,backendName:"webgl",kernelFunc:Iv};function Ov(t){const{inputs:e,backend:n}=t,{real:r,imag:i}=e,a=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(a.dataId),s=Iv({inputs:{x:r},backend:n}),c=Iv({inputs:{x:i},backend:n});return o.complexTensorInfos={real:s,imag:c},a}const Rv={kernelName:o.Complex,backendName:"webgl",kernelFunc:Ov},zv="return (a < 0.) ? b * a : a;",Bv="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const Lv={kernelName:o.LeakyRelu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{alpha:a}=r,s=n.makeTensorInfo([],"float32",o.util.createScalarValue(a,"float32")),c=(0,o.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Fv(Bv,i.shape,s.shape):new Nv(zv,i.shape,s.shape),u=n.runWebGLProgram(c,[i,s],"float32");return n.disposeIntermediateTensorInfo(s),u}},Pv="return (a < 0.) ? b * a : a;",jv="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const Uv={kernelName:o.Prelu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r,alpha:i}=e,a=(0,o.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Fv(jv,r.shape,i.shape):new Nv(Pv,r.shape,i.shape);return n.runWebGLProgram(a,[r,i],"float32")}},Wv="if (isnan(x)) return x;";function Vv(t){let{opSnippet:e,packedOpSnippet:n,cpuKernelImpl:r,dtype:i}=t;return t=>{let{inputs:a,backend:s}=t;const{x:c}=a,u=s,l=i||c.dtype;if(u.shouldExecuteOnCPU([c])&&null!=r){const t=u.texData.get(c.dataId),e=r(t.values,l);return u.makeTensorInfo(c.shape,l,e)}let h;return h=(0,o.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new kv(c.shape,n):new cv(c.shape,e),u.runWebGLProgram(h,[c],l)}}function qv(t){let{opSnippet:e,packedOpSnippet:n,checkOutOfBounds:r=!1,supportsComplex:i=!1,cpuKernelImpl:a,dtype:s}=t;return t=>{let{inputs:c,backend:u}=t;const{a:l,b:h}=c,d=u;if(i&&"complex64"===l.dtype){const t=d.texData.get(l.dataId),n=d.texData.get(h.dataId),[r,i]=[[t.complexTensorInfos.real,n.complexTensorInfos.real],[t.complexTensorInfos.imag,n.complexTensorInfos.imag]].map((t=>{const[n,r]=t,i={dataId:n.dataId,dtype:n.dtype,shape:l.shape},a={dataId:r.dataId,dtype:r.dtype,shape:h.shape},s=new Nv(e,l.shape,h.shape);return d.runWebGLProgram(s,[i,a],(0,o.upcastType)(n.dtype,r.dtype))})),a=Ov({inputs:{real:r,imag:i},backend:d});return d.disposeIntermediateTensorInfo(r),d.disposeIntermediateTensorInfo(i),a}const f=s||(0,o.upcastType)(l.dtype,h.dtype);if(("string"===l.dtype||"string"===h.dtype||d.shouldExecuteOnCPU([l,h]))&&null!=a){const t=d.texData.get(l.dataId).values,e=d.texData.get(h.dataId).values,n="string"===l.dtype?o.backend_util.fromUint8ToStringArray(t):t,r="string"===l.dtype?o.backend_util.fromUint8ToStringArray(e):e,[i,s]=a(l.shape,h.shape,n,r,f),c=d.makeTensorInfo(s,f);return d.texData.get(c.dataId).values=i,c}let p;return p=(0,o.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new Fv(n,l.shape,h.shape,r):new Nv(e,l.shape,h.shape),d.runWebGLProgram(p,[l,h],f)}}function Gv(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===t)return e?yv:lv;if("relu"===t)return e?bv:fv;if("elu"===t)return e?vv:dv;if("relu6"===t)return e?xv:pv;if("prelu"===t)return e?jv:Pv;if("leakyrelu"===t)return e?Bv:zv;if("sigmoid"===t)return e?wv:mv;throw new Error("Activation ".concat(t," has not been implemented for the WebGL backend."))}class Hv{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=jm(this.outputShape.length);const u=r?t[1]:t[2],l=Math.ceil(u/2),h=r?"i * 2, rc.y":"rc.y, i * 2",d=i?"rc.z, i * 2":"i * 2, rc.z",f=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],p=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let g="",m="";o&&(g=s?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(o,"\n        }"):c?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(o,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(o,"\n        }"),m="result = activation(result);");const y=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let v="rc.x",b="rc.x";t[0]<e[0]?v="imod(rc.x, ".concat(t[0],")"):e[0]<t[0]&&(b="imod(rc.x, ".concat(e[0],")")),this.userCode="\n      ".concat(g,"\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ").concat(l,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ").concat(v,";\n        int batchB = ").concat(b,";\n        for (int i = 0; i < ").concat(l,"; i++) {\n          vec4 a = getMatrixA(batchA, ").concat(h,");\n          vec4 b = getMatrixB(batchB, ").concat(d,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(f[0]," * ").concat(p[0],");\n          result += (").concat(f[1]," * ").concat(p[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(y,"\n\n        ").concat(m,"\n\n        setOutput(result);\n      }\n    ")}}const Yv={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class Xv{constructor(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=o.backend_util.assertAndGetBroadcastShape(e,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")}}const Kv="return a * b;";function $v(t){const{inputs:e,backend:n}=t,{a:r,b:i}=e,a=o.backend_util.upcastType(r.dtype,i.dtype);if("complex64"===r.dtype){const t=n.texData.get(r.dataId),e=n.texData.get(i.dataId),a=new Xv(Yv.REAL,r.shape,i.shape),o=new Xv(Yv.IMAG,r.shape,i.shape),s=[{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:r.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:i.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:i.shape}],c=n.runWebGLProgram(a,s,"float32"),u=n.runWebGLProgram(o,s,"float32"),l=Ov({inputs:{real:c,imag:u},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),l}if(n.shouldExecuteOnCPU([r,i])){const t=n.texData.get(r.dataId),e=n.texData.get(i.dataId),[o,s]=Ey(r.shape,i.shape,t.values,e.values,a),c=n.makeTensorInfo(s,a);return n.texData.get(c.dataId).values=o,c}let s;return s=(0,o.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Fv(Kv,r.shape,i.shape):new Nv(Kv,r.shape,i.shape),n.runWebGLProgram(s,[r,i],a)}const Zv={kernelName:o.Multiply,backendName:"webgl",kernelFunc:$v};function Qv(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{shape:a}=r,s=n,c=o.util.sizeFromShape(i.shape),u=o.util.inferFromImplicitShape(a,c),l=o.util.sizeFromShape(u);o.util.assert(c===l,(()=>"The new shape (".concat(u,") has ").concat(l," elements and the old ")+"shape (".concat(i.shape,") has ").concat(c," elements. The new shape and old ")+"shape must have the same number of elements."));const h=s.texData.get(i.dataId);return!h.isPacked||cm(i.shape,u)||null!==h.texture&&cm(h.shape,u)?(s.incRef(i.dataId),{dataId:i.dataId,shape:u,dtype:i.dtype}):function(t,e,n){const r=[im(t.shape),...am(t.shape)],i={dtype:t.dtype,shape:r,dataId:t.dataId},a=[im(e),...am(e)],o=new rv(a,r),s=[r],c=n.runWebGLProgram(o,[i],t.dtype,s,!0);return{dataId:c.dataId,shape:e,dtype:c.dtype}}(i,u,s)}const Jv={kernelName:o.Reshape,backendName:"webgl",kernelFunc:Qv};class tb{constructor(t,e){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:i,outSize:a}=t;this.outputShape=[r,a];const s=4*Math.floor(n/4),c=n%4;let u="sumValue += dot(values, ones);";if(null!=e){const t=1/e;u="sumValue += dot(values * ".concat(o.util.isInt(t)?t.toPrecision(2):t,", ones);")}let l="";i%n>0&&(l="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(l,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(u,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===c,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(u,"\n        } else if (").concat(2===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(u,"\n        } else if (").concat(3===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(u,"\n        }\n        setOutput(sumValue);\n      }\n    ")}}class eb{constructor(t,e){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:i,outSize:a}=t;this.outputShape=[r,a];let o="0.0",s="";"prod"===e?o="1.0":"min"===e?(o="1.0 / 1e-20",s="min"):"max"===e&&(o="-1.0 / 1e-20",s="max");let c="".concat(e,"(").concat(e,"(").concat(e,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===e?c="sumValue":"prod"===e?c="prodValue":"all"===e?c="allValue":"any"===e&&(c="anyValue");const u=4*Math.floor(n/4),l=n%4;let h="\n      if (".concat("sum"===e,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===e,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(s,"(values, minMaxValue);\n        if (").concat("min"===e," || ").concat("max"===e,") {\n          minMaxValue = ").concat(s,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),d="vec4";"all"===e?(o="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===e&&(o="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");let f="";i%n>0&&(f="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(o,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(f,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        vec4 minMaxValue = vec4(").concat(o,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(u,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(h,"\n        }\n\n        int inIdx = inOffset + ").concat(u,";\n        if (").concat(1===l,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(h,"\n        } else if (").concat(2===l,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(h,"\n        } else if (").concat(3===l,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(h,"\n        }\n        setOutput(").concat(c,");\n      }\n    ")}}function nb(t,e,n,r){const i=function(t){const e=[];for(;0===e.length||1!==e[e.length-1].outSize;){const n=e.length?e[e.length-1].outSize:t[1],r=o.backend_util.computeOptimalWindowSize(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}(t.shape);let a=t;for(let o=0;o<i.length;o++){const{inSize:s,windowSize:c,outSize:u}=i[o];let l,h;l="mean"===n?0===o?new tb({windowSize:c,inSize:s,batchSize:t.shape[0],outSize:u},s):new tb({windowSize:c,inSize:s,batchSize:t.shape[0],outSize:u}):new eb({windowSize:c,inSize:s,batchSize:t.shape[0],outSize:u},n),h=a,a=r.runWebGLProgram(l,[a],e),h.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(h)}return a}class rb{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let a=0;a<n.length;a++)n[a]=t[e[a]];this.outputShape=n,this.rank=n.length;const r=Mm(this.rank),i=function(t){const e=t.length;if(e>6)throw Error("Transpose for rank ".concat(e," is not yet supported"));const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let i=0;i<t.length;i++)r[t[i]]=n[i];return r.join()}(e);this.userCode="\n    void main() {\n      ".concat(r," resRC = getOutputCoords();\n      setOutput(getA(").concat(i,"));\n    }\n    ")}}class ib{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(t.length);for(let u=0;u<n.length;u++)n[u]=t[e[u]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));const r=Mm(this.rank),i=tv("rc",this.rank),a=new Array(this.rank);for(let u=0;u<e.length;u++)a[e[u]]=i[u];const o="vec2(".concat(a.slice(-2).join(),")"),s="++".concat(i[this.rank-1]," < ").concat(n[this.rank-1]),c="getChannel(getA(".concat(a.join(),"), ").concat(o,")");this.userCode="\n    void main() {\n      ".concat(r," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(c,";\n      if(").concat(s,") {\n        result[1] = ").concat(c,";\n      }\n      --").concat(i[this.rank-1],";\n      if(++").concat(i[this.rank-2]," < ").concat(n[this.rank-2],") {\n        result[2] = ").concat(c,";\n        if(").concat(s,") {\n          result[3] = ").concat(c,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}}function ab(t,e,n){const r=(0,o.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ib(t.shape,e):new rb(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}function ob(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,keepDims:s}=r;return function(t,e,n,r){const i=e,a=t.shape.length,s=o.util.parseAxisParam(i,t.shape);let c=s;const u=o.backend_util.getAxesPermutation(c,a),l=null!=u;let h=t;l&&(h=ab(t,u,r),c=o.backend_util.getInnerMostAxes(c.length,a)),o.backend_util.assertAxesAreInnerMostDims("sum",c,a);const[d,f]=o.backend_util.computeOutAndReduceShapes(h.shape,c);let p=d;n&&(p=o.backend_util.expandShapeToKeepDim(d,s));const g=o.util.sizeFromShape(f),m=Qv({inputs:{x:h},attrs:{shape:[o.util.sizeFromShape(t.shape)/g,g]},backend:r}),y=nb(m,(0,o.sumOutType)(t.dtype),"sum",r),v=Qv({inputs:{x:y},attrs:{shape:p},backend:r});return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(y),l&&r.disposeIntermediateTensorInfo(h),v}(i,a,s,n)}const sb={kernelName:o.Sum,backendName:"webgl",kernelFunc:ob};function cb(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{perm:a}=r,o=n,s=i.shape.length,c=new Array(s);for(let l=0;l<c.length;l++)c[l]=i.shape[a[l]];let u;if(o.shouldExecuteOnCPU([i])){const t=o.texData.get(i.dataId).values,e=Qy(t,i.shape,i.dtype,a,c);u=o.makeTensorInfo(c,i.dtype);o.texData.get(u.dataId).values=e}else u=ab(i,a,o);return u}const ub={kernelName:o.Transpose,backendName:"webgl",kernelFunc:cb},lb=1e3;function hb(t){let{a:e,b:n,transposeA:r,transposeB:i,backend:a,bias:s=null,preluActivationWeights:c=null,leakyreluAlpha:u=0,activation:l=null}=t;const h=e.shape.length,d=n.shape.length,f=r?e.shape[h-2]:e.shape[h-1],p=i?n.shape[d-1]:n.shape[d-2],g=r?e.shape[h-1]:e.shape[h-2],m=i?n.shape[d-2]:n.shape[d-1],y=e.shape.slice(0,-2),v=n.shape.slice(0,-2),b=o.util.sizeFromShape(y),x=o.util.sizeFromShape(v),w=o.broadcast_util.assertAndGetBroadcastShape(e.shape.slice(0,-2),n.shape.slice(0,-2)).concat([g,m]);o.util.assert(f===p,(()=>"Error in matMul: inner shapes (".concat(f,") and (")+"".concat(p,") of Tensors with shapes ").concat(e.shape," and ")+"".concat(n.shape," and transposeA=").concat(r)+" and transposeB=".concat(i," must match.")));const k=r?[b,f,g]:[b,g,f],_=i?[x,m,p]:[x,p,m],S=Qv({inputs:{x:e},backend:a,attrs:{shape:k}}),A=Qv({inputs:{x:n},backend:a,attrs:{shape:_}}),C=[S,A],E=Math.max(b,x),T=r?S.shape[1]:S.shape[2],N=null!=s,D=null!=c,F="leakyrelu"===l,I=null!=l?Gv(l,!0):null;let M;if((1===g||1===m)&&T>lb&&!1===(N||D||F||null!=I)){let t=S,e=A;r&&(t=cb({inputs:{x:S},backend:a,attrs:{perm:[0,2,1]}}),C.push(t)),i&&(e=cb({inputs:{x:A},backend:a,attrs:{perm:[0,2,1]}}),C.push(e));const n=1===m;let o=t;1!==m&&(o=Qv({inputs:{x:t},backend:a,attrs:{shape:[E,T,1]}}),C.push(o));const s=1===m?2:1;let c=e;n&&(c=Qv({inputs:{x:e},backend:a,attrs:{shape:[E,1,T]}}),C.push(c));const u=$v({inputs:{a:o,b:c},backend:a});M=ob({inputs:{x:u},backend:a,attrs:{axis:s,keepDims:!0}}),C.push(u)}else{const t=(0,o.upcastType)(e.dtype,n.dtype),l=new Hv(k,_,[E,g,m],r,i,N,I,D,F),h=[S,A];if(null!=s&&h.push(s),D&&h.push(c),F){const t=a.makeTensorInfo([],"float32",o.util.createScalarValue(u,"float32"));h.push(t),C.push(t)}M=a.runWebGLProgram(l,h,t)}const O=Qv({inputs:{x:M},backend:a,attrs:{shape:w}});C.push(M);for(const o of C)a.disposeIntermediateTensorInfo(o);return O}const db={kernelName:o._FusedMatMul,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{a:i,b:a,bias:o,preluActivationWeights:s}=e,{transposeA:c,transposeB:u,activation:l,leakyreluAlpha:h}=r;return hb({a:i,b:a,transposeA:c,transposeB:u,backend:n,bias:o,preluActivationWeights:s,leakyreluAlpha:h,activation:l})}},fb="return abs(x);";const pb={kernelName:o.Abs,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&"complex64"!==r.dtype){const t=n.texData.get(r.dataId),e=Ly(t.values);return n.makeTensorInfo(r.shape,r.dtype,e)}let i;return i=(0,o.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new kv(r.shape,fb):new cv(r.shape,fb),n.runWebGLProgram(i,[r],r.dtype)}},gb=Vv({opSnippet:uv+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),mb={kernelName:o.Acos,backendName:"webgl",kernelFunc:gb},yb=Vv({opSnippet:uv+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),vb={kernelName:o.Acosh,backendName:"webgl",kernelFunc:yb},bb="return a + b;",xb=qv({opSnippet:bb,packedOpSnippet:bb,supportsComplex:!0,cpuKernelImpl:ay}),wb={kernelName:o.Add,backendName:"webgl",kernelFunc:xb};class kb{constructor(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map(((t,e)=>"T".concat(e)));const n=[];this.variableNames.forEach((t=>{n.push("float v".concat(t," = get").concat(t,"AtOutCoords();"))}));const r=this.variableNames.map((t=>"v".concat(t))).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        float result = ").concat(r,";\n        setOutput(result);\n      }\n    ")}}class _b{constructor(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map(((t,e)=>"T".concat(e)));const n=[];this.variableNames.forEach((t=>{n.push("vec4 v".concat(t," = get").concat(t,"AtOutCoords();"))}));const r=this.variableNames.map((t=>"v".concat(t))).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        vec4 result = ").concat(r,";\n        setOutput(result);\n      }\n    ")}}const Sb={kernelName:o.AddN,backendName:"webgl",kernelFunc:function t(e){const{inputs:n,backend:r}=e,i=n;if(1===i.length)return Iv({inputs:{x:i[0]},backend:r});if(i.length>(0,o.env)().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const e=Math.floor(i.length/2),n=t({inputs:i.slice(0,e),backend:r}),a=t({inputs:i.slice(e),backend:r});return t({inputs:[n,a],backend:r})}const a=i.map((t=>t.dtype)).reduce(((t,e)=>(0,o.upcastType)(t,e))),s=i.map((t=>t.shape)),c=(0,o.env)().getBool("WEBGL_PACK")?new _b(i[0].shape,s):new kb(i[0].shape,s);return r.runWebGLProgram(c,i,a)}};const Ab={kernelName:o.All,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,keepDims:s}=r,c=i.shape.length,u=o.util.parseAxisParam(a,i.shape);let l=u;const h=o.backend_util.getAxesPermutation(l,c);let d=i;null!=h&&(d=cb({inputs:{x:i},backend:n,attrs:{perm:h}}),l=o.backend_util.getInnerMostAxes(l.length,c)),o.backend_util.assertAxesAreInnerMostDims("all",l,c);const[f,p]=o.backend_util.computeOutAndReduceShapes(d.shape,l),g=Qv({inputs:{x:d},backend:n,attrs:{shape:[-1,o.util.sizeFromShape(p)]}}),m=nb(g,g.dtype,"all",n);let y;if(s){y=Qv({inputs:{x:m},backend:n,attrs:{shape:o.backend_util.expandShapeToKeepDim(f,u)}})}else y=Qv({inputs:{x:m},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),null!=h&&n.disposeIntermediateTensorInfo(d),y}};const Cb={kernelName:o.Any,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,keepDims:s}=r,c=i.shape.length,u=o.util.parseAxisParam(a,i.shape);let l=u;const h=o.backend_util.getAxesPermutation(l,c);let d=i;null!=h&&(d=cb({inputs:{x:i},backend:n,attrs:{perm:h}}),l=o.backend_util.getInnerMostAxes(l.length,c)),o.backend_util.assertAxesAreInnerMostDims("any",l,c);const[f,p]=o.backend_util.computeOutAndReduceShapes(d.shape,l),g=Qv({inputs:{x:d},backend:n,attrs:{shape:[-1,o.util.sizeFromShape(p)]}}),m=nb(g,g.dtype,"any",n);let y;if(s){y=Qv({inputs:{x:m},backend:n,attrs:{shape:o.backend_util.expandShapeToKeepDim(f,u)}})}else y=Qv({inputs:{x:m},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),null!=h&&n.disposeIntermediateTensorInfo(d),y}};class Eb{constructor(t,e,n){this.variableNames=["A"];const{windowSize:r,batchSize:i,outSize:a}=t;n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,a];const o="max"===e?">":"<",s=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(r,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(r,"; i++) {\n          int inIdx = ").concat(s,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(o," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")}}class Tb{constructor(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,o.util.assert(t.length>2,(()=>"Packed arg".concat(n.charAt(0).toUpperCase()+n.slice(1)," supports only inputs with rank above 2.")));const i=t[t.length-1],a=Math.ceil(i/e);this.outputShape=t.slice(0,-1),a>1&&this.outputShape.push(a),r||this.variableNames.push("bestIndicesA");const s=this.outputShape,c=s.length,u=Mm(c),l=ev("coords",c);let h,d;if(1===a){d=c+1;const t=Mm(d);h="\n        ".concat(t," sourceLocR = ").concat(t,"(").concat(l.join(),", 0);\n        ++").concat(l[c-1],";\n        ").concat(t," sourceLocG = ").concat(t,"(").concat(l.join(),", 0);\n        ++").concat(l[c-2],";\n        ").concat(t," sourceLocA = ").concat(t,"(").concat(l.join(),", 0);\n        --").concat(l[c-1],";\n        ").concat(t," sourceLocB = ").concat(t,"(").concat(l.join(),", 0);\n        --").concat(l[c-2],";")}else d=c,h="\n        ".concat(u," sourceLocR = coords;\n        ++").concat(l[c-1],";\n        ").concat(u," sourceLocG = coords;\n        ++").concat(l[c-2],";\n        ").concat(u," sourceLocA = coords;\n        --").concat(l[c-1],";\n        ").concat(u," sourceLocB = coords;\n        --").concat(l[c-2],";");const f=["x","y","z","w","u","v"].slice(0,d),p="."+f[d-1],g=f.map((t=>"int "+t)),m=ev("sourceLocR",d-1).concat("inIdx.r"),y=ev("sourceLocG",d-1).concat("inIdx.g"),v=ev("sourceLocB",d-1).concat("inIdx.b"),b=ev("sourceLocA",d-1).concat("inIdx.a"),x="max"===n?"greaterThan":"lessThan",w=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(m.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(v.join(),"),\n                             getBestIndicesAChannel(").concat(b.join(),")));"),k="vec4(\n            getAChannel(".concat(m.join(),"),\n            hasNextCol ? getAChannel(").concat(y.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(v.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(b.join(),") : 0.)"),_=r?"":"\n      float getBestIndicesAChannel(".concat(g.join(),") {\n        return getChannel(getBestIndicesA(").concat(f.join(),"),\n                                          vec2(").concat(f.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(g.join(),") {\n        return getChannel(getA(").concat(f.join(),"),\n                               vec2(").concat(f.slice(-2).join(),"));\n      }\n      ").concat(_,"\n      void main() {\n        ").concat(u," coords = getOutputCoords();\n        bool hasNextCol = ").concat(l[c-1]," < ").concat(s[c-1]-1,";\n        bool hasNextRow = ").concat(l[c-2]," < ").concat(s[c-2]-1,";\n        ").concat(h,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(p,", sourceLocG").concat(p,",\n          sourceLocB").concat(p,", sourceLocA").concat(p,") * ").concat(e,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(k,";\n\n        for (int i = 0; i < ").concat(e,"; i++) {\n          inIdx = srcIdx;\n          ").concat(w,"\n          vec4 candidate = ").concat(k,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(x,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}}function Nb(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=e.shape[0],a=e.shape[1];null!=r&&(i=r.shape[0],a=r.shape[1]);const s=o.backend_util.computeOptimalWindowSize(a),c={windowSize:s,inSize:a,batchSize:i,outSize:Math.ceil(a/s)},u=new Eb(c,n,null==r),l=[e];null!=r&&l.push(r);const h=t.runWebGLProgram(u,l,"int32");if(1===h.shape[1])return h;const d=Nb(t,e,n,h);return t.disposeIntermediateTensorInfo(h),d}function Db(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const i=null!=r?r.shape:e.shape,a=i[i.length-1],s=o.backend_util.computeOptimalWindowSize(a),c=new Tb(i,s,n,null==r),u=null==r?[e]:[e,r],l=t.runWebGLProgram(c,u,"int32");if(l.shape.length===e.shape.length){const r=Db(t,e,n,l);return t.disposeIntermediateTensorInfo(l),r}return l}function Fb(t,e,n,r){const i=[n];if(o.backend_util.assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),i,e.shape.length),!(0,o.env)().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const n=[],a=t.texData.get(e.dataId);let s=e;null!==a&&a.isPacked&&(s=t.unpackTensor(e),n.push(s));const[c,u]=o.backend_util.computeOutAndReduceShapes(s.shape,i),l=o.util.sizeFromShape(u),h=Qv({inputs:{x:s},backend:t,attrs:{shape:[-1,l]}});n.push(h);const d=Nb(t,h,r);n.push(d);const f=Qv({inputs:{x:d},backend:t,attrs:{shape:c}});return n.forEach((e=>t.disposeIntermediateTensorInfo(e))),f}return Db(t,e,r)}const Ib={kernelName:o.ArgMax,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a}=r;let s=o.util.parseAxisParam(a,i.shape);const c=o.backend_util.getAxesPermutation(s,i.shape.length);let u=i;const l=[];null!=c&&(u=cb({inputs:{x:i},backend:n,attrs:{perm:c}}),l.push(u),s=o.backend_util.getInnerMostAxes(s.length,u.shape.length)),o.backend_util.assertAxesAreInnerMostDims("argMax",[s[0]],u.shape.length);const h=Fb(n,u,s[0],"max");return l.forEach((t=>n.disposeIntermediateTensorInfo(t))),h}};const Mb={kernelName:o.ArgMin,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a}=r;let s=o.util.parseAxisParam(a,i.shape);const c=o.backend_util.getAxesPermutation(s,i.shape.length);let u=i;const l=[];null!=c&&(u=cb({inputs:{x:i},backend:n,attrs:{perm:c}}),l.push(u),s=o.backend_util.getInnerMostAxes(s.length,u.shape.length)),o.backend_util.assertAxesAreInnerMostDims("argMin",[s[0]],u.shape.length);const h=Fb(n,u,s[0],"min");return l.forEach((t=>n.disposeIntermediateTensorInfo(t))),h}},Ob=Vv({opSnippet:uv+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),Rb={kernelName:o.Asin,backendName:"webgl",kernelFunc:Ob},zb=Vv({opSnippet:uv+"return log(x + sqrt(x * x + 1.0));"}),Bb={kernelName:o.Asinh,backendName:"webgl",kernelFunc:zb},Lb=Vv({opSnippet:uv+"\n  return atan(x);\n"}),Pb={kernelName:o.Atan,backendName:"webgl",kernelFunc:Lb},jb=qv({opSnippet:Tv+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Dv+"\n  return result;\n"}),Ub={kernelName:o.Atan2,backendName:"webgl",kernelFunc:jb},Wb=Vv({opSnippet:uv+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),Vb={kernelName:o.Atanh,backendName:"webgl",kernelFunc:Wb};class qb{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const a=t.filterWidth,o=t.strideHeight,s=t.strideWidth,c=t.dilationHeight,u=t.dilationWidth,l=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=t.padInfo.top,f=t.padInfo.left;this.outputShape=t.outShape;const p="avg"===e,g="((batch  * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),m="(xR * ".concat(t.inWidth," + xC) * ").concat(t.inChannels," + d");let y="0.0";if(p||(y="-1.0 / 1e-20"),n){const e=">=";return void(this.userCode="\n        const ivec2 strides = ivec2(".concat(o,", ").concat(s,");\n        const ivec2 pads = ivec2(").concat(d,", ").concat(f,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(l,";\n              wR += ").concat(c,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(h,";\n                wC += ").concat(u,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(e," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(r?i?g:m:"wR * ".concat(h," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let v="".concat(e,"(").concat(e,"(").concat(e,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(v="avgValue / max(count, 1.0)");const b=4*Math.floor(a/4),x=a%4,w="\n      if (".concat(p,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(o,", ").concat(s,");\n      const ivec2 pads = ivec2(").concat(d,", ").concat(f,");\n      const float initializationValue = ").concat(y,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(y,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(l,";\n            wR += ").concat(c,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(b,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(u,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(u,", d),\n              getValue(batch, xR, xC + 2 * ").concat(u,", d),\n              getValue(batch, xR, xC + 3 * ").concat(u,", d)\n            );\n\n            ").concat(w,"\n          }\n\n          int xC = xCCorner + ").concat(b,";\n          if (").concat(1===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(2===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(u,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(3===x,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(u,", d),\n              getValue(batch, xR, xC + 2 * ").concat(u,", d),\n              initializationValue\n            );\n\n            ").concat(w,"\n          }\n        }\n        setOutput(").concat(v,");\n      }\n    ")}}class Gb{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const a=t.filterWidth,o=t.strideDepth,s=t.strideHeight,c=t.strideWidth,u=t.dilationDepth,l=t.dilationHeight,h=t.dilationWidth,d=t.effectiveFilterDepth,f=t.effectiveFilterHeight,p=t.effectiveFilterWidth,g=t.padInfo.front,m=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;const v="avg"===e;let b="0.0";if(v||(b="-1.0 / 1e-20"),n){const e=">=";return void(this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(o,", ").concat(s,", ").concat(c,");\n        const ivec3 pads = ivec3(").concat(g,", ").concat(m,", ").concat(y,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(d,";\n              wD += ").concat(u,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(f,";\n                wR += ").concat(l,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(p,";\n                  wC += ").concat(h,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(e," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(r?i?"(((batch * ".concat(t.inDepth," + xD) * ").concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"((xD * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"wD * ".concat(f," * ").concat(p," +\n                      wR * ").concat(p," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let x="".concat(e,"(").concat(e,"(").concat(e,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(x="avgValue / max(count, 1.0)");const w=4*Math.floor(a/4),k=a%4,_="\n      if (".concat(v,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(o,", ").concat(s,", ").concat(c,");\n      const ivec3 pads = ivec3(").concat(g,", ").concat(m,", ").concat(y,");\n      const float initializationValue = ").concat(b,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(b,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(d,";\n            wD += ").concat(u,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(f,";\n            wR += ").concat(l,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(w,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(h,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(h,", ch)\n              );\n\n              ").concat(_,"\n            }\n\n            int xC = xCCorner + ").concat(w,";\n            if (").concat(1===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(_,"\n            } else if (").concat(2===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(_,"\n            } else if (").concat(3===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(h,", ch),\n                initializationValue\n              );\n\n              ").concat(_,"\n            }\n          }\n        }\n        setOutput(").concat(x,");\n      }\n    ")}}const Hb={kernelName:o.AvgPool,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e;gm(i,"avgPool");const{filterSize:a,strides:s,pad:c,dimRoundingMode:u}=r;o.util.assert(o.backend_util.eitherStridesOrDilationsAreOne(s,1),(()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(1,"'")));const l=o.backend_util.computePool2DInfo(i.shape,a,s,1,c,u);if(1===l.filterWidth&&1===l.filterHeight&&o.util.arraysEqual(l.inShape,l.outShape))return Iv({inputs:{x:i},backend:n});const h=new qb(l,"avg",!1);return n.runWebGLProgram(h,[i],"float32")}};const Yb={kernelName:o.AvgPool3D,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{filterSize:a,strides:s,pad:c,dimRoundingMode:u,dataFormat:l}=r,h=o.backend_util.computePool3DInfo(i.shape,a,s,[1,1,1],c,u,l),d=new Gb(h,"avg",!1);return n.runWebGLProgram(d,[i],"float32")}};class Xb{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,a=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterHeight,c=t.effectiveFilterWidth,u=s-1-t.padInfo.top,l=c-1-t.padInfo.left,h=1/(e*n);this.userCode="\n      const ivec2 pads = ivec2(".concat(u,", ").concat(l,");\n      const float avgMultiplier = float(").concat(h,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(s,";\n            wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(c,";\n            wC+= ").concat(o,") {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class Kb{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,i=t.strideDepth,a=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,c=t.dilationHeight,u=t.dilationWidth,l=t.effectiveFilterDepth,h=t.effectiveFilterHeight,d=t.effectiveFilterWidth,f=l-1-t.padInfo.front,p=h-1-t.padInfo.top,g=d-1-t.padInfo.left,m=1/(e*n*r);this.userCode="\n      const ivec3 pads = ivec3(".concat(f,", ").concat(p,", ").concat(g,");\n      const float avgMultiplier = float(").concat(m,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(l,";\n            wD += ").concat(s,") {\n          float dyD = float(dyDCorner + wD) / ").concat(i,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(h,";\n              wR += ").concat(c,") {\n            float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(u,") {\n              float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const $b={kernelName:o.AvgPool3DGrad,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:a}=e,s=a,{filterSize:c,strides:u,pad:l,dimRoundingMode:h}=r,d=o.backend_util.computePool3DInfo(s.shape,c,u,[1,1,1],l,h),f=new Kb(d);return n.runWebGLProgram(f,[i],s.dtype)}};const Zb={kernelName:o.AvgPoolGrad,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:a}=e,s=a;gm([i,a],"avgPoolGrad");const{filterSize:c,strides:u,pad:l}=r,h=o.backend_util.computePool2DInfo(s.shape,c,u,1,l),d=new Xb(h);return n.runWebGLProgram(d,[i],s.dtype)}};const Qb={kernelName:o.BatchMatMul,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{a:i,b:a}=e,{transposeA:o,transposeB:s}=r;return hb({a:i,b:a,transposeA:o,transposeB:s,backend:n})}};class Jb{constructor(t,e,n,r,i,a){this.outputShape=[],this.variableNames=["x","mean","variance"],o.backend_util.assertAndGetBroadcastShape(t,e),o.backend_util.assertAndGetBroadcastShape(t,n);let s="0.0";null!=r&&(o.backend_util.assertAndGetBroadcastShape(t,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let c="1.0";null!=i&&(o.backend_util.assertAndGetBroadcastShape(t,i),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(s,";\n        float scale = ").concat(c,";\n        float inv = scale * inversesqrt(variance + float(").concat(a,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")}}class tx{constructor(t,e,n,r,i,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],o.backend_util.assertAndGetBroadcastShape(t,e),o.backend_util.assertAndGetBroadcastShape(t,n);let s="vec4(0.0)";null!=r&&(o.backend_util.assertAndGetBroadcastShape(t,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let c="vec4(1.0)";null!=i&&(o.backend_util.assertAndGetBroadcastShape(t,i),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = ".concat(s,";\n        vec4 scale = ").concat(c,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(a,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")}}const ex={kernelName:o.FusedBatchNorm,backendName:"webgl",kernelFunc:t=>{let{inputs:e,backend:n,attrs:r}=t;const{x:i,mean:a,variance:s,offset:c,scale:u}=e;o.util.assert(a.shape.length===s.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),o.util.assert(null==c||a.shape.length===c.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),o.util.assert(null==u||a.shape.length===u.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));let{varianceEpsilon:l}=r;null==l&&(l=.001);const h=[i,a,s];let d=null;null!=c&&(d=c.shape,h.push(c));let f=null;null!=u&&(f=u.shape,h.push(u));const p=(0,o.env)().getBool("WEBGL_PACK_NORMALIZATION")?new tx(i.shape,a.shape,s.shape,d,f,l):new Jb(i.shape,a.shape,s.shape,d,f,l);return n.runWebGLProgram(p,h,h[0].dtype)}};class nx{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const e=Mm(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=function(t){if(1===t)return"sourceLoc";if(t<=6)return rx.slice(0,t).map((t=>"sourceLoc."+t)).join(",");throw Error("Slicing for rank ".concat(t," is not yet supported"))}(this.rank);let r;const i=t.map(((t,e)=>"sourceLoc.".concat(rx[e]," = start[").concat(e,"] + coords.").concat(rx[e],";")));r="\n        ".concat(e," sourceLoc;\n        ").concat(e," coords = getOutputCoords();\n        ").concat(i.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(r,"\n        setOutput(getSource(").concat(n,"));\n      }\n    ")}}const rx=["x","y","z","w","u","v"];class ix{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const e=Mm(this.rank),n=ev("coords",this.rank),r=ev("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2(".concat(r.slice(-2).join(),")"),a="getChannel(getSource(".concat(r.join(),"), ").concat(i,")"),o="\n      result.x = ".concat(a,";\n      if (++").concat(n[this.rank-1]," < ").concat(t[this.rank-1],") {\n        ++").concat(r[this.rank-1],";\n        result.y = ").concat(a,";\n        --").concat(r[this.rank-1],";\n      }\n    "),s=1===this.rank?"":"\n      --".concat(n[this.rank-1],";\n      if (++").concat(n[this.rank-2]," < ").concat(t[this.rank-2],") {\n        ++").concat(r[this.rank-2],";\n        result.z = ").concat(a,";\n        if (++").concat(n[this.rank-1]," < ").concat(t[this.rank-1],") {\n          ++").concat(r[this.rank-1],";\n          result.w = ").concat(a,";\n        }\n      }\n    "),c=this.rank<=4?"sourceLoc = coords +\n            ".concat(e,"(").concat(t.map(((t,e)=>"start[".concat(e,"]"))).join(),");"):t.map(((t,e)=>"".concat(r[e]," = ").concat(n[e]," + start[").concat(e,"];"))).join("\n");this.userCode="\n      void main() {\n        ".concat(e," coords = getOutputCoords();\n        ").concat(e," sourceLoc;\n        ").concat(c,"\n        vec4 result = vec4(0.);\n        ").concat(o,"\n        ").concat(s,"\n        setOutput(result);\n      }\n    ")}}function ax(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{begin:a,size:s}=r,[c,u]=o.slice_util.parseSliceParams(i,a,s);if(o.slice_util.assertParamsValid(i,c,u),0===o.util.sizeFromShape(u))return n.makeTensorInfo(u,i.dtype,[]);if(n.shouldExecuteOnCPU([i])||"string"===i.dtype){const t=n.texData.get(i.dataId),e=Py(t.values,c,u,i.shape,i.dtype);return n.makeTensorInfo(u,i.dtype,e)}const{isPacked:l}=n.texData.get(i.dataId),h=o.slice_util.isSliceContinous(i.shape,c,u);if(l||!h){const t=(0,o.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ix(u):new nx(u),e=[c];return n.runWebGLProgram(t,[i],i.dtype,e)}return n.uploadToGPU(i.dataId),function(t,e,n,r){const i=r.texData.get(t.dataId),a=r.makeTensorInfo(n,t.dtype),s=r.texData.get(a.dataId);Object.assign(s,i),s.refCount=1,s.shape=n,s.dtype=t.dtype;let c=o.slice_util.computeFlatOffset(e,o.util.computeStrides(t.shape));i.slice&&(c+=i.slice.flatOffset),s.slice={flatOffset:c,origDataId:i.slice&&i.slice.origDataId||t.dataId};const u=r.dataRefCount.get(s.slice.origDataId)||1;return r.dataRefCount.set(s.slice.origDataId,u+1),a}(i,c,u,n)}const ox={kernelName:o.Slice,backendName:"webgl",kernelFunc:ax},sx={kernelName:o.BatchToSpaceND,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockShape:a,crops:s}=r;o.util.assert(i.shape.length<=4,(()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"));const c=a.reduce(((t,e)=>t*e)),u=o.backend_util.getReshaped(i.shape,a,c),l=o.backend_util.getPermuted(u.length,a.length),h=o.backend_util.getReshapedPermuted(i.shape,a,c),d=o.backend_util.getSliceBeginCoords(s,a.length),f=o.backend_util.getSliceSize(h,s,a.length),p=[],g=Qv({inputs:{x:i},backend:n,attrs:{shape:u}}),m=cb({inputs:{x:g},backend:n,attrs:{perm:l}}),y=Qv({inputs:{x:m},backend:n,attrs:{shape:h}}),v=ax({inputs:{x:y},backend:n,attrs:{begin:d,size:f}});return p.push(g),p.push(m),p.push(y),p.forEach((t=>n.disposeIntermediateTensorInfo(t))),v}};const cx={kernelName:o.Bincount,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,weights:a}=e,{size:o}=r,s=n.readSync(i.dataId),c=n.readSync(a.dataId),u=oy(s,c,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,u)}};const ux={kernelName:o.BitwiseAnd,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{a:r,b:i}=e,a=(0,o.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS"),s=(0,o.env)().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,i])||1===s){const t=n.texData.get(r.dataId).values,e=n.texData.get(i.dataId).values,[a,o]=cy(r.shape,i.shape,t,e,r.dtype),s=n.makeTensorInfo(o,r.dtype);return n.texData.get(s.dataId).values=a,s}let c;return c=a?new Fv("\n  int r = int(a.r) & int(b.r);\n  int g = int(a.g) & int(b.g);\n  int rb = int(a.b) & int(b.b);\n  int ra = int(a.a) & int(b.a);\n  return vec4(r, g, rb, ra);\n",r.shape,i.shape,!1):new Nv("\n  return float(int(a.r) & int(b.r));\n",r.shape,i.shape),n.runWebGLProgram(c,[r,i],r.dtype)}};const lx={kernelName:o.BroadcastArgs,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{s0:r,s1:i}=e,a=n.readSync(r.dataId),s=n.readSync(i.dataId),c=o.backend_util.assertAndGetBroadcastShape(Array.from(a),Array.from(s));return n.makeTensorInfo([c.length],"int32",Int32Array.from(c))}},hx=qv({opSnippet:"return float(a != b);",cpuKernelImpl:Ny,dtype:"bool"}),dx={kernelName:o.NotEqual,backendName:"webgl",kernelFunc:hx};function fx(t){const{inputs:e,backend:n}=t,{input:r}=e;return Iv({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}const px={kernelName:o.Real,backendName:"webgl",kernelFunc:fx},gx="return float(int(x));";const mx={kernelName:o.Cast,backendName:"webgl",kernelFunc:function t(e){const{inputs:n,backend:r,attrs:i}=e,{x:a}=n,{dtype:s}=i;if("complex64"===s){if("complex64"===a.dtype)return Iv({inputs:{x:a},backend:r});const e=o.zeros(a.shape),n=t({inputs:{x:a},backend:r,attrs:{dtype:"float32"}}),i=Ov({inputs:{real:n,imag:e},backend:r});return e.dispose(),r.disposeIntermediateTensorInfo(n),i}if("complex64"===a.dtype){const e=fx({inputs:{input:a},backend:r}),n=t({inputs:{x:e},backend:r,attrs:{dtype:s}});return r.disposeIntermediateTensorInfo(e),n}if(!o.util.hasEncodingLoss(a.dtype,s)){const t=Iv({inputs:{x:a},backend:r});return{dataId:t.dataId,shape:t.shape,dtype:s}}if(r.shouldExecuteOnCPU([a])){const t=r.texData.get(a.dataId).values,[e,n,i]=uy(t,a.shape,a.dtype,s);return r.makeTensorInfo(e,n,i)}if("int32"===s)return function(t,e){const n=new cv(t.shape,gx),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(a,r);if("bool"===s){const t=r.makeTensorInfo([],"bool",o.util.getTypedArrayFromDType("bool",1)),e=hx({inputs:{a:a,b:t},backend:r});return r.disposeIntermediateTensorInfo(t),e}throw new Error("Error in Cast: failed to cast ".concat(a.dtype," to ").concat(s))}},yx="return ceil(x);",vx=Vv({opSnippet:yx,packedOpSnippet:yx,cpuKernelImpl:ly}),bx={kernelName:o.Ceil,backendName:"webgl",kernelFunc:vx};class xx{constructor(t){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}class wx{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}const kx={kernelName:o.ClipByValue,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{clipValueMin:a,clipValueMax:s}=r;let c;c=(0,o.env)().getBool("WEBGL_PACK_CLIP")?new wx(i.shape):new xx(i.shape);const u=[[a],[s]];return n.runWebGLProgram(c,[i],i.dtype,u)}};class _x{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}function Sx(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}const Ax={kernelName:o.ComplexAbs,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e,i=n.texData.get(r.dataId),a=new _x(r.shape),o=[Sx(r,i.complexTensorInfos.real),Sx(r,i.complexTensorInfos.imag)];return n.runWebGLProgram(a,o,o[0].dtype)}};class Cx{constructor(t){this.outputShape=[],this.outputShape=o.backend_util.computeOutShape(t,1),this.variableNames=t.map(((t,e)=>"T".concat(e)));const e=new Array(t.length-1);e[0]=t[0][1];for(let a=1;a<e.length;a++)e[a]=e[a-1]+t[a][1];const n=["if (yC < ".concat(e[0],") setOutput(getT0(yR, yC));")];for(let a=1;a<e.length;a++){const t=e[a-1];n.push("else if (yC < ".concat(e[a],") ")+"setOutput(getT".concat(a,"(yR, yC-").concat(t,"));"))}const r=e.length,i=e[e.length-1];n.push("else setOutput(getT".concat(r,"(yR, yC-").concat(i,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(n.join("\n        "),"\n      }\n    ")}}class Ex{constructor(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=o.backend_util.computeOutShape(t,e);const n=this.outputShape,r=n.length,i=Mm(r),a=ev("coords",r),s=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map(((t,e)=>"T".concat(e)));const c=new Array(t.length-1);c[0]=t[0][e];for(let o=1;o<c.length;o++)c[o]=c[o-1]+t[o][e];const u=s[e],l=s.slice(-2),h=s.join();let d="if (".concat(u," < ").concat(c[0],") {\n        return getChannel(\n            getT0(").concat(h,"), vec2(").concat(l.join(),"));\n        }");for(let o=1;o<c.length;o++){const t=c[o-1];d+="\n        if (".concat(u," < ").concat(c[o],"  && ").concat(u," >= ").concat(c[o-1],") {\n          return getChannel(\n            getT").concat(o,"(").concat(Tx(s,u,t),"),\n            vec2(").concat(Tx(l,u,t),"));\n        }")}const f=c.length,p=c[c.length-1];d+="\n        return getChannel(\n          getT".concat(f,"(").concat(Tx(s,u,p),"),\n          vec2(").concat(Tx(l,u,p),"));"),this.userCode="\n      float getValue(".concat(s.map((t=>"int "+t)),") {\n        ").concat(d,"\n      }\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(a,"), 0., 0., 0.);\n\n        ").concat(a[r-1]," = ").concat(a[r-1]," + 1;\n        if (").concat(a[r-1]," < ").concat(n[r-1],") {\n          result.g = getValue(").concat(a,");\n        }\n\n        ").concat(a[r-2]," = ").concat(a[r-2]," + 1;\n        if (").concat(a[r-2]," < ").concat(n[r-2],") {\n          result.a = getValue(").concat(a,");\n        }\n\n        ").concat(a[r-1]," = ").concat(a[r-1]," - 1;\n        if (").concat(a[r-2]," < ").concat(n[r-2]," &&\n            ").concat(a[r-1]," < ").concat(n[r-1],") {\n          result.b = getValue(").concat(a,");\n        }\n        setOutput(result);\n      }\n    ")}}function Tx(t,e,n){const r=t.indexOf(e);return t.map(((t,e)=>e===r?"".concat(t," - ").concat(n):t)).join()}function Nx(t){const{inputs:e,backend:n}=t,{input:r}=e;return Iv({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}const Dx={kernelName:o.Imag,backendName:"webgl",kernelFunc:Nx};function Fx(t,e,n){const r=t[0].dtype;if("complex64"===r){const r=t.map((t=>fx({inputs:{input:t},backend:n}))),i=t.map((t=>Nx({inputs:{input:t},backend:n}))),a=Fx(r,e,n),o=Fx(i,e,n),s=Ov({inputs:{real:a,imag:o},backend:n});return r.forEach((t=>n.disposeIntermediateTensorInfo(t))),i.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),s}let i=n.shouldExecuteOnCPU(t);if("string"===r&&(i=!0),i){const i=t.map((t=>{const r=o.util.sizeFromShape(t.shape.slice(e));return Qv({inputs:{x:t},backend:n,attrs:{shape:[-1,r]}})})),a=i.map((t=>({vals:n.readSync(t.dataId),shape:t.shape}))),s=o.backend_util.computeOutShape(i.map((t=>t.shape)),1),c=1===i[0].shape[0],u=hy(a,s,r,c),l=o.backend_util.computeOutShape(t.map((t=>t.shape)),e),h=n.makeTensorInfo(l,r,u);return i.forEach((t=>n.disposeIntermediateTensorInfo(t))),h}const a=t.filter((t=>o.util.sizeFromShape(t.shape)>0)),s=(0,o.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&a[0].shape.length>1;if(1===a.length){const e=s?new cv(t[0].shape,gv):new kv(t[0].shape,gv);return n.runWebGLProgram(e,t,r)}const c=(0,o.env)().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(a.length>c){const t=[];for(let i=0;i<a.length;i+=c){const r=a.slice(i,i+c);t.push(Fx(r,e,n))}const r=Fx(t,e,n);for(const e of t)n.disposeIntermediateTensorInfo(e);return r}if(s){const t=new Ex(a.map((t=>t.shape)),e);return n.runWebGLProgram(t,a,r)}const{tensors2D:u,outShape:l}=function(t,e,n){const r=o.backend_util.computeOutShape(t.map((t=>t.shape)),e),i=t.map((t=>Qv({inputs:{x:t},attrs:{shape:[-1,o.util.sizeFromShape(t.shape.slice(e))]},backend:n})));return{tensors2D:i,outShape:r}}(a,e,n),h=new Cx(u.map((t=>t.shape))),d=n.runWebGLProgram(h,u,r);u.forEach((t=>n.disposeIntermediateTensorInfo(t)));const f=Qv({inputs:{x:d},attrs:{shape:l},backend:n});return n.disposeIntermediateTensorInfo(d),f}function Ix(t){const{inputs:e,backend:n,attrs:r}=t,{axis:i}=r,a=o.util.parseAxisParam(i,e[0].shape)[0],s=e.map((t=>t.shape));o.backend_util.assertParamsConsistent(s,a);const c=o.backend_util.computeOutShape(e.map((t=>t.shape)),a);if(0===o.util.sizeFromShape(c))return n.makeTensorInfo(c,e[0].dtype,[]);const u=e.filter((t=>o.util.sizeFromShape(t.shape)>0));return 1===u.length?Iv({inputs:{x:u[0]},backend:n}):Fx(u,a,n)}const Mx={kernelName:o.Concat,backendName:"webgl",kernelFunc:Ix};class Ox{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.outputShape=t.outShape;const a=t.padInfo.top,o=t.padInfo.left,s=t.strideHeight,c=t.strideWidth,u=t.dilationHeight,l=t.dilationWidth,h=t.filterHeight,d=t.filterWidth,f=4*Math.floor(t.inChannels/4),p=t.inChannels%4,g="channelsLast"===t.dataFormat,m=g?1:2,y=g?2:3,v=g?3:1;let b="",x="";n&&(b=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),x="result = activation(result);");const w=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(b,"\n\n      const ivec2 strides = ivec2(").concat(s,", ").concat(c,");\n      const ivec2 pads = ivec2(").concat(a,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(v,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(m,"], coords[").concat(y,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(h,"; wR++) {\n          int xR = xRCorner + wR * ").concat(u,";\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(d,"; wC++) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            if (xC < 0 || xC >= ").concat(t.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(f,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(g,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===p,") {\n\n              if (").concat(g,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(f,") *\n                    getW(wR, wC, ").concat(f,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(f,", xR, xC) *\n                    getW(wR, wC, ").concat(f,", d2);\n              }\n\n            } else if (").concat(2===p,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(f,", d2),\n                getW(wR, wC, ").concat(f," + 1, d2)\n              );\n\n              if (").concat(g,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(f,"),\n                  getX(batch, xR, xC, ").concat(f," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(f,", xR, xC),\n                  getX(batch, ").concat(f," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===p,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(f,", d2),\n                getW(wR, wC, ").concat(f," + 1, d2),\n                getW(wR, wC, ").concat(f," + 2, d2)\n              );\n\n              if (").concat(g,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(f,"),\n                  getX(batch, xR, xC, ").concat(f," + 1),\n                  getX(batch, xR, xC, ").concat(f," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(f,", xR, xC),\n                  getX(batch, ").concat(f," + 1, xR, xC),\n                  getX(batch, ").concat(f," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(w,"\n        ").concat(x,"\n        setOutput(result);\n      }\n    ")}}class Rx{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,i=t.strideDepth,a=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,c=t.dilationHeight,u=t.dilationWidth,l=t.filterDepth,h=t.filterHeight,d=t.filterWidth,f=4*Math.floor(t.inChannels/4),p=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(i,", ").concat(a,", ").concat(o,");\n      const ivec3 pads = ivec3(").concat(e,", ").concat(n,", ").concat(r,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(l,"; wF++) {\n          int xF = xFCorner + wF * ").concat(s,";\n\n          if (xF < 0 || xF >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(h,"; wR++) {\n            int xR = xRCorner + wR * ").concat(c,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,"; wC++) {\n              int xC = xCCorner + wC * ").concat(u,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(f,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===p,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(f,") *\n                  getW(wF, wR, wC, ").concat(f,", d2);\n              } else if (").concat(2===p,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(f,"),\n                  getX(batch, xF, xR, xC, ").concat(f," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(f,", d2),\n                  getW(wF, wR, wC, ").concat(f," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===p,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(f,"),\n                  getX(batch, xF, xR, xC, ").concat(f," + 1),\n                  getX(batch, xF, xR, xC, ").concat(f," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(f,", d2),\n                  getW(wF, wR, wC, ").concat(f," + 1, d2),\n                  getW(wF, wR, wC, ").concat(f," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class zx{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=jm(this.outputShape.length);const a=t.padInfo.left,s=t.strideWidth,c=t.dilationWidth,u=t.filterHeight,l=t.filterWidth,h=l;let d="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let o=0;o<l;o++)d+="\n           vec4 xTexelC".concat(2*o,";\n           int xTexelC").concat(2*o,"Ready;\n           vec4 xTexelC").concat(2*o+1,";\n           int xTexelC").concat(2*o+1,"Ready;\n           vec4 xC").concat(o,";");d+="\n     for (int r = 0; r < ".concat(u,"; r++) {\n      for (int d1 = 0; d1 < ").concat(t.inChannels,"; d1 += 2) {\n       ");for(let o=0;o<l;o++)d+="\n           xTexelC".concat(2*o," = vec4(0.0);\n           xTexelC").concat(2*o,"Ready = 0;\n           xTexelC").concat(2*o+1," = vec4(0.0);\n           xTexelC").concat(2*o+1,"Ready = 0;\n           xC").concat(o," = vec4(0.0);");d+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let m=0;m<(h+1)/2;m++){const e=2*m;if(d+="\n           xC = xCCorner + ".concat(e*c,";\n           "),1===s){if(e<l&&(a%2===1?(d+="\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                   xTexelC").concat(e," = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(e,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(e,"Ready = 1;\n                 }\n               "),d+=1===c&&e>0?"\n                 xC".concat(e," = vec4(xTexelC").concat(e-2,".zw, xTexelC").concat(e,".xy);\n                 "):"\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC".concat(e," = vec4(previous.zw, xTexelC").concat(e,".xy);\n                   } else {\n                     xC").concat(e," = vec4(0.0, 0.0, xTexelC").concat(e,".xy);\n                   }\n                   ")):d+="\n                 if (xC >= 0 && xC < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                   xTexelC").concat(e," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(e,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(e,"Ready = 1;\n                 }\n\n                 xC").concat(e," = xTexelC").concat(e,";\n                 "),e+1<l)){const t=a%2===0?o.util.nearestLargerEven(c):c;c%2===0&&a%2===1||c%2!==0&&a%2!==1?(d+="\n                   xCOffset = xC + imod(pads[1], 2) + ".concat(t,";\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                     xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC").concat(e+1,".zw = vec2(0.0);\n                     }\n                     xTexelC").concat(e+1,"Ready = 1;\n                   }\n                   "),d+=c>1?"\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC".concat(e+1," = vec4(previous.zw, xTexelC").concat(e+1,".xy);\n                     } else {\n                      xC").concat(e+1," = vec4(0.0, 0.0, xTexelC").concat(e+1,".xy);\n                     }\n                     "):"\n                     xC".concat(e+1," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".xy);\n                     ")):d+=1===t?"\n                     xC".concat(e+1," = xTexelC").concat(e,";\n                     "):"\n                     xCOffset = xC + ".concat(t,";\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                       xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC").concat(e+1,".zw = vec2(0.0);\n                       }\n                       xTexelC").concat(e+1,"Ready = 1;\n                     }\n\n                     xC").concat(e+1," = xTexelC").concat(e+1,";\n                     ")}}else e<l&&(a%2===1?(d+="\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                   xTexelC").concat(e," = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(e,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(e,"Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                   xTexelC").concat(e+1," = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC").concat(e+1,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(e+1,"Ready = 1;\n                 }\n\n                 xC").concat(e," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".zw);\n               "),e+1<l&&(d+="\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC".concat(e+1," = vec4(xTexelC").concat(e+1,".xy, final.xy);\n                 "))):(d+="\n                 if(xC >= 0 && xC < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                   xTexelC").concat(e," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(e,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(e,"Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                   xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(e+1,".zw = vec2(0.);\n                   }\n                   xTexelC").concat(e+1,"Ready = 1;\n                 }\n\n                 xC").concat(e," = vec4(\n                   xTexelC").concat(e,".xy, xTexelC").concat(e+1,".xy);\n               "),e+1<l&&(d+="\n                   xC".concat(e+1," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".zw);\n                 "))));e<l&&(d+="\n             wTexel = getW(r, ".concat(e,", d1, d2);\n             dotProd += xC").concat(e,".xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ").concat(t.inChannels,") {\n               dotProd += xC").concat(e,".yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           "),e+1<l&&(d+="\n               wTexel = getW(r, ".concat(e+1,", d1, d2);\n               dotProd += xC").concat(e+1,".xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ").concat(t.inChannels,") {\n                 dotProd += xC").concat(e+1,".yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             ")))}d+="\n     }\n   ",d+="\n     }\n   ",d+="\n     }\n   ";let f="",p="";n&&(f=r?"vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ".concat(n,"\n         }"):i?"vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ".concat(n,"\n         }"):"vec4 activation(vec4 x) {\n           ".concat(n,"\n         }"),p="result = activation(result);");const g=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n       ".concat(f,"\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ").concat(d,"\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ").concat(g,"\n         ").concat(p,"\n         setOutput(result);\n       }\n     ")}}class Bx{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=jm(this.outputShape.length);const{dataFormat:n}=e,r=ym(),i="channelsLast"===n,a=i?1:2,o=i?2:3,s=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < ".concat(t[2]," && pos < ").concat(t[1],") {");let c="";for(let u=0;u<=1;u++)for(let t=0;t<=1;t++)c+="\n          blockIndex = rc.z + ".concat(t,";\n          pos = rc.y + ").concat(u,";\n\n          ").concat(s,"\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[").concat(a,"] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[").concat(o,"] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (").concat(i,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*u+t,"] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*u+t,"] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(c,"\n\n        ").concat(r.output," = result;\n      }\n    ")}}function Lx(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&1===n&&t[0]>1?[t[0],1]:null}function Px(t){let{x:e,filter:n,convInfo:r,backend:i,bias:a=null,preluActivationWeights:s=null,leakyreluAlpha:c=0,activation:u=null}=t;const l=e.shape,h=i.texData.get(e.dataId),d=r.inChannels,f=l[0]*l[1]*l[2],p=r.outChannels,g="channelsLast"===r.dataFormat;let m;const y=[];if(null!=s){const t=Lx(s.shape,g);null!=t&&(s=Qv({inputs:{x:s},backend:i,attrs:{shape:t}}),y.push(s))}if(null!=a){const t=Lx(a.shape,g);null!=t&&(a=Qv({inputs:{x:a},backend:i,attrs:{shape:t}}),y.push(a))}if(!((1===f||1===p)&&d>lb)&&h.isPacked&&g&&null!=h.texture&&l[2]%2!==0&&o.util.arraysEqual(h.shape.slice(-3),l.slice(-3))){const t=l[0]*l[1]*(l[2]+1),d={dataId:e.dataId,shape:[1,t,r.inChannels],dtype:e.dtype},f=h.shape;h.shape=h.shape.slice(),h.shape[h.shape.length-2]++,o.util.assert(cm(h.shape,d.shape),(()=>"packed reshape ".concat(h.shape," to ").concat(d.shape," isn't free")));const p=Qv({inputs:{x:n},backend:i,attrs:{shape:[1,r.inChannels,r.outChannels]}});y.push(p);const g=hb({a:d,b:p,backend:i,transposeA:false,transposeB:false,bias:a,activation:u,preluActivationWeights:s,leakyreluAlpha:c}),v=i.texData.get(g.dataId);o.util.assert(v.isPacked,(()=>"batchMatMul result is expected to be packed")),h.shape=f,v.shape=r.outShape,m=Iv({inputs:{x:g},backend:i}),m.shape=r.outShape,y.push(g)}else{const t=r.outHeight*r.outWidth,o=Qv({inputs:{x:e},backend:i,attrs:{shape:g?[r.batchSize,t,r.inChannels]:[r.batchSize,r.inChannels,t]}}),l=Qv({inputs:{x:n},backend:i,attrs:{shape:[1,r.inChannels,r.outChannels]}}),h=hb({a:g?o:l,b:g?l:o,transposeA:!g,transposeB:false,backend:i,bias:a,activation:u,preluActivationWeights:s,leakyreluAlpha:c});m=Qv({inputs:{x:h},backend:i,attrs:{shape:r.outShape}}),y.push(o),y.push(l),y.push(h)}for(const o of y)i.disposeIntermediateTensorInfo(o);return m}function jx(t){let{x:e,filter:n,convInfo:r,backend:i,bias:a=null,preluActivationWeights:s=null,leakyreluAlpha:c=0,activation:u=null}=t;const{filterWidth:l,filterHeight:h,inChannels:d,outWidth:f,outHeight:p,dataFormat:g}=r,m="channelsLast"===g,y=l*h*d,v=p*f,b=[r.batchSize,y,v],x=[];if(null!=s){const t=Lx(s.shape,m);null!=t&&(s=Qv({inputs:{x:s},backend:i,attrs:{shape:t}}),x.push(s))}if(null!=a){const t=Lx(a.shape,m);null!=t&&(a=Qv({inputs:{x:a},backend:i,attrs:{shape:t}}),x.push(a))}const w=Qv({inputs:{x:n},backend:i,attrs:{shape:[1,y,o.util.sizeFromShape(n.shape)/y]}});x.push(w);const k=new Bx(b,r),_=[e.shape,[r.padInfo.top,r.padInfo.left],[r.strideHeight,r.strideWidth],[r.dilationHeight,r.dilationWidth],[r.inChannels],[r.filterWidth*r.inChannels],[r.outWidth]],S=i.runWebGLProgram(k,[e],"float32",_),A=Qv({inputs:{x:S},backend:i,attrs:{shape:b}});x.push(S),x.push(A);const C=null!=a,E=null!=s,T="leakyrelu"===u,N=u?Gv(u,!0):null,D=new Hv(m?A.shape:w.shape,m?w.shape:A.shape,m?[r.batchSize,v,r.outChannels]:[r.batchSize,r.outChannels,v],!0,!1,C,N,E,T),F=m?[A,w]:[w,A];if(a&&F.push(a),E&&F.push(s),T){const t=i.makeTensorInfo([],"float32",o.util.createScalarValue(c,"float32"));F.push(t),x.push(t)}const I=i.runWebGLProgram(D,F,"float32"),M=Qv({inputs:{x:I},backend:i,attrs:{shape:r.outShape}});x.push(I);for(const o of x)i.disposeIntermediateTensorInfo(o);return M}const Ux={kernelName:o.Conv2D,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a}=e,{strides:s,pad:c,dataFormat:u,dilations:l,dimRoundingMode:h}=r,d=o.backend_util.convertConv2DDataFormat(u),f=o.backend_util.computeConv2DInfo(i.shape,a.shape,s,l,c,h,!1,d);let p;if(1!==f.filterHeight||1!==f.filterWidth||1!==f.dilationHeight||1!==f.dilationWidth||1!==f.strideHeight||1!==f.strideWidth||"SAME"!==f.padInfo.type&&"VALID"!==f.padInfo.type)if(f.strideWidth<=2&&"channelsLast"===d&&(0,o.env)().getBool("WEBGL_EXP_CONV")){const t=new zx(f),e=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];p=n.runWebGLProgram(t,[i,a],"float32",e)}else if((0,o.env)().getBool("WEBGL_CONV_IM2COL"))p=jx({x:i,filter:a,convInfo:f,backend:n});else{const t=new Ox(f);p=n.runWebGLProgram(t,[i,a],"float32")}else p=Px({x:i,filter:a,convInfo:f,backend:n});const g=Qv({inputs:{x:p},backend:n,attrs:{shape:f.outShape}});return n.disposeIntermediateTensorInfo(p),g}};class Wx{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,i=t.padInfo.left,a="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(e," - ").concat(r,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              ").concat(a?"float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);":"float dyValue = getDy(b, d2, yR, yC);\n              float xValue = getX(b, d1, xR, xC);\n              dotProd += (xValue * dyValue);","\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class Vx{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,a="channelsLast"===t.dataFormat,o=e-1-t.padInfo.top,s=n-1-t.padInfo.left,c=a?1:2,u=a?2:3,l=a?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(l,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(c,"], coords[").concat(u,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(e,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(e," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n\n              if (").concat(a,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class qx{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,i=t.padInfo.front,a=t.padInfo.top,o=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(t.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(e," - ").concat(i,";\n\n            if (xF < 0 || xF >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(r," - ").concat(o,";\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class Gx{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,i=t.strideDepth,a=t.strideHeight,o=t.strideWidth,s=e-1-t.padInfo.front,c=n-1-t.padInfo.top,u=r-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(s,", ").concat(c,", ").concat(u,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(e,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(i,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(t.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(e," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(n,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(n," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(r,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(r," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const Hx={kernelName:o.Conv2DBackpropFilter,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:a}=e,{strides:s,pad:c,dataFormat:u,dimRoundingMode:l,filterShape:h}=r,d=o.backend_util.convertConv2DDataFormat(u),f=o.backend_util.computeConv2DInfo(i.shape,h,s,1,c,l,!1,d),p=new Wx(f);return n.runWebGLProgram(p,[i,a],"float32")}};class Yx{constructor(t){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=t.inShape,this.enableShapeUniforms=jm(this.outputShape.length);const e=t.filterHeight,n=t.filterWidth,r=e-1-t.padInfo.top,i=n-1-t.padInfo.left;this.userCode="\n      const ivec2 pads = ivec2(".concat(r,", ").concat(i,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        vec4 result = vec4(0.);\n        for (int wR = 0; wR < ").concat(e,"; wR++) {\n          float dyR = float(dyRCorner + wR) / strides[0];\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n          int wRPerm = ").concat(e," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            float dyC = float(dyCCorner + wC) / strides[1];\n            bool idyCVal = (dyC >= 0.0) && (dyC < ").concat(t.outWidth,".0)\n              && (fract(dyC) == 0.0);\n            int idyC = int(dyC);\n\n            float dyC2 = float(dyCCorner + wC + 1) / strides[1];\n            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ").concat(t.outWidth,".0)\n              && (fract(dyC2) == 0.0);\n            int idyC2 = int(dyC2);\n\n            if (idyCVal && idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?\n                  dySample : getDy(batch, idyR, idyC2, d2);\n\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n\n                dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample2.xy : dySample2.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal) {\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC, d2);\n                vec2 dyValue = mod(float(idyC), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.xy += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            } else if (idyCVal2) {\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2 += 2) {\n                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);\n                vec4 dySample = getDy(batch, idyR, idyC2, d2);\n                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?\n                  dySample.xy : dySample.zw;\n                result.zw += vec2(dot(dyValue, wValue.xy),\n                  dot(dyValue, wValue.zw));\n              }\n            }\n          }\n        }\n        setOutput(result);\n      }\n    ")}}const Xx={kernelName:o.Conv2DBackpropInput,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:a}=e,{inputShape:s,strides:c,pad:u,dataFormat:l,dimRoundingMode:h}=r,d=o.backend_util.convertConv2DDataFormat(l),f=o.backend_util.computeConv2DInfo(s,a.shape,c,1,u,h,!1,d);if((0,o.env)().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&"channelsLast"===d){const t=[[f.strideHeight,f.strideWidth]],e=new Yx(f);return n.runWebGLProgram(e,[i,a],"float32",t)}{const t=new Vx(f);return n.runWebGLProgram(t,[i,a],"float32")}}};const Kx={kernelName:o.Conv3D,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a}=e,{strides:s,pad:c,dilations:u}=r,l=o.backend_util.computeConv3DInfo(i.shape,a.shape,s,u,c),h=new Rx(l);return n.runWebGLProgram(h,[i,a],"float32")}};const $x={kernelName:o.Conv3DBackpropFilterV2,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:a}=e,{strides:s,pad:c,filterShape:u}=r,l=o.backend_util.computeConv3DInfo(i.shape,u,s,1,c),h=new qx(l);return n.runWebGLProgram(h,[i,a],"float32")}};const Zx={kernelName:o.Conv3DBackpropInputV2,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:a}=e,{pad:s,strides:c,inputShape:u}=r,l=o.backend_util.computeConv3DInfo(u,a.shape,c,1,s),h=new Gx(l);return n.runWebGLProgram(h,[i,a],"float32")}},Qx=Vv({opSnippet:Wv+"\n  return cos(x);\n",packedOpSnippet:"\n  vec4 result = cos(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(Dv,"\n  return result;\n")}),Jx={kernelName:o.Cos,backendName:"webgl",kernelFunc:Qx},tw=Vv({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),ew={kernelName:o.Cosh,backendName:"webgl",kernelFunc:tw};class nw{constructor(t,e,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[a,o,s,c]=t,[u]=e,[l,h]=n;this.outputShape=[u,l,h,c];const d="bilinear"===r?1:0,[f,p]=["".concat(o-1,".0"),"".concat(s-1,".0")],[g,m,y]=l>1?["".concat((o-1)/(l-1)),"(y2-y1) * height_ratio","y1*".concat(f," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(f)],[v,b,x]=h>1?["".concat((s-1)/(h-1)),"(x2-x1) * width_ratio","x1*".concat(p," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(p)];this.userCode="\n      const float height_ratio = float(".concat(g,");\n      const float width_ratio = float(").concat(v,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(a,") {\n          return;\n        }\n\n        float height_scale = ").concat(m,";\n        float width_scale = ").concat(b,";\n\n        float in_y = ").concat(y,";\n        if( in_y < 0.0 || in_y > ").concat(f," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n        float in_x = ").concat(x,";\n        if( in_x < 0.0 || in_x > ").concat(p," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(d," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")}}const rw={kernelName:o.CropAndResize,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{image:i,boxes:a,boxInd:o}=e,{cropSize:s,method:c,extrapolationValue:u}=r,l=new nw(i.shape,a.shape,s,c,u);return n.runWebGLProgram(l,[i,a,o],"float32")}};var iw;!function(t){t.Prod="*",t.Sum="+"}(iw||(iw={}));class aw{constructor(t,e,n,r){this.op=t,this.outputShape=e,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,a=this.op===iw.Prod?"1.0":"0.0",o=n?a:"getX(".concat(ow(i,"coords",this.op),")"),s=this.outputShape[this.outputShape.length-1];let c="",u="";n?(c=r?"end != ".concat(s-1):"end != 0",u=r?"end + 1":"end - 1"):(c=r?"end + pow2 < ".concat(s):"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat(Mm(i)," coords = getOutputCoords();\n        int end = ").concat(sw(i,"coords",this.op),";\n        float val = ").concat(o,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(c,") {\n          int idx = ").concat(u,";\n          ").concat(sw(i,"coords",this.op)," = idx;\n          val ").concat(this.op,"= getX(").concat(ow(i,"coords",this.op),");\n        }\n        setOutput(val);\n      }\n    ")}}function ow(t,e,n){if(1===t)return"".concat(e);if(2===t)return"".concat(e,".x, ").concat(e,".y");if(3===t)return"".concat(e,".x, ").concat(e,".y, ").concat(e,".z");if(4===t)return"".concat(e,".x, ").concat(e,".y, ").concat(e,".z, ").concat(e,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(t," is not yet supported"))}function sw(t,e,n){if(1===t)return"".concat(e);if(2===t)return"".concat(e,".y");if(3===t)return"".concat(e,".z");if(4===t)return"".concat(e,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(t," is not yet supported"))}function cw(t,e,n,r,i,a){const s=e.shape.length,c=o.backend_util.getAxesPermutation([r],s);let u=e;null!=c&&(u=cb({inputs:{x:e},backend:n,attrs:{perm:c}}));const l=o.backend_util.getInnerMostAxes(1,s)[0];if(l!==s-1)throw new Error("WebGL cumprod shader expects an inner-most axis=".concat(e.shape.length-1," ")+"but got axis=".concat(r));const h=u.shape[l];let d=Iv({inputs:{x:u},backend:n});for(let o=0;o<=Math.ceil(Math.log2(h))-1;o++){const e=new aw(t,u.shape,!1,a),r=[[o]],i=d;d=n.runWebGLProgram(e,[d],d.dtype,r),n.disposeIntermediateTensorInfo(i)}if(i){const e=new aw(t,u.shape,i,a),r=d;d=n.runWebGLProgram(e,[d],d.dtype),n.disposeIntermediateTensorInfo(r)}if(null!=c){const t=cb({inputs:{x:d},backend:n,attrs:{perm:o.backend_util.getUndoAxesPermutation(c)}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(u),t}return d}const uw={kernelName:o.Cumprod,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,exclusive:o,reverse:s}=r;return cw(iw.Prod,i,n,a,o,s)}};const lw={kernelName:o.Cumsum,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,exclusive:o,reverse:s}=r;return cw(iw.Sum,i,n,a,o,s)}};const hw={kernelName:o.DenseBincount,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,weights:a}=e,{size:o,binaryOutput:s}=r;if(1===i.shape.length){const t=n.readSync(i.dataId),e=n.readSync(a.dataId),r=oy(t,e,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,r)}if(2===i.shape.length){const t=n.bufferSync(i),e=n.bufferSync(a),r=sy(t,e,o,s);return n.makeTensorInfo(r.shape,a.dtype,r.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(i.shape.length,"."))}};class dw{constructor(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(e,";\n      int offset_h = imod(h, ").concat(e,");\n      int in_w = w / ").concat(e,";\n      int offset_w = imod(w, ").concat(e,");\n      int offset_d = (offset_h * ").concat(e," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}const fw={kernelName:o.DepthToSpace,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockSize:a,dataFormat:o}=r,s=i.shape[0],c=("NHWC"===o?i.shape[1]:i.shape[2])*a,u=("NHWC"===o?i.shape[2]:i.shape[3])*a,l=("NHWC"===o?i.shape[3]:i.shape[1])/(a*a),h=new dw("NHWC"===o?[s,c,u,l]:[s,l,c,u],a,o);return n.runWebGLProgram(h,[i],i.dtype)}};class pw{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=jm(this.outputShape.length);const a=t.filterHeight,o=t.filterWidth,s=t.outChannels/t.inChannels;let c="",u="";n&&(c=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),u="result = activation(result);");const l=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(c,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(s,";\n        int q = d2 - d1 * ").concat(s,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(a,"; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(o,"; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(l,"\n        ").concat(u,"\n        setOutput(result);\n      }\n    ")}}class gw{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=jm(this.outputShape.length);const a=t.outChannels/t.inChannels,s=t.padInfo.left,c=t.strideWidth,u=t.dilationWidth,l=t.filterHeight,h=t.filterWidth,d=h;let f="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let o=0;o<h;o++)f+="\n          vec4 xTexelC".concat(2*o,";\n          int xTexelC").concat(2*o,"Ready;\n          vec4 xTexelC").concat(2*o+1,";\n          int xTexelC").concat(2*o+1,"Ready;\n          vec4 xC").concat(o,";");f+="\n    for (int r = 0; r < ".concat(l,"; r++) {\n      ");for(let o=0;o<h;o++)f+="\n          xTexelC".concat(2*o," = vec4(0.0);\n          xTexelC").concat(2*o,"Ready = 0;\n          xTexelC").concat(2*o+1," = vec4(0.0);\n          xTexelC").concat(2*o+1,"Ready = 0;\n          xC").concat(o," = vec4(0.0);");f+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let y=0;y<(d+1)/2;y++){const t=2*y;if(f+="\n          xC = xCCorner + ".concat(t*u,";\n          "),1===c){if(t<h&&(s%2===1?(f+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                  xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(t,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t,"Ready = 1;\n                }\n              "),f+=1===u&&t>0?"\n                xC".concat(t," = vec4(xTexelC").concat(t-2,".zw, xTexelC").concat(t,".xy);\n                "):"\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC".concat(t," = vec4(previous.zw, xTexelC").concat(t,".xy);\n                  } else {\n                    xC").concat(t," = vec4(0.0, 0.0, xTexelC").concat(t,".xy);\n                  }\n                  ")):f+="\n                if (xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                  xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(t,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t,"Ready = 1;\n                }\n\n                xC").concat(t," = xTexelC").concat(t,";\n                "),t+1<h)){const e=s%2===0?o.util.nearestLargerEven(u):u;u%2===0&&s%2===1||u%2!==0&&s%2!==1?(f+="\n                  xCOffset = xC + imod(pads[1], 2) + ".concat(e,";\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                    xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC").concat(t+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(t+1,"Ready = 1;\n                  }\n                  "),f+=u>1?"\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC".concat(t+1," = vec4(previous.zw, xTexelC").concat(t+1,".xy);\n                    } else {\n                     xC").concat(t+1," = vec4(0.0, 0.0, xTexelC").concat(t+1,".xy);\n                    }\n                    "):"\n                    xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".xy);\n                    ")):f+=1===e?"\n                    xC".concat(t+1," = xTexelC").concat(t,";\n                    "):"\n                    xCOffset = xC + ".concat(e,";\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                      xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC").concat(t+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(t+1,"Ready = 1;\n                    }\n\n                    xC").concat(t+1," = xTexelC").concat(t+1,";\n                    ")}}else t<h&&(s%2===1?(f+="\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                  xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(t,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                  xTexelC").concat(t+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC").concat(t+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t+1,"Ready = 1;\n                }\n\n                xC").concat(t," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n              "),t+1<h&&(f+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC".concat(t+1," = vec4(xTexelC").concat(t+1,".xy, final.xy);\n                "))):(f+="\n                if(xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                  xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(t,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t,"Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                  xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(t+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(t+1,"Ready = 1;\n                }\n\n                xC").concat(t," = vec4(\n                  xTexelC").concat(t,".xy, xTexelC").concat(t+1,".xy);\n              "),t+1<h&&(f+="\n                  xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n                "))));t<h&&(f+="\n            wTexel = getW(r, ".concat(t,", d1, q);\n            dotProd += xC").concat(t," * vec4(wTexel.xz, wTexel.xz);\n          "),t+1<h&&(f+="\n              wTexel = getW(r, ".concat(t+1,", d1, q);\n              dotProd += xC").concat(t+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}f+="\n    }\n  ",f+="\n      }\n    ";let p="",g="";n&&(p=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):i?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(n,"\n        }"),g="result = activation(result);");const m=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(p,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(a,";\n        int q = d2 - d1 * ").concat(a,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(f,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(m,"\n        ").concat(g,"\n        setOutput(result);\n      }\n    ")}}const mw={kernelName:o.DepthwiseConv2dNative,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a}=e,{strides:s,pad:c,dilations:u,dimRoundingMode:l}=r;let h=u;null==h&&(h=[1,1]),o.util.assert(o.backend_util.eitherStridesOrDilationsAreOne(s,h),(()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(s," and dilations '").concat(h,"'")));const d=o.backend_util.computeConv2DInfo(i.shape,a.shape,s,h,c,l,!0);let f;f=(0,o.env)().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?new gw(d):new pw(d);const p=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(f,[i,a],"float32",p)}};class yw{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,i=t.padInfo.left,a=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(a," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(e," - ").concat(r,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class vw{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,a=e-1-t.padInfo.top,o=n-1-t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(a,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(e,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(e," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(s,"; dm++) {\n              int d2 = d1 * ").concat(s," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const bw={kernelName:o.DepthwiseConv2dNativeBackpropFilter,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:a}=e,{strides:s,dilations:c,pad:u,dimRoundingMode:l,filterShape:h}=r,d=o.backend_util.computeConv2DInfo(i.shape,h,s,c,u,l,!0),f=new yw(d);return n.runWebGLProgram(f,[i,a],"float32")}};const xw={kernelName:o.DepthwiseConv2dNativeBackpropInput,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:a}=e,{strides:s,dilations:c,pad:u,dimRoundingMode:l,inputShape:h}=r,d=o.backend_util.computeConv2DInfo(h,a.shape,s,c,u,l,!0),f=new vw(d);return n.runWebGLProgram(f,[i,a],"float32")}};class ww{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}const kw={kernelName:o.Diag,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e,i=[...r.shape,...r.shape],a=o.util.sizeFromShape(r.shape),s=Qv({inputs:{x:r},backend:n,attrs:{shape:[a]}}),c=new ww(a),u=n.runWebGLProgram(c,[s],s.dtype),l=Qv({inputs:{x:u},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(u),l}};class _w{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:e,inWidth:n,padInfo:r,strideHeight:i,strideWidth:a,filterHeight:o,filterWidth:s,dilationHeight:c,dilationWidth:u}=t,{top:l,left:h}=r;this.userCode="\n      const ivec2 strides = ivec2(".concat(i,", ").concat(a,");\n      const ivec2 pads = ivec2(").concat(l,", ").concat(h,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(o,"; h++) {\n          int hIn = hBeg + h * ").concat(c,";\n\n          if (hIn >= 0 && hIn < ").concat(e,") {\n            for (int w = 0; w < ").concat(s,"; w++) {\n              int wIn = wBeg + w * ").concat(u,";\n\n              if (wIn >= 0 && wIn < ").concat(n,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}}const Sw={kernelName:o.Dilation2D,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a}=e,{strides:s,pad:c,dilations:u}=r,l=o.backend_util.computeDilation2DInfo(i.shape,a.shape,s,c,"NHWC",u);let h;const d=new _w(l);h=n.runWebGLProgram(d,[i,a],"float32");const f=Qv({inputs:{x:h},backend:n,attrs:{shape:l.outShape}});return n.disposeIntermediateTensorInfo(h),f}};const Aw={kernelName:o.Einsum,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{equation:i}=r,a=e,{allDims:s,summedDims:c,idDims:u}=o.backend_util.decodeEinsumEquation(i,a.length);o.backend_util.checkEinsumDimSizes(s.length,u,a);const{path:l,steps:h}=o.backend_util.getEinsumComputePath(c,u),d=h.length;let f=null,p=s.length;const g=[];for(let m=0;m<d;++m){for(const t of h[m]){const{permutationIndices:e,expandDims:r}=o.backend_util.getEinsumPermutation(p,u[t]);let i;o.backend_util.isIdentityPermutation(e)?i=a[t]:(i=cb({inputs:{x:a[t]},backend:n,attrs:{perm:e}}),g.push(i));const s=i.shape.slice();for(let t=0;t<r.length;++t)s.splice(r[t],0,1);o.util.arraysEqual(i.shape,s)||(i=Qv({inputs:{x:i},backend:n,attrs:{shape:s}}),g.push(i)),null===f?f=i:(f=$v({inputs:{a:i,b:f},backend:n}),g.push(f))}m<d-1&&(l[m]>=0&&(f=ob({inputs:{x:f},backend:n,attrs:{axis:l[m]-(s.length-p),keepDims:!1}}),g.push(f)),p--)}for(const o of g)o!==f&&n.disposeIntermediateTensorInfo(o);return f}},Cw=Vv({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),Ew={kernelName:o.Elu,backendName:"webgl",kernelFunc:Cw},Tw={kernelName:o.EluGrad,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n}=t,{dy:r,y:i}=e,a=(0,o.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Fv("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,i.shape):new Nv("return (b >= 0.0) ? a : a * (b + 1.0);",r.shape,i.shape);return n.runWebGLProgram(a,[r,i],r.dtype)}},Nw=qv({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:dy}),Dw={kernelName:o.Equal,backendName:"webgl",kernelFunc:Nw},Fw=Vv({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(o.backend_util.ERF_P,";\n  float a1 = ").concat(o.backend_util.ERF_A1,";\n  float a2 = ").concat(o.backend_util.ERF_A2,";\n  float a3 = ").concat(o.backend_util.ERF_A3,";\n  float a4 = ").concat(o.backend_util.ERF_A4,";\n  float a5 = ").concat(o.backend_util.ERF_A5,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),Iw={kernelName:o.Erf,backendName:"webgl",kernelFunc:Fw},Mw=Vv({opSnippet:Wv+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:fy,dtype:"float32"}),Ow={kernelName:o.Exp,backendName:"webgl",kernelFunc:Mw};function Rw(t){const{inputs:e,attrs:n,backend:r}=t,{dim:i}=n,{input:a}=e,s=a.shape.length,c=a.shape.slice();let u=i;return i<0&&(o.util.assert(-(s+1)<=i,(()=>"Axis must be in the interval [".concat(-(s+1),", ").concat(s,"]"))),u=s+i+1),c.splice(u,0,1),Qv({inputs:{x:a},backend:r,attrs:{shape:c}})}const zw={kernelName:o.ExpandDims,backendName:"webgl",kernelFunc:Rw},Bw="return exp(x) - 1.0;",Lw=Vv({opSnippet:Bw,packedOpSnippet:Bw,cpuKernelImpl:py}),Pw={kernelName:o.Expm1,backendName:"webgl",kernelFunc:Lw};class jw{constructor(t,e,n){this.variableNames=["real","imag"];const r=e[1];this.outputShape=e;const i=n?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),a=n?"".concat(r,".0"):"1.0";let o;if("real"===t)o="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error('FFT component must be either "real" or "imag", got '.concat(t,"."));o="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(i,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(o,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(r,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(r,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(a,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}}function Uw(t,e,n){const r=n.texData.get(t.dataId),i=o.util.sizeFromShape(t.shape),a=t.shape[t.shape.length-1],s=Qv({inputs:{x:t},backend:n,attrs:{shape:[i/a,a]}}),c=s.shape,u=new jw("real",c,e),l=new jw("imag",c,e),h=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:c},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:c}],d=n.runWebGLProgram(u,h,"float32"),f=n.runWebGLProgram(l,h,"float32"),p=Ov({inputs:{real:d,imag:f},backend:n});n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f);const g=Qv({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(p),g}const Ww={kernelName:o.FFT,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:r}=e;return Uw(r,!1,n)}};class Vw{constructor(t,e){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}}function qw(t){const{backend:e,attrs:n}=t,{shape:r,value:i}=n;let{dtype:a}=n;if(a=a||o.util.inferDtype(i),"string"===a){const t=o.util.getArrayFromDType(a,o.util.sizeFromShape(r));return t.fill(i),e.makeTensorInfo(r,a,t)}{const t=new Vw(r,i),n=[[i]];return e.runWebGLProgram(t,[],a,n)}}const Gw={kernelName:o.Fill,backendName:"webgl",kernelFunc:qw};class Hw{constructor(t){this.variableNames=["Image"],this.outputShape=[];const e=t[2];this.outputShape=t,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(e," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(e,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}const Yw={kernelName:o.FlipLeftRight,backendName:"webgl",kernelFunc:t=>{let{inputs:e,backend:n}=t;const{image:r}=e,i=n,a=new Hw(r.shape);return i.runWebGLProgram(a,[r],r.dtype)}},Xw="return floor(x);",Kw=Vv({opSnippet:Xw,packedOpSnippet:Xw,cpuKernelImpl:gy}),$w={kernelName:o.Floor,backendName:"webgl",kernelFunc:Kw},Zw=qv({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),Qw={kernelName:o.FloorDiv,backendName:"webgl",kernelFunc:Zw};class Jw{constructor(t){this.variableNames=["A"];const e=ym(),[n,r]=t;this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(r,".0, ").concat(n,".0);\n\n        vec4 values = ").concat(e.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")}}class tk{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const e=ym(),[n,r]=t;this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(r,".0, ").concat(n,".0);\n            vec4 values = ").concat(e.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(e.output," = result;\n      }\n    ")}}const ek={kernelName:o.FromPixels,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:i}=e;const{numChannels:a}=r,s="undefined"!==typeof HTMLVideoElement&&i instanceof HTMLVideoElement,c="undefined"!==typeof HTMLImageElement&&i instanceof HTMLImageElement,[u,l]=s?[i.videoWidth,i.videoHeight]:[i.width,i.height],h=[l,u],d=[l,u,a];if(c||s){const t=(0,o.env)().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=nk&&t===rk||(rk=t,nk=document.createElement("canvas").getContext("2d",{willReadFrequently:rk})),nk.canvas.width=u,nk.canvas.height=l,nk.drawImage(i,0,0,u,l),i=nk.canvas}const f=n.makeTensorInfo(h,"int32");n.texData.get(f.dataId).usage=Pg.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(f.dataId),i);const p=(0,o.env)().getBool("WEBGL_PACK")?new tk(d):new Jw(d),g=n.runWebGLProgram(p,[f],"int32");return n.disposeData(f.dataId),g}};let nk,rk=(0,o.env)().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");const ik={kernelName:o.FusedConv2D,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a,bias:s,preluActivationWeights:c}=e,{strides:u,pad:l,dataFormat:h,dilations:d,dimRoundingMode:f,activation:p,leakyreluAlpha:g}=r,m=o.backend_util.convertConv2DDataFormat(h),y=o.backend_util.computeConv2DInfo(i.shape,a.shape,u,d,l,f,!1,m);let v;const b=[],x=null!=s,w=null!=c,k="leakyrelu"===p,_=()=>{const t=[i,a],e=(t,e)=>{if("NCHW"===e&&1===t.shape.length&&1!==t.shape[0]){const e=Qv({inputs:{x:t},backend:n,attrs:{shape:[t.shape[0],1,1]}});return b.push(e),e}return t};if(x&&t.push(e(s,h)),w&&t.push(e(c,h)),k){const e=n.makeTensorInfo([],"float32",o.util.createScalarValue(g,"float32"));t.push(e),b.push(e)}return t};if(1!==y.filterHeight||1!==y.filterWidth||1!==y.dilationHeight||1!==y.dilationWidth||1!==y.strideHeight||1!==y.strideWidth||"SAME"!==y.padInfo.type&&"VALID"!==y.padInfo.type)if(y.strideWidth<=2&&"channelsLast"===m&&(0,o.env)().getBool("WEBGL_EXP_CONV")){const t=p?Gv(p,!0):null,e=new zx(y,x,t,w,k),r=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],i=_();v=n.runWebGLProgram(e,i,"float32",r)}else if((0,o.env)().getBool("WEBGL_CONV_IM2COL"))v=jx({x:i,filter:a,convInfo:y,backend:n,bias:s,activation:p,preluActivationWeights:c,leakyreluAlpha:g});else{const t=p?Gv(p,!1):null,e=new Ox(y,x,t,w,k),r=_();v=n.runWebGLProgram(e,r,"float32")}else v=Px({x:i,filter:a,convInfo:y,backend:n,bias:s,activation:p,preluActivationWeights:c,leakyreluAlpha:g});const S=Qv({inputs:{x:v},backend:n,attrs:{shape:y.outShape}});return b.push(v),b.forEach((t=>n.disposeIntermediateTensorInfo(t))),S}};const ak={kernelName:o.FusedDepthwiseConv2D,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a,bias:s,preluActivationWeights:c}=e,{strides:u,pad:l,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=r,g=[];let m=h;null==m&&(m=[1,1]),o.util.assert(o.backend_util.eitherStridesOrDilationsAreOne(u,m),(()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(u," and dilations '").concat(m,"'")));const y=o.backend_util.computeConv2DInfo(i.shape,a.shape,u,m,l,d,!0),v=(0,o.env)().getBool("WEBGL_PACK_DEPTHWISECONV")&&y.strideWidth<=2&&y.outChannels/y.inChannels===1,b=f?Gv(f,v):null,x=[i,a],w=null!=s,k=null!=c,_="leakyrelu"===f;if(w&&x.push(s),k&&x.push(c),_){const t=n.makeTensorInfo([],"float32",o.util.createScalarValue(p,"float32"));x.push(t),g.push(t)}let S;S=v?new gw(y,w,b,k,_):new pw(y,w,b,k,_);const A=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],C=n.runWebGLProgram(S,x,"float32",A);return g.forEach((t=>n.disposeIntermediateTensorInfo(t))),C}};class ok{constructor(t,e,n,r){this.sliceDim=t,this.strides=e,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=n;const i=Mm(n.length);let a="\n    int index;";for(let o=0;o<this.sliceDim;o++)a+="\n          index = round(getIndices(coords[0], ".concat(o,"));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ").concat(this.paramsShape[o],";\n          flattenIndex += index * ").concat(this.strides[o],";");this.userCode="\n         void main() {\n          ".concat(i," coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ").concat(a,"\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      ")}}const sk={kernelName:o.GatherNd,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{params:r,indices:i}=e,a=i.shape,s=a[a.length-1],c=o.util.sizeFromShape(r.shape),[u,l,h,d]=o.backend_util.prepareAndValidate(r,i),f=Qv({inputs:{x:i},backend:n,attrs:{shape:[l,s]}}),p=Qv({inputs:{x:r},backend:n,attrs:{shape:[o.util.sizeFromShape(r.shape)/h,h]}});if(n.shouldExecuteOnCPU([r,i])||"string"===r.dtype){const t=n.readSync(i.dataId),e=n.bufferSync(r),a=my(t,e,r.dtype,l,s,h,d,r.shape,c);return n.makeTensorInfo(u,r.dtype,a.values)}const g=new ok(s,d,[l,h],r.shape),m=n.runWebGLProgram(g,[p,f],p.dtype),y=Qv({inputs:{x:m},backend:n,attrs:{shape:u}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),y}};class ck{constructor(t,e){this.variableNames=["A","indices"],this.outputShape=e,this.rank=e.length;const n=Mm(this.rank),r=function(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let i=0;i<t.length;i++)2===i?r.push("index"):r.push("".concat(n[i]));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(n," resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ").concat(t[2],") ? 1.0 : 0.0;\n        setOutput(inBounds * getA(").concat(r,"));\n      }\n    ")}}function uk(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,indices:a}=e,{axis:s,batchDims:c}=r,u=o.util.parseAxisParam(s,i.shape)[0];if((0,o.env)().get("DEBUG")){const t=n.readSync(a.dataId),e=i.shape[u];for(let n=0;n<t.length;++n){const r=t[n];o.util.assert(r<=e-1&&r>=0,(()=>"GatherV2: the index value ".concat(r," is not in [0, ").concat(e-1,"]")))}}const l=o.backend_util.segment_util.collectGatherOpShapeInfo(i,a,u,c),h=o.util.sizeFromShape(a.shape),d=[],f=Qv({inputs:{x:i},backend:n,attrs:{shape:[l.batchSize,l.outerSize,l.dimSize,l.sliceSize]}}),p=Qv({inputs:{x:a},backend:n,attrs:{shape:[l.batchSize,h/l.batchSize]}});d.push(f),d.push(p);const g=[l.batchSize,l.outerSize,h/l.batchSize,l.sliceSize];if(n.shouldExecuteOnCPU([i,a])||"string"===i.dtype){const t=n.bufferSync(p),e=n.bufferSync(f),r=yy(e,t,g);return d.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.makeTensorInfo(l.outputShape,r.dtype,r.values)}const m=new ck(f.shape,g),y=n.runWebGLProgram(m,[f,p],f.dtype);d.push(y);const v=Qv({inputs:{x:y},backend:n,attrs:{shape:l.outputShape}});return d.forEach((t=>n.disposeIntermediateTensorInfo(t))),v}const lk={kernelName:o.GatherV2,backendName:"webgl",kernelFunc:uk},hk=qv({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:vy,dtype:"bool"}),dk={kernelName:o.Greater,backendName:"webgl",kernelFunc:hk},fk=qv({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:by}),pk={kernelName:o.GreaterEqual,backendName:"webgl",kernelFunc:fk};const gk={kernelName:o.IFFT,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:r}=e;return Uw(r,!0,n)}},mk=Vv({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),yk={kernelName:o.IsFinite,backendName:"webgl",kernelFunc:mk},vk=Vv({opSnippet:"return float(isinf(x));",dtype:"bool"}),bk={kernelName:o.IsInf,backendName:"webgl",kernelFunc:vk},xk=Vv({opSnippet:"return float(isnan(x));",dtype:"bool"}),wk={kernelName:o.IsNan,backendName:"webgl",kernelFunc:xk},kk=qv({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:xy,dtype:"bool"}),_k={kernelName:o.Less,backendName:"webgl",kernelFunc:kk},Sk=qv({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:wy,dtype:"bool"}),Ak={kernelName:o.LessEqual,backendName:"webgl",kernelFunc:Sk};const Ck={kernelName:o.LinSpace,backendName:"webgl",kernelFunc:function(t){const{backend:e,attrs:n}=t,{start:r,stop:i,num:a}=n,o=ky(r,i,a);return e.makeTensorInfo([o.length],"float32",o)}},Ek=Vv({opSnippet:Wv+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:_y}),Tk={kernelName:o.Log,backendName:"webgl",kernelFunc:Ek},Nk=Vv({opSnippet:Wv+"\n  return log(1.0 + x);\n"}),Dk={kernelName:o.Log1p,backendName:"webgl",kernelFunc:Nk},Fk=qv({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),Ik={kernelName:o.LogicalAnd,backendName:"webgl",kernelFunc:Fk},Mk=Vv({opSnippet:"return float(!(x >= 1.0));"}),Ok={kernelName:o.LogicalNot,backendName:"webgl",kernelFunc:Mk},Rk=qv({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),zk={kernelName:o.LogicalOr,backendName:"webgl",kernelFunc:Rk};class Bk{constructor(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[];const a=e,o=t[3]-1;let s;this.outputShape=t;const c="float(".concat(n,") + float(").concat(r,") * sum");s=.5===i?"inversesqrt(".concat(c,")"):1===i?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(a,"; j <= ").concat(a,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(o,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(s,";\n        setOutput(val);\n      }\n    ")}}class Lk{constructor(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const a=e,o=t[3]-1;let s;this.outputShape=t;const c="float(".concat(n,") + float(").concat(r,") * sum");s=.5===i?"inversesqrt(".concat(c,")"):1===i?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(a,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(a,"; j <= ").concat(a,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(o,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(s,";\n        setOutput(result);\n      }\n    ")}}const Pk={kernelName:o.LRN,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{depthRadius:a,bias:s,alpha:c,beta:u}=r,l=(0,o.env)().getBool("WEBGL_PACK_NORMALIZATION")?new Lk(i.shape,a,s,c,u):new Bk(i.shape,a,s,c,u);return n.runWebGLProgram(l,[i],i.dtype)}};class jk{constructor(t,e,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(e,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(e," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(r,") * norm + float(").concat(n,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(r,")\n                * float(").concat(i,")\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(i,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")}}const Uk={kernelName:o.LRNGrad,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i,y:a,dy:o}=e,{depthRadius:s,bias:c,alpha:u,beta:l}=r,h=new jk(i.shape,s,c,u,l);return n.runWebGLProgram(h,[i,a,o],i.dtype)}};function Wk(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{reductionIndices:a,keepDims:s}=r,c=i.shape.length,u=o.util.parseAxisParam(a,i.shape);let l=u;const h=o.backend_util.getAxesPermutation(l,c),d=null!=h,f=n.shouldExecuteOnCPU([i]);let p=i;if(d){if(f){const t=n.texData.get(p.dataId).values,e=new Array(c);for(let n=0;n<e.length;n++)e[n]=i.shape[h[n]];const r=Qy(t,i.shape,i.dtype,h,e);p=n.makeTensorInfo(e,i.dtype);n.texData.get(p.dataId).values=r}else p=ab(i,h,n);l=o.backend_util.getInnerMostAxes(l.length,c)}o.backend_util.assertAxesAreInnerMostDims("max",l,c);const[g,m]=o.backend_util.computeOutAndReduceShapes(p.shape,l);let y,v=g;if(s&&(v=o.backend_util.expandShapeToKeepDim(g,u)),f){const t=n.texData.get(p.dataId).values,e=Sy(t,o.util.sizeFromShape(m),v,i.dtype);y=n.makeTensorInfo(v,i.dtype);n.texData.get(y.dataId).values=e}else y=function(t,e,n,r){const i=o.util.sizeFromShape(e),a=Qv({inputs:{x:t},attrs:{shape:[o.util.sizeFromShape(t.shape)/i,i]},backend:r}),s=nb(a,t.dtype,"max",r),c=Qv({inputs:{x:s},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(s),c}(p,m,v,n);return d&&n.disposeIntermediateTensorInfo(p),y}const Vk={kernelName:o.Max,backendName:"webgl",kernelFunc:Wk},qk=qv({opSnippet:Tv+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Dv+"\n  return result;\n",cpuKernelImpl:Ay}),Gk={kernelName:o.Maximum,backendName:"webgl",kernelFunc:qk};const Hk={kernelName:o.MaxPool,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e;gm(i,"maxPool");const{filterSize:a,strides:s,pad:c,dimRoundingMode:u}=r;o.util.assert(o.backend_util.eitherStridesOrDilationsAreOne(s,1),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(1,"'")));const l=o.backend_util.computePool2DInfo(i.shape,a,s,1,c,u);if(1===l.filterWidth&&1===l.filterHeight&&o.util.arraysEqual(l.inShape,l.outShape))return Iv({inputs:{x:i},backend:n});const h=new qb(l,"max",!1);return n.runWebGLProgram(h,[i],i.dtype)}};const Yk={kernelName:o.MaxPool3D,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{filterSize:a,strides:s,pad:c,dataFormat:u,dimRoundingMode:l}=r,h=o.backend_util.computePool3DInfo(i.shape,a,s,[1,1,1],c,l,u),d=new Gb(h,"max",!1);return n.runWebGLProgram(d,[i],i.dtype)}};class Xk{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideHeight,n=t.strideWidth,r=t.dilationHeight,i=t.effectiveFilterHeight,a=t.effectiveFilterWidth,o=i-1-t.padInfo.top,s=a-1-t.padInfo.left,c=i*a-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(i,";\n          wR += ").concat(r,") {\n          float dyR = float(dyRCorner + wR) / ").concat(e,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(a,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(n,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(c," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(a," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class Kk{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,i=t.dilationDepth,a=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterDepth,c=t.effectiveFilterHeight,u=t.effectiveFilterWidth,l=s-1-t.padInfo.front,h=c-1-t.padInfo.top,d=u-1-t.padInfo.left,f=s*c*u-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(l,", ").concat(h,", ").concat(d,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(s,";\n           wD += ").concat(i,") {\n          float dyD = float(dyDCorner + wD) / ").concat(e,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(c,";\n              wR += ").concat(a,") {\n            float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(u,";\n                wC += ").concat(o,") {\n              float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(f," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(c," * ").concat(u," +\n                  wR * ").concat(u," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const $k={kernelName:o.MaxPool3DGrad,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:a}=e,s=a,{filterSize:c,strides:u,pad:l,dimRoundingMode:h}=r,d=o.backend_util.computePool3DInfo(s.shape,c,u,[1,1,1],l,h),f=new Gb(d,"max",!0),p=n.runWebGLProgram(f,[s],s.dtype),g=new Kk(d),m=n.runWebGLProgram(g,[i,p],s.dtype);return n.disposeIntermediateTensorInfo(p),m}};const Zk={kernelName:o.MaxPoolGrad,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:a,output:s}=e,c=a;gm([a,s],"maxPoolGrad");const{filterSize:u,strides:l,pad:h,dimRoundingMode:d}=r,f=o.backend_util.computePool2DInfo(c.shape,u,l,1,h,d),p=new qb(f,"max",!0),g=n.runWebGLProgram(p,[c],c.dtype),m=new Xk(f),y=n.runWebGLProgram(m,[i,g],c.dtype);return n.disposeIntermediateTensorInfo(g),y}};const Qk={kernelName:o.MaxPoolWithArgmax,backendName:"webgl",kernelFunc:t=>{let{inputs:e,attrs:n,backend:r}=t;const{x:i}=e,{filterSize:a,strides:s,pad:c,includeBatchInIndex:u}=n,l=r;o.util.assert(4===i.shape.length,(()=>"Error in maxPool: input must be rank 4 but got rank ".concat(i.shape.length,".")));const h=[1,1];o.util.assert(o.backend_util.eitherStridesOrDilationsAreOne(s,h),(()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(h,"'")));const d=o.backend_util.computePool2DInfo(i.shape,a,s,h,c),[f,p]=function(t,e,n,r){let i=new qb(n,"max",!1);const a=r.runWebGLProgram(i,[t],"float32");return i=new qb(n,"max",!0,!0,e),[a,r.runWebGLProgram(i,[t],"float32")]}(i,u,d,l);return[f,p]}};const Jk={kernelName:o.Mean,backendName:"webgl",kernelFunc:t=>{let{inputs:e,attrs:n,backend:r}=t;const{x:i}=e,{keepDims:a,axis:s}=n,c=r,u=i.shape.length,l=o.util.parseAxisParam(s,i.shape);let h=l;const d=o.backend_util.getAxesPermutation(h,u),f=null!=d,p=c.shouldExecuteOnCPU([i]),g=[];let m=i;if(f){if(p){const t=c.texData.get(m.dataId).values,e=new Array(u);for(let r=0;r<e.length;r++)e[r]=i.shape[d[r]];const n=Qy(t,i.shape,i.dtype,d,e);m=c.makeTensorInfo(e,i.dtype);c.texData.get(m.dataId).values=n}else m=ab(i,d,c);g.push(m),h=o.backend_util.getInnerMostAxes(h.length,u)}o.backend_util.assertAxesAreInnerMostDims("sum",h,u);const[y,v]=o.backend_util.computeOutAndReduceShapes(m.shape,h);let b=y;a&&(b=o.backend_util.expandShapeToKeepDim(y,l));const x=function(t,e,n,r){const i=o.util.sizeFromShape(e),a=Qv({inputs:{x:t},attrs:{shape:[o.util.sizeFromShape(t.shape)/i,i]},backend:r}),s=nb(a,"float32","mean",r),c=Qv({inputs:{x:s},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(s),c}(m,v,b,c);for(const o of g)c.disposeIntermediateTensorInfo(o);return x}};const t_={kernelName:o.Min,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,keepDims:s}=r,c=i.shape.length,u=o.util.parseAxisParam(a,i.shape);let l=u;const h=o.backend_util.getAxesPermutation(l,c);let d=i;null!=h&&(d=cb({inputs:{x:i},backend:n,attrs:{perm:h}}),l=o.backend_util.getInnerMostAxes(l.length,i.shape.length)),o.backend_util.assertAxesAreInnerMostDims("min",l,c);const[f,p]=o.backend_util.computeOutAndReduceShapes(d.shape,l),g=Qv({inputs:{x:d},backend:n,attrs:{shape:[-1,o.util.sizeFromShape(p)]}}),m=nb(g,g.dtype,"min",n);let y;if(s){y=Qv({inputs:{x:m},backend:n,attrs:{shape:o.backend_util.expandShapeToKeepDim(f,u)}})}else y=Qv({inputs:{x:m},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),null!=h&&n.disposeIntermediateTensorInfo(d),y}},e_=qv({opSnippet:Tv+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Dv+"\n  return result;\n",cpuKernelImpl:Cy}),n_={kernelName:o.Minimum,backendName:"webgl",kernelFunc:e_};class r_{constructor(t,e,n){this.variableNames=["x"],this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const r=t.length,i=Mm(r),a=e.map((t=>t[0])).join(","),o=e.map(((e,n)=>e[0]+t[n])).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),c="reflect"===n?0:1;this.userCode=1!==r?"\n      ".concat(i," start = ").concat(i,"(").concat(a,");\n      ").concat(i," end = ").concat(i,"(").concat(o,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(r,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(c,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(c,";\n          }\n        }\n        ").concat(i," coords = outC - start;\n        setOutput(getX(").concat(s,"));\n      }\n    "):"\n        int start = ".concat(a,";\n        int end = ").concat(o,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(c,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(c,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")}}class i_{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const r=t.length,i=Mm(r),a=e.map((t=>t[0])).join(","),o=e.map(((e,n)=>e[0]+t[n])).join(","),s=ev("rc",r),c=ev("source",r),u="".concat(s[r-1]," < ").concat(this.outputShape[r-1]),l=1===r?"source":"vec2(".concat(c.slice(-2).join(),")"),h="reflect"===n?0:1;let d="";if(1===r){const t="\n        ".concat(i," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(h,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(h,";\n        }\n        source -= start;\n      ");d="\n        ".concat(i," rc = outputLoc;\n        ").concat(t,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(l,");\n        ").concat(s[r-1]," += 1;\n        if(").concat(u,") {\n          ").concat(t,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(l,");\n        }\n      ")}else{const t="\n        ".concat(i," source = rc;\n        ").concat(i," lt = ").concat(i,"(lessThan(source, start));\n        ").concat(i," gte = ").concat(i,"(greaterThanEqual(source, end));\n        ").concat(i," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(h,") +\n                gte * ((end - 1) * 2 - source + ").concat(h,");\n        source -= start;\n      ");d="\n        ".concat(i," rc = outputLoc;\n        ").concat(t,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(l,");\n        ").concat(s[r-1]," += 1;\n        if(").concat(u,") {\n          ").concat(t,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(l,");\n        }\n        rc = outputLoc;\n        ").concat(s[r-2]," += 1;\n        if(").concat(s[r-2]," < ").concat(this.outputShape[r-2],") {\n          ").concat(t,"\n          result[2] = getChannel(getX(").concat(c.join(),"), ").concat(l,");\n          ").concat(s[r-1]," += 1;\n          if(").concat(u,") {\n            ").concat(t,"\n            result[3] = getChannel(getX(").concat(c.join(),"), ").concat(l,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(a,");\n      const ").concat(i," end = ").concat(i,"(").concat(o,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(d,"\n        setOutput(result);\n      }\n    ")}}const a_={kernelName:o.MirrorPad,backendName:"webgl",kernelFunc:t=>{let{inputs:e,backend:n,attrs:r}=t;const{x:i}=e,{paddings:a,mode:s}=r,c=(0,o.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new i_(i.shape,a,s):new r_(i.shape,a,s);return n.runWebGLProgram(c,[i],i.dtype)}},o_=qv({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+Dv+"\n  return result;\n"}),s_={kernelName:o.Mod,backendName:"webgl",kernelFunc:o_};class c_{constructor(t,e,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(e-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(e-1,"));\n      }\n    ")}}const u_=qv({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),l_={kernelName:o.RealDiv,backendName:"webgl",kernelFunc:u_},h_="return a - b;",d_=qv({opSnippet:h_,packedOpSnippet:h_,supportsComplex:!0,cpuKernelImpl:Ky}),f_={kernelName:o.Sub,backendName:"webgl",kernelFunc:d_};function p_(t){const{inputs:e,backend:n,attrs:r}=t,{logits:i}=e,{dim:a}=r,s=o.util.parseAxisParam([a],i.shape),c=Wk({inputs:{x:i},backend:n,attrs:{reductionIndices:s,keepDims:!1}}),u=o.backend_util.expandShapeToKeepDim(c.shape,s),l=Qv({inputs:{x:c},backend:n,attrs:{shape:u}}),h=d_({inputs:{a:i,b:l},backend:n}),d=Mw({inputs:{x:h},backend:n}),f=ob({inputs:{x:d},backend:n,attrs:{axis:s,keepDims:!1}}),p=Qv({inputs:{x:f},backend:n,attrs:{shape:u}}),g=u_({inputs:{a:d,b:p},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),g}const g_={kernelName:o.Softmax,backendName:"webgl",kernelFunc:p_};const m_={kernelName:o.Multinomial,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{logits:i}=e,{numSamples:a,seed:o,normalized:s}=r,c=s?i:p_({inputs:{logits:i},backend:n,attrs:{dim:i.shape.length-1}}),u=c.shape[0],l=c.shape[1],h=new c_(u,l,a),d=[[o]],f=n.runWebGLProgram(h,[c],"int32",d);return s||n.disposeIntermediateTensorInfo(c),f}},y_=uv+"\n  return -x;\n";const v_={kernelName:o.Neg,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const t=n.texData.get(r.dataId),[e,i]=Ty(t.values,r.shape,r.dtype);return n.makeTensorInfo(i,r.dtype,e)}let i;return i=(0,o.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new kv(r.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new cv(r.shape,y_),n.runWebGLProgram(i,[r],r.dtype)}},b_=o.kernel_impls.nonMaxSuppressionV3Impl;const x_={kernelName:o.NonMaxSuppressionV3,backendName:"webgl",kernelFunc:function(t){o.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:a}=e,{maxOutputSize:s,iouThreshold:c,scoreThreshold:u}=r,l=n.readSync(i.dataId),h=n.readSync(a.dataId),{selectedIndices:d}=b_(l,h,s,c,u);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}},w_=o.kernel_impls.nonMaxSuppressionV4Impl;const k_={kernelName:o.NonMaxSuppressionV4,backendName:"webgl",kernelFunc:function(t){o.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:a}=e,{maxOutputSize:s,iouThreshold:c,scoreThreshold:u,padToMaxOutputSize:l}=r,h=n.readSync(i.dataId),d=n.readSync(a.dataId),{selectedIndices:f,validOutputs:p}=w_(h,d,s,c,u,l);return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},__=o.kernel_impls.nonMaxSuppressionV5Impl;const S_={kernelName:o.NonMaxSuppressionV5,backendName:"webgl",kernelFunc:function(t){o.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:a}=e,{maxOutputSize:s,iouThreshold:c,scoreThreshold:u,softNmsSigma:l}=r,h=n.readSync(i.dataId),d=n.readSync(a.dataId),f=s,p=c,g=u,m=l,{selectedIndices:y,selectedScores:v}=__(h,d,f,p,g,m);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([v.length],"float32",new Float32Array(v))]}};class A_{constructor(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(r,"), float(").concat(n,"),\n                      float(index == coords.y)));\n      }\n    ")}}const C_={kernelName:o.OneHot,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:i}=e,{dtype:a,depth:s,onValue:c,offValue:u}=r,l=o.util.sizeFromShape(i.shape),h=new A_(l,s,c,u),d=Qv({inputs:{x:i},backend:n,attrs:{shape:[l]}}),f=n.runWebGLProgram(h,[d],a);n.disposeIntermediateTensorInfo(d);const p=Qv({inputs:{x:f},backend:n,attrs:{shape:[...i.shape,s]}});return n.disposeIntermediateTensorInfo(f),p}};function E_(t){const{inputs:e,backend:n}=t,{x:r}=e;if("complex64"===r.dtype){const t=fx({inputs:{input:r},backend:n}),e=E_({inputs:{x:t},backend:n}),i=Nx({inputs:{input:r},backend:n}),a=E_({inputs:{x:i},backend:n}),o=Ov({inputs:{real:e,imag:a},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),o}return qw({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}const T_={kernelName:o.ZerosLike,backendName:"webgl",kernelFunc:E_};const N_={kernelName:o.OnesLike,backendName:"webgl",kernelFunc:function t(e){const{inputs:n,backend:r}=e,{x:i}=n;if("string"===i.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===i.dtype){const e=fx({inputs:{input:i},backend:r}),n=t({inputs:{x:e},backend:r}),a=Nx({inputs:{input:i},backend:r}),o=E_({inputs:{x:a},backend:r}),s=Ov({inputs:{real:n,imag:o},backend:r});return r.disposeIntermediateTensorInfo(e),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(o),s}return qw({attrs:{shape:i.shape,dtype:i.dtype,value:1},backend:r})}};const D_={kernelName:o.Pack,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{axis:i}=r;if(1===e.length)return Rw({inputs:{input:e[0]},backend:n,attrs:{dim:i}});const a=e[0].shape,s=e[0].dtype;e.forEach((t=>{o.util.assertShapesMatch(a,t.shape,"All tensors passed to stack must have matching shapes"),o.util.assert(s===t.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const c=[],u=Ix({inputs:e.map((t=>{const e=Rw({inputs:{input:t},backend:n,attrs:{dim:i}});return c.push(e),e})),backend:n,attrs:{axis:i}});return c.forEach((t=>n.disposeIntermediateTensorInfo(t))),u}};class F_{constructor(t,e,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const r=t.length,i=Mm(r),a=e.map((t=>t[0])).join(","),o=e.map(((e,n)=>e[0]+t[n])).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      ".concat(i," start = ").concat(i,"(").concat(a,");\n      ").concat(i," end = ").concat(i,"(").concat(o,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(i," coords = outC - start;\n          setOutput(getX(").concat(s,"));\n        }\n      }\n    "):"\n        int start = ".concat(a,";\n        int end = ").concat(o,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")}}class I_{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map(((e,n)=>e[0]+t[n]+e[1]));const r=t.length,i=Mm(r),a=e.map((t=>t[0])).join(","),o=e.map(((e,n)=>e[0]+t[n])).join(","),s=ev("rc",r),c=ev("source",r),u="".concat(s[r-1]," < ").concat(this.outputShape[r-1]),l=1===r?"source":"vec2(".concat(c.slice(-2).join(),")"),h=["".concat(i," rc = outputLoc;"),"".concat(s[r-1]," += 1;\n       if(").concat(u,") {\n      "),1===r?"":"}\n       rc = outputLoc;\n       ".concat(s[r-2]," += 1;\n       if(").concat(s[r-2]," < ").concat(this.outputShape[r-2],") {"),1===r?"":"  ".concat(s[r-1]," += 1;\n         if(").concat(u,") {")],d=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let f="";for(let p=0,g=1===r?2:4;p<g;p++)f+="\n        ".concat(h[p],"\n        if (").concat(d,") {\n          result[").concat(p,"] = float(value);\n        } else {\n          ").concat(i," source = rc - start;\n          result[").concat(p,"] = getChannel(getX(").concat(c.join(),"), ").concat(l,");\n        }\n      ");f+=1===r?"} ":"}}",this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(a,");\n      const ").concat(i," end = ").concat(i,"(").concat(o,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(f,"\n        setOutput(result);\n      }\n    ")}}const M_=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{paddings:a,constantValue:s}=r;if(0===o.util.sizeFromShape(i.shape)){const t=a.map(((t,e)=>t[0]+i.shape[e]+t[1]));return qw({backend:n,attrs:{shape:t,value:s,dtype:i.dtype}})}const c=(0,o.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new I_(i.shape,a,s):new F_(i.shape,a,s),u=[[s]];return n.runWebGLProgram(c,[i],i.dtype,u)},O_={kernelName:o.PadV2,backendName:"webgl",kernelFunc:M_},R_=qv({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+Dv+"\n  return result;\n"}),z_={kernelName:o.Pow,backendName:"webgl",kernelFunc:R_};const B_={kernelName:o.Prod,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:a,keepDims:s}=r,c=i.shape.length,u=[],l=o.util.parseAxisParam(a,i.shape);let h=l;const d=o.backend_util.getAxesPermutation(h,c);let f,p=i;if(null!=d&&(p=cb({inputs:{x:i},backend:n,attrs:{perm:d}}),h=o.backend_util.getInnerMostAxes(h.length,c),u.push(p)),o.backend_util.assertAxesAreInnerMostDims("prod",h,c),n.shouldExecuteOnCPU([p])){const t=n.texData.get(p.dataId).values,{outVals:e,outShape:r,outDtype:i}=Dy(p.shape,p.dtype,t,h);f=n.makeTensorInfo(r,i,e)}else{const[t,e]=o.backend_util.computeOutAndReduceShapes(p.shape,h),r=o.util.sizeFromShape(e),a=Qv({inputs:{x:p},backend:n,attrs:{shape:[-1,r]}}),s=nb(a,(0,o.sumOutType)(i.dtype),"prod",n);f=Qv({inputs:{x:s},backend:n,attrs:{shape:t}}),u.push(a),u.push(s)}if(s){u.push(f);const t=o.backend_util.expandShapeToKeepDim(f.shape,l);f=Qv({inputs:{x:f},backend:n,attrs:{shape:t}})}return u.forEach((t=>n.disposeIntermediateTensorInfo(t))),f}};const L_={kernelName:o.RaggedGather,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:i,paramsDenseValues:a,indices:o}=e,{outputRaggedRank:s}=r,c=i.map((t=>n.readSync(t.dataId))),u=i.map((t=>t.shape)),l=n.readSync(a.dataId),h=n.readSync(o.dataId),[d,f,p]=Fy(c,u,l,a.shape,a.dtype,h,o.shape,s),g=d.map((t=>n.makeTensorInfo([t.length],"int32",t))),m=n.makeTensorInfo(p,a.dtype,f);return g.concat([m])}};const P_={kernelName:o.RaggedRange,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{starts:r,limits:i,deltas:a}=e,o=n.readSync(r.dataId),s=n.readSync(i.dataId),c=n.readSync(a.dataId),[u,l]=Iy(o,r.shape,r.dtype,s,i.shape,c,a.shape);return[n.makeTensorInfo([u.length],"int32",u),n.makeTensorInfo([l.length],r.dtype,l)]}};const j_={kernelName:o.RaggedTensorToTensor,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{shape:i,values:a,defaultValue:o,rowPartitionTensors:s}=e,{rowPartitionTypes:c}=r,u=n.readSync(i.dataId),l=n.readSync(a.dataId),h=n.readSync(o.dataId),d=s.map((t=>n.readSync(t.dataId))),f=s.map((t=>t.shape)),[p,g]=My(u,i.shape,l,a.shape,a.dtype,h,o.shape,d,f,c);return n.makeTensorInfo(p,a.dtype,g)}},U_=t=>{const{backend:e,attrs:n}=t,{start:r,stop:i,step:a,dtype:o}=n,s=Oy(r,i,a,o);return e.makeTensorInfo([s.length],o,s)},W_={kernelName:o.Range,backendName:"webgl",kernelFunc:U_},V_=Vv({opSnippet:"return 1.0 / x;"}),q_={kernelName:o.Reciprocal,backendName:"webgl",kernelFunc:V_},G_=Vv({opSnippet:uv+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),H_={kernelName:o.Relu,backendName:"webgl",kernelFunc:G_},Y_=Vv({opSnippet:uv+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),X_={kernelName:o.Relu6,backendName:"webgl",kernelFunc:Y_};class K_{constructor(t,e,n,r,i){this.variableNames=["A"],this.outputShape=[];const[a,o,s,c]=t;this.outputShape=[a,e,n,c];const u=[r&&e>1?o-1:o,r&&n>1?s-1:s],l=[r&&e>1?e-1:e,r&&n>1?n-1:n];let h;h=i?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(u[0]/l[0],",\n          ").concat(u[1]/l[1],");\n      const vec2 inputShapeRC = vec2(").concat(o,".0, ").concat(s,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")}}class $_{constructor(t,e,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,o,s,c]=t;this.outputShape=[a,e,n,c];const u=[r&&e>1?o-1:o,r&&n>1?s-1:s],l=[r&&e>1?e-1:e,r&&n>1?n-1:n];let h;h=i?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(u[0]/l[0],",\n          ").concat(u[1]/l[1],",\n          ").concat(u[1]/l[1],");\n      const vec3 inputShapeRC = vec3(").concat(o,".0, ").concat(s,".0,\n                                     ").concat(s,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(c-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}}const Z_={kernelName:o.ResizeBilinear,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:i}=e,{alignCorners:a,halfPixelCenters:s,size:c}=r,[u,l]=c,h=(0,o.env)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new $_(i.shape,u,l,a,s):new K_(i.shape,u,l,a,s);return n.runWebGLProgram(h,[i],"float32")}};class Q_{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,r,i]=e,[,a,o]=t,s=[n&&a>1?r-1:r,n&&o>1?i-1:i],c=[n&&a>1?a-1:a,n&&o>1?o-1:o],u=s[0]/c[0],l=s[1]/c[1],h=1/u,d=1/l,f=2*Math.ceil(h)+2,p=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(u,");\n        const float widthScale = float(").concat(l,");\n\n        const float invHeightScale = float(").concat(h,");\n        const float invWidthScale = float(").concat(d,");\n\n        const int winHeight = int(").concat(f,");\n        const int winWidth = int(").concat(p,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(a,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(o,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(r-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(i-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}const J_={kernelName:o.ResizeBilinearGrad,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:i,dy:a}=e,{alignCorners:o}=r,s=new Q_(a.shape,i.shape,o);return n.runWebGLProgram(s,[a],a.dtype)}};class tS{constructor(t,e,n,r,i){this.variableNames=["A"],this.outputShape=[];const[a,o,s,c]=t;this.outputShape=[a,e,n,c];const u=[r&&e>1?o-1:o,r&&n>1?s-1:s],l=[r&&e>1?e-1:e,r&&n>1?n-1:n],h=r?"0.5":"0.0";let d;d=i?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(u[0]/l[0],",\n          ").concat(u[1]/l[1],");\n      const vec2 inputShapeRC = vec2(").concat(o,".0, ").concat(s,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(h,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")}}class eS{constructor(t,e,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,o,s,c]=t;this.outputShape=[a,e,n,c];const u=[r&&e>1?o-1:o,r&&n>1?s-1:s],l=[r&&e>1?e-1:e,r&&n>1?n-1:n],h=r?"0.5":"0.0";let d;d=i?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(u[0]/l[0],",\n          ").concat(u[1]/l[1],",\n          ").concat(u[1]/l[1],");\n      const vec3 inputShapeRC = vec3(").concat(o,".0, ").concat(s,".0,\n                                     ").concat(s,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(h,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(c-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")}}const nS={kernelName:o.ResizeNearestNeighbor,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:i}=e,{alignCorners:a,halfPixelCenters:s,size:c}=r,[u,l]=c,h=(0,o.env)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new eS(i.shape,u,l,a,s):new tS(i.shape,u,l,a,s);return n.runWebGLProgram(h,[i],i.dtype)}};class rS{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,r,i]=e,[,a,o]=t,s=[n&&a>1?r-1:r,n&&o>1?i-1:i],c=[n&&a>1?a-1:a,n&&o>1?o-1:o],u=s[0]/c[0],l=s[1]/c[1],h=1/u,d=1/l,f=2*Math.ceil(h)+2,p=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(u,");\n        const float widthScale = float(").concat(l,");\n\n        const float invHeightScale = float(").concat(h,");\n        const float invWidthScale = float(").concat(d,");\n\n        const int winHeight = int(").concat(f,");\n        const int winWidth = int(").concat(p,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(a,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(o,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(s[0],") *\n                (float(dyR) / float(").concat(c[0],"));\n\n            float sourceFracCol =\n                float(").concat(s[1],") *\n                  (float(dyC) / float(").concat(c[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(r,") - 1),\n                ").concat(n," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(i,") - 1),\n                ").concat(n," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}const iS={kernelName:o.ResizeNearestNeighborGrad,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:i,dy:a}=e,{alignCorners:o}=r,s=new rS(a.shape,i.shape,o);return n.runWebGLProgram(s,[a],a.dtype)}};class aS{constructor(t,e){this.variableNames=["x"];const n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));if(this.outputShape=t,1===n)return void(this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(t[0]," - coord - 1));\n        }\n      "));const r=t.map(((n,r)=>(n=>-1!==e.indexOf(n)&&1!==t[n]?"".concat(t[n]," - coords[").concat(n,"] - 1"):"coords[".concat(n,"]"))(r))).join(","),i=Mm(n);this.userCode="\n      void main() {\n        ".concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(r,"));\n      }\n    ")}}class oS{constructor(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));this.outputShape=t;const r=ev("rc",n),i="".concat(r[n-1]," + 1 < ").concat(this.outputShape[n-1]),a="".concat(r[n-2]," + 1 < ").concat(this.outputShape[n-2]),o=Mm(n);function s(n){const r=t.map(((r,i)=>function(n,r){return-1!==e.indexOf(n)&&1!==t[n]?"".concat(t[n]," - ").concat(r[n]," - 1"):"".concat(r[n])}(i,n))),i=r.join(","),a=r.slice(-2).join(",");return"getChannel(getX(".concat(i,"), vec2(").concat(a,"))")}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(t[0]," - rc - 1),\n            ").concat(t[0]," - rc - 1);\n          if(").concat(i,"){\n              result.g = getChannel(getX(").concat(t[0]," - (rc  + 1) - 1),\n                ").concat(t[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(o," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(t){return s(t)}(r.slice()),";\n          if(").concat(i,"){\n            result.g = ").concat(function(t){return t[n-1]="("+t[n-1]+" + 1)",s(t)}(r.slice()),";\n          }\n          if(").concat(a,") {\n            result.b = ").concat(function(t){return t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice()),";\n            if(").concat(i,") {\n              result.a = ").concat(function(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")}}const sS={kernelName:o.Reverse,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{dims:a}=r,s=i.shape.length,c=o.util.parseAxisParam(a,i.shape);if(0===s)return Iv({inputs:{x:i},backend:n});const u=(0,o.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new oS(i.shape,c):new aS(i.shape,c);return n.runWebGLProgram(u,[i],i.dtype)}};class cS{constructor(t,e){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const n=t[1],r=t[2];this.outputShape=t;let i="";i="number"===typeof e?"float outputValue = ".concat(e.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(e.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(i,"\n          if(coordX >= 0 && coordX < ").concat(r," && coordY >= 0 && coordY < ").concat(n,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}const uS={kernelName:o.RotateWithOffset,backendName:"webgl",kernelFunc:t=>{let{inputs:e,attrs:n,backend:r}=t;const{image:i}=e,{radians:a,fillValue:s,center:c}=n,u=r,l=new cS(i.shape,s),[h,d]=o.backend_util.getImageCenter(c,i.shape[1],i.shape[2]),f=[[h,d,Math.sin(a),Math.cos(a)]];return u.runWebGLProgram(l,[i],i.dtype,f)}},lS=Vv({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),hS={kernelName:o.Round,backendName:"webgl",kernelFunc:lS},dS=Vv({opSnippet:"return inversesqrt(x);",cpuKernelImpl:Ry}),fS={kernelName:o.Rsqrt,backendName:"webgl",kernelFunc:dS};class pS{constructor(t,e,n,r,i,a){let o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;const s=Mm(i.length),c=Mm(a.length);let u="";1===n?u="i":2===n&&(u="i, j");const l="getIndices(".concat(u,")");let h="";1===r?h="i":2===r&&(h="i, coords[1]");const d="getUpdates(".concat(h,")");let f="";o&&(f="coords[0], coords[1]");const p="getDefaultValue(".concat(f,")"),g=e>1?"strides[j]":"strides";this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(i,");\n\n        void main() {\n          ").concat(c," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(t,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(e,"; j++) {\n              int index = round(").concat(l,");\n              flattenedIndex += index * ").concat(g,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(d,";\n              found = true;\n            }\n          }\n          setOutput(mix(").concat(p,", sum, float(found)));\n        }\n      ")}}class gS{constructor(t,e,n,r,i,a){let o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=a;const s=Mm(i.length),c=Mm(a.length);let u="";1===n?u="i":2===n&&(u="i, j");const l="getIndices(".concat(u,")");let h="";1===r?h="i":2===r&&(h="i, coords[1]");const d="getUpdates(".concat(h,")");let f="";o&&(f="coords[0], coords[1]");const p="getDefaultValue(".concat(f,")"),g=e>1?"strides[j]":"strides",m=e>1?"strides[j + 1]":"strides";this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(i,");\n\n        void main() {\n          ").concat(c," coords = getOutputCoords();\n          vec4 sum = vec4(0.);\n          vec4 found = vec4(0.);\n          for (int i = 0; i < ").concat(t,"; i+=2) {\n            ivec2 flattenedIndex = ivec2(0);\n            for (int j = 0; j < ").concat(e,"; j+=2) {\n              ivec4 index = round(").concat(l,");\n              flattenedIndex += index.xz * ").concat(g,";\n              if (j + 1 < ").concat(e,") {\n                flattenedIndex += index.yw * ").concat(m,";\n              }\n            }\n            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||\n                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {\n              vec4 updVals = ").concat(d,";\n              if (flattenedIndex[0] == coords[0]) {\n                sum.xy += updVals.xy;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[0] == coords[0] + 1) {\n                sum.zw += updVals.xy;\n                found.zw = vec2(1.);\n              }\n              if (flattenedIndex[1] == coords[0]) {\n                sum.xy += updVals.zw;\n                found.xy = vec2(1.);\n              } else if (flattenedIndex[1] == coords[0] + 1) {\n                sum.zw += updVals.zw;\n                found.zw = vec2(1.);\n              }\n            }\n          }\n          setOutput(mix(").concat(p,", sum, found));\n        }\n      ")}}const mS={kernelName:o.ScatterNd,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{indices:i,updates:a}=e,{shape:s}=r,{sliceRank:c,numUpdates:u,sliceSize:l,strides:h,outputSize:d}=o.backend_util.calculateShapes(a,i,s),f=[d/l,l];if(0===d)return n.makeTensorInfo(s,i.dtype);const p=Qv({inputs:{x:i},backend:n,attrs:{shape:[u,c]}}),g=Qv({inputs:{x:a},backend:n,attrs:{shape:[u,l]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let y;y=(0,o.env)().getBool("WEBGL_PACK")?new gS(u,c,p.shape.length,g.shape.length,h,f):new pS(u,c,p.shape.length,g.shape.length,h,f);const v=n.runWebGLProgram(y,[g,p,m],g.dtype),b=Qv({inputs:{x:v},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(m),b}};class yS{constructor(t,e,n,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,n];const i="for (int i = 0; i < ".concat(Math.ceil(Math.log2(e+1)),"; ++i) { if (left >= right) break;"),a=2===(0,o.env)().getNumber("WEBGL_VERSION")?"while (left < right) {":i,s="left"===r?"<":"<=";this.userCode="\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ".concat(a,"\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ").concat(s," value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     ")}}const vS={kernelName:o.SearchSorted,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:i,values:a}=e,{side:o}=r,s=new yS(i.shape[0],i.shape[1],a.shape[1],o),c=[[i.shape[1]]];return n.runWebGLProgram(s,[i,a],"int32",c)}};class bS{constructor(t,e,n){let r,i;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank ".concat(n," is not yet supported"));if(1===n)i="resRC",r="resRC";else{const n=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],o=[];for(let r=0;r<e.length;r++)o.push("".concat(n[r])),r<t&&a.push("".concat(n[r]));r=a.join(),i=o.join()}const a=Mm(n);this.userCode="\n      void main() {\n        ".concat(a," resRC = getOutputCoords();\n        float cVal = getC(").concat(r,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(i,"));\n        } else {\n          setOutput(getB(").concat(i,"));\n        }\n      }\n    ")}}const xS={kernelName:o.Select,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{condition:r,t:i,e:a}=e,s=new bS(r.shape.length,i.shape,i.shape.length);return n.runWebGLProgram(s,[r,i,a],(0,o.upcastType)(i.dtype,a.dtype))}},wS=Vv({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(o.backend_util.SELU_SCALEALPHA,";\n  float scale = ").concat(o.backend_util.SELU_SCALE,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),kS={kernelName:o.Selu,backendName:"webgl",kernelFunc:wS},_S=Vv({opSnippet:Wv+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:By}),SS={kernelName:o.Sigmoid,backendName:"webgl",kernelFunc:_S},AS=Vv({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),CS={kernelName:o.Sign,backendName:"webgl",kernelFunc:AS},ES=Vv({opSnippet:Wv+"\n  return sin(x);\n",packedOpSnippet:"\n  vec4 result = sin(x);\n  bvec4 isNaN = isnan(x);\n  ".concat(Dv,"\n  return result;\n")}),TS={kernelName:o.Sin,backendName:"webgl",kernelFunc:ES},NS=Vv({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),DS={kernelName:o.Sinh,backendName:"webgl",kernelFunc:NS},FS=Vv({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),IS={kernelName:o.Softplus,backendName:"webgl",kernelFunc:FS},MS={kernelName:o.SpaceToBatchND,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockShape:a,paddings:s}=r;o.util.assert(i.shape.length<=4,(()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"));const c=a.reduce(((t,e)=>t*e)),u=[[0,0]];u.push(...s);for(let o=1+a.length;o<i.shape.length;++o)u.push([0,0]);const l=[],h=M_({inputs:{x:i},backend:n,attrs:{paddings:u,constantValue:0}}),d=o.backend_util.getReshaped(h.shape,a,c,!1),f=o.backend_util.getPermuted(d.length,a.length,!1),p=o.backend_util.getReshapedPermuted(h.shape,a,c,!1),g=Qv({inputs:{x:h},backend:n,attrs:{shape:d}}),m=cb({inputs:{x:g},backend:n,attrs:{perm:f}}),y=Qv({inputs:{x:m},backend:n,attrs:{shape:p}});return l.push(h),l.push(g),l.push(m),l.forEach((t=>n.disposeIntermediateTensorInfo(t))),y}};const OS={kernelName:o.SparseFillEmptyRows,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{indices:r,values:i,denseShape:a,defaultValue:o}=e;if(1!==a.shape.length)throw new Error("Dense shape must be a vector, saw:\n         ".concat(a.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n         ".concat(r.shape));if(1!==i.shape.length)throw new Error("Values must be a vector, saw:\n         ".concat(i.shape));if(0!==o.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(o.shape));const s=n.readSync(r.dataId),c=n.readSync(i.dataId),u=n.readSync(a.dataId),l=n.readSync(o.dataId)[0],[h,d,f,p,g]=jy(s,r.shape,r.dtype,c,i.dtype,u,l);return[n.makeTensorInfo(d,r.dtype,h),n.makeTensorInfo([d[0]],i.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map((t=>Number(t))))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}};const RS={kernelName:o.SparseReshape,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:i,newShape:a}=e;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape ".concat(r.shape));if(1!==i.shape.length)throw new Error("Input shape should be a vector but received shape ".concat(i.shape));if(1!==a.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(a.shape));const o=Array.from(n.readSync(i.dataId)),s=n.readSync(r.dataId),c=Array.from(n.readSync(a.dataId)),[u,l,h]=Uy(s,r.shape,r.dtype,o,c);return[n.makeTensorInfo(l,r.dtype,u),n.makeTensorInfo([h.length],a.dtype,new Int32Array(h))]}};const zS={kernelName:o.SparseSegmentMean,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{data:r,indices:i,segmentIds:a}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error("Indices should be a vector but received shape\n              ".concat(i.shape));if(1!==a.shape.length)throw new Error("Segment ids should be a vector but received shape\n              ".concat(a.shape));const o=n.readSync(r.dataId),s=n.readSync(i.dataId),c=n.readSync(a.dataId),[u,l]=Wy(o,r.shape,r.dtype,s,c,!0);return n.makeTensorInfo(l,r.dtype,u)}};const BS={kernelName:o.SparseSegmentSum,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{data:r,indices:i,segmentIds:a}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error("Indices should be a vector but received shape\n             ".concat(i.shape));if(1!==a.shape.length)throw new Error("Segment ids should be a vector but received shape\n             ".concat(a.shape));const o=n.readSync(r.dataId),s=n.readSync(i.dataId),c=n.readSync(a.dataId),[u,l]=Wy(o,r.shape,r.dtype,s,c);return n.makeTensorInfo(l,r.dtype,u)}};const LS={kernelName:o.SparseToDense,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:i,sparseValues:a,defaultValue:s}=e,{outputShape:c}=r,{sliceRank:u,numUpdates:l,sliceSize:h,strides:d,outputSize:f}=o.backend_util.calculateShapes(a,i,c);if("string"===a.dtype){const t=n.bufferSync(i),e=n.bufferSync(a),r=o.util.decodeString(n.readSync(s.dataId)[0]),p=zy(t,e,c,f,h,l,u,d,r,false);return n.makeTensorInfo(c,p.dtype,p.values)}const p=new pS(l,u,i.shape.length,a.shape.length,d,[f,1],false),g=n.runWebGLProgram(p,[a,i,s],a.dtype),m=Qv({inputs:{x:g},backend:n,attrs:{shape:c}});return n.disposeIntermediateTensorInfo(g),m}};const PS={kernelName:o.SplitV,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{numOrSizeSplits:a,axis:s}=r,c=o.util.parseAxisParam(s,i.shape)[0],u=o.backend_util.prepareSplitSize(i,a,c),l=i.shape.length,h=new Array(l).fill(0),d=i.shape.slice();return u.map((t=>{const e=[...d];e[c]=t;const r=ax({inputs:{x:i},backend:n,attrs:{begin:h,size:e}});return h[c]+=t,r}))}},jS="return sqrt(x);",US=Vv({opSnippet:jS,packedOpSnippet:jS,cpuKernelImpl:Vy}),WS={kernelName:o.Sqrt,backendName:"webgl",kernelFunc:US},VS=Vv({opSnippet:"return x * x;"}),qS={kernelName:o.Square,backendName:"webgl",kernelFunc:VS},GS="return (a - b) * (a - b);",HS=qv({opSnippet:GS,packedOpSnippet:GS}),YS={kernelName:o.SquaredDifference,backendName:"webgl",kernelFunc:HS};const XS={kernelName:o.StaticRegexReplace,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e;if("string"!==i.dtype)throw new Error("Input must be of datatype string");const a=n.readSync(i.dataId),s=o.backend_util.fromUint8ToStringArray(a),c=qy(s,"string",r);return n.makeTensorInfo(i.shape,"string",c)}};const KS={kernelName:o.Step,backendName:"webgl",kernelFunc:function(t){let{inputs:e,attrs:n,backend:r}=t;const{x:i}=e,a=uv+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),o=new cv(i.shape,a);return r.runWebGLProgram(o,[i],i.dtype)}};class $S{constructor(t,e,n){this.variableNames=["x"],this.outputShape=n;const r=n.length,i=Mm(n.length),a=Mm(n.length);let o="";if(1===r)o="coords * strides + begin";else{let t=0;o=n.map(((e,r)=>(t++,1===n.length?"coords * strides[".concat(r,"] + begin[").concat(r,"]"):"coords[".concat(t-1,"] * strides[").concat(r,"] + begin[").concat(r,"]")))).join(",")}this.userCode="\n      ".concat(i," begin = ").concat(i,"(").concat(t,");\n      ").concat(i," strides = ").concat(i,"(").concat(e,");\n\n      void main() {\n        ").concat(a," coords = getOutputCoords();\n        setOutput(getX(").concat(o,"));\n      }\n    ")}}const ZS={kernelName:o.StridedSlice,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{begin:a,end:s,strides:c,beginMask:u,endMask:l,ellipsisMask:h,newAxisMask:d,shrinkAxisMask:f}=r,{finalShapeSparse:p,finalShape:g,isIdentity:m,sliceDim0:y,isSimpleSlice:v,begin:b,end:x,strides:w}=o.slice_util.sliceInfo(i.shape,a,s,c,u,l,h,d,f);let k;if(m)k=Qv({inputs:{x:i},backend:n,attrs:{shape:g}});else if(y||v){o.util.assert(i.shape.length>=1,(()=>"Input must have rank at least 1, got: ".concat(i.shape.length)));const t=o.slice_util.computeOutShape(b,x,w),e=ax({inputs:{x:i},backend:n,attrs:{begin:b,size:t}});k=Qv({inputs:{x:e},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(e)}else{if(n.shouldExecuteOnCPU([i])){const t=n.readSync(i.dataId),e=(0,o.buffer)(i.shape,i.dtype,t),r=Gy(p,e,w,b);k=n.makeTensorInfo(g,i.dtype,r.values)}else{const t=new $S(b,w,p);k=n.runWebGLProgram(t,[i],i.dtype)}}const _=Qv({inputs:{x:k},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(k),_}};const QS={kernelName:o.StringNGrams,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{separator:i,nGramWidths:a,leftPad:o,rightPad:s,padWidth:c,preserveShortSequences:u}=r,{data:l,dataSplits:h}=e,d=n.readSync(l.dataId),f=n.readSync(h.dataId),[p,g]=Hy(d,f,i,a,o,s,c,u);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(h.shape,"int32",g)]}};const JS={kernelName:o.StringSplit,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:i}=r,{input:a,delimiter:o}=e;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(1!==a.shape.length)throw new Error("Input must be a vector, got shape: ".concat(a.shape));if(0!==o.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(o.shape));const s=n.readSync(a.dataId),c=n.readSync(o.dataId)[0],[u,l,h]=Yy(s,c,i),d=l.length;return[n.makeTensorInfo([d,2],"int32",u),n.makeTensorInfo([d],"string",l),n.makeTensorInfo([2],"int32",new Int32Array(h))]}};const tA={kernelName:o.StringToHashBucketFast,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:i}=r,{input:a}=e;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(a.dataId),s=Xy(o,i);return n.makeTensorInfo(a.shape,"int32",s)}},eA=Vv({opSnippet:"return tan(x);"}),nA={kernelName:o.Tan,backendName:"webgl",kernelFunc:eA},rA=Vv({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),iA={kernelName:o.Tanh,backendName:"webgl",kernelFunc:rA};const aA={kernelName:o.TensorScatterUpdate,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{tensor:i,indices:a,updates:s}=e,{}=r,{sliceRank:c,numUpdates:u,sliceSize:l,strides:h,outputSize:d}=o.backend_util.calculateShapes(s,a,i.shape),f=[d/l,l];if(0===d)return n.makeTensorInfo(i.shape,a.dtype);const p=Qv({inputs:{x:a},backend:n,attrs:{shape:[u,c]}}),g=Qv({inputs:{x:s},backend:n,attrs:{shape:[u,l]}}),m=Qv({inputs:{x:i},backend:n,attrs:{shape:f}}),y=new pS(u,c,p.shape.length,g.shape.length,h,f,!1,!0),v=n.runWebGLProgram(y,[g,p,m],m.dtype),b=Qv({inputs:{x:v},backend:n,attrs:{shape:i.shape}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),b}};class oA{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let a=0;a<n.length;a++)n[a]=t[a]*e[a];this.outputShape=n,this.rank=n.length;const r=Mm(this.rank),i=function(t){const e=t.length;if(e>5)throw Error("Tile for rank ".concat(e," is not yet supported"));if(1===e)return"imod(resRC, ".concat(t[0],")");const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let i=0;i<t.length;i++)r.push("imod(".concat(n[i],", ").concat(t[i],")"));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        setOutput(getA(").concat(i,"));\n      }\n    ")}}function sA(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{reps:a}=r;if("string"===i.dtype||i.shape.length>5){const t=n.readSync(i.dataId),e="string"===i.dtype?t.map((t=>o.util.decodeString(t))):t,r=(0,o.buffer)(i.shape,i.dtype,e),s=$y(r,a);return n.makeTensorInfo(s.shape,s.dtype,s.values)}const s=new oA(i.shape,a);return n.runWebGLProgram(s,[i],i.dtype)}const cA={kernelName:o.Tile,backendName:"webgl",kernelFunc:sA};class uA{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}}class lA{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}}function hA(t,e){null!==e&&t.disposeIntermediateTensorInfo(e)}function dA(t){let e=1;for(;e<t;)e*=2;return e}const fA={kernelName:o.TopK,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{k:a,sorted:s}=r,c=(0,o.env)().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),u=(0,o.env)().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),l=i.shape,h=l[l.length-1];if(n.shouldExecuteOnCPU([i])||h<c||a>u){const t=n.readSync(i.dataId),[e,r]=Zy(t,l,i.dtype,a,s);return[n.makeTensorInfo(e.shape,e.dtype,e.values),n.makeTensorInfo(r.shape,r.dtype,r.values)]}if(0===a)return l[l.length-1]=0,[n.makeTensorInfo(l,i.dtype,[]),n.makeTensorInfo(l,"int32",[])];if(1===h)return[i,qw({attrs:{shape:l,dtype:"int32",value:0},backend:n})];const d=n.texData.get(i.dataId),f=null!==d&&d.isPacked,p=f?n.unpackTensor(i):i,g=o.util.sizeFromShape(l)/h,m=Qv({inputs:{x:p},attrs:{shape:[g,h]},backend:n});f&&hA(n,p);const y=dA(a),v=dA(h);let b=null;const x=()=>null===b?[m,m]:[m,b],w=(t,e,r)=>{const i=x(),a=new uA(r),o=[[h],[null===b?1:0],[Number.NEGATIVE_INFINITY],[t],[e]],s=b;b=n.runWebGLProgram(a,i,"int32",o),hA(n,s)};for(let o=1;o<y;o*=2){const t=2*o;for(let e=o;e>=1;e/=2)w(t,e,[g,v])}for(let o=v;o>y;o/=2){const t=x(),e=new lA([g,o/2]),r=[[h],[null===b?1:0],[y]],i=b;b=n.runWebGLProgram(e,t,"int32",r),hA(n,i);const a=y/2,s=2*a;for(let n=a;n>=1;n/=2)w(s,n,b.shape)}let k=b;b=ax({inputs:{x:b},backend:n,attrs:{begin:0,size:[g,a]}}),hA(n,k);let _=uk({inputs:{x:m,indices:b},backend:n,attrs:{axis:1,batchDims:1}});hA(n,m);const S=l.slice(0,-1);S.push(a),k=b,b=Qv({inputs:{x:b},attrs:{shape:S},backend:n}),hA(n,k);const A=_;return _=Qv({inputs:{x:_},attrs:{shape:S},backend:n}),hA(n,A),[_,b]}};class pA{constructor(t,e,n,r,i,a){this.variableNames=["Image","Transforms"],this.outputShape=a;const o="nearest"===n?1:2;let s;switch(r){case"constant":default:s=1;break;case"reflect":s=2;break;case"wrap":s=3;break;case"nearest":s=4}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(s," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(t," && 0 <= coordX && coordX < ").concat(e,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(i,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(i,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(e,"));\n                float mapY = mapCoord(inY, float(").concat(t,"));\n\n                if (").concat(o," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")}}const gA={kernelName:o.Transform,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{image:i,transforms:a}=e,{interpolation:o,fillMode:s,fillValue:c,outputShape:u}=r,[l,h,d,f]=i.shape,[p,g]=null!=u?u:[h,d],m=new pA(h,d,o,s,c,[l,p,g,f]);return n.runWebGLProgram(m,[i,a],"float32")}};const mA={kernelName:o.Unique,backendName:"webgl",kernelFunc:function(t){const{inputs:e,attrs:n,backend:r}=t,{axis:i}=n,{x:a}=e;gm(a,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(a.dataId),{outputValues:s,outputShape:c,indices:u}=Jy(o,i,a.shape,a.dtype);return[r.makeTensorInfo(c,a.dtype,s),r.makeTensorInfo([u.length],"int32",u)]}};const yA={kernelName:o.Unpack,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{value:i}=e;let{axis:a}=r;a<0&&(a+=i.shape.length);const o=i,s=o.shape.length,c=i.shape[a],u=new Array(s-1);let l=0;for(let g=0;g<s;g++)g!==a&&(u[l++]=o.shape[g]);const h=[],d=new Array(s).fill(0),f=o.shape.slice();f[a]=1;const p=new Array(c);for(let g=0;g<p.length;g++){d[a]=g;const t=ax({inputs:{x:o},backend:n,attrs:{begin:d,size:f}}),e=Qv({inputs:{x:t},backend:n,attrs:{shape:u}});p[g]=e,h.push(t)}return h.forEach((t=>n.disposeIntermediateTensorInfo(t))),p}};class vA{constructor(t,e){this.variableNames=["x","segmentIds"];const n=t.windowSize,r=t.batchSize,i=t.inSize,a=t.numSegments,o=a*Math.ceil(i/n);this.outputShape=[r,o];const s=4*Math.floor(n/4),c=n%4,u="\n        sumValue += dot(values, segFilter);\n    ";let l="";i%n>0&&(l="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      "));let h="";i%n>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(l,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(h,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(a,")) * float(").concat(n,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(a,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(u,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(u,"\n        } else if (").concat(2===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(u,"\n        } else if (").concat(3===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(u,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")}}const bA={kernelName:o.UnsortedSegmentSum,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,segmentIds:a}=e,{numSegments:s}=r,c=i.shape.length,u=[];let l=0;const h=o.backend_util.getAxesPermutation([l],c);let d=i;null!=h&&(d=cb({inputs:{x:i},backend:n,attrs:{perm:h}}),u.push(d),l=o.backend_util.getInnerMostAxes(1,c)[0]);const f=o.backend_util.segment_util.computeOutShape(d.shape,l,s),p=o.util.sizeFromShape([d.shape[l]]),g=Qv({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}});u.push(g);const m=(0,o.sumOutType)(i.dtype),y=(t,e,r,i,a)=>{const s=t.shape[0],c=t.shape[1],l=o.backend_util.segment_util.segOpComputeOptimalWindowSize(c,a),h=new vA({windowSize:l,inSize:c,batchSize:s,numSegments:a},e),d=n.compileAndRun(h,[t,r],i);if(u.push(d),d.shape[1]===a)return d;const f=U_({backend:n,attrs:{start:0,stop:a,step:1,dtype:"float32"}}),p=sA({inputs:{x:f},backend:n,attrs:{reps:[c/l]}});u.push(f),u.push(p);return y(d,e,p,i,a)},v=Qv({inputs:{x:y(g,"unsortedSegmentSum",a,m,s)},backend:n,attrs:{shape:f}});let b=v;if(null!=h){u.push(v);const t=o.backend_util.getUndoAxesPermutation(h);b=cb({inputs:{x:b},backend:n,attrs:{perm:t}})}return u.forEach((t=>n.disposeIntermediateTensorInfo(t))),b}},xA=[db,pb,mb,vb,wb,Sb,Ab,Cb,Ib,Mb,Rb,Bb,Pb,Ub,Vb,Hb,Yb,$b,Zb,Qb,ex,sx,cx,ux,lx,mx,bx,kx,Rv,Ax,Mx,Ux,Hx,Xx,Kx,$x,Zx,Jx,ew,rw,uw,lw,hw,fw,mw,bw,xw,kw,Sw,Aw,Ew,Tw,Dw,Iw,Ow,zw,Pw,Ww,Gw,Yw,$w,Qw,ek,ik,ak,sk,lk,dk,pk,Mv,gk,Dx,yk,bk,wk,Lv,_k,Ak,Ck,Tk,Dk,Ik,Ok,zk,Pk,Uk,Vk,Gk,Hk,Yk,$k,Zk,Qk,Jk,t_,n_,a_,s_,m_,Zv,v_,x_,k_,S_,dx,C_,N_,D_,O_,z_,Uv,B_,L_,P_,j_,W_,px,l_,q_,H_,X_,Jv,Z_,J_,nS,iS,sS,uS,hS,fS,mS,vS,xS,kS,SS,CS,TS,DS,ox,g_,IS,MS,OS,RS,zS,BS,LS,PS,WS,qS,YS,XS,KS,ZS,QS,JS,tA,f_,sb,nA,iA,aA,cA,fA,gA,ub,mA,yA,bA,T_];for(const n of xA)(0,o.registerKernel)(n);o.version_core;const wA=t=>{if(Array.isArray(t))return t.map((t=>wA(t)));if(t.dataSync)return t.dataSync();if("number"===typeof t&&isNaN(t))throw new Error("NaN");return t?Object.entries(t).map((t=>{let[e,n]=t;return[e,wA(n)]})).reduce(((t,e)=>({...t,[e[0]]:e[1]})),{}):t};class kA{constructor(t){let{policy:e,discountRate:n,learningRate:r}=t;this.policy=e,this.discountRate=n,this.optimizer=o.train.adam(r),this.trajectories=[]}pushGradients(t,e){for(const n in e)n in t?t[n].push(e[n]):t[n]=[e[n]]}observe(t){return[t,null]}toEnvAction(t,e){return e}fromEnvAction(t,e){return e}async step(t,e,n,r){const[i,a,s]=o.tidy((()=>{try{const t=o.tensor2d([e]);return this.policy.getGradientsAndAction(t,e,n,((t,e)=>this.toEnvAction(t,void 0!==r?r:e)))}catch(t){throw t}})),c=await t.step(a),u={inputs:e,validActions:n,action:void 0!==r?r:s,reward:c};return this.trajectory&&this.trajectory.push(u),o.dispose(i),u}addBonus(t){}beforeEpisode(){this.trajectory=[]}afterEpisode(t){t||(this.trajectories.push(this.trajectory),this.trajectory=[])}update(t,e){const n=[],r=[];for(let o=0;o<t.length;o++){const e=t[o],i=[],a=[];e.forEach(((t,e)=>{i.push(t.reward),t.real&&a.push(e)})),n.push(i),r.push(a)}t.length&&o.tidy((()=>{const i=function(t,e){return o.tidy((()=>{const n=[];for(const r of t)n.push(_A(r,e));return n}))}(n,this.discountRate).map(((t,e)=>t.gather(r[e])));console.log("@rewardSequences",t),console.log("@realsList",r),console.log("@normalizedRewards",i);for(let t=0;t<this.trajectories.length;t++){const n=this.trajectories[t];if(console.log("@trajectory",t,n),0===n.length){e(t);continue}const r=()=>{const e=i[t],r=[],a=[],s=[],c=[],u=[],l=[],h=n.reduce(((t,e)=>{let{inputs:n,action:i,validActions:h}=e;const d=o.tensor2d([n]),[f,,p]=this.policy.getLogitsAndAction(d,h);r.push(i),a.push(p.dataSync());const g=p.log(),m=g.mul(p).sum().neg().reshape([-1]);return s.push(g.dataSync()),c.push(g.mul(p).dataSync()),u.push(g.mul(p).sum().dataSync()),l.push(g.mul(p).sum().neg().dataSync()),t[0].push(g.gather([i],1).reshape([-1])),t[1].push(m),t}),[[],[]]),d=o.concat(h[0]),f=o.concat(h[1]),p=o.tensor(.01);console.log(this.constructor.name,"@@@@actions",r),console.log(this.constructor.name,"@@@@probs",a),console.log(this.constructor.name,"@@@@log_probs",s),console.log(this.constructor.name,"@@@@ G",e.toString(),e.dataSync()),console.log(this.constructor.name,"@@@@logProbs",d.toString(),d.dataSync()),console.log(this.constructor.name,"@@@@entropies",f.toString(),f.dataSync());const g=e.mul(d).add(p.mul(f)).neg().mean().asScalar();return console.log(this.constructor.name,"@@@@loss",g.toString()),g},a=this.optimizer.computeGradients(r);console.log(this.constructor.name,"@@@computed",a.value.toString(),wA(a.grads)),this.optimizer.applyGradients(a.grads),o.dispose(a.grads),e(t)}}));let i=0,a=0,s=0;return n.length>0&&o.tidy((()=>{const t=[];for(let i=0;i<n.length;i++){const e=_A(n[i],this.discountRate).gather(r[i]).sum(0,!0);t.push(e)}const e=o.concat(t),c=o.mean(e);i=c.dataSync()[0];const u=o.mean(o.square(o.sub(e,c))),l=o.sqrt(u);a=l.dataSync()[0],s=u.dataSync()[0]})),this.trajectories=[],{rewardsPerEpisode:i,stdRewardsPerEpisode:a,varRewardsPerEpisode:s}}dispose(){this.policy.dispose(),this.optimizer.dispose()}}function _A(t,e){const n=o.buffer([t.length]);let r=0;for(let i=t.length-1;i>=0;--i){const a=e*r+t[i];n.set(a,i),r=a}return n.toTensor()}class SA{constructor(t){t||this.reset()}reset(){throw new Error("Implement required")}getState(){throw new Error("Implement required")}step(t){throw new Error("Implement required")}isDone(){throw new Error("Implement required")}render(t){throw new Error("Implement required")}}class AA extends SA{constructor(t){super(t),this.gravity=9.8,this.massCart=1,this.massPole=.1,this.totalMass=this.massCart+this.massPole,this.cartWidth=.2,this.cartHeight=.1,this.length=.5,this.poleMoment=this.massPole*this.length,this.forceMag=10,this.tau=.02,this.xThreshold=2.4,this.thetaThreshold=12/360*2*Math.PI}reset(){this.sharedData||(this.sharedData=new Float32Array(new SharedArrayBuffer(16)));const t=this.sharedData;this.data||(this.data={get x(){return t[0]},set x(e){t[0]=e},get xDot(){return t[1]},set xDot(e){t[1]=e},get theta(){return t[2]},set theta(e){t[2]=e},get thetaDot(){return t[3]},set thetaDot(e){t[3]=e}}),this.data.x=Math.random()-.5,this.data.xDot=1*(Math.random()-.5),this.data.theta=2*(Math.random()-.5)*(6/360*2*Math.PI),this.data.thetaDot=.5*(Math.random()-.5)}getState(){return[this.data.x,this.data.xDot,this.data.theta,this.data.thetaDot]}computeReward(){return this.isDone()?0:1}step(t){if(this.isDone())return 0;t<0&&(t=this.prevAction>-1?this.prevAction:Math.round(Math.random()));const e=t>0?this.forceMag:-this.forceMag,n=Math.cos(this.data.theta),r=Math.sin(this.data.theta),i=(e+this.poleMoment*this.data.thetaDot*this.data.thetaDot*r)/this.totalMass,a=(this.gravity*r-n*i)/(this.length*(4/3-this.massPole*n*n/this.totalMass)),o=i-this.poleMoment*a*n/this.totalMass;return this.data.x+=this.tau*this.data.xDot,this.data.xDot+=this.tau*o,this.data.theta+=this.tau*this.data.thetaDot,this.data.thetaDot+=this.tau*a,this.prevAction=t,this.computeReward()}isDone(){return this.data.x<-this.xThreshold||this.data.x>this.xThreshold||this.data.theta<-this.thetaThreshold||this.data.theta>this.thetaThreshold}render(t){t.style.display||(t.style.display="block");const e=-this.xThreshold,n=this.xThreshold-e,r=t.width/n,i=t.getContext("2d");i.clearRect(0,0,t.width,t.height);const a=t.width/2,o=.8*t.height,s=this.cartWidth*r,c=this.cartHeight*r,u=this.data.x*r+a;i.beginPath(),i.strokeStyle="#000000",i.lineWidth=2,i.rect(u-s/2,o-c/2,s,c),i.stroke();const l=c/4;for(const m of[-1,1])i.beginPath(),i.lineWidth=2,i.arc(u-s/4*m,o+c/2+l,l,0,2*Math.PI),i.stroke();const h=this.data.theta+Math.PI/2,d=a+r*(this.data.x+Math.cos(h)*this.length),f=o-r*(this.cartHeight/2+Math.sin(h)*this.length);i.beginPath(),i.strokeStyle="#ffa500",i.lineWidth=6,i.moveTo(u,o-c/2),i.lineTo(d,f),i.stroke();const p=o+c/2+2*l;i.beginPath(),i.strokeStyle="#000000",i.lineWidth=1,i.moveTo(0,p),i.lineTo(t.width,p),i.stroke();for(let m=0;m<40;++m){const e=t.width/40*m,n=e+t.width/40/2,r=p+t.width/40/2,a=p;i.beginPath(),i.moveTo(e,r),i.lineTo(n,a),i.stroke()}const g=p-t.height/2;i.beginPath(),i.strokeStyle="#ff0000",i.lineWidth=2,i.moveTo(1,p),i.lineTo(1,g),i.stroke(),i.beginPath(),i.moveTo(t.width-1,p),i.lineTo(t.width-1,g),i.stroke()}}AA.NAME="cart-pole-v1";"indexeddb://".concat(AA.NAME,"/");const CA=AA;class EA extends kA{}EA.NUM_STATES=4,EA.NUM_ACTIONS=2;AA.NAME,EA.NUM_STATES,EA.NUM_ACTIONS;var TA=n(86112),NA=n(44414);const{Game:DA}=e,FA=new DA(!0);const IA=function(t){let{trainer:e}=t;const[n,r]=(0,a.useState)(!1),i=(0,a.useRef)({});(0,a.useEffect)((()=>{const t=async t=>{let{data:n}=t;const{func:a,params:o}=n;"ready"===a?(e.data=o[0],i.current={score:{values:[],series:[],xLabel:"Iteration",yLabel:"Score"},actorLoss:{values:[],series:[],xLabel:"Iteration",yLabel:"Actor Loss"},entropyLoss:{values:[],series:[],xLabel:"Iteration",yLabel:"Entropy Loss"},criticLoss:{values:[],series:[],xLabel:"Iteration",yLabel:"Critic Loss"},loss:{values:[],series:[],xLabel:"Iteration",yLabel:"Loss"}},e.data.plots.forEach((t=>{i.current.score.values.push(t.score.values),i.current.score.series.push(t.score.series),i.current.actorLoss.values.push(t.actorLoss.values),i.current.actorLoss.series.push(t.actorLoss.series),i.current.entropyLoss.values.push(t.entropyLoss.values),i.current.entropyLoss.series.push(t.entropyLoss.series),i.current.criticLoss.values.push(t.criticLoss.values),i.current.criticLoss.series.push(t.criticLoss.series),i.current.loss.values.push(t.loss.values),i.current.loss.series.push(t.loss.series)})),r(!0)):"envSharedData"===a&&(FA.data=null,FA.sharedData=o[0],FA.reset())};return e.worker.addEventListener("message",t),()=>{e.worker.removeEventListener("message",t)}}),[e]);const o=(0,a.useRef)();return(0,a.useEffect)((()=>{if(!n)return;e.call("start"),clearTimeout(o.current);const t=async()=>{if(e.data.training[0]){if(i.current.score.values.length>0)for(const t of["score","actorLoss","entropyLoss","criticLoss","loss"]){const{values:n,series:r,xLabel:a,yLabel:o}=i.current[t],s=document.getElementById("".concat(t,"-plot-container")),c=e.data.plotLength[0]>0,u=[];for(let t=0;t<n.length;t++)u.push(Array(e.data.plotLength[0]).fill(null).map(((e,r)=>({x:r+1,y:n[t][r]}))));c&&TA.render.linechart(s,{values:u,series:r},{xLabel:a||"Training Iteration",yLabel:o,width:600,height:400})}o.current&&(o.current=setTimeout(t,1e3))}else await(async t=>{const e=document.getElementById("env-canvas");e&&FA.data&&t.render(e)})(FA),o.current&&(o.current=requestAnimationFrame(t))};return o.current=requestAnimationFrame(t),()=>{clearTimeout(o.current),o.current=null}}),[n,e]),n&&(0,NA.jsxs)("div",{children:[(0,NA.jsx)("canvas",{id:"env-canvas",height:"600",width:"800",tabIndex:1}),(0,NA.jsx)("div",{style:{display:"flex",flexWrap:"wrap",flexDirection:"row"},children:["score","actorLoss","entropyLoss","criticLoss","loss"].map((t=>(0,NA.jsx)("div",{id:"".concat(t,"-plot-container")},t)))})]})},MA=function(t){let e=arguments.length>2?arguments[2]:void 0;if("function"===typeof t){const n=Array(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1).fill(null).map(t).map(((t,n)=>MA(t,null,e?t=>e(t,n):null))),r=function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return Promise.all(n.map((e=>e.call(t,...r))))};return{call:r}}const n="".concat((Date.now()*Math.random()).toString(36));let r;const i=new Promise((t=>{r=t})),a={};return t.addEventListener("message",(t=>{let{data:n}=t;if("calleeReady"===n.func)return void r();const{callId:i,error:o,data:s}=n;i&&a[i]?o?a[i].reject(o):a[i].resolve(s):e&&e(n)})),{call:async function(e){await i;const r="".concat((Date.now()*Math.random()).toString(36));for(var o=arguments.length,s=new Array(o>1?o-1:0),c=1;c<o;c++)s[c-1]=arguments[c];return t.postMessage({func:e,params:s,callerId:n,callId:r}),new Promise(((t,e)=>{a[r]={resolve:function(){delete a[r],t(...arguments)},reject:function(){delete a[r],e(...arguments)}}}))}}},OA=(()=>{const t=new Worker(new URL(n.p+n.u(468),n.b),{type:void 0});return{worker:t,data:{},call:MA(t).call}})();r.createRoot(document.getElementById("root")).render((0,NA.jsx)(a.StrictMode,{children:(0,NA.jsx)(IA,{trainer:OA})})),i()})()})();